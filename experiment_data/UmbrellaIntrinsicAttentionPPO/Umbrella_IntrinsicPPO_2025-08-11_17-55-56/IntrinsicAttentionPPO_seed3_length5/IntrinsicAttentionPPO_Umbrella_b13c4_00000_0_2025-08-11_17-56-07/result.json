{"timers": {"training_iteration": 9.819898374960758, "restore_env_runners": 1.100008375942707e-05, "training_step": 9.819740791921504, "env_runner_sampling_timer": 1.9061874160543084, "learner_update_timer": 7.690860667033121, "synch_weights": 0.0014519579708576202}, "env_runners": {"rlmodule_inference_timer": 3.983426008670497e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 8.136757687032002e-06, "numpy_to_tensor": 1.6132719143644717e-05, "add_states_from_episodes_to_batch": 3.003061164825401e-06, "batch_individual_items": 1.697394914684521e-05, "add_observations_from_episodes_to_batch": 3.319439099585828e-06}}, "connector_pipeline_timer": 7.80096299391318e-05}, "env_step_timer": 1.7009482401767586e-05, "episode_len_max": 20, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.106892315358594e-05, "get_actions": 5.052566930820896e-05, "remove_single_ts_time_rank_from_batch": 1.3522791260668476e-05, "listify_data_for_vector_env": 1.200400743230665e-05, "tensor_to_numpy": 1.7359093526171123e-05, "un_batch_to_individual_items": 7.4011437376277445e-06}}, "connector_pipeline_timer": 0.0001429870904490892}, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "episode_duration_sec_mean": 0.006294332684483381, "time_between_sampling": 0.0006830665674583072, "env_to_module_sum_episodes_length_in": 10.191744832559449, "env_to_module_sum_episodes_length_out": 10.191744832559449, "agent_episode_returns_mean": {"default_agent": -1.5}, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": -1.5}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "env_reset_timer": 8.722824586755602e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime": 627500.0, "episode_return_min": -13.5, "episode_return_mean": -1.5, "weights_seq_no": 0.0, "sample": 0.006686713891193449, "num_episodes_lifetime": 31375.0, "num_env_steps_sampled_lifetime_throughput": 2959.1526490065103}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000, "learner_connector": {"connector_pipeline_timer": 0.1719207080313936, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00963366695214063, "add_observations_from_episodes_to_batch": 0.0009412090294063091, "add_columns_from_episodes_to_train_batch": 0.050481082987971604, "add_time_dim_to_batch_and_zero_pad": 0.09857887506950647, "add_states_from_episodes_to_batch": 0.0037957080639898777, "batch_individual_items": 0.008180874981917441, "numpy_to_tensor": 9.700004011392593e-05}}}, "learner_connector_sum_episodes_length_out": 5250}, "learners": {"default_policy": {"vf_loss": 0.3206194043159485, "mean_kl_loss": 1.5964931662892923e-05, "num_module_steps_trained_lifetime": 5985, "num_module_steps_trained": 5985, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 998.9117791197002, "weights_seq_no": 1.0, "vf_explained_var": 0.0022502541542053223, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.24863503873348236, "curr_kl_coeff": 0.08079196512699127, "policy_loss": -8.621296001365408e-05, "vf_loss_unclipped": 39.4951171875, "entropy": 0.6870701313018799, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 778.9460345136358}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.9117791197002, "weights_seq_no": 1.0, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 5985, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 778.9602627380334}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 36000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 11970, "num_env_steps_trained_lifetime_throughput": 4691.417293256673, "num_module_steps_trained_throughput": 31237766.974511478, "num_module_steps_trained_lifetime_throughput": 13316872.951758863}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.251566082239151, "use_intrinsic_rewards": 1.0, "diff_num_grad_updates_vs_sampler_policy": 6.0, "mean_kl_loss": 1.5722444004495628e-05, "policy_loss": -8.512247586622834e-05, "vf_loss_unclipped": 39.6661376953125, "num_module_steps_trained_lifetime": 35910, "entropy": 0.6870748996734619, "vf_loss": 0.32438045740127563, "vf_explained_var": 0.00533449649810791, "num_module_steps_trained": 35910, "module_train_batch_size_mean": 998.5423314844973, "weights_seq_no": 6.0}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "module_train_batch_size_mean": 998.5423314844973, "weights_seq_no": 6.0, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 6.0, "num_module_steps_trained_lifetime": 35910}, "__all_modules__": {"num_env_steps_trained_lifetime": 216000, "num_module_steps_trained_lifetime": 71820, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 59289.3001680978}}}, "IntrinsicAttentionMask": [[[0.17016753554344177, 0.16013170778751373, 0.16695427894592285, 0.1674308478832245, 0.16758210957050323, 0.16773352026939392], [0.14937469363212585, 0.20248563587665558, 0.16432756185531616, 0.1620001345872879, 0.16126962006092072, 0.16054239869117737], [0.1635868400335312, 0.17260822653770447, 0.16636410355567932, 0.1659458726644516, 0.16581358015537262, 0.165681391954422], [0.16456755995750427, 0.170696422457695, 0.16646556556224823, 0.16618040204048157, 0.16609014570713043, 0.16599994897842407], [0.1648785024881363, 0.1700940877199173, 0.16649672389030457, 0.16625376045703888, 0.16617685556411743, 0.16609998047351837], [0.16518959403038025, 0.1694934219121933, 0.1665274202823639, 0.16632670164108276, 0.1662631630897522, 0.16619963943958282]], [[0.1666826754808426, 0.16662295162677765, 0.16668827831745148, 0.16668963432312012, 0.16668806970119476, 0.16662834584712982], [0.15932071208953857, 0.18641148507595062, 0.15698543190956116, 0.15642869472503662, 0.15707258880138397, 0.18378108739852905], [0.16734068095684052, 0.16482321918010712, 0.16757935285568237, 0.16763684153556824, 0.16757038235664368, 0.1650494635105133], [0.16749809682369232, 0.16439184546470642, 0.1677931845188141, 0.16786426305770874, 0.16778208315372467, 0.16467055678367615], [0.16731606423854828, 0.16489067673683167, 0.16754595935344696, 0.1676013171672821, 0.16753731667995453, 0.16510871052742004], [0.1600133627653122, 0.18457409739494324, 0.15787924826145172, 0.15737003087997437, 0.15795893967151642, 0.18220433592796326]], [[0.17131586372852325, 0.16121231019496918, 0.16808092594146729, 0.1685606986284256, 0.16196474432945251, 0.16886542737483978], [0.14410729706287384, 0.19534537196159363, 0.15853287279605865, 0.15628750622272491, 0.19084574282169342, 0.15488119423389435], [0.16259720921516418, 0.1715640276670456, 0.16535767912864685, 0.16494198143482208, 0.17085999250411987, 0.16467909514904022], [0.16389088332653046, 0.1699945479631424, 0.16578109562397003, 0.1654970943927765, 0.16951905190944672, 0.1653173863887787], [0.14612656831741333, 0.1926209032535553, 0.15935085713863373, 0.15730001032352448, 0.1885875165462494, 0.15601412951946259], [0.16471248865127563, 0.16900388896465302, 0.16604645550251007, 0.1658463180065155, 0.16867123544216156, 0.1657196283340454]], [[0.1666724979877472, 0.16661277413368225, 0.16667810082435608, 0.16667945683002472, 0.16667789220809937, 0.166679248213768], [0.16378645598888397, 0.1916365772485733, 0.16138571500778198, 0.1608133614063263, 0.1614753007888794, 0.16090263426303864], [0.166910320520401, 0.16439932584762573, 0.1671483814716339, 0.16720572113990784, 0.1671394407749176, 0.16719676554203033], [0.16696669161319733, 0.16387028992176056, 0.16726084053516388, 0.16733169555664062, 0.16724978387355804, 0.1673206239938736], [0.16690148413181305, 0.16448210179805756, 0.16713079810142517, 0.16718602180480957, 0.16712217032909393, 0.16717739403247833], [0.16695792973041534, 0.16395285725593567, 0.16724330186843872, 0.16731204092502594, 0.16723257303237915, 0.16730129718780518]], [[0.18240056931972504, 0.18190176784992218, 0.16028456389904022, 0.15890519320964813, 0.15847064554691315, 0.15803728997707367], [0.18192821741104126, 0.18144531548023224, 0.16047854721546173, 0.15913797914981842, 0.15871557593345642, 0.15829430520534515], [0.16074307262897491, 0.16091422736644745, 0.16902369260787964, 0.16959236562252045, 0.1697729527950287, 0.16995371878147125], [0.1593445986509323, 0.1595548391342163, 0.1695762276649475, 0.17028339207172394, 0.17050804197788239, 0.1707330048084259], [0.1589028686285019, 0.15912534296512604, 0.1697504222393036, 0.17050163447856903, 0.17074033617973328, 0.17097938060760498], [0.1584618240594864, 0.15869645774364471, 0.16992418467998505, 0.17071957886219025, 0.17097236216068268, 0.17122551798820496]], [[0.17266438901424408, 0.15896780788898468, 0.1599087417125702, 0.17433713376522064, 0.1739606410264969, 0.16016124188899994], [0.16117562353610992, 0.17368480563163757, 0.1727602481842041, 0.15977634489536285, 0.16008906066417694, 0.1725139021873474], [0.16200454533100128, 0.17262695729732513, 0.17184588313102722, 0.1608087569475174, 0.1610761284828186, 0.1716376692056656], [0.17398403584957123, 0.15726852416992188, 0.15840694308280945, 0.176046222448349, 0.1755816787481308, 0.15871267020702362], [0.17368854582309723, 0.1576491743326187, 0.15874366462230682, 0.1756628453731537, 0.17521819472312927, 0.15903756022453308], [0.16222596168518066, 0.17234429717063904, 0.1716013103723526, 0.16108499467372894, 0.1613401472568512, 0.17140322923660278]]]}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": -1.4}, "num_env_steps_sampled": 400, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.677055289348027e-06, "normalize_and_clip_actions": 9.094396810748929e-06, "get_actions": 4.440615247260328e-05, "listify_data_for_vector_env": 1.0583879092311847e-05, "tensor_to_numpy": 1.6963035596760382e-05, "remove_single_ts_time_rank_from_batch": 1.2830016417315828e-05}}, "connector_pipeline_timer": 0.00012716161855925607}, "env_to_module_connector": {"connector_pipeline_timer": 6.441316093842343e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 8.096122912368151e-06, "add_states_from_episodes_to_batch": 2.7762865734477165e-06, "batch_individual_items": 1.2642764490288767e-05, "numpy_to_tensor": 1.257895337082834e-05, "add_observations_from_episodes_to_batch": 3.5009452605563288e-06}}}, "num_episodes_lifetime": 20, "rlmodule_inference_timer": 3.611330753435974e-05, "episode_duration_sec_mean": 0.005308714567217976, "episode_len_mean": 20.0, "num_episodes": 20, "episode_return_max": 12.5, "weights_seq_no": 1.0, "sample": 0.11661741603165865, "episode_len_max": 20, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "env_to_module_sum_episodes_length_in": 10.216013141322508, "env_to_module_sum_episodes_length_out": 10.216013141322508, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "env_reset_timer": 0.0005738330073654652, "num_env_steps_sampled_lifetime": 5400, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": -1.4, "env_step_timer": 1.495867087168116e-05, "agent_episode_returns_mean": {"default_agent": -1.4}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_min": -12.5}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "b13c4_00000", "date": "2025-08-11_18-04-25", "timestamp": 1754928265, "time_this_iter_s": 9.950098991394043, "time_total_s": 9.950098991394043, "pid": 10212, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x144efd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9.950098991394043, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 34.126666666666665, "ram_util_percent": 80.48666666666666}}
{"timers": {"training_iteration": 9.82357425162103, "restore_env_runners": 1.095925341360271e-05, "training_step": 9.823415825671981, "env_runner_sampling_timer": 1.9040851868945174, "learner_update_timer": 7.696796867452795, "synch_weights": 0.0014524783904198556, "restore_eval_env_runners": 3.5125063732266426e-05, "evaluation_iteration": 0.12790012499317527, "synch_eval_env_connectors": 0.00013970897998660803, "synch_env_connectors": 4.625064320862293e-06}, "env_runners": {"rlmodule_inference_timer": 4.76709506307048e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.064178611418834e-06, "numpy_to_tensor": 1.3322302506074515e-05, "add_states_from_episodes_to_batch": 2.7872479983790545e-06, "batch_individual_items": 1.2899598502713677e-05, "add_observations_from_episodes_to_batch": 2.8627709716062314e-06}}, "connector_pipeline_timer": 6.138985160769717e-05}, "env_step_timer": 1.4451210187677172e-05, "episode_len_max": 20, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.221675117416394e-06, "get_actions": 4.0259102624670225e-05, "remove_single_ts_time_rank_from_batch": 1.241038082157116e-05, "listify_data_for_vector_env": 1.0732452450631868e-05, "tensor_to_numpy": 1.5642996024037807e-05, "un_batch_to_individual_items": 6.812361682428757e-06}}, "connector_pipeline_timer": 0.00012108437106175774}, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "episode_duration_sec_mean": 0.005903673484921457, "time_between_sampling": 0.030481798969296734, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": -1.9799999999999998}, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": -1.9799999999999998}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "env_reset_timer": 5.7834462794906044e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime": 10000.0, "episode_return_min": -13.5, "episode_return_mean": -1.9799999999999998, "weights_seq_no": 1.0, "sample": 0.0065484466051384345, "num_episodes_lifetime": 500.0, "num_env_steps_sampled_lifetime_throughput": 3160.3035515945}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1717660380306188, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009633785702753812, "add_observations_from_episodes_to_batch": 0.0009402235993184149, "add_columns_from_episodes_to_train_batch": 0.0503986263286788, "add_time_dim_to_batch_and_zero_pad": 0.09850852798786945, "add_states_from_episodes_to_batch": 0.003799430562648922, "batch_individual_items": 0.008176882062107324, "numpy_to_tensor": 9.69208695460111e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"vf_loss": 0.3205106258392334, "mean_kl_loss": 1.2989476999791805e-05, "num_module_steps_trained_lifetime": 11970, "num_module_steps_trained": 5985, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 998.828720912135, "weights_seq_no": 2.0, "vf_explained_var": -0.00021135807037353516, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.24847005307674408, "curr_kl_coeff": 0.040395982563495636, "policy_loss": -0.0001660092530073598, "vf_loss_unclipped": 42.49321746826172, "entropy": 0.6863567233085632, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 777.4076396925107}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.828720912135, "weights_seq_no": 2.0, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 11970, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 777.4216496579066}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 72000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 23940, "num_env_steps_trained_lifetime_throughput": 4682.09147676342, "num_module_steps_trained_throughput": 30798915.769952122, "num_module_steps_trained_lifetime_throughput": 13289221.23304101}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.2511293888092041, "use_intrinsic_rewards": 1.0, "diff_num_grad_updates_vs_sampler_policy": 11.0, "mean_kl_loss": 1.240454275830416e-05, "policy_loss": -0.0001627337624086067, "vf_loss_unclipped": 42.22401428222656, "num_module_steps_trained_lifetime": 71820, "entropy": 0.6863701939582825, "vf_loss": 0.32391878962516785, "vf_explained_var": 0.005085647106170654, "num_module_steps_trained": 35910, "module_train_batch_size_mean": 998.2236050808158, "weights_seq_no": 12.0}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "module_train_batch_size_mean": 998.2236050808158, "weights_seq_no": 12.0, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 11.0, "num_module_steps_trained_lifetime": 71820}, "__all_modules__": {"num_env_steps_trained_lifetime": 432000, "num_module_steps_trained_lifetime": 143640, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 58996.08652210807}}}, "IntrinsicAttentionMask": [[[0.17868994176387787, 0.15745441615581512, 0.17771397531032562, 0.15567253530025482, 0.1552468240261078, 0.17522233724594116], [0.1623871624469757, 0.1699371635913849, 0.16270692646503448, 0.17063333094120026, 0.17080125212669373, 0.1635342687368393], [0.17797908186912537, 0.15799982845783234, 0.17706404626369476, 0.15631641447544098, 0.1559140682220459, 0.17472662031650543], [0.1609363704919815, 0.17104454338550568, 0.16136130690574646, 0.17198441922664642, 0.17221133410930634, 0.1624620407819748], [0.16058778762817383, 0.17131051421165466, 0.16103774309158325, 0.1723095327615738, 0.172550767660141, 0.16220363974571228], [0.17614799737930298, 0.15940435230731964, 0.17538802325725555, 0.15797848999500275, 0.1576373428106308, 0.17344380915164948]], [[0.1666724979877472, 0.16667383909225464, 0.16667810082435608, 0.16667945683002472, 0.16667789220809937, 0.16661818325519562], [0.16673026978969574, 0.16674505174160004, 0.16679172217845917, 0.16680651903152466, 0.16678941249847412, 0.16613702476024628], [0.16691090166568756, 0.16696815192699432, 0.16714896261692047, 0.1672063022851944, 0.16714002192020416, 0.16462557017803192], [0.16696760058403015, 0.16703832149505615, 0.1672617495059967, 0.16733260452747345, 0.16725069284439087, 0.16414901614189148], [0.16690202057361603, 0.16695715487003326, 0.16713133454322815, 0.16718655824661255, 0.1671227067708969, 0.16470013558864594], [0.16412919759750366, 0.16359983384609222, 0.16194017231464386, 0.1614178717136383, 0.1620219349861145, 0.18689098954200745]], [[0.17016854882240295, 0.16680458188056946, 0.1602773517370224, 0.16743184626102448, 0.16758312284946442, 0.1677345335483551], [0.16327734291553497, 0.16647808253765106, 0.1730663925409317, 0.16587163507938385, 0.16572605073451996, 0.1655806005001068], [0.14970357716083527, 0.16514095664024353, 0.2009400725364685, 0.16212214529514313, 0.161404088139534, 0.16068920493125916], [0.16456793248653412, 0.16655640304088593, 0.17060410976409912, 0.1661807745695114, 0.16609053313732147, 0.16600032150745392], [0.16487878561019897, 0.16657406091690063, 0.17001570761203766, 0.16625404357910156, 0.16617713868618011, 0.16610027849674225], [0.16518978774547577, 0.16659125685691833, 0.16942887008190155, 0.16632689535617828, 0.16626335680484772, 0.16619983315467834]], [[0.1666826754808426, 0.16668401658535004, 0.16668827831745148, 0.16662858426570892, 0.16662701964378357, 0.1666894257068634], [0.16684158146381378, 0.16685637831687927, 0.1669030785560608, 0.16625024378299713, 0.16623319685459137, 0.16691556572914124], [0.16734114289283752, 0.16739855706691742, 0.16757982969284058, 0.16505877673625946, 0.16499334573745728, 0.16762833297252655], [0.1600807160139084, 0.15956640243530273, 0.15795394778251648, 0.18209725618362427, 0.1827760636806488, 0.1575256586074829], [0.15988340973854065, 0.15935491025447845, 0.15769821405410767, 0.1825525015592575, 0.1832527369260788, 0.15725824236869812], [0.1674741804599762, 0.16754300892353058, 0.1677604466676712, 0.16474096477031708, 0.164662703871727, 0.16781862080097198]], [[0.17872177064418793, 0.15748246014118195, 0.15705180168151855, 0.1762159913778305, 0.15527446568012238, 0.17525354027748108], [0.16239088773727417, 0.16994105279445648, 0.17010830342769623, 0.16321660578250885, 0.1708051711320877, 0.16353802382946014], [0.16204215586185455, 0.17020845413208008, 0.17038969695568085, 0.16293376684188843, 0.1711450070142746, 0.1632809340953827], [0.1768806129693985, 0.15888020396232605, 0.15851156413555145, 0.17477458715438843, 0.15698851644992828, 0.1739644706249237], [0.16059526801109314, 0.17131848633289337, 0.17155832052230835, 0.1617579460144043, 0.17255879938602448, 0.16221119463443756], [0.1761675626039505, 0.15942206978797913, 0.15907779335975647, 0.174214705824852, 0.15765483677387238, 0.17346307635307312]], [[0.17268328368663788, 0.17300646007061005, 0.15992626547813416, 0.16022557020187378, 0.17397966980934143, 0.1601787656545639], [0.17294129729270935, 0.17327892780303955, 0.1596364825963974, 0.15994812548160553, 0.17429578304290771, 0.15989941358566284], [0.16201502084732056, 0.1617823988199234, 0.17185699939727783, 0.1716102510690689, 0.1610865443944931, 0.1716487854719162], [0.16227629780769348, 0.1620563566684723, 0.17156590521335602, 0.17133337259292603, 0.16139833629131317, 0.17136968672275543], [0.17371465265750885, 0.17409586906433105, 0.15876753628253937, 0.1591159552335739, 0.1752445250749588, 0.159061461687088], [0.16223549842834473, 0.16201357543468475, 0.17161139845848083, 0.17137664556503296, 0.16134962439537048, 0.17141330242156982]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 1.6}, "num_env_steps_sampled": 400, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.586501605706332e-06, "normalize_and_clip_actions": 8.05422219347974e-06, "get_actions": 3.873579361881954e-05, "listify_data_for_vector_env": 1.0789369454941114e-05, "tensor_to_numpy": 1.582280391557347e-05, "remove_single_ts_time_rank_from_batch": 1.1898081785991794e-05}}, "connector_pipeline_timer": 0.00011855561757517635}, "env_to_module_connector": {"connector_pipeline_timer": 5.9549179717891666e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.016491371443967e-06, "add_states_from_episodes_to_batch": 2.7037273544841903e-06, "batch_individual_items": 1.2457179413453193e-05, "numpy_to_tensor": 1.2492931204652056e-05, "add_observations_from_episodes_to_batch": 2.9291635325300695e-06}}}, "num_episodes_lifetime": 40, "rlmodule_inference_timer": 3.164851617849795e-05, "episode_duration_sec_mean": 0.005406920803943649, "episode_len_mean": 20.0, "num_episodes": 20, "episode_return_max": 13.5, "weights_seq_no": 2.0, "sample": 0.11674348687054589, "episode_len_max": 20, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "env_to_module_sum_episodes_length_in": 10.366003441359926, "env_to_module_sum_episodes_length_out": 10.366003441359926, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "env_reset_timer": 0.0005891313473694027, "num_env_steps_sampled_lifetime": 10400, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 1.6, "env_step_timer": 1.4285070473400695e-05, "agent_episode_returns_mean": {"default_agent": 1.6}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_min": -12.5, "time_between_sampling": 10.250290166935883}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "b13c4_00000", "date": "2025-08-11_18-04-36", "timestamp": 1754928276, "time_this_iter_s": 10.332186937332153, "time_total_s": 20.282285928726196, "pid": 10212, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x144efd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20.282285928726196, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 42.392857142857146, "ram_util_percent": 79.77142857142857}}
{"timers": {"training_iteration": 9.829229284104565, "restore_env_runners": 1.093425058061257e-05, "training_step": 9.82906958282513, "env_runner_sampling_timer": 1.900716527525778, "learner_update_timer": 7.705822607938515, "synch_weights": 0.0014563348559080622, "restore_eval_env_runners": 3.5147982416674494e-05, "evaluation_iteration": 0.12803802582318896, "synch_eval_env_connectors": 0.00013968521961942317, "synch_env_connectors": 4.652563948184252e-06}, "env_runners": {"rlmodule_inference_timer": 5.054421127974989e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.093120072359714e-06, "numpy_to_tensor": 1.3263370747563322e-05, "add_states_from_episodes_to_batch": 2.7924436704744307e-06, "batch_individual_items": 1.2850108433149855e-05, "add_observations_from_episodes_to_batch": 2.8704512656321094e-06}}, "connector_pipeline_timer": 6.124842572821998e-05}, "env_step_timer": 1.4382614617140296e-05, "episode_len_max": 20, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.263420642302691e-06, "get_actions": 4.002371735293769e-05, "remove_single_ts_time_rank_from_batch": 1.2313589946347897e-05, "listify_data_for_vector_env": 1.065187548670902e-05, "tensor_to_numpy": 1.5633304733583596e-05, "un_batch_to_individual_items": 6.763530454588261e-06}}, "connector_pipeline_timer": 0.00012061532291855168}, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "episode_duration_sec_mean": 0.005375252855475993, "time_between_sampling": 0.03476754012378375, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": -2.1399999999999997}, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": -2.1399999999999997}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "env_reset_timer": 4.461199633970433e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime": -607500.0, "episode_return_min": -13.5, "episode_return_mean": -2.1399999999999997, "weights_seq_no": 2.0, "sample": 0.00640098525040249, "num_episodes_lifetime": -30375.0, "num_env_steps_sampled_lifetime_throughput": 3168.0542153078936}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17173289640130243, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009639681595074945, "add_observations_from_episodes_to_batch": 0.0009396909430855885, "add_columns_from_episodes_to_train_batch": 0.05033598006506218, "add_time_dim_to_batch_and_zero_pad": 0.09851724145797779, "add_states_from_episodes_to_batch": 0.0038096170860575512, "batch_individual_items": 0.00818268074179068, "numpy_to_tensor": 9.693999084411189e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"vf_loss": 0.3205324113368988, "mean_kl_loss": 2.98253999062581e-05, "num_module_steps_trained_lifetime": 17955, "num_module_steps_trained": 5985, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 998.7505232584676, "weights_seq_no": 3.0, "vf_explained_var": -0.0006115436553955078, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.24806755781173706, "curr_kl_coeff": 0.020197991281747818, "policy_loss": -0.0005869070882909, "vf_loss_unclipped": 41.11339569091797, "entropy": 0.685512363910675, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 774.4317271052475}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.7505232584676, "weights_seq_no": 3.0, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 17955, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 774.4453765526539}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 108000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 35910, "num_env_steps_trained_lifetime_throughput": 4664.0676652954635, "num_module_steps_trained_throughput": 30144174.26798689, "num_module_steps_trained_lifetime_throughput": 13256321.04846808}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.25017252564430237, "use_intrinsic_rewards": 1.0, "diff_num_grad_updates_vs_sampler_policy": 16.0, "mean_kl_loss": 2.765471435850486e-05, "policy_loss": -0.0005662320763804018, "vf_loss_unclipped": 41.02581787109375, "num_module_steps_trained_lifetime": 107730, "entropy": 0.6855475306510925, "vf_loss": 0.3232037127017975, "vf_explained_var": 0.005320131778717041, "num_module_steps_trained": 35910, "module_train_batch_size_mean": 998.0016398003509, "weights_seq_no": 18.0}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "module_train_batch_size_mean": 998.0016398003509, "weights_seq_no": 18.0, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 16.0, "num_module_steps_trained_lifetime": 107730}, "__all_modules__": {"num_env_steps_trained_lifetime": 648000, "num_module_steps_trained_lifetime": 215460, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 58460.824414756484}}}, "IntrinsicAttentionMask": [[[0.17132018506526947, 0.16793344914913177, 0.16808517277240753, 0.16182264685630798, 0.16196885704994202, 0.16886968910694122], [0.16219206154346466, 0.16537153720855713, 0.16522638499736786, 0.1714402735233307, 0.17128980159759521, 0.16448001563549042], [0.16260047256946564, 0.1654929369688034, 0.16536100208759308, 0.17099975049495697, 0.17086343467235565, 0.16468241810798645], [0.14581772685050964, 0.15995265543460846, 0.15928471088409424, 0.18992669880390167, 0.18913356959819794, 0.15588457882404327], [0.14620722830295563, 0.1600945144891739, 0.15943880379199982, 0.18946759402751923, 0.18869158625602722, 0.15610022842884064], [0.16471323370933533, 0.16611067950725555, 0.16604721546173096, 0.16873647272586823, 0.16867201030254364, 0.1657203882932663]], [[0.1676187515258789, 0.1673220545053482, 0.16638904809951782, 0.16609452664852142, 0.166435107588768, 0.16614051163196564], [0.1675753891468048, 0.16729223728179932, 0.1664017140865326, 0.16612054407596588, 0.16644567251205444, 0.16616444289684296], [0.1674385517835617, 0.16719815135002136, 0.1664416342973709, 0.16620266437530518, 0.16647900640964508, 0.16623997688293457], [0.16739521920681, 0.16716833412647247, 0.1664542853832245, 0.16622868180274963, 0.16648955643177032, 0.1662639081478119], [0.1674453318119049, 0.16720281541347504, 0.16643966734409332, 0.16619861125946045, 0.16647736728191376, 0.16623623669147491], [0.1674019992351532, 0.16717299818992615, 0.1664523184299469, 0.1662246286869049, 0.166487917304039, 0.16626018285751343]], [[0.17131689190864563, 0.1679302304983139, 0.16135896742343903, 0.16856172680854797, 0.1619657427072525, 0.16886645555496216], [0.1621890515089035, 0.16536845266819, 0.17191286385059357, 0.16476605832576752, 0.17128661274909973, 0.16447694599628448], [0.14452065527439117, 0.1594235897064209, 0.1939833015203476, 0.15650929510593414, 0.1904372274875641, 0.1551259458065033], [0.1638912558555603, 0.1658715456724167, 0.16990260779857635, 0.16549746692180634, 0.16951943933963776, 0.16531774401664734], [0.14614610373973846, 0.16002759337425232, 0.19185763597488403, 0.157321035861969, 0.18861274421215057, 0.15603497624397278], [0.16471266746520996, 0.166110098361969, 0.1689395159482956, 0.16584649682044983, 0.16867142915725708, 0.16571980714797974]], [[0.17909099161624908, 0.16501595079898834, 0.16409580409526825, 0.16380535066127777, 0.1641412377357483, 0.16385069489479065], [0.15379582345485687, 0.1682978868484497, 0.16933709383010864, 0.16966769099235535, 0.16928550601005554, 0.1696159988641739], [0.15217909216880798, 0.16849654912948608, 0.1696731001138687, 0.1700475811958313, 0.16961467266082764, 0.16998901963233948], [0.15166978538036346, 0.16855883598327637, 0.1697789877653122, 0.17016741633415222, 0.16971838474273682, 0.1701066642999649], [0.15225878357887268, 0.16848677396774292, 0.16965653002262115, 0.17002883553504944, 0.16959843039512634, 0.16997061669826508], [0.15174923837184906, 0.16854910552501678, 0.16976244747638702, 0.17014868557453156, 0.1697021722793579, 0.1700882762670517]], [[0.17016854882240295, 0.16680458188056946, 0.1602773666381836, 0.16743184626102448, 0.16758312284946442, 0.1677345335483551], [0.16327732801437378, 0.16647808253765106, 0.1730663925409317, 0.16587163507938385, 0.16572605073451996, 0.16558058559894562], [0.14970357716083527, 0.16514097154140472, 0.2009400725364685, 0.16212214529514313, 0.1614041030406952, 0.16068921983242035], [0.16456793248653412, 0.16655640304088593, 0.17060410976409912, 0.1661807745695114, 0.16609053313732147, 0.16600032150745392], [0.16487878561019897, 0.16657406091690063, 0.17001570761203766, 0.16625404357910156, 0.16617713868618011, 0.16610026359558105], [0.16518977284431458, 0.16659125685691833, 0.16942887008190155, 0.16632689535617828, 0.16626335680484772, 0.16619983315467834]], [[0.18751408159732819, 0.1585371345281601, 0.15672947466373444, 0.15616105496883392, 0.18480856716632843, 0.15624971687793732], [0.16617418825626373, 0.1668563038110733, 0.16690301895141602, 0.1669178158044815, 0.1662331372499466, 0.16691550612449646], [0.16476641595363617, 0.16739778220653534, 0.1675790548324585, 0.16763654351234436, 0.1649925857782364, 0.16762755811214447], [0.16432179510593414, 0.16756859421730042, 0.16779272258281708, 0.16786380112171173, 0.1646004021167755, 0.16785269975662231], [0.18561485409736633, 0.159285306930542, 0.1576293408870697, 0.15710826218128204, 0.18317270278930664, 0.15718956291675568], [0.16439121961593628, 0.16754193603992462, 0.16775935888290405, 0.16782830655574799, 0.16466163098812103, 0.16781753301620483]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 2.2666666666666666}, "num_env_steps_sampled": 400, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.833471567145216e-06, "normalize_and_clip_actions": 8.468020890775322e-06, "get_actions": 3.993092954484048e-05, "listify_data_for_vector_env": 1.1043591803868008e-05, "tensor_to_numpy": 1.5795545209789733e-05, "remove_single_ts_time_rank_from_batch": 1.2455987183003085e-05}}, "connector_pipeline_timer": 0.00012170643429223872}, "env_to_module_connector": {"connector_pipeline_timer": 6.107362480333528e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.197174689115131e-06, "add_states_from_episodes_to_batch": 2.8349793483859366e-06, "batch_individual_items": 1.2677557043321637e-05, "numpy_to_tensor": 1.2605473289774927e-05, "add_observations_from_episodes_to_batch": 2.9219113985658946e-06}}}, "num_episodes_lifetime": 60, "rlmodule_inference_timer": 3.385972621934111e-05, "episode_duration_sec_mean": 0.005497365914440403, "episode_len_mean": 20.0, "num_episodes": 20, "episode_return_max": 13.5, "weights_seq_no": 3.0, "sample": 0.11682667700194288, "episode_len_max": 20, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "env_to_module_sum_episodes_length_in": 10.368205581254823, "env_to_module_sum_episodes_length_out": 10.368205581254823, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "env_reset_timer": 0.0005870129543589428, "num_env_steps_sampled_lifetime": 15400, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 2.2666666666666666, "env_step_timer": 1.4603866038655519e-05, "agent_episode_returns_mean": {"default_agent": 2.2666666666666666}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_min": -13.5, "time_between_sampling": 10.25201016609557}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "b13c4_00000", "date": "2025-08-11_18-04-46", "timestamp": 1754928286, "time_this_iter_s": 10.5277681350708, "time_total_s": 30.810054063796997, "pid": 10212, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x144efd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30.810054063796997, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 43.06666666666668, "ram_util_percent": 80.25999999999999}}
{"timers": {"training_iteration": 9.837816657094157, "restore_env_runners": 1.095281824551057e-05, "training_step": 9.837656166586997, "env_runner_sampling_timer": 1.9024300810003192, "learner_update_timer": 7.712270616438383, "synch_weights": 0.0014525777572692604, "restore_eval_env_runners": 3.532983261393383e-05, "evaluation_iteration": 0.12811372056474213, "synch_eval_env_connectors": 0.00014040211809333416, "synch_env_connectors": 4.701458127237857e-06}, "env_runners": {"rlmodule_inference_timer": 4.4664715496451466e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 9.14224750119134e-06, "numpy_to_tensor": 1.749157673449638e-05, "add_states_from_episodes_to_batch": 3.7716837766032275e-06, "batch_individual_items": 1.614647406950532e-05, "add_observations_from_episodes_to_batch": 3.504054709182115e-06}}, "connector_pipeline_timer": 7.894076417081121e-05}, "env_step_timer": 2.0950755624491737e-05, "episode_len_max": 20, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.0149082651483179e-05, "get_actions": 5.529073541811945e-05, "remove_single_ts_time_rank_from_batch": 1.4753874728816894e-05, "listify_data_for_vector_env": 1.2946851015803982e-05, "tensor_to_numpy": 1.9777976316641075e-05, "un_batch_to_individual_items": 8.1777451604866e-06}}, "connector_pipeline_timer": 0.00015527008330532612}, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "episode_duration_sec_mean": 0.007088635648135096, "time_between_sampling": 0.03639502157792803, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": -2.7799999999999994}, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": -2.7799999999999994}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "env_reset_timer": 5.954749481792207e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime": -1225000.0, "episode_return_min": -13.5, "episode_return_mean": -2.7799999999999994, "weights_seq_no": 3.0, "sample": 0.0069813536860698945, "num_episodes_lifetime": -61250.0, "num_env_steps_sampled_lifetime_throughput": 2776.772097150199}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17214096743823973, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009655495199317346, "add_observations_from_episodes_to_batch": 0.0009388619440633338, "add_columns_from_episodes_to_train_batch": 0.050255409014559, "add_time_dim_to_batch_and_zero_pad": 0.09896893154308396, "add_states_from_episodes_to_batch": 0.0038295588355863, "batch_individual_items": 0.008185449355003422, "numpy_to_tensor": 9.69114304628456e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"vf_loss": 0.3205227553844452, "mean_kl_loss": 8.236773282987997e-06, "num_module_steps_trained_lifetime": 23940, "num_module_steps_trained": 5985, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 998.6769017198101, "weights_seq_no": 4.0, "vf_explained_var": -0.0004627704620361328, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.24842841923236847, "curr_kl_coeff": 0.010098995640873909, "policy_loss": -0.00021855489467270672, "vf_loss_unclipped": 43.65323257446289, "entropy": 0.6848403215408325, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 770.970658816762}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.6769017198101, "weights_seq_no": 4.0, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 23940, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 770.9838100526165}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 144000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 47880, "num_env_steps_trained_lifetime_throughput": 4643.095328644807, "num_module_steps_trained_throughput": 29377818.92898231, "num_module_steps_trained_lifetime_throughput": 13206596.82406634}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.25029122829437256, "use_intrinsic_rewards": 1.0, "diff_num_grad_updates_vs_sampler_policy": 21.0, "mean_kl_loss": 7.425343937939033e-06, "policy_loss": -0.0002085951273329556, "vf_loss_unclipped": 43.27560806274414, "num_module_steps_trained_lifetime": 143640, "entropy": 0.6848663687705994, "vf_loss": 0.32289984822273254, "vf_explained_var": 0.005145668983459473, "num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.847060245087, "weights_seq_no": 24.0}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.847060245087, "weights_seq_no": 24.0, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 21.0, "num_module_steps_trained_lifetime": 143640}, "__all_modules__": {"num_env_steps_trained_lifetime": 864000, "num_module_steps_trained_lifetime": 287280, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 57741.995625030926}}}, "IntrinsicAttentionMask": [[[0.178679957985878, 0.15744560956954956, 0.17770403623580933, 0.15566383302211761, 0.17569300532341003, 0.15481363236904144], [0.162385955452919, 0.1699358969926834, 0.16270573437213898, 0.17063206434249878, 0.16337227821350098, 0.17096807062625885], [0.1779702603816986, 0.15799199044704437, 0.1770552694797516, 0.15630866587162018, 0.17516882717609406, 0.15550504624843597], [0.1609342396259308, 0.1710422784090042, 0.16135917603969574, 0.17198215425014496, 0.16224583983421326, 0.17243625223636627], [0.17649629712104797, 0.1591261625289917, 0.17570650577545166, 0.15764999389648438, 0.17407652735710144, 0.15694454312324524], [0.16023674607276917, 0.1715734452009201, 0.1607116311788559, 0.17263178527355194, 0.1617029756307602, 0.1731434017419815]], [[0.18751704692840576, 0.15853965282440186, 0.18470661342144012, 0.1561635285615921, 0.15682093799114227, 0.1562522053718567], [0.16617420315742493, 0.1668563187122345, 0.16623544692993164, 0.1669178307056427, 0.16690072417259216, 0.16691552102565765], [0.18554328382015228, 0.1593165099620819, 0.18301694095134735, 0.15714725852012634, 0.15774774551391602, 0.1572282612323761], [0.16432185471057892, 0.167568638920784, 0.1646113246679306, 0.1678638458251953, 0.16778166592121124, 0.1678527444601059], [0.16483597457408905, 0.16737107932567596, 0.16506245732307434, 0.16760104894638062, 0.16753704845905304, 0.167592391371727], [0.16439124941825867, 0.167541965842247, 0.16467224061489105, 0.16782833635807037, 0.1677486151456833, 0.16781756281852722]], [[0.17862798273563385, 0.17813949286937714, 0.17765234410762787, 0.1556185632944107, 0.1551930010318756, 0.15476860105991364], [0.1782761961221695, 0.17780299484729767, 0.17733106017112732, 0.15594345331192017, 0.15552952885627747, 0.1551167070865631], [0.17792439460754395, 0.17746642231941223, 0.17700964212417603, 0.1562683880329132, 0.15586617588996887, 0.15546497702598572], [0.16092339158058167, 0.1611357182264328, 0.16134829819202423, 0.17197056114673615, 0.17219744622707367, 0.17242462933063507], [0.16057321429252625, 0.16079802811145782, 0.16102313995361328, 0.17229388654232025, 0.17253509163856506, 0.17277665436267853], [0.16022314131259918, 0.16046038269996643, 0.16069796681404114, 0.172617107629776, 0.17287270724773407, 0.17312867939472198]], [[0.18237483501434326, 0.18171340227127075, 0.15243396162986755, 0.1789899617433548, 0.15252050757408142, 0.1519673466682434], [0.1820257157087326, 0.18138016760349274, 0.15274833142757416, 0.17872154712677002, 0.15283311903476715, 0.15229110419750214], [0.16519193351268768, 0.1652485877275467, 0.1680118441581726, 0.16548429429531097, 0.16800284385681152, 0.16806046664714813], [0.18057480454444885, 0.17999465763568878, 0.15405583381652832, 0.1776033341884613, 0.15413330495357513, 0.15363809466362], [0.16524602472782135, 0.1653006225824356, 0.16796249151229858, 0.16552773118019104, 0.16795381903648376, 0.16800931096076965], [0.16489987075328827, 0.1649676412343979, 0.16827844083309174, 0.16524961590766907, 0.1682676374912262, 0.16833679378032684]], [[0.17862798273563385, 0.17813949286937714, 0.17765234410762787, 0.1556185632944107, 0.1551930010318756, 0.15476860105991364], [0.1782761961221695, 0.17780299484729767, 0.17733106017112732, 0.15594345331192017, 0.15552952885627747, 0.1551167070865631], [0.17792439460754395, 0.17746642231941223, 0.17700964212417603, 0.1562683880329132, 0.15586617588996887, 0.15546497702598572], [0.16092337667942047, 0.1611357033252716, 0.16134829819202423, 0.17197054624557495, 0.17219743132591248, 0.17242461442947388], [0.16057321429252625, 0.16079802811145782, 0.16102313995361328, 0.17229388654232025, 0.17253509163856506, 0.17277665436267853], [0.16022314131259918, 0.16046038269996643, 0.16069796681404114, 0.172617107629776, 0.17287270724773407, 0.17312867939472198]], [[0.1666826754808426, 0.16662296652793884, 0.16668827831745148, 0.16662858426570892, 0.16668806970119476, 0.1666894257068634], [0.15932312607765198, 0.18641431629657745, 0.15698781609535217, 0.1836819052696228, 0.157074972987175, 0.156517893075943], [0.1673406958580017, 0.1648232638835907, 0.16757938265800476, 0.16505834460258484, 0.16757041215896606, 0.16762788593769073], [0.16004228591918945, 0.18450480699539185, 0.15791603922843933, 0.1820535659790039, 0.15799544751644135, 0.15748782455921173], [0.16731607913970947, 0.16489069163799286, 0.16754595935344696, 0.16511724889278412, 0.16753731667995453, 0.16759267449378967], [0.16747355461120605, 0.164459228515625, 0.16775982081890106, 0.16474033892154694, 0.1677490472793579, 0.16781799495220184]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 1.35}, "num_env_steps_sampled": 400, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.636563892681134e-06, "normalize_and_clip_actions": 8.033046858265973e-06, "get_actions": 3.586242110296473e-05, "listify_data_for_vector_env": 1.0625287265050695e-05, "tensor_to_numpy": 1.5118837552645194e-05, "remove_single_ts_time_rank_from_batch": 1.2068354707958281e-05}}, "connector_pipeline_timer": 0.00011489452994242322}, "env_to_module_connector": {"connector_pipeline_timer": 5.9277295622430895e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.0096194596987625e-06, "add_states_from_episodes_to_batch": 2.7629708201405076e-06, "batch_individual_items": 1.2477117847286282e-05, "numpy_to_tensor": 1.1895237952982817e-05, "add_observations_from_episodes_to_batch": 2.8189929264533524e-06}}}, "num_episodes_lifetime": 80, "rlmodule_inference_timer": 3.09851498638281e-05, "episode_duration_sec_mean": 0.005440065050788689, "episode_len_mean": 20.0, "num_episodes": 20, "episode_return_max": 13.5, "weights_seq_no": 4.0, "sample": 0.11681660439201236, "episode_len_max": 20, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "env_to_module_sum_episodes_length_in": 10.368237912813044, "env_to_module_sum_episodes_length_out": 10.368237912813044, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "env_reset_timer": 0.0005845978255120572, "num_env_steps_sampled_lifetime": 20400, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 1.35, "env_step_timer": 1.3769612727462333e-05, "agent_episode_returns_mean": {"default_agent": 1.35}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_min": -13.5, "time_between_sampling": 10.256685712765577}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "b13c4_00000", "date": "2025-08-11_18-04-57", "timestamp": 1754928297, "time_this_iter_s": 10.816269159317017, "time_total_s": 41.626323223114014, "pid": 10212, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x144efd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 41.626323223114014, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 46.075, "ram_util_percent": 82.21875}}
{"timers": {"training_iteration": 9.840037449273703, "restore_env_runners": 1.0909540858553955e-05, "training_step": 9.839876003251655, "env_runner_sampling_timer": 1.8989443614403185, "learner_update_timer": 7.71817464860379, "synch_weights": 0.001447697819151174, "restore_eval_env_runners": 3.5121944009675644e-05, "evaluation_iteration": 0.12808698168827815, "synch_eval_env_connectors": 0.0001407276863337029, "synch_env_connectors": 4.697363546816633e-06}, "env_runners": {"rlmodule_inference_timer": 3.176426087115567e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.0411504577139156e-06, "numpy_to_tensor": 1.2873103118650014e-05, "add_states_from_episodes_to_batch": 2.7603061991266316e-06, "batch_individual_items": 1.2781566140916892e-05, "add_observations_from_episodes_to_batch": 2.8341805665170437e-06}}, "connector_pipeline_timer": 6.057069745078482e-05}, "env_step_timer": 1.4144640552507824e-05, "episode_len_max": 20, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.119906965388175e-06, "get_actions": 3.929215085273124e-05, "remove_single_ts_time_rank_from_batch": 1.2149289226578927e-05, "listify_data_for_vector_env": 1.0555754833942642e-05, "tensor_to_numpy": 1.5350248170043933e-05, "un_batch_to_individual_items": 6.743349809238012e-06}}, "connector_pipeline_timer": 0.0001189287033057181}, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "episode_duration_sec_mean": 0.005309657993260772, "time_between_sampling": 0.035684148144459645, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": -2.3000000000000007}, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": -2.3000000000000007}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "env_reset_timer": 5.13698305398559e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime": -1842500.0, "episode_return_min": -13.5, "episode_return_mean": -2.3000000000000007, "weights_seq_no": 4.0, "sample": 0.006322774053622413, "num_episodes_lifetime": -92125.0, "num_env_steps_sampled_lifetime_throughput": 3182.4371760927716}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17195841026365527, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009647919417283374, "add_observations_from_episodes_to_batch": 0.0009382224843741604, "add_columns_from_episodes_to_train_batch": 0.050181954924014435, "add_time_dim_to_batch_and_zero_pad": 0.09887583638765672, "add_states_from_episodes_to_batch": 0.003828791996320125, "batch_individual_items": 0.008179776942118992, "numpy_to_tensor": 9.658981584991212e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"vf_loss": 0.32050931453704834, "mean_kl_loss": 1.4203001228452194e-05, "num_module_steps_trained_lifetime": 29925, "num_module_steps_trained": 5985, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 998.6075885025957, "weights_seq_no": 5.0, "vf_explained_var": 0.0002281665802001953, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.24829746782779694, "curr_kl_coeff": 0.0050494978204369545, "policy_loss": -0.0003399848937988281, "vf_loss_unclipped": 42.79081726074219, "entropy": 0.6842067241668701, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 767.1129866877558}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.6075885025957, "weights_seq_no": 5.0, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 29925, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 767.1255970565769}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 180000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 59850, "num_env_steps_trained_lifetime_throughput": 4619.720982534135, "num_module_steps_trained_throughput": 28583369.710898142, "num_module_steps_trained_lifetime_throughput": 13168686.581755344}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.2498105764389038, "use_intrinsic_rewards": 1.0, "diff_num_grad_updates_vs_sampler_policy": 26.0, "mean_kl_loss": 1.286175574932713e-05, "policy_loss": -0.0003248136199545115, "vf_loss_unclipped": 42.527374267578125, "num_module_steps_trained_lifetime": 179550, "entropy": 0.6842408180236816, "vf_loss": 0.32242968678474426, "vf_explained_var": 0.005243957042694092, "num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.7394089995611, "weights_seq_no": 30.0}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.7394089995611, "weights_seq_no": 30.0, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 26.0, "num_module_steps_trained_lifetime": 179550}, "__all_modules__": {"num_env_steps_trained_lifetime": 1080000, "num_module_steps_trained_lifetime": 359100, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 56927.84046808842}}}, "IntrinsicAttentionMask": [[[0.1713179498910904, 0.16793125867843628, 0.16135995090007782, 0.16856276988983154, 0.16871505975723267, 0.16211307048797607], [0.16218999028205872, 0.1653694212436676, 0.17191386222839355, 0.16476701200008392, 0.16462239623069763, 0.171137273311615], [0.14454281330108643, 0.15944804251194, 0.19401302933692932, 0.15653330087661743, 0.1558399796485901, 0.18962283432483673], [0.16389159858226776, 0.16587191820144653, 0.1699029952287674, 0.165497824549675, 0.1654079556465149, 0.169427752494812], [0.1643020361661911, 0.16599136590957642, 0.16942098736763, 0.16567248106002808, 0.16559584438800812, 0.16901728510856628], [0.1465567648410797, 0.16019168496131897, 0.19137169420719147, 0.15753509104251862, 0.1569025069475174, 0.18744231760501862]], [[0.18745656311511993, 0.18677669763565063, 0.15668141841888428, 0.1561131626367569, 0.15677036345005035, 0.1562017947435379], [0.18698357045650482, 0.1863204389810562, 0.15690875053405762, 0.15635226666927338, 0.15699586272239685, 0.15643906593322754], [0.16476599872112274, 0.164822518825531, 0.16757862269878387, 0.16763611137866974, 0.16756965219974518, 0.16762712597846985], [0.1643211543560028, 0.16439074277877808, 0.16779205203056335, 0.167863130569458, 0.16778095066547394, 0.1678520292043686], [0.16483554244041443, 0.16489000618457794, 0.16754525899887085, 0.167600616812706, 0.16753661632537842, 0.16759195923805237], [0.16439057886600494, 0.16445815563201904, 0.16775871813297272, 0.16782766580581665, 0.16774794459342957, 0.1678168922662735]], [[0.1724797785282135, 0.16907012462615967, 0.1624542474746704, 0.16291795670986176, 0.16306515038013458, 0.1700126975774765], [0.16111424565315247, 0.16427259147167206, 0.17077362537384033, 0.17030100524425507, 0.17015153169631958, 0.1633870005607605], [0.13966381549835205, 0.15406592190265656, 0.18746417760849, 0.18485604226589203, 0.18403729796409607, 0.14991271495819092], [0.14113660156726837, 0.15481778979301453, 0.1862737089395523, 0.18382960557937622, 0.18306195735931396, 0.15088032186031342], [0.1416051834821701, 0.15505535900592804, 0.18589641153812408, 0.1835039258003235, 0.1827523410320282, 0.15118680894374847], [0.1642381101846695, 0.1656315177679062, 0.16845278441905975, 0.16824974119663239, 0.16818545758724213, 0.16524234414100647]], [[0.16793783009052277, 0.1682521402835846, 0.1555313616991043, 0.16956478357315063, 0.16919858753681183, 0.16951526701450348], [0.1679893434047699, 0.1683173030614853, 0.15506549179553986, 0.16968727111816406, 0.16930504143238068, 0.1696355789899826], [0.16558919847011566, 0.16535145044326782, 0.17564831674098969, 0.1643669605255127, 0.16464024782180786, 0.16440385580062866], [0.1682005524635315, 0.1685853749513626, 0.15314128994941711, 0.17019419372081757, 0.16974510252475739, 0.17013345658779144], [0.16814225912094116, 0.16851124167442322, 0.15367461740970612, 0.17005351185798645, 0.16962306201457977, 0.1699952930212021], [0.16819269955158234, 0.16857537627220154, 0.1532132625579834, 0.1701752096414566, 0.16972863674163818, 0.17011480033397675]], [[0.1724797934293747, 0.16907013952732086, 0.1624542623758316, 0.16291797161102295, 0.16306516528129578, 0.1700127124786377], [0.16111426055431366, 0.16427259147167206, 0.17077362537384033, 0.17030100524425507, 0.17015153169631958, 0.1633870005607605], [0.13966381549835205, 0.15406590700149536, 0.18746417760849, 0.18485604226589203, 0.18403729796409607, 0.14991271495819092], [0.14113660156726837, 0.15481778979301453, 0.1862737089395523, 0.18382960557937622, 0.18306195735931396, 0.15088032186031342], [0.1416051834821701, 0.15505535900592804, 0.18589641153812408, 0.1835039258003235, 0.1827523410320282, 0.15118680894374847], [0.1642381101846695, 0.1656315177679062, 0.16845278441905975, 0.16824974119663239, 0.16818545758724213, 0.16524234414100647]], [[0.18241126835346222, 0.15422289073467255, 0.17967736721038818, 0.15191145241260529, 0.17977936565876007, 0.15199771523475647], [0.1662852019071579, 0.16696779429912567, 0.1663465052843094, 0.16702933609485626, 0.16634419560432434, 0.16702702641487122], [0.18095366656780243, 0.1553756296634674, 0.1784898340702057, 0.15326005220413208, 0.1785818189382553, 0.15333904325962067], [0.1648462414741516, 0.1681033968925476, 0.1651366502046585, 0.16839954257011414, 0.16512572765350342, 0.16838839650154114], [0.18100842833518982, 0.1553322970867157, 0.17853450775146484, 0.15320931375026703, 0.1786268800497055, 0.1532885730266571], [0.1649002730846405, 0.16806074976921082, 0.16518212854862213, 0.1683480143547058, 0.1651715338230133, 0.16833721101284027]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 1.4}, "num_env_steps_sampled": 400, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.636059264373969e-06, "normalize_and_clip_actions": 8.062126103576113e-06, "get_actions": 3.678814138901386e-05, "listify_data_for_vector_env": 1.1128244528085437e-05, "tensor_to_numpy": 1.5184477062225113e-05, "remove_single_ts_time_rank_from_batch": 1.2040294507678895e-05}}, "connector_pipeline_timer": 0.00011633681708848646}, "env_to_module_connector": {"connector_pipeline_timer": 5.894941878083379e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.9399592235454854e-06, "add_states_from_episodes_to_batch": 2.697597103768622e-06, "batch_individual_items": 1.2295596166537569e-05, "numpy_to_tensor": 1.2127394897412882e-05, "add_observations_from_episodes_to_batch": 2.8268075467929527e-06}}}, "num_episodes_lifetime": 100, "rlmodule_inference_timer": 3.19452574896965e-05, "episode_duration_sec_mean": 0.0054012937017250805, "episode_len_mean": 20.0, "num_episodes": 20, "episode_return_max": 13.5, "weights_seq_no": 5.0, "sample": 0.11680259251816394, "episode_len_max": 20, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "env_to_module_sum_episodes_length_in": 10.368238387501162, "env_to_module_sum_episodes_length_out": 10.368238387501162, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "env_reset_timer": 0.0005822397678783466, "num_env_steps_sampled_lifetime": 25400, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 1.4, "env_step_timer": 1.408404396374005e-05, "agent_episode_returns_mean": {"default_agent": 1.4}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_min": -13.5, "time_between_sampling": 10.255017424388049}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "b13c4_00000", "date": "2025-08-11_18-05-07", "timestamp": 1754928307, "time_this_iter_s": 10.186787128448486, "time_total_s": 51.8131103515625, "pid": 10212, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x144efd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 51.8131103515625, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 40.43571428571429, "ram_util_percent": 82.38571428571427}}
{"timers": {"training_iteration": 9.837239068950376, "restore_env_runners": 1.0861695043241221e-05, "training_step": 9.83707717405852, "env_runner_sampling_timer": 1.8956435061564376, "learner_update_timer": 7.718877562537993, "synch_weights": 0.001442454591129759, "restore_eval_env_runners": 3.489322492027772e-05, "evaluation_iteration": 0.1280473531213497, "synch_eval_env_connectors": 0.00014041082871624967, "synch_env_connectors": 4.699549773449545e-06}, "env_runners": {"rlmodule_inference_timer": 3.1909572555609866e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.013244084235016e-06, "numpy_to_tensor": 1.2989152762416224e-05, "add_states_from_episodes_to_batch": 2.7655978939868625e-06, "batch_individual_items": 1.2814646557855767e-05, "add_observations_from_episodes_to_batch": 2.8408720992482004e-06}}, "connector_pipeline_timer": 6.08068171500517e-05}, "env_step_timer": 1.4257657256348167e-05, "episode_len_max": 20, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.185005235302325e-06, "get_actions": 3.962134616820243e-05, "remove_single_ts_time_rank_from_batch": 1.2276185290574095e-05, "listify_data_for_vector_env": 1.062467650075221e-05, "tensor_to_numpy": 1.542165494986447e-05, "un_batch_to_individual_items": 6.777869636297463e-06}}, "connector_pipeline_timer": 0.00011975181283442519}, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "episode_duration_sec_mean": 0.005355078641790895, "time_between_sampling": 0.0351680826498099, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": -1.5}, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": -1.5}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "env_reset_timer": 4.67460051441747e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime": -2460000.0, "episode_return_min": -13.5, "episode_return_mean": -1.5, "weights_seq_no": 5.0, "sample": 0.005759568827606749, "num_episodes_lifetime": -123000.0, "num_env_steps_sampled_lifetime_throughput": 3189.882778849795}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.171775756580989, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009646617723153604, "add_observations_from_episodes_to_batch": 0.0009375594295308228, "add_columns_from_episodes_to_train_batch": 0.050094067454456416, "add_time_dim_to_batch_and_zero_pad": 0.09878653594365717, "add_states_from_episodes_to_batch": 0.0038310115757183346, "batch_individual_items": 0.008174915423250337, "numpy_to_tensor": 9.653432741761548e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"vf_loss": 0.320512592792511, "mean_kl_loss": 2.1029572963016108e-05, "num_module_steps_trained_lifetime": 35910, "num_module_steps_trained": 5985, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 998.5423314844973, "weights_seq_no": 6.0, "vf_explained_var": 0.0007576942443847656, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.24829305708408356, "curr_kl_coeff": 0.0025247489102184772, "policy_loss": -0.00034788186894729733, "vf_loss_unclipped": 39.792503356933594, "entropy": 0.6835735440254211, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 763.6374456803077}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.5423314844973, "weights_seq_no": 6.0, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 35910, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 763.649491147633}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 216000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 71820, "num_env_steps_trained_lifetime_throughput": 4598.636401318071, "num_module_steps_trained_throughput": 27791513.498490438, "num_module_steps_trained_lifetime_throughput": 13127757.622320885}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.24940702319145203, "use_intrinsic_rewards": 1.0, "diff_num_grad_updates_vs_sampler_policy": 31.0, "mean_kl_loss": 1.95741140487371e-05, "policy_loss": -0.0003363422292750329, "vf_loss_unclipped": 39.841400146484375, "num_module_steps_trained_lifetime": 215460, "entropy": 0.6836049556732178, "vf_loss": 0.3219238221645355, "vf_explained_var": 0.005592703819274902, "num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.6644392492373, "weights_seq_no": 36.0}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.6644392492373, "weights_seq_no": 36.0, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 31.0, "num_module_steps_trained_lifetime": 215460}, "__all_modules__": {"num_env_steps_trained_lifetime": 1296000, "num_module_steps_trained_lifetime": 430920, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 56067.301003517496}}}, "IntrinsicAttentionMask": [[[0.17248523235321045, 0.16907547414302826, 0.1692282259464264, 0.16292309761047363, 0.16307030618190765, 0.16321763396263123], [0.16111910343170166, 0.16427753865718842, 0.16413335502147675, 0.17030613124370575, 0.17015665769577026, 0.17000731825828552], [0.1616235077381134, 0.16449858248233795, 0.1643674522638321, 0.16997231543064117, 0.16983680427074432, 0.16970141232013702], [0.1412333846092224, 0.1549239456653595, 0.1542769819498062, 0.18395566940307617, 0.18318748474121094, 0.1824224889278412], [0.14169856905937195, 0.15515761077404022, 0.1545221358537674, 0.18362495303153992, 0.18287287652492523, 0.18212386965751648], [0.14216472208499908, 0.15539102256298065, 0.15476705133914948, 0.18329408764839172, 0.182558074593544, 0.18182501196861267]], [[0.18751704692840576, 0.15853965282440186, 0.18470661342144012, 0.1561635285615921, 0.15682093799114227, 0.1562522053718567], [0.16617420315742493, 0.1668563187122345, 0.16623544692993164, 0.1669178307056427, 0.16690072417259216, 0.16691552102565765], [0.18554328382015228, 0.15931649506092072, 0.18301695585250854, 0.15714725852012634, 0.15774774551391602, 0.1572282612323761], [0.16432183980941772, 0.1675686240196228, 0.1646113246679306, 0.16786383092403412, 0.16778165102005005, 0.1678527295589447], [0.16483597457408905, 0.16737107932567596, 0.16506245732307434, 0.16760104894638062, 0.16753704845905304, 0.167592391371727], [0.16439123451709747, 0.167541965842247, 0.16467222571372986, 0.16782833635807037, 0.1677486151456833, 0.16781756281852722]], [[0.18244430422782898, 0.16076260805130005, 0.16032299399375916, 0.1798863410949707, 0.15850864350795746, 0.15807518362998962], [0.1611923724412918, 0.16868682205677032, 0.16885283589363098, 0.1620119959115982, 0.1695445477962494, 0.1697114109992981], [0.16074873507022858, 0.1688498556613922, 0.16902963817119598, 0.1616332232952118, 0.16977891325950623, 0.16995969414710999], [0.1800018846988678, 0.1616838425397873, 0.1613086760044098, 0.17785871028900146, 0.1597587615251541, 0.15938808023929596], [0.1589125096797943, 0.16952335834503174, 0.16976070404052734, 0.1600630134344101, 0.1707506775856018, 0.1709897369146347], [0.15847256779670715, 0.16968443989753723, 0.1699357032775879, 0.15968620777130127, 0.1709839403629303, 0.17123711109161377]], [[0.1751382201910019, 0.1612454205751419, 0.17650459706783295, 0.16250339150428772, 0.1621524691581726, 0.1624559462070465], [0.15915507078170776, 0.17150744795799255, 0.1580403745174408, 0.1703062355518341, 0.17063955962657928, 0.17035122215747833], [0.17667192220687866, 0.1602678745985031, 0.1782982051372528, 0.1617431640625, 0.1613313853740692, 0.1616874635219574], [0.1606302112340927, 0.17055413126945496, 0.1597273051738739, 0.16959545016288757, 0.1698615998029709, 0.16963137686252594], [0.1602192223072052, 0.17081958055496216, 0.1592569500207901, 0.16979366540908813, 0.17007844150066376, 0.16983211040496826], [0.16057465970516205, 0.17059001326560974, 0.15966373682022095, 0.1696222424507141, 0.16989091038703918, 0.16965852677822113]], [[0.17365965247154236, 0.16341789066791534, 0.17038047313690186, 0.16403241455554962, 0.16418062150478363, 0.1643289476633072], [0.13461343944072723, 0.1824759542942047, 0.14808866381645203, 0.1790802925825119, 0.17827275395393372, 0.17746886610984802], [0.1606534719467163, 0.16951310634613037, 0.1633809357881546, 0.16895216703414917, 0.16881747543811798, 0.16868290305137634], [0.13681970536708832, 0.18133345246315002, 0.14945568144321442, 0.17820687592029572, 0.17746269702911377, 0.17672160267829895], [0.1373545378446579, 0.18105782568454742, 0.14978498220443726, 0.17799557745456696, 0.17726656794548035, 0.1765405237674713], [0.13789092004299164, 0.18078190088272095, 0.15011440217494965, 0.17778384685516357, 0.17706996202468872, 0.17635893821716309]], [[0.1666623204946518, 0.16666366159915924, 0.16666792333126068, 0.16666927933692932, 0.16666771471500397, 0.1666690707206726], [0.16661910712718964, 0.16663388907909393, 0.16668052971363068, 0.16669531166553497, 0.16667822003364563, 0.16669300198554993], [0.16648276150226593, 0.16653986275196075, 0.1667202115058899, 0.16677740216255188, 0.16671128571033478, 0.16676846146583557], [0.16643957793712616, 0.16651009023189545, 0.1667327880859375, 0.16680341958999634, 0.16672176122665405, 0.1667923778295517], [0.16648949682712555, 0.16654451191425323, 0.1667182594537735, 0.16677333414554596, 0.16670964658260345, 0.16676472127437592], [0.16644632816314697, 0.16651473939418793, 0.1667308360338211, 0.1667993664741516, 0.16672013700008392, 0.16678865253925323]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 1.6}, "num_env_steps_sampled": 400, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.641938161895021e-06, "normalize_and_clip_actions": 8.083324079624858e-06, "get_actions": 3.668262588358645e-05, "listify_data_for_vector_env": 1.075243040386899e-05, "tensor_to_numpy": 1.525624302267089e-05, "remove_single_ts_time_rank_from_batch": 1.1957370275310178e-05}}, "connector_pipeline_timer": 0.00011603582529588961}, "env_to_module_connector": {"connector_pipeline_timer": 5.925830125171144e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.043798392905128e-06, "add_states_from_episodes_to_batch": 2.6863210131467107e-06, "batch_individual_items": 1.2497495593269837e-05, "numpy_to_tensor": 1.2160684128630237e-05, "add_observations_from_episodes_to_batch": 2.830176584317457e-06}}}, "num_episodes_lifetime": 120, "rlmodule_inference_timer": 3.099321796609628e-05, "episode_duration_sec_mean": 0.005399446610826999, "episode_len_mean": 20.0, "num_episodes": 20, "episode_return_max": 13.5, "weights_seq_no": 6.0, "sample": 0.11680105409328666, "episode_len_max": 20, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "env_to_module_sum_episodes_length_in": 10.368238394470474, "env_to_module_sum_episodes_length_out": 10.368238394470474, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "env_reset_timer": 0.0005796777896707525, "num_env_steps_sampled_lifetime": 30400, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 1.6, "env_step_timer": 1.393835087515247e-05, "agent_episode_returns_mean": {"default_agent": 1.6}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_min": -13.5, "time_between_sampling": 10.248362960564032}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "b13c4_00000", "date": "2025-08-11_18-05-17", "timestamp": 1754928317, "time_this_iter_s": 9.688405990600586, "time_total_s": 61.501516342163086, "pid": 10212, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x144efd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 61.501516342163086, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 40.99285714285714, "ram_util_percent": 82.10714285714286}}
{"timers": {"training_iteration": 9.84059549284042, "restore_env_runners": 1.0818497682909455e-05, "training_step": 9.840432781487785, "env_runner_sampling_timer": 1.8979065873458767, "learner_update_timer": 7.720008779832764, "synch_weights": 0.0014382908742219891, "restore_eval_env_runners": 3.465929354674168e-05, "evaluation_iteration": 0.12802115584039245, "synch_eval_env_connectors": 0.0001405629709286486, "synch_env_connectors": 4.703804956996139e-06}, "env_runners": {"rlmodule_inference_timer": 4.595006915441371e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 9.119437724662274e-06, "numpy_to_tensor": 1.8230060204485565e-05, "add_states_from_episodes_to_batch": 3.402778936631542e-06, "batch_individual_items": 1.6078545233475906e-05, "add_observations_from_episodes_to_batch": 3.6532875111730996e-06}}, "connector_pipeline_timer": 7.733134933442194e-05}, "env_step_timer": 1.9911493359364944e-05, "episode_len_max": 20, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.0261075374565465e-05, "get_actions": 5.839092662926153e-05, "remove_single_ts_time_rank_from_batch": 1.4929395576704079e-05, "listify_data_for_vector_env": 1.3847864580364088e-05, "tensor_to_numpy": 2.108568689474943e-05, "un_batch_to_individual_items": 9.12544656455163e-06}}, "connector_pipeline_timer": 0.00016190183185723706}, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "episode_duration_sec_mean": 0.007281137849204243, "time_between_sampling": 0.033360776985176616, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": -1.8199999999999996}, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": -1.8199999999999996}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "env_reset_timer": 6.147112644130845e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime": -3077500.0, "episode_return_min": -13.5, "episode_return_mean": -1.8199999999999996, "weights_seq_no": 6.0, "sample": 0.007323407618213137, "num_episodes_lifetime": -153875.0, "num_env_steps_sampled_lifetime_throughput": 2789.4586816945553}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17165504651572427, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009649316546642018, "add_observations_from_episodes_to_batch": 0.0009370130049093598, "add_columns_from_episodes_to_train_batch": 0.050028404699662514, "add_time_dim_to_batch_and_zero_pad": 0.09872680558392423, "add_states_from_episodes_to_batch": 0.003834363959968229, "batch_individual_items": 0.008174124179995136, "numpy_to_tensor": 9.699023477919736e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"vf_loss": 0.3205125629901886, "mean_kl_loss": 1.4208799257175997e-05, "num_module_steps_trained_lifetime": 41895, "num_module_steps_trained": 5985, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 998.4808932973482, "weights_seq_no": 7.0, "vf_explained_var": 0.00040328502655029297, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.24863725900650024, "curr_kl_coeff": 0.0012623744551092386, "policy_loss": -5.136059371579904e-06, "vf_loss_unclipped": 42.78114700317383, "entropy": 0.6825628876686096, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 760.2918626137665}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.4808932973482, "weights_seq_no": 7.0, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 41895, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 760.3033181208173}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 252000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 83790, "num_env_steps_trained_lifetime_throughput": 4578.3255357578355, "num_module_steps_trained_throughput": 27012129.567804255, "num_module_steps_trained_lifetime_throughput": 13078862.552039776}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.24966511130332947, "use_intrinsic_rewards": 1.0, "diff_num_grad_updates_vs_sampler_policy": 36.0, "mean_kl_loss": 1.4425614608626347e-05, "policy_loss": -3.959056357416557e-06, "vf_loss_unclipped": 42.52911376953125, "num_module_steps_trained_lifetime": 251370, "entropy": 0.6825567483901978, "vf_loss": 0.3218275010585785, "vf_explained_var": 0.005326449871063232, "num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.6122293241576, "weights_seq_no": 42.0}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.6122293241576, "weights_seq_no": 42.0, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 36.0, "num_module_steps_trained_lifetime": 251370}, "__all_modules__": {"num_env_steps_trained_lifetime": 1512000, "num_module_steps_trained_lifetime": 502740, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 55189.635058948224}}}, "IntrinsicAttentionMask": [[[0.17016854882240295, 0.16680458188056946, 0.1602773517370224, 0.16743184626102448, 0.16758312284946442, 0.1677345186471939], [0.16327734291553497, 0.16647808253765106, 0.1730663925409317, 0.16587163507938385, 0.16572605073451996, 0.1655806005001068], [0.14970357716083527, 0.16514095664024353, 0.2009400725364685, 0.16212216019630432, 0.1614041030406952, 0.16068921983242035], [0.16456791758537292, 0.16655638813972473, 0.17060410976409912, 0.16618075966835022, 0.16609051823616028, 0.16600030660629272], [0.16487877070903778, 0.16657404601573944, 0.17001570761203766, 0.16625404357910156, 0.16617713868618011, 0.16610026359558105], [0.16518977284431458, 0.16659125685691833, 0.16942887008190155, 0.16632689535617828, 0.16626334190368652, 0.16619983315467834]], [[0.17297416925430298, 0.172346830368042, 0.14457663893699646, 0.16976377367973328, 0.1704784482717514, 0.16986015439033508], [0.17283868789672852, 0.1722257137298584, 0.14503896236419678, 0.16970129311084747, 0.17039981484413147, 0.16979549825191498], [0.1660502701997757, 0.16610722243785858, 0.16888482868671417, 0.16634415090084076, 0.1662781983613968, 0.16633524000644684], [0.17227351665496826, 0.17172002792358398, 0.14697366952896118, 0.16943864524364471, 0.17007024586200714, 0.16952385008335114], [0.172431081533432, 0.17186109721660614, 0.14643332362174988, 0.16951218247413635, 0.1701623797416687, 0.16959989070892334], [0.17229481041431427, 0.1717391014099121, 0.14690056443214417, 0.1694485992193222, 0.1700827032327652, 0.1695341318845749]], [[0.1724797934293747, 0.16907013952732086, 0.1624542623758316, 0.16291797161102295, 0.16306515038013458, 0.1700127124786377], [0.16111426055431366, 0.16427259147167206, 0.17077362537384033, 0.17030100524425507, 0.17015153169631958, 0.1633870005607605], [0.13966381549835205, 0.15406590700149536, 0.18746417760849, 0.18485605716705322, 0.18403729796409607, 0.14991271495819092], [0.14113660156726837, 0.15481777489185333, 0.1862737089395523, 0.18382962048053741, 0.18306195735931396, 0.15088032186031342], [0.1416051685810089, 0.15505534410476685, 0.18589641153812408, 0.1835039258003235, 0.1827523410320282, 0.15118680894374847], [0.1642381101846695, 0.1656315177679062, 0.16845278441905975, 0.16824974119663239, 0.16818545758724213, 0.16524234414100647]], [[0.166692852973938, 0.16669419407844543, 0.16663740575313568, 0.16663874685764313, 0.16663718223571777, 0.1666996031999588], [0.16695302724838257, 0.16696782410144806, 0.16634653508663177, 0.1663612723350525, 0.16634422540664673, 0.1670270562171936], [0.15595489740371704, 0.1554413139820099, 0.17856529355049133, 0.1779772788286209, 0.17865733802318573, 0.1534038782119751], [0.15621742606163025, 0.15571552515029907, 0.17827540636062622, 0.1777026355266571, 0.1783650517463684, 0.15372401475906372], [0.15591388940811157, 0.15539848804473877, 0.17861057817935944, 0.1780201643705368, 0.17870299518108368, 0.15335389971733093], [0.16799281537532806, 0.16806185245513916, 0.16518321633338928, 0.16525110602378845, 0.16517262160778046, 0.16833831369876862]], [[0.1713222712278366, 0.16793550550937653, 0.16808722913265228, 0.1685670018196106, 0.1619708091020584, 0.1621171534061432], [0.16219395399093628, 0.16537345945835114, 0.16522832214832306, 0.16477103531360626, 0.1712917983531952, 0.17114146053791046], [0.162602037191391, 0.16549451649188995, 0.16536259651184082, 0.16494686901569366, 0.17086507380008698, 0.170728862285614], [0.16389311850070953, 0.1658734530210495, 0.1657833755016327, 0.16549935936927795, 0.16952139139175415, 0.16942931711673737], [0.1462455689907074, 0.16013649106025696, 0.15948063135147095, 0.1574281007051468, 0.18874111771583557, 0.18796809017658234], [0.14663413166999817, 0.16027624905109406, 0.15963266789913177, 0.15761826932430267, 0.18829739093780518, 0.18754127621650696]], [[0.17297416925430298, 0.172346830368042, 0.14457663893699646, 0.16976377367973328, 0.1704784482717514, 0.16986015439033508], [0.17283868789672852, 0.1722257137298584, 0.14503896236419678, 0.16970129311084747, 0.17039981484413147, 0.16979549825191498], [0.1660502701997757, 0.16610722243785858, 0.16888482868671417, 0.16634415090084076, 0.1662781983613968, 0.16633524000644684], [0.17227351665496826, 0.17172002792358398, 0.14697366952896118, 0.16943864524364471, 0.17007024586200714, 0.16952385008335114], [0.172431081533432, 0.17186109721660614, 0.14643332362174988, 0.16951218247413635, 0.1701623797416687, 0.16959989070892334], [0.17229481041431427, 0.1717391014099121, 0.14690056443214417, 0.1694485992193222, 0.1700827032327652, 0.1695341318845749]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 0.8}, "num_env_steps_sampled": 400, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.624090495259979e-06, "normalize_and_clip_actions": 7.976059344978116e-06, "get_actions": 3.588408380021856e-05, "listify_data_for_vector_env": 1.0697905724944783e-05, "tensor_to_numpy": 1.4984341904816244e-05, "remove_single_ts_time_rank_from_batch": 1.1920424936725696e-05}}, "connector_pipeline_timer": 0.00011467692266927776}, "env_to_module_connector": {"connector_pipeline_timer": 5.937337769624279e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.034813076625568e-06, "add_states_from_episodes_to_batch": 2.743327126378351e-06, "batch_individual_items": 1.2398110162386672e-05, "numpy_to_tensor": 1.2000323092683022e-05, "add_observations_from_episodes_to_batch": 2.841023209370991e-06}}}, "num_episodes_lifetime": 140, "rlmodule_inference_timer": 3.11512474815172e-05, "episode_duration_sec_mean": 0.005346919955918565, "episode_len_mean": 20.0, "num_episodes": 20, "episode_return_max": 13.5, "weights_seq_no": 7.0, "sample": 0.11678571647249703, "episode_len_max": 20, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "env_to_module_sum_episodes_length_in": 10.368238394572801, "env_to_module_sum_episodes_length_out": 10.368238394572801, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "env_reset_timer": 0.0005768364324152736, "num_env_steps_sampled_lifetime": 35400, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 0.8, "env_step_timer": 1.3700488429749441e-05, "agent_episode_returns_mean": {"default_agent": 0.8}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_min": -13.5, "time_between_sampling": 10.247892616379227}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "b13c4_00000", "date": "2025-08-11_18-05-27", "timestamp": 1754928327, "time_this_iter_s": 10.300019025802612, "time_total_s": 71.8015353679657, "pid": 10212, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x144efd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 71.8015353679657, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 45.43333333333333, "ram_util_percent": 82.30666666666667}}
{"timers": {"training_iteration": 9.84052976499206, "restore_env_runners": 1.0812812904489322e-05, "training_step": 9.840366390343194, "env_runner_sampling_timer": 1.8943488102227852, "learner_update_timer": 7.723684950373703, "synch_weights": 0.00143904796551203, "restore_eval_env_runners": 3.4416040164153596e-05, "evaluation_iteration": 0.1279836688622131, "synch_eval_env_connectors": 0.0001406206713373477, "synch_env_connectors": 4.7330166149163835e-06}, "env_runners": {"rlmodule_inference_timer": 3.2103044584077906e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.075968906510814e-06, "numpy_to_tensor": 1.3065084887095985e-05, "add_states_from_episodes_to_batch": 2.792225482918758e-06, "batch_individual_items": 1.2769596458335816e-05, "add_observations_from_episodes_to_batch": 2.862054881296745e-06}}, "connector_pipeline_timer": 6.086393220974939e-05}, "env_step_timer": 1.4294573079837348e-05, "episode_len_max": 20, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.228367560862253e-06, "get_actions": 3.922077998396611e-05, "remove_single_ts_time_rank_from_batch": 1.23704886252847e-05, "listify_data_for_vector_env": 1.0696086923282966e-05, "tensor_to_numpy": 1.5429544559042767e-05, "un_batch_to_individual_items": 6.7962595327098515e-06}}, "connector_pipeline_timer": 0.0001196197643888241}, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "episode_duration_sec_mean": 0.005276999148074538, "time_between_sampling": 0.033340748160607704, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": -2.3000000000000007}, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": -2.3000000000000007}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "env_reset_timer": 4.72817722737226e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime": -3695000.0, "episode_return_min": -13.5, "episode_return_mean": -2.3000000000000007, "weights_seq_no": 7.0, "sample": 0.006102201698237359, "num_episodes_lifetime": -184750.0, "num_env_steps_sampled_lifetime_throughput": 3204.4559412812287}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17148345687976352, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009644040881333252, "add_observations_from_episodes_to_batch": 0.0009360037150076274, "add_columns_from_episodes_to_train_batch": 0.049949267732571384, "add_time_dim_to_batch_and_zero_pad": 0.09864611835784504, "add_states_from_episodes_to_batch": 0.0038353053203165413, "batch_individual_items": 0.008169090438461096, "numpy_to_tensor": 9.665783204695543e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"vf_loss": 0.3205087184906006, "mean_kl_loss": 4.634573087969329e-06, "num_module_steps_trained_lifetime": 47880, "num_module_steps_trained": 5985, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 998.4230504637324, "weights_seq_no": 8.0, "vf_explained_var": 0.00026422739028930664, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.24847087264060974, "curr_kl_coeff": 0.0006311872275546193, "policy_loss": -0.00016891202540136874, "vf_loss_unclipped": 41.09065246582031, "entropy": 0.682294487953186, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 756.8871394915884}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.4230504637324, "weights_seq_no": 8.0, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 47880, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 756.8979959594111}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 288000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 95760, "num_env_steps_trained_lifetime_throughput": 4557.660308590638, "num_module_steps_trained_throughput": 26256309.45346038, "num_module_steps_trained_lifetime_throughput": 13032135.435785256}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.2492629736661911, "use_intrinsic_rewards": 1.0, "diff_num_grad_updates_vs_sampler_policy": 41.0, "mean_kl_loss": 4.2184074118267745e-06, "policy_loss": -0.00016096976469270885, "vf_loss_unclipped": 40.97747039794922, "num_module_steps_trained_lifetime": 287280, "entropy": 0.6823152303695679, "vf_loss": 0.32151442766189575, "vf_explained_var": 0.005479753017425537, "num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.5758696422192, "weights_seq_no": 48.0}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.5758696422192, "weights_seq_no": 48.0, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 41.0, "num_module_steps_trained_lifetime": 287280}, "__all_modules__": {"num_env_steps_trained_lifetime": 1728000, "num_module_steps_trained_lifetime": 574560, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 54308.01792716802}}}, "IntrinsicAttentionMask": [[[0.17248086631298065, 0.16230861842632294, 0.16922394931316376, 0.16970697045326233, 0.16306616365909576, 0.16321349143981934], [0.13922008872032166, 0.18872052431106567, 0.15315645933151245, 0.15098725259304047, 0.18437351286411285, 0.18354210257530212], [0.16162025928497314, 0.1705332100391388, 0.16436414420604706, 0.16395093500614166, 0.16983340680599213, 0.16969801485538483], [0.16322007775306702, 0.16929878294467926, 0.16510257124900818, 0.16481971740722656, 0.16882523894309998, 0.16873355209827423], [0.14162281155586243, 0.18668416142463684, 0.1544395089149475, 0.15245187282562256, 0.1827750951051712, 0.18202649056911469], [0.14209170639514923, 0.18628932535648346, 0.1546875536441803, 0.15273556113243103, 0.18246430158615112, 0.18173162639141083]], [[0.18753309547901154, 0.15855324268341064, 0.15674538910388947, 0.15617690980434418, 0.15683437883853912, 0.18415698409080505], [0.16617420315742493, 0.1668563187122345, 0.1669030338525772, 0.1669178307056427, 0.16690072417259216, 0.1662478893995285], [0.1647665649652481, 0.16739793121814728, 0.16757920384407043, 0.1676366925239563, 0.16757023334503174, 0.16504932940006256], [0.16432201862335205, 0.16756880283355713, 0.1677929311990738, 0.16786400973796844, 0.16778182983398438, 0.16467033326625824], [0.1648360788822174, 0.16737118363380432, 0.16754579544067383, 0.16760115325450897, 0.1675371527671814, 0.1651085615158081], [0.18515633046627045, 0.15948432683944702, 0.1578664481639862, 0.15735727548599243, 0.1579461246728897, 0.18218956887722015]], [[0.17872175574302673, 0.15748244524002075, 0.15705180168151855, 0.1762159913778305, 0.15527446568012238, 0.17525354027748108], [0.16239088773727417, 0.16994106769561768, 0.17010830342769623, 0.16321660578250885, 0.1708051711320877, 0.16353802382946014], [0.16204215586185455, 0.17020845413208008, 0.17038969695568085, 0.16293376684188843, 0.1711450070142746, 0.1632809191942215], [0.1768806278705597, 0.15888020396232605, 0.15851156413555145, 0.17477461695671082, 0.15698853135108948, 0.1739645004272461], [0.16059526801109314, 0.17131847143173218, 0.17155832052230835, 0.1617579460144043, 0.17255878448486328, 0.16221119463443756], [0.1761675626039505, 0.15942203998565674, 0.15907777845859528, 0.17421472072601318, 0.15765483677387238, 0.17346309125423431]], [[0.16980528831481934, 0.15646003186702728, 0.16855955123901367, 0.16826118528842926, 0.1686062067747116, 0.16830775141716003], [0.16312755644321442, 0.17850954830646515, 0.16445526480674744, 0.16477632522583008, 0.16440518200397491, 0.1647261381149292], [0.16921766102313995, 0.15834932029247284, 0.16821014881134033, 0.16796864569187164, 0.16824792325496674, 0.16800634562969208], [0.1690758764743805, 0.15880663692951202, 0.16812549531459808, 0.16789762675762177, 0.16816112399101257, 0.16793321073055267], [0.16923977434635162, 0.1582779586315155, 0.1682233363389969, 0.16797968745231628, 0.16826142370700836, 0.16801773011684418], [0.16909803450107574, 0.15873512625694275, 0.16813872754573822, 0.16790874302387238, 0.16817469894886017, 0.16794465482234955]], [[0.17871174216270447, 0.1574736386537552, 0.157042995095253, 0.17620612680912018, 0.17572426795959473, 0.15484118461608887], [0.16238971054553986, 0.1699398159980774, 0.17010706663131714, 0.16321541368961334, 0.16337603330612183, 0.17097201943397522], [0.16204077005386353, 0.17020700871944427, 0.17038823664188385, 0.1629323810338974, 0.16310586035251617, 0.17132577300071716], [0.17687349021434784, 0.1588737964630127, 0.1585051715373993, 0.17476756870746613, 0.17436206340789795, 0.1566179394721985], [0.17651736736297607, 0.15914516150951385, 0.15878868103027344, 0.1744881570339203, 0.17409731447696686, 0.1569632738828659], [0.16024509072303772, 0.17158237099647522, 0.17183643579483032, 0.16147229075431824, 0.16171137988567352, 0.1731524020433426]], [[0.18243208527565002, 0.15424050390720367, 0.1796978861093521, 0.1790461540222168, 0.15256838500499725, 0.1520150601863861], [0.1662852019071579, 0.16696779429912567, 0.1663465052843094, 0.1663612425327301, 0.16701221466064453, 0.16702702641487122], [0.180970698595047, 0.15539024770259857, 0.17850662767887115, 0.17791879177093506, 0.1538601517677307, 0.1533534824848175], [0.1806192696094513, 0.15566681325435638, 0.17821964621543884, 0.17764706909656525, 0.15417125821113586, 0.15367594361305237], [0.16524645686149597, 0.16778789460659027, 0.16547350585460663, 0.16552817821502686, 0.16795426607131958, 0.16800975799560547], [0.1649005264043808, 0.1680610030889511, 0.16518238186836243, 0.1652502715587616, 0.16826830804347992, 0.16833746433258057]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 0.8}, "num_env_steps_sampled": 400, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.515158377409408e-06, "normalize_and_clip_actions": 7.950433551400766e-06, "get_actions": 3.625295095604734e-05, "listify_data_for_vector_env": 1.0572247053458928e-05, "tensor_to_numpy": 1.5176648227396982e-05, "remove_single_ts_time_rank_from_batch": 1.1815577611946838e-05}}, "connector_pipeline_timer": 0.0001146607348573032}, "env_to_module_connector": {"connector_pipeline_timer": 5.9331306468104995e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.057591991554933e-06, "add_states_from_episodes_to_batch": 2.7219888758727107e-06, "batch_individual_items": 1.239790838197198e-05, "numpy_to_tensor": 1.2057833495619759e-05, "add_observations_from_episodes_to_batch": 2.8494968113207133e-06}}}, "num_episodes_lifetime": 160, "rlmodule_inference_timer": 3.109824239797885e-05, "episode_duration_sec_mean": 0.0052698341314680874, "episode_len_mean": 20.0, "num_episodes": 20, "episode_return_max": 13.5, "weights_seq_no": 8.0, "sample": 0.11678113555778054, "episode_len_max": 20, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "env_to_module_sum_episodes_length_in": 10.3682383945743, "env_to_module_sum_episodes_length_out": 10.3682383945743, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "env_reset_timer": 0.0005747597388087923, "num_env_steps_sampled_lifetime": 40400, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 0.8, "env_step_timer": 1.3821613895923476e-05, "agent_episode_returns_mean": {"default_agent": 0.8}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_min": -13.5, "time_between_sampling": 10.244047801054773}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "b13c4_00000", "date": "2025-08-11_18-05-37", "timestamp": 1754928337, "time_this_iter_s": 9.962401866912842, "time_total_s": 81.76393723487854, "pid": 10212, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x144efd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 81.76393723487854, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 39.4, "ram_util_percent": 82.56428571428572}}
{"timers": {"training_iteration": 9.838379088592694, "restore_env_runners": 1.0822185088070791e-05, "training_step": 9.838214753939486, "env_runner_sampling_timer": 1.8928963692107097, "learner_update_timer": 7.7231674017100165, "synch_weights": 0.0014346845656998946, "restore_eval_env_runners": 3.442562983679435e-05, "evaluation_iteration": 0.12795777217332407, "synch_eval_env_connectors": 0.00014101196492326403, "synch_env_connectors": 4.762345938190256e-06}, "env_runners": {"rlmodule_inference_timer": 3.3192386864733746e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.312629042523185e-06, "numpy_to_tensor": 1.3619266968923005e-05, "add_states_from_episodes_to_batch": 2.8470178765448934e-06, "batch_individual_items": 1.3180455140354078e-05, "add_observations_from_episodes_to_batch": 2.95160382043869e-06}}, "connector_pipeline_timer": 6.283420597497135e-05}, "env_step_timer": 1.481477158372874e-05, "episode_len_max": 20, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.441967641026546e-06, "get_actions": 4.1474635939821815e-05, "remove_single_ts_time_rank_from_batch": 1.2543693052996452e-05, "listify_data_for_vector_env": 1.0958424129628788e-05, "tensor_to_numpy": 1.5989491333362026e-05, "un_batch_to_individual_items": 6.931441277368128e-06}}, "connector_pipeline_timer": 0.0001237874778044381}, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "episode_duration_sec_mean": 0.00553397772088647, "time_between_sampling": 0.03464738974803791, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": -0.54}, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": -0.54}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "env_reset_timer": 4.908592249199717e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime": -4312500.0, "episode_return_min": -13.5, "episode_return_mean": -0.54, "weights_seq_no": 8.0, "sample": 0.005893484728771574, "num_episodes_lifetime": -215625.0, "num_env_steps_sampled_lifetime_throughput": 3073.9233165518635}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17132323898085727, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009644388382962719, "add_observations_from_episodes_to_batch": 0.0009350949273079963, "add_columns_from_episodes_to_train_batch": 0.049878177975033584, "add_time_dim_to_batch_and_zero_pad": 0.0985641000936848, "add_states_from_episodes_to_batch": 0.003834875177528012, "batch_individual_items": 0.008164026203691992, "numpy_to_tensor": 9.653833468176772e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"vf_loss": 0.32050880789756775, "mean_kl_loss": 5.287889962346526e-06, "num_module_steps_trained_lifetime": 53865, "num_module_steps_trained": 5985, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 998.3685925840979, "weights_seq_no": 9.0, "vf_explained_var": 0.00027740001678466797, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.24849310517311096, "curr_kl_coeff": 0.00031559361377730966, "policy_loss": -0.00014721089974045753, "vf_loss_unclipped": 39.39021301269531, "entropy": 0.6820045709609985, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 753.9844291323304}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.3685925840979, "weights_seq_no": 9.0, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 53865, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 753.9946926044732}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 324000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 107730, "num_env_steps_trained_lifetime_throughput": 4540.016040711291, "num_module_steps_trained_throughput": 25541379.106082883, "num_module_steps_trained_lifetime_throughput": 12986534.36662079}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.24908947944641113, "use_intrinsic_rewards": 1.0, "diff_num_grad_updates_vs_sampler_policy": 46.0, "mean_kl_loss": 4.857468866248382e-06, "policy_loss": -0.00014159749844111502, "vf_loss_unclipped": 39.40574645996094, "num_module_steps_trained_lifetime": 323190, "entropy": 0.6820252537727356, "vf_loss": 0.32126617431640625, "vf_explained_var": 0.005704402923583984, "num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.5505482791133, "weights_seq_no": 54.0}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.5505482791133, "weights_seq_no": 54.0, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 46.0, "num_module_steps_trained_lifetime": 323190}, "__all_modules__": {"num_env_steps_trained_lifetime": 1944000, "num_module_steps_trained_lifetime": 646380, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 53441.814313084644}}}, "IntrinsicAttentionMask": [[[0.17248086631298065, 0.16230861842632294, 0.16922394931316376, 0.16970697045326233, 0.16306616365909576, 0.16321349143981934], [0.13922008872032166, 0.18872052431106567, 0.15315645933151245, 0.15098725259304047, 0.18437351286411285, 0.18354210257530212], [0.16162025928497314, 0.1705332100391388, 0.16436414420604706, 0.16395093500614166, 0.16983340680599213, 0.16969801485538483], [0.1632200926542282, 0.16929879784584045, 0.16510257124900818, 0.16481973230838776, 0.16882525384426117, 0.16873356699943542], [0.14162281155586243, 0.18668416142463684, 0.1544395089149475, 0.15245187282562256, 0.1827750951051712, 0.18202649056911469], [0.14209170639514923, 0.18628932535648346, 0.1546875536441803, 0.15273556113243103, 0.18246430158615112, 0.18173162639141083]], [[0.1751382201910019, 0.1612454205751419, 0.17650459706783295, 0.16250339150428772, 0.1621524691581726, 0.1624559462070465], [0.15915507078170776, 0.17150744795799255, 0.1580403745174408, 0.1703062355518341, 0.17063955962657928, 0.17035122215747833], [0.17667192220687866, 0.1602678745985031, 0.1782982051372528, 0.1617431491613388, 0.1613313853740692, 0.1616874635219574], [0.1606302112340927, 0.17055413126945496, 0.1597273051738739, 0.16959545016288757, 0.1698615998029709, 0.16963137686252594], [0.1602192223072052, 0.17081958055496216, 0.1592569500207901, 0.16979366540908813, 0.17007844150066376, 0.16983211040496826], [0.16057465970516205, 0.17059001326560974, 0.15966373682022095, 0.1696222573518753, 0.16989091038703918, 0.16965852677822113]], [[0.1713179498910904, 0.16793125867843628, 0.16135995090007782, 0.16856275498867035, 0.16871505975723267, 0.16211307048797607], [0.16218999028205872, 0.1653694063425064, 0.17191384732723236, 0.16476701200008392, 0.16462239623069763, 0.171137273311615], [0.14454281330108643, 0.1594480276107788, 0.19401302933692932, 0.15653330087661743, 0.1558399796485901, 0.18962284922599792], [0.16389159858226776, 0.16587190330028534, 0.1699029952287674, 0.165497824549675, 0.1654079407453537, 0.169427752494812], [0.1643020212650299, 0.16599136590957642, 0.16942098736763, 0.16567248106002808, 0.16559584438800812, 0.16901728510856628], [0.14655674993991852, 0.16019167006015778, 0.19137169420719147, 0.15753509104251862, 0.1569025069475174, 0.18744231760501862]], [[0.18242645263671875, 0.15423573553562164, 0.15247711539268494, 0.15192411839962006, 0.1797943413257599, 0.1791422814130783], [0.1662852168083191, 0.16696780920028687, 0.16701453924179077, 0.16702935099601746, 0.16634421050548553, 0.16635894775390625], [0.1651923656463623, 0.16783051192760468, 0.16801226139068604, 0.16806989908218384, 0.16541911661624908, 0.16547586023807526], [0.16484643518924713, 0.16810359060764313, 0.1683284342288971, 0.16839973628520966, 0.16512592136859894, 0.16519586741924286], [0.18102096021175385, 0.15534305572509766, 0.15372809767723083, 0.15321992337703705, 0.1786392480134964, 0.1780487298965454], [0.18066975474357605, 0.155619814991951, 0.1540411412715912, 0.15354430675506592, 0.17835012078285217, 0.17777489125728607]], [[0.1701717972755432, 0.16680777072906494, 0.16695848107337952, 0.16073791682720184, 0.1675863116979599, 0.16773772239685059], [0.16328036785125732, 0.1664811670780182, 0.16633504629135132, 0.17259062826633453, 0.1657291203737259, 0.16558367013931274], [0.16359013319015503, 0.16650018095970154, 0.16636745631694794, 0.17204052209854126, 0.16581691801548004, 0.16568472981452942], [0.15073083341121674, 0.1653420329093933, 0.16465157270431519, 0.19632606208324432, 0.16181263327598572, 0.1611369103193283], [0.16487963497638702, 0.16657491028308868, 0.1664978712797165, 0.16976849734783173, 0.16617800295352936, 0.1661011278629303], [0.16519035398960114, 0.1665918529033661, 0.16652819514274597, 0.16922526061534882, 0.16626393795013428, 0.1662004142999649]], [[0.1823568195104599, 0.18169546127319336, 0.17962373793125153, 0.1518661230802536, 0.15250544250011444, 0.1519523561000824], [0.1820085495710373, 0.1813630610704422, 0.17934072017669678, 0.15219226479530334, 0.1528187096118927, 0.15227673947811127], [0.1809091418981552, 0.18031339347362518, 0.17844590544700623, 0.15322233736515045, 0.15380781888961792, 0.15330131351947784], [0.16484558582305908, 0.16491541266441345, 0.16513599455356598, 0.1683988720178604, 0.16831643879413605, 0.16838772594928741], [0.1652458906173706, 0.16530048847198486, 0.16547292470932007, 0.16801784932613373, 0.16795368492603302, 0.1680091768503189], [0.16489967703819275, 0.16496744751930237, 0.16518153250217438, 0.16834740340709686, 0.16826744377613068, 0.16833660006523132]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 1.0}, "num_env_steps_sampled": 400, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.569911822284135e-06, "normalize_and_clip_actions": 8.119384603883238e-06, "get_actions": 3.631116680696768e-05, "listify_data_for_vector_env": 1.0716124898254384e-05, "tensor_to_numpy": 1.4980655960736477e-05, "remove_single_ts_time_rank_from_batch": 1.1941504080945203e-05}}, "connector_pipeline_timer": 0.00011481872712755276}, "env_to_module_connector": {"connector_pipeline_timer": 5.903861336135372e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.048934483790503e-06, "add_states_from_episodes_to_batch": 2.771378889945159e-06, "batch_individual_items": 1.2383261393748269e-05, "numpy_to_tensor": 1.1898288934758638e-05, "add_observations_from_episodes_to_batch": 2.816181149086228e-06}}}, "num_episodes_lifetime": 180, "rlmodule_inference_timer": 3.077275980667301e-05, "episode_duration_sec_mean": 0.005253332478459925, "episode_len_mean": 20.0, "num_episodes": 20, "episode_return_max": 13.5, "weights_seq_no": 9.0, "sample": 0.11674571045215848, "episode_len_max": 20, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "env_reset_timer": 0.0005704079716067883, "num_env_steps_sampled_lifetime": 45400, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 1.0, "env_step_timer": 1.388671061789449e-05, "agent_episode_returns_mean": {"default_agent": 1.0}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_min": -13.5, "time_between_sampling": 10.23815606679396}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "b13c4_00000", "date": "2025-08-11_18-05-47", "timestamp": 1754928347, "time_this_iter_s": 9.747797012329102, "time_total_s": 91.51173424720764, "pid": 10212, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x144efd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 91.51173424720764, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 40.92142857142858, "ram_util_percent": 82.17857142857144}}
{"timers": {"training_iteration": 9.838783702705834, "restore_env_runners": 1.0783963770204619e-05, "training_step": 9.838618312240072, "env_runner_sampling_timer": 1.8942657513479628, "learner_update_timer": 7.722366863942947, "synch_weights": 0.0014447447999518925, "restore_eval_env_runners": 3.422762377893115e-05, "evaluation_iteration": 0.12787322195151618, "synch_eval_env_connectors": 0.00014101809470756376, "synch_env_connectors": 4.765143118844817e-06}, "env_runners": {"rlmodule_inference_timer": 3.379098411843349e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.267883854243017e-06, "numpy_to_tensor": 1.3458813819519546e-05, "add_states_from_episodes_to_batch": 2.820717547989024e-06, "batch_individual_items": 1.3402342598150781e-05, "add_observations_from_episodes_to_batch": 2.9680215557284307e-06}}, "connector_pipeline_timer": 6.303729698518261e-05}, "env_step_timer": 1.5280585672917766e-05, "episode_len_max": 20, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.501980895111464e-06, "get_actions": 4.2222439193187274e-05, "remove_single_ts_time_rank_from_batch": 1.2623063806592936e-05, "listify_data_for_vector_env": 1.1071981116498867e-05, "tensor_to_numpy": 1.624800480180342e-05, "un_batch_to_individual_items": 6.948362507732397e-06}}, "connector_pipeline_timer": 0.00012548640447782988}, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "episode_duration_sec_mean": 0.00560870618233457, "time_between_sampling": 0.0341486663140919, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": -1.9799999999999998}, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": -1.9799999999999998}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "env_reset_timer": 5.1317345852429544e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime": -4930000.0, "episode_return_min": -13.5, "episode_return_mean": -1.9799999999999998, "weights_seq_no": 9.0, "sample": 0.0060684652771405756, "num_episodes_lifetime": -246500.0, "num_env_steps_sampled_lifetime_throughput": 3104.012131742609}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17115238242151648, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009642533249640775, "add_observations_from_episodes_to_batch": 0.0009343227278741328, "add_columns_from_episodes_to_train_batch": 0.04979737786459, "add_time_dim_to_batch_and_zero_pad": 0.09848194492222422, "add_states_from_episodes_to_batch": 0.00383558850549342, "batch_individual_items": 0.008158872611368701, "numpy_to_tensor": 9.644753191755385e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"vf_loss": 0.32050952315330505, "mean_kl_loss": 2.1480833311215974e-05, "num_module_steps_trained_lifetime": 59850, "num_module_steps_trained": 5985, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 998.3173215714437, "weights_seq_no": 10.0, "vf_explained_var": 1.615285873413086e-05, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.24858629703521729, "curr_kl_coeff": 0.00015779680688865483, "policy_loss": -5.689753743354231e-05, "vf_loss_unclipped": 43.6431770324707, "entropy": 0.6804870963096619, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 751.4000341723591}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.3173215714437, "weights_seq_no": 10.0, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 59850, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 751.4097095541202}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 360000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 119700, "num_env_steps_trained_lifetime_throughput": 4524.289795667619, "num_module_steps_trained_throughput": 24869823.460619465, "num_module_steps_trained_lifetime_throughput": 12954256.28847592}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.24921005964279175, "use_intrinsic_rewards": 1.0, "diff_num_grad_updates_vs_sampler_policy": 51.0, "mean_kl_loss": 2.138778472726699e-05, "policy_loss": -5.712790880352259e-05, "vf_loss_unclipped": 43.32045364379883, "num_module_steps_trained_lifetime": 359100, "entropy": 0.6804894804954529, "vf_loss": 0.321306049823761, "vf_explained_var": 0.005303502082824707, "num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.532914147147, "weights_seq_no": 60.0}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.532914147147, "weights_seq_no": 60.0, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 51.0, "num_module_steps_trained_lifetime": 359100}, "__all_modules__": {"num_env_steps_trained_lifetime": 2160000, "num_module_steps_trained_lifetime": 718200, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 52597.57123505755}}}, "IntrinsicAttentionMask": [[[0.17365626990795135, 0.16341470181941986, 0.1635623574256897, 0.17086346447467804, 0.16417741775512695, 0.1643257439136505], [0.13454948365688324, 0.1823892444372177, 0.18156680464744568, 0.14592187106609344, 0.17818805575370789, 0.17738454043865204], [0.13507986068725586, 0.18211796879768372, 0.18131135404109955, 0.14628534018993378, 0.1779969483613968, 0.1772085726261139], [0.16255292296409607, 0.16860677301883698, 0.16851520538330078, 0.16414602100849152, 0.1681351512670517, 0.168043851852417], [0.13730059564113617, 0.1809867024421692, 0.18024544417858124, 0.14779916405677795, 0.1771969348192215, 0.17647118866443634], [0.13783884048461914, 0.18071362376213074, 0.17998798191547394, 0.14816413819789886, 0.17700308561325073, 0.1762923300266266]], [[0.166692852973938, 0.16663312911987305, 0.1666373908519745, 0.16663874685764313, 0.16669824719429016, 0.1666996031999588], [0.15508197247982025, 0.18145199120044708, 0.17942866683006287, 0.1787923276424408, 0.15289364755153656, 0.15235140919685364], [0.15591652691364288, 0.1803896427154541, 0.17852137982845306, 0.1779334843158722, 0.15387286245822906, 0.15336614847183228], [0.15618082880973816, 0.18005312979221344, 0.17823365330696106, 0.17766103148460388, 0.15418337285518646, 0.15368801355361938], [0.1677326112985611, 0.16530118882656097, 0.16547363996505737, 0.1655283123254776, 0.16795440018177032, 0.1680098921060562], [0.16799215972423553, 0.16496850550174713, 0.16518259048461914, 0.1652504801750183, 0.16826851665973663, 0.16833767294883728]], [[0.17248086631298065, 0.16230861842632294, 0.16922394931316376, 0.16970697045326233, 0.16306616365909576, 0.16321349143981934], [0.13922008872032166, 0.18872052431106567, 0.15315645933151245, 0.15098725259304047, 0.18437351286411285, 0.18354210257530212], [0.16162025928497314, 0.1705332100391388, 0.16436414420604706, 0.16395093500614166, 0.16983340680599213, 0.16969801485538483], [0.1632200926542282, 0.16929879784584045, 0.16510257124900818, 0.16481973230838776, 0.16882525384426117, 0.16873356699943542], [0.14162281155586243, 0.18668416142463684, 0.1544395089149475, 0.15245187282562256, 0.1827750951051712, 0.18202649056911469], [0.14209170639514923, 0.18628932535648346, 0.1546875536441803, 0.15273556113243103, 0.18246430158615112, 0.18173162639141083]], [[0.16862283647060394, 0.16801127791404724, 0.16609559953212738, 0.1654932051897049, 0.16618989408016205, 0.1655871570110321], [0.1685793250799179, 0.16798146069049835, 0.16610834002494812, 0.16551923751831055, 0.16620054841041565, 0.165611132979393], [0.1684419959783554, 0.16788730025291443, 0.16614851355552673, 0.16560137271881104, 0.16623415052890778, 0.1656867265701294], [0.16839849948883057, 0.16785746812820435, 0.16616123914718628, 0.1656273901462555, 0.16624478995800018, 0.1657106876373291], [0.1684487909078598, 0.1678919643163681, 0.16614653170108795, 0.16559730470180511, 0.16623248159885406, 0.16568298637866974], [0.16840527951717377, 0.16786211729049683, 0.1661592423915863, 0.16562332212924957, 0.16624310612678528, 0.16570691764354706]], [[0.1724754124879837, 0.16230349242687225, 0.1624501347541809, 0.16970160603523254, 0.1630610078573227, 0.17000839114189148], [0.13910886645317078, 0.18856975436210632, 0.1877194494009018, 0.15086662769317627, 0.18422621488571167, 0.14950908720493317], [0.1395764797925949, 0.18818041682243347, 0.187346950173378, 0.15115496516227722, 0.18392221629619598, 0.14981897175312042], [0.16321823000907898, 0.16929686069488525, 0.1692049205303192, 0.16481785476207733, 0.16882331669330597, 0.16463887691497803], [0.14152953028678894, 0.1865611970424652, 0.18579711019992828, 0.15235145390033722, 0.1826547086238861, 0.15110604465007782], [0.164237380027771, 0.16851641237735748, 0.16845202445983887, 0.16536793112754822, 0.16818471252918243, 0.16524161398410797]], [[0.1666826754808426, 0.16662295162677765, 0.1666272133588791, 0.16668963432312012, 0.16668806970119476, 0.1666894257068634], [0.15930767357349396, 0.18639622628688812, 0.18431776762008667, 0.1564158797264099, 0.15705972909927368, 0.15650270879268646], [0.1598564088344574, 0.1849479377269745, 0.18303246796131134, 0.15716058015823364, 0.1577611118555069, 0.1572415828704834], [0.1674979031085968, 0.1643916666507721, 0.1646115481853485, 0.16786405444145203, 0.16778187453746796, 0.1678529530763626], [0.16731594502925873, 0.16489055752754211, 0.1650625765323639, 0.16760118305683136, 0.16753718256950378, 0.16759252548217773], [0.16747334599494934, 0.1644590198993683, 0.16467244923114777, 0.16782855987548828, 0.1677488386631012, 0.16781778633594513]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 0.6}, "num_env_steps_sampled": 400, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.4438388395333385e-06, "normalize_and_clip_actions": 7.976566690471558e-06, "get_actions": 3.601128075334004e-05, "listify_data_for_vector_env": 1.0533341070468373e-05, "tensor_to_numpy": 1.4991811894104113e-05, "remove_single_ts_time_rank_from_batch": 1.1905176107648514e-05}}, "connector_pipeline_timer": 0.00011414914979160067}, "env_to_module_connector": {"connector_pipeline_timer": 5.897989447756471e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.083351614219824e-06, "add_states_from_episodes_to_batch": 2.698300658911046e-06, "batch_individual_items": 1.2239847771881587e-05, "numpy_to_tensor": 1.1969287370237097e-05, "add_observations_from_episodes_to_batch": 2.8613655273459217e-06}}}, "num_episodes_lifetime": 200, "rlmodule_inference_timer": 3.09448042177675e-05, "episode_duration_sec_mean": 0.005251930427039042, "episode_len_mean": 20.0, "num_episodes": 20, "episode_return_max": 13.5, "weights_seq_no": 10.0, "sample": 0.11672786793715856, "episode_len_max": 20, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "env_reset_timer": 0.0005681409716127822, "num_env_steps_sampled_lifetime": 50400, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 0.6, "env_step_timer": 1.3841967042889073e-05, "agent_episode_returns_mean": {"default_agent": 0.6}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_min": -13.5, "time_between_sampling": 10.234840029456375}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "b13c4_00000", "date": "2025-08-11_18-05-57", "timestamp": 1754928357, "time_this_iter_s": 10.005670070648193, "time_total_s": 101.51740431785583, "pid": 10212, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x144efd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 101.51740431785583, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 41.37142857142857, "ram_util_percent": 81.95}}
{"timers": {"training_iteration": 9.847886414428697, "restore_env_runners": 1.083695422791292e-05, "training_step": 9.847719584117609, "env_runner_sampling_timer": 1.8920665692439407, "learner_update_timer": 7.733851336133794, "synch_weights": 0.0014524344320387688, "restore_eval_env_runners": 3.4245347954053016e-05, "evaluation_iteration": 0.12783252973173562, "synch_eval_env_connectors": 0.00014131458449738213, "synch_env_connectors": 4.8454018583604955e-06}, "env_runners": {"rlmodule_inference_timer": 3.07085376827514e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.869876263973194e-06, "numpy_to_tensor": 3.894101188262462e-05, "add_states_from_episodes_to_batch": 2.736400772477597e-06, "batch_individual_items": 1.2500731631349018e-05, "add_observations_from_episodes_to_batch": 2.799014027458362e-06}}, "connector_pipeline_timer": 8.588732302053464e-05}, "env_step_timer": 1.3813077514378406e-05, "episode_len_max": 20, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.966152561319527e-06, "get_actions": 3.7720802558183665e-05, "remove_single_ts_time_rank_from_batch": 1.2012587634375631e-05, "listify_data_for_vector_env": 1.0410707935198017e-05, "tensor_to_numpy": 1.5040953245620195e-05, "un_batch_to_individual_items": 6.672292705766108e-06}}, "connector_pipeline_timer": 0.0001162747409137781}, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "episode_duration_sec_mean": 0.00581865934981033, "time_between_sampling": 0.03268703072529769, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": -2.1399999999999997}, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": -2.1399999999999997}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "env_reset_timer": 4.332544270018863e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime": -5547500.0, "episode_return_min": -13.5, "episode_return_mean": -2.1399999999999997, "weights_seq_no": 10.0, "sample": 0.006158530036915586, "num_episodes_lifetime": -277375.0, "num_env_steps_sampled_lifetime_throughput": 3266.49465026299}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17097748067732194, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009635315837390194, "add_observations_from_episodes_to_batch": 0.0009351020002569116, "add_columns_from_episodes_to_train_batch": 0.04971891866564254, "add_time_dim_to_batch_and_zero_pad": 0.09839863839339279, "add_states_from_episodes_to_batch": 0.00383495053976953, "batch_individual_items": 0.00815375763519623, "numpy_to_tensor": 9.625096698574532e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"vf_loss": 0.3205086290836334, "mean_kl_loss": 1.0376152204116806e-05, "num_module_steps_trained_lifetime": 65835, "num_module_steps_trained": 5985, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 998.2690509307901, "weights_seq_no": 11.0, "vf_explained_var": 0.00027871131896972656, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.2483103722333908, "curr_kl_coeff": 7.889840344432741e-05, "policy_loss": -0.00033278908813372254, "vf_loss_unclipped": 41.197723388671875, "entropy": 0.6800731420516968, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 747.8892653970228}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.2690509307901, "weights_seq_no": 11.0, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 65835, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 747.8983496926878}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 396000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 131670, "num_env_steps_trained_lifetime_throughput": 4503.002285707074, "num_module_steps_trained_throughput": 24210946.05788203, "num_module_steps_trained_lifetime_throughput": 12901740.680078495}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.24878403544425964, "use_intrinsic_rewards": 1.0, "diff_num_grad_updates_vs_sampler_policy": 56.0, "mean_kl_loss": 9.16205044632079e-06, "policy_loss": -0.00031468537054024637, "vf_loss_unclipped": 41.05336380004883, "num_module_steps_trained_lifetime": 395010, "entropy": 0.6801169514656067, "vf_loss": 0.3210916519165039, "vf_explained_var": 0.0054323673248291016, "num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.5206335045569, "weights_seq_no": 66.0}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.5206335045569, "weights_seq_no": 66.0, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 56.0, "num_module_steps_trained_lifetime": 395010}, "__all_modules__": {"num_env_steps_trained_lifetime": 2376000, "num_module_steps_trained_lifetime": 790020, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 51757.59025499014}}}, "IntrinsicAttentionMask": [[[0.1701717972755432, 0.16680777072906494, 0.16695848107337952, 0.16073791682720184, 0.1675863116979599, 0.16773772239685059], [0.16328036785125732, 0.1664811670780182, 0.16633504629135132, 0.17259062826633453, 0.1657291203737259, 0.16558367013931274], [0.16359013319015503, 0.16650018095970154, 0.16636745631694794, 0.17204052209854126, 0.16581691801548004, 0.16568472981452942], [0.15073083341121674, 0.1653420329093933, 0.16465157270431519, 0.19632606208324432, 0.16181263327598572, 0.1611369103193283], [0.16487963497638702, 0.16657491028308868, 0.1664978712797165, 0.16976849734783173, 0.16617800295352936, 0.1661011278629303], [0.16519035398960114, 0.1665918529033661, 0.16652819514274597, 0.16922526061534882, 0.16626393795013428, 0.1662004142999649]], [[0.1929137259721756, 0.163102388381958, 0.16124267876148224, 0.1606578826904297, 0.16133421659469604, 0.16074909269809723], [0.1660633385181427, 0.16674500703811646, 0.16679167747497559, 0.16680647432804108, 0.16678936779499054, 0.16680416464805603], [0.16434285044670105, 0.16696743667125702, 0.16714824736118317, 0.1672055870294571, 0.16713930666446686, 0.1671966314315796], [0.16380071640014648, 0.1670372039079666, 0.16726061701774597, 0.16733147203922272, 0.16724956035614014, 0.1673204004764557], [0.16442765295505524, 0.16695649921894073, 0.16713066399097443, 0.16718588769435883, 0.1671220362186432, 0.1671772599220276], [0.16388531029224396, 0.1670263409614563, 0.167243093252182, 0.16731183230876923, 0.16723236441612244, 0.16730108857154846]], [[0.17016854882240295, 0.16680458188056946, 0.1602773517370224, 0.16743184626102448, 0.16758312284946442, 0.1677345186471939], [0.16327734291553497, 0.16647808253765106, 0.1730663925409317, 0.16587163507938385, 0.16572605073451996, 0.1655806005001068], [0.14970356225967407, 0.16514095664024353, 0.2009400725364685, 0.16212216019630432, 0.1614041030406952, 0.16068921983242035], [0.16456791758537292, 0.16655638813972473, 0.17060410976409912, 0.16618075966835022, 0.16609050333499908, 0.16600030660629272], [0.16487877070903778, 0.16657404601573944, 0.17001570761203766, 0.16625404357910156, 0.16617713868618011, 0.16610026359558105], [0.16518977284431458, 0.16659125685691833, 0.16942887008190155, 0.16632689535617828, 0.16626334190368652, 0.16619983315467834]], [[0.17432457208633423, 0.16062413156032562, 0.17304567992687225, 0.15944576263427734, 0.15977269411087036, 0.17278718948364258], [0.15832430124282837, 0.1732533574104309, 0.15961292386054993, 0.1746634989976883, 0.17427006363868713, 0.1598758101463318], [0.17287249863147736, 0.16176941990852356, 0.17184323072433472, 0.16080626845359802, 0.16107362508773804, 0.17163501679897308], [0.1569034308195114, 0.1743752658367157, 0.158400759100914, 0.17603933811187744, 0.17557482421398163, 0.15870648622512817], [0.15729832649230957, 0.17406345903873444, 0.15873797237873077, 0.1756565421819687, 0.17521190643310547, 0.15903185307979584], [0.17257794737815857, 0.16200177371501923, 0.1715989112854004, 0.16108274459838867, 0.16133786737918854, 0.17140083014965057]], [[0.17247645556926727, 0.16230447590351105, 0.1624511182308197, 0.16970263421535492, 0.1698559671640396, 0.16320931911468506], [0.13913023471832275, 0.18859870731830597, 0.1877482682466507, 0.1508897989988327, 0.15020938217639923, 0.18342362344264984], [0.13959714770317078, 0.18820829689502716, 0.18737469613552094, 0.15117736160755157, 0.15050779283046722, 0.18313471972942352], [0.16321858763694763, 0.1692972332239151, 0.16920529305934906, 0.16481821238994598, 0.16472870111465454, 0.16873200237751007], [0.16372767090797424, 0.16890686750411987, 0.16882872581481934, 0.165093332529068, 0.16501696407794952, 0.16842645406723022], [0.14201903343200684, 0.18619404733181, 0.18544639647006989, 0.15265744924545288, 0.15204444527626038, 0.1816386729478836]], [[0.16794215142726898, 0.1682564616203308, 0.16925238072872162, 0.15582644939422607, 0.16920293867588043, 0.16951961815357208], [0.16799402236938477, 0.16832199692726135, 0.16936135292053223, 0.15537254512310028, 0.16930976510047913, 0.16964030265808105], [0.16815613210201263, 0.1685272753238678, 0.16970402002334595, 0.15394695103168488, 0.16964559257030487, 0.17002001404762268], [0.16565430164337158, 0.16542978584766388, 0.16472315788269043, 0.17489993572235107, 0.16475805640220642, 0.1645347625017166], [0.16814817488193512, 0.16851717233657837, 0.16968712210655212, 0.15401725471019745, 0.1696290224790573, 0.17000126838684082], [0.16819904744625092, 0.1685817390680313, 0.16979530453681946, 0.15356764197349548, 0.16973504424095154, 0.1701212227344513]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 0.4}, "num_env_steps_sampled": 400, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 7.33476262946248e-06, "normalize_and_clip_actions": 8.933200562229152e-06, "get_actions": 4.423330611316935e-05, "listify_data_for_vector_env": 1.2134562149450529e-05, "tensor_to_numpy": 1.709680639188513e-05, "remove_single_ts_time_rank_from_batch": 1.38131835826884e-05}}, "connector_pipeline_timer": 0.00013394597824130646}, "env_to_module_connector": {"connector_pipeline_timer": 6.879525441322662e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 8.285071611536482e-06, "add_states_from_episodes_to_batch": 3.156382798765766e-06, "batch_individual_items": 1.46400119526511e-05, "numpy_to_tensor": 1.4321095889364288e-05, "add_observations_from_episodes_to_batch": 3.144649523564538e-06}}}, "num_episodes_lifetime": 220, "rlmodule_inference_timer": 3.675892438956982e-05, "episode_duration_sec_mean": 0.005428917104145512, "episode_len_mean": 20.0, "num_episodes": 20, "episode_return_max": 13.5, "weights_seq_no": 11.0, "sample": 0.11692035300742927, "episode_len_max": 20, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "env_reset_timer": 0.0005658066525749439, "num_env_steps_sampled_lifetime": 55400, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 0.4, "env_step_timer": 1.6694612970142783e-05, "agent_episode_returns_mean": {"default_agent": 0.4}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_min": -13.5, "time_between_sampling": 10.240282009161016}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "b13c4_00000", "date": "2025-08-11_18-06-08", "timestamp": 1754928368, "time_this_iter_s": 10.898785591125488, "time_total_s": 112.41618990898132, "pid": 10212, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x144efd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 112.41618990898132, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 50.44666666666667, "ram_util_percent": 82.47333333333333}}
{"timers": {"training_iteration": 9.862717386534674, "restore_env_runners": 1.0870663765157472e-05, "training_step": 9.862548918276842, "env_runner_sampling_timer": 1.8913450193917538, "learner_update_timer": 7.745832331522215, "synch_weights": 0.0014533188383418457, "restore_eval_env_runners": 3.436289448471978e-05, "evaluation_iteration": 0.12801809151473562, "synch_eval_env_connectors": 0.00014217393791196963, "synch_env_connectors": 4.889447962040918e-06}, "env_runners": {"rlmodule_inference_timer": 3.384316301477701e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.342716314964009e-06, "numpy_to_tensor": 1.3696655243313246e-05, "add_states_from_episodes_to_batch": 2.8851834446404844e-06, "batch_individual_items": 1.3403915742271307e-05, "add_observations_from_episodes_to_batch": 2.9619517898081072e-06}}, "connector_pipeline_timer": 6.336735192241674e-05}, "env_step_timer": 1.5067210608409066e-05, "episode_len_max": 20, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.45931582128225e-06, "get_actions": 4.2253118004195916e-05, "remove_single_ts_time_rank_from_batch": 1.2740396011868478e-05, "listify_data_for_vector_env": 1.1007408786623727e-05, "tensor_to_numpy": 1.628102808760841e-05, "un_batch_to_individual_items": 6.974184144491248e-06}}, "connector_pipeline_timer": 0.00012558740557615296}, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "episode_duration_sec_mean": 0.005612634191755205, "time_between_sampling": 0.03768339060215133, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": -1.9799999999999998}, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": -1.9799999999999998}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "env_reset_timer": 5.037694141376216e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime": -6165000.0, "episode_return_min": -13.5, "episode_return_mean": -1.9799999999999998, "weights_seq_no": 11.0, "sample": 0.006008060533703555, "num_episodes_lifetime": -308250.0, "num_env_steps_sampled_lifetime_throughput": 3048.1565881616257}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1745353792009302, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009630247677941696, "add_observations_from_episodes_to_batch": 0.0009345509809051506, "add_columns_from_episodes_to_train_batch": 0.04966656363797478, "add_time_dim_to_batch_and_zero_pad": 0.10189578742996008, "add_states_from_episodes_to_batch": 0.0038752247843860652, "batch_individual_items": 0.008230958388618037, "numpy_to_tensor": 9.622762628319448e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"vf_loss": 0.320509135723114, "mean_kl_loss": 3.141516208415851e-05, "num_module_steps_trained_lifetime": 71820, "num_module_steps_trained": 5985, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 998.2236050808158, "weights_seq_no": 12.0, "vf_explained_var": 0.00038164854049682617, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.2480441778898239, "curr_kl_coeff": 3.944920172216371e-05, "policy_loss": -0.0006019585998728871, "vf_loss_unclipped": 43.738075256347656, "entropy": 0.6783947348594666, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 743.9337297887022}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.2236050808158, "weights_seq_no": 12.0, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 71820, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 743.9422473021157}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 432000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 143640, "num_env_steps_trained_lifetime_throughput": 4479.045260652983, "num_module_steps_trained_throughput": 23574904.36104051, "num_module_steps_trained_lifetime_throughput": 12849594.518406639}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.2485225796699524, "use_intrinsic_rewards": 1.0, "diff_num_grad_updates_vs_sampler_policy": 61.0, "mean_kl_loss": 2.8807662602048367e-05, "policy_loss": -0.0005777646438218653, "vf_loss_unclipped": 43.42597198486328, "num_module_steps_trained_lifetime": 430920, "entropy": 0.6784520149230957, "vf_loss": 0.3210863471031189, "vf_explained_var": 0.005220293998718262, "num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.512081102731, "weights_seq_no": 72.0}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.512081102731, "weights_seq_no": 72.0, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 61.0, "num_module_steps_trained_lifetime": 430920}, "__all_modules__": {"num_env_steps_trained_lifetime": 2592000, "num_module_steps_trained_lifetime": 861840, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 50895.7025378531}}}, "IntrinsicAttentionMask": [[[0.1713222712278366, 0.16793550550937653, 0.16808722913265228, 0.1685670018196106, 0.1619708091020584, 0.1621171534061432], [0.16219395399093628, 0.16537345945835114, 0.16522832214832306, 0.16477103531360626, 0.1712917983531952, 0.17114146053791046], [0.162602037191391, 0.16549451649188995, 0.16536259651184082, 0.16494686901569366, 0.17086507380008698, 0.170728862285614], [0.16389311850070953, 0.1658734530210495, 0.1657833755016327, 0.16549935936927795, 0.16952139139175415, 0.16942931711673737], [0.1462455689907074, 0.16013649106025696, 0.15948063135147095, 0.15742811560630798, 0.18874111771583557, 0.18796809017658234], [0.14663413166999817, 0.16027624905109406, 0.15963266789913177, 0.15761826932430267, 0.18829739093780518, 0.18754127621650696]], [[0.16862283647060394, 0.16801127791404724, 0.16609559953212738, 0.1654932051897049, 0.16618989408016205, 0.1655871570110321], [0.1685793250799179, 0.16798146069049835, 0.16610834002494812, 0.16551923751831055, 0.16620054841041565, 0.165611132979393], [0.1684419959783554, 0.16788730025291443, 0.16614851355552673, 0.16560137271881104, 0.16623415052890778, 0.1656867265701294], [0.16839849948883057, 0.16785746812820435, 0.16616123914718628, 0.1656273901462555, 0.16624478995800018, 0.1657106876373291], [0.1684487909078598, 0.1678919643163681, 0.16614653170108795, 0.16559730470180511, 0.16623248159885406, 0.16568298637866974], [0.16840527951717377, 0.16786211729049683, 0.1661592423915863, 0.16562332212924957, 0.16624310612678528, 0.16570691764354706]], [[0.17503881454467773, 0.17456014454364777, 0.17408280074596405, 0.17258469760417938, 0.15207472443580627, 0.15165884792804718], [0.1747966706752777, 0.17433270812034607, 0.17386998236179352, 0.172417551279068, 0.15249398350715637, 0.1520892083644867], [0.1745542287826538, 0.17410492897033691, 0.17365680634975433, 0.1722499430179596, 0.15291382372379303, 0.15252022445201874], [0.17378738522529602, 0.1733841449022293, 0.1729818433523178, 0.17171820998191833, 0.15424315631389618, 0.15388526022434235], [0.1622866690158844, 0.162513867020607, 0.16274139285087585, 0.1634615957736969, 0.17437617480754852, 0.17462031543254852], [0.16203255951404572, 0.16227248311042786, 0.16251274943351746, 0.16327343881130219, 0.17482496798038483, 0.17508383095264435]], [[0.16979292035102844, 0.16949237883090973, 0.15557625889778137, 0.16824893653392792, 0.16859391331672668, 0.1682955026626587], [0.16965287923812866, 0.16936622560024261, 0.15606729686260223, 0.16818001866340637, 0.16850915551185608, 0.16822443902492523], [0.1626402735710144, 0.1629992425441742, 0.18133684992790222, 0.1644996702671051, 0.16408087313175201, 0.1644430160522461], [0.16906863451004028, 0.1688394844532013, 0.1581215113401413, 0.16789044439792633, 0.16815392673015594, 0.16792601346969604], [0.16923150420188904, 0.16898639500141144, 0.15754786133766174, 0.16797149181365967, 0.16825321316719055, 0.16800951957702637], [0.1690906584262848, 0.1688593477010727, 0.15804392099380493, 0.167901411652565, 0.1681673526763916, 0.16793732345104218]], [[0.1736552119255066, 0.16341371834278107, 0.1635613590478897, 0.16402822732925415, 0.17101681232452393, 0.16432474553585052], [0.13452942669391632, 0.18236206471920013, 0.18153974413871765, 0.17896853387355804, 0.14524219930171967, 0.17735810577869415], [0.1350604146718979, 0.18209174275398254, 0.18128524720668793, 0.17876309156417847, 0.14561645686626434, 0.17718306183815002], [0.13674631714820862, 0.18123619258403778, 0.18047936260700226, 0.17811129987239838, 0.1467999666929245, 0.17662683129310608], [0.1631583869457245, 0.16831958293914795, 0.1682417243719101, 0.16799622774124146, 0.1644432097673416, 0.167840838432312], [0.1378224790096283, 0.1806921660900116, 0.17996661365032196, 0.1776956170797348, 0.14755165576934814, 0.17627139389514923]], [[0.17266440391540527, 0.15896783769130707, 0.1740114688873291, 0.16020803153514862, 0.15986205637454987, 0.17428623139858246], [0.16117560863494873, 0.17368480563163757, 0.1600467711687088, 0.17246834933757782, 0.17280589044094086, 0.15981855988502502], [0.17372849583625793, 0.15759775042533875, 0.17532768845558167, 0.15904845297336578, 0.15864354372024536, 0.17565414309501648], [0.16226695477962494, 0.17229197919368744, 0.16135483980178833, 0.1713235229253769, 0.17159238457679749, 0.16117030382156372], [0.1619635373353958, 0.17267930507659912, 0.16099080443382263, 0.1716422140598297, 0.17193008959293365, 0.16079403460025787], [0.1739441156387329, 0.15731994807720184, 0.17559489607810974, 0.15881295502185822, 0.15839619934558868, 0.17593194544315338]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 0.0}, "num_env_steps_sampled": 400, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.667802735289061e-06, "normalize_and_clip_actions": 8.207158798563233e-06, "get_actions": 3.905825665200799e-05, "listify_data_for_vector_env": 1.0798826787528437e-05, "tensor_to_numpy": 1.5651547666827287e-05, "remove_single_ts_time_rank_from_batch": 1.2216254411043459e-05}}, "connector_pipeline_timer": 0.00011948362372216317}, "env_to_module_connector": {"connector_pipeline_timer": 6.051213916427539e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.559339655970158e-06, "add_states_from_episodes_to_batch": 2.731867304283467e-06, "batch_individual_items": 1.2530476101050869e-05, "numpy_to_tensor": 1.246115801921323e-05, "add_observations_from_episodes_to_batch": 2.871776590879624e-06}}}, "num_episodes_lifetime": 240, "rlmodule_inference_timer": 3.316715120296199e-05, "episode_duration_sec_mean": 0.005439121269155293, "episode_len_mean": 20.0, "num_episodes": 20, "episode_return_max": 13.5, "weights_seq_no": 12.0, "sample": 0.11691388322730714, "episode_len_max": 20, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "env_reset_timer": 0.0005640344258821412, "num_env_steps_sampled_lifetime": 60400, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 0.0, "env_step_timer": 1.4286912150976469e-05, "agent_episode_returns_mean": {"default_agent": 0.0}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_min": -13.5, "time_between_sampling": 10.251568081148923}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "b13c4_00000", "date": "2025-08-11_18-06-19", "timestamp": 1754928379, "time_this_iter_s": 11.459048986434937, "time_total_s": 123.87523889541626, "pid": 10212, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x144efd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 123.87523889541626, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 52.50625, "ram_util_percent": 82.75625}}
{"timers": {"training_iteration": 9.88921979100873, "restore_env_runners": 1.0914036283174513e-05, "training_step": 9.889050489094158, "env_runner_sampling_timer": 1.899297072527154, "learner_update_timer": 7.76450222112715, "synch_weights": 0.001455081900936912, "restore_eval_env_runners": 3.436759531677061e-05, "evaluation_iteration": 0.12798738602050658, "synch_eval_env_connectors": 0.0001425771984594617, "synch_env_connectors": 4.960143450073664e-06}, "env_runners": {"rlmodule_inference_timer": 4.856657043890045e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.1436680799291814e-05, "numpy_to_tensor": 2.696411618912472e-05, "add_states_from_episodes_to_batch": 3.698976098903615e-06, "batch_individual_items": 1.7019373168157725e-05, "add_observations_from_episodes_to_batch": 3.857242396050464e-06}}, "connector_pipeline_timer": 9.22341145209471e-05}, "env_step_timer": 2.6392771200721367e-05, "episode_len_max": 20, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.0931370171886395e-05, "get_actions": 8.119646578051575e-05, "remove_single_ts_time_rank_from_batch": 1.550741258873914e-05, "listify_data_for_vector_env": 1.6542494411239578e-05, "tensor_to_numpy": 2.3761899826150123e-05, "un_batch_to_individual_items": 8.727121072371595e-06}}, "connector_pipeline_timer": 0.000193768417445455}, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "episode_duration_sec_mean": 0.008492512390948833, "time_between_sampling": 0.039858257811924404, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": -2.2199999999999998}, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": -2.2199999999999998}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "env_reset_timer": 0.00010789542837892319, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime": -6782500.0, "episode_return_min": -13.5, "episode_return_mean": -2.2199999999999998, "weights_seq_no": 12.0, "sample": 0.008350827363403803, "num_episodes_lifetime": -339125.0, "num_env_steps_sampled_lifetime_throughput": 2722.9640020999636}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1744233049886125, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009627985201275006, "add_observations_from_episodes_to_batch": 0.0009342704714364416, "add_columns_from_episodes_to_train_batch": 0.04959661800170001, "add_time_dim_to_batch_and_zero_pad": 0.10184577621536514, "add_states_from_episodes_to_batch": 0.00388404462636703, "batch_individual_items": 0.008233126304790568, "numpy_to_tensor": 9.628743114402751e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"vf_loss": 0.3205089271068573, "mean_kl_loss": 1.6331156075466424e-05, "num_module_steps_trained_lifetime": 77805, "num_module_steps_trained": 5985, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 998.1808187151925, "weights_seq_no": 13.0, "vf_explained_var": 0.0005053281784057617, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.2485118806362152, "curr_kl_coeff": 1.9724600861081854e-05, "policy_loss": -0.00013517076149582863, "vf_loss_unclipped": 42.03720474243164, "entropy": 0.6776750683784485, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 739.1202527330983}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.1808187151925, "weights_seq_no": 13.0, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 77805, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 739.1281517217407}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 468000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 155610, "num_env_steps_trained_lifetime_throughput": 4449.930777875509, "num_module_steps_trained_throughput": 22924658.60028813, "num_module_steps_trained_lifetime_throughput": 12777611.842563024}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.24886000156402588, "use_intrinsic_rewards": 1.0, "diff_num_grad_updates_vs_sampler_policy": 66.0, "mean_kl_loss": 1.5838879335206002e-05, "policy_loss": -0.00013315728574525565, "vf_loss_unclipped": 41.846073150634766, "num_module_steps_trained_lifetime": 466830, "entropy": 0.6776902079582214, "vf_loss": 0.32094988226890564, "vf_explained_var": 0.005327403545379639, "num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.5061250970534, "weights_seq_no": 78.0}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.5061250970534, "weights_seq_no": 78.0, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 66.0, "num_module_steps_trained_lifetime": 466830}, "__all_modules__": {"num_env_steps_trained_lifetime": 2808000, "num_module_steps_trained_lifetime": 933660, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 50020.41111921393}}}, "IntrinsicAttentionMask": [[[0.17132122814655304, 0.16793447732925415, 0.1680862009525299, 0.16182363033294678, 0.16871829330921173, 0.1621161699295044], [0.16219300031661987, 0.16537249088287354, 0.16522733867168427, 0.17144125699996948, 0.16462545096874237, 0.17114044725894928], [0.1626012623310089, 0.16549372673034668, 0.16536179184913635, 0.17100057005882263, 0.16481459140777588, 0.17072802782058716], [0.14583757519721985, 0.15997444093227386, 0.1593063920736313, 0.18995261192321777, 0.15655961632728577, 0.18836945295333862], [0.16430285573005676, 0.16599221527576447, 0.16591544449329376, 0.16917462646961212, 0.16559667885303497, 0.16901814937591553], [0.14661560952663422, 0.1602560132741928, 0.1596125066280365, 0.1890326738357544, 0.15696552395820618, 0.18751759827136993]], [[0.166692852973938, 0.16663312911987305, 0.16669845581054688, 0.16669981181621552, 0.16663718223571777, 0.1666385382413864], [0.15507738292217255, 0.1814466267824173, 0.15280431509017944, 0.1522623896598816, 0.17952297627925873, 0.1788862943649292], [0.16777311265468597, 0.16524915397167206, 0.16801239550113678, 0.16807003319263458, 0.16541925072669983, 0.1654759794473648], [0.16803264617919922, 0.1649164855480194, 0.168328657746315, 0.16839995980262756, 0.16512614488601685, 0.16519609093666077], [0.15587124228477478, 0.1804375797510147, 0.15374088287353516, 0.1532326638698578, 0.17865410447120667, 0.1780635416507721], [0.15613572299480438, 0.18010129034519196, 0.15405333042144775, 0.1535564661026001, 0.17836424708366394, 0.17778895795345306]], [[0.17247873544692993, 0.16230662167072296, 0.16922184824943542, 0.16291695833206177, 0.1630641520023346, 0.17001166939735413], [0.13917724788188934, 0.18866243958473206, 0.1531093269586563, 0.18515166640281677, 0.1843167543411255, 0.14958256483078003], [0.16161872446537018, 0.17053158581256866, 0.1643625795841217, 0.16996727883815765, 0.169831782579422, 0.1636880785226822], [0.14111760258674622, 0.1870296597480774, 0.15415051579475403, 0.18380488455295563, 0.18303732573986053, 0.150859996676445], [0.14158685505390167, 0.1866367608308792, 0.1544003039598465, 0.1834801733493805, 0.18272869288921356, 0.15116724371910095], [0.16423793137073517, 0.16851697862148285, 0.1655680537223816, 0.16824956238269806, 0.1681852787733078, 0.16524216532707214]], [[0.16793783009052277, 0.1682521402835846, 0.1555313616991043, 0.16956478357315063, 0.16919858753681183, 0.16951526701450348], [0.1679893434047699, 0.1683173030614853, 0.15506549179553986, 0.16968727111816406, 0.16930504143238068, 0.1696355789899826], [0.16558918356895447, 0.16535143554210663, 0.17564831674098969, 0.1643669605255127, 0.16464023292064667, 0.16440385580062866], [0.1682005673646927, 0.1685853749513626, 0.15314128994941711, 0.17019419372081757, 0.16974510252475739, 0.17013345658779144], [0.16814225912094116, 0.16851124167442322, 0.15367460250854492, 0.17005351185798645, 0.16962306201457977, 0.1699952930212021], [0.16819271445274353, 0.16857539117336273, 0.1532132625579834, 0.1701752096414566, 0.16972863674163818, 0.17011480033397675]], [[0.17365965247154236, 0.16341789066791534, 0.17038047313690186, 0.16403241455554962, 0.16418060660362244, 0.1643289476633072], [0.13461343944072723, 0.1824759542942047, 0.14808866381645203, 0.1790803074836731, 0.1782727688550949, 0.17746888101100922], [0.1606534719467163, 0.16951310634613037, 0.1633809357881546, 0.16895216703414917, 0.16881747543811798, 0.16868290305137634], [0.13681970536708832, 0.18133345246315002, 0.14945568144321442, 0.1782068908214569, 0.17746269702911377, 0.17672161757946014], [0.1373545378446579, 0.18105782568454742, 0.14978498220443726, 0.17799559235572815, 0.17726656794548035, 0.1765405386686325], [0.13789092004299164, 0.18078190088272095, 0.15011440217494965, 0.17778386175632477, 0.17706996202468872, 0.17635893821716309]], [[0.16566547751426697, 0.16597552597522736, 0.16695792973041534, 0.16727040708065033, 0.16690917313098907, 0.1672215610742569], [0.16562241315841675, 0.16594575345516205, 0.16697043180465698, 0.1672964096069336, 0.16691957414150238, 0.16724544763565063], [0.16548655927181244, 0.16585180163383484, 0.1670098751783371, 0.1673784852027893, 0.16695237159729004, 0.1673208475112915], [0.165443554520607, 0.16582204401493073, 0.16702237725257874, 0.16740450263023376, 0.16696277260780334, 0.16734474897384644], [0.16549329459667206, 0.1658564656972885, 0.1670079380273819, 0.16737443208694458, 0.1669507622718811, 0.16731712222099304], [0.16545026004314423, 0.1658266931772232, 0.16702042520046234, 0.16740043461322784, 0.16696113348007202, 0.16734102368354797]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 0.0}, "num_env_steps_sampled": 400, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.5186532028384095e-06, "normalize_and_clip_actions": 7.958388833210846e-06, "get_actions": 3.5109571420888626e-05, "listify_data_for_vector_env": 1.0528581196917468e-05, "tensor_to_numpy": 1.4750702597537463e-05, "remove_single_ts_time_rank_from_batch": 1.1868359914045094e-05}}, "connector_pipeline_timer": 0.00011299834130358083}, "env_to_module_connector": {"connector_pipeline_timer": 5.831464711171837e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.8968108834865115e-06, "add_states_from_episodes_to_batch": 2.685073033454774e-06, "batch_individual_items": 1.211589901893422e-05, "numpy_to_tensor": 1.1775507813703468e-05, "add_observations_from_episodes_to_batch": 2.834486052402443e-06}}}, "num_episodes_lifetime": 260, "rlmodule_inference_timer": 3.0257946692613033e-05, "episode_duration_sec_mean": 0.00541728297714144, "episode_len_mean": 20.0, "num_episodes": 20, "episode_return_max": 13.5, "weights_seq_no": 13.0, "sample": 0.11687865272526411, "episode_len_max": 20, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "env_reset_timer": 0.0005614670014130215, "num_env_steps_sampled_lifetime": 65400, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 0.0, "env_step_timer": 1.350941624240406e-05, "agent_episode_returns_mean": {"default_agent": 0.0}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_min": -13.5, "time_between_sampling": 10.274497161997617}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "b13c4_00000", "date": "2025-08-11_18-06-32", "timestamp": 1754928392, "time_this_iter_s": 12.637890100479126, "time_total_s": 136.51312899589539, "pid": 10212, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x144efd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 136.51312899589539, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 57.66111111111112, "ram_util_percent": 82.84444444444443}}
{"timers": {"training_iteration": 9.897226217269214, "restore_env_runners": 1.092239623296913e-05, "training_step": 9.897056120863578, "env_runner_sampling_timer": 1.8974834234613784, "learner_update_timer": 7.774493893076634, "synch_weights": 0.0014567940020352354, "restore_eval_env_runners": 3.444183989158263e-05, "evaluation_iteration": 0.12792537548952207, "synch_eval_env_connectors": 0.00014285559661064823, "synch_env_connectors": 5.0188816065247275e-06}, "env_runners": {"rlmodule_inference_timer": 3.185925903395812e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.977155944572754e-06, "numpy_to_tensor": 1.2935671906153661e-05, "add_states_from_episodes_to_batch": 2.7820441502002556e-06, "batch_individual_items": 1.2768443135129679e-05, "add_observations_from_episodes_to_batch": 2.832486506898625e-06}}, "connector_pipeline_timer": 6.053290613990486e-05}, "env_step_timer": 1.4183778484272014e-05, "episode_len_max": 20, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.169949767470485e-06, "get_actions": 3.915614905917444e-05, "remove_single_ts_time_rank_from_batch": 1.2195333977939298e-05, "listify_data_for_vector_env": 1.0603998435643988e-05, "tensor_to_numpy": 1.542479663795972e-05, "un_batch_to_individual_items": 6.727162896581503e-06}}, "connector_pipeline_timer": 0.00011897993189618358}, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "episode_duration_sec_mean": 0.005325333003886045, "time_between_sampling": 0.04093598789351263, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": -2.0599999999999996}, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": -2.0599999999999996}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "env_reset_timer": 6.134781898780282e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime": -7400000.0, "episode_return_min": -13.5, "episode_return_mean": -2.0599999999999996, "weights_seq_no": 13.0, "sample": 0.006459768306090712, "num_episodes_lifetime": -370000.0, "num_env_steps_sampled_lifetime_throughput": 3199.7579398985413}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17424335110943323, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009625237429325853, "add_observations_from_episodes_to_batch": 0.000933320686275521, "add_columns_from_episodes_to_train_batch": 0.049520541400744425, "add_time_dim_to_batch_and_zero_pad": 0.10175211012361587, "add_states_from_episodes_to_batch": 0.003884560849980084, "batch_individual_items": 0.008226997961915025, "numpy_to_tensor": 9.620205594730926e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"vf_loss": 0.3205088675022125, "mean_kl_loss": 1.4945942893973552e-05, "num_module_steps_trained_lifetime": 83790, "num_module_steps_trained": 5985, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 998.1405362012929, "weights_seq_no": 14.0, "vf_explained_var": 0.0006340742111206055, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.2483178973197937, "curr_kl_coeff": 9.862300430540927e-06, "policy_loss": -0.00033009506296366453, "vf_loss_unclipped": 39.91230773925781, "entropy": 0.677046000957489, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 734.4713904336247}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.1405362012929, "weights_seq_no": 14.0, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 83790, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 734.4787116004237}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 504000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 167580, "num_env_steps_trained_lifetime_throughput": 4421.810895930205, "num_module_steps_trained_throughput": 22286388.5600871, "num_module_steps_trained_lifetime_throughput": 12699855.190450927}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.24857734143733978, "use_intrinsic_rewards": 1.0, "diff_num_grad_updates_vs_sampler_policy": 71.0, "mean_kl_loss": 1.3741582733928226e-05, "policy_loss": -0.00031769226188771427, "vf_loss_unclipped": 39.8486213684082, "num_module_steps_trained_lifetime": 502740, "entropy": 0.6770864725112915, "vf_loss": 0.32082319259643555, "vf_explained_var": 0.0055179595947265625, "num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.501977255973, "weights_seq_no": 84.0}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.501977255973, "weights_seq_no": 84.0, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 71.0, "num_module_steps_trained_lifetime": 502740}, "__all_modules__": {"num_env_steps_trained_lifetime": 3024000, "num_module_steps_trained_lifetime": 1005480, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 49168.43900088492}}}, "IntrinsicAttentionMask": [[[0.17247433960437775, 0.16230247914791107, 0.16244912147521973, 0.16291281580924988, 0.16985388100147247, 0.17000733315944672], [0.13908742368221283, 0.18854068219661713, 0.18769049644470215, 0.1850321739912033, 0.15016315877437592, 0.14948603510856628], [0.13955570757389069, 0.18815241754055023, 0.1873190701007843, 0.1847129762172699, 0.15046310424804688, 0.14979667961597443], [0.14103955030441284, 0.1869262009859085, 0.18614561855793, 0.1837031990289688, 0.1514088362455368, 0.15077655017375946], [0.16372713446617126, 0.1689063161611557, 0.16882817447185516, 0.16858182847499847, 0.16501642763614655, 0.16494008898735046], [0.16423717141151428, 0.16851620376110077, 0.16845181584358215, 0.16824878752231598, 0.16530455648899078, 0.16524140536785126]], [[0.1726689487695694, 0.15897201001644135, 0.1740160435438156, 0.16021224856376648, 0.1739652156829834, 0.1601654589176178], [0.1611790806055069, 0.17368854582309723, 0.16005021333694458, 0.1724720597267151, 0.16009250283241272, 0.17251762747764587], [0.1737348735332489, 0.15760351717472076, 0.1753341108560562, 0.15905427932739258, 0.17527373135089874, 0.158999502658844], [0.1622692048549652, 0.17229437828063965, 0.1613570898771286, 0.1713259071111679, 0.16139128804206848, 0.17136220633983612], [0.17369484901428223, 0.15765489637851715, 0.17528456449508667, 0.1590978056192398, 0.17522455751895905, 0.1590433269739151], [0.16222825646400452, 0.17234674096107483, 0.1613079458475113, 0.1713690161705017, 0.16134244203567505, 0.17140565812587738]], [[0.17131690680980682, 0.1679302453994751, 0.16135896742343903, 0.16856172680854797, 0.1619657427072525, 0.16886645555496216], [0.1621890515089035, 0.1653684675693512, 0.17191286385059357, 0.16476605832576752, 0.17128661274909973, 0.16447696089744568], [0.14452064037322998, 0.1594235748052597, 0.1939832717180252, 0.15650929510593414, 0.1904372274875641, 0.1551259458065033], [0.16389122605323792, 0.1658715307712555, 0.16990260779857635, 0.16549745202064514, 0.16951943933963776, 0.16531774401664734], [0.14614608883857727, 0.16002757847309113, 0.19185763597488403, 0.157321035861969, 0.18861274421215057, 0.15603497624397278], [0.16471265256404877, 0.166110098361969, 0.1689395159482956, 0.16584649682044983, 0.16867142915725708, 0.16571979224681854]], [[0.16794148087501526, 0.16825580596923828, 0.1692516952753067, 0.16956846415996552, 0.1692022681236267, 0.15578033030033112], [0.16799330711364746, 0.16832126677036285, 0.16936062276363373, 0.169691264629364, 0.16930903494358063, 0.1553245484828949], [0.16815520823001862, 0.16852633655071259, 0.16970309615135193, 0.1700776368379593, 0.16964465379714966, 0.15389308333396912], [0.16820597648620605, 0.16859079897403717, 0.1698111742734909, 0.1701996773481369, 0.16975057125091553, 0.15344180166721344], [0.1681472510099411, 0.16851624846458435, 0.1696861833333969, 0.17005856335163116, 0.1696280986070633, 0.15396368503570557], [0.16564418375492096, 0.1654176115989685, 0.16470448672771454, 0.16447919607162476, 0.1647397130727768, 0.17501483857631683]], [[0.18634696304798126, 0.16420148313045502, 0.1637524515390396, 0.16234326362609863, 0.16189929842948914, 0.16145657002925873], [0.16001373529434204, 0.16745337843894958, 0.16761818528175354, 0.16813936829566956, 0.16830483078956604, 0.16847047209739685], [0.15947847068309784, 0.1675155758857727, 0.16769394278526306, 0.16825814545154572, 0.16843730211257935, 0.1686166524887085], [0.15779848396778107, 0.1677095592021942, 0.16793082654476166, 0.16863110661506653, 0.16885359585285187, 0.1690763682126999], [0.15726922452449799, 0.16777034103870392, 0.16800522804260254, 0.16874872148036957, 0.16898496448993683, 0.16922155022621155], [0.15674138069152832, 0.16783076524734497, 0.16807927191257477, 0.16886600852012634, 0.1691160500049591, 0.16936646401882172]], [[0.17430809140205383, 0.17399954795837402, 0.1730293184518814, 0.15943068265914917, 0.1597575843334198, 0.15947480499744415], [0.17396001517772675, 0.1736660748720169, 0.1727416217327118, 0.15975911915302277, 0.16007179021835327, 0.15980131924152374], [0.1728617399930954, 0.17261354625225067, 0.17183253169059753, 0.16079625487327576, 0.16106359660625458, 0.16083234548568726], [0.1568787693977356, 0.1572376936674118, 0.15837587416172028, 0.17601168155670166, 0.17554724216461182, 0.1759488582611084], [0.15727557241916656, 0.15762072801589966, 0.15871500968933105, 0.17563113570213318, 0.17518655955791473, 0.175571009516716], [0.15693235397338867, 0.15728941559791565, 0.15842169523239136, 0.1759602576494217, 0.17549850046634674, 0.17589780688285828]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 0.8}, "num_env_steps_sampled": 400, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.431979184823174e-06, "normalize_and_clip_actions": 7.833440056597225e-06, "get_actions": 3.557739819582256e-05, "listify_data_for_vector_env": 1.035729929174312e-05, "tensor_to_numpy": 1.4787293211365451e-05, "remove_single_ts_time_rank_from_batch": 1.1787678750556496e-05}}, "connector_pipeline_timer": 0.0001128899309440412}, "env_to_module_connector": {"connector_pipeline_timer": 5.8200036240490736e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.914185286746928e-06, "add_states_from_episodes_to_batch": 2.664329380804295e-06, "batch_individual_items": 1.2109750542590648e-05, "numpy_to_tensor": 1.1675615980770583e-05, "add_observations_from_episodes_to_batch": 2.8197014940391316e-06}}}, "num_episodes_lifetime": 280, "rlmodule_inference_timer": 3.064136929679326e-05, "episode_duration_sec_mean": 0.005419549678917974, "episode_len_mean": 20.0, "num_episodes": 20, "episode_return_max": 13.5, "weights_seq_no": 14.0, "sample": 0.11684725577826499, "episode_len_max": 20, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "env_reset_timer": 0.0005587594105777311, "num_env_steps_sampled_lifetime": 70400, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 0.8, "env_step_timer": 1.358482221542967e-05, "agent_episode_returns_mean": {"default_agent": 0.8}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_min": -13.5, "time_between_sampling": 10.278976962047938}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "b13c4_00000", "date": "2025-08-11_18-06-43", "timestamp": 1754928403, "time_this_iter_s": 10.815923929214478, "time_total_s": 147.32905292510986, "pid": 10212, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x144efd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 147.32905292510986, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 45.49375, "ram_util_percent": 82.3625}}
{"timers": {"training_iteration": 9.899044952596821, "restore_env_runners": 1.1074003127499124e-05, "training_step": 9.898871943815106, "env_runner_sampling_timer": 1.893902147136175, "learner_update_timer": 7.778659635395441, "synch_weights": 0.0014579873112479202, "restore_eval_env_runners": 3.462242199781617e-05, "evaluation_iteration": 0.1278724471550568, "synch_eval_env_connectors": 0.00014333454061727264, "synch_env_connectors": 5.061192912723508e-06}, "env_runners": {"rlmodule_inference_timer": 3.155780194124254e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.91998442164372e-06, "numpy_to_tensor": 1.2668971213891846e-05, "add_states_from_episodes_to_batch": 2.745902708872913e-06, "batch_individual_items": 1.2638709157425906e-05, "add_observations_from_episodes_to_batch": 2.8215748631118585e-06}}, "connector_pipeline_timer": 5.981456343564325e-05}, "env_step_timer": 1.397917900810677e-05, "episode_len_max": 20, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.100296145791182e-06, "get_actions": 3.869537605776589e-05, "remove_single_ts_time_rank_from_batch": 1.2084525971540313e-05, "listify_data_for_vector_env": 1.0534143824636623e-05, "tensor_to_numpy": 1.5271475685139485e-05, "un_batch_to_individual_items": 6.673250621742679e-06}}, "connector_pipeline_timer": 0.0001179022300393961}, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "episode_duration_sec_mean": 0.005260268534068019, "time_between_sampling": 0.037592007034532776, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": -1.9799999999999998}, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": -1.9799999999999998}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "env_reset_timer": 4.494911592612871e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime": -8017500.0, "episode_return_min": -13.5, "episode_return_mean": -1.9799999999999998, "weights_seq_no": 14.0, "sample": 0.005754891400191926, "num_episodes_lifetime": -400875.0, "num_env_steps_sampled_lifetime_throughput": 3234.000532329949}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17549086634764832, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009617418805239197, "add_observations_from_episodes_to_batch": 0.0009334549799075588, "add_columns_from_episodes_to_train_batch": 0.0508744055669399, "add_time_dim_to_batch_and_zero_pad": 0.1016586356917679, "add_states_from_episodes_to_batch": 0.0038852419010099396, "batch_individual_items": 0.00822219673282859, "numpy_to_tensor": 9.602170606624312e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"vf_loss": 0.3205088973045349, "mean_kl_loss": 1.3061153367743827e-06, "num_module_steps_trained_lifetime": 89775, "num_module_steps_trained": 5985, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 998.1026110140886, "weights_seq_no": 15.0, "vf_explained_var": 0.00032192468643188477, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.24858595430850983, "curr_kl_coeff": 4.931150215270463e-06, "policy_loss": -6.288918666541576e-05, "vf_loss_unclipped": 41.50943374633789, "entropy": 0.6765013933181763, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 730.4386623461332}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.1026110140886, "weights_seq_no": 15.0, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 89775, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 730.4454396181794}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 540000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 179550, "num_env_steps_trained_lifetime_throughput": 4397.407804671253, "num_module_steps_trained_throughput": 21720435.468432587, "num_module_steps_trained_lifetime_throughput": 12653105.550361397}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.24882766604423523, "use_intrinsic_rewards": 1.0, "diff_num_grad_updates_vs_sampler_policy": 76.0, "mean_kl_loss": 1.0883649110837723e-06, "policy_loss": -5.816206248709932e-05, "vf_loss_unclipped": 41.349609375, "num_module_steps_trained_lifetime": 538650, "entropy": 0.6765284538269043, "vf_loss": 0.3208128809928894, "vf_explained_var": 0.0053688883781433105, "num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.499088644618, "weights_seq_no": 90.0}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.499088644618, "weights_seq_no": 90.0, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 76.0, "num_module_steps_trained_lifetime": 538650}, "__all_modules__": {"num_env_steps_trained_lifetime": 3240000, "num_module_steps_trained_lifetime": 1077300, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 48367.031322943774}}}, "IntrinsicAttentionMask": [[[0.1751079261302948, 0.1542980968952179, 0.17415152490139008, 0.15255194902420044, 0.17218069732189178, 0.1717098355293274], [0.1636023372411728, 0.17120884358882904, 0.16392450034618378, 0.17191021144390106, 0.16459603607654572, 0.16475802659988403], [0.17461538314819336, 0.15501372516155243, 0.1737176477909088, 0.15336214005947113, 0.171866774559021, 0.17142440378665924], [0.16255596280097961, 0.17276586592197418, 0.1629851907491684, 0.17371518909931183, 0.16388076543807983, 0.16409698128700256], [0.1735900342464447, 0.15650591254234314, 0.17281325161457062, 0.15505406260490417, 0.17121011018753052, 0.17082661390304565], [0.1733429878950119, 0.15686596930027008, 0.17259512841701508, 0.1554628163576126, 0.1710512638092041, 0.1706818789243698]], [[0.1667030155658722, 0.16664330661296844, 0.16670863330364227, 0.16664890944957733, 0.16664735972881317, 0.16664870083332062], [0.15107031166553497, 0.17675818502902985, 0.14885596930980682, 0.17416732013225555, 0.17488424479961395, 0.17426399886608124], [0.16820795834064484, 0.16567747294902802, 0.16844788193702698, 0.16591377556324005, 0.1658480018377304, 0.16590489447116852], [0.15250925719738007, 0.17582035064697266, 0.15048310160636902, 0.17348448932170868, 0.17413116991519928, 0.17357172071933746], [0.15210826694965363, 0.17608153820037842, 0.15002934634685516, 0.17367495596408844, 0.1743411123752594, 0.17376480996608734], [0.15245503187179565, 0.1758556365966797, 0.15042172372341156, 0.17351023852825165, 0.17415954172611237, 0.1735978126525879]], [[0.17503881454467773, 0.17456014454364777, 0.17408280074596405, 0.17258469760417938, 0.15207472443580627, 0.15165884792804718], [0.1747966706752777, 0.17433270812034607, 0.17386998236179352, 0.172417551279068, 0.15249398350715637, 0.1520892083644867], [0.1745542287826538, 0.17410492897033691, 0.17365680634975433, 0.1722499430179596, 0.15291382372379303, 0.15252022445201874], [0.17378738522529602, 0.1733841449022293, 0.1729818433523178, 0.17171820998191833, 0.15424315631389618, 0.15388526022434235], [0.1622866690158844, 0.162513867020607, 0.16274139285087585, 0.1634615957736969, 0.17437617480754852, 0.17462031543254852], [0.16203255951404572, 0.16227248311042786, 0.16251274943351746, 0.16327343881130219, 0.17482496798038483, 0.17508383095264435]], [[0.1666826754808426, 0.16668401658535004, 0.1666272133588791, 0.16662856936454773, 0.16668806970119476, 0.1666894257068634], [0.16684158146381378, 0.16685637831687927, 0.16623549163341522, 0.16625022888183594, 0.16690076887607574, 0.16691556572914124], [0.15991216897964478, 0.1593855619430542, 0.18309630453586578, 0.18249334394931793, 0.15781614184379578, 0.15729643404483795], [0.16008269786834717, 0.15956838428974152, 0.1826864778995514, 0.18209953606128693, 0.15803535282611847, 0.1575276106595993], [0.1673165261745453, 0.16737180948257446, 0.16506315767765045, 0.16511769592761993, 0.16753776371479034, 0.1675931215286255], [0.16747422516345978, 0.16754305362701416, 0.164673313498497, 0.16474099457263947, 0.16774971783161163, 0.16781866550445557]], [[0.17868992686271667, 0.15745441615581512, 0.17771396040916443, 0.15567253530025482, 0.1552468240261078, 0.17522233724594116], [0.1623871624469757, 0.1699371635913849, 0.16270692646503448, 0.17063333094120026, 0.17080125212669373, 0.1635342687368393], [0.17797908186912537, 0.15799982845783234, 0.17706404626369476, 0.15631642937660217, 0.1559140831232071, 0.17472662031650543], [0.1609364002943039, 0.17104455828666687, 0.16136132180690765, 0.17198441922664642, 0.17221133410930634, 0.162462055683136], [0.16058780252933502, 0.17131051421165466, 0.16103777289390564, 0.1723095327615738, 0.172550767660141, 0.16220365464687347], [0.17614799737930298, 0.15940435230731964, 0.17538803815841675, 0.15797848999500275, 0.1576373279094696, 0.17344382405281067]], [[0.1666826754808426, 0.16668401658535004, 0.1666272133588791, 0.16668963432312012, 0.16662700474262238, 0.1666894257068634], [0.1668415665626526, 0.16685634851455688, 0.16623547673225403, 0.1669178605079651, 0.16623318195343018, 0.16691555082798004], [0.15989674627780914, 0.15937018394470215, 0.18307863175868988, 0.15720024704933167, 0.18317300081253052, 0.15728124976158142], [0.16749858856201172, 0.16756953299045563, 0.16461221873760223, 0.16786473989486694, 0.16460132598876953, 0.16785363852977753], [0.1598699539899826, 0.1593414843082428, 0.1831425428390503, 0.15716369450092316, 0.18323729932308197, 0.15724501013755798], [0.16747398674488068, 0.16754283010959625, 0.1646730750799179, 0.16782920062541962, 0.16466251015663147, 0.16781842708587646]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 0.8}, "num_env_steps_sampled": 400, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.480919056502489e-06, "normalize_and_clip_actions": 7.867416504139826e-06, "get_actions": 3.551285714415184e-05, "listify_data_for_vector_env": 1.0440330507478124e-05, "tensor_to_numpy": 1.4835023074633188e-05, "remove_single_ts_time_rank_from_batch": 1.1691390865395909e-05}}, "connector_pipeline_timer": 0.00011267291492474437}, "env_to_module_connector": {"connector_pipeline_timer": 5.890934114095023e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.1500409092576736e-06, "add_states_from_episodes_to_batch": 2.724619052116647e-06, "batch_individual_items": 1.231749285379111e-05, "numpy_to_tensor": 1.184530819267379e-05, "add_observations_from_episodes_to_batch": 2.8099019329891555e-06}}}, "num_episodes_lifetime": 300, "rlmodule_inference_timer": 3.0574613339519454e-05, "episode_duration_sec_mean": 0.005416330909356475, "episode_len_mean": 20.0, "num_episodes": 20, "episode_return_max": 13.5, "weights_seq_no": 15.0, "sample": 0.11682555071964049, "episode_len_max": 20, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "env_reset_timer": 0.0005563618163149701, "num_env_steps_sampled_lifetime": 75400, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 0.8, "env_step_timer": 1.3677958345004287e-05, "agent_episode_returns_mean": {"default_agent": 0.8}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_min": -13.5, "time_between_sampling": 10.277319819518597}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "b13c4_00000", "date": "2025-08-11_18-06-53", "timestamp": 1754928413, "time_this_iter_s": 10.206121921539307, "time_total_s": 157.53517484664917, "pid": 10212, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x144efd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 157.53517484664917, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 46.357142857142854, "ram_util_percent": 80.82142857142857}}
{"timers": {"training_iteration": 9.896026655980814, "restore_env_runners": 1.1123263150389854e-05, "training_step": 9.895852587716199, "env_runner_sampling_timer": 1.8903289885856935, "learner_update_timer": 7.7794274561215, "synch_weights": 0.001458208688207637, "restore_eval_env_runners": 3.458203829057564e-05, "evaluation_iteration": 0.12783026268346065, "synch_eval_env_connectors": 0.00014347327470197016, "synch_env_connectors": 5.088500086801477e-06}, "env_runners": {"rlmodule_inference_timer": 3.132264737428574e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.86754239578957e-06, "numpy_to_tensor": 1.2736015977683045e-05, "add_states_from_episodes_to_batch": 2.7390545154411593e-06, "batch_individual_items": 1.261435315012279e-05, "add_observations_from_episodes_to_batch": 2.826247126216609e-06}}, "connector_pipeline_timer": 5.984504055689334e-05}, "env_step_timer": 1.3974388825406585e-05, "episode_len_max": 20, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.074519072603755e-06, "get_actions": 3.867872489551206e-05, "remove_single_ts_time_rank_from_batch": 1.2098934480142762e-05, "listify_data_for_vector_env": 1.0495043375801625e-05, "tensor_to_numpy": 1.5231691723819412e-05, "un_batch_to_individual_items": 6.673591321956952e-06}}, "connector_pipeline_timer": 0.00011786949691871057}, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "episode_duration_sec_mean": 0.005266913198865951, "time_between_sampling": 0.03543785984501814, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": -1.1800000000000002}, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": -1.1800000000000002}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "env_reset_timer": 4.1044589379689315e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime": -8635000.0, "episode_return_min": -13.5, "episode_return_mean": -1.1800000000000002, "weights_seq_no": 15.0, "sample": 0.005621804677106366, "num_episodes_lifetime": -431750.0, "num_env_steps_sampled_lifetime_throughput": 3257.6116964682305}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17529286227486046, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009610008786673044, "add_observations_from_episodes_to_batch": 0.000933737509157832, "add_columns_from_episodes_to_train_batch": 0.05078814401112328, "add_time_dim_to_batch_and_zero_pad": 0.10156028225449852, "add_states_from_episodes_to_batch": 0.003887416561569016, "batch_individual_items": 0.008214493095429865, "numpy_to_tensor": 9.603315880243494e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"vf_loss": 0.32050859928131104, "mean_kl_loss": 1.90411683433922e-05, "num_module_steps_trained_lifetime": 95760, "num_module_steps_trained": 5985, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 998.0669052031734, "weights_seq_no": 16.0, "vf_explained_var": 0.0004947781562805176, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.24815011024475098, "curr_kl_coeff": 2.4655751076352317e-06, "policy_loss": -0.000499510089866817, "vf_loss_unclipped": 38.53706741333008, "entropy": 0.6758877635002136, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 727.195992702082}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.0669052031734, "weights_seq_no": 16.0, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 95760, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 727.2022711617603}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 576000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 191520, "num_env_steps_trained_lifetime_throughput": 4377.759743722941, "num_module_steps_trained_throughput": 21205238.870311804, "num_module_steps_trained_lifetime_throughput": 12627381.231723258}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.24833513796329498, "use_intrinsic_rewards": 1.0, "diff_num_grad_updates_vs_sampler_policy": 81.0, "mean_kl_loss": 1.6760795915615745e-05, "policy_loss": -0.00046968963579274714, "vf_loss_unclipped": 38.53009796142578, "num_module_steps_trained_lifetime": 574560, "entropy": 0.675957441329956, "vf_loss": 0.32070451974868774, "vf_explained_var": 0.005735874176025391, "num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.4970769774884, "weights_seq_no": 96.0}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.4970769774884, "weights_seq_no": 96.0, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 81.0, "num_module_steps_trained_lifetime": 574560}, "__all_modules__": {"num_env_steps_trained_lifetime": 3456000, "num_module_steps_trained_lifetime": 1149120, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 47624.44721586985}}}, "IntrinsicAttentionMask": [[[0.17868992686271667, 0.15745441615581512, 0.17771396040916443, 0.15567253530025482, 0.1552468240261078, 0.17522233724594116], [0.1623871624469757, 0.1699371635913849, 0.16270692646503448, 0.17063333094120026, 0.17080125212669373, 0.1635342687368393], [0.17797908186912537, 0.15799982845783234, 0.17706404626369476, 0.15631642937660217, 0.1559140831232071, 0.17472662031650543], [0.1609364002943039, 0.17104455828666687, 0.16136132180690765, 0.17198441922664642, 0.17221133410930634, 0.162462055683136], [0.16058780252933502, 0.17131051421165466, 0.16103777289390564, 0.1723095327615738, 0.172550767660141, 0.16220365464687347], [0.17614799737930298, 0.15940435230731964, 0.17538803815841675, 0.15797848999500275, 0.1576373279094696, 0.17344382405281067]], [[0.16793783009052277, 0.1682521402835846, 0.1555313616991043, 0.16956478357315063, 0.16919858753681183, 0.16951526701450348], [0.1679893434047699, 0.1683173030614853, 0.15506547689437866, 0.16968727111816406, 0.16930504143238068, 0.1696355789899826], [0.16558918356895447, 0.16535143554210663, 0.17564831674098969, 0.1643669605255127, 0.16464023292064667, 0.16440385580062866], [0.1682005673646927, 0.1685853749513626, 0.15314128994941711, 0.17019419372081757, 0.16974510252475739, 0.17013345658779144], [0.16814225912094116, 0.16851124167442322, 0.15367460250854492, 0.17005351185798645, 0.16962306201457977, 0.1699952930212021], [0.16819271445274353, 0.16857539117336273, 0.1532132625579834, 0.1701752096414566, 0.16972863674163818, 0.17011480033397675]], [[0.18244428932666779, 0.16076260805130005, 0.16032297909259796, 0.1798863410949707, 0.15850864350795746, 0.15807516872882843], [0.1611923724412918, 0.16868682205677032, 0.16885283589363098, 0.1620119959115982, 0.1695445477962494, 0.1697114109992981], [0.16074873507022858, 0.1688498556613922, 0.16902963817119598, 0.1616332232952118, 0.16977891325950623, 0.16995969414710999], [0.1800018846988678, 0.1616838276386261, 0.1613086760044098, 0.17785871028900146, 0.1597587615251541, 0.15938808023929596], [0.1589125096797943, 0.16952335834503174, 0.16976070404052734, 0.1600630134344101, 0.1707506775856018, 0.1709897369146347], [0.15847256779670715, 0.16968443989753723, 0.1699357032775879, 0.15968620777130127, 0.1709839403629303, 0.17123711109161377]], [[0.1766774207353592, 0.16279207170009613, 0.16188432276248932, 0.16159778833389282, 0.16192913055419922, 0.1751192808151245], [0.15602906048297882, 0.1707417070865631, 0.1717960089445114, 0.17213140428066254, 0.17174367606639862, 0.15755809843540192], [0.15467292070388794, 0.17125777900218964, 0.1724535971879959, 0.17283421754837036, 0.17239421606063843, 0.1563873589038849], [0.15424473583698273, 0.17142051458358765, 0.17266137897968292, 0.17305639386177063, 0.17259974777698517, 0.1560172438621521], [0.1547398716211319, 0.17123231291770935, 0.17242109775543213, 0.1727994829416275, 0.1723620742559433, 0.1564452052116394], [0.17437320947647095, 0.16368702054023743, 0.16298136115074158, 0.16275842487812042, 0.163016214966774, 0.1731838434934616]], [[0.17247873544692993, 0.16230662167072296, 0.16922184824943542, 0.16291695833206177, 0.1630641520023346, 0.17001166939735413], [0.13917724788188934, 0.18866243958473206, 0.1531093269586563, 0.18515166640281677, 0.1843167543411255, 0.14958256483078003], [0.16161872446537018, 0.17053158581256866, 0.1643625795841217, 0.16996727883815765, 0.169831782579422, 0.1636880785226822], [0.14111760258674622, 0.1870296597480774, 0.15415051579475403, 0.18380488455295563, 0.18303732573986053, 0.150859996676445], [0.14158685505390167, 0.1866367608308792, 0.1544003039598465, 0.1834801733493805, 0.18272869288921356, 0.15116724371910095], [0.16423793137073517, 0.16851697862148285, 0.1655680537223816, 0.16824956238269806, 0.1681852787733078, 0.16524216532707214]], [[0.1929137259721756, 0.163102388381958, 0.16124267876148224, 0.1606578826904297, 0.16133421659469604, 0.16074909269809723], [0.1660633385181427, 0.16674500703811646, 0.16679167747497559, 0.16680647432804108, 0.16678936779499054, 0.16680416464805603], [0.16434285044670105, 0.16696743667125702, 0.16714824736118317, 0.1672055870294571, 0.16713930666446686, 0.1671966314315796], [0.16380071640014648, 0.1670372039079666, 0.16726061701774597, 0.16733147203922272, 0.16724956035614014, 0.1673204004764557], [0.16442765295505524, 0.16695649921894073, 0.16713066399097443, 0.16718588769435883, 0.1671220362186432, 0.1671772599220276], [0.16388531029224396, 0.1670263409614563, 0.167243093252182, 0.16731183230876923, 0.16723236441612244, 0.16730108857154846]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 1.2}, "num_env_steps_sampled": 400, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.590361306142151e-06, "normalize_and_clip_actions": 8.050153822241974e-06, "get_actions": 3.758663394053986e-05, "listify_data_for_vector_env": 1.0649682458304006e-05, "tensor_to_numpy": 1.5556454575827167e-05, "remove_single_ts_time_rank_from_batch": 1.1918521639226628e-05}}, "connector_pipeline_timer": 0.00011669182075399496}, "env_to_module_connector": {"connector_pipeline_timer": 5.936133191829919e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.105086635958759e-06, "add_states_from_episodes_to_batch": 2.7124565155084055e-06, "batch_individual_items": 1.2406009598640087e-05, "numpy_to_tensor": 1.2245932730022727e-05, "add_observations_from_episodes_to_batch": 2.845587756226689e-06}}}, "num_episodes_lifetime": 320, "rlmodule_inference_timer": 3.20219375046077e-05, "episode_duration_sec_mean": 0.005255947154946625, "episode_len_mean": 20.0, "num_episodes": 20, "episode_return_max": 13.5, "weights_seq_no": 16.0, "sample": 0.11684301104193197, "episode_len_max": 20, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "env_reset_timer": 0.0005542006978666867, "num_env_steps_sampled_lifetime": 80400, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 1.2, "env_step_timer": 1.4069456750725458e-05, "agent_episode_returns_mean": {"default_agent": 1.2}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_min": -13.5, "time_between_sampling": 10.270837133823976}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "b13c4_00000", "date": "2025-08-11_18-07-03", "timestamp": 1754928423, "time_this_iter_s": 9.728020906448364, "time_total_s": 167.26319575309753, "pid": 10212, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x144efd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 167.26319575309753, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 40.42142857142857, "ram_util_percent": 81.45}}
{"timers": {"training_iteration": 9.900528099421415, "restore_env_runners": 1.119910994106184e-05, "training_step": 9.900353499339024, "env_runner_sampling_timer": 1.8867613874491649, "learner_update_timer": 7.787715615309973, "synch_weights": 0.0014542199322788308, "restore_eval_env_runners": 3.455704805724595e-05, "evaluation_iteration": 0.12782756339709905, "synch_eval_env_connectors": 0.00014399271166604853, "synch_env_connectors": 5.12136426845576e-06}, "env_runners": {"rlmodule_inference_timer": 3.1283226625288026e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.919851348420516e-06, "numpy_to_tensor": 1.2673104123481086e-05, "add_states_from_episodes_to_batch": 2.744729610028655e-06, "batch_individual_items": 1.2595208609402324e-05, "add_observations_from_episodes_to_batch": 2.819307311740615e-06}}, "connector_pipeline_timer": 5.9789446994505354e-05}, "env_step_timer": 1.3968728351267464e-05, "episode_len_max": 20, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.063053985575722e-06, "get_actions": 3.8530347670708865e-05, "remove_single_ts_time_rank_from_batch": 1.2097333030932363e-05, "listify_data_for_vector_env": 1.047490949620485e-05, "tensor_to_numpy": 1.5197788143254177e-05, "un_batch_to_individual_items": 6.673688016612691e-06}}, "connector_pipeline_timer": 0.00011755218153753947}, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "episode_duration_sec_mean": 0.00525300634559244, "time_between_sampling": 0.033519069820152556, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": -2.1399999999999997}, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": -2.1399999999999997}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "env_reset_timer": 4.116365526038741e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime": -9252500.0, "episode_return_min": -13.5, "episode_return_mean": -2.1399999999999997, "weights_seq_no": 16.0, "sample": 0.005652319782816375, "num_episodes_lifetime": -462625.0, "num_env_steps_sampled_lifetime_throughput": 3247.4891952365647}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.175101278232371, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00960241910850234, "add_observations_from_episodes_to_batch": 0.0009330780441482959, "add_columns_from_episodes_to_train_batch": 0.05069941298146491, "add_time_dim_to_batch_and_zero_pad": 0.10147387152236055, "add_states_from_episodes_to_batch": 0.0038856857253445815, "batch_individual_items": 0.00820931566439294, "numpy_to_tensor": 9.580449751209288e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"vf_loss": 0.32050877809524536, "mean_kl_loss": 1.6948986740317196e-05, "num_module_steps_trained_lifetime": 101745, "num_module_steps_trained": 5985, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 998.0332888909784, "weights_seq_no": 17.0, "vf_explained_var": 0.00041741132736206055, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.24830801784992218, "curr_kl_coeff": 1.2327875538176158e-06, "policy_loss": -0.00034386798506602645, "vf_loss_unclipped": 40.2348747253418, "entropy": 0.6744903922080994, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 724.2851916238822}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.0332888909784, "weights_seq_no": 17.0, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 101745, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 724.290761099971}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 612000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 203490, "num_env_steps_trained_lifetime_throughput": 4360.114598667938, "num_module_steps_trained_throughput": 20701070.845717333, "num_module_steps_trained_lifetime_throughput": 12592438.139650661}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.24847935140132904, "use_intrinsic_rewards": 1.0, "diff_num_grad_updates_vs_sampler_policy": 86.0, "mean_kl_loss": 1.5689383872086182e-05, "policy_loss": -0.0003314320056233555, "vf_loss_unclipped": 40.1380615234375, "num_module_steps_trained_lifetime": 610470, "entropy": 0.6745318174362183, "vf_loss": 0.32070961594581604, "vf_explained_var": 0.005465805530548096, "num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.4956760259092, "weights_seq_no": 102.0}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.4956760259092, "weights_seq_no": 102.0, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 86.0, "num_module_steps_trained_lifetime": 610470}, "__all_modules__": {"num_env_steps_trained_lifetime": 3672000, "num_module_steps_trained_lifetime": 1220940, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 46928.24645970227}}}, "IntrinsicAttentionMask": [[[0.17131152749061584, 0.16120824217796326, 0.16135390102863312, 0.16855643689632416, 0.16870872676372528, 0.16886115074157715], [0.144010990858078, 0.19521485269069672, 0.19433458149433136, 0.15618309378623962, 0.1554788053035736, 0.15477770566940308], [0.14440490305423737, 0.19469021260738373, 0.19382791221141815, 0.1563839316368103, 0.15569128096103668, 0.1550017148256302], [0.1638893336057663, 0.16999296844005585, 0.16990065574645996, 0.16549554467201233, 0.16540566086769104, 0.16531583666801453], [0.16430038213729858, 0.16949769854545593, 0.1694192886352539, 0.16567082703113556, 0.1655941903591156, 0.16551758348941803], [0.16471172869205475, 0.16900312900543213, 0.1689385622739792, 0.16584555804729462, 0.16578219830989838, 0.16571886837482452]], [[0.16566547751426697, 0.16597552597522736, 0.16695792973041534, 0.16727040708065033, 0.16690917313098907, 0.1672215610742569], [0.16562241315841675, 0.16594575345516205, 0.16697043180465698, 0.1672964096069336, 0.16691957414150238, 0.16724544763565063], [0.16548655927181244, 0.16585180163383484, 0.1670098751783371, 0.1673784852027893, 0.16695237159729004, 0.1673208475112915], [0.1654435396194458, 0.16582204401493073, 0.16702237725257874, 0.16740450263023376, 0.16696277260780334, 0.16734474897384644], [0.16549329459667206, 0.1658564656972885, 0.1670079380273819, 0.16737443208694458, 0.1669507622718811, 0.16731712222099304], [0.16545027494430542, 0.1658267080783844, 0.16702044010162354, 0.16740044951438904, 0.16696114838123322, 0.16734103858470917]], [[0.18244430422782898, 0.16076260805130005, 0.16032299399375916, 0.1798863559961319, 0.15850864350795746, 0.15807518362998962], [0.1611923724412918, 0.16868682205677032, 0.16885283589363098, 0.1620119959115982, 0.1695445477962494, 0.1697114109992981], [0.16074873507022858, 0.1688498556613922, 0.16902963817119598, 0.1616332232952118, 0.16977891325950623, 0.16995969414710999], [0.1800018846988678, 0.1616838276386261, 0.1613086760044098, 0.17785871028900146, 0.1597587615251541, 0.15938808023929596], [0.1589125096797943, 0.16952335834503174, 0.16976070404052734, 0.1600630134344101, 0.1707506775856018, 0.1709897369146347], [0.15847256779670715, 0.16968443989753723, 0.1699357032775879, 0.15968620777130127, 0.1709839403629303, 0.17123711109161377]], [[0.1666826754808426, 0.16668401658535004, 0.16668827831745148, 0.16662856936454773, 0.16662700474262238, 0.1666894257068634], [0.16684158146381378, 0.16685637831687927, 0.1669030785560608, 0.16625022888183594, 0.16623318195343018, 0.16691556572914124], [0.16734112799167633, 0.16739854216575623, 0.16757981479167938, 0.16505877673625946, 0.16499334573745728, 0.16762831807136536], [0.1600807160139084, 0.15956640243530273, 0.15795396268367767, 0.18209727108478546, 0.1827760636806488, 0.1575256586074829], [0.15988340973854065, 0.15935489535331726, 0.15769822895526886, 0.1825525164604187, 0.1832527220249176, 0.15725824236869812], [0.1674741953611374, 0.16754302382469177, 0.1677604615688324, 0.16474096477031708, 0.16466271877288818, 0.16781863570213318]], [[0.1701717972755432, 0.16680777072906494, 0.16695848107337952, 0.16073791682720184, 0.1675863116979599, 0.16773772239685059], [0.16328036785125732, 0.1664811670780182, 0.16633504629135132, 0.17259062826633453, 0.1657291203737259, 0.16558367013931274], [0.16359013319015503, 0.16650018095970154, 0.16636745631694794, 0.17204052209854126, 0.16581691801548004, 0.16568472981452942], [0.15073083341121674, 0.1653420329093933, 0.16465158760547638, 0.19632606208324432, 0.16181263327598572, 0.1611369103193283], [0.16487963497638702, 0.16657491028308868, 0.1664978712797165, 0.16976849734783173, 0.16617800295352936, 0.1661011278629303], [0.16519035398960114, 0.1665918529033661, 0.16652819514274597, 0.16922526061534882, 0.16626393795013428, 0.1662004142999649]], [[0.18237201869487762, 0.1817106008529663, 0.15243162214756012, 0.15187877416610718, 0.1525181531906128, 0.17908881604671478], [0.1820230334997177, 0.18137750029563904, 0.1527460813522339, 0.15220437943935394, 0.15283086895942688, 0.17881813645362854], [0.1651919037103653, 0.1652485728263855, 0.16801179945468903, 0.16806943714618683, 0.16800281405448914, 0.16547539830207825], [0.1648457795381546, 0.16491560637950897, 0.16832776367664337, 0.16839906573295593, 0.16831663250923157, 0.16519521176815033], [0.16524599492549896, 0.16530059278011322, 0.1679624617099762, 0.16801795363426208, 0.16795378923416138, 0.16551916301250458], [0.18062712252140045, 0.18004454672336578, 0.1540047973394394, 0.15350806713104248, 0.1540825217962265, 0.1777329444885254]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 1.2}, "num_env_steps_sampled": 400, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.554008614676449e-06, "normalize_and_clip_actions": 7.940964769909454e-06, "get_actions": 3.7409390974395234e-05, "listify_data_for_vector_env": 1.0625925722149904e-05, "tensor_to_numpy": 1.5105319792057957e-05, "remove_single_ts_time_rank_from_batch": 1.1798657290284817e-05}}, "connector_pipeline_timer": 0.00011568893168924795}, "env_to_module_connector": {"connector_pipeline_timer": 5.9072942849936396e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.06886098718508e-06, "add_states_from_episodes_to_batch": 2.7321390437391543e-06, "batch_individual_items": 1.2309666923935216e-05, "numpy_to_tensor": 1.2163907025079222e-05, "add_observations_from_episodes_to_batch": 2.8132660186626694e-06}}}, "num_episodes_lifetime": 340, "rlmodule_inference_timer": 3.191806591600804e-05, "episode_duration_sec_mean": 0.005247435884084553, "episode_len_mean": 20.0, "num_episodes": 20, "episode_return_max": 13.5, "weights_seq_no": 17.0, "sample": 0.11682814176179283, "episode_len_max": 20, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "env_reset_timer": 0.0005521920309472406, "num_env_steps_sampled_lifetime": 85400, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 1.2, "env_step_timer": 1.386559356086833e-05, "agent_episode_returns_mean": {"default_agent": 1.2}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_min": -12.5, "time_between_sampling": 10.271898802896773}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "b13c4_00000", "date": "2025-08-11_18-07-13", "timestamp": 1754928433, "time_this_iter_s": 10.473023891448975, "time_total_s": 177.7362196445465, "pid": 10212, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x144efd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 177.7362196445465, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 46.35333333333333, "ram_util_percent": 81.77333333333333}}
{"timers": {"training_iteration": 9.910360228006628, "restore_env_runners": 1.1142949301692984e-05, "training_step": 9.910184702265605, "env_runner_sampling_timer": 1.8872443294048427, "learner_update_timer": 7.797169508747012, "synch_weights": 0.001458015232306352, "restore_eval_env_runners": 3.435938789966748e-05, "evaluation_iteration": 0.12778733317384683, "synch_eval_env_connectors": 0.000143832375200781, "synch_env_connectors": 5.113480408555187e-06}, "env_runners": {"rlmodule_inference_timer": 4.0946616900665185e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 8.86884370504104e-06, "numpy_to_tensor": 1.6791449964797138e-05, "add_states_from_episodes_to_batch": 3.249981638915425e-06, "batch_individual_items": 1.5247746109687405e-05, "add_observations_from_episodes_to_batch": 3.4364605766503737e-06}}, "connector_pipeline_timer": 7.340289194227229e-05}, "env_step_timer": 1.8280089908035292e-05, "episode_len_max": 20, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.782496117075126e-06, "get_actions": 5.2442659707795963e-05, "remove_single_ts_time_rank_from_batch": 1.4167210817985598e-05, "listify_data_for_vector_env": 1.2802523197698223e-05, "tensor_to_numpy": 1.8861402046413134e-05, "un_batch_to_individual_items": 7.851811646503425e-06}}, "connector_pipeline_timer": 0.00014726557450517205}, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "episode_duration_sec_mean": 0.006614280201494694, "time_between_sampling": 0.03622803603306499, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": -1.5}, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": -1.5}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "env_reset_timer": 5.6830064916125985e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime": -9870000.0, "episode_return_min": -13.5, "episode_return_mean": -1.5, "weights_seq_no": 17.0, "sample": 0.006852088999642692, "num_episodes_lifetime": -493500.0, "num_env_steps_sampled_lifetime_throughput": 2814.619114242981}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17495276419931835, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009597056577486917, "add_observations_from_episodes_to_batch": 0.0009336739341705687, "add_columns_from_episodes_to_train_batch": 0.05063284260103752, "add_time_dim_to_batch_and_zero_pad": 0.10138938572634335, "add_states_from_episodes_to_batch": 0.003884949698522716, "batch_individual_items": 0.008216864597773437, "numpy_to_tensor": 9.687145282232918e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"vf_loss": 0.32050859928131104, "mean_kl_loss": 1.349222566204844e-05, "num_module_steps_trained_lifetime": 107730, "num_module_steps_trained": 5985, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 998.0016398003509, "weights_seq_no": 18.0, "vf_explained_var": 0.0003171563148498535, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.24851484596729279, "curr_kl_coeff": 6.163937769088079e-07, "policy_loss": -0.00013860368926543742, "vf_loss_unclipped": 40.66225814819336, "entropy": 0.6734012365341187, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 721.1575662214374}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.0016398003509, "weights_seq_no": 18.0, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 107730, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 721.16250990826}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 648000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 215460, "num_env_steps_trained_lifetime_throughput": 4341.164727840783, "num_module_steps_trained_throughput": 20228879.780004054, "num_module_steps_trained_lifetime_throughput": 12561185.108529326}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.24866199493408203, "use_intrinsic_rewards": 1.0, "diff_num_grad_updates_vs_sampler_policy": 91.0, "mean_kl_loss": 1.3066021892882418e-05, "policy_loss": -0.0001356772700091824, "vf_loss_unclipped": 40.5401496887207, "num_module_steps_trained_lifetime": 646380, "entropy": 0.6734168529510498, "vf_loss": 0.3206910789012909, "vf_explained_var": 0.00540691614151001, "num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.4947003847115, "weights_seq_no": 108.0}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.4947003847115, "weights_seq_no": 108.0, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 91.0, "num_module_steps_trained_lifetime": 646380}, "__all_modules__": {"num_env_steps_trained_lifetime": 3888000, "num_module_steps_trained_lifetime": 1292760, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 46275.341948035384}}}, "IntrinsicAttentionMask": [[[0.17132018506526947, 0.16793344914913177, 0.16808517277240753, 0.16182264685630798, 0.16196884214878082, 0.16886968910694122], [0.16219207644462585, 0.16537153720855713, 0.16522638499736786, 0.1714402735233307, 0.17128980159759521, 0.16448001563549042], [0.16260047256946564, 0.1654929369688034, 0.16536100208759308, 0.17099975049495697, 0.17086343467235565, 0.16468241810798645], [0.14581769704818726, 0.15995264053344727, 0.15928469598293304, 0.18992672860622406, 0.18913359940052032, 0.15588457882404327], [0.14620719850063324, 0.1600944995880127, 0.15943880379199982, 0.1894676238298416, 0.1886916160583496, 0.15610022842884064], [0.16471323370933533, 0.16611067950725555, 0.16604721546173096, 0.16873648762702942, 0.16867202520370483, 0.1657203733921051]], [[0.166692852973938, 0.16669419407844543, 0.16663740575313568, 0.16663874685764313, 0.16663718223571777, 0.1666996031999588], [0.16695302724838257, 0.16696782410144806, 0.16634653508663177, 0.1663612723350525, 0.16634422540664673, 0.1670270562171936], [0.15595489740371704, 0.1554413139820099, 0.17856529355049133, 0.17797726392745972, 0.17865733802318573, 0.1534038782119751], [0.15621741116046906, 0.15571552515029907, 0.17827540636062622, 0.1777026355266571, 0.1783650517463684, 0.15372401475906372], [0.15591388940811157, 0.15539850294589996, 0.17861059308052063, 0.178020179271698, 0.17870301008224487, 0.15335389971733093], [0.16799281537532806, 0.16806185245513916, 0.16518321633338928, 0.16525110602378845, 0.16517262160778046, 0.16833831369876862]], [[0.17507897317409515, 0.17460019886493683, 0.1538507044315338, 0.17262428998947144, 0.17215222120285034, 0.15169364213943481], [0.1748344600200653, 0.1743703931570053, 0.15422116219997406, 0.1724548190832138, 0.1719970703125, 0.15212208032608032], [0.16334649920463562, 0.1635204404592514, 0.17176122963428497, 0.16424529254436493, 0.16442017257213593, 0.17270632088184357], [0.17381617426872253, 0.17341287434101105, 0.1557653546333313, 0.1717466562986374, 0.17134815454483032, 0.15391075611114502], [0.1735706925392151, 0.1731819063425064, 0.15613795816898346, 0.17157535254955292, 0.1711910367012024, 0.15434302389621735], [0.1620437651872635, 0.16228371858596802, 0.17376521229743958, 0.1632847636938095, 0.1635265350341797, 0.17509596049785614]], [[0.1666724979877472, 0.16667383909225464, 0.16661705076694489, 0.16667945683002472, 0.16667789220809937, 0.166679248213768], [0.16673025488853455, 0.16674503684043884, 0.16612456738948822, 0.16680650413036346, 0.16678939759731293, 0.16680419445037842], [0.16405925154685974, 0.1635189950466156, 0.1878446340560913, 0.16129253804683685, 0.16190886497497559, 0.16137567162513733], [0.16696742177009583, 0.16703814268112183, 0.16409020125865936, 0.16733241081237793, 0.16725049912929535, 0.1673213392496109], [0.16690190136432648, 0.1669570505619049, 0.16465412080287933, 0.167186439037323, 0.16712258756160736, 0.16717781126499176], [0.16695860028266907, 0.16702722012996674, 0.16416630148887634, 0.16731271147727966, 0.16723324358463287, 0.1673019677400589]], [[0.16903971135616302, 0.1656980663537979, 0.1658477634191513, 0.16632115840911865, 0.1664714366197586, 0.1666218340396881], [0.16438435018062592, 0.16760680079460144, 0.16745969653129578, 0.16699624061584473, 0.16684967279434204, 0.1667032390832901], [0.16459272801876068, 0.16752061247825623, 0.16738706827163696, 0.1669662594795227, 0.16683316230773926, 0.16670016944408417], [0.16525176167488098, 0.16724850237369537, 0.16715766489505768, 0.1668713092803955, 0.16678068041801453, 0.16669011116027832], [0.1654609739780426, 0.1671622395515442, 0.16708491742610931, 0.16684110462665558, 0.16676391661167145, 0.1666867882013321], [0.16567043960094452, 0.1670760065317154, 0.16701216995716095, 0.16681087017059326, 0.16674715280532837, 0.16668343544006348]], [[0.187514066696167, 0.1585371345281601, 0.15672947466373444, 0.15616105496883392, 0.18480855226516724, 0.15624971687793732], [0.16617420315742493, 0.1668563187122345, 0.1669030338525772, 0.1669178307056427, 0.1662331521511078, 0.16691552102565765], [0.16476643085479736, 0.16739778220653534, 0.1675790548324585, 0.16763654351234436, 0.16499260067939758, 0.16762755811214447], [0.16432181000709534, 0.16756859421730042, 0.16779272258281708, 0.16786380112171173, 0.1646004021167755, 0.16785269975662231], [0.18561485409736633, 0.159285306930542, 0.1576293408870697, 0.15710827708244324, 0.18317270278930664, 0.15718956291675568], [0.16439121961593628, 0.16754193603992462, 0.16775935888290405, 0.16782830655574799, 0.16466163098812103, 0.16781753301620483]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 0.2}, "num_env_steps_sampled": 400, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.866163512063124e-06, "normalize_and_clip_actions": 8.416590214686151e-06, "get_actions": 3.9959736030610464e-05, "listify_data_for_vector_env": 1.1029249119894532e-05, "tensor_to_numpy": 1.576631147923984e-05, "remove_single_ts_time_rank_from_batch": 1.228676746572618e-05}}, "connector_pipeline_timer": 0.00012131153907407187}, "env_to_module_connector": {"connector_pipeline_timer": 6.116012280841452e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.2268069876864305e-06, "add_states_from_episodes_to_batch": 2.7930443806702456e-06, "batch_individual_items": 1.2704319718611773e-05, "numpy_to_tensor": 1.285781556540034e-05, "add_observations_from_episodes_to_batch": 2.95762728335024e-06}}}, "num_episodes_lifetime": 360, "rlmodule_inference_timer": 3.3330696041645186e-05, "episode_duration_sec_mean": 0.005310859610326588, "episode_len_mean": 20.0, "num_episodes": 20, "episode_return_max": 13.5, "weights_seq_no": 18.0, "sample": 0.11687027909400838, "episode_len_max": 20, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "env_reset_timer": 0.0005499642800749085, "num_env_steps_sampled_lifetime": 90400, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 0.2, "env_step_timer": 1.4586295013535103e-05, "agent_episode_returns_mean": {"default_agent": 0.2}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_min": -12.5, "time_between_sampling": 10.27834223653785}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "b13c4_00000", "date": "2025-08-11_18-07-24", "timestamp": 1754928444, "time_this_iter_s": 11.018079042434692, "time_total_s": 188.7542986869812, "pid": 10212, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x144efd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 188.7542986869812, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 47.837500000000006, "ram_util_percent": 82.46875}}
{"timers": {"training_iteration": 9.908462149477305, "restore_env_runners": 1.1144020083229949e-05, "training_step": 9.908286062322968, "env_runner_sampling_timer": 1.884340583191183, "learner_update_timer": 7.7983838424092236, "synch_weights": 0.0014541663293324801, "restore_eval_env_runners": 3.450954399682895e-05, "evaluation_iteration": 0.1278170931820014, "synch_eval_env_connectors": 0.00014427613213598313, "synch_env_connectors": 5.140686131139853e-06}, "env_runners": {"rlmodule_inference_timer": 3.2856410774484365e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.209106292466473e-06, "numpy_to_tensor": 1.328338768092199e-05, "add_states_from_episodes_to_batch": 2.8306738010247037e-06, "batch_individual_items": 1.2952542306406894e-05, "add_observations_from_episodes_to_batch": 2.8792684937153846e-06}}, "connector_pipeline_timer": 6.164588275290715e-05}, "env_step_timer": 1.4482220445279858e-05, "episode_len_max": 20, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.32264017973914e-06, "get_actions": 4.061092692557312e-05, "remove_single_ts_time_rank_from_batch": 1.2373794276106735e-05, "listify_data_for_vector_env": 1.0766751579299764e-05, "tensor_to_numpy": 1.5724478049290458e-05, "un_batch_to_individual_items": 6.871602924803785e-06}}, "connector_pipeline_timer": 0.00012180978213027655}, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "episode_duration_sec_mean": 0.005452720493078231, "time_between_sampling": 0.03689675853687721, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": -0.86}, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": -0.86}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "env_reset_timer": 4.762371666103212e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime": -10487500.0, "episode_return_min": -13.5, "episode_return_mean": -0.86, "weights_seq_no": 18.0, "sample": 0.005993076991662404, "num_episodes_lifetime": -524375.0, "num_env_steps_sampled_lifetime_throughput": 3134.5420953666985}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17473927030690556, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009590558091128786, "add_observations_from_episodes_to_batch": 0.0009329338644785683, "add_columns_from_episodes_to_train_batch": 0.05054934875439434, "add_time_dim_to_batch_and_zero_pad": 0.10127480769940003, "add_states_from_episodes_to_batch": 0.003884164371467783, "batch_individual_items": 0.008210775531098745, "numpy_to_tensor": 9.663106863620497e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"vf_loss": 0.3205087184906006, "mean_kl_loss": 2.2314186935545877e-05, "num_module_steps_trained_lifetime": 113715, "num_module_steps_trained": 5985, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 997.9718428097785, "weights_seq_no": 19.0, "vf_explained_var": 0.00037986040115356445, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.2481415867805481, "curr_kl_coeff": 3.0819688845440396e-07, "policy_loss": -0.0005138936685398221, "vf_loss_unclipped": 40.34519577026367, "entropy": 0.672116756439209, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 718.5566761245296}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 997.9718428097785, "weights_seq_no": 19.0, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 113715, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 718.561095840574}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 684000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 227430, "num_env_steps_trained_lifetime_throughput": 4325.391484943472, "num_module_steps_trained_throughput": 19793498.02680361, "num_module_steps_trained_lifetime_throughput": 12545372.847364914}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.24829140305519104, "use_intrinsic_rewards": 1.0, "diff_num_grad_updates_vs_sampler_policy": 96.0, "mean_kl_loss": 2.016409780480899e-05, "policy_loss": -0.0004896936588920653, "vf_loss_unclipped": 40.23603820800781, "num_module_steps_trained_lifetime": 682290, "entropy": 0.6721835136413574, "vf_loss": 0.3206658959388733, "vf_explained_var": 0.005383551120758057, "num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.4940209352853, "weights_seq_no": 114.0}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.4940209352853, "weights_seq_no": 114.0, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 96.0, "num_module_steps_trained_lifetime": 682290}, "__all_modules__": {"num_env_steps_trained_lifetime": 4104000, "num_module_steps_trained_lifetime": 1364580, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 45664.42795167872}}}, "IntrinsicAttentionMask": [[[0.17131690680980682, 0.16121330857276917, 0.16808196902275085, 0.16856172680854797, 0.1687140315771103, 0.1621120721101761], [0.14413020014762878, 0.1953764408826828, 0.15855808556079865, 0.15631236135959625, 0.15560750663280487, 0.19001536071300507], [0.16259798407554626, 0.17156486213207245, 0.16535846889019012, 0.16494275629520416, 0.16481126844882965, 0.17072460055351257], [0.1638912409543991, 0.16999493539333344, 0.16578146815299988, 0.16549745202064514, 0.16540756821632385, 0.16942737996578217], [0.1643017679452896, 0.16949912905693054, 0.16591432690620422, 0.1656722128391266, 0.16559559106826782, 0.169017031788826], [0.14653795957565308, 0.1921186000108719, 0.1595279723405838, 0.15751488506793976, 0.1568823903799057, 0.18741828203201294]], [[0.1743074357509613, 0.1739988923072815, 0.1597127765417099, 0.15943008661270142, 0.1730765551328659, 0.1594742089509964], [0.17395943403244019, 0.17366549372673035, 0.16002897918224335, 0.1597585827112198, 0.172786682844162, 0.15980079770088196], [0.15722104907035828, 0.1575680524110794, 0.1752946525812149, 0.17568154633045197, 0.1586136519908905, 0.17562104761600494], [0.1568777859210968, 0.15723669528961182, 0.1756088137626648, 0.17601057887077332, 0.15831835567951202, 0.17594775557518005], [0.17291566729545593, 0.17266522347927094, 0.16097766160964966, 0.16074451804161072, 0.17191606760025024, 0.1607809066772461], [0.15693140029907227, 0.15728844702243805, 0.17555974423885345, 0.17595918476581573, 0.15836448967456818, 0.17589673399925232]], [[0.17132018506526947, 0.16793344914913177, 0.16808517277240753, 0.16182264685630798, 0.16196885704994202, 0.16886968910694122], [0.16219207644462585, 0.16537153720855713, 0.16522638499736786, 0.1714402735233307, 0.17128980159759521, 0.16448001563549042], [0.16260047256946564, 0.1654929369688034, 0.16536100208759308, 0.17099975049495697, 0.17086343467235565, 0.16468241810798645], [0.14581771194934845, 0.15995265543460846, 0.15928469598293304, 0.18992672860622406, 0.18913359940052032, 0.15588459372520447], [0.14620721340179443, 0.1600944995880127, 0.15943880379199982, 0.1894676238298416, 0.1886916160583496, 0.15610024333000183], [0.16471324861049652, 0.16611067950725555, 0.16604721546173096, 0.16873648762702942, 0.16867202520370483, 0.1657203733921051]], [[0.1666928380727768, 0.16669419407844543, 0.16669845581054688, 0.16663874685764313, 0.16663718223571777, 0.1666385382413864], [0.16695304214954376, 0.16696785390377045, 0.16701458394527435, 0.16636130213737488, 0.16634425520896912, 0.16635899245738983], [0.16777373850345612, 0.16783127188682556, 0.16801303625106812, 0.1654854714870453, 0.16541986167430878, 0.16547660529613495], [0.15622763335704803, 0.15572570264339447, 0.1541520655155182, 0.1777142733335495, 0.1783767193555832, 0.177803635597229], [0.15592467784881592, 0.15540924668312073, 0.1537935882806778, 0.17803248763084412, 0.17871537804603577, 0.17812460660934448], [0.15618668496608734, 0.15568292140960693, 0.1541036069393158, 0.17775726318359375, 0.1784224659204483, 0.1778469979763031]], [[0.17509818077087402, 0.17461934685707092, 0.15386758744716644, 0.15254344046115875, 0.17217110097408295, 0.17170028388500214], [0.17485255002975464, 0.17438843846321106, 0.15423712134361267, 0.15294869244098663, 0.17201487720012665, 0.17155829071998596], [0.16334933042526245, 0.16352325677871704, 0.17176420986652374, 0.17234210669994354, 0.16442303359508514, 0.16459810733795166], [0.1625538319349289, 0.16276830434799194, 0.1729915291070938, 0.17371290922164917, 0.16387861967086792, 0.16409483551979065], [0.17358353734016418, 0.17319472134113312, 0.15614952147006989, 0.15504825115203857, 0.17120370268821716, 0.1708202213048935], [0.1733369529247284, 0.17296262085437775, 0.1565217524766922, 0.15545739233493805, 0.17104531824588776, 0.17067593336105347]], [[0.1743239164352417, 0.16062353551387787, 0.15972788631916046, 0.1594451516866684, 0.17309291660785675, 0.17278653383255005], [0.15832358598709106, 0.17325258255004883, 0.17432238161563873, 0.17466270923614502, 0.1595635712146759, 0.15987509489059448], [0.15724404156208038, 0.17410457134246826, 0.17532029747962952, 0.17570723593235016, 0.15863683819770813, 0.15898697078227997], [0.15690244734287262, 0.17437416315078735, 0.1756364107131958, 0.1760382354259491, 0.15834324061870575, 0.15870550274848938], [0.17292660474777222, 0.1617259979248047, 0.16098783910274506, 0.16075468063354492, 0.17192694544792175, 0.17167793214321136], [0.17257755994796753, 0.16200140118598938, 0.16130302846431732, 0.16108237206935883, 0.1716352254152298, 0.17140044271945953]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": -1.0}, "num_env_steps_sampled": 400, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.718960865172346e-06, "normalize_and_clip_actions": 8.042312355046013e-06, "get_actions": 3.645833737423062e-05, "listify_data_for_vector_env": 1.0587961447186356e-05, "tensor_to_numpy": 1.4997490596772991e-05, "remove_single_ts_time_rank_from_batch": 1.212630626647917e-05}}, "connector_pipeline_timer": 0.00011582744999665877}, "env_to_module_connector": {"connector_pipeline_timer": 5.911838833255594e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.980804143004909e-06, "add_states_from_episodes_to_batch": 2.7152853047503057e-06, "batch_individual_items": 1.2356443256229511e-05, "numpy_to_tensor": 1.1972796227515109e-05, "add_observations_from_episodes_to_batch": 2.8475487016358255e-06}}}, "num_episodes_lifetime": 380, "rlmodule_inference_timer": 3.0752728702737637e-05, "episode_duration_sec_mean": 0.005323449558345601, "episode_len_mean": 20.0, "num_episodes": 20, "episode_return_max": 13.5, "weights_seq_no": 19.0, "sample": 0.11685633588287209, "episode_len_max": 20, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "env_reset_timer": 0.0005476717268864199, "num_env_steps_sampled_lifetime": 95400, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": -1.0, "env_step_timer": 1.3765729574969404e-05, "agent_episode_returns_mean": {"default_agent": -1.0}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_min": -12.5, "time_between_sampling": 10.273107144582388}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "b13c4_00000", "date": "2025-08-11_18-07-34", "timestamp": 1754928454, "time_this_iter_s": 9.84745478630066, "time_total_s": 198.60175347328186, "pid": 10212, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x144efd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 198.60175347328186, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 41.699999999999996, "ram_util_percent": 81.90714285714284}}
{"timers": {"training_iteration": 9.909596383402194, "restore_env_runners": 1.1087169355108736e-05, "training_step": 9.909419774609587, "env_runner_sampling_timer": 1.8848468644389373, "learner_update_timer": 7.799145298574447, "synch_weights": 0.0014485954968615187, "restore_eval_env_runners": 3.427361818905709e-05, "evaluation_iteration": 0.12777720642057616, "synch_eval_env_connectors": 0.00014408295076020247, "synch_env_connectors": 5.128439055784599e-06}, "env_runners": {"rlmodule_inference_timer": 4.100139955594785e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 8.38398056182355e-06, "numpy_to_tensor": 1.8272971289351852e-05, "add_states_from_episodes_to_batch": 3.0652901031439413e-06, "batch_individual_items": 1.4723163320082184e-05, "add_observations_from_episodes_to_batch": 3.3125064735190446e-06}}, "connector_pipeline_timer": 7.648006720149183e-05}, "env_step_timer": 1.756068297895526e-05, "episode_len_max": 20, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.3505402882350162e-05, "get_actions": 5.1146843767471706e-05, "remove_single_ts_time_rank_from_batch": 1.3496993946673516e-05, "listify_data_for_vector_env": 1.206277789567332e-05, "tensor_to_numpy": 1.848750418520287e-05, "un_batch_to_individual_items": 7.675112107269938e-06}}, "connector_pipeline_timer": 0.00014866783942758704}, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "episode_duration_sec_mean": 0.006640883335843681, "time_between_sampling": 0.03388600933173047, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": -1.4199999999999995}, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": -1.4199999999999995}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "env_reset_timer": 4.576607124595149e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime": -11105000.0, "episode_return_min": -13.5, "episode_return_mean": -1.4199999999999995, "weights_seq_no": 19.0, "sample": 0.006125674655028241, "num_episodes_lifetime": -555250.0, "num_env_steps_sampled_lifetime_throughput": 3048.2191643232977}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17456236385440282, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009590402930804634, "add_observations_from_episodes_to_batch": 0.000933522026262638, "add_columns_from_episodes_to_train_batch": 0.05047242735672738, "add_time_dim_to_batch_and_zero_pad": 0.1011802908726586, "add_states_from_episodes_to_batch": 0.0038834231470863097, "batch_individual_items": 0.008206432365592913, "numpy_to_tensor": 9.655517800113452e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"vf_loss": 0.320508748292923, "mean_kl_loss": 1.8576730553832022e-06, "num_module_steps_trained_lifetime": 119700, "num_module_steps_trained": 5985, "num_trainable_parameters": 16595, "module_train_batch_size_mean": 997.9437895346426, "weights_seq_no": 20.0, "vf_explained_var": 0.0005443096160888672, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.24856071174144745, "curr_kl_coeff": 1.5409844422720198e-07, "policy_loss": -9.557667362969369e-05, "vf_loss_unclipped": 41.07833480834961, "entropy": 0.671593427658081, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 716.3746667631544}, "intrinsic_reward_module": {"num_module_steps_trained": 5985, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 997.9437895346426, "weights_seq_no": 20.0, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 119700, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 716.3785791911469}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 720000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 239400, "num_env_steps_trained_lifetime_throughput": 4312.142470171455, "num_module_steps_trained_throughput": 19396149.030660376, "num_module_steps_trained_lifetime_throughput": 12539462.736785032}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.2486826479434967, "use_intrinsic_rewards": 1.0, "diff_num_grad_updates_vs_sampler_policy": 101.0, "mean_kl_loss": 1.8100806755683152e-06, "policy_loss": -9.071072418009862e-05, "vf_loss_unclipped": 40.94193649291992, "num_module_steps_trained_lifetime": 718200, "entropy": 0.6715980172157288, "vf_loss": 0.3206586241722107, "vf_explained_var": 0.005315244197845459, "num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.4935477577241, "weights_seq_no": 120.0}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.4935477577241, "weights_seq_no": 120.0, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 101.0, "num_module_steps_trained_lifetime": 718200}, "__all_modules__": {"num_env_steps_trained_lifetime": 4320000, "num_module_steps_trained_lifetime": 1436400, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 45095.249837459975}}}, "IntrinsicAttentionMask": [[[0.17131482064723969, 0.16121134161949158, 0.1680799126625061, 0.16181758046150208, 0.16871197521686554, 0.1688643991947174], [0.14408427476882935, 0.1953141838312149, 0.1585075557231903, 0.19167962670326233, 0.15555791556835175, 0.15485644340515137], [0.1625964194536209, 0.17156320810317993, 0.16535687446594238, 0.17099548876285553, 0.1648096889257431, 0.16467830538749695], [0.14571410417556763, 0.19312161207199097, 0.15917153656482697, 0.18979178369045258, 0.1564270704984665, 0.1557738333940506], [0.16430123150348663, 0.16949857771396637, 0.16591379046440125, 0.1691729575395584, 0.16559505462646484, 0.16551844775676727], [0.16471228003501892, 0.1690036952495575, 0.16604624688625336, 0.16873550415039062, 0.16578274965286255, 0.1657194197177887]], [[0.17666049301624298, 0.1763477921485901, 0.16186882555484772, 0.16158230602741241, 0.16191361844539642, 0.16162702441215515], [0.17619989812374115, 0.17590217292308807, 0.16209003329277039, 0.16181614995002747, 0.1621328592300415, 0.1618589162826538], [0.15465065836906433, 0.1549919992685318, 0.17242878675460815, 0.17280934751033783, 0.17236940562725067, 0.1727498471736908], [0.15422090888023376, 0.1545737385749817, 0.17263470590114594, 0.17302966117858887, 0.17257308959960938, 0.17296791076660156], [0.1547178477048874, 0.1550573855638504, 0.17239657044410706, 0.17277489602565765, 0.17233754694461823, 0.17271573841571808], [0.15428797900676727, 0.15463902056217194, 0.1726025491952896, 0.17299525439739227, 0.1725412756204605, 0.17293384671211243]], [[0.17862798273563385, 0.17813949286937714, 0.17765234410762787, 0.1556185632944107, 0.1551930010318756, 0.15476860105991364], [0.1782761961221695, 0.17780299484729767, 0.17733106017112732, 0.15594345331192017, 0.15552952885627747, 0.1551167070865631], [0.17792439460754395, 0.17746642231941223, 0.17700964212417603, 0.1562683880329132, 0.15586617588996887, 0.15546497702598572], [0.16092339158058167, 0.1611357033252716, 0.16134829819202423, 0.17197054624557495, 0.17219743132591248, 0.17242461442947388], [0.16057321429252625, 0.16079802811145782, 0.16102315485477448, 0.17229388654232025, 0.17253509163856506, 0.17277665436267853], [0.16022314131259918, 0.16046038269996643, 0.16069798171520233, 0.172617107629776, 0.17287270724773407, 0.17312867939472198]], [[0.17754164338111877, 0.17689773440361023, 0.1748807281255722, 0.14785605669021606, 0.14847849309444427, 0.17434540390968323], [0.17730514705181122, 0.17667633295059204, 0.17470625042915344, 0.14825935661792755, 0.1488696187734604, 0.17418332397937775], [0.176557257771492, 0.17597584426403046, 0.17415328323841095, 0.14953649044036865, 0.15010787546634674, 0.1736692488193512], [0.1653735637664795, 0.16544362902641296, 0.1656649112701416, 0.16893823444843292, 0.16885553300380707, 0.16572411358356476], [0.1656583994626999, 0.1657131314277649, 0.1658860146999359, 0.16843727231025696, 0.16837294399738312, 0.16593225300312042], [0.17635692656040192, 0.17578811943531036, 0.17400482296943665, 0.14987897872924805, 0.15043987333774567, 0.1735311597585678]], [[0.17871174216270447, 0.157473623752594, 0.157042995095253, 0.17620611190795898, 0.17572425305843353, 0.15484118461608887], [0.16238971054553986, 0.1699398159980774, 0.17010706663131714, 0.16321541368961334, 0.16337604820728302, 0.17097201943397522], [0.16204077005386353, 0.17020700871944427, 0.17038823664188385, 0.1629323810338974, 0.16310586035251617, 0.17132577300071716], [0.17687349021434784, 0.1588738113641739, 0.1585051715373993, 0.17476756870746613, 0.17436206340789795, 0.1566179394721985], [0.17651738226413727, 0.15914516150951385, 0.15878869593143463, 0.1744881570339203, 0.17409732937812805, 0.1569632887840271], [0.16024509072303772, 0.17158237099647522, 0.17183643579483032, 0.16147230565547943, 0.16171139478683472, 0.1731524020433426]], [[0.18237483501434326, 0.18171340227127075, 0.15243396162986755, 0.1789899617433548, 0.15252050757408142, 0.1519673466682434], [0.1820257157087326, 0.18138016760349274, 0.15274833142757416, 0.17872154712677002, 0.15283311903476715, 0.15229110419750214], [0.16519193351268768, 0.16524860262870789, 0.1680118441581726, 0.16548429429531097, 0.16800284385681152, 0.16806046664714813], [0.18057480454444885, 0.17999465763568878, 0.15405583381652832, 0.1776033341884613, 0.15413330495357513, 0.15363809466362], [0.16524602472782135, 0.1653006225824356, 0.16796249151229858, 0.16552773118019104, 0.16795381903648376, 0.16800931096076965], [0.16489987075328827, 0.1649676412343979, 0.16827844083309174, 0.16524961590766907, 0.1682676374912262, 0.16833679378032684]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 0.0}, "num_env_steps_sampled": 400, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.609748367716467e-06, "normalize_and_clip_actions": 7.990972728634726e-06, "get_actions": 3.6135544025141165e-05, "listify_data_for_vector_env": 1.0706048500581634e-05, "tensor_to_numpy": 1.5072104224714505e-05, "remove_single_ts_time_rank_from_batch": 1.1999202320230805e-05}}, "connector_pipeline_timer": 0.00011491899046208766}, "env_to_module_connector": {"connector_pipeline_timer": 5.9062471144997844e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.056638762275046e-06, "add_states_from_episodes_to_batch": 2.6676230995355647e-06, "batch_individual_items": 1.2301968380655501e-05, "numpy_to_tensor": 1.1953487601758766e-05, "add_observations_from_episodes_to_batch": 2.817066363143095e-06}}}, "num_episodes_lifetime": 400, "rlmodule_inference_timer": 3.067324792668838e-05, "episode_duration_sec_mean": 0.005328586236573756, "episode_len_mean": 20.0, "num_episodes": 20, "episode_return_max": 13.5, "weights_seq_no": 20.0, "sample": 0.11684059043481332, "episode_len_max": 20, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "env_reset_timer": 0.0005461675090160703, "num_env_steps_sampled_lifetime": 100400, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 0.0, "env_step_timer": 1.3703326039732007e-05, "agent_episode_returns_mean": {"default_agent": 0.0}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_min": -12.5, "time_between_sampling": 10.270908361886965}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "b13c4_00000", "date": "2025-08-11_18-07-45", "timestamp": 1754928465, "time_this_iter_s": 10.14876389503479, "time_total_s": 208.75051736831665, "pid": 10212, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x144efd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 208.75051736831665, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 35.7, "ram_util_percent": 82.12857142857142}}
