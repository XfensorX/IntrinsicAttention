{"timers": {"training_iteration": 9.846915208967403, "restore_env_runners": 8.5409265011549e-06, "training_step": 9.84675183298532, "env_runner_sampling_timer": 1.6285516249481589, "learner_update_timer": 8.046346999937668, "synch_weights": 0.0011037089861929417}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5814664603204228e-05, "normalize_and_clip_actions": 1.0171753257841555e-05, "get_actions": 4.618608129800653e-05, "un_batch_to_individual_items": 6.792276884040228e-06, "remove_single_ts_time_rank_from_batch": 1.212689745646241e-05, "listify_data_for_vector_env": 1.0691862797228714e-05}}, "connector_pipeline_timer": 0.00012904428267774385}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.103548657291729e-06, "numpy_to_tensor": 1.324209622372176e-05, "add_states_from_episodes_to_batch": 2.7603951868111793e-06, "add_observations_from_episodes_to_batch": 2.891578909206644e-06, "batch_individual_items": 1.2760864953970411e-05}}, "connector_pipeline_timer": 6.280945061909866e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "rlmodule_inference_timer": 6.845835436519906e-05, "episode_len_mean": 20.0, "episode_return_min": -11.5, "weights_seq_no": 0.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_mean": -1.9, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime": 627500.0, "num_env_steps_sampled": 5000.0, "sample": 0.006819210971506023, "env_reset_timer": 8.69756354658754e-05, "episode_duration_sec_mean": 0.005652731180656699, "env_to_module_sum_episodes_length_in": 10.191744832559449, "num_episodes_lifetime": 31375.0, "time_between_sampling": 0.0005195069623637744, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": -1.9}, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.191744832559449, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.4555359109971955e-05, "module_episode_returns_mean": {"default_policy": -1.9}, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 3039.113163948085}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000, "learner_connector": {"connector_pipeline_timer": 0.13470987509936094, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008920666994526982, "add_observations_from_episodes_to_batch": 0.0008233750704675913, "add_columns_from_episodes_to_train_batch": 0.041474209050647914, "add_time_dim_to_batch_and_zero_pad": 0.07570966600906104, "add_states_from_episodes_to_batch": 0.0035365839721634984, "batch_individual_items": 0.004046957939863205, "numpy_to_tensor": 7.091590669006109e-05}}}, "learner_connector_sum_episodes_length_out": 5250}, "learners": {"IntrinsicAttentionMask": [[[0.07213345170021057, 0.07322807610034943, 0.07433930039405823, 0.098943792283535, 0.07969880849123001, 0.08090823888778687, 0.08213600516319275, 0.10932102799415588, 0.1066824421286583, 0.11266407370567322, 0.10994479060173035], [0.07251348346471786, 0.07359018176794052, 0.07468287646770477, 0.0987958088517189, 0.07994817942380905, 0.08113528043031693, 0.08234000205993652, 0.10892520099878311, 0.10635165870189667, 0.11218392848968506, 0.1095333844423294], [0.07289452105760574, 0.07395309209823608, 0.07502702623605728, 0.09864671528339386, 0.08019722998142242, 0.08136185258626938, 0.08254338055849075, 0.10852932929992676, 0.10602046549320221, 0.11170431226491928, 0.10912205278873444], [0.08031242340803146, 0.08098257333040237, 0.08165831118822098, 0.09561128169298172, 0.08485572040081024, 0.0855637863278389, 0.08627774566411972, 0.10102005302906036, 0.09966742992401123, 0.1027129516005516, 0.10133766382932663], [0.07466878741979599, 0.07564055174589157, 0.07662495970726013, 0.09794318675994873, 0.08134419471025467, 0.08240282535552979, 0.08347523212432861, 0.10669932514429092, 0.10448452830314636, 0.10949461907148361, 0.10722179710865021], [0.07505542039871216, 0.07600775361061096, 0.07697216421365738, 0.09778790175914764, 0.08159136772155762, 0.08262662589550018, 0.08367502689361572, 0.10630342364311218, 0.10415118932723999, 0.10901816934347153, 0.10681097209453583], [0.07544302940368652, 0.07637570053339005, 0.0773199051618576, 0.09763153642416, 0.08183816820383072, 0.0828499048948288, 0.08387414366006851, 0.10590754449367523, 0.10381749272346497, 0.1085423156619072, 0.1064002737402916], [0.08297771960496902, 0.08349202573299408, 0.08400952070951462, 0.09446505457162857, 0.0864434763789177, 0.08697926253080368, 0.0875183641910553, 0.09841060638427734, 0.09742909669876099, 0.09963430464267731, 0.09864059090614319], [0.08232130110263824, 0.08287478238344193, 0.08343198150396347, 0.0947498232126236, 0.08605656772851944, 0.08663516491651535, 0.08721765130758286, 0.09904901683330536, 0.0979781448841095, 0.1003853902220726, 0.0993000715970993], [0.08379004895687103, 0.084255151450634, 0.0847228392958641, 0.09411048144102097, 0.08691854774951935, 0.08740102499723434, 0.08788616955280304, 0.09762433171272278, 0.09675160050392151, 0.09871113300323486, 0.0978286936879158], [0.08313090354204178, 0.08363598585128784, 0.08414414525032043, 0.0943983718752861, 0.08653336763381958, 0.0870591402053833, 0.08758809417486191, 0.09826201945543289, 0.0973011702299118, 0.0994596853852272, 0.09848713129758835]], [[0.08798995614051819, 0.10776281356811523, 0.089889295399189, 0.11008897423744202, 0.08929403871297836, 0.09281545132398605, 0.11367268860340118, 0.09220081567764282, 0.015034440904855728, 0.10368330776691437, 0.09756817668676376], [0.09129608422517776, 0.09957077354192734, 0.09213440865278244, 0.10048507153987885, 0.09187277406454086, 0.09340634942054749, 0.10187229514122009, 0.0931410938501358, 0.04285730421543121, 0.097939632833004, 0.09542427957057953], [0.08845121413469315, 0.10701248049736023, 0.09024430066347122, 0.10918183624744415, 0.08968258649110794, 0.0930023044347763, 0.11251860857009888, 0.09242342412471771, 0.01681123860180378, 0.10320110619068146, 0.09747083485126495], [0.09144420921802521, 0.09852143377065659, 0.09216520190238953, 0.09929823130369186, 0.09194028377532959, 0.0932573601603508, 0.10047491639852524, 0.09302977472543716, 0.047749679535627365, 0.09713311493396759, 0.09498579800128937], [0.08830965310335159, 0.10724804550409317, 0.09013596177101135, 0.10946599394083023, 0.0895637571811676, 0.09294645488262177, 0.11287921667098999, 0.09235642105340958, 0.016237448900938034, 0.10335347056388855, 0.09750354290008545], [0.08910635113716125, 0.10584772378206253, 0.09073738008737564, 0.1077851951122284, 0.09022677689790726, 0.09324007481336594, 0.11075809597969055, 0.09271539002656937, 0.019868582487106323, 0.10243453830480576, 0.09727991372346878], [0.091559998691082, 0.09685510396957397, 0.09210392832756042, 0.09743048250675201, 0.09193435311317444, 0.09292589128017426, 0.09829998761415482, 0.09275481104850769, 0.0560896135866642, 0.09582395106554031, 0.09422189742326736], [0.08897443115711212, 0.10609345883131027, 0.09063933044672012, 0.10807868838310242, 0.09011805057525635, 0.09319528192281723, 0.11112640798091888, 0.09265929460525513, 0.01919274590909481, 0.10259808599948883, 0.09732424467802048], [0.04489368945360184, 0.15105652809143066, 0.051015455275774, 0.1716548055410385, 0.049026381224393845, 0.06179828196763992, 0.20793646574020386, 0.05938880518078804, 1.1457769915068639e-06, 0.11989995092153549, 0.08332845568656921], [0.0909041091799736, 0.10135611146688461, 0.09195242822170258, 0.10252495855093002, 0.09162499755620956, 0.09354761242866516, 0.10430356115102768, 0.0932145044207573, 0.03520430997014046, 0.09927763789892197, 0.09608972817659378], [0.09002047032117844, 0.1039223000407219, 0.09139277786016464, 0.105506531894207, 0.09096360951662064, 0.09349057823419571, 0.10792829096317291, 0.09305155277252197, 0.025747109204530716, 0.10111960023641586, 0.09685727953910828]], [[0.07208649814128876, 0.07702477276325226, 0.07526863366365433, 0.10233382135629654, 0.0774395763874054, 0.08153203129768372, 0.07967313379049301, 0.10435811430215836, 0.10987313836812973, 0.10736807435750961, 0.11304216831922531], [0.07397202402353287, 0.0784890279173851, 0.07688630372285843, 0.10120079666376114, 0.07886703312397003, 0.08258514851331711, 0.08089878410100937, 0.10298969596624374, 0.10784504562616348, 0.1056428775191307, 0.1106233224272728], [0.07331282645463943, 0.07797902822494507, 0.07632207125425339, 0.10159739851951599, 0.07837002724409103, 0.08222000300884247, 0.080472931265831, 0.1034676730632782, 0.10855059325695038, 0.1062440276145935, 0.11146333813667297], [0.08233430981636047, 0.08478293567895889, 0.08392248302698135, 0.096135213971138, 0.08498458564281464, 0.08694250881671906, 0.08606013655662537, 0.09697172045707703, 0.09920581430196762, 0.09819897264242172, 0.10046134144067764], [0.07412596791982651, 0.07860781997442245, 0.07701786607503891, 0.10110808163881302, 0.07898277044296265, 0.0826699435710907, 0.08099781721830368, 0.10287810862064362, 0.1076807826757431, 0.10550277680158615, 0.11042798310518265], [0.07561041414737701, 0.07974769920110703, 0.07828253507614136, 0.1002129465341568, 0.08009281754493713, 0.0834786593914032, 0.08194494992494583, 0.10180370509624481, 0.10610735416412354, 0.10415790230035782, 0.10856107622385025], [0.07494373619556427, 0.07923705130815506, 0.0777154415845871, 0.1006152406334877, 0.0795956552028656, 0.08311747014522552, 0.08152134716510773, 0.10228591412305832, 0.10681169480085373, 0.1047605574131012, 0.1093958392739296], [0.08292658627033234, 0.08521659672260284, 0.08441241085529327, 0.09577473253011703, 0.08540496230125427, 0.08723239600658417, 0.08640918880701065, 0.0965491235256195, 0.09861501306295395, 0.09768438339233398, 0.0997745618224144], [0.08449286222457886, 0.08635580539703369, 0.08570274710655212, 0.09482086449861526, 0.08650859445333481, 0.08798743039369583, 0.08732202649116516, 0.09543417394161224, 0.09706559032201767, 0.09633153676986694, 0.09797828644514084], [0.08378977328538895, 0.08584578335285187, 0.08512447774410248, 0.09524915367364883, 0.08601463586091995, 0.08765057474374771, 0.08691409975290298, 0.095934197306633, 0.09775879979133606, 0.096937395632267, 0.09878107905387878], [0.08536326885223389, 0.08698415756225586, 0.08641650527715683, 0.09429048746824265, 0.08711688220500946, 0.08839982748031616, 0.08782293647527695, 0.09481626749038696, 0.09621260315179825, 0.09558472782373428, 0.0969923734664917]], [[0.08523563295602798, 0.10607489943504333, 0.0898980125784874, 0.1085476279258728, 0.09199363738298416, 0.09029015153646469, 0.11581186205148697, 0.09239491820335388, 0.013455227017402649, 0.10808633267879486, 0.09821165353059769], [0.08994146436452866, 0.09967707842588425, 0.09222059696912766, 0.10076224058866501, 0.09322457760572433, 0.0924094021320343, 0.10387644171714783, 0.09341543912887573, 0.03777774050831795, 0.10056080669164658, 0.09613415598869324], [0.08656412363052368, 0.10472936183214188, 0.09067372977733612, 0.10685243457555771, 0.0925118625164032, 0.09101810306310654, 0.11305400729179382, 0.09286322444677353, 0.017341630533337593, 0.10645685344934464, 0.09793464094400406], [0.09027475863695145, 0.09883176535367966, 0.09228744357824326, 0.09977922588586807, 0.09317217022180557, 0.09245391190052032, 0.1024915799498558, 0.09334022551774979, 0.04203570634126663, 0.09960343688726425, 0.09572979062795639], [0.08711183816194534, 0.1041124165058136, 0.09097645431756973, 0.106086365878582, 0.09270134568214417, 0.09129978716373444, 0.11183813214302063, 0.09303081035614014, 0.01934661716222763, 0.10571875423192978, 0.09777740389108658], [0.08666898310184479, 0.10461456328630447, 0.09073258191347122, 0.10670936107635498, 0.0925493985414505, 0.09107299894094467, 0.11282550543546677, 0.09289664030075073, 0.017704075202345848, 0.10631908476352692, 0.09790680557489395], [0.0909452810883522, 0.09620483964681625, 0.09219879657030106, 0.09677636623382568, 0.09274652600288391, 0.09230200946331024, 0.09840124100446701, 0.09285034984350204, 0.05658512935042381, 0.0966704785823822, 0.09431895613670349], [0.08721315115690231, 0.10399326682090759, 0.09103109687566757, 0.10593920946121216, 0.09273448586463928, 0.09135043621063232, 0.11160670220851898, 0.09305979311466217, 0.019750017672777176, 0.10557685047388077, 0.0977448970079422], [0.0399235300719738, 0.1321984976530075, 0.05343673378229141, 0.14997197687625885, 0.06062106043100357, 0.05472525209188461, 0.21380259096622467, 0.06208281219005585, 1.6309268175973557e-06, 0.1465161293745041, 0.08671979606151581], [0.0902165099978447, 0.09899123013019562, 0.0922786071896553, 0.09996398538351059, 0.0931854099035263, 0.09244921058416367, 0.10275004059076309, 0.09335768222808838, 0.041215717792510986, 0.09978348761796951, 0.09580804407596588], [0.08854933083057404, 0.1022239550948143, 0.09170030057430267, 0.10378231108188629, 0.0930982157588005, 0.09196272492408752, 0.10829143226146698, 0.0933646559715271, 0.026351338252425194, 0.10349252820014954, 0.09718317538499832]], [[0.07237814366817474, 0.07347647100687027, 0.07459147274494171, 0.10327870398759842, 0.07996916770935059, 0.0780390202999115, 0.08241461962461472, 0.10544417798519135, 0.1070442795753479, 0.11304620653390884, 0.11031769961118698], [0.07275449484586716, 0.07383477687835693, 0.07493110001087189, 0.1030302345752716, 0.08021390438079834, 0.07831871509552002, 0.08261367678642273, 0.10514388978481293, 0.10670509934425354, 0.11255675554275513, 0.10989741235971451], [0.07313179969787598, 0.0741937980055809, 0.07527122646570206, 0.10278095304965973, 0.08045826852321625, 0.07859832048416138, 0.08281204849481583, 0.10484300553798676, 0.10636552423238754, 0.11206787079572678, 0.1094772070646286], [0.08150399476289749, 0.08211478590965271, 0.08273013681173325, 0.09721183031797409, 0.08563492447137833, 0.08460401743650436, 0.08692321181297302, 0.0982169508934021, 0.09895297139883041, 0.10166550427675247, 0.10044161230325699], [0.0748879611492157, 0.0758625715970993, 0.07684985548257828, 0.10161836445331573, 0.08158295601606369, 0.07988950610160828, 0.08372025191783905, 0.10344491899013519, 0.10479117184877396, 0.10981597006320953, 0.10753647983074188], [0.07426934689283371, 0.07527518272399902, 0.07629463821649551, 0.10202829539775848, 0.08118917047977448, 0.07943661510944366, 0.08340317010879517, 0.10393693298101425, 0.10534456372261047, 0.11060480028390884, 0.1082172617316246], [0.07565396279096603, 0.07658923417329788, 0.07753608375787735, 0.10111019760370255, 0.08206697553396225, 0.08044741302728653, 0.0841086357831955, 0.10283640772104263, 0.10410773009061813, 0.10884575545787811, 0.10669772326946259], [0.08205130696296692, 0.08262955397367477, 0.08321187645196915, 0.09684588760137558, 0.08595727384090424, 0.08498357981443405, 0.08717308938503265, 0.09778748452663422, 0.09847662597894669, 0.10101377218961716, 0.09986951947212219], [0.08244950324296951, 0.08300384134054184, 0.08356190472841263, 0.09657955914735794, 0.08619057387113571, 0.08525872975587845, 0.08735346794128418, 0.09747534245252609, 0.0981307104229927, 0.10054170340299606, 0.09945469349622726], [0.08389830589294434, 0.08436401188373566, 0.08483230322599411, 0.09560985863208771, 0.08703085780143738, 0.0862528383731842, 0.08799972385168076, 0.0963418260216713, 0.0968766063451767, 0.09883866459131241, 0.09795508533716202], [0.08324820548295975, 0.08375399559736252, 0.08426287770271301, 0.09604509174823761, 0.08665546774864197, 0.08580812066793442, 0.08771166950464249, 0.09685001522302628, 0.09743845462799072, 0.09960001707077026, 0.09862609207630157]], [[0.05720856785774231, 0.06851518899202347, 0.056871380656957626, 0.06982947140932083, 0.05796230956912041, 0.05851559713482857, 0.0718483105301857, 0.05963806062936783, 0.37116488814353943, 0.06787259876728058, 0.06057359278202057], [0.08140599727630615, 0.08682126551866531, 0.08123433589935303, 0.08741234987974167, 0.08178739249706268, 0.08206532895565033, 0.08830653876066208, 0.08262403309345245, 0.15872852504253387, 0.08652961254119873, 0.08308455348014832], [0.05629517883062363, 0.06767800450325012, 0.0559564083814621, 0.06900384277105331, 0.057052627205848694, 0.05760875716805458, 0.07104147225618362, 0.05873734503984451, 0.3799181580543518, 0.06702996045351028, 0.05967831239104271], [0.08342289179563522, 0.087892085313797, 0.08328031748533249, 0.08837664872407913, 0.08373945206403732, 0.08396998047828674, 0.08910851180553436, 0.0844329223036766, 0.14331048727035522, 0.08765275776386261, 0.08481405675411224], [0.059215378016233444, 0.07032433152198792, 0.05888260155916214, 0.07160979509353638, 0.05995892733335495, 0.06050444766879082, 0.07358220219612122, 0.06161041185259819, 0.35208502411842346, 0.06969542056322098, 0.06253145635128021], [0.06065608933568001, 0.07159668952226639, 0.06032729893922806, 0.07285851240158081, 0.06139051541686058, 0.0619291290640831, 0.07479307800531387, 0.06302057206630707, 0.3385201394557953, 0.0709790363907814, 0.063928984105587], [0.08625314384698868, 0.08922398835420609, 0.08615745604038239, 0.08954288065433502, 0.08646538853645325, 0.08661976456642151, 0.09002335369586945, 0.08692934364080429, 0.12253465503454208, 0.0890662670135498, 0.08718376606702805], [0.06348958611488342, 0.07403138279914856, 0.06317072361707687, 0.07523922622203827, 0.06420136988162994, 0.06472299247980118, 0.07708804309368134, 0.06577896326780319, 0.3121812641620636, 0.0734395831823349, 0.06665682792663574], [0.14939427375793457, 0.053771547973155975, 0.1544826626777649, 0.04828347638249397, 0.13871577382087708, 0.1314464509487152, 0.04108352214097977, 0.11803068965673447, 3.741715090654907e-06, 0.056720368564128876, 0.10806749761104584], [0.08036617189645767, 0.08623309433460236, 0.08018077909946442, 0.08687561005353928, 0.08077819645404816, 0.08107858151197433, 0.08784836530685425, 0.08168268203735352, 0.16685941815376282, 0.08591622114181519, 0.08218090981245041], [0.0657556802034378, 0.0759103000164032, 0.0654468983411789, 0.07706750929355621, 0.06644459813833237, 0.06694913655519485, 0.07883648574352264, 0.06796973943710327, 0.2914592921733856, 0.07534286379814148, 0.0688173770904541]]], "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 7.372149866569089e-06, "vf_explained_var": 0.0016627907752990723, "total_loss": 0.27807724475860596, "policy_loss": 5.641149527946254e-06, "num_module_steps_trained_lifetime": 5985, "use_intrinsic_rewards": 0.0, "num_module_steps_trained": 5985, "vf_loss": 0.358307421207428, "weights_seq_no": 1.0, "module_train_batch_size_mean": 997.9705930399, "curr_kl_coeff": 0.08079196512699127, "curr_entropy_coeff": 0.0015431216992, "entropy": 0.6929843425750732, "vf_loss_unclipped": 45.0791130065918, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 780.8577951115246}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"module_train_batch_size_mean": 997.8474438281662, "total_loss": 0.0, "num_module_steps_trained_lifetime": 35910, "diff_num_grad_updates_vs_sampler_policy": 6.0, "num_module_steps_trained": 35910, "weights_seq_no": 6.0}, "default_policy": {"policy_loss": 6.721946647303412e-06, "num_module_steps_trained_lifetime": 35910, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35910, "vf_loss": 0.3583609163761139, "weights_seq_no": 6.0, "module_train_batch_size_mean": 997.8474438281662, "entropy": 0.6929847002029419, "vf_loss_unclipped": 45.348533630371094, "diff_num_grad_updates_vs_sampler_policy": 6.0, "mean_kl_loss": 7.503271262976341e-06, "vf_explained_var": -0.0024335384368896484, "total_loss": 0.2781200110912323}, "__all_modules__": {"num_env_steps_trained": 198000, "num_module_steps_trained_lifetime": 71820, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 198000, "num_env_steps_trained_lifetime_throughput": 57992.01681032511}}}, "intrinsic_reward_module": {"curr_entropy_coeff": 0.0015431216992, "default_optimizer_learning_rate": 0.0002715581955, "module_train_batch_size_mean": 997.9705930399, "total_loss": 0.0, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "weights_seq_no": 1.0, "num_module_steps_trained_lifetime_throughput": 780.8743427746308}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 33000, "num_env_steps_trained": 33000, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 11970, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 4307.3345905128745, "num_module_steps_trained_throughput": 31430437.49696437, "num_module_steps_trained_lifetime_throughput": 15399702.252148788}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 10.216013141322508, "num_episodes_lifetime": 20, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -0.2}, "episode_len_min": 20, "weights_seq_no": 1.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.798584557000001e-06, "numpy_to_tensor": 1.2821422727299071e-05, "add_observations_from_episodes_to_batch": 2.882876841761691e-06, "add_time_dim_to_batch_and_zero_pad": 7.2670523434060344e-06, "batch_individual_items": 1.2628708738653157e-05}}, "connector_pipeline_timer": 6.169205762912203e-05}, "num_env_steps_sampled": 400, "env_reset_timer": 0.0002004159614443779, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2771994324895332e-05, "get_actions": 4.167839632383486e-05, "listify_data_for_vector_env": 1.0657717884428513e-05, "un_batch_to_individual_items": 6.688829379836413e-06, "tensor_to_numpy": 1.6609702399788963e-05, "normalize_and_clip_actions": 8.703590065550623e-06}}, "connector_pipeline_timer": 0.00012357565119456586}, "episode_len_max": 20, "env_step_timer": 1.4892174830184673e-05, "rlmodule_inference_timer": 3.399121509259274e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.216013141322508, "module_episode_returns_mean": {"default_policy": -0.2}, "episode_len_mean": 20.0, "episode_return_min": -13.5, "episode_return_mean": -0.2, "num_env_steps_sampled_lifetime": 5400, "sample": 0.11676958308089525, "episode_duration_sec_mean": 0.005334295850479976, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "episode_return_max": 14.5}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "aec1c_00000", "date": "2025-08-11_18-39-19", "timestamp": 1754930359, "time_this_iter_s": 9.972860097885132, "time_total_s": 9.972860097885132, "pid": 11610, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3842f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9.972860097885132, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 27.866666666666664, "ram_util_percent": 79.18}}
{"timers": {"training_iteration": 9.844115091457498, "restore_env_runners": 8.533847285434604e-06, "training_step": 9.843951268815436, "env_runner_sampling_timer": 1.6287277803686446, "learner_update_timer": 8.043262174938572, "synch_weights": 0.001102753145387396, "restore_eval_env_runners": 2.0625069737434387e-05, "evaluation_iteration": 0.12363737495616078, "synch_eval_env_connectors": 0.00016491697169840336, "synch_env_connectors": 5.292007699608803e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5635738611465282e-05, "normalize_and_clip_actions": 8.067831031788534e-06, "get_actions": 4.038997536759708e-05, "un_batch_to_individual_items": 6.549031285337039e-06, "remove_single_ts_time_rank_from_batch": 1.1871058490913317e-05, "listify_data_for_vector_env": 1.058840060993405e-05}}, "connector_pipeline_timer": 0.0001199005935711709}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.922799603774792e-06, "numpy_to_tensor": 1.273057824655607e-05, "add_states_from_episodes_to_batch": 2.674615274516224e-06, "add_observations_from_episodes_to_batch": 2.7796638248390826e-06, "batch_individual_items": 1.2428616717193774e-05}}, "connector_pipeline_timer": 5.978391851934141e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "rlmodule_inference_timer": 3.2069654082059444e-05, "episode_len_mean": 20.0, "episode_return_min": -11.5, "weights_seq_no": 1.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_mean": -1.2600000000000002, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime": 10000.0, "num_env_steps_sampled": 5000.0, "sample": 0.00607572283409686, "env_reset_timer": 4.309507925747859e-05, "episode_duration_sec_mean": 0.0053223591768182844, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": 500.0, "time_between_sampling": 0.031311489027448486, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": -1.2600000000000002}, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.3869604772672365e-05, "module_episode_returns_mean": {"default_policy": -1.2600000000000002}, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 3211.3189597113123}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13469933634856715, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00891662115463987, "add_observations_from_episodes_to_batch": 0.0008233154786285013, "add_columns_from_episodes_to_train_batch": 0.04147802112041973, "add_time_dim_to_batch_and_zero_pad": 0.07569974059937522, "add_states_from_episodes_to_batch": 0.0035370148031506686, "batch_individual_items": 0.0040465367003344, "numpy_to_tensor": 7.085924735292793e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"IntrinsicAttentionMask": [[[0.07239080220460892, 0.07734992355108261, 0.07845748215913773, 0.10276582837104797, 0.07776648551225662, 0.07888000458478928, 0.08000947535037994, 0.10479866713285446, 0.1062992587685585, 0.11191686987876892, 0.10936520248651505], [0.07424556463956833, 0.07877927273511887, 0.07978756725788116, 0.10157503932714462, 0.07915867865085602, 0.08017183095216751, 0.08119793981313705, 0.1033705472946167, 0.10469358414411545, 0.10962926596403122, 0.10739066451787949], [0.07464677840471268, 0.0790862962603569, 0.08007276058197021, 0.1013173907995224, 0.07945752888917923, 0.08044860512018204, 0.08145205676555634, 0.10306263715028763, 0.10434815287590027, 0.10914028435945511, 0.1069674864411354], [0.08247114717960358, 0.08492385596036911, 0.08545955270528793, 0.09629499167203903, 0.08512583374977112, 0.08566280454397202, 0.08620316535234451, 0.09713288396596909, 0.09774559736251831, 0.09999752044677734, 0.09898264706134796], [0.0743970051407814, 0.07889525592327118, 0.07989531755447388, 0.10147779434919357, 0.07927156239748001, 0.08027640730142593, 0.0812939777970314, 0.1032542884349823, 0.10456311702728271, 0.10944446176290512, 0.1072307825088501], [0.07479862868785858, 0.0792023092508316, 0.08018047362565994, 0.10121985524892807, 0.07957042008638382, 0.08055312931537628, 0.08154796808958054, 0.10294617712497711, 0.10421758145093918, 0.1089557334780693, 0.1068076640367508], [0.07520139217376709, 0.07950947433710098, 0.08046553283929825, 0.10096117854118347, 0.07986930757761002, 0.0808296948671341, 0.08180162310600281, 0.10263758897781372, 0.10387174785137177, 0.108467698097229, 0.1063847690820694], [0.08305380493402481, 0.08534732460975647, 0.0858476385474205, 0.09592167288064957, 0.08553598821163177, 0.08603739738464355, 0.08654174953699112, 0.09669724106788635, 0.09726408123970032, 0.09934526681900024, 0.09840774536132812], [0.08347790688276291, 0.0856546089053154, 0.08612900227308273, 0.09565005451440811, 0.08583351224660873, 0.08630890399217606, 0.0867869183421135, 0.09638069570064545, 0.09691449254751205, 0.09887290000915527, 0.0979909747838974], [0.0850224569439888, 0.08676687628030777, 0.08714580535888672, 0.09466163069009781, 0.08690983057022095, 0.08728938549757004, 0.08767060190439224, 0.09523168951272964, 0.09564758837223053, 0.09716933965682983, 0.09648484736680984], [0.08432911336421967, 0.08626890182495117, 0.08669088780879974, 0.09510516375303268, 0.08642807602882385, 0.0868508443236351, 0.08727569133043289, 0.0957467183470726, 0.09621506929397583, 0.09793081879615784, 0.09715866297483444]], [[0.08825495839118958, 0.10808736830949783, 0.08767051994800568, 0.11042053252458572, 0.08956295251846313, 0.09309498965740204, 0.11086685210466385, 0.09510452300310135, 0.015079722739756107, 0.10399556905031204, 0.09786202013492584], [0.09140469133853912, 0.09968921542167664, 0.09114512801170349, 0.10060460865497589, 0.09198205918073654, 0.09351745992898941, 0.10077845305204391, 0.09437618404626846, 0.042908307164907455, 0.0980561375617981, 0.09553779661655426], [0.08811302483081818, 0.10832444578409195, 0.0875186175107956, 0.11070703715085983, 0.08944358676671982, 0.09303835034370422, 0.111162930727005, 0.09508473426103592, 0.014564916491508484, 0.10414828360080719, 0.0978941023349762], [0.09153670817613602, 0.09862109273672104, 0.09131333231925964, 0.099398672580719, 0.0920332819223404, 0.09335169941186905, 0.09954623132944107, 0.09408772736787796, 0.04779800772666931, 0.09723136574029922, 0.0950818806886673], [0.08856330066919327, 0.10755608230829239, 0.08800108730792999, 0.10978040099143982, 0.089820995926857, 0.09321341663599014, 0.11020568013191223, 0.09514112025499344, 0.01628408208489418, 0.10365031659603119, 0.09778358042240143], [0.0893300399184227, 0.10611343383789062, 0.08882734924554825, 0.10805577039718628, 0.09045326709747314, 0.0934741422533989, 0.10842662304639816, 0.09518511593341827, 0.01991845853626728, 0.10269168019294739, 0.09752410650253296], [0.09155558049678802, 0.09841407835483551, 0.09133905917406082, 0.0991659164428711, 0.09203684329986572, 0.09331420809030533, 0.0993085727095604, 0.0940270870923996, 0.04877909645438194, 0.09706990420818329, 0.09498969465494156], [0.08972198516130447, 0.10528501123189926, 0.08925282210111618, 0.10707429051399231, 0.09076964110136032, 0.09358268976211548, 0.10741566121578217, 0.09517309814691544, 0.022253520786762238, 0.10212720185518265, 0.09734398126602173], [0.04624030739068985, 0.15558762848377228, 0.04443740099668503, 0.17680378258228302, 0.05049694702029228, 0.06365194916725159, 0.1811247617006302, 0.07233162969350815, 1.1801414530054899e-06, 0.12349643558263779, 0.08582791686058044], [0.0910421758890152, 0.10151004791259766, 0.09071797877550125, 0.10268066823482513, 0.09176415205001831, 0.0936896950006485, 0.10290329903364182, 0.09477013349533081, 0.03525778278708458, 0.09942841529846191, 0.09623566269874573], [0.09020543098449707, 0.10413581877946854, 0.08978182822465897, 0.1057233065366745, 0.09115050733089447, 0.093682661652565, 0.10602587461471558, 0.09511080384254456, 0.025800010189414024, 0.10132735967636108, 0.09705627709627151]], [[0.07165326178073883, 0.07656186074018478, 0.07765813171863556, 0.09799648821353912, 0.07697416841983795, 0.08104203641414642, 0.08220245689153671, 0.10767112672328949, 0.10921284556388855, 0.1107766404747963, 0.10825096815824509], [0.07356899231672287, 0.07806138694286346, 0.07906048744916916, 0.09734824299812317, 0.07843732833862305, 0.08213518559932709, 0.08318644016981125, 0.1059020459651947, 0.10725747793912888, 0.10863026231527328, 0.10641206055879593], [0.07398378103971481, 0.07838387787342072, 0.07936156541109085, 0.09720591455698013, 0.07875179499387741, 0.08236843347549438, 0.0833958238363266, 0.10552214086055756, 0.10683833062648773, 0.10817094147205353, 0.10601744055747986], [0.08095203340053558, 0.08368797600269318, 0.08428695797920227, 0.09471902996301651, 0.08391375094652176, 0.08610974997282028, 0.08672606945037842, 0.09929981827735901, 0.10001054406166077, 0.10072635114192963, 0.0995677188038826], [0.07372554391622543, 0.07818319648504257, 0.0791742354631424, 0.09729461371898651, 0.0785561129450798, 0.08222336322069168, 0.08326561748981476, 0.10575854778289795, 0.10709912329912186, 0.10845670104026794, 0.10626299679279327], [0.07523591071367264, 0.0793527141213417, 0.08026497811079025, 0.09677205234766006, 0.07969611883163452, 0.08306518942117691, 0.08402013778686523, 0.10438182204961777, 0.10558182746171951, 0.10679563879966736, 0.10483353585004807], [0.07565589249134064, 0.07967609912157059, 0.0805661603808403, 0.0966251865029335, 0.08001118153333664, 0.08329644799232483, 0.08422695100307465, 0.10400158166885376, 0.10516338050365448, 0.10633815824985504, 0.10443896055221558], [0.08386670053005219, 0.08584446460008621, 0.08627486974000931, 0.09363140165805817, 0.08600680530071259, 0.08757906407117844, 0.08801817148923874, 0.0967843160033226, 0.09726957231760025, 0.0977572575211525, 0.09696734696626663], [0.08431139588356018, 0.08617033809423447, 0.08657451719045639, 0.09346329420804977, 0.08632279932498932, 0.08779845386743546, 0.08821026980876923, 0.09640492498874664, 0.09685711562633514, 0.09731141477823257, 0.09657549858093262], [0.0847572609782219, 0.08649624139070511, 0.08687398582696915, 0.0932941883802414, 0.08663874119520187, 0.08801716566085815, 0.08840155601501465, 0.09602568298578262, 0.09644504636526108, 0.09686625003814697, 0.0961838960647583], [0.08403454720973969, 0.08596756309270859, 0.08638808876276016, 0.09356800466775894, 0.0861261785030365, 0.08766202628612518, 0.08809082955121994, 0.09664098173379898, 0.0971137061715126, 0.09758874773979187, 0.09681928902864456]], [[0.08829391002655029, 0.1051492691040039, 0.0877092182636261, 0.110469289124012, 0.0921468511223793, 0.09313607960939407, 0.11091580986976624, 0.09514650702476501, 0.015086349099874496, 0.10404148697853088, 0.0979052260518074], [0.0911664217710495, 0.09961042553186417, 0.09085981547832489, 0.1021345779299736, 0.09316222369670868, 0.09366796910762787, 0.10234367847442627, 0.09468770772218704, 0.03722028806805611, 0.09907695651054382, 0.09606986492872238], [0.0881534069776535, 0.10532636940479279, 0.08755873143672943, 0.11075778305530548, 0.09207391738891602, 0.09308099001646042, 0.11121388524770737, 0.09512830525636673, 0.014571568928658962, 0.10419602692127228, 0.09793896973133087], [0.09154199063777924, 0.09761644154787064, 0.09131859987974167, 0.09940440952777863, 0.09299121052026749, 0.09335708618164062, 0.0995519757270813, 0.09409315139055252, 0.04780076444149017, 0.09723697602748871, 0.09508737176656723], [0.08915556222200394, 0.10396309196949005, 0.088636115193367, 0.10857529938220978, 0.09256835281848907, 0.09344177693128586, 0.10896117240190506, 0.0952133983373642, 0.01884886436164379, 0.10299919545650482, 0.09763714671134949], [0.08935834467411041, 0.1036524698138237, 0.08885549753904343, 0.10809002816677094, 0.09265957027673721, 0.09350376576185226, 0.10846100002527237, 0.09521528333425522, 0.019924744963645935, 0.10272423177957535, 0.0975550189614296], [0.09156054258346558, 0.09744224697351456, 0.09134400635957718, 0.09917128831148148, 0.09296483546495438, 0.09331926703453064, 0.09931395202875137, 0.0940321758389473, 0.048781730234622955, 0.09707516431808472, 0.09499484300613403], [0.08974648267030716, 0.10301241278648376, 0.08927718549966812, 0.10710354149341583, 0.09282281994819641, 0.09360823780298233, 0.10744500160217285, 0.09519907087087631, 0.022259561344981194, 0.10215508937835693, 0.09737055748701096], [0.046934619545936584, 0.13355500996112823, 0.04510466754436493, 0.17945894598960876, 0.06060749292373657, 0.06460775434970856, 0.18384481966495514, 0.07341774553060532, 1.1978403335888288e-06, 0.1253509670495987, 0.08711674809455872], [0.09105352312326431, 0.10000789165496826, 0.09072928875684738, 0.10269348323345184, 0.09316571056842804, 0.09370137751102448, 0.10291613638401031, 0.09478195011615753, 0.03526214882731438, 0.0994408130645752, 0.09624765813350677], [0.0902252048254013, 0.10211288928985596, 0.08980152010917664, 0.10574650764465332, 0.09299704432487488, 0.09370321035385132, 0.10604913532733917, 0.09513165801763535, 0.025805633515119553, 0.10134958475828171, 0.09707757085561752]], [[0.07256803661584854, 0.07470179349184036, 0.07577142864465714, 0.09924759715795517, 0.07795687764883041, 0.07907312363386154, 0.08325191587209702, 0.10904575884342194, 0.10655955225229263, 0.11219092458486557, 0.10963299870491028], [0.07337289303541183, 0.07542940974235535, 0.07645930349826813, 0.09890950471162796, 0.07856147736310959, 0.07963414490222931, 0.08364365249872208, 0.10820334404706955, 0.10584888607263565, 0.11117828637361526, 0.10875909775495529], [0.07376936078071594, 0.0757872685790062, 0.07679734379053116, 0.09874184429645538, 0.07885805517435074, 0.07990904897451401, 0.08383464068174362, 0.1077900230884552, 0.10549961030483246, 0.11068236082792282, 0.10833048820495605], [0.08148662000894547, 0.0826798528432846, 0.08327162265777588, 0.09534454345703125, 0.08446788787841797, 0.08507245779037476, 0.08729878813028336, 0.09995557367801666, 0.09880580753087997, 0.10139153152704239, 0.10022523999214172], [0.07456541806459427, 0.07650469243526459, 0.07747446000576019, 0.09840301424264908, 0.07945101708173752, 0.0804581269621849, 0.08421417325735092, 0.1069633737206459, 0.10479986667633057, 0.10969226807355881, 0.10747356712818146], [0.07496501505374908, 0.07686425745487213, 0.0778135359287262, 0.09823186695575714, 0.07974742352962494, 0.0807323083281517, 0.08440272510051727, 0.10655008256435394, 0.10444943606853485, 0.10919813811779022, 0.10704528540372849], [0.07642095535993576, 0.07817117124795914, 0.079044409096241, 0.09760232269763947, 0.08082029223442078, 0.08172313123941422, 0.08507868647575378, 0.10505332052707672, 0.10317705571651459, 0.10741352289915085, 0.10549511015415192], [0.08425857126712799, 0.08512190729379654, 0.08554868400096893, 0.09406889975070953, 0.08640867471694946, 0.08684191107749939, 0.08842943608760834, 0.09723655134439468, 0.09645085036754608, 0.0982140302658081, 0.09742043167352676], [0.08357595652341843, 0.08452217280864716, 0.08499030023813248, 0.09438547492027283, 0.08593433350324631, 0.0864102691411972, 0.08815640956163406, 0.0979015901684761, 0.09702832251787186, 0.09898903220891953, 0.09810607135295868], [0.08510325103998184, 0.08586255460977554, 0.08623753488063812, 0.09367502480745316, 0.08699242025613785, 0.08737233281135559, 0.08876242488622665, 0.09641767293214798, 0.095738485455513, 0.09726167470216751, 0.09657653421163559], [0.08441786468029022, 0.08526170998811722, 0.08567877858877182, 0.09399481117725372, 0.0865190401673317, 0.08694225549697876, 0.08849264681339264, 0.09708179533481598, 0.09631633758544922, 0.09803389012813568, 0.09726092219352722]], [[0.08825823664665222, 0.10809141397476196, 0.09016337245702744, 0.1073756217956543, 0.08956629037857056, 0.09309844672679901, 0.11401931196451187, 0.09248193353414536, 0.015080242417752743, 0.10399945080280304, 0.09786567091941833], [0.09140549600124359, 0.09969009459018707, 0.09224481880664825, 0.09940700978040695, 0.0919828712940216, 0.09351827949285507, 0.10199437290430069, 0.09325271844863892, 0.0429086796939373, 0.09805700182914734, 0.09553863108158112], [0.0887027233839035, 0.10731679946184158, 0.09050090610980988, 0.10664882510900497, 0.08993759006261826, 0.09326675534248352, 0.11283858120441437, 0.09268622100353241, 0.016858994960784912, 0.1034945622086525, 0.09774798899888992], [0.09135401248931885, 0.10001332312822342, 0.09222979098558426, 0.09971688687801361, 0.09195642173290253, 0.09355921298265457, 0.10242754966020584, 0.09328190982341766, 0.0414871908724308, 0.09830377995967865, 0.09566998481750488], [0.08856639266014099, 0.10755985975265503, 0.09039799869060516, 0.10687705874443054, 0.0898241326212883, 0.0932166650891304, 0.11320741474628448, 0.09262491017580032, 0.016284603625535965, 0.10365394502878189, 0.09778701514005661], [0.08933263272047043, 0.10611654818058014, 0.0909678041934967, 0.10551939159631729, 0.09045589715242386, 0.09347685426473618, 0.11103938519954681, 0.09295082092285156, 0.01991899311542511, 0.10269467532634735, 0.09752694517374039], [0.09162906557321548, 0.09692814946174622, 0.09217340499162674, 0.0967497006058693, 0.0920037031173706, 0.09299597889184952, 0.0983741283416748, 0.0928247720003128, 0.056131962686777115, 0.09589622169733047, 0.09429296851158142], [0.08920595794916153, 0.10636955499649048, 0.09087519347667694, 0.10575781017541885, 0.09035254269838333, 0.09343778342008591, 0.11141560971736908, 0.09290040284395218, 0.01924263685941696, 0.1028650775551796, 0.09757749736309052], [0.046115078032016754, 0.15516676008701324, 0.05240340903401375, 0.14911684393882751, 0.05036021023988724, 0.06347961723804474, 0.2135944664478302, 0.061004552990198135, 1.1769146794904373e-06, 0.12316222488880157, 0.08559560775756836], [0.0910433828830719, 0.1015114113688469, 0.09209331125020981, 0.10114993900060654, 0.0917653739452362, 0.09369093924760818, 0.1044633761048317, 0.09335730969905853, 0.035258203744888306, 0.09942974895238876, 0.0962369441986084], [0.09020739048719406, 0.10413810610771179, 0.09158255159854889, 0.1036490797996521, 0.09115248918533325, 0.09368470311164856, 0.10815241932868958, 0.0932447612285614, 0.025800524279475212, 0.10132957994937897, 0.09705840051174164]]], "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 3.3861255360534415e-05, "vf_explained_var": -0.0031479597091674805, "total_loss": 0.27795684337615967, "policy_loss": -0.00012230647553224117, "num_module_steps_trained_lifetime": 11970, "use_intrinsic_rewards": 0.0, "num_module_steps_trained": 5985, "vf_loss": 0.35831519961357117, "weights_seq_no": 2.0, "module_train_batch_size_mean": 997.9429069707118, "curr_kl_coeff": 0.040395982563495636, "curr_entropy_coeff": 0.0015431216992, "entropy": 0.6930478811264038, "vf_loss_unclipped": 43.05253601074219, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 779.8566533289469}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"module_train_batch_size_mean": 997.7412016936058, "total_loss": 0.0, "num_module_steps_trained_lifetime": 71820, "diff_num_grad_updates_vs_sampler_policy": 11.0, "num_module_steps_trained": 35910, "weights_seq_no": 12.0}, "default_policy": {"policy_loss": -0.00012231199070811272, "num_module_steps_trained_lifetime": 71820, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35910, "vf_loss": 0.3583448827266693, "weights_seq_no": 12.0, "module_train_batch_size_mean": 997.7412016936058, "entropy": 0.6930479407310486, "vf_loss_unclipped": 43.06532287597656, "diff_num_grad_updates_vs_sampler_policy": 11.0, "mean_kl_loss": 3.3309795981040224e-05, "vf_explained_var": -0.002428770065307617, "total_loss": 0.27798259258270264}, "__all_modules__": {"num_env_steps_trained": 198000, "num_module_steps_trained_lifetime": 143640, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 396000, "num_env_steps_trained_lifetime_throughput": 57678.65010867293}}}, "intrinsic_reward_module": {"curr_entropy_coeff": 0.0015431216992, "default_optimizer_learning_rate": 0.0002715581955, "module_train_batch_size_mean": 997.9429069707118, "total_loss": 0.0, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 11970, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "weights_seq_no": 2.0, "num_module_steps_trained_lifetime_throughput": 779.872966798001}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 66000, "num_env_steps_trained": 33000, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 23940, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 4301.793232922361, "num_module_steps_trained_throughput": 30995472.137010284, "num_module_steps_trained_lifetime_throughput": 15340150.069975771}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 10.366003441359926, "num_episodes_lifetime": 40, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 0.8}, "episode_len_min": 20, "weights_seq_no": 2.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.821957736020047e-06, "numpy_to_tensor": 1.2060106671861741e-05, "add_observations_from_episodes_to_batch": 2.797143066648063e-06, "add_time_dim_to_batch_and_zero_pad": 6.899868519997259e-06, "batch_individual_items": 1.2448352551292257e-05}}, "connector_pipeline_timer": 5.90848830823706e-05}, "num_env_steps_sampled": 400, "env_reset_timer": 0.00020008805091492832, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1901295659550934e-05, "get_actions": 3.6258129039658534e-05, "listify_data_for_vector_env": 1.0411034928518153e-05, "un_batch_to_individual_items": 6.529738274757745e-06, "tensor_to_numpy": 1.5127286739626718e-05, "normalize_and_clip_actions": 7.976094160391972e-06}}, "connector_pipeline_timer": 0.00011433399627620297}, "episode_len_max": 20, "env_step_timer": 1.403921270339739e-05, "rlmodule_inference_timer": 3.1184870946785786e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.366003441359926, "module_episode_returns_mean": {"default_policy": 0.8}, "episode_len_mean": 20.0, "episode_return_min": -14.5, "episode_return_mean": 0.8, "num_env_steps_sampled_lifetime": 10400, "sample": 0.1167406959994696, "episode_duration_sec_mean": 0.005273527023382485, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "episode_return_max": 14.5, "time_between_sampling": 9.612880832981318}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "aec1c_00000", "date": "2025-08-11_18-39-29", "timestamp": 1754930369, "time_this_iter_s": 9.69013786315918, "time_total_s": 19.66299796104431, "pid": 11610, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3842f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.66299796104431, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 39.72142857142857, "ram_util_percent": 78.60714285714286}}
{"timers": {"training_iteration": 9.845887192632375, "restore_env_runners": 8.534759760368615e-06, "training_step": 9.845722245706758, "env_runner_sampling_timer": 1.6284827388141536, "learner_update_timer": 8.043987963609363, "synch_weights": 0.0011060435238876378, "restore_eval_env_runners": 2.0633398089557887e-05, "evaluation_iteration": 0.12360679245670327, "synch_eval_env_connectors": 0.00016461988212540746, "synch_env_connectors": 5.29324752278626e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.6162374704241236e-05, "normalize_and_clip_actions": 8.244830022803928e-06, "get_actions": 4.2466449577732684e-05, "un_batch_to_individual_items": 6.7312451689489475e-06, "remove_single_ts_time_rank_from_batch": 1.2253620715252451e-05, "listify_data_for_vector_env": 1.0971289751796443e-05}}, "connector_pipeline_timer": 0.00012430602546166132}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.152477958805101e-06, "numpy_to_tensor": 1.3356207234752766e-05, "add_states_from_episodes_to_batch": 2.7445192923741673e-06, "add_observations_from_episodes_to_batch": 2.848917963942812e-06, "batch_individual_items": 1.2748459616948725e-05}}, "connector_pipeline_timer": 6.166764547126043e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "rlmodule_inference_timer": 3.392606893801893e-05, "episode_len_mean": 20.0, "episode_return_min": -11.5, "weights_seq_no": 2.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_mean": -1.9, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime": -607500.0, "num_env_steps_sampled": 5000.0, "sample": 0.006043062465442627, "env_reset_timer": 3.9337072377395824e-05, "episode_duration_sec_mean": 0.0055354304937645805, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -30375.0, "time_between_sampling": 0.03262567195922894, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": -1.9}, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.4480833991997031e-05, "module_episode_returns_mean": {"default_policy": -1.9}, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 3173.2913572584293}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13585813673583325, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00891580911295023, "add_observations_from_episodes_to_batch": 0.0008236585742444732, "add_columns_from_episodes_to_train_batch": 0.04148462424936006, "add_time_dim_to_batch_and_zero_pad": 0.07570282694257331, "add_states_from_episodes_to_batch": 0.003538040485221427, "batch_individual_items": 0.005194928413745947, "numpy_to_tensor": 7.100732496473938e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"IntrinsicAttentionMask": [[[0.07205477356910706, 0.0731481984257698, 0.07724959403276443, 0.09883592277765274, 0.07652904093265533, 0.0808199942111969, 0.0788693055510521, 0.10920185595750809, 0.1108589842915535, 0.10818325728178024, 0.11424905806779861], [0.07243780791759491, 0.07351339608430862, 0.07754483819007874, 0.09869275987148285, 0.07683690637350082, 0.08105061203241348, 0.07913564145565033, 0.10881158709526062, 0.11042726039886475, 0.10781821608543396, 0.11373092979192734], [0.07383331656455994, 0.07484234869480133, 0.07861411571502686, 0.09816388785839081, 0.07795292884111404, 0.08188144862651825, 0.08009813725948334, 0.1073964461684227, 0.10886415839195251, 0.10649318993091583, 0.11186002939939499], [0.08028639853000641, 0.08095633238554001, 0.08343010395765305, 0.09558030962944031, 0.08299984037876129, 0.08553605526685715, 0.08439075946807861, 0.10098732262849808, 0.10182998329401016, 0.1004665195941925, 0.103536456823349], [0.07359270006418228, 0.07461337745189667, 0.07843045145273209, 0.09825588017702103, 0.07776113599538803, 0.08173923939466476, 0.0799330621957779, 0.10763968527317047, 0.10913257300853729, 0.10672109574079514, 0.11218073964118958], [0.07499850541353226, 0.07595010846853256, 0.0794992595911026, 0.09771377593278885, 0.0788780003786087, 0.08256395906209946, 0.08089236170053482, 0.10622285306453705, 0.10757064074277878, 0.10539274662733078, 0.11031775176525116], [0.07436738908290863, 0.0753503143787384, 0.07902068644762039, 0.0979585275053978, 0.07837770879268646, 0.08219554275274277, 0.0804632380604744, 0.10685762017965317, 0.10826995968818665, 0.10598812997341156, 0.11115089803934097], [0.08296298235654831, 0.0834771916270256, 0.0853666141629219, 0.0944482684135437, 0.08503902703523636, 0.08696380257606506, 0.08609645068645477, 0.09839311242103577, 0.09900295734405518, 0.09801554679870605, 0.1002340242266655], [0.08337017893791199, 0.08385992795228958, 0.08565812557935715, 0.09427321702241898, 0.0853465124964714, 0.08717658370733261, 0.08635217696428299, 0.09800171852111816, 0.09857742488384247, 0.09764519333839417, 0.09973899275064468], [0.08271000534296036, 0.08323930948972702, 0.08518509566783905, 0.09455665946006775, 0.08484764397144318, 0.08683102577924728, 0.08593709021806717, 0.09863670915365219, 0.09926794469356537, 0.09824596345424652, 0.10054254531860352], [0.084186851978302, 0.0846269279718399, 0.08624032139778137, 0.09391992539167404, 0.0859609991312027, 0.08759982883930206, 0.08686204999685287, 0.09721929579973221, 0.09772749990224838, 0.09690441191196442, 0.09875188022851944]], [[0.05705275759100914, 0.06664743274450302, 0.05814716964960098, 0.06963932514190674, 0.057804450392723083, 0.0598282665014267, 0.07165267318487167, 0.06097591295838356, 0.3701556622982025, 0.06768777221441269, 0.06040862947702408], [0.07846453785896301, 0.08409585058689117, 0.07913214713335037, 0.08575873076915741, 0.07892383635044098, 0.08014421164989471, 0.08685555309057236, 0.08082611113786697, 0.1806303858757019, 0.08467867225408554, 0.08048994094133377], [0.05995260924100876, 0.06930147111415863, 0.061024051159620285, 0.07219743728637695, 0.06068866327404976, 0.06266722828149796, 0.0741414874792099, 0.06378718465566635, 0.3426966369152069, 0.07030943036079407, 0.06323376297950745], [0.08332378417253494, 0.08715710788965225, 0.08378316462039948, 0.08827164024114609, 0.0836399719119072, 0.08447698503732681, 0.08900263905525208, 0.08494272828102112, 0.1431400626897812, 0.08754861354827881, 0.08471328765153885], [0.05905584990978241, 0.06848884373903275, 0.06013534218072891, 0.07141692191362381, 0.05979739874601364, 0.06179169565439224, 0.07338400185108185, 0.0629211962223053, 0.3511381149291992, 0.0695076733827591, 0.06236300244927406], [0.0641912892460823, 0.0730385109782219, 0.06521248072385788, 0.07575192302465439, 0.06489304453134537, 0.06677480787038803, 0.07756674289703369, 0.06783708184957504, 0.3034372925758362, 0.07398431748151779, 0.06731241941452026], [0.08618410676717758, 0.08873652666807175, 0.0864921286702156, 0.08947119861841202, 0.08639618009328842, 0.08695622533559799, 0.0899512767791748, 0.08726701140403748, 0.12243638187646866, 0.08899496495723724, 0.08711398392915726], [0.06692443042993546, 0.07535083591938019, 0.06790165603160858, 0.07791806012392044, 0.06759611517190933, 0.0693943202495575, 0.07963091135025024, 0.07040760666131973, 0.27872219681739807, 0.07624655961990356, 0.0699073001742363], [0.1564381718635559, 0.06484241783618927, 0.1404716521501541, 0.05055977404117584, 0.1452561914920807, 0.11952466517686844, 0.04302036017179489, 0.10732565075159073, 3.917942194675561e-06, 0.05939449742436409, 0.11316268891096115], [0.08024252206087112, 0.08526649326086044, 0.08084039390087128, 0.08674194663763046, 0.08065391331911087, 0.08174557983875275, 0.08771321177482605, 0.08235465735197067, 0.16660277545452118, 0.08578403294086456, 0.08205447345972061], [0.06559012085199356, 0.07423198968172073, 0.06659001111984253, 0.07687349617481232, 0.06627729535102844, 0.06811848282814026, 0.07863800972700119, 0.06915691494941711, 0.2907263934612274, 0.0751531794667244, 0.06864411383867264]], [[0.07186825573444366, 0.07589787989854813, 0.07406599074602127, 0.10255120694637299, 0.07940579950809479, 0.08061078190803528, 0.07866514474153519, 0.1089191660284996, 0.11057200282812119, 0.10790320485830307, 0.10954062640666962], [0.07326583564281464, 0.07704789191484451, 0.07533052563667297, 0.1017085388302803, 0.08032762259244919, 0.08145160973072052, 0.0796360895037651, 0.10752176493406296, 0.10902626067399979, 0.10659611225128174, 0.10808765888214111], [0.07263820618391037, 0.07653241604566574, 0.0747632086277008, 0.1020873412489891, 0.07991524040699005, 0.0810757651925087, 0.07920153439044952, 0.1081477627158165, 0.10971827059984207, 0.10718190670013428, 0.10873839259147644], [0.08121665567159653, 0.08344299346208572, 0.08243846893310547, 0.09686911851167679, 0.08533301949501038, 0.08597248792648315, 0.08493752032518387, 0.09980562329292297, 0.10055354982614517, 0.09934304654598236, 0.10008750855922699], [0.0744338110089302, 0.07800296694040298, 0.0763838142156601, 0.10100218653678894, 0.08108821511268616, 0.08214350789785385, 0.08043842762708664, 0.10636358708143234, 0.10774783045053482, 0.10551125556230545, 0.10688440501689911], [0.07482520490884781, 0.07832179218530655, 0.07673607021570206, 0.10076505690813065, 0.08134110271930695, 0.08237318694591522, 0.08070544898509979, 0.10597740113735199, 0.1073220819234848, 0.10514921694993973, 0.10648338496685028], [0.07419079542160034, 0.07780469208955765, 0.07616492360830307, 0.1011493131518364, 0.080930694937706, 0.08200035244226456, 0.08027216792106628, 0.10660386085510254, 0.1080128476023674, 0.10573642700910568, 0.10713395476341248], [0.0828542411327362, 0.08472956717014313, 0.08388450741767883, 0.09586523473262787, 0.08631483465433121, 0.08684981614351273, 0.08598361909389496, 0.09826415032148361, 0.09887319803237915, 0.0978870689868927, 0.0984937846660614], [0.08326590061187744, 0.08505136519670486, 0.08424705266952515, 0.09561259299516678, 0.08655906468629837, 0.08706754446029663, 0.08624417334794998, 0.09787914156913757, 0.09845412522554398, 0.09752307087182999, 0.09809596091508865], [0.08259853720664978, 0.08452935516834259, 0.0836591124534607, 0.0960220992565155, 0.08616261184215546, 0.0867140144109726, 0.08582128584384918, 0.09850379079580307, 0.0991341695189476, 0.09811356663703918, 0.09874145686626434], [0.08300964534282684, 0.08485112339258194, 0.08402141183614731, 0.09576986730098724, 0.08640715479850769, 0.08693214505910873, 0.0860820859670639, 0.09811868518590927, 0.09871483594179153, 0.09774956107139587, 0.09834346920251846]], [[0.0885312557220459, 0.1054319217801094, 0.09044227749109268, 0.11076625436544418, 0.08984334766864777, 0.0933864489197731, 0.11121396720409393, 0.09276801347732544, 0.015126897022128105, 0.10432115942239761, 0.09816840291023254], [0.09128956496715546, 0.09974498301744461, 0.09228341281414032, 0.10227254033088684, 0.09197305887937546, 0.09379449486732483, 0.10248192399740219, 0.09347905963659286, 0.037270572036504745, 0.09921079128980637, 0.0961996391415596], [0.08895839750766754, 0.10483107715845108, 0.09076175838708878, 0.10980791598558426, 0.09019682556390762, 0.09353557974100113, 0.11022496223449707, 0.09295336902141571, 0.016907598823308945, 0.10379286855459213, 0.098029725253582], [0.09163100272417068, 0.09771134704351425, 0.0923534631729126, 0.09950105100870132, 0.09212808310985565, 0.09344784915447235, 0.09964875876903534, 0.0932198017835617, 0.04784727096557617, 0.09733151644468307, 0.09517981857061386], [0.0888274535536766, 0.10502021014690399, 0.09066446125507355, 0.11010786890983582, 0.09008890390396118, 0.09349144250154495, 0.1105344146490097, 0.0928979367017746, 0.016332611441612244, 0.10395947843790054, 0.09807524085044861], [0.08956226706504822, 0.10388901084661484, 0.09120164811611176, 0.10833670198917389, 0.09068841487169266, 0.09371714293956757, 0.10870851576328278, 0.09318976104259491, 0.019970206543803215, 0.10295864939689636, 0.09777764230966568], [0.09164673835039139, 0.09753398597240448, 0.09234687685966492, 0.09926465153694153, 0.09212848544120789, 0.09340712428092957, 0.09940744936466217, 0.09318622201681137, 0.048827677965164185, 0.09716655313968658, 0.09508427232503891], [0.0894409790635109, 0.10408871620893478, 0.09111461043357849, 0.10864543914794922, 0.09059058874845505, 0.09368395805358887, 0.10902655869722366, 0.09314515441656113, 0.01929333806037903, 0.1031360775232315, 0.09783457219600677], [0.04752636328339577, 0.13523894548416138, 0.054007142782211304, 0.1817217469215393, 0.05190139636397362, 0.06542231887578964, 0.18616287410259247, 0.06287149339914322, 1.2129308970543207e-06, 0.12693139910697937, 0.08821509778499603], [0.09118393063545227, 0.10015112161636353, 0.09223547577857971, 0.10284056514501572, 0.09190703183412552, 0.09383556991815567, 0.10306353121995926, 0.09350142627954483, 0.03531264886260033, 0.0995832309126854, 0.09638550132513046], [0.09039659798145294, 0.10230686515569687, 0.09177464246749878, 0.10594738274812698, 0.09134367108345032, 0.09388120472431183, 0.1062505841255188, 0.09344033896923065, 0.025854645296931267, 0.10154210031032562, 0.09726196527481079]], [[0.07208339869976044, 0.07702145725488663, 0.07526539266109467, 0.10232947021722794, 0.07743623852729797, 0.07854503393173218, 0.08269592374563217, 0.10435367375612259, 0.10986847430467606, 0.1073634997010231, 0.11303737014532089], [0.07396944612264633, 0.07848628610372543, 0.07688362151384354, 0.10119730979204178, 0.07886427640914917, 0.07987365126609802, 0.0836392417550087, 0.10298612713813782, 0.10784132033586502, 0.10563922673463821, 0.11061950773000717], [0.07331007719039917, 0.07797610759735107, 0.07631920278072357, 0.10159363597631454, 0.07836707681417465, 0.07941154390573502, 0.08331269025802612, 0.10346383601427078, 0.10854657739400864, 0.10624008625745773, 0.11145921796560287], [0.08233357220888138, 0.0847821831703186, 0.08392173051834106, 0.09613434970378876, 0.08498381823301315, 0.08551990240812302, 0.08749016374349594, 0.09697084128856659, 0.0992049127817154, 0.0981980711221695, 0.10046042501926422], [0.07412343472242355, 0.07860513776540756, 0.077015221118927, 0.10110468417406082, 0.07898006588220596, 0.07998121529817581, 0.08371499925851822, 0.10287462919950485, 0.107677161693573, 0.10549920797348022, 0.11042426526546478], [0.07453183829784393, 0.07891981303691864, 0.07736390084028244, 0.10085885226726532, 0.0792866051197052, 0.08026581257581711, 0.08391502499580383, 0.1025790199637413, 0.10724268853664398, 0.10512839257717133, 0.10990796983242035], [0.07602079957723618, 0.08006040751934052, 0.07863052189350128, 0.09996116161346436, 0.0803970918059349, 0.08129521459341049, 0.08463320136070251, 0.1015029028058052, 0.10567063093185425, 0.10378334671258926, 0.10804470628499985], [0.082925945520401, 0.08521594107151031, 0.08441176265478134, 0.09577400237321854, 0.08540430665016174, 0.08590494841337204, 0.08774308115243912, 0.09654837846755981, 0.09861424565315247, 0.0976836234331131, 0.09977378696203232], [0.08449245244264603, 0.08635538071393967, 0.0857023298740387, 0.09482039511203766, 0.08650817722082138, 0.08691393584012985, 0.08839969336986542, 0.09543369710445404, 0.09706509113311768, 0.09633104503154755, 0.09797778725624084], [0.08378926664590836, 0.08584526181221008, 0.0851239562034607, 0.09524857252836227, 0.08601410686969757, 0.08646266907453537, 0.08810713142156601, 0.09593360871076584, 0.09775819629430771, 0.09693679213523865, 0.09878046810626984], [0.08536296337842941, 0.08698383718729019, 0.08641618490219116, 0.09429012984037399, 0.08711656183004379, 0.08746887743473053, 0.0887570008635521, 0.09481590241193771, 0.0962122306227684, 0.09558435529470444, 0.09699199348688126]], [[0.08841545134782791, 0.10828395187854767, 0.08782994002103806, 0.11062134802341461, 0.08972582221031189, 0.09068906307220459, 0.1110684797167778, 0.09264666587114334, 0.015536101534962654, 0.10714313387870789, 0.09803998470306396], [0.09145398437976837, 0.09974296391010284, 0.0911942720413208, 0.1006588414311409, 0.09203165769577026, 0.09245322644710541, 0.10083278268575668, 0.0933021754026413, 0.04344907030463219, 0.0992918387055397, 0.0955893024802208], [0.08827679604291916, 0.10852581262588501, 0.08768128603696823, 0.11091284453868866, 0.08960983902215958, 0.0905899628996849, 0.11136956512928009, 0.09258248656988144, 0.015014185570180416, 0.10736113041639328, 0.09807605296373367], [0.09157508611679077, 0.09866243600845337, 0.09135161340236664, 0.09944033622741699, 0.09207186847925186, 0.09243413060903549, 0.09958795458078384, 0.09316292405128479, 0.04831300675868988, 0.09827890247106552, 0.09512174129486084], [0.08871637284755707, 0.10774200409650803, 0.0881531834602356, 0.10997017472982407, 0.0899762362241745, 0.09090185910463333, 0.11039617657661438, 0.09278175979852676, 0.016755908727645874, 0.10665377974510193, 0.09795259684324265], [0.0889291912317276, 0.10734282433986664, 0.08838234096765518, 0.10949225723743439, 0.09015210717916489, 0.09105023741722107, 0.10990305244922638, 0.09287342429161072, 0.017699576914310455, 0.10629255324602127, 0.09788234531879425], [0.0915919840335846, 0.09845320135354996, 0.09137536585330963, 0.09920533746480942, 0.09207343310117722, 0.09242445975542068, 0.0993480458855629, 0.09313053637742996, 0.049287863075733185, 0.09808231145143509, 0.09502745419740677], [0.08933952450752258, 0.10652881115674973, 0.08882570266723633, 0.1085221916437149, 0.09048782289028168, 0.09133050590753555, 0.10890287160873413, 0.09303949773311615, 0.019745633006095886, 0.10555385053157806, 0.0977235808968544], [0.0467320941388607, 0.1547444760799408, 0.04493359103798866, 0.1755492240190506, 0.05097471922636032, 0.054293349385261536, 0.17978215217590332, 0.06159286946058273, 1.6179819795070216e-06, 0.14536036550998688, 0.08603551983833313], [0.0913751870393753, 0.1002626121044159, 0.09109761565923691, 0.1012478619813919, 0.0919928103685379, 0.09244369715452194, 0.10143504291772842, 0.09335212409496307, 0.04121323302388191, 0.09977754205465317, 0.09580233693122864], [0.09031030535697937, 0.10425691306591034, 0.08988621085882187, 0.10584624856710434, 0.09125647693872452, 0.09194942563772202, 0.10614915937185287, 0.09335114806890488, 0.026347456499934196, 0.10347757488489151, 0.09716912358999252]]], "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 5.189722742215963e-06, "vf_explained_var": -0.002962946891784668, "total_loss": 0.2780424654483795, "policy_loss": -3.2411611755378544e-05, "num_module_steps_trained_lifetime": 17955, "use_intrinsic_rewards": 0.0, "num_module_steps_trained": 5985, "vf_loss": 0.35831302404403687, "weights_seq_no": 3.0, "module_train_batch_size_mean": 997.9168410861561, "curr_kl_coeff": 0.020197991281747818, "curr_entropy_coeff": 0.0015431216992, "entropy": 0.6930539608001709, "vf_loss_unclipped": 44.545501708984375, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 777.960791911297}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"module_train_batch_size_mean": 997.6672132667843, "total_loss": 0.0, "num_module_steps_trained_lifetime": 107730, "diff_num_grad_updates_vs_sampler_policy": 16.0, "num_module_steps_trained": 35910, "weights_seq_no": 18.0}, "default_policy": {"policy_loss": -3.166369424434379e-05, "num_module_steps_trained_lifetime": 107730, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35910, "vf_loss": 0.35835161805152893, "weights_seq_no": 18.0, "module_train_batch_size_mean": 997.6672132667843, "entropy": 0.6930539011955261, "vf_loss_unclipped": 44.60425567626953, "diff_num_grad_updates_vs_sampler_policy": 16.0, "mean_kl_loss": 5.1114293455611914e-06, "vf_explained_var": -0.002435445785522461, "total_loss": 0.27807390689849854}, "__all_modules__": {"num_env_steps_trained": 198000, "num_module_steps_trained_lifetime": 215460, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 594000, "num_env_steps_trained_lifetime_throughput": 57110.91201796734}}}, "intrinsic_reward_module": {"curr_entropy_coeff": 0.0015431216992, "default_optimizer_learning_rate": 0.0002715581955, "module_train_batch_size_mean": 997.9168410861561, "total_loss": 0.0, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 17955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "weights_seq_no": 3.0, "num_module_steps_trained_lifetime_throughput": 777.9767184921437}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 99000, "num_env_steps_trained": 33000, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 35910, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 4291.303763872265, "num_module_steps_trained_throughput": 30339017.792017903, "num_module_steps_trained_lifetime_throughput": 15241167.153489044}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 10.368205581254823, "num_episodes_lifetime": 60, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 0.4666666666666667}, "episode_len_min": 20, "weights_seq_no": 3.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7692633007135488e-06, "numpy_to_tensor": 1.1906584671498576e-05, "add_observations_from_episodes_to_batch": 2.7788115607919677e-06, "add_time_dim_to_batch_and_zero_pad": 6.734324039529975e-06, "batch_individual_items": 1.2286606335204483e-05}}, "connector_pipeline_timer": 5.8301165702545967e-05}, "num_env_steps_sampled": 400, "env_reset_timer": 0.00020105217086384072, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1778861421321469e-05, "get_actions": 3.6113945112336426e-05, "listify_data_for_vector_env": 1.043257046936351e-05, "un_batch_to_individual_items": 6.4524655173722005e-06, "tensor_to_numpy": 1.4990462516109827e-05, "normalize_and_clip_actions": 7.975316536828013e-06}}, "connector_pipeline_timer": 0.00011396768106155134}, "episode_len_max": 20, "env_step_timer": 1.390679252593149e-05, "rlmodule_inference_timer": 3.138399243613739e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368205581254823, "module_episode_returns_mean": {"default_policy": 0.4666666666666667}, "episode_len_mean": 20.0, "episode_return_min": -14.5, "episode_return_mean": 0.4666666666666667, "num_env_steps_sampled_lifetime": 15400, "sample": 0.1167356232089689, "episode_duration_sec_mean": 0.005280073563335463, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "episode_return_max": 14.5, "time_between_sampling": 9.617231209240853}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "aec1c_00000", "date": "2025-08-11_18-39-39", "timestamp": 1754930379, "time_this_iter_s": 10.148056030273438, "time_total_s": 29.81105399131775, "pid": 11610, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3842f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 29.81105399131775, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 43.607142857142854, "ram_util_percent": 78.09285714285714}}
{"timers": {"training_iteration": 9.844185700705669, "restore_env_runners": 8.567741352482698e-06, "training_step": 9.844020217839187, "env_runner_sampling_timer": 1.6276779997661306, "learner_update_timer": 8.041828515632927, "synch_weights": 0.001103207258372451, "restore_eval_env_runners": 2.112748387735337e-05, "evaluation_iteration": 0.12360866161257728, "synch_eval_env_connectors": 0.00016457285380456596, "synch_env_connectors": 5.323235352989286e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.56016415091312e-05, "normalize_and_clip_actions": 8.091914738594764e-06, "get_actions": 3.999793458908751e-05, "un_batch_to_individual_items": 6.555427219022372e-06, "remove_single_ts_time_rank_from_batch": 1.1897355983082038e-05, "listify_data_for_vector_env": 1.0623646371092517e-05}}, "connector_pipeline_timer": 0.00011977295104182173}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.976662640487697e-06, "numpy_to_tensor": 1.2515281661971419e-05, "add_states_from_episodes_to_batch": 2.69515613681128e-06, "add_observations_from_episodes_to_batch": 2.793756629776103e-06, "batch_individual_items": 1.2408888154349564e-05}}, "connector_pipeline_timer": 5.971381445133218e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "rlmodule_inference_timer": 3.2314302969406727e-05, "episode_len_mean": 20.0, "episode_return_min": -11.5, "weights_seq_no": 3.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_mean": -1.9, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime": -1225000.0, "num_env_steps_sampled": 5000.0, "sample": 0.005838582313624828, "env_reset_timer": 4.2228071692746496e-05, "episode_duration_sec_mean": 0.005317975668236615, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -61250.0, "time_between_sampling": 0.034584028422807354, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": -1.9}, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.3741320219066205e-05, "module_episode_returns_mean": {"default_policy": -1.9}, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 3211.4883596864547}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13699961995802376, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008915454771352235, "add_observations_from_episodes_to_batch": 0.0008239953285212395, "add_columns_from_episodes_to_train_batch": 0.04148640508727904, "add_time_dim_to_batch_and_zero_pad": 0.07570324408211024, "add_states_from_episodes_to_batch": 0.0035403954899382076, "batch_individual_items": 0.0063318624593501445, "numpy_to_tensor": 7.114058176870458e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"IntrinsicAttentionMask": [[[0.07281432300806046, 0.07495531439781189, 0.07602858543395996, 0.10336709767580032, 0.07822144776582718, 0.07934148609638214, 0.08047755807638168, 0.10941583663225174, 0.10692118108272552, 0.10845216363668442, 0.11000506579875946], [0.0736103430390358, 0.07567351311445236, 0.07670674473047256, 0.10282180458307266, 0.07881572097539902, 0.0798918604850769, 0.08098268508911133, 0.10855350643396378, 0.10619142651557922, 0.10764134675264359, 0.10911105573177338], [0.07400239259004593, 0.07602667063474655, 0.0770399421453476, 0.10255305469036102, 0.07910715043544769, 0.08016147464513779, 0.08122984319925308, 0.10813051462173462, 0.10583286732435226, 0.1072433739900589, 0.10867268592119217], [0.08270329982042313, 0.08377016335725784, 0.08429858833551407, 0.09656604379415512, 0.08536545187234879, 0.08590393513441086, 0.08644581586122513, 0.09902574121952057, 0.09802072495222092, 0.09863904118537903, 0.09926125407218933], [0.07478946447372437, 0.07673456519842148, 0.07770724594593048, 0.10201315581798553, 0.07968974113464355, 0.0806998759508133, 0.08172282576560974, 0.10728475451469421, 0.10511474311351776, 0.10644716024398804, 0.10779647529125214], [0.07518447190523148, 0.07708927243947983, 0.07804133743047714, 0.10174202173948288, 0.07998087257146835, 0.08096864819526672, 0.08196862041950226, 0.10686200112104416, 0.10475520044565201, 0.10604893416166306, 0.1073586493730545], [0.07558045536279678, 0.07744447886943817, 0.07837571203708649, 0.10147011280059814, 0.0802718847990036, 0.08123711496591568, 0.08221394568681717, 0.10643932968378067, 0.10439533740282059, 0.1056506335735321, 0.10692102462053299], [0.08435896784067154, 0.08522333204746246, 0.08565061539411545, 0.09542422741651535, 0.08651162683963776, 0.08694536983966827, 0.08738129585981369, 0.09735238552093506, 0.09656575322151184, 0.09704990684986115, 0.09753648936748505], [0.08368593454360962, 0.08463339507579803, 0.0851021334528923, 0.0958884060382843, 0.08604740351438522, 0.08652397245168686, 0.0870031788945198, 0.09803040325641632, 0.09715598821640015, 0.09769407659769058, 0.09823515266180038], [0.08410057425498962, 0.08499696850776672, 0.08544021844863892, 0.09560245275497437, 0.08633367717266083, 0.08678390830755234, 0.08723647892475128, 0.09761235862970352, 0.09679217636585236, 0.09729694575071335, 0.09780434519052505], [0.0845160037279129, 0.0853608250617981, 0.0857783779501915, 0.09531591832637787, 0.08661960810422897, 0.08704332262277603, 0.08746910095214844, 0.09719464182853699, 0.0964282900094986, 0.09689997136592865, 0.09737396985292435]], [[0.051920752972364426, 0.06318625062704086, 0.05446351692080498, 0.06628073006868362, 0.055601995438337326, 0.054676756262779236, 0.0683698058128357, 0.055819686502218246, 0.4086458683013916, 0.06426089257001877, 0.05677374079823494], [0.07773485034704208, 0.08424442261457443, 0.07927194982767105, 0.08591023832559586, 0.07994642853736877, 0.07939890772104263, 0.087008997797966, 0.08007446676492691, 0.1809493750333786, 0.08482827246189117, 0.08063214272260666], [0.058743927627801895, 0.06949982047080994, 0.06119872257113457, 0.07240408658981323, 0.0622924380004406, 0.06140382960438728, 0.07435368746519089, 0.0625011995434761, 0.3436768651008606, 0.07051067054271698, 0.06341475248336792], [0.08282554894685745, 0.08726272732019424, 0.08388470113277435, 0.08837860822677612, 0.08434717357158661, 0.08397185802459717, 0.08911049365997314, 0.08443481475114822, 0.1433134227991104, 0.087654709815979, 0.08481595665216446], [0.061628006398677826, 0.07202672213315964, 0.06401265412569046, 0.07481373101472855, 0.06507284939289093, 0.06421156972646713, 0.07668004184961319, 0.06527506560087204, 0.31712234020233154, 0.07299769669771194, 0.06615938246250153], [0.059292785823345184, 0.06998749822378159, 0.06173582375049591, 0.07287118583917618, 0.06282386183738708, 0.06193988025188446, 0.0748060941696167, 0.06303151696920395, 0.3385798931121826, 0.07099136710166931, 0.06394008547067642], [0.08585147559642792, 0.08880847692489624, 0.08656226843595505, 0.08954374492168427, 0.08687163889408112, 0.08662061393260956, 0.09002421796321869, 0.08693020045757294, 0.1225355863571167, 0.08906713128089905, 0.08718462288379669], [0.0621662475168705, 0.07248832285404205, 0.06453544646501541, 0.07525090873241425, 0.06558836996555328, 0.06473301351070404, 0.07710001617670059, 0.06578916311264038, 0.3122304379940033, 0.0734509751200676, 0.06666716188192368], [0.17339399456977844, 0.06240951642394066, 0.13520099222660065, 0.048662763088941574, 0.12140202522277832, 0.13247957825660706, 0.04140623286366463, 0.11895834654569626, 3.770973080463591e-06, 0.05716599524021149, 0.10891681164503098], [0.07959092408418655, 0.08540123701095581, 0.08096816390752792, 0.08687903732061386, 0.08157145231962204, 0.08108177781105042, 0.08785182982683182, 0.08168590068817139, 0.16686590015888214, 0.08591960370540619, 0.08218415081501007], [0.06447315961122513, 0.07442974299192429, 0.06676740199327469, 0.07707827538251877, 0.06778523325920105, 0.0669584721326828, 0.0788474977016449, 0.06797922402620316, 0.29150059819221497, 0.07535337656736374, 0.06882697343826294]], [[0.07192645221948624, 0.07595935463905334, 0.07711202651262283, 0.09865989536046982, 0.07947012037038803, 0.07755200564861298, 0.08190032094717026, 0.10900736600160599, 0.10637632757425308, 0.1079905778169632, 0.11404558271169662], [0.07331665605306625, 0.07710134238004684, 0.07818017899990082, 0.0981372743844986, 0.08038336038589478, 0.07859163731336594, 0.0826486200094223, 0.10759633779525757, 0.10519805550575256, 0.10667003691196442, 0.11217644810676575], [0.07370295375585556, 0.07741729170084, 0.07847529649734497, 0.09799053519964218, 0.08063489198684692, 0.0788787305355072, 0.08285391330718994, 0.107206791639328, 0.10487191379070282, 0.10630512237548828, 0.11166249215602875], [0.08017157018184662, 0.08262136578559875, 0.08331077545881271, 0.09544359147548676, 0.08470690250396729, 0.08357270061969757, 0.0861264318227768, 0.10084287077188492, 0.0994926169514656, 0.10032280534505844, 0.10338836163282394], [0.07447874546051025, 0.07805004715919495, 0.07906581461429596, 0.09769391268491745, 0.08113716542720795, 0.07945295423269272, 0.08326277881860733, 0.10642777383327484, 0.10421860218048096, 0.10557492822408676, 0.11063731461763382], [0.073849156498909, 0.07753672450780869, 0.07858680933713913, 0.09793483465909958, 0.08072984963655472, 0.07898718118667603, 0.08293131738901138, 0.10705964267253876, 0.10474862158298492, 0.1061672493815422, 0.11146857589483261], [0.075258769094944, 0.07868386059999466, 0.07965660095214844, 0.09739308804273605, 0.08163829892873764, 0.08002718538045883, 0.08366929739713669, 0.10564890503883362, 0.10356394946575165, 0.10484426468610764, 0.10961582511663437], [0.08286601305007935, 0.08474160730838776, 0.0852668434381485, 0.09433787316083908, 0.08632709830999374, 0.08546610176563263, 0.08740054816007614, 0.09827810525894165, 0.09729790687561035, 0.09790097177028656, 0.10011686384677887], [0.08220206201076508, 0.08422169834375381, 0.08478795737028122, 0.09461256861686707, 0.0859319195151329, 0.08500286191701889, 0.08709131181240082, 0.0989055410027504, 0.0978362187743187, 0.09849400818347931, 0.10091392695903778], [0.08261104673147202, 0.08454214781522751, 0.08508317917585373, 0.09444352239370346, 0.08617565035820007, 0.08528846502304077, 0.08728215843439102, 0.09851869195699692, 0.09750442951917648, 0.09812840819358826, 0.10042224824428558], [0.08410044014453888, 0.08570380508899689, 0.08615180850028992, 0.09382351487874985, 0.08705485612154007, 0.08632165193557739, 0.08796736598014832, 0.09711949527263641, 0.09630153328180313, 0.09680493921041489, 0.0986505076289177]], [[0.08583368360996246, 0.10681919753551483, 0.09052877873182297, 0.10930927097797394, 0.08988207578659058, 0.09092366695404053, 0.11315363645553589, 0.09589719027280807, 0.013146339915692806, 0.10560541599988937, 0.09890074282884598], [0.09024766087532043, 0.10001642256975174, 0.09253454953432083, 0.10110527276992798, 0.09222335368394852, 0.09272399544715881, 0.10276081413030624, 0.0950736477971077, 0.03737202286720276, 0.09948078542947769, 0.09646143019199371], [0.08709343522787094, 0.10536978393793106, 0.091228187084198, 0.10750583559274673, 0.09066033363342285, 0.09157466143369675, 0.11079137772321701, 0.09592214971780777, 0.01699451543390751, 0.10432624071836472, 0.09853348135948181], [0.09054805338382721, 0.09913095831871033, 0.0925668329000473, 0.10008128732442856, 0.09229247272014618, 0.09273380041122437, 0.10152388364076614, 0.09480130672454834, 0.04163883998990059, 0.09866300970315933, 0.09601958096027374], [0.08692870289087296, 0.10557094216346741, 0.09113992005586624, 0.10775420069694519, 0.09056135267019272, 0.09149298816919327, 0.11111405491828918, 0.09592533111572266, 0.016418293118476868, 0.10450465232133865, 0.09858956187963486], [0.08719262480735779, 0.10524667054414749, 0.09128078073263168, 0.10735412687063217, 0.09071947634220123, 0.09162325412034988, 0.11059469729661942, 0.0959191545844078, 0.017353974282741547, 0.10421690344810486, 0.09849835187196732], [0.0909084901213646, 0.0977185070514679, 0.09252159297466278, 0.09846502542495728, 0.09230278432369232, 0.09265469014644623, 0.09959551692008972, 0.09429877996444702, 0.048920076340436935, 0.09735038876533508, 0.09526415914297104], [0.08834907412528992, 0.10367396473884583, 0.09185785055160522, 0.10543585568666458, 0.09137751162052155, 0.09215070307254791, 0.10813500732183456, 0.09581045806407928, 0.022402549162507057, 0.10281112790107727, 0.09799587726593018], [0.04160722345113754, 0.1399986296892166, 0.05590797960758209, 0.15908904373645782, 0.0537281297147274, 0.05727431923151016, 0.19271478056907654, 0.0769600048661232, 1.2556373576444457e-06, 0.13139879703521729, 0.09131982922554016], [0.09008271247148514, 0.10044026374816895, 0.09250177443027496, 0.10159855335950851, 0.09217237681150436, 0.09270232915878296, 0.10336107760667801, 0.09519173204898834, 0.03541463986039162, 0.09987074136734009, 0.09666377305984497], [0.08896169811487198, 0.10270001739263535, 0.09212733805179596, 0.10426562279462814, 0.09169471263885498, 0.0923909842967987, 0.10665889829397202, 0.0956786572933197, 0.025954026728868484, 0.1019323319196701, 0.09763574600219727]], [[0.07133264094591141, 0.07533225417137146, 0.07647539675235748, 0.10178691148757935, 0.07881402224302292, 0.07691174745559692, 0.08122416585683823, 0.10810740292072296, 0.10549808293581009, 0.11141332983970642, 0.11310401558876038], [0.07276365160942078, 0.07651978731155396, 0.07759048044681549, 0.10101136565208435, 0.07977703958749771, 0.07799884676933289, 0.08202522248029709, 0.10678474605083466, 0.10440455377101898, 0.109794020652771, 0.1113303080201149], [0.07316137105226517, 0.07684842497110367, 0.07789865136146545, 0.10079504549503326, 0.08004236966371536, 0.07829912006855011, 0.08224509656429291, 0.10641901195049286, 0.1041012853384018, 0.10934758931398392, 0.11084196716547012], [0.0809224545955658, 0.08314073830842972, 0.08376377820968628, 0.09651821106672287, 0.0850239098072052, 0.0840003564953804, 0.0863029956817627, 0.09944407641887665, 0.09824692457914352, 0.10094010084867477, 0.10169652849435806], [0.07396025955677032, 0.07750671356916428, 0.07851538807153702, 0.10035958886146545, 0.08057232946157455, 0.07889986038208008, 0.08268315345048904, 0.10568687319755554, 0.10349307209253311, 0.10845563560724258, 0.10986710339784622], [0.07331191748380661, 0.07697267085313797, 0.07801511883735657, 0.1007130816578865, 0.0801425650715828, 0.07841258496046066, 0.08232801407575607, 0.10628079622983932, 0.10398659110069275, 0.10917902737855911, 0.11065765470266342], [0.0747637003660202, 0.07816625386476517, 0.07913259416818619, 0.09992041438817978, 0.08110125362873077, 0.07950074225664139, 0.08311889320611954, 0.10495389997959137, 0.10288265347480774, 0.10756494104862213, 0.1088947206735611], [0.08260662108659744, 0.08447634428739548, 0.0849999263882637, 0.09557871520519257, 0.08605687320232391, 0.08519856631755829, 0.0871269553899765, 0.09797046333551407, 0.0969933345913887, 0.09918868541717529, 0.09980346262454987], [0.08192162960767746, 0.08393438160419464, 0.08449869602918625, 0.09596122801303864, 0.08563876152038574, 0.08471287041902542, 0.08679420500993729, 0.09856811165809631, 0.0975024402141571, 0.09989799559116364, 0.10056965053081512], [0.08345477283000946, 0.0851449966430664, 0.08561762422323227, 0.0951043963432312, 0.08657075464725494, 0.08579684793949127, 0.08753450214862823, 0.09723367542028427, 0.09636443108320236, 0.09831612557172775, 0.09886185824871063], [0.08388034254312515, 0.0854795053601265, 0.08592633157968521, 0.09486611932516098, 0.08682701736688614, 0.08609574288129807, 0.08773714303970337, 0.09686532616615295, 0.09604950249195099, 0.09788066893815994, 0.09839232265949249]], [[0.057846371084451675, 0.06757447123527527, 0.057505421340465546, 0.0706079825758934, 0.06008690968155861, 0.05916796624660492, 0.07264933735132217, 0.060302942991256714, 0.366068959236145, 0.06694070994853973, 0.06124889478087425], [0.07883521914482117, 0.08449312299489975, 0.07862769067287445, 0.08616385608911514, 0.08018244057893753, 0.07963331043720245, 0.08726586401462555, 0.08031085878610611, 0.17947864532470703, 0.08413885533809662, 0.08087018132209778], [0.056947529315948486, 0.06674273312091827, 0.05660482123494148, 0.06980346888303757, 0.05920064449310303, 0.05827632173895836, 0.07186470925807953, 0.059417981654405594, 0.3746683597564697, 0.06610364466905594, 0.06036984920501709], [0.0835636779665947, 0.08740802109241486, 0.08342085778713226, 0.08852577209472656, 0.08448762446641922, 0.08411168307065964, 0.08925886452198029, 0.08457541465759277, 0.14252087473869324, 0.08717001974582672, 0.08495718240737915], [0.06349898874759674, 0.07263211160898209, 0.06317529827356339, 0.07544253766536713, 0.06561979651451111, 0.0647512823343277, 0.07732453942298889, 0.06582372635602951, 0.3129734396934509, 0.07204281538724899, 0.06671545654535294], [0.061236120760440826, 0.07064448297023773, 0.06090417504310608, 0.07355523854494095, 0.063413605093956, 0.0625213235616684, 0.07550830394029617, 0.06362320482730865, 0.3340182602405548, 0.07003504782915115, 0.06454029679298401], [0.08633938431739807, 0.08889639377593994, 0.08624360710382462, 0.08963238447904587, 0.08695764094591141, 0.08670637011528015, 0.0901133269071579, 0.08701625466346741, 0.12208441644906998, 0.08873924612998962, 0.08727093040943146], [0.06401925534009933, 0.07308172434568405, 0.06369771808385849, 0.07586691528558731, 0.0661252811551094, 0.06526293605566025, 0.07773115485906601, 0.06632772088050842, 0.3081768751144409, 0.07249751687049866, 0.06721290200948715], [0.14887578785419464, 0.06256570667028427, 0.15386582911014557, 0.04897516593337059, 0.12044303864240646, 0.13125333189964294, 0.041777659207582474, 0.11805631220340729, 5.058321221440565e-06, 0.06594164669513702, 0.10824048519134521], [0.07774709165096283, 0.08376312255859375, 0.07752703130245209, 0.08554551005363464, 0.07917672395706177, 0.07859378308057785, 0.08672259002923965, 0.07931309193372726, 0.18831825256347656, 0.08338551223278046, 0.07990723848342896], [0.0662434920668602, 0.07497143000364304, 0.06593240797519684, 0.07763923704624176, 0.06827856600284576, 0.0674457922577858, 0.07942133396863937, 0.06847396492958069, 0.2878548204898834, 0.07441100478172302, 0.06932788342237473]]], "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 2.7128997317049652e-05, "vf_explained_var": -0.0008070468902587891, "total_loss": 0.27795031666755676, "policy_loss": -0.00012141108163632452, "num_module_steps_trained_lifetime": 23940, "use_intrinsic_rewards": 0.0, "num_module_steps_trained": 5985, "vf_loss": 0.3583085238933563, "weights_seq_no": 4.0, "module_train_batch_size_mean": 997.8923005732703, "curr_kl_coeff": 0.010098995640873909, "curr_entropy_coeff": 0.0015431216992, "entropy": 0.6930182576179504, "vf_loss_unclipped": 44.550228118896484, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 775.5455983255914}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"module_train_batch_size_mean": 997.6156867483631, "total_loss": 0.0, "num_module_steps_trained_lifetime": 143640, "diff_num_grad_updates_vs_sampler_policy": 21.0, "num_module_steps_trained": 35910, "weights_seq_no": 24.0}, "default_policy": {"policy_loss": -0.00011826616537291557, "num_module_steps_trained_lifetime": 143640, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35910, "vf_loss": 0.3583509027957916, "weights_seq_no": 24.0, "module_train_batch_size_mean": 997.6156867483631, "entropy": 0.693018913269043, "vf_loss_unclipped": 44.671207427978516, "diff_num_grad_updates_vs_sampler_policy": 21.0, "mean_kl_loss": 2.6546143999439664e-05, "vf_explained_var": -0.0024471282958984375, "total_loss": 0.2779902517795563}, "__all_modules__": {"num_env_steps_trained": 198000, "num_module_steps_trained_lifetime": 287280, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 792000, "num_env_steps_trained_lifetime_throughput": 56378.2854810286}}}, "intrinsic_reward_module": {"curr_entropy_coeff": 0.0015431216992, "default_optimizer_learning_rate": 0.0002715581955, "module_train_batch_size_mean": 997.8923005732703, "total_loss": 0.0, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 23940, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "weights_seq_no": 4.0, "num_module_steps_trained_lifetime_throughput": 775.5610266746297}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 132000, "num_env_steps_trained": 33000, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 47880, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 4277.9407533108615, "num_module_steps_trained_throughput": 29590486.82584862, "num_module_steps_trained_lifetime_throughput": 15132449.708215263}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 10.368237912813044, "num_episodes_lifetime": 80, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 0.55}, "episode_len_min": 20, "weights_seq_no": 4.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7869189669535998e-06, "numpy_to_tensor": 1.2391016884205633e-05, "add_observations_from_episodes_to_batch": 2.8325726816465878e-06, "add_time_dim_to_batch_and_zero_pad": 6.9685988367639366e-06, "batch_individual_items": 1.2848273184199225e-05}}, "connector_pipeline_timer": 6.016440590346368e-05}, "num_env_steps_sampled": 400, "env_reset_timer": 0.00019983414995099883, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2044776505238424e-05, "get_actions": 3.758805123259463e-05, "listify_data_for_vector_env": 1.0613114080838243e-05, "un_batch_to_individual_items": 6.646264450140617e-06, "tensor_to_numpy": 1.5334756351041e-05, "normalize_and_clip_actions": 8.179132752766991e-06}}, "connector_pipeline_timer": 0.00011727760292097592}, "episode_len_max": 20, "env_step_timer": 1.4391638757245661e-05, "rlmodule_inference_timer": 3.184574612738654e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368237912813044, "module_episode_returns_mean": {"default_policy": 0.55}, "episode_len_mean": 20.0, "episode_return_min": -14.5, "episode_return_mean": 0.55, "num_env_steps_sampled_lifetime": 20400, "sample": 0.11670830197774176, "episode_duration_sec_mean": 0.0052685807124362325, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "episode_return_max": 14.5, "time_between_sampling": 9.618088942987937}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "aec1c_00000", "date": "2025-08-11_18-39-49", "timestamp": 1754930389, "time_this_iter_s": 9.79753589630127, "time_total_s": 39.60858988761902, "pid": 11610, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3842f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 39.60858988761902, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 35.31428571428571, "ram_util_percent": 78.47142857142858}}
{"timers": {"training_iteration": 9.840554464527843, "restore_env_runners": 8.541223877203881e-06, "training_step": 9.8403884273207, "env_runner_sampling_timer": 1.6270081618579766, "learner_update_timer": 8.038763160895744, "synch_weights": 0.0011007585154067037, "restore_eval_env_runners": 2.1016209800029173e-05, "evaluation_iteration": 0.12356356582652464, "synch_eval_env_connectors": 0.00016404921530070713, "synch_env_connectors": 5.34333301067818e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5720658151089805e-05, "normalize_and_clip_actions": 8.052110960652808e-06, "get_actions": 4.028349216850649e-05, "un_batch_to_individual_items": 6.615922930390914e-06, "remove_single_ts_time_rank_from_batch": 1.1920358682453045e-05, "listify_data_for_vector_env": 1.0721276702922764e-05}}, "connector_pipeline_timer": 0.00012025505428977535}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.896370163472922e-06, "numpy_to_tensor": 1.2714441698540277e-05, "add_states_from_episodes_to_batch": 2.6964620600363406e-06, "add_observations_from_episodes_to_batch": 2.7936628838057437e-06, "batch_individual_items": 1.2461665138351875e-05}}, "connector_pipeline_timer": 5.985907244872208e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "rlmodule_inference_timer": 3.247936207654803e-05, "episode_len_mean": 20.0, "episode_return_min": -11.5, "weights_seq_no": 4.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_mean": -2.1399999999999997, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime": -1842500.0, "num_env_steps_sampled": 5000.0, "sample": 0.005721788055539774, "env_reset_timer": 4.304002116758977e-05, "episode_duration_sec_mean": 0.005348020155448466, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -92125.0, "time_between_sampling": 0.033660988544761676, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": -2.1399999999999997}, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.389806681972304e-05, "module_episode_returns_mean": {"default_policy": -2.1399999999999997}, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 3198.795838676104}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1369793204291024, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.0089122702240026, "add_observations_from_episodes_to_batch": 0.0008241274552827106, "add_columns_from_episodes_to_train_batch": 0.04148684187621968, "add_time_dim_to_batch_and_zero_pad": 0.07570610664166308, "add_states_from_episodes_to_batch": 0.0035412852852019935, "batch_individual_items": 0.006310733424923897, "numpy_to_tensor": 7.108792601941387e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"IntrinsicAttentionMask": [[[0.0727725401520729, 0.07387685775756836, 0.07801909744739532, 0.09982041269540787, 0.08040492981672287, 0.0816250741481781, 0.07965493947267532, 0.1060187891125679, 0.10762761533260345, 0.10926085710525513, 0.11091887205839157], [0.07313966751098633, 0.07422567158937454, 0.07829617708921432, 0.09964895248413086, 0.08063856512308121, 0.08183591812849045, 0.07990239560604095, 0.10570056736469269, 0.10727003961801529, 0.10886281728744507, 0.11047925055027008], [0.07447750121355057, 0.07549533993005753, 0.07929999381303787, 0.09902030974626541, 0.08148228377103806, 0.08259584754705429, 0.0807969719171524, 0.10454525053501129, 0.1059739962220192, 0.10742226988077164, 0.10889033228158951], [0.08067159354686737, 0.08134473860263824, 0.08383037894964218, 0.09603885561227798, 0.08523521572351456, 0.08594643324613571, 0.08479563891887665, 0.09928467869758606, 0.10011313110589981, 0.1009485051035881, 0.10179083794355392], [0.07522149384021759, 0.0762004479765892, 0.07985429465770721, 0.0986681580543518, 0.08194631338119507, 0.08301278203725815, 0.08128964900970459, 0.10390566289424896, 0.10525791347026825, 0.10662776231765747, 0.10801544040441513], [0.07559490948915482, 0.0765540823340416, 0.08013146370649338, 0.09849077463150024, 0.08217784017324448, 0.08322053402662277, 0.08153563737869263, 0.10358547419309616, 0.10489979386329651, 0.10623080283403397, 0.10757869482040405], [0.07498962432146072, 0.0759807676076889, 0.07968185096979141, 0.09877809137105942, 0.08180209249258041, 0.08288327604532242, 0.08113647252321243, 0.10410476475954056, 0.10548073053359985, 0.10687487572431564, 0.10828743875026703], [0.08222191780805588, 0.08280136436223984, 0.08493465185165405, 0.09527647495269775, 0.08613599091768265, 0.08674302697181702, 0.08576042950153351, 0.09799079596996307, 0.09868136048316956, 0.09937680512666702, 0.10007715225219727], [0.08261161297559738, 0.08316704630851746, 0.0852103903889656, 0.09508393704891205, 0.08636005222797394, 0.08694068342447281, 0.0860007181763649, 0.09766698628664017, 0.09832364320755005, 0.0989847183227539, 0.09965022653341293], [0.08300213515758514, 0.08353331685066223, 0.08548597246408463, 0.09489061683416367, 0.08658362179994583, 0.08713771402835846, 0.08624061942100525, 0.0973430648446083, 0.0979660153388977, 0.09859295189380646, 0.09922390431165695], [0.08339349925518036, 0.08390018343925476, 0.0857614129781723, 0.09469655156135559, 0.08680672198534012, 0.08733413368463516, 0.08648014068603516, 0.09701903909444809, 0.09760850667953491, 0.09820155799388885, 0.09879820793867111]], [[0.08527985215187073, 0.10612994432449341, 0.08726780861616135, 0.10860394686460495, 0.09204136580228806, 0.09310797601938248, 0.11242350935935974, 0.09527842700481415, 0.013462185859680176, 0.1081424206495285, 0.09826259315013885], [0.08995112776756287, 0.09968778491020203, 0.09093039482831955, 0.10077305883169174, 0.0932345911860466, 0.09374073147773743, 0.10242315381765366, 0.09476125240325928, 0.03778184577822685, 0.10057159513235092, 0.09614447504281998], [0.08585954457521439, 0.10555405169725418, 0.08774802088737488, 0.10787571221590042, 0.09227298200130463, 0.09328223764896393, 0.11145429313182831, 0.09533397108316422, 0.015025663189589977, 0.10744282603263855, 0.09815067797899246], [0.09028222411870956, 0.09883992373943329, 0.09114772081375122, 0.09978745877742767, 0.09317987412214279, 0.09362544119358063, 0.1012258231639862, 0.09452299028635025, 0.04203923046588898, 0.09961166232824326, 0.09573768824338913], [0.08714127540588379, 0.10414761304855347, 0.08879345655441284, 0.1061222180724144, 0.09273268282413483, 0.09360764920711517, 0.10915455967187881, 0.09538242965936661, 0.019353145733475685, 0.10575448721647263, 0.09781043976545334], [0.08740590512752533, 0.10382777452468872, 0.08900580555200577, 0.10572826117277145, 0.0928163081407547, 0.09366192668676376, 0.10864442586898804, 0.09537633508443832, 0.020438849925994873, 0.10537442564964294, 0.09772001206874847], [0.09069056063890457, 0.09748424589633942, 0.09138339012861252, 0.09822897613048553, 0.09300491958856583, 0.09335950016975403, 0.0993567556142807, 0.09407272189855576, 0.049292244017124176, 0.09809091687202454, 0.09503578394651413], [0.08791913837194443, 0.10316943377256393, 0.08941329270601273, 0.10492274910211563, 0.09296432882547379, 0.09375094622373581, 0.10760876536369324, 0.09534420818090439, 0.02279161661863327, 0.10459648817777634, 0.09751898050308228], [0.0407269150018692, 0.13485917448997498, 0.04620247334241867, 0.15299038589000702, 0.061841029673814774, 0.0658671110868454, 0.18485859036445618, 0.07472264766693115, 1.6637048929624143e-06, 0.14946499466896057, 0.08846496045589447], [0.09022435545921326, 0.09899982064962387, 0.0911109670996666, 0.099972665309906, 0.09319350123405457, 0.09365028142929077, 0.1014498844742775, 0.09457055479288101, 0.041219353675842285, 0.09979215264320374, 0.09581636637449265], [0.08856837451457977, 0.10224595665931702, 0.08991855382919312, 0.10380463302135468, 0.09311824291944504, 0.0938253328204155, 0.10618732869625092, 0.09525565057992935, 0.026356983929872513, 0.10351479053497314, 0.09720407426357269]], [[0.07124105095863342, 0.07232213765382767, 0.07637721300125122, 0.10165619105100632, 0.0787128359079361, 0.07990729063749313, 0.07797861844301224, 0.10796856880187988, 0.10960698127746582, 0.11127025634050369, 0.11295877397060394], [0.07163794338703156, 0.07270164787769318, 0.07668858021497726, 0.10144909471273422, 0.0789828896522522, 0.0801556408405304, 0.07826181501150131, 0.10761002451181412, 0.10920785367488861, 0.11082940548658371, 0.11247503757476807], [0.07308492809534073, 0.07408373057842255, 0.07781726121902466, 0.10068970173597336, 0.07995874434709549, 0.08105148375034332, 0.07928624749183655, 0.10630778968334198, 0.10776062309741974, 0.1092333123087883, 0.11072612553834915], [0.08089673519134521, 0.08150296658277512, 0.08373714983463287, 0.09648751467466354, 0.08499687910079956, 0.08563383668661118, 0.08460293710231781, 0.0994124487042427, 0.10015742480754852, 0.10090799629688263, 0.10166418552398682], [0.0738900899887085, 0.07485171407461166, 0.07844089716672897, 0.10026434063911438, 0.08049588650465012, 0.0815434679389, 0.07985083013772964, 0.10558656603097916, 0.10696069151163101, 0.10835270583629608, 0.10976283252239227], [0.07429429888725281, 0.075236976146698, 0.078752800822258, 0.10005004703998566, 0.08076396584510803, 0.08178871870040894, 0.08013280481100082, 0.10522539913654327, 0.10656053572893143, 0.10791261494159698, 0.10928184539079666], [0.07363911718130112, 0.07461241632699966, 0.07824684679508209, 0.10039713978767395, 0.08032890409231186, 0.0813906118273735, 0.07967526465654373, 0.10581111907958984, 0.10720962285995483, 0.10862661898136139, 0.11006234586238861], [0.08258862793445587, 0.08310051262378693, 0.08498141914606094, 0.09555787593126297, 0.08603812754154205, 0.08657139539718628, 0.08570795506238937, 0.09794910997152328, 0.09855619817972183, 0.09916706383228302, 0.09978170692920685], [0.08301393687725067, 0.08350159972906113, 0.08529211580753326, 0.09532324969768524, 0.08629713952541351, 0.08680407702922821, 0.08598319441080093, 0.09758293628692627, 0.09815617650747299, 0.09873278439044952, 0.09931278228759766], [0.08344017714262009, 0.08390333503484726, 0.08560264855623245, 0.09508775174617767, 0.086555615067482, 0.08703607320785522, 0.08625799417495728, 0.0972166582942009, 0.0977562889456749, 0.09829892218112946, 0.09884455800056458], [0.08386731147766113, 0.08430572599172592, 0.08591300249099731, 0.09485138207674026, 0.0868135392665863, 0.08726734668016434, 0.0865323543548584, 0.09685026854276657, 0.09735654294490814, 0.09786546230316162, 0.0983770340681076]], [[0.052601177245378494, 0.06401429325342178, 0.05517726391553879, 0.0671493262052536, 0.05482325702905655, 0.05691637471318245, 0.06741222739219666, 0.05810612067580223, 0.40292125940322876, 0.06336087733507156, 0.057517752051353455], [0.07796870172023773, 0.084497831761837, 0.07951042056083679, 0.08616866171360016, 0.07930111140012741, 0.08052732795476913, 0.08630666136741638, 0.08121248334646225, 0.17948850989341736, 0.08414354175329208, 0.08087468892335892], [0.05932144448161125, 0.07018305361270905, 0.06180036813020706, 0.07311586290597916, 0.0614607147872448, 0.0634644478559494, 0.07336089760065079, 0.06459865719079971, 0.3390870988368988, 0.06956920772790909, 0.06403817236423492], [0.08296549320220947, 0.08741015195846558, 0.08402643352746964, 0.08852792531251907, 0.08388282358646393, 0.08472227305173874, 0.0886199101805687, 0.08518935739994049, 0.14252424240112305, 0.08717214316129684, 0.0849592462182045], [0.05842836946249008, 0.06938968598842621, 0.060926325619220734, 0.07235626131296158, 0.0605839379131794, 0.06260446459054947, 0.07260424643754959, 0.06374882161617279, 0.34740549325942993, 0.06876911967992783, 0.0631832629442215], [0.06355247646570206, 0.07382359355688095, 0.06591347604990005, 0.0765661671757698, 0.06559060513973236, 0.06749258935451508, 0.07679476588964462, 0.06856629252433777, 0.3004160523414612, 0.0732480064034462, 0.06803596764802933], [0.08335121721029282, 0.08761415630578995, 0.08436967432498932, 0.08868470042943954, 0.08423185348510742, 0.08503734320402145, 0.08877277374267578, 0.08548538386821747, 0.13980208337306976, 0.0873861163854599, 0.08526468276977539], [0.0662904679775238, 0.0760691687464714, 0.0685490071773529, 0.07866086065769196, 0.06824053823947906, 0.07005588710308075, 0.0788765400648117, 0.0710788443684578, 0.2760806083679199, 0.07552426308393478, 0.07057374715805054], [0.1720861792564392, 0.06293890625238419, 0.1347055733203888, 0.04926729574799538, 0.13922064006328583, 0.11490890383720398, 0.04829099774360657, 0.10335524380207062, 5.088511443318566e-06, 0.06633496284484863, 0.10888613760471344], [0.07682885229587555, 0.08376848697662354, 0.07846368849277496, 0.08555099368095398, 0.07824160158634186, 0.0795433297753334, 0.08569833636283875, 0.08027132600545883, 0.18833015859127045, 0.08339085429906845, 0.07991236448287964], [0.06495269387960434, 0.07498329877853394, 0.06726399064064026, 0.07765153050422668, 0.06694811582565308, 0.0688079372048378, 0.07787375897169113, 0.06985688209533691, 0.2879002094268799, 0.07442279905080795, 0.06933887302875519]], [[0.07247747480869293, 0.07654126733541489, 0.07469383627176285, 0.10342048108577728, 0.07697798311710358, 0.08129411190748215, 0.08252774924039841, 0.10558891296386719, 0.10719121247529984, 0.10881782323122025, 0.11046912521123886], [0.0738319680094719, 0.0776432454586029, 0.07591261714696884, 0.10249440371990204, 0.07805188745260239, 0.08208099752664566, 0.08322951942682266, 0.10447552800178528, 0.1059373989701271, 0.10741972178220749, 0.1089227944612503], [0.07322372496128082, 0.07714932411909103, 0.07536586374044418, 0.10291019827127457, 0.07757065445184708, 0.08172930032014847, 0.08291617035865784, 0.10497482120990753, 0.10649925470352173, 0.10804581642150879, 0.10961484163999557], [0.0815313458442688, 0.08376631140708923, 0.08275789022445679, 0.09724442660808563, 0.08400288969278336, 0.08630560338497162, 0.08695236593484879, 0.09824986755847931, 0.09898614138364792, 0.09972792863845825, 0.10047527402639389], [0.07397396862506866, 0.07775833457708359, 0.0760401263833046, 0.10239732265472412, 0.0781639888882637, 0.08216271549463272, 0.08330225199460983, 0.10435909032821655, 0.10580646991729736, 0.10727392882108688, 0.1087617352604866], [0.07534278929233551, 0.07886356860399246, 0.0772668793797493, 0.10146202892065048, 0.0792400985956192, 0.08294299244880676, 0.08399539440870285, 0.1032399833202362, 0.10454992949962616, 0.10587649047374725, 0.1072198897600174], [0.07572293281555176, 0.0791691467165947, 0.07760676741600037, 0.10120239108800888, 0.07953746616840363, 0.08315728604793549, 0.08418532460927963, 0.10293015837669373, 0.10420264303684235, 0.10549084842205048, 0.10679499059915543], [0.08207565546035767, 0.0841902494430542, 0.08323656767606735, 0.09687460958957672, 0.08441389352083206, 0.08658872544765472, 0.08719895035028458, 0.09781647473573685, 0.09850581735372543, 0.09920001775026321, 0.09989912062883377], [0.08247175067663193, 0.08449801057577133, 0.08358445763587952, 0.09660561382770538, 0.08471217751502991, 0.08679348975419998, 0.08737703412771225, 0.09750162810087204, 0.09815716743469238, 0.0988171175122261, 0.0994815081357956], [0.08286871761083603, 0.08480583876371384, 0.08393275737762451, 0.09633615612983704, 0.08501045405864716, 0.08699764311313629, 0.08755438774824142, 0.09718658030033112, 0.09780853241682053, 0.0984344556927681, 0.09906439483165741], [0.08326655626296997, 0.08511373400688171, 0.08428145200014114, 0.09606624394655228, 0.08530871570110321, 0.08720119297504425, 0.0877310112118721, 0.09687133878469467, 0.09745991230010986, 0.09805205464363098, 0.09864780306816101]], [[0.08552217483520508, 0.1064314991235733, 0.09020023047924042, 0.10891253501176834, 0.08955586701631546, 0.09059368073940277, 0.11274294555187225, 0.09554915130138397, 0.013500449247658253, 0.10844969749450684, 0.09854178875684738], [0.0900714322924614, 0.09982110559940338, 0.09235385805368423, 0.1009078249335289, 0.09204326570034027, 0.09254293888807297, 0.1025601327419281, 0.09488799422979355, 0.03783239796757698, 0.10070610046386719, 0.09627305716276169], [0.08681262284517288, 0.10503001511096954, 0.09093403816223145, 0.10715917497873306, 0.09036802500486374, 0.09127939492464066, 0.11043412238359451, 0.09561286866664886, 0.017391422763466835, 0.10676246136426926, 0.09821576625108719], [0.09038841724395752, 0.09895617514848709, 0.09240364283323288, 0.09990482777357101, 0.09212975949048996, 0.09257030487060547, 0.10134488344192505, 0.09463416785001755, 0.04208870977163315, 0.09972883015871048, 0.09585029631853104], [0.08664371818304062, 0.10522481799125671, 0.090841144323349, 0.10740092396736145, 0.0902644544839859, 0.09119303524494171, 0.110749751329422, 0.0956108421087265, 0.016809644177556038, 0.10699538886547089, 0.09826632589101791], [0.08691436797380447, 0.10491076856851578, 0.09098948538303375, 0.10701149702072144, 0.09042996168136597, 0.09133085608482361, 0.11024172604084015, 0.0956130400300026, 0.017754195258021355, 0.10662011802196503, 0.09818398952484131], [0.09077534079551697, 0.09757537394762039, 0.09238608181476593, 0.09832079708576202, 0.09216759353876114, 0.09251897782087326, 0.09944962710142136, 0.09416066110134125, 0.04933834820985794, 0.09818261116743088, 0.09512462466955185], [0.08810262382030487, 0.10338473320007324, 0.09160161763429642, 0.10514172166585922, 0.09112261235713959, 0.09189365059137344, 0.10783333331346512, 0.09554319083690643, 0.022839199751615524, 0.10481477528810501, 0.09772249311208725], [0.04118648171424866, 0.1363808661699295, 0.05512724444270134, 0.15471668541431427, 0.0530056357383728, 0.056456487625837326, 0.18694446980953217, 0.07556580752134323, 1.6824839121909463e-06, 0.15115150809288025, 0.08946316689252853], [0.09033318608999252, 0.09911922365427017, 0.09239795058965683, 0.10009324550628662, 0.09211726486682892, 0.0925687626004219, 0.10157224535942078, 0.09468462318181992, 0.041269101202487946, 0.09991251677274704, 0.09593193233013153], [0.08873433619737625, 0.10243753343820572, 0.09189189970493317, 0.10399914532899857, 0.09146036952733994, 0.092154860496521, 0.10638629645109177, 0.09543413668870926, 0.026406390592455864, 0.10370875895023346, 0.09738621115684509]]], "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 3.748763265321031e-05, "vf_explained_var": 0.0009665489196777344, "total_loss": 0.27753183245658875, "policy_loss": -0.0005387061391957104, "num_module_steps_trained_lifetime": 29925, "use_intrinsic_rewards": 0.0, "num_module_steps_trained": 5985, "vf_loss": 0.3583069145679474, "weights_seq_no": 5.0, "module_train_batch_size_mean": 997.8691961675322, "curr_kl_coeff": 0.0050494978204369545, "curr_entropy_coeff": 0.0015431216992, "entropy": 0.6928947567939758, "vf_loss_unclipped": 44.19807434082031, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 773.0164646607296}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"module_train_batch_size_mean": 997.5798029998547, "total_loss": 0.0, "num_module_steps_trained_lifetime": 179550, "diff_num_grad_updates_vs_sampler_policy": 26.0, "num_module_steps_trained": 35910, "weights_seq_no": 30.0}, "default_policy": {"policy_loss": -0.0005170389777049422, "num_module_steps_trained_lifetime": 179550, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35910, "vf_loss": 0.35834699869155884, "weights_seq_no": 30.0, "module_train_batch_size_mean": 997.5798029998547, "entropy": 0.6929005980491638, "vf_loss_unclipped": 44.3819580078125, "diff_num_grad_updates_vs_sampler_policy": 26.0, "mean_kl_loss": 3.464226028881967e-05, "vf_explained_var": -0.002486586570739746, "total_loss": 0.27758991718292236}, "__all_modules__": {"num_env_steps_trained": 198000, "num_module_steps_trained_lifetime": 359100, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 990000, "num_env_steps_trained_lifetime_throughput": 55545.12451840062}}}, "intrinsic_reward_module": {"curr_entropy_coeff": 0.0015431216992, "default_optimizer_learning_rate": 0.0002715581955, "module_train_batch_size_mean": 997.8691961675322, "total_loss": 0.0, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 29925, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "weights_seq_no": 5.0, "num_module_steps_trained_lifetime_throughput": 773.0313254600428}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 165000, "num_env_steps_trained": 33000, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 59850, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 4263.9437461439475, "num_module_steps_trained_throughput": 28803571.24271384, "num_module_steps_trained_lifetime_throughput": 15011738.088744747}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 10.368238387501162, "num_episodes_lifetime": 100, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 0.4}, "episode_len_min": 20, "weights_seq_no": 5.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7631335360217988e-06, "numpy_to_tensor": 1.2010066245745121e-05, "add_observations_from_episodes_to_batch": 2.7855304290887064e-06, "add_time_dim_to_batch_and_zero_pad": 6.748304244499697e-06, "batch_individual_items": 1.2301666764710235e-05}}, "connector_pipeline_timer": 5.872083593148857e-05}, "num_env_steps_sampled": 400, "env_reset_timer": 0.0001989103893928381, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2093974346294003e-05, "get_actions": 3.543580040179015e-05, "listify_data_for_vector_env": 1.038672623325185e-05, "un_batch_to_individual_items": 6.487203923248755e-06, "tensor_to_numpy": 1.5047248511943417e-05, "normalize_and_clip_actions": 7.988873929505733e-06}}, "connector_pipeline_timer": 0.00011403490244413289}, "episode_len_max": 20, "env_step_timer": 1.3869746596433843e-05, "rlmodule_inference_timer": 3.1150543123701644e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238387501162, "module_episode_returns_mean": {"default_policy": 0.4}, "episode_len_mean": 20.0, "episode_return_min": -14.5, "episode_return_mean": 0.4, "num_env_steps_sampled_lifetime": 25400, "sample": 0.11667093729703502, "episode_duration_sec_mean": 0.005250683731865138, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "episode_return_max": 14.5, "time_between_sampling": 9.61698101188775}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "aec1c_00000", "date": "2025-08-11_18-39-58", "timestamp": 1754930398, "time_this_iter_s": 9.602324962615967, "time_total_s": 49.210914850234985, "pid": 11610, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3842f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 49.210914850234985, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 37.03076923076923, "ram_util_percent": 77.37692307692308}}
{"timers": {"training_iteration": 9.838976992802309, "restore_env_runners": 8.514141535433228e-06, "training_step": 9.838810054718397, "env_runner_sampling_timer": 1.6266491206595752, "learner_update_timer": 8.037429547207067, "synch_weights": 0.0011070817700169634, "restore_eval_env_runners": 2.0874386988400947e-05, "evaluation_iteration": 0.12351318474860068, "synch_eval_env_connectors": 0.00016360788245324277, "synch_env_connectors": 5.344900099368533e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5845378627038866e-05, "normalize_and_clip_actions": 8.158114128625715e-06, "get_actions": 4.171828594499068e-05, "un_batch_to_individual_items": 6.987861710551003e-06, "remove_single_ts_time_rank_from_batch": 1.2008593937952481e-05, "listify_data_for_vector_env": 1.075371615166418e-05}}, "connector_pipeline_timer": 0.00012266881788739115}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.04176505391175e-06, "numpy_to_tensor": 1.2884339288953484e-05, "add_states_from_episodes_to_batch": 2.7326385867624032e-06, "add_observations_from_episodes_to_batch": 2.8183814172895415e-06, "batch_individual_items": 1.2756939592547519e-05}}, "connector_pipeline_timer": 6.102385234988683e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "rlmodule_inference_timer": 3.2867245328724894e-05, "episode_len_mean": 20.0, "episode_return_min": -11.5, "weights_seq_no": 5.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_mean": -0.54, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime": -2460000.0, "num_env_steps_sampled": 5000.0, "sample": 0.005778484112735596, "env_reset_timer": 4.228622762268687e-05, "episode_duration_sec_mean": 0.005473345314618198, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -123000.0, "time_between_sampling": 0.032816086837445926, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": -0.54}, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.478760039627608e-05, "module_episode_returns_mean": {"default_policy": -0.54}, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 3192.626304619721}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13695619556391297, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008910992111487711, "add_observations_from_episodes_to_batch": 0.0008248895100534883, "add_columns_from_episodes_to_train_batch": 0.0414891997077409, "add_time_dim_to_batch_and_zero_pad": 0.07570297349526012, "add_states_from_episodes_to_batch": 0.0035417511828455864, "batch_individual_items": 0.006288579840232615, "numpy_to_tensor": 7.108287634791609e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"IntrinsicAttentionMask": [[[0.07225067168474197, 0.07720018923282623, 0.07830560952425003, 0.10256686806678772, 0.07761592417955399, 0.08171772211790085, 0.08288782089948654, 0.10459575802087784, 0.10609343647956848, 0.10761256515979767, 0.10915344208478928], [0.07410653680562973, 0.07863174378871918, 0.07963816076517105, 0.10138480365276337, 0.07901042699813843, 0.08273531496524811, 0.0837942436337471, 0.10317692160606384, 0.10449746996164322, 0.10583493113517761, 0.10718950629234314], [0.07450832426548004, 0.07893961668014526, 0.07992424070835114, 0.1011294350028038, 0.07931013405323029, 0.08295241743326187, 0.08398709446191788, 0.10287143290042877, 0.1041545569896698, 0.10545369237661362, 0.10676903277635574], [0.08237051218748093, 0.0848202183842659, 0.0853552594780922, 0.09617743641138077, 0.08502193540334702, 0.08698073029518127, 0.08752939850091934, 0.09701430052518845, 0.09762626141309738, 0.09824208915233612, 0.09886179864406586], [0.07425816357135773, 0.07874801754951477, 0.07974622398614883, 0.10128839313983917, 0.0791236162185669, 0.08281737565994263, 0.0838671550154686, 0.10306154936552048, 0.1043679416179657, 0.10569089651107788, 0.10703062266111374], [0.07572124898433685, 0.07986460626125336, 0.08078275620937347, 0.10035982728004456, 0.08021021634340286, 0.08360102772712708, 0.08456213772296906, 0.10195289552211761, 0.10312498360872269, 0.104310542345047, 0.10550973564386368], [0.07612805813550949, 0.08017336577177048, 0.0810689777135849, 0.10010214149951935, 0.08051052689552307, 0.083816297352314, 0.08475260436534882, 0.1016460508108139, 0.10278153419494629, 0.10392970591783524, 0.10509070008993149], [0.08295806497335434, 0.08524894714355469, 0.08574867248535156, 0.09581106901168823, 0.08543737232685089, 0.0872655063867569, 0.08777705579996109, 0.09658573567867279, 0.09715192019939423, 0.09772142022848129, 0.09829426556825638], [0.08338591456413269, 0.08556021004915237, 0.08603408187627792, 0.09554461389780045, 0.08573891222476959, 0.08747149258852005, 0.08795594424009323, 0.09627444297075272, 0.09680765122175217, 0.097343809902668, 0.097882941365242], [0.08381494134664536, 0.08587156236171722, 0.08631937950849533, 0.09527772665023804, 0.08604045957326889, 0.08767689019441605, 0.08813411742448807, 0.09596297144889832, 0.0964634120464325, 0.0969664603471756, 0.09747213870286942], [0.08424511551856995, 0.08618296682834625, 0.086604543030262, 0.09501039981842041, 0.0863419771194458, 0.0878816619515419, 0.08831154555082321, 0.0956513062119484, 0.09611918777227402, 0.09658936411142349, 0.09706184267997742]], [[0.0884736180305481, 0.10835512727499008, 0.0878877267241478, 0.10763756930828094, 0.08978485316038132, 0.09074871987104416, 0.11429747194051743, 0.09534014016389847, 0.015117141418159008, 0.10425319522619247, 0.09810444712638855], [0.09150512516498566, 0.09979872405529022, 0.09124527871608734, 0.09951531887054443, 0.09208312630653381, 0.09250493347644806, 0.1021055057644844, 0.09447986632585526, 0.04295557737350464, 0.09816385060548782, 0.09564274549484253], [0.08833504468202591, 0.10859735310077667, 0.08773913234472275, 0.10786475241184235, 0.08966895192861557, 0.09064972400665283, 0.11466770619153976, 0.09532430768013, 0.01460165437310934, 0.10441067069768906, 0.09814071655273438], [0.09145785123109818, 0.1001269742846489, 0.0911867693066597, 0.09983020275831223, 0.09206093847751617, 0.09250116348266602, 0.10254394263029099, 0.09456348419189453, 0.04153444990515709, 0.09841549396514893, 0.0957786962389946], [0.08877439796924591, 0.10781241953372955, 0.08821083605289459, 0.10712799429893494, 0.0900350883603096, 0.09096130728721619, 0.11347321420907974, 0.09536788612604141, 0.016322944313287735, 0.1038973405957222, 0.09801661968231201], [0.08898714184761047, 0.10741271078586578, 0.0884399265050888, 0.1067521944642067, 0.09021084755659103, 0.09110955893993378, 0.11287079751491547, 0.09538136422634125, 0.01725674234330654, 0.10363257676362991, 0.09794609248638153], [0.09169404953718185, 0.09699687361717224, 0.09152522683143616, 0.09681829065084457, 0.09206895530223846, 0.09234202653169632, 0.09844386577606201, 0.09361478686332703, 0.05617190897464752, 0.095964215695858, 0.09435983002185822], [0.08990047127008438, 0.1054944172501564, 0.08943036198616028, 0.10494276136159897, 0.09095019847154617, 0.09171976894140244, 0.1100337877869606, 0.09536240994930267, 0.02229786291718483, 0.10233031213283539, 0.0975375846028328], [0.04642865061759949, 0.15622125566005707, 0.044618383049964905, 0.15013012290000916, 0.05070260912179947, 0.05404910072684288, 0.21504588425159454, 0.07262622565031052, 1.1849605243696715e-06, 0.12399929016828537, 0.08617732673883438], [0.09116720408201218, 0.10164942592382431, 0.09084255248308182, 0.10128745436668396, 0.09189017117023468, 0.09241849184036255, 0.10460539907217026, 0.09490027278661728, 0.03530628979206085, 0.09956493973731995, 0.09636779874563217], [0.09036741405725479, 0.10432280600070953, 0.0899430513381958, 0.10383290797472, 0.09131418168544769, 0.09200756251811981, 0.10834423452615738, 0.09528159350156784, 0.025846382603049278, 0.10150929540395737, 0.09723054617643356]], [[0.07152891904115677, 0.07553952932357788, 0.076685830950737, 0.09811453521251678, 0.07597052305936813, 0.07712336629629135, 0.08144764602184296, 0.10840481519699097, 0.11004984378814697, 0.11171983927488327, 0.1134151741862297], [0.07295294106006622, 0.07671883702278137, 0.07779232412576675, 0.09765036404132843, 0.07712260633707047, 0.07820174098014832, 0.0822385922074318, 0.10706248879432678, 0.10856055468320847, 0.11007958650588989, 0.11161987483501434], [0.07334853708744049, 0.0770450159907341, 0.07809793949127197, 0.09751928597688675, 0.07744109630584717, 0.07849942147731781, 0.08245548605918884, 0.10669120401144028, 0.10814927518367767, 0.10962727665901184, 0.11112547665834427], [0.07996559888124466, 0.08240910619497299, 0.08309674263000488, 0.0951983630657196, 0.08266820013523102, 0.08335798978805542, 0.08590515702962875, 0.1005837693810463, 0.10142306238412857, 0.10226935893297195, 0.10312271863222122], [0.07310226559638977, 0.07684203237295151, 0.07790777832269669, 0.09760100394487381, 0.0772429034113884, 0.07831420004367828, 0.08232060819864273, 0.10692227631807327, 0.10840519517660141, 0.10990869253873825, 0.11143305152654648], [0.07349824905395508, 0.0771683007478714, 0.07821338623762131, 0.09746942669153214, 0.07756143808364868, 0.07861185818910599, 0.08253724873065948, 0.10655087232589722, 0.10799389332532883, 0.10945646464824677, 0.11093884706497192], [0.07494136691093445, 0.07835201174020767, 0.07932064682245255, 0.09698229283094406, 0.07871652394533157, 0.07968966662883759, 0.08331640809774399, 0.10520327091217041, 0.10650385171175003, 0.10782051831483841, 0.10915345698595047], [0.08271705359220505, 0.08458927273750305, 0.08511356264352798, 0.0941682681441307, 0.08478695154190063, 0.08531246334314346, 0.08724342286586761, 0.0981014147400856, 0.09870944917201996, 0.09932126104831696, 0.09993686527013779], [0.08313597738742828, 0.08491865545511246, 0.0854175016283989, 0.09400836378335953, 0.085106760263443, 0.08560670912265778, 0.08744236081838608, 0.09772638976573944, 0.09830047190189362, 0.0988779217004776, 0.09945877641439438], [0.08355580270290375, 0.08524806797504425, 0.08572126924991608, 0.0938473492860794, 0.08542651683092117, 0.08590070903301239, 0.08764047175645828, 0.09735136479139328, 0.09789174050092697, 0.09843512624502182, 0.09898152202367783], [0.08397649228572845, 0.08557749539613724, 0.08602483570575714, 0.09368522465229034, 0.08574620634317398, 0.08619443327188492, 0.08783771842718124, 0.09697634726762772, 0.09748326987028122, 0.09799285233020782, 0.09850509464740753]], [[0.05722247436642647, 0.0685318186879158, 0.05688520148396492, 0.06812789291143417, 0.05797639116644859, 0.060006219893693924, 0.0718657523393631, 0.059652552008628845, 0.3712543547153473, 0.06788907945156097, 0.0605882853269577], [0.08140938729047775, 0.08682484924793243, 0.08123772591352463, 0.08664176613092422, 0.08179079741239548, 0.08280207961797714, 0.08831018209457397, 0.08262746781110764, 0.15873457491397858, 0.08653319627046585, 0.0830879956483841], [0.056309230625629425, 0.06769486516714096, 0.055970367044210434, 0.06728748977184296, 0.05706685408949852, 0.05910768732428551, 0.07105918228626251, 0.05875198915600777, 0.3800124526023865, 0.06704666465520859, 0.05969317629933357], [0.08076050877571106, 0.08646078407764435, 0.08058016747236252, 0.08626770973205566, 0.0811612531542778, 0.08222435414791107, 0.0880279541015625, 0.08204075694084167, 0.16379830241203308, 0.08615322411060333, 0.08252506703138351], [0.05922883003950119, 0.07034029066562653, 0.05889597535133362, 0.06994499266147614, 0.05997254326939583, 0.06197267770767212, 0.07359889894723892, 0.06162440404295921, 0.35216447710990906, 0.06971123814582825, 0.06254563480615616], [0.06436839699745178, 0.07477138191461563, 0.06405309587717056, 0.07440511882305145, 0.06507208198308945, 0.06695903092622757, 0.07778070122003555, 0.06663103401660919, 0.30427274107933044, 0.07418840378522873, 0.0674981102347374], [0.08625420928001404, 0.08922506123781204, 0.08615852147340775, 0.08912608027458191, 0.08646644651889801, 0.08702694624662399, 0.0900244191288948, 0.08693040907382965, 0.12253570556640625, 0.08906733989715576, 0.0871848315000534], [0.06350179016590118, 0.07404559850692749, 0.06318286806344986, 0.07367371767759323, 0.06421371549367905, 0.06612370908260345, 0.07710285484790802, 0.06579160690307617, 0.3122408092021942, 0.07345369458198547, 0.06666962057352066], [0.15090088546276093, 0.054313722997903824, 0.15604066848754883, 0.056163687258958817, 0.14011472463607788, 0.11529403179883957, 0.04149774834513664, 0.11922101676464081, 3.779375902013271e-06, 0.05729229375720024, 0.10915746539831161], [0.08037012815475464, 0.08623731136322021, 0.08018472045660019, 0.08603837341070175, 0.08078216761350632, 0.08187556266784668, 0.08785264939069748, 0.08168669044971466, 0.16686707735061646, 0.08592040836811066, 0.08218493312597275], [0.06576703488826752, 0.07592339813709259, 0.06545819342136383, 0.075566865503788, 0.06645606458187103, 0.068302221596241, 0.07885009050369263, 0.06798147410154343, 0.29150956869125366, 0.0753558799624443, 0.0688292533159256]], [[0.0718536525964737, 0.0729440227150917, 0.07703395932912827, 0.10253030061721802, 0.07631541788578033, 0.08059439808130264, 0.08181741088628769, 0.10889694839715958, 0.10626857727766037, 0.11222702264785767, 0.10951827466487885], [0.07223863154649734, 0.07331125438213348, 0.07733161002397537, 0.10229971259832382, 0.07662562280893326, 0.0808277428150177, 0.08202790468931198, 0.10851230472326279, 0.10594850033521652, 0.11175867915153503, 0.10911817103624344], [0.07364188879728317, 0.07464830577373505, 0.07841028273105621, 0.10145702213048935, 0.07775081694126129, 0.0816691517829895, 0.08278527110815048, 0.1071179211139679, 0.10478498041629791, 0.11006573587656021, 0.10766859352588654], [0.08121248334646225, 0.08182107657194138, 0.08406398445367813, 0.09686411172151566, 0.0836743637919426, 0.08596806973218918, 0.08661230653524399, 0.09980045258998871, 0.09859900921583176, 0.10130184143781662, 0.10008232295513153], [0.0733998641371727, 0.07441785931587219, 0.07822492718696594, 0.10160259157419205, 0.07755735516548157, 0.0815250426530838, 0.08265573531389236, 0.10735754668712616, 0.10498528927564621, 0.11035613715648651, 0.10791762173175812], [0.07481446117162704, 0.07576373219490051, 0.07930417358875275, 0.10075052082538605, 0.07868442684412003, 0.08236135542392731, 0.08340638875961304, 0.10596209764480591, 0.10381676256656647, 0.10866812616586685, 0.10646799951791763], [0.07520736008882523, 0.07613711059093475, 0.07960217446088791, 0.10051332414150238, 0.07899591326713562, 0.08259108662605286, 0.08361212909221649, 0.10557666420936584, 0.10349313914775848, 0.10820320248603821, 0.10606784373521805], [0.08285130560398102, 0.0833648294210434, 0.08525170385837555, 0.09586180746555328, 0.08492455631494522, 0.0868467390537262, 0.08738502115011215, 0.09826062619686127, 0.09728061407804489, 0.099482461810112, 0.09849026054143906], [0.08218494057655334, 0.0827375054359436, 0.08477029204368591, 0.0962696447968483, 0.08441757410764694, 0.0864916443824768, 0.08707316964864731, 0.09888491034507751, 0.09781581163406372, 0.10021906346082687, 0.09913554042577744], [0.08367608487606049, 0.08414055407047272, 0.08584466576576233, 0.09535658359527588, 0.085549496114254, 0.08728214353322983, 0.087766632437706, 0.09749150276184082, 0.09661996364593506, 0.09857682883739471, 0.09769558161497116], [0.0830068290233612, 0.08351116627454758, 0.08536376059055328, 0.0957665964961052, 0.08504261821508408, 0.08692919462919235, 0.08745735883712769, 0.09811533242464066, 0.09715592116117477, 0.0993112102150917, 0.09834010154008865]], [[0.05786058306694031, 0.06759107112884521, 0.05751955136656761, 0.0688876211643219, 0.060101673007011414, 0.06067538261413574, 0.07266716659069061, 0.0603177584707737, 0.36615806818008423, 0.06695714592933655, 0.06126393750309944], [0.07884014397859573, 0.08449839055538177, 0.07863260060548782, 0.08521733433008194, 0.08018744736909866, 0.08052786439657211, 0.0872713029384613, 0.08031587302684784, 0.1794896423816681, 0.08414410054683685, 0.08087523281574249], [0.05696192383766174, 0.06675960123538971, 0.05661913752555847, 0.06806743890047073, 0.05921560525894165, 0.05979282408952713, 0.07188285142183304, 0.059432998299598694, 0.3747621476650238, 0.06612034142017365, 0.060385093092918396], [0.0809536725282669, 0.0858549252152443, 0.08077290654182434, 0.08647405356168747, 0.08212544769048691, 0.08242102712392807, 0.08823850005865097, 0.08223698288202286, 0.16265054047107697, 0.08554953336715698, 0.08272245526313782], [0.06351159512996674, 0.07264651358127594, 0.06318783760070801, 0.07384971529245377, 0.06563282757997513, 0.06617411226034164, 0.07733987271785736, 0.06583678722381592, 0.31303489208221436, 0.07205710560083389, 0.06672868877649307], [0.06488239020109177, 0.07382482290267944, 0.06456457078456879, 0.07499926537275314, 0.06696317344903946, 0.06749371439218521, 0.07840180397033691, 0.06716310232877731, 0.3004208207130432, 0.0732492208480835, 0.06803710013628006], [0.08634041249752045, 0.0888974517583847, 0.08624463528394699, 0.08921516686677933, 0.08695866912603378, 0.08711393177509308, 0.09011440724134445, 0.08701729774475098, 0.12208578735589981, 0.08874029666185379, 0.08727197349071503], [0.064031682908535, 0.0730958953499794, 0.06371008604764938, 0.07428847998380661, 0.0661381185054779, 0.06667546927928925, 0.07774623483419418, 0.06634059548377991, 0.3082360029220581, 0.07251157611608505, 0.06722594052553177], [0.15033793449401855, 0.06318023800849915, 0.15537694096565247, 0.05682770535349846, 0.12162595242261887, 0.11534947901964188, 0.042188018560409546, 0.11921574920415878, 5.108057393954368e-06, 0.06658931076526642, 0.10930360853672028], [0.07775267213582993, 0.08376912027597427, 0.07753259688615799, 0.08453579246997833, 0.07918240875005722, 0.07954392582178116, 0.08672879636287689, 0.07931877672672272, 0.1883314847946167, 0.08339148014783859, 0.07991296052932739], [0.06625503301620483, 0.07498447597026825, 0.0659438967704773, 0.07612758129835129, 0.06829046458005905, 0.06880903244018555, 0.07943516224622726, 0.06848590075969696, 0.2879045307636261, 0.07442396879196167, 0.06933996826410294]]], "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 1.7113779904320836e-05, "vf_explained_var": 0.0005574226379394531, "total_loss": 0.27791187167167664, "policy_loss": -0.0001586428115842864, "num_module_steps_trained_lifetime": 35910, "use_intrinsic_rewards": 0.0, "num_module_steps_trained": 5985, "vf_loss": 0.35830697417259216, "weights_seq_no": 6.0, "module_train_batch_size_mean": 997.8474438281662, "curr_kl_coeff": 0.0025247489102184772, "curr_entropy_coeff": 0.0015431216992, "entropy": 0.6927332878112793, "vf_loss_unclipped": 43.428977966308594, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 770.3098774556408}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"module_train_batch_size_mean": 997.5548130830801, "total_loss": 0.0, "num_module_steps_trained_lifetime": 215460, "diff_num_grad_updates_vs_sampler_policy": 31.0, "num_module_steps_trained": 35910, "weights_seq_no": 36.0}, "default_policy": {"policy_loss": -0.00015316698409151286, "num_module_steps_trained_lifetime": 215460, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35910, "vf_loss": 0.3583420217037201, "weights_seq_no": 36.0, "module_train_batch_size_mean": 997.5548130830801, "entropy": 0.6927360892295837, "vf_loss_unclipped": 43.57811737060547, "diff_num_grad_updates_vs_sampler_policy": 31.0, "mean_kl_loss": 1.64287648658501e-05, "vf_explained_var": -0.0025053024291992188, "total_loss": 0.27794724702835083}, "__all_modules__": {"num_env_steps_trained": 198000, "num_module_steps_trained_lifetime": 430920, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 1188000, "num_env_steps_trained_lifetime_throughput": 54649.6955865683}}}, "intrinsic_reward_module": {"curr_entropy_coeff": 0.0015431216992, "default_optimizer_learning_rate": 0.0002715581955, "module_train_batch_size_mean": 997.8474438281662, "total_loss": 0.0, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 35910, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "weights_seq_no": 6.0, "num_module_steps_trained_lifetime_throughput": 770.324129220399}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 198000, "num_env_steps_trained": 33000, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 71820, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 4248.964740073483, "num_module_steps_trained_throughput": 28011720.933634005, "num_module_steps_trained_lifetime_throughput": 14891700.671650318}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 10.368238394470474, "num_episodes_lifetime": 120, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 0.2}, "episode_len_min": 20, "weights_seq_no": 6.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7584992662308546e-06, "numpy_to_tensor": 1.1990964666483959e-05, "add_observations_from_episodes_to_batch": 2.8369681678043793e-06, "add_time_dim_to_batch_and_zero_pad": 6.7953459587440355e-06, "batch_individual_items": 1.2370115137844996e-05}}, "connector_pipeline_timer": 5.8804064032249305e-05}, "num_env_steps_sampled": 400, "env_reset_timer": 0.00020014045552911616, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1790965030821171e-05, "get_actions": 3.569992638053059e-05, "listify_data_for_vector_env": 1.0423924918769778e-05, "un_batch_to_individual_items": 6.482022154295161e-06, "tensor_to_numpy": 1.4884408018398531e-05, "normalize_and_clip_actions": 7.938869579110103e-06}}, "connector_pipeline_timer": 0.00011344611470408907}, "episode_len_max": 20, "env_step_timer": 1.4094245542473607e-05, "rlmodule_inference_timer": 3.075616281244462e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394470474, "module_episode_returns_mean": {"default_policy": 0.2}, "episode_len_mean": 20.0, "episode_return_min": -14.5, "episode_return_mean": 0.2, "num_env_steps_sampled_lifetime": 30400, "sample": 0.11665524917388981, "episode_duration_sec_mean": 0.005229960390133783, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "episode_return_max": 14.5, "time_between_sampling": 9.617930231769048}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "aec1c_00000", "date": "2025-08-11_18-40-08", "timestamp": 1754930408, "time_this_iter_s": 9.809912919998169, "time_total_s": 59.020827770233154, "pid": 11610, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3842f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 59.020827770233154, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 40.26428571428572, "ram_util_percent": 77.85000000000001}}
{"timers": {"training_iteration": 9.84963648162445, "restore_env_runners": 8.5985893043035e-06, "training_step": 9.849468416671913, "env_runner_sampling_timer": 1.6274302052932403, "learner_update_timer": 8.045779332154629, "synch_weights": 0.0011113017928456991, "restore_eval_env_runners": 2.1163552614123956e-05, "evaluation_iteration": 0.12351879498079545, "synch_eval_env_connectors": 0.0001635405536413763, "synch_env_connectors": 5.411041066028002e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.6892595272515732e-05, "normalize_and_clip_actions": 1.0750468110486783e-05, "get_actions": 4.582304565609932e-05, "un_batch_to_individual_items": 6.898485552154017e-06, "remove_single_ts_time_rank_from_batch": 1.2784326656311165e-05, "listify_data_for_vector_env": 1.1257845466874617e-05}}, "connector_pipeline_timer": 0.00013274054610585786}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.338157560582703e-06, "numpy_to_tensor": 1.407063855044342e-05, "add_states_from_episodes_to_batch": 2.8234885829041315e-06, "add_observations_from_episodes_to_batch": 3.0778327700952536e-06, "batch_individual_items": 1.325667234577994e-05}}, "connector_pipeline_timer": 6.456713002780148e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "rlmodule_inference_timer": 3.533701631806718e-05, "episode_len_mean": 20.0, "episode_return_min": -11.5, "weights_seq_no": 6.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_mean": -0.38000000000000006, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime": -3077500.0, "num_env_steps_sampled": 5000.0, "sample": 0.00602081125059383, "env_reset_timer": 4.7666822941371285e-05, "episode_duration_sec_mean": 0.0058372459965758, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -153875.0, "time_between_sampling": 0.03343743120659408, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": -0.38000000000000006}, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.531666594329125e-05, "module_episode_returns_mean": {"default_policy": -0.38000000000000006}, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 3054.507632378907}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13829948694847305, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008912013860376591, "add_observations_from_episodes_to_batch": 0.0008269543651976305, "add_columns_from_episodes_to_train_batch": 0.041514108960549426, "add_time_dim_to_batch_and_zero_pad": 0.07570843000974879, "add_states_from_episodes_to_batch": 0.0035426470010732763, "batch_individual_items": 0.007597164042425143, "numpy_to_tensor": 7.117038777277628e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"IntrinsicAttentionMask": [[[0.07206349074840546, 0.07700018584728241, 0.07524459809064865, 0.0985574871301651, 0.0774148553609848, 0.07852333784103394, 0.082673080265522, 0.1082875058054924, 0.10581857711076736, 0.11141079664230347, 0.11300606280565262], [0.07395331561565399, 0.0784691721200943, 0.07686685025691986, 0.09785674512386322, 0.07884708046913147, 0.07985623180866241, 0.08362099528312683, 0.1064552292227745, 0.10428143292665482, 0.1091976910829544, 0.11059530824422836], [0.07329266518354416, 0.07795758545398712, 0.07630107551813126, 0.09810371696949005, 0.07834846526384354, 0.0793926790356636, 0.0832928940653801, 0.10709341615438461, 0.10481780767440796, 0.10996705293655396, 0.11143266409635544], [0.08120625466108322, 0.08395078033208847, 0.08298511058092117, 0.0950164645910263, 0.08417727053165436, 0.084779754281044, 0.08699842542409897, 0.09961162507534027, 0.09846580773591995, 0.10104263573884964, 0.10176583379507065], [0.0741075947880745, 0.0785883441567421, 0.076998770236969, 0.09779877215623856, 0.07896319776773453, 0.07996412366628647, 0.083697110414505, 0.10630655288696289, 0.10415633022785187, 0.10901868343353271, 0.11040059477090836], [0.07451676577329636, 0.07890384644269943, 0.0773482546210289, 0.09764444082975388, 0.07927057147026062, 0.08024957031011581, 0.08389804512262344, 0.10591290146112442, 0.10382481664419174, 0.10854512453079224, 0.10988566279411316], [0.07600834220647812, 0.08004727959632874, 0.0786176323890686, 0.09707527607679367, 0.08038391917943954, 0.081281878054142, 0.08461932092905045, 0.10448602586984634, 0.10261990129947662, 0.10683348029851913, 0.1080269142985344], [0.084056057035923, 0.08603828400373459, 0.08534307032823563, 0.0938427597284317, 0.08620098978281021, 0.08663317561149597, 0.0882168859243393, 0.0970027968287468, 0.09621898084878922, 0.09797792136669159, 0.09846916049718857], [0.08335389941930771, 0.08552736788988113, 0.08476448059082031, 0.09413466602563858, 0.08570600301027298, 0.086180679500103, 0.08792218565940857, 0.09764143824577332, 0.09677048772573471, 0.09872598201036453, 0.09927277266979218], [0.08492521941661835, 0.08666764199733734, 0.08605712652206421, 0.09347902983427048, 0.08681043237447739, 0.08718955516815186, 0.08857673406600952, 0.09621593356132507, 0.09553816169500351, 0.09705816954374313, 0.09748204052448273], [0.08536124974489212, 0.08698209375143051, 0.08641444891691208, 0.09329559653997421, 0.08711481094360352, 0.08746711164712906, 0.08875521272420883, 0.09582275152206421, 0.0951974168419838, 0.09659935534000397, 0.09699001908302307]], [[0.08529339730739594, 0.10614677518606186, 0.08995893597602844, 0.10862118005752563, 0.09205597639083862, 0.09312276542186737, 0.11244133859872818, 0.09245752543210983, 0.013464346528053284, 0.10815957188606262, 0.09827818721532822], [0.08995433151721954, 0.09969133138656616, 0.09223379194736481, 0.10077664256095886, 0.09323792159557343, 0.09374406933784485, 0.10242679715156555, 0.09342879801988602, 0.037783220410346985, 0.10057517886161804, 0.09614789485931396], [0.08660823106765747, 0.10478272289037704, 0.09071993827819824, 0.10690687596797943, 0.09255900979042053, 0.09349247813224792, 0.11017410457134247, 0.09291054308414459, 0.017350491136312485, 0.10651108622550964, 0.09798452258110046], [0.09028472751379013, 0.09884265065193176, 0.09229762852191925, 0.09979021549224854, 0.09318245202302933, 0.09362803399562836, 0.10122861713171005, 0.09335052222013474, 0.04204042628407478, 0.09961441904306412, 0.09574033319950104], [0.08715055882930756, 0.10415869206190109, 0.09101690351963043, 0.10613351315259933, 0.09274256229400635, 0.09361762553453445, 0.10916616767644882, 0.09307216107845306, 0.01935524493455887, 0.10576573759317398, 0.09782085567712784], [0.08741458505392075, 0.10383807122707367, 0.0911569744348526, 0.10573875159025192, 0.09282553195953369, 0.09367123246192932, 0.10865520685911179, 0.09314411133527756, 0.02044091559946537, 0.10538488626480103, 0.09772971272468567], [0.09069215506315231, 0.09748595207929611, 0.09230141341686249, 0.09823068976402283, 0.09300655126571655, 0.09336113929748535, 0.09935849159955978, 0.09314034879207611, 0.04929313436150551, 0.09809263050556183, 0.09503745287656784], [0.08725088834762573, 0.10403826832771301, 0.0910705029964447, 0.10598503798246384, 0.09277462214231491, 0.0936385989189148, 0.10897371172904968, 0.09310005605220795, 0.01975858025252819, 0.10562252998352051, 0.09778717160224915], [0.040852826088666916, 0.13527588546276093, 0.05468064546585083, 0.15346314013004303, 0.062032200396060944, 0.06607071310281754, 0.18542976677417755, 0.06352795660495758, 1.6688755977156688e-06, 0.14992685616016388, 0.08873837441205978], [0.09022698551416397, 0.09900269657373428, 0.09228932857513428, 0.0999755710363388, 0.09319622814655304, 0.09365300834178925, 0.10145283490419388, 0.0933685228228569, 0.04122059792280197, 0.09979505836963654, 0.0958191528916359], [0.08857453614473343, 0.10225304961204529, 0.0917263999581337, 0.1038118451833725, 0.09312471747398376, 0.0938318520784378, 0.10619469732046127, 0.09339122474193573, 0.02635885216295719, 0.10352198034524918, 0.09721081703901291]], [[0.07216261327266693, 0.07428444921970367, 0.07821016758680344, 0.10244184732437134, 0.08046594262123108, 0.07863134890794754, 0.08278679847717285, 0.10446826368570328, 0.10596411675214767, 0.1115640252828598, 0.10902039706707001], [0.0729779601097107, 0.07502341270446777, 0.07880076766014099, 0.10193838179111481, 0.08096731454133987, 0.07920550554990768, 0.08319342881441116, 0.10386095196008682, 0.10527904331684113, 0.11057975143194199, 0.10817359387874603], [0.07443934679031372, 0.07634419202804565, 0.07985025644302368, 0.10103579610586166, 0.08185464143753052, 0.08022504299879074, 0.08390934020280838, 0.1027761846780777, 0.10405813157558441, 0.10883694142103195, 0.10667017847299576], [0.0823509693145752, 0.08341328799724579, 0.08533501625061035, 0.09615462273359299, 0.08641499280929565, 0.08553796261548996, 0.08750864118337631, 0.09699129313230515, 0.09760311245918274, 0.09985174983739853, 0.09883835166692734], [0.07525302469730377, 0.07707753032445908, 0.08042958378791809, 0.10053321719169617, 0.0823424756526947, 0.08078745752573013, 0.08430086076259613, 0.10217432677745819, 0.10338221490383148, 0.10787825286388397, 0.1058410033583641], [0.07459267228841782, 0.07648248225450516, 0.0799596905708313, 0.10094109177589417, 0.08194690197706223, 0.08033131062984467, 0.08398349583148956, 0.10266266018152237, 0.10393054783344269, 0.1086556613445282, 0.10651350766420364], [0.07607149332761765, 0.07781371474266052, 0.08100874722003937, 0.10002775490283966, 0.08282874524593353, 0.08134942501783371, 0.08468963205814362, 0.10157051682472229, 0.10270515829324722, 0.10692223906517029, 0.10501261055469513], [0.08294106274843216, 0.08393512666225433, 0.08573109656572342, 0.09579142928123474, 0.08673915266990662, 0.08592060208320618, 0.08775906264781952, 0.09656593948602676, 0.09713200479745865, 0.09921036660671234, 0.0982741191983223], [0.08337065577507019, 0.08431454747915268, 0.08601833879947662, 0.09552711993455887, 0.08697378635406494, 0.08619799464941025, 0.08793985098600388, 0.09625682234764099, 0.09678993374109268, 0.09874582290649414, 0.097865030169487], [0.08493579924106598, 0.0856936052441597, 0.08705697953701019, 0.09456511586904526, 0.08781903237104416, 0.08720041066408157, 0.08858776092529297, 0.09513458609580994, 0.0955500602722168, 0.09707025438547134, 0.09638646245002747], [0.0842331051826477, 0.08507510274648666, 0.0865921899676323, 0.0949968546628952, 0.08744140714406967, 0.08675196021795273, 0.08829895406961441, 0.09563767164945602, 0.09610548615455627, 0.09781928360462189, 0.09704800695180893]], [[0.05277654528617859, 0.06422767788171768, 0.0538797602057457, 0.06557025760412216, 0.056518446654081345, 0.05710611119866371, 0.06763694435358047, 0.05673973634839058, 0.4042629897594452, 0.06357209384441376, 0.05770949274301529], [0.07811255007982254, 0.08465373516082764, 0.07877716422080994, 0.08537399768829346, 0.0803348645567894, 0.08067590743303299, 0.08646590262651443, 0.08046353608369827, 0.17981958389282227, 0.08429879695177078, 0.08102390915155411], [0.05571158975362778, 0.0669763833284378, 0.056803010404109955, 0.06828848272562027, 0.05940790846943855, 0.05998700112104416, 0.0703049823641777, 0.059626009315252304, 0.37597835063934326, 0.06633505970239639, 0.06058119982481003], [0.0803220197558403, 0.08599133789539337, 0.08090124279260635, 0.08661144971847534, 0.08225592970848083, 0.0825519859790802, 0.08754999935626984, 0.08236764371395111, 0.16290897130966187, 0.08568546175956726, 0.08285389095544815], [0.06234550103545189, 0.07286522537469864, 0.06337808817625046, 0.07407205551862717, 0.06583043932914734, 0.06637335568666458, 0.07591987401247025, 0.06603500992059708, 0.3139767646789551, 0.07227405160665512, 0.06692960113286972], [0.06374063342809677, 0.07404214888811111, 0.06475464999675751, 0.07522004097700119, 0.06716030836105347, 0.06769239902496338, 0.07702212035655975, 0.06736082583665848, 0.3013046681880951, 0.07346486300230026, 0.06823739409446716], [0.08345075696706772, 0.08771878480911255, 0.08389044553041458, 0.08818095922470093, 0.08491549640893936, 0.08513889461755753, 0.08887878060340881, 0.08499981462955475, 0.13996902108192444, 0.08749048411846161, 0.08536650240421295], [0.06287451833486557, 0.07331415265798569, 0.06390032917261124, 0.07451029866933823, 0.06633561104536057, 0.06687456369400024, 0.07634120434522629, 0.06653869152069092, 0.30915579199790955, 0.07272809743881226, 0.06742668151855469], [0.16792692244052887, 0.06141786277294159, 0.15104252099990845, 0.05524253845214844, 0.1182330921292305, 0.11213172227144241, 0.0471239797770977, 0.11589011549949646, 4.965670996170957e-06, 0.06473181396722794, 0.10625453293323517], [0.07697978615760803, 0.08393304795026779, 0.07768432796001434, 0.08470122516155243, 0.07933736592531204, 0.07969959080219269, 0.08586668223142624, 0.07947400957345963, 0.1886998862028122, 0.08355467766523361, 0.08006934821605682], [0.06514013558626175, 0.07519969344139099, 0.06613316386938095, 0.07634606212377548, 0.06848647445440292, 0.06900651752948761, 0.07809846848249435, 0.068682461977005, 0.2887304127216339, 0.07463756203651428, 0.06953897327184677]], [[0.07257063686847687, 0.07754207402467728, 0.07577413320541382, 0.09925103932619095, 0.07795965671539307, 0.07907594740390778, 0.08020821213722229, 0.10505891591310501, 0.10656323283910751, 0.11219479143619537, 0.11380128562450409], [0.07441727072000504, 0.07896145433187485, 0.07734907418489456, 0.09847061336040497, 0.07934172451496124, 0.08035721629858017, 0.08138570934534073, 0.10360950976610184, 0.10493560880422592, 0.10988270491361618, 0.11128908395767212], [0.07377192378044128, 0.07846735417842865, 0.07680000364780426, 0.0987451821565628, 0.07886078953742981, 0.07991182059049606, 0.08097686618566513, 0.10411553829908371, 0.10550316423177719, 0.11068607866764069, 0.11216127127408981], [0.0814879983663559, 0.08424204587936401, 0.0832730233669281, 0.0953461080789566, 0.08446931838989258, 0.08507389575242996, 0.08568279445171356, 0.09810525178909302, 0.0988074243068695, 0.1013931930065155, 0.10211890190839767], [0.07456794381141663, 0.07907652854919434, 0.07747707515954971, 0.09840625524520874, 0.07945370674133301, 0.08046084642410278, 0.08148076385259628, 0.10349146276712418, 0.10480330139398575, 0.10969585180282593, 0.11108634620904922], [0.07496749609708786, 0.07938111573457718, 0.07781611382961273, 0.09823502600193024, 0.07975004613399506, 0.0807349756360054, 0.08173206448554993, 0.10317851603031158, 0.10445278137922287, 0.10920163244009018, 0.11055027693510056], [0.07536807656288147, 0.07968570291996002, 0.07815546542406082, 0.0980626568198204, 0.08004631847143173, 0.08100882917642593, 0.08198291808366776, 0.10286499559879303, 0.10410188883543015, 0.10870802402496338, 0.11001517623662949], [0.08315733820199966, 0.08545371890068054, 0.0846472978591919, 0.09458044916391373, 0.08564261347055435, 0.08614464849233627, 0.08664963394403458, 0.096817746758461, 0.09738529473543167, 0.09946906566619873, 0.10005215555429459], [0.08357689529657364, 0.08575617522001266, 0.08499124646186829, 0.09438648819923401, 0.08593528717756271, 0.0864112377166748, 0.08688981831073761, 0.09649494290351868, 0.09702937304973602, 0.09899009764194489, 0.09953834861516953], [0.08510390669107437, 0.08684999495744705, 0.08623819053173065, 0.09367571026086807, 0.08699308335781097, 0.08737300336360931, 0.08775458484888077, 0.0953228771686554, 0.09573917835950851, 0.09726238250732422, 0.09768714755773544], [0.0855274349451065, 0.0871514305472374, 0.08658268302679062, 0.09347722679376602, 0.08728440850973129, 0.08763740211725235, 0.08799181878566742, 0.0949985608458519, 0.09538275748491287, 0.09678742289543152, 0.09717884659767151]], [[0.0844404399394989, 0.10830862075090408, 0.08905932307243347, 0.11083340644836426, 0.09113539755344391, 0.08944781124591827, 0.11473137140274048, 0.09434058517217636, 0.013329741545021534, 0.10707792639732361, 0.0972953662276268], [0.09005290269851685, 0.09939899295568466, 0.09197548776865005, 0.10031171888113022, 0.09282004833221436, 0.09213442355394363, 0.10169654339551926, 0.0941014513373375, 0.04329933598637581, 0.09894943982362747, 0.0952596664428711], [0.08586713671684265, 0.10665592551231384, 0.08994365483522415, 0.10881804674863815, 0.09176698327064514, 0.09028526395559311, 0.11214368790388107, 0.09457152336835861, 0.017202062532305717, 0.10559966415166855, 0.09714606404304504], [0.09036991000175476, 0.09837169200181961, 0.09202513843774796, 0.09914729744195938, 0.09275071322917938, 0.09216175973415375, 0.1003221943974495, 0.09384981542825699, 0.04817073419690132, 0.09798929840326309, 0.09484143555164337], [0.0864582359790802, 0.10590741038322449, 0.09029385447502136, 0.10791538655757904, 0.09200580418109894, 0.09061475843191147, 0.1109989583492279, 0.0946347713470459, 0.019201530143618584, 0.10492551326751709, 0.09704374521970749], [0.08598015457391739, 0.10651621222496033, 0.09001145511865616, 0.10864908993244171, 0.0918138399720192, 0.09034917503595352, 0.11192874610424042, 0.09458531439304352, 0.017563430592417717, 0.10547405481338501, 0.09712862223386765], [0.0907430648803711, 0.0967392548918724, 0.0919937938451767, 0.09731395542621613, 0.09254029393196106, 0.09209676831960678, 0.09818241000175476, 0.09336615353822708, 0.0564594604074955, 0.09645551443099976, 0.09410921484231949], [0.08730785548686981, 0.10474089533090591, 0.090775266289711, 0.10652092844247818, 0.09231795370578766, 0.09106466919183731, 0.1092478483915329, 0.0946812778711319, 0.022633234038949013, 0.10386920720338821, 0.09684091806411743], [0.03759581968188286, 0.14688055217266083, 0.05032116174697876, 0.16662797331809998, 0.05708661675453186, 0.051534563302993774, 0.2013368308544159, 0.06897785514593124, 1.5358561995526543e-06, 0.13797356188297272, 0.08166354149580002], [0.08987752348184586, 0.0998917743563652, 0.09193186461925507, 0.10087338835000992, 0.09283525496721268, 0.09210182726383209, 0.10236391425132751, 0.09420701116323471, 0.04106096923351288, 0.09940852224826813, 0.09544801712036133], [0.0880214124917984, 0.1036502793431282, 0.0911535918712616, 0.10523037612438202, 0.09254318475723267, 0.09141445904970169, 0.10764578729867935, 0.09466737508773804, 0.026194289326667786, 0.10287550091743469, 0.09660375863313675]]], "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 2.5674640710349195e-05, "vf_explained_var": 0.000280916690826416, "total_loss": 0.27742812037467957, "policy_loss": -0.0006418972043320537, "num_module_steps_trained_lifetime": 41895, "use_intrinsic_rewards": 0.0, "num_module_steps_trained": 5985, "vf_loss": 0.3583061695098877, "weights_seq_no": 7.0, "module_train_batch_size_mean": 997.82696443245, "curr_kl_coeff": 0.0012623744551092386, "curr_entropy_coeff": 0.0015431216992, "entropy": 0.692643940448761, "vf_loss_unclipped": 45.07010269165039, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 766.5061712056793}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"module_train_batch_size_mean": 997.5374097747205, "total_loss": 0.0, "num_module_steps_trained_lifetime": 251370, "diff_num_grad_updates_vs_sampler_policy": 36.0, "num_module_steps_trained": 35910, "weights_seq_no": 42.0}, "default_policy": {"policy_loss": -0.0005956687382422388, "num_module_steps_trained_lifetime": 251370, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35910, "vf_loss": 0.35834911465644836, "weights_seq_no": 42.0, "module_train_batch_size_mean": 997.5374097747205, "entropy": 0.6926582455635071, "vf_loss_unclipped": 45.26070022583008, "diff_num_grad_updates_vs_sampler_policy": 36.0, "mean_kl_loss": 2.2277825337368995e-05, "vf_explained_var": -0.0025496482849121094, "total_loss": 0.277511328458786}, "__all_modules__": {"num_env_steps_trained": 198000, "num_module_steps_trained_lifetime": 502740, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 1386000, "num_env_steps_trained_lifetime_throughput": 53705.02423087152}}}, "intrinsic_reward_module": {"curr_entropy_coeff": 0.0015431216992, "default_optimizer_learning_rate": 0.0002715581955, "module_train_batch_size_mean": 997.82696443245, "total_loss": 0.0, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 41895, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "weights_seq_no": 7.0, "num_module_steps_trained_lifetime_throughput": 766.5197788141309}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 231000, "num_env_steps_trained": 33000, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 83790, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 4227.936278416464, "num_module_steps_trained_throughput": 27227761.74946147, "num_module_steps_trained_lifetime_throughput": 14755725.397816852}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 10.368238394572801, "num_episodes_lifetime": 140, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -0.8}, "episode_len_min": 20, "weights_seq_no": 7.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.667569650836106e-06, "numpy_to_tensor": 1.3892730682360956e-05, "add_observations_from_episodes_to_batch": 2.9931388993971127e-06, "add_time_dim_to_batch_and_zero_pad": 7.300527053011042e-06, "batch_individual_items": 1.3119296822890998e-05}}, "connector_pipeline_timer": 6.494337565171139e-05}, "num_env_steps_sampled": 400, "env_reset_timer": 0.00020186362997467054, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2854531753260444e-05, "get_actions": 4.4482343365239946e-05, "listify_data_for_vector_env": 1.0900026169844253e-05, "un_batch_to_individual_items": 7.17981451959062e-06, "tensor_to_numpy": 1.6474320309309924e-05, "normalize_and_clip_actions": 8.692148441902905e-06}}, "connector_pipeline_timer": 0.00012934626406385855}, "episode_len_max": 20, "env_step_timer": 1.578027487992888e-05, "rlmodule_inference_timer": 3.596058021610776e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394572801, "module_episode_returns_mean": {"default_policy": -0.8}, "episode_len_mean": 20.0, "episode_return_min": -14.5, "episode_return_mean": -0.8, "num_env_steps_sampled_lifetime": 35400, "sample": 0.11671873126237231, "episode_duration_sec_mean": 0.005294490432133898, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "episode_return_max": 14.5, "time_between_sampling": 9.631113596122288}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "aec1c_00000", "date": "2025-08-11_18-40-19", "timestamp": 1754930419, "time_this_iter_s": 11.039840936660767, "time_total_s": 70.06066870689392, "pid": 11610, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3842f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 70.06066870689392, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 49.6375, "ram_util_percent": 78.76874999999998}}
{"timers": {"training_iteration": 9.84974075972798, "restore_env_runners": 8.679683845299702e-06, "training_step": 9.849571840005197, "env_runner_sampling_timer": 1.628290016569538, "learner_update_timer": 8.043642603002368, "synch_weights": 0.0011092679453305575, "restore_eval_env_runners": 2.1446497105385485e-05, "evaluation_iteration": 0.12360247162054454, "synch_eval_env_connectors": 0.00016399305806608184, "synch_env_connectors": 5.452351638056388e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.7046857453014613e-05, "normalize_and_clip_actions": 8.670757396218e-06, "get_actions": 4.5584936273198764e-05, "un_batch_to_individual_items": 7.169016105074997e-06, "remove_single_ts_time_rank_from_batch": 1.2847590583835465e-05, "listify_data_for_vector_env": 1.157902068925448e-05}}, "connector_pipeline_timer": 0.0001317368284662635}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.578665174893695e-06, "numpy_to_tensor": 1.417339182108112e-05, "add_states_from_episodes_to_batch": 2.981476251734301e-06, "add_observations_from_episodes_to_batch": 2.997849871377418e-06, "batch_individual_items": 1.3702305162977331e-05}}, "connector_pipeline_timer": 6.536151517709802e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "rlmodule_inference_timer": 3.6025893423874834e-05, "episode_len_mean": 20.0, "episode_return_min": -11.5, "weights_seq_no": 7.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_mean": -0.06, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime": -3695000.0, "num_env_steps_sampled": 5000.0, "sample": 0.006234430129321611, "env_reset_timer": 4.914062135452644e-05, "episode_duration_sec_mean": 0.005860483493655918, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -184750.0, "time_between_sampling": 0.03763905291740125, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": -0.06}, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.5419154005635924e-05, "module_episode_returns_mean": {"default_policy": -0.06}, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 2958.8402486796645}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13955268998916676, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008909844971750399, "add_observations_from_episodes_to_batch": 0.0008283252407028761, "add_columns_from_episodes_to_train_batch": 0.041517137460191485, "add_time_dim_to_batch_and_zero_pad": 0.07570265112890448, "add_states_from_episodes_to_batch": 0.0035448342807994633, "batch_individual_items": 0.00885164448141994, "numpy_to_tensor": 7.133118413585127e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"IntrinsicAttentionMask": [[[0.07217799127101898, 0.07622499018907547, 0.0773816928267479, 0.10299306362867355, 0.07974802702665329, 0.0778232142329216, 0.07900416851043701, 0.10515254735946655, 0.10674822330474854, 0.11273355036973953, 0.11001258343458176], [0.07355360686779022, 0.07735050469636917, 0.0784328281879425, 0.10210789740085602, 0.08064312487840652, 0.07884562760591507, 0.07994887232780457, 0.10408156365156174, 0.10553792119026184, 0.1109858825802803, 0.10851205885410309], [0.07393573969602585, 0.07766181230545044, 0.07872316241264343, 0.10186181217432022, 0.08088956773281097, 0.07912787050008774, 0.08020924031734467, 0.1037847027182579, 0.1052030548453331, 0.1105048656463623, 0.10809816420078278], [0.08137595653533936, 0.08360665291547775, 0.08423319458961487, 0.09705907851457596, 0.08550038188695908, 0.08447109907865524, 0.08510410785675049, 0.09806260466575623, 0.09879747778177261, 0.10150574147701263, 0.10028377175331116], [0.07470304518938065, 0.0782850906252861, 0.07930391281843185, 0.10136739909648895, 0.08138150721788406, 0.07969222962856293, 0.08072936534881592, 0.10318943858146667, 0.10453236848115921, 0.10954475402832031, 0.10727088898420334], [0.07408037036657333, 0.07777947187423706, 0.07883284240961075, 0.10176864266395569, 0.08098258823156357, 0.07923448085784912, 0.08030755817890167, 0.10367242246866226, 0.10507646948099136, 0.11032331734895706, 0.10794185101985931], [0.07446390390396118, 0.0780910924077034, 0.07912322133779526, 0.10152153670787811, 0.0812285989522934, 0.07951667159795761, 0.08056765049695969, 0.10337485373020172, 0.1047411635518074, 0.1098431870341301, 0.1075281947851181], [0.08192912489175797, 0.08403994143009186, 0.08463220298290253, 0.09670164436101913, 0.08582927286624908, 0.0848570242524147, 0.0854550451040268, 0.09764183312654495, 0.09832995384931564, 0.10086331516504288, 0.09972076117992401], [0.08233167976140976, 0.08435450494289398, 0.08492165803909302, 0.09644152969121933, 0.08606741577386856, 0.08513689786195755, 0.08570931106805801, 0.09733603149652481, 0.09799046069383621, 0.1003980040550232, 0.09931254386901855], [0.08379728347063065, 0.08549444377422333, 0.08596900850534439, 0.09549470245838165, 0.08692605793476105, 0.08614896982908249, 0.08662717044353485, 0.0962257832288742, 0.09675992280244827, 0.09871961176395416, 0.09783709794282913], [0.08313948661088943, 0.08498384058475494, 0.08550018817186356, 0.0959196388721466, 0.08654230833053589, 0.08569606393575668, 0.08621673285961151, 0.09672350436449051, 0.09731117635965347, 0.09946991503238678, 0.09849725663661957]], [[0.08505219966173172, 0.10584656894207001, 0.08970453590154648, 0.10831397026777267, 0.09179564565420151, 0.0928594097495079, 0.11212332546710968, 0.09502406418323517, 0.013426323421299458, 0.10785368829965591, 0.09800024330615997], [0.08983433991670609, 0.09955833852291107, 0.0921107605099678, 0.10064219683408737, 0.09311354160308838, 0.09361901879310608, 0.10229016095399857, 0.09463822096586227, 0.03773285076022148, 0.10044100880622864, 0.09601963311433792], [0.08639422804117203, 0.10452377051115036, 0.090495765209198, 0.10664267092943192, 0.09233029186725616, 0.09326145052909851, 0.10990183055400848, 0.09515204280614853, 0.017307661473751068, 0.10624787211418152, 0.09774238616228104], [0.09017875790596008, 0.09872663766145706, 0.09218929708003998, 0.0996730849146843, 0.09307307749986649, 0.09351814538240433, 0.10110980272293091, 0.09441465884447098, 0.041991107165813446, 0.09949749708175659, 0.09562795609235764], [0.08694881200790405, 0.10391753166913986, 0.09080619364976883, 0.10588777810335159, 0.0925278514623642, 0.09340088069438934, 0.10891341418027878, 0.0951717421412468, 0.019310487434267998, 0.10552086681127548, 0.09759438037872314], [0.08721907436847687, 0.10360580682754517, 0.09095308184623718, 0.10550222545862198, 0.09261791408061981, 0.09346171468496323, 0.10841215401887894, 0.0951724722981453, 0.020395249128341675, 0.10514915734529495, 0.09751112014055252], [0.09060752391815186, 0.09739498049020767, 0.09221528470516205, 0.09813903272151947, 0.09291977435350418, 0.09327401965856552, 0.09926577657461166, 0.09398659318685532, 0.04924715682864189, 0.09800110012292862, 0.09494876861572266], [0.08774389326572418, 0.10296373069286346, 0.09122861921787262, 0.1047135591506958, 0.0927790030837059, 0.09356406331062317, 0.10739421099424362, 0.09515414386987686, 0.02274627424776554, 0.10438794642686844, 0.09732456505298615], [0.04039142653346062, 0.1337476521730423, 0.05406300723552704, 0.15172937512397766, 0.061331529170274734, 0.06532441824674606, 0.1833348572254181, 0.07410698384046555, 1.6500654282936011e-06, 0.14823314547538757, 0.08773597329854965], [0.0901184156537056, 0.09888355433940887, 0.09217827022075653, 0.09985525906085968, 0.09308407455682755, 0.09354031831026077, 0.10133074223995209, 0.09445951133966446, 0.041171032935380936, 0.09967496246099472, 0.0957038477063179], [0.08840912580490112, 0.10206208378076553, 0.09155510365962982, 0.10361795127391815, 0.09295080602169037, 0.09365662187337875, 0.10599636286497116, 0.09508436918258667, 0.026309672743082047, 0.1033286452293396, 0.09702927619218826]], [[0.0716380849480629, 0.07272518426179886, 0.07680284976959229, 0.10222264379262924, 0.07915148884057999, 0.08035261183977127, 0.08157195150852203, 0.10857018828392029, 0.11021772772073746, 0.10755748301744461, 0.10918965935707092], [0.07202562689781189, 0.07309507578611374, 0.07710358500480652, 0.10199801623821259, 0.07941029965877533, 0.0805894136428833, 0.08178602904081345, 0.10819227248430252, 0.10979875177145004, 0.10720456391572952, 0.1087963730096817], [0.07343883067369461, 0.07444246858358383, 0.07819407433271408, 0.10117720812559128, 0.08034592121839523, 0.08144395798444748, 0.08255699276924133, 0.10682249069213867, 0.10828235745429993, 0.10592406988143921, 0.10737165063619614], [0.08107953518629074, 0.08168713748455048, 0.08392636477947235, 0.09670552611351013, 0.08518894761800766, 0.08582734316587448, 0.08647051453590393, 0.09963706880807877, 0.10038373619318008, 0.09917527437210083, 0.09991848468780518], [0.07422544062137604, 0.0751914232969284, 0.07879690080881119, 0.10071931779384613, 0.08086120337247849, 0.0819135457277298, 0.08297958970069885, 0.10606569796800613, 0.10744605958461761, 0.10521575808525085, 0.1065850630402565], [0.07462041079998016, 0.07556720823049545, 0.07909846305847168, 0.10048913955688477, 0.08111845701932907, 0.08214771747589111, 0.08319003880023956, 0.1056872010231018, 0.10702819377183914, 0.10486128181219101, 0.10619179904460907], [0.07501648366451263, 0.07594387233257294, 0.07940015196800232, 0.10025817900896072, 0.08137545734643936, 0.082381471991539, 0.08339992165565491, 0.1053086668252945, 0.10661055147647858, 0.10450662672519684, 0.10579860210418701], [0.08273734897375107, 0.08325016498565674, 0.08513444662094116, 0.09572995454072952, 0.08619306236505508, 0.08672729134559631, 0.08726484328508377, 0.09812548011541367, 0.09873367100954056, 0.09774893522262573, 0.09835479408502579], [0.08315427601337433, 0.08364276587963104, 0.08543630689382553, 0.09548439085483551, 0.08644302934408188, 0.08695083111524582, 0.08746162056922913, 0.09774789214134216, 0.09832210838794708, 0.09739229828119278, 0.09796442091464996], [0.08247841149568558, 0.08300624042749405, 0.08494658023118973, 0.09588240832090378, 0.0860372930765152, 0.08658789843320847, 0.08714202791452408, 0.09836048632860184, 0.09898994863033295, 0.09797083586454391, 0.09859780222177505], [0.08289474248886108, 0.08339839428663254, 0.08524849265813828, 0.09563726931810379, 0.08628754317760468, 0.08681181818246841, 0.08733926713466644, 0.09798283129930496, 0.09857815504074097, 0.09761421382427216, 0.09820730239152908]], [[0.08578277379274368, 0.10675575584173203, 0.08778246492147446, 0.11259528249502182, 0.08982875198125839, 0.09365703910589218, 0.11308642476797104, 0.09298799932003021, 0.013138644397258759, 0.10554271936416626, 0.09884203970432281], [0.09023623168468475, 0.10000373423099518, 0.09121860563755035, 0.1025378480553627, 0.09221167117357254, 0.09403784573078156, 0.10274777561426163, 0.09372159093618393, 0.037367381155490875, 0.0994681715965271, 0.09644919633865356], [0.0863429605960846, 0.10614828020334244, 0.0882420614361763, 0.11162208765745163, 0.09018294513225555, 0.0938074141740799, 0.11208173632621765, 0.09317460656166077, 0.014685406349599361, 0.10500914603471756, 0.09870325773954391], [0.09086357802152634, 0.09789583832025528, 0.09157999604940414, 0.09968891739845276, 0.09230205416679382, 0.09362431615591049, 0.09983690828084946, 0.09339583665132523, 0.047937724739313126, 0.0975152999162674, 0.09535953402519226], [0.08688822388648987, 0.10552170127630234, 0.08868511766195297, 0.11063364148139954, 0.09051917493343353, 0.093937948346138, 0.11106222122907639, 0.09334161132574081, 0.01641075871884823, 0.10445593297481537, 0.09854360669851303], [0.0878305733203888, 0.10433219373226166, 0.08943825215101242, 0.10879883915185928, 0.0910753533244133, 0.09411699324846268, 0.10917223989963531, 0.09358736872673035, 0.02005556784570217, 0.10339788347482681, 0.09819477796554565], [0.09090287983417511, 0.09771246463060379, 0.09159733355045319, 0.09944629669189453, 0.09229709208011627, 0.09357807040214539, 0.09958935528993607, 0.09335677325725555, 0.048917144536972046, 0.09734436869621277, 0.09525827318429947], [0.08767331391572952, 0.10454193502664566, 0.08931386470794678, 0.1091184914112091, 0.09098510444164276, 0.09409193694591522, 0.10950126498937607, 0.09355079382658005, 0.01937752403318882, 0.10358517616987228, 0.09826058894395828], [0.04083256796002388, 0.13739128410816193, 0.04640054330229759, 0.1846136748790741, 0.052727751433849335, 0.0664638876914978, 0.18912549316883087, 0.06387249380350113, 1.232325189448602e-06, 0.1289518028497696, 0.08961927890777588], [0.09006987512111664, 0.10042590647935867, 0.09110856801271439, 0.10312272608280182, 0.09215924143791199, 0.09409306943416595, 0.10334630310535431, 0.0937580093741417, 0.035409726202487946, 0.09985648095607758, 0.09664997458457947], [0.08893934637308121, 0.10267418622970581, 0.09029518067836761, 0.10632777214050293, 0.09167168289422989, 0.09421831369400024, 0.1066320613026619, 0.09377586841583252, 0.02594762109220028, 0.10190670192241669, 0.0976111963391304]], [[0.07158911973237991, 0.07649331539869308, 0.07474929094314575, 0.10162767767906189, 0.0798264667391777, 0.07800643891096115, 0.0821288675069809, 0.10757461935281754, 0.10911495983600616, 0.10662717372179031, 0.11226211488246918], [0.0735161304473877, 0.07800529152154922, 0.07641243934631348, 0.10057701915502548, 0.0810389518737793, 0.07938415557146072, 0.08312664926052094, 0.10582584142684937, 0.10718029737472534, 0.10499170422554016, 0.10994144529104233], [0.07284221798181534, 0.07747846096754074, 0.07583213597536087, 0.10094515979290009, 0.080617755651474, 0.07890472561120987, 0.08278097957372665, 0.10643516480922699, 0.10785370320081711, 0.10556193441152573, 0.11074773967266083], [0.0820852667093277, 0.08452649414539337, 0.08366863429546356, 0.09584438055753708, 0.08613617718219757, 0.08526197820901871, 0.08722630143165588, 0.09828569740056992, 0.09890568256378174, 0.09790188819169998, 0.10015740990638733], [0.07477124780416489, 0.0789809599518776, 0.07748942077159882, 0.09988956153392792, 0.08181530237197876, 0.08027024567127228, 0.08376114815473557, 0.10469749569892883, 0.10593521595001221, 0.10393466055393219, 0.10845471918582916], [0.07409113645553589, 0.07845316082239151, 0.07690644264221191, 0.1002623662352562, 0.08139590919017792, 0.07979118824005127, 0.0834188237786293, 0.10530787706375122, 0.10660843551158905, 0.10450664162635803, 0.10925794392824173], [0.07561428844928741, 0.07963228970766068, 0.07821004837751389, 0.0994265228509903, 0.08233091980218887, 0.08086048066616058, 0.08418062329292297, 0.10394428670406342, 0.1051054373383522, 0.10322825610637665, 0.10746681690216064], [0.08385727554559708, 0.0858348160982132, 0.08514124155044556, 0.09485669434070587, 0.08713236451148987, 0.08642830699682236, 0.08800826966762543, 0.09677340090274811, 0.09725859761238098, 0.09647271782159805, 0.09823630005121231], [0.08430308848619461, 0.08616184443235397, 0.08551025390625, 0.09460785984992981, 0.08737995475530624, 0.08671914786100388, 0.08820157498121262, 0.09639539569616318, 0.0968475341796875, 0.0961151272058487, 0.09775817394256592], [0.08358044177293777, 0.08563131093978882, 0.08491180092096329, 0.0950111523270607, 0.0869779959321022, 0.08624717593193054, 0.08788753300905228, 0.09700862318277359, 0.09751451760530472, 0.09669516235589981, 0.0985342413187027], [0.0851980522274971, 0.08681579679250717, 0.08624924719333649, 0.09410794824361801, 0.08787335455417633, 0.0872998982667923, 0.08858553320169449, 0.09563955664634705, 0.09602633863687515, 0.09539967775344849, 0.09680459648370743]], [[0.08825337886810303, 0.10808535665273666, 0.09015840291976929, 0.10736959427595139, 0.0895613580942154, 0.09052282571792603, 0.11401290446519852, 0.09510280936956406, 0.015079565346240997, 0.10399366170167923, 0.09786021709442139], [0.09140456467866898, 0.0996890515089035, 0.09224388003349304, 0.09940595924854279, 0.09198193997144699, 0.09240327775478363, 0.10199330002069473, 0.09437604248523712, 0.042908381670713425, 0.09805598855018616, 0.09553764015436172], [0.08869840949773788, 0.10731147229671478, 0.0904964953660965, 0.10664352029561996, 0.08993321657180786, 0.09084019809961319, 0.11283296346664429, 0.09515281021595001, 0.016858341172337532, 0.1034894660115242, 0.09774316847324371], [0.09135299175977707, 0.1000121682882309, 0.09222874790430069, 0.09971573948860168, 0.09195539355278015, 0.0923951119184494, 0.10242636501789093, 0.0944550633430481, 0.04148685559630394, 0.09830266237258911, 0.09566888213157654], [0.08856191486120224, 0.10755430907011032, 0.09039341658353806, 0.10687153041362762, 0.08981958031654358, 0.09074358642101288, 0.1132015511393547, 0.09513960778713226, 0.016283942386507988, 0.10364863276481628, 0.09778199344873428], [0.08878036588430405, 0.10716307908296585, 0.09055809676647186, 0.10650411248207092, 0.09000124782323837, 0.09089786559343338, 0.11260848492383957, 0.09515973925590515, 0.01721671037375927, 0.10339176654815674, 0.0977184846997261], [0.09162865579128265, 0.096927709877491, 0.0921730026602745, 0.09674926102161407, 0.09200330078601837, 0.0922761783003807, 0.09837367385625839, 0.09354802966117859, 0.05613183230161667, 0.09589579701423645, 0.0942925438284874], [0.08972121775150299, 0.10528403520584106, 0.09124599397182465, 0.10473348945379257, 0.09076885133981705, 0.09153688699007034, 0.10981435328722, 0.09517226368188858, 0.022253474220633507, 0.10212627053260803, 0.0973430946469307], [0.04605383798480034, 0.15495942533016205, 0.0523337721824646, 0.14891758561134338, 0.05029330402612686, 0.05361277237534523, 0.21330884099006653, 0.07203987240791321, 1.1754372053474071e-06, 0.12299798429012299, 0.08548147976398468], [0.0910419300198555, 0.10150972753763199, 0.09209183603525162, 0.10114826261997223, 0.09176390618085861, 0.09229150414466858, 0.10446164011955261, 0.09476988017559052, 0.035257838666439056, 0.09942811727523804, 0.09623537212610245], [0.0902048721909523, 0.10413512587547302, 0.09157998859882355, 0.10364612191915512, 0.0911499410867691, 0.09184207767248154, 0.10814932733774185, 0.0951102152466774, 0.025799956172704697, 0.10132670402526855, 0.09705564379692078]]], "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 2.1073274183436297e-06, "vf_explained_var": -0.0019381046295166016, "total_loss": 0.27809038758277893, "policy_loss": 1.9319440980325453e-05, "num_module_steps_trained_lifetime": 47880, "use_intrinsic_rewards": 0.0, "num_module_steps_trained": 5985, "vf_loss": 0.3583071529865265, "weights_seq_no": 8.0, "module_train_batch_size_mean": 997.8076834879114, "curr_kl_coeff": 0.0006311872275546193, "curr_entropy_coeff": 0.0015431216992, "entropy": 0.692406415939331, "vf_loss_unclipped": 42.79432678222656, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 762.9822677142679}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"module_train_batch_size_mean": 997.5252898807411, "total_loss": 0.0, "num_module_steps_trained_lifetime": 287280, "diff_num_grad_updates_vs_sampler_policy": 41.0, "num_module_steps_trained": 35910, "weights_seq_no": 48.0}, "default_policy": {"policy_loss": 2.0174382370896637e-05, "num_module_steps_trained_lifetime": 287280, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35910, "vf_loss": 0.3583349585533142, "weights_seq_no": 48.0, "module_train_batch_size_mean": 997.5252898807411, "entropy": 0.6924039125442505, "vf_loss_unclipped": 42.85139083862305, "diff_num_grad_updates_vs_sampler_policy": 41.0, "mean_kl_loss": 2.242345999547979e-06, "vf_explained_var": -0.0025634765625, "total_loss": 0.2781132757663727}, "__all_modules__": {"num_env_steps_trained": 198000, "num_module_steps_trained_lifetime": 574560, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 1584000, "num_env_steps_trained_lifetime_throughput": 52746.11632345409}}}, "intrinsic_reward_module": {"curr_entropy_coeff": 0.0015431216992, "default_optimizer_learning_rate": 0.0002715581955, "module_train_batch_size_mean": 997.8076834879114, "total_loss": 0.0, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 47880, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "weights_seq_no": 8.0, "num_module_steps_trained_lifetime_throughput": 762.9952349146715}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 264000, "num_env_steps_trained": 33000, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 95760, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 4208.44960839403, "num_module_steps_trained_throughput": 26469084.83876216, "num_module_steps_trained_lifetime_throughput": 14623283.635281252}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 10.3682383945743, "num_episodes_lifetime": 160, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -1.2}, "episode_len_min": 20, "weights_seq_no": 8.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7476748802675293e-06, "numpy_to_tensor": 1.1901204384562089e-05, "add_observations_from_episodes_to_batch": 2.792339021374824e-06, "add_time_dim_to_batch_and_zero_pad": 6.768295464823037e-06, "batch_individual_items": 1.233089676271868e-05}}, "connector_pipeline_timer": 5.84610082705512e-05}, "num_env_steps_sampled": 400, "env_reset_timer": 0.00020065374372134096, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1897653112760434e-05, "get_actions": 3.5717135565297225e-05, "listify_data_for_vector_env": 1.0387083495114115e-05, "un_batch_to_individual_items": 6.433289862046043e-06, "tensor_to_numpy": 1.5058513090237126e-05, "normalize_and_clip_actions": 7.937945041389522e-06}}, "connector_pipeline_timer": 0.00011361915485525171}, "episode_len_max": 20, "env_step_timer": 1.3911306196482224e-05, "rlmodule_inference_timer": 3.0440224447672948e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.3682383945743, "module_episode_returns_mean": {"default_policy": -1.2}, "episode_len_mean": 20.0, "episode_return_min": -14.5, "episode_return_mean": -1.2, "num_env_steps_sampled_lifetime": 40400, "sample": 0.11667270020034091, "episode_duration_sec_mean": 0.005266422905260697, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "episode_return_max": 14.5, "time_between_sampling": 9.633746327241445}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "aec1c_00000", "date": "2025-08-11_18-40-29", "timestamp": 1754930429, "time_this_iter_s": 9.980112075805664, "time_total_s": 80.04078078269958, "pid": 11610, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3842f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 80.04078078269958, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 42.81428571428571, "ram_util_percent": 78.80714285714285}}
{"timers": {"training_iteration": 9.84634832672164, "restore_env_runners": 8.650807121915259e-06, "training_step": 9.846179301195223, "env_runner_sampling_timer": 1.6274610276540669, "learner_update_timer": 8.041007786551818, "synch_weights": 0.0011074756859380057, "restore_eval_env_runners": 2.1299952325545117e-05, "evaluation_iteration": 0.12353823607481478, "synch_eval_env_connectors": 0.00016332728740600915, "synch_env_connectors": 5.452408281161164e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5647058684814215e-05, "normalize_and_clip_actions": 8.049620793565906e-06, "get_actions": 4.036642467147962e-05, "un_batch_to_individual_items": 6.567627711382609e-06, "remove_single_ts_time_rank_from_batch": 1.1889021460068266e-05, "listify_data_for_vector_env": 1.0604031964531195e-05}}, "connector_pipeline_timer": 0.00011998994707265479}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.956052188374194e-06, "numpy_to_tensor": 1.2648517103510068e-05, "add_states_from_episodes_to_batch": 2.6789796357522356e-06, "add_observations_from_episodes_to_batch": 2.785249768157003e-06, "batch_individual_items": 1.2445970337518071e-05}}, "connector_pipeline_timer": 5.980589891814341e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "rlmodule_inference_timer": 3.230887583897369e-05, "episode_len_mean": 20.0, "episode_return_min": -11.5, "weights_seq_no": 8.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_mean": -1.9799999999999998, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime": -4312500.0, "num_env_steps_sampled": 5000.0, "sample": 0.005994012909638876, "env_reset_timer": 4.530015371532044e-05, "episode_duration_sec_mean": 0.005321185172069817, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -215625.0, "time_between_sampling": 0.03398518401371186, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": -1.9799999999999998}, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.3846104936984418e-05, "module_episode_returns_mean": {"default_policy": -1.9799999999999998}, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 3193.420428966799}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13950531683898876, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008909999851239154, "add_observations_from_episodes_to_batch": 0.0008291569878527613, "add_columns_from_episodes_to_train_batch": 0.041520162336274126, "add_time_dim_to_batch_and_zero_pad": 0.07569874086672226, "add_states_from_episodes_to_batch": 0.0035450480186184036, "batch_individual_items": 0.008804365955964276, "numpy_to_tensor": 7.11582920090181e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"IntrinsicAttentionMask": [[[0.07150839269161224, 0.0764070600271225, 0.07466500252485275, 0.10151305794715881, 0.07681853324174881, 0.07791847735643387, 0.08203624188899994, 0.10745330899953842, 0.10899190604686737, 0.11055252701044083, 0.11213550716638565], [0.07344985753297806, 0.07793498039245605, 0.07634356617927551, 0.10048633813858032, 0.07831030339002609, 0.07931259274482727, 0.08305171132087708, 0.10573042929172516, 0.10708366334438324, 0.10845421999692917, 0.10984232276678085], [0.07277102768421173, 0.0774027481675148, 0.07575803250074387, 0.10084648430347443, 0.07779084891080856, 0.07882761210203171, 0.08270008116960526, 0.10633112490177155, 0.10774827748537064, 0.10918430984020233, 0.11063949018716812], [0.08206730335950851, 0.08450799435377121, 0.08365032076835632, 0.09582340717315674, 0.08470898121595383, 0.08524332195520401, 0.08720720559358597, 0.0982641875743866, 0.09888403862714767, 0.09950779378414154, 0.10013549029827118], [0.0736084058880806, 0.07805898040533066, 0.07648012042045593, 0.10040206462144852, 0.07843130081892014, 0.07942548394203186, 0.08313331753015518, 0.10559041053056717, 0.10692885518074036, 0.10828427225351334, 0.10965686291456223], [0.07402893900871277, 0.0783872976899147, 0.07684189081192017, 0.10017818957567215, 0.07875162363052368, 0.07972420752048492, 0.08334879577159882, 0.10521946102380753, 0.1065189316868782, 0.10783445090055466, 0.1091662123799324], [0.07556234300136566, 0.07957758009433746, 0.07815632224082947, 0.0993582084774971, 0.07991223782300949, 0.08080492913722992, 0.08412279188632965, 0.1038728654384613, 0.10503321886062622, 0.10620654374361038, 0.10739297419786453], [0.08384567499160767, 0.0858229547739029, 0.08512947708368301, 0.09484358131885529, 0.08598524332046509, 0.08641635626554489, 0.08799610286951065, 0.09676001965999603, 0.09724514931440353, 0.09773270785808563, 0.09822271764278412], [0.08429289609193802, 0.08615142852067947, 0.08549991995096207, 0.09459642320871353, 0.08630385994911194, 0.086708664894104, 0.08819091320037842, 0.09638374298810959, 0.09683582186698914, 0.0972900241613388, 0.0977463573217392], [0.08474113047122955, 0.0864797830581665, 0.08587058633565903, 0.09434838593006134, 0.08662226051092148, 0.08700056374073029, 0.0883847326040268, 0.09600738435983658, 0.09642666578292847, 0.0968477874994278, 0.09727074205875397], [0.08519039303064346, 0.08680799603462219, 0.08624149113893509, 0.0940994918346405, 0.08694044500589371, 0.08729204535484314, 0.08857756853103638, 0.0956309586763382, 0.09601770341396332, 0.0964060127735138, 0.09679589420557022]], [[0.05192340910434723, 0.06492684781551361, 0.0530087985098362, 0.06628405302762985, 0.055604830384254456, 0.05618298798799515, 0.0665435716509819, 0.05582254379987717, 0.4086623191833496, 0.06426413357257843, 0.05677661672234535], [0.0806882306933403, 0.0868246853351593, 0.0812375620007515, 0.08741579204797745, 0.0825214833021164, 0.08280190825462341, 0.08752789348363876, 0.0826273113489151, 0.1587342917919159, 0.08653302490711212, 0.08308783173561096], [0.054894816130399704, 0.06769467145204544, 0.05597023665904999, 0.0690208449959755, 0.05853694677352905, 0.05910754203796387, 0.06927423179149628, 0.058751847594976425, 0.3800092935562134, 0.06704648584127426, 0.059693023562431335], [0.08282586932182312, 0.08789436519145966, 0.08328250795602798, 0.08837895095348358, 0.08434750139713287, 0.08457969129085541, 0.08847077935934067, 0.08443513512611389, 0.14331382513046265, 0.08765504509210587, 0.08481627702713013], [0.06163017451763153, 0.07359731942415237, 0.06265091150999069, 0.0748162642121315, 0.0650751143693924, 0.06561180204153061, 0.0750487670302391, 0.0652773454785347, 0.317130446434021, 0.0730002149939537, 0.06616165488958359], [0.06304984539747238, 0.07477108389139175, 0.06405287235975266, 0.07596058398485184, 0.06643246114253998, 0.06695879250764847, 0.0761873722076416, 0.06663080304861069, 0.3042701780796051, 0.07418812066316605, 0.0674978643655777], [0.08321868628263474, 0.08807960897684097, 0.0836571455001831, 0.08854368329048157, 0.08467933535575867, 0.08490212261676788, 0.08863162249326706, 0.08476343005895615, 0.1405448019504547, 0.08785036951303482, 0.08512909710407257], [0.062168367207050323, 0.0740453228354454, 0.06318265944719315, 0.07525339722633362, 0.06559058278799057, 0.06612348556518555, 0.0754837840795517, 0.06579139083623886, 0.3122381269931793, 0.07345343381166458, 0.06666938960552216], [0.1731998771429062, 0.054133735597133636, 0.15552271902561188, 0.04860872030258179, 0.12126632779836655, 0.11491145938634872, 0.04763028025627136, 0.11882537603378296, 3.7670531582989497e-06, 0.05710236728191376, 0.10879534482955933], [0.0795915350317955, 0.08623712509870529, 0.08018456399440765, 0.086879663169384, 0.08157207816839218, 0.08187540620565414, 0.08700156211853027, 0.08168653398752213, 0.16686654090881348, 0.08592024445533752, 0.08218476176261902], [0.06447506695985794, 0.07592309266328812, 0.06545795500278473, 0.07708050310611725, 0.06778722256422043, 0.0683019682765007, 0.07730108499526978, 0.06798122823238373, 0.291507363319397, 0.07535557448863983, 0.06882898509502411]], [[0.07172893732786179, 0.07281742244958878, 0.07392241805791855, 0.09838880598545074, 0.07618296146392822, 0.0804545059800148, 0.08167538791894913, 0.10870783030986786, 0.11035745590925217, 0.11203211545944214, 0.11373218894004822], [0.0721186026930809, 0.07318944483995438, 0.07427618652582169, 0.09825769811868668, 0.07649830728769302, 0.08069343864917755, 0.08189159631729126, 0.10833189636468887, 0.10994044691324234, 0.11157286912202835, 0.11322954297065735], [0.0725092664361, 0.07356223464012146, 0.0746304988861084, 0.09812523424625397, 0.07681377232074738, 0.08093183487653732, 0.08210710436105728, 0.10795559734106064, 0.10952331125736237, 0.1111137866973877, 0.11272736638784409], [0.0801042690873146, 0.08077268302440643, 0.08144666254520416, 0.09536342322826385, 0.08281154930591583, 0.08534201234579086, 0.08605412393808365, 0.10075816512107849, 0.10159891843795776, 0.10244668275117874, 0.1033015176653862], [0.073293536901474, 0.0743100643157959, 0.07534069567918777, 0.097856305539608, 0.07744501531124115, 0.08140694350004196, 0.0825359970331192, 0.1072019413113594, 0.10868874937295914, 0.11019617319107056, 0.11172451078891754], [0.07472384721040726, 0.0756719633936882, 0.07663211971521378, 0.09735578298568726, 0.07858911901712418, 0.0822615846991539, 0.08330534398555756, 0.10583366453647614, 0.1071765199303627, 0.10853640735149384, 0.10991355776786804], [0.07512092590332031, 0.07604961097240448, 0.0769897848367691, 0.09721457958221436, 0.0789051204919815, 0.08249615877866745, 0.08351602405309677, 0.10545524209737778, 0.10675893723964691, 0.10807874798774719, 0.10941488295793533], [0.08282753825187683, 0.08334091305732727, 0.0838574692606926, 0.09429403394460678, 0.08490020036697388, 0.08682183176279068, 0.0873599573969841, 0.09823243319988251, 0.09884128719568253, 0.09945391863584518, 0.10007034242153168], [0.08324180543422699, 0.08373081684112549, 0.08422268182039261, 0.09412802755832672, 0.08521509915590286, 0.08704236149787903, 0.08755367994308472, 0.09785078465938568, 0.09842560440301895, 0.09900379180908203, 0.0995853841304779], [0.08365684002637863, 0.0841212123632431, 0.08458814769983292, 0.09396082907915115, 0.08552981913089752, 0.08726207911968231, 0.08774645626544952, 0.09746908396482468, 0.0980101153254509, 0.09855416417121887, 0.09910121560096741], [0.08407264202833176, 0.0845121294260025, 0.08495389670133591, 0.09379248321056366, 0.08584439009428024, 0.08748099952936172, 0.08793829381465912, 0.09708737581968307, 0.09759488701820374, 0.0981050506234169, 0.09861788153648376]], [[0.057310089468955994, 0.06863672286272049, 0.056972309947013855, 0.0699533224105835, 0.05806516855955124, 0.05861943960189819, 0.07020483911037445, 0.05974389612674713, 0.3718201518058777, 0.06799301505088806, 0.06068105250597], [0.08146976679563522, 0.08688925206661224, 0.08129796385765076, 0.08748079836368561, 0.08185145258903503, 0.08212961256504059, 0.08759298920631409, 0.08268875628709793, 0.15885235369205475, 0.08659737557172775, 0.08314961940050125], [0.056396011263132095, 0.0677991583943367, 0.056056633591651917, 0.06912738084793091, 0.05715480446815491, 0.05771193653345108, 0.06938116252422333, 0.05884253978729248, 0.38059523701667786, 0.06714997440576553, 0.05978516861796379], [0.08347635716199875, 0.08794838190078735, 0.08333368599414825, 0.08843326568603516, 0.08379312604665756, 0.08402378857135773, 0.08852514624595642, 0.08448702841997147, 0.14340192079544067, 0.08770891278982162, 0.0848684012889862], [0.05931800976395607, 0.07044617086648941, 0.0589846633374691, 0.07173386216163635, 0.06006285175681114, 0.06060931459069252, 0.07197971642017365, 0.0617172010242939, 0.35269227623939514, 0.06981617212295532, 0.06263981014490128], [0.06075919419527054, 0.07171832770109177, 0.06042983755469322, 0.0729822963476181, 0.0614948570728302, 0.06203438714146614, 0.0732235312461853, 0.06312768906354904, 0.3390927016735077, 0.071099653840065, 0.06403761357069016], [0.0838434249162674, 0.08813153207302094, 0.08370646089315414, 0.08859588205814362, 0.08414749056100845, 0.08436887711286545, 0.08868387341499329, 0.08481340110301971, 0.1406276822090149, 0.08790215849876404, 0.08517927676439285], [0.06359268724918365, 0.07415154576301575, 0.06327331066131592, 0.07536134868860245, 0.0643056333065033, 0.06482809036970139, 0.07559207081794739, 0.06588578224182129, 0.31268569827079773, 0.07355880737304688, 0.06676504015922546], [0.14846937358379364, 0.053438905626535416, 0.15352627635002136, 0.047984812408685684, 0.13785703480243683, 0.13063271343708038, 0.047018926590681076, 0.11730003356933594, 3.718749212566763e-06, 0.056369416415691376, 0.10739881545305252], [0.08043468743562698, 0.08630657196044922, 0.08024913817644119, 0.08694963157176971, 0.08084706217050552, 0.0811476930975914, 0.08707163482904434, 0.08175231516361237, 0.16700085997581482, 0.08598943799734116, 0.08225095272064209], [0.06585776060819626, 0.07602811604738235, 0.06554850190877914, 0.07718712091445923, 0.06654775142669678, 0.06705307215452194, 0.07740800827741623, 0.0680752620100975, 0.291910320520401, 0.07545981556177139, 0.0689241960644722]], [[0.07185125350952148, 0.07587991654872894, 0.07703138887882233, 0.09855654835700989, 0.07938700914382935, 0.07747090607881546, 0.07864652574062347, 0.10889316350221634, 0.11054560542106628, 0.11222312599420547, 0.10951448231935501], [0.07325147092342377, 0.07703276723623276, 0.07811065018177032, 0.09804985672235489, 0.0803118646144867, 0.07852175086736679, 0.07962046563625336, 0.10750046372413635, 0.10900465399026871, 0.11052990704774857, 0.10806624591350555], [0.07364042103290558, 0.07735160738229752, 0.07840871810913086, 0.09790725260972977, 0.08056647330522537, 0.07881180942058563, 0.07988887280225754, 0.10711564868688583, 0.10857952386140823, 0.11006340384483337, 0.10766632109880447], [0.0801461935043335, 0.08259521424770355, 0.0832844078540802, 0.09541333466768265, 0.08468009531497955, 0.08354625105857849, 0.08424337953329086, 0.10081090033054352, 0.10165208578109741, 0.1025002971291542, 0.10112784802913666], [0.07442142814397812, 0.07798997312784195, 0.07900495082139969, 0.09761857241392136, 0.08107470721006393, 0.07939180731773376, 0.08042503148317337, 0.10634568333625793, 0.10772968828678131, 0.10913170874118805, 0.10686641186475754], [0.073787622153759, 0.07747210562229156, 0.07852131128311157, 0.09785307198762894, 0.0806625559926033, 0.0789213627576828, 0.0799902006983757, 0.10697023570537567, 0.10841894894838333, 0.1098872721195221, 0.10751521587371826], [0.07417801022529602, 0.07779127359390259, 0.07881944626569748, 0.09770888835191727, 0.08091674745082855, 0.07921138405799866, 0.0802583247423172, 0.106585294008255, 0.10799402743577957, 0.10942139476537704, 0.10711529105901718], [0.08285156637430191, 0.08472682535648346, 0.08525197207927704, 0.09432138502597809, 0.08631204813718796, 0.08545120060443878, 0.08598083257675171, 0.09826093167066574, 0.09886996448040009, 0.09948276728391647, 0.09849055856466293], [0.08326350152492523, 0.08504890650510788, 0.0855485275387764, 0.0941525474190712, 0.086556576192379, 0.08573803305625916, 0.0862416923046112, 0.09787628799676895, 0.09845124930143356, 0.09902959316968918, 0.09809309244155884], [0.08367632329463959, 0.08537103980779648, 0.08584492653608322, 0.09398271143436432, 0.08680058270692825, 0.08602461963891983, 0.08650212734937668, 0.0974917858839035, 0.09803294390439987, 0.0985771119594574, 0.09769586473703384], [0.0830070823431015, 0.08484850078821182, 0.08536402136087418, 0.09425772726535797, 0.08640448749065399, 0.08555958420038223, 0.0860794261097908, 0.09811560809612274, 0.09871173650026321, 0.09931149333715439, 0.09834038466215134]], [[0.08817964047193527, 0.10799498856067657, 0.08759570121765137, 0.10727982223033905, 0.08948652446269989, 0.09301553666591644, 0.11391758173704147, 0.09239956736564636, 0.01549488678574562, 0.1068572849035263, 0.09777843207120895], [0.09135063737630844, 0.09963022172451019, 0.09109123051166534, 0.0993473008275032, 0.091927669942379, 0.09346215426921844, 0.10193312168121338, 0.09319674223661423, 0.043400101363658905, 0.09917964041233063, 0.0954812690615654], [0.08803696930408478, 0.10823079943656921, 0.08744307607412338, 0.10750067979097366, 0.0893663763999939, 0.09295804053544998, 0.11428065598011017, 0.0923309475183487, 0.01497361809015274, 0.10706934332847595, 0.09780952334403992], [0.09129802882671356, 0.09995198994874954, 0.09102743119001389, 0.09965574741363525, 0.09190007299184799, 0.09350187331438065, 0.10236474126577377, 0.09322474151849747, 0.04198383167386055, 0.09948019683361053, 0.0956113263964653], [0.08848956972360611, 0.10746640712022781, 0.08792782574892044, 0.10678418725728989, 0.08974621444940567, 0.09313580393791199, 0.1131090298295021, 0.0925445631146431, 0.016713300719857216, 0.10638102889060974, 0.09770210087299347], [0.08926009386777878, 0.10603022575378418, 0.08875780552625656, 0.10543355345726013, 0.09038244187831879, 0.09340094029903412, 0.11094904690980911, 0.09287533909082413, 0.020382096990942955, 0.1050807386636734, 0.09744767099618912], [0.09158580750226974, 0.09688237309455872, 0.09141718596220016, 0.09670400619506836, 0.09196026623249054, 0.09295208007097244, 0.09832766652107239, 0.0927809476852417, 0.05654298514127731, 0.09659821540117264, 0.0942484438419342], [0.08913270384073257, 0.1062820553779602, 0.08862008899450302, 0.10567080229520798, 0.09027834236621857, 0.09336104989051819, 0.11132393777370453, 0.09282410144805908, 0.019700178876519203, 0.10530940443277359, 0.09749728441238403], [0.04602650925517082, 0.15240612626075745, 0.04425518214702606, 0.14654076099395752, 0.0502050518989563, 0.06309089064598083, 0.20891085267066956, 0.06066282466053963, 1.5937379203023738e-06, 0.14316432178020477, 0.08473595231771469], [0.09126458317041397, 0.10014118254184723, 0.09098734706640244, 0.09983698278665543, 0.09188146144151688, 0.09352321922779083, 0.10261949151754379, 0.09323912113904953, 0.041163600981235504, 0.09965673089027405, 0.09568633884191513], [0.0901399552822113, 0.10406017303466797, 0.08971667289733887, 0.10357151180505753, 0.09108434617519379, 0.09361467510461807, 0.1080714762210846, 0.09317506849765778, 0.026297977194190025, 0.10328234732151031, 0.09698579460382462]]], "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 3.673439778140164e-06, "vf_explained_var": -0.0012335777282714844, "total_loss": 0.2779752314090729, "policy_loss": -9.635451715439558e-05, "num_module_steps_trained_lifetime": 53865, "use_intrinsic_rewards": 0.0, "num_module_steps_trained": 5985, "vf_loss": 0.358307808637619, "weights_seq_no": 9.0, "module_train_batch_size_mean": 997.7895308613665, "curr_kl_coeff": 0.00031559361377730966, "curr_entropy_coeff": 0.0015431216992, "entropy": 0.692431628704071, "vf_loss_unclipped": 44.26295852661133, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 759.7688728476408}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"module_train_batch_size_mean": 997.5168494263723, "total_loss": 0.0, "num_module_steps_trained_lifetime": 323190, "diff_num_grad_updates_vs_sampler_policy": 46.0, "num_module_steps_trained": 35910, "weights_seq_no": 54.0}, "default_policy": {"policy_loss": -9.200847125612199e-05, "num_module_steps_trained_lifetime": 323190, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35910, "vf_loss": 0.3583415746688843, "weights_seq_no": 54.0, "module_train_batch_size_mean": 997.5168494263723, "entropy": 0.6924356818199158, "vf_loss_unclipped": 44.386558532714844, "diff_num_grad_updates_vs_sampler_policy": 46.0, "mean_kl_loss": 3.346128551129368e-06, "vf_explained_var": -0.00254058837890625, "total_loss": 0.27800634503364563}, "__all_modules__": {"num_env_steps_trained": 198000, "num_module_steps_trained_lifetime": 646380, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 1782000, "num_env_steps_trained_lifetime_throughput": 51794.844969795435}}}, "intrinsic_reward_module": {"curr_entropy_coeff": 0.0015431216992, "default_optimizer_learning_rate": 0.0002715581955, "module_train_batch_size_mean": 997.7895308613665, "total_loss": 0.0, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 53865, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "weights_seq_no": 9.0, "num_module_steps_trained_lifetime_throughput": 759.7811852765994}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 297000, "num_env_steps_trained": 33000, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 107730, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 4190.675185302824, "num_module_steps_trained_throughput": 25730076.75871889, "num_module_steps_trained_lifetime_throughput": 14488404.296123076}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 180, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -0.8}, "episode_len_min": 20, "weights_seq_no": 9.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7267589650074768e-06, "numpy_to_tensor": 1.1814468281438556e-05, "add_observations_from_episodes_to_batch": 2.759302432393102e-06, "add_time_dim_to_batch_and_zero_pad": 6.7055881546567e-06, "batch_individual_items": 1.2169065347152107e-05}}, "connector_pipeline_timer": 5.797514234007709e-05}, "num_env_steps_sampled": 400, "env_reset_timer": 0.0001994667864479342, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1892829120581105e-05, "get_actions": 3.538123110962077e-05, "listify_data_for_vector_env": 1.0346204404358898e-05, "un_batch_to_individual_items": 6.379273322817983e-06, "tensor_to_numpy": 1.4751811835538155e-05, "normalize_and_clip_actions": 7.951308262263496e-06}}, "connector_pipeline_timer": 0.00011274681084058198}, "episode_len_max": 20, "env_step_timer": 1.3820718188210437e-05, "rlmodule_inference_timer": 2.9989854156149487e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": -0.8}, "episode_len_mean": 20.0, "episode_return_min": -14.5, "episode_return_mean": -0.8, "num_env_steps_sampled_lifetime": 45400, "sample": 0.11662408194842565, "episode_duration_sec_mean": 0.005249089584685862, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "episode_return_max": 14.5, "time_between_sampling": 9.6327604547987}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "aec1c_00000", "date": "2025-08-11_18-40-39", "timestamp": 1754930439, "time_this_iter_s": 9.630254983901978, "time_total_s": 89.67103576660156, "pid": 11610, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3842f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 89.67103576660156, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 34.09285714285714, "ram_util_percent": 78.17142857142856}}
{"timers": {"training_iteration": 9.845922455124285, "restore_env_runners": 8.623879248253913e-06, "training_step": 9.845753286933471, "env_runner_sampling_timer": 1.6292425482081903, "learner_update_timer": 8.037613656596559, "synch_weights": 0.0011044767600709368, "restore_eval_env_runners": 2.1155282775435988e-05, "evaluation_iteration": 0.12347181871402736, "synch_eval_env_connectors": 0.00016284984405470779, "synch_env_connectors": 5.437054461684661e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.7984081419340937e-05, "normalize_and_clip_actions": 9.023941396478866e-06, "get_actions": 4.8034222077181956e-05, "un_batch_to_individual_items": 7.197026822519426e-06, "remove_single_ts_time_rank_from_batch": 1.414575410067069e-05, "listify_data_for_vector_env": 1.2364024249663808e-05}}, "connector_pipeline_timer": 0.00013825264081475768}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.689932552978355e-06, "numpy_to_tensor": 1.5372732378077676e-05, "add_states_from_episodes_to_batch": 2.970614732958622e-06, "add_observations_from_episodes_to_batch": 3.120737919425683e-06, "batch_individual_items": 1.3598153040586054e-05}}, "connector_pipeline_timer": 6.686264755313713e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "rlmodule_inference_timer": 3.713409665447025e-05, "episode_len_mean": 20.0, "episode_return_min": -11.5, "weights_seq_no": 9.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_mean": -1.8199999999999996, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime": -4930000.0, "num_env_steps_sampled": 5000.0, "sample": 0.006329533864988519, "env_reset_timer": 4.878738805698805e-05, "episode_duration_sec_mean": 0.006215952677186579, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -246500.0, "time_between_sampling": 0.033038718499398045, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": -1.8199999999999996}, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.6250555311263063e-05, "module_episode_returns_mean": {"default_policy": -1.8199999999999996}, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 2996.8070974364114}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1405415003402529, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008914394022140806, "add_observations_from_episodes_to_batch": 0.0008295891689175518, "add_columns_from_episodes_to_train_batch": 0.04154407863279787, "add_time_dim_to_batch_and_zero_pad": 0.07571705970848941, "add_states_from_episodes_to_batch": 0.003546885457981491, "batch_individual_items": 0.009791613136058096, "numpy_to_tensor": 7.112795991072697e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"IntrinsicAttentionMask": [[[0.07158119976520538, 0.07368592172861099, 0.07758001983165741, 0.10161632299423218, 0.07981762290000916, 0.08096051216125488, 0.079114630818367, 0.10362640768289566, 0.109102763235569, 0.1106649786233902, 0.11224956810474396], [0.07242123037576675, 0.07445105910301208, 0.078199602663517, 0.10116058588027954, 0.0803496241569519, 0.08144669979810715, 0.07967445999383926, 0.10306848585605621, 0.10825788974761963, 0.10973601788282394, 0.11123432964086533], [0.0739271342754364, 0.07581885904073715, 0.07930079847574234, 0.10034046322107315, 0.08129139244556427, 0.08230534940958023, 0.08066679537296295, 0.10206886380910873, 0.10675632208585739, 0.10808791220188141, 0.10943610221147537], [0.08208363503217697, 0.08314249664545059, 0.08505798876285553, 0.09584245830774307, 0.08613446354866028, 0.08667780458927155, 0.08579810708761215, 0.09667640924453735, 0.09890370070934296, 0.09952758997678757, 0.10015540570020676], [0.07476573437452316, 0.07657840847969055, 0.07990876585245132, 0.099882110953331, 0.08180926740169525, 0.08277639746665955, 0.08121319115161896, 0.10151258856058121, 0.10592731088399887, 0.10717956721782684, 0.1084466278553009], [0.07518692314624786, 0.07695931941270828, 0.08021270483732224, 0.0996515080332756, 0.08206760883331299, 0.08301109075546265, 0.08148596435785294, 0.1012333333492279, 0.10551287978887558, 0.10672589391469955, 0.10795284807682037], [0.0745042935013771, 0.07634176313877106, 0.07971962541341782, 0.10002511739730835, 0.0816483125090599, 0.08263008296489716, 0.0810433179140091, 0.10168597847223282, 0.10618521273136139, 0.10746202617883682, 0.10875419527292252], [0.08269214630126953, 0.08368321508169174, 0.08547381311655045, 0.09550394117832184, 0.08647885173559189, 0.08698578923940659, 0.08616490662097931, 0.09627612680196762, 0.09833617508411407, 0.09891262650489807, 0.09949245303869247], [0.08430216461420059, 0.08511011302471161, 0.0865650400519371, 0.09460681676864624, 0.08737900108098984, 0.08778885006904602, 0.08712494373321533, 0.09521874040365219, 0.09684646874666214, 0.09730072319507599, 0.09775710850954056], [0.08474921435117722, 0.08550535142421722, 0.08686573803424835, 0.09435737878084183, 0.08762612193822861, 0.0880088061094284, 0.08738885074853897, 0.09492559731006622, 0.09643585979938507, 0.09685701876878738, 0.09728001803159714], [0.08519735932350159, 0.08590114116668701, 0.0871661826968193, 0.09410718083381653, 0.08787263929843903, 0.0882280096411705, 0.08765223622322083, 0.09463194012641907, 0.09602555632591248, 0.09641390293836594, 0.09680381417274475]], [[0.08577723056077957, 0.10674876719713211, 0.0877767875790596, 0.11258790642023087, 0.08982295542955399, 0.09086386114358902, 0.1130790114402771, 0.09583409130573273, 0.013137901201844215, 0.1055358499288559, 0.09883560985326767], [0.0902349129319191, 0.10000226646661758, 0.0912172794342041, 0.10253635048866272, 0.09221033751964569, 0.09271091222763062, 0.10274627059698105, 0.09506023675203323, 0.03736688569188118, 0.0994667336344719, 0.09644778817892075], [0.08633798360824585, 0.1061420738697052, 0.0882369801402092, 0.11161555349826813, 0.0901777446269989, 0.09116408228874207, 0.11207517236471176, 0.09586518257856369, 0.014684679917991161, 0.10500304400920868, 0.09869752824306488], [0.09086288511753082, 0.09789508581161499, 0.09157928824424744, 0.09968814998865128, 0.09230134636163712, 0.09266451001167297, 0.09983614087104797, 0.09436178207397461, 0.04793738201260567, 0.0975145623087883, 0.09535880386829376], [0.0868837833404541, 0.105516217648983, 0.08868058025836945, 0.11062789708375931, 0.09051454067230225, 0.091445691883564, 0.11105644702911377, 0.09587572515010834, 0.016410043463110924, 0.10445054620504379, 0.09853852540254593], [0.08715040236711502, 0.1051955372095108, 0.08889549225568771, 0.1101277768611908, 0.09067553281784058, 0.09157887101173401, 0.1105409562587738, 0.0958726778626442, 0.017345814034342766, 0.10416633635759354, 0.09845056384801865], [0.09090222418308258, 0.09771175682544708, 0.09159667044878006, 0.09944558143615723, 0.09229642897844315, 0.09264831244945526, 0.09958864003419876, 0.0942922905087471, 0.048916805535554886, 0.09734367579221725, 0.09525758773088455], [0.08831837028265, 0.10363777726888657, 0.0898192897439003, 0.10775373131036758, 0.09134574234485626, 0.09211865812540054, 0.10809725522994995, 0.09577713161706924, 0.022395042702555656, 0.10277529805898666, 0.09796172380447388], [0.04077576473355293, 0.13719910383224487, 0.04633597284555435, 0.18435531854629517, 0.05265437811613083, 0.05612967535853386, 0.18886074423789978, 0.07542181760072708, 1.2306987855481566e-06, 0.12877172231674194, 0.0894942358136177], [0.09006842970848083, 0.10042426735162735, 0.09110710769891739, 0.10312103480100632, 0.0921577662229538, 0.09268762916326523, 0.10334461182355881, 0.09517664462327957, 0.035409264266490936, 0.09985486418008804, 0.09664841741323471], [0.08893685042858124, 0.10267124325037003, 0.09029264748096466, 0.10632473975419998, 0.09166910499334335, 0.09236518293619156, 0.10662901401519775, 0.09565193951129913, 0.025947006419301033, 0.10190381854772568, 0.09760843217372894]], [[0.07265517115592957, 0.07479147613048553, 0.07874400168657303, 0.09936651587486267, 0.08101517707109451, 0.07916805148124695, 0.08030163496732712, 0.10518115013837814, 0.10668721050024033, 0.11232532560825348, 0.10976433753967285], [0.07345309853553772, 0.0755118578672409, 0.07931380718946457, 0.09901738911867142, 0.08149446547031403, 0.07972117513418198, 0.08080967515707016, 0.1045370027422905, 0.10596431791782379, 0.111299529671669, 0.10887769609689713], [0.07488232851028442, 0.07679849863052368, 0.0803254246711731, 0.09838630259037018, 0.0823417454957962, 0.08070245385169983, 0.08170907199382782, 0.10338764637708664, 0.104677215218544, 0.10948445647954941, 0.10730479657649994], [0.08151134103536606, 0.08270493149757385, 0.08486931025981903, 0.09537339210510254, 0.08608853816986084, 0.0850982740521431, 0.08570734411478043, 0.09813333302736282, 0.09883571416139603, 0.10142222791910172, 0.1002555787563324], [0.07567759603261948, 0.07751236855983734, 0.08088333904743195, 0.09803210198879242, 0.0828070193529129, 0.08124323189258575, 0.08220367133617401, 0.10275062918663025, 0.10396532714366913, 0.10848671942949295, 0.10643798112869263], [0.07503221929073334, 0.07693315297365189, 0.08043085038661957, 0.09831970930099487, 0.08242977410554886, 0.08080466836690903, 0.0818026065826416, 0.10326746106147766, 0.1045428141951561, 0.10929576307535172, 0.10714098811149597], [0.07542971521615982, 0.07729001343250275, 0.08070982247591019, 0.09814272820949554, 0.08266247063875198, 0.08107506483793259, 0.08204995095729828, 0.10294898599386215, 0.10418688505887985, 0.10879678279161453, 0.10670752823352814], [0.08317326754331589, 0.08417010307312012, 0.08597111701965332, 0.09459854662418365, 0.08698200434446335, 0.08616115152835846, 0.08666622638702393, 0.09683627635240555, 0.09740393608808517, 0.09948811680078506, 0.0985492467880249], [0.08359117805957794, 0.0845375657081604, 0.08624587208032608, 0.09440261125564575, 0.08720385283231735, 0.08642600476741791, 0.08690466731786728, 0.09651142358779907, 0.09704594314098358, 0.0990070179104805, 0.09812389314174652], [0.08511291444301605, 0.08587229996919632, 0.08723852783441544, 0.09368561953306198, 0.08800218254327774, 0.0873822569847107, 0.08776388317346573, 0.09533296525478363, 0.09574931859970093, 0.09727268666028976, 0.09658746421337128], [0.08442985266447067, 0.08527381718158722, 0.08679445832967758, 0.09400811791419983, 0.08764566481113434, 0.08695460110902786, 0.08737995475530624, 0.09586106240749359, 0.09632997214794159, 0.09804777801036835, 0.09727469831705093]], [[0.08830603957176208, 0.10516349226236343, 0.09021219611167908, 0.11048422753810883, 0.09215949475765228, 0.0931488573551178, 0.11093079298734665, 0.09253200143575668, 0.015088717453181744, 0.10405563563108444, 0.0979185476899147], [0.09116967022418976, 0.09961392730474472, 0.09216220676898956, 0.10213816910982132, 0.0931655541062355, 0.09367132186889648, 0.10234727710485458, 0.09335628896951675, 0.03722180426120758, 0.09908047318458557, 0.09607325494289398], [0.08874503523111343, 0.10457944124937057, 0.09054406732320786, 0.1095443144440651, 0.09237956255674362, 0.09331122785806656, 0.10996035486459732, 0.09273041039705276, 0.016867363825440407, 0.10354379564523697, 0.09779449552297592], [0.09154371172189713, 0.0976182371377945, 0.09226549416780472, 0.09940624237060547, 0.09299296140670776, 0.0933588445186615, 0.09955380856990814, 0.09313100576400757, 0.04780183732509613, 0.09723879396915436, 0.0950891301035881], [0.089165098965168, 0.10397400707006454, 0.09085564315319061, 0.10858669131994247, 0.0925782322883606, 0.09345174580812454, 0.10897260159254074, 0.09290724992752075, 0.018851209431886673, 0.10301008075475693, 0.09764746576547623], [0.08936727792024612, 0.1036626398563385, 0.09100307524204254, 0.10810061544179916, 0.092668816447258, 0.09351308643817902, 0.10847161710262299, 0.09298685193061829, 0.019927075132727623, 0.10273437201976776, 0.09756465256214142], [0.09156213700771332, 0.09744391590356827, 0.09226163476705551, 0.09917299449443817, 0.0929664671421051, 0.09332090616226196, 0.09931565821170807, 0.09310019761323929, 0.04878273978829384, 0.09707684814929962, 0.09499648213386536], [0.0892421081662178, 0.10385707020759583, 0.09091201424598694, 0.10840365290641785, 0.09261316061019897, 0.09347563236951828, 0.10878391563892365, 0.09293802827596664, 0.019250784069299698, 0.10290663689374924, 0.09761693328619003], [0.047081075608730316, 0.13396956026554108, 0.05350106209516525, 0.1800156980752945, 0.060796502977609634, 0.06480919569730759, 0.1844150722026825, 0.06228229030966759, 1.201764348479628e-06, 0.1257406324148178, 0.08738771826028824], [0.09105716645717621, 0.10001180320978165, 0.09210725128650665, 0.10269749164581299, 0.0931694358587265, 0.09370512515306473, 0.10292015224695206, 0.0933714434504509, 0.03526388481259346, 0.09944474697113037, 0.0962514579296112], [0.0902315005660057, 0.10211989283561707, 0.09160701930522919, 0.10575375705957413, 0.0930035188794136, 0.09370973706245422, 0.10605639964342117, 0.09326967597007751, 0.025807712227106094, 0.10135658085346222, 0.09708426147699356]], [[0.07285461574792862, 0.07499677687883377, 0.076070636510849, 0.09963922947645187, 0.07826470583677292, 0.07938535511493683, 0.08358065038919449, 0.10546980798244476, 0.10698000341653824, 0.10851182788610458, 0.11424636840820312], [0.07364750653505325, 0.07571171224117279, 0.07674545794725418, 0.09927940368652344, 0.078855499625206, 0.07993216812610626, 0.08395668119192123, 0.10481362044811249, 0.10624472051858902, 0.10769536346197128, 0.11311772465705872], [0.074038065969944, 0.07606332004070282, 0.07707706838846207, 0.0991012379527092, 0.07914528250694275, 0.08020010590553284, 0.08413998782634735, 0.10449095815420151, 0.10588357597589493, 0.10729476809501648, 0.11256569623947144], [0.08163674175739288, 0.08283217251300812, 0.08342503756284714, 0.09552010893821716, 0.08462350815534592, 0.08522918820381165, 0.08745963126420975, 0.09828430414199829, 0.09898775815963745, 0.09969624131917953, 0.10230528563261032], [0.07482219487428665, 0.07676813751459122, 0.07774123549461365, 0.09874159842729568, 0.07972459495067596, 0.08073516935110092, 0.0845041498541832, 0.10384413599967957, 0.10516044497489929, 0.10649344325065613, 0.11146489530801773], [0.07521576434373856, 0.07712133973836899, 0.07807379215955734, 0.09856016933917999, 0.08001413941383362, 0.08100231736898422, 0.08468501269817352, 0.10352002084255219, 0.10479849576950073, 0.10609276592731476, 0.11091617494821548], [0.07664962857961655, 0.07840505987405777, 0.07928092032670975, 0.09789411723613739, 0.08106210082769394, 0.08196764439344406, 0.08533323556184769, 0.10234224796295166, 0.10348550230264664, 0.10464153438806534, 0.10893812030553818], [0.08328013122081757, 0.08427824825048447, 0.08477228879928589, 0.09472008049488068, 0.08576907962560654, 0.08627185970544815, 0.08811784535646439, 0.09696068614721298, 0.09752907603979111, 0.09810078889131546, 0.10019988566637039], [0.08369314670562744, 0.08464068174362183, 0.08510945737361908, 0.09451775252819061, 0.08605481684207916, 0.08653143048286438, 0.08828002959489822, 0.09662914276123047, 0.09716431796550751, 0.09770245850086212, 0.09967679530382156], [0.08410699665546417, 0.08500345796346664, 0.08544675260782242, 0.09431451559066772, 0.0863402783870697, 0.0867905467748642, 0.08844124525785446, 0.09629735350608826, 0.09679953753948212, 0.0973043441772461, 0.0991550162434578], [0.08561306446790695, 0.08632028102874756, 0.08666937053203583, 0.09357080608606339, 0.08737180382013321, 0.08772514760494232, 0.08901705592870712, 0.09509367495775223, 0.09547825157642365, 0.09586437791585922, 0.09727615118026733]], [[0.0521869994699955, 0.06351011991500854, 0.05474278703331947, 0.06483769416809082, 0.05439157411456108, 0.05495712161064148, 0.06688128411769867, 0.05610591545701027, 0.41073140501976013, 0.06459031999111176, 0.057064808905124664], [0.07795265316963196, 0.08448043465614319, 0.07949406653642654, 0.08519922941923141, 0.07928480207920074, 0.07962138205766678, 0.08628890663385391, 0.08029882609844208, 0.1814557909965515, 0.08506595343351364, 0.08085804432630539], [0.05902769789099693, 0.06983540207147598, 0.061494339257478714, 0.07108346372842789, 0.06115637347102165, 0.06170043349266052, 0.07299749553203583, 0.06280311197042465, 0.34532952308654785, 0.07085118442773819, 0.06372102349996567], [0.0801958367228508, 0.08585625141859055, 0.08153872936964035, 0.08647538721561432, 0.08135664463043213, 0.08164945989847183, 0.08741247653961182, 0.08223826438188553, 0.1641925722360611, 0.08636065572500229, 0.08272373676300049], [0.058118510991334915, 0.0690215602517128, 0.06060321629047394, 0.07028321921825409, 0.06026264280080795, 0.06081091985106468, 0.07221907377243042, 0.06192249432206154, 0.3538617789745331, 0.07004837691783905, 0.06284813582897186], [0.05957726389169693, 0.070323146879673, 0.06203201040625572, 0.07156252861022949, 0.061695750802755356, 0.06223704665899277, 0.07346267253160477, 0.0633339136838913, 0.34019702672958374, 0.07133188098669052, 0.06424679607152939], [0.08336862921714783, 0.08763246238231659, 0.08438730984926224, 0.08809418976306915, 0.08424945175647736, 0.08447111397981644, 0.08879133313894272, 0.08491616696119308, 0.14079813659191132, 0.08800868690013885, 0.08528248965740204], [0.062452442944049835, 0.07282190024852753, 0.06483253836631775, 0.07401001453399658, 0.06450692564249039, 0.0650310218334198, 0.07582861930131912, 0.06609201431274414, 0.31366145610809326, 0.07378902286291122, 0.06697400659322739], [0.16800691187381744, 0.060471683740615845, 0.131000816822052, 0.05429982766509056, 0.13546277582645416, 0.1283639669418335, 0.04620277136564255, 0.11526292562484741, 3.654525926322094e-06, 0.05539076775312424, 0.1055338978767395], [0.07978911697864532, 0.08561384677886963, 0.08116978406906128, 0.08625173568725586, 0.08098253607749939, 0.08128368109464645, 0.08721750974655151, 0.081889308989048, 0.16728012263774872, 0.08613351732492447, 0.08238876610994339], [0.06475800275802612, 0.07475845515727997, 0.0670623704791069, 0.07589811086654663, 0.06674744188785553, 0.06725428998470306, 0.07764024287462234, 0.06827953457832336, 0.29278436303138733, 0.07568622380495071, 0.06913099437952042]]], "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 1.4496661606244743e-05, "vf_explained_var": -0.0013909339904785156, "total_loss": 0.2781689763069153, "policy_loss": 9.838271216722205e-05, "num_module_steps_trained_lifetime": 59850, "use_intrinsic_rewards": 0.0, "num_module_steps_trained": 5985, "vf_loss": 0.35830584168434143, "weights_seq_no": 10.0, "module_train_batch_size_mean": 997.772440523815, "curr_kl_coeff": 0.00015779680688865483, "curr_entropy_coeff": 0.0015431216992, "entropy": 0.6920852065086365, "vf_loss_unclipped": 42.63201904296875, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 756.7918907906102}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"module_train_batch_size_mean": 997.5109713823833, "total_loss": 0.0, "num_module_steps_trained_lifetime": 359100, "diff_num_grad_updates_vs_sampler_policy": 51.0, "num_module_steps_trained": 35910, "weights_seq_no": 60.0}, "default_policy": {"policy_loss": 0.00010001320333685726, "num_module_steps_trained_lifetime": 359100, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35910, "vf_loss": 0.3583327531814575, "weights_seq_no": 60.0, "module_train_batch_size_mean": 997.5109713823833, "entropy": 0.6920803785324097, "vf_loss_unclipped": 42.701934814453125, "diff_num_grad_updates_vs_sampler_policy": 51.0, "mean_kl_loss": 1.507769320596708e-05, "vf_explained_var": -0.0025589466094970703, "total_loss": 0.27819395065307617}, "__all_modules__": {"num_env_steps_trained": 198000, "num_module_steps_trained_lifetime": 718200, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 1980000, "num_env_steps_trained_lifetime_throughput": 50868.258385960435}}}, "intrinsic_reward_module": {"curr_entropy_coeff": 0.0015431216992, "default_optimizer_learning_rate": 0.0002715581955, "module_train_batch_size_mean": 997.772440523815, "total_loss": 0.0, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 59850, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "weights_seq_no": 10.0, "num_module_steps_trained_lifetime_throughput": 756.8035699560751}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 330000, "num_env_steps_trained": 33000, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 119700, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 4174.205160583302, "num_module_steps_trained_throughput": 25045077.785656653, "num_module_steps_trained_lifetime_throughput": 14379647.852087367}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 200, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -1.0}, "episode_len_min": 20, "weights_seq_no": 10.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7665918743730704e-06, "numpy_to_tensor": 1.2039653834565888e-05, "add_observations_from_episodes_to_batch": 2.8334278345781006e-06, "add_time_dim_to_batch_and_zero_pad": 6.946937729820144e-06, "batch_individual_items": 1.2418270643295847e-05}}, "connector_pipeline_timer": 5.905340208714887e-05}, "num_env_steps_sampled": 400, "env_reset_timer": 0.0002007025285129837, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2024472520507331e-05, "get_actions": 3.580635033817989e-05, "listify_data_for_vector_env": 1.0394279153154213e-05, "un_batch_to_individual_items": 6.454931102574397e-06, "tensor_to_numpy": 1.50755552237778e-05, "normalize_and_clip_actions": 8.007716819162192e-06}}, "connector_pipeline_timer": 0.00011400385695156528}, "episode_len_max": 20, "env_step_timer": 1.3858548780067269e-05, "rlmodule_inference_timer": 3.083426153460764e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": -1.0}, "episode_len_mean": 20.0, "episode_return_min": -14.5, "episode_return_mean": -1.0, "num_env_steps_sampled_lifetime": 50400, "sample": 0.11660753654794931, "episode_duration_sec_mean": 0.005260006666649133, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "episode_return_max": 14.5, "time_between_sampling": 9.634742631500558}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "aec1c_00000", "date": "2025-08-11_18-40-49", "timestamp": 1754930449, "time_this_iter_s": 9.930001974105835, "time_total_s": 99.6010377407074, "pid": 11610, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3842f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 99.6010377407074, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 37.28571428571428, "ram_util_percent": 78.83571428571429}}
{"timers": {"training_iteration": 9.840199410163034, "restore_env_runners": 8.597229966554926e-06, "training_step": 9.840029729483678, "env_runner_sampling_timer": 1.628463978146394, "learner_update_timer": 8.031792609200473, "synch_weights": 0.001100829912596323, "restore_eval_env_runners": 2.102247909213146e-05, "evaluation_iteration": 0.12347099760683357, "synch_eval_env_connectors": 0.00016250301544320147, "synch_env_connectors": 5.42352474027114e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5721685725649844e-05, "normalize_and_clip_actions": 8.09226096743296e-06, "get_actions": 4.063821085789618e-05, "un_batch_to_individual_items": 6.5567398262049495e-06, "remove_single_ts_time_rank_from_batch": 1.1902600297272486e-05, "listify_data_for_vector_env": 1.0661611808591514e-05}}, "connector_pipeline_timer": 0.00012061801792236765}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.019621622743639e-06, "numpy_to_tensor": 1.2585699120343e-05, "add_states_from_episodes_to_batch": 2.7116983915738187e-06, "add_observations_from_episodes_to_batch": 2.7940800387160324e-06, "batch_individual_items": 1.2547570276353069e-05}}, "connector_pipeline_timer": 5.9946130563702047e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "rlmodule_inference_timer": 3.2775897622084616e-05, "episode_len_mean": 20.0, "episode_return_min": -11.5, "weights_seq_no": 10.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_mean": -1.0999999999999996, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime": -5547500.0, "num_env_steps_sampled": 5000.0, "sample": 0.006018600575918434, "env_reset_timer": 4.461666059425641e-05, "episode_duration_sec_mean": 0.005338882145937533, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -277375.0, "time_between_sampling": 0.03309414740023918, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": -1.0999999999999996}, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.3906206549530142e-05, "module_episode_returns_mean": {"default_policy": -1.0999999999999996}, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 3192.2052787436855}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1413259982469579, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008914649661366162, "add_observations_from_episodes_to_batch": 0.0008305574478862196, "add_columns_from_episodes_to_train_batch": 0.04154435950555281, "add_time_dim_to_batch_and_zero_pad": 0.07570838869206349, "add_states_from_episodes_to_batch": 0.0035475341042600574, "batch_individual_items": 0.010582939504531442, "numpy_to_tensor": 7.103917981295234e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"IntrinsicAttentionMask": [[[0.07214679569005966, 0.07619203627109528, 0.07435304671525955, 0.09896178543567657, 0.07971355319023132, 0.07778956741094589, 0.08215119689702988, 0.10934089869260788, 0.1067018210887909, 0.11268454790115356, 0.1099647581577301], [0.07352655380964279, 0.07732205837965012, 0.0755985751748085, 0.09841791540384293, 0.08061346411705017, 0.07881661504507065, 0.08288520574569702, 0.10790400207042694, 0.10549886524677277, 0.11094480752944946, 0.10847189277410507], [0.0729069858789444, 0.07681559771299362, 0.07503984123468399, 0.09866328537464142, 0.08021093904972076, 0.07835669815540314, 0.08255747705698013, 0.10854754596948624, 0.10603825002908707, 0.11172305792570114, 0.10914035141468048], [0.08031731843948364, 0.08277156949043274, 0.08166328072547913, 0.09561700373888016, 0.0848609060049057, 0.08372464030981064, 0.08628302067518234, 0.10102610290050507, 0.09967339783906937, 0.10271911323070526, 0.10134373605251312], [0.07467925548553467, 0.07826016843318939, 0.0766356885433197, 0.09795662760734558, 0.08135558664798737, 0.0796668529510498, 0.08348692208528519, 0.10671395808458328, 0.10449884831905365, 0.10950962454080582, 0.10723648220300674], [0.07405483722686768, 0.07775265723466873, 0.0760742723941803, 0.09820728003978729, 0.0809546709060669, 0.0792071595788002, 0.08316226303577423, 0.1073574498295784, 0.10503999888896942, 0.11028503626585007, 0.10790439695119858], [0.07545265555381775, 0.07888656109571457, 0.07732976227998734, 0.09764371067285538, 0.08184859901666641, 0.08023334294557571, 0.0838848277926445, 0.10592074692249298, 0.10383042693138123, 0.10855583846569061, 0.10641352087259293], [0.08298058062791824, 0.08485876768827438, 0.08401241153478622, 0.09446822851896286, 0.08644646406173706, 0.08558427542448044, 0.08752138912677765, 0.09841392189264297, 0.09743237495422363, 0.09963766485452652, 0.09864390641450882], [0.08232462406158447, 0.08434727042913437, 0.08343534916639328, 0.09475355595350266, 0.0860600546002388, 0.08512960374355316, 0.0872211754322052, 0.09905293583869934, 0.0979820191860199, 0.10038936883211136, 0.09930399805307388], [0.08379238098859787, 0.08548944443464279, 0.08472520112991333, 0.09411303699016571, 0.08692098408937454, 0.08614394068717957, 0.08788863569498062, 0.09762699156999588, 0.09675423055887222, 0.09871382266283035, 0.0978313535451889], [0.08313365280628204, 0.084977887570858, 0.08414693921804428, 0.09440143406391144, 0.08653625845909119, 0.08569005876779556, 0.0875910073518753, 0.09826521575450897, 0.0973043292760849, 0.09946292638778687, 0.09849032759666443]], [[0.0877840667963028, 0.10751038044691086, 0.08967895060777664, 0.10679841786623001, 0.0916147381067276, 0.09259825199842453, 0.11027500033378601, 0.09459705650806427, 0.015425560064613819, 0.10637782514095306, 0.09733971208333969], [0.09115774929523468, 0.09941983222961426, 0.09199479967355728, 0.09913750737905502, 0.09283953905105591, 0.09326481074094772, 0.10050612688064575, 0.09412121772766113, 0.04330854490399361, 0.09897021949291229, 0.09527964890003204], [0.08824853599071503, 0.10676699876785278, 0.09003749489784241, 0.10610243678092957, 0.09186272323131561, 0.0927891656756401, 0.10934507846832275, 0.09467018395662308, 0.017220310866832733, 0.10570972412824631, 0.09724732488393784], [0.09109728038311005, 0.09973219782114029, 0.09197059273719788, 0.09943659603595734, 0.09285227954387665, 0.09329628944396973, 0.10086990892887115, 0.09419068694114685, 0.04189159721136093, 0.09926145523786545, 0.09540107846260071], [0.08869456499814987, 0.1060037910938263, 0.09037617594003677, 0.1053861677646637, 0.0920896828174591, 0.09295858442783356, 0.1083974614739418, 0.09472104907035828, 0.019219353795051575, 0.10502107441425323, 0.0971321314573288], [0.08890990167856216, 0.10561411082744598, 0.09053732454776764, 0.10501977801322937, 0.09219453483819962, 0.09303448349237442, 0.10791639238595963, 0.09473741054534912, 0.020302342250943184, 0.10466840118169785, 0.09706529229879379], [0.09134393185377121, 0.09818654507398605, 0.09204176068305969, 0.09795433282852173, 0.09274491667747498, 0.09309850633144379, 0.09907896816730499, 0.09380973875522614, 0.049154553562402725, 0.09781669080257416, 0.09477008134126663], [0.08932360261678696, 0.10481728613376617, 0.0908416137099266, 0.10426918417215347, 0.0923854261636734, 0.09316714107990265, 0.1069384515285492, 0.09475047141313553, 0.02265012264251709, 0.10394502431154251, 0.09691162407398224], [0.046209223568439484, 0.15300941467285156, 0.052421774715185165, 0.14712078869342804, 0.05946958065032959, 0.06334122270345688, 0.17776605486869812, 0.07185709476470947, 1.6002222764655016e-06, 0.14373145997524261, 0.08507178723812103], [0.09105920791625977, 0.0999157726764679, 0.09195401519536972, 0.09961225837469101, 0.09285762161016464, 0.09331274777650833, 0.1010841503739357, 0.09422970563173294, 0.041071150451898575, 0.09943243861198425, 0.09547097980976105], [0.08983755856752396, 0.10371098667383194, 0.09120707213878632, 0.10322396457195282, 0.09259747713804245, 0.09330060333013535, 0.10559332370758057, 0.0947229191660881, 0.026209916919469833, 0.1029358059167862, 0.09666037559509277]], [[0.07236030697822571, 0.07345836609601974, 0.0745730847120285, 0.09925460815429688, 0.07994944602251053, 0.07801976799964905, 0.0823943018913269, 0.1096644327044487, 0.10701753944158554, 0.1130179688334465, 0.11029013246297836], [0.07273737341165543, 0.07381739467382431, 0.07491346448659897, 0.0991005077958107, 0.08019500970840454, 0.07830026000738144, 0.08259420841932297, 0.10926111787557602, 0.10667963325977325, 0.11252988874912262, 0.10987116396427155], [0.07311537861824036, 0.07417713850736618, 0.07525432854890823, 0.0989452451467514, 0.08044019341468811, 0.07858065515756607, 0.08279343694448471, 0.10885775834321976, 0.10634128004312515, 0.11204233765602112, 0.1094522476196289], [0.08046086132526398, 0.08113224804401398, 0.08180923014879227, 0.0957878828048706, 0.08501257002353668, 0.08387427777051926, 0.08643722534179688, 0.10120666027069092, 0.09985151886940002, 0.10290268808603287, 0.10152485221624374], [0.0748746246099472, 0.07584906369447708, 0.07683617621660233, 0.09821286797523499, 0.08156841993331909, 0.07987526804208755, 0.08370533585548401, 0.10699309408664703, 0.104772187769413, 0.10979607701301575, 0.10751698166131973], [0.07425494492053986, 0.07526058703660965, 0.07627985626459122, 0.09847263991832733, 0.08117342740297318, 0.07942119985818863, 0.08338698744773865, 0.10764752328395844, 0.10532381385564804, 0.11058302223682404, 0.1081959530711174], [0.07564186304807663, 0.07657698541879654, 0.07752367854118347, 0.0978885367512703, 0.08205384016036987, 0.08043453842401505, 0.08409517258405685, 0.10618631541728973, 0.10409075766801834, 0.10882801562547684, 0.10668032616376877], [0.08309391140937805, 0.08360894024372101, 0.08412715792655945, 0.09459725022315979, 0.08656452596187592, 0.08570116013288498, 0.08764093369245529, 0.09854833036661148, 0.09756544232368469, 0.09977374225854874, 0.0987786278128624], [0.08244575560092926, 0.0830000713467598, 0.08355811983346939, 0.0948929712176323, 0.08618668466806412, 0.08525486290454865, 0.08734951913356781, 0.09919868409633636, 0.09812618046998978, 0.10053707659244537, 0.09945010393857956], [0.0838957354426384, 0.08436142653226852, 0.08482971042394638, 0.09422911703586578, 0.08702819794416428, 0.0862501934170723, 0.08799704164266586, 0.09774740785360336, 0.09687357395887375, 0.09883558005094528, 0.09795202314853668], [0.08324513584375381, 0.08375091850757599, 0.08425977826118469, 0.09452801942825317, 0.08665229380130768, 0.08580496907234192, 0.08770846575498581, 0.09839697927236557, 0.09743481129407883, 0.0995962992310524, 0.0986223965883255]], [[0.057043928653001785, 0.06831783801317215, 0.058138158172369, 0.06962832063436508, 0.05925338715314865, 0.058347176760435104, 0.07164134830236435, 0.0594664141535759, 0.37008705735206604, 0.06767717003822327, 0.06039918214082718], [0.08128765970468521, 0.08669501543045044, 0.08184107393026352, 0.08728524297475815, 0.08239825814962387, 0.08194602280855179, 0.0881781354546547, 0.08250392228364944, 0.15849712491035461, 0.08640381693840027, 0.0829637423157692], [0.059944186359643936, 0.07091966271400452, 0.061015479266643524, 0.07218709588050842, 0.06210591644048691, 0.0612199604511261, 0.07413084805011749, 0.06231405586004257, 0.3426385521888733, 0.070299431681633, 0.06322479993104935], [0.08332223445177078, 0.08778601139783859, 0.08378161489963531, 0.08826999366283417, 0.0842435210943222, 0.08386866003274918, 0.08900098502635956, 0.08433105051517487, 0.14313717186450958, 0.08754699677228928, 0.0847117081284523], [0.06278758496046066, 0.07338176667690277, 0.06382749229669571, 0.07459713518619537, 0.06488462537527084, 0.06402583420276642, 0.07645805180072784, 0.0650862529873848, 0.31619685888290405, 0.07278644293546677, 0.06596793979406357], [0.06048604100942612, 0.07139579951763153, 0.06155204772949219, 0.07265408337116241, 0.0626368522644043, 0.06175549700856209, 0.07458321005105972, 0.06284387409687042, 0.3375629484653473, 0.0707799419760704, 0.06374967843294144], [0.08618340641260147, 0.08915185183286667, 0.0864914283156395, 0.08947048336267471, 0.08680055290460587, 0.08654973655939102, 0.0899505615234375, 0.08685906231403351, 0.12243545055389404, 0.08899427205324173, 0.08711326867341995], [0.06331713497638702, 0.07383012771606445, 0.0643501728773117, 0.07503469288349152, 0.06540006399154663, 0.06454717367887497, 0.07687847316265106, 0.06560028344392776, 0.31132614612579346, 0.0732400044798851, 0.06647569686174393], [0.1553908884525299, 0.055931009352207184, 0.1395314633846283, 0.05022260174155235, 0.1252906322479248, 0.13672290742397308, 0.04273355007171631, 0.12276874482631683, 3.892711902153678e-06, 0.05899794399738312, 0.11240635812282562], [0.08024001866579056, 0.08609765022993088, 0.08083787560462952, 0.08673915266990662, 0.08144018799066544, 0.08095129579305649, 0.08771037310361862, 0.08155445754528046, 0.16659578680992126, 0.08578130602836609, 0.08205186575651169], [0.06558270752429962, 0.07571051269769669, 0.06658248603343964, 0.07686468213796616, 0.06759749352931976, 0.06677302718162537, 0.07862899452447891, 0.06779094785451889, 0.29068824648857117, 0.07514461874961853, 0.06863629817962646]], [[0.07218746840953827, 0.07623498886823654, 0.0773918554186821, 0.1030062735080719, 0.07975849509239197, 0.07783342152833939, 0.07901452481746674, 0.10940245538949966, 0.1067618876695633, 0.10838198661804199, 0.11002666503190994], [0.07356175035238266, 0.07735906541347504, 0.07844150811433792, 0.10211890190839767, 0.08065204322338104, 0.07885434478521347, 0.07995770871639252, 0.10795556753873825, 0.10554927587509155, 0.10702616721391678, 0.10852372646331787], [0.07394352555274963, 0.07766997069120407, 0.07873143255710602, 0.10187222808599472, 0.08089806884527206, 0.07913617789745331, 0.08021766692399979, 0.10755627602338791, 0.10521379113197327, 0.106651671230793, 0.10810919851064682], [0.08137834072113037, 0.08360911905765533, 0.08423567563295364, 0.09706186503171921, 0.08550291508436203, 0.08447358012199402, 0.08510661870241165, 0.10000421106815338, 0.09880031645298004, 0.09954071044921875, 0.10028665512800217], [0.07471013069152832, 0.07829251885414124, 0.07931143045425415, 0.1013767346739769, 0.08138921856880188, 0.07969977706670761, 0.08073700219392776, 0.1067579910159111, 0.10454196482896805, 0.10590249300003052, 0.10728073120117188], [0.07408800721168518, 0.07778748869895935, 0.07884097099304199, 0.10177885740995407, 0.08099092543125153, 0.07924263924360275, 0.08031582087278366, 0.10740546882152557, 0.10508697479963303, 0.10651017725467682, 0.10795265436172485], [0.07447119057178497, 0.07809873670339584, 0.07913097739219666, 0.10153120011091232, 0.08123654872179031, 0.0795244500041008, 0.08057552576065063, 0.10700631886720657, 0.1047511026263237, 0.10613560676574707, 0.10753840208053589], [0.08298826217651367, 0.08486662805080414, 0.08539263904094696, 0.09602022171020508, 0.08645447343587875, 0.08559219539165497, 0.08612270653247833, 0.09842302650213242, 0.09744138270616531, 0.09804533421993256, 0.09865303337574005], [0.08233360946178436, 0.08435649424791336, 0.084923654794693, 0.09644374251365662, 0.08606945723295212, 0.08513890206813812, 0.08571132272481918, 0.09906374663114548, 0.09799270331859589, 0.09865155816078186, 0.09931483119726181], [0.08273688703775406, 0.08467093855142593, 0.08521279692649841, 0.09618284553289413, 0.08630693703889847, 0.08541838824748993, 0.08596502989530563, 0.09866869449615479, 0.09765288233757019, 0.09827782213687897, 0.0989067554473877], [0.08314105868339539, 0.08498545736074448, 0.08550181239843369, 0.09592141211032867, 0.0865439623594284, 0.08569768816232681, 0.08621837198734283, 0.09827395528554916, 0.09731297940015793, 0.09790424257516861, 0.09849908947944641]], [[0.08822734653949738, 0.10506964474916458, 0.0876430794596672, 0.11038561910390854, 0.09207736700773239, 0.09306584298610687, 0.11083178967237473, 0.09244953095912933, 0.015503525733947754, 0.10691496729850769, 0.09783121943473816], [0.0911104828119278, 0.09954922646284103, 0.0908040702342987, 0.1020718440413475, 0.09310507774353027, 0.09361051023006439, 0.10228081047534943, 0.09329568594694138, 0.03772957995533943, 0.10043187439441681, 0.09601087123155594], [0.08808643370866776, 0.10524600744247437, 0.0874922126531601, 0.11067327857017517, 0.0920039564371109, 0.09301026165485382, 0.11112900823354721, 0.09238281100988388, 0.01498227659612894, 0.10712938755750656, 0.09786437451839447], [0.09149282425642014, 0.09756394475698471, 0.09126954525709152, 0.09935096651315689, 0.0929412692785263, 0.09330695122480392, 0.099498450756073, 0.09307923913002014, 0.04826981574296951, 0.09819062054157257, 0.09503626078367233], [0.08909134566783905, 0.1038878858089447, 0.08857225626707077, 0.10849674046039581, 0.09250165522098541, 0.09337443113327026, 0.10888232290744781, 0.09283038973808289, 0.01930542103946209, 0.10549085587263107, 0.0975666344165802], [0.0892946720123291, 0.10357829928398132, 0.08879217505455017, 0.10801266878843307, 0.09259352087974548, 0.09343710541725159, 0.10838335752487183, 0.09291129559278488, 0.020390290766954422, 0.10512133687734604, 0.09748532623052597], [0.09151211380958557, 0.09739065915346146, 0.09129568189382553, 0.09911879152059555, 0.09291567653417587, 0.09326991438865662, 0.09926138073205948, 0.09304933249950409, 0.049245066940784454, 0.097996786236763, 0.09494456648826599], [0.08916880190372467, 0.1037716493010521, 0.0886559709906578, 0.10831448435783386, 0.09253707528114319, 0.09339883923530579, 0.10869442671537399, 0.09286168217658997, 0.01970844529569149, 0.10535194724798203, 0.09753668308258057], [0.04695160686969757, 0.13176827132701874, 0.045144662261009216, 0.17636851966381073, 0.06042499467730522, 0.06435884535312653, 0.18062110245227814, 0.061881959438323975, 1.6260005395452026e-06, 0.146040141582489, 0.08643832057714462], [0.09127455204725266, 0.09887618571519852, 0.09099728614091873, 0.101136215031147, 0.09307722747325897, 0.09353343397378922, 0.1013231873512268, 0.09324929863214493, 0.04116835445165634, 0.09966758638620377, 0.09569675475358963], [0.09016402065753937, 0.10204344987869263, 0.08974061161279678, 0.10567460209131241, 0.09293397516012192, 0.09363965690135956, 0.10597701370716095, 0.09319992363452911, 0.02630523405969143, 0.10330986231565475, 0.09701161831617355]]], "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 3.6374485716805793e-06, "vf_explained_var": -0.00036203861236572266, "total_loss": 0.2779911160469055, "policy_loss": -8.025285205803812e-05, "num_module_steps_trained_lifetime": 65835, "use_intrinsic_rewards": 0.0, "num_module_steps_trained": 5985, "vf_loss": 0.3583068251609802, "weights_seq_no": 11.0, "module_train_batch_size_mean": 997.7563503102639, "curr_kl_coeff": 7.889840344432741e-05, "curr_entropy_coeff": 0.0015431216992, "entropy": 0.692055344581604, "vf_loss_unclipped": 43.59211349487305, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 754.3449042631794}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"module_train_batch_size_mean": 997.5068778348534, "total_loss": 0.0, "num_module_steps_trained_lifetime": 395010, "diff_num_grad_updates_vs_sampler_policy": 56.0, "num_module_steps_trained": 35910, "weights_seq_no": 66.0}, "default_policy": {"policy_loss": -7.66833545640111e-05, "num_module_steps_trained_lifetime": 395010, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35910, "vf_loss": 0.3583360016345978, "weights_seq_no": 66.0, "module_train_batch_size_mean": 997.5068778348534, "entropy": 0.6920603513717651, "vf_loss_unclipped": 43.728843688964844, "diff_num_grad_updates_vs_sampler_policy": 56.0, "mean_kl_loss": 3.329572336951969e-06, "vf_explained_var": -0.00255584716796875, "total_loss": 0.27801787853240967}, "__all_modules__": {"num_env_steps_trained": 198000, "num_module_steps_trained_lifetime": 790020, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 2178000, "num_env_steps_trained_lifetime_throughput": 49982.82890216419}}}, "intrinsic_reward_module": {"curr_entropy_coeff": 0.0015431216992, "default_optimizer_learning_rate": 0.0002715581955, "module_train_batch_size_mean": 997.7563503102639, "total_loss": 0.0, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 65835, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "weights_seq_no": 11.0, "num_module_steps_trained_lifetime_throughput": 754.3559620618489}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 363000, "num_env_steps_trained": 33000, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 131670, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 4160.658756840413, "num_module_steps_trained_throughput": 24391165.985878613, "num_module_steps_trained_lifetime_throughput": 14272853.002168067}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 220, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -0.6}, "episode_len_min": 20, "weights_seq_no": 11.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.8139671581730198e-06, "numpy_to_tensor": 1.2391095107524944e-05, "add_observations_from_episodes_to_batch": 2.891258669887552e-06, "add_time_dim_to_batch_and_zero_pad": 6.937590267910755e-06, "batch_individual_items": 1.2593822790066866e-05}}, "connector_pipeline_timer": 5.980971939342167e-05}, "num_env_steps_sampled": 400, "env_reset_timer": 0.00019962217384620915, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2065143681187493e-05, "get_actions": 3.766610852128592e-05, "listify_data_for_vector_env": 1.0673925860240554e-05, "un_batch_to_individual_items": 6.5808982619742635e-06, "tensor_to_numpy": 1.6652782093974502e-05, "normalize_and_clip_actions": 8.10888239029864e-06}}, "connector_pipeline_timer": 0.00011925589900968683}, "episode_len_max": 20, "env_step_timer": 1.4579914034580007e-05, "rlmodule_inference_timer": 3.1928114246628166e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": -0.6}, "episode_len_mean": 20.0, "episode_return_min": -14.5, "episode_return_mean": -0.6, "num_env_steps_sampled_lifetime": 55400, "sample": 0.11663373160319433, "episode_duration_sec_mean": 0.005302471660543233, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "episode_return_max": 14.5, "time_between_sampling": 9.63140349768455}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "aec1c_00000", "date": "2025-08-11_18-40-58", "timestamp": 1754930458, "time_this_iter_s": 9.401226043701172, "time_total_s": 109.00226378440857, "pid": 11610, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3842f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 109.00226378440857, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 36.75, "ram_util_percent": 77.52857142857142}}
{"timers": {"training_iteration": 9.838493524811007, "restore_env_runners": 8.575007861275024e-06, "training_step": 9.838322419688833, "env_runner_sampling_timer": 1.6283888162752365, "learner_update_timer": 8.030129301859493, "synch_weights": 0.0011012145337483724, "restore_eval_env_runners": 2.0904754423474174e-05, "evaluation_iteration": 0.12348357263104665, "synch_eval_env_connectors": 0.00016216506610196874, "synch_env_connectors": 5.41428983552063e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.6357712681366446e-05, "normalize_and_clip_actions": 8.358933591968043e-06, "get_actions": 4.2781542771410874e-05, "un_batch_to_individual_items": 6.864377388580245e-06, "remove_single_ts_time_rank_from_batch": 1.2317543635302901e-05, "listify_data_for_vector_env": 1.1021760899686152e-05}}, "connector_pipeline_timer": 0.00012547151128502448}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.287505615150183e-06, "numpy_to_tensor": 1.337171710797452e-05, "add_states_from_episodes_to_batch": 2.8187268594484306e-06, "add_observations_from_episodes_to_batch": 2.9078578657103723e-06, "batch_individual_items": 1.2984288607497945e-05}}, "connector_pipeline_timer": 6.253113275760814e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "rlmodule_inference_timer": 3.411226882355141e-05, "episode_len_mean": 20.0, "episode_return_min": -11.5, "weights_seq_no": 11.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_mean": -1.5800000000000005, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime": -6165000.0, "num_env_steps_sampled": 5000.0, "sample": 0.00592175752903613, "env_reset_timer": 4.067047972446836e-05, "episode_duration_sec_mean": 0.005593286180403084, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -308250.0, "time_between_sampling": 0.03207074562862778, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": -1.5800000000000005}, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.471842480627072e-05, "module_episode_returns_mean": {"default_policy": -1.5800000000000005}, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 3101.4744572520053}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.14125193742564535, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008913355664898755, "add_observations_from_episodes_to_batch": 0.0008305227023920353, "add_columns_from_episodes_to_train_batch": 0.04153915425076147, "add_time_dim_to_batch_and_zero_pad": 0.07570645772517105, "add_states_from_episodes_to_batch": 0.0035482537629197316, "batch_individual_items": 0.010517169689255278, "numpy_to_tensor": 7.094378804112337e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"IntrinsicAttentionMask": [[[0.07183650881052017, 0.07394871860742569, 0.07500757277011871, 0.09824666380882263, 0.08010228723287582, 0.08124925196170807, 0.08241263777017593, 0.10399574786424637, 0.10949162393808365, 0.11105939745903015, 0.11264963448047638], [0.07266707718372345, 0.07470380514860153, 0.07572378218173981, 0.09795761108398438, 0.08062237501144409, 0.0817231759428978, 0.0828390046954155, 0.10341813415288925, 0.1086251363158226, 0.11010828614234924, 0.11161167174577713], [0.07307642698287964, 0.07507536560297012, 0.07607594132423401, 0.0978139266371727, 0.08087696135044098, 0.08195485174655914, 0.08304712921380997, 0.10313362628221512, 0.10820014029741287, 0.10964218527078629, 0.11110346764326096], [0.08107273280620575, 0.082259900867939, 0.08284866064786911, 0.09486015141010284, 0.0856253057718277, 0.08623815327882767, 0.08685539662837982, 0.09760524332523346, 0.10015956312417984, 0.10087644308805466, 0.10159845650196075], [0.0749843642115593, 0.0768023282289505, 0.07771026343107224, 0.09713391959667206, 0.08204847574234009, 0.08301843702793121, 0.083999864757061, 0.10180921107530594, 0.10623683035373688, 0.10749273747205734, 0.10876350104808807], [0.07540053129196167, 0.07717794924974442, 0.07806521654129028, 0.0969834178686142, 0.08230074495077133, 0.08324690163135529, 0.08420393615961075, 0.10152073204517365, 0.10581241548061371, 0.10702886432409286, 0.10825930535793304], [0.07581788301467896, 0.07755426317453384, 0.07842060923576355, 0.09683171659708023, 0.08255256712436676, 0.08347476273775101, 0.0844072550535202, 0.10123156011104584, 0.10538812726736069, 0.10656540840864182, 0.10775584727525711], [0.08280989527702332, 0.08380237221717834, 0.08429362624883652, 0.09418521821498871, 0.08660199493169785, 0.08710966259241104, 0.08762029558420181, 0.09641318768262863, 0.09847617894411087, 0.09905344247817993, 0.09963410347700119], [0.08439786732196808, 0.08520673215389252, 0.08560638874769211, 0.09355908632278442, 0.08747820556163788, 0.08788852393627167, 0.08830075711011887, 0.09532681852579117, 0.09695640951395035, 0.09741117060184479, 0.09786807745695114], [0.08483869582414627, 0.08559563010931015, 0.08596944808959961, 0.09338376671075821, 0.0877186581492424, 0.08810175210237503, 0.08848650753498077, 0.09502581506967545, 0.09653767943382263, 0.09695928543806076, 0.09738273173570633], [0.08528057485818863, 0.08598504960536957, 0.0863327831029892, 0.09320740401744843, 0.08795847743749619, 0.08831419795751572, 0.08867135643959045, 0.09472436457872391, 0.09611935168504715, 0.09650807082653046, 0.09689836949110031]], [[0.08552226424217224, 0.1064312756061554, 0.09020032733678818, 0.10891228914260864, 0.08955595642328262, 0.09059377014636993, 0.11274268478155136, 0.09554923325777054, 0.013500869274139404, 0.10844960063695908, 0.0985417291522026], [0.0900714099407196, 0.09982103109359741, 0.09235385805368423, 0.10090775787830353, 0.09204326570034027, 0.09254293143749237, 0.10256007313728333, 0.09488800168037415, 0.03783261030912399, 0.10070609301328659, 0.0962730124592781], [0.08681271970272064, 0.10502981394529343, 0.09093412011861801, 0.10715896636247635, 0.0903681069612503, 0.09127946943044662, 0.11043389141559601, 0.09561293572187424, 0.017391907051205635, 0.1067623719573021, 0.09821570664644241], [0.09038840979337692, 0.09895612299442291, 0.09240364283323288, 0.09990478307008743, 0.09212975949048996, 0.09257031232118607, 0.10134484618902206, 0.09463419020175934, 0.042088884860277176, 0.09972883760929108, 0.09585027396678925], [0.08664379268884659, 0.1052245944738388, 0.09084120392799377, 0.10740068554878235, 0.09026451408863068, 0.09119310230016708, 0.1107494980096817, 0.09561089426279068, 0.01681012101471424, 0.10699528455734253, 0.09826625883579254], [0.08691444993019104, 0.10491055995225906, 0.09098955243825912, 0.10701127350330353, 0.09043002873659134, 0.09133091568946838, 0.11024148762226105, 0.09561309218406677, 0.01775468699634075, 0.10662002116441727, 0.09818392992019653], [0.09077532589435577, 0.09757533669471741, 0.09238608181476593, 0.09832077473402023, 0.09216759353876114, 0.09251898527145386, 0.09944961220026016, 0.09416068345308304, 0.04933846369385719, 0.09818262606859207, 0.09512460976839066], [0.08810269087553024, 0.10338454693555832, 0.0916016697883606, 0.10514151304960251, 0.09112266451120377, 0.09189369529485703, 0.10783311724662781, 0.09554322808980942, 0.022839762270450592, 0.10481467843055725, 0.09772242605686188], [0.04118729382753372, 0.13637982308864594, 0.05512816086411476, 0.15471524000167847, 0.053006529808044434, 0.05645739287137985, 0.18694233894348145, 0.07556679844856262, 1.682934907876188e-06, 0.15115125477313995, 0.0894635021686554], [0.09033317863941193, 0.09911911189556122, 0.09239794313907623, 0.10009312629699707, 0.09211726486682892, 0.0925687626004219, 0.10157212615013123, 0.09468462318181992, 0.04126953333616257, 0.09991245716810226, 0.09593187272548676], [0.08873436599969864, 0.10243740677833557, 0.09189192950725555, 0.10399899631738663, 0.09146039932966232, 0.09215489029884338, 0.10638615489006042, 0.09543417394161224, 0.026406820863485336, 0.10370870679616928, 0.09738615900278091]], [[0.0717705637216568, 0.07285967469215393, 0.07694488018751144, 0.10241132229566574, 0.07622716575860977, 0.07738389819860458, 0.08172278851270676, 0.10877056419849396, 0.11042114347219467, 0.11209676414728165, 0.10939116030931473], [0.07215864956378937, 0.0732300728559494, 0.07724597305059433, 0.10218603163957596, 0.07654077559709549, 0.07767727226018906, 0.08193705976009369, 0.10839170217514038, 0.11000113189220428, 0.11163445562124252, 0.10899689048528671], [0.07357282191514969, 0.07457828521728516, 0.07833673059940338, 0.1013614609837532, 0.07767787575721741, 0.07873943448066711, 0.08270759135484695, 0.10701701045036316, 0.10847952961921692, 0.10996203869581223, 0.10756716132164001], [0.08118955790996552, 0.08179798722267151, 0.08404026925563812, 0.09683668613433838, 0.08365075290203094, 0.08427762240171432, 0.08658788353204727, 0.09977221488952637, 0.10051989555358887, 0.10127317905426025, 0.10005399584770203], [0.07332895696163177, 0.07434596866369247, 0.07814936339855194, 0.10150405764579773, 0.0774824246764183, 0.07855703681707382, 0.08257587254047394, 0.10725341737270355, 0.1087409257888794, 0.11024907976388931, 0.10781293362379074], [0.07372106611728668, 0.07471947371959686, 0.07845048606395721, 0.10127472132444382, 0.0777965635061264, 0.078850157558918, 0.08278744667768478, 0.10687346011400223, 0.10832084715366364, 0.10978784412145615, 0.10741794109344482], [0.07514963299036026, 0.07607868313789368, 0.07954107969999313, 0.10043581575155258, 0.07893528044223785, 0.07991111278533936, 0.08354794234037399, 0.10549525171518326, 0.10679943859577179, 0.10811974853277206, 0.10598603636026382], [0.08283531665802002, 0.08334874361753464, 0.08523526042699814, 0.09584324806928635, 0.08490817993879318, 0.0854344516992569, 0.0873681828379631, 0.09824162721633911, 0.09885053336620331, 0.09946322441101074, 0.09847120940685272], [0.0832488164305687, 0.08373785763978958, 0.08553345501422882, 0.0955929085612297, 0.0852222815155983, 0.085722915828228, 0.08756107836961746, 0.09785899519920349, 0.09843386709690094, 0.0990121066570282, 0.0980757623910904], [0.08366312831640244, 0.0841275304555893, 0.08583138883113861, 0.09534177929162979, 0.08553626388311386, 0.08601106703281403, 0.08775307238101959, 0.09747639298439026, 0.09801746904850006, 0.09856154769659042, 0.09768043458461761], [0.08299142867326736, 0.08349566906690598, 0.08534794300794601, 0.09574877470731735, 0.08502685278654099, 0.08554346114397049, 0.08744115382432938, 0.09809708595275879, 0.09869310259819031, 0.09929274767637253, 0.0983218103647232]], [[0.08579099178314209, 0.10676567256450653, 0.09048373997211456, 0.1126057356595993, 0.08983735740184784, 0.09087841957807541, 0.11309691518545151, 0.09299689531326294, 0.013140257447957993, 0.10555265098810196, 0.09885135293006897], [0.09023813903331757, 0.10000579804182053, 0.09252481162548065, 0.10253998637199402, 0.09221363812685013, 0.09271422773599625, 0.10274991393089294, 0.0937235951423645, 0.03736836463212967, 0.09947027266025543, 0.09645122289657593], [0.08706086874008179, 0.10533002018928528, 0.0911940485239029, 0.11033052206039429, 0.09062641859054565, 0.0915403887629509, 0.11074954271316528, 0.09339608252048492, 0.01698869653046131, 0.10428700596094131, 0.0984964445233345], [0.09086459130048752, 0.09789689630270004, 0.09252890199422836, 0.0996900126338005, 0.0923030897974968, 0.09266625344753265, 0.0998380035161972, 0.09339688718318939, 0.04793839529156685, 0.09751638770103455, 0.09536058455705643], [0.08689484000205994, 0.10552945733070374, 0.0911044031381607, 0.11064176261425018, 0.0905260443687439, 0.0914573222398758, 0.11107036471366882, 0.09334870427846909, 0.016412420198321342, 0.10446371883153915, 0.0985509604215622], [0.08716081827878952, 0.10520792752504349, 0.09124746918678284, 0.11014073342084885, 0.0906863585114479, 0.09158980846405029, 0.11055395752191544, 0.09342379122972488, 0.01734817773103714, 0.10417867451906204, 0.09846223145723343], [0.09090381860733032, 0.09771345555782318, 0.09251685440540314, 0.0994473323225975, 0.09229806065559387, 0.09264994412660599, 0.09959038347005844, 0.09335774928331375, 0.048917755484580994, 0.09734539687633514, 0.09525925666093826], [0.08767880499362946, 0.10454822331666946, 0.0915171355009079, 0.1091250479221344, 0.09099079668521881, 0.09183815866708755, 0.10950783640146255, 0.09355663508176804, 0.019379178062081337, 0.10359151661396027, 0.0982666090130806], [0.040906503796577454, 0.13763663172721863, 0.05496624484658241, 0.18494294583797455, 0.052823103964328766, 0.05630951374769211, 0.18946263194084167, 0.0639878660440445, 1.234837554875412e-06, 0.12918299436569214, 0.08978025615215302], [0.09007205069065094, 0.10042821615934372, 0.09249082952737808, 0.10312510281801224, 0.09216146916151047, 0.0926913470029831, 0.10334867984056473, 0.09376027435064316, 0.03541097044944763, 0.0998588353395462, 0.09665224701166153], [0.08894307166337967, 0.1026783287525177, 0.09210805594921112, 0.10633207112550735, 0.0916755199432373, 0.09237165004014969, 0.10663636773824692, 0.0937798023223877, 0.025949079543352127, 0.10191089659929276, 0.09761520475149155]], [[0.07159647345542908, 0.07650114595890045, 0.07475694268941879, 0.10163772106170654, 0.07983463257551193, 0.08097776025533676, 0.07913148403167725, 0.10758524388074875, 0.10912572592496872, 0.11068826913833618, 0.10816460102796555], [0.0735221728682518, 0.07801168411970139, 0.07641869783401489, 0.10058493167161942, 0.08104558289051056, 0.08208287507295609, 0.08040675520896912, 0.10583414882421494, 0.10718870908021927, 0.10856061428785324, 0.1063438206911087], [0.07284869998693466, 0.0774853378534317, 0.07583886384963989, 0.10095378011465073, 0.08062490820884705, 0.08169945329427719, 0.07996343076229095, 0.10644424706697464, 0.10786289721727371, 0.10930046439170837, 0.10697795450687408], [0.08208687603473663, 0.08452815562486649, 0.08367026597261429, 0.09584620594978333, 0.08613787591457367, 0.08668123930692673, 0.08580149710178375, 0.09828758239746094, 0.09890758246183395, 0.09953149408102036, 0.09852133691310883], [0.07477648556232452, 0.07898646593093872, 0.07749482989311218, 0.09989622235298157, 0.0818210020661354, 0.08278828114271164, 0.08122484385967255, 0.10470447689294815, 0.1059422716498375, 0.1071946993470192, 0.1051703542470932], [0.07519713044166565, 0.0793117806315422, 0.07785462588071823, 0.09966479986906052, 0.0820787325501442, 0.0830223336815834, 0.08149699866771698, 0.10432755202054977, 0.10552693903446198, 0.10674010962247849, 0.10477901995182037], [0.07451539486646652, 0.07878414541482925, 0.0772712230682373, 0.1000397726893425, 0.0816604495048523, 0.08264236897230148, 0.08105535805225372, 0.10493893176317215, 0.10620075464248657, 0.10747775435447693, 0.10541381686925888], [0.08385828137397766, 0.08583585917949677, 0.08514226973056793, 0.09485781192779541, 0.08713342994451523, 0.08757029473781586, 0.08686269074678421, 0.09677454829216003, 0.0972597524523735, 0.09774739295244217, 0.09695754945278168], [0.08430398255586624, 0.08616276830434799, 0.08551115542650223, 0.094608835875988, 0.08738090097904205, 0.08779074996709824, 0.08712682873010635, 0.09639640152454376, 0.09684854745864868, 0.09730281680822372, 0.09656696021556854], [0.08475078642368317, 0.08648964017629623, 0.08588037639856339, 0.09435911476612091, 0.08762776851654053, 0.08801046013832092, 0.0873904824256897, 0.09601831436157227, 0.09643765538930893, 0.09685882180929184, 0.09617650508880615], [0.0840265303850174, 0.08595936000347137, 0.08528158813714981, 0.0947638526558876, 0.0872269868850708, 0.08765366673469543, 0.08696253597736359, 0.09663170576095581, 0.09710439294576645, 0.09757938981056213, 0.0968099981546402]], [[0.08499681949615479, 0.1057773157954216, 0.08697817474603653, 0.11156332492828369, 0.09173586219549179, 0.09279893338680267, 0.11204995214939117, 0.09496217221021652, 0.013417959213256836, 0.1077832579612732, 0.09793626517057419], [0.08982168883085251, 0.09954427182674408, 0.09079955518245697, 0.1020667627453804, 0.09310045838356018, 0.09360586851835251, 0.10227572172880173, 0.09462493658065796, 0.03772773966193199, 0.10042688995599747, 0.09600610285997391], [0.08559247851371765, 0.1052253469824791, 0.08747506886720657, 0.11065155267715454, 0.09198593348264694, 0.09299204498529434, 0.11110719293355942, 0.09503739327192307, 0.014979411847889423, 0.10710837692022324, 0.0978451818227768], [0.09055319428443909, 0.09756140410900116, 0.0912671610713005, 0.09934837371110916, 0.0929388478398323, 0.09330452233552933, 0.09949585795402527, 0.09404018521308899, 0.04826858267188072, 0.09818805754184723, 0.09503378719091415], [0.08691142499446869, 0.10387257486581802, 0.08855923265218735, 0.10848074406385422, 0.09248805791139603, 0.09336070716381073, 0.10886627435684204, 0.0951307937502861, 0.01930266246199608, 0.10547532886266708, 0.09755227714776993], [0.0871841311454773, 0.10356401652097702, 0.08877997100353241, 0.10799777507781982, 0.09258078783750534, 0.09342426061630249, 0.1083684116601944, 0.09513431042432785, 0.020387569442391396, 0.10510686039924622, 0.09747190028429031], [0.09060128033161163, 0.09738825261592865, 0.09129343926906586, 0.09911635518074036, 0.09291338920593262, 0.09326762706041336, 0.09925893694162369, 0.09398014843463898, 0.04924388229846954, 0.0979943796992302, 0.09494222700595856], [0.08771361410617828, 0.10292795300483704, 0.08920425921678543, 0.1070156991481781, 0.09274698048830032, 0.09353175759315491, 0.10735686868429184, 0.09512127935886383, 0.022738946601748466, 0.10435176640748978, 0.09729084372520447], [0.039637189358472824, 0.13124673068523407, 0.04496615380048752, 0.17567038536071777, 0.060186054557561874, 0.06410432606935501, 0.17990612983703613, 0.07272274792194366, 1.6196336218854412e-06, 0.1454622894525528, 0.08609636127948761], [0.09010812640190125, 0.09887214750051498, 0.09099358320236206, 0.10113208740949631, 0.09307344257831573, 0.09352963417768478, 0.10131905227899551, 0.09444871544837952, 0.041166752576828, 0.09966351836919785, 0.09569285809993744], [0.08838459849357605, 0.1020335927605629, 0.08973196893930435, 0.10566440224647522, 0.09292502701282501, 0.09363064914941788, 0.10596678406000137, 0.09505798667669296, 0.026302769780158997, 0.10329990088939667, 0.09700226783752441]]], "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 1.809336208680179e-05, "vf_explained_var": -0.0012710094451904297, "total_loss": 0.2780167758464813, "policy_loss": -5.454082565847784e-05, "num_module_steps_trained_lifetime": 71820, "use_intrinsic_rewards": 0.0, "num_module_steps_trained": 5985, "vf_loss": 0.3583061397075653, "weights_seq_no": 12.0, "module_train_batch_size_mean": 997.7412016936058, "curr_kl_coeff": 3.944920172216371e-05, "curr_entropy_coeff": 0.0015431216992, "entropy": 0.691750705242157, "vf_loss_unclipped": 43.406654357910156, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 751.8869985185592}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"module_train_batch_size_mean": 997.504027034245, "total_loss": 0.0, "num_module_steps_trained_lifetime": 430920, "diff_num_grad_updates_vs_sampler_policy": 61.0, "num_module_steps_trained": 35910, "weights_seq_no": 72.0}, "default_policy": {"policy_loss": -5.026135113439523e-05, "num_module_steps_trained_lifetime": 430920, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35910, "vf_loss": 0.35833418369293213, "weights_seq_no": 72.0, "module_train_batch_size_mean": 997.504027034245, "entropy": 0.6917502284049988, "vf_loss_unclipped": 43.50956344604492, "diff_num_grad_updates_vs_sampler_policy": 61.0, "mean_kl_loss": 1.8121461835107766e-05, "vf_explained_var": -0.0025773048400878906, "total_loss": 0.2780458331108093}, "__all_modules__": {"num_env_steps_trained": 198000, "num_module_steps_trained_lifetime": 861840, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 2376000, "num_env_steps_trained_lifetime_throughput": 49129.02283785527}}}, "intrinsic_reward_module": {"curr_entropy_coeff": 0.0015431216992, "default_optimizer_learning_rate": 0.0002715581955, "module_train_batch_size_mean": 997.7412016936058, "total_loss": 0.0, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 71820, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "weights_seq_no": 12.0, "num_module_steps_trained_lifetime_throughput": 751.8974596557372}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 396000, "num_env_steps_trained": 33000, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 143640, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 4147.053467495934, "num_module_steps_trained_throughput": 23770568.70398882, "num_module_steps_trained_lifetime_throughput": 14174277.782452099}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 240, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -0.6}, "episode_len_min": 20, "weights_seq_no": 12.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.015104166477521e-06, "numpy_to_tensor": 1.6199701021386274e-05, "add_observations_from_episodes_to_batch": 3.396989169441054e-06, "add_time_dim_to_batch_and_zero_pad": 8.798243883544493e-06, "batch_individual_items": 1.4398103466012085e-05}}, "connector_pipeline_timer": 7.034720495577194e-05}, "num_env_steps_sampled": 400, "env_reset_timer": 0.00019841137135951682, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.423775285056527e-05, "get_actions": 4.679755226510207e-05, "listify_data_for_vector_env": 1.2942507892746036e-05, "un_batch_to_individual_items": 7.527821138524812e-06, "tensor_to_numpy": 1.8097747864693174e-05, "normalize_and_clip_actions": 9.89233003889492e-06}}, "connector_pipeline_timer": 0.00013976732183315987}, "episode_len_max": 20, "env_step_timer": 1.7778300278273222e-05, "rlmodule_inference_timer": 3.9215848151257875e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": -0.6}, "episode_len_mean": 20.0, "episode_return_min": -14.5, "episode_return_mean": -0.6, "num_env_steps_sampled_lifetime": 60400, "sample": 0.11695966803648036, "episode_duration_sec_mean": 0.005564680370735004, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "episode_return_max": 14.5, "time_between_sampling": 9.632060438957717}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "aec1c_00000", "date": "2025-08-11_18-41-08", "timestamp": 1754930468, "time_this_iter_s": 9.828284978866577, "time_total_s": 118.83054876327515, "pid": 11610, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3842f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 118.83054876327515, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 40.24285714285714, "ram_util_percent": 78.78571428571429}}
{"timers": {"training_iteration": 9.85166065956264, "restore_env_runners": 8.572587870025995e-06, "training_step": 9.851488972992275, "env_runner_sampling_timer": 1.635645982281666, "learner_update_timer": 8.033835793841037, "synch_weights": 0.001105109478637077, "restore_eval_env_runners": 2.092237682406222e-05, "evaluation_iteration": 0.1238053764852579, "synch_eval_env_connectors": 0.00016194175554137155, "synch_env_connectors": 5.411806236226126e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.3722801928352314e-05, "normalize_and_clip_actions": 1.1230369611878433e-05, "get_actions": 6.865554788770072e-05, "un_batch_to_individual_items": 9.451021647830014e-06, "remove_single_ts_time_rank_from_batch": 1.625749438286222e-05, "listify_data_for_vector_env": 1.5341541505746907e-05}}, "connector_pipeline_timer": 0.00018216480186554948}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.040459335631751e-05, "numpy_to_tensor": 2.19481187878919e-05, "add_states_from_episodes_to_batch": 3.507529035848335e-06, "add_observations_from_episodes_to_batch": 4.177635655615445e-06, "batch_individual_items": 1.78313800356424e-05}}, "connector_pipeline_timer": 8.695750055448873e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "rlmodule_inference_timer": 5.1738940585957325e-05, "episode_len_mean": 20.0, "episode_return_min": -11.5, "weights_seq_no": 12.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_mean": -1.2600000000000002, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime": -6782500.0, "num_env_steps_sampled": 5000.0, "sample": 0.007071045769714793, "env_reset_timer": 4.6648554995067296e-05, "episode_duration_sec_mean": 0.008157795848790556, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -339125.0, "time_between_sampling": 0.03341464178266447, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": -1.2600000000000002}, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 2.2025198935986604e-05, "module_episode_returns_mean": {"default_policy": -1.2600000000000002}, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 2678.5000929201665}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1431826418015145, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.0089240412780952, "add_observations_from_episodes_to_batch": 0.0008322645553633894, "add_columns_from_episodes_to_train_batch": 0.041575247288079625, "add_time_dim_to_batch_and_zero_pad": 0.07577667772894728, "add_states_from_episodes_to_batch": 0.003559534135496405, "batch_individual_items": 0.012316160072389887, "numpy_to_tensor": 7.095643016418231e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"IntrinsicAttentionMask": [[[0.07207738608121872, 0.07611873745918274, 0.07428151369094849, 0.1028490960597992, 0.07655303180217743, 0.0777147114276886, 0.08207215368747711, 0.10500553250312805, 0.1108931452035904, 0.1125759407877922, 0.10985877364873886], [0.07346624881029129, 0.0772586390376091, 0.0755365788936615, 0.10198624432086945, 0.07766524702310562, 0.07875197380781174, 0.08281721919775009, 0.10395754128694534, 0.10932391881942749, 0.11085362732410431, 0.10838274657726288], [0.07284265756607056, 0.0767478197813034, 0.07497362792491913, 0.10237415879964828, 0.07716694474220276, 0.07828754931688309, 0.08248461782932281, 0.1044280156493187, 0.11002650111913681, 0.11162428557872772, 0.10904385894536972], [0.08134789019823074, 0.08357783406972885, 0.08257168531417847, 0.09702552109956741, 0.08381388336420059, 0.08444198220968246, 0.08675674349069595, 0.09802871197462082, 0.10071591287851334, 0.10147067159414291, 0.10024911165237427], [0.07361183315515518, 0.07737766951322556, 0.0756678655743599, 0.10189557820558548, 0.0777813270688057, 0.0788600817322731, 0.08289442211389542, 0.10384773463010788, 0.10916037112474442, 0.11067434400320053, 0.10822879523038864], [0.0739978700876236, 0.07769285142421722, 0.07601575553417206, 0.10165494680404663, 0.0780886709690094, 0.07914622128009796, 0.08309827744960785, 0.1035565733909607, 0.10872752964496613, 0.11020003259181976, 0.10782122611999512], [0.07540418207645416, 0.0788358822464943, 0.07728008180856705, 0.10077598690986633, 0.07920264452695847, 0.0801817923784256, 0.08383092284202576, 0.10249646008014679, 0.10716115683317184, 0.10848593711853027, 0.10634499788284302], [0.08190412074327469, 0.08401430398225784, 0.08306260406970978, 0.09667206555604935, 0.0842374786734581, 0.0848311334848404, 0.08701673150062561, 0.09761196374893188, 0.10012684762477875, 0.10083247721195221, 0.0996902659535408], [0.08337380737066269, 0.08516159653663635, 0.08435623347759247, 0.09573642164468765, 0.08535023033618927, 0.08585162460803986, 0.08769254386425018, 0.09651213139295578, 0.09858164191246033, 0.09916075319051743, 0.0982230007648468], [0.08378139138221741, 0.08547823876142502, 0.08471408486366272, 0.09547653794288635, 0.08565717190504074, 0.08613263815641403, 0.08787711709737778, 0.09620749205350876, 0.09815600514411926, 0.0987008586525917, 0.09781850129365921], [0.08312059938907623, 0.08496455103158951, 0.08413372188806534, 0.09589780122041702, 0.08515918999910355, 0.08567660301923752, 0.08757725358009338, 0.096701480448246, 0.09884671121835709, 0.09944728761911392, 0.09847484529018402]], [[0.08825507014989853, 0.10808710753917694, 0.08767061680555344, 0.11042024940252304, 0.08956305682659149, 0.0930950790643692, 0.11086655408143997, 0.09510460495948792, 0.015080257318913937, 0.10399545729160309, 0.09786193072795868], [0.09140468388795853, 0.09968913346529007, 0.0911451205611229, 0.10060453414916992, 0.09198205173015594, 0.09351745992898941, 0.10077837109565735, 0.09437618404626846, 0.04290860518813133, 0.09805610030889511, 0.09553773701190948], [0.08811313658952713, 0.10832418501377106, 0.08751872181892395, 0.11070676147937775, 0.08944368362426758, 0.09303844720125198, 0.11116263270378113, 0.09508481621742249, 0.014565430581569672, 0.10414818674325943, 0.09789401292800903], [0.09153670072555542, 0.09862102568149567, 0.09131330996751785, 0.09939860552549362, 0.0920332744717598, 0.09335169941186905, 0.0995461642742157, 0.09408773481845856, 0.047798268496990204, 0.09723133593797684, 0.09508183598518372], [0.08856340497732162, 0.1075558289885521, 0.08800118416547775, 0.10978013277053833, 0.08982108533382416, 0.09321349859237671, 0.11020539700984955, 0.09514119476079941, 0.016284625977277756, 0.10365020483732224, 0.09778349846601486], [0.08933012932538986, 0.10611319541931152, 0.08882743120193481, 0.10805550962686539, 0.09045334905385971, 0.09347420930862427, 0.10842634737491608, 0.09518517553806305, 0.01991908624768257, 0.10269156843423843, 0.0975240170955658], [0.09155557304620743, 0.09841402620077133, 0.09133904427289963, 0.09916586428880692, 0.09203683584928513, 0.09331421554088593, 0.09930852055549622, 0.0940270945429802, 0.04877931624650955, 0.0970698818564415, 0.09498964995145798], [0.08972207456827164, 0.10528479516506195, 0.08925290405750275, 0.10707405209541321, 0.0907697081565857, 0.09358275681734085, 0.10741540789604187, 0.09517315775156021, 0.022254183888435364, 0.10212709754705429, 0.09734389185905457], [0.04624129831790924, 0.15558619797229767, 0.04443834349513054, 0.1768018752336502, 0.05049792304635048, 0.06365307420492172, 0.18112260103225708, 0.07233277708292007, 1.180495473818155e-06, 0.12349651753902435, 0.08582824468612671], [0.09104219824075699, 0.10150990635156631, 0.09071799367666245, 0.10268052667379379, 0.0917641669511795, 0.09368970990180969, 0.10290314257144928, 0.094770148396492, 0.03525833785533905, 0.09942834824323654, 0.09623558819293976], [0.09020546823740005, 0.104135662317276, 0.08978186547756195, 0.10572315007448196, 0.09115053713321686, 0.09368270635604858, 0.10602570325136185, 0.09511084854602814, 0.02580050192773342, 0.10132730007171631, 0.09705620259046555]], [[0.07176335901021957, 0.07285235822200775, 0.07693715393543243, 0.1024009957909584, 0.07928989082574844, 0.07737612724304199, 0.0785503014922142, 0.10454805195331573, 0.11041000485420227, 0.11208546906709671, 0.11378634721040726], [0.07215176522731781, 0.07322309166193008, 0.07723861187696457, 0.1021762490272522, 0.07954935729503632, 0.07766986638307571, 0.07882312685251236, 0.10427235066890717, 0.10999059677124023, 0.11162377148866653, 0.11328119039535522], [0.07356709241867065, 0.07457247376441956, 0.0783306285738945, 0.10135353356599808, 0.0804862305521965, 0.07873330265283585, 0.0798092931509018, 0.10326681286096573, 0.10847104340791702, 0.10995344072580338, 0.11145608872175217], [0.08118802309036255, 0.08179643750190735, 0.08403868228197098, 0.09683484584093094, 0.08530294895172119, 0.08427603542804718, 0.08490758389234543, 0.09783605486154556, 0.10051798075437546, 0.10127125680446625, 0.10203017294406891], [0.0743541270494461, 0.07532178610563278, 0.07893349975347519, 0.10089358687400818, 0.0810013860464096, 0.07931999117136002, 0.080352284014225, 0.10270708054304123, 0.10763193666934967, 0.10903268307447433, 0.11045165359973907], [0.0737154483795166, 0.07471378892660141, 0.07844451814889908, 0.10126697272062302, 0.08058365434408188, 0.07884415984153748, 0.07991194725036621, 0.10316134244203568, 0.10831256210803986, 0.10977944731712341, 0.11126619577407837], [0.07410884648561478, 0.07508834451436996, 0.07874596118927002, 0.10103711485862732, 0.08084127306938171, 0.07913751155138016, 0.0801834762096405, 0.10288156569004059, 0.10789300501346588, 0.10931903123855591, 0.11076389998197556], [0.08175357431173325, 0.08232972770929337, 0.08445087820291519, 0.09649437665939331, 0.085645392537117, 0.08467521518468857, 0.08527195453643799, 0.09743255376815796, 0.09994281083345413, 0.10064715147018433, 0.10135644674301147], [0.08324791491031647, 0.08373694866895676, 0.0855325236916542, 0.09559185802936554, 0.08654038608074188, 0.08572198450565338, 0.08622555434703827, 0.09636639803647995, 0.09843278676271439, 0.09901101887226105, 0.0995926558971405], [0.08366232365369797, 0.08412672579288483, 0.08583056926727295, 0.09534085541963577, 0.08678608387708664, 0.08601024001836777, 0.08648766577243805, 0.09607076644897461, 0.09801651537418365, 0.09856059402227402, 0.09910769015550613], [0.08407752960920334, 0.08451703190803528, 0.0861283540725708, 0.09508908540010452, 0.08703115582466125, 0.0862981528043747, 0.08674927055835724, 0.0957745909690857, 0.0976005420088768, 0.09811073541641235, 0.0986235961318016]], [[0.05193322151899338, 0.06320119649171829, 0.05447659641504288, 0.06452231854200363, 0.054127078503370285, 0.05619361251592636, 0.06838595867156982, 0.05736824870109558, 0.40872833132743835, 0.06427618116140366, 0.05678727477788925], [0.07773886620998383, 0.08424872905015945, 0.07927605509757996, 0.08496555685997009, 0.07906736433506012, 0.08028998225927353, 0.08701347559690475, 0.08097312599420547, 0.18095789849758148, 0.08483266830444336, 0.08063628524541855], [0.05875531584024429, 0.06951306015253067, 0.06121056526899338, 0.07075535506010056, 0.06087416410446167, 0.06285876035690308, 0.07436782866716385, 0.06398214399814606, 0.34373167157173157, 0.0705241784453392, 0.06342693418264389], [0.08000554144382477, 0.08565250784158707, 0.08134524524211884, 0.08627018332481384, 0.08116359263658524, 0.08222673088312149, 0.08803049474954605, 0.08281970024108887, 0.163802832365036, 0.0861557349562645, 0.08252742886543274], [0.057847760617733, 0.06869993358850479, 0.060320883989334106, 0.06995571404695511, 0.05998189374804497, 0.06198233366012573, 0.07361015677452087, 0.06311531364917755, 0.3522087633609772, 0.0697219967842102, 0.06255531311035156], [0.0630580335855484, 0.07324905693531036, 0.06540066003799438, 0.07441432774066925, 0.06508029997348785, 0.06696748733520508, 0.07779031246900558, 0.06803283095359802, 0.30430278182029724, 0.0741976648569107, 0.0675065666437149], [0.08585226535797119, 0.0888093039393425, 0.08656306564807892, 0.08912671357393265, 0.08646704256534576, 0.08702754974365234, 0.09002507477998734, 0.08733859658241272, 0.12253693491220474, 0.0890679880976677, 0.08718542009592056], [0.06584466248750687, 0.0755573958158493, 0.06808798760175705, 0.07666067034006119, 0.06778159737586975, 0.06958472728729248, 0.07984916865825653, 0.07060079276561737, 0.2794782519340515, 0.07645563036203384, 0.07009904086589813], [0.17467038333415985, 0.0628708228468895, 0.13619676232337952, 0.05645414814352989, 0.14083567261695862, 0.11588756740093231, 0.04171254485845566, 0.10405992716550827, 3.7999275264155585e-06, 0.05758820101618767, 0.10972017794847488], [0.07959426939487457, 0.08540473878383636, 0.08097156882286072, 0.08604108542203903, 0.08078478276729584, 0.08187821507453918, 0.08785542845726013, 0.0824882760643959, 0.16687095165252686, 0.08592315763235092, 0.08218755573034286], [0.06448276340961456, 0.07444065809249878, 0.06677734106779099, 0.07557547092437744, 0.06646376103162766, 0.06831011921167374, 0.07885906845331192, 0.06935147196054459, 0.29153764247894287, 0.07536452263593674, 0.06883715093135834]], [[0.07204772531986237, 0.07416614145040512, 0.07522811740636826, 0.09853547066450119, 0.07739788293838501, 0.08148813992738724, 0.0826549381017685, 0.10430145263671875, 0.10981348901987076, 0.11138588190078735, 0.11298078298568726], [0.0728723555803299, 0.07491482049226761, 0.07593769580125809, 0.09823428094387054, 0.07802551984786987, 0.08195403218269348, 0.08307301253080368, 0.10371022671461105, 0.10893193632364273, 0.11041926592588425, 0.11192690581083298], [0.07327868044376373, 0.07528313994407654, 0.07628649473190308, 0.09808458387851715, 0.07833348959684372, 0.0821816697716713, 0.08327696472406387, 0.10341901332139969, 0.10849953442811966, 0.10994558036327362, 0.11141090095043182], [0.08120155334472656, 0.08239060640335083, 0.08298030495643616, 0.09501086920499802, 0.08417239785194397, 0.08637519180774689, 0.08699341118335724, 0.09776032716035843, 0.10031870752573013, 0.10103672742843628, 0.1017598882317543], [0.074094757437706, 0.07602176815271378, 0.07698541134595871, 0.09778141975402832, 0.07894948124885559, 0.08263509720563889, 0.08368255943059921, 0.1028343215584755, 0.10763496160507202, 0.10899931937456131, 0.11038097739219666], [0.07558424025774002, 0.07736598700284958, 0.07825540751218796, 0.09721966832876205, 0.080065056681633, 0.08344972133636475, 0.08440908044576645, 0.10176803171634674, 0.10607016831636429, 0.10728958249092102, 0.10852301865816116], [0.07599803060293198, 0.07773853093385696, 0.07860694825649261, 0.09706174582242966, 0.08037297427654266, 0.08367308974266052, 0.0846078023314476, 0.10147204250097275, 0.10563848167657852, 0.10681856423616409, 0.10801182687282562], [0.08291911333799362, 0.08391290158033371, 0.08440481126308441, 0.09430944174528122, 0.08539728075265884, 0.0872245579957962, 0.0877358689904213, 0.09654034674167633, 0.09860606491565704, 0.09918409585952759, 0.09976551681756973], [0.08448799699544907, 0.08529771864414215, 0.08569780737161636, 0.09365899115800858, 0.08650361746549606, 0.08798237890005112, 0.08839505165815353, 0.09542861580848694, 0.0970599427819252, 0.09751520305871964, 0.09797259420156479], [0.08492334187030792, 0.08568102866411209, 0.086055226624012, 0.09347692877054214, 0.08680851757526398, 0.08818965405225754, 0.08857479691505432, 0.0951206162571907, 0.09663400053977966, 0.09705602377653122, 0.09747989475727081], [0.0853596180677414, 0.08606474101543427, 0.08641280978918076, 0.09329379349946976, 0.087113156914711, 0.08839605748653412, 0.08875354379415512, 0.09481216222047806, 0.09620844572782516, 0.09659752994775772, 0.09698818624019623]], [[0.05715397372841835, 0.0667654275894165, 0.058250319212675095, 0.06804613769054413, 0.05936768651008606, 0.059934381395578384, 0.07177949696779251, 0.059581127017736435, 0.37079814076423645, 0.06780769675970078, 0.06051567941904068], [0.07853991538286209, 0.08417658507823944, 0.07920816540718079, 0.08489278703927994, 0.07988210022449493, 0.08022122085094452, 0.08693896234035492, 0.08001003414392471, 0.18080294132232666, 0.08476001769304276, 0.08056723326444626], [0.06005525961518288, 0.06941989809274673, 0.061128538101911545, 0.0706605315208435, 0.062220994383096695, 0.06277451664209366, 0.0742681547999382, 0.0624295175075531, 0.3432709276676178, 0.07042966783046722, 0.06334193795919418], [0.08070237934589386, 0.08558840304613113, 0.08128435909748077, 0.0862056165933609, 0.08187052607536316, 0.0821651890873909, 0.08796460926532745, 0.08198171854019165, 0.16368025541305542, 0.08609125018119812, 0.08246565610170364], [0.06289837509393692, 0.07194490730762482, 0.0639401227235794, 0.07313648611307144, 0.06499912589788437, 0.06553518027067184, 0.07659291476011276, 0.06520110368728638, 0.3167526423931122, 0.07291486114263535, 0.06608433276414871], [0.06429386138916016, 0.0731549933552742, 0.06531667709350586, 0.0743187740445137, 0.06635575741529465, 0.06688148528337479, 0.07769041508436203, 0.06655387580394745, 0.30391189455986023, 0.07410237938165665, 0.0674198791384697], [0.08622027188539505, 0.08877375721931458, 0.08652842789888382, 0.08909104019403458, 0.08683767914772034, 0.08699272572994232, 0.08998904377222061, 0.08689621835947037, 0.12248791009187698, 0.08903234452009201, 0.08715053647756577], [0.06342771649360657, 0.07240625470876694, 0.0644625648856163, 0.0735875815153122, 0.06551428884267807, 0.0660465657711029, 0.07701269537210464, 0.06571485102176666, 0.31186777353286743, 0.0733678936958313, 0.066591776907444], [0.15568728744983673, 0.06453306972980499, 0.1397976130247116, 0.05794674530625343, 0.1255297064781189, 0.11895149201154709, 0.04281538724899292, 0.1230030208826065, 3.900408501067432e-06, 0.05911076441407204, 0.11262104660272598], [0.08031091839075089, 0.08533906191587448, 0.08090930432081223, 0.08597491681575775, 0.08151214569807053, 0.08181525021791458, 0.08778785169124603, 0.0816265195608139, 0.16674260795116425, 0.0858570858836174, 0.08212435245513916], [0.06569178402423859, 0.0743468850851059, 0.06669322401285172, 0.07548027485609055, 0.06770993024110794, 0.06822407245635986, 0.07875973731279373, 0.06790369749069214, 0.2911703288555145, 0.07526958733797073, 0.06875044107437134]]], "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 7.4612735261325724e-06, "vf_explained_var": -0.001442551612854004, "total_loss": 0.2779850661754608, "policy_loss": -8.801012154435739e-05, "num_module_steps_trained_lifetime": 77805, "use_intrinsic_rewards": 0.0, "num_module_steps_trained": 5985, "vf_loss": 0.3583081364631653, "weights_seq_no": 13.0, "module_train_batch_size_mean": 997.7269395717314, "curr_kl_coeff": 1.9724600861081854e-05, "curr_entropy_coeff": 0.0015431216992, "entropy": 0.6916055679321289, "vf_loss_unclipped": 43.91065979003906, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 748.8489759102249}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"module_train_batch_size_mean": 997.5020416990191, "total_loss": 0.0, "num_module_steps_trained_lifetime": 466830, "diff_num_grad_updates_vs_sampler_policy": 66.0, "num_module_steps_trained": 35910, "weights_seq_no": 78.0}, "default_policy": {"policy_loss": -8.477526716887951e-05, "num_module_steps_trained_lifetime": 466830, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35910, "vf_loss": 0.3583364188671112, "weights_seq_no": 78.0, "module_train_batch_size_mean": 997.5020416990191, "entropy": 0.6916107535362244, "vf_loss_unclipped": 44.022701263427734, "diff_num_grad_updates_vs_sampler_policy": 66.0, "mean_kl_loss": 7.092783107509604e-06, "vf_explained_var": -0.0025707483291625977, "total_loss": 0.2780114710330963}, "__all_modules__": {"num_env_steps_trained": 198000, "num_module_steps_trained_lifetime": 933660, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 2574000, "num_env_steps_trained_lifetime_throughput": 48290.044473343754}}}, "intrinsic_reward_module": {"curr_entropy_coeff": 0.0015431216992, "default_optimizer_learning_rate": 0.0002715581955, "module_train_batch_size_mean": 997.7269395717314, "total_loss": 0.0, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 77805, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "weights_seq_no": 13.0, "num_module_steps_trained_lifetime_throughput": 748.8588532352782}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 429000, "num_env_steps_trained": 33000, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 155610, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 4130.251327153386, "num_module_steps_trained_throughput": 23169329.716156837, "num_module_steps_trained_lifetime_throughput": 14076916.46368611}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 260, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -0.4}, "episode_len_min": 20, "weights_seq_no": 13.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7276763586591646e-06, "numpy_to_tensor": 1.1781915284897459e-05, "add_observations_from_episodes_to_batch": 2.8158863792323325e-06, "add_time_dim_to_batch_and_zero_pad": 6.714349789992636e-06, "batch_individual_items": 1.2201627694931469e-05}}, "connector_pipeline_timer": 5.796943454345833e-05}, "num_env_steps_sampled": 400, "env_reset_timer": 0.00019940891830069, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1730611495151005e-05, "get_actions": 3.503809713612679e-05, "listify_data_for_vector_env": 1.0295907112944686e-05, "un_batch_to_individual_items": 6.3816158798852745e-06, "tensor_to_numpy": 1.4696540574104571e-05, "normalize_and_clip_actions": 7.831652402563039e-06}}, "connector_pipeline_timer": 0.00011175764626302825}, "episode_len_max": 20, "env_step_timer": 1.3711683451824494e-05, "rlmodule_inference_timer": 3.023175577639626e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": -0.4}, "episode_len_mean": 20.0, "episode_return_min": -14.5, "episode_return_mean": -0.4, "num_env_steps_sampled_lifetime": 65400, "sample": 0.11691710635577857, "episode_duration_sec_mean": 0.0055620883067604154, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "episode_return_max": 14.5, "time_between_sampling": 9.647595313318217}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "aec1c_00000", "date": "2025-08-11_18-41-19", "timestamp": 1754930479, "time_this_iter_s": 11.279451131820679, "time_total_s": 130.10999989509583, "pid": 11610, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3842f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 130.10999989509583, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 49.875, "ram_util_percent": 78.44375000000001}}
{"timers": {"training_iteration": 9.850415558387807, "restore_env_runners": 8.601032825747847e-06, "training_step": 9.85024335784311, "env_runner_sampling_timer": 1.6350217599599193, "learner_update_timer": 8.031972723822491, "synch_weights": 0.0011177363045405124, "restore_eval_env_runners": 2.1116903510828555e-05, "evaluation_iteration": 0.12377810314004742, "synch_eval_env_connectors": 0.00016185483743156014, "synch_env_connectors": 5.395598823416806e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.628613638926219e-05, "normalize_and_clip_actions": 8.309955056683111e-06, "get_actions": 4.247985628119983e-05, "un_batch_to_individual_items": 6.724964756315704e-06, "remove_single_ts_time_rank_from_batch": 1.2216112499806687e-05, "listify_data_for_vector_env": 1.0939067943755441e-05}}, "connector_pipeline_timer": 0.00012442752390230504}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.165046232480289e-06, "numpy_to_tensor": 1.3120011572628504e-05, "add_states_from_episodes_to_batch": 2.733900839833514e-06, "add_observations_from_episodes_to_batch": 2.8887959712948264e-06, "batch_individual_items": 1.270628756847083e-05}}, "connector_pipeline_timer": 6.124128980851724e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "rlmodule_inference_timer": 3.4002794160996524e-05, "episode_len_mean": 20.0, "episode_return_min": -11.5, "weights_seq_no": 13.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_mean": -0.54, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime": -7400000.0, "num_env_steps_sampled": 5000.0, "sample": 0.007285334588548573, "env_reset_timer": 4.958317200412414e-05, "episode_duration_sec_mean": 0.005426497662905602, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -370000.0, "time_between_sampling": 0.03616111637115149, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": -0.54}, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.4544090963638938e-05, "module_episode_returns_mean": {"default_policy": -0.54}, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 3082.2694739917997}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.14430101372382217, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008922017946186753, "add_observations_from_episodes_to_batch": 0.0008335423298265509, "add_columns_from_episodes_to_train_batch": 0.0415769702257031, "add_time_dim_to_batch_and_zero_pad": 0.0757737647017712, "add_states_from_episodes_to_batch": 0.0035599279645698065, "batch_individual_items": 0.013436083472562813, "numpy_to_tensor": 7.10147762499075e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"IntrinsicAttentionMask": [[[0.07217054814100266, 0.07711455971002579, 0.0782187432050705, 0.10245265066623688, 0.07752983272075653, 0.08162705600261688, 0.07976598292589188, 0.10447926819324493, 0.10597527027130127, 0.10749270766973495, 0.11317338794469833], [0.07404107600450516, 0.07856225967407227, 0.07956777513027191, 0.10129480063915253, 0.07894060760736465, 0.0826621875166893, 0.08097424358129501, 0.10308533161878586, 0.10440471023321152, 0.1057409718632698, 0.11072603613138199], [0.07444585859775543, 0.0788734182715416, 0.07985721528530121, 0.10104423016309738, 0.07924362272024155, 0.0828828364610672, 0.08123277127742767, 0.10278475284576416, 0.10406679660081863, 0.1053648293018341, 0.11020365357398987], [0.08235304057598114, 0.08480224758386612, 0.08533718436956406, 0.09615699201822281, 0.08500391989946365, 0.08696231245994568, 0.08607971668243408, 0.09699367731809616, 0.09760551899671555, 0.09822121262550354, 0.10048411041498184], [0.07419383525848389, 0.07867978513240814, 0.07967711240053177, 0.10120023041963577, 0.079055055975914, 0.08274559676647186, 0.08107192814350128, 0.10297183692455292, 0.1042770966887474, 0.10559888929128647, 0.11052858084440231], [0.07566743344068527, 0.0798078253865242, 0.08072532713413239, 0.10028812289237976, 0.08015318959951401, 0.08354157209396362, 0.08200670778751373, 0.10188005119562149, 0.10305128991603851, 0.10423599928617477, 0.10864247381687164], [0.07500553131103516, 0.07930237054824829, 0.08025592565536499, 0.10069779306650162, 0.07966124266386032, 0.08318596333265305, 0.08158852159976959, 0.10236980766057968, 0.10360074043273926, 0.10484647005796432, 0.10948555171489716], [0.0829428881406784, 0.08523336052894592, 0.08573300391435623, 0.09579349309206009, 0.08542176336050034, 0.08724956214427948, 0.08642618358135223, 0.0965680256485939, 0.09713411331176758, 0.09770351648330688, 0.09979411959648132], [0.08337230235338211, 0.08554626256227493, 0.08602005243301392, 0.0955289825797081, 0.08572493493556976, 0.08745724707841873, 0.08667712658643723, 0.09625869244337082, 0.0967918187379837, 0.09732789546251297, 0.09929467737674713], [0.08380281180143356, 0.08585915714502335, 0.08630690723657608, 0.09526392072439194, 0.08602802455425262, 0.08766423165798187, 0.086927630007267, 0.09594906866550446, 0.09644943475723267, 0.096952423453331, 0.09879640489816666], [0.08537126332521439, 0.0869923084974289, 0.08734411746263504, 0.09429926425218582, 0.08712504059076309, 0.08840811997652054, 0.08783116191625595, 0.09482509642839432, 0.09520859271287918, 0.09559363126754761, 0.09700141847133636]], [[0.052602801471948624, 0.06401605904102325, 0.05517897382378578, 0.06715116649866104, 0.05633239448070526, 0.05539500340819359, 0.06741408258676529, 0.058107905089855194, 0.4029194116592407, 0.06336271017789841, 0.057519447058439255], [0.077969029545784, 0.08449817448854446, 0.07951077073812485, 0.08616901934146881, 0.08018729090690613, 0.07963811606168747, 0.08630702644586563, 0.08121286332607269, 0.17948871850967407, 0.08414392173290253, 0.08087503165006638], [0.05932289734482765, 0.07018456608057022, 0.06180187687277794, 0.07311742752790451, 0.06290636211633682, 0.062008991837501526, 0.07336246967315674, 0.06460021436214447, 0.3390846848487854, 0.06957078725099564, 0.06403964757919312], [0.08296561241149902, 0.08741028606891632, 0.08402656763792038, 0.08852807432413101, 0.08448982238769531, 0.08411387354135513, 0.08862005919218063, 0.08518951386213303, 0.14252454042434692, 0.08717229962348938, 0.08495937287807465], [0.06215862184762955, 0.07264663279056549, 0.06456377357244492, 0.0754576101899147, 0.06563310325145721, 0.06476440280675888, 0.07569209486246109, 0.06727038323879242, 0.31302717328071594, 0.07205729186534882, 0.06672889739274979], [0.059862732887268066, 0.07066001743078232, 0.0623292438685894, 0.07357140630483627, 0.06342773139476776, 0.06253526359796524, 0.07381457835435867, 0.06511187553405762, 0.3340819776058197, 0.07005053013563156, 0.0645546019077301], [0.08335132151842117, 0.0876142755150795, 0.08436980098485947, 0.08868483453989029, 0.08481433242559433, 0.08445358276367188, 0.08877291530370712, 0.08548552542924881, 0.13980241119861603, 0.08738626539707184, 0.08526478707790375], [0.06629166752099991, 0.07607033848762512, 0.0685502216219902, 0.07866206020116806, 0.06955117732286453, 0.0687381699681282, 0.07887773215770721, 0.07108008861541748, 0.27607807517051697, 0.07552548497915268, 0.07057493180036545], [0.17224493622779846, 0.06299878656864166, 0.1348303109407425, 0.04931434616446495, 0.12127382308244705, 0.1321585476398468, 0.048337142914533615, 0.10345140099525452, 5.09474102727836e-06, 0.06639757752418518, 0.10898803919553757], [0.07682938873767853, 0.08376897871494293, 0.07846423983573914, 0.08555149286985397, 0.07918236404657364, 0.07859937846660614, 0.08569884300231934, 0.0802718922495842, 0.18832921981811523, 0.08339139819145203, 0.07991287112236023], [0.0649537667632103, 0.07498439401388168, 0.0672651007771492, 0.07765267789363861, 0.06829052418470383, 0.06745760142803192, 0.07787489891052246, 0.06985803693532944, 0.28789910674095154, 0.07442395389080048, 0.06933996081352234]], [[0.07158643007278442, 0.07369128614664078, 0.07758566737174988, 0.10162343829870224, 0.07982342690229416, 0.07800347357988358, 0.08212573081254959, 0.10757012665271759, 0.10911039263010025, 0.10662270337343216, 0.11225740611553192], [0.0724259614944458, 0.07445590943098068, 0.0782046988606453, 0.10116691887378693, 0.08035484701395035, 0.07860635966062546, 0.08256412297487259, 0.10680633783340454, 0.10826464742422104, 0.1059088483452797, 0.11124126613140106], [0.07393109053373337, 0.07582288980484009, 0.0793050229549408, 0.10034554451704025, 0.08129572123289108, 0.07967724651098251, 0.08333637565374374, 0.1054464802145958, 0.10676171630620956, 0.10463626682758331, 0.10944163054227829], [0.08208457380533218, 0.0831434428691864, 0.08505897223949432, 0.09584350883960724, 0.08613546192646027, 0.0852612629532814, 0.08722557127475739, 0.09828481823205948, 0.0989048033952713, 0.09790100157260895, 0.1001565232872963], [0.0747692808508873, 0.07658201456069946, 0.07991252839565277, 0.09988658130168915, 0.08181311935186386, 0.08026809990406036, 0.08375890552997589, 0.10469436645507812, 0.10593204200267792, 0.10393154621124268, 0.1084514632821083], [0.07408902049064636, 0.07596603780984879, 0.07941976934671402, 0.10025914758443832, 0.08139356225728989, 0.07978887110948563, 0.0834164023399353, 0.10530448704957962, 0.10660499334335327, 0.10450327396392822, 0.10925441235303879], [0.07561250776052475, 0.07734417915344238, 0.08051993697881699, 0.0994238555431366, 0.08232894539833069, 0.08085855096578598, 0.08417860418558121, 0.10394147783517838, 0.10510259866714478, 0.1032254695892334, 0.10746390372514725], [0.08385680615901947, 0.08471602201461792, 0.0862646996974945, 0.0948561429977417, 0.08713188767433167, 0.08642783015966415, 0.08800780028104782, 0.09677284210920334, 0.09725803881883621, 0.09647215157747269, 0.09823574125766754], [0.08430268615484238, 0.0851106345653534, 0.08656557649374008, 0.0946073830127716, 0.08737955242395401, 0.08671873807907104, 0.08820117264986038, 0.09639492630958557, 0.0968470573425293, 0.09611465036869049, 0.09775770455598831], [0.08357994258403778, 0.08447077870368958, 0.08607736974954605, 0.09501056373119354, 0.0869775041937828, 0.08624666929244995, 0.08788704127073288, 0.09700803458690643, 0.09751392900943756, 0.09669457376003265, 0.09853365272283554], [0.08519773185253143, 0.08590151369571686, 0.08716657757759094, 0.09410758316516876, 0.08787303417921066, 0.08729957044124603, 0.08858521282672882, 0.0956391915678978, 0.0960259810090065, 0.09539931267499924, 0.09680423885583878]], [[0.0578625462949276, 0.06759316474199295, 0.05752149969339371, 0.07062748819589615, 0.060103703290224075, 0.05918450281023979, 0.07088141143321991, 0.06184136122465134, 0.366159051656723, 0.06695929914712906, 0.06126592680811882], [0.07884056121110916, 0.0844988003373146, 0.07863301038742065, 0.08616966754198074, 0.08018788695335388, 0.07963871210813522, 0.08630767464637756, 0.08121346682310104, 0.17949005961418152, 0.08414454758167267, 0.08087563514709473], [0.05696391686797142, 0.06676173210144043, 0.056621111929416656, 0.06982332468032837, 0.0592176653444767, 0.05829308554530144, 0.07007965445518494, 0.060966309159994125, 0.374763548374176, 0.06612254679203033, 0.060387130826711655], [0.08356612175703049, 0.087410569190979, 0.08342329412698746, 0.08852836489677429, 0.084490105509758, 0.08411414176225662, 0.08862034976482391, 0.08518978953361511, 0.14252498745918274, 0.08717257529497147, 0.08495964854955673], [0.06351327151060104, 0.07264823466539383, 0.06318950653076172, 0.07545928657054901, 0.06563454866409302, 0.06476584076881409, 0.0756937637925148, 0.0672718733549118, 0.3130343556404114, 0.07205888628959656, 0.06673037260770798], [0.06125125288963318, 0.07066173851490021, 0.060919228941202164, 0.07357318699359894, 0.06342926621437073, 0.06253677606582642, 0.07381636649370193, 0.06511345505714417, 0.33409029245376587, 0.07005222141742706, 0.06455616652965546], [0.08392783999443054, 0.0876145288348198, 0.08379073441028595, 0.08868511021137238, 0.08481458574533463, 0.08445382863283157, 0.08877316862344742, 0.0854857787489891, 0.13980281352996826, 0.08738652616739273, 0.08526504039764404], [0.06756491959095001, 0.07607173919677734, 0.06726089119911194, 0.07866352051496506, 0.0695524662733078, 0.06873944401741028, 0.07887919247150421, 0.07108139991760254, 0.2760833501815796, 0.0755268856883049, 0.07057622820138931], [0.1502397656440735, 0.06314058601856232, 0.15527544915676117, 0.04942534118890762, 0.1215469092130661, 0.13245610892772675, 0.0484459362924099, 0.10368432104587555, 5.106167009216733e-06, 0.06654705107212067, 0.10923342406749725], [0.07775326818227768, 0.08376967161893845, 0.07753318548202515, 0.08555220067501068, 0.07918300479650497, 0.07860001921653748, 0.08569953590631485, 0.08027254045009613, 0.18833082914352417, 0.08339208364486694, 0.07991352677345276], [0.06625638902187347, 0.07498587667942047, 0.06594525277614594, 0.07765420526266098, 0.06829187273979187, 0.06745892763137817, 0.07787642627954483, 0.06985940784215927, 0.2879049479961395, 0.07442542165517807, 0.06934132426977158]], [[0.07224571704864502, 0.07629649341106415, 0.07745429128408432, 0.09909731894731522, 0.0798228308558464, 0.07789621502161026, 0.08226381987333298, 0.10949064791202545, 0.10684794187545776, 0.10846934467554092, 0.11011535674333572], [0.07361232489347458, 0.07741226255893707, 0.07849544286727905, 0.09853259474039078, 0.08070749789476395, 0.07890856266021729, 0.0829818919301033, 0.10802971571683884, 0.10562178492546082, 0.10709968209266663, 0.1085982695221901], [0.073992058634758, 0.07772095501422882, 0.07878311723470688, 0.09837446361780167, 0.08095116168260574, 0.07918811589479446, 0.08317888528108597, 0.10762680321931839, 0.10528278350830078, 0.10672159492969513, 0.10818008333444595], [0.08035067468881607, 0.08280595391988754, 0.08349690586328506, 0.09565667808055878, 0.08489615470170975, 0.08375941962003708, 0.08631885796785355, 0.10106803476810455, 0.09971475601196289, 0.10054679960012436, 0.10138578712940216], [0.07475466281175613, 0.07833918184041977, 0.07935870438814163, 0.0980554074048996, 0.08143772184848785, 0.0797472894191742, 0.08357120305299759, 0.10682155936956406, 0.10460421442985535, 0.10596554726362228, 0.1073446050286293], [0.07413577288389206, 0.07783763855695724, 0.0788917988538742, 0.09831448644399643, 0.08104313910007477, 0.07929372042417526, 0.0832531526684761, 0.10747463256120682, 0.10515465587377548, 0.1065787747502327, 0.10802217572927475], [0.07552141696214676, 0.07895845174789429, 0.07993458211421967, 0.09773257374763489, 0.08192317932844162, 0.08030645549297333, 0.08396126329898834, 0.10601712763309479, 0.10392490774393082, 0.10520968586206436, 0.10651034116744995], [0.08299959450960159, 0.08487822115421295, 0.08540431410074234, 0.09448985755443573, 0.08646628260612488, 0.08560389280319214, 0.08754146099090576, 0.09843645989894867, 0.09745468199253082, 0.09805871546268463, 0.09866649657487869], [0.0823468267917633, 0.08437003940343857, 0.08493728935718536, 0.09477908909320831, 0.08608327060937881, 0.08515257388353348, 0.08724471181631088, 0.09907963871955872, 0.0980084240436554, 0.09866737574338913, 0.09933076053857803], [0.08274892717599869, 0.08468326181173325, 0.08522520214319229, 0.09460105746984482, 0.08631949871778488, 0.0854308232665062, 0.08742785453796387, 0.09868305176496506, 0.09766709059476852, 0.09829211980104446, 0.09892114251852036], [0.08315196633338928, 0.08499661087989807, 0.08551303297281265, 0.09442219883203506, 0.08655531704425812, 0.08570893853902817, 0.08761030435562134, 0.09828684478998184, 0.09732574224472046, 0.09791707247495651, 0.09851200133562088]], [[0.057867683470249176, 0.06930435448884964, 0.05897771194577217, 0.0688958689570427, 0.058630093932151794, 0.060682814568281174, 0.07088771462440491, 0.06032514572143555, 0.3661920428276062, 0.0669652447104454, 0.061271365731954575], [0.08159121870994568, 0.08701877295970917, 0.08214669674634933, 0.08683526515960693, 0.08197347074747086, 0.08298701792955399, 0.08772355318069458, 0.08281203359365463, 0.1576799601316452, 0.08595838397741318, 0.08327355980873108], [0.06072314828634262, 0.07184121757745743, 0.061808355152606964, 0.07144637405872345, 0.06146866828203201, 0.06347265094518661, 0.07337018102407455, 0.06312380731105804, 0.33912110328674316, 0.06957810372114182, 0.06404638290405273], [0.08095532655715942, 0.08666934072971344, 0.08153911679983139, 0.08647579699754715, 0.08135703951120377, 0.08242271095514297, 0.08741288632154465, 0.08223866671323776, 0.16265363991260529, 0.08555128425359726, 0.08272413164377213], [0.05984062701463699, 0.07106668502092361, 0.060934457927942276, 0.07066729664802551, 0.06059201806783676, 0.06261280179023743, 0.07261372357606888, 0.062260933220386505, 0.3474416732788086, 0.06877817958593369, 0.06319162249565125], [0.0648883804678917, 0.07537521421909332, 0.06592065095901489, 0.07500599324703217, 0.06559773534536362, 0.06749992817640305, 0.07680293172597885, 0.06716927886009216, 0.3004407286643982, 0.07325587421655655, 0.0680432990193367], [0.08392863720655441, 0.08822111785411835, 0.08437085151672363, 0.08807699382305145, 0.08423301577568054, 0.08503852784633636, 0.08877401053905487, 0.08489961177110672, 0.13980410993099213, 0.08738735318183899, 0.08526584506034851], [0.06403780728578568, 0.07467042654752731, 0.0650825947523117, 0.07429539412260056, 0.06475573033094406, 0.06668183207511902, 0.0761210173368454, 0.06634693592786789, 0.30825746059417725, 0.07251840829849243, 0.06723229587078094], [0.1509304940700531, 0.05520287901163101, 0.13575519621372223, 0.05705315247178078, 0.14030541479587555, 0.11580456048250198, 0.048668596893548965, 0.1196860820055008, 5.129566488903947e-06, 0.06685294955968857, 0.10973559319972992], [0.07775532454252243, 0.0847785547375679, 0.07846695929765701, 0.08453858643770218, 0.07824485749006271, 0.07954664528369904, 0.08570181578397751, 0.07932148873806, 0.18833591043949127, 0.08339428156614304, 0.07991564273834229], [0.06626058369874954, 0.076493039727211, 0.0672706887125969, 0.07613382488489151, 0.06695478409528732, 0.06881479173898697, 0.07788137346506119, 0.068491630256176, 0.2879234552383423, 0.07443013787269592, 0.06934572011232376]]], "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 3.345132790855132e-05, "vf_explained_var": 0.00014394521713256836, "total_loss": 0.27786147594451904, "policy_loss": -0.0002117719704983756, "num_module_steps_trained_lifetime": 83790, "use_intrinsic_rewards": 0.0, "num_module_steps_trained": 5985, "vf_loss": 0.35830721259117126, "weights_seq_no": 14.0, "module_train_batch_size_mean": 997.7135120670981, "curr_kl_coeff": 9.862300430540927e-06, "curr_entropy_coeff": 0.0015431216992, "entropy": 0.6910313963890076, "vf_loss_unclipped": 43.00327682495117, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 745.9637257317212}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"module_train_batch_size_mean": 997.5006590853257, "total_loss": 0.0, "num_module_steps_trained_lifetime": 502740, "diff_num_grad_updates_vs_sampler_policy": 71.0, "num_module_steps_trained": 35910, "weights_seq_no": 84.0}, "default_policy": {"policy_loss": -0.0002069440670311451, "num_module_steps_trained_lifetime": 502740, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35910, "vf_loss": 0.35833173990249634, "weights_seq_no": 84.0, "module_train_batch_size_mean": 997.5006590853257, "entropy": 0.6910387277603149, "vf_loss_unclipped": 43.141395568847656, "diff_num_grad_updates_vs_sampler_policy": 71.0, "mean_kl_loss": 3.251344969612546e-05, "vf_explained_var": -0.0025904178619384766, "total_loss": 0.2778906524181366}, "__all_modules__": {"num_env_steps_trained": 198000, "num_module_steps_trained_lifetime": 1005480, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 2772000, "num_env_steps_trained_lifetime_throughput": 47480.50631631267}}}, "intrinsic_reward_module": {"curr_entropy_coeff": 0.0015431216992, "default_optimizer_learning_rate": 0.0002715581955, "module_train_batch_size_mean": 997.7135120670981, "total_loss": 0.0, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 83790, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "weights_seq_no": 14.0, "num_module_steps_trained_lifetime_throughput": 745.9730265433784}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 462000, "num_env_steps_trained": 33000, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 167580, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 4114.293470956939, "num_module_steps_trained_throughput": 22603125.369672444, "num_module_steps_trained_lifetime_throughput": 13985594.187498279}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 280, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -0.2}, "episode_len_min": 20, "weights_seq_no": 14.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.936288409875395e-06, "numpy_to_tensor": 1.4231042780939952e-05, "add_observations_from_episodes_to_batch": 3.0996355051405366e-06, "add_time_dim_to_batch_and_zero_pad": 7.76244877442391e-06, "batch_individual_items": 1.3499782513554582e-05}}, "connector_pipeline_timer": 6.49662704964366e-05}, "num_env_steps_sampled": 400, "env_reset_timer": 0.0001980889983954554, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.300791260111918e-05, "get_actions": 4.4598243905172435e-05, "listify_data_for_vector_env": 1.2124521789346637e-05, "un_batch_to_individual_items": 7.4105353521785655e-06, "tensor_to_numpy": 1.7411538228547566e-05, "normalize_and_clip_actions": 8.787905515083662e-06}}, "connector_pipeline_timer": 0.0001330644199792365}, "episode_len_max": 20, "env_step_timer": 1.6779753063789665e-05, "rlmodule_inference_timer": 3.5345271525405256e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": -0.2}, "episode_len_mean": 20.0, "episode_return_min": -14.5, "episode_return_mean": -0.2, "num_env_steps_sampled_lifetime": 70400, "sample": 0.11705124696125567, "episode_duration_sec_mean": 0.005724332821555436, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "episode_return_max": 14.5, "time_between_sampling": 9.648681220184585}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "aec1c_00000", "date": "2025-08-11_18-41-29", "timestamp": 1754930489, "time_this_iter_s": 9.867100715637207, "time_total_s": 139.97710061073303, "pid": 11610, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3842f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 139.97710061073303, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 37.74285714285714, "ram_util_percent": 77.97142857142858}}
{"timers": {"training_iteration": 9.850577742383432, "restore_env_runners": 8.5716923120025e-06, "training_step": 9.850405052594516, "env_runner_sampling_timer": 1.6348704852800473, "learner_update_timer": 8.03188195783408, "synch_weights": 0.0011215351917356865, "restore_eval_env_runners": 2.0996984297427873e-05, "evaluation_iteration": 0.12390696210855255, "synch_eval_env_connectors": 0.00016204837852466572, "synch_env_connectors": 5.383723481563421e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.6598069665302623e-05, "normalize_and_clip_actions": 8.299233177761389e-06, "get_actions": 4.28907505657372e-05, "un_batch_to_individual_items": 6.830157283776592e-06, "remove_single_ts_time_rank_from_batch": 1.2167899765251203e-05, "listify_data_for_vector_env": 1.1036523545388258e-05}}, "connector_pipeline_timer": 0.00012561757954918868}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.229232832981595e-06, "numpy_to_tensor": 1.337624984521806e-05, "add_states_from_episodes_to_batch": 2.7471868315055752e-06, "add_observations_from_episodes_to_batch": 2.857342262351932e-06, "batch_individual_items": 1.2806066867852593e-05}}, "connector_pipeline_timer": 6.191075158713957e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "rlmodule_inference_timer": 3.3949089007299276e-05, "episode_len_mean": 20.0, "episode_return_min": -11.5, "weights_seq_no": 14.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_mean": -1.6599999999999997, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime": -8017500.0, "num_env_steps_sampled": 5000.0, "sample": 0.0060061887889832554, "env_reset_timer": 3.958140075883998e-05, "episode_duration_sec_mean": 0.00557741151144728, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -400875.0, "time_between_sampling": 0.033955200318898676, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": -1.6599999999999997}, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.4665846734339932e-05, "module_episode_returns_mean": {"default_policy": -1.6599999999999997}, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 3113.5531487813855}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1445811856668975, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008926136106081591, "add_observations_from_episodes_to_batch": 0.000833618156838304, "add_columns_from_episodes_to_train_batch": 0.04159648677387716, "add_time_dim_to_batch_and_zero_pad": 0.07610276497458514, "add_states_from_episodes_to_batch": 0.003571940765740288, "batch_individual_items": 0.01335096013731639, "numpy_to_tensor": 7.119712771634784e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"IntrinsicAttentionMask": [[[0.07229074835777283, 0.07724299281835556, 0.07548186928033829, 0.09886788576841354, 0.07765895128250122, 0.07877093553543091, 0.07989883422851562, 0.1086285337805748, 0.1101839616894722, 0.1117616519331932, 0.10921350866556168], [0.07416363805532455, 0.07869231700897217, 0.07708544284105301, 0.09813468158245087, 0.0790712833404541, 0.08008331060409546, 0.08110829442739487, 0.10675756633281708, 0.10812395066022873, 0.10950781404972076, 0.10727167874574661], [0.07350905239582062, 0.0781877189874649, 0.07652632892131805, 0.09839298576116562, 0.07857975363731384, 0.07962704449892044, 0.08068828284740448, 0.10740917921066284, 0.1088406890630722, 0.11029127985239029, 0.10794771462678909], [0.08133956044912338, 0.08408860117197037, 0.08312132954597473, 0.09517234563827515, 0.08431544899940491, 0.08491893112659454, 0.0855267271399498, 0.09977508336305618, 0.10048921406269073, 0.10120844841003418, 0.10004425048828125], [0.07431647926568985, 0.07880982756614685, 0.077215775847435, 0.0980740562081337, 0.07918572425842285, 0.08018947392702103, 0.08120594173669815, 0.10660577565431595, 0.10795708745718002, 0.10932553559541702, 0.10711424797773361], [0.0747218057513237, 0.0791209414601326, 0.07756105810403824, 0.0979127585887909, 0.07948865741491318, 0.08047034591436386, 0.08146416395902634, 0.10620392113924026, 0.10751554369926453, 0.1088433712720871, 0.10669750720262527], [0.07512817531824112, 0.07943203300237656, 0.07790668308734894, 0.0977502092719078, 0.07979150116443634, 0.0807509496808052, 0.08172193169593811, 0.10580193996429443, 0.10707414150238037, 0.10836164653301239, 0.10628073662519455], [0.08415385335683823, 0.08613839000463486, 0.08544235676527023, 0.09395190328359604, 0.086301289498806, 0.08673398196697235, 0.08716884255409241, 0.09711563587188721, 0.09760255366563797, 0.09809190779924393, 0.09729929268360138], [0.08458227664232254, 0.08644720166921616, 0.08579344302415848, 0.09376351535320282, 0.08660014718770981, 0.0870063453912735, 0.08741445094347, 0.09671462327241898, 0.09716825932264328, 0.09762401878833771, 0.09688573330640793], [0.08501158654689789, 0.08675578236579895, 0.08614464104175568, 0.09357406944036484, 0.08689872175455093, 0.08727823197841644, 0.08765940368175507, 0.09631378203630447, 0.0967344120144844, 0.09715687483549118, 0.09647245705127716], [0.08431558310985565, 0.08625506609678268, 0.08557496219873428, 0.09388086199760437, 0.08641421049833298, 0.08683691918849945, 0.08726169168949127, 0.09696412831544876, 0.09743843972682953, 0.09791506826877594, 0.0971430242061615]], [[0.05251028388738632, 0.06566055119037628, 0.05508190393447876, 0.0670330673456192, 0.056233301758766174, 0.05529756098985672, 0.06729552149772644, 0.058005694299936295, 0.402212530374527, 0.06325127184391022, 0.05741826817393303], [0.08080469816923141, 0.08695000410079956, 0.08208178728818893, 0.08754198253154755, 0.08264061063528061, 0.08218704164028168, 0.0876542404294014, 0.08348599076271057, 0.15755535662174225, 0.08589046448469162, 0.08320775628089905], [0.05922514572739601, 0.07171531766653061, 0.06170003116130829, 0.07299697399139404, 0.06280270218849182, 0.06190681457519531, 0.07324160635471344, 0.06449376791715622, 0.3385273218154907, 0.06945616006851196, 0.06393413990736008], [0.08291318267583847, 0.0879870355129242, 0.0839734598994255, 0.08847212791442871, 0.08443643152713776, 0.08406072109937668, 0.08856405317783356, 0.08513567596673965, 0.14243441820144653, 0.08711721003055573, 0.08490568399429321], [0.062060389667749405, 0.07411093264818192, 0.06446174532175064, 0.07533838599920273, 0.06552937626838684, 0.06466205418109894, 0.07557249814271927, 0.06716408580541611, 0.3125336766242981, 0.07194343954324722, 0.06662345677614212], [0.0597648024559021, 0.07217898964881897, 0.0622272752225399, 0.07345107197761536, 0.0633239671587944, 0.06243295222520828, 0.07369384914636612, 0.065005362033844, 0.3335367441177368, 0.06993594765663147, 0.0644489973783493], [0.0833008661866188, 0.08816660940647125, 0.08431871980428696, 0.08863114565610886, 0.08476298302412033, 0.08440245687961578, 0.08871916681528091, 0.08543377369642258, 0.1397177278995514, 0.08733335882425308, 0.08521316945552826], [0.06619497388601303, 0.07741691917181015, 0.06845023483037949, 0.07854735851287842, 0.06944973766803741, 0.068637914955616, 0.0787627100944519, 0.07097641378641129, 0.27567633986473083, 0.07541535049676895, 0.07047199457883835], [0.17366433143615723, 0.055278480052948, 0.13594134151935577, 0.04972050338983536, 0.12227311730384827, 0.1332475244998932, 0.048735253512859344, 0.10430379211902618, 5.13651912115165e-06, 0.06694454699754715, 0.10988599061965942], [0.07675209641456604, 0.08469033986330032, 0.07838530093431473, 0.0854654386639595, 0.07910270988941193, 0.07852030545473099, 0.08561263978481293, 0.08019113540649414, 0.18814003467559814, 0.08330750465393066, 0.07983248680830002], [0.06485627591609955, 0.07637190073728561, 0.06716414541006088, 0.07753615081310272, 0.06818801909685135, 0.06735635548830032, 0.07775802910327911, 0.06975318491458893, 0.2874677777290344, 0.0743122547864914, 0.0692358911037445]], [[0.07246372848749161, 0.07652674615383148, 0.07768802344799042, 0.09939642250537872, 0.07696337252855301, 0.08127867430448532, 0.07931691408157349, 0.10556845366954803, 0.10717043280601501, 0.11317944526672363, 0.1104477122426033], [0.07382047176361084, 0.0776311531662941, 0.07871740311384201, 0.09881123900413513, 0.07803972065448761, 0.08206818997859955, 0.08023892343044281, 0.10445884615182877, 0.10592047870159149, 0.1113881915807724, 0.10890539735555649], [0.07419728487730026, 0.07793653756380081, 0.07900163531303406, 0.09864737838506699, 0.07833719253540039, 0.0822850689291954, 0.08049296587705612, 0.10415150225162506, 0.10557485371828079, 0.11089541018009186, 0.10848020017147064], [0.08049626648426056, 0.08295600116252899, 0.0836481973528862, 0.09583001583814621, 0.08321680873632431, 0.08575966209173203, 0.08461136370897293, 0.09906879812479019, 0.09989544749259949, 0.10294795781373978, 0.1015695109963417], [0.07396270334720612, 0.07774648815393448, 0.07882476598024368, 0.09874945878982544, 0.07815206795930862, 0.0821501761674881, 0.08033492416143417, 0.10434279590845108, 0.10578994452953339, 0.1112019494175911, 0.10874474048614502], [0.07533352077007294, 0.07885386049747467, 0.07985437661409378, 0.09814988076686859, 0.07923033833503723, 0.08293276280164719, 0.08125369250774384, 0.1032269150018692, 0.10453668236732483, 0.10942168533802032, 0.1072063073515892], [0.07471802830696106, 0.07835760712623596, 0.07939326018095016, 0.09841999411582947, 0.0787472277879715, 0.08258306235074997, 0.08084259927272797, 0.10372733324766159, 0.10509829223155975, 0.11021772027015686, 0.10789483040571213], [0.08207304775714874, 0.0841875821352005, 0.08478088676929474, 0.09510388225317001, 0.08441121876239777, 0.08658599108457565, 0.08560516685247421, 0.09781329333782196, 0.09850262105464935, 0.10104045271873474, 0.0998958870768547], [0.0824693888425827, 0.08449561148881912, 0.08506371080875397, 0.09492015838623047, 0.0847097635269165, 0.0867910236120224, 0.08585266768932343, 0.09749878197908401, 0.09815429896116257, 0.10056588798761368, 0.09947860985994339], [0.0839121863245964, 0.08561168611049652, 0.08608690649271011, 0.09424757957458496, 0.08579089492559433, 0.08752844482660294, 0.0867459625005722, 0.09635768830776215, 0.09689255803823471, 0.09885495156049728, 0.09797121584415436], [0.08326465636491776, 0.08511179685592651, 0.0856289267539978, 0.09455017000436783, 0.08530677855014801, 0.08719921857118607, 0.08634654432535172, 0.0968690812587738, 0.0974576398730278, 0.09961964190006256, 0.09864550828933716]], [[0.05767958238720894, 0.06907910853624344, 0.05878600850701332, 0.07040420174598694, 0.05843951925635338, 0.06048556789755821, 0.07065732777118683, 0.06164581701159477, 0.3650031089782715, 0.06674759835004807, 0.0610722154378891], [0.08146773278713226, 0.08688706904649734, 0.08202236890792847, 0.08747860789299011, 0.08184941112995148, 0.08286142349243164, 0.0875907838344574, 0.08342555910348892, 0.15744131803512573, 0.0858282744884491, 0.08314753323793411], [0.060531675815582275, 0.07161470502614975, 0.06161347031593323, 0.07289455831050873, 0.06127484142780304, 0.06327251344919205, 0.07313884794712067, 0.06440328061580658, 0.3380529284477234, 0.0693587139248848, 0.06384443491697311], [0.08346283435821533, 0.08793414384126663, 0.08392298966646194, 0.08841894567012787, 0.08377955853939056, 0.084617979824543, 0.08851081877946854, 0.08508449792861938, 0.14234879612922668, 0.08706483989953995, 0.08485465496778488], [0.05964997783303261, 0.07084028422832489, 0.06074032187461853, 0.07213518768548965, 0.060398977249860764, 0.06241333484649658, 0.07238240540027618, 0.06355419009923935, 0.3463359475135803, 0.06855908036231995, 0.06299030035734177], [0.06469598412513733, 0.07515174895524979, 0.06572519987821579, 0.07634729146957397, 0.06540324538946152, 0.06729979068040848, 0.07657523453235626, 0.06837041676044464, 0.2995508909225464, 0.07303868234157562, 0.0678415596485138], [0.0838283821940422, 0.08811572939157486, 0.08427006751298904, 0.08857999742031097, 0.08413239568471909, 0.0849369466304779, 0.08866796642541885, 0.08538446575403214, 0.1396370828151703, 0.08728295564651489, 0.08516398817300797], [0.06737887114286423, 0.07731796056032181, 0.06836272031068802, 0.07844693958759308, 0.06805509328842163, 0.06986550241708755, 0.07866202294826508, 0.07088566571474075, 0.275324285030365, 0.07531893998384476, 0.07038190960884094], [0.15447202324867249, 0.056498005986213684, 0.13894063234329224, 0.05081740394234657, 0.14359760284423828, 0.11852181702852249, 0.049810413271188736, 0.10660502314567566, 5.249754394753836e-06, 0.06842147558927536, 0.11231034994125366], [0.07760249078273773, 0.0846119225025177, 0.07831272482872009, 0.08538631349802017, 0.07809105515480042, 0.07939028739929199, 0.08553337305784225, 0.0801168829202652, 0.18796595931053162, 0.08323036879301071, 0.07975857704877853], [0.0660691112279892, 0.07627200335264206, 0.06707628816366196, 0.0774347260594368, 0.06676129251718521, 0.06861592829227448, 0.0776563212275505, 0.069661945104599, 0.28709205985069275, 0.07421505451202393, 0.0691453292965889]], [[0.0721469447016716, 0.07426828891038895, 0.07819316536188126, 0.09867125749588013, 0.0804484486579895, 0.0786142349243164, 0.08276878297328949, 0.10841250419616699, 0.10594071447849274, 0.11153938621282578, 0.10899630934000015], [0.07296361774206161, 0.07500863820314407, 0.0787852481007576, 0.09835737198591232, 0.08095137029886246, 0.07918989658355713, 0.08317704498767853, 0.10759931802749634, 0.10525799542665482, 0.11055764555931091, 0.10815194994211197], [0.07442725449800491, 0.07633175700902939, 0.07983725517988205, 0.09778822213411331, 0.08184131234884262, 0.08021198213100433, 0.08389568328857422, 0.10615424811840057, 0.10404088348150253, 0.1088189110159874, 0.10665249824523926], [0.08122945576906204, 0.08241891860961914, 0.08457581698894501, 0.09504353255033493, 0.08579082787036896, 0.0848039761185646, 0.0870233029127121, 0.09964003413915634, 0.09849387407302856, 0.10107145458459854, 0.09990882873535156], [0.07524210959672928, 0.0770663246512413, 0.08041788637638092, 0.0974678248167038, 0.08233050256967545, 0.08077570050954819, 0.0842885971069336, 0.10535652935504913, 0.1033668965101242, 0.10786226391792297, 0.10582531243562698], [0.07458081096410751, 0.07647029310464859, 0.07994694262742996, 0.09772803634405136, 0.08193384110927582, 0.08031849563121796, 0.08397011458873749, 0.10600356757640839, 0.10391367971897125, 0.10863803327083588, 0.10649622231721878], [0.07606170326471329, 0.07780366390943527, 0.08099827915430069, 0.09714313596487045, 0.08281804621219635, 0.08133890479803085, 0.08467869460582733, 0.1045590490102768, 0.10269162058830261, 0.10690814256668091, 0.10499875992536545], [0.08406776189804077, 0.08492913842201233, 0.08648170530796051, 0.09385579824447632, 0.08735107630491257, 0.08664524555206299, 0.08822918683290482, 0.09701628983020782, 0.09623236209154129, 0.09799156337976456, 0.09719975292682648], [0.08336810767650604, 0.08431196957826614, 0.0860157161951065, 0.09415066987276077, 0.08697114884853363, 0.08619537204504013, 0.08793719112873077, 0.09765805304050446, 0.09678695350885391, 0.09874279797077179, 0.09786202013492584], [0.08493418991565704, 0.08569197356700897, 0.08705534040927887, 0.09348887950181961, 0.08781738579273224, 0.08719876408576965, 0.08858610689640045, 0.09622609615325928, 0.09554823487997055, 0.0970684140920639, 0.09638462960720062], [0.08423109352588654, 0.0850730687379837, 0.08659014105796814, 0.09378679096698761, 0.08743934333324432, 0.08674990385770798, 0.08829687535762787, 0.09686695784330368, 0.09610318392515182, 0.09781695157289505, 0.09704568237066269]], [[0.05275706574320793, 0.06420382857322693, 0.05385986715555191, 0.06554591655731201, 0.05498571693897247, 0.05555744841694832, 0.0694708526134491, 0.05827830731868744, 0.4041043817996979, 0.06354854255914688, 0.057688139379024506], [0.0781058743596077, 0.08464647829532623, 0.07877042889595032, 0.08536668866872787, 0.0794406458735466, 0.07977788895368576, 0.08742427080869675, 0.08135539293289185, 0.17980381846427917, 0.08429159224033356, 0.08101697266101837], [0.05569266155362129, 0.06695349514484406, 0.056783705949783325, 0.06826514005661011, 0.05789612978696823, 0.058460477739572525, 0.07209161669015884, 0.06114138662815094, 0.37584230303764343, 0.06631243973970413, 0.06056055426597595], [0.08031696826219559, 0.08598592877388, 0.08089616894721985, 0.0866059958934784, 0.08147953450679779, 0.08177278935909271, 0.08837316185235977, 0.08314209431409836, 0.16289855539798737, 0.08568008989095688, 0.0828486829996109], [0.05859605222940445, 0.06958866119384766, 0.059667136520147324, 0.07086067646741867, 0.06075779348611832, 0.06131058186292648, 0.07456240057945251, 0.06393174827098846, 0.3483940362930298, 0.06896638125181198, 0.06336452811956406], [0.06003088504076004, 0.07085855305194855, 0.061088867485523224, 0.07210736721754074, 0.062165502458810806, 0.06271091848611832, 0.07573708891868591, 0.0652947798371315, 0.33502286672592163, 0.07024732232093811, 0.06473594903945923], [0.08600689470767975, 0.08896925300359726, 0.08631429076194763, 0.08928722888231277, 0.08662278205156326, 0.08677743375301361, 0.090187206864357, 0.08749590069055557, 0.12218461185693741, 0.08881199359893799, 0.08734245598316193], [0.06646218150854111, 0.07626605778932571, 0.06743264943361282, 0.07737968116998672, 0.06841728836297989, 0.0689149871468544, 0.08059808611869812, 0.07126293331384659, 0.27678993344306946, 0.07571978867053986, 0.07075649499893188], [0.16573970019817352, 0.0606190524995327, 0.14907537400722504, 0.054524097591638565, 0.13408654928207397, 0.12716715037822723, 0.04047797620296478, 0.09954411536455154, 4.901956799585605e-06, 0.06388957798480988, 0.10487152636051178], [0.0769723504781723, 0.08392486721277237, 0.07767682522535324, 0.08469296991825104, 0.07838773727416992, 0.07874562591314316, 0.08689005672931671, 0.08042125403881073, 0.18868015706539154, 0.08354657143354416, 0.08006158471107483], [0.06512477248907089, 0.07518184930086136, 0.06611756235361099, 0.07632794976234436, 0.06712548434734344, 0.0676351934671402, 0.07964425534009933, 0.0700419545173645, 0.2886584997177124, 0.07461991906166077, 0.06952252984046936]]], "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 1.3125892337484402e-06, "vf_explained_var": 0.0019382238388061523, "total_loss": 0.2780759036540985, "policy_loss": 8.026842834851777e-08, "num_module_steps_trained_lifetime": 89775, "use_intrinsic_rewards": 0.0, "num_module_steps_trained": 5985, "vf_loss": 0.35831063985824585, "weights_seq_no": 15.0, "module_train_batch_size_mean": 997.7008703380301, "curr_kl_coeff": 4.931150215270463e-06, "curr_entropy_coeff": 0.0015431216992, "entropy": 0.6910815834999084, "vf_loss_unclipped": 44.216190338134766, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 743.2500203662096}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"module_train_batch_size_mean": 997.4996962148737, "total_loss": 0.0, "num_module_steps_trained_lifetime": 538650, "diff_num_grad_updates_vs_sampler_policy": 76.0, "num_module_steps_trained": 35910, "weights_seq_no": 90.0}, "default_policy": {"policy_loss": 7.950216968310997e-06, "num_module_steps_trained_lifetime": 538650, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35910, "vf_loss": 0.3583367168903351, "weights_seq_no": 90.0, "module_train_batch_size_mean": 997.4996962148737, "entropy": 0.691070020198822, "vf_loss_unclipped": 44.455562591552734, "diff_num_grad_updates_vs_sampler_policy": 76.0, "mean_kl_loss": 1.600561063241912e-06, "vf_explained_var": -0.0025789737701416016, "total_loss": 0.27810442447662354}, "__all_modules__": {"num_env_steps_trained": 198000, "num_module_steps_trained_lifetime": 1077300, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 2970000, "num_env_steps_trained_lifetime_throughput": 46688.80047514306}}}, "intrinsic_reward_module": {"curr_entropy_coeff": 0.0015431216992, "default_optimizer_learning_rate": 0.0002715581955, "module_train_batch_size_mean": 997.7008703380301, "total_loss": 0.0, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 89775, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "weights_seq_no": 15.0, "num_module_steps_trained_lifetime_throughput": 743.2587556659824}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 495000, "num_env_steps_trained": 33000, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 179550, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 4099.283531197012, "num_module_steps_trained_throughput": 22078507.006179865, "num_module_steps_trained_lifetime_throughput": 13909170.051626008}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 300, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 0.2}, "episode_len_min": 20, "weights_seq_no": 15.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.70491484259695e-06, "numpy_to_tensor": 1.1769189015736446e-05, "add_observations_from_episodes_to_batch": 2.771568652626657e-06, "add_time_dim_to_batch_and_zero_pad": 6.706055332299291e-06, "batch_individual_items": 1.2192214294582158e-05}}, "connector_pipeline_timer": 5.780957127019378e-05}, "num_env_steps_sampled": 400, "env_reset_timer": 0.0001990868575190703, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1742224975154102e-05, "get_actions": 3.5046717151676426e-05, "listify_data_for_vector_env": 1.0363265242997185e-05, "un_batch_to_individual_items": 6.424351188803987e-06, "tensor_to_numpy": 1.4716857140614957e-05, "normalize_and_clip_actions": 7.793414949372736e-06}}, "connector_pipeline_timer": 0.00011191900304162946}, "episode_len_max": 20, "env_step_timer": 1.37077033783355e-05, "rlmodule_inference_timer": 3.023951192875819e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 0.2}, "episode_len_mean": 20.0, "episode_return_min": -14.5, "episode_return_mean": 0.2, "num_env_steps_sampled_lifetime": 75400, "sample": 0.1170116211609138, "episode_duration_sec_mean": 0.005710108258062974, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "episode_return_max": 14.5, "time_between_sampling": 9.651162561732331}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "aec1c_00000", "date": "2025-08-11_18-41-39", "timestamp": 1754930499, "time_this_iter_s": 9.991521120071411, "time_total_s": 149.96862173080444, "pid": 11610, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3842f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 149.96862173080444, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 38.01428571428572, "ram_util_percent": 79.59285714285714}}
{"timers": {"training_iteration": 9.846273297038843, "restore_env_runners": 8.625975290758328e-06, "training_step": 9.846100334988241, "env_runner_sampling_timer": 1.6338657875065037, "learner_update_timer": 8.027090634914936, "synch_weights": 0.0011183514993450801, "restore_eval_env_runners": 2.1174104712753897e-05, "evaluation_iteration": 0.12388524456716025, "synch_eval_env_connectors": 0.00016199998470766826, "synch_env_connectors": 5.371135687730725e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.552763263493967e-05, "normalize_and_clip_actions": 8.05757622748729e-06, "get_actions": 3.978401563591897e-05, "un_batch_to_individual_items": 6.585297266449552e-06, "remove_single_ts_time_rank_from_batch": 1.1840882861282934e-05, "listify_data_for_vector_env": 1.0564749768954541e-05}}, "connector_pipeline_timer": 0.00011915508320835677}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.8825567926996415e-06, "numpy_to_tensor": 1.2643083313806464e-05, "add_states_from_episodes_to_batch": 2.6861584751189874e-06, "add_observations_from_episodes_to_batch": 2.7998548686132542e-06, "batch_individual_items": 1.2464951751778306e-05}}, "connector_pipeline_timer": 5.968500416504116e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "rlmodule_inference_timer": 3.1875309940296703e-05, "episode_len_mean": 20.0, "episode_return_min": -11.5, "weights_seq_no": 15.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_mean": -1.3400000000000003, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime": -8635000.0, "num_env_steps_sampled": 5000.0, "sample": 0.005726088894055654, "env_reset_timer": 3.645391986776968e-05, "episode_duration_sec_mean": 0.005295772357843817, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -431750.0, "time_between_sampling": 0.034054908374737736, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": -1.3400000000000003}, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.3772494348958327e-05, "module_episode_returns_mean": {"default_policy": -1.3400000000000003}, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 3242.4210262561623}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.14596110465020556, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008923958495425193, "add_observations_from_episodes_to_batch": 0.0008337936454365476, "add_columns_from_episodes_to_train_batch": 0.041599604406877405, "add_time_dim_to_batch_and_zero_pad": 0.07610374607471919, "add_states_from_episodes_to_batch": 0.003572804267607326, "batch_individual_items": 0.01472800261652419, "numpy_to_tensor": 7.123849628487151e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"IntrinsicAttentionMask": [[[0.07229041308164597, 0.07338741421699524, 0.07450105249881744, 0.10315320640802383, 0.07677929848432541, 0.07794441282749176, 0.08231472969055176, 0.10531602054834366, 0.11122104525566101, 0.11290881037712097, 0.11018360406160355], [0.07267004996538162, 0.07374908030033112, 0.0748441219329834, 0.1029103472828865, 0.07708323746919632, 0.07822779566049576, 0.08251777291297913, 0.10502149909734726, 0.11078083515167236, 0.11242574453353882, 0.10976947844028473], [0.0730505958199501, 0.07411142438650131, 0.07518766075372696, 0.10266652703285217, 0.077387236058712, 0.07851104438304901, 0.08272009342908859, 0.10472625494003296, 0.11034072935581207, 0.1119430810213089, 0.10935527831315994], [0.08147991448640823, 0.08209051936864853, 0.08270569890737534, 0.09718301892280579, 0.08394991606473923, 0.08457902818918228, 0.08689754456281662, 0.09818783402442932, 0.10087939351797104, 0.10163537412881851, 0.10041183233261108], [0.07381439208984375, 0.07483813911676407, 0.07587608695030212, 0.10217610001564026, 0.07799536734819412, 0.0790771022439003, 0.08312252908945084, 0.10413362085819244, 0.10946089029312134, 0.11097902804613113, 0.10852674394845963], [0.07419762015342712, 0.07520248740911484, 0.07622096687555313, 0.10192949324846268, 0.07829947024583817, 0.07935988903045654, 0.08332262188196182, 0.10383624583482742, 0.10902117192745209, 0.11049765348434448, 0.10811241716146469], [0.07559307664632797, 0.07652760297060013, 0.07747367769479752, 0.10102855414152145, 0.07940106838941574, 0.08038266748189926, 0.08404094725847244, 0.10275334119796753, 0.10742972046136856, 0.10875783115625381, 0.10661152005195618], [0.08202986419200897, 0.08260795474052429, 0.08319013565778732, 0.09682050347328186, 0.0843668058514595, 0.08496137708425522, 0.08715032041072845, 0.0977618396282196, 0.10028058290481567, 0.10098730027675629, 0.0998433381319046], [0.08348216116428375, 0.08397257328033447, 0.0844658613204956, 0.09586085379123688, 0.08546115458011627, 0.0859631896018982, 0.08780650049448013, 0.09663756936788559, 0.09870976954698563, 0.09928963333368301, 0.09835066646337509], [0.08388471603393555, 0.0843503475189209, 0.08481856435537338, 0.09559429436922073, 0.08576280623674393, 0.08623886108398438, 0.08798547834157944, 0.09632615000009537, 0.09827706217765808, 0.09882258623838425, 0.0979391410946846], [0.08323203772306442, 0.08373773843050003, 0.08424652367830276, 0.09602638334035873, 0.0852733626961708, 0.08579146862030029, 0.0876946672797203, 0.09683114290237427, 0.09897924214601517, 0.09958062320947647, 0.09860687702894211]], [[0.08773288875818253, 0.10448084026575089, 0.08962667733430862, 0.10976703464984894, 0.09156133979558945, 0.09254427254199982, 0.11334025859832764, 0.09193141013383865, 0.015416581183671951, 0.10631580650806427, 0.09728295356035233], [0.09085964411497116, 0.09927515685558319, 0.09184881299734116, 0.10179082304239273, 0.0928487479686737, 0.0933527871966362, 0.10345759987831116, 0.09303882718086243, 0.03762568160891533, 0.10015536844730377, 0.09574653953313828], [0.08820328861474991, 0.103940948843956, 0.08999133855104446, 0.10887551307678223, 0.09181563556194305, 0.09274160116910934, 0.11220289766788483, 0.09216433018445969, 0.01721150241792202, 0.10565551370382309, 0.09719745069742203], [0.09131254255771637, 0.09737170487642288, 0.09203249961137772, 0.09915519505739212, 0.09275812655687332, 0.09312308579683304, 0.10033018887042999, 0.09289582073688507, 0.04817470908164978, 0.09799712151288986, 0.09484899044036865], [0.08865490555763245, 0.10337899625301361, 0.09033577889204025, 0.10796528309583664, 0.0920485109090805, 0.09291702508926392, 0.11105027049779892, 0.09237563610076904, 0.019210785627365112, 0.10497410595417023, 0.09708868712186813], [0.08887291699647903, 0.1030891165137291, 0.09049966931343079, 0.10750254988670349, 0.09215618669986725, 0.092995785176754, 0.11046763509511948, 0.09247245639562607, 0.020293915644288063, 0.10462485253810883, 0.09702489525079727], [0.0914546400308609, 0.0959952175617218, 0.09199795126914978, 0.09731834381818771, 0.09254448860883713, 0.0928189679980278, 0.09818684309720993, 0.09264807403087616, 0.056462086737155914, 0.09645988047122955, 0.09411345422267914], [0.08873791247606277, 0.10327021777629852, 0.09039837121963501, 0.10779111087322235, 0.09208991378545761, 0.09294750541448593, 0.11083070188760757, 0.09241293370723724, 0.01961313560605049, 0.10484287887811661, 0.09706536680459976], [0.045119430869817734, 0.12662677466869354, 0.0511854887008667, 0.1694868803024292, 0.05806708335876465, 0.061847422271966934, 0.20479099452495575, 0.05946717411279678, 1.5624916613887763e-06, 0.14034169912338257, 0.08306540548801422], [0.09104859828948975, 0.09863141924142838, 0.09194330126047134, 0.10088585317134857, 0.09284680336713791, 0.09330187737941742, 0.10237656533718109, 0.09301844984292984, 0.041066400706768036, 0.09942084550857544, 0.09545984864234924], [0.08981185406446457, 0.10164490342140198, 0.09118098765611649, 0.10526188462972641, 0.09257099032402039, 0.09327391535043716, 0.10767801851034164, 0.09283589571714401, 0.026202429085969925, 0.10290636122226715, 0.09663271903991699]], [[0.0718378871679306, 0.07292801886796951, 0.0740346908569336, 0.10250750929117203, 0.07937224954366684, 0.08057671785354614, 0.0817994549870491, 0.10465677827596664, 0.11052484810352325, 0.10785718262195587, 0.11390469968318939], [0.07222344726324081, 0.07329583913087845, 0.0743841603398323, 0.10227791219949722, 0.07962840795516968, 0.08081074804067612, 0.0820106565952301, 0.10437610745429993, 0.11010004580020905, 0.10749872773885727, 0.11339391767978668], [0.07261006534099579, 0.07366448640823364, 0.07473424077033997, 0.10204741358757019, 0.07988427579402924, 0.08104433864355087, 0.08222125470638275, 0.1040947213768959, 0.1096753403544426, 0.1071399599313736, 0.11288384348154068], [0.08120813220739365, 0.08181669563055038, 0.08242981880903244, 0.09685885906219482, 0.08532407134771347, 0.08596348762512207, 0.0866076871752739, 0.09786030650138855, 0.10054290294647217, 0.09933251142501831, 0.10205546021461487], [0.07441059499979019, 0.07537898421287537, 0.07635998725891113, 0.10097034275531769, 0.081062912940979, 0.08211787790060043, 0.08318658173084259, 0.10278522223234177, 0.10771382600069046, 0.1054779514670372, 0.11053568869829178], [0.07480301707983017, 0.0757521390914917, 0.07671330869197845, 0.10073483735322952, 0.08131697028875351, 0.08234874904155731, 0.08339361101388931, 0.10250003635883331, 0.1072898656129837, 0.10511764138936996, 0.11002979427576065], [0.07519644498825073, 0.07612606883049011, 0.07706718146800995, 0.10049847513437271, 0.08157067745923996, 0.0825790986418724, 0.0835999920964241, 0.10221420228481293, 0.10686606168746948, 0.10475708544254303, 0.109524667263031], [0.08177145570516586, 0.08234772831201553, 0.08292806148529053, 0.09651550650596619, 0.08566411584615707, 0.08626782149076462, 0.086875781416893, 0.09745387732982635, 0.0999646857380867, 0.09883230179548264, 0.10137862712144852], [0.08326051384210587, 0.08374962210655212, 0.0842415988445282, 0.09560634195804596, 0.08655347675085068, 0.08706192672252655, 0.08757337182760239, 0.09638099372386932, 0.09844768792390823, 0.09751668572425842, 0.09960773587226868], [0.0825921967625618, 0.08312075585126877, 0.08365269750356674, 0.09601465612649918, 0.08615601062774658, 0.08670737594366074, 0.08726226538419724, 0.09686224162578583, 0.09912649542093277, 0.09810596704483032, 0.10039928555488586], [0.08408758044242859, 0.08452713489532471, 0.08496899157762527, 0.09510045498609543, 0.08704155683517456, 0.0874965563416481, 0.08795393258333206, 0.09578604996204376, 0.09761220216751099, 0.09679008275270462, 0.09863538295030594]], [[0.08796002715826035, 0.10772588104009628, 0.08737753331661224, 0.110051229596138, 0.09179838001728058, 0.09022191166877747, 0.11049603670835495, 0.09478667378425598, 0.015456481836736202, 0.10659106075763702, 0.09753481298685074], [0.09125006943941116, 0.09952051192522049, 0.09099093824625015, 0.10043435543775558, 0.09293355792760849, 0.09224709123373032, 0.10060790181159973, 0.09421653300523758, 0.043352432548999786, 0.09907043725252151, 0.09537613391876221], [0.08781393617391586, 0.10795646905899048, 0.08722154051065445, 0.11033095419406891, 0.09171933680772781, 0.09011494368314743, 0.11078527569770813, 0.09476195275783539, 0.014935854822397232, 0.10679800808429718, 0.09756163507699966], [0.09139984846115112, 0.09847359359264374, 0.09117680042982101, 0.09925000369548798, 0.0928468182682991, 0.09225724637508392, 0.09939733892679214, 0.09394706040620804, 0.04822076857089996, 0.09809082746505737, 0.094939686357975], [0.08885737508535385, 0.10619836300611496, 0.08833964169025421, 0.10821186006069183, 0.09225872159004211, 0.09086385369300842, 0.10859642177820206, 0.0948949083685875, 0.019254637882113457, 0.10521383583545685, 0.09731041640043259], [0.08850269019603729, 0.10682772099971771, 0.08795846253633499, 0.10896683484315872, 0.09208250790834427, 0.09061355143785477, 0.10937564820051193, 0.09486208856105804, 0.017615122720599174, 0.10578259825706482, 0.09741275012493134], [0.0914221778512001, 0.09827064722776413, 0.09120596945285797, 0.09902139008045197, 0.09282436221837997, 0.09225311875343323, 0.09916383028030396, 0.09389009326696396, 0.049196675419807434, 0.09790047258138657, 0.09485125541687012], [0.08947496116161346, 0.10499489307403564, 0.08900707215070724, 0.10677922517061234, 0.09254197031259537, 0.09128563851118088, 0.10711964219808578, 0.09491102397441864, 0.02268851175904274, 0.1041211485862732, 0.09707581996917725], [0.04580550640821457, 0.15167269110679626, 0.04404264688491821, 0.17206421494483948, 0.058950025588274, 0.053216736763715744, 0.17621298134326935, 0.07122931629419327, 1.5862372038100148e-06, 0.14247576892375946, 0.08432849496603012], [0.09115718305110931, 0.10002326965332031, 0.09088026732206345, 0.1010061651468277, 0.09295753389596939, 0.09222313016653061, 0.1011928990483284, 0.09433109313249588, 0.04111536219716072, 0.09953941404819489, 0.09557369351387024], [0.08997754752635956, 0.10387260466814041, 0.08955501019954681, 0.10545608401298523, 0.09274177253246307, 0.0916106179356575, 0.10575786232948303, 0.09487053006887436, 0.026250755414366722, 0.10309620946645737, 0.09681098908185959]], [[0.07237880676984787, 0.07733707875013351, 0.07557380944490433, 0.10274844616651535, 0.07775354385375977, 0.0788668841123581, 0.08303477615118027, 0.1047808974981308, 0.10628123581409454, 0.11189790070056915, 0.10934664309024811], [0.07423558831214905, 0.07876866310834885, 0.07716022431850433, 0.1015610620379448, 0.07914799451828003, 0.08016099780797958, 0.08394011855125427, 0.10335628688335419, 0.10467913001775742, 0.10961414128541946, 0.10737583786249161], [0.07358646392822266, 0.0782700628042221, 0.07660690695047379, 0.10197629034519196, 0.07866249978542328, 0.07971088588237762, 0.08362674713134766, 0.10385351628065109, 0.10523764044046402, 0.1104075238108635, 0.10806148499250412], [0.08246824890375137, 0.08492086827754974, 0.08405900001525879, 0.09629151225090027, 0.08512283116579056, 0.08565977960824966, 0.08763327449560165, 0.09712936729192734, 0.09774206578731537, 0.09999391436576843, 0.09897906333208084], [0.07438716292381287, 0.0788848027586937, 0.07728922367095947, 0.10146406292915344, 0.07926105707883835, 0.08026575297117233, 0.08401282131671906, 0.10324028879404068, 0.10454894602298737, 0.10942963510751724, 0.1072162315249443], [0.07478921860456467, 0.07919233292341232, 0.07763104140758514, 0.10120680928230286, 0.07956037670373917, 0.08054295182228088, 0.0842047706246376, 0.1029328927397728, 0.10420411825180054, 0.10894167423248291, 0.10679386556148529], [0.07625490427017212, 0.08030693233013153, 0.07887264341115952, 0.10026867687702179, 0.0806446522474289, 0.08154552429914474, 0.08489378541707993, 0.10181514173746109, 0.1029525175690651, 0.10717975348234177, 0.10526551306247711], [0.08305127918720245, 0.08534473925828934, 0.08453933149576187, 0.0959186851978302, 0.08553338050842285, 0.08603477478027344, 0.08787570148706436, 0.0966942235827446, 0.09726104885339737, 0.09934218227863312, 0.09840468317270279], [0.08347562700510025, 0.08565227687358856, 0.0848882645368576, 0.09564737975597382, 0.0858311653137207, 0.08630653470754623, 0.08805059641599655, 0.09637799113988876, 0.09691178053617477, 0.09887014329433441, 0.09798823297023773], [0.0850209966301918, 0.08676538616418839, 0.08615417778491974, 0.0946599543094635, 0.08690833300352097, 0.08728788048028946, 0.08867663890123367, 0.09522999823093414, 0.09564588963985443, 0.09716761857271194, 0.09648313373327255], [0.08432729542255402, 0.08626705408096313, 0.08558685332536697, 0.09510307013988495, 0.08642622083425522, 0.08684898167848587, 0.08839771896600723, 0.09574460983276367, 0.0962129533290863, 0.09792867302894592, 0.09715652465820312]], [[0.05198416858911514, 0.06500272452831268, 0.05307082086801529, 0.06636150926351547, 0.05418017506599426, 0.05474352464079857, 0.0684531182050705, 0.0558878555893898, 0.4091338515281677, 0.06433927267789841, 0.05684300512075424], [0.08074330538511276, 0.08688395470380783, 0.081293024122715, 0.08747546374797821, 0.08184646815061569, 0.08212461322546005, 0.08837030827999115, 0.08268372714519501, 0.15884245932102203, 0.08659211546182632, 0.08314454555511475], [0.05495947599411011, 0.06777431815862656, 0.05603615939617157, 0.06910204142332077, 0.05713392794132233, 0.057690855115652084, 0.07114256173372269, 0.05882103741168976, 0.3804509937763214, 0.06712540239095688, 0.05976329371333122], [0.0828733891248703, 0.08794479817152023, 0.08333028852939606, 0.08842965960502625, 0.08378971368074417, 0.08402036875486374, 0.08916196972131729, 0.08448358625173569, 0.14339597523212433, 0.0877053514122963, 0.08486492931842804], [0.057906556874513626, 0.07042264938354492, 0.0589650422334671, 0.07170990854501724, 0.06004286929965019, 0.060589149594306946, 0.07368505746126175, 0.06169666349887848, 0.3525702953338623, 0.06979291141033173, 0.0626189261674881], [0.059364501386880875, 0.07169558107852936, 0.0604107491672039, 0.07295915484428406, 0.06147543340921402, 0.062014780938625336, 0.07489637285470963, 0.06310773640871048, 0.3389812111854553, 0.0710771381855011, 0.06401734799146652], [0.08588521927595139, 0.08925992995500565, 0.08619217574596405, 0.08957895636558533, 0.08650022745132446, 0.0866546705365181, 0.09005961567163467, 0.08696436882019043, 0.1225837767124176, 0.08910215646028519, 0.08721888810396194], [0.06224001944065094, 0.07413056492805481, 0.06325548142194748, 0.07534003257751465, 0.06428751349449158, 0.06480982154607773, 0.0771913230419159, 0.06586721539497375, 0.3125937879085541, 0.07353803515434265, 0.06674619019031525], [0.168230801820755, 0.052581340074539185, 0.15106084942817688, 0.047214798629283905, 0.13564331829547882, 0.12853507697582245, 0.04017425701022148, 0.11541656404733658, 3.6594724406313617e-06, 0.05546465143561363, 0.10567467659711838], [0.07964994013309479, 0.08630036562681198, 0.08024340122938156, 0.0869433805346489, 0.08084128797054291, 0.081141896545887, 0.08791688829660416, 0.08174647390842438, 0.1669880896806717, 0.0859832689166069, 0.08224505186080933], [0.06454780697822571, 0.07600869238376617, 0.06553181260824203, 0.07716740667819977, 0.06653079390525818, 0.06703599542379379, 0.07893867790699005, 0.06805791705846786, 0.2918336093425751, 0.07544056326150894, 0.06890660524368286]]], "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 3.561556150089018e-05, "vf_explained_var": 0.00025647878646850586, "total_loss": 0.2778858542442322, "policy_loss": -0.0001876472233561799, "num_module_steps_trained_lifetime": 95760, "use_intrinsic_rewards": 0.0, "num_module_steps_trained": 5985, "vf_loss": 0.35830652713775635, "weights_seq_no": 16.0, "module_train_batch_size_mean": 997.6889684010584, "curr_kl_coeff": 2.4655751076352317e-06, "curr_entropy_coeff": 0.0015431216992, "entropy": 0.6905117034912109, "vf_loss_unclipped": 44.269935607910156, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 741.0752693452641}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"module_train_batch_size_mean": 997.4990256591639, "total_loss": 0.0, "num_module_steps_trained_lifetime": 574560, "diff_num_grad_updates_vs_sampler_policy": 81.0, "num_module_steps_trained": 35910, "weights_seq_no": 96.0}, "default_policy": {"policy_loss": -0.0001841119083110243, "num_module_steps_trained_lifetime": 574560, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35910, "vf_loss": 0.3583361506462097, "weights_seq_no": 96.0, "module_train_batch_size_mean": 997.4990256591639, "entropy": 0.6905189752578735, "vf_loss_unclipped": 44.451107025146484, "diff_num_grad_updates_vs_sampler_policy": 81.0, "mean_kl_loss": 3.475356788840145e-05, "vf_explained_var": -0.0025843381881713867, "total_loss": 0.27791810035705566}, "__all_modules__": {"num_env_steps_trained": 198000, "num_module_steps_trained_lifetime": 1149120, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 3168000, "num_env_steps_trained_lifetime_throughput": 45945.04042765057}}}, "intrinsic_reward_module": {"curr_entropy_coeff": 0.0015431216992, "default_optimizer_learning_rate": 0.0002715581955, "module_train_batch_size_mean": 997.6889684010584, "total_loss": 0.0, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 95760, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "weights_seq_no": 16.0, "num_module_steps_trained_lifetime_throughput": 741.0834683727621}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 528000, "num_env_steps_trained": 33000, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 191520, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 4087.2473906924256, "num_module_steps_trained_throughput": 21583738.580978673, "num_module_steps_trained_lifetime_throughput": 13838472.040492048}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 320, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -0.4}, "episode_len_min": 20, "weights_seq_no": 16.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.807313903334057e-06, "numpy_to_tensor": 1.3168334368986822e-05, "add_observations_from_episodes_to_batch": 2.944863927067616e-06, "add_time_dim_to_batch_and_zero_pad": 7.094287362338491e-06, "batch_individual_items": 1.3029842902713016e-05}}, "connector_pipeline_timer": 6.193069182232368e-05}, "num_env_steps_sampled": 400, "env_reset_timer": 0.00019781598860554874, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2296542998577966e-05, "get_actions": 3.938643111119916e-05, "listify_data_for_vector_env": 1.1068238481303927e-05, "un_batch_to_individual_items": 6.692692944441135e-06, "tensor_to_numpy": 1.568768303978226e-05, "normalize_and_clip_actions": 8.26758110283185e-06}}, "connector_pipeline_timer": 0.00012048628902269224}, "episode_len_max": 20, "env_step_timer": 1.469061755923347e-05, "rlmodule_inference_timer": 3.311434703654485e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": -0.4}, "episode_len_mean": 20.0, "episode_return_min": -14.5, "episode_return_mean": -0.4, "num_env_steps_sampled_lifetime": 80400, "sample": 0.11708158660952134, "episode_duration_sec_mean": 0.005769807437900454, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "episode_return_max": 14.5, "time_between_sampling": 9.649145826115214}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "aec1c_00000", "date": "2025-08-11_18-41-49", "timestamp": 1754930509, "time_this_iter_s": 9.552645206451416, "time_total_s": 159.52126693725586, "pid": 11610, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3842f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 159.52126693725586, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 40.93846153846154, "ram_util_percent": 78.53846153846153}}
{"timers": {"training_iteration": 9.840842648658978, "restore_env_runners": 8.59929573540855e-06, "training_step": 9.84066945621745, "env_runner_sampling_timer": 1.6326201804622034, "learner_update_timer": 8.022043963145151, "synch_weights": 0.0011150375646465662, "restore_eval_env_runners": 2.1037783331871938e-05, "evaluation_iteration": 0.12394210962210452, "synch_eval_env_connectors": 0.0001621612347451076, "synch_env_connectors": 5.354514252387479e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5349713914749944e-05, "normalize_and_clip_actions": 7.88926279781498e-06, "get_actions": 3.913113583237101e-05, "un_batch_to_individual_items": 6.4822908738987155e-06, "remove_single_ts_time_rank_from_batch": 1.1733576308840982e-05, "listify_data_for_vector_env": 1.0420986836286709e-05}}, "connector_pipeline_timer": 0.00011758403656511783}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.797177514209164e-06, "numpy_to_tensor": 1.2277778107525669e-05, "add_states_from_episodes_to_batch": 2.665227355730208e-06, "add_observations_from_episodes_to_batch": 2.7521717349546843e-06, "batch_individual_items": 1.223829960122932e-05}}, "connector_pipeline_timer": 5.878559536907861e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "rlmodule_inference_timer": 3.1797844533796595e-05, "episode_len_mean": 20.0, "episode_return_min": -11.5, "weights_seq_no": 16.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_mean": -1.2600000000000002, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime": -9252500.0, "num_env_steps_sampled": 5000.0, "sample": 0.005597496536981204, "env_reset_timer": 3.3351025955443374e-05, "episode_duration_sec_mean": 0.00522875414835289, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -462625.0, "time_between_sampling": 0.03273041825420523, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": -1.2600000000000002}, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.3524597819538745e-05, "module_episode_returns_mean": {"default_policy": -1.2600000000000002}, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 3296.971414172954}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1467226631837105, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008922015160747209, "add_observations_from_episodes_to_batch": 0.0008346311292552774, "add_columns_from_episodes_to_train_batch": 0.04159726336238328, "add_time_dim_to_batch_and_zero_pad": 0.07609615819390565, "add_states_from_episodes_to_batch": 0.003574262475487513, "batch_individual_items": 0.01549920843044298, "numpy_to_tensor": 7.124444158797694e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"IntrinsicAttentionMask": [[[0.07138548791408539, 0.07627572119235992, 0.07736789435148239, 0.10133834183216095, 0.07959937304258347, 0.08073914051055908, 0.07889830321073532, 0.10726834833621979, 0.10482265055179596, 0.1103622317314148, 0.11194248497486115], [0.07332546263933182, 0.07780296355485916, 0.07879875600337982, 0.10031593590974808, 0.08082874864339828, 0.08186326175928116, 0.08019162714481354, 0.10555112361907959, 0.10339578241109848, 0.10827028751373291, 0.10965603590011597], [0.07374557852745056, 0.07813148945569992, 0.07910603284835815, 0.10009388625621796, 0.0810917317867279, 0.0821032002568245, 0.08046865463256836, 0.10518203675746918, 0.10308802872896194, 0.10782229155302048, 0.1091671735048294], [0.08197115361690521, 0.08440899103879929, 0.08494143933057785, 0.09571109712123871, 0.08601643890142441, 0.08655903488397598, 0.0856805369257927, 0.09814903140068054, 0.09715290367603302, 0.09939118474721909, 0.10001814365386963], [0.07458982616662979, 0.07878930866718292, 0.07972073554992676, 0.09964698553085327, 0.08161677420139313, 0.08258162438869476, 0.08102208375930786, 0.10444323718547821, 0.10247083753347397, 0.10692724585533142, 0.10819131880998611], [0.07501397281885147, 0.07911860197782516, 0.08002818375825882, 0.0994221642613411, 0.08187882602214813, 0.08282012492418289, 0.08129850029945374, 0.10407356917858124, 0.1021614670753479, 0.10648024827241898, 0.10770437866449356], [0.07432658225297928, 0.07858452200889587, 0.07952945679426193, 0.0997864156961441, 0.08145354688167572, 0.08243297785520554, 0.08084998279809952, 0.10467316210269928, 0.1026630848646164, 0.10720556229352951, 0.10849464684724808], [0.08376307785511017, 0.085738405585289, 0.08616827428340912, 0.09475012868642807, 0.08703449368476868, 0.08747086673974991, 0.08676406741142273, 0.0966646820306778, 0.09588359296321869, 0.09763641655445099, 0.09812594205141068], [0.0830339640378952, 0.08519909530878067, 0.08567096292972565, 0.09514131397008896, 0.08662255853414536, 0.08710231631994247, 0.08632536232471466, 0.09726662933826447, 0.09639902412891388, 0.09834703058004379, 0.0988917201757431], [0.0846664234995842, 0.08640354126691818, 0.08678088337182999, 0.09426518529653549, 0.08754052966833115, 0.0879228413105011, 0.08730347454547882, 0.09592272341251373, 0.09524700045585632, 0.09676238894462585, 0.09718497842550278], [0.08511991053819656, 0.08673617243766785, 0.08708695322275162, 0.09402162581682205, 0.0877927616238594, 0.08814781159162521, 0.08757255971431732, 0.09555183351039886, 0.09492826461791992, 0.09632624685764313, 0.09671580791473389]], [[0.05233370512723923, 0.06543980538845062, 0.05489668995141983, 0.06680772453546524, 0.05604422464966774, 0.05662694573402405, 0.06891339272260666, 0.057810645550489426, 0.40086305141448975, 0.06303860992193222, 0.05722522363066673], [0.08068224787712097, 0.08681824803352356, 0.08195739984512329, 0.08740931749343872, 0.08251538127660751, 0.08279579132795334, 0.08830347657203674, 0.08335947245359421, 0.15731662511825562, 0.08576029539108276, 0.0830816701054573], [0.05903753265738487, 0.07148817926645279, 0.061504583805799484, 0.0727657750248909, 0.06260375678539276, 0.06316069513559341, 0.07472511380910873, 0.06428946554660797, 0.3374571204185486, 0.06923616677522659, 0.06373162567615509], [0.08280976861715317, 0.08787728101015091, 0.08386872708797455, 0.08836176991462708, 0.08433111757040024, 0.08456326276063919, 0.08909351378679276, 0.0850294902920723, 0.1422567218542099, 0.08700854331254959, 0.08479978889226913], [0.061871353536844254, 0.0738852471113205, 0.06426540017127991, 0.07510896027088165, 0.06532978266477585, 0.0658685714006424, 0.07698263227939606, 0.06695950776338577, 0.31158363819122314, 0.07172432541847229, 0.0664205402135849], [0.06326686590909958, 0.07502835243940353, 0.06561724841594696, 0.07622192800045013, 0.06666111201047897, 0.06718925386667252, 0.07804800570011139, 0.0682581290602684, 0.2990601658821106, 0.07291873544454575, 0.0677301436662674], [0.08583064377307892, 0.08920320868492126, 0.08654126524925232, 0.08952202647924423, 0.08685056120157242, 0.0870056301355362, 0.0900023803114891, 0.08731659501791, 0.1219341903924942, 0.08862999081611633, 0.08716345578432083], [0.06600816547870636, 0.07719849050045013, 0.06825707107782364, 0.07832573354244232, 0.06925375014543533, 0.06975752860307693, 0.08004752546548843, 0.07077611237764359, 0.2748998999595642, 0.07520254701375961, 0.07027313858270645], [0.17786334455013275, 0.05661467835307121, 0.13922812044620514, 0.05092233791947365, 0.1252293884754181, 0.11876703798770905, 0.04343874379992485, 0.1068255603313446, 5.260373200144386e-06, 0.06856288015842438, 0.11254259943962097], [0.07660096883773804, 0.08452359586954117, 0.07823096215724945, 0.08529717475175858, 0.07894694805145264, 0.07930739223957062, 0.0864708423614502, 0.08003323525190353, 0.1877700388431549, 0.08314347267150879, 0.07967530190944672], [0.06466817855834961, 0.07615043222904205, 0.06696934998035431, 0.07731129229068756, 0.0679902657866478, 0.06850653886795044, 0.07908587157726288, 0.06955087929964066, 0.28663524985313416, 0.07409675419330597, 0.06903509795665741]], [[0.07229141891002655, 0.07441701740026474, 0.075482577085495, 0.10262440890073776, 0.07765968143939972, 0.07877167314291, 0.08293454349040985, 0.10862968116998672, 0.10615293681621552, 0.10767292231321335, 0.11336313188076019], [0.07310739904642105, 0.07515645027160645, 0.07618261873722076, 0.10211892426013947, 0.07827718555927277, 0.0793459564447403, 0.08334095776081085, 0.10781142115592957, 0.10546548664569855, 0.1069054827094078, 0.11228808760643005], [0.07350938767194748, 0.07552016526460648, 0.07652667909860611, 0.10186950117349625, 0.0785801112651825, 0.0796273946762085, 0.08353915810585022, 0.10740976780653, 0.10512743145227432, 0.10652853548526764, 0.11176183074712753], [0.08244875818490982, 0.0835123285651207, 0.08403913676738739, 0.09626876562833786, 0.08510271459817886, 0.08563954383134842, 0.0876125618815422, 0.09872090071439743, 0.0977189764380455, 0.0983353853225708, 0.10060090571641922], [0.07431662827730179, 0.07624941319227219, 0.07721593230962753, 0.10136786103248596, 0.07918589562177658, 0.08018963038921356, 0.08393315225839615, 0.10660611093044281, 0.10444982349872589, 0.10577381402254105, 0.11071167886257172], [0.07472187280654907, 0.07661493867635727, 0.07756113260984421, 0.10111568868160248, 0.07948873937129974, 0.08047042042016983, 0.08412894606590271, 0.10620412975549698, 0.10411030054092407, 0.1053960770368576, 0.11018781363964081], [0.07619864493608475, 0.07794374227523804, 0.07881444692611694, 0.10019470006227493, 0.08058514446020126, 0.08148535341024399, 0.08483115583658218, 0.10474735498428345, 0.10287655889987946, 0.10402578860521317, 0.10829709470272064], [0.08415356278419495, 0.08501581847667694, 0.08544206619262695, 0.0951918214559555, 0.08630098402500153, 0.08673367649316788, 0.08831922709941864, 0.09711530804634094, 0.09633057564496994, 0.09681355208158493, 0.09858337789773941], [0.08346042037010193, 0.0844053253531456, 0.08487279713153839, 0.09562995284795761, 0.08581552654504776, 0.08629081398248672, 0.08803454786539078, 0.09776618331670761, 0.09689412266016006, 0.0974307656288147, 0.0993996188044548], [0.08388741314411163, 0.08478152751922607, 0.08522366732358932, 0.09536010026931763, 0.08611486107110977, 0.08656394481658936, 0.0882103443145752, 0.09736491739749908, 0.09654680639505386, 0.09705029428005219, 0.09889613837003708], [0.08544156700372696, 0.08614736050367355, 0.08649575710296631, 0.09437691420316696, 0.08719677478075027, 0.08754941076040268, 0.08883873373270035, 0.09591290354728699, 0.09528698027133942, 0.09567233175039291, 0.09708128124475479]], [[0.08791427314281464, 0.10766985267400742, 0.08733206987380981, 0.10999399423599243, 0.09175063669681549, 0.09017498046159744, 0.11357460170984268, 0.09212146699428558, 0.015448419377207756, 0.10653561353683472, 0.09748408943414688], [0.09124180674552917, 0.0995115116238594, 0.09098269790410995, 0.10042526572942734, 0.09292514622211456, 0.09223873913288116, 0.10181166231632233, 0.09308571368455887, 0.04334849491715431, 0.09906147420406342, 0.09536749869585037], [0.08776646852493286, 0.10789813101291656, 0.08717438578605652, 0.11027133464813232, 0.09166975319385529, 0.09006623178720474, 0.113929383456707, 0.09204723685979843, 0.0149277588352561, 0.10674029588699341, 0.09750892221927643], [0.09139378368854523, 0.09846705943346024, 0.09117074310779572, 0.09924342483282089, 0.09284065663814545, 0.09225112944841385, 0.10041946172714233, 0.09297847747802734, 0.04821755364537239, 0.09808432310819626, 0.09493338316679001], [0.0888219103217125, 0.10615599900484085, 0.08830437809228897, 0.10816868394613266, 0.09222190827131271, 0.0908275917172432, 0.11125948280096054, 0.0925496444106102, 0.019246933981776237, 0.10517186671495438, 0.09727159142494202], [0.0884632095694542, 0.10678007453680038, 0.0879192128777504, 0.10891823470592499, 0.09204143285751343, 0.09057311713695526, 0.11220600455999374, 0.09238674491643906, 0.01760724000632763, 0.1057354062795639, 0.09736929088830948], [0.09151699393987656, 0.09680958092212677, 0.09134850651025772, 0.09738469123840332, 0.09260758012533188, 0.09216372668743134, 0.09825378656387329, 0.09271124005317688, 0.05650056526064873, 0.0965256467461586, 0.09417761862277985], [0.08890342712402344, 0.10600855946540833, 0.08839211612939835, 0.10799219459295273, 0.09226167947053909, 0.09088467806577682, 0.11103745549917221, 0.09258531779050827, 0.019649680703878403, 0.10503844916820526, 0.09724642336368561], [0.04487062245607376, 0.1485772281885147, 0.04314374551177025, 0.16855259239673615, 0.057746876031160355, 0.052130602300167084, 0.20366208255290985, 0.05913925543427467, 1.5538472553089377e-06, 0.13956794142723083, 0.08260743319988251], [0.09114769846200943, 0.1000128760933876, 0.09087080508470535, 0.10099566727876663, 0.09294786304235458, 0.09221354126930237, 0.10248800367116928, 0.09311969578266144, 0.041111059486866, 0.09952906519174576, 0.09556375443935394], [0.08995456993579865, 0.10384609550237656, 0.08953214436769485, 0.10542916506528854, 0.09271809458732605, 0.09158723056316376, 0.10784914344549179, 0.0929834246635437, 0.026244038715958595, 0.10306989401578903, 0.09678628295660019]], [[0.07193601131439209, 0.07596944272518158, 0.0771222710609436, 0.09867267310619354, 0.07948067784309387, 0.07756229490041733, 0.08191119134426117, 0.10902145504951477, 0.11067584902048111, 0.10800453275442123, 0.10964349657297134], [0.07332486659288406, 0.07710996270179749, 0.07818891853094101, 0.09814794361591339, 0.08039233833551407, 0.07860041409730911, 0.0826578438282013, 0.10760800540447235, 0.10911370813846588, 0.10668160021305084, 0.10817433893680573], [0.07371080666780472, 0.07742553949356079, 0.07848365604877472, 0.098000667989254, 0.08064346760511398, 0.07888711988925934, 0.0828627198934555, 0.10721784830093384, 0.10868311673402786, 0.10631608963012695, 0.10776902735233307], [0.08017455786466599, 0.08262445777654648, 0.08331388980150223, 0.09544704854488373, 0.08471007645130157, 0.08357582241296768, 0.08612965047359467, 0.1008465364575386, 0.10168802738189697, 0.10032644867897034, 0.1011635959148407], [0.0744858831167221, 0.07805752754211426, 0.07907338440418243, 0.0977029800415039, 0.08114492893218994, 0.07946055382490158, 0.08327074348926544, 0.10643763840198517, 0.10782283544540405, 0.10558470338582993, 0.10695880651473999], [0.07385686039924622, 0.07754480838775635, 0.07859499752521515, 0.09794475138187408, 0.08073825389146805, 0.07899540662765503, 0.08293995261192322, 0.10707046091556549, 0.1085205227136612, 0.10617796331644058, 0.10761594772338867], [0.07526524364948273, 0.07869062572717667, 0.07966344058513641, 0.09740118682384491, 0.08164530247449875, 0.0800340473651886, 0.08367647230625153, 0.105657659471035, 0.1069638580083847, 0.10485294461250305, 0.10614920407533646], [0.08286767452955246, 0.08474331349134445, 0.08526855707168579, 0.09433969110250473, 0.08632884174585342, 0.08546782284975052, 0.08740230649709702, 0.09828001260757446, 0.09888916462659836, 0.09790287166833878, 0.09850968420505524], [0.08327805250883102, 0.08506378531455994, 0.08556348085403442, 0.09416896849870682, 0.08657170832157135, 0.08575301617383957, 0.08759181201457977, 0.0978933647274971, 0.09846843034029007, 0.09753722697496414, 0.09811020642518997], [0.08261281251907349, 0.08454396575689316, 0.08508501201868057, 0.09444546699523926, 0.0861775130033493, 0.08529029041528702, 0.08728403598070145, 0.09852074086666107, 0.09915123134851456, 0.09813044965267181, 0.09875844419002533], [0.0830225870013237, 0.08486435562372208, 0.08537997305393219, 0.09427531063556671, 0.08642064034938812, 0.08557556569576263, 0.08747398108243942, 0.09813392162322998, 0.09873016923666, 0.09776473790407181, 0.09835874289274216]], [[0.08547265082597733, 0.10963237285614014, 0.08746509999036789, 0.10884919762611389, 0.08950399607419968, 0.09054120630025864, 0.11267737299203873, 0.09549380093812943, 0.013492928817868233, 0.10838673263788223, 0.0984845981001854], [0.09046976268291473, 0.0998590961098671, 0.09130049496889114, 0.09957551211118698, 0.0921388566493988, 0.09256092458963394, 0.10095018148422241, 0.09453705698251724, 0.043499913066625595, 0.09940748661756516, 0.09570061415433884], [0.08604581654071808, 0.10884374380111694, 0.08793838322162628, 0.1081094741821289, 0.0898725837469101, 0.09085557609796524, 0.1116958037018776, 0.09554076939821243, 0.015058591961860657, 0.10767575353384018, 0.0983634740114212], [0.09037965536117554, 0.10019208490848541, 0.0912460908293724, 0.09989511221647263, 0.09212082624435425, 0.09256134182214737, 0.10133503377437592, 0.09462501853704453, 0.042084772139787674, 0.09971916675567627, 0.09584098309278488], [0.08660423010587692, 0.10803757607936859, 0.08839523792266846, 0.10735172778367996, 0.0902232974767685, 0.09115145355463028, 0.11069901287555695, 0.0955672413110733, 0.016802320256829262, 0.10694647580385208, 0.09822141379117966], [0.08687724173069, 0.10762738436460495, 0.08861685544252396, 0.1069655492901802, 0.09039130806922913, 0.09129182249307632, 0.1101943776011467, 0.09557216614484787, 0.017746958881616592, 0.10657442361116409, 0.09814192354679108], [0.09076976776123047, 0.09854781627655029, 0.09146320819854736, 0.09831474721431732, 0.09216193854808807, 0.0925133153796196, 0.09944351762533188, 0.09415490925312042, 0.04933542385697365, 0.09817659854888916, 0.09511877596378326], [0.08807556331157684, 0.10566173493862152, 0.08957235515117645, 0.10510919988155365, 0.09109459817409515, 0.09186539798974991, 0.10779997706413269, 0.09551380574703217, 0.022832581773400307, 0.10478243231773376, 0.09769236296415329], [0.040533483028411865, 0.15835487842559814, 0.0459829680621624, 0.15226048231124878, 0.05216512456536293, 0.05556124076247215, 0.18397635221481323, 0.07436737418174744, 1.6561075426579919e-06, 0.14875273406505585, 0.088043712079525], [0.09032397717237473, 0.10038790851831436, 0.09121156483888626, 0.10008294880390167, 0.0921078696846962, 0.0925593301653862, 0.10156179964542389, 0.0946749672293663, 0.04126522317528725, 0.09990228712558746, 0.09592210501432419], [0.0887124165892601, 0.10446387529373169, 0.09006477892398834, 0.10397331416606903, 0.09143777191638947, 0.0921320915222168, 0.10635987669229507, 0.09541055560112, 0.026400167495012283, 0.10368306934833527, 0.09736207872629166]]], "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 2.5714875846460927e-06, "vf_explained_var": -0.0012813806533813477, "total_loss": 0.2780255675315857, "policy_loss": -4.8623322072671726e-05, "num_module_steps_trained_lifetime": 101745, "use_intrinsic_rewards": 0.0, "num_module_steps_trained": 5985, "vf_loss": 0.3583068549633026, "weights_seq_no": 17.0, "module_train_batch_size_mean": 997.6777629636601, "curr_kl_coeff": 1.2327875538176158e-06, "curr_entropy_coeff": 0.0015431216992, "entropy": 0.6902545690536499, "vf_loss_unclipped": 43.610939025878906, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 739.3675966400176}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"module_train_batch_size_mean": 997.498558675304, "total_loss": 0.0, "num_module_steps_trained_lifetime": 610470, "diff_num_grad_updates_vs_sampler_policy": 86.0, "num_module_steps_trained": 35910, "weights_seq_no": 102.0}, "default_policy": {"policy_loss": -4.6901634050300345e-05, "num_module_steps_trained_lifetime": 610470, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35910, "vf_loss": 0.35833123326301575, "weights_seq_no": 102.0, "module_train_batch_size_mean": 997.498558675304, "entropy": 0.6902579665184021, "vf_loss_unclipped": 43.72661209106445, "diff_num_grad_updates_vs_sampler_policy": 86.0, "mean_kl_loss": 2.4551500246161595e-06, "vf_explained_var": -0.002598285675048828, "total_loss": 0.2780466675758362}, "__all_modules__": {"num_env_steps_trained": 198000, "num_module_steps_trained_lifetime": 1220940, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 3366000, "num_env_steps_trained_lifetime_throughput": 45251.82544759611}}}, "intrinsic_reward_module": {"curr_entropy_coeff": 0.0015431216992, "default_optimizer_learning_rate": 0.0002715581955, "module_train_batch_size_mean": 997.6777629636601, "total_loss": 0.0, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 101745, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "weights_seq_no": 17.0, "num_module_steps_trained_lifetime_throughput": 739.3752777301407}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 561000, "num_env_steps_trained": 33000, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 203490, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 4077.7887572633804, "num_module_steps_trained_throughput": 21102670.73590875, "num_module_steps_trained_lifetime_throughput": 13757515.647549693}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 340, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 0.4}, "episode_len_min": 20, "weights_seq_no": 17.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7379450965824514e-06, "numpy_to_tensor": 1.1779317193207538e-05, "add_observations_from_episodes_to_batch": 2.762221829778992e-06, "add_time_dim_to_batch_and_zero_pad": 6.728303639097786e-06, "batch_individual_items": 1.2206179254388242e-05}}, "connector_pipeline_timer": 5.79365763973236e-05}, "num_env_steps_sampled": 400, "env_reset_timer": 0.00019659949924561034, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1889345168782702e-05, "get_actions": 3.519117695260095e-05, "listify_data_for_vector_env": 1.0329629514306589e-05, "un_batch_to_individual_items": 6.401198108791234e-06, "tensor_to_numpy": 1.4830733832087477e-05, "normalize_and_clip_actions": 7.835280278151288e-06}}, "connector_pipeline_timer": 0.00011235891403566456}, "episode_len_max": 20, "env_step_timer": 1.3933474983026166e-05, "rlmodule_inference_timer": 3.0499832971972004e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 0.4}, "episode_len_mean": 20.0, "episode_return_min": -14.5, "episode_return_mean": 0.4, "num_env_steps_sampled_lifetime": 85400, "sample": 0.11702090865284409, "episode_duration_sec_mean": 0.005423497478477657, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "episode_return_max": 14.5, "time_between_sampling": 9.645929098683352}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "aec1c_00000", "date": "2025-08-11_18-41-58", "timestamp": 1754930518, "time_this_iter_s": 9.422850131988525, "time_total_s": 168.94411706924438, "pid": 11610, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3842f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 168.94411706924438, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 38.135714285714286, "ram_util_percent": 77.75}}
{"timers": {"training_iteration": 9.838928738831683, "restore_env_runners": 8.569132073943008e-06, "training_step": 9.838755236655253, "env_runner_sampling_timer": 1.631424524077688, "learner_update_timer": 8.021342822672992, "synch_weights": 0.0011140321894150234, "restore_eval_env_runners": 2.0938655472550693e-05, "evaluation_iteration": 0.12386870561631953, "synch_eval_env_connectors": 0.00016177546184280046, "synch_env_connectors": 5.346389711827602e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.530932721266082e-05, "normalize_and_clip_actions": 7.952847435437175e-06, "get_actions": 3.899250857639281e-05, "un_batch_to_individual_items": 6.514497195091613e-06, "remove_single_ts_time_rank_from_batch": 1.1758551465965054e-05, "listify_data_for_vector_env": 1.0456739226720467e-05}}, "connector_pipeline_timer": 0.00011758365316105358}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.82017830065793e-06, "numpy_to_tensor": 1.229775024041211e-05, "add_states_from_episodes_to_batch": 2.670794586219934e-06, "add_observations_from_episodes_to_batch": 2.743212288506409e-06, "batch_individual_items": 1.2252511507961732e-05}}, "connector_pipeline_timer": 5.88848008870889e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "rlmodule_inference_timer": 3.159245216657715e-05, "episode_len_mean": 20.0, "episode_return_min": -11.5, "weights_seq_no": 17.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_mean": -2.6999999999999993, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime": -9870000.0, "num_env_steps_sampled": 5000.0, "sample": 0.0055712526211178556, "env_reset_timer": 3.30964600945775e-05, "episode_duration_sec_mean": 0.005233048844151199, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -493500.0, "time_between_sampling": 0.032233588342042645, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": -2.6999999999999993}, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.3581799355100118e-05, "module_episode_returns_mean": {"default_policy": -2.6999999999999993}, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 3294.4006542437837}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.14659751571284124, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008920887508785164, "add_observations_from_episodes_to_batch": 0.0008347577381253279, "add_columns_from_episodes_to_train_batch": 0.04159273614922767, "add_time_dim_to_batch_and_zero_pad": 0.07608732202232968, "add_states_from_episodes_to_batch": 0.003577649020623295, "batch_individual_items": 0.015385250096305668, "numpy_to_tensor": 7.120449705415449e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"IntrinsicAttentionMask": [[[0.07160527259111404, 0.07651057094335556, 0.07760610431432724, 0.10165035724639893, 0.07984445244073868, 0.07802402228116989, 0.07914122194051743, 0.10759862512350082, 0.10913929343223572, 0.1107020378112793, 0.10817805677652359], [0.07352953404188156, 0.07801949977874756, 0.07901806384325027, 0.10059512406587601, 0.08105369657278061, 0.07939859479665756, 0.0804148018360138, 0.1058448776602745, 0.10719957947731018, 0.1085716187953949, 0.10635460168123245], [0.07394605875015259, 0.07834389805793762, 0.07932108640670776, 0.10036601126194, 0.08131217956542969, 0.07969338446855545, 0.08068741112947464, 0.10546798259019852, 0.10678349435329437, 0.10811541974544525, 0.10596301406621933], [0.08208903670310974, 0.08453037589788437, 0.08506359159946442, 0.09584873914718628, 0.08614013344049454, 0.08526588976383209, 0.08580374717712402, 0.09829017519950867, 0.09891019016504288, 0.09953411668539047, 0.09852392971515656], [0.07478295266628265, 0.0789933055639267, 0.07992714643478394, 0.09990498423576355, 0.08182808756828308, 0.0802827775478363, 0.08123186975717545, 0.10471365600824356, 0.10595156252384186, 0.10720410197973251, 0.10517957806587219], [0.07410375028848648, 0.0784665048122406, 0.0794355645775795, 0.10027921944856644, 0.081409752368927, 0.07980474829673767, 0.08079034090042114, 0.10532557219266891, 0.10662634670734406, 0.10794319212436676, 0.10581507533788681], [0.07452203333377838, 0.07879117876291275, 0.07973859459161758, 0.10004881769418716, 0.08166772872209549, 0.0800994411110878, 0.08106258511543274, 0.10494841635227203, 0.10621035844087601, 0.10748747736215591, 0.10542335361242294], [0.08385971933603287, 0.08583732694387436, 0.08626769483089447, 0.09485944360494614, 0.08713491261005402, 0.08643083274364471, 0.086864173412323, 0.09677620977163315, 0.09726142883300781, 0.09774906933307648, 0.09695921838283539], [0.08430524170398712, 0.08616405725479126, 0.0865682065486908, 0.09461026638746262, 0.08738219738006592, 0.08672136813402176, 0.08712812513113022, 0.09639784693717957, 0.09685000032186508, 0.09730426967144012, 0.09656840562820435], [0.08475189656019211, 0.08649076521396637, 0.08686848729848862, 0.0943603441119194, 0.08762889355421066, 0.08701160550117493, 0.08739160746335983, 0.09601955860853195, 0.09643889963626862, 0.09686007350683212, 0.09617775678634644], [0.08402789384126663, 0.0859607607126236, 0.08638124912977219, 0.09476540982723236, 0.08722839504480362, 0.08654061704874039, 0.0869639441370964, 0.09663327783346176, 0.097105972468853, 0.09758097678422928, 0.09681157022714615]], [[0.05258924141526222, 0.0657593384385109, 0.05516474321484566, 0.06713393330574036, 0.054810818284749985, 0.055380724370479584, 0.06739677488803864, 0.05809292569756508, 0.4028204083442688, 0.06334640830755234, 0.05750463902950287], [0.08086388558149338, 0.08701369911432266, 0.08214190602302551, 0.08760610222816467, 0.08196869492530823, 0.08224724978208542, 0.08771844208240509, 0.08354714512825012, 0.15767082571983337, 0.08595337718725204, 0.08326870948076248], [0.05931051820516586, 0.07181873172521591, 0.061788979917764664, 0.07310223579406738, 0.06144938990473747, 0.06199605017900467, 0.07334722578525543, 0.06458673626184464, 0.33901751041412354, 0.06955630332231522, 0.06402631849050522], [0.0829634964466095, 0.08804042637348175, 0.08402441442012787, 0.08852581679821014, 0.08388081938028336, 0.08411172777414322, 0.08861778676509857, 0.08518732339143753, 0.14252084493637085, 0.0871700644493103, 0.08495721220970154], [0.05841725319623947, 0.0710437223315239, 0.06091472506523132, 0.07234233617782593, 0.06057239696383476, 0.061123497784137726, 0.07259026169776917, 0.06373666971921921, 0.34733206033706665, 0.06875594705343246, 0.06317117810249329], [0.05985048785805702, 0.07228252291679382, 0.062316492199897766, 0.07355643063783646, 0.061978694051504135, 0.06252247095108032, 0.07379955053329468, 0.06509856879711151, 0.3340170979499817, 0.07003624737262726, 0.06454142928123474], [0.08334938436746597, 0.08821795135736465, 0.08436782658100128, 0.08868275582790375, 0.08423000574111938, 0.0844516009092331, 0.08877082914113998, 0.08548352122306824, 0.1397990733385086, 0.08738420903682709, 0.08526279777288437], [0.0662815272808075, 0.07751819491386414, 0.06853974610567093, 0.07865010201931, 0.06823132187128067, 0.06872766464948654, 0.07886574417352676, 0.07106921821832657, 0.27603834867477417, 0.07551398873329163, 0.0705641657114029], [0.17055636644363403, 0.054288845509290695, 0.1335083693265915, 0.04883036017417908, 0.1379832774400711, 0.1308627724647522, 0.04786273464560509, 0.10243695974349976, 5.044271347287577e-06, 0.06574618071317673, 0.1079191192984581], [0.07682421058416367, 0.08476992696523666, 0.07845894992351532, 0.08554576337337494, 0.07823687046766281, 0.07859407365322113, 0.08569309115409851, 0.08026647567749023, 0.18831728398799896, 0.08338578790426254, 0.07990750670433044], [0.06494317203760147, 0.07647424191236496, 0.06725413352251053, 0.07764004915952682, 0.06693830341100693, 0.06744658946990967, 0.07786224037408829, 0.06984663754701614, 0.2878541052341461, 0.07441183179616928, 0.0693286657333374]], [[0.07290248572826385, 0.0740087702870369, 0.07513183355331421, 0.09999833256006241, 0.08054850250482559, 0.07860435545444489, 0.07979716360569, 0.10620774328708649, 0.10781943053007126, 0.11386483162641525, 0.11111655086278915], [0.0732702910900116, 0.07435823231935501, 0.07546232640743256, 0.09982661157846451, 0.08078258484601974, 0.07887394726276398, 0.08004509657621384, 0.10588899999856949, 0.10746126621961594, 0.1133543998003006, 0.11067619174718857], [0.07363896071910858, 0.07470832765102386, 0.07579322904348373, 0.09965383261442184, 0.08101624250411987, 0.07914338260889053, 0.08029268682003021, 0.10556977242231369, 0.10710284113883972, 0.11284472793340683, 0.11023608595132828], [0.08078759908676147, 0.08146171271800995, 0.0821414515376091, 0.0961768701672554, 0.08535780012607574, 0.08421488106250763, 0.0849175900220871, 0.09942736476659775, 0.100257009267807, 0.10332056879997253, 0.10193713009357452], [0.07535368204116821, 0.07633434236049652, 0.07732777297496796, 0.09884124994277954, 0.08209030330181122, 0.08038631081581116, 0.08143246918916702, 0.10408792644739151, 0.10544254630804062, 0.1104985773563385, 0.1082049012184143], [0.07474987208843231, 0.07576221227645874, 0.07678826153278351, 0.09912899881601334, 0.08171446621417999, 0.07995055615901947, 0.08103333413600922, 0.10460911691188812, 0.10602584481239319, 0.11132010817527771, 0.10891711711883545], [0.07512182742357254, 0.0761147066950798, 0.07712071388959885, 0.09895195066928864, 0.08194628357887268, 0.08021923899650574, 0.08127949386835098, 0.10428798198699951, 0.10566635429859161, 0.1108134463429451, 0.10847800225019455], [0.08232776820659637, 0.08290795981884003, 0.08349224179983139, 0.09539907425642014, 0.08624690771102905, 0.08526992052793503, 0.08587084710597992, 0.09811688959598541, 0.09880835562944412, 0.10135405510663986, 0.1002059355378151], [0.0827145054936409, 0.08327063173055649, 0.08383049070835114, 0.09520230442285538, 0.08646762371063232, 0.0855327695608139, 0.08610784262418747, 0.09778857976198196, 0.09844605624675751, 0.10086480528116226, 0.09977429360151291], [0.08412090688943863, 0.08458784967660904, 0.08505738526582718, 0.09448201954364777, 0.08726177364587784, 0.08648168295621872, 0.08696173131465912, 0.09659737348556519, 0.097133569419384, 0.09910084307193756, 0.09821490943431854], [0.08348999172449112, 0.08399726450443268, 0.08450761437416077, 0.09480606764554977, 0.08690717816352844, 0.08605735003948212, 0.08658022433519363, 0.09713124483823776, 0.0977213978767395, 0.09988924860954285, 0.09891248494386673]], [[0.08799473196268082, 0.10479266941547394, 0.08989416062831879, 0.107054702937603, 0.09183458983898163, 0.09025750309228897, 0.11367852985858917, 0.09482406824827194, 0.015462570823729038, 0.10663310438394547, 0.09757330268621445], [0.0909888967871666, 0.09941639006137848, 0.09197946637868881, 0.10049870610237122, 0.09298082441091537, 0.09216777980327606, 0.10360477864742279, 0.09450334310531616, 0.037679195404052734, 0.10029784590005875, 0.09588275104761124], [0.08844905346632004, 0.10423058271408081, 0.09024208784103394, 0.10634353011846542, 0.09207145869731903, 0.09058480709791183, 0.11251555383205414, 0.09488529711961746, 0.01725943572819233, 0.10594991594552994, 0.0974682867527008], [0.0912003293633461, 0.09860379993915558, 0.09207463264465332, 0.0995490774512291, 0.09295731782913208, 0.09224070608615875, 0.1022551879286766, 0.09429723769426346, 0.04193899407982826, 0.09937374293804169, 0.09550899267196655], [0.08888453245162964, 0.10364677011966705, 0.09056974947452545, 0.1056118831038475, 0.09228692203760147, 0.09089162200689316, 0.11133791506290436, 0.09492391347885132, 0.01926051639020443, 0.10524600744247437, 0.0973401665687561], [0.08853282034397125, 0.10412202775478363, 0.09030558913946152, 0.10620696097612381, 0.09211385995149612, 0.09064439684152603, 0.11229430139064789, 0.09489438682794571, 0.017621107399463654, 0.10581860691308975, 0.09744592010974884], [0.09152316302061081, 0.09606713056564331, 0.09206687659025192, 0.09663784503936768, 0.0926138162612915, 0.09216992557048798, 0.09826040267944336, 0.09344033151865005, 0.056504376232624054, 0.09653214365243912, 0.09418396651744843], [0.08949700742959976, 0.1027258113026619, 0.0910179615020752, 0.1044715866446495, 0.09256476908922195, 0.0913081243634224, 0.10953974723815918, 0.09493441134691238, 0.022694088518619537, 0.104146808385849, 0.09709974378347397], [0.046255841851234436, 0.1298162043094635, 0.05247465893626213, 0.14726927876472473, 0.059529583901166916, 0.05373992398381233, 0.20994921028614044, 0.07192959636449814, 1.601830376785074e-06, 0.14387652277946472, 0.0851575955748558], [0.09116470068693161, 0.09875719994306564, 0.09206055104732513, 0.09972766041755676, 0.09296520054340363, 0.09223073720932007, 0.10250712186098099, 0.09433887153863907, 0.04111873731017113, 0.09954763203859329, 0.09558158367872238], [0.08999540656805038, 0.101852647960186, 0.09136733412742615, 0.10340534150600433, 0.09276018291711807, 0.09162880480289459, 0.10789809376001358, 0.09488935768604279, 0.026255961507558823, 0.10311668366193771, 0.09683021157979965]], [[0.07175340503454208, 0.07284225523471832, 0.07394761592149734, 0.1023869663476944, 0.07927890121936798, 0.08048195391893387, 0.0785394161939621, 0.10453371703624725, 0.11039488762617111, 0.11207011342048645, 0.11377076804637909], [0.07214214652776718, 0.07321333140134811, 0.07430042326450348, 0.10216279327869415, 0.07953876256942749, 0.08071978390216827, 0.0788126215338707, 0.10425861924886703, 0.10997612029314041, 0.1116090714931488, 0.11326628178358078], [0.07253190129995346, 0.07358519732952118, 0.07465378940105438, 0.10193759202957153, 0.07979827374219894, 0.08095709979534149, 0.07908560335636139, 0.10398269444704056, 0.10955730825662613, 0.11114827543497086, 0.11276235431432724], [0.08118501305580139, 0.0817934051156044, 0.08240634948015213, 0.09683128446340561, 0.0852997824549675, 0.08593901246786118, 0.08490443229675293, 0.09783245623111725, 0.10051428526639938, 0.10126752406358719, 0.10202641040086746], [0.07434632629156113, 0.07531387358903885, 0.07629402726888657, 0.10088314116001129, 0.08099288493394852, 0.08204694837331772, 0.08034385740756989, 0.10269645601511002, 0.10762080550193787, 0.10902140289545059, 0.11044023185968399], [0.07474161684513092, 0.07568996399641037, 0.07665033638477325, 0.10065217316150665, 0.08125022798776627, 0.08228115737438202, 0.08061526715755463, 0.10241592675447464, 0.10720182210206985, 0.10856202989816666, 0.10993950068950653], [0.07410084456205368, 0.07508023828268051, 0.0760725736618042, 0.10102634876966476, 0.08083255589008331, 0.0819009318947792, 0.08017482608556747, 0.10287060588598251, 0.10788152366876602, 0.10930739343166351, 0.11075211316347122], [0.08175088465213776, 0.08232701569795609, 0.08290719240903854, 0.09649122506380081, 0.08564256131649017, 0.08624611794948578, 0.08526913076639175, 0.09742935746908188, 0.09993954002857208, 0.10064385086297989, 0.10135312378406525], [0.08324599266052246, 0.08373501896858215, 0.08422690629959106, 0.09558967500925064, 0.08653838187456131, 0.08704674988985062, 0.0862235575914383, 0.09636419266462326, 0.09843052178621292, 0.09900874644517899, 0.09959036856889725], [0.08366058766841888, 0.08412498235702515, 0.08459194004535675, 0.09533889591693878, 0.08678426593542099, 0.0872659981250763, 0.0864858627319336, 0.09606878459453583, 0.09801449626684189, 0.09855855256319046, 0.09910564124584198], [0.08407597988843918, 0.08451547473669052, 0.08495726436376572, 0.09508733451366425, 0.08702954649925232, 0.08748447895050049, 0.0867476612329483, 0.09577284008264542, 0.09759873896837234, 0.0981089249253273, 0.09862177819013596]], [[0.052588749676942825, 0.06575872749090195, 0.055164217948913574, 0.06533682346343994, 0.05631734058260918, 0.0553801991045475, 0.0692492425441742, 0.056537821888923645, 0.4028170108795166, 0.06334581226110458, 0.05750409513711929], [0.0808638483285904, 0.08701365441083908, 0.08214186877012253, 0.08683016896247864, 0.08270110934972763, 0.08224721252918243, 0.08850222080945969, 0.08280715346336365, 0.1576707661151886, 0.08595332503318787, 0.0832686722278595], [0.05931013077497482, 0.0718182697892189, 0.06178857758641243, 0.07142356038093567, 0.06289282441139221, 0.061995647847652435, 0.07507015019655228, 0.06310360133647919, 0.33901557326316833, 0.0695558562874794, 0.0640258938074112], [0.08019096404314041, 0.08666365593671799, 0.0815337747335434, 0.08647013455629349, 0.08212172985076904, 0.08164450526237488, 0.08823452144861221, 0.08223326504230499, 0.16264307498931885, 0.08554567396640778, 0.08271870762109756], [0.06214667856693268, 0.07421403378248215, 0.06455137580633163, 0.07383572310209274, 0.06562049686908722, 0.06475196778774261, 0.07732520997524261, 0.06582441180944443, 0.31297042965888977, 0.07204349339008331, 0.06671611219644547], [0.05985010042786598, 0.07228206843137741, 0.06231609359383583, 0.07189024239778519, 0.06341435760259628, 0.06252206861972809, 0.07550904154777527, 0.06362396478652954, 0.33401528000831604, 0.07003579288721085, 0.06454101204872131], [0.08593645691871643, 0.08931317925453186, 0.08664795011281967, 0.08921410143375397, 0.08695763349533081, 0.08670636266469955, 0.09011334180831909, 0.08701625466346741, 0.12208455055952072, 0.08873925358057022, 0.08727091550827026], [0.06267580389976501, 0.0746496170759201, 0.06506441533565521, 0.0742747038602829, 0.06612595915794373, 0.06526360660791397, 0.07773180305957794, 0.06632839888334274, 0.3081739544868469, 0.07249817997217178, 0.06721353530883789], [0.17082303762435913, 0.054373692721128464, 0.1337171047925949, 0.0561961866915226, 0.12027245759963989, 0.13106735050678253, 0.04171929508447647, 0.1178891658782959, 5.052129381510895e-06, 0.0658489465713501, 0.10808780789375305], [0.0768241286277771, 0.0847698375582695, 0.07845886796712875, 0.08452989906072617, 0.07917694747447968, 0.07859399914741516, 0.08672276139259338, 0.07931330800056458, 0.1883171647787094, 0.08338570594787598, 0.07990741729736328], [0.06494288146495819, 0.0764739140868187, 0.06725383549928665, 0.07611479610204697, 0.06827908009290695, 0.06744629889726639, 0.07942182570695877, 0.06847447156906128, 0.2878530025482178, 0.07441151142120361, 0.06932836771011353]]], "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 2.6238447389914654e-05, "vf_explained_var": -0.0016428232192993164, "total_loss": 0.27773961424827576, "policy_loss": -0.0003349788603372872, "num_module_steps_trained_lifetime": 107730, "use_intrinsic_rewards": 0.0, "num_module_steps_trained": 5985, "vf_loss": 0.3583061695098877, "weights_seq_no": 18.0, "module_train_batch_size_mean": 997.6672132667843, "curr_kl_coeff": 6.163937769088079e-07, "curr_entropy_coeff": 0.0015431216992, "entropy": 0.6896421313285828, "vf_loss_unclipped": 43.26930618286133, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 737.5482583560582}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"module_train_batch_size_mean": 997.4982334615715, "total_loss": 0.0, "num_module_steps_trained_lifetime": 646380, "diff_num_grad_updates_vs_sampler_policy": 91.0, "num_module_steps_trained": 35910, "weights_seq_no": 108.0}, "default_policy": {"policy_loss": -0.0003229539142921567, "num_module_steps_trained_lifetime": 646380, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35910, "vf_loss": 0.35832956433296204, "weights_seq_no": 108.0, "module_train_batch_size_mean": 997.4982334615715, "entropy": 0.6896631717681885, "vf_loss_unclipped": 43.36238098144531, "diff_num_grad_updates_vs_sampler_policy": 91.0, "mean_kl_loss": 2.4428074539173394e-05, "vf_explained_var": -0.0025779008865356445, "total_loss": 0.27777373790740967}, "__all_modules__": {"num_env_steps_trained": 198000, "num_module_steps_trained_lifetime": 1292760, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 3564000, "num_env_steps_trained_lifetime_throughput": 44592.671485385275}}}, "intrinsic_reward_module": {"curr_entropy_coeff": 0.0015431216992, "default_optimizer_learning_rate": 0.0002715581955, "module_train_batch_size_mean": 997.6672132667843, "total_loss": 0.0, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 107730, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "weights_seq_no": 18.0, "num_module_steps_trained_lifetime_throughput": 737.5554470710182}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 594000, "num_env_steps_trained": 33000, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 215460, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 4067.716643668258, "num_module_steps_trained_throughput": 20650035.977942478, "num_module_steps_trained_lifetime_throughput": 13687559.58243521}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 360, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 0.6}, "episode_len_min": 20, "weights_seq_no": 18.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.876928881677187e-06, "numpy_to_tensor": 1.4338845886329413e-05, "add_observations_from_episodes_to_batch": 3.069321642118606e-06, "add_time_dim_to_batch_and_zero_pad": 7.498980881560546e-06, "batch_individual_items": 1.4365262894720928e-05}}, "connector_pipeline_timer": 6.599906293424377e-05}, "num_env_steps_sampled": 400, "env_reset_timer": 0.00019593433371586127, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2943160879927239e-05, "get_actions": 4.292417977656731e-05, "listify_data_for_vector_env": 1.2188228407136579e-05, "un_batch_to_individual_items": 7.043419062517475e-06, "tensor_to_numpy": 1.7475161706795186e-05, "normalize_and_clip_actions": 8.525488301891884e-06}}, "connector_pipeline_timer": 0.00012912278138453882}, "episode_len_max": 20, "env_step_timer": 1.6187591071248054e-05, "rlmodule_inference_timer": 3.468386336768338e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 0.6}, "episode_len_mean": 20.0, "episode_return_min": -14.5, "episode_return_mean": 0.6, "num_env_steps_sampled_lifetime": 90400, "sample": 0.11705914498680436, "episode_duration_sec_mean": 0.005503025409998372, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "episode_return_max": 14.5, "time_between_sampling": 9.64621585936657}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "aec1c_00000", "date": "2025-08-11_18-42-08", "timestamp": 1754930528, "time_this_iter_s": 9.780165195465088, "time_total_s": 178.72428226470947, "pid": 11610, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3842f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 178.72428226470947, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 40.578571428571436, "ram_util_percent": 78.98571428571428}}
{"timers": {"training_iteration": 9.836894806863748, "restore_env_runners": 8.569280754905886e-06, "training_step": 9.836720490958593, "env_runner_sampling_timer": 1.631079116756556, "learner_update_timer": 8.01862249278719, "synch_weights": 0.0011107722767690464, "restore_eval_env_runners": 2.095884808154043e-05, "evaluation_iteration": 0.12390474272979062, "synch_eval_env_connectors": 0.00016152853722009404, "synch_env_connectors": 5.334586201778313e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.602366303927249e-05, "normalize_and_clip_actions": 8.274847770722327e-06, "get_actions": 4.2004686905039494e-05, "un_batch_to_individual_items": 6.725604919899548e-06, "remove_single_ts_time_rank_from_batch": 1.217930180552397e-05, "listify_data_for_vector_env": 1.0915904352556344e-05}}, "connector_pipeline_timer": 0.00012348710512177942}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.104702417670683e-06, "numpy_to_tensor": 1.3186447189791845e-05, "add_states_from_episodes_to_batch": 2.754495094870279e-06, "add_observations_from_episodes_to_batch": 2.838631742750164e-06, "batch_individual_items": 1.273699216066197e-05}}, "connector_pipeline_timer": 6.124306853097405e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "rlmodule_inference_timer": 3.343733183996011e-05, "episode_len_mean": 20.0, "episode_return_min": -11.5, "weights_seq_no": 18.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_mean": -0.7000000000000002, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime": -10487500.0, "num_env_steps_sampled": 5000.0, "sample": 0.005745318245838158, "env_reset_timer": 3.757311897794213e-05, "episode_duration_sec_mean": 0.005493134458549324, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -524375.0, "time_between_sampling": 0.03353179307729894, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": -0.7000000000000002}, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.4326484891376005e-05, "module_episode_returns_mean": {"default_policy": -0.7000000000000002}, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 3156.166358224524}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.14752458347587016, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008917957793574762, "add_observations_from_episodes_to_batch": 0.0008349197412556744, "add_columns_from_episodes_to_train_batch": 0.041592229616821026, "add_time_dim_to_batch_and_zero_pad": 0.07611515422208824, "add_states_from_episodes_to_batch": 0.0035816267004101644, "batch_individual_items": 0.01628363884505107, "numpy_to_tensor": 7.13107819468632e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"IntrinsicAttentionMask": [[[0.0722915455698967, 0.07441714406013489, 0.07548269629478455, 0.10262458026409149, 0.07765980809926987, 0.07877179980278015, 0.08293467015028, 0.10465459525585175, 0.11018529534339905, 0.11176301538944244, 0.10921484231948853], [0.07310750335454941, 0.0751565620303154, 0.07618273794651031, 0.102119080722332, 0.07827729731798172, 0.07934607565402985, 0.083341084420681, 0.10404503345489502, 0.10928361862897873, 0.11077575385570526, 0.10836531221866608], [0.07350947707891464, 0.07552026212215424, 0.07652676850557327, 0.10186964273452759, 0.07858020812273026, 0.07962750643491745, 0.08353926986455917, 0.10374490171670914, 0.10884144902229309, 0.11029205471277237, 0.10794846713542938], [0.08244877308607101, 0.08351235091686249, 0.08403914421796799, 0.09626878052949905, 0.08510272204875946, 0.08563955128192902, 0.0876125767827034, 0.0971064418554306, 0.09934365004301071, 0.09997031092643738, 0.09895569831132889], [0.07431671768426895, 0.07624949514865875, 0.0772160217165947, 0.1013679951429367, 0.07918597757816315, 0.08018973469734192, 0.08393324911594391, 0.10314253717660904, 0.10795756429433823, 0.10932601988315582, 0.10711470991373062], [0.07472194731235504, 0.07661500573158264, 0.07756119966506958, 0.10111579298973083, 0.07948880642652512, 0.0804704949259758, 0.08412902057170868, 0.10284031927585602, 0.10751587152481079, 0.10884369909763336, 0.10669782757759094], [0.07619870454072952, 0.07794380187988281, 0.07881450653076172, 0.1001947820186615, 0.08058520406484604, 0.08148542046546936, 0.08483121544122696, 0.10174011439085007, 0.10591757297515869, 0.10710076987743378, 0.10518793761730194], [0.08303432911634445, 0.08402949571609497, 0.08452208340167999, 0.09589911997318268, 0.08551592379808426, 0.08601722866296768, 0.08785776793956757, 0.09667450189590454, 0.09874308109283447, 0.09932191669940948, 0.09838461130857468], [0.08458201587200165, 0.08539263904094696, 0.08579317480325699, 0.09492086619138718, 0.08659987896680832, 0.08700606971979141, 0.08849341422319412, 0.09553481638431549, 0.0971679612994194, 0.09762372076511383, 0.09688544273376465], [0.08501135557889938, 0.08576982468366623, 0.08614440262317657, 0.09464922547340393, 0.08689847588539124, 0.08727798610925674, 0.08866658061742783, 0.0952191948890686, 0.09673414379358292, 0.09715660661458969, 0.09647219628095627], [0.08431531488895416, 0.08515812456607819, 0.0855746865272522, 0.09508955478668213, 0.0864139273762703, 0.08683663606643677, 0.08838514983654022, 0.09573099762201309, 0.09743812680244446, 0.09791475534439087, 0.09714271873235703]], [[0.08495306968688965, 0.10896594077348709, 0.08693341165781021, 0.11150604486465454, 0.08895991742610931, 0.09275117516517639, 0.11199242621660233, 0.0949133038520813, 0.0134109016507864, 0.10772787034511566, 0.09788592904806137], [0.09026068449020386, 0.09962832182645798, 0.09108950197696686, 0.10054315626621246, 0.09192592650651932, 0.09346039593219757, 0.10071688890457153, 0.09431859105825424, 0.043399378657341, 0.0991777628660202, 0.09547945111989975], [0.08555325865745544, 0.10822069644927979, 0.08743498474359512, 0.11060099303722382, 0.0893581211566925, 0.09294944256544113, 0.11105642467737198, 0.09499385952949524, 0.014972385950386524, 0.10705938190221786, 0.09780041873455048], [0.09054797887802124, 0.09856551885604858, 0.09126190841197968, 0.09934265911579132, 0.09198146313428879, 0.09329913556575775, 0.09949012845754623, 0.09403475373983383, 0.048265762627124786, 0.09818240255117416, 0.09502831101417542], [0.08613910526037216, 0.10745736211538315, 0.08792050927877426, 0.10967963188886642, 0.08973874151706696, 0.09312805533409119, 0.110104501247406, 0.09505398571491241, 0.016712073236703873, 0.10637211054563522, 0.09769391268491745], [0.0871565043926239, 0.10602299869060516, 0.08875183016061783, 0.10796365886926651, 0.0903763547539711, 0.09339465200901031, 0.10833418369293213, 0.0951041728258133, 0.020380916073918343, 0.10507361590862274, 0.09744106233119965], [0.09059640020132065, 0.0983595922589302, 0.09128851443529129, 0.09911102056503296, 0.09198591858148575, 0.09326258301734924, 0.0992535874247551, 0.09397506713867188, 0.04924118518829346, 0.09798908978700638, 0.09493710845708847], [0.08768967539072037, 0.10519880801439285, 0.08917992562055588, 0.10698661208152771, 0.09069549292325974, 0.09350623935461044, 0.10732768476009369, 0.09509533643722534, 0.02273254282772541, 0.1043233573436737, 0.0972643494606018], [0.03907303884625435, 0.15264931321144104, 0.04432617872953415, 0.17317214608192444, 0.05028558149933815, 0.06319206953048706, 0.17734763026237488, 0.07168789207935333, 1.5964329804774025e-06, 0.1433931291103363, 0.08487146347761154], [0.0901000127196312, 0.10013898462057114, 0.09098539501428604, 0.10112302005290985, 0.09187948703765869, 0.09352120757102966, 0.10130997002124786, 0.09444021433591843, 0.041162893176078796, 0.09965457022190094, 0.09568425267934799], [0.08836523443460464, 0.10405506938695908, 0.08971231430768967, 0.10564132779836655, 0.09107992798089981, 0.09361013770103455, 0.10594364255666733, 0.09503716975450516, 0.02629684843122959, 0.1032773107290268, 0.09698105603456497]], [[0.07215292006731033, 0.07709572464227676, 0.0753379538655281, 0.09867949783802032, 0.08045510947704315, 0.08160712569952011, 0.07974649965763092, 0.10842155665159225, 0.10594956576824188, 0.11154870688915253, 0.10900542140007019], [0.07402658462524414, 0.07854689657688141, 0.07694298774003983, 0.0979534313082695, 0.08160161226987839, 0.08264602720737457, 0.08095841109752655, 0.10656039416790009, 0.10438445210456848, 0.10930556803941727, 0.10707356780767441], [0.07337141782045364, 0.07804134488105774, 0.07638304680585861, 0.09820886701345444, 0.08120344579219818, 0.08228569477796555, 0.08053720742464066, 0.10720819234848022, 0.10493013262748718, 0.1100849136710167, 0.10774572938680649], [0.08123128116130829, 0.08397666364908218, 0.08301068097352982, 0.09504567831754684, 0.08579275757074356, 0.08640680462121964, 0.08541286736726761, 0.09964228421449661, 0.09849610179662704, 0.1010737419128418, 0.09991109371185303], [0.07524649053812027, 0.07948293536901474, 0.07798191905021667, 0.09747354686260223, 0.08233528584241867, 0.0833086371421814, 0.08173537254333496, 0.10536272078752518, 0.1033729612827301, 0.10786860436201096, 0.10583152621984482], [0.0756554901599884, 0.0797952264547348, 0.0783291906118393, 0.09731144458055496, 0.08257904648780823, 0.08352840691804886, 0.08199377357959747, 0.10496362298727036, 0.10303516685962677, 0.1073908880352974, 0.10541784018278122], [0.0749925822019577, 0.07928868383169174, 0.0777660682797432, 0.09757387638092041, 0.08218339830636978, 0.08317161351442337, 0.0815744400024414, 0.10561109334230423, 0.10358300805091858, 0.10816618800163269, 0.1060890331864357], [0.08406871557235718, 0.08605124801397324, 0.08535592257976532, 0.09385687112808228, 0.08735206723213196, 0.08779003471136093, 0.08708065003156662, 0.09701739996671677, 0.09623346477746964, 0.0979926809668541, 0.09720086306333542], [0.08336924761533737, 0.08554312586784363, 0.08478008955717087, 0.09415196627378464, 0.08697234094142914, 0.08745402842760086, 0.08667395263910294, 0.0976594015955925, 0.09678828716278076, 0.09874416142702103, 0.09786337614059448], [0.08493492007255554, 0.08667754381895065, 0.08606695383787155, 0.09348968416452408, 0.08781814575195312, 0.08820166438817978, 0.08758033812046051, 0.09622693061828613, 0.0955490693449974, 0.09706925600767136, 0.09638546407222748], [0.08423200249671936, 0.08616956323385239, 0.08549012988805771, 0.09378780424594879, 0.08744028210639954, 0.08786800503730774, 0.08717518299818039, 0.09686800837516785, 0.0961042270064354, 0.09781800955533981, 0.09704673290252686]], [[0.05182647332549095, 0.06480555236339569, 0.05290982872247696, 0.06616021692752838, 0.05401582270860672, 0.05607810989022255, 0.06824548542499542, 0.057250332087278366, 0.40789344906806946, 0.06414411216974258, 0.05667058378458023], [0.08062457293272018, 0.08675618469715118, 0.08117347210645676, 0.08734682947397232, 0.08172611147165298, 0.08273660391569138, 0.08824034780263901, 0.08329988270998001, 0.15860898792743683, 0.0864647701382637, 0.08302228152751923], [0.05479495972394943, 0.06757144629955292, 0.055868420749902725, 0.06889519840478897, 0.05696289986371994, 0.05900002643465996, 0.07092960178852081, 0.06015585735440254, 0.3793127238750458, 0.06692447513341904, 0.05958440154790878], [0.08277247101068497, 0.08783771097660065, 0.08322881907224655, 0.0883219763636589, 0.0836876705288887, 0.08452518284320831, 0.08905339986085892, 0.08499118685722351, 0.14322145283222198, 0.08759854733943939, 0.0847615972161293], [0.0577368400990963, 0.07021624594926834, 0.05879220739006996, 0.07149973511695862, 0.059866879135370255, 0.0618634968996048, 0.07346909493207932, 0.06299430131912231, 0.35153743624687195, 0.06958834826946259, 0.062435392290353775], [0.06294779479503632, 0.07464996725320816, 0.06394919008016586, 0.07583753019571304, 0.06496652215719223, 0.06685040891170502, 0.0776543915271759, 0.06791388988494873, 0.30377382040023804, 0.07406798005104065, 0.06738857179880142], [0.08581535518169403, 0.08918732404708862, 0.0861220508813858, 0.08950608223676682, 0.08642986416816711, 0.086990125477314, 0.08998635411262512, 0.08730103075504303, 0.12248411774635315, 0.08902966976165771, 0.08714793622493744], [0.06573673337697983, 0.076881043612957, 0.06669660657644272, 0.0780036523938179, 0.06767049431800842, 0.06947068125009537, 0.07971836626529694, 0.07048507034778595, 0.27902284264564514, 0.07633036375045776, 0.06998416781425476], [0.17381258308887482, 0.05432591214776039, 0.1560729295015335, 0.048781316727399826, 0.14014387130737305, 0.11531815677881241, 0.04150717705488205, 0.10354858636856079, 3.780862471103319e-06, 0.057304900139570236, 0.10918080806732178], [0.0795232430100441, 0.08616308867931366, 0.08011575788259506, 0.0868050754070282, 0.0807126834988594, 0.08180514723062515, 0.0877770408987999, 0.0824146643280983, 0.1667225956916809, 0.08584649115800858, 0.08211422711610794], [0.06437357515096664, 0.07580351829528809, 0.06535491347312927, 0.07695910334587097, 0.06635120511054993, 0.0681944489479065, 0.07872559130191803, 0.06923403590917587, 0.29104605317115784, 0.07523693144321442, 0.06872060894966125]], [[0.07268249988555908, 0.0737854540348053, 0.07792257517576218, 0.09969659149646759, 0.08030544966459274, 0.07836716622114182, 0.07955638319253922, 0.1058872640132904, 0.10749409347772598, 0.11352125555276871, 0.11078126728534698], [0.07305306196212769, 0.07413777709007263, 0.07820345461368561, 0.0995306447148323, 0.08054307848215103, 0.07864009588956833, 0.07980776578187943, 0.10557505488395691, 0.10714266449213028, 0.11301832646131516, 0.11034805327653885], [0.07440290600061417, 0.07541971653699875, 0.07922057062387466, 0.09892082959413528, 0.08140066266059875, 0.07962781935930252, 0.08071603626012802, 0.10444021224975586, 0.10586751252412796, 0.11120282113552094, 0.10878091305494308], [0.08064168691635132, 0.0813145786523819, 0.08379931002855301, 0.09600315988063812, 0.0852036327123642, 0.08406276255846024, 0.08476421236991882, 0.09924778342247009, 0.10007593035697937, 0.10313395410776138, 0.10175301134586334], [0.07515324652194977, 0.07613129913806915, 0.07978185266256332, 0.09857834875583649, 0.08187194913625717, 0.08017249405384064, 0.08121588081121445, 0.10381107032299042, 0.10516208410263062, 0.11020467430353165, 0.10791709274053574], [0.07454435527324677, 0.07555391639471054, 0.07932659983634949, 0.09885646402835846, 0.08148980885744095, 0.07973074167966843, 0.0808105394244194, 0.10432151705026627, 0.10573434829711914, 0.11101406067609787, 0.10861767828464508], [0.07491941750049591, 0.07590962946414948, 0.07960724830627441, 0.09868533909320831, 0.08172550052404404, 0.08000309020280838, 0.0810604989528656, 0.10400699824094772, 0.10538165271282196, 0.11051488667726517, 0.10818572342395782], [0.08220021426677704, 0.08277950435876846, 0.0849122405052185, 0.09525125473737717, 0.08611328154802322, 0.08513779938220978, 0.08573779463768005, 0.09796486049890518, 0.09865525364875793, 0.1011970192193985, 0.1000506803393364], [0.08259177953004837, 0.0831470787525177, 0.08518994599580765, 0.0950610488653183, 0.08633933216333389, 0.0854058638215065, 0.08598008751869202, 0.09764349460601807, 0.09829998016357422, 0.10071515291929245, 0.09962625056505203], [0.08401641249656677, 0.08448278158903122, 0.08619382977485657, 0.09436465799808502, 0.08715338259935379, 0.08637425303459167, 0.08685370534658432, 0.09647738188505173, 0.09701290726661682, 0.09897774457931519, 0.09809290617704391], [0.0833771750330925, 0.08388375490903854, 0.08574462682008743, 0.09467795491218567, 0.08678974211215973, 0.08594106137752533, 0.08646322041749954, 0.09699999541044235, 0.09758935123682022, 0.09975427389144897, 0.09877882897853851]], [[0.05190601944923401, 0.06490501016378403, 0.05299102142453194, 0.06626174598932266, 0.05409872159361839, 0.05616416782140732, 0.06835021823644638, 0.055803824216127396, 0.40851926803588867, 0.06424255669116974, 0.056757550686597824], [0.08068408817052841, 0.08682023733854294, 0.08123340457677841, 0.0874113216996193, 0.08178644627332687, 0.08279768377542496, 0.08830548822879791, 0.08262307941913605, 0.1587260216474533, 0.08652860671281815, 0.08308357000350952], [0.0548778772354126, 0.0676736980676651, 0.05595296248793602, 0.06899945437908173, 0.05704910308122635, 0.059089306741952896, 0.07103694975376129, 0.058733709156513214, 0.37988659739494324, 0.06702575087547302, 0.059674572199583054], [0.08282303065061569, 0.0878913626074791, 0.08327965438365936, 0.08837592601776123, 0.0837387889623642, 0.0845768079161644, 0.08910778909921646, 0.08443225175142288, 0.14330889284610748, 0.0876520574092865, 0.08481337130069733], [0.0578223392367363, 0.07032022625207901, 0.05887927860021591, 0.0716056227684021, 0.05995553731918335, 0.061955101788043976, 0.0735778957605362, 0.06160693243145943, 0.3520578444004059, 0.06969139724969864, 0.0625278651714325], [0.06303547322750092, 0.07475395500659943, 0.06403826922178268, 0.07594316452741623, 0.06505701690912247, 0.06694351881742477, 0.07776255905628204, 0.06661560386419296, 0.3041968047618866, 0.07417116314172745, 0.06748244911432266], [0.08585033565759659, 0.08922368288040161, 0.0861571729183197, 0.08954256772994995, 0.08646509796380997, 0.08702559769153595, 0.09002304822206497, 0.08692905306816101, 0.12253402918577194, 0.08906597644090652, 0.08718346804380417], [0.062153615057468414, 0.0740276649594307, 0.06316766887903214, 0.07523544877767563, 0.06419827044010162, 0.06610779464244843, 0.07708417624235153, 0.06577576696872711, 0.3121601343154907, 0.0734359547495842, 0.0666535347700119], [0.1711263209581375, 0.05348632484674454, 0.1536608636379242, 0.048027414828538895, 0.1379779726266861, 0.11353594064712524, 0.0408656969666481, 0.1174030676484108, 3.7224403968139086e-06, 0.056419264525175095, 0.10749344527721405], [0.07958677411079407, 0.08623192459344864, 0.08017975836992264, 0.08687442541122437, 0.08077716827392578, 0.08187050372362137, 0.08784717321395874, 0.08168163895606995, 0.16685575246810913, 0.08591507375240326, 0.08217982947826385], [0.06446123123168945, 0.07590674608945847, 0.06544390320777893, 0.0770638957619667, 0.06644156575202942, 0.06828732043504715, 0.07883279025554657, 0.06796663999557495, 0.29144230484962463, 0.07533938437700272, 0.06881418824195862]]], "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 1.5413037544931285e-05, "vf_explained_var": -0.00039780139923095703, "total_loss": 0.2779628336429596, "policy_loss": -0.00011345207167323679, "num_module_steps_trained_lifetime": 113715, "use_intrinsic_rewards": 0.0, "num_module_steps_trained": 5985, "vf_loss": 0.358307421207428, "weights_seq_no": 19.0, "module_train_batch_size_mean": 997.6572809365935, "curr_kl_coeff": 3.0819688845440396e-07, "curr_entropy_coeff": 0.0015431216992, "entropy": 0.6891655325889587, "vf_loss_unclipped": 43.22478485107422, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 735.879207300332}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"module_train_batch_size_mean": 997.4980069784294, "total_loss": 0.0, "num_module_steps_trained_lifetime": 682290, "diff_num_grad_updates_vs_sampler_policy": 96.0, "num_module_steps_trained": 35910, "weights_seq_no": 114.0}, "default_policy": {"policy_loss": -0.00010871535778278485, "num_module_steps_trained_lifetime": 682290, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35910, "vf_loss": 0.3583288788795471, "weights_seq_no": 114.0, "module_train_batch_size_mean": 997.4980069784294, "entropy": 0.6891753077507019, "vf_loss_unclipped": 43.361572265625, "diff_num_grad_updates_vs_sampler_policy": 96.0, "mean_kl_loss": 1.4812886547588278e-05, "vf_explained_var": -0.0025690793991088867, "total_loss": 0.27798664569854736}, "__all_modules__": {"num_env_steps_trained": 198000, "num_module_steps_trained_lifetime": 1364580, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 3762000, "num_env_steps_trained_lifetime_throughput": 43962.20863501048}}}, "intrinsic_reward_module": {"curr_entropy_coeff": 0.0015431216992, "default_optimizer_learning_rate": 0.0002715581955, "module_train_batch_size_mean": 997.6572809365935, "total_loss": 0.0, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 113715, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "weights_seq_no": 19.0, "num_module_steps_trained_lifetime_throughput": 735.88592281257}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 627000, "num_env_steps_trained": 33000, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 227430, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 4058.475114722657, "num_module_steps_trained_throughput": 20229812.8391183, "num_module_steps_trained_lifetime_throughput": 13628400.597465172}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 380, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -0.2}, "episode_len_min": 20, "weights_seq_no": 19.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7550700427112477e-06, "numpy_to_tensor": 1.1762787270297229e-05, "add_observations_from_episodes_to_batch": 2.775177146635099e-06, "add_time_dim_to_batch_and_zero_pad": 6.8458673687893155e-06, "batch_individual_items": 1.2250060789766119e-05}}, "connector_pipeline_timer": 5.804827946780076e-05}, "num_env_steps_sampled": 400, "env_reset_timer": 0.00019478874046319225, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1779176445161606e-05, "get_actions": 3.504544939138904e-05, "listify_data_for_vector_env": 1.0394317002791896e-05, "un_batch_to_individual_items": 6.379104204669877e-06, "tensor_to_numpy": 1.4803050534236147e-05, "normalize_and_clip_actions": 7.944645975319626e-06}}, "connector_pipeline_timer": 0.00011221888103754532}, "episode_len_max": 20, "env_step_timer": 1.370043085025106e-05, "rlmodule_inference_timer": 3.026811244565859e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": -0.2}, "episode_len_mean": 20.0, "episode_return_min": -14.5, "episode_return_mean": -0.2, "num_env_steps_sampled_lifetime": 95400, "sample": 0.11700073520696876, "episode_duration_sec_mean": 0.005335969192674384, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "episode_return_max": 14.5, "time_between_sampling": 9.6463922686839}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "aec1c_00000", "date": "2025-08-11_18-42-18", "timestamp": 1754930538, "time_this_iter_s": 9.754891872406006, "time_total_s": 188.47917413711548, "pid": 11610, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3842f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 188.47917413711548, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 40.67142857142858, "ram_util_percent": 78.65714285714286}}
{"timers": {"training_iteration": 9.83547526462593, "restore_env_runners": 8.537758324909338e-06, "training_step": 9.835300775208655, "env_runner_sampling_timer": 1.63067631766931, "learner_update_timer": 8.016738435769469, "synch_weights": 0.0011091820548768737, "restore_eval_env_runners": 2.081175949455425e-05, "evaluation_iteration": 0.12382717988228123, "synch_eval_env_connectors": 0.00016105825241741548, "synch_env_connectors": 5.317069483359205e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.6069812768002513e-05, "normalize_and_clip_actions": 8.299738507691835e-06, "get_actions": 4.199398326407487e-05, "un_batch_to_individual_items": 6.680902937130696e-06, "remove_single_ts_time_rank_from_batch": 1.2140566727309029e-05, "listify_data_for_vector_env": 1.089086305725903e-05}}, "connector_pipeline_timer": 0.00012352780375707954}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.184510102309512e-06, "numpy_to_tensor": 1.3031462756987627e-05, "add_states_from_episodes_to_batch": 2.774455035274185e-06, "add_observations_from_episodes_to_batch": 2.8848521756712926e-06, "batch_individual_items": 1.2730068387527788e-05}}, "connector_pipeline_timer": 6.1362099906148e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "rlmodule_inference_timer": 3.3470892305869015e-05, "episode_len_mean": 20.0, "episode_return_min": -11.5, "weights_seq_no": 19.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_mean": -0.7800000000000001, "episode_return_max": 8.5, "num_env_steps_sampled_lifetime": -11105000.0, "num_env_steps_sampled": 5000.0, "sample": 0.005806257879532405, "env_reset_timer": 3.916798338618043e-05, "episode_duration_sec_mean": 0.005482098476495596, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -555250.0, "time_between_sampling": 0.03322976808359368, "num_episodes": 250.0, "agent_episode_returns_mean": {"default_agent": -0.7800000000000001}, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_step_timer": 1.4286657440598146e-05, "module_episode_returns_mean": {"default_policy": -0.7800000000000001}, "episode_len_min": 20, "num_env_steps_sampled_lifetime_throughput": 3141.908159074395}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.14827684348123976, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008916812376074215, "add_observations_from_episodes_to_batch": 0.0008360022140301588, "add_columns_from_episodes_to_train_batch": 0.04159180732030636, "add_time_dim_to_batch_and_zero_pad": 0.07610527393005943, "add_states_from_episodes_to_batch": 0.00358173085360197, "batch_individual_items": 0.017046211626468195, "numpy_to_tensor": 7.135309315072954e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"IntrinsicAttentionMask": [[[0.07187044620513916, 0.07398365437984467, 0.07789348810911179, 0.1020267903804779, 0.07720744609832764, 0.08128763735294342, 0.08245158195495605, 0.10404496639966965, 0.10954345762729645, 0.11111198365688324, 0.1085786446928978], [0.0726981982588768, 0.07473577558994293, 0.07849865406751633, 0.10154732316732407, 0.07783903181552887, 0.08175816386938095, 0.08287446945905685, 0.10346249490976334, 0.10867174714803696, 0.11015553027391434, 0.10775858163833618], [0.07418199628591537, 0.07608022540807724, 0.07957417517900467, 0.10068624466657639, 0.07896275818347931, 0.08258907496929169, 0.08361922204494476, 0.10242058336734772, 0.1071242094039917, 0.10846038162708282, 0.10630109906196594], [0.08221684396266937, 0.08327741920948029, 0.08519602566957474, 0.09599796682596207, 0.0848633199930191, 0.08681846410036087, 0.08736611902713776, 0.09683326631784439, 0.0990641787648201, 0.09968908131122589, 0.09867732226848602], [0.07392594963312149, 0.07584856450557709, 0.07938943058252335, 0.10083497315645218, 0.07876960933208466, 0.08244683593511581, 0.08349192142486572, 0.10260017961263657, 0.107389897108078, 0.10875115543603897, 0.10655147582292557], [0.07542318105697632, 0.07720113545656204, 0.08046474307775497, 0.09996452182531357, 0.07989444583654404, 0.08327191323041916, 0.0842292308807373, 0.10155129432678223, 0.10584428161382675, 0.10706111043691635, 0.10509411990642548], [0.07583936303853989, 0.07757622748613358, 0.08076152205467224, 0.09972226619720459, 0.08020517975091934, 0.08349841088056564, 0.08443116396665573, 0.10126030445098877, 0.10541806370019913, 0.10659568756818771, 0.10469187796115875], [0.08281619101762772, 0.08380874246358871, 0.0856020376086235, 0.0956471785902977, 0.08529127389192581, 0.08711627870798111, 0.08762695640325546, 0.0964205265045166, 0.09848367422819138, 0.09906098991632462, 0.09812614321708679], [0.08440195769071579, 0.08521085232496262, 0.0866675078868866, 0.09471879154443741, 0.08641551434993744, 0.08789276331663132, 0.0883050188422203, 0.09533143043518066, 0.09696109592914581, 0.09741588681936264, 0.09667918086051941], [0.0848422572016716, 0.08559921383857727, 0.08696110546588898, 0.09446094930171967, 0.0867256224155426, 0.08810543268918991, 0.08849021792411804, 0.0950297936797142, 0.09654172509908676, 0.09696334600448608, 0.0962802916765213], [0.08412852883338928, 0.08496947586536407, 0.08648470044136047, 0.0948789045214653, 0.08622249215841293, 0.0877600684762001, 0.08818935602903366, 0.09551892429590225, 0.09722227603197098, 0.09769784659147263, 0.09692751616239548]], [[0.057937368750572205, 0.06938787549734116, 0.057595886290073395, 0.07071888446807861, 0.05870070308446884, 0.059261031448841095, 0.07097313553094864, 0.06039779260754585, 0.3666362166404724, 0.0670459195971489, 0.0613451711833477], [0.08164728432893753, 0.08707855641841888, 0.08147510886192322, 0.08767139166593552, 0.0820297971367836, 0.08230855315923691, 0.0877838283777237, 0.08286892622709274, 0.15778830647468567, 0.0860174372792244, 0.08333078026771545], [0.05703774839639664, 0.06857055425643921, 0.05669449269771576, 0.06991388648748398, 0.05780515819787979, 0.05836863070726395, 0.07017055153846741, 0.059512101113796234, 0.37525320053100586, 0.06620828062295914, 0.06046541407704353], [0.08361516892910004, 0.08809462934732437, 0.08347225934267044, 0.08858031034469604, 0.08393246680498123, 0.08416351675987244, 0.08867234736680984, 0.08462751656770706, 0.14260855317115784, 0.08722373098134995, 0.08500951528549194], [0.05991240590810776, 0.0711519792675972, 0.05957571417093277, 0.07245257496833801, 0.06066469848155975, 0.06121663749217987, 0.0727008804678917, 0.06233561784029007, 0.3478614091873169, 0.06886070966720581, 0.06326743960380554], [0.06132914498448372, 0.07239099591970444, 0.06099670007824898, 0.07366682589054108, 0.06207170709967613, 0.06261629611253738, 0.07391031086444855, 0.06371984630823135, 0.3345184922218323, 0.07014135271310806, 0.06463827937841415], [0.08397518843412399, 0.08827003836631775, 0.08383800089359283, 0.08873511850833893, 0.08427973091602325, 0.08450146019458771, 0.08882323652505875, 0.08494669198989868, 0.13988161087036133, 0.08743580430746078, 0.08531313389539719], [0.06411284953355789, 0.07475798577070236, 0.06379084289073944, 0.07597768306732178, 0.06483160704374313, 0.06535834074020386, 0.07621028274297714, 0.06642468273639679, 0.30862119793891907, 0.07260342687368393, 0.0673111081123352], [0.14652135968208313, 0.053589820861816406, 0.15143248438835144, 0.048201609402894974, 0.13620662689208984, 0.12917782366275787, 0.047246452420949936, 0.11618959903717041, 4.9793129619502e-06, 0.06489964574575424, 0.10652957111597061], [0.07782222330570221, 0.08485151082277298, 0.07760193943977356, 0.08562809973955154, 0.07831217348575592, 0.0786697193980217, 0.08577557653188705, 0.07938972860574722, 0.18849854171276093, 0.08346603810787201, 0.07998441159725189], [0.06633659452199936, 0.07658082991838455, 0.06602507084608078, 0.07774826139211655, 0.06703159213066101, 0.06754058599472046, 0.07797075062990189, 0.06857020407915115, 0.28825533390045166, 0.07451553642749786, 0.06942528486251831]], [[0.07215840369462967, 0.07710158079862595, 0.07534366846084595, 0.10243555903434753, 0.07751677930355072, 0.08161332458257675, 0.08278191834688187, 0.10446182638406754, 0.10595759004354477, 0.10747476667165756, 0.11315451562404633], [0.07403092831373215, 0.0785515084862709, 0.07694750279188156, 0.10128108412027359, 0.07892979681491852, 0.08265087008476257, 0.08370871841907501, 0.10307135432958603, 0.10439055413007736, 0.10572663694620132, 0.11071103811264038], [0.07337614893913269, 0.07804636657238007, 0.07638796418905258, 0.10168485343456268, 0.0784376785159111, 0.08229099214076996, 0.08338773995637894, 0.10355670750141144, 0.1049368754029274, 0.10633543878793716, 0.11155925691127777], [0.08235013484954834, 0.08479923009872437, 0.0839385911822319, 0.09615359455347061, 0.0850009024143219, 0.08695921301841736, 0.08750775456428528, 0.09699025005102158, 0.09760206192731857, 0.09821773320436478, 0.10048054903745651], [0.0741838589310646, 0.07866920530796051, 0.07707798480987549, 0.10118677467107773, 0.07904443144798279, 0.08273448050022125, 0.08378320187330246, 0.10295813530683517, 0.10426321625709534, 0.10558483749628067, 0.11051388829946518], [0.07565895467996597, 0.0797988772392273, 0.07833275943994522, 0.10027700662612915, 0.08014419674873352, 0.08353221416473389, 0.084492526948452, 0.10186874121427536, 0.10303986072540283, 0.10422443598508835, 0.10863043367862701], [0.0760689377784729, 0.0801110789179802, 0.07868028432130814, 0.10002414137125015, 0.0804479643702507, 0.08375117182731628, 0.0846867486834526, 0.10156683623790741, 0.10270143300294876, 0.10384870320558548, 0.10811274498701096], [0.08294033259153366, 0.08523072302341461, 0.0844264030456543, 0.0957905575633049, 0.08541911840438843, 0.0872468650341034, 0.08775831013917923, 0.09656505286693573, 0.09713112562894821, 0.09770050644874573, 0.0997910425066948], [0.08337000012397766, 0.08554390072822571, 0.08478084951639175, 0.09552635252475739, 0.08572255820035934, 0.08745481818914413, 0.08793918788433075, 0.09625604748725891, 0.09678915143013, 0.09732521325349808, 0.09929193556308746], [0.08380074799060822, 0.08585703372955322, 0.08513562381267548, 0.0952615812420845, 0.0860258936882019, 0.08766206353902817, 0.08811921626329422, 0.09594670683145523, 0.09644706547260284, 0.09695003181695938, 0.09879396855831146], [0.08536999672651291, 0.08699100464582443, 0.08642330020666122, 0.094297856092453, 0.08712373673915863, 0.08840678632259369, 0.08876431733369827, 0.09482366591691971, 0.09520715475082397, 0.0955921858549118, 0.09699995070695877]], [[0.057317983359098434, 0.06695707887411118, 0.05698014050722122, 0.06824146956205368, 0.058073148131370544, 0.058627501130104065, 0.07198555022478104, 0.061259347945451736, 0.37186604738235474, 0.06800231337547302, 0.06068935617804527], [0.07867759466171265, 0.08432414382696152, 0.07847047597169876, 0.08504161238670349, 0.0791381299495697, 0.0794740840792656, 0.0870913565158844, 0.08104559034109116, 0.18111994862556458, 0.08490858227014542, 0.08070845901966095], [0.05640396848320961, 0.06610553711652756, 0.056064534932374954, 0.06740057468414307, 0.05716286227107048, 0.05772007256746292, 0.07117860019207001, 0.06036703661084175, 0.3806438148021698, 0.06715939939022064, 0.05979355797171593], [0.08082558959722519, 0.08571907132863998, 0.08064509928226471, 0.08633722364902496, 0.0812266618013382, 0.08151900768280029, 0.08809889107942581, 0.0828840509057045, 0.16393010318279266, 0.08622266352176666, 0.08259155601263046], [0.05932564288377762, 0.06880156695842743, 0.05899224057793617, 0.07005919516086578, 0.060070570558309555, 0.060617104172706604, 0.07371905446052551, 0.06320863217115402, 0.3527330160140991, 0.06982510536909103, 0.06264781951904297], [0.060766611248254776, 0.07010269165039062, 0.06043720990419388, 0.07133819162845612, 0.0615023598074913, 0.062041956931352615, 0.07492920011281967, 0.06459825485944748, 0.33912980556488037, 0.07110827416181564, 0.06404539197683334], [0.08628998696804047, 0.08884552866220474, 0.08619426935911179, 0.08916306495666504, 0.0865023210644722, 0.08665677160024643, 0.09006179124116898, 0.0873742327094078, 0.1225866749882698, 0.0891043096780777, 0.08722099661827087], [0.06719719618558884, 0.07565777003765106, 0.06689480692148209, 0.07676252722740173, 0.06787160038948059, 0.06836532056331635, 0.07995525747537613, 0.07069453597068787, 0.27985164523124695, 0.07655718922615051, 0.0701921358704567], [0.1494034379720688, 0.06192781776189804, 0.15449225902557373, 0.055607352405786514, 0.13872447609901428, 0.13145478069782257, 0.041086792945861816, 0.1024998351931572, 3.7425793379952665e-06, 0.056724511086940765, 0.1080750823020935], [0.08043694496154785, 0.08547300100326538, 0.08025138825178146, 0.08610984683036804, 0.08084932714700699, 0.08114997297525406, 0.08792564272880554, 0.08255419135093689, 0.16700465977191925, 0.08599182963371277, 0.08225324004888535], [0.06586417555809021, 0.07454203069210052, 0.06555487215518951, 0.07567837834358215, 0.06655421853065491, 0.06705959141254425, 0.07896645367145538, 0.06944586336612701, 0.29193639755249023, 0.07546712458133698, 0.06893086433410645]], [[0.07292681932449341, 0.07403348386287689, 0.07515691965818405, 0.10406134277582169, 0.07745521515607834, 0.08179810643196106, 0.0798238068819046, 0.10624319314956665, 0.1078554093837738, 0.10949210822582245, 0.11115363240242004], [0.07329362630844116, 0.07438191771507263, 0.07548635452985764, 0.10379344969987869, 0.07774469256401062, 0.08200818300247192, 0.08007058501243591, 0.10592271387577057, 0.10749548673629761, 0.1090916097164154, 0.11071143299341202], [0.07366129755973816, 0.0747309997677803, 0.07581622153520584, 0.10352484881877899, 0.07803419232368469, 0.08221768587827682, 0.08031704276800156, 0.10560179501771927, 0.10713532567024231, 0.10869111865758896, 0.11026951670646667], [0.0818021148443222, 0.0824151262640953, 0.08303273469209671, 0.09756730496883392, 0.08428186923265457, 0.08659224212169647, 0.08554979413747787, 0.09857608377933502, 0.09931480139493942, 0.10005905479192734, 0.10080888122320175], [0.0743991807103157, 0.07543104141950607, 0.07647719979286194, 0.10298560559749603, 0.0786132663488388, 0.08263497799634933, 0.08080900460481644, 0.10495863109827042, 0.1064143180847168, 0.10789020359516144, 0.10938655585050583], [0.07574409246444702, 0.07670515775680542, 0.07767841219902039, 0.10200216621160507, 0.07966214418411255, 0.08338475227355957, 0.0816965252161026, 0.1037895679473877, 0.10510648041963577, 0.10644009709358215, 0.10779064893722534], [0.07514042407274246, 0.07613355666399002, 0.07713980972766876, 0.10244367271661758, 0.0791923999786377, 0.08304993063211441, 0.08129961043596268, 0.10431379079818726, 0.10569249838590622, 0.10708944499492645, 0.10850484669208527], [0.08233314007520676, 0.08291337639093399, 0.08349769562482834, 0.09717846661806107, 0.08467872440814972, 0.08686038851737976, 0.0858764499425888, 0.09812328219413757, 0.09881479293107986, 0.09951117634773254, 0.1002124696969986], [0.08271940797567368, 0.08327556401491165, 0.08383546024560928, 0.09689566493034363, 0.08496657013893127, 0.08705414831638336, 0.08611294627189636, 0.09779436141252518, 0.0984518826007843, 0.09911380708217621, 0.09978019446134567], [0.08310635387897491, 0.08363819867372513, 0.08417344093322754, 0.0966123640537262, 0.0852542445063591, 0.08724714070558548, 0.08634891360998154, 0.09746522456407547, 0.09808896481990814, 0.09871669113636017, 0.09934843331575394], [0.08349398523569107, 0.08400128781795502, 0.0845116600394249, 0.09632860124111176, 0.0855417400598526, 0.0874393954873085, 0.08658436685800552, 0.09713589400053024, 0.09772606939077377, 0.09831983596086502, 0.09891720861196518]], [[0.08473625034093857, 0.10868782550096512, 0.08671154081821442, 0.11122144758701324, 0.0914546549320221, 0.09251447021961212, 0.11513305455446243, 0.09467107057571411, 0.012978589162230492, 0.10425501316785812, 0.09763608872890472], [0.0902043879032135, 0.09956616908311844, 0.09103268384933472, 0.10048042982816696, 0.09297619760036469, 0.09340209513902664, 0.10186758637428284, 0.09425975382328033, 0.04285565763711929, 0.09793513268232346, 0.09541988372802734], [0.08535120636224747, 0.10796509683132172, 0.08722849935293198, 0.11033977568149567, 0.09172666072845459, 0.09272993355989456, 0.11400008946657181, 0.09476952254772186, 0.014516984112560749, 0.1038028746843338, 0.09756942838430405], [0.09050439298152924, 0.09851806610822678, 0.09121797978878021, 0.09929482638835907, 0.09288875758647919, 0.09325423091650009, 0.10047147423028946, 0.09398949146270752, 0.04774836450815201, 0.09712981432676315, 0.0949825569987297], [0.08671466261148453, 0.10622134059667587, 0.08835874497890472, 0.10823525488376617, 0.09227868169546127, 0.09314936399459839, 0.11132796108722687, 0.09491543471813202, 0.018790338188409805, 0.10267671197652817, 0.0973314642906189], [0.08699695020914078, 0.10582888871431351, 0.08858935534954071, 0.10776600986719131, 0.0923820361495018, 0.0932236835360527, 0.1107383593916893, 0.09493007510900497, 0.019865533336997032, 0.10241638123989105, 0.0972626730799675], [0.09084995836019516, 0.09685320407152176, 0.09138967841863632, 0.0974285900592804, 0.09264932572841644, 0.09292411804199219, 0.09829806536436081, 0.09347614645957947, 0.05608879774808884, 0.09582209587097168, 0.09422007203102112], [0.08754544705152512, 0.1050257608294487, 0.08903323858976364, 0.10681062191724777, 0.09256917983293533, 0.09335245192050934, 0.10954495519399643, 0.09493892639875412, 0.02219923958182335, 0.10187579691410065, 0.09710435569286346], [0.03777851536870003, 0.1503068506717682, 0.042930010706186295, 0.17080271244049072, 0.05768531560897827, 0.06149265542626381, 0.20690394937992096, 0.06987779587507248, 1.140321387538279e-06, 0.11930552870035172, 0.08291543275117874], [0.08954136073589325, 0.10134877264499664, 0.09057395905256271, 0.10251753777265549, 0.09300621598958969, 0.09354095906019211, 0.1042960062623024, 0.09461967647075653, 0.03520221263170242, 0.09927050024271011, 0.09608280658721924], [0.08824148029088974, 0.10390934348106384, 0.08958667516708374, 0.10549338161945343, 0.09277456998825073, 0.09347904473543167, 0.10791482776403427, 0.09490408003330231, 0.025744259357452393, 0.10110703110694885, 0.09684522449970245]]], "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 5.913841596338898e-05, "vf_explained_var": 0.0010507702827453613, "total_loss": 0.2773626446723938, "policy_loss": -0.000715469301212579, "num_module_steps_trained_lifetime": 119700, "use_intrinsic_rewards": 0.0, "num_module_steps_trained": 5985, "vf_loss": 0.358307808637619, "weights_seq_no": 20.0, "module_train_batch_size_mean": 997.6479298448816, "curr_kl_coeff": 1.5409844422720198e-07, "curr_entropy_coeff": 0.0015431216992, "entropy": 0.6881598830223083, "vf_loss_unclipped": 43.3150634765625, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 734.2434131468557}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"module_train_batch_size_mean": 997.4978492525759, "total_loss": 0.0, "num_module_steps_trained_lifetime": 718200, "diff_num_grad_updates_vs_sampler_policy": 101.0, "num_module_steps_trained": 35910, "weights_seq_no": 120.0}, "default_policy": {"policy_loss": -0.0006911905365996063, "num_module_steps_trained_lifetime": 718200, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35910, "vf_loss": 0.35832861065864563, "weights_seq_no": 120.0, "module_train_batch_size_mean": 997.4978492525759, "entropy": 0.688197672367096, "vf_loss_unclipped": 43.50804138183594, "diff_num_grad_updates_vs_sampler_policy": 101.0, "mean_kl_loss": 5.505926310434006e-05, "vf_explained_var": -0.0025578737258911133, "total_loss": 0.2774120271205902}, "__all_modules__": {"num_env_steps_trained": 198000, "num_module_steps_trained_lifetime": 1436400, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 3960000, "num_env_steps_trained_lifetime_throughput": 43363.8647216895}}}, "intrinsic_reward_module": {"curr_entropy_coeff": 0.0015431216992, "default_optimizer_learning_rate": 0.0002715581955, "module_train_batch_size_mean": 997.6479298448816, "total_loss": 0.0, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 119700, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "weights_seq_no": 20.0, "num_module_steps_trained_lifetime_throughput": 734.2496803295063}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 660000, "num_env_steps_trained": 33000, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 239400, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 4049.4187703444177, "num_module_steps_trained_throughput": 19824186.737691876, "num_module_steps_trained_lifetime_throughput": 13567223.965399463}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 400, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -0.8}, "episode_len_min": 20, "weights_seq_no": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.836730497487195e-06, "numpy_to_tensor": 1.3092128512311538e-05, "add_observations_from_episodes_to_batch": 2.904702081470018e-06, "add_time_dim_to_batch_and_zero_pad": 7.300152084210875e-06, "batch_individual_items": 1.3063512714810451e-05}}, "connector_pipeline_timer": 6.202712943594878e-05}, "num_env_steps_sampled": 400, "env_reset_timer": 0.00019363293359504503, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2404810883025128e-05, "get_actions": 4.027526137365899e-05, "listify_data_for_vector_env": 1.0818912262265902e-05, "un_batch_to_individual_items": 6.716237101194012e-06, "tensor_to_numpy": 1.597934798455475e-05, "normalize_and_clip_actions": 8.170205608075133e-06}}, "connector_pipeline_timer": 0.00012211687779688}, "episode_len_max": 20, "env_step_timer": 1.4957304939174136e-05, "rlmodule_inference_timer": 3.296909775033504e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": -0.8}, "episode_len_mean": 20.0, "episode_return_min": -14.5, "episode_return_mean": -0.8, "num_env_steps_sampled_lifetime": 100400, "sample": 0.11709926993555103, "episode_duration_sec_mean": 0.005466289174510166, "num_module_steps_sampled": {"default_policy": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "episode_return_max": 14.5, "time_between_sampling": 9.647132904336496}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "aec1c_00000", "date": "2025-08-11_18-42-28", "timestamp": 1754930548, "time_this_iter_s": 9.830995082855225, "time_total_s": 198.3101692199707, "pid": 11610, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3842f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 198.3101692199707, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 41.292857142857144, "ram_util_percent": 79.1857142857143}}
