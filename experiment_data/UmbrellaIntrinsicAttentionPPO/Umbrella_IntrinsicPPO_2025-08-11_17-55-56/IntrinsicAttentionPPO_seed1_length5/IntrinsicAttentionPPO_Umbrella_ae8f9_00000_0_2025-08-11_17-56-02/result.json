{"timers": {"training_iteration": 10.97209016699344, "restore_env_runners": 1.1458992958068848e-05, "training_step": 10.971934083965607, "env_runner_sampling_timer": 1.8557337500387803, "learner_update_timer": 8.907711666077375, "synch_weights": 0.0014697909355163574}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 8.22036014922602e-06, "add_observations_from_episodes_to_batch": 3.1616531707498583e-06, "add_states_from_episodes_to_batch": 3.131374386900697e-06, "batch_individual_items": 1.4126881844225965e-05, "numpy_to_tensor": 1.54767732234285e-05}}, "connector_pipeline_timer": 6.99391205635524e-05}, "episode_len_mean": 20.0, "sample": 0.007577205671411456, "weights_seq_no": 0.0, "episode_duration_sec_mean": 0.006435896516311914, "episode_len_max": 20, "rlmodule_inference_timer": 6.671878004263012e-05, "module_to_env_connector": {"connector_pipeline_timer": 0.0001644784122522028, "timers": {"connectors": {"tensor_to_numpy": 1.7787377418616827e-05, "listify_data_for_vector_env": 1.1987049286088388e-05, "normalize_and_clip_actions": 1.1173972466959796e-05, "get_actions": 7.357070897515962e-05, "remove_single_ts_time_rank_from_batch": 1.3112900399633552e-05, "un_batch_to_individual_items": 7.430633907827883e-06}}}, "env_to_module_sum_episodes_length_out": 10.191744832559449, "env_reset_timer": 0.00010482545917592856, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_return_max": 9.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 1.0999999999999996}, "env_step_timer": 1.6858118199224673e-05, "agent_episode_returns_mean": {"default_agent": 1.0999999999999996}, "time_between_sampling": 0.0005497583901025685, "num_env_steps_sampled_lifetime": 627500.0, "num_episodes_lifetime": 31375.0, "episode_return_min": -10.5, "episode_return_mean": 1.0999999999999996, "env_to_module_sum_episodes_length_in": 10.191744832559449, "num_env_steps_sampled_lifetime_throughput": 2711.1569642515024}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000, "learner_connector": {"connector_pipeline_timer": 0.16927754203788936, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009381624986417592, "add_observations_from_episodes_to_batch": 0.0008650000672787428, "add_columns_from_episodes_to_train_batch": 0.043514874996617436, "add_time_dim_to_batch_and_zero_pad": 0.1030585840344429, "add_states_from_episodes_to_batch": 0.003971208003349602, "batch_individual_items": 0.008162083919160068, "numpy_to_tensor": 8.487503509968519e-05}}}, "learner_connector_sum_episodes_length_out": 5250}, "learners": {"default_policy": {"vf_explained_var": -0.005382180213928223, "vf_loss_unclipped": 42.250308990478516, "module_train_batch_size_mean": 998.9117791197002, "policy_loss": -0.00012424222950357944, "mean_kl_loss": 5.979707111691823e-06, "entropy": 0.690514326095581, "num_module_steps_trained": 5985, "curr_kl_coeff": 0.08079196512699127, "curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.3206407427787781, "num_module_steps_trained_lifetime": 5985, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.24860668182373047, "num_trainable_parameters": 16595, "weights_seq_no": 1.0, "num_module_steps_trained_lifetime_throughput": 665.4566830909928}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.9117791197002, "total_loss": 0.0, "weights_seq_no": 1.0, "curr_entropy_coeff": 0.0015431216992, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 665.4685967787428}, "__all_modules__": {"num_module_steps_trained_lifetime": 11970, "num_env_steps_trained_lifetime": 36000, "num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained": 36000, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 4007.8147941821935, "num_module_steps_trained_throughput": 28730878.626418587, "num_module_steps_trained_lifetime_throughput": 10315647.978613729}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_explained_var": -0.0015538930892944336, "vf_loss_unclipped": 42.121192932128906, "module_train_batch_size_mean": 998.5423314844973, "total_loss": 0.24907925724983215, "mean_kl_loss": 5.551123194891261e-06, "weights_seq_no": 6.0, "entropy": 0.6905234456062317, "vf_loss": 0.32124218344688416, "policy_loss": -0.0001201490085804835, "num_module_steps_trained_lifetime": 35910, "diff_num_grad_updates_vs_sampler_policy": 6.0, "num_module_steps_trained": 35910, "use_intrinsic_rewards": 1.0}, "intrinsic_reward_module": {"weights_seq_no": 6.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 35910, "diff_num_grad_updates_vs_sampler_policy": 6.0, "module_train_batch_size_mean": 998.5423314844973, "total_loss": 0.0}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 71820, "num_env_steps_trained_lifetime": 216000, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 47946.17796868885}}}, "IntrinsicAttentionMask": [[[0.1680145114660263, 0.16803209483623505, 0.16296298801898956, 0.16480322182178497, 0.16808481514453888, 0.16810239851474762], [0.16802041232585907, 0.16803807020187378, 0.16294680535793304, 0.16479499638080597, 0.1680910289287567, 0.16810868680477142], [0.16627971827983856, 0.166274756193161, 0.16773352026939392, 0.16719728708267212, 0.16625988483428955, 0.166254922747612], [0.16692055761814117, 0.16692383587360382, 0.16596750915050507, 0.16631744801998138, 0.16693365573883057, 0.1669369339942932], [0.16803812980651855, 0.16805601119995117, 0.16289828717708588, 0.16477036476135254, 0.1681096851825714, 0.16812756657600403], [0.16804401576519012, 0.1680619865655899, 0.16288210451602936, 0.16476215422153473, 0.16811588406562805, 0.16813385486602783]], [[0.16723814606666565, 0.16678592562675476, 0.16599488258361816, 0.1659906953573227, 0.16677331924438477, 0.16721706092357635], [0.16611814498901367, 0.16655072569847107, 0.16731299459934235, 0.16731704771518707, 0.16656282544136047, 0.16613827645778656], [0.16415536403656006, 0.16612401604652405, 0.16963794827461243, 0.16965678334236145, 0.166179358959198, 0.16424652934074402], [0.16414496302604675, 0.1661216914653778, 0.16965031623840332, 0.1696692258119583, 0.16617725789546967, 0.16423648595809937], [0.16608688235282898, 0.1665440797805786, 0.1673498898744583, 0.16735418140888214, 0.16655687987804413, 0.1661081463098526], [0.1671859622001648, 0.16677510738372803, 0.16605615615844727, 0.16605235636234283, 0.16676364839076996, 0.1671668142080307]], [[0.16863544285297394, 0.1667873114347458, 0.1635652482509613, 0.16358236968517303, 0.168706014752388, 0.16872365772724152], [0.1677231639623642, 0.16673524677753448, 0.16500070691108704, 0.16500996053218842, 0.16776077449321747, 0.1677701771259308], [0.16610370576381683, 0.16662649810314178, 0.16755597293376923, 0.1675509810447693, 0.16608388721942902, 0.16607894003391266], [0.16611242294311523, 0.16662713885307312, 0.1675422340631485, 0.16753731667995453, 0.1660929024219513, 0.1660880297422409], [0.16867004334926605, 0.16678914427757263, 0.16351087391376495, 0.16352827847003937, 0.1687418669462204, 0.16875982284545898], [0.16867868602275848, 0.16678959131240845, 0.16349726915359497, 0.16351474821567535, 0.1687508225440979, 0.16876885294914246]], [[0.16670279204845428, 0.16604727506637573, 0.16722193360328674, 0.16722817718982697, 0.1667277216911316, 0.16607211530208588], [0.16665564477443695, 0.16685116291046143, 0.16650152206420898, 0.16649967432022095, 0.1666482388973236, 0.1668437272310257], [0.166738361120224, 0.1654139906167984, 0.16779100894927979, 0.16780370473861694, 0.16678884625434875, 0.16546405851840973], [0.16673877835273743, 0.16540637612342834, 0.16779786348342896, 0.16781063377857208, 0.16678957641124725, 0.16545675694942474], [0.16670455038547516, 0.16601680219173431, 0.16724930703639984, 0.16725586354732513, 0.16673070192337036, 0.16604286432266235], [0.166657492518425, 0.16682061553001404, 0.1665288656949997, 0.16652731597423553, 0.16665129363536835, 0.1668144166469574]], [[0.16926729679107666, 0.16741223633289337, 0.16417810320854187, 0.16419526934623718, 0.16746476292610168, 0.16748228669166565], [0.16805842518806458, 0.16706855595111847, 0.16533054411411285, 0.16533979773521423, 0.16709664463996887, 0.1671060174703598], [0.16592860221862793, 0.16645082831382751, 0.16737933456897736, 0.16737434267997742, 0.16643594205379486, 0.1664309799671173], [0.16593997180461884, 0.16645416617393494, 0.1673683077096939, 0.16736339032649994, 0.1664395034313202, 0.1664346158504486], [0.16809280216693878, 0.1670783907175064, 0.16529768705368042, 0.1653071939945221, 0.16710719466209412, 0.16711679100990295], [0.16810424625873566, 0.16708166897296906, 0.16528671979904175, 0.1652963012456894, 0.16711069643497467, 0.16712036728858948]], [[0.16661934554576874, 0.1666233092546463, 0.16694888472557068, 0.1673753559589386, 0.16621455550193787, 0.16621850430965424], [0.1666184365749359, 0.16662247478961945, 0.16695436835289001, 0.1673891246318817, 0.16620580852031708, 0.1662098467350006], [0.16654105484485626, 0.1665513962507248, 0.16740261018276215, 0.16852162778377533, 0.16548651456832886, 0.1654967963695526], [0.16643619537353516, 0.1664547622203827, 0.1679864078760147, 0.17000940442085266, 0.16454742848873138, 0.164565771818161], [0.16671225428581238, 0.16670836508274078, 0.16638851165771484, 0.16597141325473785, 0.16711167991161346, 0.16710777580738068], [0.16671137511730194, 0.16670754551887512, 0.16639399528503418, 0.1659850925207138, 0.16710291802883148, 0.16709908843040466]]]}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 10.216013141322508, "episode_len_mean": 20.0, "env_to_module_connector": {"connector_pipeline_timer": 6.535585512211301e-05, "timers": {"connectors": {"batch_individual_items": 1.2812066642832488e-05, "numpy_to_tensor": 1.3699917417237712e-05, "add_observations_from_episodes_to_batch": 3.0724444794889177e-06, "add_states_from_episodes_to_batch": 2.758391587727714e-06, "add_time_dim_to_batch_and_zero_pad": 8.02984730428921e-06}}}, "weights_seq_no": 1.0, "rlmodule_inference_timer": 3.9458038910465454e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.291706547213812e-05, "tensor_to_numpy": 1.7599851896574762e-05, "normalize_and_clip_actions": 9.484191705215786e-06, "get_actions": 4.892235564884413e-05, "listify_data_for_vector_env": 1.08744653145244e-05, "un_batch_to_individual_items": 6.861646506815185e-06}}, "connector_pipeline_timer": 0.00013333081633319895}, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 5400, "num_episodes_lifetime": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "sample": 0.12225949997082353, "episode_duration_sec_mean": 0.005550829344429076, "module_episode_returns_mean": {"default_policy": 1.2}, "episode_len_max": 20, "episode_len_min": 20, "episode_return_max": 12.5, "env_step_timer": 1.5837089118866605e-05, "episode_return_min": -11.5, "episode_return_mean": 1.2, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.216013141322508, "env_reset_timer": 0.0005383340176194906, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 1.2}}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "ae8f9_00000", "date": "2025-08-11_18-14-33", "timestamp": 1754928873, "time_this_iter_s": 11.1076180934906, "time_total_s": 11.1076180934906, "pid": 10547, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3849f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11.1076180934906, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 42.724999999999994, "ram_util_percent": 81.14375}}
{"timers": {"training_iteration": 10.970814086993924, "restore_env_runners": 1.142148277722299e-05, "training_step": 10.97065719104605, "env_runner_sampling_timer": 1.8595169900381006, "learner_update_timer": 8.902728712336394, "synch_weights": 0.0014652555261272938, "restore_eval_env_runners": 1.566705759614706e-05, "evaluation_iteration": 0.13320337503682822, "synch_eval_env_connectors": 0.00017404207028448582, "synch_env_connectors": 5.707959644496441e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 9.351700473622007e-06, "add_observations_from_episodes_to_batch": 3.487269094189541e-06, "add_states_from_episodes_to_batch": 3.375391109212713e-06, "batch_individual_items": 1.5348751264178047e-05, "numpy_to_tensor": 1.7475463806673675e-05}}, "connector_pipeline_timer": 7.56971623582257e-05}, "episode_len_mean": 20.0, "sample": 0.007754546159683834, "weights_seq_no": 1.0, "episode_duration_sec_mean": 0.007051317688077687, "episode_len_max": 20, "rlmodule_inference_timer": 4.525994973840447e-05, "module_to_env_connector": {"connector_pipeline_timer": 0.00016057084610480982, "timers": {"connectors": {"tensor_to_numpy": 2.00028817159605e-05, "listify_data_for_vector_env": 1.3366620061195789e-05, "normalize_and_clip_actions": 1.004542393038422e-05, "get_actions": 6.093817322488507e-05, "remove_single_ts_time_rank_from_batch": 1.5174525518488254e-05, "un_batch_to_individual_items": 7.946427363715297e-06}}}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 5.911517661334941e-05, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_return_max": 9.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 0.4600000000000001}, "env_step_timer": 1.8785781094843848e-05, "agent_episode_returns_mean": {"default_agent": 0.4600000000000001}, "time_between_sampling": 0.035117209270140524, "num_env_steps_sampled_lifetime": 10000.0, "num_episodes_lifetime": 500.0, "episode_return_min": -10.5, "episode_return_mean": 0.4600000000000001, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 2760.04026621913}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.16910176745732314, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009378719157539307, "add_observations_from_episodes_to_batch": 0.0008646388165652752, "add_columns_from_episodes_to_train_batch": 0.04348552874638699, "add_time_dim_to_batch_and_zero_pad": 0.10292524611460976, "add_states_from_episodes_to_batch": 0.0039682796737179156, "batch_individual_items": 0.008156401830492542, "numpy_to_tensor": 8.480420452542604e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"vf_explained_var": -0.00167083740234375, "vf_loss_unclipped": 40.73228073120117, "module_train_batch_size_mean": 998.828720912135, "policy_loss": -0.00024215983285102993, "mean_kl_loss": 8.003718903637491e-06, "entropy": 0.6903693079948425, "num_module_steps_trained": 5985, "curr_kl_coeff": 0.040395982563495636, "curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.3206078112125397, "num_module_steps_trained_lifetime": 11970, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.2484630048274994, "num_trainable_parameters": 16595, "weights_seq_no": 2.0, "num_module_steps_trained_lifetime_throughput": 665.173459909553}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.828720912135, "total_loss": 0.0, "weights_seq_no": 2.0, "curr_entropy_coeff": 0.0015431216992, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 11970, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 665.1851868026151}, "__all_modules__": {"num_module_steps_trained_lifetime": 23940, "num_env_steps_trained_lifetime": 72000, "num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained": 36000, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 4006.053139257889, "num_module_steps_trained_throughput": 28356323.54992456, "num_module_steps_trained_lifetime_throughput": 10369541.89735333}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_explained_var": -0.001639723777770996, "vf_loss_unclipped": 40.899574279785156, "module_train_batch_size_mean": 998.2236050808158, "total_loss": 0.24889720976352692, "mean_kl_loss": 7.0899682214076165e-06, "weights_seq_no": 12.0, "entropy": 0.6903868317604065, "vf_loss": 0.3211483657360077, "policy_loss": -0.00022952767903916538, "num_module_steps_trained_lifetime": 71820, "diff_num_grad_updates_vs_sampler_policy": 11.0, "num_module_steps_trained": 35910, "use_intrinsic_rewards": 1.0}, "intrinsic_reward_module": {"weights_seq_no": 12.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 71820, "diff_num_grad_updates_vs_sampler_policy": 11.0, "module_train_batch_size_mean": 998.2236050808158, "total_loss": 0.0}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 143640, "num_env_steps_trained_lifetime": 432000, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 47754.263232497055}}}, "IntrinsicAttentionMask": [[[0.1689508855342865, 0.1689685583114624, 0.16387119889259338, 0.1638883501291275, 0.16715171933174133, 0.1671692132949829], [0.16896097362041473, 0.1689787209033966, 0.16385896503925323, 0.16387617588043213, 0.16715382039546967, 0.16717137396335602], [0.1660161018371582, 0.16601115465164185, 0.1674676090478897, 0.16746261715888977, 0.16652372479438782, 0.16651874780654907], [0.16602614521980286, 0.16602127254009247, 0.16745522618293762, 0.16745030879974365, 0.1665259450674057, 0.16652105748653412], [0.16792082786560059, 0.1679304838180542, 0.16512858867645264, 0.16513806581497192, 0.1669362336397171, 0.16694582998752594], [0.16793088614940643, 0.16794061660766602, 0.16511628031730652, 0.16512583196163177, 0.16693836450576782, 0.16694803535938263]], [[0.16701439023017883, 0.16701017320156097, 0.16621805727481842, 0.16621385514736176, 0.16699755191802979, 0.16654598712921143], [0.16700804233551025, 0.16700391471385956, 0.16622623801231384, 0.16622212529182434, 0.16699150204658508, 0.16654819250106812], [0.16581089794635773, 0.16582119464874268, 0.16777236759662628, 0.16778278350830078, 0.16585205495357513, 0.1669607162475586], [0.16580453515052795, 0.16581490635871887, 0.1677805781364441, 0.16779106855392456, 0.16584600508213043, 0.1669628769159317], [0.16698899865150452, 0.16698509454727173, 0.1662508100271225, 0.1662469208240509, 0.16697338223457336, 0.16655482351779938], [0.1663072556257248, 0.166311576962471, 0.16713078320026398, 0.16713513433933258, 0.16632458567619324, 0.1667906790971756]], [[0.1683274209499359, 0.16648265719413757, 0.16326647996902466, 0.16511014103889465, 0.16839785873889923, 0.16841547191143036], [0.16755777597427368, 0.16657084226608276, 0.1648380011320114, 0.1658332645893097, 0.16759534180164337, 0.1676047444343567], [0.16619189083576202, 0.16671495139598846, 0.1676449328660965, 0.16710898280143738, 0.1661720722913742, 0.16616711020469666], [0.16697868704795837, 0.16663388907909393, 0.1660252958536148, 0.16637535393238068, 0.16699178516864777, 0.1669950634241104], [0.16835659742355347, 0.1664792001247406, 0.1632070243358612, 0.165082648396492, 0.16842828691005707, 0.16844621300697327], [0.16836389899253845, 0.16647833585739136, 0.16319215297698975, 0.16507577896118164, 0.16843590140342712, 0.1684539020061493]], [[0.16708877682685852, 0.16708455979824066, 0.16629208624362946, 0.1658424288034439, 0.16707192361354828, 0.1666201651096344], [0.1670810878276825, 0.1670769602060318, 0.16629894077777863, 0.1658574789762497, 0.16706454753875732, 0.16662104427814484], [0.1656268686056137, 0.16563715040683746, 0.16758617758750916, 0.16870641708374023, 0.16566798090934753, 0.1667754203081131], [0.16479727625846863, 0.16481566429138184, 0.1683165431022644, 0.17034350335597992, 0.16487079858779907, 0.16685625910758972], [0.16705796122550964, 0.16705405712127686, 0.16631947457790375, 0.1659025400876999, 0.1670423448085785, 0.16662360727787018], [0.16623011231422424, 0.16623444855213165, 0.16705326735973358, 0.1675214022397995, 0.1662474423646927, 0.16671332716941833]], [[0.1666635125875473, 0.1669473499059677, 0.16620492935180664, 0.16523398458957672, 0.16796572506427765, 0.16698449850082397], [0.1666620671749115, 0.16701790690422058, 0.16608746349811554, 0.1648722141981125, 0.16829587519168854, 0.16706447303295135], [0.16666530072689056, 0.16683261096477509, 0.16639474034309387, 0.1658208966255188, 0.16743193566799164, 0.16685450077056885], [0.16666682064533234, 0.16658659279346466, 0.16679678857326508, 0.16707350313663483, 0.1663002222776413, 0.16657611727714539], [0.16665467619895935, 0.16726809740066528, 0.16566617786884308, 0.1635836660861969, 0.1694788932800293, 0.1673484444618225], [0.1666618436574936, 0.16702711582183838, 0.16607210040092468, 0.164824977517128, 0.1683390587568283, 0.16707491874694824]], [[0.1672384887933731, 0.16678626835346222, 0.16599521040916443, 0.16643688082695007, 0.16677366197109222, 0.16676945984363556], [0.16611845791339874, 0.16655103862285614, 0.16731330752372742, 0.1668868362903595, 0.16656313836574554, 0.16656717658042908], [0.1641620397567749, 0.16613076627254486, 0.16964484751224518, 0.16767171025276184, 0.16618612408638, 0.1662045568227768], [0.1652539223432541, 0.1663667857646942, 0.16833901405334473, 0.16723383963108063, 0.16639800369739532, 0.16640840470790863], [0.16608722507953644, 0.16654442250728607, 0.16735024750232697, 0.16689938306808472, 0.1665572226047516, 0.16656148433685303], [0.16607683897018433, 0.16654223203659058, 0.16736257076263428, 0.1669035702943802, 0.166555255651474, 0.1665596067905426]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 10.366003441359926, "episode_len_mean": 20.0, "env_to_module_connector": {"connector_pipeline_timer": 6.67227376769329e-05, "timers": {"connectors": {"batch_individual_items": 1.3676199654706185e-05, "numpy_to_tensor": 1.398646882253263e-05, "add_observations_from_episodes_to_batch": 3.2918621648125716e-06, "add_states_from_episodes_to_batch": 2.9024537044581084e-06, "add_time_dim_to_batch_and_zero_pad": 8.212905689024256e-06}}}, "weights_seq_no": 2.0, "rlmodule_inference_timer": 3.796881330003037e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2235990575710764e-05, "tensor_to_numpy": 1.8452341101118975e-05, "normalize_and_clip_actions": 8.391710162686747e-06, "get_actions": 4.62717969874851e-05, "listify_data_for_vector_env": 1.1576375351459337e-05, "un_batch_to_individual_items": 7.1614076812697545e-06}}, "connector_pipeline_timer": 0.00013248400193217752}, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 10400, "num_episodes_lifetime": 40, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "sample": 0.12226200788165442, "episode_duration_sec_mean": 0.005576754271169193, "module_episode_returns_mean": {"default_policy": 1.2}, "episode_len_max": 20, "episode_len_min": 20, "episode_return_max": 12.5, "env_step_timer": 1.5838939788858364e-05, "episode_return_min": -12.5, "episode_return_mean": 1.2, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.366003441359926, "env_reset_timer": 0.0005361944274045527, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 1.2}, "time_between_sampling": 10.89884845900815}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "ae8f9_00000", "date": "2025-08-11_18-14-44", "timestamp": 1754928884, "time_this_iter_s": 10.977636098861694, "time_total_s": 22.085254192352295, "pid": 10547, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3849f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 22.085254192352295, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 43.256249999999994, "ram_util_percent": 78.44999999999999}}
{"timers": {"training_iteration": 10.969849005713746, "restore_env_runners": 1.1430178082082418e-05, "training_step": 10.969691236215482, "env_runner_sampling_timer": 1.857704166387976, "learner_update_timer": 8.902781888543057, "synch_weights": 0.0014667254708125258, "restore_eval_env_runners": 1.568871783092618e-05, "evaluation_iteration": 0.1331760712864343, "synch_eval_env_connectors": 0.00017372748930938542, "synch_env_connectors": 5.707970121875406e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.536198059655705e-06, "add_observations_from_episodes_to_batch": 3.0542303202264604e-06, "add_states_from_episodes_to_batch": 2.963831110257214e-06, "batch_individual_items": 1.3338335702591598e-05, "numpy_to_tensor": 1.4207150396585596e-05}}, "connector_pipeline_timer": 6.424936563075134e-05}, "episode_len_mean": 20.0, "sample": 0.006358226524697912, "weights_seq_no": 2.0, "episode_duration_sec_mean": 0.005757722996640948, "episode_len_max": 20, "rlmodule_inference_timer": 3.5802012511418016e-05, "module_to_env_connector": {"connector_pipeline_timer": 0.0001293532800021344, "timers": {"connectors": {"tensor_to_numpy": 1.6788145214236278e-05, "listify_data_for_vector_env": 1.12435534010801e-05, "normalize_and_clip_actions": 8.556940823000331e-06, "get_actions": 4.5486432323202395e-05, "remove_single_ts_time_rank_from_batch": 1.2532964845873161e-05, "un_batch_to_individual_items": 6.975717173827902e-06}}}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 4.8428993850039434e-05, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_return_max": 9.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 0.7000000000000002}, "env_step_timer": 1.5030574424251275e-05, "agent_episode_returns_mean": {"default_agent": 0.7000000000000002}, "time_between_sampling": 0.03590942643402216, "num_env_steps_sampled_lifetime": -607500.0, "num_episodes_lifetime": -30375.0, "episode_return_min": -10.5, "episode_return_mean": 0.7000000000000002, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3028.267067265492}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1697863364535733, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00937351779649034, "add_observations_from_episodes_to_batch": 0.0008643886785954237, "add_columns_from_episodes_to_train_batch": 0.04347023470835993, "add_time_dim_to_batch_and_zero_pad": 0.1027918699034606, "add_states_from_episodes_to_batch": 0.0039662202065344895, "batch_individual_items": 0.008998194891924504, "numpy_to_tensor": 8.475033267168329e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"vf_explained_var": 0.0007207989692687988, "vf_loss_unclipped": 41.38207244873047, "module_train_batch_size_mean": 998.7505232584676, "policy_loss": -0.00010851063416339457, "mean_kl_loss": 1.4819643183727749e-05, "entropy": 0.6898483633995056, "num_module_steps_trained": 5985, "curr_kl_coeff": 0.020197991281747818, "curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.3205200135707855, "num_module_steps_trained_lifetime": 17955, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.24852901697158813, "num_trainable_parameters": 16595, "weights_seq_no": 3.0, "num_module_steps_trained_lifetime_throughput": 664.2826647987494}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.7505232584676, "total_loss": 0.0, "weights_seq_no": 3.0, "curr_entropy_coeff": 0.0015431216992, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 17955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 664.2940942512867}, "__all_modules__": {"num_module_steps_trained_lifetime": 35910, "num_env_steps_trained_lifetime": 108000, "num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained": 36000, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 4000.5974804599305, "num_module_steps_trained_throughput": 27770285.453093156, "num_module_steps_trained_lifetime_throughput": 10434914.090062415}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_explained_var": -0.0016036033630371094, "vf_loss_unclipped": 41.56843185424805, "module_train_batch_size_mean": 998.0016398003509, "total_loss": 0.24891577661037445, "mean_kl_loss": 1.4326627933769487e-05, "weights_seq_no": 18.0, "entropy": 0.689855694770813, "vf_loss": 0.32101166248321533, "policy_loss": -0.00010644685244187713, "num_module_steps_trained_lifetime": 107730, "diff_num_grad_updates_vs_sampler_policy": 16.0, "num_module_steps_trained": 35910, "use_intrinsic_rewards": 1.0}, "intrinsic_reward_module": {"weights_seq_no": 18.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 107730, "diff_num_grad_updates_vs_sampler_policy": 16.0, "module_train_batch_size_mean": 998.0016398003509, "total_loss": 0.0}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 215460, "num_env_steps_trained_lifetime": 648000, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 47406.553348002846}}}, "IntrinsicAttentionMask": [[[0.16650031507015228, 0.1667838841676712, 0.16604217886924744, 0.16605141758918762, 0.16681170463562012, 0.1678105890750885], [0.16645783185958862, 0.16681323945522308, 0.16588392853736877, 0.1658954918384552, 0.16684812307357788, 0.16810135543346405], [0.1665688008069992, 0.16673600673675537, 0.16629840433597565, 0.1663038432598114, 0.1667524129152298, 0.1673404723405838], [0.16656742990016937, 0.16673699021339417, 0.1662932187318802, 0.1662987470626831, 0.1667536199092865, 0.1673499494791031], [0.16645365953445435, 0.1668161153793335, 0.16586844623088837, 0.1658802181482315, 0.1668516844511032, 0.16812989115715027], [0.1663036048412323, 0.166918084025383, 0.16531342267990112, 0.1653333455324173, 0.16697844862937927, 0.1691531538963318]], [[0.1668606549501419, 0.1668587327003479, 0.16649460792541504, 0.1662876009941101, 0.1668529212474823, 0.16664546728134155], [0.1668529510498047, 0.16685108840465546, 0.1665014624595642, 0.1663026660680771, 0.16684551537036896, 0.1666463166475296], [0.1653982400894165, 0.16541075706481934, 0.16778773069381714, 0.16915671527385712, 0.16544830799102783, 0.1667982041835785], [0.16456836462020874, 0.16458895802497864, 0.16851751506328583, 0.1707966923713684, 0.16465075314044952, 0.1668776273727417], [0.16682982444763184, 0.1668282002210617, 0.16652196645736694, 0.16634781658649445, 0.16682332754135132, 0.16664884984493256], [0.16600169241428375, 0.16600827872753143, 0.167255237698555, 0.16796958446502686, 0.16602805256843567, 0.1667371541261673]], [[0.16633401811122894, 0.1676056981086731, 0.1658763438463211, 0.1649073213338852, 0.16763365268707275, 0.1676429808139801], [0.16594953835010529, 0.16866911947727203, 0.16497650742530823, 0.16292637586593628, 0.16872917115688324, 0.16874919831752777], [0.1664712280035019, 0.16722051799297333, 0.16620099544525146, 0.16562779247760773, 0.16723696887493134, 0.16724245250225067], [0.1667596995830536, 0.1664007604122162, 0.1668897569179535, 0.16716662049293518, 0.16639290750026703, 0.1663902848958969], [0.1659410446882248, 0.16869239509105682, 0.16495677828788757, 0.16288317739963531, 0.16875316202640533, 0.16877342760562897], [0.16593821346759796, 0.16870015859603882, 0.1649501919746399, 0.16286876797676086, 0.16876116394996643, 0.16878150403499603]], [[0.16716361045837402, 0.16715939342975616, 0.1663665622472763, 0.16591671109199524, 0.16669899225234985, 0.1666947901248932], [0.16715453565120697, 0.16715040802955627, 0.16637204587459564, 0.16593037545681, 0.1666984111070633, 0.1666942834854126], [0.16544535756111145, 0.165455624461174, 0.1674025058746338, 0.16852153837680817, 0.16658230125904083, 0.16659264266490936], [0.164473757147789, 0.16449210047721863, 0.16798612475395203, 0.17000910639762878, 0.16651014983654022, 0.16652871668338776], [0.16616249084472656, 0.166166752576828, 0.16697072982788086, 0.1674303561449051, 0.16663268208503723, 0.16663695871829987], [0.1661534160375595, 0.16615775227546692, 0.1669761836528778, 0.167444109916687, 0.1666320562362671, 0.1666364073753357]], [[0.16832751035690308, 0.1683451235294342, 0.16326656937599182, 0.16511023044586182, 0.16653499007225037, 0.16841556131839752], [0.16833481192588806, 0.16835249960422516, 0.16325169801712036, 0.16510336101055145, 0.16653436422348022, 0.16842325031757355], [0.16619190573692322, 0.16618695855140686, 0.1676449477672577, 0.16710899770259857, 0.16670005023479462, 0.16616712510585785], [0.16697868704795837, 0.16698196530342102, 0.1660252958536148, 0.16637535393238068, 0.16664369404315948, 0.1669950634241104], [0.1675797402858734, 0.16758936643600464, 0.16479314863681793, 0.16581273078918457, 0.1665971428155899, 0.16762788593769073], [0.1683640033006668, 0.16838198900222778, 0.1631922423839569, 0.1650758683681488, 0.16653183102607727, 0.16845400631427765]], [[0.16716396808624268, 0.1667119562625885, 0.16636691987514496, 0.1663627177476883, 0.1666993349790573, 0.16669514775276184], [0.1661899983882904, 0.16662275791168213, 0.1669546663761139, 0.16695870459079742, 0.16663487255573273, 0.16663891077041626], [0.16544748842716217, 0.16655345261096954, 0.1674046814441681, 0.1674150675535202, 0.16658446192741394, 0.16659480333328247], [0.1654384732246399, 0.1665526032447815, 0.16741016507148743, 0.1674206256866455, 0.1665838360786438, 0.1665942519903183], [0.1661628633737564, 0.16662026941776276, 0.1669711023569107, 0.16697537899017334, 0.16663306951522827, 0.1666373312473297], [0.16615381836891174, 0.1666194349527359, 0.16697658598423004, 0.16698093712329865, 0.16663245856761932, 0.16663679480552673]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 10.368205581254823, "episode_len_mean": 20.0, "env_to_module_connector": {"connector_pipeline_timer": 5.848346673303092e-05, "timers": {"connectors": {"batch_individual_items": 1.2330572459243167e-05, "numpy_to_tensor": 1.1769182408876991e-05, "add_observations_from_episodes_to_batch": 2.806424343842078e-06, "add_states_from_episodes_to_batch": 2.685474876646788e-06, "add_time_dim_to_batch_and_zero_pad": 6.984373553189586e-06}}}, "weights_seq_no": 3.0, "rlmodule_inference_timer": 3.1885205139098204e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1703298925452426e-05, "tensor_to_numpy": 1.5088391129744358e-05, "normalize_and_clip_actions": 7.7978886046568e-06, "get_actions": 3.66845373789129e-05, "listify_data_for_vector_env": 1.0469304127020238e-05, "un_batch_to_individual_items": 6.516768824196674e-06}}, "connector_pipeline_timer": 0.00011389209247179292}, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 15400, "num_episodes_lifetime": 60, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "sample": 0.12218424489280441, "episode_duration_sec_mean": 0.0054626278191184, "module_episode_returns_mean": {"default_policy": 0.8666666666666667}, "episode_len_max": 20, "episode_len_min": 20, "episode_return_max": 12.5, "env_step_timer": 1.3890349423408767e-05, "episode_return_min": -12.5, "episode_return_mean": 0.8666666666666667, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368205581254823, "env_reset_timer": 0.0005341079038800672, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 0.8666666666666667}, "time_between_sampling": 10.898889029837445}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "ae8f9_00000", "date": "2025-08-11_18-14-55", "timestamp": 1754928895, "time_this_iter_s": 11.000128984451294, "time_total_s": 33.08538317680359, "pid": 10547, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3849f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 33.08538317680359, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 44.425, "ram_util_percent": 78.7}}
{"timers": {"training_iteration": 10.971954791487118, "restore_env_runners": 1.1470036962884475e-05, "training_step": 10.971795886772608, "env_runner_sampling_timer": 1.855203966393952, "learner_update_timer": 8.90724121673764, "synch_weights": 0.0014682682161350968, "restore_eval_env_runners": 1.6073500667698682e-05, "evaluation_iteration": 0.1330716209933511, "synch_eval_env_connectors": 0.00017395313506713138, "synch_env_connectors": 5.707560235168785e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.3505836786741474e-06, "add_observations_from_episodes_to_batch": 2.8932466525850837e-06, "add_states_from_episodes_to_batch": 2.9285644873176817e-06, "batch_individual_items": 1.2873890083507706e-05, "numpy_to_tensor": 1.3466440268445873e-05}}, "connector_pipeline_timer": 6.216804204113719e-05}, "episode_len_mean": 20.0, "sample": 0.00607334731609408, "weights_seq_no": 3.0, "episode_duration_sec_mean": 0.005541816327720882, "episode_len_max": 20, "rlmodule_inference_timer": 3.399633668447058e-05, "module_to_env_connector": {"connector_pipeline_timer": 0.00012426193320347898, "timers": {"connectors": {"tensor_to_numpy": 1.6325173142918463e-05, "listify_data_for_vector_env": 1.098956966125584e-05, "normalize_and_clip_actions": 8.350921930341818e-06, "get_actions": 4.2258161021869315e-05, "remove_single_ts_time_rank_from_batch": 1.2149405988747935e-05, "un_batch_to_individual_items": 6.865888857428734e-06}}}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 4.456908394539e-05, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_return_max": 9.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 0.86}, "env_step_timer": 1.4497422568901019e-05, "agent_episode_returns_mean": {"default_agent": 0.86}, "time_between_sampling": 0.03773113282587233, "num_env_steps_sampled_lifetime": -1225000.0, "num_episodes_lifetime": -61250.0, "episode_return_min": -10.5, "episode_return_mean": 0.86, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3140.340776131491}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.16976677808840585, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009378365117720326, "add_observations_from_episodes_to_batch": 0.0008651189609766006, "add_columns_from_episodes_to_train_batch": 0.043490661940917254, "add_time_dim_to_batch_and_zero_pad": 0.10274743912502877, "add_states_from_episodes_to_batch": 0.003967320504608098, "batch_individual_items": 0.008996977943696896, "numpy_to_tensor": 8.46774196434999e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"vf_explained_var": 0.0015313029289245605, "vf_loss_unclipped": 41.180320739746094, "module_train_batch_size_mean": 998.6769017198101, "policy_loss": -0.00012804385914932936, "mean_kl_loss": 1.2058473657816648e-05, "entropy": 0.6894611120223999, "num_module_steps_trained": 5985, "curr_kl_coeff": 0.010098995640873909, "curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.3205232322216034, "num_module_steps_trained_lifetime": 23940, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.24851219356060028, "num_trainable_parameters": 16595, "weights_seq_no": 4.0, "num_module_steps_trained_lifetime_throughput": 662.7422463602104}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.6769017198101, "total_loss": 0.0, "weights_seq_no": 4.0, "curr_entropy_coeff": 0.0015431216992, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 23940, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 662.7532947914889}, "__all_modules__": {"num_module_steps_trained_lifetime": 47880, "num_env_steps_trained_lifetime": 144000, "num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained": 36000, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 3991.209930641985, "num_module_steps_trained_throughput": 27104782.19044825, "num_module_steps_trained_lifetime_throughput": 10509013.638094427}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_explained_var": -0.0016318559646606445, "vf_loss_unclipped": 41.42483901977539, "module_train_batch_size_mean": 997.847060245087, "total_loss": 0.24883060157299042, "mean_kl_loss": 1.1488683412608225e-05, "weights_seq_no": 24.0, "entropy": 0.6894710063934326, "vf_loss": 0.3209252655506134, "policy_loss": -0.00012448517372831702, "num_module_steps_trained_lifetime": 143640, "diff_num_grad_updates_vs_sampler_policy": 21.0, "num_module_steps_trained": 35910, "use_intrinsic_rewards": 1.0}, "intrinsic_reward_module": {"weights_seq_no": 24.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 143640, "diff_num_grad_updates_vs_sampler_policy": 21.0, "module_train_batch_size_mean": 997.847060245087, "total_loss": 0.0}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 287280, "num_env_steps_trained_lifetime": 864000, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 46948.83224604131}}}, "IntrinsicAttentionMask": [[[0.16649863123893738, 0.16777154803276062, 0.16604049503803253, 0.16507050395011902, 0.16779954731464386, 0.16681928932666779], [0.16630157828330994, 0.1690269261598587, 0.16532647609710693, 0.16327199339866638, 0.16908711194992065, 0.166985884308815], [0.16656821966171265, 0.1673179566860199, 0.1662978231906891, 0.16572429239749908, 0.1673344075679779, 0.16675730049610138], [0.16671322286128998, 0.16635438799858093, 0.1668432354927063, 0.1671200394630432, 0.16634653508663177, 0.16662250459194183], [0.16629718244075775, 0.16905443370342255, 0.1653107851743698, 0.1632327437400818, 0.1691153347492218, 0.16698946058750153], [0.16644947230815887, 0.16808846592903137, 0.16586045920848846, 0.16461493074893951, 0.16812454164028168, 0.16686201095581055]], [[0.16708879172801971, 0.16663697361946106, 0.16629210114479065, 0.1658424437046051, 0.16707193851470947, 0.1670677214860916], [0.1662609875202179, 0.16669392585754395, 0.16702596843242645, 0.16746090352535248, 0.16627709567546844, 0.16628111898899078], [0.16562692821025848, 0.16673406958580017, 0.16758622229099274, 0.168706476688385, 0.1656680405139923, 0.16567832231521606], [0.16479741036891937, 0.16678200662136078, 0.16831667721271515, 0.17034365236759186, 0.16487093269824982, 0.16488932073116302], [0.16705797612667084, 0.16663920879364014, 0.16631947457790375, 0.16590255498886108, 0.16704235970973969, 0.1670384556055069], [0.16705027222633362, 0.1666397601366043, 0.16632631421089172, 0.16591759026050568, 0.16703495383262634, 0.16703113913536072]], [[0.16633573174476624, 0.16760742664337158, 0.1658780574798584, 0.1658872812986374, 0.1666468232870102, 0.1676447093486786], [0.16595731675624847, 0.16867701709270477, 0.16498422622680664, 0.16500382125377655, 0.1666204333305359, 0.1687571108341217], [0.16647183895111084, 0.16722112894058228, 0.16620159149169922, 0.16620704531669617, 0.16665534675121307, 0.16724306344985962], [0.16646911203861237, 0.16722892224788666, 0.1661950647830963, 0.16620059311389923, 0.16665518283843994, 0.16725116968154907], [0.16624321043491364, 0.16786958277225494, 0.16565871238708496, 0.1656704843044281, 0.1666407287120819, 0.16791731119155884], [0.16594623029232025, 0.16870830953121185, 0.1649581640958786, 0.1649780422449112, 0.16661962866783142, 0.16878965497016907]], [[0.16626112163066864, 0.16626733541488647, 0.16744354367256165, 0.16744980216026306, 0.16628599166870117, 0.166292205452919], [0.1662561297416687, 0.1662624180316925, 0.1674531251192093, 0.16745945811271667, 0.1662812978029251, 0.1662875860929489], [0.16531138122081757, 0.16533198952674866, 0.16926360130310059, 0.16928470134735107, 0.16539384424686432, 0.1654144674539566], [0.16530637443065643, 0.1653270572423935, 0.169273242354393, 0.16929441690444946, 0.16538912057876587, 0.16540981829166412], [0.1662411242723465, 0.1662476509809494, 0.16748185455799103, 0.16748842597007751, 0.16626721620559692, 0.16627372801303864], [0.16623611748218536, 0.16624271869659424, 0.16749143600463867, 0.16749808192253113, 0.16626250743865967, 0.16626910865306854]], [[0.16864781081676483, 0.16679953038692474, 0.16540710628032684, 0.1654244065284729, 0.16685187816619873, 0.16686932742595673], [0.16772669553756714, 0.16673876345157623, 0.1659911423921585, 0.16600044071674347, 0.16676682233810425, 0.1667761653661728], [0.16702833771705627, 0.16669154167175293, 0.16643579304218292, 0.1664389669895172, 0.16670110821723938, 0.16670431196689606], [0.16703703999519348, 0.1666921228170395, 0.16643023490905762, 0.16643349826335907, 0.16670194268226624, 0.1667052060365677], [0.16775287687778473, 0.1667405217885971, 0.16597449779510498, 0.16598403453826904, 0.16676926612854004, 0.1667788326740265], [0.16776157915592194, 0.16674108803272247, 0.16596893966197968, 0.1659785509109497, 0.1667700558900833, 0.16677971184253693]], [[0.16693970561027527, 0.1669355034828186, 0.1661437302827835, 0.16613952815532684, 0.16692286729812622, 0.16691866517066956], [0.16693472862243652, 0.16693060100078583, 0.16615326702594757, 0.16614915430545807, 0.16691820323467255, 0.16691406071186066], [0.16599321365356445, 0.1660035103559494, 0.1679568588733673, 0.1679672747850418, 0.16603441536426544, 0.16604472696781158], [0.16598822176456451, 0.16599859297275543, 0.16796645522117615, 0.1679769605398178, 0.16602972149848938, 0.1660401076078415], [0.1669197678565979, 0.1669158637523651, 0.16618187725543976, 0.16617800295352936, 0.16690415143966675, 0.16690026223659515], [0.16691480576992035, 0.16691099107265472, 0.1661914438009262, 0.16618762910366058, 0.16689950227737427, 0.16689568758010864]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 10.368237912813044, "episode_len_mean": 20.0, "env_to_module_connector": {"connector_pipeline_timer": 5.877912442969569e-05, "timers": {"connectors": {"batch_individual_items": 1.2375710288514375e-05, "numpy_to_tensor": 1.1961493779185948e-05, "add_observations_from_episodes_to_batch": 2.810160747327977e-06, "add_states_from_episodes_to_batch": 2.674036549975151e-06, "add_time_dim_to_batch_and_zero_pad": 7.017016749014887e-06}}}, "weights_seq_no": 4.0, "rlmodule_inference_timer": 3.1763465443639136e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1652635216960198e-05, "tensor_to_numpy": 1.5260043287889206e-05, "normalize_and_clip_actions": 7.787494240474844e-06, "get_actions": 3.7254094045360474e-05, "listify_data_for_vector_env": 1.0431780275789824e-05, "un_batch_to_individual_items": 6.473638444062117e-06}}, "connector_pipeline_timer": 0.00011444064252621478}, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 20400, "num_episodes_lifetime": 80, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "sample": 0.12210846952326583, "episode_duration_sec_mean": 0.0054062089300714435, "module_episode_returns_mean": {"default_policy": 0.2}, "episode_len_max": 20, "episode_len_min": 20, "episode_return_max": 12.5, "env_step_timer": 1.4163009780932039e-05, "episode_return_min": -12.5, "episode_return_mean": 0.2, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368237912813044, "env_reset_timer": 0.0005321034940199461, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 0.2}, "time_between_sampling": 10.902016606629163}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "ae8f9_00000", "date": "2025-08-11_18-15-06", "timestamp": 1754928906, "time_this_iter_s": 11.306949138641357, "time_total_s": 44.392332315444946, "pid": 10547, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3849f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 44.392332315444946, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 49.34375, "ram_util_percent": 80.68125}}
{"timers": {"training_iteration": 10.963458746902504, "restore_env_runners": 1.1461166269868842e-05, "training_step": 10.963299340824575, "env_runner_sampling_timer": 1.8520793754807188, "learner_update_timer": 8.901953363729804, "synch_weights": 0.0014634159441003424, "restore_eval_env_runners": 1.646026575542055e-05, "evaluation_iteration": 0.13297642020281136, "synch_eval_env_connectors": 0.00017423193456802985, "synch_env_connectors": 5.698824931052513e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.112806526889337e-06, "add_observations_from_episodes_to_batch": 2.8159057336187728e-06, "add_states_from_episodes_to_batch": 2.8544892742515648e-06, "batch_individual_items": 1.2497649535794702e-05, "numpy_to_tensor": 1.2735633382118527e-05}}, "connector_pipeline_timer": 6.013756737927461e-05}, "episode_len_mean": 20.0, "sample": 0.005768881373545509, "weights_seq_no": 4.0, "episode_duration_sec_mean": 0.00531580868270248, "episode_len_max": 20, "rlmodule_inference_timer": 3.258548344407651e-05, "module_to_env_connector": {"connector_pipeline_timer": 0.0001195479202262116, "timers": {"connectors": {"tensor_to_numpy": 1.556805224114343e-05, "listify_data_for_vector_env": 1.0691110238825597e-05, "normalize_and_clip_actions": 8.145681748341852e-06, "get_actions": 4.016865905001483e-05, "remove_single_ts_time_rank_from_batch": 1.1838384751803757e-05, "un_batch_to_individual_items": 6.6350455536939245e-06}}}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 3.793443634745854e-05, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_return_max": 9.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 0.06}, "env_step_timer": 1.3861385584001787e-05, "agent_episode_returns_mean": {"default_agent": 0.06}, "time_between_sampling": 0.039234958909981604, "num_env_steps_sampled_lifetime": -1842500.0, "num_episodes_lifetime": -92125.0, "episode_return_min": -10.5, "episode_return_mean": 0.06, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3222.0378930290435}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.16959524697708492, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009371521886403307, "add_observations_from_episodes_to_batch": 0.0008649190208172798, "add_columns_from_episodes_to_train_batch": 0.04346926449226569, "add_time_dim_to_batch_and_zero_pad": 0.10262314181352312, "add_states_from_episodes_to_batch": 0.003964906048924098, "batch_individual_items": 0.008982051493530485, "numpy_to_tensor": 8.455939488432255e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"vf_explained_var": 0.0017621517181396484, "vf_loss_unclipped": 41.982200622558594, "module_train_batch_size_mean": 998.6075885025957, "policy_loss": -0.00010203560668742284, "mean_kl_loss": 1.714279096631799e-05, "entropy": 0.6888173222541809, "num_module_steps_trained": 5985, "curr_kl_coeff": 0.0050494978204369545, "curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.3205196261405945, "num_module_steps_trained_lifetime": 29925, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.2485363632440567, "num_trainable_parameters": 16595, "weights_seq_no": 5.0, "num_module_steps_trained_lifetime_throughput": 661.6179231816035}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.6075885025957, "total_loss": 0.0, "weights_seq_no": 5.0, "curr_entropy_coeff": 0.0015431216992, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 29925, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 661.6285332898539}, "__all_modules__": {"num_module_steps_trained_lifetime": 59850, "num_env_steps_trained_lifetime": 180000, "num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained": 36000, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 3984.3068205857608, "num_module_steps_trained_throughput": 26422858.388709392, "num_module_steps_trained_lifetime_throughput": 10595880.041561222}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_explained_var": -0.0016001462936401367, "vf_loss_unclipped": 42.110931396484375, "module_train_batch_size_mean": 997.7394089995611, "total_loss": 0.24878624081611633, "mean_kl_loss": 1.687579606368672e-05, "weights_seq_no": 30.0, "entropy": 0.6888216733932495, "vf_loss": 0.32083380222320557, "policy_loss": -9.948216757038608e-05, "num_module_steps_trained_lifetime": 179550, "diff_num_grad_updates_vs_sampler_policy": 26.0, "num_module_steps_trained": 35910, "use_intrinsic_rewards": 1.0}, "intrinsic_reward_module": {"weights_seq_no": 30.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 179550, "diff_num_grad_updates_vs_sampler_policy": 26.0, "module_train_batch_size_mean": 997.7394089995611, "total_loss": 0.0}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 359100, "num_env_steps_trained_lifetime": 1080000, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 46435.32924982375}}}, "IntrinsicAttentionMask": [[[0.16633574664592743, 0.16760744154453278, 0.1658780574798584, 0.1658872812986374, 0.16763539612293243, 0.16665609180927277], [0.16595737636089325, 0.16867707669734955, 0.16498428583145142, 0.16500386595726013, 0.16873714327812195, 0.1666402667760849], [0.16647186875343323, 0.16722114384174347, 0.1662016063928604, 0.16620706021785736, 0.16723759472370148, 0.1666608303785324], [0.16646909713745117, 0.16722892224788666, 0.16619504988193512, 0.16620059311389923, 0.16724559664726257, 0.16666071116924286], [0.1659490317106247, 0.16870050132274628, 0.1649647057056427, 0.16498450934886932, 0.16876128315925598, 0.16663986444473267], [0.16624045372009277, 0.16787739098072052, 0.16565218567848206, 0.16566404700279236, 0.16791342198848724, 0.16665247082710266]], [[0.16682636737823486, 0.16682444512844086, 0.16625535488128662, 0.16645847260951996, 0.16681863367557526, 0.16681669652462006], [0.16682003438472748, 0.16681817173957825, 0.16627170145511627, 0.16646675765514374, 0.16681261360645294, 0.1668107509613037], [0.16493873298168182, 0.16495929658412933, 0.17113634943962097, 0.16890309751033783, 0.16502100229263306, 0.16504156589508057], [0.16561336815357208, 0.16562597453594208, 0.16938699781894684, 0.1680334359407425, 0.16566380858421326, 0.16567642986774445], [0.16680100560188293, 0.1667993813753128, 0.16632069647312164, 0.1664915829896927, 0.16679450869560242, 0.1667928695678711], [0.16679465770721436, 0.1667931079864502, 0.1663370281457901, 0.16649983823299408, 0.16678845882415771, 0.16678690910339355]], [[0.1666652411222458, 0.1669490933418274, 0.16620664298534393, 0.1662158966064453, 0.1669769436120987, 0.16698622703552246], [0.16666476428508759, 0.16702061891555786, 0.16609016060829163, 0.16610172390937805, 0.16705554723739624, 0.16706718504428864], [0.1666659116744995, 0.16683322191238403, 0.16639533638954163, 0.16640079021453857, 0.16684962809085846, 0.1668550968170166], [0.16666589677333832, 0.16683556139469147, 0.1663915514945984, 0.1663970798254013, 0.166852205991745, 0.1668577492237091], [0.166664719581604, 0.16702763736248016, 0.16607874631881714, 0.16609054803848267, 0.16706325113773346, 0.16707512736320496], [0.16666468977928162, 0.1670299619436264, 0.16607491672039032, 0.166086807847023, 0.1670658141374588, 0.16707776486873627]], [[0.16647900640964508, 0.16606271266937256, 0.16723038256168365, 0.1672343611717224, 0.16649481654167175, 0.16649878025054932], [0.16686128079891205, 0.1672971397638321, 0.16608016192913055, 0.16607604920864105, 0.16684475541114807, 0.16684062778949738], [0.1657821089029312, 0.16385389864444733, 0.1693076342344284, 0.16932643949985504, 0.1658557653427124, 0.165874183177948], [0.16577839851379395, 0.16384227573871613, 0.16931861639022827, 0.16933749616146088, 0.165852352976799, 0.16587084531784058], [0.1664644032716751, 0.16601593792438507, 0.1672741025686264, 0.16727839410305023, 0.16648145020008087, 0.1664857119321823], [0.16646075248718262, 0.1660042405128479, 0.16728505492210388, 0.16728940606117249, 0.16647811233997345, 0.16648244857788086]], [[0.16682705283164978, 0.16810250282287598, 0.16538691520690918, 0.16539610922336578, 0.16713905334472656, 0.16714835166931152], [0.1670021414756775, 0.16973896324634552, 0.16394034028053284, 0.1639597862958908, 0.16766943037509918, 0.16768933832645416], [0.16661888360977173, 0.16624976694583893, 0.16704009473323822, 0.16703738272190094, 0.16652825474739075, 0.16652557253837585], [0.16662026941776276, 0.16626162827014923, 0.1670294851064682, 0.16702686250209808, 0.1665322184562683, 0.1665295958518982], [0.16687068343162537, 0.16850319504737854, 0.1650315374135971, 0.16504326462745667, 0.16726970672607422, 0.1672815978527069], [0.16687197983264923, 0.1685151308774948, 0.16502097249031067, 0.1650327742099762, 0.16727358102798462, 0.16728556156158447]], [[0.16668978333473206, 0.16627295315265656, 0.16701944172382355, 0.1670234203338623, 0.16670560836791992, 0.16628876328468323], [0.1666419953107834, 0.16707728803157806, 0.1662992686033249, 0.1662951558828354, 0.1666254997253418, 0.1670607477426529], [0.16672585904598236, 0.16563931107521057, 0.16758836805820465, 0.16759876906871796, 0.16676725447177887, 0.1656804382801056], [0.16672629117965698, 0.1656317114830017, 0.16759522259235382, 0.1676056981086731, 0.16676798462867737, 0.1656731218099594], [0.16669154167175293, 0.16624246537685394, 0.16704681515693665, 0.16705109179019928, 0.16670861840248108, 0.16625948250293732], [0.1666438728570938, 0.16704674065113068, 0.1663266122341156, 0.16632279753684998, 0.16662859916687012, 0.1670314222574234]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 10.368238387501162, "episode_len_mean": 20.0, "env_to_module_connector": {"connector_pipeline_timer": 5.776016795287225e-05, "timers": {"connectors": {"batch_individual_items": 1.2116351707626395e-05, "numpy_to_tensor": 1.1780480536915053e-05, "add_observations_from_episodes_to_batch": 2.7940442774344697e-06, "add_states_from_episodes_to_batch": 2.6248743624918627e-06, "add_time_dim_to_batch_and_zero_pad": 6.753194791973558e-06}}}, "weights_seq_no": 5.0, "rlmodule_inference_timer": 3.177165597881991e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1716864633553766e-05, "tensor_to_numpy": 1.511385859284996e-05, "normalize_and_clip_actions": 7.824852545194958e-06, "get_actions": 3.6532325018398414e-05, "listify_data_for_vector_env": 1.0311091492807828e-05, "un_batch_to_individual_items": 6.482453073662738e-06}}, "connector_pipeline_timer": 0.00011356182782269016}, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 25400, "num_episodes_lifetime": 100, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "sample": 0.12201124024818862, "episode_duration_sec_mean": 0.005356801329180598, "module_episode_returns_mean": {"default_policy": 0.4}, "episode_len_max": 20, "episode_len_min": 20, "episode_return_max": 12.5, "env_step_timer": 1.3850933325263977e-05, "episode_return_min": -12.5, "episode_return_mean": 0.4, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238387501162, "env_reset_timer": 0.0005280395396645111, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 0.4}, "time_between_sampling": 10.894495534722678}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "ae8f9_00000", "date": "2025-08-11_18-15-16", "timestamp": 1754928916, "time_this_iter_s": 10.243885040283203, "time_total_s": 54.63621735572815, "pid": 10547, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3849f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 54.63621735572815, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 38.714285714285715, "ram_util_percent": 79.25}}
{"timers": {"training_iteration": 10.964358424434085, "restore_env_runners": 1.1417385181429315e-05, "training_step": 10.96419841616622, "env_runner_sampling_timer": 1.8512758967252292, "learner_update_timer": 8.903755934262726, "synch_weights": 0.0014600934540276358, "restore_eval_env_runners": 1.6425253141664436e-05, "evaluation_iteration": 0.1328346001615576, "synch_eval_env_connectors": 0.00017393711518487313, "synch_env_connectors": 5.6897567206656085e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.981206057258765e-06, "add_observations_from_episodes_to_batch": 3.279643163513665e-06, "add_states_from_episodes_to_batch": 3.071033519084902e-06, "batch_individual_items": 1.386691618561903e-05, "numpy_to_tensor": 1.4690908729225103e-05}}, "connector_pipeline_timer": 6.789032952009242e-05}, "episode_len_mean": 20.0, "sample": 0.0063056800659776775, "weights_seq_no": 5.0, "episode_duration_sec_mean": 0.006066124066710472, "episode_len_max": 20, "rlmodule_inference_timer": 3.7862073936075576e-05, "module_to_env_connector": {"connector_pipeline_timer": 0.00013589025732736767, "timers": {"connectors": {"tensor_to_numpy": 1.765193902907078e-05, "listify_data_for_vector_env": 1.1629403842149847e-05, "normalize_and_clip_actions": 8.874067029282414e-06, "get_actions": 4.753431067488924e-05, "remove_single_ts_time_rank_from_batch": 1.311443332018225e-05, "un_batch_to_individual_items": 7.146567218476278e-06}}}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 4.525332357765309e-05, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_return_max": 9.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 0.06}, "env_step_timer": 1.582334773688865e-05, "agent_episode_returns_mean": {"default_agent": 0.06}, "time_between_sampling": 0.03572356535600955, "num_env_steps_sampled_lifetime": -2460000.0, "num_episodes_lifetime": -123000.0, "episode_return_min": -10.5, "episode_return_mean": 0.06, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 2968.961030866678}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.16941321075786517, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009372807917113398, "add_observations_from_episodes_to_batch": 0.0008647598300635755, "add_columns_from_episodes_to_train_batch": 0.04344150434753406, "add_time_dim_to_batch_and_zero_pad": 0.10248635331583987, "add_states_from_episodes_to_batch": 0.003962324898159867, "batch_individual_items": 0.008967578478982758, "numpy_to_tensor": 8.432214084121815e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"vf_explained_var": 0.0009499788284301758, "vf_loss_unclipped": 42.47935485839844, "module_train_batch_size_mean": 998.5423314844973, "policy_loss": -0.0009045246406458318, "mean_kl_loss": 6.471547385444865e-05, "entropy": 0.6876062154769897, "num_module_steps_trained": 5985, "curr_kl_coeff": 0.0025247489102184772, "curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.32051777839660645, "num_module_steps_trained_lifetime": 35910, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.2477344423532486, "num_trainable_parameters": 16595, "weights_seq_no": 6.0, "num_module_steps_trained_lifetime_throughput": 660.4113255121586}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.5423314844973, "total_loss": 0.0, "weights_seq_no": 6.0, "curr_entropy_coeff": 0.0015431216992, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 35910, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 660.421454977879}, "__all_modules__": {"num_module_steps_trained_lifetime": 71820, "num_env_steps_trained_lifetime": 216000, "num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained": 36000, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 3976.8978453840755, "num_module_steps_trained_throughput": 25719335.646120965, "num_module_steps_trained_lifetime_throughput": 10662121.340958662}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_explained_var": -0.0015795230865478516, "vf_loss_unclipped": 42.52613067626953, "module_train_batch_size_mean": 997.6644392492373, "total_loss": 0.24797019362449646, "mean_kl_loss": 6.0421934904297814e-05, "weights_seq_no": 36.0, "entropy": 0.6876463890075684, "vf_loss": 0.3207685351371765, "policy_loss": -0.0008735020528547466, "num_module_steps_trained_lifetime": 215460, "diff_num_grad_updates_vs_sampler_policy": 31.0, "num_module_steps_trained": 35910, "use_intrinsic_rewards": 1.0}, "intrinsic_reward_module": {"weights_seq_no": 36.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 215460, "diff_num_grad_updates_vs_sampler_policy": 31.0, "module_train_batch_size_mean": 997.6644392492373, "total_loss": 0.0}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 430920, "num_env_steps_trained_lifetime": 1296000, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 45867.63398735391}}}, "IntrinsicAttentionMask": [[[0.1683274358510971, 0.16648267209529877, 0.16326649487018585, 0.16511015594005585, 0.16839787364006042, 0.16841548681259155], [0.16755779087543488, 0.16657085716724396, 0.1648380011320114, 0.1658332645893097, 0.16759535670280457, 0.16760475933551788], [0.16619190573692322, 0.16671496629714966, 0.1676449477672577, 0.16710899770259857, 0.1661720722913742, 0.16616712510585785], [0.16697868704795837, 0.16663388907909393, 0.1660252958536148, 0.16637535393238068, 0.16699178516864777, 0.1669950634241104], [0.16835661232471466, 0.1664792150259018, 0.1632070094347, 0.165082648396492, 0.16842830181121826, 0.16844622790813446], [0.16836391389369965, 0.16647835075855255, 0.16319215297698975, 0.16507577896118164, 0.16843591630458832, 0.16845391690731049]], [[0.16716361045837402, 0.16671159863471985, 0.1663665622472763, 0.16591669619083405, 0.16669897735118866, 0.16714254021644592], [0.16618970036506653, 0.16662245988845825, 0.16695435345172882, 0.16738910973072052, 0.16663455963134766, 0.16620983183383942], [0.16544540226459503, 0.16655133664608002, 0.16740255057811737, 0.16852158308029175, 0.16658234596252441, 0.16549673676490784], [0.16447392106056213, 0.16645461320877075, 0.16798627376556396, 0.17000927031040192, 0.16651029884815216, 0.16456562280654907], [0.16616250574588776, 0.1666199117898941, 0.16697074472904205, 0.16743037104606628, 0.16663271188735962, 0.16618376970291138], [0.16711823642253876, 0.16670756042003632, 0.16639399528503418, 0.1659850925207138, 0.16669608652591705, 0.16709908843040466]], [[0.1664968878030777, 0.16776981949806213, 0.16505961120128632, 0.16506877541542053, 0.16779780387878418, 0.16780713200569153], [0.1662936806678772, 0.1690189093351364, 0.16324487328529358, 0.16326424479484558, 0.16907908022403717, 0.16909915208816528], [0.16671445965766907, 0.16634511947631836, 0.16713589429855347, 0.1671331822872162, 0.1663370281457901, 0.166334331035614], [0.16671308875083923, 0.166354238986969, 0.16712252795696259, 0.16711990535259247, 0.16634640097618103, 0.1663437783718109], [0.16628912091255188, 0.16904625296592712, 0.16320523619651794, 0.16322483122348785, 0.16910715401172638, 0.1691274493932724], [0.1662876009941101, 0.16905534267425537, 0.1631920039653778, 0.1632116734981537, 0.16911648213863373, 0.1691368669271469]], [[0.16648167371749878, 0.1664879024028778, 0.16766566038131714, 0.16700637340545654, 0.16584563255310059, 0.16651280224323273], [0.16647939383983612, 0.16648569703102112, 0.16767799854278564, 0.16701056063175201, 0.16583555936813354, 0.1665109097957611], [0.16604341566562653, 0.16606411337852478, 0.17001312971115112, 0.16779454052448273, 0.16393792629241943, 0.16614694893360138], [0.16628818213939667, 0.16630083322525024, 0.16870525479316711, 0.16735713183879852, 0.16499705612659454, 0.16635149717330933], [0.166714608669281, 0.16671298444271088, 0.16640695929527283, 0.16657793521881104, 0.1668810099363327, 0.16670648753643036], [0.1664702296257019, 0.16647683084011078, 0.1677273064851761, 0.16702724993228912, 0.16579514741897583, 0.16650326550006866]], [[0.16802068054676056, 0.1680382490158081, 0.1647920161485672, 0.16480925679206848, 0.16809098422527313, 0.16624881327152252], [0.1680266261100769, 0.1680442839860916, 0.164783775806427, 0.16480109095573425, 0.16809724271297455, 0.1662469357252121], [0.16691480576992035, 0.16691800951957703, 0.16632266342639923, 0.16632585227489471, 0.16692760586738586, 0.16659100353717804], [0.16692078113555908, 0.16692405939102173, 0.16631439328193665, 0.1663176566362381, 0.16693387925624847, 0.1665891855955124], [0.16804450750350952, 0.16806238889694214, 0.1647590845823288, 0.16477662324905396, 0.16811606287956238, 0.1662413477897644], [0.16741661727428436, 0.16742631793022156, 0.16562765836715698, 0.16563725471496582, 0.16745540499687195, 0.16643677651882172]], [[0.16701439023017883, 0.16701017320156097, 0.16621805727481842, 0.16621385514736176, 0.1665501743555069, 0.16699333488941193], [0.16700804233551025, 0.16700391471385956, 0.16622623801231384, 0.16622212529182434, 0.1665523201227188, 0.1669873595237732], [0.16581088304519653, 0.16582117974758148, 0.16777236759662628, 0.16778278350830078, 0.16695034503936768, 0.1658623367547989], [0.16580455005168915, 0.16581490635871887, 0.16778059303760529, 0.16779108345508575, 0.166952446103096, 0.16585637629032135], [0.16631360352039337, 0.16631785035133362, 0.16712257266044617, 0.1671268492937088, 0.16678422689437866, 0.16633488237857819], [0.16698263585567474, 0.16697882115840912, 0.16625897586345673, 0.1662551611661911, 0.1665608286857605, 0.16696350276470184]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 10.368238394470474, "episode_len_mean": 20.0, "env_to_module_connector": {"connector_pipeline_timer": 6.186321533599934e-05, "timers": {"connectors": {"batch_individual_items": 1.3068206058645227e-05, "numpy_to_tensor": 1.3223756675542531e-05, "add_observations_from_episodes_to_batch": 2.901899267872829e-06, "add_states_from_episodes_to_batch": 2.746760825372656e-06, "add_time_dim_to_batch_and_zero_pad": 7.212529343097219e-06}}}, "weights_seq_no": 6.0, "rlmodule_inference_timer": 3.4431048871840436e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2065845633911692e-05, "tensor_to_numpy": 1.6647042491426876e-05, "normalize_and_clip_actions": 8.241012183842603e-06, "get_actions": 4.113367280545676e-05, "listify_data_for_vector_env": 1.083753724352535e-05, "un_batch_to_individual_items": 6.852936962525791e-06}}, "connector_pipeline_timer": 0.00012317662107911716}, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 30400, "num_episodes_lifetime": 120, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "sample": 0.12214020659547889, "episode_duration_sec_mean": 0.005473339629825205, "module_episode_returns_mean": {"default_policy": 0.4}, "episode_len_max": 20, "episode_len_min": 20, "episode_return_max": 12.5, "env_step_timer": 1.5609732723525757e-05, "episode_return_min": -12.5, "episode_return_mean": 0.4, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394470474, "env_reset_timer": 0.0005268508145388752, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 0.4}, "time_between_sampling": 10.896343492284979}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "ae8f9_00000", "date": "2025-08-11_18-15-28", "timestamp": 1754928928, "time_this_iter_s": 11.200929164886475, "time_total_s": 65.83714652061462, "pid": 10547, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3849f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 65.83714652061462, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 47.106249999999996, "ram_util_percent": 80.75625}}
{"timers": {"training_iteration": 10.96368046810986, "restore_env_runners": 1.1366960359847452e-05, "training_step": 10.96351822784427, "env_runner_sampling_timer": 1.849707896928269, "learner_update_timer": 8.904701979499565, "synch_weights": 0.00145868501924231, "restore_eval_env_runners": 1.6368080587417425e-05, "evaluation_iteration": 0.13295280124093753, "synch_eval_env_connectors": 0.00017377399468487568, "synch_env_connectors": 5.69952904411602e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.686740512180477e-06, "add_observations_from_episodes_to_batch": 2.9870532740572834e-06, "add_states_from_episodes_to_batch": 2.992157849607079e-06, "batch_individual_items": 1.354502514547857e-05, "numpy_to_tensor": 1.408221691379582e-05}}, "connector_pipeline_timer": 6.46001663783539e-05}, "episode_len_mean": 20.0, "sample": 0.006181166975253896, "weights_seq_no": 6.0, "episode_duration_sec_mean": 0.005808554153423754, "episode_len_max": 20, "rlmodule_inference_timer": 3.558067429101698e-05, "module_to_env_connector": {"connector_pipeline_timer": 0.00013020220114420833, "timers": {"connectors": {"tensor_to_numpy": 1.6987939035712807e-05, "listify_data_for_vector_env": 1.1397660074184435e-05, "normalize_and_clip_actions": 8.66027437853637e-06, "get_actions": 4.5351165311513895e-05, "remove_single_ts_time_rank_from_batch": 1.2552243679092236e-05, "un_batch_to_individual_items": 7.056477582066052e-06}}}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 4.746757172248064e-05, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_return_max": 9.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 0.9399999999999996}, "env_step_timer": 1.5144058792973515e-05, "agent_episode_returns_mean": {"default_agent": 0.9399999999999996}, "time_between_sampling": 0.038127856542280125, "num_env_steps_sampled_lifetime": -3077500.0, "num_episodes_lifetime": -153875.0, "episode_return_min": -10.5, "episode_return_mean": 0.9399999999999996, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 2997.283558717701}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.16925006365013132, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009368961497893324, "add_observations_from_episodes_to_batch": 0.0008646768220065623, "add_columns_from_episodes_to_train_batch": 0.043424171803538594, "add_time_dim_to_batch_and_zero_pad": 0.10236327144318612, "add_states_from_episodes_to_batch": 0.003960464149756805, "batch_individual_items": 0.00895196727328676, "numpy_to_tensor": 8.417432985019881e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"vf_explained_var": 1.0371208190917969e-05, "vf_loss_unclipped": 42.11946105957031, "module_train_batch_size_mean": 998.4808932973482, "policy_loss": -0.0012566358782351017, "mean_kl_loss": 6.852939259260893e-05, "entropy": 0.6864365935325623, "num_module_steps_trained": 5985, "curr_kl_coeff": 0.0012623744551092386, "curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.3205130398273468, "num_module_steps_trained_lifetime": 41895, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.247380331158638, "num_trainable_parameters": 16595, "weights_seq_no": 7.0, "num_module_steps_trained_lifetime_throughput": 658.8761533692771}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.4808932973482, "total_loss": 0.0, "weights_seq_no": 7.0, "curr_entropy_coeff": 0.0015431216992, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 41895, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 658.8857982177115}, "__all_modules__": {"num_module_steps_trained_lifetime": 83790, "num_env_steps_trained_lifetime": 252000, "num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained": 36000, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 3967.506441786187, "num_module_steps_trained_throughput": 25032117.502035934, "num_module_steps_trained_lifetime_throughput": 10730503.595436562}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_explained_var": -0.001610875129699707, "vf_loss_unclipped": 42.19489669799805, "module_train_batch_size_mean": 997.6122293241576, "total_loss": 0.24761903285980225, "mean_kl_loss": 6.247502460610121e-05, "weights_seq_no": 42.0, "entropy": 0.6864975690841675, "vf_loss": 0.32073381543159485, "policy_loss": -0.0011997036635875702, "num_module_steps_trained_lifetime": 251370, "diff_num_grad_updates_vs_sampler_policy": 36.0, "num_module_steps_trained": 35910, "use_intrinsic_rewards": 1.0}, "intrinsic_reward_module": {"weights_seq_no": 42.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 251370, "diff_num_grad_updates_vs_sampler_policy": 36.0, "module_train_batch_size_mean": 997.6122293241576, "total_loss": 0.0}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 502740, "num_env_steps_trained_lifetime": 1512000, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 45275.78159714964}}}, "IntrinsicAttentionMask": [[[0.16864162683486938, 0.16679342091083527, 0.16540104150772095, 0.16358834505081177, 0.16684575378894806, 0.16872984170913696], [0.16772493720054626, 0.16673700511455536, 0.16598938405513763, 0.1650116890668869, 0.16676504909992218, 0.16777195036411285], [0.16702812910079956, 0.16669133305549622, 0.16643556952476501, 0.16609996557235718, 0.16670091450214386, 0.16704413294792175], [0.16611288487911224, 0.16662761569023132, 0.16702024638652802, 0.16753779351711273, 0.16661293804645538, 0.16608849167823792], [0.1677509993314743, 0.16673865914344788, 0.16597265005111694, 0.16497103869915009, 0.16676738858222961, 0.1677991896867752], [0.16868513822555542, 0.1667959839105606, 0.1653730720281601, 0.16352100670337677, 0.16684947907924652, 0.16877532005310059]], [[0.16689495742321014, 0.16668744385242462, 0.1663237065076828, 0.1665269136428833, 0.16668164730072021, 0.16688528656959534], [0.1659214198589325, 0.1665971428155899, 0.1677902340888977, 0.16712234914302826, 0.1666160523891449, 0.16595283150672913], [0.16421540081501007, 0.16642816364765167, 0.17038583755493164, 0.16816237568855286, 0.16649042069911957, 0.1643178015947342], [0.1651683747768402, 0.16652421653270721, 0.16893187165260315, 0.1675819456577301, 0.1665622591972351, 0.16523127257823944], [0.16589424014091492, 0.16659455001354218, 0.16783133149147034, 0.1671389490365982, 0.16661414504051208, 0.16592678427696228], [0.16684959828853607, 0.1666833460330963, 0.16639181971549988, 0.16655470430850983, 0.16667869687080383, 0.16684184968471527]], [[0.1664985716342926, 0.16678214073181152, 0.16604045033454895, 0.16507045924663544, 0.16779950261116028, 0.16780883073806763], [0.16645513474941254, 0.166810542345047, 0.16588126122951508, 0.1646675169467926, 0.1680869311094284, 0.16809864342212677], [0.16656821966171265, 0.1667354255914688, 0.1662978231906891, 0.16572429239749908, 0.1673344075679779, 0.16733989119529724], [0.16671322286128998, 0.1666329950094223, 0.1668432354927063, 0.1671200394630432, 0.16634653508663177, 0.16634391248226166], [0.16629700362682343, 0.1669091135263443, 0.16531062126159668, 0.16323256492614746, 0.16911515593528748, 0.1691354662179947], [0.16629557311534882, 0.16691000759601593, 0.16530540585517883, 0.16321949660778046, 0.16912458837032318, 0.16914497315883636]], [[0.1668606698513031, 0.16665320098400116, 0.16649462282657623, 0.1662876158952713, 0.1668529361486435, 0.1668509989976883], [0.1660325676202774, 0.16670872271060944, 0.16722795367240906, 0.16790898144245148, 0.16605770587921143, 0.16606399416923523], [0.16539829969406128, 0.1667477935552597, 0.1677878051996231, 0.16915678977966309, 0.1654483824968338, 0.16546091437339783], [0.16456857323646545, 0.1667943298816681, 0.16851772367954254, 0.17079690098762512, 0.16465094685554504, 0.16467155516147614], [0.16682982444763184, 0.16665534675121307, 0.16652196645736694, 0.16634781658649445, 0.16682332754135132, 0.16682168841362], [0.16682212054729462, 0.16665589809417725, 0.16652880609035492, 0.16636288166046143, 0.16681592166423798, 0.16681437194347382]], [[0.16832754015922546, 0.1683451533317566, 0.16509298980236053, 0.16328367590904236, 0.16653501987457275, 0.1684155911207199], [0.16833484172821045, 0.16835252940654755, 0.1650860458612442, 0.16326887905597687, 0.1665343940258026, 0.16842328011989594], [0.166971355676651, 0.16697454452514648, 0.16637898981571198, 0.1660435050725937, 0.16664423048496246, 0.166987344622612], [0.1661992371082306, 0.1661943644285202, 0.16710707545280457, 0.16762489080429077, 0.16669955849647522, 0.16617484390735626], [0.1675797402858734, 0.16758936643600464, 0.1658032089471817, 0.16480261087417603, 0.1665971428155899, 0.16762788593769073], [0.1683640480041504, 0.16838203370571136, 0.16505827009677887, 0.1632097363471985, 0.16653187572956085, 0.16845405101776123]], [[0.16682636737823486, 0.16682444512844086, 0.16646039485931396, 0.16625343263149261, 0.16681863367557526, 0.16681669652462006], [0.16682003438472748, 0.16681817173957825, 0.16646860539913177, 0.16626985371112823, 0.16681261360645294, 0.1668107509613037], [0.16561974585056305, 0.16563227772712708, 0.16801244020462036, 0.16938325762748718, 0.16566988825798035, 0.16568242013454437], [0.1649322658777237, 0.16495290398597717, 0.16889014840126038, 0.17117436230182648, 0.1650148332118988, 0.16503547132015228], [0.16680100560188293, 0.1667993813753128, 0.16649320721626282, 0.1663190871477127, 0.16679450869560242, 0.1667928695678711], [0.16679464280605316, 0.166793093085289, 0.16650138795375824, 0.16633547842502594, 0.16678844392299652, 0.16678689420223236]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 10.368238394572801, "episode_len_mean": 20.0, "env_to_module_connector": {"connector_pipeline_timer": 6.293888572590346e-05, "timers": {"connectors": {"batch_individual_items": 1.2836859033505417e-05, "numpy_to_tensor": 1.3561281915575144e-05, "add_observations_from_episodes_to_batch": 3.0000992747715886e-06, "add_states_from_episodes_to_batch": 2.99582954913295e-06, "add_time_dim_to_batch_and_zero_pad": 7.355423719720664e-06}}}, "weights_seq_no": 7.0, "rlmodule_inference_timer": 3.572762546521929e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2411717709775661e-05, "tensor_to_numpy": 1.6482069843910077e-05, "normalize_and_clip_actions": 8.450077627072378e-06, "get_actions": 4.245443914869857e-05, "listify_data_for_vector_env": 1.1590798031189034e-05, "un_batch_to_individual_items": 6.820486115203828e-06}}, "connector_pipeline_timer": 0.00012646989360774925}, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 35400, "num_episodes_lifetime": 140, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "sample": 0.12217242535919012, "episode_duration_sec_mean": 0.005480600884184241, "module_episode_returns_mean": {"default_policy": 0.0}, "episode_len_max": 20, "episode_len_min": 20, "episode_return_max": 12.5, "env_step_timer": 1.5354663676439152e-05, "episode_return_min": -12.5, "episode_return_mean": 0.0, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394572801, "env_reset_timer": 0.0005291489670361104, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 0.0}, "time_between_sampling": 10.89666127569227}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "ae8f9_00000", "date": "2025-08-11_18-15-39", "timestamp": 1754928939, "time_this_iter_s": 11.035673141479492, "time_total_s": 76.87281966209412, "pid": 10547, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3849f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 76.87281966209412, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 45.44375, "ram_util_percent": 80.125}}
{"timers": {"training_iteration": 10.963441109269057, "restore_env_runners": 1.1314121254363206e-05, "training_step": 10.963278227225903, "env_runner_sampling_timer": 1.8471840129583739, "learner_update_timer": 8.907032570954488, "synch_weights": 0.0014571464989061335, "restore_eval_env_runners": 1.635148006329262e-05, "evaluation_iteration": 0.13298270572768542, "synch_eval_env_connectors": 0.00017424333440748757, "synch_env_connectors": 5.696693653848405e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.2821163862849834e-06, "add_observations_from_episodes_to_batch": 2.8897458228215496e-06, "add_states_from_episodes_to_batch": 2.9131465740325073e-06, "batch_individual_items": 1.2860876948934367e-05, "numpy_to_tensor": 1.3328255892454683e-05}}, "connector_pipeline_timer": 6.176870226122481e-05}, "episode_len_mean": 20.0, "sample": 0.0060479943060196455, "weights_seq_no": 7.0, "episode_duration_sec_mean": 0.005478150708135216, "episode_len_max": 20, "rlmodule_inference_timer": 3.374216510796817e-05, "module_to_env_connector": {"connector_pipeline_timer": 0.00012320138826033851, "timers": {"connectors": {"tensor_to_numpy": 1.6076247712291458e-05, "listify_data_for_vector_env": 1.0941983678397208e-05, "normalize_and_clip_actions": 8.321417674462964e-06, "get_actions": 4.194753523421511e-05, "remove_single_ts_time_rank_from_batch": 1.2051905571780198e-05, "un_batch_to_individual_items": 6.766309496289076e-06}}}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 4.74295268564664e-05, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_return_max": 9.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 0.6199999999999999}, "env_step_timer": 1.4448638253942043e-05, "agent_episode_returns_mean": {"default_agent": 0.6199999999999999}, "time_between_sampling": 0.03799341410193887, "num_env_steps_sampled_lifetime": -3695000.0, "num_episodes_lifetime": -184750.0, "episode_return_min": -10.5, "episode_return_mean": 0.6199999999999999, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3104.0181236047865}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.16911046759365128, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009365555223456036, "add_observations_from_episodes_to_batch": 0.0008648358938298477, "add_columns_from_episodes_to_train_batch": 0.04340581300658238, "add_time_dim_to_batch_and_zero_pad": 0.10226277581962165, "add_states_from_episodes_to_batch": 0.003957842418501169, "batch_individual_items": 0.008938276350240372, "numpy_to_tensor": 8.41279965663858e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"vf_explained_var": -0.00021958351135253906, "vf_loss_unclipped": 42.43973159790039, "module_train_batch_size_mean": 998.4230504637324, "policy_loss": -0.0002605766640044749, "mean_kl_loss": 3.24397515214514e-05, "entropy": 0.6853889226913452, "num_module_steps_trained": 5985, "curr_kl_coeff": 0.0006311872275546193, "curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.32051727175712585, "num_module_steps_trained_lifetime": 47880, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.2483811378479004, "num_trainable_parameters": 16595, "weights_seq_no": 8.0, "num_module_steps_trained_lifetime_throughput": 656.9486719270694}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.4230504637324, "total_loss": 0.0, "weights_seq_no": 8.0, "curr_entropy_coeff": 0.0015431216992, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 47880, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 656.9578511434199}, "__all_modules__": {"num_module_steps_trained_lifetime": 95760, "num_env_steps_trained_lifetime": 288000, "num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained": 36000, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 3955.751724577559, "num_module_steps_trained_throughput": 24358326.46761202, "num_module_steps_trained_lifetime_throughput": 10787697.616548272}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_explained_var": -0.0015958547592163086, "vf_loss_unclipped": 42.47526168823242, "module_train_batch_size_mean": 997.5758696422192, "total_loss": 0.2485262155532837, "mean_kl_loss": 3.130657205474563e-05, "weights_seq_no": 48.0, "entropy": 0.6854065656661987, "vf_loss": 0.3206906318664551, "policy_loss": -0.0002555281389504671, "num_module_steps_trained_lifetime": 287280, "diff_num_grad_updates_vs_sampler_policy": 41.0, "num_module_steps_trained": 35910, "use_intrinsic_rewards": 1.0}, "intrinsic_reward_module": {"weights_seq_no": 48.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 287280, "diff_num_grad_updates_vs_sampler_policy": 41.0, "module_train_batch_size_mean": 997.5758696422192, "total_loss": 0.0}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 574560, "num_env_steps_trained_lifetime": 1728000, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 44683.94514517973}}}, "IntrinsicAttentionMask": [[[0.16832758486270905, 0.16834519803524017, 0.16509303450584412, 0.16328372061252594, 0.16839802265167236, 0.16655248403549194], [0.16833488643169403, 0.16835257411003113, 0.16508609056472778, 0.16326892375946045, 0.16840563714504242, 0.16655193269252777], [0.166971355676651, 0.16697455942630768, 0.16637900471687317, 0.16604351997375488, 0.16698415577411652, 0.16664744913578033], [0.1661992371082306, 0.1661943644285202, 0.16710707545280457, 0.16762489080429077, 0.16617971658706665, 0.16669465601444244], [0.1683567762374878, 0.168374702334404, 0.1650652438402176, 0.16322454810142517, 0.1684284657239914, 0.16655026376247406], [0.1675870567560196, 0.16759677231311798, 0.16579627990722656, 0.16478773951530457, 0.16762588918209076, 0.16660621762275696]], [[0.1668606549501419, 0.16665318608283997, 0.16649460792541504, 0.1662876009941101, 0.1668529212474823, 0.1668509840965271], [0.1660325676202774, 0.16670872271060944, 0.16722795367240906, 0.16790898144245148, 0.16605770587921143, 0.16606399416923523], [0.16539829969406128, 0.1667477935552597, 0.1677878051996231, 0.16915678977966309, 0.1654483824968338, 0.16546091437339783], [0.16456855833530426, 0.1667943298816681, 0.16851772367954254, 0.17079690098762512, 0.16465094685554504, 0.16467155516147614], [0.16682982444763184, 0.16665534675121307, 0.16652196645736694, 0.16634781658649445, 0.16682332754135132, 0.16682168841362], [0.16682212054729462, 0.16665589809417725, 0.16652880609035492, 0.16636288166046143, 0.16681592166423798, 0.16681437194347382]], [[0.166498601436615, 0.16777154803276062, 0.16506129503250122, 0.16604970395565033, 0.16680999100208282, 0.16780886054039001], [0.16630151867866516, 0.16902685165405273, 0.1632525473833084, 0.16534602642059326, 0.1669660061597824, 0.1691071093082428], [0.166714608669281, 0.1663452684879303, 0.1671360433101654, 0.16684572398662567, 0.16662392020225525, 0.16633449494838715], [0.16656681895256042, 0.16732709109783173, 0.16570556163787842, 0.16629815101623535, 0.16675300896167755, 0.16734933853149414], [0.1664508879184723, 0.16807930171489716, 0.16461637616157532, 0.16587744653224945, 0.16684891283512115, 0.16812708973884583], [0.1662956327199936, 0.1690635234117508, 0.16319990158081055, 0.16532540321350098, 0.16697044670581818, 0.16914504766464233]], [[0.16689495742321014, 0.16689302027225494, 0.1663237065076828, 0.1665269136428833, 0.16668164730072021, 0.1666797250509262], [0.1668858826160431, 0.16688401997089386, 0.16633734107017517, 0.1665324717760086, 0.16668106615543365, 0.16667920351028442], [0.16421523690223694, 0.16423571109771729, 0.17038565874099731, 0.16816219687461853, 0.16649024188518524, 0.16651099920272827], [0.16516831517219543, 0.16518089175224304, 0.16893181204795837, 0.16758188605308533, 0.16656219959259033, 0.1665748953819275], [0.16589422523975372, 0.16590073704719543, 0.16783131659030914, 0.167138934135437, 0.1666141301393509, 0.16662068665027618], [0.16588516533374786, 0.16589173674583435, 0.1678450107574463, 0.16714446246623993, 0.16661348938941956, 0.16662010550498962]], [[0.16682875156402588, 0.16711287200450897, 0.16538859903812408, 0.1663789600133896, 0.16714075207710266, 0.16715005040168762], [0.16686946153640747, 0.16722574830055237, 0.16506588459014893, 0.16630573570728302, 0.16726072132587433, 0.16727237403392792], [0.16661904752254486, 0.16653649508953094, 0.16704024374485016, 0.16675008833408356, 0.16652841866016388, 0.1665257215499878], [0.16676385700702667, 0.16693361103534698, 0.1659015715122223, 0.16649486124515533, 0.1669502556324005, 0.16695581376552582], [0.16687345504760742, 0.1672368198633194, 0.16503427922725677, 0.16629855334758759, 0.16727247834205627, 0.16728436946868896], [0.16687478125095367, 0.16724051535129547, 0.16502375900745392, 0.16629618406295776, 0.16727641224861145, 0.1672883778810501]], [[0.1668950468301773, 0.16668753325939178, 0.16652892529964447, 0.16652700304985046, 0.16668173670768738, 0.16667981445789337], [0.16592220962047577, 0.16659793257713318, 0.16711682081222534, 0.16712313890457153, 0.16661684215068817, 0.16662314534187317], [0.16518054902553558, 0.16652825474739075, 0.1675669103860855, 0.16757959127426147, 0.16656607389450073, 0.16657868027687073], [0.1651715189218521, 0.1665273904800415, 0.16757237911224365, 0.16758513450622559, 0.1665654331445694, 0.16657811403274536], [0.16589507460594177, 0.16659538447856903, 0.16713322699069977, 0.16713978350162506, 0.16661499440670013, 0.16662152111530304], [0.1658860445022583, 0.16659455001354218, 0.1671387255191803, 0.16714535653591156, 0.16661439836025238, 0.16662101447582245]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 10.3682383945743, "episode_len_mean": 20.0, "env_to_module_connector": {"connector_pipeline_timer": 6.202181197193928e-05, "timers": {"connectors": {"batch_individual_items": 1.2934069835308172e-05, "numpy_to_tensor": 1.2706319849661463e-05, "add_observations_from_episodes_to_batch": 2.8741369184381282e-06, "add_states_from_episodes_to_batch": 2.9606828984742325e-06, "add_time_dim_to_batch_and_zero_pad": 7.266115386421274e-06}}}, "weights_seq_no": 8.0, "rlmodule_inference_timer": 3.605170887859212e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1984407067380776e-05, "tensor_to_numpy": 1.583530540771172e-05, "normalize_and_clip_actions": 8.04477645998416e-06, "get_actions": 3.970387030382076e-05, "listify_data_for_vector_env": 1.0921289548321752e-05, "un_batch_to_individual_items": 6.645540051065124e-06}}, "connector_pipeline_timer": 0.00011925451009078905}, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 40400, "num_episodes_lifetime": 160, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "sample": 0.12217174777570539, "episode_duration_sec_mean": 0.005542192119173705, "module_episode_returns_mean": {"default_policy": 0.0}, "episode_len_max": 20, "episode_len_min": 20, "episode_return_max": 12.5, "env_step_timer": 1.4784238968671743e-05, "episode_return_min": -12.5, "episode_return_mean": 0.0, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.3682383945743, "env_reset_timer": 0.0005275724777139149, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 0.0}, "time_between_sampling": 10.897425655435319}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "ae8f9_00000", "date": "2025-08-11_18-15-50", "timestamp": 1754928950, "time_this_iter_s": 11.074551820755005, "time_total_s": 87.94737148284912, "pid": 10547, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3849f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 87.94737148284912, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 45.84375, "ram_util_percent": 80.01875}}
{"timers": {"training_iteration": 10.953799008586966, "restore_env_runners": 1.1275140094282986e-05, "training_step": 10.953635487863856, "env_runner_sampling_timer": 1.8447609436690697, "learner_update_timer": 8.899901437745376, "synch_weights": 0.0014521562838228225, "restore_eval_env_runners": 1.6425465324872038e-05, "evaluation_iteration": 0.1329702336698912, "synch_eval_env_connectors": 0.0001741575609422031, "synch_env_connectors": 5.69430687679526e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.3126609980948665e-06, "add_observations_from_episodes_to_batch": 2.8830779245397014e-06, "add_states_from_episodes_to_batch": 2.9928938704727966e-06, "batch_individual_items": 1.2966123389391438e-05, "numpy_to_tensor": 1.3211128024884538e-05}}, "connector_pipeline_timer": 6.185702717516063e-05}, "episode_len_mean": 20.0, "sample": 0.005900835844687176, "weights_seq_no": 8.0, "episode_duration_sec_mean": 0.0055070618032477805, "episode_len_max": 20, "rlmodule_inference_timer": 3.377212820019725e-05, "module_to_env_connector": {"connector_pipeline_timer": 0.00012364320223095499, "timers": {"connectors": {"tensor_to_numpy": 1.6096534630146655e-05, "listify_data_for_vector_env": 1.0940122689142303e-05, "normalize_and_clip_actions": 8.355950265169579e-06, "get_actions": 4.205616084306722e-05, "remove_single_ts_time_rank_from_batch": 1.2207062434553245e-05, "un_batch_to_individual_items": 6.7997517200706145e-06}}}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 4.4544000977508174e-05, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_return_max": 9.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 0.3}, "env_step_timer": 1.4511311660297442e-05, "agent_episode_returns_mean": {"default_agent": 0.3}, "time_between_sampling": 0.038475556178673986, "num_env_steps_sampled_lifetime": -4312500.0, "num_episodes_lifetime": -215625.0, "episode_return_min": -10.5, "episode_return_mean": 0.3, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3117.3916837833012}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1689409270879673, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009361040920412492, "add_observations_from_episodes_to_batch": 0.0008646717054308538, "add_columns_from_episodes_to_train_batch": 0.04338482112655582, "add_time_dim_to_batch_and_zero_pad": 0.10213515431061854, "add_states_from_episodes_to_batch": 0.003956199833816436, "batch_individual_items": 0.008925072755856371, "numpy_to_tensor": 8.396005700140284e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"vf_explained_var": -7.128715515136719e-05, "vf_loss_unclipped": 41.80965805053711, "module_train_batch_size_mean": 998.3685925840979, "policy_loss": -0.0002360311191296205, "mean_kl_loss": 1.3477791981131304e-05, "entropy": 0.6849201917648315, "num_module_steps_trained": 5985, "curr_kl_coeff": 0.00031559361377730966, "curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.32051700353622437, "num_module_steps_trained_lifetime": 53865, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.24840620160102844, "num_trainable_parameters": 16595, "weights_seq_no": 9.0, "num_module_steps_trained_lifetime_throughput": 655.8047076043185}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.3685925840979, "total_loss": 0.0, "weights_seq_no": 9.0, "curr_entropy_coeff": 0.0015431216992, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 53865, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 655.8134086750276}, "__all_modules__": {"num_module_steps_trained_lifetime": 107730, "num_env_steps_trained_lifetime": 324000, "num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained": 36000, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 3948.7130051312256, "num_module_steps_trained_throughput": 23729017.38283198, "num_module_steps_trained_lifetime_throughput": 10852072.40904428}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_explained_var": -0.0016378164291381836, "vf_loss_unclipped": 41.90453338623047, "module_train_batch_size_mean": 997.5505482791133, "total_loss": 0.248536616563797, "mean_kl_loss": 1.2424485248629935e-05, "weights_seq_no": 54.0, "entropy": 0.6849464178085327, "vf_loss": 0.3206694722175598, "policy_loss": -0.00022633845219388604, "num_module_steps_trained_lifetime": 323190, "diff_num_grad_updates_vs_sampler_policy": 46.0, "num_module_steps_trained": 35910, "use_intrinsic_rewards": 1.0}, "intrinsic_reward_module": {"weights_seq_no": 54.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 323190, "diff_num_grad_updates_vs_sampler_policy": 46.0, "module_train_batch_size_mean": 997.5505482791133, "total_loss": 0.0}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 646380, "num_env_steps_trained_lifetime": 1944000, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 44110.163560095454}}}, "IntrinsicAttentionMask": [[[0.1666635274887085, 0.1669473648071289, 0.16620494425296783, 0.16523398458957672, 0.16796573996543884, 0.16698451340198517], [0.1666620671749115, 0.1670178920030594, 0.16608746349811554, 0.1648722141981125, 0.16829587519168854, 0.16706447303295135], [0.16666530072689056, 0.16683261096477509, 0.16639474034309387, 0.1658208966255188, 0.16743193566799164, 0.16685450077056885], [0.16666682064533234, 0.16658659279346466, 0.16679678857326508, 0.16707350313663483, 0.1663002222776413, 0.16657611727714539], [0.16665469110012054, 0.16726811230182648, 0.16566617786884308, 0.1635836660861969, 0.1694789081811905, 0.1673484593629837], [0.1666618436574936, 0.16702711582183838, 0.16607210040092468, 0.1648249626159668, 0.1683390587568283, 0.16707491874694824]], [[0.1668606549501419, 0.1668587327003479, 0.1662895232439041, 0.16649268567562103, 0.16664738953113556, 0.1668509840965271], [0.1668529510498047, 0.16685108840465546, 0.16630451381206512, 0.16649961471557617, 0.16664816439151764, 0.16684366762638092], [0.1645761877298355, 0.16459670662879944, 0.17076018452644348, 0.16853183507919312, 0.16685621440410614, 0.16467881202697754], [0.16539053618907928, 0.16540312767028809, 0.16915909945964813, 0.16780735552310944, 0.1667862981557846, 0.16545352339744568], [0.16600941121578217, 0.16601592302322388, 0.16794784367084503, 0.1672549843788147, 0.16672982275485992, 0.16604198515415192], [0.1668221354484558, 0.16682058572769165, 0.16636444628238678, 0.16652728617191315, 0.16665126383304596, 0.166814386844635]], [[0.1689569652080536, 0.1671053022146225, 0.16387709975242615, 0.1657276451587677, 0.16715773940086365, 0.16717521846294403], [0.16789239645004272, 0.16690348088741302, 0.1651671975851059, 0.16616444289684296, 0.16693156957626343, 0.16694092750549316], [0.1660165935754776, 0.16653910279273987, 0.1674681007862091, 0.16693271696567535, 0.16652421653270721, 0.16651923954486847], [0.16709499061107635, 0.1667499542236328, 0.16614094376564026, 0.16649124026298523, 0.16675977408885956, 0.1667630523443222], [0.16792266070842743, 0.16690927743911743, 0.1651303619146347, 0.16615203022956848, 0.16693805158138275, 0.1669476330280304], [0.16793273389339447, 0.16691119968891144, 0.16511806845664978, 0.1661478877067566, 0.16694019734859467, 0.16694986820220947]], [[0.1665925532579422, 0.16659878194332123, 0.1671113520860672, 0.16711759567260742, 0.16595609486103058, 0.16662369668483734], [0.16659162938594818, 0.16659793257713318, 0.16711682081222534, 0.16712313890457153, 0.1659473478794098, 0.16662314534187317], [0.16651570796966553, 0.16652831435203552, 0.16756696999073029, 0.16757965087890625, 0.1652306169271469, 0.1665787398815155], [0.1665147840976715, 0.16652746498584747, 0.16757245361804962, 0.16758520901203156, 0.1652219146490097, 0.16657818853855133], [0.16668584942817688, 0.16668421030044556, 0.16655083000659943, 0.1665491908788681, 0.1668522208929062, 0.16667772829532623], [0.1665879487991333, 0.16659456491470337, 0.1671387404203415, 0.16714537143707275, 0.16591240465641022, 0.16662102937698364]], [[0.16864781081676483, 0.16679953038692474, 0.16540710628032684, 0.1654244065284729, 0.16685187816619873, 0.16686932742595673], [0.16772669553756714, 0.16673876345157623, 0.1659911423921585, 0.16600044071674347, 0.16676682233810425, 0.1667761653661728], [0.16702833771705627, 0.16669154167175293, 0.16643577814102173, 0.1664389669895172, 0.16670110821723938, 0.16670431196689606], [0.16703703999519348, 0.1666921228170395, 0.16643023490905762, 0.16643349826335907, 0.16670194268226624, 0.1667052060365677], [0.16775287687778473, 0.1667405217885971, 0.16597449779510498, 0.16598403453826904, 0.16676926612854004, 0.1667788326740265], [0.16776157915592194, 0.16674108803272247, 0.16596893966197968, 0.1659785509109497, 0.1667700558900833, 0.16677971184253693]], [[0.1668606549501419, 0.1668587327003479, 0.16649460792541504, 0.1662876009941101, 0.16664738953113556, 0.1668509840965271], [0.1668529510498047, 0.16685108840465546, 0.1665014624595642, 0.1663026660680771, 0.16664816439151764, 0.16684366762638092], [0.1653982549905777, 0.16541077196598053, 0.16778776049613953, 0.1691567450761795, 0.1667856127023697, 0.16546086966991425], [0.16456842422485352, 0.1645890325307846, 0.1685175895690918, 0.17079676687717438, 0.1668568104505539, 0.1646714210510254], [0.16600942611694336, 0.16601593792438507, 0.1672484278678894, 0.1679544448852539, 0.16672983765602112, 0.16604198515415192], [0.16682212054729462, 0.16682057082653046, 0.16652880609035492, 0.16636288166046143, 0.16665124893188477, 0.16681437194347382]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "env_to_module_connector": {"connector_pipeline_timer": 5.993023511498744e-05, "timers": {"connectors": {"batch_individual_items": 1.2546769078565963e-05, "numpy_to_tensor": 1.2599262480538221e-05, "add_observations_from_episodes_to_batch": 2.8590406217774733e-06, "add_states_from_episodes_to_batch": 2.7032444866615522e-06, "add_time_dim_to_batch_and_zero_pad": 7.03455465603714e-06}}}, "weights_seq_no": 9.0, "rlmodule_inference_timer": 3.250798204476968e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.178163084615117e-05, "tensor_to_numpy": 1.648463302469052e-05, "normalize_and_clip_actions": 7.930252892429681e-06, "get_actions": 3.842627316093921e-05, "listify_data_for_vector_env": 1.0580835841768252e-05, "un_batch_to_individual_items": 6.859869842944347e-06}}, "connector_pipeline_timer": 0.00011863505791921405}, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 45400, "num_episodes_lifetime": 180, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "sample": 0.12213397821758344, "episode_duration_sec_mean": 0.005578863335540518, "module_episode_returns_mean": {"default_policy": -0.4}, "episode_len_max": 20, "episode_len_min": 20, "episode_return_max": 12.5, "env_step_timer": 1.445774416867657e-05, "episode_return_min": -12.5, "episode_return_mean": -0.4, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.0005241821724154157, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -0.4}, "time_between_sampling": 10.888763389710617}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "ae8f9_00000", "date": "2025-08-11_18-16-00", "timestamp": 1754928960, "time_this_iter_s": 10.126893043518066, "time_total_s": 98.07426452636719, "pid": 10547, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3849f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 98.07426452636719, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 42.528571428571425, "ram_util_percent": 79.8714285714286}}
{"timers": {"training_iteration": 10.969677252251389, "restore_env_runners": 1.1222389150209758e-05, "training_step": 10.9695130121553, "env_runner_sampling_timer": 1.8522418075629474, "learner_update_timer": 8.908242731708421, "synch_weights": 0.0014529559715238671, "restore_eval_env_runners": 1.631954173277792e-05, "evaluation_iteration": 0.1328890900835684, "synch_eval_env_connectors": 0.0001737168147954881, "synch_env_connectors": 5.678192989698451e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.0472119378093618e-05, "add_observations_from_episodes_to_batch": 4.185145061394298e-06, "add_states_from_episodes_to_batch": 4.06541336499418e-06, "batch_individual_items": 2.077755976605604e-05, "numpy_to_tensor": 2.086118335905645e-05}}, "connector_pipeline_timer": 9.19335566607495e-05}, "episode_len_mean": 20.0, "sample": 0.007624491064659866, "weights_seq_no": 9.0, "episode_duration_sec_mean": 0.008455371532123532, "episode_len_max": 20, "rlmodule_inference_timer": 5.5718771677482376e-05, "module_to_env_connector": {"connector_pipeline_timer": 0.00018807557695898713, "timers": {"connectors": {"tensor_to_numpy": 2.3832205021099383e-05, "listify_data_for_vector_env": 1.597601498238965e-05, "normalize_and_clip_actions": 1.1633204172262732e-05, "get_actions": 7.207188839943443e-05, "remove_single_ts_time_rank_from_batch": 1.717301364840039e-05, "un_batch_to_individual_items": 9.146476634001888e-06}}}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 5.865133098857787e-05, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_return_max": 9.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 2.379999999999999}, "env_step_timer": 2.2316395369643554e-05, "agent_episode_returns_mean": {"default_agent": 2.379999999999999}, "time_between_sampling": 0.03559899586194898, "num_env_steps_sampled_lifetime": -4930000.0, "num_episodes_lifetime": -246500.0, "episode_return_min": -10.5, "episode_return_mean": 2.379999999999999, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 2551.585793042699}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.16884257781686088, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009371043841492501, "add_observations_from_episodes_to_batch": 0.0008647299894681298, "add_columns_from_episodes_to_train_batch": 0.04339074624528955, "add_time_dim_to_batch_and_zero_pad": 0.1020275115176709, "add_states_from_episodes_to_batch": 0.003956495755970339, "batch_individual_items": 0.008918424948308494, "numpy_to_tensor": 8.387504657763238e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"vf_explained_var": 0.00038689374923706055, "vf_loss_unclipped": 41.47823715209961, "module_train_batch_size_mean": 998.3173215714437, "policy_loss": -5.158140629646368e-05, "mean_kl_loss": 2.0579689419264469e-07, "entropy": 0.6849457025527954, "num_module_steps_trained": 5985, "curr_kl_coeff": 0.00015779680688865483, "curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.32051321864128113, "num_module_steps_trained_lifetime": 59850, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.24858760833740234, "num_trainable_parameters": 16595, "weights_seq_no": 10.0, "num_module_steps_trained_lifetime_throughput": 653.7448705790489}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.3173215714437, "total_loss": 0.0, "weights_seq_no": 10.0, "curr_entropy_coeff": 0.0015431216992, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 59850, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 653.7530814753244}, "__all_modules__": {"num_module_steps_trained_lifetime": 119700, "num_env_steps_trained_lifetime": 360000, "num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained": 36000, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 3936.1690679752846, "num_module_steps_trained_throughput": 23111448.411714833, "num_module_steps_trained_lifetime_throughput": 10897298.21336477}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_explained_var": -0.0016611814498901367, "vf_loss_unclipped": 41.61111068725586, "module_train_batch_size_mean": 997.532914147147, "total_loss": 0.24869559705257416, "mean_kl_loss": 1.5168492950579093e-07, "weights_seq_no": 60.0, "entropy": 0.6849623918533325, "vf_loss": 0.32064566016197205, "policy_loss": -4.676575554185547e-05, "num_module_steps_trained_lifetime": 359100, "diff_num_grad_updates_vs_sampler_policy": 51.0, "num_module_steps_trained": 35910, "use_intrinsic_rewards": 1.0}, "intrinsic_reward_module": {"weights_seq_no": 60.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 359100, "diff_num_grad_updates_vs_sampler_policy": 51.0, "module_train_batch_size_mean": 997.532914147147, "total_loss": 0.0}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 718200, "num_env_steps_trained_lifetime": 2160000, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 43521.44149307536}}}, "IntrinsicAttentionMask": [[[0.1683274358510971, 0.16648267209529877, 0.16326649487018585, 0.16511015594005585, 0.16839787364006042, 0.16841548681259155], [0.16755779087543488, 0.16657085716724396, 0.1648380011320114, 0.1658332645893097, 0.16759535670280457, 0.16760475933551788], [0.16619189083576202, 0.16671495139598846, 0.1676449328660965, 0.16710898280143738, 0.1661720722913742, 0.16616711020469666], [0.16697868704795837, 0.16663388907909393, 0.1660252958536148, 0.16637535393238068, 0.16699178516864777, 0.1669950634241104], [0.16835659742355347, 0.1664792001247406, 0.1632070094347, 0.165082648396492, 0.16842828691005707, 0.16844621300697327], [0.16836389899253845, 0.16647833585739136, 0.16319213807582855, 0.16507576406002045, 0.16843590140342712, 0.1684539020061493]], [[0.16661934554576874, 0.1666233092546463, 0.16694889962673187, 0.1673753559589386, 0.16621455550193787, 0.16621850430965424], [0.1666184365749359, 0.16662247478961945, 0.16695436835289001, 0.1673891246318817, 0.16620580852031708, 0.1662098467350006], [0.16654106974601746, 0.1665513962507248, 0.16740261018276215, 0.16852164268493652, 0.16548652946949005, 0.1654967963695526], [0.16643621027469635, 0.1664547622203827, 0.1679864227771759, 0.17000941932201385, 0.16454742848873138, 0.1645657867193222], [0.16671225428581238, 0.16670836508274078, 0.16638851165771484, 0.16597141325473785, 0.16711167991161346, 0.16710777580738068], [0.16671137511730194, 0.16670754551887512, 0.16639399528503418, 0.1659850925207138, 0.16710291802883148, 0.16709908843040466]], [[0.16802054643630981, 0.16617915034294128, 0.16479188203811646, 0.16480912268161774, 0.1680908501148224, 0.16810843348503113], [0.16739274561405182, 0.1664067804813385, 0.16566063463687897, 0.16566991806030273, 0.16743028163909912, 0.16743966937065125], [0.16691480576992035, 0.1665782332420349, 0.16632264852523804, 0.16632583737373352, 0.16692760586738586, 0.16693079471588135], [0.16692078113555908, 0.16657611727714539, 0.16631440818309784, 0.1663176715373993, 0.16693387925624847, 0.16693715751171112], [0.16804438829421997, 0.16617046296596527, 0.16475895047187805, 0.1647764891386032, 0.16811594367027283, 0.16813382506370544], [0.16805031895637512, 0.16616827249526978, 0.16475069522857666, 0.16476832330226898, 0.16812218725681305, 0.16814015805721283]], [[0.1664808839559555, 0.16582626104354858, 0.16766487061977386, 0.16767114400863647, 0.1658448576927185, 0.16651202738285065], [0.16672131419181824, 0.16691690683364868, 0.16637010872364044, 0.1663682609796524, 0.16691133379936218, 0.16671204566955566], [0.16603471338748932, 0.1638680398464203, 0.1700042337179184, 0.17002542316913605, 0.16392932832241058, 0.16613824665546417], [0.1660323143005371, 0.16385772824287415, 0.1700166016817093, 0.1700378805398941, 0.16391924023628235, 0.1661362200975418], [0.16671456396579742, 0.1668858379125595, 0.16640691459178925, 0.16640529036521912, 0.16688095033168793, 0.16670642793178558], [0.16646933555603027, 0.16577452421188354, 0.16772641241550446, 0.1677330732345581, 0.1657942682504654, 0.16650238633155823]], [[0.1666618138551712, 0.16793599724769592, 0.1652231067419052, 0.16523228585720062, 0.16796401143074036, 0.16698278486728668], [0.16664719581604004, 0.16937819123268127, 0.1635918915271759, 0.1636113077402115, 0.16943851113319397, 0.16733291745185852], [0.1666666716337204, 0.16629743576049805, 0.16708798706531525, 0.16708527505397797, 0.16628935933113098, 0.16657331585884094], [0.1666666716337204, 0.16630792617797852, 0.1670759916305542, 0.16707336902618408, 0.16630007326602936, 0.16657596826553345], [0.16664674878120422, 0.16940979659557343, 0.16355623304843903, 0.16357585787773132, 0.16947083175182343, 0.167340487241745], [0.16665902733802795, 0.1683000922203064, 0.1648103892803192, 0.16482217609882355, 0.16833621263504028, 0.1670720875263214]], [[0.1668606549501419, 0.1668587327003479, 0.16649460792541504, 0.1662876009941101, 0.1668529212474823, 0.16664546728134155], [0.1668529510498047, 0.16685108840465546, 0.1665014624595642, 0.1663026511669159, 0.16684551537036896, 0.1666463166475296], [0.1653982400894165, 0.16541075706481934, 0.16778774559497833, 0.1691567301750183, 0.16544832289218903, 0.16679821908473969], [0.16456837952136993, 0.16458897292613983, 0.16851752996444702, 0.1707967072725296, 0.16465076804161072, 0.1668776422739029], [0.16682982444763184, 0.1668282002210617, 0.16652196645736694, 0.16634781658649445, 0.16682332754135132, 0.16664884984493256], [0.16600169241428375, 0.16600827872753143, 0.167255237698555, 0.16796958446502686, 0.16602805256843567, 0.1667371541261673]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "env_to_module_connector": {"connector_pipeline_timer": 5.884322778681096e-05, "timers": {"connectors": {"batch_individual_items": 1.2354744714467222e-05, "numpy_to_tensor": 1.1959588994419648e-05, "add_observations_from_episodes_to_batch": 2.7926368764996725e-06, "add_states_from_episodes_to_batch": 2.621428820889581e-06, "add_time_dim_to_batch_and_zero_pad": 7.165969973610529e-06}}}, "weights_seq_no": 10.0, "rlmodule_inference_timer": 3.237096775253666e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1702414346191615e-05, "tensor_to_numpy": 1.5251231555994233e-05, "normalize_and_clip_actions": 7.805577243304494e-06, "get_actions": 3.699305920339556e-05, "listify_data_for_vector_env": 1.0480050074829968e-05, "un_batch_to_individual_items": 6.574361178370673e-06}}, "connector_pipeline_timer": 0.00011468680166528748}, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 50400, "num_episodes_lifetime": 200, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "sample": 0.12209598677538994, "episode_duration_sec_mean": 0.0056276966526638715, "module_episode_returns_mean": {"default_policy": -0.6}, "episode_len_max": 20, "episode_len_min": 20, "episode_return_max": 12.5, "env_step_timer": 1.403896497694988e-05, "episode_return_min": -12.5, "episode_return_mean": -0.6, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.0005222178506184694, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -0.6}, "time_between_sampling": 10.905564624562931}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "ae8f9_00000", "date": "2025-08-11_18-16-13", "timestamp": 1754928973, "time_this_iter_s": 12.67259407043457, "time_total_s": 110.74685859680176, "pid": 10547, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3849f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 110.74685859680176, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 51.194444444444436, "ram_util_percent": 80.29444444444444}}
{"timers": {"training_iteration": 10.968321232228517, "restore_env_runners": 1.1253075543629187e-05, "training_step": 10.968156150364301, "env_runner_sampling_timer": 1.8544589474073416, "learner_update_timer": 8.904518836061982, "synch_weights": 0.0014523668311118816, "restore_eval_env_runners": 1.6705925587496828e-05, "evaluation_iteration": 0.1328291762632045, "synch_eval_env_connectors": 0.0001737063163725639, "synch_env_connectors": 5.666830497612245e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 8.483787628781864e-06, "add_observations_from_episodes_to_batch": 3.4627307288312277e-06, "add_states_from_episodes_to_batch": 3.2047716646163943e-06, "batch_individual_items": 1.6281370976935673e-05, "numpy_to_tensor": 4.1818789376784944e-05}}, "connector_pipeline_timer": 9.828635097716258e-05}, "episode_len_mean": 20.0, "sample": 0.007814067034771258, "weights_seq_no": 10.0, "episode_duration_sec_mean": 0.007288746186066421, "episode_len_max": 20, "rlmodule_inference_timer": 4.410017726684534e-05, "module_to_env_connector": {"connector_pipeline_timer": 0.00014671262937791379, "timers": {"connectors": {"tensor_to_numpy": 1.9362382317232386e-05, "listify_data_for_vector_env": 1.2431154237021748e-05, "normalize_and_clip_actions": 9.319752946569444e-06, "get_actions": 5.155938001987486e-05, "remove_single_ts_time_rank_from_batch": 1.4151044848822163e-05, "un_batch_to_individual_items": 7.480293916055655e-06}}}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 5.291712959966806e-05, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_return_max": 9.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 1.0199999999999996}, "env_step_timer": 1.7891848126977244e-05, "agent_episode_returns_mean": {"default_agent": 1.0199999999999996}, "time_between_sampling": 0.040627324660690536, "num_env_steps_sampled_lifetime": -5547500.0, "num_episodes_lifetime": -277375.0, "episode_return_min": -10.5, "episode_return_mean": 1.0199999999999996, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3043.825865028586}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.16883454953827778, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009382279653872033, "add_observations_from_episodes_to_batch": 0.0008649789400840367, "add_columns_from_episodes_to_train_batch": 0.04339876169264966, "add_time_dim_to_batch_and_zero_pad": 0.10198971515243249, "add_states_from_episodes_to_batch": 0.003964303298822802, "batch_individual_items": 0.00892131194820798, "numpy_to_tensor": 8.387963664284761e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"vf_explained_var": 0.0009496212005615234, "vf_loss_unclipped": 41.533363342285156, "module_train_batch_size_mean": 998.2690509307901, "policy_loss": -0.00013530506112147123, "mean_kl_loss": 2.3125321604311466e-05, "entropy": 0.683984637260437, "num_module_steps_trained": 5985, "curr_kl_coeff": 7.889840344432741e-05, "curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.3205154240131378, "num_module_steps_trained_lifetime": 65835, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.24850711226463318, "num_trainable_parameters": 16595, "weights_seq_no": 11.0, "num_module_steps_trained_lifetime_throughput": 652.1845918514168}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.2690509307901, "total_loss": 0.0, "weights_seq_no": 11.0, "curr_entropy_coeff": 0.0015431216992, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 65835, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 652.1923143779111}, "__all_modules__": {"num_module_steps_trained_lifetime": 131670, "num_env_steps_trained_lifetime": 396000, "num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained": 36000, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 3926.635351532821, "num_module_steps_trained_throughput": 22529154.176454082, "num_module_steps_trained_lifetime_throughput": 10947971.220161175}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_explained_var": -0.0016155242919921875, "vf_loss_unclipped": 41.66505813598633, "module_train_batch_size_mean": 997.5206335045569, "total_loss": 0.24859625101089478, "mean_kl_loss": 2.260875226056669e-05, "weights_seq_no": 66.0, "entropy": 0.6839946508407593, "vf_loss": 0.32062166929244995, "policy_loss": -0.00013256072998046875, "num_module_steps_trained_lifetime": 395010, "diff_num_grad_updates_vs_sampler_policy": 56.0, "num_module_steps_trained": 35910, "use_intrinsic_rewards": 1.0}, "intrinsic_reward_module": {"weights_seq_no": 66.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 395010, "diff_num_grad_updates_vs_sampler_policy": 56.0, "module_train_batch_size_mean": 997.5206335045569, "total_loss": 0.0}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 790020, "num_env_steps_trained_lifetime": 2376000, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 42936.882904730504}}}, "IntrinsicAttentionMask": [[[0.16895081102848053, 0.1670992076396942, 0.16387110948562622, 0.16388824582099915, 0.16902150213718414, 0.16716912388801575], [0.16789063811302185, 0.16690173745155334, 0.16516545414924622, 0.1651747226715088, 0.1679282933473587, 0.1669391691684723], [0.1660161018371582, 0.16653861105442047, 0.1674676090478897, 0.16746261715888977, 0.16599629819393158, 0.16651874780654907], [0.16602614521980286, 0.16654060781002045, 0.16745522618293762, 0.16745030879974365, 0.1660066545009613, 0.16652104258537292], [0.1689910590648651, 0.16710658371448517, 0.16382205486297607, 0.16383948922157288, 0.1690630167722702, 0.1671777367591858], [0.16793087124824524, 0.1669093519449234, 0.16511625051498413, 0.16512581706047058, 0.16796977818012238, 0.16694802045822144]], [[0.1664789915084839, 0.16606271266937256, 0.16723038256168365, 0.1672343611717224, 0.16649481654167175, 0.16649878025054932], [0.16686128079891205, 0.1672971397638321, 0.16608016192913055, 0.16607606410980225, 0.16684475541114807, 0.16684062778949738], [0.1657821089029312, 0.16385389864444733, 0.1693076342344284, 0.16932643949985504, 0.1658557653427124, 0.165874183177948], [0.16577839851379395, 0.16384227573871613, 0.16931861639022827, 0.16933749616146088, 0.165852352976799, 0.16587084531784058], [0.1664644032716751, 0.16601593792438507, 0.1672741025686264, 0.16727839410305023, 0.16648145020008087, 0.1664857119321823], [0.16646075248718262, 0.1660042405128479, 0.16728505492210388, 0.16728940606117249, 0.16647811233997345, 0.16648244857788086]], [[0.1683214157819748, 0.16833901405334473, 0.16326063871383667, 0.16327771544456482, 0.16839183866977692, 0.16840945184230804], [0.1683286428451538, 0.1683463305234909, 0.16324572265148163, 0.16326285898685455, 0.1683993935585022, 0.1684170812368393], [0.16619142889976501, 0.16618646681308746, 0.1676444560289383, 0.16763946413993835, 0.166171595454216, 0.16616664826869965], [0.16619877517223358, 0.1661939024925232, 0.16762934625148773, 0.16762441396713257, 0.16617925465106964, 0.16617438197135925], [0.16835038363933563, 0.16836829483509064, 0.1632009595632553, 0.16321833431720734, 0.16842205822467804, 0.16843998432159424], [0.16835762560367584, 0.168375626206398, 0.16318605840206146, 0.16320350766181946, 0.16842962801456451, 0.16844762861728668]], [[0.1666894555091858, 0.16627264022827148, 0.16744180023670197, 0.16702310740947723, 0.1662844866514206, 0.16628845036029816], [0.16664166748523712, 0.1670769602060318, 0.1658615916967392, 0.16629482805728912, 0.16706454753875732, 0.16706041991710663], [0.16676314175128937, 0.1648235321044922, 0.17030952870845795, 0.168328657746315, 0.16487842798233032, 0.16489674150943756], [0.16672413051128387, 0.1656295657157898, 0.16871114075183868, 0.1676035225391388, 0.16566061973571777, 0.1656709760427475], [0.16664309799671173, 0.16705407202243805, 0.16590642929077148, 0.16631560027599335, 0.16704235970973969, 0.1670384556055069], [0.16664357483386993, 0.1670464426279068, 0.1659213900566101, 0.1663225144147873, 0.16703496873378754, 0.16703112423419952]], [[0.16633568704128265, 0.1666189730167389, 0.16587801277637482, 0.1658872365951538, 0.16763533651828766, 0.167644664645195], [0.16625142097473145, 0.16660639643669128, 0.1656782329082489, 0.16568978130817413, 0.16788122057914734, 0.1678929179906845], [0.16647183895111084, 0.16663895547389984, 0.16620159149169922, 0.16620704531669617, 0.16723757982254028, 0.16724306344985962], [0.16646909713745117, 0.1666385531425476, 0.16619504988193512, 0.16620057821273804, 0.16724559664726257, 0.16725115478038788], [0.16594886779785156, 0.16655969619750977, 0.16496454179286957, 0.1649843454360962, 0.16876111924648285, 0.16878138482570648], [0.1659460961818695, 0.16655926406383514, 0.16495802998542786, 0.16497790813446045, 0.16876918077468872, 0.16878952085971832]], [[0.1665489822626114, 0.16613252460956573, 0.16730068624019623, 0.16730466485023499, 0.16656480729579926, 0.16614830493927002], [0.16678789258003235, 0.16722355782985687, 0.1660071164369583, 0.16600301861763, 0.16677136719226837, 0.1672070026397705], [0.16610561311244965, 0.16417363286018372, 0.1696380078792572, 0.16965684294700623, 0.16617940366268158, 0.1642465591430664], [0.16610322892665863, 0.16416330635547638, 0.1696503758430481, 0.1696692854166031, 0.16617731750011444, 0.16423654556274414], [0.16653981804847717, 0.16609114408493042, 0.1673498898744583, 0.16735418140888214, 0.16655687987804413, 0.1661081463098526], [0.16677893698215485, 0.16718213260173798, 0.16605617105960846, 0.16605235636234283, 0.16676364839076996, 0.1671667993068695]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "env_to_module_connector": {"connector_pipeline_timer": 6.252656119197118e-05, "timers": {"connectors": {"batch_individual_items": 1.2835658574682349e-05, "numpy_to_tensor": 1.3169224717877719e-05, "add_observations_from_episodes_to_batch": 2.881444405832428e-06, "add_states_from_episodes_to_batch": 2.8797803812266578e-06, "add_time_dim_to_batch_and_zero_pad": 7.581924148295119e-06}}}, "weights_seq_no": 11.0, "rlmodule_inference_timer": 3.464561195480202e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.232551082133407e-05, "tensor_to_numpy": 1.613989038055691e-05, "normalize_and_clip_actions": 8.171037175945346e-06, "get_actions": 4.0857786202162596e-05, "listify_data_for_vector_env": 1.096932742580847e-05, "un_batch_to_individual_items": 6.849912769680741e-06}}, "connector_pipeline_timer": 0.00012199248447142095}, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 55400, "num_episodes_lifetime": 220, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "sample": 0.1220788256582843, "episode_duration_sec_mean": 0.00549176246044226, "module_episode_returns_mean": {"default_policy": 0.0}, "episode_len_max": 20, "episode_len_min": 20, "episode_return_max": 12.5, "env_step_timer": 1.5071660293418426e-05, "episode_return_min": -12.5, "episode_return_mean": 0.0, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.0005203735918961005, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 0.0}, "time_between_sampling": 10.905261859977195}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "ae8f9_00000", "date": "2025-08-11_18-16-24", "timestamp": 1754928984, "time_this_iter_s": 10.966579914093018, "time_total_s": 121.71343851089478, "pid": 10547, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3849f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 121.71343851089478, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 46.9, "ram_util_percent": 80.625}}
{"timers": {"training_iteration": 10.974097702406455, "restore_env_runners": 1.129262510801473e-05, "training_step": 10.973930453440074, "env_runner_sampling_timer": 1.862647262932785, "learner_update_timer": 8.902127958531997, "synch_weights": 0.0014549514933038688, "restore_eval_env_runners": 1.6845116626292325e-05, "evaluation_iteration": 0.13279620867106878, "synch_eval_env_connectors": 0.000173455912957318, "synch_env_connectors": 5.656831931003323e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.112372365812021e-05, "add_observations_from_episodes_to_batch": 4.25789506635854e-06, "add_states_from_episodes_to_batch": 4.164892233649636e-06, "batch_individual_items": 2.5011742111471682e-05, "numpy_to_tensor": 2.2748657692505532e-05}}, "connector_pipeline_timer": 9.98558506935378e-05}, "episode_len_mean": 20.0, "sample": 0.010066770906523395, "weights_seq_no": 11.0, "episode_duration_sec_mean": 0.009340404160320758, "episode_len_max": 20, "rlmodule_inference_timer": 8.326205608958861e-05, "module_to_env_connector": {"connector_pipeline_timer": 0.00019576518619928714, "timers": {"connectors": {"tensor_to_numpy": 2.479503287805875e-05, "listify_data_for_vector_env": 1.673439138423028e-05, "normalize_and_clip_actions": 1.2349271006319722e-05, "get_actions": 7.665933806651287e-05, "remove_single_ts_time_rank_from_batch": 1.6558546036353248e-05, "un_batch_to_individual_items": 1.0030136449059268e-05}}}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 7.141315538011297e-05, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_return_max": 9.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 0.9399999999999996}, "env_step_timer": 2.6432964266444823e-05, "agent_episode_returns_mean": {"default_agent": 0.9399999999999996}, "time_between_sampling": 0.036722173577341026, "num_env_steps_sampled_lifetime": -6165000.0, "num_episodes_lifetime": -308250.0, "episode_return_min": -10.5, "episode_return_mean": 0.9399999999999996, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 2385.9678039882833}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.16868537821336116, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009382883107185717, "add_observations_from_episodes_to_batch": 0.0008651712308162321, "add_columns_from_episodes_to_train_batch": 0.04338146949542211, "add_time_dim_to_batch_and_zero_pad": 0.10187198133137372, "add_states_from_episodes_to_batch": 0.0039619740156154526, "batch_individual_items": 0.008909833829248707, "numpy_to_tensor": 8.37545907636126e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"vf_explained_var": 0.0009129047393798828, "vf_loss_unclipped": 41.76734161376953, "module_train_batch_size_mean": 998.2236050808158, "policy_loss": -1.9705748854903504e-05, "mean_kl_loss": 1.0881193702516612e-05, "entropy": 0.6833096742630005, "num_module_steps_trained": 5985, "curr_kl_coeff": 3.944920172216371e-05, "curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.3205133080482483, "num_module_steps_trained_lifetime": 71820, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.2486221045255661, "num_trainable_parameters": 16595, "weights_seq_no": 12.0, "num_module_steps_trained_lifetime_throughput": 650.6870170258214}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.2236050808158, "total_loss": 0.0, "weights_seq_no": 12.0, "curr_entropy_coeff": 0.0015431216992, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 71820, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 650.6943086980422}, "__all_modules__": {"num_module_steps_trained_lifetime": 143640, "num_env_steps_trained_lifetime": 432000, "num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained": 36000, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 3917.4836135352666, "num_module_steps_trained_throughput": 21974730.612209987, "num_module_steps_trained_lifetime_throughput": 10992355.600570166}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_explained_var": -0.0016183853149414062, "vf_loss_unclipped": 41.89339828491211, "module_train_batch_size_mean": 997.512081102731, "total_loss": 0.248694509267807, "mean_kl_loss": 1.0857130291697104e-05, "weights_seq_no": 72.0, "entropy": 0.6833102703094482, "vf_loss": 0.3206031322479248, "policy_loss": -1.9040287952520885e-05, "num_module_steps_trained_lifetime": 430920, "diff_num_grad_updates_vs_sampler_policy": 61.0, "num_module_steps_trained": 35910, "use_intrinsic_rewards": 1.0}, "intrinsic_reward_module": {"weights_seq_no": 72.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 430920, "diff_num_grad_updates_vs_sampler_policy": 61.0, "module_train_batch_size_mean": 997.512081102731, "total_loss": 0.0}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 861840, "num_env_steps_trained_lifetime": 2592000, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 42375.16525412528}}}, "IntrinsicAttentionMask": [[[0.1666652262210846, 0.1669490784406662, 0.16620664298534393, 0.16621588170528412, 0.1669769287109375, 0.16698621213436127], [0.16666476428508759, 0.16702061891555786, 0.16609016060829163, 0.16610172390937805, 0.16705554723739624, 0.16706718504428864], [0.1666659116744995, 0.16683322191238403, 0.16639533638954163, 0.16640079021453857, 0.16684962809085846, 0.1668550968170166], [0.16666589677333832, 0.16683556139469147, 0.1663915514945984, 0.1663970798254013, 0.166852205991745, 0.1668577492237091], [0.166664719581604, 0.16702763736248016, 0.16607874631881714, 0.16609054803848267, 0.16706325113773346, 0.16707512736320496], [0.16666468977928162, 0.1670299619436264, 0.1660749316215515, 0.166086807847023, 0.1670658141374588, 0.16707776486873627]], [[0.1668606549501419, 0.16665318608283997, 0.16649460792541504, 0.1662876009941101, 0.1668529212474823, 0.1668509840965271], [0.1660325676202774, 0.16670872271060944, 0.16722795367240906, 0.16790898144245148, 0.16605770587921143, 0.16606399416923523], [0.16539829969406128, 0.1667477935552597, 0.1677878051996231, 0.16915678977966309, 0.1654483824968338, 0.16546091437339783], [0.16456855833530426, 0.1667943298816681, 0.16851772367954254, 0.17079690098762512, 0.16465094685554504, 0.16467155516147614], [0.16682982444763184, 0.16665534675121307, 0.16652196645736694, 0.16634781658649445, 0.16682332754135132, 0.16682168841362], [0.16682212054729462, 0.16665589809417725, 0.16652880609035492, 0.16636288166046143, 0.16681592166423798, 0.16681437194347382]], [[0.16864162683486938, 0.16679342091083527, 0.16540104150772095, 0.16358834505081177, 0.16684575378894806, 0.16872984170913696], [0.16772493720054626, 0.16673700511455536, 0.16598938405513763, 0.1650116890668869, 0.16676504909992218, 0.16777195036411285], [0.16702812910079956, 0.16669133305549622, 0.16643556952476501, 0.16609996557235718, 0.16670091450214386, 0.16704413294792175], [0.16611288487911224, 0.16662761569023132, 0.16702024638652802, 0.16753779351711273, 0.16661295294761658, 0.1660885065793991], [0.1677509993314743, 0.16673865914344788, 0.16597265005111694, 0.16497103869915009, 0.16676738858222961, 0.1677991896867752], [0.16868513822555542, 0.1667959839105606, 0.1653730720281601, 0.16352100670337677, 0.16684947907924652, 0.16877532005310059]], [[0.16659176349639893, 0.16659799218177795, 0.16711056232452393, 0.16778281331062317, 0.1659553050994873, 0.16596151888370514], [0.1665908247232437, 0.1665971428155899, 0.16711603105068207, 0.16779659688472748, 0.16594655811786652, 0.16595283150672913], [0.16651256382465363, 0.16652517020702362, 0.167563796043396, 0.16893094778060913, 0.1652274876832962, 0.16524000465869904], [0.1664065420627594, 0.1664273738861084, 0.1681469827890396, 0.17042113840579987, 0.1642887145280838, 0.16430926322937012], [0.1666857749223709, 0.1666841357946396, 0.16655075550079346, 0.16637656092643738, 0.16685214638710022, 0.1668505221605301], [0.16668489575386047, 0.1666833460330963, 0.1665562391281128, 0.1663902848958969, 0.16684339940547943, 0.16684184968471527]], [[0.1666618138551712, 0.16793598234653473, 0.1652231067419052, 0.16523228585720062, 0.16796401143074036, 0.16698278486728668], [0.16664719581604004, 0.16937819123268127, 0.1635918915271759, 0.1636113077402115, 0.16943851113319397, 0.16733291745185852], [0.1666666716337204, 0.16629743576049805, 0.16708798706531525, 0.16708527505397797, 0.16628935933113098, 0.16657331585884094], [0.1666666716337204, 0.16630792617797852, 0.1670759916305542, 0.16707336902618408, 0.16630007326602936, 0.16657596826553345], [0.16664674878120422, 0.16940979659557343, 0.16355623304843903, 0.16357585787773132, 0.16947083175182343, 0.167340487241745], [0.16665902733802795, 0.1683000922203064, 0.1648103892803192, 0.16482217609882355, 0.16833621263504028, 0.1670720875263214]], [[0.16689488291740417, 0.16689294576644897, 0.16632363200187683, 0.16632170975208282, 0.16688714921474457, 0.16667965054512024], [0.16688582301139832, 0.16688396036624908, 0.1663372814655304, 0.16633541882038116, 0.16687838733196259, 0.16667914390563965], [0.16420674324035645, 0.1642272174358368, 0.17037686705589294, 0.17039810121059418, 0.16428865492343903, 0.16650240123271942], [0.1641976535320282, 0.16421820223331451, 0.17039063572883606, 0.17041195929050446, 0.16427986323833466, 0.1665017157793045], [0.16685861349105835, 0.16685698926448822, 0.16637814044952393, 0.1663765162229538, 0.16685210168361664, 0.16667760908603668], [0.16588430106639862, 0.1658908873796463, 0.16784414649009705, 0.1678508073091507, 0.16591064631938934, 0.16661925613880157]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "env_to_module_connector": {"connector_pipeline_timer": 6.736983700366719e-05, "timers": {"connectors": {"batch_individual_items": 1.4273190145726953e-05, "numpy_to_tensor": 1.3834023524473548e-05, "add_observations_from_episodes_to_batch": 3.215065567086765e-06, "add_states_from_episodes_to_batch": 2.9622520623369065e-06, "add_time_dim_to_batch_and_zero_pad": 8.11889773516168e-06}}}, "weights_seq_no": 12.0, "rlmodule_inference_timer": 3.759054903774294e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.3064171522243258e-05, "tensor_to_numpy": 1.711627808677129e-05, "normalize_and_clip_actions": 8.456643606618795e-06, "get_actions": 4.344234108433425e-05, "listify_data_for_vector_env": 1.1384544066570799e-05, "un_batch_to_individual_items": 6.991692090268412e-06}}, "connector_pipeline_timer": 0.00012831271423517383}, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 60400, "num_episodes_lifetime": 240, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "sample": 0.12219245656254994, "episode_duration_sec_mean": 0.005580007033422589, "module_episode_returns_mean": {"default_policy": -0.4}, "episode_len_max": 20, "episode_len_min": 20, "episode_return_max": 12.5, "env_step_timer": 1.6046962091711974e-05, "episode_return_min": -12.5, "episode_return_mean": -0.4, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.0005189794356252169, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -0.4}, "time_between_sampling": 10.911993843457662}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "ae8f9_00000", "date": "2025-08-11_18-16-35", "timestamp": 1754928995, "time_this_iter_s": 11.691851139068604, "time_total_s": 133.40528964996338, "pid": 10547, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3849f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 133.40528964996338, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 50.46875, "ram_util_percent": 81.0875}}
{"timers": {"training_iteration": 10.976780134552397, "restore_env_runners": 1.1322618455081856e-05, "training_step": 10.976612116405166, "env_runner_sampling_timer": 1.861768487804202, "learner_update_timer": 8.90570147936585, "synch_weights": 0.0014573836385264095, "restore_eval_env_runners": 1.712208561533109e-05, "evaluation_iteration": 0.13289382200392003, "synch_eval_env_connectors": 0.00017342968348297484, "synch_env_connectors": 5.637343055848387e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.377288865414276e-06, "add_observations_from_episodes_to_batch": 2.9535408474864928e-06, "add_states_from_episodes_to_batch": 2.924088227298928e-06, "batch_individual_items": 1.3005249367663034e-05, "numpy_to_tensor": 1.3636492503274294e-05}}, "connector_pipeline_timer": 6.279343770770686e-05}, "episode_len_mean": 20.0, "sample": 0.0070360284669802094, "weights_seq_no": 12.0, "episode_duration_sec_mean": 0.005595547669567166, "episode_len_max": 20, "rlmodule_inference_timer": 3.449356787929593e-05, "module_to_env_connector": {"connector_pipeline_timer": 0.00012557023273907352, "timers": {"connectors": {"tensor_to_numpy": 1.6404780631346505e-05, "listify_data_for_vector_env": 1.1223474053254756e-05, "normalize_and_clip_actions": 8.40599809418875e-06, "get_actions": 4.3015617948874905e-05, "remove_single_ts_time_rank_from_batch": 1.2254665112903179e-05, "un_batch_to_individual_items": 6.847858564310907e-06}}}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 5.6856659184038496e-05, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_return_max": 9.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 1.9}, "env_step_timer": 1.4705145447675743e-05, "agent_episode_returns_mean": {"default_agent": 1.9}, "time_between_sampling": 0.03720494781985765, "num_env_steps_sampled_lifetime": -6782500.0, "num_episodes_lifetime": -339125.0, "episode_return_min": -10.5, "episode_return_mean": 1.9, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3046.409105817758}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1685575494315427, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009379832196672908, "add_observations_from_episodes_to_batch": 0.0008651765983965775, "add_columns_from_episodes_to_train_batch": 0.04337891022043931, "add_time_dim_to_batch_and_zero_pad": 0.10175891318707796, "add_states_from_episodes_to_batch": 0.003961341776052364, "batch_individual_items": 0.008902110911515418, "numpy_to_tensor": 8.375079509275592e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"vf_explained_var": 0.0007176995277404785, "vf_loss_unclipped": 40.44845962524414, "module_train_batch_size_mean": 998.1808187151925, "policy_loss": 0.00011265529610682279, "mean_kl_loss": 1.8997716324520297e-05, "entropy": 0.6828945875167847, "num_module_steps_trained": 5985, "curr_kl_coeff": 1.9724600861081854e-05, "curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.320512056350708, "num_module_steps_trained_lifetime": 77805, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.24875414371490479, "num_trainable_parameters": 16595, "weights_seq_no": 13.0, "num_module_steps_trained_lifetime_throughput": 648.9708508832942}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.1808187151925, "total_loss": 0.0, "weights_seq_no": 13.0, "curr_entropy_coeff": 0.0015431216992, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 77805, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 648.9777189566925}, "__all_modules__": {"num_module_steps_trained_lifetime": 155610, "num_env_steps_trained_lifetime": 468000, "num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained": 36000, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 3907.017107612004, "num_module_steps_trained_throughput": 21461823.86262504, "num_module_steps_trained_lifetime_throughput": 11049799.50118108}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_explained_var": -0.0017323493957519531, "vf_loss_unclipped": 40.63932418823242, "module_train_batch_size_mean": 997.5061250970534, "total_loss": 0.24883010983467102, "mean_kl_loss": 1.963358408829663e-05, "weights_seq_no": 78.0, "entropy": 0.6828797459602356, "vf_loss": 0.32060062885284424, "policy_loss": 0.00011647804058156908, "num_module_steps_trained_lifetime": 466830, "diff_num_grad_updates_vs_sampler_policy": 66.0, "num_module_steps_trained": 35910, "use_intrinsic_rewards": 1.0}, "intrinsic_reward_module": {"weights_seq_no": 78.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 466830, "diff_num_grad_updates_vs_sampler_policy": 66.0, "module_train_batch_size_mean": 997.5061250970534, "total_loss": 0.0}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 933660, "num_env_steps_trained_lifetime": 2808000, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 41834.32242298585}}}, "IntrinsicAttentionMask": [[[0.1664985716342926, 0.16678214073181152, 0.16604043543338776, 0.16507045924663544, 0.16779950261116028, 0.16780883073806763], [0.16645513474941254, 0.166810542345047, 0.16588124632835388, 0.1646675169467926, 0.1680869311094284, 0.16809864342212677], [0.16656821966171265, 0.1667354255914688, 0.1662978231906891, 0.16572429239749908, 0.1673344075679779, 0.16733989119529724], [0.16671323776245117, 0.1666329950094223, 0.1668432503938675, 0.1671200394630432, 0.16634653508663177, 0.16634391248226166], [0.16629700362682343, 0.1669091135263443, 0.16531062126159668, 0.16323256492614746, 0.16911515593528748, 0.1691354662179947], [0.16629557311534882, 0.16691000759601593, 0.16530540585517883, 0.16321949660778046, 0.16912458837032318, 0.16914497315883636]], [[0.1664808839559555, 0.16582626104354858, 0.16766487061977386, 0.16767114400863647, 0.1658448576927185, 0.16651201248168945], [0.16672131419181824, 0.16691690683364868, 0.16637010872364044, 0.1663682609796524, 0.16691133379936218, 0.16671204566955566], [0.16603471338748932, 0.1638680398464203, 0.1700042337179184, 0.17002542316913605, 0.16392932832241058, 0.16613823175430298], [0.1660323143005371, 0.16385772824287415, 0.1700166016817093, 0.1700378805398941, 0.16391922533512115, 0.1661362200975418], [0.16671456396579742, 0.1668858379125595, 0.16640691459178925, 0.16640529036521912, 0.16688095033168793, 0.16670642793178558], [0.16646933555603027, 0.16577452421188354, 0.16772641241550446, 0.1677330732345581, 0.1657942682504654, 0.16650238633155823]], [[0.1680145263671875, 0.16803210973739624, 0.1647859811782837, 0.16298003494739532, 0.16808483004570007, 0.1681024134159088], [0.16802045702934265, 0.16803811490535736, 0.1647777259349823, 0.16296395659446716, 0.1680910736322403, 0.168108731508255], [0.16691461205482483, 0.1669178009033203, 0.16632245481014252, 0.1659870743751526, 0.16692741215229034, 0.16693060100078583], [0.1662856936454773, 0.1662808060646057, 0.16719399392604828, 0.16771207749843597, 0.16626615822315216, 0.16626127064228058], [0.16803815960884094, 0.16805604100227356, 0.16475284099578857, 0.16291563212871552, 0.1681097149848938, 0.16812759637832642], [0.1680440455675125, 0.1680620163679123, 0.1647445559501648, 0.16289952397346497, 0.16811591386795044, 0.16813388466835022]], [[0.1668606698513031, 0.16665320098400116, 0.16649462282657623, 0.1662876158952713, 0.1668529361486435, 0.1668509989976883], [0.1660325676202774, 0.16670872271060944, 0.16722795367240906, 0.16790898144245148, 0.16605770587921143, 0.16606399416923523], [0.16539831459522247, 0.1667477935552597, 0.1677878201007843, 0.16915680468082428, 0.1654483824968338, 0.16546091437339783], [0.16456854343414307, 0.1667943149805069, 0.16851772367954254, 0.17079690098762512, 0.16465093195438385, 0.16467154026031494], [0.16682982444763184, 0.16665534675121307, 0.16652196645736694, 0.16634781658649445, 0.16682332754135132, 0.16682168841362], [0.16682212054729462, 0.16665589809417725, 0.16652880609035492, 0.16636288166046143, 0.16681592166423798, 0.16681437194347382]], [[0.16682875156402588, 0.16711287200450897, 0.16538859903812408, 0.1663789600133896, 0.16714075207710266, 0.16715005040168762], [0.16686946153640747, 0.16722574830055237, 0.16506586968898773, 0.16630573570728302, 0.16726072132587433, 0.16727237403392792], [0.16661903262138367, 0.16653649508953094, 0.16704024374485016, 0.16675008833408356, 0.16652841866016388, 0.1665257215499878], [0.16676385700702667, 0.16693361103534698, 0.1659015715122223, 0.16649486124515533, 0.1669502556324005, 0.16695581376552582], [0.16687346994876862, 0.1672368347644806, 0.16503427922725677, 0.16629856824874878, 0.16727249324321747, 0.16728438436985016], [0.16687479615211487, 0.16724053025245667, 0.16502375900745392, 0.16629618406295776, 0.16727642714977264, 0.1672883927822113]], [[0.16701439023017883, 0.1665627807378769, 0.16621805727481842, 0.16621385514736176, 0.16699755191802979, 0.16699333488941193], [0.1663326472043991, 0.16676577925682068, 0.16709797084331512, 0.16710200905799866, 0.16634875535964966, 0.1663527935743332], [0.1658109426498413, 0.16691932082176208, 0.16777242720127106, 0.16778284311294556, 0.16585209965705872, 0.16586239635944366], [0.16580459475517273, 0.1669211983680725, 0.16778065264225006, 0.16779114305973053, 0.1658460646867752, 0.16585642099380493], [0.16698899865150452, 0.16657039523124695, 0.1662507951259613, 0.1662469208240509, 0.16697338223457336, 0.16696947813034058], [0.16698266565799713, 0.16657231748104095, 0.1662590056657791, 0.1662551909685135, 0.16696736216545105, 0.16696353256702423]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "env_to_module_connector": {"connector_pipeline_timer": 6.412132006290475e-05, "timers": {"connectors": {"batch_individual_items": 1.3479214299853209e-05, "numpy_to_tensor": 1.346029184933929e-05, "add_observations_from_episodes_to_batch": 3.031244434263632e-06, "add_states_from_episodes_to_batch": 3.299756298255798e-06, "add_time_dim_to_batch_and_zero_pad": 7.525326196088258e-06}}}, "weights_seq_no": 13.0, "rlmodule_inference_timer": 3.517437576212448e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2284691447105023e-05, "tensor_to_numpy": 1.703236999674603e-05, "normalize_and_clip_actions": 8.31356914624749e-06, "get_actions": 4.243836765872747e-05, "listify_data_for_vector_env": 1.196941581915834e-05, "un_batch_to_individual_items": 6.8766478814278515e-06}}, "connector_pipeline_timer": 0.00012730910981253652}, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 65400, "num_episodes_lifetime": 260, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "sample": 0.12227453907637671, "episode_duration_sec_mean": 0.005660890385042876, "module_episode_returns_mean": {"default_policy": -0.6}, "episode_len_max": 20, "episode_len_min": 20, "episode_return_max": 12.5, "env_step_timer": 1.6674772745011385e-05, "episode_return_min": -12.5, "episode_return_mean": -0.6, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.0005175804710653088, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -0.6}, "time_between_sampling": 10.91559794294321}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "ae8f9_00000", "date": "2025-08-11_18-16-47", "timestamp": 1754929007, "time_this_iter_s": 11.38535189628601, "time_total_s": 144.7906415462494, "pid": 10547, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3849f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 144.7906415462494, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 48.68235294117647, "ram_util_percent": 80.86470588235295}}
{"timers": {"training_iteration": 10.981915484456618, "restore_env_runners": 1.1350222213651517e-05, "training_step": 10.98174636108199, "env_runner_sampling_timer": 1.8614361212563233, "learner_update_timer": 8.911200510402443, "synch_weights": 0.0014586248026565766, "restore_eval_env_runners": 1.7345024919972635e-05, "evaluation_iteration": 0.13296129920375738, "synch_eval_env_connectors": 0.00017442872643653727, "synch_env_connectors": 5.6222202304260585e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.520496906708093e-06, "add_observations_from_episodes_to_batch": 2.9935174025522685e-06, "add_states_from_episodes_to_batch": 2.972404523464491e-06, "batch_individual_items": 1.323330166554282e-05, "numpy_to_tensor": 1.3732714595421219e-05}}, "connector_pipeline_timer": 6.342112444165521e-05}, "episode_len_mean": 20.0, "sample": 0.006176475361103836, "weights_seq_no": 13.0, "episode_duration_sec_mean": 0.005706011460628359, "episode_len_max": 20, "rlmodule_inference_timer": 3.531540894765306e-05, "module_to_env_connector": {"connector_pipeline_timer": 0.00012846498135731665, "timers": {"connectors": {"tensor_to_numpy": 1.6744138701284945e-05, "listify_data_for_vector_env": 1.1409457428538626e-05, "normalize_and_clip_actions": 8.600598048854228e-06, "get_actions": 4.428230472179255e-05, "remove_single_ts_time_rank_from_batch": 1.2422608310220258e-05, "un_batch_to_individual_items": 6.976054843426524e-06}}}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 5.178955587433454e-05, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_return_max": 9.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 1.1800000000000002}, "env_step_timer": 1.4988331414673675e-05, "agent_episode_returns_mean": {"default_agent": 1.1800000000000002}, "time_between_sampling": 0.03942005004948367, "num_env_steps_sampled_lifetime": -7400000.0, "num_episodes_lifetime": -370000.0, "episode_return_min": -10.5, "episode_return_mean": 1.1800000000000002, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3006.3552395839074}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.16840115143669665, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009374582624624298, "add_observations_from_episodes_to_batch": 0.0008652269126437716, "add_columns_from_episodes_to_train_batch": 0.04336284736883313, "add_time_dim_to_batch_and_zero_pad": 0.10163943864587996, "add_states_from_episodes_to_batch": 0.003958490858240803, "batch_individual_items": 0.008890005222759265, "numpy_to_tensor": 8.375995715102417e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"vf_explained_var": 0.0006150603294372559, "vf_loss_unclipped": 40.45675277709961, "module_train_batch_size_mean": 998.1405362012929, "policy_loss": -0.00013237964594736695, "mean_kl_loss": 1.0414307325845584e-05, "entropy": 0.6822347640991211, "num_module_steps_trained": 5985, "curr_kl_coeff": 9.862300430540927e-06, "curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.3205143213272095, "num_module_steps_trained_lifetime": 83790, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.2485118806362152, "num_trainable_parameters": 16595, "weights_seq_no": 14.0, "num_module_steps_trained_lifetime_throughput": 646.9103587156942}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.1405362012929, "total_loss": 0.0, "weights_seq_no": 14.0, "curr_entropy_coeff": 0.0015431216992, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 83790, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 646.9168279191997}, "__all_modules__": {"num_module_steps_trained_lifetime": 167580, "num_env_steps_trained_lifetime": 504000, "num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained": 36000, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 3894.492457441823, "num_module_steps_trained_throughput": 20965302.948990043, "num_module_steps_trained_lifetime_throughput": 11107369.428503627}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_explained_var": -0.0017229318618774414, "vf_loss_unclipped": 40.64155578613281, "module_train_batch_size_mean": 997.501977255973, "total_loss": 0.248575359582901, "mean_kl_loss": 1.007084301818395e-05, "weights_seq_no": 84.0, "entropy": 0.6822461485862732, "vf_loss": 0.3205875754356384, "policy_loss": -0.000127568026073277, "num_module_steps_trained_lifetime": 502740, "diff_num_grad_updates_vs_sampler_policy": 71.0, "num_module_steps_trained": 35910, "use_intrinsic_rewards": 1.0}, "intrinsic_reward_module": {"weights_seq_no": 84.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 502740, "diff_num_grad_updates_vs_sampler_policy": 71.0, "module_train_batch_size_mean": 997.501977255973, "total_loss": 0.0}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 1005480, "num_env_steps_trained_lifetime": 3024000, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 41302.64974871846}}}, "IntrinsicAttentionMask": [[[0.16682876646518707, 0.16711288690567017, 0.1663697212934494, 0.16539780795574188, 0.16714076697826385, 0.16715006530284882], [0.16686949133872986, 0.16722577810287476, 0.1662941724061966, 0.16507741808891296, 0.16726075112819672, 0.1672724038362503], [0.16676250100135803, 0.1669299155473709, 0.1664917916059494, 0.16591759026050568, 0.16694633662700653, 0.16695180535316467], [0.1666203886270523, 0.1665402054786682, 0.16675034165382385, 0.16702698171138763, 0.16653233766555786, 0.16652971506118774], [0.16687346994876862, 0.1672368347644806, 0.16628673672676086, 0.16504600644111633, 0.16727249324321747, 0.16728438436985016], [0.16687479615211487, 0.16724053025245667, 0.16628429293632507, 0.16503556072711945, 0.16727642714977264, 0.1672883927822113]], [[0.1663709133863449, 0.16571670770645142, 0.1675541251897812, 0.1675603836774826, 0.16639579832553864, 0.16640202701091766], [0.16675426065921783, 0.16694988310337067, 0.16640296578407288, 0.16640111804008484, 0.1667468398809433, 0.16674497723579407], [0.1656721830368042, 0.16351023316383362, 0.16963304579257965, 0.16965419054031372, 0.16575482487678528, 0.16577547788619995], [0.16566848754882812, 0.163498654961586, 0.1696440428495407, 0.16966527700424194, 0.1657514125108719, 0.16577215492725372], [0.16635631024837494, 0.1656700074672699, 0.1675979048013687, 0.1676044762134552, 0.16638241708278656, 0.16638894379138947], [0.16635264456272125, 0.16565832495689392, 0.1676088273525238, 0.16761548817157745, 0.16637904942035675, 0.16638565063476562]], [[0.1664985716342926, 0.16678214073181152, 0.16506126523017883, 0.16604965925216675, 0.16779950261116028, 0.16780883073806763], [0.16645510494709015, 0.1668105125427246, 0.16465599834918976, 0.16589276492595673, 0.16808690130710602, 0.16809861361980438], [0.1667145937681198, 0.1666320115327835, 0.1671360433101654, 0.16684572398662567, 0.16633717715740204, 0.16633448004722595], [0.16656681895256042, 0.16673637926578522, 0.16570556163787842, 0.16629815101623535, 0.16734376549720764, 0.16734933853149414], [0.16629697382450104, 0.1669090837240219, 0.16321292519569397, 0.1653304249048233, 0.1691151261329651, 0.1691354364156723], [0.16629552841186523, 0.16690997779369354, 0.1631997972726822, 0.16532528400421143, 0.1691245585680008, 0.16914494335651398]], [[0.16659177839756012, 0.16659800708293915, 0.16777655482292175, 0.16711682081222534, 0.1659553200006485, 0.16596153378486633], [0.1665908396244049, 0.1665971428155899, 0.1677902489900589, 0.16712236404418945, 0.1659465730190277, 0.16595284640789032], [0.16640760004520416, 0.1664283573627472, 0.17038604617118835, 0.16816258430480957, 0.16429749131202698, 0.16431798040866852], [0.16651159524917603, 0.16652429103851318, 0.16893194615840912, 0.16758202016353607, 0.1652187556028366, 0.16523133218288422], [0.1666857898235321, 0.16668415069580078, 0.1663782000541687, 0.16654913127422333, 0.1668521612882614, 0.16685053706169128], [0.16668491065502167, 0.1666833609342575, 0.16639183461666107, 0.16655470430850983, 0.16684341430664062, 0.16684186458587646]], [[0.16864171624183655, 0.16865935921669006, 0.163571298122406, 0.16541841626167297, 0.16684584319591522, 0.1668633073568344], [0.16865043342113495, 0.16866815090179443, 0.163557767868042, 0.16541290283203125, 0.1668466031551361, 0.16686412692070007], [0.16610421240329742, 0.16609926521778107, 0.167556494474411, 0.16702082753181458, 0.16661210358142853, 0.16660712659358978], [0.16703681647777557, 0.16704009473323822, 0.16608309745788574, 0.16643327474594116, 0.16670171916484833, 0.16670499742031097], [0.16775104403495789, 0.1677606850862503, 0.16496159136295319, 0.1659822165966034, 0.1667674481868744, 0.16677702963352203], [0.1677597314119339, 0.1677694469690323, 0.16494795680046082, 0.16597670316696167, 0.16676820814609528, 0.16677787899971008]], [[0.16668976843357086, 0.16627295315265656, 0.16701944172382355, 0.1670234203338623, 0.16628481447696686, 0.16670957207679749], [0.1666419953107834, 0.16707728803157806, 0.1662992686033249, 0.1662951558828354, 0.1670648753643036, 0.1666213721036911], [0.16672585904598236, 0.16563931107521057, 0.16758836805820465, 0.16759876906871796, 0.16567014157772064, 0.1667775958776474], [0.1667262613773346, 0.16563168168067932, 0.16759520769119263, 0.1676056832075119, 0.1656627357006073, 0.16677838563919067], [0.1666433960199356, 0.16705437004566193, 0.16631977260112762, 0.16631588339805603, 0.16704265773296356, 0.16662392020225525], [0.16669197380542755, 0.1662348359823227, 0.16705365478992462, 0.16705800592899323, 0.16624782979488373, 0.16671371459960938]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "env_to_module_connector": {"connector_pipeline_timer": 5.9144539326633214e-05, "timers": {"connectors": {"batch_individual_items": 1.2431120726387122e-05, "numpy_to_tensor": 1.194835892800023e-05, "add_observations_from_episodes_to_batch": 2.8365993934931607e-06, "add_states_from_episodes_to_batch": 2.680756735423963e-06, "add_time_dim_to_batch_and_zero_pad": 7.105234245119636e-06}}}, "weights_seq_no": 14.0, "rlmodule_inference_timer": 3.200585593683492e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.180358849139989e-05, "tensor_to_numpy": 1.5567952732321687e-05, "normalize_and_clip_actions": 7.805486666138823e-06, "get_actions": 3.7455118957131695e-05, "listify_data_for_vector_env": 1.0418496502850168e-05, "un_batch_to_individual_items": 6.516937664115627e-06}}, "connector_pipeline_timer": 0.000115617909941699}, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 70400, "num_episodes_lifetime": 280, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "sample": 0.12222246493605127, "episode_duration_sec_mean": 0.005642209523357451, "module_episode_returns_mean": {"default_policy": -0.4}, "episode_len_max": 20, "episode_len_min": 20, "episode_return_max": 12.5, "env_step_timer": 1.4233780856678782e-05, "episode_return_min": -12.5, "episode_return_mean": -0.4, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.0005156963258774573, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -0.4}, "time_between_sampling": 10.921678741014027}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "ae8f9_00000", "date": "2025-08-11_18-16-58", "timestamp": 1754929018, "time_this_iter_s": 11.619652032852173, "time_total_s": 156.41029357910156, "pid": 10547, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3849f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 156.41029357910156, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 50.89375, "ram_util_percent": 81.1625}}
{"timers": {"training_iteration": 10.972674185863092, "restore_env_runners": 1.140130913766714e-05, "training_step": 10.972504349970494, "env_runner_sampling_timer": 1.8597560608736492, "learner_update_timer": 8.903699259467944, "synch_weights": 0.001455438554123744, "restore_eval_env_runners": 1.7580325163852334e-05, "evaluation_iteration": 0.1328915403822136, "synch_eval_env_connectors": 0.00017534859915556842, "synch_env_connectors": 5.606827209792941e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.18701404324063e-06, "add_observations_from_episodes_to_batch": 2.875722485876641e-06, "add_states_from_episodes_to_batch": 2.8593067267295384e-06, "batch_individual_items": 1.2547201095252257e-05, "numpy_to_tensor": 1.2844454925565637e-05}}, "connector_pipeline_timer": 6.049045983963168e-05}, "episode_len_mean": 20.0, "sample": 0.0058704259938684306, "weights_seq_no": 14.0, "episode_duration_sec_mean": 0.005376833512447775, "episode_len_max": 20, "rlmodule_inference_timer": 3.296927200396013e-05, "module_to_env_connector": {"connector_pipeline_timer": 0.00012118364397922573, "timers": {"connectors": {"tensor_to_numpy": 1.57671226807626e-05, "listify_data_for_vector_env": 1.0753505094043148e-05, "normalize_and_clip_actions": 8.154065305458907e-06, "get_actions": 4.1272409899288035e-05, "remove_single_ts_time_rank_from_batch": 1.1920010245384923e-05, "un_batch_to_individual_items": 6.617267404869688e-06}}}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 4.6181939198492494e-05, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_return_max": 9.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 0.9399999999999996}, "env_step_timer": 1.4037398077118897e-05, "agent_episode_returns_mean": {"default_agent": 0.9399999999999996}, "time_between_sampling": 0.04016698559810186, "num_env_steps_sampled_lifetime": -8017500.0, "num_episodes_lifetime": -400875.0, "episode_return_min": -10.5, "episode_return_mean": 0.9399999999999996, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3164.9361291069577}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.16824406534178693, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00936892429798541, "add_observations_from_episodes_to_batch": 0.0008651233931281155, "add_columns_from_episodes_to_train_batch": 0.04334119806472961, "add_time_dim_to_batch_and_zero_pad": 0.1015243600991495, "add_states_from_episodes_to_batch": 0.003956450539380925, "batch_individual_items": 0.00887845142071369, "numpy_to_tensor": 8.376443849672331e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"vf_explained_var": 0.0005357861518859863, "vf_loss_unclipped": 41.698707580566406, "module_train_batch_size_mean": 998.1026110140886, "policy_loss": -0.00023038176004774868, "mean_kl_loss": 3.6420336982700974e-05, "entropy": 0.6803695559501648, "num_module_steps_trained": 5985, "curr_kl_coeff": 4.931150215270463e-06, "curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.3205147683620453, "num_module_steps_trained_lifetime": 89775, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.24841709434986115, "num_trainable_parameters": 16595, "weights_seq_no": 15.0, "num_module_steps_trained_lifetime_throughput": 645.7464969100937}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.1026110140886, "total_loss": 0.0, "weights_seq_no": 15.0, "curr_entropy_coeff": 0.0015431216992, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 89775, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 645.7525738842908}, "__all_modules__": {"num_module_steps_trained_lifetime": 179550, "num_env_steps_trained_lifetime": 540000, "num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained": 36000, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 3887.366405008613, "num_module_steps_trained_throughput": 20493953.400822468, "num_module_steps_trained_lifetime_throughput": 11155208.15598264}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_explained_var": -0.0015486478805541992, "vf_loss_unclipped": 41.80371856689453, "module_train_batch_size_mean": 997.499088644618, "total_loss": 0.24846750497817993, "mean_kl_loss": 3.540782563504763e-05, "weights_seq_no": 90.0, "entropy": 0.6803885698318481, "vf_loss": 0.3205670714378357, "policy_loss": -0.0002263884962303564, "num_module_steps_trained_lifetime": 538650, "diff_num_grad_updates_vs_sampler_policy": 76.0, "num_module_steps_trained": 35910, "use_intrinsic_rewards": 1.0}, "intrinsic_reward_module": {"weights_seq_no": 90.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 538650, "diff_num_grad_updates_vs_sampler_policy": 76.0, "module_train_batch_size_mean": 997.499088644618, "total_loss": 0.0}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 1077300, "num_env_steps_trained_lifetime": 3240000, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 40804.75582723108}}}, "IntrinsicAttentionMask": [[[0.16863559186458588, 0.1686532199382782, 0.16356535255908966, 0.1635824590921402, 0.16870614886283875, 0.16685722768306732], [0.1686442345380783, 0.1686619520187378, 0.16355174779891968, 0.16356892883777618, 0.16871510446071625, 0.1668579876422882], [0.16610372066497803, 0.16609877347946167, 0.1675560027360916, 0.16755101084709167, 0.1660839170217514, 0.16660663485527039], [0.16611240804195404, 0.16610752046108246, 0.1675422340631485, 0.16753731667995453, 0.1660928875207901, 0.1666075736284256], [0.1686701774597168, 0.16868813335895538, 0.1635109782218933, 0.16352838277816772, 0.16874200105667114, 0.16686029732227325], [0.16775786876678467, 0.16776758432388306, 0.16494612395763397, 0.16495569050312042, 0.16779673099517822, 0.16677601635456085]], [[0.16668976843357086, 0.16627295315265656, 0.16701944172382355, 0.1670234203338623, 0.16628481447696686, 0.16670957207679749], [0.1666419953107834, 0.16707728803157806, 0.1662992686033249, 0.1662951558828354, 0.1670648753643036, 0.1666213721036911], [0.16672585904598236, 0.16563931107521057, 0.16758836805820465, 0.16759876906871796, 0.16567014157772064, 0.1667775958776474], [0.1667262613773346, 0.16563168168067932, 0.16759520769119263, 0.1676056832075119, 0.1656627357006073, 0.16677838563919067], [0.1666433960199356, 0.16705437004566193, 0.16631977260112762, 0.16631588339805603, 0.16704265773296356, 0.16662392020225525], [0.16669197380542755, 0.1662348359823227, 0.16705365478992462, 0.16705800592899323, 0.16624782979488373, 0.16671371459960938]], [[0.1666635125875473, 0.1669473499059677, 0.16620491445064545, 0.16523396968841553, 0.166975200176239, 0.1679750680923462], [0.1666620522737503, 0.1670178920030594, 0.16608743369579315, 0.1648721992969513, 0.16705282032489777, 0.1683076024055481], [0.16666530072689056, 0.16683261096477509, 0.16639474034309387, 0.1658208817243576, 0.1668490320444107, 0.16743741929531097], [0.16666680574417114, 0.16658659279346466, 0.16679677367210388, 0.16707350313663483, 0.1665787249803543, 0.16629758477210999], [0.16666190326213837, 0.16702482104301453, 0.1660759299993515, 0.16483677923679352, 0.16706043481826782, 0.16834023594856262], [0.166654571890831, 0.16727034747600555, 0.1656622737646103, 0.16357184946537018, 0.16733083128929138, 0.1695101410150528]], [[0.1668131798505783, 0.16615724563598633, 0.16733266413211823, 0.16733892261981964, 0.16617588698863983, 0.16618210077285767], [0.16662277281284332, 0.16681824624538422, 0.16646867990493774, 0.1664668172597885, 0.16681267321109772, 0.16681082546710968], [0.16696162521839142, 0.16563548147678375, 0.16801570355892181, 0.16802842915058136, 0.16567309200763702, 0.16568563878536224], [0.16696341335773468, 0.16562920808792114, 0.168023943901062, 0.16803672909736633, 0.16566704213619232, 0.1656796634197235], [0.16662824153900146, 0.16679944097995758, 0.1664932519197464, 0.16649164259433746, 0.166794553399086, 0.16679294407367706], [0.16663004457950592, 0.16679315268993378, 0.16650143265724182, 0.16649989783763885, 0.1667885035276413, 0.16678695380687714]], [[0.168020561337471, 0.16617915034294128, 0.16479188203811646, 0.16480912268161774, 0.16809086501598358, 0.16810844838619232], [0.16739274561405182, 0.1664067804813385, 0.16566063463687897, 0.16566993296146393, 0.16743029654026031, 0.16743968427181244], [0.16691480576992035, 0.1665782332420349, 0.16632264852523804, 0.16632583737373352, 0.16692760586738586, 0.16693079471588135], [0.16692078113555908, 0.16657611727714539, 0.16631440818309784, 0.1663176715373993, 0.16693387925624847, 0.16693715751171112], [0.16804438829421997, 0.16617044806480408, 0.16475893557071686, 0.16477647423744202, 0.16811594367027283, 0.16813382506370544], [0.16805031895637512, 0.16616827249526978, 0.16475069522857666, 0.1647682934999466, 0.16812218725681305, 0.16814015805721283]], [[0.16654931008815765, 0.16655325889587402, 0.16687871515750885, 0.16730499267578125, 0.16656513512134552, 0.16614863276481628], [0.1665470153093338, 0.16655105352401733, 0.16688281297683716, 0.16731737554073334, 0.16656315326690674, 0.16613860428333282], [0.16635873913764954, 0.16636906564235687, 0.1672193706035614, 0.1683371663093567, 0.1664000302553177, 0.16531561315059662], [0.1661101132631302, 0.16612863540649414, 0.16765731573104858, 0.16967634856700897, 0.166184201836586, 0.16424334049224854], [0.16654017567634583, 0.16654443740844727, 0.16689512133598328, 0.1673545390367508, 0.1665572226047516, 0.16610850393772125], [0.16677922010421753, 0.1667754054069519, 0.16646170616149902, 0.16605263948440552, 0.16676393151283264, 0.16716709733009338]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "env_to_module_connector": {"connector_pipeline_timer": 5.833320372530957e-05, "timers": {"connectors": {"batch_individual_items": 1.2280549802886926e-05, "numpy_to_tensor": 1.1864151621312946e-05, "add_observations_from_episodes_to_batch": 2.7926403633887082e-06, "add_states_from_episodes_to_batch": 2.6524235499683636e-06, "add_time_dim_to_batch_and_zero_pad": 6.917461858296138e-06}}}, "weights_seq_no": 15.0, "rlmodule_inference_timer": 3.1773037822529257e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1898418194465421e-05, "tensor_to_numpy": 1.542830462570211e-05, "normalize_and_clip_actions": 7.92164230081221e-06, "get_actions": 3.685051971111016e-05, "listify_data_for_vector_env": 1.0465362278020648e-05, "un_batch_to_individual_items": 6.92068984920056e-06}}, "connector_pipeline_timer": 0.00011612515797469988}, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 75400, "num_episodes_lifetime": 300, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "sample": 0.1221393240370039, "episode_duration_sec_mean": 0.005606372063048184, "module_episode_returns_mean": {"default_policy": 0.0}, "episode_len_max": 20, "episode_len_min": 20, "episode_return_max": 12.5, "env_step_timer": 1.5230318326673753e-05, "episode_return_min": -12.5, "episode_return_mean": 0.0, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.0005119397818967531, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 0.0}, "time_between_sampling": 10.913349724014514}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "ae8f9_00000", "date": "2025-08-11_18-17-09", "timestamp": 1754929029, "time_this_iter_s": 10.180706977844238, "time_total_s": 166.5910005569458, "pid": 10547, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3849f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 166.5910005569458, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 39.70666666666666, "ram_util_percent": 80.66666666666667}}
{"timers": {"training_iteration": 10.977996732334361, "restore_env_runners": 1.1382717028979135e-05, "training_step": 10.977826320221089, "env_runner_sampling_timer": 1.8644725911051983, "learner_update_timer": 8.902111993953794, "synch_weights": 0.0014572974984501527, "restore_eval_env_runners": 1.7548682497691756e-05, "evaluation_iteration": 0.1327619078983795, "synch_eval_env_connectors": 0.0001750230239203325, "synch_env_connectors": 5.5924298021429626e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 9.83791269207401e-06, "add_observations_from_episodes_to_batch": 3.7984128590673722e-06, "add_states_from_episodes_to_batch": 3.5101635761924458e-06, "batch_individual_items": 1.6188421323766872e-05, "numpy_to_tensor": 1.9215988916791265e-05}}, "connector_pipeline_timer": 8.087176725719748e-05}, "episode_len_mean": 20.0, "sample": 0.006739463809974561, "weights_seq_no": 15.0, "episode_duration_sec_mean": 0.008097642149776221, "episode_len_max": 20, "rlmodule_inference_timer": 5.064420510693118e-05, "module_to_env_connector": {"connector_pipeline_timer": 0.0001912752351487753, "timers": {"connectors": {"tensor_to_numpy": 2.3844555268906464e-05, "listify_data_for_vector_env": 1.4194689650398766e-05, "normalize_and_clip_actions": 1.3218496720432026e-05, "get_actions": 7.968426008492052e-05, "remove_single_ts_time_rank_from_batch": 1.6058932343064506e-05, "un_batch_to_individual_items": 8.904907223360556e-06}}}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 5.9846569126731544e-05, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_return_max": 9.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 1.1800000000000002}, "env_step_timer": 2.321166983249949e-05, "agent_episode_returns_mean": {"default_agent": 1.1800000000000002}, "time_between_sampling": 0.03520838166395162, "num_env_steps_sampled_lifetime": -8635000.0, "num_episodes_lifetime": -431750.0, "episode_return_min": -10.5, "episode_return_mean": 1.1800000000000002, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 2848.8607663833177}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1701758742786877, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009387939214697485, "add_observations_from_episodes_to_batch": 0.0008654867388971405, "add_columns_from_episodes_to_train_batch": 0.04335358149369654, "add_time_dim_to_batch_and_zero_pad": 0.10184742274797584, "add_states_from_episodes_to_batch": 0.003955058113935824, "batch_individual_items": 0.010457226075506568, "numpy_to_tensor": 8.391387380476056e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"vf_explained_var": 0.0008358359336853027, "vf_loss_unclipped": 41.922847747802734, "module_train_batch_size_mean": 998.0669052031734, "policy_loss": -0.00033977616112679243, "mean_kl_loss": 2.36270952882478e-05, "entropy": 0.6792064309120178, "num_module_steps_trained": 5985, "curr_kl_coeff": 2.4655751076352317e-06, "curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.3205156922340393, "num_module_steps_trained_lifetime": 95760, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.24831022322177887, "num_trainable_parameters": 16595, "weights_seq_no": 16.0, "num_module_steps_trained_lifetime_throughput": 644.5952172569935}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.0669052031734, "total_loss": 0.0, "weights_seq_no": 16.0, "curr_entropy_coeff": 0.0015431216992, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 95760, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 644.6009249472404}, "__all_modules__": {"num_module_steps_trained_lifetime": 191520, "num_env_steps_trained_lifetime": 576000, "num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained": 36000, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 3880.3237194105745, "num_module_steps_trained_throughput": 20036155.480720922, "num_module_steps_trained_lifetime_throughput": 11189768.722248133}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_explained_var": -0.0015360116958618164, "vf_loss_unclipped": 42.03139877319336, "module_train_batch_size_mean": 997.4970769774884, "total_loss": 0.24835792183876038, "mean_kl_loss": 2.216990469605662e-05, "weights_seq_no": 96.0, "entropy": 0.679241955280304, "vf_loss": 0.3205585181713104, "policy_loss": -0.00032892735907807946, "num_module_steps_trained_lifetime": 574560, "diff_num_grad_updates_vs_sampler_policy": 81.0, "num_module_steps_trained": 35910, "use_intrinsic_rewards": 1.0}, "intrinsic_reward_module": {"weights_seq_no": 96.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 574560, "diff_num_grad_updates_vs_sampler_policy": 81.0, "module_train_batch_size_mean": 997.4970769774884, "total_loss": 0.0}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 1149120, "num_env_steps_trained_lifetime": 3456000, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 40331.43067309541}}}, "IntrinsicAttentionMask": [[[0.1666635274887085, 0.1679377257823944, 0.16522479057312012, 0.16621416807174683, 0.1669752150774002, 0.16698451340198517], [0.166655033826828, 0.16938616335391998, 0.16359956562519073, 0.16569750010967255, 0.16732093691825867, 0.16734080016613007], [0.16666680574417114, 0.1662975698709488, 0.16708813607692719, 0.16679789125919342, 0.16657614707946777, 0.1665734499692917], [0.16666528582572937, 0.1674260050058365, 0.16580353677272797, 0.16639646887779236, 0.16685159504413605, 0.16685713827610016], [0.16666194796562195, 0.16829241812229156, 0.16482508182525635, 0.1660877764225006, 0.1670604646205902, 0.1670723408460617], [0.16666188836097717, 0.1683029681444168, 0.16481319069862366, 0.16608399152755737, 0.16706298291683197, 0.16707494854927063]], [[0.16693970561027527, 0.1669355034828186, 0.16614371538162231, 0.16613952815532684, 0.16692286729812622, 0.16691866517066956], [0.16693472862243652, 0.16693060100078583, 0.16615325212478638, 0.16614915430545807, 0.16691820323467255, 0.16691406071186066], [0.16599321365356445, 0.1660035103559494, 0.1679568737745285, 0.167967289686203, 0.16603441536426544, 0.1660447120666504], [0.16598820686340332, 0.16599857807159424, 0.16796645522117615, 0.1679769605398178, 0.16602972149848938, 0.1660400927066803], [0.1669197678565979, 0.1669158637523651, 0.16618187725543976, 0.16617800295352936, 0.16690415143966675, 0.16690026223659515], [0.16691480576992035, 0.16691099107265472, 0.1661914438009262, 0.16618762910366058, 0.16689950227737427, 0.16689568758010864]], [[0.1666652411222458, 0.1669490933418274, 0.16620664298534393, 0.16621588170528412, 0.1669769436120987, 0.16698622703552246], [0.16666476428508759, 0.16702061891555786, 0.16609014570713043, 0.16610172390937805, 0.16705554723739624, 0.16706718504428864], [0.1666659116744995, 0.16683322191238403, 0.16639533638954163, 0.16640079021453857, 0.16684962809085846, 0.1668550968170166], [0.16666589677333832, 0.16683556139469147, 0.1663915365934372, 0.1663970798254013, 0.166852205991745, 0.1668577492237091], [0.166664719581604, 0.16702763736248016, 0.16607873141765594, 0.16609053313732147, 0.16706325113773346, 0.16707512736320496], [0.1666647046804428, 0.1670299768447876, 0.1660749316215515, 0.166086807847023, 0.16706582903862, 0.16707777976989746]], [[0.1668606698513031, 0.1668587476015091, 0.16649462282657623, 0.1662876158952713, 0.1668529361486435, 0.16664548218250275], [0.1668529510498047, 0.16685108840465546, 0.16650144755840302, 0.1663026511669159, 0.16684551537036896, 0.1666463166475296], [0.1653982400894165, 0.16541075706481934, 0.16778776049613953, 0.1691567450761795, 0.16544832289218903, 0.16679821908473969], [0.16456836462020874, 0.16458895802497864, 0.16851754486560822, 0.1707967221736908, 0.16465075314044952, 0.1668776273727417], [0.16682983934879303, 0.1668282151222229, 0.16652198135852814, 0.16634781658649445, 0.1668233424425125, 0.16664886474609375], [0.16600169241428375, 0.16600827872753143, 0.167255237698555, 0.16796958446502686, 0.16602805256843567, 0.1667371541261673]], [[0.16699261963367462, 0.1672770231962204, 0.16555103659629822, 0.16556024551391602, 0.16730493307113647, 0.16731423139572144], [0.16707469522953033, 0.16743142902851105, 0.1652688980102539, 0.16528041660785675, 0.1674664467573166, 0.16747811436653137], [0.16657115519046783, 0.1664886325597763, 0.16699223220348358, 0.1669895201921463, 0.16648054122924805, 0.16647784411907196], [0.1665738821029663, 0.16649369895458221, 0.1669829785823822, 0.16698035597801208, 0.16648584604263306, 0.16648322343826294], [0.167082741856575, 0.167446568608284, 0.16524124145507812, 0.16525299847126007, 0.16748227179050446, 0.16749417781829834], [0.1670854240655899, 0.1674516201019287, 0.16523204743862152, 0.16524386405944824, 0.16748756170272827, 0.16749954223632812]], [[0.1668131798505783, 0.16615724563598633, 0.16733266413211823, 0.16733892261981964, 0.16617588698863983, 0.16618210077285767], [0.16662277281284332, 0.16681824624538422, 0.16646867990493774, 0.1664668172597885, 0.16681267321109772, 0.16681082546710968], [0.16696162521839142, 0.16563548147678375, 0.16801570355892181, 0.16802842915058136, 0.16567309200763702, 0.16568563878536224], [0.16696341335773468, 0.16562920808792114, 0.168023943901062, 0.16803672909736633, 0.16566704213619232, 0.1656796634197235], [0.16662824153900146, 0.16679944097995758, 0.1664932519197464, 0.16649164259433746, 0.166794553399086, 0.16679294407367706], [0.16663004457950592, 0.16679315268993378, 0.16650143265724182, 0.16649989783763885, 0.1667885035276413, 0.16678695380687714]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "env_to_module_connector": {"connector_pipeline_timer": 5.8204613246643205e-05, "timers": {"connectors": {"batch_individual_items": 1.219869374094873e-05, "numpy_to_tensor": 1.1876360563136175e-05, "add_observations_from_episodes_to_batch": 2.7650924368484772e-06, "add_states_from_episodes_to_batch": 2.6400511416132197e-06, "add_time_dim_to_batch_and_zero_pad": 6.945233285926636e-06}}}, "weights_seq_no": 16.0, "rlmodule_inference_timer": 3.146864868707952e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1636845253615429e-05, "tensor_to_numpy": 1.5207819137972474e-05, "normalize_and_clip_actions": 7.755421810948078e-06, "get_actions": 3.684030146932391e-05, "listify_data_for_vector_env": 1.0291885892183191e-05, "un_batch_to_individual_items": 6.50630879495815e-06}}, "connector_pipeline_timer": 0.00011381750874791042}, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 80400, "num_episodes_lifetime": 320, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "sample": 0.12206820620725248, "episode_duration_sec_mean": 0.005563728744164109, "module_episode_returns_mean": {"default_policy": -0.6}, "episode_len_max": 20, "episode_len_min": 20, "episode_return_max": 12.5, "env_step_timer": 1.3910641315199926e-05, "episode_return_min": -12.5, "episode_return_mean": -0.6, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.0005103966348246318, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -0.6}, "time_between_sampling": 10.919531347193622}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "ae8f9_00000", "date": "2025-08-11_18-17-20", "timestamp": 1754929040, "time_this_iter_s": 11.632228136062622, "time_total_s": 178.22322869300842, "pid": 10547, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3849f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 178.22322869300842, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 46.99375, "ram_util_percent": 81.25625}}
{"timers": {"training_iteration": 10.982737225430608, "restore_env_runners": 1.1463060138117707e-05, "training_step": 10.982565754519875, "env_runner_sampling_timer": 1.8620308601947861, "learner_update_timer": 8.909352959434568, "synch_weights": 0.0014629157726704506, "restore_eval_env_runners": 1.792444550462974e-05, "evaluation_iteration": 0.13267423590932112, "synch_eval_env_connectors": 0.00017509487391146954, "synch_env_connectors": 5.586504720692983e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.467563243334851e-06, "add_observations_from_episodes_to_batch": 3.0434051782897516e-06, "add_states_from_episodes_to_batch": 2.945101153230973e-06, "batch_individual_items": 1.2951679637289638e-05, "numpy_to_tensor": 1.3488780291032434e-05}}, "connector_pipeline_timer": 6.255204637189814e-05}, "episode_len_mean": 20.0, "sample": 0.007587520877366863, "weights_seq_no": 16.0, "episode_duration_sec_mean": 0.005558222569990905, "episode_len_max": 20, "rlmodule_inference_timer": 3.427202925541009e-05, "module_to_env_connector": {"connector_pipeline_timer": 0.00012558417421186074, "timers": {"connectors": {"tensor_to_numpy": 1.6505302979489637e-05, "listify_data_for_vector_env": 1.10689118959198e-05, "normalize_and_clip_actions": 8.42357947527016e-06, "get_actions": 4.297991582285244e-05, "remove_single_ts_time_rank_from_batch": 1.2300647314483713e-05, "un_batch_to_individual_items": 6.843403121879752e-06}}}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 6.176995677482214e-05, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_return_max": 9.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 1.5}, "env_step_timer": 1.4744721703062612e-05, "agent_episode_returns_mean": {"default_agent": 1.5}, "time_between_sampling": 0.03767555869534617, "num_env_steps_sampled_lifetime": -9252500.0, "num_episodes_lifetime": -462625.0, "episode_return_min": -10.5, "episode_return_mean": 1.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3063.0779109032496}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17003008136623993, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00938409023334319, "add_observations_from_episodes_to_batch": 0.0008659581214417844, "add_columns_from_episodes_to_train_batch": 0.04336407567912212, "add_time_dim_to_batch_and_zero_pad": 0.10172216810998466, "add_states_from_episodes_to_batch": 0.003953194202762672, "batch_individual_items": 0.010432277564231153, "numpy_to_tensor": 8.394098496888683e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"vf_explained_var": 0.00029599666595458984, "vf_loss_unclipped": 42.56673049926758, "module_train_batch_size_mean": 998.0332888909784, "policy_loss": -0.0004699074197560549, "mean_kl_loss": 5.4805313993711025e-05, "entropy": 0.6770713329315186, "num_module_steps_trained": 5985, "curr_kl_coeff": 1.2327875538176158e-06, "curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.3205164074897766, "num_module_steps_trained_lifetime": 101745, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.24818389117717743, "num_trainable_parameters": 16595, "weights_seq_no": 17.0, "num_module_steps_trained_lifetime_throughput": 643.1059387881018}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.0332888909784, "total_loss": 0.0, "weights_seq_no": 17.0, "curr_entropy_coeff": 0.0015431216992, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 101745, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 643.1113117896136}, "__all_modules__": {"num_module_steps_trained_lifetime": 203490, "num_env_steps_trained_lifetime": 612000, "num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained": 36000, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 3871.254951834671, "num_module_steps_trained_throughput": 19600347.1630581, "num_module_steps_trained_lifetime_throughput": 11226793.226452682}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_explained_var": -0.0014649629592895508, "vf_loss_unclipped": 42.61326599121094, "module_train_batch_size_mean": 997.4956760259092, "total_loss": 0.24822767078876495, "mean_kl_loss": 5.251056791166775e-05, "weights_seq_no": 102.0, "entropy": 0.6771103739738464, "vf_loss": 0.32054832577705383, "policy_loss": -0.0004594489582814276, "num_module_steps_trained_lifetime": 610470, "diff_num_grad_updates_vs_sampler_policy": 86.0, "num_module_steps_trained": 35910, "use_intrinsic_rewards": 1.0}, "intrinsic_reward_module": {"weights_seq_no": 102.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 610470, "diff_num_grad_updates_vs_sampler_policy": 86.0, "module_train_batch_size_mean": 997.4956760259092, "total_loss": 0.0}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 1220940, "num_env_steps_trained_lifetime": 3672000, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 39859.85731152796}}}, "IntrinsicAttentionMask": [[[0.16864176094532013, 0.16865940392017365, 0.1654011458158493, 0.16358844935894012, 0.1668458878993988, 0.1668633371591568], [0.16865046322345734, 0.16866818070411682, 0.16539554297924042, 0.1635749787092209, 0.1668466329574585, 0.16686415672302246], [0.16702812910079956, 0.16703131794929504, 0.16643555462360382, 0.16609996557235718, 0.16670089960098267, 0.16670408844947815], [0.16611289978027344, 0.16610802710056305, 0.1670202761888504, 0.16753782331943512, 0.16661295294761658, 0.1666080802679062], [0.16775105893611908, 0.1677606999874115, 0.16597269475460052, 0.16497108340263367, 0.16676746308803558, 0.16677704453468323], [0.1677597612142563, 0.16776947677135468, 0.16596712172031403, 0.16495753824710846, 0.16676823794841766, 0.16677789390087128]], [[0.1664808839559555, 0.16582626104354858, 0.16766487061977386, 0.16767114400863647, 0.1658448576927185, 0.16651201248168945], [0.16672132909297943, 0.16691692173480988, 0.16637010872364044, 0.1663682609796524, 0.16691134870052338, 0.16671206057071686], [0.1660347282886505, 0.1638680398464203, 0.17000426352024078, 0.17002545297145844, 0.16392932832241058, 0.16613824665546417], [0.1660323143005371, 0.16385771334171295, 0.17001663148403168, 0.1700379103422165, 0.16391924023628235, 0.1661362200975418], [0.16671456396579742, 0.1668858528137207, 0.16640691459178925, 0.16640529036521912, 0.16688096523284912, 0.16670644283294678], [0.16646933555603027, 0.16577452421188354, 0.16772641241550446, 0.1677330732345581, 0.1657942682504654, 0.16650238633155823]], [[0.16666179895401, 0.16793599724769592, 0.16522307693958282, 0.16523225605487823, 0.16796401143074036, 0.16698278486728668], [0.16664719581604004, 0.16937819123268127, 0.16359186172485352, 0.1636112779378891, 0.16943851113319397, 0.16733291745185852], [0.1666666567325592, 0.16629742085933685, 0.16708798706531525, 0.16708527505397797, 0.1662893444299698, 0.16657330095767975], [0.1666666865348816, 0.16630792617797852, 0.1670760065317154, 0.16707338392734528, 0.16630007326602936, 0.16657598316669464], [0.1666467785835266, 0.1694098263978958, 0.16355623304843903, 0.16357585787773132, 0.1694708615541458, 0.1673405021429062], [0.16665904223918915, 0.1683001071214676, 0.1648103892803192, 0.16482217609882355, 0.16833622753620148, 0.1670720875263214]], [[0.1668131798505783, 0.16615724563598633, 0.16733266413211823, 0.16733892261981964, 0.16617587208747864, 0.16618208587169647], [0.16662277281284332, 0.16681824624538422, 0.16646867990493774, 0.1664668172597885, 0.16681267321109772, 0.16681082546710968], [0.1669616401195526, 0.16563548147678375, 0.168015718460083, 0.16802844405174255, 0.16567310690879822, 0.16568563878536224], [0.16696342825889587, 0.16562920808792114, 0.1680239588022232, 0.16803674399852753, 0.16566705703735352, 0.1656796783208847], [0.16662824153900146, 0.16679944097995758, 0.1664932519197464, 0.16649164259433746, 0.166794553399086, 0.16679294407367706], [0.16663004457950592, 0.16679315268993378, 0.16650143265724182, 0.16649989783763885, 0.1667885035276413, 0.16678695380687714]], [[0.16617147624492645, 0.1674419343471527, 0.16571423411369324, 0.16572344303131104, 0.16746985912322998, 0.16747917234897614], [0.1656068116426468, 0.16832077503204346, 0.16463574767112732, 0.16465529799461365, 0.1683807075023651, 0.16840068995952606], [0.16637496650218964, 0.16712382435798645, 0.16610488295555115, 0.1661103218793869, 0.16714026033878326, 0.1671457439661026], [0.16637086868286133, 0.1671302318572998, 0.1660969853401184, 0.16610251367092133, 0.16714690625667572, 0.16715246438980103], [0.16559439897537231, 0.16833999752998352, 0.16461214423179626, 0.1646319180727005, 0.16840064525604248, 0.16842086613178253], [0.16559027135372162, 0.16834641993045807, 0.1646042764186859, 0.16462412476539612, 0.16840730607509613, 0.16842760145664215]], [[0.1668606698513031, 0.1668587476015091, 0.16649462282657623, 0.1662876158952713, 0.1668529361486435, 0.16664548218250275], [0.1668529510498047, 0.16685108840465546, 0.16650144755840302, 0.1663026511669159, 0.16684551537036896, 0.1666463166475296], [0.1653982251882553, 0.16541074216365814, 0.16778776049613953, 0.1691567450761795, 0.16544830799102783, 0.1667982041835785], [0.16456836462020874, 0.16458895802497864, 0.1685175597667694, 0.170796737074852, 0.16465075314044952, 0.1668776422739029], [0.16682983934879303, 0.1668282151222229, 0.16652198135852814, 0.16634781658649445, 0.1668233424425125, 0.16664886474609375], [0.16600169241428375, 0.16600827872753143, 0.167255237698555, 0.16796958446502686, 0.16602805256843567, 0.1667371541261673]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "env_to_module_connector": {"connector_pipeline_timer": 6.095478372408057e-05, "timers": {"connectors": {"batch_individual_items": 1.2704347274354956e-05, "numpy_to_tensor": 1.2460249261305587e-05, "add_observations_from_episodes_to_batch": 3.3204460675735547e-06, "add_states_from_episodes_to_batch": 2.701702059656979e-06, "add_time_dim_to_batch_and_zero_pad": 7.308863219893189e-06}}}, "weights_seq_no": 17.0, "rlmodule_inference_timer": 3.3237783148303586e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1928940023559662e-05, "tensor_to_numpy": 1.578520547611852e-05, "normalize_and_clip_actions": 7.936209854892215e-06, "get_actions": 3.911475668818163e-05, "listify_data_for_vector_env": 1.0585595031056258e-05, "un_batch_to_individual_items": 6.7543552895002975e-06}}, "connector_pipeline_timer": 0.00011816440147047849}, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 85400, "num_episodes_lifetime": 340, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "sample": 0.12202470748594921, "episode_duration_sec_mean": 0.00541706207441166, "module_episode_returns_mean": {"default_policy": 0.2}, "episode_len_max": 20, "episode_len_min": 20, "episode_return_max": 12.5, "env_step_timer": 1.5017497058886911e-05, "episode_return_min": -12.5, "episode_return_mean": 0.2, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.0005087039179668402, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 0.2}, "time_between_sampling": 10.92515493497136}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "ae8f9_00000", "date": "2025-08-11_18-17-32", "timestamp": 1754929052, "time_this_iter_s": 11.583775043487549, "time_total_s": 189.80700373649597, "pid": 10547, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3849f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 189.80700373649597, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 51.73529411764706, "ram_util_percent": 81.68823529411765}}
{"timers": {"training_iteration": 10.980152353176003, "restore_env_runners": 1.1448840080118697e-05, "training_step": 10.979979741144716, "env_runner_sampling_timer": 1.8590483882633413, "learner_update_timer": 8.909832751920764, "synch_weights": 0.001467232863981727, "restore_eval_env_runners": 1.816270131825138e-05, "evaluation_iteration": 0.13263223604992957, "synch_eval_env_connectors": 0.00017506142602663843, "synch_env_connectors": 5.570639978065788e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.1604383177668546e-06, "add_observations_from_episodes_to_batch": 2.8349581370842764e-06, "add_states_from_episodes_to_batch": 2.855867960272422e-06, "batch_individual_items": 1.2536917435762363e-05, "numpy_to_tensor": 1.2889421559357839e-05}}, "connector_pipeline_timer": 6.053183615723264e-05}, "episode_len_mean": 20.0, "sample": 0.00599700433511184, "weights_seq_no": 17.0, "episode_duration_sec_mean": 0.005373595828190446, "episode_len_max": 20, "rlmodule_inference_timer": 3.2866436328369526e-05, "module_to_env_connector": {"connector_pipeline_timer": 0.00012079922316202344, "timers": {"connectors": {"tensor_to_numpy": 1.574752936476131e-05, "listify_data_for_vector_env": 1.0760008600531137e-05, "normalize_and_clip_actions": 8.164395459760235e-06, "get_actions": 4.0782353127366375e-05, "remove_single_ts_time_rank_from_batch": 1.1924204677743986e-05, "un_batch_to_individual_items": 6.683809754973664e-06}}}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 4.5047329921896766e-05, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_return_max": 9.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 2.379999999999999}, "env_step_timer": 1.3998796149107328e-05, "agent_episode_returns_mean": {"default_agent": 2.379999999999999}, "time_between_sampling": 0.04021550601814346, "num_env_steps_sampled_lifetime": -9870000.0, "num_episodes_lifetime": -493500.0, "episode_return_min": -10.5, "episode_return_mean": 2.379999999999999, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3187.175748521456}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.16986178180230252, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009377680160890517, "add_observations_from_episodes_to_batch": 0.0008657431202440241, "add_columns_from_episodes_to_train_batch": 0.04335039826214023, "add_time_dim_to_batch_and_zero_pad": 0.1016085764282598, "add_states_from_episodes_to_batch": 0.0039509668404810235, "batch_individual_items": 0.010401703958994632, "numpy_to_tensor": 8.366782506533028e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"vf_explained_var": 0.00020307302474975586, "vf_loss_unclipped": 41.32518005371094, "module_train_batch_size_mean": 998.0016398003509, "policy_loss": -0.00019307478214614093, "mean_kl_loss": 1.1972437278018333e-05, "entropy": 0.6769327521324158, "num_module_steps_trained": 5985, "curr_kl_coeff": 6.163937769088079e-07, "curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.3205159306526184, "num_module_steps_trained_lifetime": 107730, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.24846060574054718, "num_trainable_parameters": 16595, "weights_seq_no": 18.0, "num_module_steps_trained_lifetime_throughput": 641.6460154255503}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 998.0016398003509, "total_loss": 0.0, "weights_seq_no": 18.0, "curr_entropy_coeff": 0.0015431216992, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 107730, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 641.651068755645}, "__all_modules__": {"num_module_steps_trained_lifetime": 215460, "num_env_steps_trained_lifetime": 648000, "num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained": 36000, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 3862.3692609688865, "num_module_steps_trained_throughput": 19198179.26232049, "num_module_steps_trained_lifetime_throughput": 11270289.237518271}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_explained_var": -0.0015583038330078125, "vf_loss_unclipped": 41.447486877441406, "module_train_batch_size_mean": 997.4947003847115, "total_loss": 0.2484971284866333, "mean_kl_loss": 1.1078270290454384e-05, "weights_seq_no": 108.0, "entropy": 0.6769658923149109, "vf_loss": 0.32055091857910156, "policy_loss": -0.00018555403221398592, "num_module_steps_trained_lifetime": 646380, "diff_num_grad_updates_vs_sampler_policy": 91.0, "num_module_steps_trained": 35910, "use_intrinsic_rewards": 1.0}, "intrinsic_reward_module": {"weights_seq_no": 108.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 646380, "diff_num_grad_updates_vs_sampler_policy": 91.0, "module_train_batch_size_mean": 997.4947003847115, "total_loss": 0.0}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 1292760, "num_env_steps_trained_lifetime": 3888000, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 39423.437384804834}}}, "IntrinsicAttentionMask": [[[0.1666652411222458, 0.1669490933418274, 0.16620664298534393, 0.16621586680412292, 0.1669769436120987, 0.16698622703552246], [0.16666476428508759, 0.16702061891555786, 0.16609013080596924, 0.16610170900821686, 0.16705554723739624, 0.16706718504428864], [0.1666659116744995, 0.16683322191238403, 0.16639533638954163, 0.16640079021453857, 0.16684962809085846, 0.1668550968170166], [0.16666589677333832, 0.16683556139469147, 0.1663915365934372, 0.1663970649242401, 0.166852205991745, 0.1668577492237091], [0.166664719581604, 0.16702763736248016, 0.16607873141765594, 0.16609051823616028, 0.16706325113773346, 0.16707512736320496], [0.1666647046804428, 0.1670299768447876, 0.16607491672039032, 0.16608679294586182, 0.16706582903862, 0.16707777976989746]], [[0.1669292002916336, 0.1667216420173645, 0.1663578301668167, 0.1663559079170227, 0.1667158454656601, 0.1669195294380188], [0.16580961644649506, 0.16648486256599426, 0.1676771640777588, 0.16768351197242737, 0.16650377213954926, 0.1658410131931305], [0.16384759545326233, 0.16605541110038757, 0.17000426352024078, 0.17002545297145844, 0.16611751914024353, 0.16394975781440735], [0.16383720934391022, 0.16605308651924133, 0.17001663148403168, 0.1700379103422165, 0.1661154329776764, 0.16393974423408508], [0.16577838361263275, 0.16647818684577942, 0.16771411895751953, 0.16772069036960602, 0.16649778187274933, 0.16581089794635773], [0.16687703132629395, 0.1667107492685318, 0.16641917824745178, 0.16641762852668762, 0.16670610010623932, 0.16686928272247314]], [[0.16682706773281097, 0.16810251772403717, 0.16538690030574799, 0.1653960943222046, 0.16713906824588776, 0.16714836657047272], [0.16700217127799988, 0.1697389930486679, 0.16394032537937164, 0.16395977139472961, 0.16766946017742157, 0.16768936812877655], [0.16661888360977173, 0.16624975204467773, 0.16704009473323822, 0.16703738272190094, 0.16652825474739075, 0.16652555763721466], [0.16662026941776276, 0.16626161336898804, 0.1670294851064682, 0.16702686250209808, 0.1665322184562683, 0.166529580950737], [0.16687069833278656, 0.16850322484970093, 0.1650315374135971, 0.16504326462745667, 0.1672697365283966, 0.1672816127538681], [0.16687197983264923, 0.168515145778656, 0.16502094268798828, 0.165032759308815, 0.1672735959291458, 0.16728556156158447]], [[0.1663709282875061, 0.16637715697288513, 0.16755414009094238, 0.1675603985786438, 0.16573531925678253, 0.16640202701091766], [0.1663672775030136, 0.1663735806941986, 0.16756507754325867, 0.16757142543792725, 0.16572387516498566, 0.1663987636566162], [0.16567231714725494, 0.16569295525550842, 0.1696331948041916, 0.16965433955192566, 0.1635715216398239, 0.1657756119966507], [0.16566860675811768, 0.1656893491744995, 0.16964420676231384, 0.16966544091701508, 0.1635601669549942, 0.16577228903770447], [0.16674339771270752, 0.16674178838729858, 0.16643570363521576, 0.16643407940864563, 0.1669098436832428, 0.16673529148101807], [0.16635265946388245, 0.16635926067829132, 0.167608842253685, 0.16761550307273865, 0.16567806899547577, 0.16638566553592682]], [[0.1683274358510971, 0.16648265719413757, 0.16326645016670227, 0.16511012613773346, 0.16839787364006042, 0.16841548681259155], [0.16755780577659607, 0.16657085716724396, 0.16483798623085022, 0.1658332496881485, 0.16759537160396576, 0.16760477423667908], [0.16619189083576202, 0.16671496629714966, 0.1676449477672577, 0.16710899770259857, 0.1661720722913742, 0.16616711020469666], [0.16697867214679718, 0.16663388907909393, 0.1660252958536148, 0.16637533903121948, 0.16699177026748657, 0.16699504852294922], [0.16835662722587585, 0.1664792150259018, 0.16320699453353882, 0.1650826334953308, 0.16842831671237946, 0.16844624280929565], [0.16836392879486084, 0.16647836565971375, 0.16319212317466736, 0.16507576406002045, 0.1684359312057495, 0.16845393180847168]], [[0.16637170314788818, 0.16637791693210602, 0.16688981652259827, 0.16756117343902588, 0.16639657318592072, 0.16640280187129974], [0.16636806726455688, 0.16637437045574188, 0.16689257323741913, 0.16757221519947052, 0.16639326512813568, 0.16639955341815948], [0.16606897115707397, 0.16608154773712158, 0.1671174317598343, 0.16848094761371613, 0.16611924767494202, 0.16613182425498962], [0.16567713022232056, 0.1656978726387024, 0.1674099713563919, 0.16967417299747467, 0.1657600700855255, 0.16578081250190735], [0.1663571447134018, 0.1663636714220047, 0.16690078377723694, 0.16760532557964325, 0.1663832664489746, 0.16638977825641632], [0.1663535088300705, 0.16636011004447937, 0.1669035255908966, 0.1676163673400879, 0.1663799285888672, 0.16638652980327606]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "env_to_module_connector": {"connector_pipeline_timer": 5.916384187943935e-05, "timers": {"connectors": {"batch_individual_items": 1.2491893020766702e-05, "numpy_to_tensor": 1.1948287082660366e-05, "add_observations_from_episodes_to_batch": 2.837042268507572e-06, "add_states_from_episodes_to_batch": 2.633578824311921e-06, "add_time_dim_to_batch_and_zero_pad": 7.08863005200004e-06}}}, "weights_seq_no": 18.0, "rlmodule_inference_timer": 3.145061238326767e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1896870495778299e-05, "tensor_to_numpy": 1.536928470128538e-05, "normalize_and_clip_actions": 7.849770887267815e-06, "get_actions": 3.707927433570317e-05, "listify_data_for_vector_env": 1.0613639083302693e-05, "un_batch_to_individual_items": 6.525653696425134e-06}}, "connector_pipeline_timer": 0.00011537099211471619}, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 90400, "num_episodes_lifetime": 360, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "sample": 0.12204648624094135, "episode_duration_sec_mean": 0.005357231225352734, "module_episode_returns_mean": {"default_policy": 0.8}, "episode_len_max": 20, "episode_len_min": 20, "episode_return_max": 12.5, "env_step_timer": 1.4266565970435635e-05, "episode_return_min": -12.5, "episode_return_mean": 0.8, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.0005074214688745558, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 0.8}, "time_between_sampling": 10.923463705202018}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "ae8f9_00000", "date": "2025-08-11_18-17-43", "timestamp": 1754929063, "time_this_iter_s": 10.862077236175537, "time_total_s": 200.6690809726715, "pid": 10547, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3849f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 200.6690809726715, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 43.76666666666667, "ram_util_percent": 81.50666666666666}}
{"timers": {"training_iteration": 10.974684945064013, "restore_env_runners": 1.1428522361449754e-05, "training_step": 10.974509779562826, "env_runner_sampling_timer": 1.8569135397916743, "learner_update_timer": 8.90659847523227, "synch_weights": 0.0014759613642827036, "restore_eval_env_runners": 1.8455654170181765e-05, "evaluation_iteration": 0.1326484186894963, "synch_eval_env_connectors": 0.00017579623115709516, "synch_env_connectors": 5.557853579136284e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.388914934668162e-06, "add_observations_from_episodes_to_batch": 2.9500104170364335e-06, "add_states_from_episodes_to_batch": 2.9584996614428103e-06, "batch_individual_items": 1.3033725657676344e-05, "numpy_to_tensor": 1.3566543288327646e-05}}, "connector_pipeline_timer": 6.277989484352441e-05}, "episode_len_mean": 20.0, "sample": 0.005943397190106585, "weights_seq_no": 18.0, "episode_duration_sec_mean": 0.005643936834298076, "episode_len_max": 20, "rlmodule_inference_timer": 3.494209846541017e-05, "module_to_env_connector": {"connector_pipeline_timer": 0.0001270019814382722, "timers": {"connectors": {"tensor_to_numpy": 1.6638386733079353e-05, "listify_data_for_vector_env": 1.1159127304348006e-05, "normalize_and_clip_actions": 8.489158254597779e-06, "get_actions": 4.365687463469892e-05, "remove_single_ts_time_rank_from_batch": 1.2342031958320238e-05, "un_batch_to_individual_items": 6.963617973447754e-06}}}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 4.4787613844629664e-05, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_return_max": 9.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 1.5800000000000005}, "env_step_timer": 1.4789936587285605e-05, "agent_episode_returns_mean": {"default_agent": 1.5800000000000005}, "time_between_sampling": 0.03799643493564332, "num_env_steps_sampled_lifetime": -10487500.0, "num_episodes_lifetime": -524375.0, "episode_return_min": -10.5, "episode_return_mean": 1.5800000000000005, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3068.8004819019716}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1696772085640965, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00937348502975401, "add_observations_from_episodes_to_batch": 0.0008652469397762857, "add_columns_from_episodes_to_train_batch": 0.043328285939391434, "add_time_dim_to_batch_and_zero_pad": 0.10148159316390926, "add_states_from_episodes_to_batch": 0.003948669671959239, "batch_individual_items": 0.010374634419169769, "numpy_to_tensor": 8.344239710346147e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"vf_explained_var": -0.0002459287643432617, "vf_loss_unclipped": 42.741676330566406, "module_train_batch_size_mean": 997.9718428097785, "policy_loss": -0.00010939703497570008, "mean_kl_loss": 1.3434510947263334e-05, "entropy": 0.6751120686531067, "num_module_steps_trained": 5985, "curr_kl_coeff": 3.0819688845440396e-07, "curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.3205171227455139, "num_module_steps_trained_lifetime": 113715, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.2485479861497879, "num_trainable_parameters": 16595, "weights_seq_no": 19.0, "num_module_steps_trained_lifetime_throughput": 640.520820993563}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 997.9718428097785, "total_loss": 0.0, "weights_seq_no": 19.0, "curr_entropy_coeff": 0.0015431216992, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 113715, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 640.525589442598}, "__all_modules__": {"num_module_steps_trained_lifetime": 227430, "num_env_steps_trained_lifetime": 684000, "num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained": 36000, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 3855.5026336265087, "num_module_steps_trained_throughput": 18780859.634332873, "num_module_steps_trained_lifetime_throughput": 11272034.178182367}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_explained_var": -0.001421213150024414, "vf_loss_unclipped": 42.75252151489258, "module_train_batch_size_mean": 997.4940209352853, "total_loss": 0.2485690414905548, "mean_kl_loss": 1.2995323231734801e-05, "weights_seq_no": 114.0, "entropy": 0.6751284599304199, "vf_loss": 0.32053783535957336, "policy_loss": -0.00010656493395799771, "num_module_steps_trained_lifetime": 682290, "diff_num_grad_updates_vs_sampler_policy": 96.0, "num_module_steps_trained": 35910, "use_intrinsic_rewards": 1.0}, "intrinsic_reward_module": {"weights_seq_no": 114.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 682290, "diff_num_grad_updates_vs_sampler_policy": 96.0, "module_train_batch_size_mean": 997.4940209352853, "total_loss": 0.0}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 1364580, "num_env_steps_trained_lifetime": 4104000, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 39014.756811331936}}}, "IntrinsicAttentionMask": [[[0.16833370923995972, 0.16835132241249084, 0.16509900987148285, 0.16511628031730652, 0.16654111444950104, 0.16655853390693665], [0.16834105551242828, 0.16835874319076538, 0.1650920957326889, 0.16510944068431854, 0.16654053330421448, 0.16655802726745605], [0.16697156429290771, 0.1669747531414032, 0.1663791984319687, 0.16638238728046417, 0.16664445400238037, 0.16664762794971466], [0.1669788807630539, 0.16698215901851654, 0.16637229919433594, 0.1663755476474762, 0.1666439026594162, 0.16664718091487885], [0.16758161783218384, 0.16759124398231506, 0.16580502688884735, 0.1658145636320114, 0.16659899055957794, 0.16660857200622559], [0.1675889492034912, 0.1675986647605896, 0.1657981276512146, 0.16580773890018463, 0.16659843921661377, 0.16660809516906738]], [[0.16682645678520203, 0.16661903262138367, 0.16646048426628113, 0.16645854711532593, 0.16681872308254242, 0.16681678593158722], [0.16614466905593872, 0.16682128608226776, 0.16734087467193604, 0.16734720766544342, 0.16616983711719513, 0.16617612540721893], [0.16562293469905853, 0.1669742614030838, 0.16801570355892181, 0.16802842915058136, 0.16567307710647583, 0.16568560898303986], [0.16561655700206757, 0.16697609424591064, 0.16802392899990082, 0.16803671419620514, 0.16566701233386993, 0.16567963361740112], [0.16680105030536652, 0.16662660241127014, 0.1664932370185852, 0.16649162769317627, 0.166794553399086, 0.16679291427135468], [0.16679471731185913, 0.16662850975990295, 0.16650144755840302, 0.16649989783763885, 0.1667885184288025, 0.16678696870803833]], [[0.16633574664592743, 0.16760744154453278, 0.1658780425786972, 0.1658872663974762, 0.1666468232870102, 0.16764472424983978], [0.16595734655857086, 0.16867704689502716, 0.16498422622680664, 0.16500380635261536, 0.16662046313285828, 0.1687571406364441], [0.16647185385227203, 0.16722112894058228, 0.16620159149169922, 0.16620704531669617, 0.16665534675121307, 0.16724306344985962], [0.16646911203861237, 0.16722892224788666, 0.1661950647830963, 0.16620059311389923, 0.16665519773960114, 0.16725116968154907], [0.16624321043491364, 0.16786959767341614, 0.16565869748592377, 0.1656704694032669, 0.1666407287120819, 0.16791732609272003], [0.16594624519348145, 0.16870832443237305, 0.1649581342935562, 0.1649780124425888, 0.16661962866783142, 0.16878966987133026]], [[0.16659100353717804, 0.1659359335899353, 0.16777576506137848, 0.1677820384502411, 0.16595454514026642, 0.16596074402332306], [0.16668842732906342, 0.16688397526741028, 0.1663372665643692, 0.16633541882038116, 0.16687840223312378, 0.16687653958797455], [0.16639886796474457, 0.1642274260520935, 0.17037713527679443, 0.17039836943149567, 0.16428886353969574, 0.1643093377351761], [0.1663978099822998, 0.16421841084957123, 0.17039090394973755, 0.17041222751140594, 0.16428007185459137, 0.16430062055587769], [0.16668573021888733, 0.16685698926448822, 0.16637814044952393, 0.1663765162229538, 0.16685210168361664, 0.1668504923582077], [0.1666848510503769, 0.16684800386428833, 0.1663917750120163, 0.16639022529125214, 0.16684335470199585, 0.1668418049812317]], [[0.166498601436615, 0.16777156293392181, 0.16506128013134003, 0.16604968905448914, 0.16680999100208282, 0.1678088754415512], [0.16630151867866516, 0.16902685165405273, 0.16325250267982483, 0.16534598171710968, 0.1669660061597824, 0.1691071093082428], [0.1667145937681198, 0.1663452535867691, 0.1671360433101654, 0.16684572398662567, 0.16662390530109406, 0.16633448004722595], [0.16656681895256042, 0.16732709109783173, 0.16570556163787842, 0.16629815101623535, 0.16675300896167755, 0.16734933853149414], [0.16645090281963348, 0.16807931661605835, 0.16461634635925293, 0.16587743163108826, 0.16684891283512115, 0.16812710464000702], [0.16629564762115479, 0.169063538312912, 0.16319987177848816, 0.1653253734111786, 0.16697044670581818, 0.16914506256580353]], [[0.16626112163066864, 0.16626733541488647, 0.16744354367256165, 0.16744980216026306, 0.16628597676753998, 0.166292205452919], [0.1662561297416687, 0.1662624329328537, 0.16745314002037048, 0.16745947301387787, 0.1662812978029251, 0.1662876009941101], [0.16531136631965637, 0.16533198952674866, 0.16926363110542297, 0.16928473114967346, 0.16539382934570312, 0.1654144525527954], [0.16530635952949524, 0.1653270423412323, 0.1692732721567154, 0.16929444670677185, 0.16538910567760468, 0.16540980339050293], [0.1662411242723465, 0.1662476360797882, 0.16748185455799103, 0.16748842597007751, 0.16626720130443573, 0.16627372801303864], [0.16623611748218536, 0.16624271869659424, 0.16749143600463867, 0.16749808192253113, 0.16626250743865967, 0.16626910865306854]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "env_to_module_connector": {"connector_pipeline_timer": 6.016401717434343e-05, "timers": {"connectors": {"batch_individual_items": 1.2635546532084358e-05, "numpy_to_tensor": 1.25625120710678e-05, "add_observations_from_episodes_to_batch": 2.901508807847432e-06, "add_states_from_episodes_to_batch": 2.6985154158596175e-06, "add_time_dim_to_batch_and_zero_pad": 7.116503252253056e-06}}}, "weights_seq_no": 19.0, "rlmodule_inference_timer": 3.2846147662246116e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2062499905905822e-05, "tensor_to_numpy": 1.5855900020003718e-05, "normalize_and_clip_actions": 8.051314730680087e-06, "get_actions": 3.9223697140226156e-05, "listify_data_for_vector_env": 1.059197979160257e-05, "un_batch_to_individual_items": 6.777347015506663e-06}}, "connector_pipeline_timer": 0.00011883816170226151}, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 95400, "num_episodes_lifetime": 380, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "sample": 0.12204731846847373, "episode_duration_sec_mean": 0.005398840398993343, "module_episode_returns_mean": {"default_policy": 1.6}, "episode_len_max": 20, "episode_len_min": 20, "episode_return_max": 12.5, "env_step_timer": 1.4645278969473208e-05, "episode_return_min": -12.5, "episode_return_mean": 1.6, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.0005074385048270816, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 1.6}, "time_between_sampling": 10.918905090650496}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "ae8f9_00000", "date": "2025-08-11_18-17-53", "timestamp": 1754929073, "time_this_iter_s": 10.56948184967041, "time_total_s": 211.23856282234192, "pid": 10547, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3849f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 211.23856282234192, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 42.5, "ram_util_percent": 81.1}}
{"timers": {"training_iteration": 10.990348700204388, "restore_env_runners": 1.1431737450461619e-05, "training_step": 10.990173159266348, "env_runner_sampling_timer": 1.8568788156439056, "learner_update_timer": 8.921692607149902, "synch_weights": 0.0014735996704213826, "restore_eval_env_runners": 1.8727766996329776e-05, "evaluation_iteration": 0.1326417990823106, "synch_eval_env_connectors": 0.00017587784862704161, "synch_env_connectors": 5.5406152654354035e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 8.209837989172152e-06, "add_observations_from_episodes_to_batch": 3.201376759537299e-06, "add_states_from_episodes_to_batch": 3.2109164886747406e-06, "batch_individual_items": 1.4637633243528695e-05, "numpy_to_tensor": 1.5194614782218486e-05}}, "connector_pipeline_timer": 6.917527594738132e-05}, "episode_len_mean": 20.0, "sample": 0.006296911128079147, "weights_seq_no": 19.0, "episode_duration_sec_mean": 0.006336520685814323, "episode_len_max": 20, "rlmodule_inference_timer": 3.777481751343269e-05, "module_to_env_connector": {"connector_pipeline_timer": 0.00013904473969073323, "timers": {"connectors": {"tensor_to_numpy": 1.7818419119259993e-05, "listify_data_for_vector_env": 1.2088403100201268e-05, "normalize_and_clip_actions": 9.371836119326611e-06, "get_actions": 4.958328113132735e-05, "remove_single_ts_time_rank_from_batch": 1.3141663235900072e-05, "un_batch_to_individual_items": 7.337338624723851e-06}}}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 4.7963135692735004e-05, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_return_max": 9.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 1.74}, "env_step_timer": 1.6147978094640948e-05, "agent_episode_returns_mean": {"default_agent": 1.74}, "time_between_sampling": 0.036466884554369354, "num_env_steps_sampled_lifetime": -11105000.0, "num_episodes_lifetime": -555250.0, "episode_return_min": -10.5, "episode_return_mean": 1.74, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 2978.5082517552687}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.16991027689836263, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009464580179382039, "add_observations_from_episodes_to_batch": 0.0008655140505196053, "add_columns_from_episodes_to_train_batch": 0.04347716640923373, "add_time_dim_to_batch_and_zero_pad": 0.10148296973251686, "add_states_from_episodes_to_batch": 0.00396354506554414, "batch_individual_items": 0.010351503075311708, "numpy_to_tensor": 8.344630314796698e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"vf_explained_var": 0.0003129243850708008, "vf_loss_unclipped": 42.40892028808594, "module_train_batch_size_mean": 997.9437895346426, "policy_loss": -0.0001216882883454673, "mean_kl_loss": 1.3157406328900834e-06, "entropy": 0.6756014227867126, "num_module_steps_trained": 5985, "curr_kl_coeff": 1.5409844422720198e-07, "curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.32051804661750793, "num_module_steps_trained_lifetime": 119700, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.24853570759296417, "num_trainable_parameters": 16595, "weights_seq_no": 20.0, "num_module_steps_trained_lifetime_throughput": 638.4737442238968}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "module_train_batch_size_mean": 997.9437895346426, "total_loss": 0.0, "weights_seq_no": 20.0, "curr_entropy_coeff": 0.0015431216992, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 119700, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 638.4783254808136}, "__all_modules__": {"num_module_steps_trained_lifetime": 239400, "num_env_steps_trained_lifetime": 720000, "num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained": 36000, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 3843.098865396026, "num_module_steps_trained_throughput": 18343657.110948775, "num_module_steps_trained_lifetime_throughput": 11237136.902821433}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_explained_var": -0.0014367103576660156, "vf_loss_unclipped": 42.46110916137695, "module_train_batch_size_mean": 997.4935477577241, "total_loss": 0.24856160581111908, "mean_kl_loss": 9.8473333309812e-07, "weights_seq_no": 120.0, "entropy": 0.6755598783493042, "vf_loss": 0.3205353021621704, "policy_loss": -0.00010941953951260075, "num_module_steps_trained_lifetime": 718200, "diff_num_grad_updates_vs_sampler_policy": 101.0, "num_module_steps_trained": 35910, "use_intrinsic_rewards": 1.0}, "intrinsic_reward_module": {"weights_seq_no": 120.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 718200, "diff_num_grad_updates_vs_sampler_policy": 101.0, "module_train_batch_size_mean": 997.4935477577241, "total_loss": 0.0}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 1436400, "num_env_steps_trained_lifetime": 4320000, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 38593.27905275182}}}, "IntrinsicAttentionMask": [[[0.16682875156402588, 0.16711287200450897, 0.1653885692358017, 0.1663789451122284, 0.16714075207710266, 0.16715005040168762], [0.16686949133872986, 0.16722577810287476, 0.16506588459014893, 0.16630573570728302, 0.16726075112819672, 0.1672724038362503], [0.16661904752254486, 0.16653650999069214, 0.16704025864601135, 0.16675010323524475, 0.16652841866016388, 0.1665257215499878], [0.16676385700702667, 0.16693361103534698, 0.1659015715122223, 0.16649486124515533, 0.1669502556324005, 0.16695581376552582], [0.16687346994876862, 0.1672368347644806, 0.16503426432609558, 0.16629855334758759, 0.16727249324321747, 0.16728438436985016], [0.16687479615211487, 0.16724053025245667, 0.16502374410629272, 0.16629616916179657, 0.16727642714977264, 0.1672883927822113]], [[0.16708914935588837, 0.1666373312473297, 0.1662924438714981, 0.16628825664520264, 0.16707229614257812, 0.16662052273750305], [0.16626131534576416, 0.1666942685842514, 0.1670263111591339, 0.16703034937381744, 0.1662774235010147, 0.16671040654182434], [0.16562899947166443, 0.1667361855506897, 0.16758836805820465, 0.16759876906871796, 0.16567012667655945, 0.166777566075325], [0.1656213104724884, 0.1667366772890091, 0.16759520769119263, 0.1676056832075119, 0.1656627207994461, 0.16677837073802948], [0.16705827414989471, 0.16663949191570282, 0.16631977260112762, 0.16631588339805603, 0.16704265773296356, 0.16662392020225525], [0.16623049974441528, 0.16669632494449615, 0.16705365478992462, 0.16705800592899323, 0.16624782979488373, 0.16671371459960938]], [[0.16864164173603058, 0.16679342091083527, 0.16357119381427765, 0.16541831195354462, 0.16871219873428345, 0.16686320304870605], [0.16772493720054626, 0.16673700511455536, 0.16500240564346313, 0.1659986674785614, 0.16776254773139954, 0.16677440702915192], [0.16610419750213623, 0.16662698984146118, 0.16755647957324982, 0.16702081263065338, 0.1660843789577484, 0.1666071116924286], [0.16703681647777557, 0.16669189929962158, 0.16608309745788574, 0.16643327474594116, 0.16704991459846497, 0.16670498251914978], [0.1686764508485794, 0.16679547727108002, 0.163517028093338, 0.16539622843265533, 0.16874827444553375, 0.1668664962053299], [0.1677597165107727, 0.16673922538757324, 0.16494792699813843, 0.16597667336463928, 0.16779857873916626, 0.1667778491973877]], [[0.16659176349639893, 0.1659366935491562, 0.16711057722568512, 0.16778281331062317, 0.16661667823791504, 0.16596151888370514], [0.16668850183486938, 0.16688404977321625, 0.16653433442115784, 0.16633549332618713, 0.16668108105659485, 0.16687661409378052], [0.16651250422000885, 0.1651899218559265, 0.1675637662410736, 0.16893091797828674, 0.16656291484832764, 0.16523993015289307], [0.16640639305114746, 0.16422688961029053, 0.16814684867858887, 0.17042101919651031, 0.16648969054222107, 0.16430909931659698], [0.16658802330493927, 0.16590076684951782, 0.1671324074268341, 0.1678379327058792, 0.16661417484283447, 0.16592679917812347], [0.16668491065502167, 0.1668480634689331, 0.166556254029274, 0.1663902848958969, 0.16667871177196503, 0.16684186458587646]], [[0.16682706773281097, 0.16810251772403717, 0.16538690030574799, 0.1653960943222046, 0.16713906824588776, 0.16714836657047272], [0.16700217127799988, 0.1697389930486679, 0.16394032537937164, 0.16395977139472961, 0.16766946017742157, 0.16768936812877655], [0.16661888360977173, 0.16624975204467773, 0.16704009473323822, 0.16703738272190094, 0.16652825474739075, 0.16652555763721466], [0.16662026941776276, 0.16626161336898804, 0.1670294851064682, 0.16702686250209808, 0.1665322184562683, 0.1665295958518982], [0.16687069833278656, 0.16850322484970093, 0.1650315374135971, 0.16504326462745667, 0.1672697365283966, 0.1672816127538681], [0.16687197983264923, 0.168515145778656, 0.16502094268798828, 0.165032759308815, 0.1672735959291458, 0.16728556156158447]], [[0.1667027771472931, 0.16604727506637573, 0.16722193360328674, 0.16722817718982697, 0.1667277216911316, 0.16607210040092468], [0.16665564477443695, 0.16685116291046143, 0.1665015071630478, 0.16649965941905975, 0.1666482388973236, 0.1668437272310257], [0.166738361120224, 0.1654139757156372, 0.16779103875160217, 0.16780373454093933, 0.16678884625434875, 0.16546405851840973], [0.16673877835273743, 0.16540637612342834, 0.16779789328575134, 0.16781066358089447, 0.16678957641124725, 0.16545675694942474], [0.16670453548431396, 0.16601680219173431, 0.16724930703639984, 0.16725586354732513, 0.16673070192337036, 0.16604286432266235], [0.166657492518425, 0.16682061553001404, 0.1665288507938385, 0.16652731597423553, 0.16665129363536835, 0.1668144166469574]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "env_to_module_connector": {"connector_pipeline_timer": 6.544251107558845e-05, "timers": {"connectors": {"batch_individual_items": 1.418176301044475e-05, "numpy_to_tensor": 1.3640779002562274e-05, "add_observations_from_episodes_to_batch": 3.0632317384801024e-06, "add_states_from_episodes_to_batch": 2.8616564396213153e-06, "add_time_dim_to_batch_and_zero_pad": 7.656537414619932e-06}}}, "weights_seq_no": 20.0, "rlmodule_inference_timer": 3.6336218295440066e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2723522032851627e-05, "tensor_to_numpy": 1.668698349816859e-05, "normalize_and_clip_actions": 8.222477684781564e-06, "get_actions": 4.3751056051841095e-05, "listify_data_for_vector_env": 1.1122141456903916e-05, "un_batch_to_individual_items": 6.876486408023142e-06}}, "connector_pipeline_timer": 0.0001274926419883413}, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 100400, "num_episodes_lifetime": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "sample": 0.12218723319417926, "episode_duration_sec_mean": 0.005586231995839626, "module_episode_returns_mean": {"default_policy": 0.2}, "episode_len_max": 20, "episode_len_min": 20, "episode_return_max": 12.5, "env_step_timer": 1.6272371117299573e-05, "episode_return_min": -12.5, "episode_return_mean": 0.2, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.0005065399594916542, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 0.2}, "time_between_sampling": 10.93545137057362}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "ae8f9_00000", "date": "2025-08-11_18-18-06", "timestamp": 1754929086, "time_this_iter_s": 12.691051006317139, "time_total_s": 223.92961382865906, "pid": 10547, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3849f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 223.92961382865906, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 62.71111111111111, "ram_util_percent": 82.04444444444445}}
