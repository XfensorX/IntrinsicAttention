{"timers": {"training_iteration": 10.20457333396189, "restore_env_runners": 9.332899935543537e-06, "training_step": 10.20437366690021, "env_runner_sampling_timer": 1.665127333952114, "learner_update_timer": 8.363843375002034, "synch_weights": 0.0017480830429121852}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.360178502429659e-05, "add_observations_from_episodes_to_batch": 3.01263553290507e-06, "batch_individual_items": 1.3043024045224833e-05, "add_time_dim_to_batch_and_zero_pad": 7.504699093975092e-06, "add_states_from_episodes_to_batch": 2.854376531894074e-06}}, "connector_pipeline_timer": 6.411580624874869e-05}, "module_to_env_connector": {"connector_pipeline_timer": 0.00013715053620278877, "timers": {"connectors": {"get_actions": 5.2741744874791644e-05, "normalize_and_clip_actions": 1.0517937039671365e-05, "un_batch_to_individual_items": 6.842570445483032e-06, "listify_data_for_vector_env": 1.0896128074982073e-05, "tensor_to_numpy": 1.644402453611271e-05, "remove_single_ts_time_rank_from_batch": 1.2238575373784538e-05}}}, "weights_seq_no": 0.0, "episode_return_max": 14.5, "episode_duration_sec_mean": 0.005414194974582641, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "env_reset_timer": 8.984530840985224e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": 31375.0, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "episode_return_min": -5.5, "agent_episode_returns_mean": {"default_agent": 4.019999999999998}, "num_env_steps_sampled_lifetime": 627500.0, "env_to_module_sum_episodes_length_out": 10.191744832559449, "num_env_steps_sampled": 5000.0, "env_step_timer": 1.5473271214109286e-05, "time_between_sampling": 0.0006699605242304821, "num_episodes": 250.0, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 4.019999999999998}, "sample": 0.006894829245828052, "env_to_module_sum_episodes_length_in": 10.191744832559449, "rlmodule_inference_timer": 3.839222991571349e-05, "episode_return_mean": 4.019999999999998, "episode_len_max": 20, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 2992.9337185361055}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000, "learner_connector": {"connector_pipeline_timer": 0.1354907921049744, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009390374994836748, "add_observations_from_episodes_to_batch": 0.0008383330423384905, "add_columns_from_episodes_to_train_batch": 0.04173691594041884, "add_time_dim_to_batch_and_zero_pad": 0.07580629200674593, "add_states_from_episodes_to_batch": 0.003487083944492042, "batch_individual_items": 0.003983917064033449, "numpy_to_tensor": 7.633294444531202e-05}}}, "learner_connector_sum_episodes_length_out": 5250}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 35910, "module_train_batch_size_mean": 997.8474438281662, "vf_explained_var": 0.0019511580467224121, "total_loss": 0.27862077951431274, "weights_seq_no": 6.0, "vf_loss_unclipped": 42.293846130371094, "diff_num_grad_updates_vs_sampler_policy": 6.0, "entropy": 0.6929816603660583, "vf_loss": 0.35948583483695984, "policy_loss": -0.00037077179877087474, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 1.916955443448387e-05}, "__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 71820, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 198000, "num_env_steps_trained_lifetime_throughput": 55746.731851550474}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 6.0, "num_module_steps_trained": 35910, "total_loss": 0.0, "num_module_steps_trained_lifetime": 35910, "module_train_batch_size_mean": 997.8474438281662, "weights_seq_no": 6.0}}}, "intrinsic_reward_module": {"total_loss": 0.0, "weights_seq_no": 1.0, "num_trainable_parameters": 8266, "num_module_steps_trained_lifetime": 5985, "module_train_batch_size_mean": 997.9705930399, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 718.8598173891875}, "default_policy": {"use_intrinsic_rewards": 0.0, "num_trainable_parameters": 16595, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 5985, "module_train_batch_size_mean": 997.9705930399, "vf_explained_var": 0.005554258823394775, "total_loss": 0.27779632806777954, "weights_seq_no": 1.0, "mean_kl_loss": 2.1166335500311106e-05, "vf_loss_unclipped": 41.9501953125, "curr_kl_coeff": 0.08079196512699127, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.6929765343666077, "vf_loss": 0.35845115780830383, "curr_entropy_coeff": 0.0015431216992, "policy_loss": -0.00038948148721829057, "num_module_steps_trained_lifetime_throughput": 718.8469674529873}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 11970, "num_env_steps_trained_lifetime": 33000, "num_env_steps_trained": 33000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 3965.313174469928, "num_module_steps_trained_throughput": 32262439.022852242, "num_module_steps_trained_lifetime_throughput": 12992879.09421879}, "IntrinsicAttentionMask": [[[0.09096062928438187, 0.09050372987985611, 0.09024400264024734, 0.09117308259010315, 0.09091143310070038, 0.09089913964271545, 0.09113609790802002, 0.0908745527267456, 0.0911114439368248, 0.09109912067651749, 0.09108680486679077], [0.09092962741851807, 0.09074822813272476, 0.09064487367868423, 0.09101378172636032, 0.09091012179851532, 0.09090524911880493, 0.09099914133548737, 0.09089549630880356, 0.0909893736243248, 0.09098450094461441, 0.09097961336374283], [0.09091179072856903, 0.09088792651891708, 0.09087430685758591, 0.09092285484075546, 0.09090922772884369, 0.09090859442949295, 0.09092093259096146, 0.09090730547904968, 0.09091964364051819, 0.09091901034116745, 0.09091836959123611], [0.09097490459680557, 0.09039058536291122, 0.09005879610776901, 0.09124687314033508, 0.09091194719076157, 0.09089621156454086, 0.09119950979948044, 0.09086475521326065, 0.09116794914007187, 0.09115216881036758, 0.0911363959312439], [0.09095731377601624, 0.09052997827529907, 0.09028699994087219, 0.09115596860647202, 0.09091130644083023, 0.09089981019496918, 0.0911213830113411, 0.09087681770324707, 0.09109833836555481, 0.09108681231737137, 0.09107529371976852], [0.09095647931098938, 0.09053653478622437, 0.09029775112867355, 0.09115168452262878, 0.09091126918792725, 0.09089997410774231, 0.09111770242452621, 0.09087737649679184, 0.09109505265951157, 0.09108373522758484, 0.09107241034507751], [0.0909724310040474, 0.0904102623462677, 0.09009099006652832, 0.09123404324054718, 0.090911865234375, 0.09089673310518265, 0.09118848294019699, 0.09086646884679794, 0.09115812182426453, 0.09114295244216919, 0.09112777560949326], [0.09095482528209686, 0.09054967015981674, 0.09031926095485687, 0.09114313125610352, 0.09091120958328247, 0.09090030938386917, 0.09111034870147705, 0.09087850898504257, 0.09108850359916687, 0.09107758104801178, 0.09106666594743729], [0.09097075462341309, 0.09042336046695709, 0.09011244028806686, 0.09122546762228012, 0.09091178327798843, 0.09089705348014832, 0.09118111431598663, 0.09086758643388748, 0.09115155786275864, 0.09113678336143494, 0.09112200886011124], [0.09096994251012802, 0.09042992442846298, 0.09012318402528763, 0.09122119843959808, 0.09091176837682724, 0.09089723229408264, 0.09117744863033295, 0.09086816757917404, 0.09114829450845718, 0.091133713722229, 0.09111914038658142], [0.09096911549568176, 0.09043648838996887, 0.0901339203119278, 0.09121692180633545, 0.09091173857450485, 0.09089740365743637, 0.09117376804351807, 0.09086873382329941, 0.09114501625299454, 0.09113064408302307, 0.09111626446247101]], [[0.0902850329875946, 0.08958988636732101, 0.09021937847137451, 0.08835254609584808, 0.08767227828502655, 0.09012096375226974, 0.08825618773698807, 0.08939455449581146, 0.10862232744693756, 0.08841658383607864, 0.08907022327184677], [0.09038317203521729, 0.08977607637643814, 0.09032585471868515, 0.08869398385286331, 0.08809824287891388, 0.09023994207382202, 0.08860962837934494, 0.08960538357496262, 0.10619592666625977, 0.08875003457069397, 0.08932185173034668], [0.09029451012611389, 0.08960763365030289, 0.09022963792085648, 0.08838487416505814, 0.08771251887083054, 0.09013240784406662, 0.08828962594270706, 0.08941462635993958, 0.1083918884396553, 0.08844815939664841, 0.0890941247344017], [0.09054586291313171, 0.09009798616170883, 0.09050361067056656, 0.08929768949747086, 0.08885598927736282, 0.09044026583433151, 0.08923520147800446, 0.08997191488742828, 0.10194984823465347, 0.08933921158313751, 0.0897623673081398], [0.09062876552343369, 0.0902697816491127, 0.09059491008520126, 0.08962742984294891, 0.0892724096775055, 0.09054415673017502, 0.08957722038030624, 0.09016866236925125, 0.09965542703866959, 0.08966077864170074, 0.09000053256750107], [0.09030862897634506, 0.08963416516780853, 0.09024492651224136, 0.08843327313661575, 0.08777282387018204, 0.09014945477247238, 0.08833972364664078, 0.08944462984800339, 0.1080470159649849, 0.08849544078111649, 0.08912987262010574], [0.09055788815021515, 0.09012254327535629, 0.0905168205499649, 0.08934449404478073, 0.08891499042510986, 0.09045525640249252, 0.08928373456001282, 0.08999999612569809, 0.10162308812141418, 0.08938486129045486, 0.089796282351017], [0.09040988236665726, 0.08982770144939423, 0.09035491943359375, 0.08878962695598602, 0.08821789175271988, 0.09027254581451416, 0.08870868384838104, 0.08966399729251862, 0.10551942139863968, 0.08884341269731522, 0.08939202129840851], [0.08606415241956711, 0.08340315520763397, 0.0858101099729538, 0.07882069796323776, 0.07638365775346756, 0.08543043583631516, 0.07847195118665695, 0.08266673982143402, 0.18244121968746185, 0.07905308157205582, 0.0814548060297966], [0.09053783118724823, 0.09008163958787918, 0.0904947966337204, 0.0892665907740593, 0.08881679177284241, 0.09043026715517044, 0.08920294791460037, 0.0899532288312912, 0.10216730833053589, 0.08930886536836624, 0.08973980695009232], [0.0904533714056015, 0.08991275727748871, 0.09040234237909317, 0.08894815295934677, 0.08841653913259506, 0.09032586216926575, 0.08887290209531784, 0.0897606834769249, 0.10440125316381454, 0.08899815380573273, 0.08950801193714142]], [[0.09098329395055771, 0.090526282787323, 0.09026648849248886, 0.09119579941034317, 0.09093409031629562, 0.0909217894077301, 0.09115880727767944, 0.09089719504117966, 0.09088490158319473, 0.09112182259559631, 0.091109499335289], [0.09093861281871796, 0.09075719863176346, 0.09065382927656174, 0.09102277457714081, 0.09091909974813461, 0.09091422706842422, 0.09100813418626785, 0.09090447425842285, 0.09089959412813187, 0.0909934863448143, 0.09098860621452332], [0.09091297537088394, 0.090889111161232, 0.09087549149990082, 0.09092403948307037, 0.0909104123711586, 0.09090977907180786, 0.09092211723327637, 0.0909084901213646, 0.09090784937143326, 0.09092019498348236, 0.09091955423355103], [0.09100391715765, 0.09041941165924072, 0.09008751809597015, 0.09127597510814667, 0.0909409373998642, 0.0909252017736435, 0.09122859686613083, 0.09089373052120209, 0.09087800234556198, 0.09118124097585678, 0.0911654606461525], [0.09097851067781448, 0.09055107831954956, 0.0903080403804779, 0.09117721021175385, 0.09093248844146729, 0.09092099219560623, 0.09114261716604233, 0.09089799225330353, 0.09088649600744247, 0.091108039021492, 0.09109652042388916], [0.09097731113433838, 0.0905572772026062, 0.09031842648983002, 0.09117256104946136, 0.09093209356069565, 0.09092079102993011, 0.0911385715007782, 0.09089819341897964, 0.09088689833879471, 0.09110459685325623, 0.0910932719707489], [0.09100034087896347, 0.09043800085783005, 0.09011863172054291, 0.09126203507184982, 0.09093976020812988, 0.09092462062835693, 0.09121645987033844, 0.09089434891939163, 0.09087921679019928, 0.09117091447114944, 0.09115573018789291], [0.09097491949796677, 0.09056968241930008, 0.09033921360969543, 0.091163270175457, 0.09093129634857178, 0.09092038869857788, 0.09113048017024994, 0.09089858829975128, 0.09088769555091858, 0.09109770506620407, 0.09108678251504898], [0.09097371995449066, 0.09057587385177612, 0.09034960716962814, 0.09115862101316452, 0.09093089401721954, 0.09092018753290176, 0.09112643450498581, 0.0908987894654274, 0.09088809043169022, 0.0910942554473877, 0.09108353406190872], [0.09099674969911575, 0.09045658260583878, 0.09014974534511566, 0.09124808013439178, 0.09093856066465378, 0.09092401713132858, 0.09120431542396545, 0.09089494496583939, 0.09088040888309479, 0.09116057306528091, 0.09114599227905273], [0.09099555760622025, 0.09046278148889542, 0.09016012400388718, 0.0912434384226799, 0.09093816578388214, 0.09092382341623306, 0.09120026975870132, 0.0908951461315155, 0.09088081121444702, 0.09115713089704514, 0.09114275127649307]], [[0.09157226234674454, 0.09156209230422974, 0.09175817668437958, 0.09096892178058624, 0.09095881134271622, 0.09152138978242874, 0.09093859046697617, 0.09150105714797974, 0.08565516024827957, 0.0911940485239029, 0.09236950427293777], [0.09155945479869843, 0.09154947847127914, 0.0917416661977768, 0.0909680500626564, 0.09095814824104309, 0.09150958806276321, 0.09093832224607468, 0.09148965775966644, 0.0857560932636261, 0.09118873625993729, 0.09234078973531723], [0.0918041244149208, 0.09179025888442993, 0.09205768257379532, 0.09098251163959503, 0.09096875786781311, 0.09173477441072464, 0.09094126522541046, 0.09170705080032349, 0.08383195102214813, 0.09128884971141815, 0.09289277344942093], [0.09079129993915558, 0.09079305082559586, 0.09075941145420074, 0.09089533984661102, 0.0908970907330513, 0.09080004692077637, 0.09090059250593185, 0.09080354124307632, 0.09184812009334564, 0.09085642546415329, 0.09065505862236023], [0.09077782928943634, 0.09077978134155273, 0.0907423123717308, 0.0908937081694603, 0.09089566022157669, 0.09078757464885712, 0.09089955687522888, 0.09079146385192871, 0.09195557981729507, 0.09085036814212799, 0.09062610566616058], [0.09150811284780502, 0.0914989486336708, 0.0916755422949791, 0.09096447378396988, 0.09095536172389984, 0.09146228432655334, 0.09093714505434036, 0.09144396334886551, 0.08616092801094055, 0.09116736054420471, 0.09222590923309326], [0.09075086563825607, 0.0907532125711441, 0.09070810675621033, 0.09089040756225586, 0.09089276194572449, 0.09076259285211563, 0.09089745581150055, 0.0907672867178917, 0.0921708419919014, 0.09083821624517441, 0.09056821465492249], [0.09148236364126205, 0.09147360175848007, 0.09164242446422577, 0.09096260368824005, 0.09095388650894165, 0.09143855422735214, 0.09093646705150604, 0.09142103791236877, 0.08636397868394852, 0.09115659445524216, 0.09216843545436859], [0.08167584985494614, 0.08177445083856583, 0.07989732921123505, 0.08775244653224945, 0.08785837888717651, 0.08217005431652069, 0.08807063102722168, 0.08236856758594513, 0.168662428855896, 0.08542917668819427, 0.07434063404798508], [0.09108788520097733, 0.09108519554138184, 0.09113693237304688, 0.09092819690704346, 0.09092551469802856, 0.09107445180416107, 0.09092015027999878, 0.09106907248497009, 0.08948706090450287, 0.09098786860704422, 0.0912977084517479], [0.09253867715597153, 0.0925125777721405, 0.09301632642745972, 0.09099876880645752, 0.09097309410572052, 0.09240823239088058, 0.0909217819571495, 0.0923561081290245, 0.07810536026954651, 0.09157152473926544, 0.09459753334522247]], [[0.091005839407444, 0.09030106663703918, 0.09028884768486023, 0.09096892178058624, 0.09095661342144012, 0.09119372069835663, 0.09093201160430908, 0.09116905182600021, 0.0911567285656929, 0.09114439785480499, 0.09088283032178879], [0.0909157320857048, 0.09086743742227554, 0.09086659550666809, 0.09091320633888245, 0.09091237187385559, 0.09092854708433151, 0.09091068804264069, 0.09092686325311661, 0.09092602878808975, 0.0909251868724823, 0.09090732038021088], [0.09091416001319885, 0.09087730944156647, 0.09087666869163513, 0.09091223776340485, 0.09091159701347351, 0.09092393517494202, 0.09091030806303024, 0.09092265367507935, 0.09092201292514801, 0.09092137217521667, 0.0909077450633049], [0.09100115299224854, 0.09033054858446121, 0.09031893312931061, 0.09096602350473404, 0.09095432609319687, 0.09117987751960754, 0.09093091636896133, 0.09115641564130783, 0.09114468842744827, 0.09113296121358871, 0.09088412672281265], [0.09099959582090378, 0.09034039825201035, 0.09032896906137466, 0.09096506983041763, 0.09095356613397598, 0.09117527306079865, 0.09093055874109268, 0.09115220606327057, 0.09114068001508713, 0.09112915396690369, 0.09088456630706787], [0.09102959930896759, 0.09015125781297684, 0.09013605862855911, 0.090983547270298, 0.09096820652484894, 0.0912640392780304, 0.09093751758337021, 0.0912332534790039, 0.09121786803007126, 0.09120248258113861, 0.09087617695331573], [0.09099647402763367, 0.09036006033420563, 0.09034903347492218, 0.09096314758062363, 0.09095203876495361, 0.09116604924201965, 0.09092982858419418, 0.09114378690719604, 0.09113265573978424, 0.09112153202295303, 0.09088543057441711], [0.09102647751569748, 0.09017089009284973, 0.09015607833862305, 0.090981625020504, 0.09096667915582657, 0.0912548080086708, 0.09093679487705231, 0.09122482687234879, 0.09120984375476837, 0.09119486063718796, 0.09087704867124557], [0.09102492779493332, 0.09018071740865707, 0.0901661068201065, 0.09098067134618759, 0.09096592664718628, 0.09125020354986191, 0.09093643724918365, 0.09122062474489212, 0.09120583534240723, 0.09119105339050293, 0.0908774882555008], [0.09102337062358856, 0.09019053727388382, 0.09017612040042877, 0.09097971767187119, 0.0909651666879654, 0.09124559164047241, 0.090936079621315, 0.09121641516685486, 0.09120182693004608, 0.0911872461438179, 0.09087792783975601], [0.09099022299051285, 0.09039940685033798, 0.09038916230201721, 0.09095928817987442, 0.09094898402690887, 0.09114759415388107, 0.09092836827039719, 0.0911269411444664, 0.09111660718917847, 0.09110628068447113, 0.0908871591091156]], [[0.0896826982498169, 0.08965405821800232, 0.09020689874887466, 0.08856600522994995, 0.08853772282600403, 0.09012050926685333, 0.08791085332632065, 0.09006296098232269, 0.10686365514993668, 0.08919733017683029, 0.08919733017683029], [0.08969197422266006, 0.08966352790594101, 0.0902126133441925, 0.08858278393745422, 0.08855469524860382, 0.09012681245803833, 0.08793198317289352, 0.09006965160369873, 0.10674619674682617, 0.08920987695455551, 0.08920987695455551], [0.08951126784086227, 0.08947910368442535, 0.09010021388530731, 0.08825808763504028, 0.08822637796401978, 0.0900031253695488, 0.08752377331256866, 0.0899384543299675, 0.1090269461274147, 0.08896632492542267, 0.08896632492542267], [0.09003748744726181, 0.09001647680997849, 0.09042173624038696, 0.08921690285205841, 0.0891960859298706, 0.09035845100879669, 0.08873417228460312, 0.0903162881731987, 0.10234008729457855, 0.08968115597963333, 0.08968115597963333], [0.09004628658294678, 0.09002546966075897, 0.09042695164680481, 0.08923330157995224, 0.08921267837285995, 0.09036426246166229, 0.08875501155853271, 0.09032249450683594, 0.10222702473402023, 0.08969326317310333, 0.08969326317310333], [0.08953972905874252, 0.08950814604759216, 0.09011805057525635, 0.08830893784761429, 0.08827778697013855, 0.09002271294593811, 0.08758758753538132, 0.08995921909809113, 0.10866867750883102, 0.08900456130504608, 0.08900456130504608], [0.0902390256524086, 0.09022256731987, 0.09053988754749298, 0.08959557116031647, 0.08957923203706741, 0.09049035608768463, 0.0892164409160614, 0.09045735001564026, 0.09974002093076706, 0.0899597704410553, 0.0899597704410553], [0.08955863863229752, 0.0895274430513382, 0.09012986719608307, 0.08834278583526611, 0.08831200748682022, 0.09003570675849915, 0.08763008564710617, 0.08997298777103424, 0.1084304004907608, 0.08902999013662338, 0.08902999013662338], [0.08252599090337753, 0.08240044862031937, 0.08485093712806702, 0.07774102687835693, 0.07762275636196136, 0.08446425944566727, 0.07503749430179596, 0.0842074528336525, 0.19031286239624023, 0.0804184153676033, 0.0804184153676033], [0.08983864635229111, 0.08981331437826157, 0.09030236303806305, 0.08884977549314499, 0.08882471174001694, 0.0902259573340416, 0.08826892822980881, 0.09017506241798401, 0.10488325357437134, 0.0894090086221695, 0.0894090086221695], [0.08983864635229111, 0.08981331437826157, 0.09030236303806305, 0.08884977549314499, 0.08882471174001694, 0.0902259573340416, 0.08826892822980881, 0.09017506241798401, 0.10488325357437134, 0.0894090086221695, 0.0894090086221695]]]}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.4042453131984773e-05, "add_observations_from_episodes_to_batch": 3.6858088318342875e-06, "batch_individual_items": 1.3645636508841267e-05, "add_time_dim_to_batch_and_zero_pad": 8.558208096886474e-06, "add_states_from_episodes_to_batch": 2.934390969765978e-06}}, "connector_pipeline_timer": 6.87331422089052e-05}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.0250353381014485e-05, "tensor_to_numpy": 1.8716030574265764e-05, "remove_single_ts_time_rank_from_batch": 1.359777833948357e-05, "get_actions": 5.259510558026802e-05, "listify_data_for_vector_env": 1.1048916047781924e-05, "un_batch_to_individual_items": 7.039330573298044e-06}}, "connector_pipeline_timer": 0.00014150850001763335}, "rlmodule_inference_timer": 4.036114683192854e-05, "episode_return_mean": -1.3, "module_episode_returns_mean": {"default_policy": -1.3}, "weights_seq_no": 1.0, "episode_return_max": 11.5, "num_episodes_lifetime": 20, "env_to_module_sum_episodes_length_out": 10.216013141322508, "env_step_timer": 1.7245525738000296e-05, "episode_len_min": 20, "env_reset_timer": 0.000738792004995048, "num_env_steps_sampled_lifetime": 5400, "num_env_steps_sampled": 400, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.216013141322508, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "episode_duration_sec_mean": 0.006106029101647437, "episode_return_min": -13.5, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "sample": 0.13498487509787083, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": -1.3}}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "ba99e_00000", "date": "2025-08-11_18-52-50", "timestamp": 1754931170, "time_this_iter_s": 10.35550308227539, "time_total_s": 10.35550308227539, "pid": 11884, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1619f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.35550308227539, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 36.13333333333333, "ram_util_percent": 80.15333333333335}}
{"timers": {"training_iteration": 10.197457916041603, "restore_env_runners": 9.360820986330509e-06, "training_step": 10.197257841480896, "env_runner_sampling_timer": 1.6654213885322677, "learner_update_timer": 8.356380111671752, "synch_weights": 0.0017391451320145279, "restore_eval_env_runners": 7.25829740986228e-05, "evaluation_iteration": 0.1480790830682963, "synch_eval_env_connectors": 0.00018550001550465822, "synch_env_connectors": 5.58304600417614e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2655709771652908e-05, "add_observations_from_episodes_to_batch": 2.866894236077175e-06, "batch_individual_items": 1.2543883415103977e-05, "add_time_dim_to_batch_and_zero_pad": 7.133863283088526e-06, "add_states_from_episodes_to_batch": 2.7868073680628204e-06}}, "connector_pipeline_timer": 6.041234885800419e-05}, "module_to_env_connector": {"connector_pipeline_timer": 0.00011944820492831919, "timers": {"connectors": {"get_actions": 4.040479811705107e-05, "normalize_and_clip_actions": 8.016760035109524e-06, "un_batch_to_individual_items": 6.616762430510096e-06, "listify_data_for_vector_env": 1.0417060789902938e-05, "tensor_to_numpy": 1.5534960464316502e-05, "remove_single_ts_time_rank_from_batch": 1.188168311271139e-05}}}, "weights_seq_no": 1.0, "episode_return_max": 14.5, "episode_duration_sec_mean": 0.00533687651436776, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "env_reset_timer": 4.534160955258715e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": 500.0, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "episode_return_min": -5.5, "agent_episode_returns_mean": {"default_agent": 4.5}, "num_env_steps_sampled_lifetime": 10000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "env_step_timer": 1.3836780552352834e-05, "time_between_sampling": 0.03279179852862367, "num_episodes": 250.0, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 4.5}, "sample": 0.005891397715947855, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 3.245695964850663e-05, "episode_return_mean": 4.5, "episode_len_max": 20, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3211.552538811242}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13545631918357684, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009381618744228035, "add_observations_from_episodes_to_batch": 0.0008378013817127794, "add_columns_from_episodes_to_train_batch": 0.0417285742808599, "add_time_dim_to_batch_and_zero_pad": 0.07578888158663176, "add_states_from_episodes_to_batch": 0.003487536445027217, "batch_individual_items": 0.0039850758132524795, "numpy_to_tensor": 7.615502574481071e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 71820, "module_train_batch_size_mean": 997.7412016936058, "vf_explained_var": 0.0018843412399291992, "total_loss": 0.27867406606674194, "weights_seq_no": 12.0, "vf_loss_unclipped": 43.335018157958984, "diff_num_grad_updates_vs_sampler_policy": 11.0, "entropy": 0.6928558945655823, "vf_loss": 0.35942211747169495, "policy_loss": -0.00026834075106307864, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 2.0997715182602406e-05}, "__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 143640, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 396000, "num_env_steps_trained_lifetime_throughput": 55458.22854194412}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 11.0, "num_module_steps_trained": 35910, "total_loss": 0.0, "num_module_steps_trained_lifetime": 71820, "module_train_batch_size_mean": 997.7412016936058, "weights_seq_no": 12.0}}}, "intrinsic_reward_module": {"total_loss": 0.0, "weights_seq_no": 2.0, "num_trainable_parameters": 8266, "num_module_steps_trained_lifetime": 11970, "module_train_batch_size_mean": 997.9429069707118, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 718.7882704348231}, "default_policy": {"use_intrinsic_rewards": 0.0, "num_trainable_parameters": 16595, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 11970, "module_train_batch_size_mean": 997.9429069707118, "vf_explained_var": 0.005952775478363037, "total_loss": 0.2778412997722626, "weights_seq_no": 2.0, "mean_kl_loss": 2.241429865534883e-05, "vf_loss_unclipped": 42.93039321899414, "curr_kl_coeff": 0.040395982563495636, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.6928510069847107, "vf_loss": 0.3583684265613556, "curr_entropy_coeff": 0.0015431216992, "policy_loss": -0.00027866082382388413, "num_module_steps_trained_lifetime_throughput": 718.7756081262279}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 23940, "num_env_steps_trained_lifetime": 66000, "num_env_steps_trained": 33000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 3964.8998679094657, "num_module_steps_trained_throughput": 31812262.620513927, "num_module_steps_trained_lifetime_throughput": 12988332.502254581}, "IntrinsicAttentionMask": [[[0.09102851152420044, 0.0903235673904419, 0.09031134843826294, 0.09099158644676208, 0.09122878313064575, 0.09096697717905045, 0.09095466881990433, 0.09119177609682083, 0.09117944538593292, 0.09091777354478836, 0.09090547263622284], [0.09091728180646896, 0.0908689871430397, 0.09086814522743225, 0.0909147635102272, 0.09093093872070312, 0.0909130796790123, 0.09091223776340485, 0.09092842042446136, 0.09092757850885391, 0.09090971201658249, 0.09090887755155563], [0.09091533720493317, 0.09087848663330078, 0.09087784588336945, 0.09091341495513916, 0.09092575311660767, 0.09091212600469589, 0.09091148525476456, 0.09092383086681366, 0.09092319011688232, 0.09090956300497055, 0.09090892225503922], [0.09102273732423782, 0.09035198390483856, 0.09034036099910736, 0.09098760783672333, 0.09121324867010117, 0.09096419811248779, 0.09095249325037003, 0.0911780446767807, 0.09116631001234055, 0.09091738611459732, 0.09090568870306015], [0.0910598412156105, 0.09016983211040497, 0.09015443176031113, 0.09101317077875137, 0.09131300449371338, 0.09098206460475922, 0.09096652269363403, 0.0912662073969841, 0.09125061333179474, 0.09091990441083908, 0.0909043699502945], [0.09101887792348862, 0.09037091583013535, 0.09035968780517578, 0.09098494052886963, 0.09120287746191025, 0.09096232801675797, 0.09095102548599243, 0.09116887301206589, 0.09115754812955856, 0.09091711044311523, 0.0909058153629303], [0.09101694822311401, 0.09038039296865463, 0.09036935865879059, 0.09098360687494278, 0.09119769185781479, 0.09096138924360275, 0.09095028787851334, 0.09116429090499878, 0.09115315973758698, 0.09091697633266449, 0.09090587496757507], [0.09105406701564789, 0.09019821882247925, 0.09018339961767197, 0.09100919961929321, 0.0912974625825882, 0.09097929298877716, 0.09096435457468033, 0.09125247597694397, 0.09123748540878296, 0.09091952443122864, 0.0909045934677124], [0.09105213731527328, 0.09020767360925674, 0.09019304811954498, 0.09100786596536636, 0.09129227697849274, 0.09097836911678314, 0.09096361696720123, 0.09124789386987686, 0.09123310446739197, 0.0909193903207779, 0.09090465307235718], [0.0910111591219902, 0.0904088169336319, 0.09039837121963501, 0.09097962081432343, 0.0911821499466896, 0.0909586027264595, 0.09094808995723724, 0.09115055203437805, 0.0911400243639946, 0.09091658145189285, 0.09090607613325119], [0.0910092294216156, 0.09041829407215118, 0.09040804207324982, 0.09097829461097717, 0.09117697179317474, 0.09095767140388489, 0.09094736725091934, 0.09114597737789154, 0.0911356508731842, 0.09091644734144211, 0.09090614318847656]], [[0.08989986032247543, 0.08987115323543549, 0.09042532742023468, 0.08820819109678268, 0.08818002790212631, 0.09033872932195663, 0.08869544416666031, 0.08969909697771072, 0.10643196105957031, 0.08883696049451828, 0.08941330760717392], [0.08990762382745743, 0.0898791030049324, 0.09042951464653015, 0.08822730928659439, 0.08819933235645294, 0.09034350514411926, 0.08871130645275116, 0.08970821648836136, 0.10631787776947021, 0.08885188400745392, 0.08942435681819916], [0.08975611627101898, 0.0897238627076149, 0.09034667164087296, 0.08785784989595413, 0.08782628178596497, 0.09024932235479355, 0.08840414136648178, 0.0895305946469307, 0.10853257775306702, 0.08856287598609924, 0.08920968323945999], [0.09034104645252228, 0.09032397717237473, 0.09065313637256622, 0.0893312469124794, 0.08931436389684677, 0.09060174971818924, 0.08962289988994598, 0.09022161364555359, 0.09983112663030624, 0.08970748633146286, 0.09005141258239746], [0.09034811705350876, 0.09033124148845673, 0.0906565934419632, 0.08934987336397171, 0.0893331915140152, 0.09060580283403397, 0.08963820338249207, 0.0902300551533699, 0.09972330927848816, 0.08972182869911194, 0.09006181359291077], [0.08978003263473511, 0.08974835276603699, 0.0903598964214325, 0.08791564404964447, 0.08788462728261948, 0.09026430547237396, 0.08845225721597672, 0.08955857157707214, 0.10818475484848022, 0.08860816806554794, 0.08924341946840286], [0.09021735191345215, 0.090196892619133, 0.09059149026870728, 0.08900851756334305, 0.08898832648992538, 0.09052987396717072, 0.08935737609863281, 0.09007423371076584, 0.10170695930719376, 0.08945859968662262, 0.08987034857273102], [0.08995392918586731, 0.0899265855550766, 0.09045437723398209, 0.0883418396115303, 0.08831498771905899, 0.09037191420793533, 0.08880632370710373, 0.08976268768310547, 0.10563565045595169, 0.08894120156764984, 0.08949041366577148], [0.08393451571464539, 0.08381054550409317, 0.08622925728559494, 0.07687024772167206, 0.07675670832395554, 0.08584773540496826, 0.07885522395372391, 0.08307052403688431, 0.18333327770233154, 0.0794392004609108, 0.08185266703367233], [0.0901809111237526, 0.09015947580337524, 0.09057299047708511, 0.08891467750072479, 0.08889354020357132, 0.09050841629505157, 0.08928001672029495, 0.0900309607386589, 0.10225564241409302, 0.08938603103160858, 0.0898173451423645], [0.09003011882305145, 0.09000471979379654, 0.09049481153488159, 0.08853194117546082, 0.08850696682929993, 0.0904182493686676, 0.08896379917860031, 0.08985248953104019, 0.10450810194015503, 0.08908917754888535, 0.08959955722093582]], [[0.08996254205703735, 0.09057075530290604, 0.0902256965637207, 0.09112944453954697, 0.09144509583711624, 0.09109670668840408, 0.09108034521341324, 0.0910639837384224, 0.09104762226343155, 0.0910312682390213, 0.09134658426046371], [0.08953188359737396, 0.09041561186313629, 0.08991391211748123, 0.09122976660728455, 0.09169077128171921, 0.09118199348449707, 0.09115812182426453, 0.09113425016403198, 0.09111038595438004, 0.09108653664588928, 0.09154681861400604], [0.08977564424276352, 0.0905035212635994, 0.09009045362472534, 0.0911729708313942, 0.09155156463384628, 0.0911337211728096, 0.0911141037940979, 0.0910944864153862, 0.0910748764872551, 0.09105527400970459, 0.09143337607383728], [0.08914025872945786, 0.09027386456727982, 0.08962991833686829, 0.09132103621959686, 0.09191517531871796, 0.09125952422618866, 0.09122878313064575, 0.09119804948568344, 0.09116733074188232, 0.09113661199808121, 0.0917295590043068], [0.08892063051462173, 0.09019407629966736, 0.08947044610977173, 0.09137222170829773, 0.09204141795635223, 0.09130296111106873, 0.09126835316419601, 0.0912337601184845, 0.09119918197393417, 0.09116461127996445, 0.09183228760957718], [0.08916308730840683, 0.0902821347117424, 0.08964648097753525, 0.09131570160388947, 0.09190204739570618, 0.09125498682260513, 0.09122464805841446, 0.09119431674480438, 0.0911640003323555, 0.09113369137048721, 0.09171886742115021], [0.08917451649904251, 0.09028628468513489, 0.08965477347373962, 0.09131304174661636, 0.09189549833536148, 0.09125273674726486, 0.09122259169816971, 0.09119246155023575, 0.09116234630346298, 0.09113223105669022, 0.09171353280544281], [0.0891859382390976, 0.09029041975736618, 0.0896630585193634, 0.09131037443876266, 0.09188893437385559, 0.0912504717707634, 0.09122052788734436, 0.09119059890508652, 0.09116067737340927, 0.09113077074289322, 0.09170819073915482], [0.08919736742973328, 0.09029456973075867, 0.08967135846614838, 0.09130772203207016, 0.0918823853135109, 0.09124821424484253, 0.0912184789776802, 0.09118875116109848, 0.09115903079509735, 0.09112931787967682, 0.09170286357402802], [0.08920879662036896, 0.09029870480298996, 0.08967964351177216, 0.09130504727363586, 0.091875821352005, 0.09124594926834106, 0.09121640771627426, 0.09118688106536865, 0.09115736186504364, 0.09112785011529922, 0.09169751405715942], [0.08898904174566269, 0.09021894633769989, 0.08952014148235321, 0.09135627001523972, 0.09200205653905869, 0.09128942340612411, 0.0912560224533081, 0.09122263640165329, 0.09118925780057907, 0.09115589410066605, 0.091800257563591]], [[0.09021218866109848, 0.08951759338378906, 0.0894850343465805, 0.0876333937048912, 0.08824913948774338, 0.09004825353622437, 0.08753781020641327, 0.0899827629327774, 0.10933718830347061, 0.08899834752082825, 0.08899834752082825], [0.09032104164361954, 0.08971436321735382, 0.08968591690063477, 0.08806559443473816, 0.0886048972606659, 0.09017791599035263, 0.08798183500766754, 0.09012072533369064, 0.10680679976940155, 0.08926045149564743, 0.08926045149564743], [0.09032602608203888, 0.08972349017858505, 0.08969523012638092, 0.0880858525633812, 0.08862154185771942, 0.09018387645483017, 0.08800264447927475, 0.09012708067893982, 0.10668899118900299, 0.08927265554666519, 0.08927265554666519], [0.0905902087688446, 0.0902271717786789, 0.09021011739969254, 0.08923549950122833, 0.08956069499254227, 0.09050464630126953, 0.08918492496013641, 0.09047044813632965, 0.10010647028684616, 0.08995489776134491, 0.08995489776134491], [0.09050647169351578, 0.09006298333406448, 0.09004215896129608, 0.08885359019041061, 0.08924984186887741, 0.09040191769599915, 0.08879198879003525, 0.090360127389431, 0.10226965695619583, 0.0897306352853775, 0.0897306352853775], [0.09023833274841309, 0.08956440538167953, 0.08953280746936798, 0.08773543685674667, 0.08833325654268265, 0.09007929265499115, 0.0876426249742508, 0.09001575410366058, 0.10873705893754959, 0.08906050026416779, 0.08906050026416779], [0.09060284495353699, 0.0902523621916771, 0.09023590385913849, 0.08929475396871567, 0.0896088108420372, 0.09052024781703949, 0.08924590796232224, 0.09048722684383392, 0.09977298974990845, 0.08998948335647583, 0.08998948335647583], [0.0902487188577652, 0.08958305418491364, 0.08955184370279312, 0.08777621388435364, 0.08836685121059418, 0.09009163081645966, 0.0876845121383667, 0.09002887457609177, 0.10849783569574356, 0.08908528834581375, 0.08908528834581375], [0.08531029522418976, 0.08259464800357819, 0.08246898651123047, 0.0755586326122284, 0.07780566066503525, 0.08466332405805588, 0.07521430402994156, 0.08440592139959335, 0.19076237082481384, 0.08060792833566666, 0.08060792833566666], [0.09039904177188873, 0.08985874801874161, 0.08983340859413147, 0.0883883610367775, 0.08886964619159698, 0.09027161449193954, 0.08831357955932617, 0.09022068977355957, 0.104936383664608, 0.08945424854755402, 0.08945424854755402], [0.09039904177188873, 0.08985874801874161, 0.08983340859413147, 0.0883883610367775, 0.08886964619159698, 0.09027161449193954, 0.08831357955932617, 0.09022068977355957, 0.104936383664608, 0.08945424854755402, 0.08945424854755402]], [[0.09098346531391144, 0.09052643924951553, 0.09051419794559479, 0.09094655513763428, 0.0911836326122284, 0.09092195332050323, 0.09090965241193771, 0.09089735895395279, 0.09113431721925735, 0.09112198650836945, 0.09086048603057861], [0.09093862771987915, 0.09075721353292465, 0.09075234830379486, 0.09092399477958679, 0.09101790934801102, 0.09091424196958542, 0.09090936928987503, 0.09090448915958405, 0.09099838137626648, 0.0909935012459755, 0.09088986366987228], [0.09093742817640305, 0.09076342731714249, 0.09075875580310822, 0.09092339128255844, 0.09101346880197525, 0.0909140408039093, 0.09090936928987503, 0.09090469032526016, 0.09099474549293518, 0.09099005907773972, 0.09089066088199615], [0.09097985178232193, 0.09054502099752426, 0.09053336828947067, 0.09094473719596863, 0.09117027372121811, 0.09092134237289429, 0.09090963751077652, 0.09089794009923935, 0.09112335741519928, 0.09111163020133972, 0.09086285531520844], [0.09100297093391418, 0.09042584896087646, 0.09041039645671844, 0.09095633774995804, 0.09125598520040512, 0.09092525392770767, 0.09090971946716309, 0.0908941850066185, 0.09119363129138947, 0.0911780521273613, 0.09084760397672653], [0.09097744524478912, 0.09055740386247635, 0.0905461460351944, 0.09094353020191193, 0.09116136282682419, 0.09092092514038086, 0.09090962260961533, 0.09089832007884979, 0.0911160483956337, 0.09110473096370697, 0.09086443483829498], [0.09097624570131302, 0.09056360274553299, 0.09055254608392715, 0.09094292670488358, 0.09115691483020782, 0.09092072397470474, 0.09090962260961533, 0.09089852124452591, 0.0911124050617218, 0.09110127389431, 0.09086523205041885], [0.09097503870725632, 0.09056979417800903, 0.09055893123149872, 0.09094231575727463, 0.09115245938301086, 0.09092051535844803, 0.09090960770845413, 0.09089871495962143, 0.09110874682664871, 0.09109782427549362, 0.09086601436138153], [0.09099817276000977, 0.09045060724020004, 0.0904359444975853, 0.09095393121242523, 0.09123817086219788, 0.09092444181442261, 0.09090970456600189, 0.09089496731758118, 0.0911790281534195, 0.0911642462015152, 0.09085077792406082], [0.09099697321653366, 0.09045679867267609, 0.09044232964515686, 0.09095332026481628, 0.09123371541500092, 0.09092424064874649, 0.0909096971154213, 0.0908951684832573, 0.091175377368927, 0.09116079658269882, 0.0908515676856041], [0.0909714326262474, 0.09058838337659836, 0.0905781164765358, 0.09094050526618958, 0.09113910794258118, 0.09091989696025848, 0.09090960025787354, 0.09089929610490799, 0.09109780192375183, 0.09108748286962509, 0.09086839109659195]], [[0.09196218848228455, 0.09194788336753845, 0.09193358570337296, 0.09111537784337997, 0.09110121428966522, 0.09160178154706955, 0.09078652411699295, 0.09157329052686691, 0.08375518023967743, 0.09143108874559402, 0.09279186278581619], [0.09194768965244293, 0.09193359315395355, 0.09191949665546417, 0.0911128968000412, 0.09109892696142197, 0.09159240871667862, 0.09078867733478546, 0.09156432002782822, 0.0838523879647255, 0.0914241373538971, 0.09276548773050308], [0.09193318337202072, 0.09191928058862686, 0.0919053927063942, 0.09111039340496063, 0.09109662473201752, 0.0915830209851265, 0.09079080820083618, 0.09155533462762833, 0.08394969254732132, 0.09141717106103897, 0.09273910522460938], [0.09108264744281769, 0.09108036011457443, 0.09107806533575058, 0.09094658493995667, 0.09094429761171341, 0.09102486073970795, 0.09089345484972, 0.09102029353380203, 0.08971704542636871, 0.09099743515253067, 0.09121493995189667], [0.09106756001710892, 0.09106547385454178, 0.09106338024139404, 0.09094337373971939, 0.09094128757715225, 0.09101483225822449, 0.09089488536119461, 0.09101065248250961, 0.08982045948505402, 0.09098979085683823, 0.09118828922510147], [0.09159307926893234, 0.09158390015363693, 0.09157472848892212, 0.09104892611503601, 0.09103980660438538, 0.09136169403791428, 0.09083712100982666, 0.09134339541196823, 0.08624085038900375, 0.09125200659036636, 0.09212448447942734], [0.09072933346033096, 0.0907316729426384, 0.09073401987552643, 0.09086883813142776, 0.09087119251489639, 0.09078852087259293, 0.09092342853546143, 0.09079321473836899, 0.09214898943901062, 0.09081664681434631, 0.0905940905213356], [0.09156357496976852, 0.09155479818582535, 0.09154602885246277, 0.09104333817958832, 0.09103462100028992, 0.09134238213300705, 0.09084080904722214, 0.09132488816976547, 0.0864405706524849, 0.09123751521110535, 0.09207149595022202], [0.08129598945379257, 0.08139052242040634, 0.08148515969514847, 0.0871141105890274, 0.08721540868282318, 0.08371664583683014, 0.08949972689151764, 0.08391144126653671, 0.1634601354598999, 0.08489146828651428, 0.07601936161518097], [0.09141557663679123, 0.09140882641077042, 0.0914020761847496, 0.09101469069719315, 0.09100797027349472, 0.09124519675970078, 0.09085848182439804, 0.09123171120882034, 0.08744458854198456, 0.09116438031196594, 0.09180647879838943], [0.09278356283903122, 0.09275738149881363, 0.09273122251033783, 0.0912395566701889, 0.09121382236480713, 0.09212499111890793, 0.09064308553934097, 0.09207303076982498, 0.07831192016601562, 0.0918138399720192, 0.09430757910013199]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1858750961804738e-05, "add_observations_from_episodes_to_batch": 2.8240677802057814e-06, "batch_individual_items": 1.22695203251686e-05, "add_time_dim_to_batch_and_zero_pad": 7.114004398950829e-06, "add_states_from_episodes_to_batch": 2.759008651715586e-06}}, "connector_pipeline_timer": 5.861872755957861e-05}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.881922485010939e-06, "tensor_to_numpy": 1.484712872360737e-05, "remove_single_ts_time_rank_from_batch": 1.1804553026216537e-05, "get_actions": 3.53704647825495e-05, "listify_data_for_vector_env": 1.0320965532672772e-05, "un_batch_to_individual_items": 6.424921282704332e-06}}, "connector_pipeline_timer": 0.00011239007184679315}, "rlmodule_inference_timer": 3.057894814934393e-05, "episode_return_mean": -0.3, "module_episode_returns_mean": {"default_policy": -0.3}, "weights_seq_no": 2.0, "episode_return_max": 14.5, "num_episodes_lifetime": 40, "env_to_module_sum_episodes_length_out": 10.366003441359926, "env_step_timer": 1.3721645412552761e-05, "episode_len_min": 20, "env_reset_timer": 0.0007323445053771139, "num_env_steps_sampled_lifetime": 10400, "num_env_steps_sampled": 400, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.366003441359926, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "episode_duration_sec_mean": 0.0056105864758137615, "episode_return_min": -13.5, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "sample": 0.1347495842666831, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "agent_episode_returns_mean": {"default_agent": -0.3}, "time_between_sampling": 9.540831999969669}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "ba99e_00000", "date": "2025-08-11_18-53-00", "timestamp": 1754931180, "time_this_iter_s": 9.612375974655151, "time_total_s": 19.967879056930542, "pid": 11884, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1619f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.967879056930542, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 40.01428571428572, "ram_util_percent": 79.05714285714284}}
{"timers": {"training_iteration": 10.188725718550304, "restore_env_runners": 9.340963046997784e-06, "training_step": 10.188525751406466, "env_runner_sampling_timer": 1.6639610717275528, "learner_update_timer": 8.349061982224056, "synch_weights": 0.001731056179932784, "restore_eval_env_runners": 7.194048492237926e-05, "evaluation_iteration": 0.14776623431826008, "synch_eval_env_connectors": 0.0001848258462268859, "synch_env_connectors": 5.57221588678658e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2445910583055876e-05, "add_observations_from_episodes_to_batch": 2.7712616148710115e-06, "batch_individual_items": 1.2301641502316157e-05, "add_time_dim_to_batch_and_zero_pad": 7.005252033229584e-06, "add_states_from_episodes_to_batch": 2.7352082661080837e-06}}, "connector_pipeline_timer": 5.937948750168972e-05}, "module_to_env_connector": {"connector_pipeline_timer": 0.0001175823069423537, "timers": {"connectors": {"get_actions": 3.946373239871558e-05, "normalize_and_clip_actions": 7.882247671877848e-06, "un_batch_to_individual_items": 6.492249046342147e-06, "listify_data_for_vector_env": 1.0318922712694707e-05, "tensor_to_numpy": 1.5371052597256227e-05, "remove_single_ts_time_rank_from_batch": 1.178148882889596e-05}}}, "weights_seq_no": 2.0, "episode_return_max": 14.5, "episode_duration_sec_mean": 0.005239122165832667, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "env_reset_timer": 3.802004953096518e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -30375.0, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "episode_return_min": -5.5, "agent_episode_returns_mean": {"default_agent": 5.460000000000001}, "num_env_steps_sampled_lifetime": -607500.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "env_step_timer": 1.3616285026806354e-05, "time_between_sampling": 0.03227263995870193, "num_episodes": 250.0, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 5.460000000000001}, "sample": 0.006081788418635213, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 3.162078655621577e-05, "episode_return_mean": 5.460000000000001, "episode_len_max": 20, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3267.11247150471}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13541539349143858, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00937267005748581, "add_observations_from_episodes_to_batch": 0.0008403279480175115, "add_columns_from_episodes_to_train_batch": 0.04171746436891844, "add_time_dim_to_batch_and_zero_pad": 0.07576546985000605, "add_states_from_episodes_to_batch": 0.0034887481609475798, "batch_individual_items": 0.00398465297583025, "numpy_to_tensor": 7.605139551451431e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 107730, "module_train_batch_size_mean": 997.6672132667843, "vf_explained_var": 0.0019320845603942871, "total_loss": 0.2786725163459778, "weights_seq_no": 18.0, "vf_loss_unclipped": 46.555633544921875, "diff_num_grad_updates_vs_sampler_policy": 16.0, "entropy": 0.6927027106285095, "vf_loss": 0.3593880534172058, "policy_loss": -0.00024460640270262957, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 2.7234278604737483e-05}, "__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 215460, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 594000, "num_env_steps_trained_lifetime_throughput": 54958.453003990035}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 16.0, "num_module_steps_trained": 35910, "total_loss": 0.0, "num_module_steps_trained_lifetime": 107730, "module_train_batch_size_mean": 997.6672132667843, "weights_seq_no": 18.0}}}, "intrinsic_reward_module": {"total_loss": 0.0, "weights_seq_no": 3.0, "num_trainable_parameters": 8266, "num_module_steps_trained_lifetime": 17955, "module_train_batch_size_mean": 997.9168410861561, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 718.8495935940487}, "default_policy": {"use_intrinsic_rewards": 0.0, "num_trainable_parameters": 16595, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 17955, "module_train_batch_size_mean": 997.9168410861561, "vf_explained_var": 0.003982424736022949, "total_loss": 0.277870237827301, "weights_seq_no": 3.0, "mean_kl_loss": 2.834354199876543e-05, "vf_loss_unclipped": 46.6484260559082, "curr_kl_coeff": 0.020197991281747818, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.6926982998847961, "vf_loss": 0.3583722412586212, "curr_entropy_coeff": 0.0015431216992, "policy_loss": -0.00025222875410690904, "num_module_steps_trained_lifetime_throughput": 718.8372551226837}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 35910, "num_env_steps_trained_lifetime": 99000, "num_env_steps_trained": 33000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 3965.206319524402, "num_module_steps_trained_throughput": 31137815.17435034, "num_module_steps_trained_lifetime_throughput": 12980203.646164784}, "IntrinsicAttentionMask": [[[0.09100598841905594, 0.09030120819807053, 0.09053660929203033, 0.09096907079219818, 0.09120620787143707, 0.09094446897506714, 0.09093216061592102, 0.0909198671579361, 0.09115687012672424, 0.09114454686641693, 0.09088297933340073], [0.0909157246351242, 0.09086742997169495, 0.09088359773159027, 0.09091320633888245, 0.09092938154935837, 0.09091152250766754, 0.09091068059206009, 0.09090984612703323, 0.09092602133750916, 0.0909251794219017, 0.09090732038021088], [0.0909460186958313, 0.09067750722169876, 0.09076733142137527, 0.0909319818019867, 0.0910220667719841, 0.09092263132333755, 0.09091795235872269, 0.09091328084468842, 0.09100333601236343, 0.09099865704774857, 0.09089925140142441], [0.09100128710269928, 0.09033068269491196, 0.09055469930171967, 0.09096616506576538, 0.09119175374507904, 0.09094276279211044, 0.09093105792999268, 0.09091935306787491, 0.09114482998847961, 0.09113310277462006, 0.090884268283844], [0.09103139489889145, 0.0901416763663292, 0.09043864160776138, 0.09098474681377411, 0.09128449112176895, 0.09095365554094315, 0.09093812108039856, 0.09092257916927338, 0.0912221223115921, 0.09120653569698334, 0.09087598323822021], [0.09099815785884857, 0.09035034477710724, 0.09056676179170609, 0.09096423536539078, 0.09118212014436722, 0.09094163030385971, 0.09093032032251358, 0.09091901779174805, 0.09113679826259613, 0.0911254733800888, 0.09088512510061264], [0.09099658578634262, 0.09036017954349518, 0.090572789311409, 0.09096326678991318, 0.09117729961872101, 0.09094104915857315, 0.09092994779348373, 0.09091884642839432, 0.09113278239965439, 0.09112165123224258, 0.09088554978370667], [0.09099502116441727, 0.09036999940872192, 0.09057881683111191, 0.09096229076385498, 0.0911724790930748, 0.09094048291444778, 0.09092957526445389, 0.09091867506504059, 0.09112875908613205, 0.09111782908439636, 0.09088597446680069], [0.09102515131235123, 0.09018093347549438, 0.09046275913715363, 0.0909809023141861, 0.0912652239203453, 0.09095140546560287, 0.09093666076660156, 0.09092192351818085, 0.09120606631040573, 0.09119127690792084, 0.0908777192234993], [0.09102358669042587, 0.09019074589014053, 0.09046878665685654, 0.0909799262881279, 0.0912604033946991, 0.09095083922147751, 0.09093629568815231, 0.09092175215482712, 0.09120205044746399, 0.09118746221065521, 0.09087814390659332], [0.0909903272986412, 0.09039951115846634, 0.09059692174196243, 0.09095939248800278, 0.09115803241729736, 0.09093877673149109, 0.09092847257852554, 0.09091816842556, 0.09111671894788742, 0.09110639244318008, 0.09088726341724396]], [[0.0920129045844078, 0.09199859201908112, 0.09169507026672363, 0.09116562455892563, 0.09086484462022781, 0.0916522890329361, 0.09112309664487839, 0.09191278368234634, 0.08353786170482635, 0.09119386970996857, 0.09284303337335587], [0.09199771285057068, 0.0919836089015007, 0.09168440848588943, 0.09116246551275253, 0.09086593240499496, 0.09164223819971085, 0.09112053364515305, 0.09189901500940323, 0.08363791555166245, 0.09119031578302383, 0.09281595796346664], [0.09167236089706421, 0.09166257083415985, 0.0914548859000206, 0.09109209477901459, 0.0908856987953186, 0.09142559766769409, 0.09106292575597763, 0.09160387516021729, 0.08578932285308838, 0.09111146628856659, 0.09223925322294235], [0.09109102934598923, 0.09108874201774597, 0.09104011207818985, 0.09095495194196701, 0.09090639650821686, 0.09103324264287949, 0.09094808995723724, 0.09107500314712524, 0.08967965841293335, 0.09095950424671173, 0.0912233367562294], [0.0907527506351471, 0.09075469523668289, 0.09079606831073761, 0.09086859226226807, 0.09091001749038696, 0.090801902115345, 0.09087444096803665, 0.09076637774705887, 0.09197012335062027, 0.09086471796035767, 0.09064041823148727], [0.09162604063749313, 0.09161686152219772, 0.09142205119132996, 0.09108169376850128, 0.09088802337646484, 0.0913945734500885, 0.09105432033538818, 0.09156180918216705, 0.08609706908464432, 0.09109987318515778, 0.09215763956308365], [0.09104354679584503, 0.09104186296463013, 0.09100596606731415, 0.0909431129693985, 0.0909072607755661, 0.09100089967250824, 0.09093805402517319, 0.09103172272443771, 0.08999990671873093, 0.09094647318124771, 0.09114116430282593], [0.09190630167722702, 0.09189341217279434, 0.09162010252475739, 0.0911431536078453, 0.09087207913398743, 0.09158158302307129, 0.09110483527183533, 0.09181614965200424, 0.08424043655395508, 0.091168612241745, 0.0926533192396164], [0.08036351948976517, 0.08046053349971771, 0.08254987001419067, 0.08634257316589355, 0.08858464658260345, 0.08284919708967209, 0.08665565401315689, 0.08104510605335236, 0.170058473944664, 0.08613532781600952, 0.0749550312757492], [0.09112249314785004, 0.09111980348825455, 0.09106270968914032, 0.0909627377986908, 0.09090574085712433, 0.09105464816093445, 0.09095469117164612, 0.0911036804318428, 0.08946757763624191, 0.09096808731555939, 0.09127786010503769], [0.09287365525960922, 0.09284745156764984, 0.09229253232479095, 0.09132815152406693, 0.09078231453895569, 0.09221445024013519, 0.09125088900327682, 0.09269042313098907, 0.07794144749641418, 0.09137948602437973, 0.09439915418624878]], [[0.09098328649997711, 0.09027868509292603, 0.09051401913166046, 0.09119579195976257, 0.09118346124887466, 0.0909217819571495, 0.09090948104858398, 0.09114646911621094, 0.09088489413261414, 0.09112181514501572, 0.09086031466722488], [0.09091418981552124, 0.09086589515209198, 0.0908820629119873, 0.09092868864536285, 0.0909278467297554, 0.09090998768806458, 0.09090915322303772, 0.09092532843351364, 0.09090746939182281, 0.09092364460229874, 0.09090578556060791], [0.09093739837408066, 0.09066890180110931, 0.09075872600078583, 0.09101811796426773, 0.09101343899965286, 0.09091401100158691, 0.09090933203697205, 0.09099938720464706, 0.0908999815583229, 0.09099002927541733, 0.09089063107967377], [0.0910039022564888, 0.09010308980941772, 0.0904037356376648, 0.09127596020698547, 0.09126016497612, 0.0909251868724823, 0.090909443795681, 0.09121279418468475, 0.09087798744440079, 0.09118122607469559, 0.09084653854370117], [0.09100271016359329, 0.09011325985193253, 0.09041012823581696, 0.091271311044693, 0.09125571697950363, 0.09092498570680618, 0.0909094512462616, 0.09120894968509674, 0.09087838977575302, 0.09117778390645981, 0.09084733575582504], [0.09097730368375778, 0.09032963961362839, 0.09054600447416306, 0.09117255359888077, 0.09116122126579285, 0.09092078357934952, 0.09090948104858398, 0.09112723916769028, 0.09088688343763351, 0.09110458940267563, 0.09086429327726364], [0.09097611159086227, 0.09033983945846558, 0.09055240452289581, 0.09116791188716888, 0.09115678071975708, 0.090920589864254, 0.09090948849916458, 0.09112339466810226, 0.09088728576898575, 0.09110114723443985, 0.09086509793996811], [0.09099912643432617, 0.09014378488063812, 0.09042931348085403, 0.09125737100839615, 0.09124238044023514, 0.09092440456151962, 0.09090946614742279, 0.0911974161863327, 0.09087959676980972, 0.09116744995117188, 0.09084974229335785], [0.09097371250391006, 0.09036022424697876, 0.09056520462036133, 0.09115861356258392, 0.09114788472652435, 0.09092018008232117, 0.09090948104858398, 0.09111569821834564, 0.09088808298110962, 0.0910942479968071, 0.09086668491363525], [0.09099674224853516, 0.09016413986682892, 0.09044209867715836, 0.09124807268381119, 0.09123347699642181, 0.09092400968074799, 0.09090946614742279, 0.09118972718715668, 0.09088040143251419, 0.09116056561470032, 0.09085133671760559], [0.09097131341695786, 0.09038061648607254, 0.09057799726724625, 0.09114931523799896, 0.09113898873329163, 0.09091977775096893, 0.09090947359800339, 0.09110800176858902, 0.0908888727426529, 0.09108735620975494, 0.0908682718873024]], [[0.0902133658528328, 0.08951876312494278, 0.08948621153831482, 0.08763453364372253, 0.0882502868771553, 0.09004943072795868, 0.0881861001253128, 0.08932359516620636, 0.10933871567249298, 0.08899950981140137, 0.08899950981140137], [0.09032195061445236, 0.08971525728702545, 0.0896868109703064, 0.088066466152668, 0.08860577642917633, 0.09017881006002426, 0.08854958415031433, 0.08954468369483948, 0.10680795460939407, 0.08926133066415787, 0.08926133066415787], [0.09032692015171051, 0.08972437679767609, 0.08969611674547195, 0.08808670938014984, 0.08862240612506866, 0.0901847630739212, 0.08856658637523651, 0.08955495804548264, 0.10669013112783432, 0.08927353471517563, 0.08927353471517563], [0.09059053659439087, 0.09022749960422516, 0.0902104452252388, 0.089235819876194, 0.08956100791692734, 0.0905049741268158, 0.08952716737985611, 0.09012524783611298, 0.1001068651676178, 0.08995521813631058, 0.08995521813631058], [0.09050695598125458, 0.09006346762180328, 0.09004265069961548, 0.08885405957698822, 0.08925031870603561, 0.09040240198373795, 0.08920906484127045, 0.08993862569332123, 0.10227024555206299, 0.0897311121225357, 0.0897311121225357], [0.09023945033550262, 0.08956550806760788, 0.08953391015529633, 0.08773651719093323, 0.0883343443274498, 0.09008040279150009, 0.08827203512191772, 0.08937611430883408, 0.1087384968996048, 0.08906159549951553, 0.08906159549951553], [0.0905158594250679, 0.09008072316646576, 0.090060293674469, 0.08889387547969818, 0.08928277343511581, 0.09041327238082886, 0.08924228698015213, 0.08995822072029114, 0.10204354673624039, 0.08975459635257721, 0.08975459635257721], [0.09035154432058334, 0.08976974338293076, 0.08974245935678482, 0.08818775415420532, 0.08870534598827362, 0.09021429717540741, 0.08865141868591309, 0.08960612863302231, 0.10610269755125046, 0.08933433890342712, 0.08933433890342712], [0.08532794564962387, 0.08261171728372574, 0.08248604089021683, 0.07557420432567596, 0.07782170176506042, 0.08468084037303925, 0.07758509367704391, 0.0818604826927185, 0.19080285727977753, 0.08062457293272018, 0.08062457293272018], [0.09039977192878723, 0.0898594781756401, 0.08983413130044937, 0.08838906139135361, 0.08887036144733429, 0.09027233719825745, 0.08882022649049759, 0.08970748633146286, 0.10493729263544083, 0.08945495635271072, 0.08945495635271072], [0.09039977192878723, 0.0898594781756401, 0.08983413130044937, 0.08838906139135361, 0.08887036144733429, 0.09027233719825745, 0.08882022649049759, 0.08970748633146286, 0.10493729263544083, 0.08945495635271072, 0.08945495635271072]], [[0.08987307548522949, 0.09015215933322906, 0.09046442806720734, 0.09103882312774658, 0.09102246910333633, 0.09133774787187576, 0.09132134169340134, 0.09130493551492691, 0.09095708280801773, 0.09127213805913925, 0.09125573933124542], [0.0896560475230217, 0.08999321609735489, 0.09037072211503983, 0.09106583893299103, 0.0910460352897644, 0.09142795950174332, 0.09140808135271072, 0.09138820320367813, 0.09096686542034149, 0.09134845435619354, 0.09132859110832214], [0.08941449224948883, 0.0898161381483078, 0.09026619046926498, 0.09109582751989365, 0.09107217937707901, 0.09152851998806, 0.09150475263595581, 0.09148100018501282, 0.09097762405872345, 0.09143349528312683, 0.09140975028276443], [0.08897367119789124, 0.0894925519824028, 0.0900747999548912, 0.09115038067102432, 0.0911196768283844, 0.09171250462532043, 0.09168160706758499, 0.09165072441101074, 0.09099695831537247, 0.09158898890018463, 0.09155813604593277], [0.08898615837097168, 0.08950172364711761, 0.09008023142814636, 0.09114883840084076, 0.09111832827329636, 0.09170728176832199, 0.09167659282684326, 0.09164590388536453, 0.0909964069724083, 0.09158457815647125, 0.09155391901731491], [0.08874601870775223, 0.08932523429393768, 0.08997564017772675, 0.09117846190929413, 0.09114409983158112, 0.09180775284767151, 0.0917731523513794, 0.09173856675624847, 0.09100678563117981, 0.09166944026947021, 0.09163489192724228], [0.08875848352909088, 0.0893343910574913, 0.0899810716509819, 0.09117691963911057, 0.09114275872707367, 0.09180252999067307, 0.09176813066005707, 0.09173375368118286, 0.09100624173879623, 0.09166502952575684, 0.09163068234920502], [0.08877095580101013, 0.08934356272220612, 0.08998651057481766, 0.0911753848195076, 0.09114143252372742, 0.09179731458425522, 0.09176312386989594, 0.09172894060611725, 0.09100571274757385, 0.09166062623262405, 0.09162648022174835], [0.08903612196445465, 0.08953843265771866, 0.09010195732116699, 0.09114266186952591, 0.09111295640468597, 0.09168639779090881, 0.09165651351213455, 0.09162664413452148, 0.09099423885345459, 0.09156692773103714, 0.09153708815574646], [0.08879588544368744, 0.08936189115047455, 0.08999737352132797, 0.09117231518030167, 0.09113875031471252, 0.09178687632083893, 0.09175308793783188, 0.09171931445598602, 0.0910046398639679, 0.0916518047451973, 0.09161806851625443], [0.08880835026502609, 0.08937105536460876, 0.09000280499458313, 0.0911707729101181, 0.09113740921020508, 0.09178165346384048, 0.09174806624650955, 0.09171450138092041, 0.09100409597158432, 0.09164739400148392, 0.09161386638879776]], [[0.08983835577964783, 0.08980965614318848, 0.08978098630905151, 0.08871970325708389, 0.08811967819929123, 0.09027691930532455, 0.08806341141462326, 0.08963772654533386, 0.10704933106899261, 0.08935212343931198, 0.08935212343931198], [0.08984659612178802, 0.08981810510158539, 0.08978962153196335, 0.08873548358678818, 0.08813945204019547, 0.09028219431638718, 0.08808355778455734, 0.0896473303437233, 0.10693042725324631, 0.08936365693807602, 0.08936365693807602], [0.08985481411218643, 0.08982651680707932, 0.0897982269525528, 0.08875123411417007, 0.08815920352935791, 0.09028742462396622, 0.08810368180274963, 0.08965690433979034, 0.10681162029504776, 0.08937516063451767, 0.08937516063451767], [0.09015219658613205, 0.09013116359710693, 0.09011013060808182, 0.08933056145906448, 0.08888869732618332, 0.09047356992959976, 0.08884721994400024, 0.0900050476193428, 0.10247056931257248, 0.08979541063308716, 0.08979541063308716], [0.09031415730714798, 0.09029728919267654, 0.09028042107820511, 0.08965474367141724, 0.08929961174726486, 0.09057175368070602, 0.08926626294851303, 0.0901961475610733, 0.10006362944841385, 0.09002795815467834, 0.09002795815467834], [0.08971108496189117, 0.08967944234609604, 0.0896478146314621, 0.08847792446613312, 0.08781713247299194, 0.09019500017166138, 0.08775518834590912, 0.08948981016874313, 0.10887686908245087, 0.08917488902807236, 0.08917488902807236], [0.0903291255235672, 0.0903126522898674, 0.0902961790561676, 0.08968502283096313, 0.08933810144662857, 0.09058070927858353, 0.08930551260709763, 0.09021386504173279, 0.09983967989683151, 0.09004958719015121, 0.09004958719015121], [0.08989576995372772, 0.0898684486746788, 0.08984112739562988, 0.0888298824429512, 0.08825787901878357, 0.09031348675489426, 0.08820422738790512, 0.08970465511083603, 0.10621939599514008, 0.08943255245685577, 0.08943255245685577], [0.08314847946166992, 0.08302197605371475, 0.0828956738114357, 0.07832732796669006, 0.07583395391702652, 0.08510137349367142, 0.07560338079929352, 0.08226701617240906, 0.1917508840560913, 0.08102495968341827, 0.08102495968341827], [0.08997666835784912, 0.089951291680336, 0.08992591500282288, 0.08898626267910004, 0.08845441043376923, 0.09036457538604736, 0.08840451389551163, 0.08979915082454681, 0.10504453629255295, 0.08954635262489319, 0.08954635262489319], [0.08997666835784912, 0.089951291680336, 0.08992591500282288, 0.08898626267910004, 0.08845441043376923, 0.09036457538604736, 0.08840451389551163, 0.08979915082454681, 0.10504453629255295, 0.08954635262489319, 0.08954635262489319]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1763892780766157e-05, "add_observations_from_episodes_to_batch": 2.8039910773634655e-06, "batch_individual_items": 1.2175875941224068e-05, "add_time_dim_to_batch_and_zero_pad": 6.819836803729991e-06, "add_states_from_episodes_to_batch": 2.745778963481597e-06}}, "connector_pipeline_timer": 5.7959557044834974e-05}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.907559395546477e-06, "tensor_to_numpy": 1.4717013492425913e-05, "remove_single_ts_time_rank_from_batch": 1.1772904625456517e-05, "get_actions": 3.477544639810975e-05, "listify_data_for_vector_env": 1.0213538291410107e-05, "un_batch_to_individual_items": 6.461781707988541e-06}}, "connector_pipeline_timer": 0.00011154972649499865}, "rlmodule_inference_timer": 3.078196179986958e-05, "episode_return_mean": -0.6333333333333333, "module_episode_returns_mean": {"default_policy": -0.6333333333333333}, "weights_seq_no": 3.0, "episode_return_max": 14.5, "num_episodes_lifetime": 60, "env_to_module_sum_episodes_length_out": 10.368205581254823, "env_step_timer": 1.3627800880169303e-05, "episode_len_min": 20, "env_reset_timer": 0.000725803980138153, "num_env_steps_sampled_lifetime": 15400, "num_env_steps_sampled": 400, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368205581254823, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "episode_duration_sec_mean": 0.0054391757119446995, "episode_return_min": -13.5, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "sample": 0.1345098925845814, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "agent_episode_returns_mean": {"default_agent": -0.6333333333333333}, "time_between_sampling": 9.53890439247014}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "ba99e_00000", "date": "2025-08-11_18-53-09", "timestamp": 1754931189, "time_this_iter_s": 9.44245195388794, "time_total_s": 29.41033101081848, "pid": 11884, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1619f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 29.41033101081848, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 34.73076923076923, "ram_util_percent": 78.3153846153846}}
{"timers": {"training_iteration": 10.17928981552524, "restore_env_runners": 9.323384028859435e-06, "training_step": 10.179089955973241, "env_runner_sampling_timer": 1.662553769350769, "learner_update_timer": 8.340990354071828, "synch_weights": 0.0017215918687978988, "restore_eval_env_runners": 7.13077501161024e-05, "evaluation_iteration": 0.14744604989455543, "synch_eval_env_connectors": 0.00018409175690030678, "synch_env_connectors": 5.5752438842318955e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.234854193921657e-05, "add_observations_from_episodes_to_batch": 2.8133696703773052e-06, "batch_individual_items": 1.2376973143663628e-05, "add_time_dim_to_batch_and_zero_pad": 7.1273569588543705e-06, "add_states_from_episodes_to_batch": 2.745753014460936e-06}}, "connector_pipeline_timer": 5.9544261172943886e-05}, "module_to_env_connector": {"connector_pipeline_timer": 0.00011755887174181051, "timers": {"connectors": {"get_actions": 3.946004046169191e-05, "normalize_and_clip_actions": 7.854178773008632e-06, "un_batch_to_individual_items": 6.49198383748978e-06, "listify_data_for_vector_env": 1.038352664376555e-05, "tensor_to_numpy": 1.5327300244619112e-05, "remove_single_ts_time_rank_from_batch": 1.1760814499332556e-05}}}, "weights_seq_no": 3.0, "episode_return_max": 14.5, "episode_duration_sec_mean": 0.005250289343763143, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "env_reset_timer": 3.6438258887554446e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -61250.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "episode_return_min": -5.5, "agent_episode_returns_mean": {"default_agent": 5.22}, "num_env_steps_sampled_lifetime": -1225000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "env_step_timer": 1.3656005654566007e-05, "time_between_sampling": 0.032245753388307666, "num_episodes": 250.0, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 5.22}, "sample": 0.0056291097467482155, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 3.164256616500373e-05, "episode_return_mean": 5.22, "episode_len_max": 20, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3275.343879074972}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13538661538658034, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009365769196154783, "add_observations_from_episodes_to_batch": 0.0008399959185867337, "add_columns_from_episodes_to_train_batch": 0.04170619931541953, "add_time_dim_to_batch_and_zero_pad": 0.07575555390099332, "add_states_from_episodes_to_batch": 0.0034889627685066077, "batch_individual_items": 0.003985147275945405, "numpy_to_tensor": 7.580463168781717e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 143640, "module_train_batch_size_mean": 997.6156867483631, "vf_explained_var": 0.0018785595893859863, "total_loss": 0.27837708592414856, "weights_seq_no": 24.0, "vf_loss_unclipped": 47.10076904296875, "diff_num_grad_updates_vs_sampler_policy": 21.0, "entropy": 0.6924270391464233, "vf_loss": 0.35932546854019165, "policy_loss": -0.0004931767471134663, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 3.639174610725604e-05}, "__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 287280, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 792000, "num_env_steps_trained_lifetime_throughput": 54316.12421516602}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 21.0, "num_module_steps_trained": 35910, "total_loss": 0.0, "num_module_steps_trained_lifetime": 143640, "module_train_batch_size_mean": 997.6156867483631, "weights_seq_no": 24.0}}}, "intrinsic_reward_module": {"total_loss": 0.0, "weights_seq_no": 4.0, "num_trainable_parameters": 8266, "num_module_steps_trained_lifetime": 23940, "module_train_batch_size_mean": 997.8923005732703, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 718.9554380854895}, "default_policy": {"use_intrinsic_rewards": 0.0, "num_trainable_parameters": 16595, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 23940, "module_train_batch_size_mean": 997.8923005732703, "vf_explained_var": 0.002158224582672119, "total_loss": 0.2775583863258362, "weights_seq_no": 4.0, "mean_kl_loss": 3.89236920455005e-05, "vf_loss_unclipped": 47.27592849731445, "curr_kl_coeff": 0.010098995640873909, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.692416250705719, "vf_loss": 0.3583084046840668, "curr_entropy_coeff": 0.0015431216992, "policy_loss": -0.0005144284223206341, "num_module_steps_trained_lifetime_throughput": 718.9435099222877}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 47880, "num_env_steps_trained_lifetime": 132000, "num_env_steps_trained": 33000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 3965.749841728601, "num_module_steps_trained_throughput": 30363688.006600805, "num_module_steps_trained_lifetime_throughput": 12972321.38284097}, "IntrinsicAttentionMask": [[[0.09098314493894577, 0.09027853608131409, 0.09026632457971573, 0.09094623476266861, 0.09118331223726273, 0.09092163294553757, 0.09115865081548691, 0.091146320104599, 0.09113398939371109, 0.09087245166301727, 0.09110934287309647], [0.09091418236494064, 0.09086588770151138, 0.09086504578590393, 0.09091166406869888, 0.0909278392791748, 0.09090998023748398, 0.0909261554479599, 0.09092532098293304, 0.09092447906732559, 0.09090662002563477, 0.09092279523611069], [0.09091297537088394, 0.09087612479925156, 0.09087549149990082, 0.09091105312108994, 0.09092339128255844, 0.09090976417064667, 0.09092210978269577, 0.09092146903276443, 0.0909208282828331, 0.09090720117092133, 0.09091954678297043], [0.09097956866025925, 0.09030911326408386, 0.09029749780893326, 0.09094444662332535, 0.09116998314857483, 0.09092105180025101, 0.09114652127027512, 0.09113479405641556, 0.091123066842556, 0.09087426215410233, 0.09109961986541748], [0.09100247919559479, 0.09011303633451462, 0.09009763598442078, 0.09095584601163864, 0.09125549346208572, 0.09092476218938828, 0.0912243127822876, 0.09120872616767883, 0.09119314700365067, 0.09086263924837112, 0.09116198122501373], [0.09097718447446823, 0.09032952040433884, 0.09031828492879868, 0.09094326943159103, 0.0911611020565033, 0.09092065691947937, 0.09113844484090805, 0.09112711250782013, 0.0911157876253128, 0.09087546914815903, 0.09109314531087875], [0.09100010246038437, 0.09013339132070541, 0.09011838585138321, 0.09095466136932373, 0.0912466049194336, 0.09092437475919724, 0.09121622145175934, 0.09120103716850281, 0.09118586033582687, 0.09086384624242783, 0.09115549921989441], [0.09099891781806946, 0.090143583714962, 0.09012876451015472, 0.09095408022403717, 0.09124217182397842, 0.09092419594526291, 0.091212198138237, 0.09119721502065659, 0.09118223190307617, 0.09086445719003677, 0.09115226566791534], [0.09099772572517395, 0.0901537537574768, 0.09013914316892624, 0.09095348417758942, 0.09123772382736206, 0.09092400223016739, 0.09120814502239227, 0.09119336307048798, 0.09117858111858368, 0.09086506068706512, 0.09114902466535568], [0.0909724161028862, 0.09037031978368759, 0.0903598740696907, 0.09094088524580002, 0.09114333242177963, 0.09091988205909729, 0.09112227708101273, 0.09111174941062927, 0.09110122174024582, 0.09087786823511124, 0.0910801813006401], [0.09099535644054413, 0.0901741236448288, 0.09015990048646927, 0.0909523069858551, 0.09122884273529053, 0.09092362225055695, 0.09120006859302521, 0.09118568152189255, 0.09117130935192108, 0.09086627513170242, 0.09114255011081696]], [[0.09146075695753098, 0.09145058691501617, 0.09164643287658691, 0.09106282144784927, 0.09105270355939865, 0.09161587804555893, 0.09103246033191681, 0.09138962626457214, 0.08574346452951431, 0.09128818660974503, 0.09225702285766602], [0.09145013988018036, 0.09144017845392227, 0.09163212776184082, 0.0910600796341896, 0.0910501629114151, 0.09160218387842178, 0.09103032201528549, 0.09138041734695435, 0.08584274351596832, 0.091280996799469, 0.09223054349422455], [0.0916525200009346, 0.09163866937160492, 0.09190566092729568, 0.09111065417528152, 0.09109688550233841, 0.09186399728059769, 0.09106934815645218, 0.09155560284852982, 0.08394989371299744, 0.09141743928194046, 0.09273937344551086], [0.09103631228208542, 0.09103402495384216, 0.09107807278633118, 0.09094659239053726, 0.090944305062294, 0.09107121080160141, 0.09093973785638809, 0.09102030098438263, 0.08971705287694931, 0.09099744260311127, 0.09121494740247726], [0.09102527052164078, 0.09102318435907364, 0.09106338024139404, 0.09094337373971939, 0.09094129502773285, 0.09105711430311203, 0.09093712270259857, 0.09101065248250961, 0.08982046693563461, 0.09098979085683823, 0.09118828922510147], [0.09162122756242752, 0.09160798043012619, 0.09186325967311859, 0.09110304713249207, 0.0910898819565773, 0.09182342141866684, 0.09106354415416718, 0.09152855724096298, 0.08424240350723267, 0.09139643609523773, 0.09266016632318497], [0.0910031646490097, 0.0910014733672142, 0.09103398770093918, 0.09093693643808365, 0.09093524515628815, 0.09102891385555267, 0.09093187004327774, 0.09099134057760239, 0.09002761542797089, 0.09097447246313095, 0.09113497287034988], [0.09138624370098114, 0.09137748926877975, 0.09154613316059113, 0.09104343503713608, 0.09103471785783768, 0.09151983261108398, 0.09101727604866028, 0.09132498502731323, 0.08644062280654907, 0.0912376120686531, 0.09207160025835037], [0.08324439823627472, 0.08334118872880936, 0.0814976841211319, 0.08712754398584366, 0.08722885698080063, 0.08178230375051498, 0.08743182569742203, 0.08392433822154999, 0.16348622739315033, 0.08490455150604248, 0.07603103667497635], [0.09127897769212723, 0.09127224236726761, 0.09140214323997498, 0.09101475775241852, 0.09100803732872009, 0.09138187766075134, 0.09099458158016205, 0.09123177826404572, 0.08744462579488754, 0.09116444736719131, 0.09180654585361481], [0.09225595742464066, 0.0922299325466156, 0.09273213893175125, 0.09124045819044113, 0.09121471643447876, 0.09265368431806564, 0.0911632627248764, 0.0920739397406578, 0.07831264287233353, 0.09181474149227142, 0.0943085104227066]], [[0.08996224403381348, 0.09024161100387573, 0.09022540599107742, 0.09146123379468918, 0.09111278504133224, 0.0910964161157608, 0.09108005464076996, 0.0913955345749855, 0.09137912094593048, 0.09103097766637802, 0.09101462364196777], [0.08976374566555023, 0.09010130912065506, 0.09008171409368515, 0.09157760441303253, 0.09115539491176605, 0.09113557636737823, 0.09111575037240982, 0.09149797260761261, 0.09147807210683823, 0.09105632454156876, 0.09103652089834213], [0.08977524936199188, 0.0901094451546669, 0.09009004384279251, 0.09157086908817291, 0.09115293622016907, 0.09113331139087677, 0.09111369401216507, 0.09149204194545746, 0.09147235006093979, 0.09105486422777176, 0.09103526175022125], [0.08890796452760696, 0.08949500322341919, 0.08946087956428528, 0.09208177775144577, 0.09133874624967575, 0.09130392223596573, 0.0912691205739975, 0.09194143861532211, 0.09190638363361359, 0.09116476774215698, 0.09113001078367233], [0.08915068954229355, 0.08966720849275589, 0.08963719755411148, 0.09193837642669678, 0.0912868082523346, 0.09125626087188721, 0.09122571349143982, 0.09181535989046097, 0.09178463369607925, 0.09113415330648422, 0.09110365062952042], [0.08916212618350983, 0.08967531472444534, 0.08964550495147705, 0.09193162620067596, 0.0912843570113182, 0.09125401079654694, 0.09122366458177567, 0.09180942922830582, 0.09177889674901962, 0.09113270789384842, 0.09110240638256073], [0.0891735628247261, 0.0896834284067154, 0.08965380489826202, 0.09192487597465515, 0.09128190577030182, 0.09125175327062607, 0.09122161567211151, 0.09180349111557007, 0.09177316725254059, 0.09113126248121262, 0.09110116213560104], [0.08895362168550491, 0.08952740579843521, 0.08949405699968338, 0.09205477684736252, 0.09132897853851318, 0.09129495918750763, 0.09126095473766327, 0.09191770106554031, 0.09188346564769745, 0.09115901589393616, 0.09112506359815598], [0.08896504342556, 0.08953551948070526, 0.08950236439704895, 0.0920480340719223, 0.09132654219865799, 0.09129272401332855, 0.09125892072916031, 0.09191177785396576, 0.09187773615121841, 0.09115758538246155, 0.09112382680177689], [0.08920787274837494, 0.08970775455236435, 0.08967871218919754, 0.09190463274717331, 0.09127455949783325, 0.09124501049518585, 0.09121547639369965, 0.09178568422794342, 0.09175597131252289, 0.0911269262433052, 0.09109742194414139], [0.08921931684017181, 0.0897158607840538, 0.08968701213598251, 0.0918978825211525, 0.09127210825681686, 0.09124276041984558, 0.09121342748403549, 0.09177974611520767, 0.09175024181604385, 0.0911254733800888, 0.0910961702466011]], [[0.09147948026657104, 0.09146931022405624, 0.09166519343852997, 0.09108146280050278, 0.09107134491205215, 0.09163463115692139, 0.09084642678499222, 0.09140833467245102, 0.08576101809740067, 0.09130688011646271, 0.09227591007947922], [0.09146849811077118, 0.0914585292339325, 0.09165052324533463, 0.09107837080955505, 0.09106843918561935, 0.09162057191133499, 0.09084796905517578, 0.09139876067638397, 0.08585997670888901, 0.09129931777715683, 0.0922490581870079], [0.09167803078889847, 0.09166417270898819, 0.09193123877048492, 0.09113600850105286, 0.09112223982810974, 0.09188956022262573, 0.09081633388996124, 0.0915810763835907, 0.08397325873374939, 0.09144287556409836, 0.09276518225669861], [0.09104051440954208, 0.09103823453187943, 0.09108228236436844, 0.09095079451799393, 0.09094850718975067, 0.09107542037963867, 0.09089766442775726, 0.0910245031118393, 0.0897211953997612, 0.09100164473056793, 0.09121916443109512], [0.09102912247180939, 0.09102703630924225, 0.09106723964214325, 0.090947225689888, 0.09094513952732086, 0.09106096625328064, 0.09089873731136322, 0.09101450443267822, 0.08982425928115845, 0.09099364280700684, 0.09119214862585068], [0.09164562821388245, 0.09163238108158112, 0.09188771992921829, 0.09112730622291565, 0.09111414104700089, 0.09184787422418594, 0.09082154929637909, 0.09155293554067612, 0.0842648446559906, 0.09142077714204788, 0.09268484264612198], [0.09077248722314835, 0.09077483415603638, 0.0907297134399414, 0.09086453169584274, 0.09086687862873077, 0.0907367467880249, 0.0909191146492958, 0.09078890830278397, 0.09214462339878082, 0.09081234037876129, 0.09058979153633118], [0.09140237420797348, 0.0913936197757721, 0.09156229346990585, 0.09105950593948364, 0.09105078130960464, 0.09153598546981812, 0.09085693955421448, 0.09134110063314438, 0.08645588904619217, 0.09125371277332306, 0.09208784997463226], [0.08307149261236191, 0.08316808193922043, 0.08132840692996979, 0.08694656193256378, 0.08704766631126404, 0.08161243796348572, 0.0893276035785675, 0.08375002443790436, 0.1631464809179306, 0.0847281888127327, 0.07587311416864395], [0.0912914052605629, 0.09128466248512268, 0.09141457825899124, 0.0910271480679512, 0.09102042019367218, 0.09139431267976761, 0.0908709168434143, 0.09124419838190079, 0.08745653182268143, 0.09117686003446579, 0.09181904047727585], [0.09230389446020126, 0.09227785468101501, 0.09278032183647156, 0.09128786623477936, 0.09126210957765579, 0.09270182251930237, 0.09069107472896576, 0.09212177991867065, 0.07835334539413452, 0.09186244755983353, 0.09435751289129257]], [[0.09100598096847534, 0.09054884314537048, 0.09028898179531097, 0.09096906334161758, 0.09120620042085648, 0.09094446152448654, 0.09093215316534042, 0.09116920083761215, 0.09090755879878998, 0.09114453941583633, 0.09088297188282013], [0.09094759821891785, 0.09076616168022156, 0.09066278487443924, 0.09093296527862549, 0.09102688729763031, 0.09092321246862411, 0.09091833978891373, 0.09101224690675735, 0.09090857952833176, 0.09100247919559479, 0.09089883416891098], [0.09091416001319885, 0.09089028835296631, 0.09087667614221573, 0.09091223776340485, 0.09092457592487335, 0.09091094881296158, 0.09091030806303024, 0.09092265367507935, 0.09090902656316757, 0.09092136472463608, 0.0909077450633049], [0.09100128710269928, 0.09056634455919266, 0.09031905978918076, 0.09096616506576538, 0.09119175374507904, 0.09094276279211044, 0.09093105792999268, 0.09115655720233917, 0.09090765565633774, 0.09113310277462006, 0.090884268283844], [0.09103140234947205, 0.0904540866613388, 0.09012626856565475, 0.09098474681377411, 0.09128449112176895, 0.09095365554094315, 0.09093812108039856, 0.09123770892620087, 0.09090704470872879, 0.09120653569698334, 0.09087598323822021], [0.09099815785884857, 0.09057801961898804, 0.09033910930156708, 0.09096423536539078, 0.09118212014436722, 0.09094162285327911, 0.09093032032251358, 0.09114812314510345, 0.09090771526098251, 0.0911254733800888, 0.09088512510061264], [0.09099658578634262, 0.09058384597301483, 0.09034913778305054, 0.09096326678991318, 0.09117729961872101, 0.09094104915857315, 0.09092994779348373, 0.0911439061164856, 0.0909077450633049, 0.09112165123224258, 0.09088554978370667], [0.09102670103311539, 0.09047158062458038, 0.09015628695487976, 0.0909818485379219, 0.09127002954483032, 0.09095195680856705, 0.09093701839447021, 0.09122505784034729, 0.09090714156627655, 0.09119508415460587, 0.09087727218866348], [0.09099345654249191, 0.09059552103281021, 0.09036919474601746, 0.09096132963895798, 0.09116766601800919, 0.09093991667032242, 0.09092921018600464, 0.09113547205924988, 0.09090780466794968, 0.09111402183771133, 0.09088640660047531], [0.09102358669042587, 0.09048324078321457, 0.09017631411552429, 0.0909799262881279, 0.0912603959441185, 0.09095083177089691, 0.09093628823757172, 0.09121662378311157, 0.09090720862150192, 0.09118745476007462, 0.09087813645601273], [0.09099031984806061, 0.0906071811914444, 0.09038925170898438, 0.09095938503742218, 0.09115802496671677, 0.09093876928091049, 0.09092846512794495, 0.09112703800201416, 0.09090785682201385, 0.09110638499259949, 0.09088725596666336]], [[0.09015367925167084, 0.09012088924646378, 0.08942700177431107, 0.08822398632764816, 0.08754470199346542, 0.08998985588550568, 0.0881277546286583, 0.08926448971033096, 0.10926637798547745, 0.08894062787294388, 0.08894062787294388], [0.09015928208827972, 0.09012668579816818, 0.08943691104650497, 0.08824096620082855, 0.08756563812494278, 0.08999642729759216, 0.08814530074596405, 0.08927536755800247, 0.1091466173529625, 0.0889534056186676, 0.0889534056186676], [0.09027506411075592, 0.09024663269519806, 0.08964463323354721, 0.08859942853450775, 0.08800841867923737, 0.09013299643993378, 0.0885157436132431, 0.08950354903936386, 0.1066288948059082, 0.08922228962182999, 0.08922228962182999], [0.09046387672424316, 0.09044277667999268, 0.08999540656805038, 0.08921682834625244, 0.08877552300691605, 0.09035838395357132, 0.08915439248085022, 0.08989045768976212, 0.10234009474515915, 0.08968108892440796, 0.08968108892440796], [0.09056378155946732, 0.0905468612909317, 0.09018819779157639, 0.08956316113471985, 0.08920839428901672, 0.09047923237085342, 0.08951298147439957, 0.09010400623083115, 0.09996140748262405, 0.08993599563837051, 0.08993599563837051], [0.09018152952194214, 0.09014970809221268, 0.08947643637657166, 0.08830879628658295, 0.08764927089214325, 0.09002257883548737, 0.08821537345647812, 0.08931873738765717, 0.10866869986057281, 0.08900441974401474, 0.08900441974401474], [0.0904783308506012, 0.09045781195163727, 0.09002295136451721, 0.08926599472761154, 0.08883686363697052, 0.09037578850984573, 0.08920527994632721, 0.08992092311382294, 0.10200124233961105, 0.08971738070249557, 0.08971738070249557], [0.09030146151781082, 0.09027401357889175, 0.08969271183013916, 0.08868314325809479, 0.08811208605766296, 0.09016428887844086, 0.08860228955745697, 0.08955647051334381, 0.10604389011859894, 0.08928481489419937, 0.08928481489419937], [0.08510750532150269, 0.08497802913188934, 0.0822729542851448, 0.0777389407157898, 0.07526429742574692, 0.08446207642555237, 0.07738466560840607, 0.08164901286363602, 0.19030994176864624, 0.08041629195213318, 0.08041629195213318], [0.09035322815179825, 0.09032774716615677, 0.08978787809610367, 0.08884967863559723, 0.08831864595413208, 0.09022586792707443, 0.08877450227737427, 0.08966131508350372, 0.10488327592611313, 0.08940891176462173, 0.08940891176462173], [0.09035322815179825, 0.09032774716615677, 0.08978787809610367, 0.08884967863559723, 0.08831864595413208, 0.09022586792707443, 0.08877450227737427, 0.08966131508350372, 0.10488327592611313, 0.08940891176462173, 0.08940891176462173]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1772835908303476e-05, "add_observations_from_episodes_to_batch": 2.8060751803459633e-06, "batch_individual_items": 1.224206879118064e-05, "add_time_dim_to_batch_and_zero_pad": 6.866596307245826e-06, "add_states_from_episodes_to_batch": 2.7689973333366033e-06}}, "connector_pipeline_timer": 5.815457577951405e-05}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.927306474685132e-06, "tensor_to_numpy": 1.4749618090949235e-05, "remove_single_ts_time_rank_from_batch": 1.1898150012299564e-05, "get_actions": 3.501303938734031e-05, "listify_data_for_vector_env": 1.0223697406434589e-05, "un_batch_to_individual_items": 6.520051095375331e-06}}, "connector_pipeline_timer": 0.0001122884491533214}, "rlmodule_inference_timer": 3.0431044290540006e-05, "episode_return_mean": 0.45, "module_episode_returns_mean": {"default_policy": 0.45}, "weights_seq_no": 4.0, "episode_return_max": 15.5, "num_episodes_lifetime": 80, "env_to_module_sum_episodes_length_out": 10.368237912813044, "env_step_timer": 1.3741251037852648e-05, "episode_len_min": 20, "env_reset_timer": 0.0007194726109551267, "num_env_steps_sampled_lifetime": 20400, "num_env_steps_sampled": 400, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368237912813044, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "episode_duration_sec_mean": 0.005359448457602412, "episode_return_min": -13.5, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "sample": 0.13427732407880424, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "agent_episode_returns_mean": {"default_agent": 0.45}, "time_between_sampling": 9.536202107294626}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "ba99e_00000", "date": "2025-08-11_18-53-19", "timestamp": 1754931199, "time_this_iter_s": 9.36377477645874, "time_total_s": 38.77410578727722, "pid": 11884, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1619f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 38.77410578727722, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 33.65, "ram_util_percent": 78.15}}
{"timers": {"training_iteration": 10.170514170279471, "restore_env_runners": 9.289739699354393e-06, "training_step": 10.170314023503494, "env_runner_sampling_timer": 1.661151947076677, "learner_update_timer": 8.333550021371352, "synch_weights": 0.001712856369747555, "restore_eval_env_runners": 7.068967217416503e-05, "evaluation_iteration": 0.14713261314534692, "synch_eval_env_connectors": 0.0001832308398085879, "synch_env_connectors": 5.560740886372514e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2371440025636661e-05, "add_observations_from_episodes_to_batch": 2.7856348393799865e-06, "batch_individual_items": 1.2461681881995424e-05, "add_time_dim_to_batch_and_zero_pad": 7.057107433437364e-06, "add_states_from_episodes_to_batch": 2.74274462686846e-06}}, "connector_pipeline_timer": 5.95391498744386e-05}, "module_to_env_connector": {"connector_pipeline_timer": 0.00011797584928871496, "timers": {"connectors": {"get_actions": 3.9481635248969886e-05, "normalize_and_clip_actions": 7.913323213558338e-06, "un_batch_to_individual_items": 6.501491561756299e-06, "listify_data_for_vector_env": 1.043989466794192e-05, "tensor_to_numpy": 1.546024484232346e-05, "remove_single_ts_time_rank_from_batch": 1.181595069194381e-05}}}, "weights_seq_no": 4.0, "episode_return_max": 14.5, "episode_duration_sec_mean": 0.005253883175551891, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "env_reset_timer": 3.5959797804325207e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -92125.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "episode_return_min": -5.5, "agent_episode_returns_mean": {"default_agent": 5.619999999999999}, "num_env_steps_sampled_lifetime": -1842500.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "env_step_timer": 1.367493758354228e-05, "time_between_sampling": 0.03193728661978986, "num_episodes": 250.0, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 5.619999999999999}, "sample": 0.005599580401812054, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 3.1588712991459957e-05, "episode_return_mean": 5.619999999999999, "episode_len_max": 20, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3273.6326331581395}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1353692554827961, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009356678593991164, "add_observations_from_episodes_to_batch": 0.0008395742995460668, "add_columns_from_episodes_to_train_batch": 0.041703782742652726, "add_time_dim_to_batch_and_zero_pad": 0.07574870753222616, "add_states_from_episodes_to_batch": 0.003490849390584166, "batch_individual_items": 0.003985731633782785, "numpy_to_tensor": 7.556575579677128e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 179550, "module_train_batch_size_mean": 997.5798029998547, "vf_explained_var": 0.0018643736839294434, "total_loss": 0.2788199782371521, "weights_seq_no": 30.0, "vf_loss_unclipped": 47.64303207397461, "diff_num_grad_updates_vs_sampler_policy": 26.0, "entropy": 0.692294180393219, "vf_loss": 0.35926583409309387, "policy_loss": 9.391029038852139e-07, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 5.960990165476687e-06}, "__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 359100, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 990000, "num_env_steps_trained_lifetime_throughput": 53583.338305894686}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 26.0, "num_module_steps_trained": 35910, "total_loss": 0.0, "num_module_steps_trained_lifetime": 179550, "module_train_batch_size_mean": 997.5798029998547, "weights_seq_no": 30.0}}}, "intrinsic_reward_module": {"total_loss": 0.0, "weights_seq_no": 5.0, "num_trainable_parameters": 8266, "num_module_steps_trained_lifetime": 29925, "module_train_batch_size_mean": 997.8691961675322, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 719.0207656462366}, "default_policy": {"use_intrinsic_rewards": 0.0, "num_trainable_parameters": 16595, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 29925, "module_train_batch_size_mean": 997.8691961675322, "vf_explained_var": 0.0003948211669921875, "total_loss": 0.27808186411857605, "weights_seq_no": 5.0, "mean_kl_loss": 5.875850092706969e-06, "vf_loss_unclipped": 47.8804817199707, "curr_kl_coeff": 0.0050494978204369545, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.6922950744628906, "vf_loss": 0.3583199977874756, "curr_entropy_coeff": 0.0015431216992, "policy_loss": 5.280883783598256e-07, "num_module_steps_trained_lifetime_throughput": 719.0093024241238}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 59850, "num_env_steps_trained_lifetime": 165000, "num_env_steps_trained": 33000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 3966.0647034705958, "num_module_steps_trained_throughput": 29518380.57013162, "num_module_steps_trained_lifetime_throughput": 12925122.504837448}, "IntrinsicAttentionMask": [[[0.08981375396251678, 0.09042096138000488, 0.09040471911430359, 0.09131026268005371, 0.09129385650157928, 0.09127745777368546, 0.09092970937490463, 0.0912446677684784, 0.09122828394174576, 0.09121189266443253, 0.0908643901348114], [0.08931601792573929, 0.0901976078748703, 0.09017398953437805, 0.09149365872144699, 0.09146970510482788, 0.09144575148820877, 0.09093833714723587, 0.09139786660671234, 0.09137394279241562, 0.0913500115275383, 0.09084312617778778], [0.08932925015687943, 0.09020356088876724, 0.09018013626337051, 0.09148876368999481, 0.09146501123905182, 0.09144125878810883, 0.09093810617923737, 0.09139378368854523, 0.09137004613876343, 0.09134633094072342, 0.09084369987249374], [0.08859705924987793, 0.08987326174974442, 0.08983899652957916, 0.09175977110862732, 0.09172479063272476, 0.0916898176074028, 0.09094995260238647, 0.09161992371082306, 0.09158499538898468, 0.0915500745177269, 0.0908113420009613], [0.0886102169752121, 0.08987921476364136, 0.08984515070915222, 0.09175489097833633, 0.0917201116681099, 0.09168534725904465, 0.09094974398612976, 0.09161585569381714, 0.09158112108707428, 0.09154640883207321, 0.09081193059682846], [0.08862337470054626, 0.0898851677775383, 0.08985129743814468, 0.09175001084804535, 0.09171543270349503, 0.0916808694601059, 0.09094955027103424, 0.09161178022623062, 0.09157726168632507, 0.09154274314641953, 0.09081252664327621], [0.0889032781124115, 0.09001165628433228, 0.08998192846775055, 0.09164625406265259, 0.09161598980426788, 0.09158572554588318, 0.09094513207674026, 0.09152523428201675, 0.09149500727653503, 0.09146478027105331, 0.09082503616809845], [0.0886496901512146, 0.08989707380533218, 0.08986359089612961, 0.09174025058746338, 0.09170608222484589, 0.09167192131280899, 0.09094914048910141, 0.09160364419221878, 0.09156952053308487, 0.09153541922569275, 0.09081371873617172], [0.08866285532712936, 0.08990303426980972, 0.08986974507570267, 0.0917353704571724, 0.09170140326023102, 0.09166745096445084, 0.09094893932342529, 0.09159957617521286, 0.09156566113233566, 0.09153175354003906, 0.09081430733203888], [0.08867601305246353, 0.08990897983312607, 0.08987588435411453, 0.09173048287630081, 0.09169672429561615, 0.09166296571493149, 0.09094873070716858, 0.09159550070762634, 0.09156177937984467, 0.09152808040380478, 0.09081489592790604], [0.08895605802536011, 0.09003547579050064, 0.090006522834301, 0.09162671864032745, 0.09159725904464722, 0.09156780689954758, 0.09094428271055222, 0.09150893241167068, 0.09147951006889343, 0.09145010262727737, 0.09082737565040588]], [[0.09196221828460693, 0.091658815741539, 0.09193361550569534, 0.09111540764570236, 0.09081479161977768, 0.09189072996377945, 0.09107290208339691, 0.0915733203291893, 0.08375518769025803, 0.09143111854791641, 0.09279189258813858], [0.09165198355913162, 0.09144005179405212, 0.09163200855255127, 0.09105996787548065, 0.09084941446781158, 0.09160206466913223, 0.09103021025657654, 0.0913802981376648, 0.08584265410900116, 0.09128087759017944, 0.092230424284935], [0.09193321317434311, 0.09163843840360641, 0.09190542250871658, 0.09111042320728302, 0.09081828594207764, 0.09186375141143799, 0.09106911718845367, 0.09155536442995071, 0.08394970744848251, 0.09141720086336136, 0.09273913502693176], [0.09108265489339828, 0.09103401750326157, 0.09107807278633118, 0.09094658493995667, 0.09089802950620651, 0.09107120335102081, 0.0909397304058075, 0.09102029353380203, 0.08971703797578812, 0.09099743515253067, 0.09121494740247726], [0.09075994044542313, 0.09080131351947784, 0.09076383709907532, 0.09087579697370529, 0.09091721475124359, 0.0907696783542633, 0.09088164567947388, 0.09081299602985382, 0.09193746000528336, 0.09083245694637299, 0.09064760059118271], [0.09188961237668991, 0.09160777926445007, 0.09186304360628128, 0.09110284596681595, 0.09082342684268951, 0.09182321280241013, 0.09106334298849106, 0.09152834862470627, 0.08424224704504013, 0.09139623492956161, 0.09265995770692825], [0.09103736281394958, 0.0910014733672142, 0.09103398770093918, 0.09093692898750305, 0.09090107679367065, 0.09102891385555267, 0.09093187004327774, 0.09099134057760239, 0.09002760052680969, 0.09097447246313095, 0.09113497287034988], [0.09156357496976852, 0.091377392411232, 0.09154603630304337, 0.09104333817958832, 0.09085822105407715, 0.09151973575353622, 0.09101717919111252, 0.09132488816976547, 0.0864405557513237, 0.09123751521110535, 0.09207150340080261], [0.0812971219420433, 0.08332954347133636, 0.0814862921833992, 0.0871153175830841, 0.08929318934679031, 0.0817708820104599, 0.08741956949234009, 0.08391261100769043, 0.16346246004104614, 0.08489266037940979, 0.07602042704820633], [0.09141559153795242, 0.09127218276262283, 0.0914020836353302, 0.09101470559835434, 0.09087192267179489, 0.09138182550668716, 0.09099453687667847, 0.09123172610998154, 0.08744458854198456, 0.09116439521312714, 0.09180649369955063], [0.09278365224599838, 0.09222910553216934, 0.09273131191730499, 0.09123964607715607, 0.09069433063268661, 0.09265285730361938, 0.09116245061159134, 0.09207312017679214, 0.078311987221241, 0.09181392192840576, 0.09430766850709915]], [[0.08990313112735748, 0.09051094949245453, 0.09049468487501144, 0.09106926620006561, 0.09105290472507477, 0.09136829525232315, 0.09135188162326813, 0.0913354754447937, 0.09098750352859497, 0.09097115695476532, 0.09095481783151627], [0.08944574743509293, 0.0903286263346672, 0.09030497074127197, 0.09114200621843338, 0.09111814200878143, 0.09157858043909073, 0.09155460447072983, 0.09153062850236893, 0.09102274477481842, 0.09099891036748886, 0.0909750834107399], [0.0894579067826271, 0.0903334766626358, 0.09031002223491669, 0.09114006161689758, 0.09111639857292175, 0.09157296270132065, 0.09154918789863586, 0.09152541309595108, 0.09102179855108261, 0.09099816530942917, 0.09097453951835632], [0.08902998268604279, 0.09016218036413193, 0.09013181179761887, 0.0912080705165863, 0.09117734432220459, 0.09177055209875107, 0.09173963963985443, 0.0917087271809578, 0.09105455130338669, 0.09102388471364975, 0.09099321812391281], [0.08904210478067398, 0.09016704559326172, 0.09013687074184418, 0.0912061408162117, 0.0911756232380867, 0.09176494181156158, 0.09173423051834106, 0.09170352667570114, 0.09105362743139267, 0.09102315455675125, 0.09099268913269043], [0.08880901336669922, 0.09007345139980316, 0.09003951400518417, 0.09124317765235901, 0.0912087932229042, 0.0918729156255722, 0.0918382927775383, 0.09180368483066559, 0.09107138216495514, 0.09103706479072571, 0.09100275486707687], [0.08882111310958862, 0.09007831662893295, 0.09004457294940948, 0.091241255402565, 0.09120707213878632, 0.09186730533838272, 0.09183288365602493, 0.09179848432540894, 0.09107046574354172, 0.09103633463382721, 0.09100222587585449], [0.08883321285247803, 0.09008318185806274, 0.0900496244430542, 0.091239333152771, 0.09120535105466843, 0.09186169505119324, 0.09182748198509216, 0.09179327636957169, 0.0910695418715477, 0.0910356193780899, 0.0910017117857933], [0.08909061551094055, 0.09018649905920029, 0.09015710651874542, 0.09119844436645508, 0.09116872400045395, 0.09174250811338425, 0.09171260893344879, 0.09168271720409393, 0.0910499319434166, 0.09102024883031845, 0.0909905955195427], [0.08910273760557175, 0.09019135683774948, 0.09016215801239014, 0.09119650721549988, 0.09116698056459427, 0.09173689037561417, 0.09170719236135483, 0.09167750924825668, 0.09104899317026138, 0.09101951867341995, 0.09099005907773972], [0.08911488205194473, 0.09019622951745987, 0.09016723185777664, 0.09119459241628647, 0.09116527438163757, 0.09173129498958588, 0.09170180559158325, 0.09167231619358063, 0.09104807674884796, 0.09101880341768265, 0.09098954498767853]], [[0.09206567704677582, 0.09176193177700043, 0.09203704446554184, 0.09093110263347626, 0.0909169614315033, 0.09170486032962799, 0.09088868647813797, 0.09196549654006958, 0.08358579128980637, 0.09124617278575897, 0.09289628267288208], [0.09172458946704865, 0.09151250123977661, 0.0917045995593071, 0.09093129634857178, 0.09092138707637787, 0.09147262573242188, 0.09090157598257065, 0.09165466576814651, 0.08572136610746384, 0.0911518856883049, 0.09230349212884903], [0.0920337587594986, 0.09173866361379623, 0.09200594574213028, 0.09093136340379715, 0.09091761708259583, 0.09168321639299393, 0.09089013934135437, 0.09193643182516098, 0.08378473669290543, 0.09123753756284714, 0.09284056723117828], [0.09076233953237534, 0.090799480676651, 0.09076584130525589, 0.09090178459882736, 0.09090352803468704, 0.09080647677183151, 0.0909070372581482, 0.09077458083629608, 0.09185462445020676, 0.09086286276578903, 0.09066147357225418], [0.09074557572603226, 0.09078694134950638, 0.09074947237968445, 0.09090087562799454, 0.09090282768011093, 0.09079472720623016, 0.09090672433376312, 0.09075920283794403, 0.09196282923221588, 0.09085752815008163, 0.09063325822353363], [0.09165988117456436, 0.09146498143672943, 0.09164152294397354, 0.09093070775270462, 0.09092159569263458, 0.09142833948135376, 0.0909033790230751, 0.09159562736749649, 0.08612886071205139, 0.09113352000713348, 0.092191681265831], [0.09071202576160431, 0.09076182544231415, 0.09071671217679977, 0.0908990353345871, 0.09090138971805573, 0.09077120572328568, 0.09090607613325119, 0.09072842448949814, 0.09217958897352219, 0.09084683656692505, 0.09057681262493134], [0.091953806579113, 0.09168031066656113, 0.09192802011966705, 0.09093179553747177, 0.09091904759407043, 0.09162892401218414, 0.09089356660842896, 0.09186360985040665, 0.0842839851975441, 0.09121573716402054, 0.09270121157169342], [0.08002141118049622, 0.08209932595491409, 0.0802147388458252, 0.08810114115476608, 0.08820750564336777, 0.08249649405479431, 0.08842059969902039, 0.0807000994682312, 0.1693340539932251, 0.08576861768960953, 0.07463595271110535], [0.09113240242004395, 0.09107529371976852, 0.09112701565027237, 0.09091830253601074, 0.09091562032699585, 0.09106454253196716, 0.09091025590896606, 0.09111358225345612, 0.0894772857427597, 0.0909779742360115, 0.09128778427839279], [0.0929703637957573, 0.09241469949483871, 0.09291791915893555, 0.09090248495340347, 0.09087684005498886, 0.09231047332286835, 0.09082558006048203, 0.09278693795204163, 0.07802262157201767, 0.09147464483976364, 0.094497449696064]], [[0.08987303823232651, 0.09048064798116684, 0.09013593196868896, 0.09137053042650223, 0.0913541167974472, 0.09133770316839218, 0.09098973125219345, 0.0909733846783638, 0.0912884920835495, 0.0909406989812851, 0.09125570207834244], [0.08940186351537704, 0.0902843102812767, 0.08978333324193954, 0.09158159792423248, 0.09155761450529099, 0.09153364598751068, 0.09102574735879898, 0.09100191295146942, 0.09146176278591156, 0.0909542590379715, 0.09141387790441513], [0.08966855704784393, 0.09039556235074997, 0.08998299390077591, 0.09146205335855484, 0.09144236147403717, 0.0914226844906807, 0.09100542217493057, 0.09098583459854126, 0.09136365354061127, 0.09094665944576263, 0.0913243219256401], [0.08872090280056, 0.08999888598918915, 0.08927267044782639, 0.09188803285360336, 0.09185300022363663, 0.09181798249483109, 0.09107708185911179, 0.09104235470294952, 0.09171301126480103, 0.09097295254468918, 0.09164309501647949], [0.08873336017131805, 0.09000413119792938, 0.08928202092647552, 0.09188240766525269, 0.09184758365154266, 0.09181276708841324, 0.09107615053653717, 0.09104162454605103, 0.09170839935541153, 0.09097261726856232, 0.09163889288902283], [0.0887458324432373, 0.09000937640666962, 0.08929138630628586, 0.0918767899274826, 0.0918421670794487, 0.09180755168199539, 0.09107521921396255, 0.09104090183973312, 0.09170380234718323, 0.09097229689359665, 0.09163469076156616], [0.08901099115610123, 0.09012071788311005, 0.0894903689622879, 0.09175729006528854, 0.09172698855400085, 0.09169668704271317, 0.09105531871318817, 0.09102524071931839, 0.09160585701465607, 0.09096512198448181, 0.09154535830020905], [0.08902348577976227, 0.09012595564126968, 0.08949974179267883, 0.09175166487693787, 0.0917215570807457, 0.09169147163629532, 0.09105437248945236, 0.0910245031118393, 0.09160124510526657, 0.09096477925777435, 0.09154114872217178], [0.08878324180841446, 0.09002511203289032, 0.08931947499513626, 0.09185992926359177, 0.09182591736316681, 0.09179191291332245, 0.0910724326968193, 0.09103871136903763, 0.09168998897075653, 0.09097130596637726, 0.09162209928035736], [0.08904848992824554, 0.09013644605875015, 0.08951849490404129, 0.09174042195081711, 0.09171072393655777, 0.09168104082345963, 0.09105250239372253, 0.0910230204463005, 0.09159203618764877, 0.09096410125494003, 0.09153274446725845], [0.08880817145109177, 0.090035580098629, 0.08933818340301514, 0.09184867143630981, 0.09181506186723709, 0.09178146719932556, 0.09107055515050888, 0.09103722870349884, 0.09168075770139694, 0.09097062051296234, 0.09161368012428284]], [[0.0902838185429573, 0.09025097638368607, 0.08955609053373337, 0.08835133910179138, 0.08767107874155045, 0.09011974930763245, 0.08760731667280197, 0.09005420655012131, 0.10862100124359131, 0.08841538429260254, 0.08906901627779007], [0.09028857201337814, 0.09025593101978302, 0.08956517279148102, 0.0883675143122673, 0.08769121021032333, 0.09012548625469208, 0.0876278206706047, 0.09006033092737198, 0.1085057333111763, 0.08843117952346802, 0.08908097445964813], [0.09038673341274261, 0.09035825729370117, 0.08975551277399063, 0.0887090340256691, 0.08811728656291962, 0.09024448692798615, 0.08806178718805313, 0.09018764644861221, 0.10608195513486862, 0.08876470476388931, 0.08933265507221222], [0.09054535627365112, 0.09052422642707825, 0.09007646143436432, 0.08929719030857086, 0.08885549008846283, 0.09043976664543152, 0.08881402760744095, 0.09039755910634995, 0.10194934904575348, 0.08933871239423752, 0.08976186066865921], [0.09062843024730682, 0.09061149507761002, 0.090252585709095, 0.08962709456682205, 0.08927208185195923, 0.09054382890462875, 0.0892387330532074, 0.09051000326871872, 0.09965512156486511, 0.08966045081615448, 0.0900001972913742], [0.09030746668577194, 0.09027561545372009, 0.08960140496492386, 0.08843213319778442, 0.0877716913819313, 0.09014830738306046, 0.08770977705717087, 0.09008472412824631, 0.10804577171802521, 0.08849430084228516, 0.08912873268127441], [0.09063597023487091, 0.09061944484710693, 0.09026890248060226, 0.08965793251991272, 0.08931111544370651, 0.09055335074663162, 0.08927854150533676, 0.09052031487226486, 0.0994415432214737, 0.08969052135944366, 0.09002238512039185], [0.09031686186790466, 0.09028539806604385, 0.0896194651722908, 0.0884643942117691, 0.0878118947148323, 0.09015966206789017, 0.08775072544813156, 0.0900968536734581, 0.10781645029783249, 0.08852580934762955, 0.08915255218744278], [0.0860467329621315, 0.08591964095830917, 0.083263099193573, 0.07880467921495438, 0.07636813074350357, 0.0854131355881691, 0.07614269107580185, 0.0851610004901886, 0.18240556120872498, 0.07903704047203064, 0.08143828064203262], [0.09053729474544525, 0.09051577746868134, 0.09005969017744064, 0.08926605433225632, 0.08881626278162003, 0.09042973816394806, 0.08877404034137726, 0.09038674831390381, 0.1021667942404747, 0.08930833637714386, 0.08973927050828934], [0.09045262634754181, 0.09042710810899734, 0.08988665044307709, 0.08894741535186768, 0.08841580897569656, 0.09032511711120605, 0.08836592733860016, 0.09027417004108429, 0.10440049320459366, 0.08899741619825363, 0.08950726687908173]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.169170191833148e-05, "add_observations_from_episodes_to_batch": 2.8037446015694372e-06, "batch_individual_items": 1.2188132527024376e-05, "add_time_dim_to_batch_and_zero_pad": 6.8443942205534935e-06, "add_states_from_episodes_to_batch": 2.7735948996248022e-06}}, "connector_pipeline_timer": 5.795395910558756e-05}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.869025553045335e-06, "tensor_to_numpy": 1.4664279533827555e-05, "remove_single_ts_time_rank_from_batch": 1.1805485679655347e-05, "get_actions": 3.489337951609906e-05, "listify_data_for_vector_env": 1.0191985059030237e-05, "un_batch_to_individual_items": 6.425828829362906e-06}}, "connector_pipeline_timer": 0.00011165431392079383}, "rlmodule_inference_timer": 3.107888943322746e-05, "episode_return_mean": 0.5, "module_episode_returns_mean": {"default_policy": 0.5}, "weights_seq_no": 5.0, "episode_return_max": 15.5, "num_episodes_lifetime": 100, "env_to_module_sum_episodes_length_out": 10.368238387501162, "env_step_timer": 1.3654932306752917e-05, "episode_len_min": 20, "env_reset_timer": 0.0007131949651697187, "num_env_steps_sampled_lifetime": 25400, "num_env_steps_sampled": 400, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238387501162, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "episode_duration_sec_mean": 0.005312498736893758, "episode_return_min": -13.5, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "sample": 0.13404912875795946, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "agent_episode_returns_mean": {"default_agent": 0.5}, "time_between_sampling": 9.534094179141785}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "ba99e_00000", "date": "2025-08-11_18-53-28", "timestamp": 1754931208, "time_this_iter_s": 9.421271800994873, "time_total_s": 48.195377588272095, "pid": 11884, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1619f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 48.195377588272095, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 36.2, "ram_util_percent": 78.16153846153847}}
{"timers": {"training_iteration": 10.167002658166773, "restore_env_runners": 9.257263018542247e-06, "training_step": 10.166801917848108, "env_runner_sampling_timer": 1.660048695946401, "learner_update_timer": 8.331065795737402, "synch_weights": 0.001711733216630044, "restore_eval_env_runners": 7.007235587841599e-05, "evaluation_iteration": 0.14683017076410862, "synch_eval_env_connectors": 0.0001830572821084724, "synch_env_connectors": 5.548463260292774e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2651423396302843e-05, "add_observations_from_episodes_to_batch": 2.8135374222265096e-06, "batch_individual_items": 1.2566732217472826e-05, "add_time_dim_to_batch_and_zero_pad": 7.124348953093891e-06, "add_states_from_episodes_to_batch": 2.782830474579757e-06}}, "connector_pipeline_timer": 6.032336382032738e-05}, "module_to_env_connector": {"connector_pipeline_timer": 0.00012002097265968331, "timers": {"connectors": {"get_actions": 4.050169313812973e-05, "normalize_and_clip_actions": 7.994961297975044e-06, "un_batch_to_individual_items": 6.6047866208508285e-06, "listify_data_for_vector_env": 1.0520278427934243e-05, "tensor_to_numpy": 1.5741114797896297e-05, "remove_single_ts_time_rank_from_batch": 1.191000421926806e-05}}}, "weights_seq_no": 5.0, "episode_return_max": 14.5, "episode_duration_sec_mean": 0.0053439772971905775, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "env_reset_timer": 3.873300996580728e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -123000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "episode_return_min": -5.5, "agent_episode_returns_mean": {"default_agent": 5.700000000000004}, "num_env_steps_sampled_lifetime": -2460000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "env_step_timer": 1.3914306198924518e-05, "time_between_sampling": 0.0321350319445376, "num_episodes": 250.0, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 5.700000000000004}, "sample": 0.005673936852950132, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 3.2287141983650075e-05, "episode_return_mean": 5.700000000000004, "episode_len_max": 20, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3220.090393761323}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13535320459763828, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009350506397842327, "add_observations_from_episodes_to_batch": 0.0008392556366793206, "add_columns_from_episodes_to_train_batch": 0.041698569495741, "add_time_dim_to_batch_and_zero_pad": 0.07574589920684892, "add_states_from_episodes_to_batch": 0.0034916175664733906, "batch_individual_items": 0.0039844114071578745, "numpy_to_tensor": 7.539884777418535e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 215460, "module_train_batch_size_mean": 997.5548130830801, "vf_explained_var": 0.001763761043548584, "total_loss": 0.27816542983055115, "weights_seq_no": 36.0, "vf_loss_unclipped": 48.71467208862305, "diff_num_grad_updates_vs_sampler_policy": 31.0, "entropy": 0.6918532252311707, "vf_loss": 0.3592163324356079, "policy_loss": -0.0006233613239601254, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 5.296025119605474e-05}, "__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 430920, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 1188000, "num_env_steps_trained_lifetime_throughput": 52786.6959277475}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 31.0, "num_module_steps_trained": 35910, "total_loss": 0.0, "num_module_steps_trained_lifetime": 215460, "module_train_batch_size_mean": 997.5548130830801, "weights_seq_no": 36.0}}}, "intrinsic_reward_module": {"total_loss": 0.0, "weights_seq_no": 6.0, "num_trainable_parameters": 8266, "num_module_steps_trained_lifetime": 35910, "module_train_batch_size_mean": 997.8474438281662, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 718.6398435167459}, "default_policy": {"use_intrinsic_rewards": 0.0, "num_trainable_parameters": 16595, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 35910, "module_train_batch_size_mean": 997.8474438281662, "vf_explained_var": -0.0003122091293334961, "total_loss": 0.2774478495121002, "weights_seq_no": 6.0, "mean_kl_loss": 5.6035751185845584e-05, "vf_loss_unclipped": 49.015174865722656, "curr_kl_coeff": 0.0025247489102184772, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.6918383240699768, "vf_loss": 0.35832491517066956, "curr_entropy_coeff": 0.0015431216992, "policy_loss": -0.000638218130916357, "num_module_steps_trained_lifetime_throughput": 718.6288787747056}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 71820, "num_env_steps_trained_lifetime": 198000, "num_env_steps_trained": 33000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 3963.914597436719, "num_module_steps_trained_throughput": 28682792.070053633, "num_module_steps_trained_lifetime_throughput": 12889822.777022267}, "IntrinsicAttentionMask": [[[0.09096063673496246, 0.09050372242927551, 0.09024399518966675, 0.0909237265586853, 0.09091143310070038, 0.09114842116832733, 0.09113609045743942, 0.09112376719713211, 0.09086225926876068, 0.09109912067651749, 0.09108680486679077], [0.09092962741851807, 0.09074823558330536, 0.09064487367868423, 0.0909150019288063, 0.09091012179851532, 0.09100402146577835, 0.09099914133548737, 0.09099426120519638, 0.09089062362909317, 0.09098450094461441, 0.09097962081432343], [0.09091180562973022, 0.09088793396949768, 0.0908743143081665, 0.09090988337993622, 0.09090924263000488, 0.09092158079147339, 0.09092094004154205, 0.09092029929161072, 0.09090667217969894, 0.09091901779174805, 0.09091836959123611], [0.09095814824104309, 0.09052341431379318, 0.09027624130249023, 0.09092304110527039, 0.09091133624315262, 0.09113679081201553, 0.09112506359815598, 0.09111333638429642, 0.09086455404758453, 0.0910898968577385, 0.09107816964387894], [0.09095731377601624, 0.09052997082471848, 0.0902869924902916, 0.09092281013727188, 0.09091130644083023, 0.09113290905952454, 0.0911213830113411, 0.09110985696315765, 0.09086532145738602, 0.09108681231737137, 0.09107529371976852], [0.09097324311733246, 0.09040369093418121, 0.09008024632930756, 0.09092722088098526, 0.0909118801355362, 0.09120753407478333, 0.09119214862585068, 0.09117677062749863, 0.09085056185722351, 0.09114601463079453, 0.09113064408302307], [0.0909724310040474, 0.0904102548956871, 0.09009098261594772, 0.09092699736356735, 0.090911865234375, 0.09120366722345352, 0.09118848294019699, 0.09117329865694046, 0.09085133671760559, 0.09114295244216919, 0.09112777560949326], [0.09097159653902054, 0.0904168114066124, 0.0901017114520073, 0.09092676639556885, 0.09091182798147202, 0.09119978547096252, 0.09118480235338211, 0.0911698192358017, 0.09085210412740707, 0.09113986790180206, 0.09112489223480225], [0.0909539982676506, 0.09055623412132263, 0.09033001214265823, 0.09092187881469727, 0.09091117978096008, 0.09111740440130234, 0.09110667556524277, 0.0910959541797638, 0.09086838364601135, 0.09107451140880585, 0.09106379002332687], [0.09096994251012802, 0.09042992442846298, 0.09012317657470703, 0.09092631191015244, 0.09091176837682724, 0.09119202941656113, 0.09117744863033295, 0.09116286784410477, 0.09085363149642944, 0.0911337211728096, 0.09111914783716202], [0.09096911549568176, 0.09043648838996887, 0.0901339128613472, 0.09092608094215393, 0.09091173857450485, 0.09118815511465073, 0.09117377549409866, 0.0911593958735466, 0.09085440635681152, 0.09113064408302307, 0.0911162719130516]], [[0.09196219593286514, 0.09165879338979721, 0.09193359315395355, 0.09111538529396057, 0.09110122174024582, 0.09189070761203766, 0.09078653156757355, 0.09157329797744751, 0.08375521004199982, 0.09143109619617462, 0.09279187023639679], [0.09165197610855103, 0.09144005179405212, 0.09163200110197067, 0.09105996042490005, 0.09105004370212555, 0.09160205721855164, 0.09082961827516556, 0.0913802906870842, 0.08584267646074295, 0.09128087013959885, 0.0922304168343544], [0.09193319827318192, 0.09163842350244522, 0.09190540760755539, 0.09111040830612183, 0.09109663963317871, 0.0918637365102768, 0.09079083055257797, 0.09155535697937012, 0.0839497372508049, 0.09141718596220016, 0.09273912012577057], [0.09108265489339828, 0.09103401750326157, 0.09107807278633118, 0.09094658493995667, 0.09094429761171341, 0.09107120335102081, 0.09089345484972, 0.09102029353380203, 0.08971703052520752, 0.09099743515253067, 0.09121494740247726], [0.09106756001710892, 0.09102317690849304, 0.09106338024139404, 0.09094337373971939, 0.09094128757715225, 0.09105711430311203, 0.09089488536119461, 0.09101065248250961, 0.08982044458389282, 0.09098979085683823, 0.09118828922510147], [0.09188959002494812, 0.09160775691270828, 0.09186302870512009, 0.09110283106565475, 0.0910896584391594, 0.09182319045066833, 0.09079714864492416, 0.09152833372354507, 0.08424226939678192, 0.09139621257781982, 0.09265993535518646], [0.09072933346033096, 0.090779148042202, 0.09073402732610703, 0.09086884558200836, 0.0908711850643158, 0.09074105322360992, 0.09092342853546143, 0.09079321473836899, 0.09214895963668823, 0.09081665426492691, 0.0905940979719162], [0.09156357496976852, 0.091377392411232, 0.09154603630304337, 0.09104334563016891, 0.09103462845087051, 0.09151973575353622, 0.09084081649780273, 0.09132488816976547, 0.08644058555364609, 0.09123752266168594, 0.09207150340080261], [0.08129680156707764, 0.0833292007446289, 0.08148597180843353, 0.08711493760347366, 0.08721623569726944, 0.08177056163549423, 0.08950056880712509, 0.08391226083040237, 0.16346102952957153, 0.08489229530096054, 0.07602013647556305], [0.09141557663679123, 0.09127216786146164, 0.091402068734169, 0.09101469069719315, 0.09100797027349472, 0.09138181060552597, 0.09085848182439804, 0.09123171120882034, 0.08744458854198456, 0.09116438031196594, 0.09180647879838943], [0.0927836075425148, 0.09222906827926636, 0.09273126721382141, 0.09123960882425308, 0.09121387451887131, 0.0926528126001358, 0.09064313769340515, 0.09207308292388916, 0.07831200212240219, 0.09181388467550278, 0.09430763125419617]], [[0.09100595861673355, 0.09030118584632874, 0.09053657948970795, 0.09121851623058319, 0.09120617806911469, 0.09119383990764618, 0.09093213826417923, 0.09091983735561371, 0.09090753644704819, 0.09089524298906326, 0.09088294953107834], [0.0909157320857048, 0.09086742997169495, 0.09088360518217087, 0.09093023091554642, 0.09092938899993896, 0.09092854708433151, 0.09091068804264069, 0.09090984612703323, 0.09090900421142578, 0.09090816974639893, 0.09090732783079147], [0.0909460112452507, 0.09067749232053757, 0.09076731652021408, 0.09102673828601837, 0.0910220593214035, 0.09101737290620804, 0.09091794490814209, 0.09091326594352722, 0.09090858697891235, 0.09090391546487808, 0.09089923650026321], [0.09103292226791382, 0.09013181924819946, 0.09043256938457489, 0.09130506217479706, 0.09128926694393158, 0.0912734642624855, 0.09093843400478363, 0.09092269837856293, 0.09090696275234222, 0.09089123457670212, 0.09087550640106201], [0.09103136509656906, 0.09014163911342621, 0.0904386043548584, 0.09130005538463593, 0.09128445386886597, 0.0912688598036766, 0.09093808382749557, 0.09092254191637039, 0.0909070074558258, 0.09089148044586182, 0.09087594598531723], [0.09102980047464371, 0.09015144407749176, 0.09044462442398071, 0.091295026242733, 0.09127962589263916, 0.09126423299312592, 0.09093771129846573, 0.09092237055301666, 0.0909070372581482, 0.09089169651269913, 0.09087637066841125], [0.09099657088518143, 0.09036015719175339, 0.0905727744102478, 0.09118841588497162, 0.09117728471755981, 0.09116614609956741, 0.09092993289232254, 0.09091883152723312, 0.09090773016214371, 0.09089662879705429, 0.09088552743196487], [0.09099500626325607, 0.09036999195814133, 0.09057880938053131, 0.09118340164422989, 0.0911724641919136, 0.09116153419017792, 0.09092956781387329, 0.09091866761445999, 0.0909077599644661, 0.0908968597650528, 0.0908859595656395], [0.09099344164133072, 0.09037981927394867, 0.09058483690023422, 0.09117837995290756, 0.0911676436662674, 0.09115691483020782, 0.09092919528484344, 0.09091848880052567, 0.09090778976678848, 0.0908970907330513, 0.09088638424873352], [0.09099188446998596, 0.0903896689414978, 0.09059087932109833, 0.09117337316274643, 0.09116283804178238, 0.09115231037139893, 0.0909288302063942, 0.09091832488775253, 0.09090782701969147, 0.0908973217010498, 0.09088682383298874], [0.09099030494689941, 0.09039948880672455, 0.09059690684080124, 0.0911683440208435, 0.09115801751613617, 0.09114768356084824, 0.09092845022678375, 0.0909181460738182, 0.09090784937143326, 0.09089754521846771, 0.09088724106550217]], [[0.08989989012479782, 0.08987117558717728, 0.09042534977197647, 0.08820821344852448, 0.0881800502538681, 0.08975644409656525, 0.0886954665184021, 0.09028106927871704, 0.1064320057630539, 0.08883698284626007, 0.08941332995891571], [0.08990765362977982, 0.08987913280725479, 0.09042954444885254, 0.08822733908891678, 0.08819936215877533, 0.08976517617702484, 0.08871133625507355, 0.0902862474322319, 0.1063179299235344, 0.0888519138097763, 0.08942438662052155], [0.08975615352392197, 0.08972389996051788, 0.09034670144319534, 0.08785788714885712, 0.08782631903886795, 0.0895950123667717, 0.08840417861938477, 0.09018450230360031, 0.1085326224565506, 0.08856291323900223, 0.08920972049236298], [0.09034105390310287, 0.09032397717237473, 0.09065313637256622, 0.0893312469124794, 0.08931436389684677, 0.0902557298541069, 0.08962290734052658, 0.09056752175092697, 0.09983114898204803, 0.08970748633146286, 0.09005142003297806], [0.09034811705350876, 0.09033124148845673, 0.0906565934419632, 0.08934988081455231, 0.0893331915140152, 0.09026376903057098, 0.08963820338249207, 0.09057196229696274, 0.09972333163022995, 0.08972182124853134, 0.09006180614233017], [0.08993857353925705, 0.0899108424782753, 0.09044617414474487, 0.08830372989177704, 0.08827650547027588, 0.08979998528957367, 0.08877472579479218, 0.09030680358409882, 0.10586268454790115, 0.0889115035533905, 0.08946847170591354], [0.09021736681461334, 0.09019690752029419, 0.09059150516986847, 0.08900853246450424, 0.08898834884166718, 0.09011511504650116, 0.089357390999794, 0.09048883616924286, 0.10170698910951614, 0.08945861458778381, 0.08987037092447281], [0.08979593962430954, 0.08976465463638306, 0.09036868065595627, 0.08795416355133057, 0.08792351931333542, 0.08963964134454727, 0.08848431706428528, 0.09021139144897461, 0.10795346647500992, 0.08863835036754608, 0.08926588296890259], [0.08393515646457672, 0.08381117880344391, 0.08622991293668747, 0.07687084376811981, 0.07675729691982269, 0.0833171084523201, 0.07885581254959106, 0.08559496700763702, 0.1833346039056778, 0.07943981140851974, 0.08185328543186188], [0.09018094092607498, 0.09015949815511703, 0.0905730128288269, 0.08891469240188599, 0.08889355510473251, 0.09007380157709122, 0.08928003907203674, 0.09046541154384613, 0.1022556871175766, 0.08938605338335037, 0.08981736749410629], [0.09003014862537384, 0.09000475704669952, 0.09049484133720398, 0.0885319709777832, 0.08850700408220291, 0.08990323543548584, 0.0889638289809227, 0.09036727994680405, 0.10450814664363861, 0.08908920735120773, 0.08959958702325821]], [[0.0910058319568634, 0.09030105918645859, 0.09028884768486023, 0.09121838957071304, 0.09095661342144012, 0.090944305062294, 0.09118138253688812, 0.09091971069574356, 0.09090740978717804, 0.0911443904042244, 0.09113206714391708], [0.0909157320857048, 0.09086742997169495, 0.0908665880560875, 0.09093023091554642, 0.09091237187385559, 0.09091152995824814, 0.09092771261930466, 0.09090984612703323, 0.09090900421142578, 0.0909251868724823, 0.09092434495687485], [0.09091415256261826, 0.09087730944156647, 0.09087666869163513, 0.09092521667480469, 0.09091158956289291, 0.09091094881296158, 0.09092329442501068, 0.09090966731309891, 0.09090902656316757, 0.09092137217521667, 0.09092073142528534], [0.0910327136516571, 0.09013161808252335, 0.09011601656675339, 0.09130485355854034, 0.09096971154212952, 0.09095396846532822, 0.09125746041536331, 0.09092248976230621, 0.09090675413608551, 0.09121008962392807, 0.09119430929422379], [0.09099958837032318, 0.09034038335084915, 0.09032895416021347, 0.09119833260774612, 0.09095355868339539, 0.09094205498695374, 0.09116373211145401, 0.09091904759407043, 0.09090755134820938, 0.09112914651632309, 0.09111762046813965], [0.09099802374839783, 0.09035021811723709, 0.09033899009227753, 0.0911933183670044, 0.0909527987241745, 0.09094148874282837, 0.09115932136774063, 0.0909188836812973, 0.09090758115053177, 0.09112533926963806, 0.09111400693655014], [0.09102804213762283, 0.09016107767820358, 0.09014606475830078, 0.09128981828689575, 0.09096744656562805, 0.0909522995352745, 0.09124422818422318, 0.09092202037572861, 0.09090688079595566, 0.09119866788387299, 0.09118348360061646], [0.09099490940570831, 0.09036989510059357, 0.09035905450582504, 0.09118329733610153, 0.09095127135515213, 0.09094036370515823, 0.09115049988031387, 0.09091856330633163, 0.09090765565633774, 0.09111771732568741, 0.09110678732395172], [0.09099333733320236, 0.09037972241640091, 0.0903690829873085, 0.0911782756447792, 0.09095049649477005, 0.09093979001045227, 0.0911460816860199, 0.09091838449239731, 0.09090768545866013, 0.09111389517784119, 0.09110317379236221], [0.09102337062358856, 0.09019052982330322, 0.09017610549926758, 0.09127477556467056, 0.0909651592373848, 0.0909506231546402, 0.09123099595308304, 0.09092153608798981, 0.09090699255466461, 0.0911872386932373, 0.09117265790700912], [0.0910218134522438, 0.09020034968852997, 0.09018612653017044, 0.09126976132392883, 0.09096439927816391, 0.09095005691051483, 0.09122658520936966, 0.09092137217521667, 0.0909070298075676, 0.09118343144655228, 0.09116905182600021]], [[0.09201265126466751, 0.09199833869934082, 0.09198403358459473, 0.09087873995304108, 0.09086460620164871, 0.09194112569093704, 0.09112285822629929, 0.09162353724241257, 0.08353769779205322, 0.09119363129138947, 0.09284278005361557], [0.09199745208024979, 0.09198334813117981, 0.09196923673152924, 0.09087961167097092, 0.09086567163467407, 0.0919269472360611, 0.09112028032541275, 0.09161387383937836, 0.08363773673772812, 0.09119005501270294, 0.09281568974256516], [0.09198226034641266, 0.0919683575630188, 0.09195445477962494, 0.09088048338890076, 0.09086674451828003, 0.09191276878118515, 0.09111770987510681, 0.09160421788692474, 0.08373790234327316, 0.09118648618459702, 0.09278861433267593], [0.09076876938343048, 0.09077051281929016, 0.09077227115631104, 0.09090821444988251, 0.09090996533632278, 0.09077750891447067, 0.09087803214788437, 0.09081640094518661, 0.09186110645532608, 0.09086929261684418, 0.09066790342330933], [0.0907527357339859, 0.0907546877861023, 0.09075663238763809, 0.09090805053710938, 0.09091000258922577, 0.09076247364282608, 0.09087442606687546, 0.0908057913184166, 0.0919700637459755, 0.09086470305919647, 0.09064041823148727], [0.09193658083677292, 0.091923289000988, 0.0919099971652031, 0.09088300168514252, 0.09086985886096954, 0.09187015146017075, 0.09110989421606064, 0.09157513827085495, 0.08403901010751724, 0.09117567539215088, 0.0927073210477829], [0.09104356169700623, 0.09104187041521072, 0.09104017913341522, 0.0909089520573616, 0.0909072682261467, 0.09103511273860931, 0.09093806147575378, 0.09099753201007843, 0.08999989181756973, 0.09094648063182831, 0.09114117920398712], [0.09159502387046814, 0.09158624708652496, 0.09157747775316238, 0.09089813381433487, 0.09088943153619766, 0.09155116230249405, 0.09104844182729721, 0.09135625511407852, 0.0863027274608612, 0.09109199792146683, 0.09210312366485596], [0.08035179227590561, 0.08044879883527756, 0.08054592460393906, 0.08846482634544373, 0.08857161551713943, 0.08083798736333847, 0.08664293587207794, 0.08303721249103546, 0.1700320690870285, 0.08612269163131714, 0.07494412362575531], [0.09112247824668884, 0.09111978858709335, 0.09111709892749786, 0.09090840071439743, 0.09090571850538254, 0.09110903739929199, 0.09095467627048492, 0.09104926139116287, 0.08946754783391953, 0.0909680724143982, 0.0912778452038765], [0.09287282824516296, 0.09284663200378418, 0.09282044321298599, 0.09080712497234344, 0.09078151732683182, 0.09274191409349442, 0.09125008434057236, 0.09216161072254181, 0.07794082909822464, 0.09137868881225586, 0.09439831972122192]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1676169334302134e-05, "add_observations_from_episodes_to_batch": 2.792285219599618e-06, "batch_individual_items": 1.2273190416915824e-05, "add_time_dim_to_batch_and_zero_pad": 6.872344246833061e-06, "add_states_from_episodes_to_batch": 2.717949146993485e-06}}, "connector_pipeline_timer": 5.791035825730063e-05}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.850537860699123e-06, "tensor_to_numpy": 1.465270648889004e-05, "remove_single_ts_time_rank_from_batch": 1.1826270710587473e-05, "get_actions": 3.50832459791542e-05, "listify_data_for_vector_env": 1.0272004519114327e-05, "un_batch_to_individual_items": 6.431669098491897e-06}}, "connector_pipeline_timer": 0.00011173056047961305}, "rlmodule_inference_timer": 3.031295452933172e-05, "episode_return_mean": 0.5, "module_episode_returns_mean": {"default_policy": 0.5}, "weights_seq_no": 6.0, "episode_return_max": 15.5, "num_episodes_lifetime": 120, "env_to_module_sum_episodes_length_out": 10.368238394470474, "env_step_timer": 1.3678961292969857e-05, "episode_len_min": 20, "env_reset_timer": 0.0007093396854039847, "num_env_steps_sampled_lifetime": 30400, "num_env_steps_sampled": 400, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394470474, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "episode_duration_sec_mean": 0.005124695004196838, "episode_return_min": -13.5, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "sample": 0.13384075539000373, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "agent_episode_returns_mean": {"default_agent": 0.5}, "time_between_sampling": 9.53721021693059}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "ba99e_00000", "date": "2025-08-11_18-53-38", "timestamp": 1754931218, "time_this_iter_s": 9.944175004959106, "time_total_s": 58.1395525932312, "pid": 11884, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1619f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 58.1395525932312, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 38.98571428571428, "ram_util_percent": 78.77857142857142}}
{"timers": {"training_iteration": 10.161874938674654, "restore_env_runners": 9.304280508299847e-06, "training_step": 10.16167400825001, "env_runner_sampling_timer": 1.6591836485671037, "learner_update_timer": 8.326758802780228, "synch_weights": 0.0017021904636765582, "restore_eval_env_runners": 6.986621233703459e-05, "evaluation_iteration": 0.14658085780636465, "synch_eval_env_connectors": 0.0001829250388664728, "synch_env_connectors": 5.539637888678082e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2714081694032961e-05, "add_observations_from_episodes_to_batch": 2.8656120034102983e-06, "batch_individual_items": 1.2733996838348133e-05, "add_time_dim_to_batch_and_zero_pad": 7.2146191003513245e-06, "add_states_from_episodes_to_batch": 2.7920641728048236e-06}}, "connector_pipeline_timer": 6.089449377825946e-05}, "module_to_env_connector": {"connector_pipeline_timer": 0.000121319866586823, "timers": {"connectors": {"get_actions": 4.1283232923170054e-05, "normalize_and_clip_actions": 8.09019052917059e-06, "un_batch_to_individual_items": 6.688928014234209e-06, "listify_data_for_vector_env": 1.0608909632639808e-05, "tensor_to_numpy": 1.577610567312428e-05, "remove_single_ts_time_rank_from_batch": 1.203979609924965e-05}}}, "weights_seq_no": 6.0, "episode_return_max": 14.5, "episode_duration_sec_mean": 0.005412399004679173, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "env_reset_timer": 4.0244204103510985e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -153875.0, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "episode_return_min": -5.5, "agent_episode_returns_mean": {"default_agent": 4.579999999999998}, "num_env_steps_sampled_lifetime": -3077500.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "env_step_timer": 1.4127804359570089e-05, "time_between_sampling": 0.033995419003062535, "num_episodes": 250.0, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 4.579999999999998}, "sample": 0.005778655143912115, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 3.305078008416949e-05, "episode_return_mean": 4.579999999999998, "episode_len_max": 20, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3192.26208573169}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13531836796181665, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009345566754456107, "add_observations_from_episodes_to_batch": 0.0008389726601066362, "add_columns_from_episodes_to_train_batch": 0.04168655630118421, "add_time_dim_to_batch_and_zero_pad": 0.07572588646447592, "add_states_from_episodes_to_batch": 0.0034947130609212667, "batch_individual_items": 0.003984515203786289, "numpy_to_tensor": 7.5259448376658e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 251370, "module_train_batch_size_mean": 997.5374097747205, "vf_explained_var": 0.0017694830894470215, "total_loss": 0.2787148356437683, "weights_seq_no": 42.0, "vf_loss_unclipped": 49.274269104003906, "diff_num_grad_updates_vs_sampler_policy": 36.0, "entropy": 0.691804051399231, "vf_loss": 0.359164297580719, "policy_loss": -2.5041739718290046e-05, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 5.34384639649943e-07}, "__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 502740, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 1386000, "num_env_steps_trained_lifetime_throughput": 51957.66698095145}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 36.0, "num_module_steps_trained": 35910, "total_loss": 0.0, "num_module_steps_trained_lifetime": 251370, "module_train_batch_size_mean": 997.5374097747205, "weights_seq_no": 42.0}}}, "intrinsic_reward_module": {"total_loss": 0.0, "weights_seq_no": 7.0, "num_trainable_parameters": 8266, "num_module_steps_trained_lifetime": 41895, "module_train_batch_size_mean": 997.82696443245, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 717.9371378554147}, "default_policy": {"use_intrinsic_rewards": 0.0, "num_trainable_parameters": 16595, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 41895, "module_train_batch_size_mean": 997.82696443245, "vf_explained_var": -0.00035881996154785156, "total_loss": 0.27804645895957947, "weights_seq_no": 7.0, "mean_kl_loss": 5.692435252058203e-07, "vf_loss_unclipped": 49.63325881958008, "curr_kl_coeff": 0.0012623744551092386, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.691801905632019, "vf_loss": 0.3583081066608429, "curr_entropy_coeff": 0.0015431216992, "policy_loss": -2.6282319595338777e-05, "num_module_steps_trained_lifetime_throughput": 717.9267053686212}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 83790, "num_env_steps_trained_lifetime": 231000, "num_env_steps_trained": 33000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 3959.9885905939, "num_module_steps_trained_throughput": 27860062.963970643, "num_module_steps_trained_lifetime_throughput": 12846813.869785763}, "IntrinsicAttentionMask": [[[0.0898432582616806, 0.09045067429542542, 0.0901060700416565, 0.09134025871753693, 0.0913238525390625, 0.09097592532634735, 0.09129104763269424, 0.09127464890480042, 0.09125825017690659, 0.09091056883335114, 0.09122546762228012], [0.08935864269733429, 0.09024067223072052, 0.08973994106054306, 0.09153732657432556, 0.09151335805654526, 0.09100557118654251, 0.09146544337272644, 0.09144148975610733, 0.09141755104064941, 0.09091029316186905, 0.09136968106031418], [0.08963291347026825, 0.0903596431016922, 0.08994723856449127, 0.09142570197582245, 0.09140601754188538, 0.09098883718252182, 0.09136667102575302, 0.09134700149297714, 0.09132733941078186, 0.09091051667928696, 0.0912880226969719], [0.08865836262702942, 0.08993545919656754, 0.08920974284410477, 0.09182325750589371, 0.09178825467824936, 0.09104759246110916, 0.09171827882528305, 0.09168331325054169, 0.09164836257696152, 0.09090883284807205, 0.09157849848270416], [0.08867117762565613, 0.08994106203317642, 0.08921945840120316, 0.09181801229715347, 0.09178321063518524, 0.09104683250188828, 0.09171364456415176, 0.09167888015508652, 0.09164412319660187, 0.09090886265039444, 0.09157466143369675], [0.08894382417201996, 0.09006012231111526, 0.08942603319883347, 0.0917065367102623, 0.09167604893445969, 0.09103058278560638, 0.09161509573459625, 0.09158463776111603, 0.0915541872382164, 0.09090957790613174, 0.09149331599473953], [0.08869682252407074, 0.08995227515697479, 0.08923889696598053, 0.0918075293302536, 0.0917731299996376, 0.0910453200340271, 0.09170437604188919, 0.09167002141475677, 0.09163567423820496, 0.090908944606781, 0.0915670245885849], [0.08870964497327805, 0.08995787799358368, 0.08924861997365952, 0.09180228412151337, 0.09176809340715408, 0.09104455262422562, 0.0916997417807579, 0.0916655883193016, 0.0916314423084259, 0.09090898185968399, 0.09156319499015808], [0.08872245997190475, 0.08996348828077316, 0.0892583355307579, 0.09179703891277313, 0.09176304936408997, 0.09104379266500473, 0.09169510751962662, 0.09166115522384644, 0.09162721037864685, 0.09090901911258698, 0.09155937284231186], [0.08899522572755814, 0.09008254110813141, 0.0894649550318718, 0.09168554842472076, 0.09165586531162262, 0.09102750569581985, 0.09159653633832932, 0.09156689047813416, 0.091537244617939, 0.0909096896648407, 0.09147799015045166], [0.08874810487031937, 0.08997468650341034, 0.08927776664495468, 0.09178654104471207, 0.09175295382738113, 0.09104226529598236, 0.09168582409620285, 0.0916522815823555, 0.09161874651908875, 0.09090909361839294, 0.09155170619487762]], [[0.09149832278490067, 0.09148814529180527, 0.09168407320976257, 0.09110023826360703, 0.09109010547399521, 0.09144748747348785, 0.09086515009403229, 0.09142716228961945, 0.08577876538038254, 0.09132568538188934, 0.09229491651058197], [0.09148695319890976, 0.09147699177265167, 0.09166902303695679, 0.09109675884246826, 0.09108682721853256, 0.09143713116645813, 0.090866319835186, 0.09141720831394196, 0.08587738871574402, 0.09131775051355362, 0.09226767718791962], [0.09170376509428024, 0.09168990701436996, 0.09195704013109207, 0.09116160124540329, 0.09114782512187958, 0.09163448214530945, 0.09084183722734451, 0.09160679578781128, 0.08399693667888641, 0.09146855026483536, 0.09279122203588486], [0.09104474633932114, 0.09104245901107788, 0.09108651429414749, 0.09095501154661179, 0.09095272421836853, 0.09103330224752426, 0.09090188145637512, 0.09102872759103775, 0.08972533792257309, 0.09100586920976639, 0.09122340381145477], [0.0910329669713974, 0.09103088080883026, 0.09107108414173126, 0.09095107018947601, 0.09094898402690887, 0.09102252870798111, 0.09090257436037064, 0.09101834893226624, 0.08982803672552109, 0.09099748730659485, 0.09119600802659988], [0.09144140779972076, 0.09143224358558655, 0.09160871803760529, 0.09108272939920425, 0.09107360243797302, 0.09139560908079147, 0.09087084233760834, 0.09137730300426483, 0.08627290278673172, 0.09128588438034058, 0.09215868264436722], [0.09076818823814392, 0.09077053517103195, 0.09072542190551758, 0.09086021780967712, 0.09086257219314575, 0.09077991545200348, 0.09091480076313019, 0.09078460931777954, 0.09214019775390625, 0.09080804139375687, 0.09058550745248795], [0.09141857922077179, 0.09140981733798981, 0.09157852083444595, 0.09107565134763718, 0.09106692671775818, 0.09137479960918427, 0.09087304770946503, 0.09135729819536209, 0.08647128194570541, 0.09126989543437958, 0.09210417419672012], [0.08291059732437134, 0.08300700783729553, 0.08117091655731201, 0.08677806705236435, 0.08687897771596909, 0.08339376002550125, 0.08915445953607559, 0.08358780294656754, 0.16282811760902405, 0.08456404507160187, 0.075726218521595], [0.09130387753248215, 0.09129712730646133, 0.09142706543207169, 0.09103958308696747, 0.09103286266326904, 0.09127014875411987, 0.09088332951068878, 0.09125666320323944, 0.08746851980686188, 0.09118931740522385, 0.09183158725500107], [0.09235264360904694, 0.0923265889286995, 0.09282932430505753, 0.09133608639240265, 0.09131032228469849, 0.09222245216369629, 0.09073898941278458, 0.09217043220996857, 0.07839485257863998, 0.09191097319126129, 0.0944073498249054]], [[0.09098327904939651, 0.09027867764234543, 0.09051401913166046, 0.09119578450918198, 0.09093407541513443, 0.09117111563682556, 0.09115879237651825, 0.09089718014001846, 0.09113413095474243, 0.09087259322404861, 0.09086030721664429], [0.09091418981552124, 0.09086588770151138, 0.0908820629119873, 0.09092868864536285, 0.09091082215309143, 0.09092700481414795, 0.0909261703491211, 0.09090830385684967, 0.09092448651790619, 0.09090662747621536, 0.09090578556060791], [0.09093739837408066, 0.09066890180110931, 0.09075871855020523, 0.09101811796426773, 0.09091868996620178, 0.0910087525844574, 0.09100407361984253, 0.09090466052293777, 0.0909947082400322, 0.09089530259370804, 0.09089063107967377], [0.0910039022564888, 0.09010309725999832, 0.09040375053882599, 0.09127596020698547, 0.090940922498703, 0.09124436974525452, 0.09122858196496964, 0.0908937156200409, 0.09119700640439987, 0.09086225926876068, 0.09084653854370117], [0.09097850322723389, 0.09031945466995239, 0.0905396118760109, 0.09117720276117325, 0.09093248099088669, 0.09115413576364517, 0.09114260971546173, 0.09089798480272293, 0.09111955761909485, 0.09087499976158142, 0.09086350351572037], [0.09100151062011719, 0.09012343734502792, 0.09041652083396912, 0.09126665443181992, 0.09094012528657913, 0.09123586863279343, 0.09122048318386078, 0.09089411795139313, 0.09118971228599548, 0.09086345136165619, 0.09084812551736832], [0.09100031107664108, 0.09013360738754272, 0.09042291343212128, 0.09126200526952744, 0.0909397304058075, 0.09123162180185318, 0.09121643006801605, 0.09089431911706924, 0.09118606150150299, 0.09086405485868454, 0.09084893018007278], [0.09097490459680557, 0.09035003185272217, 0.09055879712104797, 0.0911632552742958, 0.09093128144741058, 0.09114139527082443, 0.09113046526908875, 0.09089858084917068, 0.09110861271619797, 0.09087678045034409, 0.09086588025093079], [0.09099792689085007, 0.09015396237373352, 0.0904357060790062, 0.09125271439552307, 0.09093894064426422, 0.09122312813997269, 0.09120834618806839, 0.09089472144842148, 0.0911787822842598, 0.09086526185274124, 0.09085053205490112], [0.09097251296043396, 0.09037041664123535, 0.09057159721851349, 0.09115395694971085, 0.09093047678470612, 0.09113289415836334, 0.09112236648797989, 0.09089896827936172, 0.09110131859779358, 0.090877965092659, 0.09086746722459793], [0.09097131341695786, 0.09038062393665314, 0.09057799726724625, 0.09114931523799896, 0.09093008935451508, 0.09112866222858429, 0.09111832827329636, 0.09089916944503784, 0.09109768271446228, 0.09087856858968735, 0.0908682718873024]], [[0.09040231257677078, 0.08970625698566437, 0.08967363834381104, 0.08781810104846954, 0.08778616040945053, 0.0902380421757698, 0.08772232383489609, 0.0901724100112915, 0.1087634265422821, 0.08853144198656082, 0.0891859233379364], [0.09048595279455185, 0.08987816423177719, 0.08984965831041336, 0.08822639286518097, 0.08819841593503952, 0.09034255892038345, 0.08814248442649841, 0.09028526395559311, 0.1063166931271553, 0.0888509526848793, 0.08942342549562454], [0.09048975259065628, 0.0898861289024353, 0.08985781669616699, 0.08824552595615387, 0.08821772783994675, 0.09034734219312668, 0.08816216886043549, 0.09029044210910797, 0.10620274394750595, 0.08886588364839554, 0.08943448215723038], [0.09068705886602402, 0.09032363444566727, 0.09030656516551971, 0.08933091163635254, 0.08931402862071991, 0.09060140699148178, 0.08928027004003525, 0.09056717157363892, 0.0998307392001152, 0.089707151055336, 0.09005106985569], [0.09069013595581055, 0.09033090621232986, 0.09031403064727783, 0.08934955298900604, 0.08933286368846893, 0.0906054750084877, 0.08929949253797531, 0.09057163447141647, 0.09972293674945831, 0.08972150087356567, 0.0900614783167839], [0.09042250365018845, 0.08974719792604446, 0.08971554040908813, 0.08791451156139374, 0.08788350224494934, 0.09026313573122025, 0.08782151341438293, 0.09019947052001953, 0.10818326473236084, 0.08860703557729721, 0.08924226462841034], [0.09069626033306122, 0.09034541994333267, 0.09032893925905228, 0.08938682079315186, 0.08937051892280579, 0.09061357378959656, 0.08933791518211365, 0.0905805230140686, 0.0995076447725296, 0.08975017070770264, 0.09008226543664932], [0.09043051302433014, 0.08976349979639053, 0.08973222970962524, 0.08795303106307983, 0.08792239427566528, 0.09027310460805893, 0.08786115050315857, 0.09021022170782089, 0.10795197635889053, 0.08863720297813416, 0.08926473557949066], [0.08646679669618607, 0.08379334956407547, 0.08366958051919937, 0.07685454189777374, 0.07674101740121841, 0.08583010733127594, 0.07651448994874954, 0.08557675033807755, 0.18329453468322754, 0.07942293584346771, 0.08183588832616806], [0.09061554074287415, 0.09015895426273346, 0.09013751894235611, 0.0889141634106636, 0.08889302611351013, 0.0905078873038292, 0.08885076642036438, 0.09046486020088196, 0.10225500911474228, 0.0893855094909668, 0.08981683105230331], [0.09054514765739441, 0.09000398218631744, 0.08997859060764313, 0.08853121846914291, 0.08850624412298203, 0.09041750431060791, 0.08845631778240204, 0.09036649763584137, 0.10450718551874161, 0.08908844739198685, 0.08959882706403732]], [[0.0909833088517189, 0.09027871489524841, 0.09051404893398285, 0.09119581431150436, 0.09093410521745682, 0.0909218043088913, 0.09090950340032578, 0.09114649146795273, 0.09113416075706482, 0.090872623026371, 0.0911095142364502], [0.09091418981552124, 0.09086588770151138, 0.0908820629119873, 0.09092868864536285, 0.09091082215309143, 0.09090998768806458, 0.09090914577245712, 0.09092532843351364, 0.09092448651790619, 0.09090662747621536, 0.09092280268669128], [0.09093739837408066, 0.09066890180110931, 0.09075871855020523, 0.09101811796426773, 0.09091868996620178, 0.09091401100158691, 0.09090933203697205, 0.09099938720464706, 0.0909947082400322, 0.09089530259370804, 0.09098535031080246], [0.09100391715765, 0.09010311216115952, 0.09040376543998718, 0.09127597510814667, 0.0909409373998642, 0.0909252017736435, 0.09090946614742279, 0.09121280908584595, 0.09119702130556107, 0.09086227416992188, 0.0911654606461525], [0.09097851812839508, 0.09031946957111359, 0.09053963422775269, 0.09117721766233444, 0.09093249589204788, 0.09092099964618683, 0.09090949594974518, 0.09113109856843948, 0.09111957252025604, 0.09087501466274261, 0.09109652787446976], [0.09097731113433838, 0.09032965451478958, 0.09054601937532425, 0.09117256104946136, 0.09093209356069565, 0.09092079102993011, 0.09090948849916458, 0.09112724661827087, 0.09111592173576355, 0.09087559580802917, 0.0910932719707489], [0.09097611904144287, 0.09033985435962677, 0.090552419424057, 0.09116791933774948, 0.09093169867992401, 0.0909205973148346, 0.09090949594974518, 0.09112340211868286, 0.09111227840185165, 0.09087619930505753, 0.09109003096818924], [0.09099914878606796, 0.09014381468296051, 0.09042933583259583, 0.09125738590955734, 0.09093936532735825, 0.09092441946268082, 0.09090948104858398, 0.0911974310874939, 0.09118244796991348, 0.09086468815803528, 0.09115249663591385], [0.09099795669317245, 0.09015399217605591, 0.09043572843074799, 0.09125273674726486, 0.09093896299600601, 0.0909242182970047, 0.09090948849916458, 0.09119358658790588, 0.09117880463600159, 0.09086528420448303, 0.09114924818277359], [0.09097252786159515, 0.09037043899297714, 0.09057161211967468, 0.09115397185087204, 0.09093049168586731, 0.09091999381780624, 0.09090948104858398, 0.09111186116933823, 0.09110133349895477, 0.09087797999382019, 0.09108028560876846], [0.09099555760622025, 0.09017433971166611, 0.09044851362705231, 0.0912434384226799, 0.09093816578388214, 0.09092382341623306, 0.09090948849916458, 0.09118589013814926, 0.0911715105175972, 0.09086648374795914, 0.09114275127649307]], [[0.0919862762093544, 0.0919719710946083, 0.09195766597986221, 0.09113924950361252, 0.09083856642246246, 0.09191477298736572, 0.09109673649072647, 0.09159727394580841, 0.0835137888789177, 0.09116748720407486, 0.09281616657972336], [0.09197147190570831, 0.09195736795663834, 0.09194326400756836, 0.09113647043704987, 0.09084001928567886, 0.09190098196268082, 0.09109455347061157, 0.09158800542354584, 0.08361414819955826, 0.09116430580615997, 0.09278947860002518], [0.09195664525032043, 0.09194274246692657, 0.09192884713411331, 0.09113365411758423, 0.09084144979715347, 0.09188716858625412, 0.09109234064817429, 0.09157870709896088, 0.08371461927890778, 0.0911610946059227, 0.0927627757191658], [0.09108680486679077, 0.09108451753854752, 0.09108223021030426, 0.09095073491334915, 0.0909021720290184, 0.0910753607749939, 0.09094387292861938, 0.09102444350719452, 0.08967547118663788, 0.09095528721809387, 0.09121911227703094], [0.09075631946325302, 0.09075826406478882, 0.09076021611690521, 0.09087216854095459, 0.09091358631849289, 0.0907660573720932, 0.09087800979614258, 0.09080936759710312, 0.091973677277565, 0.09086828678846359, 0.0906439945101738], [0.09191209077835083, 0.09189880639314651, 0.0918855220079422, 0.09112514555454254, 0.09084565937519073, 0.09184567630290985, 0.09108563512563705, 0.09155074506998062, 0.08401666581630707, 0.09115138649940491, 0.09268262982368469], [0.09104043990373611, 0.09103874862194061, 0.09103705734014511, 0.09094000607728958, 0.09090414643287659, 0.0910319909453392, 0.09093493968248367, 0.09099441766738892, 0.08999679982662201, 0.0909433662891388, 0.09113805741071701], [0.09157885611057281, 0.09157008677721024, 0.09156130999326706, 0.09105854481458664, 0.09087338298559189, 0.09153500199317932, 0.09103237837553024, 0.09134013205766678, 0.08628752082586288, 0.09107591956853867, 0.09208686649799347], [0.0805237889289856, 0.08062099665403366, 0.08071833103895187, 0.08651465177536011, 0.08876114338636398, 0.08101101964712143, 0.08682835102081299, 0.08321495354175568, 0.17039518058300018, 0.08630701154470444, 0.07510454207658768], [0.09111752361059189, 0.091114841401577, 0.0911121517419815, 0.09095778316259384, 0.09090078622102737, 0.09110409021377563, 0.09094973653554916, 0.09104431420564651, 0.08946269750595093, 0.09096313267946243, 0.09127289056777954], [0.0928245335817337, 0.09279834479093552, 0.09277216345071793, 0.09127986431121826, 0.09073430299758911, 0.09269367903470993, 0.09120263159275055, 0.0921136885881424, 0.07790033519268036, 0.09133116900920868, 0.09434922784566879]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1722214512939476e-05, "add_observations_from_episodes_to_batch": 2.7864164382780727e-06, "batch_individual_items": 1.2144184212593571e-05, "add_time_dim_to_batch_and_zero_pad": 6.8829821932262875e-06, "add_states_from_episodes_to_batch": 2.717319665265781e-06}}, "connector_pipeline_timer": 5.801706359664639e-05}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.905077064690702e-06, "tensor_to_numpy": 1.4781760262896676e-05, "remove_single_ts_time_rank_from_batch": 1.1737046025717716e-05, "get_actions": 3.4927896092202955e-05, "listify_data_for_vector_env": 1.0282412741348692e-05, "un_batch_to_individual_items": 6.467215197173536e-06}}, "connector_pipeline_timer": 0.00011191345415879992}, "rlmodule_inference_timer": 3.022378752400179e-05, "episode_return_mean": 0.1, "module_episode_returns_mean": {"default_policy": 0.1}, "weights_seq_no": 7.0, "episode_return_max": 15.5, "num_episodes_lifetime": 140, "env_to_module_sum_episodes_length_out": 10.368238394572801, "env_step_timer": 1.3655702153557865e-05, "episode_len_min": 20, "env_reset_timer": 0.0007029371180244237, "num_env_steps_sampled_lifetime": 35400, "num_env_steps_sampled": 400, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394572801, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "episode_duration_sec_mean": 0.005119805393042043, "episode_return_min": -13.5, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "sample": 0.13360759575601705, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "agent_episode_returns_mean": {"default_agent": 0.1}, "time_between_sampling": 9.538662757680523}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "ba99e_00000", "date": "2025-08-11_18-53-48", "timestamp": 1754931228, "time_this_iter_s": 9.772706985473633, "time_total_s": 67.91225957870483, "pid": 11884, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1619f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 67.91225957870483, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 37.357142857142854, "ram_util_percent": 78.97142857142858}}
{"timers": {"training_iteration": 10.153313594287761, "restore_env_runners": 9.272487296489654e-06, "training_step": 10.153112558997599, "env_runner_sampling_timer": 1.6581551612511116, "learner_update_timer": 8.319156579752448, "synch_weights": 0.0016933806390323105, "restore_eval_env_runners": 6.922838071177848e-05, "evaluation_iteration": 0.1462729571487249, "synch_eval_env_connectors": 0.00018230620747327787, "synch_env_connectors": 5.5275724567285045e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2708506573799206e-05, "add_observations_from_episodes_to_batch": 2.8633569612772763e-06, "batch_individual_items": 1.2775035132789907e-05, "add_time_dim_to_batch_and_zero_pad": 7.2274358043727795e-06, "add_states_from_episodes_to_batch": 2.7873919855353335e-06}}, "connector_pipeline_timer": 6.08952399320337e-05}, "module_to_env_connector": {"connector_pipeline_timer": 0.00012033013677203644, "timers": {"connectors": {"get_actions": 4.0608538224835795e-05, "normalize_and_clip_actions": 8.00759023542283e-06, "un_batch_to_individual_items": 6.638273925889671e-06, "listify_data_for_vector_env": 1.0593276249507275e-05, "tensor_to_numpy": 1.5709374321638567e-05, "remove_single_ts_time_rank_from_batch": 1.1928210468729842e-05}}}, "weights_seq_no": 7.0, "episode_return_max": 14.5, "episode_duration_sec_mean": 0.005372411641292278, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "env_reset_timer": 3.804172086967784e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -184750.0, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "episode_return_min": -5.5, "agent_episode_returns_mean": {"default_agent": 5.0600000000000005}, "num_env_steps_sampled_lifetime": -3695000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "env_step_timer": 1.394367628972737e-05, "time_between_sampling": 0.03340364741698393, "num_episodes": 250.0, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 5.0600000000000005}, "sample": 0.0057448822645183705, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 3.249369832741161e-05, "episode_return_mean": 5.0600000000000005, "episode_len_max": 20, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3220.9851755196382}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13531377011203571, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009337194007179724, "add_observations_from_episodes_to_batch": 0.0008384429328195204, "add_columns_from_episodes_to_train_batch": 0.041680884907600566, "add_time_dim_to_batch_and_zero_pad": 0.0757359892693995, "add_states_from_episodes_to_batch": 0.003495844680002259, "batch_individual_items": 0.00398418047250484, "numpy_to_tensor": 7.510018437118711e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 287280, "module_train_batch_size_mean": 997.5252898807411, "vf_explained_var": 0.0017865300178527832, "total_loss": 0.2786184549331665, "weights_seq_no": 48.0, "vf_loss_unclipped": 48.77198028564453, "diff_num_grad_updates_vs_sampler_policy": 41.0, "entropy": 0.6916708946228027, "vf_loss": 0.3591057062149048, "policy_loss": -7.632358756382018e-05, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 2.5799774903134676e-06}, "__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 574560, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 1584000, "num_env_steps_trained_lifetime_throughput": 51119.66132312898}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 41.0, "num_module_steps_trained": 35910, "total_loss": 0.0, "num_module_steps_trained_lifetime": 287280, "module_train_batch_size_mean": 997.5252898807411, "weights_seq_no": 48.0}}}, "intrinsic_reward_module": {"total_loss": 0.0, "weights_seq_no": 8.0, "num_trainable_parameters": 8266, "num_module_steps_trained_lifetime": 47880, "module_train_batch_size_mean": 997.8076834879114, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 717.4775442497046}, "default_policy": {"use_intrinsic_rewards": 0.0, "num_trainable_parameters": 16595, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 47880, "module_train_batch_size_mean": 997.8076834879114, "vf_explained_var": 0.00012826919555664062, "total_loss": 0.277988463640213, "weights_seq_no": 8.0, "mean_kl_loss": 2.930595201178221e-06, "vf_loss_unclipped": 49.106929779052734, "curr_kl_coeff": 0.0006311872275546193, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.6916631460189819, "vf_loss": 0.35830503702163696, "curr_entropy_coeff": 0.0015431216992, "policy_loss": -8.212150714825839e-05, "num_module_steps_trained_lifetime_throughput": 717.4676574080455}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 95760, "num_env_steps_trained_lifetime": 264000, "num_env_steps_trained": 33000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 3957.4028530240976, "num_module_steps_trained_throughput": 27080717.045371152, "num_module_steps_trained_lifetime_throughput": 12818702.623236116}, "IntrinsicAttentionMask": [[[0.0898435190320015, 0.0904509425163269, 0.09043468534946442, 0.09134051948785782, 0.09132411330938339, 0.09130770713090897, 0.09129130840301514, 0.09094350039958954, 0.09092716872692108, 0.09091082960367203, 0.09122572839260101], [0.08935918658971786, 0.09024122357368469, 0.09021759033203125, 0.09153788536787033, 0.09151391685009003, 0.09148995578289032, 0.09146600216627121, 0.09095846861600876, 0.09093465656042099, 0.09091084450483322, 0.09137023985385895], [0.08937207609415054, 0.09024681150913239, 0.09022337943315506, 0.0915326252579689, 0.09150885790586472, 0.09148509800434113, 0.09146134555339813, 0.09095808118581772, 0.09093446284532547, 0.09091085195541382, 0.09136638790369034], [0.08865951001644135, 0.08993662148714066, 0.08990234136581421, 0.09182444214820862, 0.09178943932056427, 0.09175444394350052, 0.09171946346759796, 0.09097936004400253, 0.09094467759132385, 0.09091000258922577, 0.09157967567443848], [0.08867231011390686, 0.08994221687316895, 0.08990812301635742, 0.09181918203830719, 0.09178438037633896, 0.09174958616495132, 0.09171480685472488, 0.09097898006439209, 0.09094449132680893, 0.09091002494096756, 0.09157583117485046], [0.08868512511253357, 0.08994781225919724, 0.08991391211748123, 0.09181392937898636, 0.09177932888269424, 0.09174474328756332, 0.091710165143013, 0.09097861498594284, 0.0909443274140358, 0.09091005474328995, 0.09157200157642365], [0.08869792520999908, 0.08995340019464493, 0.08991969376802444, 0.09180866926908493, 0.09177426993846893, 0.09173988550901413, 0.09170551598072052, 0.0909782350063324, 0.09094414860010147, 0.09091007709503174, 0.09156815707683563], [0.0889703705906868, 0.09007219970226288, 0.09004264324903488, 0.09169691801071167, 0.09166683256626129, 0.0916367620229721, 0.09160669147968292, 0.09097018837928772, 0.09094034135341644, 0.09091050922870636, 0.09148652851581573], [0.0889832153916359, 0.09007779508829117, 0.09004843235015869, 0.09169166535139084, 0.09166178107261658, 0.09163191169500351, 0.09160204976797104, 0.09096981585025787, 0.09094016999006271, 0.09091053158044815, 0.09148269146680832], [0.0889960527420044, 0.09008338302373886, 0.0900542214512825, 0.09168640524148941, 0.09165672212839127, 0.09162705391645432, 0.09159739315509796, 0.09096943587064743, 0.09093998372554779, 0.09091054648160934, 0.0914788469672203], [0.08874916285276413, 0.0899757668375969, 0.08994285017251968, 0.09178763628005981, 0.09175404906272888, 0.09172047674655914, 0.0916869193315506, 0.09097673743963242, 0.09094344824552536, 0.0909101739525795, 0.09155280143022537]], [[0.09022647887468338, 0.09019365906715393, 0.09016085416078568, 0.08829524368047714, 0.0882631316781044, 0.08940159529447556, 0.0881989449262619, 0.0893365815281868, 0.10855183750391006, 0.08835924416780472, 0.08901245892047882], [0.09023155272006989, 0.09019893407821655, 0.09016633033752441, 0.08831172436475754, 0.08827980607748032, 0.08941157907247543, 0.08821598440408707, 0.08934693783521652, 0.10843703895807266, 0.08837535232305527, 0.08902473002672195], [0.09023663401603699, 0.09020420908927917, 0.09017179906368256, 0.08832821249961853, 0.08829648047685623, 0.08942156285047531, 0.08823303878307343, 0.08935730904340744, 0.10832236707210541, 0.08839146047830582, 0.08903700858354568], [0.09050773829221725, 0.09048662334680557, 0.09046550840139389, 0.08926009386777878, 0.08923926949501038, 0.08997602015733719, 0.08919762074947357, 0.08993403613567352, 0.1019069254398346, 0.08930159360170364, 0.0897245705127716], [0.09051210433244705, 0.09049118310213089, 0.09047026932239532, 0.08927604556083679, 0.08925540000200272, 0.08998534083366394, 0.08921413868665695, 0.08994373679161072, 0.10179833322763443, 0.08931715786457062, 0.0897362232208252], [0.09035103768110275, 0.09032317996025085, 0.09029532223939896, 0.08870870620012283, 0.08868135511875153, 0.0896502137184143, 0.0886266678571701, 0.08959493041038513, 0.1056860089302063, 0.08876321464776993, 0.08931926637887955], [0.09052081406116486, 0.09050028771162033, 0.0904797613620758, 0.08930791914463043, 0.089287668466568, 0.09000396728515625, 0.08924718201160431, 0.0899631455540657, 0.10158148407936096, 0.08934827148914337, 0.08975951373577118], [0.09036058932542801, 0.09033311903476715, 0.09030565619468689, 0.0887412279844284, 0.08871424943208694, 0.0896696150302887, 0.08866032212972641, 0.0896151140332222, 0.10546187311410904, 0.08879497647285461, 0.08934328705072403], [0.08586366474628448, 0.08573684096336365, 0.08561020344495773, 0.07863710820674896, 0.07852096110582352, 0.08271834999322891, 0.07828917354345322, 0.08247417211532593, 0.18201559782028198, 0.07886894792318344, 0.08126506954431534], [0.09049900621175766, 0.09047748893499374, 0.09045598655939102, 0.0892283022403717, 0.08920709788799286, 0.08995742350816727, 0.08916468918323517, 0.08991465717554092, 0.10212349146604538, 0.08927056938409805, 0.0897013247013092], [0.09040752053260803, 0.09038201719522476, 0.09035652130842209, 0.08890307694673538, 0.08887799084186554, 0.08976581692695618, 0.08882785588502884, 0.08971518278121948, 0.1043483167886734, 0.08895304054021835, 0.08946263790130615]], [[0.0898730456829071, 0.09048066288232803, 0.09013595432043076, 0.0910387858748436, 0.0913541242480278, 0.09133771061897278, 0.09132130444049835, 0.09130490571260452, 0.09095704555511475, 0.09127210080623627, 0.09092437475919724], [0.08940187841653824, 0.0902843326330185, 0.08978337049484253, 0.09109730273485184, 0.09155763685703278, 0.09153366088867188, 0.09150969237089157, 0.09148573875427246, 0.09097810089588165, 0.09143783152103424, 0.09093046188354492], [0.08966855704784393, 0.09039556980133057, 0.0899830013513565, 0.0910642221570015, 0.09144236147403717, 0.0914226770401001, 0.09140300005674362, 0.09138331562280655, 0.09096623957157135, 0.09134398400783539, 0.09092707931995392], [0.08897353708744049, 0.09010503441095352, 0.0894622951745987, 0.09115024656057358, 0.09174326807260513, 0.09171236306428909, 0.09168147295713425, 0.0916505828499794, 0.09099681675434113, 0.09158884733915329, 0.09093552827835083], [0.08873339742422104, 0.09000417590141296, 0.0892820730805397, 0.09117981791496277, 0.09184760600328445, 0.09181279689073563, 0.0917779952287674, 0.09174320101737976, 0.09100715070962906, 0.09167367219924927, 0.09093816578388214], [0.0887458473443985, 0.090009406208992, 0.08929141610860825, 0.0911782756447792, 0.0918421745300293, 0.09180756658315659, 0.09177296608686447, 0.09173838049173355, 0.09100659936666489, 0.0916692465543747, 0.0909380242228508], [0.08875831961631775, 0.09001465886831284, 0.08930078148841858, 0.09117675572633743, 0.09183676540851593, 0.09180235862731934, 0.09176796674728394, 0.09173358231782913, 0.0910060778260231, 0.0916648581624031, 0.09093790501356125], [0.0887707844376564, 0.09001989662647247, 0.08931013941764832, 0.09117522090673447, 0.09183134138584137, 0.09179713577032089, 0.09176294505596161, 0.09172876924276352, 0.09100554138422012, 0.09166044741868973, 0.09093776345252991], [0.0890360102057457, 0.0901312381029129, 0.08950915187597275, 0.09114254266023636, 0.09171616286039352, 0.09168627113103867, 0.0916563868522644, 0.09162651747465134, 0.09099411964416504, 0.09156680852174759, 0.09093482047319412], [0.0887957215309143, 0.09003037959337234, 0.08932886272668839, 0.09117214381694794, 0.09182050079107285, 0.0917867049574852, 0.09175292402505875, 0.09171915054321289, 0.09100447595119476, 0.09165164083242416, 0.09093749523162842], [0.08906099945306778, 0.09014170616865158, 0.08952789753675461, 0.09113945066928864, 0.0917053148150444, 0.09167583286762238, 0.09164635092020035, 0.09161689132452011, 0.09099303185939789, 0.09155797958374023, 0.09093452990055084]], [[0.08995132893323898, 0.08992260694503784, 0.0904770940542221, 0.08825870603322983, 0.08823052048683167, 0.08980780094861984, 0.08817417919635773, 0.09033272415399551, 0.1064927726984024, 0.08888782560825348, 0.08946450799703598], [0.08995874226093292, 0.0899302139878273, 0.09048093110322952, 0.08827748894691467, 0.08824949711561203, 0.08981619030237198, 0.08819352835416794, 0.09033754467964172, 0.1063782125711441, 0.08890240639448166, 0.08947520703077316], [0.08981373906135559, 0.08978147059679031, 0.09040466696023941, 0.08791427314281464, 0.08788268268108368, 0.08965249359607697, 0.08781953901052475, 0.09024236351251602, 0.10860209912061691, 0.08861973881721497, 0.08926695585250854], [0.0903719961643219, 0.09035491943359375, 0.0906841829419136, 0.08936183899641037, 0.08934495598077774, 0.09028663486242294, 0.08931118994951248, 0.09059853106737137, 0.09986529499292374, 0.08973821252584457, 0.09008225798606873], [0.09037870168685913, 0.0903618186712265, 0.09068728983402252, 0.08938013762235641, 0.08936344087123871, 0.09029433131217957, 0.08933006227016449, 0.09060262888669968, 0.09975705295801163, 0.0897522047162056, 0.09009230136871338], [0.08998831361532211, 0.08996056020259857, 0.09049618989229202, 0.08835257589817047, 0.08832533657550812, 0.08984964340925217, 0.08827086538076401, 0.09035674482584, 0.10592109709978104, 0.0889606773853302, 0.08951795846223831], [0.090392105281353, 0.090375617146492, 0.09069347381591797, 0.08941670507192612, 0.08940038830041885, 0.09030970185995102, 0.08936778455972672, 0.0906107947230339, 0.09954088926315308, 0.08978016674518585, 0.09011237323284149], [0.08985184878110886, 0.08982054889202118, 0.09042493999004364, 0.08800893276929855, 0.08797827363014221, 0.08969545364379883, 0.08791699260473251, 0.09026755392551422, 0.10802052915096283, 0.0886935442686081, 0.08932146430015564], [0.08413088321685791, 0.08400662243366241, 0.08643098175525665, 0.07705017179250717, 0.07693636417388916, 0.08351140469312668, 0.07670926302671432, 0.08579456061124802, 0.18376046419143677, 0.07962509989738464, 0.08204419165849686], [0.09021961688995361, 0.09019816666841507, 0.09061185270547867, 0.08895283192396164, 0.08893168717622757, 0.09011243283748627, 0.08888941258192062, 0.09050420671701431, 0.10229945927858353, 0.08942439407110214, 0.08985589444637299], [0.0900757908821106, 0.09005038440227509, 0.09054072201251984, 0.08857686817646027, 0.08855187892913818, 0.08994881808757782, 0.0885019302368164, 0.09041309356689453, 0.10456103086471558, 0.08913438022136688, 0.08964502066373825]], [[0.08993268758058548, 0.09021197259426117, 0.09052444994449615, 0.09109920263290405, 0.09141474962234497, 0.09106647968292236, 0.09138190746307373, 0.09103376418352127, 0.09101741015911102, 0.09133267402648926, 0.09098470956087112], [0.08972807228565216, 0.09006552398204803, 0.09044334292411804, 0.09113900363445282, 0.09152131527662277, 0.09109936654567719, 0.091481514275074, 0.09105975180864334, 0.09103994816541672, 0.09142185002565384, 0.09100035578012466], [0.0895003229379654, 0.0899023711681366, 0.0903528556227684, 0.09118327498435974, 0.0916401743888855, 0.09113592654466629, 0.09159259498119354, 0.09108860790729523, 0.09106495976448059, 0.0915212631225586, 0.09101767092943192], [0.08908460289239883, 0.08960416167974472, 0.09018712490797043, 0.0912640243768692, 0.09185779094696045, 0.09120254963636398, 0.091795913875103, 0.09114111214876175, 0.09111040830612183, 0.09170317649841309, 0.09104903787374496], [0.08885814994573593, 0.08944150060415268, 0.09009655565023422, 0.09130801260471344, 0.09197673946619034, 0.09123881161212921, 0.09190702438354492, 0.09116965532302856, 0.09113509207963943, 0.09180255234241486, 0.09106602519750595], [0.0891081690788269, 0.08962108194828033, 0.09019654244184494, 0.09125946462154388, 0.09184544533491135, 0.09119878709316254, 0.09178438037633896, 0.09113815426826477, 0.09110785275697708, 0.09169286489486694, 0.09104727953672409], [0.08888164907693863, 0.08945838361978531, 0.09010595828294754, 0.09130344539880753, 0.09196437150239944, 0.09123504161834717, 0.09189547598361969, 0.09116668999195099, 0.09113252907991409, 0.09179222583770752, 0.09106425195932388], [0.08913172781467438, 0.08963799476623535, 0.09020595252513885, 0.09125487506389618, 0.09183308482170105, 0.0911950096487999, 0.09177283942699432, 0.0911351814866066, 0.09110527485609055, 0.09168253093957901, 0.09104550629854202], [0.08914351463317871, 0.08964644372463226, 0.09021064639091492, 0.09125258773565292, 0.0918269008398056, 0.09119311720132828, 0.09176705777645111, 0.09113368391990662, 0.09110398590564728, 0.09167736768722534, 0.09104461222887039], [0.08891692757606506, 0.08948373049497604, 0.09012008458375931, 0.09129659086465836, 0.0919458344578743, 0.0912294015288353, 0.09187815338373184, 0.09116224944591522, 0.09112869948148727, 0.09177673608064651, 0.09106162190437317], [0.08916709572076797, 0.08966337144374847, 0.09022007137537003, 0.09124802052974701, 0.0918145552277565, 0.09118935465812683, 0.09175552427768707, 0.09113072603940964, 0.09110142290592194, 0.0916670486330986, 0.09104285389184952]], [[0.090094193816185, 0.09006143361330032, 0.09002867341041565, 0.08751880377531052, 0.08813374489545822, 0.08927053213119507, 0.08806964010000229, 0.08986508101224899, 0.10919397324323654, 0.0888819620013237, 0.0888819620013237], [0.09010014683008194, 0.09006757289171219, 0.09003500640392303, 0.08753987401723862, 0.0881512388586998, 0.0892813578248024, 0.08808751404285431, 0.08987238258123398, 0.10907471179962158, 0.08889507502317429, 0.08889507502317429], [0.09010607749223709, 0.09007369726896286, 0.09004133194684982, 0.08756094425916672, 0.08816873282194138, 0.08929217606782913, 0.08810538053512573, 0.08987967669963837, 0.10895556956529617, 0.08890818804502487, 0.08890818804502487], [0.09052792191505432, 0.09051082283258438, 0.09049371629953384, 0.08917415887117386, 0.08949911594390869, 0.09009700268507004, 0.08946529775857925, 0.09040824323892593, 0.1000376045703888, 0.08989305794239044, 0.08989305794239044], [0.09043057262897491, 0.09040966629981995, 0.09038877487182617, 0.08877908438444138, 0.08917500823736191, 0.08990427851676941, 0.08913378417491913, 0.09028434753417969, 0.10218381881713867, 0.08965539187192917, 0.08965539187192917], [0.09024030715227127, 0.09021248668432236, 0.09018466621637344, 0.08804842829704285, 0.0885726734995842, 0.08954034745693207, 0.08851805329322815, 0.09004569798707962, 0.10621769726276398, 0.08920980244874954, 0.08920980244874954], [0.09044089168310165, 0.09042038023471832, 0.09039987623691559, 0.08882025629281998, 0.08920883387327194, 0.08992449194192886, 0.08916837722063065, 0.09029742330312729, 0.10195891559123993, 0.0896802619099617, 0.0896802619099617], [0.09013553708791733, 0.09010414034128189, 0.09007275104522705, 0.08766614645719528, 0.08825604617595673, 0.08934609591960907, 0.08819456398487091, 0.08991596847772598, 0.10836155712604523, 0.08897357434034348, 0.08897357434034348], [0.08489006012678146, 0.08476091176271439, 0.08463195711374283, 0.07518656551837921, 0.07742250710725784, 0.08168881386518478, 0.07718710601329803, 0.08399014174938202, 0.18982015550136566, 0.08021092414855957, 0.08021092414855957], [0.0903068333864212, 0.09028135985136032, 0.09025589376688004, 0.08829821646213531, 0.0887790098786354, 0.08966585248708725, 0.08872893452644348, 0.09012866020202637, 0.10482921451330185, 0.08936300873756409, 0.08936300873756409], [0.0903068333864212, 0.09028135985136032, 0.09025589376688004, 0.08829821646213531, 0.0887790098786354, 0.08966585248708725, 0.08872893452644348, 0.09012866020202637, 0.10482921451330185, 0.08936300873756409, 0.08936300873756409]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1698866489024607e-05, "add_observations_from_episodes_to_batch": 2.7782788661885207e-06, "batch_individual_items": 1.2099073170429558e-05, "add_time_dim_to_batch_and_zero_pad": 6.822681816590728e-06, "add_states_from_episodes_to_batch": 2.7319911483358235e-06}}, "connector_pipeline_timer": 5.755314992356498e-05}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.810052390593543e-06, "tensor_to_numpy": 1.467056173504986e-05, "remove_single_ts_time_rank_from_batch": 1.171054228109946e-05, "get_actions": 3.524137421946117e-05, "listify_data_for_vector_env": 1.013667441311159e-05, "un_batch_to_individual_items": 6.4024294339312545e-06}}, "connector_pipeline_timer": 0.00011137007449775073}, "rlmodule_inference_timer": 3.027262918603986e-05, "episode_return_mean": 0.9, "module_episode_returns_mean": {"default_policy": 0.9}, "weights_seq_no": 8.0, "episode_return_max": 15.5, "num_episodes_lifetime": 160, "env_to_module_sum_episodes_length_out": 10.3682383945743, "env_step_timer": 1.3604975148741443e-05, "episode_len_min": 20, "env_reset_timer": 0.0006966339968444775, "num_env_steps_sampled_lifetime": 40400, "num_env_steps_sampled": 400, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.3682383945743, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "episode_duration_sec_mean": 0.005127049555303529, "episode_return_min": -13.5, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "sample": 0.13338667479846367, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "agent_episode_returns_mean": {"default_agent": 0.9}, "time_between_sampling": 9.536572371352907}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "ba99e_00000", "date": "2025-08-11_18-53-57", "timestamp": 1754931237, "time_this_iter_s": 9.42526388168335, "time_total_s": 77.33752346038818, "pid": 11884, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1619f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 77.33752346038818, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 34.276923076923076, "ram_util_percent": 78.43846153846154}}
{"timers": {"training_iteration": 10.145932659594845, "restore_env_runners": 9.238931674996514e-06, "training_step": 10.145731628827411, "env_runner_sampling_timer": 1.6566855325583507, "learner_update_timer": 8.313184979794682, "synch_weights": 0.0016852197527606324, "restore_eval_env_runners": 6.86110974757477e-05, "evaluation_iteration": 0.14597850007716404, "synch_eval_env_connectors": 0.00018161314585385006, "synch_env_connectors": 5.5156265149452045e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.236325020157451e-05, "add_observations_from_episodes_to_batch": 2.764029253398157e-06, "batch_individual_items": 1.2364525862991807e-05, "add_time_dim_to_batch_and_zero_pad": 6.974003747262805e-06, "add_states_from_episodes_to_batch": 2.731526712969479e-06}}, "connector_pipeline_timer": 5.9225710399712597e-05}, "module_to_env_connector": {"connector_pipeline_timer": 0.00011708672941633224, "timers": {"connectors": {"get_actions": 3.917525307953345e-05, "normalize_and_clip_actions": 7.827895354776892e-06, "un_batch_to_individual_items": 6.503339277559973e-06, "listify_data_for_vector_env": 1.0361183140977389e-05, "tensor_to_numpy": 1.530633592536363e-05, "remove_single_ts_time_rank_from_batch": 1.1763278073485327e-05}}}, "weights_seq_no": 8.0, "episode_return_max": 14.5, "episode_duration_sec_mean": 0.00522198428865522, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "env_reset_timer": 3.5017781058554165e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -215625.0, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "episode_return_min": -5.5, "agent_episode_returns_mean": {"default_agent": 6.74}, "num_env_steps_sampled_lifetime": -4312500.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "env_step_timer": 1.3581547702718168e-05, "time_between_sampling": 0.032126423607968434, "num_episodes": 250.0, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 6.74}, "sample": 0.005586017585867127, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 3.138809417524685e-05, "episode_return_mean": 6.74, "episode_len_max": 20, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3297.2915459749283}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1352900907412076, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009329758736601022, "add_observations_from_episodes_to_batch": 0.0008382280942196826, "add_columns_from_episodes_to_train_batch": 0.0416720193882984, "add_time_dim_to_batch_and_zero_pad": 0.07572683979683906, "add_states_from_episodes_to_batch": 0.003499412482320386, "batch_individual_items": 0.003983612418515239, "numpy_to_tensor": 7.484001280736195e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 323190, "module_train_batch_size_mean": 997.5168494263723, "vf_explained_var": 0.001760244369506836, "total_loss": 0.2781253457069397, "weights_seq_no": 54.0, "vf_loss_unclipped": 50.42412185668945, "diff_num_grad_updates_vs_sampler_policy": 46.0, "entropy": 0.6913881897926331, "vf_loss": 0.35906869173049927, "policy_loss": -0.0005435720086097717, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 1.81812938535586e-05}, "__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 646380, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 1782000, "num_env_steps_trained_lifetime_throughput": 50289.56662302999}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 46.0, "num_module_steps_trained": 35910, "total_loss": 0.0, "num_module_steps_trained_lifetime": 323190, "module_train_batch_size_mean": 997.5168494263723, "weights_seq_no": 54.0}}}, "intrinsic_reward_module": {"total_loss": 0.0, "weights_seq_no": 9.0, "num_trainable_parameters": 8266, "num_module_steps_trained_lifetime": 53865, "module_train_batch_size_mean": 997.7895308613665, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 716.9719226018188}, "default_policy": {"use_intrinsic_rewards": 0.0, "num_trainable_parameters": 16595, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 53865, "module_train_batch_size_mean": 997.7895308613665, "vf_explained_var": 0.0004934072494506836, "total_loss": 0.2774854302406311, "weights_seq_no": 9.0, "mean_kl_loss": 2.1047686459496617e-05, "vf_loss_unclipped": 50.84813690185547, "curr_kl_coeff": 0.00031559361377730966, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.6913613677024841, "vf_loss": 0.3583044409751892, "curr_entropy_coeff": 0.0015431216992, "policy_loss": -0.0005851238965988159, "num_module_steps_trained_lifetime_throughput": 716.9625553594212}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 107730, "num_env_steps_trained_lifetime": 297000, "num_env_steps_trained": 33000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 3954.5629592900978, "num_module_steps_trained_throughput": 26328766.39023547, "num_module_steps_trained_lifetime_throughput": 12787745.808826894}, "IntrinsicAttentionMask": [[[0.08993265777826309, 0.09054067730903625, 0.09019573777914047, 0.0914311408996582, 0.09108280390501022, 0.09139829874038696, 0.09138187766075134, 0.09103373438119888, 0.09101738035678864, 0.09100102633237839, 0.09098467975854874], [0.0894884318113327, 0.0903717502951622, 0.08987028896808624, 0.09167028218507767, 0.09116162359714508, 0.09162227809429169, 0.09159829467535019, 0.09109003096818924, 0.09106618165969849, 0.09104233235120773, 0.09101849794387817], [0.08973987400531769, 0.09046746790409088, 0.09005457162857056, 0.0915348008275032, 0.09111703187227249, 0.09149539470672607, 0.09147569537162781, 0.09105820208787918, 0.09103859961032867, 0.09101899713277817, 0.09099940955638885], [0.08884623646736145, 0.09012604504823685, 0.08939880132675171, 0.09201783686876297, 0.09127532690763474, 0.09194768965244293, 0.0919126346707344, 0.09117097407579422, 0.09113621711730957, 0.09110146760940552, 0.09106673300266266], [0.08909627795219421, 0.09022191911935806, 0.08958251774311066, 0.09188225120306015, 0.0912310853600502, 0.09182076156139374, 0.09179002791643143, 0.09113951772451401, 0.0911090150475502, 0.09107852727174759, 0.09104803949594498], [0.08886975795030594, 0.09013508260250092, 0.08941609412431717, 0.09200508147478104, 0.09127116948366165, 0.09193574637174606, 0.09190110117197037, 0.09116802364587784, 0.09113366901874542, 0.0910993292927742, 0.09106498956680298], [0.08888151496648788, 0.09013959020376205, 0.089424729347229, 0.09199869632720947, 0.09126909077167511, 0.09192977100610733, 0.09189533442258835, 0.09116654843091965, 0.09113238751888275, 0.09109824150800705, 0.09106411039829254], [0.08913163095712662, 0.09023544937372208, 0.08960847556591034, 0.09186311811208725, 0.09122483432292938, 0.09180285036563873, 0.09177272766828537, 0.09113506972789764, 0.09110517054796219, 0.09107527881860733, 0.09104540199041367], [0.08914341032505035, 0.09023996442556381, 0.08961712568998337, 0.09185673296451569, 0.09122274816036224, 0.0917968675494194, 0.09176695346832275, 0.09113358706235886, 0.09110388159751892, 0.09107419103384018, 0.09104450792074203], [0.08915519714355469, 0.09024447202682495, 0.089625783264637, 0.09185035526752472, 0.0912206619977951, 0.09179089963436127, 0.09176118671894073, 0.09113210439682007, 0.09110260009765625, 0.09107310324907303, 0.091043621301651], [0.08916698396205902, 0.09024897962808609, 0.08963444083929062, 0.09184397757053375, 0.09121857583522797, 0.09178492426872253, 0.09175541251897812, 0.09113061428070068, 0.09110131114721298, 0.09107202291488647, 0.09104274213314056]], [[0.09201288223266602, 0.09199856966733932, 0.09169504791498184, 0.09087897092103958, 0.09115143865346909, 0.09194135665893555, 0.09112308919429779, 0.09162376821041107, 0.08353797346353531, 0.09119386225938797, 0.09284301102161407], [0.0919976755976677, 0.09198357164859772, 0.09168437123298645, 0.09087984263896942, 0.09114846587181091, 0.091927170753479, 0.09112051874399185, 0.09161410480737686, 0.0836380124092102, 0.09119028598070145, 0.09281592071056366], [0.09167233854532242, 0.09166255593299866, 0.0914548709988594, 0.0908953994512558, 0.091082364320755, 0.09162341803312302, 0.09106291830539703, 0.09140606969594955, 0.08578939735889435, 0.09111145883798599, 0.09223923832178116], [0.09076878428459167, 0.09077052772045135, 0.09080767631530762, 0.0909082293510437, 0.09087454527616501, 0.09077752381563187, 0.09087803959846497, 0.09081641584634781, 0.09186109155416489, 0.09086930751800537, 0.09066791832447052], [0.09107521176338196, 0.09107312560081482, 0.09102873504161835, 0.09090877324342728, 0.0909489318728447, 0.09106476604938507, 0.09094475209712982, 0.09101829677820206, 0.08978625386953354, 0.09095516800880432, 0.0911959558725357], [0.09193678200244904, 0.09192349761724472, 0.09164156764745712, 0.09088321030139923, 0.09113645553588867, 0.09187035262584686, 0.09111011028289795, 0.09157533943653107, 0.08403926342725754, 0.091175876557827, 0.09270752966403961], [0.09104356169700623, 0.09104187041521072, 0.09100597351789474, 0.0909089520573616, 0.0909414291381836, 0.09103511273860931, 0.09093805402517319, 0.09099753201007843, 0.08999987691640854, 0.09094648063182831, 0.09114117920398712], [0.0915951058268547, 0.09158632904291153, 0.09140010178089142, 0.09089822322130203, 0.09106598049402237, 0.09155124425888062, 0.09104853123426437, 0.09135633707046509, 0.08630285412073135, 0.0910920798778534, 0.09210320562124252], [0.08036364614963531, 0.08046066761016846, 0.08254995942115784, 0.08847778290510178, 0.08644679933786392, 0.08084990829229355, 0.0866556391119957, 0.08304944634437561, 0.17005562782287598, 0.08613533526659012, 0.07495519518852234], [0.09112248569726944, 0.09111980348825455, 0.09106270223855972, 0.09090841561555862, 0.0909600555896759, 0.09110905230045319, 0.09095469117164612, 0.09104927629232407, 0.08946757018566132, 0.09096808731555939, 0.09127786010503769], [0.09287362545728683, 0.09284742921590805, 0.09229250252246857, 0.09080791473388672, 0.09130237996578217, 0.09274270385503769, 0.09125087410211563, 0.09216240793466568, 0.07794157415628433, 0.09137947112321854, 0.09439913183450699]], [[0.09096062183380127, 0.09025619924068451, 0.09049147367477417, 0.0909237191081047, 0.09116073697805405, 0.09114840626716614, 0.09113608300685883, 0.09087453782558441, 0.09086224436759949, 0.09109910577535629, 0.09108678251504898], [0.09091264009475708, 0.09086433798074722, 0.09088050574064255, 0.09091012179851532, 0.09092629700899124, 0.09092545509338379, 0.09092462062835693, 0.09090675413608551, 0.09090591222047806, 0.09092209488153458, 0.09092125296592712], [0.09092878550291061, 0.09066031873226166, 0.09075012803077698, 0.0909147560596466, 0.09100481867790222, 0.09100013971328735, 0.09099545329809189, 0.09089604765176773, 0.09089137613773346, 0.09098141640424728, 0.09097672998905182], [0.0909581407904625, 0.09028786420822144, 0.09051176905632019, 0.09092303365468979, 0.0911485105752945, 0.09113678336143494, 0.09112505614757538, 0.09087624400854111, 0.09086455404758453, 0.0910898819565773, 0.09107816219329834], [0.09097407013177872, 0.09008491039276123, 0.0903816893696785, 0.09092743694782257, 0.09122699499130249, 0.09121140837669373, 0.09119582176208496, 0.09086531400680542, 0.09084978699684143, 0.09114908427000046, 0.09113351255655289], [0.09097323566675186, 0.09009544551372528, 0.09038843959569931, 0.09092720597982407, 0.09122291207313538, 0.09120752662420273, 0.09119214117527008, 0.09086588025093079, 0.09085055440664291, 0.09114600718021393, 0.09113062918186188], [0.0909724161028862, 0.09010598063468933, 0.09039519727230072, 0.09092698246240616, 0.09121883660554886, 0.09120365232229233, 0.0911884680390358, 0.09086644649505615, 0.0908513218164444, 0.0911429300904274, 0.09112776070833206], [0.09095482528209686, 0.0903300866484642, 0.09053881466388702, 0.09092210978269577, 0.09113220125436783, 0.09112127125263214, 0.09111034870147705, 0.09087850898504257, 0.09086761623620987, 0.09107758104801178, 0.09106665849685669], [0.0909539982676506, 0.09034065157175064, 0.09054557979106903, 0.09092187881469727, 0.09112812578678131, 0.09111739695072174, 0.09110666811466217, 0.09087907522916794, 0.09086837619543076, 0.09107450395822525, 0.09106378257274628], [0.09096992760896683, 0.09013758599758148, 0.09041545540094376, 0.09092628955841064, 0.09120659530162811, 0.09119200706481934, 0.09117742627859116, 0.09086815267801285, 0.09085361659526825, 0.09113369882106781, 0.09111912548542023], [0.09096910804510117, 0.09014812856912613, 0.09042222052812576, 0.09092607349157333, 0.09120252728462219, 0.09118814021348953, 0.09117376804351807, 0.09086872637271881, 0.09085439145565033, 0.09113062918186188, 0.09111626446247101]], [[0.09146074205636978, 0.09145057946443558, 0.09164641797542572, 0.09106282144784927, 0.09105270355939865, 0.09161586314439774, 0.0910324677824974, 0.09138961136341095, 0.08574357628822327, 0.09128817915916443, 0.09225700795650482], [0.09145013242959976, 0.09144017100334167, 0.09163212031126022, 0.0910600945353508, 0.0910501703619957, 0.09160217642784119, 0.09103033691644669, 0.09138040989637375, 0.08584286272525787, 0.0912809893488884, 0.09223053604364395], [0.09165249764919281, 0.09163864701986313, 0.0919056385755539, 0.09111064672470093, 0.09109687060117722, 0.0918639674782753, 0.09106934070587158, 0.09155558049678802, 0.08395003527402878, 0.09141741693019867, 0.09273935109376907], [0.09103631973266602, 0.09103403240442276, 0.09107808768749237, 0.09094659239053726, 0.0909443125128746, 0.091071218252182, 0.09093973785638809, 0.09102030098438263, 0.08971703052520752, 0.09099744260311127, 0.09121496230363846], [0.09102527797222137, 0.09102319180965424, 0.09106339514255524, 0.09094339609146118, 0.09094130992889404, 0.09105712920427322, 0.09093713015317917, 0.0910106673836708, 0.08982044458389282, 0.09098980575799942, 0.09118831157684326], [0.09162122011184692, 0.0916079729795456, 0.0918632373213768, 0.09110304713249207, 0.0910898819565773, 0.09182340651750565, 0.09106354415416718, 0.09152854233980179, 0.0842425525188446, 0.09139642864465714, 0.09266015142202377], [0.0910031720995903, 0.0910014808177948, 0.09103399515151978, 0.09093693643808365, 0.09093525260686874, 0.09102892875671387, 0.09093187749385834, 0.09099134802818298, 0.0900275856256485, 0.09097447991371155, 0.09113498777151108], [0.09138623625040054, 0.09137747436761856, 0.09154611825942993, 0.09104343503713608, 0.09103471040725708, 0.09151981770992279, 0.09101727604866028, 0.09132497012615204, 0.08644072711467743, 0.09123760461807251, 0.09207158535718918], [0.08324474096298218, 0.08334153890609741, 0.08149805665016174, 0.08712775260210037, 0.08722906559705734, 0.08178267627954483, 0.08743203431367874, 0.08392467349767685, 0.16348324716091156, 0.08490482717752457, 0.07603143155574799], [0.09127897024154663, 0.09127222746610641, 0.09140212833881378, 0.09101475030183792, 0.0910080298781395, 0.09138187021017075, 0.09099458158016205, 0.09123177081346512, 0.08744467794895172, 0.09116443991661072, 0.09180653840303421], [0.09225593507289886, 0.09222991019487381, 0.09273211658000946, 0.09124045073986053, 0.09121471643447876, 0.09265365451574326, 0.0911632627248764, 0.09207391738891602, 0.07831282913684845, 0.09181472659111023, 0.09430849552154541]], [[0.08978403359651566, 0.09039105474948883, 0.09037481993436813, 0.09128004312515259, 0.09126364439725876, 0.09124725311994553, 0.09089961647987366, 0.09121447056531906, 0.09119808673858643, 0.09118171036243439, 0.09116533398628235], [0.0892728865146637, 0.09015407413244247, 0.09013047069311142, 0.09144948422908783, 0.09142553806304932, 0.0914015993475914, 0.0908944308757782, 0.09135374426841736, 0.09132982045412064, 0.09130591154098511, 0.09128199517726898], [0.08928648382425308, 0.09016039222478867, 0.09013698250055313, 0.0914449691772461, 0.0914212241768837, 0.0913974866271019, 0.09089457988739014, 0.09135003387928009, 0.09132631123065948, 0.09130260348320007, 0.09127888828516006], [0.08853475004434586, 0.08981006592512131, 0.08977583050727844, 0.09169522672891617, 0.0916602686047554, 0.09162532538175583, 0.09088597446680069, 0.09155547618865967, 0.09152057021856308, 0.09148567914962769, 0.09145080298185349], [0.08854825049638748, 0.0898163840174675, 0.08978234231472015, 0.09169071912765503, 0.09165596961975098, 0.09162122011184692, 0.09088614583015442, 0.0915517807006836, 0.09151707589626312, 0.09148238599300385, 0.09144771099090576], [0.0885617583990097, 0.0898226946592331, 0.08978884667158127, 0.09168621152639389, 0.09165165573358536, 0.09161711484193802, 0.09088630974292755, 0.09154807776212692, 0.09151358157396317, 0.09147909283638, 0.09144461899995804], [0.08884911984205246, 0.0899568423628807, 0.08992713689804077, 0.09159041941165924, 0.09156017005443573, 0.09152992814779282, 0.09088972210884094, 0.09146947413682938, 0.09143926203250885, 0.09140906482934952, 0.09137886762619019], [0.08858877420425415, 0.08983532339334488, 0.0898018628358841, 0.09167720377445221, 0.09164305776357651, 0.0916089192032814, 0.09088664501905441, 0.09154069423675537, 0.09150659292936325, 0.09147251397371292, 0.09143844246864319], [0.08860228955745697, 0.08984163403511047, 0.0898083746433258, 0.09167269617319107, 0.09163875132799149, 0.0916048213839531, 0.09088680893182755, 0.0915369912981987, 0.0915030986070633, 0.09146922081708908, 0.09143535047769547], [0.0886157974600792, 0.08984795212745667, 0.08981487900018692, 0.09166818857192993, 0.09163445234298706, 0.09160071611404419, 0.09088696539402008, 0.09153329581022263, 0.09149960428476334, 0.09146592020988464, 0.09143225103616714], [0.08862930536270142, 0.08985425531864166, 0.08982138335704803, 0.0916636735200882, 0.09163013100624084, 0.09159661084413528, 0.09088712185621262, 0.09152959287166595, 0.09149610251188278, 0.0914626196026802, 0.09142915159463882]], [[0.09015373885631561, 0.08945959806442261, 0.09008817374706268, 0.08757663518190384, 0.08819197863340378, 0.08998990803956985, 0.08812783658504486, 0.08926454931497574, 0.10926612466573715, 0.08894070237874985, 0.08894070237874985], [0.09026980400085449, 0.08966346830129623, 0.09021256119012833, 0.08801565319299698, 0.08855465054512024, 0.09012675285339355, 0.08849848806858063, 0.08949299156665802, 0.10674602538347244, 0.08920981734991074, 0.08920981734991074], [0.090164914727211, 0.08947902917861938, 0.09010013192892075, 0.08761812746524811, 0.0882263109087944, 0.09000304341316223, 0.08816292136907578, 0.08928629010915756, 0.1090267151594162, 0.0889662504196167, 0.0889662504196167], [0.0905592292547226, 0.09019631147384644, 0.09052500128746033, 0.08920498937368393, 0.08953005820512772, 0.09047368913888931, 0.08949622511863708, 0.09009409695863724, 0.10007219016551971, 0.08992413431406021, 0.08992413431406021], [0.09046874940395355, 0.09002543985843658, 0.09042692184448242, 0.0888165608048439, 0.08921264857053757, 0.0903642326593399, 0.0891714096069336, 0.0899006575345993, 0.10222695022821426, 0.08969323337078094, 0.08969323337078094], [0.09018158912658691, 0.08950807899236679, 0.09011797606945038, 0.08768028020858765, 0.08827772736549377, 0.09002264589071274, 0.08821546286344528, 0.08931880444288254, 0.10866846144199371, 0.08900449424982071, 0.08900449424982071], [0.09047836065292358, 0.09004340320825577, 0.09043733030557632, 0.08885706216096878, 0.08924579620361328, 0.09037582576274872, 0.08920532464981079, 0.08992095291614532, 0.10200116038322449, 0.08971742540597916, 0.08971742540597916], [0.0903014987707138, 0.08972002565860748, 0.09024660289287567, 0.08813893795013428, 0.0886562392115593, 0.09016432613134384, 0.08860234916210175, 0.0895565077662468, 0.10604367405176163, 0.08928486704826355, 0.08928486704826355], [0.08510839194059372, 0.08239919692277908, 0.08484962582588196, 0.07537993788719177, 0.07762163877487183, 0.0844629630446434, 0.07738563418388367, 0.08164990693330765, 0.19030828773975372, 0.0804172232747078, 0.0804172232747078], [0.09035326540470123, 0.08981325477361679, 0.09030229598283768, 0.08834361284971237, 0.08882465213537216, 0.09022589772939682, 0.08877454698085785, 0.08966133743524551, 0.1048831045627594, 0.08940895646810532, 0.08940895646810532], [0.09035326540470123, 0.08981325477361679, 0.09030229598283768, 0.08834361284971237, 0.08882465213537216, 0.09022589772939682, 0.08877454698085785, 0.08966133743524551, 0.1048831045627594, 0.08940895646810532, 0.08940895646810532]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3010641354852335e-05, "add_observations_from_episodes_to_batch": 3.101922359911909e-06, "batch_individual_items": 1.2975467048940086e-05, "add_time_dim_to_batch_and_zero_pad": 7.44487908367309e-06, "add_states_from_episodes_to_batch": 2.8516291431844824e-06}}, "connector_pipeline_timer": 6.187300154951641e-05}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.349293145479419e-06, "tensor_to_numpy": 1.5722082260740557e-05, "remove_single_ts_time_rank_from_batch": 1.2623982558664672e-05, "get_actions": 4.005790935483414e-05, "listify_data_for_vector_env": 1.1279386724788304e-05, "un_batch_to_individual_items": 6.810441069841867e-06}}, "connector_pipeline_timer": 0.00012226383235692357}, "rlmodule_inference_timer": 3.4152164577500656e-05, "episode_return_mean": 0.5, "module_episode_returns_mean": {"default_policy": 0.5}, "weights_seq_no": 9.0, "episode_return_max": 15.5, "num_episodes_lifetime": 180, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.5524320551453913e-05, "episode_len_min": 20, "env_reset_timer": 0.0006904393170009158, "num_env_steps_sampled_lifetime": 45400, "num_env_steps_sampled": 400, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "episode_duration_sec_mean": 0.005241149124922231, "episode_return_min": -13.5, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "sample": 0.13329520514159765, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "agent_episode_returns_mean": {"default_agent": 0.5}, "time_between_sampling": 9.535612107639649}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "ba99e_00000", "date": "2025-08-11_18-54-07", "timestamp": 1754931247, "time_this_iter_s": 9.549195051193237, "time_total_s": 86.88671851158142, "pid": 11884, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1619f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 86.88671851158142, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 34.26428571428571, "ram_util_percent": 78.42857142857143}}
{"timers": {"training_iteration": 10.14228716299971, "restore_env_runners": 9.206961910274728e-06, "training_step": 10.142086278788856, "env_runner_sampling_timer": 1.6559898176529713, "learner_update_timer": 8.310190314587302, "synch_weights": 0.0016771733859631513, "restore_eval_env_runners": 6.800873684766575e-05, "evaluation_iteration": 0.1458199450753274, "synch_eval_env_connectors": 0.00018098034470954546, "synch_env_connectors": 5.502139950090486e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2940949667380809e-05, "add_observations_from_episodes_to_batch": 2.8882815364286934e-06, "batch_individual_items": 1.2809349173515606e-05, "add_time_dim_to_batch_and_zero_pad": 7.265881164155526e-06, "add_states_from_episodes_to_batch": 2.8414251710219538e-06}}, "connector_pipeline_timer": 6.13368026817261e-05}, "module_to_env_connector": {"connector_pipeline_timer": 0.00012313468575711497, "timers": {"connectors": {"get_actions": 4.190273087249163e-05, "normalize_and_clip_actions": 8.163519013257683e-06, "un_batch_to_individual_items": 6.761548202584636e-06, "listify_data_for_vector_env": 1.0886936969345146e-05, "tensor_to_numpy": 1.6055397264471978e-05, "remove_single_ts_time_rank_from_batch": 1.2130924364426608e-05}}}, "weights_seq_no": 9.0, "episode_return_max": 14.5, "episode_duration_sec_mean": 0.005483709986787287, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "env_reset_timer": 3.655263900417625e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -246500.0, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "episode_return_min": -5.5, "agent_episode_returns_mean": {"default_agent": 5.380000000000001}, "num_env_steps_sampled_lifetime": -4930000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "env_step_timer": 1.4274767524057134e-05, "time_between_sampling": 0.03266368878833571, "num_episodes": 250.0, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 5.380000000000001}, "sample": 0.005772784973268573, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 3.378878110182354e-05, "episode_return_mean": 5.380000000000001, "episode_len_max": 20, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3176.9032163237334}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13526278025337854, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009322735309074388, "add_observations_from_episodes_to_batch": 0.0008380349734214423, "add_columns_from_episodes_to_train_batch": 0.04166244503499692, "add_time_dim_to_batch_and_zero_pad": 0.07571338639903966, "add_states_from_episodes_to_batch": 0.0035000841971748586, "batch_individual_items": 0.003986754623914089, "numpy_to_tensor": 7.468661255329901e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 359100, "module_train_batch_size_mean": 997.5109713823833, "vf_explained_var": 0.001636207103729248, "total_loss": 0.2782282531261444, "weights_seq_no": 60.0, "vf_loss_unclipped": 48.77064514160156, "diff_num_grad_updates_vs_sampler_policy": 51.0, "entropy": 0.6908717751502991, "vf_loss": 0.35900893807411194, "policy_loss": -0.00039525277679786086, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 2.0523681087070145e-05}, "__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 718200, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 1980000, "num_env_steps_trained_lifetime_throughput": 49465.03902999228}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 51.0, "num_module_steps_trained": 35910, "total_loss": 0.0, "num_module_steps_trained_lifetime": 359100, "module_train_batch_size_mean": 997.5109713823833, "weights_seq_no": 60.0}}}, "intrinsic_reward_module": {"total_loss": 0.0, "weights_seq_no": 10.0, "num_trainable_parameters": 8266, "num_module_steps_trained_lifetime": 59850, "module_train_batch_size_mean": 997.772440523815, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 716.0799133159161}, "default_policy": {"use_intrinsic_rewards": 0.0, "num_trainable_parameters": 16595, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 59850, "module_train_batch_size_mean": 997.772440523815, "vf_explained_var": 0.0010929107666015625, "total_loss": 0.2776598632335663, "weights_seq_no": 10.0, "mean_kl_loss": 2.256994048366323e-05, "vf_loss_unclipped": 48.981178283691406, "curr_kl_coeff": 0.00015779680688865483, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.6908509135246277, "vf_loss": 0.3583069443702698, "curr_entropy_coeff": 0.0015431216992, "policy_loss": -0.0004134685732424259, "num_module_steps_trained_lifetime_throughput": 716.07107241764}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 119700, "num_env_steps_trained_lifetime": 330000, "num_env_steps_trained": 33000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 3949.59412418985, "num_module_steps_trained_throughput": 25622755.3051852, "num_module_steps_trained_lifetime_throughput": 12769247.884544889}, "IntrinsicAttentionMask": [[[0.0899028554558754, 0.09051067382097244, 0.09016584604978561, 0.09140083938837051, 0.0913844183087349, 0.09103626757860184, 0.09101991355419159, 0.09133517742156982, 0.09098722040653229, 0.09130237251520157, 0.09095452725887299], [0.08944513648748398, 0.09032803028821945, 0.08982681483030319, 0.09162593632936478, 0.09160194545984268, 0.09109366685152054, 0.09106981754302979, 0.09153001010417938, 0.09102212637662888, 0.09148208796977997, 0.09097446501255035], [0.08970420062541962, 0.09043151140213013, 0.09001877158880234, 0.09149841219186783, 0.09147871285676956, 0.09106120467185974, 0.09104160219430923, 0.09141965210437775, 0.09100240468978882, 0.0913802981376648, 0.09096322953701019], [0.08878355473279953, 0.0900624543428421, 0.08933572471141815, 0.09195291250944138, 0.09191785752773285, 0.09117615222930908, 0.09114138782024384, 0.09181276708841324, 0.09107191115617752, 0.09174277633428574, 0.09100248664617538], [0.08879566192626953, 0.09006734192371368, 0.08934473246335983, 0.09194691479206085, 0.09191206097602844, 0.0911746546626091, 0.09114009141921997, 0.09180758148431778, 0.09107100963592529, 0.09173800051212311, 0.09100198745727539], [0.08905326575040817, 0.09017094224691391, 0.08953607827425003, 0.09181937575340271, 0.09178885072469711, 0.09114258736371994, 0.09111228585243225, 0.0916973277926445, 0.09105170518159866, 0.09163635969161987, 0.09099117666482925], [0.08906540274620056, 0.0901758223772049, 0.08954509347677231, 0.09181337803602219, 0.0917830541729927, 0.09114108234643936, 0.09111097455024719, 0.09169214218854904, 0.09105080366134644, 0.09163158386945724, 0.09099066257476807], [0.08883199095726013, 0.09008196741342545, 0.08937172591686249, 0.09192889928817749, 0.09189465641975403, 0.09117012470960617, 0.09113616496324539, 0.09179200977087021, 0.09106829017400742, 0.09172364324331284, 0.09100046008825302], [0.08908968418836594, 0.09018556773662567, 0.08956311643123627, 0.09180136770009995, 0.0917714461684227, 0.09113804996013641, 0.09110834449529648, 0.09168175607919693, 0.09104897081851959, 0.0916220024228096, 0.09098963439464569], [0.08885622769594193, 0.09009172022342682, 0.08938973397016525, 0.09191689640283585, 0.09188306331634521, 0.09116711467504501, 0.09113355726003647, 0.09178163856267929, 0.09106647968292236, 0.09171408414840698, 0.09099945425987244], [0.08911396563053131, 0.09019532054662704, 0.08958113938570023, 0.0917893648147583, 0.09175985306501389, 0.09113501757383347, 0.09110572189092636, 0.09167136996984482, 0.09104714542627335, 0.09161243587732315, 0.09098860621452332]], [[0.09028621017932892, 0.09025336802005768, 0.08955846726894379, 0.0883537083864212, 0.08832157403230667, 0.08946078270673752, 0.0882573351264, 0.08939572423696518, 0.10862364619970322, 0.08841773867607117, 0.08907138556241989], [0.09029094129800797, 0.09025830030441284, 0.08956753462553024, 0.08836986869573593, 0.08833791315555573, 0.08947043120861053, 0.08827405422925949, 0.08940575271844864, 0.10850836336612701, 0.08843351900577545, 0.08908333629369736], [0.09038852155208588, 0.09036005288362503, 0.08975730091333389, 0.08871080726385117, 0.0886828675866127, 0.0896725207567215, 0.08862701803445816, 0.08961604535579681, 0.10608386248350143, 0.08876647800207138, 0.08933443576097488], [0.09054635465145111, 0.09052523225545883, 0.0900774598121643, 0.08929818868637085, 0.08927734941244125, 0.09001441299915314, 0.08923568576574326, 0.08997241407632828, 0.10195038467645645, 0.08933970332145691, 0.0897628515958786], [0.09055036306381226, 0.0905294343829155, 0.09008583426475525, 0.08931378275156021, 0.08929313719272614, 0.09002337604761124, 0.08925186097621918, 0.08998176455497742, 0.10184134542942047, 0.08935491740703583, 0.08977416157722473], [0.09040186554193497, 0.09037398546934128, 0.0897836908698082, 0.08875861763954163, 0.08873124420642853, 0.08970064669847488, 0.08867653459310532, 0.08964534103870392, 0.10574541985988617, 0.08881315588951111, 0.0893695130944252], [0.09055835753679276, 0.09053782373666763, 0.09010257571935654, 0.08934496343135834, 0.0893247053027153, 0.09004129469394684, 0.08928419649600983, 0.0900004580616951, 0.10162359476089478, 0.08938533067703247, 0.08979673683643341], [0.09041069447994232, 0.09038320928812027, 0.08980121463537216, 0.08879043906927109, 0.08876344561576843, 0.08971934020519257, 0.08870948851108551, 0.08966480195522308, 0.10552030801773071, 0.08884421736001968, 0.08939283341169357], [0.08608097583055496, 0.08595383167266846, 0.0832962617278099, 0.07883615791797638, 0.07871971279382706, 0.08292771130800247, 0.0784873440861702, 0.08268291503190994, 0.1824757307767868, 0.07906858623027802, 0.08147075772285461], [0.09053833782672882, 0.09051681309938431, 0.09006072580814362, 0.08926708996295929, 0.08924586325883865, 0.08999651670455933, 0.08920343965291977, 0.08995373547077179, 0.10216784477233887, 0.08930936455726624, 0.08974030613899231], [0.09045407176017761, 0.09042855352163315, 0.08988809585571289, 0.08894885331392288, 0.08892375975847244, 0.08981204032897949, 0.08887360244989395, 0.08976138383150101, 0.10440201312303543, 0.08899883925914764, 0.08950870484113693]], [[0.0898435190320015, 0.0904509425163269, 0.09043469280004501, 0.09134051948785782, 0.09132411330938339, 0.09097618609666824, 0.09129130095243454, 0.09127490222454071, 0.09125851094722748, 0.09091082960367203, 0.09089450538158417], [0.08935918658971786, 0.09024122357368469, 0.09021759778261185, 0.09153788536787033, 0.09151391685009003, 0.09100612252950668, 0.09146599471569061, 0.0914420485496521, 0.09141810983419418, 0.09091084450483322, 0.09088703989982605], [0.08937206864356995, 0.09024681150913239, 0.09022337943315506, 0.0915326252579689, 0.09150885790586472, 0.09100533276796341, 0.09146134555339813, 0.09143759310245514, 0.09141385555267334, 0.09091085195541382, 0.09088724851608276], [0.08865951001644135, 0.08993662893772125, 0.08990234136581421, 0.09182444214820862, 0.09178943932056427, 0.09104876220226288, 0.09171946346759796, 0.091684490442276, 0.09164953976869583, 0.09091000258922577, 0.09087534248828888], [0.08867231011390686, 0.08994221687316895, 0.08990813046693802, 0.09181918203830719, 0.09178438037633896, 0.0910479947924614, 0.09171480685472488, 0.09168004244565964, 0.09164529293775558, 0.09091002494096756, 0.09087556600570679], [0.0889446958899498, 0.0900610089302063, 0.09003106504678726, 0.09170743077993393, 0.09167694300413132, 0.09103146940469742, 0.09161598980426788, 0.09158553183078766, 0.09155507385730743, 0.09091046452522278, 0.09088023751974106], [0.08869792520999908, 0.08995340764522552, 0.08991970121860504, 0.09180866926908493, 0.09177426993846893, 0.09104644507169724, 0.09170551598072052, 0.0916711613535881, 0.09163681417703629, 0.09091007709503174, 0.0908760130405426], [0.0887107327580452, 0.08995899558067322, 0.08992549031972885, 0.0918034091591835, 0.09176921844482422, 0.09104567021131516, 0.09170086681842804, 0.09166671335697174, 0.09163256734609604, 0.09091009944677353, 0.09087623655796051], [0.08872354030609131, 0.08996458351612091, 0.08993127197027206, 0.09179814904928207, 0.09176415950059891, 0.09104489535093307, 0.09169621020555496, 0.09166226536035538, 0.09162832051515579, 0.09091012179851532, 0.09087646007537842], [0.0889960527420044, 0.09008337557315826, 0.0900542214512825, 0.09168639779090881, 0.09165671467781067, 0.09102834761142731, 0.09159738570451736, 0.09156773239374161, 0.09153809398412704, 0.09091053903102875, 0.0908811092376709], [0.08900889754295349, 0.09008897095918655, 0.09006001055240631, 0.09168113768100739, 0.09165166318416595, 0.09102756530046463, 0.09159272909164429, 0.09156328439712524, 0.0915338471531868, 0.09091055393218994, 0.09088132530450821]], [[0.09021330624818802, 0.09018048644065857, 0.08948614448308945, 0.08763450384140015, 0.08825024962425232, 0.08938854187726974, 0.08818607032299042, 0.08932353556156158, 0.10933830589056015, 0.08899945765733719, 0.08899945765733719], [0.09021853655576706, 0.09018592536449432, 0.0894957035779953, 0.08765490353107452, 0.08826708048582077, 0.08939868211746216, 0.08820326626300812, 0.08933404833078384, 0.10921802371740341, 0.08901189267635345, 0.08901189267635345], [0.09032686799764633, 0.09029841423034668, 0.08969607204198837, 0.08808668702840805, 0.08862236887216568, 0.08961135149002075, 0.08856656402349472, 0.08955491334199905, 0.10668979585170746, 0.08927349746227264, 0.08927349746227264], [0.09059051424264908, 0.09057339280843735, 0.09021042287349701, 0.0892358124256134, 0.08956099301576614, 0.09015929698944092, 0.08952715247869492, 0.09012522548437119, 0.10010676085948944, 0.08995520323514938, 0.08995520323514938], [0.09050692617893219, 0.09048600494861603, 0.0900426134467125, 0.08885403722524643, 0.08925029635429382, 0.08998018503189087, 0.08920903503894806, 0.08993858844041824, 0.10227008163928986, 0.08973108232021332, 0.08973108232021332], [0.09034167975187302, 0.09031382948160172, 0.08972391486167908, 0.0881473496556282, 0.08867218345403671, 0.08964093029499054, 0.08861749619245529, 0.08958566188812256, 0.10633700340986252, 0.08931002020835876, 0.08931002020835876], [0.09051582217216492, 0.09049529582262039, 0.09006025642156601, 0.0888938382267952, 0.08928274363279343, 0.0899989977478981, 0.08924225717782974, 0.08995818346738815, 0.10204338282346725, 0.08975456655025482, 0.08975456655025482], [0.09035149216651917, 0.0903240218758583, 0.08974240720272064, 0.08818773925304413, 0.08870532363653183, 0.08966059237718582, 0.08865140378475189, 0.08960609138011932, 0.1061023697257042, 0.08933429419994354, 0.08933429419994354], [0.08532684296369553, 0.08519702404737473, 0.08248502016067505, 0.07557343691587448, 0.07782087475061417, 0.08210912346839905, 0.07758425921201706, 0.08185948431491852, 0.19079667329788208, 0.08062363415956497, 0.08062363415956497], [0.09039973467588425, 0.09037423133850098, 0.08983409404754639, 0.08838904649019241, 0.0888703390955925, 0.08975809067487717, 0.0888202041387558, 0.08970745652914047, 0.10493703931570053, 0.08945493400096893, 0.08945493400096893], [0.09039973467588425, 0.09037423133850098, 0.08983409404754639, 0.08838904649019241, 0.0888703390955925, 0.08975809067487717, 0.0888202041387558, 0.08970745652914047, 0.10493703931570053, 0.08945493400096893, 0.08945493400096893]], [[0.08981377631425858, 0.09042099118232727, 0.09040474891662598, 0.0913102775812149, 0.09129387140274048, 0.09094606339931488, 0.09126107394695282, 0.09124468266963959, 0.09122829884290695, 0.09088072925806046, 0.09119553118944168], [0.08931602537631989, 0.09019763767719269, 0.09017401933670044, 0.09149367362260818, 0.09146972000598907, 0.09096217155456543, 0.09142182767391205, 0.09139788150787354, 0.09137395769357681, 0.09086693823337555, 0.09132611006498337], [0.08932927250862122, 0.09020359814167023, 0.0901801809668541, 0.0914887934923172, 0.0914650410413742, 0.090961754322052, 0.09141755104064941, 0.09139381349086761, 0.09137007594108582, 0.09086731821298599, 0.0913226380944252], [0.0885971188545227, 0.08987333625555038, 0.08983907848596573, 0.0917598232626915, 0.09172484278678894, 0.09098468720912933, 0.09165491908788681, 0.09161997586488724, 0.09158504754304886, 0.09084602445363998, 0.09151522815227509], [0.08861026912927628, 0.08987929672002792, 0.08984522521495819, 0.09175494313240051, 0.09172016382217407, 0.0909842923283577, 0.09165064245462418, 0.09161590784788132, 0.09158118069171906, 0.09084642678499222, 0.09151176363229752], [0.08889012038707733, 0.09000575542449951, 0.08997583389282227, 0.09165116399526596, 0.09162069112062454, 0.09097561985254288, 0.09155977517366409, 0.09152933955192566, 0.09149890393018723, 0.0908546894788742, 0.09143806993961334], [0.08863657712936401, 0.08989118784666061, 0.08985751122236252, 0.09174516797065735, 0.09171079099178314, 0.09098347276449203, 0.09164208918809891, 0.09160774946212769, 0.09157343208789825, 0.0908471941947937, 0.09150482714176178], [0.08864972740411758, 0.08989714086055756, 0.08986365050077438, 0.09174028038978577, 0.09170611202716827, 0.0909830629825592, 0.09163780510425568, 0.09160367399454117, 0.09156955033540726, 0.09084758162498474, 0.09150135517120361], [0.08866289258003235, 0.0899030864238739, 0.08986979722976685, 0.09173540025949478, 0.0917014330625534, 0.09098266065120697, 0.09163353592157364, 0.09159960597753525, 0.09156569093465805, 0.09084797650575638, 0.09149789065122604], [0.08894289284944534, 0.09002956748008728, 0.09000042825937271, 0.09163162857294083, 0.09160196781158447, 0.09097397327423096, 0.09154266864061356, 0.09151303023099899, 0.09148341417312622, 0.09085623174905777, 0.09142419695854187], [0.08868921548128128, 0.08991499245166779, 0.08988209813833237, 0.09172563254833221, 0.09169206768274307, 0.0909818485379219, 0.09162498265504837, 0.09159146249294281, 0.09155794233083725, 0.09084876626729965, 0.09149095416069031]], [[0.0914793461561203, 0.09167525172233582, 0.09166505932807922, 0.09108135104179382, 0.09086651355028152, 0.09142852574586868, 0.09084631502628326, 0.09161413460969925, 0.08576102554798126, 0.09130675345659256, 0.09227577596902847], [0.09168856590986252, 0.09195958077907562, 0.09194547683000565, 0.09113865345716476, 0.09084220230579376, 0.09161829203367233, 0.09081434458494186, 0.09187500923871994, 0.08387620747089386, 0.09144998341798782, 0.09279170632362366], [0.09167777746915817, 0.09194488078355789, 0.09193098545074463, 0.09113577753305435, 0.090843565762043, 0.09160851687192917, 0.09081610292196274, 0.0918615385890007, 0.08397319167852402, 0.09144262969493866, 0.09276492893695831], [0.09104052186012268, 0.09108457714319229, 0.09108228981494904, 0.09095079451799393, 0.09090223163366318, 0.0910290777683258, 0.09089765697717667, 0.09107084572315216, 0.08972117304801941, 0.09100164473056793, 0.09121917188167572], [0.09079578518867493, 0.090758316218853, 0.0907602608203888, 0.09087221324443817, 0.09091363102197647, 0.0908055230975151, 0.09091752767562866, 0.09076999872922897, 0.09193378686904907, 0.09082888066768646, 0.09064403921365738], [0.09142434597015381, 0.09160080552101135, 0.09159162640571594, 0.09106573462486267, 0.09087210148572922, 0.09137856215238571, 0.09085389226675034, 0.09154576063156128, 0.08625684678554535, 0.09126885235309601, 0.09214148670434952], [0.09077249467372894, 0.09072737395763397, 0.090729720890522, 0.09086452424526215, 0.09091441333293915, 0.0907842218875885, 0.09091910719871521, 0.09074144065380096, 0.09214454889297485, 0.09081234782934189, 0.09058979898691177], [0.09162376075983047, 0.09187132120132446, 0.09185843914747238, 0.09112125635147095, 0.09085024148225784, 0.09155955910682678, 0.09082477539777756, 0.09179407358169556, 0.08445969223976135, 0.09140577912330627, 0.09263104200363159], [0.08306068181991577, 0.08122341334819794, 0.08131786435842514, 0.08693511039018631, 0.08910844475030899, 0.08354471623897552, 0.08931578695774078, 0.08179173618555069, 0.16312181949615479, 0.08471710234880447, 0.0758633241057396], [0.09129133820533752, 0.09142126142978668, 0.09141451120376587, 0.09102708101272583, 0.09088428318500519, 0.09125761687755585, 0.09087085723876953, 0.09138074517250061, 0.08745652437210083, 0.09117679297924042, 0.09181897342205048], [0.0923030897974968, 0.09280569106340408, 0.09277950972318649, 0.09128709137439728, 0.09074150025844574, 0.09217297285795212, 0.09069030731916428, 0.09264872223138809, 0.07835286110639572, 0.09186165779829025, 0.09435670077800751]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2192311172960687e-05, "add_observations_from_episodes_to_batch": 2.8586555278231864e-06, "batch_individual_items": 1.266362116775918e-05, "add_time_dim_to_batch_and_zero_pad": 7.120458419856794e-06, "add_states_from_episodes_to_batch": 2.8211596927330393e-06}}, "connector_pipeline_timer": 5.9762209041607986e-05}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.029430147974342e-06, "tensor_to_numpy": 1.5193257905683782e-05, "remove_single_ts_time_rank_from_batch": 1.2221857388239786e-05, "get_actions": 3.6464283338844366e-05, "listify_data_for_vector_env": 1.0577537192362876e-05, "un_batch_to_individual_items": 6.613772040562499e-06}}, "connector_pipeline_timer": 0.00011527611273894607}, "rlmodule_inference_timer": 3.220326987528022e-05, "episode_return_mean": 0.3, "module_episode_returns_mean": {"default_policy": 0.3}, "weights_seq_no": 10.0, "episode_return_max": 15.5, "num_episodes_lifetime": 200, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.4265884112852781e-05, "episode_len_min": 20, "env_reset_timer": 0.0006848586743063281, "num_env_steps_sampled_lifetime": 50400, "num_env_steps_sampled": 400, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "episode_duration_sec_mean": 0.005275169966043904, "episode_return_min": -13.5, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "sample": 0.1331177547606186, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "agent_episode_returns_mean": {"default_agent": 0.3}, "time_between_sampling": 9.538316210313324}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "ba99e_00000", "date": "2025-08-11_18-54-17", "timestamp": 1754931257, "time_this_iter_s": 9.905872106552124, "time_total_s": 96.79259061813354, "pid": 11884, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1619f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 96.79259061813354, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 40.31428571428571, "ram_util_percent": 78.86428571428571}}
{"timers": {"training_iteration": 10.133635131369141, "restore_env_runners": 9.183222264318299e-06, "training_step": 10.13343419475071, "env_runner_sampling_timer": 1.6553751148866092, "learner_update_timer": 8.302108725611243, "synch_weights": 0.0016686170720516208, "restore_eval_env_runners": 6.738948929052906e-05, "evaluation_iteration": 0.14557948729512676, "synch_eval_env_connectors": 0.0001801588817333899, "synch_env_connectors": 5.487948896413942e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3078908298258371e-05, "add_observations_from_episodes_to_batch": 2.8840859925743663e-06, "batch_individual_items": 1.2942136315631469e-05, "add_time_dim_to_batch_and_zero_pad": 7.362564807036866e-06, "add_states_from_episodes_to_batch": 2.8667180454582064e-06}}, "connector_pipeline_timer": 6.197558126312859e-05}, "module_to_env_connector": {"connector_pipeline_timer": 0.00012346314820489904, "timers": {"connectors": {"get_actions": 4.1885153963922696e-05, "normalize_and_clip_actions": 8.187964969244784e-06, "un_batch_to_individual_items": 6.8213263822708e-06, "listify_data_for_vector_env": 1.0836350419145408e-05, "tensor_to_numpy": 1.6088114378150796e-05, "remove_single_ts_time_rank_from_batch": 1.225567604206953e-05}}}, "weights_seq_no": 10.0, "episode_return_max": 14.5, "episode_duration_sec_mean": 0.005505548120941965, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "env_reset_timer": 3.833485778333734e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -277375.0, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "episode_return_min": -5.5, "agent_episode_returns_mean": {"default_agent": 4.420000000000002}, "num_env_steps_sampled_lifetime": -5547500.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "env_step_timer": 1.4273598778207817e-05, "time_between_sampling": 0.033754035967714896, "num_episodes": 250.0, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 4.420000000000002}, "sample": 0.005874372015498625, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 3.37134359475893e-05, "episode_return_mean": 4.420000000000002, "episode_len_max": 20, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3138.887937406213}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.135230011620734, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009316757955616704, "add_observations_from_episodes_to_batch": 0.0008377825435511373, "add_columns_from_episodes_to_train_batch": 0.04165359725424607, "add_time_dim_to_batch_and_zero_pad": 0.07569452919502595, "add_states_from_episodes_to_batch": 0.0035018341856802135, "batch_individual_items": 0.003987139167641037, "numpy_to_tensor": 7.451599645004326e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 395010, "module_train_batch_size_mean": 997.5068778348534, "vf_explained_var": 0.0015732049942016602, "total_loss": 0.27797794342041016, "weights_seq_no": 66.0, "vf_loss_unclipped": 48.78921890258789, "diff_num_grad_updates_vs_sampler_policy": 56.0, "entropy": 0.6903272271156311, "vf_loss": 0.35896560549736023, "policy_loss": -0.0006137441960163414, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 2.726776074268855e-05}, "__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 790020, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 2178000, "num_env_steps_trained_lifetime_throughput": 48662.76176112963}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 56.0, "num_module_steps_trained": 35910, "total_loss": 0.0, "num_module_steps_trained_lifetime": 395010, "module_train_batch_size_mean": 997.5068778348534, "weights_seq_no": 66.0}}}, "intrinsic_reward_module": {"total_loss": 0.0, "weights_seq_no": 11.0, "num_trainable_parameters": 8266, "num_module_steps_trained_lifetime": 65835, "module_train_batch_size_mean": 997.7563503102639, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 715.5945928564014}, "default_policy": {"use_intrinsic_rewards": 0.0, "num_trainable_parameters": 16595, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 65835, "module_train_batch_size_mean": 997.7563503102639, "vf_explained_var": 0.0012388825416564941, "total_loss": 0.27742743492126465, "weights_seq_no": 11.0, "mean_kl_loss": 3.055343040614389e-05, "vf_loss_unclipped": 48.965484619140625, "curr_kl_coeff": 7.889840344432741e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.6902950406074524, "vf_loss": 0.35830873250961304, "curr_entropy_coeff": 0.0015431216992, "policy_loss": -0.0006481543532572687, "num_module_steps_trained_lifetime_throughput": 715.5862757028933}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 131670, "num_env_steps_trained_lifetime": 363000, "num_env_steps_trained": 33000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 3946.8694726272884, "num_module_steps_trained_throughput": 24950465.344207507, "num_module_steps_trained_lifetime_throughput": 12752316.096936282}, "IntrinsicAttentionMask": [[[0.08981378376483917, 0.09042100608348846, 0.09040476381778717, 0.09097875654697418, 0.09129388630390167, 0.09127748757600784, 0.09126108884811401, 0.09124469757080078, 0.0908970758318901, 0.09121192246675491, 0.09119553864002228], [0.08931607007980347, 0.09019767493009567, 0.09017406404018402, 0.09100986272096634, 0.09146975725889206, 0.09144580364227295, 0.09142186492681503, 0.09139792621135712, 0.09089077264070511, 0.09135007113218307, 0.09132614731788635], [0.0893293097615242, 0.09020362794399261, 0.09018021076917648, 0.09100904315710068, 0.0914650708436966, 0.0914413258433342, 0.0914175808429718, 0.09139384329319, 0.09089095145463943, 0.0913463830947876, 0.09132266789674759], [0.088863804936409, 0.0899939090013504, 0.08996359258890152, 0.0910378247499466, 0.09163011610507965, 0.0915992483496666, 0.09156839549541473, 0.09153755009174347, 0.09088458865880966, 0.09147588908672333, 0.09144507348537445], [0.08861034363508224, 0.0898793637752533, 0.08984529972076416, 0.09105338156223297, 0.09172023832798004, 0.0916854739189148, 0.09165071696043015, 0.09161597490310669, 0.09088093787431717, 0.09154653549194336, 0.09151183813810349], [0.08862349390983582, 0.08988530933856964, 0.08985143899917603, 0.0910525694489479, 0.09171555191278458, 0.09168098866939545, 0.09164644032716751, 0.09161189943552017, 0.09088113158941269, 0.09154286235570908, 0.09150836616754532], [0.08863664418458939, 0.08989125490188599, 0.08985757827758789, 0.09105175733566284, 0.09171086549758911, 0.0916765034198761, 0.09164215624332428, 0.09160782396793365, 0.09088131785392761, 0.09153919667005539, 0.09150489419698715], [0.08864979445934296, 0.08989720046520233, 0.08986371755599976, 0.09105094522237778, 0.09170617908239365, 0.09167201817035675, 0.09163787215948105, 0.09160374104976654, 0.09088150411844254, 0.09153551608324051, 0.09150142222642899], [0.08892975002527237, 0.09002367407083511, 0.08999433368444443, 0.09103377163410187, 0.09160670638084412, 0.09157685190439224, 0.09154700487852097, 0.09151717275381088, 0.09088552743196487, 0.09145753085613251, 0.09142772108316422], [0.08867612481117249, 0.08990911394357681, 0.08987601846456528, 0.09104934334754944, 0.0916968286037445, 0.09166307747364044, 0.09162933379411697, 0.0915956050157547, 0.09088190644979477, 0.09152819216251373, 0.09149450063705444], [0.08868928998708725, 0.08991507440805435, 0.08988217264413834, 0.09104853868484497, 0.09169214963912964, 0.09165859967470169, 0.09162506461143494, 0.09159153699874878, 0.09088209271430969, 0.09152452647686005, 0.09149103611707687]], [[0.08984751254320145, 0.0904015377163887, 0.09037267416715622, 0.08815684169530869, 0.08812868595123291, 0.08970414847135544, 0.08864380419254303, 0.09022846817970276, 0.10636986047029495, 0.08878523111343384, 0.08936125040054321], [0.08968905359506607, 0.09031543135643005, 0.09028277546167374, 0.08778077363967896, 0.08774904161691666, 0.08952705562114716, 0.08832992613315582, 0.09011969715356827, 0.10857707262039185, 0.08848949521780014, 0.08913970738649368], [0.08969739824533463, 0.09032002091407776, 0.09028756618499756, 0.08780039101839066, 0.08776883780956268, 0.08953636139631271, 0.08834631741046906, 0.09012547135353088, 0.1084614247083664, 0.08850494772195816, 0.08915132284164429], [0.09030978381633759, 0.09063888341188431, 0.09062176197767258, 0.08930033445358276, 0.08928345888853073, 0.0902244821190834, 0.08959188312292099, 0.09053616970777512, 0.09979654848575592, 0.08967643976211548, 0.09002024680376053], [0.09031721204519272, 0.0906425192952156, 0.0906255915760994, 0.08931931853294373, 0.08930264413356781, 0.09023290127515793, 0.08960755169391632, 0.09054098278284073, 0.09968917816877365, 0.08969113975763321, 0.09003101289272308], [0.08988795429468155, 0.09042314440011978, 0.0903952568769455, 0.08825404196977615, 0.08822682499885559, 0.08974944055080414, 0.0887247622013092, 0.090255968272686, 0.10580296814441681, 0.08886145800352097, 0.08941812068223953], [0.0901799350976944, 0.0905744656920433, 0.09055392444133759, 0.08897161483764648, 0.08895143121480942, 0.09007773548364639, 0.08932033181190491, 0.09045130014419556, 0.10166473686695099, 0.08942150324583054, 0.0898330807685852], [0.08973891288042068, 0.09034276008605957, 0.09031128883361816, 0.08789831399917603, 0.08786769211292267, 0.08958271890878677, 0.08842813223600388, 0.09015409648418427, 0.10788475722074509, 0.08858206123113632, 0.08920920640230179], [0.08372209221124649, 0.08613823354244232, 0.08601100742816925, 0.07667578756809235, 0.0765625387430191, 0.08310561627149582, 0.07865571230649948, 0.08537767827510834, 0.1828676164150238, 0.07923820614814758, 0.08164554089307785], [0.09014172106981277, 0.09055515378713608, 0.09053362905979156, 0.08887603878974915, 0.08885490894317627, 0.09003463387489319, 0.08924122154712677, 0.09042607247829437, 0.10221114009618759, 0.08934719115495682, 0.08977831900119781], [0.0899837538599968, 0.0904737338423729, 0.09044821560382843, 0.08848636597394943, 0.08846140652894974, 0.08985691517591476, 0.08891800045967102, 0.09032071381807327, 0.10445419698953629, 0.08904330432415009, 0.08955342322587967]], [[0.0898432731628418, 0.09045068174600601, 0.09010609239339828, 0.09100862592458725, 0.0913238599896431, 0.09130745381116867, 0.09129105508327484, 0.09127465635538101, 0.09125826507806778, 0.09091058373451233, 0.09122547507286072], [0.08935867995023727, 0.0902407094836235, 0.08973997831344604, 0.09105328470468521, 0.09151339530944824, 0.09148943424224854, 0.09146547317504883, 0.09144152700901031, 0.0914175882935524, 0.09091033041477203, 0.09136971831321716], [0.08963294327259064, 0.09035966545343399, 0.08994726091623306, 0.09102805703878403, 0.09140604734420776, 0.09138637036085129, 0.09136669337749481, 0.09134702384471893, 0.09132736176252365, 0.09091053903102875, 0.09128805249929428], [0.08891817927360535, 0.09004896879196167, 0.08940663188695908, 0.0910935252904892, 0.0916861817240715, 0.09165529161691666, 0.0916244238615036, 0.09159355610609055, 0.09156270325183868, 0.09090957045555115, 0.09150102734565735], [0.0886712372303009, 0.0899411216378212, 0.08921952545642853, 0.09111594408750534, 0.09178326278924942, 0.09174847602844238, 0.09171369671821594, 0.0916789323091507, 0.09164418280124664, 0.09090891480445862, 0.09157472103834152], [0.08868403732776642, 0.08994671702384949, 0.08922923356294632, 0.09111477434635162, 0.0917782112956047, 0.09174361824989319, 0.09170904755592346, 0.09167449176311493, 0.091639943420887, 0.090908944606781, 0.0915708914399147], [0.08869686722755432, 0.08995232731103897, 0.0892389565706253, 0.0911136269569397, 0.09177318215370178, 0.09173879772424698, 0.09170442819595337, 0.09167007356882095, 0.09163572639226913, 0.09090899676084518, 0.09156707674264908], [0.08870968222618103, 0.08995792269706726, 0.0892486646771431, 0.09111245721578598, 0.09176813066005707, 0.09173394739627838, 0.09169977903366089, 0.09166562557220459, 0.09163148701190948, 0.09090902656316757, 0.09156323969364166], [0.08872249722480774, 0.08996353298425674, 0.08925838023424149, 0.09111128747463226, 0.09176308661699295, 0.09172911196947098, 0.0916951447725296, 0.09166119247674942, 0.09162725508213043, 0.09090906381607056, 0.09155941009521484], [0.08899526298046112, 0.0900825709104538, 0.08946499228477478, 0.0910865068435669, 0.0916559025645256, 0.09162623435258865, 0.0915965735912323, 0.09156692028045654, 0.09153728187084198, 0.09090972691774368, 0.09147801995277405], [0.08874815702438354, 0.08997473865747452, 0.08927782624959946, 0.09110897034406662, 0.09175300598144531, 0.09171943366527557, 0.09168587625026703, 0.09165232628583908, 0.09161879122257233, 0.09090913832187653, 0.0915517583489418]], [[0.09190933406352997, 0.09189504384994507, 0.09159185737371445, 0.0910630151629448, 0.09104885905981064, 0.09183789044618607, 0.09102053940296173, 0.09180932492017746, 0.08370711654424667, 0.09137854725122452, 0.09273853152990341], [0.09189558774232864, 0.09188149869441986, 0.09158262610435486, 0.09106127917766571, 0.09104730933904648, 0.09182516485452652, 0.0910193920135498, 0.09179700165987015, 0.08380495756864548, 0.09137233346700668, 0.09271292388439178], [0.09160113334655762, 0.09159135818481445, 0.09138383716344833, 0.0910213366150856, 0.09101161360740662, 0.0915522500872612, 0.09099218249320984, 0.09153271466493607, 0.08590823411941528, 0.09123769402503967, 0.09216759353876114], [0.09107422083616257, 0.09107192605733871, 0.09102330356836319, 0.09093816578388214, 0.09093587845563889, 0.09106277674436569, 0.09093131124973297, 0.09105819463729858, 0.08970872312784195, 0.09098901599645615, 0.09120650589466095], [0.09105987101793289, 0.09105778485536575, 0.09101340174674988, 0.09093569219112396, 0.09093360602855682, 0.091049425303936, 0.09092943370342255, 0.09104525297880173, 0.08981284499168396, 0.0909821018576622, 0.09118059277534485], [0.09184049069881439, 0.09182721376419067, 0.09154557436704636, 0.09105415642261505, 0.09104099124670029, 0.09177412837743759, 0.09101467579603195, 0.09174759685993195, 0.08419730514287949, 0.09134738147258759, 0.0926104262471199], [0.09103113412857056, 0.09102945029735565, 0.09099356085062027, 0.09093070775270462, 0.09092902392148972, 0.09102269262075424, 0.09092564880847931, 0.09101931005716324, 0.09002142399549484, 0.09096825122833252, 0.09112874418497086], [0.09181288629770279, 0.0918000191450119, 0.09152698516845703, 0.09105052798986435, 0.09103776514530182, 0.09174855798482895, 0.09101224690675735, 0.09172283858060837, 0.08439410477876663, 0.09133483469486237, 0.09255915135145187], [0.08162591606378555, 0.08172082901000977, 0.08376381546258926, 0.08746754378080368, 0.08756925165653229, 0.08210159093141556, 0.08777301758527756, 0.08229263126850128, 0.16412153840065002, 0.08523594588041306, 0.07632790505886078], [0.09139066934585571, 0.0913839116692543, 0.09124055504798889, 0.09098988771438599, 0.09098316729068756, 0.09135691076517105, 0.09096972644329071, 0.09134341031312943, 0.08742077648639679, 0.0911395400762558, 0.09178145974874496], [0.09268657118082047, 0.09266041964292526, 0.09210661798715591, 0.09114418923854828, 0.09111848473548889, 0.09255591034889221, 0.09106708317995071, 0.09250370413064957, 0.07823016494512558, 0.09171786159276962, 0.09420900046825409]], [[0.08984322845935822, 0.09045064449310303, 0.0901060476899147, 0.09134022891521454, 0.09132382273674011, 0.09130741655826569, 0.09129101783037186, 0.09127461910247803, 0.0909268781542778, 0.09124182909727097, 0.09089421480894089], [0.08935859799385071, 0.09024062752723694, 0.08973989635705948, 0.09153728187084198, 0.09151331335306168, 0.09148935228586197, 0.09146539866924286, 0.09144144505262375, 0.09093405306339264, 0.09139356762170792, 0.0908864438533783], [0.08963290601968765, 0.090359628200531, 0.08994722366333008, 0.09142568707466125, 0.09140600264072418, 0.0913863331079483, 0.09136665612459183, 0.09134698659181595, 0.09093007445335388, 0.09130766242742538, 0.09089092910289764], [0.08865827322006226, 0.08993536978960037, 0.0892096608877182, 0.09182316064834595, 0.0917881578207016, 0.09175316244363785, 0.09171818196773529, 0.09168321639299393, 0.09094340354204178, 0.09161332249641418, 0.0908740758895874], [0.08867109566926956, 0.08994098007678986, 0.08921937644481659, 0.09181792289018631, 0.09178312122821808, 0.09174833446741104, 0.0917135551571846, 0.09167879074811935, 0.09094324707984924, 0.09160929918289185, 0.0908743143081665], [0.08868390321731567, 0.08994657546281815, 0.08922909200191498, 0.09181267023086548, 0.09177806973457336, 0.09174348413944244, 0.09170891344547272, 0.09167435020208359, 0.09094308316707611, 0.09160526841878891, 0.09087454527616501], [0.08869672566652298, 0.08995218575000763, 0.08923880755901337, 0.09180743247270584, 0.09177303314208984, 0.09173865616321564, 0.09170427918434143, 0.09166992455720901, 0.09094292670488358, 0.09160124510526657, 0.09087479114532471], [0.08870954811573029, 0.08995778858661652, 0.08924852311611176, 0.0918021872639656, 0.09176799654960632, 0.09173381328582764, 0.09169964492321014, 0.09166549146175385, 0.09094276279211044, 0.09159721434116364, 0.09087502956390381], [0.08898229897022247, 0.09007685631513596, 0.08945515751838684, 0.09169071912765503, 0.09166083484888077, 0.0916309654712677, 0.09160110354423523, 0.09157124906778336, 0.0909392312169075, 0.091511569917202, 0.09087996184825897], [0.0887352004647255, 0.08996900916099548, 0.08926796913146973, 0.09179170429706573, 0.09175791591405869, 0.09172414243221283, 0.09169037640094757, 0.0916566327214241, 0.09094244986772537, 0.09158916771411896, 0.09087550640106201], [0.08900801837444305, 0.09008807688951492, 0.0894746333360672, 0.09168023616075516, 0.09165076166391373, 0.0916212871670723, 0.09159183502197266, 0.09156239032745361, 0.09093889594078064, 0.09150351583957672, 0.09088043123483658]], [[0.09206588566303253, 0.09205156564712524, 0.09174786508083344, 0.09093131870031357, 0.09120393544435501, 0.09170506149530411, 0.09088889509439468, 0.09167654067277908, 0.08358604460954666, 0.09124638885259628, 0.0928964912891388], [0.09204992651939392, 0.09203580766916275, 0.09173643589019775, 0.09093144536018372, 0.09120022505521774, 0.09169425070285797, 0.09088962525129318, 0.09166613221168518, 0.08368545770645142, 0.09124207496643066, 0.0928686335682869], [0.09170851111412048, 0.09169872105121613, 0.09149095416069031, 0.09093125909566879, 0.09111829847097397, 0.0914616584777832, 0.09090214222669601, 0.09144213050603867, 0.08582320809364319, 0.09114740788936615, 0.09227563440799713], [0.09076234698295593, 0.09076409041881561, 0.09080123901367188, 0.09090178459882736, 0.09086810052394867, 0.09080648422241211, 0.0909070372581482, 0.09080997854471207, 0.09185460209846497, 0.09086287021636963, 0.09066148847341537], [0.09108291566371918, 0.09108082950115204, 0.09103643149137497, 0.0909164622426033, 0.09095662087202072, 0.09103017300367355, 0.09091020375490189, 0.09102599322795868, 0.089793860912323, 0.09096286445856094, 0.09120366722345352], [0.09165995568037033, 0.09165077656507492, 0.09145589917898178, 0.09093078225851059, 0.09110628813505173, 0.09142840653657913, 0.09090345352888107, 0.0914100930094719, 0.08612897992134094, 0.09113359451293945, 0.09219175577163696], [0.0907120406627655, 0.09071438759565353, 0.09076418727636337, 0.09089905023574829, 0.09085386991500854, 0.09077122062444687, 0.09090609103441238, 0.09077590703964233, 0.09217957407236099, 0.09084684401750565, 0.09057682752609253], [0.09162753075361252, 0.09161875396966934, 0.09143245965242386, 0.09093039482831955, 0.09109821170568466, 0.09140618145465851, 0.09090426564216614, 0.09138868004083633, 0.08633336424827576, 0.09112431854009628, 0.09213580936193466], [0.08003201335668564, 0.08012863248586655, 0.08220931887626648, 0.0881127268075943, 0.08609011769294739, 0.0825074091553688, 0.08843222260475159, 0.0827067419886589, 0.16935500502586365, 0.08577992767095566, 0.07464586198329926], [0.09113239496946335, 0.09112970530986786, 0.09107260406017303, 0.09091830253601074, 0.09096994251012802, 0.09106454253196716, 0.09091025590896606, 0.09105917066335678, 0.0894772931933403, 0.0909779742360115, 0.09128778427839279], [0.0929710790514946, 0.09294484555721283, 0.09238934516906738, 0.09090319275856018, 0.09139817208051682, 0.09231118112802505, 0.09082628041505814, 0.09225910902023315, 0.07802329212427139, 0.09147534519433975, 0.0944981798529625]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.172162688009092e-05, "add_observations_from_episodes_to_batch": 2.7683400024727654e-06, "batch_individual_items": 1.2103394974774112e-05, "add_time_dim_to_batch_and_zero_pad": 6.762009611353544e-06, "add_states_from_episodes_to_batch": 2.7076204228231025e-06}}, "connector_pipeline_timer": 5.758986106818193e-05}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.849508871182846e-06, "tensor_to_numpy": 1.466908005875292e-05, "remove_single_ts_time_rank_from_batch": 1.1818183228626769e-05, "get_actions": 3.4838633714515983e-05, "listify_data_for_vector_env": 1.0221214998169273e-05, "un_batch_to_individual_items": 6.466973770504542e-06}}, "connector_pipeline_timer": 0.00011152913277014443}, "rlmodule_inference_timer": 3.018309769076242e-05, "episode_return_mean": 0.3, "module_episode_returns_mean": {"default_policy": 0.3}, "weights_seq_no": 11.0, "episode_return_max": 15.5, "num_episodes_lifetime": 220, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.37992588720894e-05, "episode_len_min": 20, "env_reset_timer": 0.0006787721678713147, "num_env_steps_sampled_lifetime": 55400, "num_env_steps_sampled": 400, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "episode_duration_sec_mean": 0.005262079978128895, "episode_return_min": -13.5, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "sample": 0.132894355133564, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "agent_episode_returns_mean": {"default_agent": 0.3}, "time_between_sampling": 9.535964213210475}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "ba99e_00000", "date": "2025-08-11_18-54-26", "timestamp": 1754931266, "time_this_iter_s": 9.396032094955444, "time_total_s": 106.18862271308899, "pid": 11884, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1619f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 106.18862271308899, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 35.41428571428572, "ram_util_percent": 78.95714285714284}}
{"timers": {"training_iteration": 10.125996469225235, "restore_env_runners": 9.1513893343915e-06, "training_step": 10.125795503213576, "env_runner_sampling_timer": 1.6548271991567982, "learner_update_timer": 8.294993093775856, "synch_weights": 0.0016607609010461943, "restore_eval_env_runners": 6.679268462373756e-05, "evaluation_iteration": 0.14528474909183725, "synch_eval_env_connectors": 0.00017956812285761185, "synch_env_connectors": 5.477649490790209e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2213724796978555e-05, "add_observations_from_episodes_to_batch": 2.804503736114499e-06, "batch_individual_items": 1.235129786094537e-05, "add_time_dim_to_batch_and_zero_pad": 7.001905663945474e-06, "add_states_from_episodes_to_batch": 2.764189343952975e-06}}, "connector_pipeline_timer": 5.923502383300763e-05}, "module_to_env_connector": {"connector_pipeline_timer": 0.00011712369291729088, "timers": {"connectors": {"get_actions": 3.911860109853642e-05, "normalize_and_clip_actions": 7.820712932498239e-06, "un_batch_to_individual_items": 6.498873549310169e-06, "listify_data_for_vector_env": 1.0390697465619854e-05, "tensor_to_numpy": 1.531731572529407e-05, "remove_single_ts_time_rank_from_batch": 1.1755128095252192e-05}}}, "weights_seq_no": 11.0, "episode_return_max": 14.5, "episode_duration_sec_mean": 0.005579011662863197, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "env_reset_timer": 3.4196682902838576e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -308250.0, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "episode_return_min": -5.5, "agent_episode_returns_mean": {"default_agent": 6.419999999999999}, "num_env_steps_sampled_lifetime": -6165000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "env_step_timer": 1.3543448192899981e-05, "time_between_sampling": 0.031916874185783234, "num_episodes": 250.0, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 6.419999999999999}, "sample": 0.0059218783795726175, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 5.076093401137241e-05, "episode_return_mean": 6.419999999999999, "episode_len_max": 20, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3283.949260414359}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13519039734389282, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009309011626029469, "add_observations_from_episodes_to_batch": 0.0008371917983644437, "add_columns_from_episodes_to_train_batch": 0.04164292211133634, "add_time_dim_to_batch_and_zero_pad": 0.07567491557331898, "add_states_from_episodes_to_batch": 0.0035020495940642883, "batch_individual_items": 0.003986887365189084, "numpy_to_tensor": 7.43566663246532e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 430920, "module_train_batch_size_mean": 997.504027034245, "vf_explained_var": 0.0015538334846496582, "total_loss": 0.2785099148750305, "weights_seq_no": 72.0, "vf_loss_unclipped": 50.456687927246094, "diff_num_grad_updates_vs_sampler_policy": 61.0, "entropy": 0.6901295781135559, "vf_loss": 0.3589359223842621, "policy_loss": -5.550505011342466e-05, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 6.020626187819289e-06}, "__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 861840, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 2376000, "num_env_steps_trained_lifetime_throughput": 47893.8343598118}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 61.0, "num_module_steps_trained": 35910, "total_loss": 0.0, "num_module_steps_trained_lifetime": 430920, "module_train_batch_size_mean": 997.504027034245, "weights_seq_no": 72.0}}}, "intrinsic_reward_module": {"total_loss": 0.0, "weights_seq_no": 12.0, "num_trainable_parameters": 8266, "num_module_steps_trained_lifetime": 71820, "module_train_batch_size_mean": 997.7412016936058, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 715.2591415095579}, "default_policy": {"use_intrinsic_rewards": 0.0, "num_trainable_parameters": 16595, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 71820, "module_train_batch_size_mean": 997.7412016936058, "vf_explained_var": 0.0007057785987854004, "total_loss": 0.2780170440673828, "weights_seq_no": 12.0, "mean_kl_loss": 6.17566274740966e-06, "vf_loss_unclipped": 50.74566650390625, "curr_kl_coeff": 3.944920172216371e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.6901260018348694, "vf_loss": 0.3583064377307892, "curr_entropy_coeff": 0.0015431216992, "policy_loss": -5.702349517378025e-05, "num_module_steps_trained_lifetime_throughput": 715.2513393431561}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 143640, "num_env_steps_trained_lifetime": 396000, "num_env_steps_trained": 33000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 3944.972787820028, "num_module_steps_trained_throughput": 24313108.460710935, "num_module_steps_trained_lifetime_throughput": 12739737.079353493}, "IntrinsicAttentionMask": [[[0.08990316092967987, 0.09051097929477692, 0.09049471467733383, 0.0910692885518074, 0.09105293452739716, 0.09103658050298691, 0.09102022647857666, 0.09133549779653549, 0.09131909161806107, 0.09130268543958664, 0.09095484018325806], [0.0894458144903183, 0.09032870084047318, 0.09030505269765854, 0.09114207327365875, 0.09111820161342621, 0.09109434485435486, 0.0910704955458641, 0.0915306955575943, 0.091506727039814, 0.09148276597261429, 0.09097515046596527], [0.08945798128843307, 0.09033355861902237, 0.09031010419130325, 0.09114013612270355, 0.09111646562814713, 0.09109281003475189, 0.09106916189193726, 0.09152548760175705, 0.09150172770023346, 0.09147796779870987, 0.0909746065735817], [0.08903010189533234, 0.09016230702400208, 0.09013193845748901, 0.09120818227529526, 0.09117745608091354, 0.09114674478769302, 0.0911160409450531, 0.09170884639024734, 0.0916779488325119, 0.09164707362651825, 0.09099332988262177], [0.08904222398996353, 0.09016717225313187, 0.09013699740171432, 0.09120626002550125, 0.09117573499679565, 0.09114522486925125, 0.09111472219228745, 0.09170364588499069, 0.09167295694351196, 0.09164227545261383, 0.09099280834197998], [0.08905433863401413, 0.09017203003168106, 0.09014204889535904, 0.09120433032512665, 0.09117400646209717, 0.09114369750022888, 0.0911133885383606, 0.09169843792915344, 0.09166795015335083, 0.09163747727870941, 0.090992271900177], [0.08906647562980652, 0.09017689526081085, 0.09014711529016495, 0.09120240807533264, 0.09117227792739868, 0.09114217013120651, 0.09111206978559494, 0.09169323742389679, 0.0916629508137703, 0.09163267910480499, 0.09099175781011581], [0.08883334696292877, 0.09008333086967468, 0.09004977345466614, 0.09123947471380234, 0.09120549261569977, 0.0911715179681778, 0.09113755822181702, 0.09179341793060303, 0.09175922721624374, 0.09172505140304565, 0.09100185334682465], [0.08884544670581818, 0.09008818864822388, 0.09005483239889145, 0.09123754501342773, 0.09120376408100128, 0.09116999059915543, 0.09113623946905136, 0.09178820997476578, 0.09175422042608261, 0.09172024577856064, 0.09100132435560226], [0.08885754644870758, 0.09009305387735367, 0.09005988389253616, 0.09123562276363373, 0.0912020355463028, 0.09116847068071365, 0.09113491326570511, 0.09178300201892853, 0.09174921363592148, 0.09171544760465622, 0.09100080281496048], [0.0891149714589119, 0.09019633382558823, 0.0901673287153244, 0.09119468927383423, 0.09116536378860474, 0.09113605320453644, 0.09110675007104874, 0.09167241305112839, 0.09164293855428696, 0.09161347150802612, 0.09098963439464569]], [[0.0919862911105156, 0.0916828066110611, 0.09195768088102341, 0.09113926440477371, 0.09112509340047836, 0.09191478788852692, 0.09081032127141953, 0.09188620001077652, 0.0835137739777565, 0.09116750210523605, 0.09281618148088455], [0.09166925400495529, 0.0914572924375534, 0.09164927899837494, 0.09107713401317596, 0.09106720983982086, 0.0916193276643753, 0.09084673970937729, 0.09159936755895615, 0.08566969633102417, 0.0910969004034996, 0.09224780648946762], [0.09195665270090103, 0.09166181087493896, 0.0919288620352745, 0.09113366901874542, 0.09111989289522171, 0.09188718348741531, 0.0908140018582344, 0.09185941517353058, 0.08371460437774658, 0.09116110950708389, 0.092762790620327], [0.09108680486679077, 0.09103817492723465, 0.09108223021030426, 0.09095073491334915, 0.0909484475851059, 0.0910753607749939, 0.09089760482311249, 0.09107078611850739, 0.08967547118663788, 0.09095528721809387, 0.09121911227703094], [0.09107135981321335, 0.09102697670459747, 0.09106718003749847, 0.09094716608524323, 0.09094507992267609, 0.09106091409921646, 0.09089867025613785, 0.09105673432350159, 0.0897824615240097, 0.09095132350921631, 0.0911920964717865], [0.09191211313009262, 0.09163021296262741, 0.09188554435968399, 0.09112516790628433, 0.09111198782920837, 0.09184569865465164, 0.09081941843032837, 0.0918191522359848, 0.08401665091514587, 0.0911514088511467, 0.09268265217542648], [0.09072496742010117, 0.0907747745513916, 0.09072965383529663, 0.09086446464061737, 0.0908668115735054, 0.09073668718338013, 0.09091904759407043, 0.09074137359857559, 0.09219270944595337, 0.0908597856760025, 0.0905897319316864], [0.0918823629617691, 0.09160909056663513, 0.09185660630464554, 0.0911194309592247, 0.09110665321350098, 0.09181798249483109, 0.09082295745611191, 0.09179224818944931, 0.08421856164932251, 0.0911448746919632, 0.09262919425964355], [0.08052447438240051, 0.0826154425740242, 0.08071901649236679, 0.08651541918516159, 0.08661985397338867, 0.08101170510053635, 0.08897639065980911, 0.08120742440223694, 0.17039728164672852, 0.08630777150392532, 0.07510518282651901], [0.09111752361059189, 0.09106042981147766, 0.0911121517419815, 0.09095778316259384, 0.09095510095357895, 0.09110409021377563, 0.09089542180299759, 0.09109871089458466, 0.08946269005537033, 0.09096313267946243, 0.09127289056777954], [0.09282460063695908, 0.09226981550455093, 0.0927722379565239, 0.09127992391586304, 0.09125416725873947, 0.0926937460899353, 0.09068318456411362, 0.09264145791530609, 0.07790035009384155, 0.09133122116327286, 0.09434929490089417]], [[0.09100599586963654, 0.09054886549711227, 0.09028901159763336, 0.09096907824277878, 0.09095676988363266, 0.09094447642564774, 0.09118154644966125, 0.0909198746085167, 0.09115688502788544, 0.09114455431699753, 0.09088298678398132], [0.09094759076833725, 0.09076616168022156, 0.09066278487443924, 0.09093295782804489, 0.0909280851483345, 0.09092320501804352, 0.09101711958646774, 0.09091345220804214, 0.09100735187530518, 0.09100247919559479, 0.09089882671833038], [0.09091416001319885, 0.09089028090238571, 0.09087666869163513, 0.09091223031282425, 0.09091159701347351, 0.09091095626354218, 0.09092329442501068, 0.09090966731309891, 0.09092201292514801, 0.09092137217521667, 0.0909077450633049], [0.09100130200386047, 0.09056636691093445, 0.09031908214092255, 0.09096617996692657, 0.09095447510480881, 0.09094277024269104, 0.09116829931735992, 0.0909193679690361, 0.09114483743906021, 0.09113311022520065, 0.09088427573442459], [0.09099973738193512, 0.09057219326496124, 0.09032910317182541, 0.09096521139144897, 0.09095370769500732, 0.09094220399856567, 0.09116388112306595, 0.09091919660568237, 0.09114082157611847, 0.09112929552793503, 0.09088470041751862], [0.09099816530942917, 0.09057803452014923, 0.09033913165330887, 0.09096424281597137, 0.09095293283462524, 0.09094163030385971, 0.09115946292877197, 0.09091903269290924, 0.09113680571317673, 0.0911254733800888, 0.09088513255119324], [0.09102828800678253, 0.09046576917171478, 0.09014630317687988, 0.0909828320145607, 0.09096768498420715, 0.09095253795385361, 0.09124447405338287, 0.09092225879430771, 0.09121409058570862, 0.09119890630245209, 0.09087685495615005], [0.09099502861499786, 0.09058969467878342, 0.09035918116569519, 0.09096230566501617, 0.09095139801502228, 0.09094049036502838, 0.09115062654018402, 0.09091868996620178, 0.09112876653671265, 0.09111784398555756, 0.09088598191738129], [0.09102516621351242, 0.09047743678092957, 0.09016633033752441, 0.0909809023141861, 0.09096615761518478, 0.09095141291618347, 0.09123564511537552, 0.09092193096876144, 0.09120606631040573, 0.09119128435850143, 0.0908777192234993], [0.09102358669042587, 0.09048325568437576, 0.09017632156610489, 0.0909799262881279, 0.0909653827548027, 0.09095083177089691, 0.09123121201992035, 0.09092174470424652, 0.0912020355463028, 0.09118745476007462, 0.09087814390659332], [0.0909903347492218, 0.09060720354318619, 0.09038927406072617, 0.09095940738916397, 0.09094909578561783, 0.09093879163265228, 0.09113737940788269, 0.0909181758761406, 0.09111672639846802, 0.09110639989376068, 0.09088727086782455]], [[0.09157227724790573, 0.09156209975481033, 0.09175818413496017, 0.09096892178058624, 0.09095881879329681, 0.09152139723300934, 0.09093859791755676, 0.09150106459856033, 0.08565511554479599, 0.09119405597448349, 0.09236951917409897], [0.09155946224927902, 0.09154949337244034, 0.09174167364835739, 0.090968057513237, 0.09095814824104309, 0.09150960296392441, 0.09093832969665527, 0.09148966521024704, 0.08575605601072311, 0.09118874371051788, 0.09234080463647842], [0.091804139316082, 0.09179026633501053, 0.09205769747495651, 0.09098251163959503, 0.09096876531839371, 0.09173478931188583, 0.09094126522541046, 0.09170705825090408, 0.08383191376924515, 0.09128885716199875, 0.09289278835058212], [0.09079130738973618, 0.09079305082559586, 0.09075941145420074, 0.09089533984661102, 0.0908970907330513, 0.09080004692077637, 0.09090059995651245, 0.09080354124307632, 0.09184809774160385, 0.09085642546415329, 0.09065505862236023], [0.09077784419059753, 0.09077978879213333, 0.090742327272892, 0.0908937156200409, 0.09089566767215729, 0.09078758209943771, 0.09089956432580948, 0.0907914787530899, 0.09195556491613388, 0.09085037559270859, 0.09062612801790237], [0.09150812029838562, 0.0914989560842514, 0.09167555719614029, 0.09096448123455048, 0.09095536917448044, 0.09146229177713394, 0.09093714505434036, 0.0914439707994461, 0.08616089075803757, 0.09116736799478531, 0.09222592413425446], [0.09075087308883667, 0.0907532200217247, 0.09070810675621033, 0.09089041501283646, 0.09089276194572449, 0.09076260030269623, 0.09089745581150055, 0.0907672867178917, 0.0921708196401596, 0.09083821624517441, 0.09056822210550308], [0.09148237854242325, 0.09147361665964127, 0.09164243936538696, 0.09096261113882065, 0.09095390141010284, 0.09143857657909393, 0.09093647450208664, 0.09142105281352997, 0.08636394888162613, 0.09115660935640335, 0.09216845780611038], [0.08167582005262375, 0.08177442103624344, 0.07989729940891266, 0.08775243163108826, 0.08785837143659592, 0.0821700170636177, 0.08807062357664108, 0.08236853033304214, 0.16866277158260345, 0.08542916178703308, 0.07434061169624329], [0.09108788520097733, 0.09108519554138184, 0.09113693237304688, 0.09092818945646286, 0.09092550724744797, 0.09107445180416107, 0.09092014282941818, 0.09106907993555069, 0.08948702365159988, 0.09098787605762482, 0.09129771590232849], [0.09253868460655212, 0.0925125852227211, 0.09301633387804031, 0.09099876880645752, 0.09097310155630112, 0.09240823984146118, 0.0909217819571495, 0.0923561155796051, 0.07810531556606293, 0.09157153218984604, 0.09459754079580307]], [[0.08990258723497391, 0.09018177539110184, 0.09016557782888412, 0.09106871485710144, 0.091384157538414, 0.09136774390935898, 0.09135133028030396, 0.09100329875946045, 0.0909869521856308, 0.09130211174488068, 0.09128571301698685], [0.0896916389465332, 0.09002894163131714, 0.09000936150550842, 0.0911019816994667, 0.09148414433002472, 0.09146425127983093, 0.09144435822963715, 0.09102276712656021, 0.09100297093391418, 0.09138471633195877, 0.09136484563350677], [0.08970385789871216, 0.09003780037164688, 0.09001842141151428, 0.09110007435083389, 0.0914783626794815, 0.09145867079496384, 0.09143897891044617, 0.09102164953947067, 0.09100205451250076, 0.09137994796037674, 0.09136027097702026], [0.08902813494205475, 0.08954735100269318, 0.08951718360185623, 0.09120617806911469, 0.09179956465959549, 0.09176864475011826, 0.09173773229122162, 0.0910833403468132, 0.09105265885591507, 0.09164504706859589, 0.09161417931318283], [0.08879457414150238, 0.0893775001168251, 0.08934362232685089, 0.09124269336462021, 0.0919109359383583, 0.09187609702348709, 0.09184127300977707, 0.0911044254899025, 0.09106989204883575, 0.09173687547445297, 0.09170210361480713], [0.08880669623613358, 0.08938631415367126, 0.08935262262821198, 0.0912407860159874, 0.0919051468372345, 0.09187051653862, 0.0918358862400055, 0.09110333025455475, 0.09106899797916412, 0.09173209965229034, 0.09169752895832062], [0.08881882578134537, 0.08939513564109802, 0.08936164528131485, 0.09123890101909637, 0.09189936518669128, 0.0918649360537529, 0.09183051437139511, 0.0911022424697876, 0.09106811136007309, 0.09172733873128891, 0.0916929766535759], [0.08907672762870789, 0.0895826667547226, 0.08955327421426773, 0.09119856357574463, 0.09177641570568085, 0.09174630790948868, 0.0917162075638771, 0.09107893705368042, 0.09104906022548676, 0.09162595868110657, 0.09159589558839798], [0.08908887207508087, 0.08959148824214935, 0.08956228941679001, 0.09119665622711182, 0.09177061915397644, 0.09174071252346039, 0.09171081334352493, 0.09107782691717148, 0.09104814380407333, 0.09162117540836334, 0.09159131348133087], [0.08885519951581955, 0.0894216001033783, 0.08938869088888168, 0.09123321622610092, 0.09188200533390045, 0.09184818714857101, 0.09181437641382217, 0.09109896421432495, 0.0910654291510582, 0.09171302616596222, 0.09167926758527756], [0.08886732906103134, 0.08943042904138565, 0.08939770609140396, 0.0912313237786293, 0.09187622368335724, 0.09184260666370392, 0.09180900454521179, 0.0910978764295578, 0.09106454253196716, 0.09170826524496078, 0.09167470782995224]], [[0.09196221828460693, 0.09194791316986084, 0.09164455533027649, 0.09082892537117004, 0.09110123664140701, 0.09189072996377945, 0.09107290953397751, 0.0915733203291893, 0.0837552472949028, 0.09143111854791641, 0.09279189258813858], [0.09194770455360413, 0.09193360060453415, 0.09163456410169601, 0.09083046764135361, 0.09109894186258316, 0.09187723696231842, 0.09107100963592529, 0.09156433492898941, 0.08385244011878967, 0.09142415225505829, 0.09276550263166428], [0.0916372612118721, 0.09162747859954834, 0.09141987562179565, 0.09086061269044876, 0.0910475105047226, 0.09158836305141449, 0.09102807193994522, 0.091371089220047, 0.0859420895576477, 0.09127368032932281, 0.09220394492149353], [0.09077523648738861, 0.09077698737382889, 0.09081412851810455, 0.09091469645500183, 0.09088100492954254, 0.0907839760184288, 0.0908844992518425, 0.09082287549972534, 0.09183184057474136, 0.09084034711122513, 0.09067436307668686], [0.09106755256652832, 0.09106546640396118, 0.0910210832953453, 0.09090113639831543, 0.09094128757715225, 0.09105710685253143, 0.09093710780143738, 0.09101064503192902, 0.08982043713331223, 0.09098978340625763, 0.09118828922510147], [0.09188960492610931, 0.091876320540905, 0.09159452468156815, 0.0908365547657013, 0.09108967334032059, 0.09182320535182953, 0.09106333553791046, 0.09152834117412567, 0.08424229174852371, 0.09139622747898102, 0.09265995025634766], [0.09103736281394958, 0.09103567898273468, 0.0909997895359993, 0.09090276807546616, 0.09093524515628815, 0.09102892130613327, 0.09093187004327774, 0.09099134802818298, 0.0900275856256485, 0.09097447246313095, 0.09113498032093048], [0.09156357496976852, 0.09155480563640594, 0.0913686454296112, 0.09086693078279495, 0.09103462845087051, 0.09151973575353622, 0.09101718664169312, 0.09132488816976547, 0.08644060045480728, 0.09123752266168594, 0.09207150340080261], [0.08129725605249405, 0.08139178901910782, 0.08342655748128891, 0.0891895517706871, 0.08721669763326645, 0.08177101612091064, 0.08741963654756546, 0.08391273021697998, 0.16346140205860138, 0.08489276468753815, 0.07602056860923767], [0.09141557663679123, 0.09140881896018982, 0.09126542508602142, 0.09087862819433212, 0.09100797027349472, 0.09138181060552597, 0.09099452197551727, 0.09123171120882034, 0.08744458854198456, 0.09116438031196594, 0.09180647879838943], [0.09278362989425659, 0.0927574560046196, 0.0922030657529831, 0.09071990847587585, 0.0912138968706131, 0.0926528349518776, 0.09116243571043015, 0.09207309782505035, 0.07831204682588577, 0.09181390702724457, 0.09430765360593796]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1825158456768009e-05, "add_observations_from_episodes_to_batch": 2.840905146915745e-06, "batch_individual_items": 1.2415361383078912e-05, "add_time_dim_to_batch_and_zero_pad": 7.137587719646114e-06, "add_states_from_episodes_to_batch": 2.724277515201307e-06}}, "connector_pipeline_timer": 5.873146090264796e-05}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.86677153237762e-06, "tensor_to_numpy": 1.4970331901842717e-05, "remove_single_ts_time_rank_from_batch": 1.1836367798325118e-05, "get_actions": 3.4820579002494925e-05, "listify_data_for_vector_env": 1.0345884039952228e-05, "un_batch_to_individual_items": 6.449177317054335e-06}}, "connector_pipeline_timer": 0.00011192335644535325}, "rlmodule_inference_timer": 3.081213633699942e-05, "episode_return_mean": 0.5, "module_episode_returns_mean": {"default_policy": 0.5}, "weights_seq_no": 12.0, "episode_return_max": 15.5, "num_episodes_lifetime": 240, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.3903739426732397e-05, "episode_len_min": 20, "env_reset_timer": 0.0006727756966878417, "num_env_steps_sampled_lifetime": 60400, "num_env_steps_sampled": 400, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "episode_duration_sec_mean": 0.0052758179255761204, "episode_return_min": -13.5, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "sample": 0.13268709991254157, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "agent_episode_returns_mean": {"default_agent": 0.5}, "time_between_sampling": 9.534554225238903}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "ba99e_00000", "date": "2025-08-11_18-54-36", "timestamp": 1754931276, "time_this_iter_s": 9.490283966064453, "time_total_s": 115.67890667915344, "pid": 11884, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1619f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 115.67890667915344, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 36.49230769230768, "ram_util_percent": 79.20769230769231}}
{"timers": {"training_iteration": 10.117410358282859, "restore_env_runners": 9.118214651274716e-06, "training_step": 10.11720928068117, "env_runner_sampling_timer": 1.6545850521653496, "learner_update_timer": 8.286604298258906, "synch_weights": 0.0016539041218124814, "restore_eval_env_runners": 6.619350800995831e-05, "evaluation_iteration": 0.14500861826060263, "synch_eval_env_connectors": 0.00017966785070644165, "synch_env_connectors": 5.461202740593826e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2510694724127347e-05, "add_observations_from_episodes_to_batch": 2.801452042829819e-06, "batch_individual_items": 1.2446009747710503e-05, "add_time_dim_to_batch_and_zero_pad": 7.103338738980362e-06, "add_states_from_episodes_to_batch": 2.763495175238418e-06}}, "connector_pipeline_timer": 5.993351575006198e-05}, "module_to_env_connector": {"connector_pipeline_timer": 0.00011911909210998232, "timers": {"connectors": {"get_actions": 4.015207122209041e-05, "normalize_and_clip_actions": 7.994067262230238e-06, "un_batch_to_individual_items": 6.550193048810239e-06, "listify_data_for_vector_env": 1.05405151492429e-05, "tensor_to_numpy": 1.5503745969700735e-05, "remove_single_ts_time_rank_from_batch": 1.1895919428542624e-05}}}, "weights_seq_no": 12.0, "episode_return_max": 14.5, "episode_duration_sec_mean": 0.005309636806603523, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "env_reset_timer": 3.603470480331878e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -339125.0, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "episode_return_min": -5.5, "agent_episode_returns_mean": {"default_agent": 5.380000000000001}, "num_env_steps_sampled_lifetime": -6782500.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "env_step_timer": 1.3834022242190233e-05, "time_between_sampling": 0.0320947842075359, "num_episodes": 250.0, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 5.380000000000001}, "sample": 0.005941739488118221, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 3.2283707258449434e-05, "episode_return_mean": 5.380000000000001, "episode_len_max": 20, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3231.391951455983}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13516518253065, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009303054429348917, "add_observations_from_episodes_to_batch": 0.0008376132197468925, "add_columns_from_episodes_to_train_batch": 0.04163515497983531, "add_time_dim_to_batch_and_zero_pad": 0.07566343058711301, "add_states_from_episodes_to_batch": 0.00350257826752994, "batch_individual_items": 0.003987073901309516, "numpy_to_tensor": 7.407685057328322e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 466830, "module_train_batch_size_mean": 997.5020416990191, "vf_explained_var": 0.0015203356742858887, "total_loss": 0.27810513973236084, "weights_seq_no": 78.0, "vf_loss_unclipped": 52.133636474609375, "diff_num_grad_updates_vs_sampler_policy": 66.0, "entropy": 0.6896958947181702, "vf_loss": 0.3589073121547699, "policy_loss": -0.00044140900718048215, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 2.2914287910680287e-05}, "__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 933660, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 2574000, "num_env_steps_trained_lifetime_throughput": 47160.3456252792}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 66.0, "num_module_steps_trained": 35910, "total_loss": 0.0, "num_module_steps_trained_lifetime": 466830, "module_train_batch_size_mean": 997.5020416990191, "weights_seq_no": 78.0}}}, "intrinsic_reward_module": {"total_loss": 0.0, "weights_seq_no": 13.0, "num_trainable_parameters": 8266, "num_module_steps_trained_lifetime": 77805, "module_train_batch_size_mean": 997.7269395717314, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 715.1939230007556}, "default_policy": {"use_intrinsic_rewards": 0.0, "num_trainable_parameters": 16595, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 77805, "module_train_batch_size_mean": 997.7269395717314, "vf_explained_var": -0.0001112222671508789, "total_loss": 0.27761244773864746, "weights_seq_no": 13.0, "mean_kl_loss": 2.5240855393349193e-05, "vf_loss_unclipped": 52.54269790649414, "curr_kl_coeff": 1.9724600861081854e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.6896681785583496, "vf_loss": 0.3583053648471832, "curr_entropy_coeff": 0.0015431216992, "policy_loss": -0.0004614829085767269, "num_module_steps_trained_lifetime_throughput": 715.1866251352214}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 155610, "num_env_steps_trained_lifetime": 429000, "num_env_steps_trained": 33000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 3944.568056200309, "num_module_steps_trained_throughput": 23706987.611325387, "num_module_steps_trained_lifetime_throughput": 12726251.195568237}, "IntrinsicAttentionMask": [[[0.08990263193845749, 0.09018182009458542, 0.0901656225323677, 0.09106875956058502, 0.09105240553617477, 0.09103604406118393, 0.09135137498378754, 0.09133496135473251, 0.09131855517625809, 0.09130215644836426, 0.09128575026988983], [0.08969167619943619, 0.09002897888422012, 0.090009406208992, 0.09110202640295029, 0.09108221530914307, 0.09106241166591644, 0.09144440293312073, 0.09142451733350754, 0.09140463918447495, 0.09138476103544235, 0.09136488288640976], [0.08970389515161514, 0.09003783762454987, 0.09001845866441727, 0.09110010415315628, 0.09108049422502518, 0.09106088429689407, 0.09143901616334915, 0.09141933172941208, 0.091399647295475, 0.09137997776269913, 0.09136030822992325], [0.0890282541513443, 0.08954747021198273, 0.08951730281114578, 0.09120629727840424, 0.09117557108402252, 0.091144859790802, 0.09173785150051117, 0.09170695394277573, 0.09167605638504028, 0.09164517372846603, 0.09161429852247238], [0.08904039859771729, 0.08955629169940948, 0.08952631801366806, 0.09120438992977142, 0.09117387235164642, 0.09114335477352142, 0.0917324647307396, 0.09170176088809967, 0.09167107194662094, 0.0916403979063034, 0.09160972386598587], [0.08905252814292908, 0.08956510573625565, 0.08953533321619034, 0.09120247513055801, 0.09117215871810913, 0.09114184230566025, 0.09172707051038742, 0.09169657528400421, 0.0916660875082016, 0.09163560718297958, 0.09160514175891876], [0.08881895989179611, 0.08939526975154877, 0.0893617793917656, 0.09123903512954712, 0.09120485931634903, 0.09117068350315094, 0.09183065593242645, 0.09179624915122986, 0.09176185727119446, 0.09172748029232025, 0.09169311076402664], [0.08883108198642731, 0.08940409123897552, 0.08937079459428787, 0.0912371501326561, 0.09120316058397293, 0.09116919338703156, 0.09182527661323547, 0.091791070997715, 0.09175688028335571, 0.09172271192073822, 0.09168854355812073], [0.0888432040810585, 0.08941291272640228, 0.08937980979681015, 0.09123525023460388, 0.09120146930217743, 0.09116769582033157, 0.0918198972940445, 0.09178590029478073, 0.09175191074609756, 0.09171793609857559, 0.09168397635221481], [0.0888553336262703, 0.08942173421382904, 0.08938882499933243, 0.09123335033655167, 0.09119977056980133, 0.09116620570421219, 0.09181451797485352, 0.09178072214126587, 0.09174693375825882, 0.09171316772699356, 0.0916794091463089], [0.08886745572090149, 0.0894305482506752, 0.08939782530069351, 0.09123145043849945, 0.09119807183742523, 0.09116470068693161, 0.09180913120508194, 0.09177553653717041, 0.09174195677042007, 0.09170839190483093, 0.09167483448982239]], [[0.09193338453769684, 0.09191908687353134, 0.09190479665994644, 0.09108684211969376, 0.091072678565979, 0.09186191856861115, 0.0910443514585495, 0.09183334559202194, 0.08346571773290634, 0.0911150649189949, 0.09276279807090759], [0.09191932529211044, 0.09190522879362106, 0.09189113974571228, 0.0910847932100296, 0.09107082337141037, 0.09184887260198593, 0.0910428985953331, 0.09182070940732956, 0.08356670290231705, 0.09111261367797852, 0.0927368700504303], [0.09190525859594345, 0.09189137071371078, 0.09187748283147812, 0.09108272939920425, 0.09106896072626114, 0.09183582663536072, 0.0910414382815361, 0.09180807322263718, 0.08366779237985611, 0.09111015498638153, 0.092710942029953], [0.09107837080955505, 0.0910760834813118, 0.09107378870248795, 0.09094230830669403, 0.09094002842903137, 0.09106692671775818, 0.09093545377254486, 0.09106234461069107, 0.08966716378927231, 0.09094686061143875, 0.09121066331863403], [0.09106366336345673, 0.09106157720088959, 0.09105948358774185, 0.0909394845366478, 0.09093739837408066, 0.09105321764945984, 0.09093322604894638, 0.09104904532432556, 0.08977488428354263, 0.09094364196062088, 0.09118439257144928], [0.0918629840016365, 0.09184969961643219, 0.09183642268180847, 0.09107644855976105, 0.09106328338384628, 0.09179659932851791, 0.09103696048259735, 0.09177006781101227, 0.08397172391414642, 0.09110267460346222, 0.09263310581445694], [0.09103422611951828, 0.09103253483772278, 0.09103084355592728, 0.09093379229307175, 0.09093210846185684, 0.09102577716112137, 0.09092873334884644, 0.09102240204811096, 0.08999066054821014, 0.09093715995550156, 0.09113183617591858], [0.09183475375175476, 0.09182188659906387, 0.09180901199579239, 0.0910722091794014, 0.09105944633483887, 0.09177041053771973, 0.0910339206457138, 0.09174468368291855, 0.08417490124702454, 0.0910976454615593, 0.09258119761943817], [0.08085928112268448, 0.08095689862966537, 0.08105462789535522, 0.08687514811754227, 0.08698003739118576, 0.08134853839874268, 0.0871901661157608, 0.08154506981372833, 0.17110610008239746, 0.08666662871837616, 0.07541745156049728], [0.09110762923955917, 0.09110493957996368, 0.0911022499203682, 0.09094790369272232, 0.09094522148370743, 0.09109418839216232, 0.09093984961509705, 0.09108881652355194, 0.08945296704769135, 0.09095324575901031, 0.09126297384500504], [0.0927274078130722, 0.0927012488245964, 0.0926750972867012, 0.0911843478679657, 0.09115862101316452, 0.09259669482707977, 0.09110719710588455, 0.09254445880651474, 0.07781877368688583, 0.09123560041189194, 0.09425050765275955]], [[0.08981376141309738, 0.09042097628116608, 0.09040473401546478, 0.09131027013063431, 0.09129386395215988, 0.09127746522426605, 0.09126106649637222, 0.09091338515281677, 0.09089705348014832, 0.09121190011501312, 0.09119551628828049], [0.08931602537631989, 0.0901976227760315, 0.09017400443553925, 0.09149366617202759, 0.09146971255540848, 0.09144575893878937, 0.09142182022333145, 0.0909145325422287, 0.09089072793722153, 0.0913500189781189, 0.09132610261440277], [0.08932927250862122, 0.09020358324050903, 0.0901801660656929, 0.0914887860417366, 0.09146503359079361, 0.09144128113985062, 0.09141754359006882, 0.0909145176410675, 0.09089091420173645, 0.09134635329246521, 0.0913226306438446], [0.08859708905220032, 0.0898732990026474, 0.08983904123306274, 0.09175980091094971, 0.09172482043504715, 0.09168984740972519, 0.09165489673614502, 0.09091530740261078, 0.09088064730167389, 0.09155010432004929, 0.0915152058005333], [0.08861023187637329, 0.08987923711538315, 0.08984517306089401, 0.09175490587949753, 0.09172012656927109, 0.09168536216020584, 0.09165060520172119, 0.09091529250144958, 0.09088083356618881, 0.0915464237332344, 0.09151172637939453], [0.08862338960170746, 0.08988519757986069, 0.08985131978988647, 0.09175002574920654, 0.09171544760465622, 0.09168088436126709, 0.09164633601903915, 0.09091529250144958, 0.09088102728128433, 0.09154275804758072, 0.09150826185941696], [0.08863654732704163, 0.08989115059375763, 0.08985746651887894, 0.09174514561891556, 0.09171076864004135, 0.09167641401290894, 0.09164206683635712, 0.09091528505086899, 0.09088122099637985, 0.09153909236192703, 0.09150480479001999], [0.08891648054122925, 0.09001763164997101, 0.0899880975484848, 0.0916413813829422, 0.09161131083965302, 0.09158125519752502, 0.09155120700597763, 0.09091508388519287, 0.09088526666164398, 0.09146112948656082, 0.09143111854791641], [0.0889296680688858, 0.09002358466386795, 0.08999424427747726, 0.09163649380207062, 0.09160662442445755, 0.09157676994800568, 0.091546930372715, 0.09091506898403168, 0.09088544547557831, 0.09145744889974594, 0.09142764657735825], [0.08867604285478592, 0.08990901708602905, 0.08987592160701752, 0.0917305052280426, 0.09169673919677734, 0.09166298806667328, 0.09162924438714981, 0.09091527760028839, 0.09088180959224701, 0.09152810275554657, 0.09149441123008728], [0.08868919312953949, 0.0899149626493454, 0.08988206088542938, 0.09172561764717102, 0.09169205278158188, 0.09165851026773453, 0.09162496775388718, 0.0909152626991272, 0.09088199585676193, 0.09152442961931229, 0.09149093925952911]], [[0.09203950315713882, 0.0917358472943306, 0.09172157943248749, 0.09119198471307755, 0.0911778062582016, 0.09196796268224716, 0.09086285531520844, 0.09165027737617493, 0.08356206119060516, 0.09122023731470108, 0.09286987781524658], [0.091706283390522, 0.09149423241615295, 0.09148425608873367, 0.09111392498016357, 0.09110399335622787, 0.09165633469820023, 0.09088344126939774, 0.09143444150686264, 0.08570428192615509, 0.09113369137048721, 0.09228506684303284], [0.09169048070907593, 0.0914827287197113, 0.09147296100854874, 0.09111011028289795, 0.09110037982463837, 0.09164155274629593, 0.090884268283844, 0.09142415225505829, 0.08580631762742996, 0.09112948179244995, 0.09225749224424362], [0.09109524637460709, 0.09104660898447037, 0.09104432165622711, 0.09095915406942368, 0.09095687419176102, 0.09108379483222961, 0.09090602397918701, 0.09103287756443024, 0.08968377858400345, 0.09096371382474899, 0.09122756123542786], [0.09107905626296997, 0.0910346731543541, 0.09103257954120636, 0.09095486253499985, 0.09095276892185211, 0.09106861054897308, 0.09090635925531387, 0.09102214127779007, 0.08979006111621857, 0.09095901995897293, 0.09119980782270432], [0.09196149557828903, 0.09167943894863129, 0.09166618436574936, 0.09117411822080612, 0.09116093814373016, 0.09189504384994507, 0.09086820483207703, 0.0915999561548233, 0.08406176418066025, 0.09120037406682968, 0.09273244440555573], [0.09071635454893112, 0.09076615422964096, 0.09076850116252899, 0.09085583686828613, 0.09085818380117416, 0.09072806686162949, 0.0909104123711586, 0.09078022837638855, 0.09218396246433258, 0.09085115790367126, 0.09058112651109695], [0.09161137044429779, 0.0914250910282135, 0.09141632914543152, 0.0910908654332161, 0.0910821408033371, 0.0915675014257431, 0.09088823199272156, 0.09137255698442459, 0.08631812036037445, 0.09110824763774872, 0.09211955964565277], [0.08020327240228653, 0.08228590339422226, 0.08238524198532104, 0.08617033064365387, 0.08627436310052872, 0.08068856596946716, 0.08862150460481644, 0.08288373798131943, 0.16971799731254578, 0.08596350997686386, 0.07480558753013611], [0.0911274403333664, 0.09107033908367157, 0.09106764942407608, 0.09096767753362656, 0.09096499532461166, 0.09111399948596954, 0.09090530872344971, 0.09105422347784042, 0.08947242051362991, 0.09097302705049515, 0.09128282219171524], [0.09292273968458176, 0.09236737340688705, 0.09234131127595901, 0.09137643128633499, 0.09135065227746964, 0.09279175102710724, 0.09077906608581543, 0.09221114218235016, 0.07798269391059875, 0.09142778813838959, 0.09444905072450638]], [[0.08990311622619629, 0.09051093459129333, 0.09049467742443085, 0.0914011150598526, 0.09138469398021698, 0.09103653579950333, 0.09102018177509308, 0.09100383520126343, 0.09098748862743378, 0.09097114205360413, 0.09128624200820923], [0.08944573998451233, 0.09032861888408661, 0.09030497074127197, 0.09162654727697372, 0.09160255640745163, 0.09109427034854889, 0.09107042104005814, 0.09104657173156738, 0.09102272987365723, 0.09099890291690826, 0.09145873785018921], [0.0894579067826271, 0.0903334841132164, 0.09031002968549728, 0.091620534658432, 0.09159674495458603, 0.09109273552894592, 0.09106907993555069, 0.09104543924331665, 0.09102179855108261, 0.09099816530942917, 0.09145414084196091], [0.08878479152917862, 0.09006370604038239, 0.09002937376499176, 0.09195420145988464, 0.09191914647817612, 0.09117742627859116, 0.0911426693201065, 0.09110791981220245, 0.0910731852054596, 0.09103846549987793, 0.09170909225940704], [0.08879689127206802, 0.09006857126951218, 0.09003443270921707, 0.09194818884134293, 0.09191333502531052, 0.09117590636014938, 0.09114135056734085, 0.09110680222511292, 0.09107227623462677, 0.09103775024414062, 0.09170449525117874], [0.08905421197414398, 0.09017189592123032, 0.09014192223548889, 0.0918203592300415, 0.09178983420133591, 0.09114356338977814, 0.09111325442790985, 0.09108296781778336, 0.09105268120765686, 0.09102240949869156, 0.09160687029361725], [0.08906634151935577, 0.09017676115036011, 0.0901469811797142, 0.09181434661149979, 0.0917840227484703, 0.09114203602075577, 0.0911119356751442, 0.09108184278011322, 0.09105176478624344, 0.09102168679237366, 0.09160228073596954], [0.08907847106456757, 0.0901816263794899, 0.09015204012393951, 0.09180833399295807, 0.0917782112956047, 0.091140516102314, 0.09111060947179794, 0.09108072519302368, 0.09105084091424942, 0.09102096408605576, 0.09159768372774124], [0.08909060060977936, 0.09018649160861969, 0.09015709906816483, 0.09180232137441635, 0.0917723998427391, 0.09113898873329163, 0.09110929071903229, 0.09107959270477295, 0.0910499170422554, 0.09102024137973785, 0.09159309417009354], [0.08910273760557175, 0.09019135683774948, 0.09016216546297073, 0.09179630875587463, 0.0917665958404541, 0.09113746881484985, 0.09110796451568604, 0.09107847511768341, 0.09104899317026138, 0.09101951867341995, 0.09158850461244583], [0.08886948227882385, 0.09009774774312973, 0.09006477892398834, 0.09191208332777023, 0.09187845140695572, 0.09116678684949875, 0.09113343060016632, 0.09110008180141449, 0.09106674790382385, 0.09103342890739441, 0.09167692810297012]], [[0.0919862911105156, 0.0919719859957695, 0.09195768088102341, 0.09085270017385483, 0.09112508594989777, 0.09191478788852692, 0.09109674394130707, 0.0915972888469696, 0.08351375162601471, 0.09116749465465546, 0.09281618148088455], [0.0919714868068695, 0.09195738285779953, 0.09194327890872955, 0.09085395187139511, 0.09112250059843063, 0.09190099686384201, 0.09109456092119217, 0.09158801287412643, 0.08361411839723587, 0.09116431325674057, 0.09278949350118637], [0.09195664525032043, 0.09194274991750717, 0.09192885458469391, 0.0908551812171936, 0.09111988544464111, 0.09188717603683472, 0.09109234809875488, 0.09157871454954147, 0.0837145745754242, 0.0911611020565033, 0.0927627831697464], [0.09077198803424835, 0.09077373147010803, 0.09077548235654831, 0.09091144055128098, 0.09087774902582169, 0.09078072756528854, 0.09088125079870224, 0.09081961959600449, 0.09186436235904694, 0.09087251871824265, 0.090671107172966], [0.09107135981321335, 0.09106927365064621, 0.09106718748807907, 0.09090492874383926, 0.09094507992267609, 0.09106091409921646, 0.09094090759754181, 0.09101444482803345, 0.0897824689745903, 0.09095132350921631, 0.0911920964717865], [0.09191210567951202, 0.09189882129430771, 0.0918855369091034, 0.09085880219936371, 0.09111198037862778, 0.09184569120407104, 0.09108564257621765, 0.09155075997114182, 0.08401662111282349, 0.0911514014005661, 0.09268264472484589], [0.09104043990373611, 0.09103874862194061, 0.09103705734014511, 0.09090583771467209, 0.09093832224607468, 0.0910319909453392, 0.09093493968248367, 0.09099441766738892, 0.0899968072772026, 0.0909433662891388, 0.09113805741071701], [0.09157886356115341, 0.09157009422779083, 0.09156131744384766, 0.09088210016489029, 0.09104982763528824, 0.09153500944375992, 0.09103237837553024, 0.09134013205766678, 0.0862874984741211, 0.09107592701911926, 0.09208687394857407], [0.08052389323711395, 0.08062110096216202, 0.08071842789649963, 0.08865431696176529, 0.08661925047636032, 0.08101111650466919, 0.08682851493358612, 0.08321507275104523, 0.17039649188518524, 0.08630715310573578, 0.07510463148355484], [0.09111752361059189, 0.091114841401577, 0.0911121517419815, 0.09090346843004227, 0.09095510095357895, 0.09110409021377563, 0.09094972908496857, 0.09104431420564651, 0.08946269005537033, 0.09096313267946243, 0.09127289056777954], [0.0928245559334755, 0.09279836714267731, 0.09277219325304031, 0.09075992554426193, 0.09125412255525589, 0.09269370138645172, 0.09120264649391174, 0.09211371093988419, 0.07790029048919678, 0.09133118391036987, 0.09434925019741058]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3879154999228778e-05, "add_observations_from_episodes_to_batch": 2.9830844698590686e-06, "batch_individual_items": 1.2759229921888792e-05, "add_time_dim_to_batch_and_zero_pad": 7.360643380542708e-06, "add_states_from_episodes_to_batch": 2.8093069878711784e-06}}, "connector_pipeline_timer": 6.235807629329739e-05}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.589561437165186e-06, "tensor_to_numpy": 1.6394806433877368e-05, "remove_single_ts_time_rank_from_batch": 1.2175553245916223e-05, "get_actions": 3.9388116778082894e-05, "listify_data_for_vector_env": 1.095853776319007e-05, "un_batch_to_individual_items": 7.1599435009484004e-06}}, "connector_pipeline_timer": 0.00012221830487555379}, "rlmodule_inference_timer": 3.357255141432973e-05, "episode_return_mean": -0.5, "module_episode_returns_mean": {"default_policy": -0.5}, "weights_seq_no": 13.0, "episode_return_max": 15.5, "num_episodes_lifetime": 260, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.5896125813855734e-05, "episode_len_min": 20, "env_reset_timer": 0.0006669133607460458, "num_env_steps_sampled_lifetime": 65400, "num_env_steps_sampled": 400, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "episode_duration_sec_mean": 0.005311696267453953, "episode_return_min": -13.5, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "sample": 0.132515374753437, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "agent_episode_returns_mean": {"default_agent": -0.5}, "time_between_sampling": 9.532121689236096}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "ba99e_00000", "date": "2025-08-11_18-54-45", "timestamp": 1754931285, "time_this_iter_s": 9.390938758850098, "time_total_s": 125.06984543800354, "pid": 11884, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1619f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 125.06984543800354, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 35.98461538461539, "ram_util_percent": 79.24615384615385}}
{"timers": {"training_iteration": 10.105617145949779, "restore_env_runners": 9.089532398591195e-06, "training_step": 10.105415388294537, "env_runner_sampling_timer": 1.6541434274743367, "learner_update_timer": 8.275226683606366, "synch_weights": 0.001645217170651342, "restore_eval_env_runners": 6.561740245418207e-05, "evaluation_iteration": 0.1447660120790271, "synch_eval_env_connectors": 0.00017902408202586452, "synch_env_connectors": 5.455340793356135e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.24423785835903e-05, "add_observations_from_episodes_to_batch": 2.7936902612809957e-06, "batch_individual_items": 1.2314698428957656e-05, "add_time_dim_to_batch_and_zero_pad": 6.982452561483262e-06, "add_states_from_episodes_to_batch": 2.7431940982206002e-06}}, "connector_pipeline_timer": 5.946014447928342e-05}, "module_to_env_connector": {"connector_pipeline_timer": 0.00011782875879070106, "timers": {"connectors": {"get_actions": 3.961742294701402e-05, "normalize_and_clip_actions": 7.867204395128994e-06, "un_batch_to_individual_items": 6.4989673033414225e-06, "listify_data_for_vector_env": 1.0327690754632143e-05, "tensor_to_numpy": 1.542044615781967e-05, "remove_single_ts_time_rank_from_batch": 1.1749824548518299e-05}}}, "weights_seq_no": 13.0, "episode_return_max": 14.5, "episode_duration_sec_mean": 0.005604818217922004, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "env_reset_timer": 3.6168605496738696e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -370000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "episode_return_min": -5.5, "agent_episode_returns_mean": {"default_agent": 4.899999999999999}, "num_env_steps_sampled_lifetime": -7400000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "env_step_timer": 1.3599549205952417e-05, "time_between_sampling": 0.031640873640035226, "num_episodes": 250.0, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 4.899999999999999}, "sample": 0.005837024831596811, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 5.093082377602367e-05, "episode_return_mean": 4.899999999999999, "episode_len_max": 20, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3261.6882049671703}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1351242069554846, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009303569305150753, "add_observations_from_episodes_to_batch": 0.000837467507611742, "add_columns_from_episodes_to_train_batch": 0.041624834260964146, "add_time_dim_to_batch_and_zero_pad": 0.07563550503134456, "add_states_from_episodes_to_batch": 0.003501585405230107, "batch_individual_items": 0.003985644832190802, "numpy_to_tensor": 7.40331723580372e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 502740, "module_train_batch_size_mean": 997.5006590853257, "vf_explained_var": 0.0013970732688903809, "total_loss": 0.2782585918903351, "weights_seq_no": 84.0, "vf_loss_unclipped": 48.8327751159668, "diff_num_grad_updates_vs_sampler_policy": 71.0, "entropy": 0.6889500617980957, "vf_loss": 0.35885176062583923, "policy_loss": -0.0002444230194669217, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 1.4426041161641479e-05}, "__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1005480, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 2772000, "num_env_steps_trained_lifetime_throughput": 46473.73095700869}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 71.0, "num_module_steps_trained": 35910, "total_loss": 0.0, "num_module_steps_trained_lifetime": 502740, "module_train_batch_size_mean": 997.5006590853257, "weights_seq_no": 84.0}}}, "intrinsic_reward_module": {"total_loss": 0.0, "weights_seq_no": 14.0, "num_trainable_parameters": 8266, "num_module_steps_trained_lifetime": 83790, "module_train_batch_size_mean": 997.7135120670981, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 715.7470122494534}, "default_policy": {"use_intrinsic_rewards": 0.0, "num_trainable_parameters": 16595, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 83790, "module_train_batch_size_mean": 997.7135120670981, "vf_explained_var": -0.00019025802612304688, "total_loss": 0.27782198786735535, "weights_seq_no": 14.0, "mean_kl_loss": 1.5691448425059207e-05, "vf_loss_unclipped": 49.01961898803711, "curr_kl_coeff": 9.862300430540927e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.6889288425445557, "vf_loss": 0.35830652713775635, "curr_entropy_coeff": 0.0015431216992, "policy_loss": -0.0002539878769312054, "num_module_steps_trained_lifetime_throughput": 715.7401858365396}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 167580, "num_env_steps_trained_lifetime": 462000, "num_env_steps_trained": 33000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 3947.5745943474417, "num_module_steps_trained_throughput": 23135594.87606152, "num_module_steps_trained_lifetime_throughput": 12715213.581116315}, "IntrinsicAttentionMask": [[[0.09093794971704483, 0.0902336984872818, 0.09046891331672668, 0.09115034341812134, 0.09113801270723343, 0.09087646752595901, 0.0911133661866188, 0.09110104292631149, 0.09108871966600418, 0.09107640385627747, 0.09081503003835678], [0.09091109782457352, 0.09086280316114426, 0.09087897092103958, 0.09092559665441513, 0.09092475473880768, 0.09090689569711685, 0.09092307835817337, 0.09092223644256592, 0.09092139452695847, 0.09092055261135101, 0.09090269356966019], [0.09092017263174057, 0.0906517282128334, 0.09074153006076813, 0.09100087732076645, 0.09099619835615158, 0.09089679270982742, 0.09098683297634125, 0.09098215401172638, 0.09097747504711151, 0.09097278863191605, 0.09087341278791428], [0.09094586223363876, 0.09004563093185425, 0.0903460904955864, 0.09121774882078171, 0.09120196849107742, 0.09086719900369644, 0.09117040038108826, 0.09115462750196457, 0.09113884717226028, 0.0911230742931366, 0.09078860282897949], [0.09094540029764175, 0.09005651623010635, 0.09035320580005646, 0.09121383726596832, 0.09119825065135956, 0.09086773544549942, 0.09116709232330322, 0.09115151315927505, 0.09113594144582748, 0.09112036973237991, 0.09079013019800186], [0.09093564003705978, 0.09028827399015427, 0.09050454199314117, 0.0911308005452156, 0.09111947566270828, 0.09087914228439331, 0.09109682589769363, 0.09108550101518631, 0.09107418358325958, 0.09106286615133286, 0.09082268178462982], [0.09094449132680893, 0.09007832407951355, 0.09036745131015778, 0.09120602905750275, 0.09119084477424622, 0.09086881577968597, 0.09116048365831375, 0.09114531427621841, 0.09113012999296188, 0.09111496806144714, 0.09079320728778839], [0.09094403684139252, 0.09008920937776566, 0.09037455916404724, 0.09120211750268936, 0.09118713438510895, 0.09086935222148895, 0.09115717560052872, 0.0911421999335289, 0.09112722426652908, 0.09111225605010986, 0.09079473465681076], [0.09094357490539551, 0.09010011702775955, 0.0903816893696785, 0.09119821339845657, 0.09118343144655228, 0.09086989611387253, 0.09115387499332428, 0.09113910049200058, 0.09112432599067688, 0.09110955148935318, 0.09079626947641373], [0.0909431204199791, 0.09011100977659225, 0.09038880467414856, 0.09119430184364319, 0.09117972105741501, 0.09087042510509491, 0.09115055948495865, 0.09113598614931107, 0.09112141281366348, 0.0911068394780159, 0.0907978042960167], [0.09093333035707474, 0.09034288674592972, 0.09054017812013626, 0.09111125767230988, 0.09110093116760254, 0.0908818170428276, 0.09108028560876846, 0.09106996655464172, 0.09105964750051498, 0.09104932099580765, 0.09083033353090286]], [[0.0902266725897789, 0.08953196555376053, 0.08949939906597137, 0.08829542249441147, 0.08826331049203873, 0.0900627076625824, 0.08819911628961563, 0.08999720215797424, 0.10855217278003693, 0.08835941553115845, 0.08901263773441315], [0.09033196419477463, 0.08972521126270294, 0.08969676494598389, 0.08864372968673706, 0.08861561864614487, 0.09018881618976593, 0.08855941891670227, 0.09013162553310394, 0.10613582283258438, 0.08869975060224533, 0.08927123993635178], [0.09033679217100143, 0.08973418921232224, 0.0897059291601181, 0.08866002410650253, 0.08863210678100586, 0.09019462764263153, 0.0885762870311737, 0.09013782441616058, 0.10602328181266785, 0.08871566504240036, 0.0892833024263382], [0.09050782024860382, 0.09006012976169586, 0.09003911167383194, 0.08926016837358475, 0.08923933655023575, 0.0904022678732872, 0.08919769525527954, 0.09036008268594742, 0.10190705209970474, 0.08930166810750961, 0.08972464501857758], [0.09051219373941422, 0.09006867557764053, 0.09004785120487213, 0.08927612751722336, 0.08925548195838928, 0.09040763229131699, 0.08921422809362411, 0.09036583453416824, 0.10179847478866577, 0.08931723982095718, 0.08973630517721176], [0.09025194495916367, 0.08957789838314056, 0.0895463079214096, 0.08837775141000748, 0.08834658563137054, 0.09009286761283875, 0.08828426152467728, 0.09002932161092758, 0.10797926038503647, 0.08843988180160522, 0.08907392621040344], [0.09052088856697083, 0.0900857225060463, 0.09006530046463013, 0.0893079936504364, 0.08928774297237396, 0.09041830152273178, 0.08924724906682968, 0.09037730097770691, 0.10158161073923111, 0.08934834599494934, 0.08975958824157715], [0.09026195853948593, 0.08959619700908661, 0.08956499397754669, 0.0884106233716011, 0.08837983012199402, 0.0901048555970192, 0.08831826597452164, 0.09004209190607071, 0.10775084048509598, 0.08847200870513916, 0.08909836411476135], [0.08586645871400833, 0.08321155607700348, 0.08308865129947662, 0.07863961905241013, 0.07852345705032349, 0.08523418754339218, 0.07829166948795319, 0.08498258888721466, 0.1820226013660431, 0.0788714736700058, 0.08126768469810486], [0.09049908071756363, 0.0900430753827095, 0.09002166986465454, 0.08922836929559708, 0.08920715749263763, 0.09039156138896942, 0.08916475623846054, 0.09034859389066696, 0.10212362557649612, 0.08927063643932343, 0.08970139920711517], [0.09040763974189758, 0.08986730128526688, 0.08984194695949554, 0.08890318125486374, 0.0888781026005745, 0.0902801975607872, 0.08882796764373779, 0.09022927284240723, 0.10434852540493011, 0.08895315229892731, 0.0894627496600151]], [[0.08993268013000488, 0.09021196514368057, 0.09052444249391556, 0.09109920263290405, 0.09108284115791321, 0.09139832854270935, 0.09138190746307373, 0.09136549383401871, 0.09101741015911102, 0.09100106358528137, 0.09098470956087112], [0.08972806483507156, 0.09006550908088684, 0.09044332802295685, 0.09113898873329163, 0.09111917018890381, 0.0915013998746872, 0.09148150682449341, 0.09146160632371902, 0.09103993326425552, 0.0910201370716095, 0.09100034087896347], [0.0895003154873848, 0.0899023488163948, 0.09035284072160721, 0.09118326008319855, 0.09115958958864212, 0.09161636978387833, 0.09159258008003235, 0.09156879782676697, 0.0910649448633194, 0.09104130417108536, 0.09101766347885132], [0.08908460289239883, 0.08960413932800293, 0.09018711000680923, 0.0912640169262886, 0.0912332758307457, 0.09182684123516083, 0.091795913875103, 0.09176498651504517, 0.09111040085554123, 0.0910797119140625, 0.09104903042316437], [0.08909637480974197, 0.08961259573698044, 0.0901918113231659, 0.09126172959804535, 0.09123118966817856, 0.0918208658695221, 0.09179013222455978, 0.09175941348075867, 0.09110911935567856, 0.09107863157987595, 0.09104814380407333], [0.0888698622584343, 0.08944989740848541, 0.0901012197136879, 0.0913056954741478, 0.0912712886929512, 0.09193586558103561, 0.09190122038125992, 0.09186658263206482, 0.09113378077745438, 0.09109944105148315, 0.09106510877609253], [0.08888163417577744, 0.08945835381746292, 0.09010592848062515, 0.09130342304706573, 0.09126920998096466, 0.09192989766597748, 0.0918954536318779, 0.09186102449893951, 0.0911325141787529, 0.0910983681678772, 0.09106423705816269], [0.08889338374137878, 0.08946680277585983, 0.09011063724756241, 0.09130114316940308, 0.09126713126897812, 0.09192392230033875, 0.09188968688249588, 0.09185545891523361, 0.09113123267889023, 0.09109728783369064, 0.09106335788965225], [0.08914349973201752, 0.08964642882347107, 0.09021063148975372, 0.09125257283449173, 0.0912228375673294, 0.09179696440696716, 0.09176704287528992, 0.09173713624477386, 0.09110397100448608, 0.09107428789138794, 0.0910446047782898], [0.08915528655052185, 0.08965487778186798, 0.09021533280611038, 0.09125028550624847, 0.09122074395418167, 0.09179098904132843, 0.0917612761259079, 0.09173157066106796, 0.09110268950462341, 0.09107319265604019, 0.09104371815919876], [0.08916708081960678, 0.08966334909200668, 0.09022004902362823, 0.09124799817800522, 0.09121866524219513, 0.0917850211262703, 0.09175550937652588, 0.09172600507736206, 0.09110140800476074, 0.09107211232185364, 0.09104283154010773]], [[0.09147831052541733, 0.09167420864105225, 0.09166402369737625, 0.09108031541109085, 0.09107019007205963, 0.09142749011516571, 0.09104994684457779, 0.09161309897899628, 0.08556722849607468, 0.09110047668218613, 0.0922747328877449], [0.09168662130832672, 0.09195762127637863, 0.09194352477788925, 0.09113671630620956, 0.09112273901700974, 0.09161635488271713, 0.09109479933977127, 0.09187305718660355, 0.08361435681581497, 0.09116455167531967, 0.09278973937034607], [0.09167589247226715, 0.09194298833608627, 0.09192909300327301, 0.09113389253616333, 0.09112011641263962, 0.09160663932561874, 0.09109257906675339, 0.09185964614152908, 0.0837148055434227, 0.0911613330245018, 0.0927630215883255], [0.0910404771566391, 0.09108452498912811, 0.09108223766088486, 0.09095074236392975, 0.09094845503568649, 0.09102902561426163, 0.09094388037919998, 0.09107079356908798, 0.08967548608779907, 0.09095529466867447, 0.09121911972761154], [0.09102906286716461, 0.09106927365064621, 0.09106718748807907, 0.09094716608524323, 0.09094507992267609, 0.09101862460374832, 0.09094090759754181, 0.09105673432350159, 0.0897824689745903, 0.09095132350921631, 0.0911920964717865], [0.09142351150512695, 0.0915999636054039, 0.09159079194068909, 0.09106490015983582, 0.09105577319860458, 0.09137772023677826, 0.09103753417730331, 0.09154491871595383, 0.08608122169971466, 0.09108307212591171, 0.09214064478874207], [0.09100624173879623, 0.09103874862194061, 0.09103705734014511, 0.09094000607728958, 0.09093832224607468, 0.09099780023097992, 0.09093493968248367, 0.0910286158323288, 0.0899968072772026, 0.0909433662891388, 0.09113805741071701], [0.09162212908267975, 0.09186968952417374, 0.09185680747032166, 0.09111962467432022, 0.0911068543791771, 0.09155793488025665, 0.09108131378889084, 0.09179244190454483, 0.08421873301267624, 0.09114506840705872, 0.09262939542531967], [0.08252789080142975, 0.08063346892595291, 0.08073081076145172, 0.08652807027101517, 0.08663252741098404, 0.08302724361419678, 0.08684182167053223, 0.08121929317712784, 0.17042234539985657, 0.08632039278745651, 0.07511615008115768], [0.09106313437223434, 0.09111485630273819, 0.0911121666431427, 0.09095779806375504, 0.09095511585474014, 0.09104970097541809, 0.09094975143671036, 0.09109872579574585, 0.08946271240711212, 0.09096314758062363, 0.09127290546894073], [0.09229664504528046, 0.09279922395944595, 0.09277304261922836, 0.09128071367740631, 0.09125496447086334, 0.09216654300689697, 0.0912034884095192, 0.09264226257801056, 0.07790102809667587, 0.09133201837539673, 0.09435011446475983]], [[0.08993237465620041, 0.0902116522192955, 0.09019544720649719, 0.09143085777759552, 0.0914144292473793, 0.09139801561832428, 0.09104980528354645, 0.09136518090963364, 0.09101709723472595, 0.0910007432103157, 0.09098440408706665], [0.08972761780023575, 0.09006506204605103, 0.09004548192024231, 0.09154075384140015, 0.09152084589004517, 0.09150094538927078, 0.09107908606529236, 0.09146115183830261, 0.09103947877883911, 0.09101968258619308, 0.09099989384412766], [0.08973947167396545, 0.09007354825735092, 0.09005416184663773, 0.09153438359498978, 0.09151467680931091, 0.09149498492479324, 0.09107739478349686, 0.09145558625459671, 0.09103818237781525, 0.09101858735084534, 0.09099899232387543], [0.08884500712156296, 0.08943164348602295, 0.08939754962921143, 0.0920165628194809, 0.09198148548603058, 0.09194641560316086, 0.09120447933673859, 0.091876320540905, 0.0911349505186081, 0.09110020101070404, 0.09106547385454178], [0.0888567715883255, 0.08944010734558105, 0.08940619975328445, 0.09201019257307053, 0.09197531640529633, 0.09194045513868332, 0.09120281785726547, 0.09187076985836029, 0.09113368391990662, 0.09109914302825928, 0.09106460958719254], [0.08886853605508804, 0.08944856375455856, 0.08941485732793808, 0.09200382232666016, 0.09196915477514267, 0.09193449467420578, 0.09120114147663116, 0.09186521172523499, 0.09113242477178574, 0.09109807759523392, 0.09106374531984329], [0.08911890536546707, 0.08962846547365189, 0.08959886431694031, 0.09186852723360062, 0.09183818846940994, 0.09180784970521927, 0.0911657065153122, 0.0917472168803215, 0.09110549092292786, 0.09107540547847748, 0.0910453200340271], [0.08889207988977432, 0.08946548402309418, 0.08943216502666473, 0.09199108183383942, 0.09195681661367416, 0.0919225737452507, 0.09119781851768494, 0.09185410290956497, 0.09112989157438278, 0.0910959467291832, 0.0910620167851448], [0.08914250135421753, 0.08964541554450989, 0.08961620181798935, 0.09185579419136047, 0.09182585775852203, 0.09179592877626419, 0.09116236120462418, 0.09173610806465149, 0.0911029502749443, 0.09107325971126556, 0.09104357659816742], [0.08915429562330246, 0.08965389430522919, 0.08962487429380417, 0.0918494313955307, 0.09181969612836838, 0.09178997576236725, 0.09116069227457047, 0.09173055738210678, 0.09110168367624283, 0.0910721868276596, 0.09104270488023758], [0.08916610479354858, 0.08966237306594849, 0.08963353931903839, 0.09184306859970093, 0.09181354194879532, 0.09178401529788971, 0.09115902334451675, 0.09172500669956207, 0.09110040962696075, 0.09107112139463425, 0.09104184061288834]], [[0.09198857843875885, 0.09168508648872375, 0.09167083352804184, 0.09085496515035629, 0.09084083884954453, 0.09191707521677017, 0.09109901636838913, 0.09188848733901978, 0.08377926051616669, 0.09145732969045639, 0.0928184911608696], [0.09167037904262543, 0.09145841002464294, 0.09144844859838486, 0.09087756276130676, 0.09086766093969345, 0.09162045270204544, 0.09104849398136139, 0.09160049259662628, 0.08585993945598602, 0.09129920601844788, 0.09224893897771835], [0.09165529161691666, 0.0914476290345192, 0.09143786877393723, 0.09087849408388138, 0.09086879342794418, 0.09160638600587845, 0.09104598313570023, 0.09158682823181152, 0.08595900237560272, 0.0912916362285614, 0.09222208708524704], [0.09077201783657074, 0.090809166431427, 0.09081090986728668, 0.09091147035360336, 0.09091322124004364, 0.09078075736761093, 0.09088128060102463, 0.09078425168991089, 0.0918285921216011, 0.09083712846040726, 0.09067114442586899], [0.0907563716173172, 0.09079773724079132, 0.09079968184232712, 0.09091168642044067, 0.09091363847255707, 0.09076610207557678, 0.09087806195020676, 0.09076999127864838, 0.09193381667137146, 0.09082888066768646, 0.09064403921365738], [0.0919140875339508, 0.091632179915905, 0.09161893278360367, 0.0908607617020607, 0.09084762632846832, 0.09184767305850983, 0.09108760207891464, 0.09182111918926239, 0.08426474779844284, 0.09142057597637177, 0.09268464148044586], [0.0910404771566391, 0.09100458770990372, 0.09100289642810822, 0.09090587496757507, 0.09090419113636017, 0.09103202819824219, 0.09093498438596725, 0.09102865308523178, 0.09003067016601562, 0.09097757935523987, 0.09113809466362], [0.09188423305749893, 0.09161095321178436, 0.09159810841083527, 0.09086300432682037, 0.09085027128458023, 0.09181985259056091, 0.09108296781778336, 0.09179411083459854, 0.08445966243743896, 0.09140580892562866, 0.09263107925653458], [0.08112988620996475, 0.08315811306238174, 0.08325480669736862, 0.08900593221187592, 0.08910942077636719, 0.08160266280174255, 0.08723966032266617, 0.08179254829883575, 0.16312484443187714, 0.08471798151731491, 0.07586406171321869], [0.09142802655696869, 0.09128459542989731, 0.09127785265445709, 0.09089100360870361, 0.09088428318500519, 0.09139425307512283, 0.09100691229104996, 0.09138074517250061, 0.08745650202035904, 0.09117680042982101, 0.09181898087263107], [0.09283194690942764, 0.09227712452411652, 0.09225108474493027, 0.09076716005802155, 0.09074155241250992, 0.09270108491182327, 0.09120991826057434, 0.09264879673719406, 0.07835283875465393, 0.09186172485351562, 0.09435676783323288]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1648724503258711e-05, "add_observations_from_episodes_to_batch": 2.7679800285027615e-06, "batch_individual_items": 1.2109450853441088e-05, "add_time_dim_to_batch_and_zero_pad": 6.753572252508946e-06, "add_states_from_episodes_to_batch": 2.668004876518874e-06}}, "connector_pipeline_timer": 5.719846091835153e-05}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.694743337623975e-06, "tensor_to_numpy": 1.4590899799782644e-05, "remove_single_ts_time_rank_from_batch": 1.1738639432141707e-05, "get_actions": 3.476386150240667e-05, "listify_data_for_vector_env": 1.0167044583997795e-05, "un_batch_to_individual_items": 6.359255870664075e-06}}, "connector_pipeline_timer": 0.00011040516143662099}, "rlmodule_inference_timer": 3.0040451680208447e-05, "episode_return_mean": -1.5, "module_episode_returns_mean": {"default_policy": -1.5}, "weights_seq_no": 14.0, "episode_return_max": 15.5, "num_episodes_lifetime": 280, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.3482272055025212e-05, "episode_len_min": 20, "env_reset_timer": 0.0006610433973681693, "num_env_steps_sampled_lifetime": 70400, "num_env_steps_sampled": 400, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "episode_duration_sec_mean": 0.005205765846185386, "episode_return_min": -13.5, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "sample": 0.13230958225563264, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "agent_episode_returns_mean": {"default_agent": -1.5}, "time_between_sampling": 9.526443067344069}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "ba99e_00000", "date": "2025-08-11_18-54-54", "timestamp": 1754931294, "time_this_iter_s": 9.058152914047241, "time_total_s": 134.12799835205078, "pid": 11884, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1619f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 134.12799835205078, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 23.99230769230769, "ram_util_percent": 76.73846153846154}}
{"timers": {"training_iteration": 10.095981000329752, "restore_env_runners": 9.0536363292492e-06, "training_step": 10.095779271911125, "env_runner_sampling_timer": 1.6523187152893906, "learner_update_timer": 8.26741186010072, "synch_weights": 0.0016368074990663476, "restore_eval_env_runners": 6.503914869699867e-05, "evaluation_iteration": 0.14448878487740752, "synch_eval_env_connectors": 0.0001806817510450572, "synch_env_connectors": 5.442877345029103e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.194709367467124e-05, "add_observations_from_episodes_to_batch": 2.7423822670310805e-06, "batch_individual_items": 1.2071010696861974e-05, "add_time_dim_to_batch_and_zero_pad": 6.9109029552993245e-06, "add_states_from_episodes_to_batch": 2.6681864341937976e-06}}, "connector_pipeline_timer": 5.795968007489864e-05}, "module_to_env_connector": {"connector_pipeline_timer": 0.00011452230796362834, "timers": {"connectors": {"get_actions": 3.818089511732837e-05, "normalize_and_clip_actions": 7.658725692283679e-06, "un_batch_to_individual_items": 6.3601209492597375e-06, "listify_data_for_vector_env": 1.0147474635917322e-05, "tensor_to_numpy": 1.495449635858138e-05, "remove_single_ts_time_rank_from_batch": 1.151499022790879e-05}}}, "weights_seq_no": 14.0, "episode_return_max": 14.5, "episode_duration_sec_mean": 0.005104574769269674, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "env_reset_timer": 3.121929669663561e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -400875.0, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "episode_return_min": -5.5, "agent_episode_returns_mean": {"default_agent": 6.3400000000000025}, "num_env_steps_sampled_lifetime": -8017500.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "env_step_timer": 1.3215966940372694e-05, "time_between_sampling": 0.03042841332688372, "num_episodes": 250.0, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 6.3400000000000025}, "sample": 0.005706976392163056, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 3.0875452929185915e-05, "episode_return_mean": 6.3400000000000025, "episode_len_max": 20, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3376.758208030049}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13507259488665144, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00929379069192219, "add_observations_from_episodes_to_batch": 0.0008367332422846258, "add_columns_from_episodes_to_train_batch": 0.04161395175935205, "add_time_dim_to_batch_and_zero_pad": 0.07560846164142891, "add_states_from_episodes_to_batch": 0.003502297881436086, "batch_individual_items": 0.003982930053177661, "numpy_to_tensor": 7.376159042025263e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 538650, "module_train_batch_size_mean": 997.4996962148737, "vf_explained_var": 0.0013433098793029785, "total_loss": 0.27770838141441345, "weights_seq_no": 90.0, "vf_loss_unclipped": 48.87191390991211, "diff_num_grad_updates_vs_sampler_policy": 76.0, "entropy": 0.6881037950515747, "vf_loss": 0.3588188588619232, "policy_loss": -0.0007742946036159992, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 3.885235855705105e-05}, "__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1077300, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 2970000, "num_env_steps_trained_lifetime_throughput": 45826.686029774115}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 76.0, "num_module_steps_trained": 35910, "total_loss": 0.0, "num_module_steps_trained_lifetime": 538650, "module_train_batch_size_mean": 997.4996962148737, "weights_seq_no": 90.0}}}, "intrinsic_reward_module": {"total_loss": 0.0, "weights_seq_no": 15.0, "num_trainable_parameters": 8266, "num_module_steps_trained_lifetime": 89775, "module_train_batch_size_mean": 997.7008703380301, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 716.3274964184559}, "default_policy": {"use_intrinsic_rewards": 0.0, "num_trainable_parameters": 16595, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 89775, "module_train_batch_size_mean": 997.7008703380301, "vf_explained_var": 0.0001952648162841797, "total_loss": 0.27725979685783386, "weights_seq_no": 15.0, "mean_kl_loss": 4.287060801289044e-05, "vf_loss_unclipped": 49.05183792114258, "curr_kl_coeff": 4.931150215270463e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.688059389591217, "vf_loss": 0.3583064079284668, "curr_entropy_coeff": 0.0015431216992, "policy_loss": -0.0008174175745807588, "num_module_steps_trained_lifetime_throughput": 716.3211245327404}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 179550, "num_env_steps_trained_lifetime": 495000, "num_env_steps_trained": 33000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 3950.734081358428, "num_module_steps_trained_throughput": 22600098.40989663, "num_module_steps_trained_lifetime_throughput": 12712895.725872247}, "IntrinsicAttentionMask": [[[0.08984354883432388, 0.0904509648680687, 0.0904347151517868, 0.0913405492901802, 0.09099256247282028, 0.09097621589899063, 0.09129133820533752, 0.0912749320268631, 0.09125854074954987, 0.09091085940599442, 0.0912257581949234], [0.08935926109552383, 0.09024129062891006, 0.09021766483783722, 0.0915379598736763, 0.09103003889322281, 0.09100619703531265, 0.09146607667207718, 0.09144212305545807, 0.09141818434000015, 0.09091091901063919, 0.09137031435966492], [0.08937214314937592, 0.09024687856435776, 0.09022344648838043, 0.09153269231319427, 0.09102904051542282, 0.09100539982318878, 0.0914614126086235, 0.09143766015768051, 0.09141392260789871, 0.09091091901063919, 0.09136646240949631], [0.08865965902805328, 0.0899367704987526, 0.08990248292684555, 0.09182459861040115, 0.09108363837003708, 0.09104891866445541, 0.0917196199297905, 0.09168464690446854, 0.09164969623088837, 0.09091015160083771, 0.09157983213663101], [0.08893197774887085, 0.09005553275346756, 0.090025395154953, 0.0917128175497055, 0.09106285125017166, 0.09103237092494965, 0.09162076562643051, 0.09159010648727417, 0.09155945479869843, 0.09091056883335114, 0.09149817377328873], [0.08894480019807816, 0.09006111323833466, 0.09003116935491562, 0.09170754998922348, 0.09106186032295227, 0.09103158116340637, 0.09161610901355743, 0.09158565104007721, 0.09155519306659698, 0.09091057628393173, 0.09149432182312012], [0.08869805932044983, 0.08995353430509567, 0.08991982787847519, 0.09180881083011627, 0.09108071029186249, 0.09104658663272858, 0.09170565754175186, 0.09167129546403885, 0.09163695573806763, 0.09091021865606308, 0.09156829863786697], [0.08871087431907654, 0.08995912969112396, 0.089925616979599, 0.09180355817079544, 0.09107974171638489, 0.0910458192229271, 0.09170101583003998, 0.09166686236858368, 0.09163271635770798, 0.09091024845838547, 0.09156446903944016], [0.08872366696596146, 0.08996471017599106, 0.08993139863014221, 0.09179829061031342, 0.0910787582397461, 0.09104502946138382, 0.0916963517665863, 0.09166240692138672, 0.09162846207618713, 0.09091026335954666, 0.09156061708927155], [0.08899614959955215, 0.09008347243070602, 0.09005431085824966, 0.09168650209903717, 0.0910579264163971, 0.09102845191955566, 0.09159749001264572, 0.09156784415245056, 0.0915381982922554, 0.09091063588857651, 0.09147894382476807], [0.08874929696321487, 0.08997589349746704, 0.08994296938180923, 0.09178777039051056, 0.0910768061876297, 0.09104347974061966, 0.09168705344200134, 0.0916535034775734, 0.09161996841430664, 0.09091030061244965, 0.09155293554067612]], [[0.09021203219890594, 0.09017921984195709, 0.09014642238616943, 0.08763325214385986, 0.08760137856006622, 0.08938728272914886, 0.08818481862545013, 0.08932226896286011, 0.10933693498373032, 0.08899819850921631, 0.08899819850921631], [0.09021728485822678, 0.09018467366695404, 0.0901520699262619, 0.08765367418527603, 0.08762198686599731, 0.08939743787050247, 0.08820203691720963, 0.08933281898498535, 0.10921667516231537, 0.08901065587997437, 0.08901065587997437], [0.0902225449681282, 0.09019012749195099, 0.09015771746635437, 0.0876741036772728, 0.087642602622509, 0.08940759301185608, 0.08821924775838852, 0.0893433541059494, 0.10909654945135117, 0.08902310580015182, 0.08902310580015182], [0.09059017151594162, 0.09057305008172989, 0.09055594354867935, 0.08923546969890594, 0.0892186090350151, 0.09015895426273346, 0.08952680975198746, 0.09012489020824432, 0.10010642558336258, 0.08995486050844193, 0.08995486050844193], [0.09059439599514008, 0.09057747572660446, 0.09056055545806885, 0.08925522863864899, 0.08923855423927307, 0.09016814827919006, 0.08954325318336487, 0.09013447165489197, 0.09999515861272812, 0.08996640890836716, 0.08996640890836716], [0.0903407633304596, 0.0903129056096077, 0.0902850553393364, 0.08814643323421478, 0.0881192535161972, 0.08964002132415771, 0.08861658722162247, 0.08958474546670914, 0.10633605718612671, 0.08930910378694534, 0.08930910378694534], [0.09051533043384552, 0.090494804084301, 0.09047428518533707, 0.0888933539390564, 0.08887319266796112, 0.0899985060095787, 0.08924176543951035, 0.08995769172906876, 0.10204289108514786, 0.08975407481193542, 0.08975407481193542], [0.09035060554742813, 0.09032313525676727, 0.09029567986726761, 0.0881868526339531, 0.08816004544496536, 0.08965970575809479, 0.08865051716566086, 0.08960520476102829, 0.10610146075487137, 0.08933340758085251, 0.08933340758085251], [0.08530796319246292, 0.0851781815290451, 0.08504859358072281, 0.07555661350488663, 0.07544166594743729, 0.08209093660116196, 0.07756701856851578, 0.08184134215116501, 0.19075624644756317, 0.08060574531555176, 0.08060574531555176], [0.09039895236492157, 0.0903734564781189, 0.09034796059131622, 0.08838827908039093, 0.08836334198713303, 0.08975731581449509, 0.08881942927837372, 0.08970668166875839, 0.10493624210357666, 0.08945415914058685, 0.08945415914058685], [0.09039895236492157, 0.0903734564781189, 0.09034796059131622, 0.08838827908039093, 0.08836334198713303, 0.08975731581449509, 0.08881942927837372, 0.08970668166875839, 0.10493624210357666, 0.08945415914058685, 0.08945415914058685]], [[0.08984354883432388, 0.0904509648680687, 0.0904347151517868, 0.0913405492901802, 0.09132414311170578, 0.09097621589899063, 0.09095986932516098, 0.09094353020191193, 0.09125854074954987, 0.09124214947223663, 0.0912257581949234], [0.08935926109552383, 0.09024129062891006, 0.09021766483783722, 0.0915379598736763, 0.091513991355896, 0.09100619703531265, 0.09098237007856369, 0.09095854312181473, 0.09141818434000015, 0.09139424562454224, 0.09137031435966492], [0.08937214314937592, 0.09024687856435776, 0.09022344648838043, 0.09153269231319427, 0.09150892496109009, 0.09100539982318878, 0.09098177403211594, 0.09095814824104309, 0.09141392260789871, 0.09139018505811691, 0.09136646240949631], [0.08865965902805328, 0.0899367704987526, 0.08990248292684555, 0.09182459861040115, 0.0917895957827568, 0.09104891866445541, 0.09101420640945435, 0.09097950905561447, 0.09164969623088837, 0.09161476045846939, 0.09157983213663101], [0.0886724591255188, 0.08994235843420029, 0.08990826457738876, 0.09181933850049973, 0.0917845368385315, 0.09104814380407333, 0.09101363271474838, 0.09097913652658463, 0.09164545685052872, 0.09161071479320526, 0.091575987637043], [0.08894480019807816, 0.09006111323833466, 0.09003116935491562, 0.09170754998922348, 0.09167706221342087, 0.09103158116340637, 0.09100131690502167, 0.09097106009721756, 0.09155519306659698, 0.09152475744485855, 0.09149432182312012], [0.08895763754844666, 0.09006670862436295, 0.09003695845603943, 0.09170228987932205, 0.09167200326919556, 0.0910307988524437, 0.09100073575973511, 0.09097068011760712, 0.09155095368623734, 0.09152071177959442, 0.0914904847741127], [0.08897047489881516, 0.09007229655981064, 0.09004274755716324, 0.09169702976942062, 0.09166694432497025, 0.09103002399206161, 0.09100015461444855, 0.09097030013799667, 0.09154669940471649, 0.09151666611433029, 0.09148664027452469], [0.08872366696596146, 0.08996471017599106, 0.08993139863014221, 0.09179829061031342, 0.09176430106163025, 0.09104502946138382, 0.09101132303476334, 0.09097762405872345, 0.09162846207618713, 0.09159453213214874, 0.09156061708927155], [0.08873648941516876, 0.08997030556201935, 0.08993718773126602, 0.09179303795099258, 0.09175924956798553, 0.09104426205158234, 0.09101074934005737, 0.0909772515296936, 0.09162422269582748, 0.09159049391746521, 0.09155678004026413], [0.08874929696321487, 0.08997588604688644, 0.08994296938180923, 0.09178777039051056, 0.09175418317317963, 0.09104347974061966, 0.09101016819477081, 0.09097686409950256, 0.09161996841430664, 0.09158644080162048, 0.09155293554067612]], [[0.09015358984470367, 0.09012079983949661, 0.09008802473545074, 0.0882239118218422, 0.08819182217121124, 0.08932936936616898, 0.08748095482587814, 0.0892644077539444, 0.10926609486341476, 0.08894054591655731, 0.08894054591655731], [0.09015918523073196, 0.09012658894062042, 0.09009400010108948, 0.08824088424444199, 0.08820898830890656, 0.08933985978364944, 0.08750224858522415, 0.08927527815103531, 0.10914632678031921, 0.08895332366228104, 0.08895332366228104], [0.09016476571559906, 0.09013237059116364, 0.09009998291730881, 0.08825786411762238, 0.08822615444660187, 0.08935034275054932, 0.08752354979515076, 0.08928613364696503, 0.10902668535709381, 0.08896610140800476, 0.08896610140800476], [0.09046385437250137, 0.09044274687767029, 0.0904216468334198, 0.08921681344509125, 0.08919599652290344, 0.0899323895573616, 0.08873408287763596, 0.08989042788743973, 0.10233999788761139, 0.08968105912208557, 0.08968105912208557], [0.09046868234872818, 0.09044776856899261, 0.09042686223983765, 0.08923321217298508, 0.0892125815153122, 0.08994216471910477, 0.08875491470098495, 0.08990059047937393, 0.10222693532705307, 0.08969316631555557, 0.08969316631555557], [0.09029087424278259, 0.09026303142309189, 0.09023518860340118, 0.08864963054656982, 0.08862228691577911, 0.08959051221609116, 0.08801627904176712, 0.08953526616096497, 0.10627732425928116, 0.08925978094339371, 0.08925978094339371], [0.09057287871837616, 0.09055635333061218, 0.0905398428440094, 0.08959551900625229, 0.08957917988300323, 0.09015671163797379, 0.08921638876199722, 0.09012382477521896, 0.09973998367786407, 0.08995971828699112, 0.08995971828699112], [0.09030140191316605, 0.09027394652366638, 0.09024650603532791, 0.08868309110403061, 0.08865612745285034, 0.08961087465286255, 0.0880584791302681, 0.08955640345811844, 0.10604367405176163, 0.08928476274013519, 0.08928476274013519], [0.08510603755712509, 0.08497656881809235, 0.08484728634357452, 0.07773768156766891, 0.07761941850185394, 0.08189662545919418, 0.0750342607498169, 0.08164762705564499, 0.190304696559906, 0.08041495829820633, 0.08041495829820633], [0.09035317599773407, 0.090327687561512, 0.09030220657587051, 0.08884962648153305, 0.088824562728405, 0.08971185982227325, 0.08826877176761627, 0.08966125547885895, 0.1048830971121788, 0.08940885961055756, 0.08940885961055756], [0.09035317599773407, 0.090327687561512, 0.09030220657587051, 0.08884962648153305, 0.088824562728405, 0.08971185982227325, 0.08826877176761627, 0.08966125547885895, 0.1048830971121788, 0.08940885961055756, 0.08940885961055756]], [[0.09091547131538391, 0.09045878797769547, 0.09044655412435532, 0.09112781286239624, 0.09086629748344421, 0.09110316634178162, 0.0910908430814743, 0.09107852727174759, 0.09081714600324631, 0.09105388820171356, 0.09104157239198685], [0.09091170132160187, 0.09073033928871155, 0.09072547405958176, 0.09099584072828293, 0.09089219570159912, 0.09098608046770096, 0.09098120033740997, 0.09097632020711899, 0.09087269753217697, 0.09096655994653702, 0.09096167981624603], [0.09091158956289291, 0.09073763340711594, 0.09073296934366226, 0.0909922868013382, 0.09089288115501404, 0.09098292887210846, 0.090978242456913, 0.09097356349229813, 0.09087418019771576, 0.09096420556306839, 0.09095952659845352], [0.09091713279485703, 0.09033319354057312, 0.09031755477190018, 0.0911889374256134, 0.0908542200922966, 0.09115737676620483, 0.09114160388708115, 0.09112583100795746, 0.09079134464263916, 0.09109429270029068, 0.09107852727174759], [0.09091506898403168, 0.09048792719841003, 0.09047648310661316, 0.0911136269569397, 0.09086907655000687, 0.09109058231115341, 0.09107905626296997, 0.09106753766536713, 0.09082311391830444, 0.09104450047016144, 0.09103298932313919], [0.0909169539809227, 0.09034774452447891, 0.0903325080871582, 0.09118185192346573, 0.09085562080144882, 0.09115109592676163, 0.09113571792840958, 0.09112034738063812, 0.09079433977603912, 0.09108961373567581, 0.09107425063848495], [0.09091684967279434, 0.0903550237417221, 0.09033998101949692, 0.09117830544710159, 0.09085632115602493, 0.09114794433116913, 0.09113277494907379, 0.09111760556697845, 0.0907958373427391, 0.09108726680278778, 0.09107210487127304], [0.09091676026582718, 0.0903623104095459, 0.09034746885299683, 0.09117476642131805, 0.09085702896118164, 0.09114481508731842, 0.0911298394203186, 0.09111487120389938, 0.09079734236001968, 0.09108492732048035, 0.09106996655464172], [0.09091466665267944, 0.0905170813202858, 0.0905064195394516, 0.09109944850206375, 0.09087187051773071, 0.09107799828052521, 0.09106728434562683, 0.09105656296014786, 0.09082908928394318, 0.09103512763977051, 0.09102441370487213], [0.09091655910015106, 0.09037686884403229, 0.09036241471767426, 0.09116767346858978, 0.09085842221975327, 0.09113851934671402, 0.09112394601106644, 0.09110938012599945, 0.09080032259225845, 0.09108024090528488, 0.0910656750202179], [0.0909164622426033, 0.09038414061069489, 0.09036988765001297, 0.09116412699222565, 0.09085912257432938, 0.09113537520170212, 0.09112099558115005, 0.09110663086175919, 0.09080182015895844, 0.09107790142297745, 0.09106352925300598]], [[0.09009413421154022, 0.09006136655807495, 0.09002860635519028, 0.08816573023796082, 0.08813367038965225, 0.0892704650759697, 0.08742326498031616, 0.08986501395702362, 0.10919402539730072, 0.08888189494609833, 0.08888189494609833], [0.09010007977485657, 0.09006750583648682, 0.09003493934869766, 0.08818303793668747, 0.08815116435289383, 0.08928129076957703, 0.08744488656520844, 0.0898723155260086, 0.10907475650310516, 0.08889500796794891, 0.08889500796794891], [0.09010600298643112, 0.09007362276315689, 0.09004126489162445, 0.08820033818483353, 0.08816865086555481, 0.08929210156202316, 0.08746650069952011, 0.089879609644413, 0.10895561426877975, 0.0889081209897995, 0.0889081209897995], [0.09042534977197647, 0.09040424972772598, 0.09038315713405609, 0.08917884528636932, 0.08915802836418152, 0.0898941159248352, 0.08869631588459015, 0.09027775377035141, 0.10229643434286118, 0.08964289724826813, 0.08964289724826813], [0.09043052792549133, 0.09040962904691696, 0.09038873016834259, 0.08919557183980942, 0.08917495608329773, 0.08990423381328583, 0.08871748298406601, 0.0902843028306961, 0.10218381881713867, 0.08965534716844559, 0.08965534716844559], [0.09024026244878769, 0.09021243453025818, 0.09018460661172867, 0.08859994262456894, 0.08857261389493942, 0.08954029530286789, 0.08796694129705429, 0.09004564583301544, 0.10621774196624756, 0.08920974284410477, 0.08920974284410477], [0.09054268151521683, 0.09052616357803345, 0.09050965309143066, 0.08956564962863922, 0.08954931795597076, 0.0901266559958458, 0.0891866460442543, 0.09042714536190033, 0.09970673173666, 0.0899297297000885, 0.0899297297000885], [0.09013547748327255, 0.09010408073663712, 0.09007269144058228, 0.08828673511743546, 0.08825597912073135, 0.0893460363149643, 0.08757449686527252, 0.08991590887308121, 0.10836161673069, 0.0889735147356987, 0.0889735147356987], [0.08488903939723969, 0.0847598984837532, 0.08463095128536224, 0.07753947377204895, 0.07742150872945786, 0.0816878154873848, 0.07484295964241028, 0.08398913592100143, 0.1898193657398224, 0.08020992577075958, 0.08020992577075958], [0.09030679613351822, 0.09028132259845734, 0.09025585651397705, 0.08880401402711868, 0.08877896517515182, 0.08966581523418427, 0.08822346478700638, 0.09012863039970398, 0.10482925176620483, 0.0893629640340805, 0.0893629640340805], [0.09030679613351822, 0.09028132259845734, 0.09025585651397705, 0.08880401402711868, 0.08877896517515182, 0.08966581523418427, 0.08822346478700638, 0.09012863039970398, 0.10482925176620483, 0.0893629640340805, 0.0893629640340805]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1361063276132792e-05, "add_observations_from_episodes_to_batch": 2.7316841883513796e-06, "batch_individual_items": 1.1795153178948939e-05, "add_time_dim_to_batch_and_zero_pad": 6.606554519061622e-06, "add_states_from_episodes_to_batch": 2.6708313847011165e-06}}, "connector_pipeline_timer": 5.61871150413899e-05}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.733610270035073e-06, "tensor_to_numpy": 1.430806263216466e-05, "remove_single_ts_time_rank_from_batch": 1.1591590081722203e-05, "get_actions": 3.437361841366508e-05, "listify_data_for_vector_env": 9.996739800822372e-06, "un_batch_to_individual_items": 6.24451266274024e-06}}, "connector_pipeline_timer": 0.00010940339480901736}, "rlmodule_inference_timer": 2.953771565472581e-05, "episode_return_mean": -1.7, "module_episode_returns_mean": {"default_policy": -1.7}, "weights_seq_no": 15.0, "episode_return_max": 15.5, "num_episodes_lifetime": 300, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.3277091600984778e-05, "episode_len_min": 20, "env_reset_timer": 0.000655280052498842, "num_env_steps_sampled_lifetime": 75400, "num_env_steps_sampled": 400, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "episode_duration_sec_mean": 0.005144560035550967, "episode_return_min": -13.5, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "sample": 0.13206858768314367, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "agent_episode_returns_mean": {"default_agent": -1.7}, "time_between_sampling": 9.522838119580227}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "ba99e_00000", "date": "2025-08-11_18-55-04", "timestamp": 1754931304, "time_this_iter_s": 9.257936000823975, "time_total_s": 143.38593435287476, "pid": 11884, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1619f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 143.38593435287476, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 26.969230769230766, "ram_util_percent": 76.97692307692307}}
{"timers": {"training_iteration": 10.08791599574711, "restore_env_runners": 9.019760467243096e-06, "training_step": 10.087714482112332, "env_runner_sampling_timer": 1.650763207296678, "learner_update_timer": 8.260033379840472, "synch_weights": 0.0016295431744200498, "restore_eval_env_runners": 6.445208714510253e-05, "evaluation_iteration": 0.14417569535909505, "synch_eval_env_connectors": 0.00018000118425239554, "synch_env_connectors": 5.4276188349139204e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2239055858489847e-05, "add_observations_from_episodes_to_batch": 2.7700575115174623e-06, "batch_individual_items": 1.2245721530615146e-05, "add_time_dim_to_batch_and_zero_pad": 6.934216900844375e-06, "add_states_from_episodes_to_batch": 2.708299386995251e-06}}, "connector_pipeline_timer": 5.869833637955498e-05}, "module_to_env_connector": {"connector_pipeline_timer": 0.0001164140050584363, "timers": {"connectors": {"get_actions": 3.89943840172461e-05, "normalize_and_clip_actions": 7.799063516148034e-06, "un_batch_to_individual_items": 6.46117487081329e-06, "listify_data_for_vector_env": 1.026290880550982e-05, "tensor_to_numpy": 1.5222649954704472e-05, "remove_single_ts_time_rank_from_batch": 1.164788643003624e-05}}}, "weights_seq_no": 15.0, "episode_return_max": 14.5, "episode_duration_sec_mean": 0.0051914900047704575, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "env_reset_timer": 3.044651115730477e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -431750.0, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "episode_return_min": -5.5, "agent_episode_returns_mean": {"default_agent": 5.7799999999999985}, "num_env_steps_sampled_lifetime": -8635000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "env_step_timer": 1.3487879587248765e-05, "time_between_sampling": 0.0315851193315973, "num_episodes": 250.0, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 5.7799999999999985}, "sample": 0.005500502828507791, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 3.1380399993861324e-05, "episode_return_mean": 5.7799999999999985, "episode_len_max": 20, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3337.9841506382004}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1350082764385232, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009284054454625181, "add_observations_from_episodes_to_batch": 0.0008358967506740305, "add_columns_from_episodes_to_train_batch": 0.0415908293321499, "add_time_dim_to_batch_and_zero_pad": 0.07558034410474347, "add_states_from_episodes_to_batch": 0.0035013215716466995, "batch_individual_items": 0.003982332842994263, "numpy_to_tensor": 7.362731438371647e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 574560, "module_train_batch_size_mean": 997.4990256591639, "vf_explained_var": 0.0012219548225402832, "total_loss": 0.27761855721473694, "weights_seq_no": 96.0, "vf_loss_unclipped": 47.22254943847656, "diff_num_grad_updates_vs_sampler_policy": 81.0, "entropy": 0.6868943572044373, "vf_loss": 0.35878103971481323, "policy_loss": -0.0008374205208383501, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 4.453206929611042e-05}, "__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1149120, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 3168000, "num_env_steps_trained_lifetime_throughput": 45211.13510172208}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 81.0, "num_module_steps_trained": 35910, "total_loss": 0.0, "num_module_steps_trained_lifetime": 574560, "module_train_batch_size_mean": 997.4990256591639, "weights_seq_no": 96.0}}}, "intrinsic_reward_module": {"total_loss": 0.0, "weights_seq_no": 16.0, "num_trainable_parameters": 8266, "num_module_steps_trained_lifetime": 95760, "module_train_batch_size_mean": 997.6889684010584, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 716.8331931621718}, "default_policy": {"use_intrinsic_rewards": 0.0, "num_trainable_parameters": 16595, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 95760, "module_train_batch_size_mean": 997.6889684010584, "vf_explained_var": 0.0008717775344848633, "total_loss": 0.2772010564804077, "weights_seq_no": 16.0, "mean_kl_loss": 4.907650509267114e-05, "vf_loss_unclipped": 47.26389694213867, "curr_kl_coeff": 2.4655751076352317e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.6868420839309692, "vf_loss": 0.35830608010292053, "curr_entropy_coeff": 0.0015431216992, "policy_loss": -0.0008777712937444448, "num_module_steps_trained_lifetime_throughput": 716.8272575512796}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 191520, "num_env_steps_trained_lifetime": 528000, "num_env_steps_trained": 33000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 3953.4838586408314, "num_module_steps_trained_throughput": 22089461.659906358, "num_module_steps_trained_lifetime_throughput": 12706370.382961784}, "IntrinsicAttentionMask": [[[0.09098327904939651, 0.0905262678861618, 0.09026647359132767, 0.09119578450918198, 0.09118345379829407, 0.09092177450656891, 0.09115879237651825, 0.09089718014001846, 0.09088488668203354, 0.09087259322404861, 0.09110948443412781], [0.09093860536813736, 0.09075719118118286, 0.09065382182598114, 0.09102276712656021, 0.09101788699626923, 0.09091421961784363, 0.09100812673568726, 0.09090446680784225, 0.09089958667755127, 0.09089471399784088, 0.09098859876394272], [0.09091297537088394, 0.090889111161232, 0.09087549149990082, 0.09092403948307037, 0.09092339873313904, 0.09090977907180786, 0.09092211723327637, 0.0909084901213646, 0.09090784937143326, 0.09090720862150192, 0.09091955423355103], [0.0910038873553276, 0.09041938185691833, 0.09008748829364777, 0.09127594530582428, 0.0912601500749588, 0.0909251719713211, 0.09122856706380844, 0.0908937007188797, 0.0908779725432396, 0.09086224436759949, 0.09116543084383011], [0.0910027027130127, 0.09042558073997498, 0.09009786695241928, 0.0912713035941124, 0.09125570952892303, 0.09092497825622559, 0.09122452884912491, 0.09089390933513641, 0.09087838232517242, 0.09086285531520844, 0.09116219729185104], [0.09097729623317719, 0.09055725485086441, 0.09031841158866882, 0.09117254614830017, 0.09116121381521225, 0.09092077612876892, 0.091138556599617, 0.09089817106723785, 0.09088688343763351, 0.09087558090686798, 0.09109325706958771], [0.09100031107664108, 0.09043797105550766, 0.09011860191822052, 0.09126200526952744, 0.09124681353569031, 0.09092459082603455, 0.09121643006801605, 0.09089431911706924, 0.09087918698787689, 0.09086405485868454, 0.09115570038557053], [0.09097490459680557, 0.09056966006755829, 0.09033919870853424, 0.0911632552742958, 0.09115232527256012, 0.09092037379741669, 0.09113046526908875, 0.09089858084917068, 0.09088768064975739, 0.09087678045034409, 0.09108676761388779], [0.09097371250391006, 0.09057586640119553, 0.09034959971904755, 0.09115861356258392, 0.09114788472652435, 0.09092018008232117, 0.09112642705440521, 0.0908987820148468, 0.09088808298110962, 0.09087738394737244, 0.09108352661132812], [0.09097252041101456, 0.09058207273483276, 0.09035999327898026, 0.09115397185087204, 0.09114344418048859, 0.09091998636722565, 0.09112238138914108, 0.09089898318052292, 0.09088848531246185, 0.09087797999382019, 0.09108028560876846], [0.09099553525447845, 0.09046275168657303, 0.09016010165214539, 0.09124341607093811, 0.09122902899980545, 0.09092380106449127, 0.09120024740695953, 0.09089512377977371, 0.09088078886270523, 0.09086646139621735, 0.09114272892475128]], [[0.09196221828460693, 0.09194791316986084, 0.09164456278085709, 0.09082893282175064, 0.09110124409198761, 0.09160181134939194, 0.09107290953397751, 0.09186215698719025, 0.08375526964664459, 0.09143111854791641, 0.09279189258813858], [0.09194771200418472, 0.09193360805511475, 0.09163457155227661, 0.0908304750919342, 0.09109895676374435, 0.09159243106842041, 0.09107101708650589, 0.09184906631708145, 0.08385246992111206, 0.09142415970563889, 0.09276551008224487], [0.0916372686624527, 0.09162748605012894, 0.09141988307237625, 0.09086062014102936, 0.09104751795530319, 0.09139060974121094, 0.09102807939052582, 0.09156882017850876, 0.08594211935997009, 0.09127368777990341, 0.09220395237207413], [0.09077523648738861, 0.09077698737382889, 0.09081412851810455, 0.09091469645500183, 0.09088100492954254, 0.09081938117742538, 0.0908845067024231, 0.09078747034072876, 0.09183184802532196, 0.09084034711122513, 0.09067436307668686], [0.09106755256652832, 0.09106546640396118, 0.0910210832953453, 0.09090113639831543, 0.09094128757715225, 0.09101482480764389, 0.09093711525201797, 0.09105293452739716, 0.08982043713331223, 0.09098979085683823, 0.09118828922510147], [0.09159307181835175, 0.09158390015363693, 0.09138916432857513, 0.09086443483829498, 0.09103981405496597, 0.09136170148849487, 0.0910215675830841, 0.09152886271476746, 0.08624089509248734, 0.09125200659036636, 0.09212448447942734], [0.09103736281394958, 0.09103567898273468, 0.0909997895359993, 0.09090276807546616, 0.09093524515628815, 0.09099472314119339, 0.09093187749385834, 0.09102553874254227, 0.09002760052680969, 0.09097447246313095, 0.09113498032093048], [0.09186048805713654, 0.09184761345386505, 0.09157443791627884, 0.09083952754735947, 0.09108496457338333, 0.09153594076633453, 0.09105943143367767, 0.09177038818597794, 0.08443784713745117, 0.09138219058513641, 0.09260714054107666], [0.08129765838384628, 0.08139218389987946, 0.08342695981264114, 0.08918996900320053, 0.08721709996461868, 0.08371832221746445, 0.08742004632949829, 0.08196168392896652, 0.16346193850040436, 0.08489316701889038, 0.07602094113826752], [0.09141557663679123, 0.09140882641077042, 0.09126542508602142, 0.09087862819433212, 0.09100797027349472, 0.09124519675970078, 0.09099452197551727, 0.09136831015348434, 0.08744460344314575, 0.09116438031196594, 0.09180647879838943], [0.09278365969657898, 0.09275748580694199, 0.09220309555530548, 0.09071993827819824, 0.09121392667293549, 0.09212509542703629, 0.09116247296333313, 0.09260059893131256, 0.07831208407878876, 0.09181393682956696, 0.09430768340826035]], [[0.09098311513662338, 0.0902785211801529, 0.09026630967855453, 0.09119562059640884, 0.09118328988552094, 0.09117095172405243, 0.09115862846374512, 0.09089701622724533, 0.090884730219841, 0.09112164378166199, 0.09086014330387115], [0.09091418981552124, 0.09086588770151138, 0.09086505323648453, 0.09092868864536285, 0.0909278467297554, 0.09092700481414795, 0.0909261703491211, 0.09090830385684967, 0.09090746194124222, 0.09092364460229874, 0.09090578556060791], [0.09091297537088394, 0.09087613224983215, 0.09087549149990082, 0.09092403948307037, 0.09092339873313904, 0.0909227579832077, 0.09092211723327637, 0.0909084901213646, 0.09090784937143326, 0.09092019498348236, 0.09090656787157059], [0.09100361913442612, 0.09010282158851624, 0.09008722752332687, 0.09127567708492279, 0.09125988185405731, 0.09124408662319183, 0.09122829884290695, 0.09089343249797821, 0.0908777043223381, 0.0911809429526329, 0.09084625542163849], [0.0910024493932724, 0.09011301398277283, 0.09009761363267899, 0.0912710502743721, 0.09125545620918274, 0.09123986214399338, 0.09122427552938461, 0.09089365601539612, 0.09087812900543213, 0.09117752313613892, 0.09084707498550415], [0.09100125730037689, 0.09012318402528763, 0.0901079848408699, 0.09126640111207962, 0.09125100821256638, 0.09123561531305313, 0.09122022986412048, 0.09089385718107224, 0.09087853133678436, 0.09117407351732254, 0.09084787964820862], [0.09100005775690079, 0.09013335406780243, 0.09011835604906082, 0.09126175194978714, 0.09124656021595001, 0.09123136848211288, 0.09121617674827576, 0.09089406579732895, 0.0908789336681366, 0.09117063134908676, 0.09084867686033249], [0.09097477793693542, 0.09034990519285202, 0.09033907204866409, 0.09116312861442566, 0.09115219861268997, 0.09114126861095428, 0.0911303386092186, 0.09089845418930054, 0.09088755398988724, 0.09109756350517273, 0.09086575359106064], [0.09097358584403992, 0.0903601124882698, 0.0903494730591774, 0.09115848690271378, 0.0911477580666542, 0.09113702178001404, 0.09112630039453506, 0.09089865535497665, 0.09088795632123947, 0.09109412133693695, 0.0908665582537651], [0.09099651128053665, 0.09016392379999161, 0.09014950692653656, 0.09124784171581268, 0.09123324602842331, 0.09121866524219513, 0.09120407700538635, 0.09089470654726028, 0.09088017046451569, 0.09116033464670181, 0.09085110574960709], [0.0909711942076683, 0.09038050472736359, 0.09037026017904282, 0.09114919602870941, 0.09113886952400208, 0.09112854301929474, 0.0911182090640068, 0.09089905023574829, 0.09088875353336334, 0.0910872370004654, 0.09086815267801285]], [[0.09195970743894577, 0.09194540232419968, 0.09193111211061478, 0.09082645177841187, 0.09109875559806824, 0.09188822656869888, 0.09107042849063873, 0.09185964614152908, 0.08348966389894485, 0.09114115685224533, 0.09278935939073563], [0.09194528311491013, 0.09193118661642075, 0.09191709011793137, 0.09082808345556259, 0.09109655022621155, 0.09187481552362442, 0.09106861054897308, 0.09184664487838745, 0.08359034359455109, 0.09113834798336029, 0.09276305884122849], [0.09193083643913269, 0.09191694110631943, 0.09190305322408676, 0.09082967787981033, 0.09109431505203247, 0.09186138957738876, 0.09106677770614624, 0.09183362871408463, 0.08369112014770508, 0.09113551676273346, 0.09273674339056015], [0.09077519923448563, 0.0907769501209259, 0.09077869355678558, 0.09091465920209885, 0.09088096767663956, 0.09078393876552582, 0.09088446944952011, 0.09078743308782578, 0.0918676108121872, 0.09087572991847992, 0.09067431837320328], [0.09106750786304474, 0.0910654217004776, 0.09106332808732986, 0.09090109169483185, 0.09094124287366867, 0.09105706214904785, 0.0909370630979538, 0.09105288982391357, 0.08977867662906647, 0.09094748646020889, 0.09118824452161789], [0.09188743680715561, 0.0918741524219513, 0.09186087548732758, 0.09083442389965057, 0.09108753502368927, 0.09182104468345642, 0.09106119722127914, 0.09179449826478958, 0.08399412035942078, 0.0911269336938858, 0.09265776723623276], [0.0910373255610466, 0.0910356417298317, 0.0910339504480362, 0.09090273082256317, 0.09093520790338516, 0.09102888405323029, 0.09093183279037476, 0.09102550148963928, 0.08999373763799667, 0.09094025939702988, 0.0911349430680275], [0.09185846149921417, 0.09184557944536209, 0.0918327048420906, 0.0908375233411789, 0.09108295291662216, 0.09179409593343735, 0.0910574197769165, 0.09176836162805557, 0.08419667184352875, 0.09112115949392319, 0.0926050916314125], [0.08068601042032242, 0.080783411860466, 0.08088093996047974, 0.08883275091648102, 0.08679360151290894, 0.08117421716451645, 0.08700329065322876, 0.08137033134698868, 0.17073866724967957, 0.08648088574409485, 0.07525584846735], [0.09111258387565613, 0.09110990166664124, 0.09110720455646515, 0.0908985361456871, 0.09095016121864319, 0.09109914302825928, 0.0909447968006134, 0.0910937711596489, 0.08945784717798233, 0.09095819294452667, 0.09126793593168259], [0.09277559816837311, 0.09274941682815552, 0.09272325783967972, 0.0907120630145073, 0.09120599925518036, 0.09264481067657471, 0.0911545529961586, 0.09259255230426788, 0.07785926014184952, 0.09128301590681076, 0.09429948776960373]], [[0.08987303823232651, 0.09048065543174744, 0.09013593941926956, 0.09137053042650223, 0.0913541167974472, 0.0910060778260231, 0.09132130444049835, 0.0909733846783638, 0.0912884920835495, 0.0909406989812851, 0.09125570207834244], [0.08940188586711884, 0.0902843326330185, 0.08978337049484253, 0.09158162027597427, 0.09155763685703278, 0.09104960411787033, 0.09150969982147217, 0.09100192785263062, 0.09146178513765335, 0.09095428138971329, 0.09141390025615692], [0.08966855704784393, 0.09039556980133057, 0.0899830013513565, 0.09146205335855484, 0.09144236147403717, 0.09102501720190048, 0.09140300005674362, 0.09098583459854126, 0.09136365354061127, 0.09094665944576263, 0.0913243219256401], [0.08872093260288239, 0.08999893069267273, 0.08927270770072937, 0.09188805520534515, 0.09185302257537842, 0.09111183881759644, 0.09178300201892853, 0.09104238450527191, 0.09171303361654282, 0.09097298234701157, 0.09164311736822128], [0.08873338252305984, 0.09000416100025177, 0.08928205817937851, 0.09188242256641388, 0.09184759855270386, 0.0911106988787651, 0.0917779803276062, 0.09104163944721222, 0.09170842170715332, 0.09097263216972351, 0.09163890779018402], [0.08899852633476257, 0.0901155173778534, 0.08948104083538055, 0.09176293760538101, 0.09173242747783661, 0.09108656644821167, 0.09167143702507019, 0.09102600812911987, 0.09161049127578735, 0.09096548706293106, 0.0915495827794075], [0.08875832706689835, 0.09001465141773224, 0.08930078893899918, 0.09187118709087372, 0.09183676540851593, 0.09110844880342484, 0.09176796674728394, 0.09104018658399582, 0.09169921278953552, 0.09097198396921158, 0.09163051098585129], [0.08902350813150406, 0.09012598544359207, 0.08949977159500122, 0.09175167977809906, 0.09172157943248749, 0.09108427166938782, 0.09166140109300613, 0.09102451801300049, 0.09160126000642776, 0.09096479415893555, 0.09154116362333298], [0.08878325670957565, 0.09002513438463211, 0.08931949734687805, 0.09185993671417236, 0.0918259248137474, 0.09110617637634277, 0.09175793081521988, 0.09103871881961823, 0.09168999642133713, 0.09097131341695786, 0.09162210673093796], [0.08904851227998734, 0.09013648331165314, 0.08951853215694427, 0.0917404443025589, 0.09171074628829956, 0.09108200669288635, 0.09165138006210327, 0.0910230502486229, 0.09159205853939056, 0.09096412360668182, 0.09153276681900024], [0.08880820125341415, 0.09003561735153198, 0.08933822065591812, 0.0918486937880516, 0.09181508421897888, 0.09110391139984131, 0.09174790978431702, 0.09103725105524063, 0.09168078005313873, 0.09097065031528473, 0.09161370247602463]], [[0.09022648632526398, 0.09019366651773453, 0.09016086161136627, 0.08829525113105774, 0.088263139128685, 0.08940159529447556, 0.0881989449262619, 0.0893365815281868, 0.10855181515216827, 0.08835925161838531, 0.08901245892047882], [0.09023155272006989, 0.09019892662763596, 0.09016633033752441, 0.08831173181533813, 0.08827980607748032, 0.08941157907247543, 0.08821598440408707, 0.08934693783521652, 0.10843701660633087, 0.08837534487247467, 0.08902473002672195], [0.0902366191148758, 0.09020419418811798, 0.09017178416252136, 0.08832821249961853, 0.08829647302627563, 0.08942154049873352, 0.08823303133249283, 0.08935729414224625, 0.10832232981920242, 0.08839145302772522, 0.08903700858354568], [0.09050773084163666, 0.09048661589622498, 0.0904655009508133, 0.08926009386777878, 0.08923926949501038, 0.08997601270675659, 0.08919762074947357, 0.08993402868509293, 0.1019069030880928, 0.08930158615112305, 0.08972456306219101], [0.09051211178302765, 0.09049119055271149, 0.09047026932239532, 0.08927604556083679, 0.08925540745258331, 0.08998534828424454, 0.08921414613723755, 0.08994374424219131, 0.10179832577705383, 0.08931715786457062, 0.0897362232208252], [0.09035104513168335, 0.09032317996025085, 0.09029532968997955, 0.08870871365070343, 0.08868136256933212, 0.0896502211689949, 0.0886266753077507, 0.08959493786096573, 0.10568598657846451, 0.08876322209835052, 0.08931926637887955], [0.09052082151174545, 0.09050029516220093, 0.0904797688126564, 0.08930792659521103, 0.08928767591714859, 0.09000396728515625, 0.08924718201160431, 0.0899631530046463, 0.10158147662878036, 0.08934827148914337, 0.08975952118635178], [0.09036058932542801, 0.09033311903476715, 0.09030566364526749, 0.0887412279844284, 0.08871424943208694, 0.0896696150302887, 0.08866032212972641, 0.0896151140332222, 0.10546185076236725, 0.08879498392343521, 0.08934329450130463], [0.08586365729570389, 0.08573684096336365, 0.08561020344495773, 0.07863711565732956, 0.07852096855640411, 0.08271834254264832, 0.07828918844461441, 0.08247417956590652, 0.18201540410518646, 0.07886896282434464, 0.08126508444547653], [0.09049899876117706, 0.09047748893499374, 0.09045597910881042, 0.0892283022403717, 0.08920709043741226, 0.08995741605758667, 0.08916468918323517, 0.08991464972496033, 0.10212346911430359, 0.08927056193351746, 0.08970131725072861], [0.09040751308202744, 0.09038200974464417, 0.09035651385784149, 0.08890306949615479, 0.08887799084186554, 0.08976581692695618, 0.08882785588502884, 0.08971517533063889, 0.10434829443693161, 0.08895303308963776, 0.08946263790130615]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.28251761354896e-05, "add_observations_from_episodes_to_batch": 2.9237497459960616e-06, "batch_individual_items": 1.2856171986056532e-05, "add_time_dim_to_batch_and_zero_pad": 7.195725149723254e-06, "add_states_from_episodes_to_batch": 2.806884011444612e-06}}, "connector_pipeline_timer": 6.095722005165365e-05}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.442308135140538e-06, "tensor_to_numpy": 1.5456171755630513e-05, "remove_single_ts_time_rank_from_batch": 1.218142586402921e-05, "get_actions": 3.846901546693056e-05, "listify_data_for_vector_env": 1.115873144175798e-05, "un_batch_to_individual_items": 6.7846182255341895e-06}}, "connector_pipeline_timer": 0.0001193148608784257}, "rlmodule_inference_timer": 3.2435771808395376e-05, "episode_return_mean": -1.1, "module_episode_returns_mean": {"default_policy": -1.1}, "weights_seq_no": 16.0, "episode_return_max": 15.5, "num_episodes_lifetime": 320, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.5217052071325786e-05, "episode_len_min": 20, "env_reset_timer": 0.000649533091637225, "num_env_steps_sampled_lifetime": 80400, "num_env_steps_sampled": 400, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "episode_duration_sec_mean": 0.005207865823758766, "episode_return_min": -13.5, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "sample": 0.13193350222630668, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "agent_episode_returns_mean": {"default_agent": -1.1}, "time_between_sampling": 9.520794718794575}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "ba99e_00000", "date": "2025-08-11_18-55-13", "timestamp": 1754931313, "time_this_iter_s": 9.416988134384155, "time_total_s": 152.8029224872589, "pid": 11884, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1619f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 152.8029224872589, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 31.02857142857143, "ram_util_percent": 77.70714285714287}}
{"timers": {"training_iteration": 10.079703189120355, "restore_env_runners": 8.990393360684893e-06, "training_step": 10.079501600210198, "env_runner_sampling_timer": 1.6501644652235572, "learner_update_timer": 8.252309557711785, "synch_weights": 0.0016210844123593058, "restore_eval_env_runners": 6.388797666474381e-05, "evaluation_iteration": 0.14397854340516927, "synch_eval_env_connectors": 0.00017936742226808703, "synch_env_connectors": 5.41917186630839e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3395669530875475e-05, "add_observations_from_episodes_to_batch": 2.901987358291728e-06, "batch_individual_items": 1.278908021215314e-05, "add_time_dim_to_batch_and_zero_pad": 7.278634966575798e-06, "add_states_from_episodes_to_batch": 2.8550319733096897e-06}}, "connector_pipeline_timer": 6.215232711427445e-05}, "module_to_env_connector": {"connector_pipeline_timer": 0.00012306942631033836, "timers": {"connectors": {"get_actions": 4.195929551863704e-05, "normalize_and_clip_actions": 8.204065675080915e-06, "un_batch_to_individual_items": 6.659336617417274e-06, "listify_data_for_vector_env": 1.0755443902495922e-05, "tensor_to_numpy": 1.623999212367293e-05, "remove_single_ts_time_rank_from_batch": 1.2129552309555375e-05}}}, "weights_seq_no": 16.0, "episode_return_max": 14.5, "episode_duration_sec_mean": 0.005506452532019464, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "env_reset_timer": 3.542601127939894e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -462625.0, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "episode_return_min": -5.5, "agent_episode_returns_mean": {"default_agent": 5.619999999999999}, "num_env_steps_sampled_lifetime": -9252500.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "env_step_timer": 1.4447515290743742e-05, "time_between_sampling": 0.032211205042287326, "num_episodes": 250.0, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 5.619999999999999}, "sample": 0.005817129584062769, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 3.3658238911692806e-05, "episode_return_mean": 5.619999999999999, "episode_len_max": 20, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3224.7117655051184}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13505211283402907, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00928012766044803, "add_observations_from_episodes_to_batch": 0.0008363319525746281, "add_columns_from_episodes_to_train_batch": 0.04162231936868055, "add_time_dim_to_batch_and_zero_pad": 0.07559301858390603, "add_states_from_episodes_to_batch": 0.0035041446056151473, "batch_individual_items": 0.0039833482644107635, "numpy_to_tensor": 7.348521107264536e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 610470, "module_train_batch_size_mean": 997.498558675304, "vf_explained_var": 0.0011546611785888672, "total_loss": 0.2780401408672333, "weights_seq_no": 102.0, "vf_loss_unclipped": 49.43777084350586, "diff_num_grad_updates_vs_sampler_policy": 86.0, "entropy": 0.6863075494766235, "vf_loss": 0.358761727809906, "policy_loss": -0.0003981592890340835, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 2.2609323423239402e-05}, "__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1220940, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 3366000, "num_env_steps_trained_lifetime_throughput": 44624.81188225653}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 86.0, "num_module_steps_trained": 35910, "total_loss": 0.0, "num_module_steps_trained_lifetime": 610470, "module_train_batch_size_mean": 997.498558675304, "weights_seq_no": 102.0}}}, "intrinsic_reward_module": {"total_loss": 0.0, "weights_seq_no": 17.0, "num_trainable_parameters": 8266, "num_module_steps_trained_lifetime": 101745, "module_train_batch_size_mean": 997.6777629636601, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 717.490578973452}, "default_policy": {"use_intrinsic_rewards": 0.0, "num_trainable_parameters": 16595, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 101745, "module_train_batch_size_mean": 997.6777629636601, "vf_explained_var": 0.0009049177169799805, "total_loss": 0.2776636779308319, "weights_seq_no": 17.0, "mean_kl_loss": 2.474667053320445e-05, "vf_loss_unclipped": 49.54374694824219, "curr_kl_coeff": 1.2327875538176158e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.6862714290618896, "vf_loss": 0.3583059012889862, "curr_entropy_coeff": 0.0015431216992, "policy_loss": -0.0004158703377470374, "num_module_steps_trained_lifetime_throughput": 717.4850641225194}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 203490, "num_env_steps_trained_lifetime": 561000, "num_env_steps_trained": 33000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 3957.0718000187653, "num_module_steps_trained_throughput": 21612733.949563056, "num_module_steps_trained_lifetime_throughput": 12711011.187908169}, "IntrinsicAttentionMask": [[[0.09091529250144958, 0.09021122753620148, 0.09044638276100159, 0.09112763404846191, 0.0911153107881546, 0.09110298752784729, 0.09109066426753998, 0.09107834845781326, 0.09081697463989258, 0.09105370938777924, 0.09104139357805252], [0.09090954065322876, 0.0908612459897995, 0.09087741374969482, 0.09092403948307037, 0.09092319756746292, 0.09092236310243607, 0.09092152118682861, 0.09092067927122116, 0.09090282022953033, 0.09091899544000626, 0.0909181535243988], [0.09091155976057053, 0.09064314514398575, 0.09073293954133987, 0.09099225699901581, 0.09098757803440094, 0.09098289906978607, 0.0909782126545906, 0.09097353368997574, 0.09087415039539337, 0.090964175760746, 0.09095949679613113], [0.09091685712337494, 0.0900169163942337, 0.09031728655099869, 0.09118865430355072, 0.09117287397384644, 0.09115709364414215, 0.09114132076501846, 0.09112554788589478, 0.09079106152057648, 0.091094009578228, 0.0910782441496849], [0.09091678261756897, 0.09002818912267685, 0.0903247743844986, 0.09118513017892838, 0.09116955101490021, 0.09115397185087204, 0.09113840013742447, 0.0911228284239769, 0.09079258143901825, 0.09109169244766235, 0.09107612818479538], [0.0909166932106018, 0.0900394394993782, 0.0903322622179985, 0.09118159115314484, 0.09116621315479279, 0.09115083515644073, 0.09113545715808868, 0.09112009406089783, 0.09079407900571823, 0.09108935296535492, 0.09107398986816406], [0.09091660380363464, 0.09005070477724075, 0.09033974260091782, 0.0911780595779419, 0.09116288274526596, 0.09114769846200943, 0.09113252907991409, 0.09111735969781876, 0.0907955914735794, 0.09108702093362808, 0.09107185900211334], [0.09091651439666748, 0.0900619626045227, 0.09034723043441772, 0.09117452055215836, 0.09115954488515854, 0.09114456921815872, 0.0911295935511589, 0.09111462533473969, 0.09079709649085999, 0.09108468145132065, 0.09106972068548203], [0.0909145399928093, 0.09030146896839142, 0.09050630033016205, 0.0910993218421936, 0.09108860045671463, 0.09107787907123566, 0.09106715768575668, 0.09105643630027771, 0.09082896262407303, 0.09103500097990036, 0.09102428704500198], [0.09091632813215256, 0.0900844857096672, 0.09036219120025635, 0.09116744250059128, 0.0911528617143631, 0.09113828837871552, 0.09112371504306793, 0.09110914915800095, 0.09080009907484055, 0.09108000993728638, 0.09106544405221939], [0.0909162387251854, 0.09009574353694916, 0.09036967158317566, 0.09116390347480774, 0.09114952385425568, 0.09113515168428421, 0.09112077206373215, 0.09110640734434128, 0.09080159664154053, 0.09107767790555954, 0.09106330573558807]], [[0.0919356420636177, 0.09192134439945221, 0.09161807596683502, 0.09080269187688828, 0.09107492864131927, 0.09186417609453201, 0.09104660153388977, 0.09183561056852341, 0.08373113721609116, 0.09140470623970032, 0.09276507794857025], [0.09192152321338654, 0.09190743416547775, 0.09160847216844559, 0.09080461412668228, 0.09107301384210587, 0.09185107797384262, 0.0910450890660286, 0.09182291477918625, 0.08382866531610489, 0.09139812737703323, 0.09273909032344818], [0.09161914139986038, 0.09160935878753662, 0.09140179306268692, 0.09084264934062958, 0.09102950990200043, 0.09157025068998337, 0.09101007133722305, 0.09155070036649704, 0.0859251618385315, 0.09125562757253647, 0.09218570590019226], [0.09077844768762589, 0.09078019857406616, 0.09081734716892242, 0.0909179151058197, 0.09088422358036041, 0.09078719466924667, 0.09088772535324097, 0.09079068154096603, 0.09183507412672043, 0.0908435583114624, 0.09067757427692413], [0.0910637155175209, 0.09106162935495377, 0.09101724624633789, 0.09089729934930801, 0.09093745052814484, 0.09105326980352402, 0.09093327820301056, 0.09104909002780914, 0.08981664478778839, 0.09098594635725021, 0.09118444472551346], [0.0918649360537529, 0.09185165911912918, 0.0915699452161789, 0.09081218391656876, 0.09106523543596268, 0.0917985588312149, 0.09103890508413315, 0.09177201986312866, 0.08421977609395981, 0.09137170016765594, 0.09263508021831512], [0.09103425592184067, 0.09103256464004517, 0.09099667519330978, 0.09089966118335724, 0.09093213826417923, 0.09102580696344376, 0.09092876315116882, 0.09102243185043335, 0.09002450853586197, 0.09097136557102203, 0.09113186597824097], [0.0918366014957428, 0.09182372689247131, 0.09155062586069107, 0.09081590920686722, 0.09106127917766571, 0.09177225083112717, 0.09103575348854065, 0.09174652397632599, 0.08441595733165741, 0.09135842323303223, 0.0925830528140068], [0.08145637810230255, 0.08155109733343124, 0.0835898369550705, 0.08936401456594467, 0.08738730847835541, 0.08193106949329376, 0.08759066462516785, 0.08212171494960785, 0.1637796312570572, 0.08505887538194656, 0.07616938650608063], [0.09140310436487198, 0.09139634668827057, 0.09125296771526337, 0.09086622297763824, 0.09099555015563965, 0.09136933833360672, 0.0909821018576622, 0.0913558378815651, 0.08743268996477127, 0.09115193784236908, 0.09179394692182541], [0.09273470193147659, 0.0927085429430008, 0.09215445071458817, 0.0906720831990242, 0.09116580337285995, 0.09260398149490356, 0.09111437946557999, 0.09255173802375793, 0.07827086001634598, 0.09176550805568695, 0.09425792843103409]], [[0.09091545641422272, 0.09045878052711487, 0.09044655412435532, 0.09112779796123505, 0.09111547470092773, 0.09110315144062042, 0.09109082818031311, 0.09082941710948944, 0.09106618911027908, 0.09080485254526138, 0.09104155749082565], [0.09091169387102127, 0.09073033183813095, 0.09072546660900116, 0.09099583327770233, 0.09099095314741135, 0.09098607301712036, 0.09098119288682938, 0.09087757021188736, 0.0909714326262474, 0.09086782485246658, 0.09096167236566544], [0.09091158956289291, 0.09073763340711594, 0.09073296934366226, 0.0909922868013382, 0.09098760783672333, 0.09098292887210846, 0.090978242456913, 0.09087885916233063, 0.09096888452768326, 0.09086950868368149, 0.09095952659845352], [0.09091711044311523, 0.09033317118883133, 0.09031753242015839, 0.09118890762329102, 0.09117312729358673, 0.09115734696388245, 0.09114157408475876, 0.09080702811479568, 0.09111002832651138, 0.09077560901641846, 0.0910784974694252], [0.09091702848672867, 0.09034045785665512, 0.09032502770423889, 0.09118537604808807, 0.0911697968840599, 0.09115421772003174, 0.09113864600658417, 0.09080834686756134, 0.09110750257968903, 0.09077731519937515, 0.09107636660337448], [0.09091692417860031, 0.09034772962331772, 0.09033248573541641, 0.09118182212114334, 0.09116644412279129, 0.09115106612443924, 0.09113568812608719, 0.09080962836742401, 0.09110495448112488, 0.09077899903059006, 0.09107422083616257], [0.09091682732105255, 0.09035501629114151, 0.09033997356891632, 0.0911782830953598, 0.09116310626268387, 0.09114792197942734, 0.091132752597332, 0.09081093221902847, 0.09110241383314133, 0.09078069776296616, 0.09107208251953125], [0.0909147560596466, 0.09050978720188141, 0.09049893170595169, 0.0911029800772667, 0.0910920575261116, 0.09108113497495651, 0.09107021242380142, 0.0908384770154953, 0.09104837477207184, 0.09081669896841049, 0.09102654457092285], [0.09091663360595703, 0.0903695672750473, 0.09035491943359375, 0.09117119014263153, 0.09115641564130783, 0.09114163368940353, 0.09112686663866043, 0.0908135250210762, 0.09109732508659363, 0.09078408032655716, 0.09106779098510742], [0.09091456234455109, 0.09052436798810959, 0.09051390737295151, 0.09109589457511902, 0.09108537435531616, 0.09107484668493271, 0.09106432646512985, 0.09084106981754303, 0.09104329347610474, 0.09082008898258209, 0.09102225303649902], [0.09091644734144211, 0.09038414061069489, 0.09036988765001297, 0.09116411209106445, 0.09114973247051239, 0.09113536030054092, 0.09112098067998886, 0.09081612527370453, 0.09109225124120712, 0.09078748524188995, 0.09106351435184479]], [[0.0919356420636177, 0.09163232892751694, 0.09190705418586731, 0.09080269187688828, 0.09107492864131927, 0.09186417609453201, 0.09104660153388977, 0.09183561056852341, 0.08373115956783295, 0.09140470623970032, 0.09276507794857025], [0.09163347631692886, 0.09142159670591354, 0.09161350876092911, 0.09084098786115646, 0.09103168547153473, 0.09158357232809067, 0.09101185202598572, 0.0915636196732521, 0.08582546561956406, 0.09126245975494385, 0.09221180528402328], [0.09190739691257477, 0.09161270409822464, 0.09187961369752884, 0.09080652892589569, 0.09107109159231186, 0.09183796495199203, 0.09104356169700623, 0.0918102115392685, 0.08392631262540817, 0.09139154106378555, 0.09271309524774551], [0.09077845513820648, 0.09081560373306274, 0.09078195691108704, 0.0909179151058197, 0.09088422358036041, 0.09078719466924667, 0.09088773280382156, 0.09079068899154663, 0.09183507412672043, 0.090843565762043, 0.09067758172750473], [0.09106370806694031, 0.09101932495832443, 0.09105952829122543, 0.09089729189872742, 0.09093744307756424, 0.09105326235294342, 0.09093327075242996, 0.09104908257722855, 0.0898166373372078, 0.09098593890666962, 0.09118443727493286], [0.0918649360537529, 0.09158318489789963, 0.09183838218450546, 0.09081219136714935, 0.09106524288654327, 0.0917985588312149, 0.09103891253471375, 0.09177201986312866, 0.084219790995121, 0.09137170761823654, 0.09263508021831512], [0.09103425592184067, 0.09099836647510529, 0.09103087335824966, 0.09089966118335724, 0.09093213826417923, 0.09102580696344376, 0.09092876315116882, 0.09102243185043335, 0.09002450853586197, 0.09097136557102203, 0.09113186597824097], [0.0918365940451622, 0.09156345576047897, 0.09181084483861923, 0.09081590175628662, 0.09106127172708511, 0.09177224338054657, 0.09103574603796005, 0.09174651652574539, 0.084415964782238, 0.09135841578245163, 0.09258304536342621], [0.08145660161972046, 0.08349297195672989, 0.0816461443901062, 0.08936423063278198, 0.08738753944635391, 0.08193128556013107, 0.08759088069200516, 0.08212193846702576, 0.16377970576286316, 0.08505909889936447, 0.07616959512233734], [0.09140310436487198, 0.09125971049070358, 0.09138958901166916, 0.09086622297763824, 0.09099555015563965, 0.09136933833360672, 0.0909821018576622, 0.0913558378815651, 0.08743270486593246, 0.09115193784236908, 0.09179394692182541], [0.09273470938205719, 0.09218046069145203, 0.09268239885568619, 0.0906720981001854, 0.09116581827402115, 0.09260398149490356, 0.09111438691616058, 0.09255174547433853, 0.07827088981866837, 0.09176551550626755, 0.09425793588161469]], [[0.09093794226646423, 0.09048115462064743, 0.09022149443626404, 0.09115033596754074, 0.09113800525665283, 0.09087646752595901, 0.09111335873603821, 0.0911010354757309, 0.09108871221542358, 0.09107639640569687, 0.09081503003835678], [0.09092064946889877, 0.09073927253484726, 0.09063591808080673, 0.09100479632616043, 0.09099991619586945, 0.09089626371860504, 0.09099015593528748, 0.09098527580499649, 0.0909803956747055, 0.09097551554441452, 0.0908718928694725], [0.09091061353683472, 0.09088674187660217, 0.090873122215271, 0.09092167764902115, 0.09092103689908981, 0.09090740978717804, 0.09091975539922714, 0.0909191146492958, 0.09091846644878387, 0.09091783314943314, 0.09090420603752136], [0.09094586223363876, 0.09036173671483994, 0.09003005921840668, 0.09121774137020111, 0.09120196104049683, 0.09086719155311584, 0.09117039293050766, 0.09115462005138397, 0.09113883972167969, 0.091123066842556, 0.0907885953783989], [0.09094540029764175, 0.09036865830421448, 0.0900411456823349, 0.09121383726596832, 0.09119825065135956, 0.09086773544549942, 0.09116709232330322, 0.09115151315927505, 0.09113594144582748, 0.09112036973237991, 0.09079013019800186], [0.09093564003705978, 0.09051580727100372, 0.09027706831693649, 0.0911308005452156, 0.09111947566270828, 0.09087914228439331, 0.09109682589769363, 0.09108550101518631, 0.09107418358325958, 0.09106286615133286, 0.09082268923521042], [0.09094447642564774, 0.09038249403238297, 0.09006332606077194, 0.09120601415634155, 0.09119082987308502, 0.09086880832910538, 0.09116046875715256, 0.09114529937505722, 0.09113012254238129, 0.09111495316028595, 0.0907931923866272], [0.09094402939081192, 0.0903894230723381, 0.09007442742586136, 0.09120211005210876, 0.09118712693452835, 0.09086934477090836, 0.09115716814994812, 0.0911421924829483, 0.09112721681594849, 0.09111224859952927, 0.09079473465681076], [0.09094357490539551, 0.09039635211229324, 0.09008552134037018, 0.09119820594787598, 0.09118342399597168, 0.09086988866329193, 0.09115386754274368, 0.09113909304141998, 0.09112431854009628, 0.09110954403877258, 0.09079626947641373], [0.0909431129693985, 0.09040326625108719, 0.090096615254879, 0.09119429439306259, 0.09117971360683441, 0.09087042510509491, 0.09115055203437805, 0.09113597869873047, 0.09112140536308289, 0.0911068320274353, 0.0907977968454361], [0.09093333035707474, 0.09055045247077942, 0.09033265709877014, 0.09111125767230988, 0.09110093116760254, 0.0908818170428276, 0.09108028560876846, 0.09106996655464172, 0.09105964750051498, 0.09104932099580765, 0.09083033353090286]], [[0.09149818122386932, 0.09169412404298782, 0.09168393164873123, 0.09110010415315628, 0.0908852219581604, 0.09144734591245651, 0.09086502343416214, 0.0914270281791687, 0.08577872812747955, 0.0913255587220192, 0.09229477494955063], [0.09171467274427414, 0.09198576211929321, 0.09197165071964264, 0.09116461127996445, 0.09086807072162628, 0.09164437651634216, 0.09084021300077438, 0.09161628037691116, 0.08390014618635178, 0.09147602319717407, 0.09281812608242035], [0.09170351922512054, 0.09197069704532623, 0.09195679426193237, 0.09116137027740479, 0.09086907655000687, 0.09163425117731094, 0.0908416137099266, 0.09160654991865158, 0.08399682492017746, 0.09146831184625626, 0.09279097616672516], [0.09104474633932114, 0.09108880162239075, 0.09108651429414749, 0.09095501154661179, 0.09090644866228104, 0.09103330224752426, 0.09090187400579453, 0.09102872759103775, 0.08972533792257309, 0.09100586920976639, 0.09122340381145477], [0.0907922089099884, 0.09075473994016647, 0.09075668454170227, 0.09086862951517105, 0.09091005474328995, 0.09080194681882858, 0.09091395139694214, 0.09080584347248077, 0.09193015843629837, 0.09082530438899994, 0.09064047038555145], [0.09144129604101181, 0.09161778539419174, 0.09160860627889633, 0.0910826325416565, 0.09088895469903946, 0.09139550477266312, 0.09087074548006058, 0.09137719869613647, 0.08627288788557053, 0.09128578007221222, 0.09215857088565826], [0.09076819568872452, 0.09072308242321014, 0.09072542190551758, 0.09086022526025772, 0.09091010689735413, 0.09077992290258408, 0.09091480076313019, 0.09078460931777954, 0.09214017540216446, 0.09080804884433746, 0.09058550745248795], [0.09141846746206284, 0.09158718585968018, 0.091578409075737, 0.09107555449008942, 0.09089036285877228, 0.09137469530105591, 0.09087295830249786, 0.09135718643665314, 0.08647126704454422, 0.09126979112625122, 0.09210406243801117], [0.08289933949708939, 0.08106565475463867, 0.08115991204977036, 0.08676619827747345, 0.08893529325723648, 0.08338242769241333, 0.08914224803447723, 0.08357645571231842, 0.1628040075302124, 0.08455251902341843, 0.07571598142385483], [0.09130381047725677, 0.09143375605344772, 0.09142699837684631, 0.09103952348232269, 0.09089670330286026, 0.0912700816988945, 0.090883269906044, 0.09125659614801407, 0.08746849745512009, 0.09118925034999847, 0.0918315201997757], [0.09235180914402008, 0.09285467118024826, 0.09282848238945007, 0.09133527427911758, 0.09078938513994217, 0.09222161769866943, 0.09073817729949951, 0.09216959774494171, 0.07839427143335342, 0.09191014617681503, 0.09440650045871735]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1533193586509346e-05, "add_observations_from_episodes_to_batch": 2.7543498553652806e-06, "batch_individual_items": 1.1946280680567598e-05, "add_time_dim_to_batch_and_zero_pad": 6.688361174591327e-06, "add_states_from_episodes_to_batch": 2.6887974407136096e-06}}, "connector_pipeline_timer": 5.683156670418043e-05}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.739423905430457e-06, "tensor_to_numpy": 1.4646217592997802e-05, "remove_single_ts_time_rank_from_batch": 1.1609196147610295e-05, "get_actions": 3.463779423445822e-05, "listify_data_for_vector_env": 1.009238342311715e-05, "un_batch_to_individual_items": 6.331007728375387e-06}}, "connector_pipeline_timer": 0.00011034192708405085}, "rlmodule_inference_timer": 3.0200753989042353e-05, "episode_return_mean": -1.1, "module_episode_returns_mean": {"default_policy": -1.1}, "weights_seq_no": 17.0, "episode_return_max": 15.5, "num_episodes_lifetime": 340, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.3604478473219633e-05, "episode_len_min": 20, "env_reset_timer": 0.0006438081705451794, "num_env_steps_sampled_lifetime": 85400, "num_env_steps_sampled": 400, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "episode_duration_sec_mean": 0.005181392866652459, "episode_return_min": -13.5, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "sample": 0.13170381178395896, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "agent_episode_returns_mean": {"default_agent": -1.1}, "time_between_sampling": 9.518567212436043}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "ba99e_00000", "date": "2025-08-11_18-55-22", "timestamp": 1754931322, "time_this_iter_s": 9.383468866348267, "time_total_s": 162.18639135360718, "pid": 11884, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1619f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 162.18639135360718, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 29.83846153846154, "ram_util_percent": 77.76923076923076}}
{"timers": {"training_iteration": 10.072714813479045, "restore_env_runners": 8.956740146431601e-06, "training_step": 10.072513042958137, "env_runner_sampling_timer": 1.6487142605718557, "learner_update_timer": 8.246696542974547, "synch_weights": 0.0016169852285616124, "restore_eval_env_runners": 6.330700653578596e-05, "evaluation_iteration": 0.1436795633911177, "synch_eval_env_connectors": 0.00017852416855356734, "synch_env_connectors": 5.411229626700711e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2356405019976812e-05, "add_observations_from_episodes_to_batch": 2.753336646609278e-06, "batch_individual_items": 1.225399718146216e-05, "add_time_dim_to_batch_and_zero_pad": 6.972884111899326e-06, "add_states_from_episodes_to_batch": 2.7199846148293686e-06}}, "connector_pipeline_timer": 5.898404883728851e-05}, "module_to_env_connector": {"connector_pipeline_timer": 0.0001167543041826429, "timers": {"connectors": {"get_actions": 3.922902547948105e-05, "normalize_and_clip_actions": 7.814026438987364e-06, "un_batch_to_individual_items": 6.453532040161003e-06, "listify_data_for_vector_env": 1.0282990635268353e-05, "tensor_to_numpy": 1.5219374501231952e-05, "remove_single_ts_time_rank_from_batch": 1.1663841336702892e-05}}}, "weights_seq_no": 17.0, "episode_return_max": 14.5, "episode_duration_sec_mean": 0.005213495533447715, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "env_reset_timer": 3.18627348653147e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -493500.0, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "episode_return_min": -5.5, "agent_episode_returns_mean": {"default_agent": 6.019999999999998}, "num_env_steps_sampled_lifetime": -9870000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "env_step_timer": 1.3528923408044566e-05, "time_between_sampling": 0.0317441992508926, "num_episodes": 250.0, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 6.019999999999998}, "sample": 0.005545204481575258, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 3.143982638122025e-05, "episode_return_mean": 6.019999999999998, "episode_len_max": 20, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3330.3716113268692}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13503486754584082, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009275088464209342, "add_observations_from_episodes_to_batch": 0.0008361023829921083, "add_columns_from_episodes_to_train_batch": 0.041618854095560695, "add_time_dim_to_batch_and_zero_pad": 0.07558426089760817, "add_states_from_episodes_to_batch": 0.0035040544093950083, "batch_individual_items": 0.003984514781967822, "numpy_to_tensor": 7.334035879785712e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 646380, "module_train_batch_size_mean": 997.4982334615715, "vf_explained_var": 0.0010875463485717773, "total_loss": 0.2783712148666382, "weights_seq_no": 108.0, "vf_loss_unclipped": 47.77180099487305, "diff_num_grad_updates_vs_sampler_policy": 91.0, "entropy": 0.6856276392936707, "vf_loss": 0.35872721672058105, "policy_loss": -3.8620793930022046e-05, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 6.63653781884932e-06}, "__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1292760, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 3564000, "num_env_steps_trained_lifetime_throughput": 44063.042277789405}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 91.0, "num_module_steps_trained": 35910, "total_loss": 0.0, "num_module_steps_trained_lifetime": 646380, "module_train_batch_size_mean": 997.4982334615715, "weights_seq_no": 108.0}}}, "intrinsic_reward_module": {"total_loss": 0.0, "weights_seq_no": 18.0, "num_trainable_parameters": 8266, "num_module_steps_trained_lifetime": 107730, "module_train_batch_size_mean": 997.6672132667843, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 717.8317498620606}, "default_policy": {"use_intrinsic_rewards": 0.0, "num_trainable_parameters": 16595, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 107730, "module_train_batch_size_mean": 997.6672132667843, "vf_explained_var": 0.0010140538215637207, "total_loss": 0.2780407965183258, "weights_seq_no": 18.0, "mean_kl_loss": 6.7551354732131585e-06, "vf_loss_unclipped": 47.77821350097656, "curr_kl_coeff": 6.163937769088079e-07, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.6856235265731812, "vf_loss": 0.3583056926727295, "curr_entropy_coeff": 0.0015431216992, "policy_loss": -3.9625218050787225e-05, "num_module_steps_trained_lifetime_throughput": 717.826619812729}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 215460, "num_env_steps_trained_lifetime": 594000, "num_env_steps_trained": 33000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 3958.9169556222787, "num_module_steps_trained_throughput": 21162693.309238687, "num_module_steps_trained_lifetime_throughput": 12719464.292660488}, "IntrinsicAttentionMask": [[[0.09093811362981796, 0.09048133343458176, 0.09046909213066101, 0.09115050733089447, 0.09088892489671707, 0.09112585335969925, 0.09111353009939194, 0.09085205942392349, 0.09108888357877731, 0.0910765677690506, 0.09081520140171051], [0.09092066437005997, 0.09073928743600845, 0.09073442220687866, 0.09100481122732162, 0.09090115875005722, 0.09099505096673965, 0.09099017083644867, 0.09088653326034546, 0.0909804105758667, 0.09097553044557571, 0.0908719077706337], [0.09092019498348236, 0.09074622392654419, 0.09074155986309052, 0.09100089967250824, 0.09090148657560349, 0.0909915342926979, 0.09098685532808304, 0.09088745713233948, 0.0909774973988533, 0.09097281098365784, 0.09087343513965607], [0.09094611555337906, 0.09036199003458023, 0.09034635871648788, 0.091218002140522, 0.09088318049907684, 0.09118643403053284, 0.09117065370082855, 0.09083601087331772, 0.09113910049200058, 0.09112332761287689, 0.09078885614871979], [0.09093624353408813, 0.09050901979207993, 0.09049756824970245, 0.09113485366106033, 0.09089025110006332, 0.09111180156469345, 0.09110027551651001, 0.09085576981306076, 0.09107723832130432, 0.09106571227312088, 0.0908212959766388], [0.09094519168138504, 0.09037582576274872, 0.09036058187484741, 0.09121017158031464, 0.09088385105133057, 0.09117940813302994, 0.09116402268409729, 0.09083786606788635, 0.09113327413797379, 0.09111790359020233, 0.09079191088676453], [0.09094472974538803, 0.09038273990154266, 0.09036768972873688, 0.09120626002550125, 0.09088417887687683, 0.09117589145898819, 0.09116071462631226, 0.09083879739046097, 0.09113036841154099, 0.09111519902944565, 0.0907934382557869], [0.09093484282493591, 0.09052978456020355, 0.09051892161369324, 0.09112310409545898, 0.09089123457670212, 0.0911012515425682, 0.09109032899141312, 0.09085854142904282, 0.09106848388910294, 0.09105756878852844, 0.0908258706331253], [0.09094379842281342, 0.09039656817913055, 0.0903819128870964, 0.09119842946529388, 0.09088484942913055, 0.09116886556148529, 0.09115409106016159, 0.0908406600356102, 0.09112454205751419, 0.09110976755619049, 0.09079649299383163], [0.09094332903623581, 0.0904034897685051, 0.09038903564214706, 0.0911945179104805, 0.09088518470525742, 0.09116535633802414, 0.09115077555179596, 0.09084159135818481, 0.0911216288805008, 0.09110705554485321, 0.090798020362854], [0.09093344211578369, 0.09055056422948837, 0.09054029732942581, 0.09111136943101883, 0.0908922329545021, 0.09109072387218475, 0.09108039736747742, 0.09086132794618607, 0.09105975925922394, 0.0910494327545166, 0.09083044528961182]], [[0.09021209180355072, 0.0895175039768219, 0.09014648199081421, 0.08763334155082703, 0.0882490798830986, 0.0900481566786766, 0.08753776550292969, 0.08932233601808548, 0.10933667421340942, 0.08899827301502228, 0.08899827301502228], [0.09032098203897476, 0.08971430361270905, 0.09026370197534561, 0.08806557208299637, 0.0886048674583435, 0.09017784893512726, 0.08798180520534515, 0.08954373002052307, 0.10680638998746872, 0.08926039934158325, 0.08926039934158325], [0.09022259712219238, 0.08953627198934555, 0.09015777707099915, 0.08767419308423996, 0.08828277140855789, 0.09006062895059586, 0.08757971972227097, 0.08934341371059418, 0.10909629613161087, 0.0890231728553772, 0.0890231728553772], [0.09059018641710281, 0.0902271568775177, 0.09055595844984055, 0.08923549205064774, 0.08956068009138107, 0.09050463140010834, 0.08918491750955582, 0.09012490510940552, 0.10010635107755661, 0.08995488286018372, 0.08995488286018372], [0.09050643444061279, 0.0900629460811615, 0.09046459943056107, 0.08885356038808823, 0.08924981951713562, 0.09040188044309616, 0.08879196643829346, 0.08993811160326004, 0.10226946324110031, 0.08973060548305511, 0.08973060548305511], [0.09023825824260712, 0.08956433087587357, 0.0901746079325676, 0.08773539960384369, 0.08833321928977966, 0.09007921069860458, 0.0876425951719284, 0.08937493711709976, 0.10873658210039139, 0.08906044065952301, 0.08906044065952301], [0.0906028226017952, 0.0902523472905159, 0.09056977927684784, 0.08929474651813507, 0.0896088033914566, 0.0905202254652977, 0.08924589306116104, 0.09015362709760666, 0.0997728779911995, 0.08998946845531464, 0.08998946845531464], [0.09035064280033112, 0.08976885676383972, 0.09029572457075119, 0.08818692713975906, 0.08870450407266617, 0.09021340310573578, 0.08810652047395706, 0.08960524946451187, 0.10610124468803406, 0.08933346718549728, 0.08933346718549728], [0.08530892431735992, 0.08259335905313492, 0.08504954725503922, 0.075557641685009, 0.07780460268259048, 0.08466197550296783, 0.07521332055330276, 0.08184230327606201, 0.19075489044189453, 0.08060674369335175, 0.08060674369335175], [0.09039899706840515, 0.08985871076583862, 0.09034799784421921, 0.08838833123445511, 0.0888696163892746, 0.09027156233787537, 0.08831354975700378, 0.08970672637224197, 0.10493607074022293, 0.08945420384407043, 0.08945420384407043], [0.09039899706840515, 0.08985871076583862, 0.09034799784421921, 0.08838833123445511, 0.0888696163892746, 0.09027156233787537, 0.08831354975700378, 0.08970672637224197, 0.10493607074022293, 0.08945420384407043, 0.08945420384407043]], [[0.09096063673496246, 0.0902562290430069, 0.09049150347709656, 0.0909237414598465, 0.09091144055128098, 0.09089913964271545, 0.09113609790802002, 0.09112377464771271, 0.0911114439368248, 0.09109912812709808, 0.09108680486679077], [0.09091264009475708, 0.09086434543132782, 0.09088051319122314, 0.09091012179851532, 0.09090927988290787, 0.09090844541788101, 0.09092462062835693, 0.09092377871274948, 0.09092294424772263, 0.09092210233211517, 0.09092126041650772], [0.09092879295349121, 0.09066032618284225, 0.09075013548135757, 0.0909147635102272, 0.09091007709503174, 0.09090540558099747, 0.09099546074867249, 0.09099078178405762, 0.09098610281944275, 0.09098141640424728, 0.09097673743963242], [0.09095815569162369, 0.09028788655996323, 0.09051178395748138, 0.09092305600643158, 0.09091135114431381, 0.09089965373277664, 0.09112507104873657, 0.09111334383487701, 0.09110162407159805, 0.09108990430831909, 0.09107818454504013], [0.09095732122659683, 0.09029844403266907, 0.09051854908466339, 0.09092281758785248, 0.09091131389141083, 0.09089981764554977, 0.09112139046192169, 0.09110986441373825, 0.09109833836555481, 0.09108681976795197, 0.09107530117034912], [0.09095649421215057, 0.09030899405479431, 0.0905253067612648, 0.09092259407043457, 0.09091129153966904, 0.0908999890089035, 0.09111771732568741, 0.09110639244318008, 0.09109506756067276, 0.09108374267816544, 0.09107242524623871], [0.0909724310040474, 0.09010601788759232, 0.0903952345252037, 0.09092701226472855, 0.0909118726849556, 0.09089673310518265, 0.09118849039077759, 0.09117330610752106, 0.09115812927484512, 0.09114295244216919, 0.09112778306007385], [0.09097161144018173, 0.09011655300855637, 0.09040198475122452, 0.09092678129673004, 0.0909118503332138, 0.09089691191911697, 0.0911848172545433, 0.09116984158754349, 0.09115485846996307, 0.09113988280296326, 0.09112491458654404], [0.09097078442573547, 0.09012708812952042, 0.09040874242782593, 0.09092655032873154, 0.09091181308031082, 0.0908970758318901, 0.09118113666772842, 0.09116636216640472, 0.09115158021450043, 0.09113680571317673, 0.09112203121185303], [0.09096995741128922, 0.09013763070106506, 0.09041550010442734, 0.09092632681131363, 0.09091179072856903, 0.09089724719524384, 0.09117746353149414, 0.09116288274526596, 0.09114830940961838, 0.0911337286233902, 0.09111916273832321], [0.09096913039684296, 0.09014816582202911, 0.09042225033044815, 0.09092609584331512, 0.09091175347566605, 0.09089741855859756, 0.09117378294467926, 0.0911594033241272, 0.09114503115415573, 0.09113065898418427, 0.0911162793636322]], [[0.09015247970819473, 0.09011968970298767, 0.0900869071483612, 0.08757542818784714, 0.08819076418876648, 0.08932827413082123, 0.08747991919517517, 0.08992321044206619, 0.10926437377929688, 0.08893946558237076, 0.08893946558237076], [0.09015808254480362, 0.09012549370527267, 0.09009290486574173, 0.08759619295597076, 0.08820795267820358, 0.08933877944946289, 0.08750122785568237, 0.08993017673492432, 0.10914462804794312, 0.08895225822925568, 0.08895225822925568], [0.0901636928319931, 0.09013129770755768, 0.09009891003370285, 0.08761695772409439, 0.08822512626647949, 0.08934927731752396, 0.08752254396677017, 0.08993715792894363, 0.1090250164270401, 0.08896505832672119, 0.08896505832672119], [0.09055887162685394, 0.0905417650938034, 0.09052465111017227, 0.08920464664697647, 0.08952972292900085, 0.09012780338525772, 0.08915407955646515, 0.09043914824724197, 0.1000717282295227, 0.08992379158735275, 0.08992379158735275], [0.09046822041273117, 0.0904473066329956, 0.09042640030384064, 0.08881605416536331, 0.08921214193105698, 0.08994171023368835, 0.08875447511672974, 0.09032193571329117, 0.10222626477479935, 0.08969271928071976, 0.08969271928071976], [0.09029008448123932, 0.09026223421096802, 0.09023440629243851, 0.08809701353311539, 0.08862154930830002, 0.08958973735570908, 0.08801554143428802, 0.09009536355733871, 0.10627608746290207, 0.08925901353359222, 0.08925901353359222], [0.09057258814573288, 0.0905560627579689, 0.09053955227136612, 0.08926495164632797, 0.08957890421152115, 0.0901564210653305, 0.08921611309051514, 0.0904570072889328, 0.09973956644535065, 0.08995943516492844, 0.08995943516492844], [0.09019146114587784, 0.09016004949808121, 0.09012863785028458, 0.08772056549787521, 0.08831083029508591, 0.08940154314041138, 0.08762892335653305, 0.08997175842523575, 0.10842857509851456, 0.08902879059314728, 0.08902879059314728], [0.08508959412574768, 0.08496014028787613, 0.0848308876156807, 0.0753634124994278, 0.07760458439588547, 0.0818808451294899, 0.07501997798681259, 0.0841875672340393, 0.19026394188404083, 0.0803995132446289, 0.0803995132446289], [0.09035250544548035, 0.09032701700925827, 0.09030153602361679, 0.08834288269281387, 0.08882392197847366, 0.08971119672060013, 0.08826814591884613, 0.09017424285411835, 0.10488207638263702, 0.08940821141004562, 0.08940821141004562], [0.09035250544548035, 0.09032701700925827, 0.09030153602361679, 0.08834288269281387, 0.08882392197847366, 0.08971119672060013, 0.08826814591884613, 0.09017424285411835, 0.10488207638263702, 0.08940821141004562, 0.08940821141004562]], [[0.08990312367677689, 0.09051094949245453, 0.09049469232559204, 0.091401107609272, 0.09105288982391357, 0.09136827290058136, 0.09102018177509308, 0.09100383520126343, 0.09098748117685318, 0.09130264073610306, 0.09095479547977448], [0.08944571763277054, 0.0903286263346672, 0.09030497074127197, 0.09162653237581253, 0.09111811965703964, 0.09157855063676834, 0.09107040613889694, 0.09104656428098679, 0.09102271497249603, 0.09148267656564713, 0.09097505360841751], [0.08945789188146591, 0.0903334841132164, 0.09031002968549728, 0.09162051975727081, 0.09111638367176056, 0.09157294780015945, 0.09106907248497009, 0.09104542434215546, 0.09102178364992142, 0.0914778783917427, 0.09097452461719513], [0.08878479897975922, 0.09006373584270477, 0.09002940356731415, 0.09195419400930405, 0.091212198138237, 0.09188409894704819, 0.09114266186952591, 0.09110791981220245, 0.0910731852054596, 0.09174405783414841, 0.09100376069545746], [0.08904209733009338, 0.09016706794500351, 0.09013689309358597, 0.09182637184858322, 0.09117560088634491, 0.0917649194598198, 0.0911145880818367, 0.09108409285545349, 0.09105361253023148, 0.09164213389158249, 0.09099267423152924], [0.08880899101495743, 0.09007346630096436, 0.09003952145576477, 0.09194216132164001, 0.09120876342058182, 0.09187287837266922, 0.0911400243639946, 0.09110568463802338, 0.09107135236263275, 0.09173446893692017, 0.09100272506475449], [0.08906634896993637, 0.0901767909526825, 0.090147003531456, 0.09181433916091919, 0.09117215126752853, 0.09175369888544083, 0.0911119356751442, 0.09108184278011322, 0.09105175733566284, 0.09163253754377365, 0.09099162369966507], [0.08907846361398697, 0.09018164128065109, 0.09015204757452011, 0.09180831164121628, 0.09117041528224945, 0.09174808114767075, 0.09111059457063675, 0.09108070284128189, 0.09105081856250763, 0.09162773191928864, 0.0909910798072815], [0.08909059315919876, 0.09018649905920029, 0.09015711396932602, 0.09180229902267456, 0.09116868674755096, 0.09174247086048126, 0.0911092758178711, 0.09107957780361176, 0.09104990214109421, 0.09162293374538422, 0.09099055826663971], [0.08885738998651505, 0.09009291231632233, 0.09005974978208542, 0.09191808849573135, 0.09120187163352966, 0.09185042977333069, 0.09113474190235138, 0.09110119938850403, 0.09106766432523727, 0.0917152687907219, 0.09100063145160675], [0.08911485970020294, 0.09019624441862106, 0.09016723930835724, 0.09179028123617172, 0.09116524457931519, 0.09173126518726349, 0.09110663086175919, 0.09107733517885208, 0.09104805439710617, 0.09161335229873657, 0.09098951518535614]], [[0.09203947335481644, 0.09202516078948975, 0.0917215496301651, 0.09090525656938553, 0.091177798807621, 0.09167876839637756, 0.09114944189786911, 0.09165025502443314, 0.08356224745512009, 0.09122022986412048, 0.0928698480129242], [0.09202389419078827, 0.09200979024171829, 0.09171050041913986, 0.09090575575828552, 0.09117445349693298, 0.09166832268238068, 0.09114649146795273, 0.09164021164178848, 0.08366196602582932, 0.09121628105640411, 0.09284237027168274], [0.09169046580791473, 0.09168067574501038, 0.09147295355796814, 0.09091337770223618, 0.09110037982463837, 0.09144365787506104, 0.0910809338092804, 0.0914241373538971, 0.0858064591884613, 0.09112947434186935, 0.09225746989250183], [0.0907655581831932, 0.09076730906963348, 0.09080445021390915, 0.09090499579906464, 0.09087131172418594, 0.09080969542264938, 0.0908748134970665, 0.09081318974494934, 0.09185780584812164, 0.0908660814166069, 0.09066469967365265], [0.09107906371355057, 0.09107697755098343, 0.09103258699178696, 0.09091261774301529, 0.09095277637243271, 0.09102632105350494, 0.09094860404729843, 0.09102214872837067, 0.08979005366563797, 0.09095901995897293, 0.09119981527328491], [0.09164302796125412, 0.09163384884595871, 0.09143900871276855, 0.09091400355100632, 0.09108947217464447, 0.0914115235209465, 0.0910712257027626, 0.09139320999383926, 0.08611320704221725, 0.0911167711019516, 0.0921747237443924], [0.09104667603969574, 0.09104498475790024, 0.09100908786058426, 0.09091205894947052, 0.09094454348087311, 0.09100402891635895, 0.0909411683678627, 0.09100064635276794, 0.09000295400619507, 0.09094958752393723, 0.09114430099725723], [0.0916113406419754, 0.09160257130861282, 0.09141630679368973, 0.09091434627771378, 0.0910821259021759, 0.09139003604650497, 0.09106467664241791, 0.0913725346326828, 0.0863182470202446, 0.09110823273658752, 0.09211952984333038], [0.08020351827144623, 0.08030034601688385, 0.08238545805215836, 0.08830133825540543, 0.08627443760633469, 0.08268418908119202, 0.08648286014795303, 0.08288393914699554, 0.16971445083618164, 0.08596362918615341, 0.07480587065219879], [0.09112744778394699, 0.0911247506737709, 0.09106765687465668, 0.09091336280107498, 0.09096500277519226, 0.0910595953464508, 0.09095963090658188, 0.09105422347784042, 0.0894724652171135, 0.09097302705049515, 0.09128282219171524], [0.09292269498109818, 0.0928964838385582, 0.09234126657247543, 0.0908559113740921, 0.09135063737630844, 0.09226314723491669, 0.09129910171031952, 0.09221109747886658, 0.07798289507627487, 0.0914277657866478, 0.0944490134716034]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3619744153550815e-05, "add_observations_from_episodes_to_batch": 2.895554220518195e-06, "batch_individual_items": 1.3449525919599052e-05, "add_time_dim_to_batch_and_zero_pad": 7.183157361048422e-06, "add_states_from_episodes_to_batch": 2.9022127014298986e-06}}, "connector_pipeline_timer": 6.299925671867034e-05}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.397038156025783e-06, "tensor_to_numpy": 1.6427815802896056e-05, "remove_single_ts_time_rank_from_batch": 1.2413867001625188e-05, "get_actions": 4.062885549479054e-05, "listify_data_for_vector_env": 1.102084263258837e-05, "un_batch_to_individual_items": 6.841599542219796e-06}}, "connector_pipeline_timer": 0.000123808829339289}, "rlmodule_inference_timer": 3.349953950471919e-05, "episode_return_mean": -0.5, "module_episode_returns_mean": {"default_policy": -0.5}, "weights_seq_no": 18.0, "episode_return_max": 15.5, "num_episodes_lifetime": 360, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.532098347435269e-05, "episode_len_min": 20, "env_reset_timer": 0.0006387859180139482, "num_env_steps_sampled_lifetime": 90400, "num_env_steps_sampled": 400, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "episode_duration_sec_mean": 0.005231297055725008, "episode_return_min": -13.5, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "sample": 0.1316042274171339, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "agent_episode_returns_mean": {"default_agent": -0.5}, "time_between_sampling": 9.517441703231023}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "ba99e_00000", "date": "2025-08-11_18-55-32", "timestamp": 1754931332, "time_this_iter_s": 9.51237416267395, "time_total_s": 171.69876551628113, "pid": 11884, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1619f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 171.69876551628113, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 26.307142857142857, "ram_util_percent": 77.53571428571429}}
{"timers": {"training_iteration": 10.068535994933677, "restore_env_runners": 8.940091810100022e-06, "training_step": 10.068334245858308, "env_runner_sampling_timer": 1.6480667708765, "learner_update_timer": 8.243159578794339, "synch_weights": 0.0016099445354285041, "restore_eval_env_runners": 6.28481065975666e-05, "evaluation_iteration": 0.1435274923475751, "synch_eval_env_connectors": 0.00017829226698454743, "synch_env_connectors": 5.393788156809188e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3241344881741207e-05, "add_observations_from_episodes_to_batch": 2.867187578037108e-06, "batch_individual_items": 1.28307259600505e-05, "add_time_dim_to_batch_and_zero_pad": 7.3318163663181804e-06, "add_states_from_episodes_to_batch": 2.8256288638045334e-06}}, "connector_pipeline_timer": 6.181895537612754e-05}, "module_to_env_connector": {"connector_pipeline_timer": 0.00012259819130734344, "timers": {"connectors": {"get_actions": 4.183715098443488e-05, "normalize_and_clip_actions": 8.148456436348856e-06, "un_batch_to_individual_items": 6.7047435190849146e-06, "listify_data_for_vector_env": 1.0775259747411394e-05, "tensor_to_numpy": 1.5900583499541172e-05, "remove_single_ts_time_rank_from_batch": 1.2142763095346557e-05}}}, "weights_seq_no": 18.0, "episode_return_max": 14.5, "episode_duration_sec_mean": 0.005469692631158976, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "env_reset_timer": 3.505848132165445e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -524375.0, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "episode_return_min": -5.5, "agent_episode_returns_mean": {"default_agent": 5.940000000000001}, "num_env_steps_sampled_lifetime": -10487500.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "env_step_timer": 1.4345777665628086e-05, "time_between_sampling": 0.032528650572958125, "num_episodes": 250.0, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 5.940000000000001}, "sample": 0.005698877624426092, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 3.3195520204482724e-05, "episode_return_mean": 5.940000000000001, "episode_len_max": 20, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3175.666128007749}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13499140387046787, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009265449248504157, "add_observations_from_episodes_to_batch": 0.0008355813594880011, "add_columns_from_episodes_to_train_batch": 0.04160272388487462, "add_time_dim_to_batch_and_zero_pad": 0.07556824994880779, "add_states_from_episodes_to_batch": 0.0035048751150813405, "batch_individual_items": 0.003983434633629062, "numpy_to_tensor": 7.319320530830072e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 682290, "module_train_batch_size_mean": 997.4980069784294, "vf_explained_var": 0.001109480857849121, "total_loss": 0.2784068286418915, "weights_seq_no": 114.0, "vf_loss_unclipped": 49.498924255371094, "diff_num_grad_updates_vs_sampler_policy": 96.0, "entropy": 0.6854420900344849, "vf_loss": 0.3587082028388977, "policy_loss": 1.1564808119146619e-05, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 6.207329079188639e-06}, "__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1364580, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 3762000, "num_env_steps_trained_lifetime_throughput": 43507.755437481785}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 96.0, "num_module_steps_trained": 35910, "total_loss": 0.0, "num_module_steps_trained_lifetime": 682290, "module_train_batch_size_mean": 997.4980069784294, "weights_seq_no": 114.0}}}, "intrinsic_reward_module": {"total_loss": 0.0, "weights_seq_no": 19.0, "num_trainable_parameters": 8266, "num_module_steps_trained_lifetime": 113715, "module_train_batch_size_mean": 997.6572809365935, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 717.7777950672063}, "default_policy": {"use_intrinsic_rewards": 0.0, "num_trainable_parameters": 16595, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 113715, "module_train_batch_size_mean": 997.6572809365935, "vf_explained_var": 0.0008565783500671387, "total_loss": 0.27809008955955505, "weights_seq_no": 19.0, "mean_kl_loss": 5.94058974456857e-06, "vf_loss_unclipped": 49.59006881713867, "curr_kl_coeff": 3.0819688845440396e-07, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.6854514479637146, "vf_loss": 0.35830575227737427, "curr_entropy_coeff": 0.0015431216992, "policy_loss": 9.37319146032678e-06, "num_module_steps_trained_lifetime_throughput": 717.7730323198494}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 227430, "num_env_steps_trained_lifetime": 627000, "num_env_steps_trained": 33000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 3958.5853193180706, "num_module_steps_trained_throughput": 20720321.065619227, "num_module_steps_trained_lifetime_throughput": 12719019.406342415}, "IntrinsicAttentionMask": [[[0.08990289270877838, 0.09051071852445602, 0.09016589820384979, 0.09106902033090591, 0.09105265885591507, 0.09103630483150482, 0.09135162830352783, 0.09133521467447281, 0.09098725020885468, 0.09130240976810455, 0.09128601104021072], [0.08944523334503174, 0.09032813459634781, 0.08982691913843155, 0.091141477227211, 0.09111761301755905, 0.0910937562584877, 0.09155407547950745, 0.09153009951114655, 0.09102222323417664, 0.09148217737674713, 0.09145822376012802], [0.08970426023006439, 0.0904315784573555, 0.09001883864402771, 0.09110047668218613, 0.09108086675405502, 0.09106126427650452, 0.0914393961429596, 0.09141971170902252, 0.09100247174501419, 0.09138035029172897, 0.0913606807589531], [0.08902917057275772, 0.09016139060258865, 0.08951825648546219, 0.09120722860097885, 0.09117650240659714, 0.09114579111337662, 0.09173878282308578, 0.09170787781476974, 0.09105370938777924, 0.09164610505104065, 0.091615229845047], [0.08904130011796951, 0.09016625583171844, 0.08952725678682327, 0.09120530635118484, 0.09117478132247925, 0.09114427119493484, 0.09173338115215302, 0.09170267730951309, 0.09105279296636581, 0.09164130687713623, 0.09161064028739929], [0.0890534296631813, 0.09017112851142883, 0.08953626453876495, 0.09120339155197144, 0.09117306768894196, 0.09114275127649307, 0.09172798693180084, 0.09169749170541763, 0.09105187654495239, 0.091636523604393, 0.09160605818033218], [0.08882009983062744, 0.09007732570171356, 0.0893629640340805, 0.09124020487070084, 0.09120602160692215, 0.09117185324430466, 0.09183182567358017, 0.09179741889238358, 0.09106941521167755, 0.09172865003347397, 0.09169428050518036], [0.08883220702409744, 0.09008219093084335, 0.0893719494342804, 0.09123829007148743, 0.09120430797338486, 0.09117033332586288, 0.0918264240026474, 0.09179221838712692, 0.09106849879026413, 0.09172385185956955, 0.09168969094753265], [0.08908984065055847, 0.0901857540011406, 0.0895632952451706, 0.09119764715433121, 0.09116792678833008, 0.09113820642232895, 0.09171180427074432, 0.09168191254138947, 0.09104913473129272, 0.09162216633558273, 0.09159230440855026], [0.08885642886161804, 0.09009194374084473, 0.08938995748758316, 0.0912344679236412, 0.09120088815689087, 0.09116731584072113, 0.09181563556194305, 0.09178183972835541, 0.09106668084859848, 0.0917142853140831, 0.09168052673339844], [0.08886854350566864, 0.09009681642055511, 0.08939895033836365, 0.09123256057500839, 0.09119918197393417, 0.09116581082344055, 0.09181024134159088, 0.09177664667367935, 0.09106577932834625, 0.09170950204133987, 0.09167594462633133]], [[0.09028507024049759, 0.0895899310708046, 0.0902194157242775, 0.08770424872636795, 0.08832048624753952, 0.09012100845575333, 0.08825625479221344, 0.08939459919929504, 0.1086220070719719, 0.08841664344072342, 0.08907028287649155], [0.09038319438695908, 0.08977610617876053, 0.09032587707042694, 0.08812624216079712, 0.0886659100651741, 0.09023996442556381, 0.08860967308282852, 0.089605413377285, 0.10619564354419708, 0.08875007927417755, 0.08932189643383026], [0.09029455482959747, 0.08960768580436707, 0.09022968262434006, 0.08774413168430328, 0.08835318684577942, 0.0901324525475502, 0.08828970044851303, 0.08941467106342316, 0.10839157551527023, 0.08844821900129318, 0.08909418433904648], [0.09062498807907104, 0.09026180952787399, 0.09059073776006699, 0.08926977217197418, 0.08959508687257767, 0.09053938835859299, 0.08956122398376465, 0.09015951305627823, 0.09976229071617126, 0.08964575082063675, 0.08998943865299225], [0.09054990857839584, 0.09010620415210724, 0.09050805121660233, 0.0888962522149086, 0.08929269015789032, 0.09044529497623444, 0.08925141394138336, 0.08998130261898041, 0.10184071213006973, 0.08935446292161942, 0.08977370709180832], [0.09030865877866745, 0.08963420242071152, 0.09024496376514435, 0.08780386298894882, 0.0884021520614624, 0.09014949947595596, 0.08833979070186615, 0.08944466710090637, 0.10804670304059982, 0.08849549293518066, 0.08912993222475052], [0.09055790305137634, 0.09012255817651749, 0.0905168354511261, 0.08893518149852753, 0.08932426571846008, 0.09045527130365372, 0.08928375691175461, 0.09000000357627869, 0.10162296891212463, 0.08938488364219666, 0.08979629725217819], [0.09040989726781845, 0.08982773125171661, 0.09035494178533554, 0.08824477344751358, 0.08876268565654755, 0.09027256816625595, 0.08870872855186462, 0.0896640196442604, 0.10551915317773819, 0.0888434574007988, 0.08939205855131149], [0.08606470376253128, 0.08340372145175934, 0.08581066131591797, 0.07649735361337662, 0.07870496809482574, 0.08543098717927933, 0.07847264409065247, 0.08266732096672058, 0.18243850767612457, 0.07905373722314835, 0.08145544677972794], [0.09053784608840942, 0.09008165448904037, 0.09049481153488159, 0.08883794397115707, 0.08924540132284164, 0.09043028950691223, 0.08920297771692276, 0.08995325118303299, 0.10216714441776276, 0.08930888772010803, 0.0897398367524147], [0.0904533863067627, 0.0899127796292305, 0.09040236473083496, 0.08844152837991714, 0.08892310410737991, 0.09032588452100754, 0.08887294679880142, 0.08976070582866669, 0.10440104454755783, 0.08899818360805511, 0.0895080417394638]], [[0.08984352648258209, 0.0904509574174881, 0.09043470770120621, 0.09134051948785782, 0.09132411330938339, 0.09097619354724884, 0.09129130840301514, 0.09094350785017014, 0.09125851094722748, 0.09124211966991425, 0.09089451283216476], [0.08935920149087906, 0.09024125337600708, 0.09021762013435364, 0.09153790026903152, 0.09151393175125122, 0.09100613743066788, 0.0914660170674324, 0.09095849096775055, 0.09141812473535538, 0.09139418601989746, 0.09088706225156784], [0.08937208354473114, 0.09024684876203537, 0.09022341668605804, 0.0915326401591301, 0.09150887280702591, 0.0910053476691246, 0.09146136045455933, 0.09095809608697891, 0.09141387045383453, 0.09139013290405273, 0.09088726341724396], [0.08865956962108612, 0.08993670344352722, 0.08990242332220078, 0.0918244943022728, 0.09178949147462845, 0.09104882180690765, 0.09171951562166214, 0.09097941219806671, 0.09164959192276001, 0.09161465615034103, 0.09087539464235306], [0.08867236971855164, 0.08994229882955551, 0.08990820497274399, 0.09181923419237137, 0.09178443253040314, 0.09104804694652557, 0.09171485900878906, 0.09097903966903687, 0.09164535254240036, 0.0916106104850769, 0.09087561815977097], [0.08894473314285278, 0.09006107598543167, 0.09003113210201263, 0.09170746803283691, 0.0916769802570343, 0.0910315066576004, 0.09161602705717087, 0.09097098559141159, 0.09155511111021042, 0.09152467548847198, 0.09088028222322464], [0.08869796246290207, 0.0899534597992897, 0.08991976082324982, 0.09180869907140732, 0.09177429974079132, 0.09104647487401962, 0.09170554578304291, 0.09097827225923538, 0.09163684397935867, 0.09160251170396805, 0.09087605029344559], [0.08897040784358978, 0.09007225185632706, 0.09004270285367966, 0.09169694781303406, 0.09166686236858368, 0.09102994948625565, 0.09160672128200531, 0.0909702256321907, 0.09154661744832993, 0.09151658415794373, 0.09088070690631866], [0.08872358500957489, 0.08996465057134628, 0.08993133902549744, 0.09179818630218506, 0.09176419675350189, 0.09104494005441666, 0.09169624745845795, 0.09097751975059509, 0.09162835776805878, 0.09159442782402039, 0.0908764973282814], [0.0887364000082016, 0.08997024595737457, 0.08993712812662125, 0.09179293364286423, 0.09175914525985718, 0.09104416519403458, 0.09169161319732666, 0.09097715467214584, 0.09162411838769913, 0.09159038960933685, 0.09087672829627991], [0.08900893479585648, 0.09008903056383133, 0.09006006270647049, 0.09168116748332977, 0.09165169298648834, 0.09102759510278702, 0.09159276634454727, 0.09096907079219818, 0.09153387695550919, 0.09150444716215134, 0.0908813551068306]], [[0.09193585813045502, 0.09163254499435425, 0.09190726280212402, 0.09108932316303253, 0.09107515215873718, 0.09157555550336838, 0.09104682505130768, 0.09183581918478012, 0.08373146504163742, 0.09140492975711823, 0.09276529401540756], [0.09163357317447662, 0.0914217010140419, 0.09161361306905746, 0.09104171395301819, 0.09103178977966309, 0.09138187021017075, 0.09101195633411407, 0.09156371653079987, 0.08582564443349838, 0.0912625640630722, 0.09221190214157104], [0.09190759062767029, 0.09161289781332016, 0.09187980741262436, 0.09108506143093109, 0.09107129275798798, 0.09155753254890442, 0.09104376286268234, 0.09181039780378342, 0.08392658829689026, 0.09139174222946167, 0.09271328896284103], [0.09107843786478043, 0.0910298153758049, 0.09107386320829391, 0.0909423828125, 0.09094009548425674, 0.09102065861225128, 0.09093552082777023, 0.09106241911649704, 0.08971287310123444, 0.090993233025074, 0.09121073782444], [0.0910637229681015, 0.09101933985948563, 0.09105954319238663, 0.09093953669071198, 0.09093745052814484, 0.09101098775863647, 0.09093327820301056, 0.09104909747838974, 0.0898166373372078, 0.09098595380783081, 0.09118445217609406], [0.09157616645097733, 0.09138144552707672, 0.0915578156709671, 0.09103213995695114, 0.0910230204463005, 0.09134484082460403, 0.09100478142499924, 0.09151197224855423, 0.08622512221336365, 0.09123516827821732, 0.09210747480392456], [0.09103425592184067, 0.09099836647510529, 0.09103088080883026, 0.09093382954597473, 0.09093214571475983, 0.09099161624908447, 0.09092876315116882, 0.09102243185043335, 0.09002450108528137, 0.09097136557102203, 0.09113187342882156], [0.09183675795793533, 0.0915636196732521, 0.09181101620197296, 0.09107422083616257, 0.09106145799160004, 0.0915122926235199, 0.09103593230247498, 0.09174668043851852, 0.0844162255525589, 0.09135859459638596, 0.09258321672677994], [0.08146719634532928, 0.08350380510091782, 0.08165676146745682, 0.08729728311300278, 0.08739878982305527, 0.08389286696910858, 0.0876021459698677, 0.08213260024785995, 0.16379889845848083, 0.08507008850574493, 0.07617952674627304], [0.09140314161777496, 0.09125974774360657, 0.09138962626457214, 0.09100231528282166, 0.09099558740854263, 0.0912327766418457, 0.09098214656114578, 0.09135587513446808, 0.08743278682231903, 0.09115197509527206, 0.0917939841747284], [0.09273543953895569, 0.09218118339776993, 0.09268312901258469, 0.09119226783514023, 0.09116654843091965, 0.09207721799612045, 0.09111512452363968, 0.09255247563123703, 0.07827162742614746, 0.09176623821258545, 0.09425868093967438]], [[0.08987309783697128, 0.09015221893787384, 0.09046447277069092, 0.09103883802890778, 0.09102248400449753, 0.09100613743066788, 0.09132135659456253, 0.0913049504160881, 0.09128855168819427, 0.09127215296030045, 0.09125576168298721], [0.08965606242418289, 0.08999326080083847, 0.09037076681852341, 0.09106585383415222, 0.0910460501909256, 0.09102625399827957, 0.09140809625387192, 0.09138821810483932, 0.09136834740638733, 0.09134847670793533, 0.09132861346006393], [0.08941452205181122, 0.08981620520353317, 0.09026625752449036, 0.09109586477279663, 0.0910722091794014, 0.09104856103658676, 0.0915047898888588, 0.0914810299873352, 0.09145727753639221, 0.09143353253602982, 0.09140978753566742], [0.08897372335195541, 0.08949265629053116, 0.09007488936185837, 0.0911504253745079, 0.09111972153186798, 0.09108902513980865, 0.09168165177106857, 0.09165076911449432, 0.09161989390850067, 0.09158903360366821, 0.09155818074941635], [0.08898621797561646, 0.08950182795524597, 0.09008032828569412, 0.09114889055490494, 0.09111838042736053, 0.09108789265155792, 0.09167663753032684, 0.09164595603942871, 0.09161528199911118, 0.09158462285995483, 0.09155397117137909], [0.0889987051486969, 0.08951099961996078, 0.09008575975894928, 0.09114734828472137, 0.09111703932285309, 0.091086745262146, 0.09167161583900452, 0.0916411355137825, 0.09161067008972168, 0.09158020466566086, 0.09154976159334183], [0.08875855058431625, 0.08933451026678085, 0.08998118340969086, 0.09117697924375534, 0.09114281833171844, 0.09110867232084274, 0.09176819026470184, 0.09173380583524704, 0.09169944375753403, 0.09166508167982101, 0.09163074195384979], [0.08877101540565491, 0.08934366703033447, 0.08998661488294601, 0.09117544442415237, 0.0911414846777916, 0.09110753238201141, 0.09176316857337952, 0.09172899276018143, 0.09169482439756393, 0.09166067093610764, 0.09162653237581253], [0.08878348022699356, 0.08935283869504929, 0.08999204635620117, 0.09117390215396881, 0.09114014357328415, 0.09110639989376068, 0.09175815433263779, 0.09172417968511581, 0.09169021248817444, 0.09165626019239426, 0.09162232279777527], [0.08879595249891281, 0.0893620029091835, 0.08999748528003693, 0.09117236733436584, 0.0911388099193573, 0.09110526740550995, 0.09175314009189606, 0.0917193666100502, 0.09168560802936554, 0.09165185689926147, 0.0916181206703186], [0.08880841732025146, 0.08937117457389832, 0.09000292420387268, 0.09117083996534348, 0.09113747626543045, 0.09110412746667862, 0.09174812585115433, 0.09171455353498459, 0.09168099611997604, 0.09164745360612869, 0.09161391854286194]], [[0.08984749764204025, 0.09040152281522751, 0.09037265181541443, 0.08815685659646988, 0.08870045095682144, 0.08970413357019424, 0.08807243406772614, 0.09022845327854156, 0.1063695177435875, 0.08878523111343384, 0.08936124294996262], [0.08968903124332428, 0.09031540900468826, 0.09028275310993195, 0.08778078854084015, 0.08839382976293564, 0.08952703326940536, 0.08768562227487564, 0.09011968225240707, 0.10857667773962021, 0.08848948776721954, 0.08913969993591309], [0.08969736844301224, 0.09031999111175537, 0.09028753638267517, 0.08780039846897125, 0.08840984851121902, 0.08953633904457092, 0.08770578354597092, 0.0901254415512085, 0.10846102237701416, 0.08850494027137756, 0.08915131539106369], [0.09030978381633759, 0.09063888341188431, 0.09062176197767258, 0.08930034190416336, 0.0896257683634758, 0.090224489569664, 0.08924972265958786, 0.09053616970777512, 0.09979643672704697, 0.08967644721269608, 0.09002025425434113], [0.09016463905572891, 0.09056674689054489, 0.09054581075906754, 0.08893333375453949, 0.08932995051145554, 0.09006047993898392, 0.08887168020009995, 0.09044121205806732, 0.1018831804394722, 0.08939174562692642, 0.08981116861104965], [0.08988794684410095, 0.09042313694953918, 0.0903952494263649, 0.08825406432151794, 0.08877953141927719, 0.08974944055080414, 0.08817244321107864, 0.09025596082210541, 0.10580264776945114, 0.08886147290468216, 0.08941812813282013], [0.09033200889825821, 0.09064972400665283, 0.09063318371772766, 0.08935727179050446, 0.0896715521812439, 0.09024965763092041, 0.08930838108062744, 0.09055056422948837, 0.09947460889816284, 0.08972048759460449, 0.09005247056484222], [0.08973889797925949, 0.09034273773431778, 0.09031126648187637, 0.08789833635091782, 0.08848979324102402, 0.08958270400762558, 0.08780650794506073, 0.09015407413244247, 0.10788438469171524, 0.08858206868171692, 0.08920919895172119], [0.08372177928686142, 0.08613788336515427, 0.0860106572508812, 0.0766756683588028, 0.0788884311914444, 0.08310531079769135, 0.07633642107248306, 0.08537733554840088, 0.18286313116550446, 0.07923801243305206, 0.08164530247449875], [0.09014171361923218, 0.09055513888597488, 0.09053362160921097, 0.08887605369091034, 0.08928367495536804, 0.09003462642431259, 0.0888126865029335, 0.09042606502771378, 0.10221093147993088, 0.08934719115495682, 0.08977831900119781], [0.0899837464094162, 0.0904737114906311, 0.09044820070266724, 0.08848636597394943, 0.0889681950211525, 0.08985690027475357, 0.08841150999069214, 0.09032069891691208, 0.1044539362192154, 0.08904330432415009, 0.08955341577529907]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.168567785289451e-05, "add_observations_from_episodes_to_batch": 2.7556946122297336e-06, "batch_individual_items": 1.2044924345576508e-05, "add_time_dim_to_batch_and_zero_pad": 6.732421424624241e-06, "add_states_from_episodes_to_batch": 2.6868669355736235e-06}}, "connector_pipeline_timer": 5.711559341919338e-05}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.722856654597343e-06, "tensor_to_numpy": 1.4627469290508435e-05, "remove_single_ts_time_rank_from_batch": 1.1771861709641525e-05, "get_actions": 3.4649822575887816e-05, "listify_data_for_vector_env": 1.0113104038410677e-05, "un_batch_to_individual_items": 6.33738353252987e-06}}, "connector_pipeline_timer": 0.00011046363210741268}, "rlmodule_inference_timer": 3.0105109080423693e-05, "episode_return_mean": 0.9, "module_episode_returns_mean": {"default_policy": 0.9}, "weights_seq_no": 19.0, "episode_return_max": 15.5, "num_episodes_lifetime": 380, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.3549199853602597e-05, "episode_len_min": 20, "env_reset_timer": 0.0006331918087660083, "num_env_steps_sampled_lifetime": 95400, "num_env_steps_sampled": 400, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "episode_duration_sec_mean": 0.00520663832896389, "episode_return_min": -13.5, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "sample": 0.13138257431197384, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "agent_episode_returns_mean": {"default_agent": 0.9}, "time_between_sampling": 9.519118626197834}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "ba99e_00000", "date": "2025-08-11_18-55-42", "timestamp": 1754931342, "time_this_iter_s": 9.77298903465271, "time_total_s": 181.47175455093384, "pid": 11884, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1619f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 181.47175455093384, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 36.221428571428575, "ram_util_percent": 77.7357142857143}}
{"timers": {"training_iteration": 10.061560617893836, "restore_env_runners": 8.905691310796157e-06, "training_step": 10.061358838399563, "env_runner_sampling_timer": 1.6465708952475115, "learner_update_timer": 8.237681162176774, "synch_weights": 0.0016033780089949596, "restore_eval_env_runners": 6.228087628901696e-05, "evaluation_iteration": 0.14324455867466238, "synch_eval_env_connectors": 0.00017756726505934457, "synch_env_connectors": 5.381930921621879e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2209812048507824e-05, "add_observations_from_episodes_to_batch": 2.7421408492084144e-06, "batch_individual_items": 1.2254823438383138e-05, "add_time_dim_to_batch_and_zero_pad": 7.000359425245348e-06, "add_states_from_episodes_to_batch": 2.720253538936439e-06}}, "connector_pipeline_timer": 5.887480104594446e-05}, "module_to_env_connector": {"connector_pipeline_timer": 0.0001165030043977238, "timers": {"connectors": {"get_actions": 3.891936111319162e-05, "normalize_and_clip_actions": 7.754090486490837e-06, "un_batch_to_individual_items": 6.4932386462621446e-06, "listify_data_for_vector_env": 1.0252086481611482e-05, "tensor_to_numpy": 1.522856258687189e-05, "remove_single_ts_time_rank_from_batch": 1.1777994749253207e-05}}}, "weights_seq_no": 19.0, "episode_return_max": 14.5, "episode_duration_sec_mean": 0.005200690833386034, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "env_reset_timer": 3.287832966554488e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -555250.0, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "episode_return_min": -5.5, "agent_episode_returns_mean": {"default_agent": 5.7799999999999985}, "num_env_steps_sampled_lifetime": -11105000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "env_step_timer": 1.3449943134061327e-05, "time_between_sampling": 0.03323743233774455, "num_episodes": 250.0, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 5.7799999999999985}, "sample": 0.005642890881400662, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 3.1711198132169934e-05, "episode_return_mean": 5.7799999999999985, "episode_len_max": 20, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3341.0628034063634}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13494079108143678, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009257252255925537, "add_observations_from_episodes_to_batch": 0.0008354292963693622, "add_columns_from_episodes_to_train_batch": 0.04158211247645179, "add_time_dim_to_batch_and_zero_pad": 0.07554835952926015, "add_states_from_episodes_to_batch": 0.0035046651134919855, "batch_individual_items": 0.003983012787629537, "numpy_to_tensor": 7.293460398392741e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 718200, "module_train_batch_size_mean": 997.4978492525759, "vf_explained_var": 0.0009292364120483398, "total_loss": 0.2772921323776245, "weights_seq_no": 120.0, "vf_loss_unclipped": 47.79409408569336, "diff_num_grad_updates_vs_sampler_policy": 101.0, "entropy": 0.6833736896514893, "vf_loss": 0.35867923498153687, "policy_loss": -0.0010980477090924978, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 9.451270307181403e-05}, "__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1436400, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 3960000, "num_env_steps_trained_lifetime_throughput": 42968.77152638711}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 101.0, "num_module_steps_trained": 35910, "total_loss": 0.0, "num_module_steps_trained_lifetime": 718200, "module_train_batch_size_mean": 997.4978492525759, "weights_seq_no": 120.0}}}, "intrinsic_reward_module": {"total_loss": 0.0, "weights_seq_no": 20.0, "num_trainable_parameters": 8266, "num_module_steps_trained_lifetime": 119700, "module_train_batch_size_mean": 997.6479298448816, "gradients_default_optimizer_global_norm": 0.0, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime_throughput": 717.7547018384911}, "default_policy": {"use_intrinsic_rewards": 0.0, "num_trainable_parameters": 16595, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 119700, "module_train_batch_size_mean": 997.6479298448816, "vf_explained_var": 0.0008535981178283691, "total_loss": 0.27695125341415405, "weights_seq_no": 20.0, "mean_kl_loss": 0.0001006434322334826, "vf_loss_unclipped": 47.77337646484375, "curr_kl_coeff": 1.5409844422720198e-07, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.6833127737045288, "vf_loss": 0.35830605030059814, "curr_entropy_coeff": 0.0015431216992, "policy_loss": -0.0011329581029713154, "num_module_steps_trained_lifetime_throughput": 717.7502793522658}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 239400, "num_env_steps_trained_lifetime": 660000, "num_env_steps_trained": 33000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 3958.425082513934, "num_module_steps_trained_throughput": 20290818.920746952, "num_module_steps_trained_lifetime_throughput": 12704777.37243861}, "IntrinsicAttentionMask": [[[0.08978403359651566, 0.09039105474948883, 0.09037481993436813, 0.0912800282239914, 0.09126362949609756, 0.09124723821878433, 0.0912308469414711, 0.0908832773566246, 0.09119807183742523, 0.0911816954612732, 0.09116531908512115], [0.0892728790640831, 0.09015408158302307, 0.09013047814369202, 0.09144947677850723, 0.09142553061246872, 0.0914015918970108, 0.09137766063213348, 0.09087061882019043, 0.09132981300354004, 0.09130590409040451, 0.09128198772668839], [0.08928646892309189, 0.09016039222478867, 0.09013698250055313, 0.0914449542760849, 0.0914212092757225, 0.0913974717259407, 0.0913737416267395, 0.09087096154689789, 0.09132629632949829, 0.09130258858203888, 0.09127887338399887], [0.08853472769260406, 0.0898100733757019, 0.08977583050727844, 0.09169519692659378, 0.09166023880243301, 0.09162529557943344, 0.09159036725759506, 0.0908513069152832, 0.09152054041624069, 0.0914856493473053, 0.0914507731795311], [0.08854822814464569, 0.0898163840174675, 0.08978233486413956, 0.09169068932533264, 0.09165593981742859, 0.09162119030952454, 0.09158646315336227, 0.09085166454315186, 0.09151704609394073, 0.09148235619068146, 0.09144768863916397], [0.08856173604726791, 0.0898226946592331, 0.08978884667158127, 0.0916861817240715, 0.09165162593126297, 0.09161708503961563, 0.09158256649971008, 0.0908520296216011, 0.09151355177164078, 0.09147906303405762, 0.09144458919763565], [0.08857524394989014, 0.08982900530099869, 0.08979535102844238, 0.09168167412281036, 0.09164732694625854, 0.09161298722028732, 0.0915786623954773, 0.09085239470005035, 0.09151005744934082, 0.09147576987743378, 0.09144149720668793], [0.08886265009641647, 0.0899631604552269, 0.08993364870548248, 0.09158588945865631, 0.09155584126710892, 0.09152580052614212, 0.09149577468633652, 0.0908600464463234, 0.0914357379078865, 0.09140574187040329, 0.09137575328350067], [0.08860225975513458, 0.08984163403511047, 0.08980835974216461, 0.09167265892028809, 0.0916387140750885, 0.09160478413105011, 0.09157086163759232, 0.09085311740636826, 0.09150306135416031, 0.0914691835641861, 0.09143531322479248], [0.088615782558918, 0.08984795212745667, 0.08981487900018692, 0.09166815876960754, 0.09163442254066467, 0.0916006863117218, 0.09156697243452072, 0.0908534899353981, 0.09149957448244095, 0.09146589040756226, 0.09143222868442535], [0.08862928301095963, 0.08985426276922226, 0.08982137590646744, 0.09166364371776581, 0.09163010120391846, 0.0915965810418129, 0.09156306833028793, 0.09085384011268616, 0.0914960727095604, 0.09146259725093842, 0.09142912179231644]], [[0.09201260656118393, 0.09199829399585724, 0.09198398888111115, 0.09087872505187988, 0.09115118533372879, 0.09194108098745346, 0.09083633124828339, 0.09162349998950958, 0.08353789895772934, 0.09119360148906708, 0.09284273535013199], [0.0919974222779274, 0.09198331832885742, 0.09196920692920685, 0.09087960422039032, 0.09114822745323181, 0.09192691743373871, 0.09083781391382217, 0.09161385148763657, 0.08363794535398483, 0.09119004011154175, 0.09281565994024277], [0.09198221564292908, 0.09196831285953522, 0.09195441007614136, 0.09088046848773956, 0.09114523977041245, 0.09191273152828217, 0.09083926677703857, 0.09160418063402176, 0.08373808860778809, 0.09118645638227463, 0.09278856962919235], [0.09076878428459167, 0.09077052772045135, 0.09077227860689163, 0.0909082219004631, 0.09087453782558441, 0.09077752381563187, 0.09091347455978394, 0.09081641584634781, 0.0918610543012619, 0.09086930751800537, 0.09066791832447052], [0.09107520431280136, 0.09107311815023422, 0.09107103198766708, 0.09090877324342728, 0.0909489244222641, 0.09106475859880447, 0.09090251475572586, 0.09101828932762146, 0.08978624641895294, 0.09095516800880432, 0.0911959558725357], [0.09193655103445053, 0.09192325919866562, 0.0919099748134613, 0.09088299423456192, 0.09113623946905136, 0.09187012165784836, 0.09084358811378479, 0.09157511591911316, 0.08403921127319336, 0.09117566049098969, 0.09270729124546051], [0.09072066843509674, 0.09072300791740417, 0.0907253548502922, 0.09090768545866013, 0.09086249768733978, 0.0907323807477951, 0.09091472625732422, 0.09078453481197357, 0.0921882688999176, 0.09085547924041748, 0.09058544039726257], [0.09159500151872635, 0.09158622473478317, 0.0915774554014206, 0.09089812636375427, 0.09106588363647461, 0.09155113250017166, 0.09087200462818146, 0.09135623276233673, 0.08630288392305374, 0.09109198302030563, 0.09210309386253357], [0.08035185188055038, 0.08044885843992233, 0.08054597675800323, 0.08846459537744522, 0.08643393963575363, 0.08083803206682205, 0.08878537267446518, 0.08303721994161606, 0.17002734541893005, 0.08612257242202759, 0.07494422793388367], [0.09112247824668884, 0.09111978858709335, 0.09111709892749786, 0.09090840816497803, 0.09096004068851471, 0.09110903739929199, 0.09090036153793335, 0.09104926139116287, 0.0894675925374031, 0.0909680724143982, 0.0912778452038765], [0.09287277609109879, 0.0928465723991394, 0.09282038360834122, 0.09080711007118225, 0.0913015604019165, 0.09274185448884964, 0.09073027968406677, 0.09216155856847763, 0.07794105261564255, 0.09137865155935287, 0.09439827501773834]], [[0.0898730605840683, 0.09048069268465042, 0.09013597667217255, 0.09103880077600479, 0.0913541316986084, 0.09133771806955338, 0.09132131189107895, 0.090973399579525, 0.09095706045627594, 0.09127210825681686, 0.09125571697950363], [0.08940190821886063, 0.09028438478708267, 0.08978342264890671, 0.09109733998775482, 0.09155767410993576, 0.09153369814157486, 0.09150972962379456, 0.0910019651055336, 0.09097813814878464, 0.09143786877393723, 0.09141393005847931], [0.08966857939958572, 0.09039561450481415, 0.08998304605484009, 0.09106425195932388, 0.09144239127635956, 0.09142270684242249, 0.09140302985906601, 0.09098586440086365, 0.09096626937389374, 0.09134401381015778, 0.0913243442773819], [0.08897359669208527, 0.09010510891675949, 0.08946237713098526, 0.09115029126405716, 0.09174331277608871, 0.09171240776777267, 0.09168151766061783, 0.09102752804756165, 0.0909968689084053, 0.09158889204263687, 0.09155803918838501], [0.08873347193002701, 0.09000427275896072, 0.08928217738866806, 0.09117989242076874, 0.09184767305850983, 0.091812863945961, 0.09177806228399277, 0.09104172885417938, 0.09100721776485443, 0.09167373925447464, 0.09163898229598999], [0.08874592930078506, 0.09000951051712036, 0.0892915204167366, 0.09117835015058517, 0.09184224903583527, 0.09180763363838196, 0.09177304059267044, 0.09104098379611969, 0.09100668132305145, 0.09166932106018066, 0.09163478016853333], [0.08875839412212372, 0.09001474827528, 0.08930087834596634, 0.09117681533098221, 0.0918368250131607, 0.09180241823196411, 0.09176802635192871, 0.09104025363922119, 0.09100614488124847, 0.09166491776704788, 0.09163057059049606], [0.08902356773614883, 0.09012607485055923, 0.08949986100196838, 0.0911441296339035, 0.09172163158655167, 0.09169153869152069, 0.09166145324707031, 0.09102457016706467, 0.09099471569061279, 0.09157126396894455, 0.09154121577739716], [0.08903606235980988, 0.09013131260871887, 0.08950923383235931, 0.09114258736371994, 0.0917162075638771, 0.09168631583452225, 0.09165643155574799, 0.09102383255958557, 0.09099417179822922, 0.09156685322523117, 0.0915370061993599], [0.08879578858613968, 0.09003046900033951, 0.08932895958423615, 0.09117221087217331, 0.09182056039571762, 0.09178676456212997, 0.09175298362970352, 0.0910380482673645, 0.09100453555583954, 0.09165170043706894, 0.09161796420812607], [0.08880826085805893, 0.09003569930791855, 0.08933831751346588, 0.09117066860198975, 0.09181513637304306, 0.09178154170513153, 0.0917479619383812, 0.0910373106598854, 0.09100399911403656, 0.09164728969335556, 0.0916137546300888]], [[0.09206563234329224, 0.09205131232738495, 0.09174761921167374, 0.09093109518289566, 0.0909169539809227, 0.09199406206607819, 0.09088867902755737, 0.09167630225419998, 0.08358602225780487, 0.09124615043401718, 0.0928962379693985], [0.09204966574907303, 0.09203555434942245, 0.09173619002103806, 0.09093122184276581, 0.09091727435588837, 0.09197912365198135, 0.09088940173387527, 0.09166587889194489, 0.08368543535470963, 0.09124182909727097, 0.092868372797966], [0.09170838445425034, 0.09169859439134598, 0.09149082750082016, 0.09093114733695984, 0.09092144668102264, 0.09165944904088974, 0.09090203046798706, 0.09144200384616852, 0.08582325279712677, 0.0911472886800766, 0.09227550029754639], [0.09076234698295593, 0.09076409786939621, 0.09080123901367188, 0.09090177714824677, 0.09090352803468704, 0.09077108651399612, 0.0909070298075676, 0.09080997854471207, 0.09185454249382019, 0.09086286276578903, 0.09066148847341537], [0.09074558317661285, 0.09074752777814865, 0.09078889340162277, 0.09090087562799454, 0.09090282768011093, 0.09075532108545303, 0.09090672433376312, 0.09079863131046295, 0.09196274727582932, 0.09085752815008163, 0.09063327312469482], [0.09198576956987381, 0.0919724702835083, 0.09169038385152817, 0.09093164652585983, 0.09091850370168686, 0.09191929548978806, 0.09089221805334091, 0.09162413328886032, 0.08408418297767639, 0.09122446924448013, 0.09275691956281662], [0.0907120406627655, 0.09071438759565353, 0.09076418727636337, 0.0908990427851677, 0.09090138971805573, 0.09072376042604446, 0.09090608358383179, 0.09077590703964233, 0.09217950701713562, 0.09084684401750565, 0.09057682752609253], [0.09162743389606476, 0.09161865711212158, 0.0914323553442955, 0.09093031287193298, 0.09092160314321518, 0.09158354997634888, 0.09090418368577957, 0.09138857573270798, 0.08633343130350113, 0.09112423658370972, 0.0921357050538063], [0.08002140372991562, 0.08011800795793533, 0.0821983814239502, 0.08810079842805862, 0.08820714801549911, 0.08050558716058731, 0.08842024952173233, 0.08269573003053665, 0.16932831704616547, 0.08576839417219162, 0.07463601231575012], [0.09113238006830215, 0.09112968295812607, 0.09107258170843124, 0.09091828763484955, 0.09091560542583466, 0.09111893177032471, 0.09091023355722427, 0.09105914831161499, 0.08947731554508209, 0.09097795188426971, 0.091287761926651], [0.09297028183937073, 0.09294405579566956, 0.09238855540752411, 0.09090244770050049, 0.09087680280208588, 0.09283922612667084, 0.09082553535699844, 0.09225832670927048, 0.07802287489175797, 0.09147458523511887, 0.09449738264083862]], [[0.08996251970529556, 0.09024190902709961, 0.09055448323488235, 0.09112942218780518, 0.09144506603479385, 0.09109668433666229, 0.09141221642494202, 0.0910639613866806, 0.09104759991168976, 0.09103124588727951, 0.09101489186286926], [0.08976412564516068, 0.09010172635316849, 0.09047969430685043, 0.0911756232380867, 0.09155809134244919, 0.09113597124814987, 0.09151827543973923, 0.09109634160995483, 0.09107653051614761, 0.09105672687292099, 0.09103692322969437], [0.08954329043626785, 0.08994554728269577, 0.09039625525474548, 0.09122705459594727, 0.09168417751789093, 0.09117969125509262, 0.09163657575845718, 0.09113235026597977, 0.09110868722200394, 0.0910850241780281, 0.09106137603521347], [0.08914019912481308, 0.08966009318828583, 0.09024342149496078, 0.09132096916437149, 0.09191510081291199, 0.09125944972038269, 0.09185318648815155, 0.09119797497987747, 0.09116726368665695, 0.09113654494285583, 0.09110584855079651], [0.08892056345939636, 0.08950434625148773, 0.09015985578298569, 0.09137213975191116, 0.09204133599996567, 0.09130289405584335, 0.09197157621383667, 0.09123369306325912, 0.0911991074681282, 0.09116453677415848, 0.09112998098134995], [0.08916304260492325, 0.08967628329992294, 0.0902521014213562, 0.09131564199924469, 0.0919019877910614, 0.09125493466854095, 0.09184088557958603, 0.0911942645907402, 0.09116394072771072, 0.09113363176584244, 0.09110333025455475], [0.08894335478544235, 0.08952051401138306, 0.0901685357093811, 0.09136682003736496, 0.09202820807695389, 0.09129837155342102, 0.09195926040410995, 0.09122997522354126, 0.09119579941034317, 0.09116163104772568, 0.09112747013568878], [0.08918588608503342, 0.08969247341156006, 0.09026077389717102, 0.09131031483411789, 0.09188886731863022, 0.09125040471553802, 0.09182858467102051, 0.09119053930044174, 0.09116062521934509, 0.09113071113824844, 0.09110081195831299], [0.0891973078250885, 0.08970057219266891, 0.09026511013507843, 0.09130764752626419, 0.09188231080770493, 0.09124814718961716, 0.09182243049144745, 0.09118868410587311, 0.09115895628929138, 0.09112925827503204, 0.09109955281019211], [0.08920873701572418, 0.08970866352319717, 0.09026945382356644, 0.09130498766899109, 0.09187575429677963, 0.09124588221311569, 0.09181628376245499, 0.09118682146072388, 0.09115730226039886, 0.09112779796123505, 0.09109829366207123], [0.08922017365694046, 0.08971676975488663, 0.09027379751205444, 0.09130233526229858, 0.09186920523643494, 0.09124363213777542, 0.09181013703346252, 0.09118496626615524, 0.09115564823150635, 0.09112634509801865, 0.09109704196453094]], [[0.0914793461561203, 0.0914691761136055, 0.09166505932807922, 0.09087661653757095, 0.09086652100086212, 0.09163449704647064, 0.09105098992586136, 0.09161413460969925, 0.08576113730669022, 0.09130675345659256, 0.09227576851844788], [0.09146836400032043, 0.09145840257406235, 0.09165039658546448, 0.09087757021188736, 0.09086766839027405, 0.09162044525146484, 0.09104849398136139, 0.09160047769546509, 0.08586009591817856, 0.09129919856786728, 0.09224892407655716], [0.09167779982089996, 0.09166394174098969, 0.09193100035190582, 0.09085732698440552, 0.09084359556436539, 0.09188932180404663, 0.0910944864153862, 0.0918615534901619, 0.08397334814071655, 0.09144265949726105, 0.0927649438381195], [0.09080743044614792, 0.0908091813325882, 0.09077553451061249, 0.09091148525476456, 0.09091323614120483, 0.09078077971935272, 0.09088129550218582, 0.09078427404165268, 0.09182854741811752, 0.09083714336156845, 0.09067116677761078], [0.09079580008983612, 0.09079774469137192, 0.09076027572154999, 0.09091168642044067, 0.09091363847255707, 0.09076610952615738, 0.09087806195020676, 0.09077000617980957, 0.09193375706672668, 0.09082888811826706, 0.09064404666423798], [0.09164541959762573, 0.0916321724653244, 0.09188750386238098, 0.0908607766032219, 0.09084764122962952, 0.09184766560792923, 0.09108761698007584, 0.0918211042881012, 0.08426494151353836, 0.09142058342695236, 0.09268462657928467], [0.09100627154111862, 0.09100458025932312, 0.0910370945930481, 0.09090587496757507, 0.09090418368577957, 0.09103202819824219, 0.09093496948480606, 0.09102864563465118, 0.09003064781427383, 0.09097757935523987, 0.09113809466362], [0.09162376821041107, 0.09161093086004257, 0.09185845404863358, 0.09086300432682037, 0.09085026383399963, 0.09181982278823853, 0.09108296036720276, 0.09179408103227615, 0.0844598338007927, 0.09140579402446747, 0.09263104945421219], [0.08306229114532471, 0.08315886557102203, 0.08131945133209229, 0.08900652080774307, 0.08911000937223434, 0.08160344511270523, 0.08724028617143631, 0.08179332315921783, 0.1631222665309906, 0.08471868187189102, 0.07586483657360077], [0.09129133820533752, 0.09128458797931671, 0.09141451120376587, 0.09089100360870361, 0.09088429063558578, 0.09139424562454224, 0.09100691229104996, 0.09138074517250061, 0.0874565839767456, 0.09117679297924042, 0.09181897342205048], [0.09230314940214157, 0.09227710962295532, 0.09277956932783127, 0.09076717495918274, 0.09074157476425171, 0.09270107746124268, 0.09120993316173553, 0.09264878183603287, 0.07835307717323303, 0.09186173230409622, 0.09435676783323288]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1432148580939468e-05, "add_observations_from_episodes_to_batch": 2.747567639568295e-06, "batch_individual_items": 1.1884328837433263e-05, "add_time_dim_to_batch_and_zero_pad": 6.618865899391584e-06, "add_states_from_episodes_to_batch": 2.673141110106249e-06}}, "connector_pipeline_timer": 5.6371524104618984e-05}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.725950215580033e-06, "tensor_to_numpy": 1.443173930136733e-05, "remove_single_ts_time_rank_from_batch": 1.1616146002105756e-05, "get_actions": 3.390566026156404e-05, "listify_data_for_vector_env": 1.0033018947188084e-05, "un_batch_to_individual_items": 6.28279025994729e-06}}, "connector_pipeline_timer": 0.00010905048800247702}, "rlmodule_inference_timer": 2.9461647390546016e-05, "episode_return_mean": 1.5, "module_episode_returns_mean": {"default_policy": 1.5}, "weights_seq_no": 20.0, "episode_return_max": 15.5, "num_episodes_lifetime": 400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.3296449089968056e-05, "episode_len_min": 20, "env_reset_timer": 0.000628062810198786, "num_env_steps_sampled_lifetime": 100400, "num_env_steps_sampled": 400, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "episode_duration_sec_mean": 0.0052120620955247434, "episode_return_min": -13.5, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "sample": 0.13115869023950658, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "agent_episode_returns_mean": {"default_agent": 1.5}, "time_between_sampling": 9.517888772855864}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "ba99e_00000", "date": "2025-08-11_18-55-51", "timestamp": 1754931351, "time_this_iter_s": 9.489125728607178, "time_total_s": 190.96088027954102, "pid": 11884, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1619f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 190.96088027954102, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 34.246153846153845, "ram_util_percent": 77.88461538461537}}
