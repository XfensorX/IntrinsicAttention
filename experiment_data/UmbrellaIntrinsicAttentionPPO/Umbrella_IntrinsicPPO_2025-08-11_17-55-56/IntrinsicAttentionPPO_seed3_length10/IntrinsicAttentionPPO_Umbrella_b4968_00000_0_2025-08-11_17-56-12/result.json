{"timers": {"training_iteration": 10.597874208004214, "restore_env_runners": 1.191697083413601e-05, "training_step": 10.59763724997174, "env_runner_sampling_timer": 1.6698667500168085, "learner_update_timer": 8.753328416962177, "synch_weights": 0.0018388750031590462}, "env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.544383589477909e-06, "numpy_to_tensor": 1.3710155835805207e-05, "add_states_from_episodes_to_batch": 2.9235357873872024e-06, "batch_individual_items": 1.3196064897594353e-05, "add_observations_from_episodes_to_batch": 3.089438582280538e-06}}, "connector_pipeline_timer": 6.476796490520963e-05}, "num_env_steps_sampled_lifetime": 627500.0, "episode_return_mean": -1.5, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": -1.5}, "module_episode_returns_mean": {"default_policy": -1.5}, "env_to_module_sum_episodes_length_in": 10.191744832559449, "sample": 0.006527484633846374, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.6054635640009526e-05, "remove_single_ts_time_rank_from_batch": 1.2484534998184474e-05, "normalize_and_clip_actions": 1.0159382016914825e-05, "get_actions": 4.591041200881002e-05, "listify_data_for_vector_env": 1.1024073940009173e-05, "un_batch_to_individual_items": 6.897398776331039e-06}}, "connector_pipeline_timer": 0.00012979751973928562}, "time_between_sampling": 0.0005105449115201257, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 6.5, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "episode_len_mean": 20.0, "num_episodes": 250.0, "num_episodes_lifetime": 31375.0, "env_to_module_sum_episodes_length_out": 10.191744832559449, "num_env_steps_sampled": 5000.0, "rlmodule_inference_timer": 5.4873297117086286e-05, "episode_duration_sec_mean": 0.005811865211464465, "weights_seq_no": 0.0, "env_step_timer": 1.5233472314256812e-05, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "env_reset_timer": 8.243397666660369e-05, "num_env_steps_sampled_lifetime_throughput": 2985.6092183241412}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000, "learner_connector": {"connector_pipeline_timer": 0.13669445796404034, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008950959076173604, "add_observations_from_episodes_to_batch": 0.0009102079784497619, "add_columns_from_episodes_to_train_batch": 0.04138862492982298, "add_time_dim_to_batch_and_zero_pad": 0.0766259579686448, "add_states_from_episodes_to_batch": 0.004113791976124048, "batch_individual_items": 0.004430584027431905, "numpy_to_tensor": 7.458298932760954e-05}}}, "learner_connector_sum_episodes_length_out": 5250}, "learners": {"__all_modules__": {"num_env_steps_trained": 33000, "num_trainable_parameters": 24861, "num_module_steps_trained": 11970, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 11970, "num_env_steps_trained_lifetime": 33000, "num_env_steps_trained_lifetime_throughput": 4173.347097841018, "num_module_steps_trained_throughput": 32044597.105132073, "num_module_steps_trained_lifetime_throughput": 13591466.961356314}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 71820, "num_env_steps_trained_lifetime": 198000, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 51153.638658949756}, "default_policy": {"vf_loss_unclipped": 40.50495147705078, "module_train_batch_size_mean": 997.8474438281662, "num_module_steps_trained_lifetime": 35910, "diff_num_grad_updates_vs_sampler_policy": 6.0, "vf_loss": 0.359818696975708, "total_loss": 0.2791895866394043, "vf_explained_var": 0.004820048809051514, "mean_kl_loss": 9.965775461751036e-06, "policy_loss": -6.869821663713083e-05, "entropy": 0.6871989369392395, "weights_seq_no": 6.0, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35910}, "intrinsic_reward_module": {"weights_seq_no": 6.0, "num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.8474438281662, "num_module_steps_trained_lifetime": 35910, "diff_num_grad_updates_vs_sampler_policy": 6.0, "total_loss": 0.0}}}, "IntrinsicAttentionMask": [[[0.09352570027112961, 0.08800990879535675, 0.09175966680049896, 0.09202158451080322, 0.0921047255396843, 0.09218794107437134, 0.0884082168340683, 0.0921749398112297, 0.09225821495056152, 0.08864805847406387, 0.0889010950922966], [0.07835544645786285, 0.10621512681245804, 0.0861990675330162, 0.08497820049524307, 0.08459500223398209, 0.08421353995800018, 0.10384183377027512, 0.08427301049232483, 0.08389300107955933, 0.1024433821439743, 0.10099244117736816], [0.08862733840942383, 0.09351490437984467, 0.09013199061155319, 0.08990540355443954, 0.08983372896909714, 0.0897621139883995, 0.09314274787902832, 0.08977330476045609, 0.08970173448324203, 0.09292016923427582, 0.09268657118082047], [0.0893518328666687, 0.09267949312925339, 0.09038235992193222, 0.09022752195596695, 0.09017851948738098, 0.0901295468211174, 0.09242810308933258, 0.09013719856739044, 0.09008824080228806, 0.09227759391069412, 0.09211951494216919], [0.08958197385072708, 0.0924157127737999, 0.09046118706464767, 0.09032918512821198, 0.09028739482164383, 0.09024563431739807, 0.09220217168331146, 0.09025215357542038, 0.09021040797233582, 0.09207427501678467, 0.09193991869688034], [0.08981239050626755, 0.09215234965085983, 0.09053975343704224, 0.09043062478303909, 0.09039608389139175, 0.09036154299974442, 0.09197644889354706, 0.09036693722009659, 0.09033241868019104, 0.09187107533216476, 0.09176034480333328], [0.0794360563158989, 0.10479964315891266, 0.08664794266223907, 0.0855293869972229, 0.08517801016569138, 0.08482807874679565, 0.1026645377278328, 0.08488264679908752, 0.0845339223742485, 0.10140440613031387, 0.10009535402059555], [0.08977637439966202, 0.09219346195459366, 0.0905274972319603, 0.09041479229927063, 0.09037911146879196, 0.09034345299005508, 0.0920116975903511, 0.09034901857376099, 0.0903133675456047, 0.09190281480550766, 0.0917883887887001], [0.09000702202320099, 0.09193046391010284, 0.09060586243867874, 0.09051607549190521, 0.09048764407634735, 0.09045922011137009, 0.09178618341684341, 0.09046366065740585, 0.09043525159358978, 0.09169971942901611, 0.09160885214805603], [0.08008813858032227, 0.1039549708366394, 0.08691467344760895, 0.08585814386606216, 0.08552607148885727, 0.08519530296325684, 0.1019602119922638, 0.08524688333272934, 0.08491719514131546, 0.10078177601099014, 0.09955666959285736], [0.0807771310210228, 0.10307007282972336, 0.08719313889741898, 0.08620236814022064, 0.08589081466197968, 0.08558038622140884, 0.10122089087963104, 0.08562880754470825, 0.08531932532787323, 0.10012735426425934, 0.09898962080478668]], [[0.10029049217700958, 0.08447738736867905, 0.09954831004142761, 0.0831834226846695, 0.08287505805492401, 0.08323169499635696, 0.09808038175106049, 0.0977167934179306, 0.08950328826904297, 0.09660607576370239, 0.08448702096939087], [0.09088899195194244, 0.09092304110527039, 0.09089046716690063, 0.09092610329389572, 0.09092684090137482, 0.09092599153518677, 0.09089341014623642, 0.09089414775371552, 0.09091157466173172, 0.09089642018079758, 0.0909230187535286], [0.09987685829401016, 0.08475757390260696, 0.09916969388723373, 0.0835152193903923, 0.08321903645992279, 0.08356158435344696, 0.0977703407406807, 0.09742359071969986, 0.08957527577877045, 0.09636399149894714, 0.08476681262254715], [0.09006042778491974, 0.0914987102150917, 0.09012221544981003, 0.09162921458482742, 0.09166064858436584, 0.09162431210279465, 0.09024592489004135, 0.09027688205242157, 0.09101174026727676, 0.0903722271323204, 0.0914977490901947], [0.08986151218414307, 0.09163706749677658, 0.08993766456842422, 0.09179850667715073, 0.09183739125728607, 0.09179243445396423, 0.09009014070034027, 0.09012830257415771, 0.09103517234325409, 0.09024587273597717, 0.09163588285446167], [0.09009150415658951, 0.09147708863019943, 0.09015104919672012, 0.09160277247428894, 0.09163303673267365, 0.0915980413556099, 0.09027025103569031, 0.0903000757098198, 0.09100804477930069, 0.09039194881916046, 0.09147615730762482], [0.09905125200748444, 0.08531775325536728, 0.09841333329677582, 0.08417986333370209, 0.08390835672616959, 0.08422235399484634, 0.0971498042345047, 0.09683645516633987, 0.08971629291772842, 0.09587829560041428, 0.08532621711492538], [0.09884519875049591, 0.08545775711536407, 0.09822443127632141, 0.0843462347984314, 0.08408096432685852, 0.08438774943351746, 0.09699457138776779, 0.09668952226638794, 0.08975093066692352, 0.09575655311346054, 0.08546601980924606], [0.0940176397562027, 0.08876029402017593, 0.09378373622894287, 0.08830200135707855, 0.08819209784269333, 0.08831918984651566, 0.0933176726102829, 0.09320151805877686, 0.09049731492996216, 0.0928448885679245, 0.08876368403434753], [0.0982118621468544, 0.0858885869383812, 0.09764349460601807, 0.08485887944698334, 0.08461297303438187, 0.08489735424518585, 0.09651658684015274, 0.09623690694570541, 0.08985601365566254, 0.09538107365369797, 0.08589623868465424], [0.09089511632919312, 0.09091878682374954, 0.09089614450931549, 0.09092091023921967, 0.09092142432928085, 0.0909208357334137, 0.09089819341897964, 0.09089870750904083, 0.09091081470251083, 0.09090028703212738, 0.09091877192258835]], [[0.09352350234985352, 0.088007852435112, 0.09175751358270645, 0.09201942384243011, 0.08841861039400101, 0.09218578040599823, 0.08840613812208176, 0.092172771692276, 0.08856595307588577, 0.0923394039273262, 0.09260297566652298], [0.07830856740474701, 0.10615158081054688, 0.0861474946141243, 0.08492735773324966, 0.1037064641714096, 0.08416315913200378, 0.10377970337867737, 0.08422259241342545, 0.10284586250782013, 0.08346472680568695, 0.08228259533643723], [0.0886257067322731, 0.09351319074630737, 0.09013033658266068, 0.08990374952554703, 0.09312944114208221, 0.08976047486066818, 0.09314104169607162, 0.08977165073156357, 0.09299260377883911, 0.08962857723236084, 0.08940325677394867], [0.08935107290744781, 0.09267871081829071, 0.09038158506155014, 0.09022675454616547, 0.09241947531700134, 0.09012877941131592, 0.0924273207783699, 0.09013643115758896, 0.09232695400714874, 0.09003854542970657, 0.08988430351018906], [0.07943078130483627, 0.10470394790172577, 0.08661917597055435, 0.08550438284873962, 0.10251150280237198, 0.08480541408061981, 0.10257724672555923, 0.08485980331897736, 0.10173871368169785, 0.08416610211133957, 0.08308287709951401], [0.0898120105266571, 0.09215196222066879, 0.0905393734574318, 0.09043024480342865, 0.09197057783603668, 0.09036116302013397, 0.09197606146335602, 0.09036655724048615, 0.09190580248832703, 0.09029752016067505, 0.09018868207931519], [0.07939666509628296, 0.10474767535924911, 0.08660497516393661, 0.08548697829246521, 0.10254766047000885, 0.08478601276874542, 0.10261363536119461, 0.0848405510187149, 0.1017722338438034, 0.08414489775896072, 0.08305864781141281], [0.08977597206830978, 0.09219305962324142, 0.09052710235118866, 0.09041439741849899, 0.09200561791658401, 0.09034305065870285, 0.09201129525899887, 0.09034862369298935, 0.09193868935108185, 0.09027732908725739, 0.09016492962837219], [0.07983392477035522, 0.1041884571313858, 0.08678626269102097, 0.08570948988199234, 0.10208495706319809, 0.08503410220146179, 0.10214806348085403, 0.08508665859699249, 0.10134314000606537, 0.08441618084907532, 0.08336881548166275], [0.0902378186583519, 0.09166776388883591, 0.09068384021520615, 0.09061701595783234, 0.09155742824077606, 0.09057469666004181, 0.09156077355146408, 0.09057799726724625, 0.09151800721883774, 0.09053569287061691, 0.09046897292137146], [0.09096865355968475, 0.09084204584360123, 0.09092893451452255, 0.0909348651766777, 0.09085173904895782, 0.09093862771987915, 0.09085144102573395, 0.09093833714723587, 0.0908552035689354, 0.09094209969043732, 0.09094803780317307]], [[0.10341980308294296, 0.08711329102516174, 0.10265446454286575, 0.08577895164489746, 0.08546096086502075, 0.08582872897386551, 0.08551055938005447, 0.08519356697797775, 0.09229601174592972, 0.09962042421102524, 0.08712322264909744], [0.09088293462991714, 0.09091697633266449, 0.09088440984487534, 0.09092003852128983, 0.09092077612876892, 0.09091992676258087, 0.09092066437005997, 0.09092140197753906, 0.09090550988912582, 0.09089036285877228, 0.0909169614315033], [0.10285543650388718, 0.08728525042533875, 0.10212717205286026, 0.08600585162639618, 0.08570083230733871, 0.08605359494686127, 0.08574841171503067, 0.08544430881738663, 0.0922466292977333, 0.09923779964447021, 0.08729477226734161], [0.08980715274810791, 0.09124139696359634, 0.08986876904964447, 0.09137153625488281, 0.09140288084745407, 0.09136664122343063, 0.0913979783654213, 0.09142933040857315, 0.09075579792261124, 0.09011808037757874, 0.09124043583869934], [0.08954960852861404, 0.0913189947605133, 0.08962549269199371, 0.09147987514734268, 0.09151862561702728, 0.09147382527589798, 0.09151256829500198, 0.09155133366584778, 0.09071918576955795, 0.0899326279759407, 0.0913178101181984], [0.08984743803739548, 0.09122925996780396, 0.08990681916475296, 0.091354601085186, 0.09138479083776474, 0.09134989231824875, 0.09138007462024689, 0.09141026437282562, 0.09076149016618729, 0.09014706313610077, 0.09122833609580994], [0.08958981186151505, 0.0913068875670433, 0.08966346830129623, 0.09146296232938766, 0.09150055050849915, 0.09145709127187729, 0.09149467945098877, 0.09153228253126144, 0.09072492271661758, 0.08996159583330154, 0.09130574017763138], [0.0893326923251152, 0.09138435125350952, 0.08942054957151413, 0.09157121181488037, 0.09161622822284698, 0.09156417846679688, 0.09160918742418289, 0.0916542261838913, 0.09068813174962997, 0.08977627009153366, 0.09138297289609909], [0.09498750418424606, 0.0896759182214737, 0.09475118666887283, 0.08921290934085846, 0.0891018658876419, 0.08923026919364929, 0.08911920338869095, 0.08900827914476395, 0.09143086522817612, 0.09380265325307846, 0.08967934548854828], [0.10059558600187302, 0.0879732146859169, 0.10001341998577118, 0.08691850304603577, 0.08666662871837616, 0.08695792406797409, 0.08670593798160553, 0.08645467460155487, 0.09203692525625229, 0.09769609570503235, 0.08798104524612427], [0.09089092165231705, 0.09091458469629288, 0.09089194238185883, 0.090916708111763, 0.09091722220182419, 0.09091663360595703, 0.09091714024543762, 0.09091765433549881, 0.09090661257505417, 0.09089607745409012, 0.09091456234455109]], [[0.09860094636678696, 0.09833130985498428, 0.08664561063051224, 0.0858999639749527, 0.08566506206989288, 0.0854308009147644, 0.09699413925409317, 0.09672889113426208, 0.08523362874984741, 0.09620058536529541, 0.08426905423402786], [0.09837163239717484, 0.09811052680015564, 0.08677343279123306, 0.08604857325553894, 0.08582016825675964, 0.08559238165616989, 0.09681534767150879, 0.09655837714672089, 0.08540064096450806, 0.09604646265506744, 0.08446246385574341], [0.08798319846391678, 0.0880768820643425, 0.09251562505960464, 0.09282689541578293, 0.09292573481798172, 0.09302467852830887, 0.08854679018259048, 0.08864107728004456, 0.09310824424028397, 0.08882994204759598, 0.09352098405361176], [0.08728989213705063, 0.08740506321191788, 0.09289484471082687, 0.09328222274780273, 0.09340529143810272, 0.09352852404117584, 0.08798316866159439, 0.08809924870729446, 0.09363263100385666, 0.08833187073469162, 0.09414713829755783], [0.08707072585821152, 0.08719262480735779, 0.09301462769508362, 0.09342624992132187, 0.09355705231428146, 0.09368803352117538, 0.08780469745397568, 0.08792762458324432, 0.0937986969947815, 0.0881739929318428, 0.09434569627046585], [0.08685176819562912, 0.08698037266731262, 0.09313420206308365, 0.09357015043497086, 0.09370869398117065, 0.09384744614362717, 0.08762623369693756, 0.08775597810745239, 0.09396468847990036, 0.08801605552434921, 0.09454430639743805], [0.09722762554883957, 0.09700862318277359, 0.08741054683923721, 0.08679062128067017, 0.08659512549638748, 0.08640007674694061, 0.09592098742723465, 0.09570492804050446, 0.08623583614826202, 0.09527426958084106, 0.08543138206005096], [0.09699934720993042, 0.09678865224123001, 0.08753754943609238, 0.08693883568048477, 0.08674999326467514, 0.08656156808137894, 0.09574204683303833, 0.09553408622741699, 0.08640289306640625, 0.09511952102184296, 0.0856255441904068], [0.08666722476482391, 0.0868014469742775, 0.09323497116565704, 0.09369149059057236, 0.09383659064769745, 0.09398192912340164, 0.08747570961713791, 0.08761119097471237, 0.09410472959280014, 0.08788277953863144, 0.09471196681261063], [0.0965433195233345, 0.09634914249181747, 0.08779113739728928, 0.08723504096269608, 0.08705957978963852, 0.08688447624444962, 0.09538409858942032, 0.09519224613904953, 0.0867370069026947, 0.09480971097946167, 0.08601423352956772], [0.08576058596372604, 0.08592217415571213, 0.09372932463884354, 0.09428785741329193, 0.09446550905704498, 0.0946434959769249, 0.08673469722270966, 0.08689811825752258, 0.09479393810033798, 0.08722589164972305, 0.09553848952054977]], [[0.09344235807657242, 0.09360969811677933, 0.08649156242609024, 0.0869813933968544, 0.09447731822729111, 0.09428206831216812, 0.08711280673742294, 0.08726881444454193, 0.09137825667858124, 0.09514262527227402, 0.08981308341026306], [0.09355515986680984, 0.09373025596141815, 0.08629511296749115, 0.08680589497089386, 0.09463829547166824, 0.09443391859531403, 0.08694295585155487, 0.08710567653179169, 0.09139659255743027, 0.09533485025167465, 0.08976126462221146], [0.08847013860940933, 0.08832065016031265, 0.09517540782690048, 0.09466876834630966, 0.08755387365818024, 0.08772523701190948, 0.0945337787270546, 0.09437405318021774, 0.09035773575305939, 0.08697512000799179, 0.09184528142213821], [0.08883936703205109, 0.08871180564165115, 0.09452852606773376, 0.09410081803798676, 0.0880570113658905, 0.08820342272520065, 0.09398680925369263, 0.09385185688734055, 0.09044727683067322, 0.0875622034072876, 0.09171085804700851], [0.09413496404886246, 0.09435033053159714, 0.08528562635183334, 0.08590298146009445, 0.09546864032745361, 0.09521672129631042, 0.0860687866806984, 0.0862656906247139, 0.091487355530262, 0.09632810950279236, 0.08949073404073715], [0.09400522708892822, 0.09421152621507645, 0.08551149815320969, 0.08610517531633377, 0.0952824130654335, 0.09504122287034988, 0.08626458048820496, 0.0864538848400116, 0.09146757423877716, 0.09610509127378464, 0.0895518958568573], [0.08893793821334839, 0.08881627768278122, 0.09435591846704483, 0.09394914656877518, 0.08819162100553513, 0.08833131194114685, 0.09384069591760635, 0.09371233731508255, 0.0904708281159401, 0.08771944046020508, 0.09167454391717911], [0.08905468136072159, 0.08894002437591553, 0.09415151923894882, 0.09376946836709976, 0.08835119009017944, 0.08848288655281067, 0.09366759657859802, 0.09354700148105621, 0.09049852192401886, 0.08790592104196548, 0.09163129329681396], [0.09202482551336288, 0.0920969545841217, 0.08896199613809586, 0.08918227255344391, 0.09246978163719177, 0.09238604456186295, 0.08924125134944916, 0.08931120485067368, 0.09112906455993652, 0.09275436401367188, 0.0904422178864479], [0.09457390010356903, 0.09482022374868393, 0.08452170342206955, 0.08521847426891327, 0.09610053896903992, 0.09581194818019867, 0.08540572226047516, 0.08562816679477692, 0.09155212342739105, 0.09708592295646667, 0.08928128331899643], [0.09091714769601822, 0.0909176617860794, 0.09089502692222595, 0.09089663624763489, 0.09092029929161072, 0.09091971069574356, 0.0908970758318901, 0.0908975824713707, 0.09091075509786606, 0.09092231094837189, 0.0909058079123497]]], "default_policy": {"vf_explained_var": 0.002385437488555908, "curr_entropy_coeff": 0.0015431216992, "num_trainable_parameters": 16595, "curr_kl_coeff": 0.08079196512699127, "policy_loss": -6.984433275647461e-05, "entropy": 0.6871935725212097, "module_train_batch_size_mean": 997.9705930399, "weights_seq_no": 1.0, "use_intrinsic_rewards": 0.0, "num_module_steps_trained": 5985, "vf_loss_unclipped": 40.402488708496094, "num_module_steps_trained_lifetime": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.27804866433143616, "vf_loss": 0.35835564136505127, "mean_kl_loss": 1.0198143172601704e-05, "num_module_steps_trained_lifetime_throughput": 756.5561870217995}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_trainable_parameters": 8266, "weights_seq_no": 1.0, "num_module_steps_trained": 5985, "module_train_batch_size_mean": 997.9705930399, "num_module_steps_trained_lifetime_throughput": 756.5705457373982}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 2.6}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.914596640223826e-06, "tensor_to_numpy": 1.6844768399878353e-05, "un_batch_to_individual_items": 6.603797027236039e-06, "remove_single_ts_time_rank_from_batch": 1.2624522089019267e-05, "listify_data_for_vector_env": 1.0586549153603355e-05, "get_actions": 4.55097818609892e-05}}, "connector_pipeline_timer": 0.0001276543789990602}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.662104297106365e-06, "numpy_to_tensor": 1.2763375869543362e-05, "add_states_from_episodes_to_batch": 3.062141838215135e-06, "batch_individual_items": 1.2637611294296816e-05, "add_time_dim_to_batch_and_zero_pad": 8.294875215538517e-06}}, "connector_pipeline_timer": 6.573482571760863e-05}, "num_agent_steps_sampled": {"default_agent": 400}, "rlmodule_inference_timer": 3.6768868744204366e-05, "episode_duration_sec_mean": 0.005354718852322549, "num_env_steps_sampled_lifetime": 5400, "episode_len_mean": 20.0, "num_episodes_lifetime": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "num_episodes": 20, "env_step_timer": 1.5145008371378223e-05, "weights_seq_no": 1.0, "episode_return_min": -12.5, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 2.6, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 2.6}, "env_to_module_sum_episodes_length_out": 10.216013141322508, "num_env_steps_sampled": 400, "episode_len_max": 20, "env_reset_timer": 0.0006414169911295176, "episode_return_max": 13.5, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.216013141322508, "sample": 0.11779733304865658}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "b4968_00000", "date": "2025-08-11_18-15-05", "timestamp": 1754928905, "time_this_iter_s": 10.730983972549438, "time_total_s": 10.730983972549438, "pid": 10564, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x141ef98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.730983972549438, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 43.4875, "ram_util_percent": 80.625}}
{"timers": {"training_iteration": 10.587007291343761, "restore_env_runners": 1.190739101730287e-05, "training_step": 10.586770129562355, "env_runner_sampling_timer": 1.669619430436287, "learner_update_timer": 8.742638154871528, "synch_weights": 0.0018319020932540298, "restore_eval_env_runners": 6.0999998822808266e-05, "evaluation_iteration": 0.13058829202782363, "synch_eval_env_connectors": 0.00026095809880644083, "synch_env_connectors": 5.332985892891884e-06}, "env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.826318657093266e-06, "numpy_to_tensor": 1.2605970534152147e-05, "add_states_from_episodes_to_batch": 2.7078586392276854e-06, "batch_individual_items": 1.2314479049020329e-05, "add_observations_from_episodes_to_batch": 2.819895408650422e-06}}, "connector_pipeline_timer": 5.907394337084072e-05}, "num_env_steps_sampled_lifetime": 10000.0, "episode_return_mean": -1.9799999999999998, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": -1.9799999999999998}, "module_episode_returns_mean": {"default_policy": -1.9799999999999998}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.00608809587076628, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5300225276242758e-05, "remove_single_ts_time_rank_from_batch": 1.196424252609461e-05, "normalize_and_clip_actions": 7.9968938307243e-06, "get_actions": 3.985997780881585e-05, "listify_data_for_vector_env": 1.0488608159728322e-05, "un_batch_to_individual_items": 6.612870472617381e-06}}, "connector_pipeline_timer": 0.00011833231836276274}, "time_between_sampling": 0.03397305840301548, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 6.5, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "episode_len_mean": 20.0, "num_episodes": 250.0, "num_episodes_lifetime": 500.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "rlmodule_inference_timer": 3.184622361789115e-05, "episode_duration_sec_mean": 0.0052605996332131325, "weights_seq_no": 1.0, "env_step_timer": 1.3784373537362437e-05, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "env_reset_timer": 4.191434594968252e-05, "num_env_steps_sampled_lifetime_throughput": 3259.316872935495}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1366522433841601, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008949365735752508, "add_observations_from_episodes_to_batch": 0.0009092754882294684, "add_columns_from_episodes_to_train_batch": 0.04138632743037306, "add_time_dim_to_batch_and_zero_pad": 0.07659860838903115, "add_states_from_episodes_to_batch": 0.004109284885926172, "batch_individual_items": 0.004426329436246305, "numpy_to_tensor": 7.442298927344382e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_env_steps_trained": 33000, "num_trainable_parameters": 24861, "num_module_steps_trained": 11970, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 23940, "num_env_steps_trained_lifetime": 66000, "num_env_steps_trained_lifetime_throughput": 4169.911045239224, "num_module_steps_trained_throughput": 31584670.322912615, "num_module_steps_trained_lifetime_throughput": 13563626.278611936}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 143640, "num_env_steps_trained_lifetime": 396000, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 50906.38197012471}, "default_policy": {"vf_loss_unclipped": 45.20817184448242, "module_train_batch_size_mean": 997.7412016936058, "num_module_steps_trained_lifetime": 71820, "diff_num_grad_updates_vs_sampler_policy": 11.0, "vf_loss": 0.3598116636276245, "total_loss": 0.2791893482208252, "vf_explained_var": 0.0043929219245910645, "mean_kl_loss": 3.846258550765924e-06, "policy_loss": -6.317263614619151e-05, "entropy": 0.6867523193359375, "weights_seq_no": 12.0, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35910}, "intrinsic_reward_module": {"weights_seq_no": 12.0, "num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.7412016936058, "num_module_steps_trained_lifetime": 71820, "diff_num_grad_updates_vs_sampler_policy": 11.0, "total_loss": 0.0}}}, "IntrinsicAttentionMask": [[[0.09751866012811661, 0.08592953532934189, 0.09698603302240372, 0.08495709300041199, 0.08472476154565811, 0.09562624245882034, 0.09592948853969574, 0.08452922105789185, 0.09540554136037827, 0.08406753838062286, 0.09432585537433624], [0.08856280893087387, 0.0926804393529892, 0.08873721212148666, 0.09306011348962784, 0.09315169602632523, 0.08918841928243637, 0.08908703923225403, 0.09322904050350189, 0.0892624706029892, 0.09341263025999069, 0.08962814509868622], [0.09712706506252289, 0.08622394502162933, 0.09662771224975586, 0.08530528098344803, 0.08508571237325668, 0.09535212069749832, 0.09563668817281723, 0.0849008783698082, 0.09514499455690384, 0.08446437865495682, 0.09413127601146698], [0.0877680629491806, 0.09328063577413559, 0.08799979835748672, 0.09379320591688156, 0.09391695261001587, 0.08860009908676147, 0.0884651318192482, 0.0940214991569519, 0.08869871497154236, 0.0942697525024414, 0.08918610960245132], [0.08757714927196503, 0.09342482686042786, 0.08782254159450531, 0.09396964311599731, 0.0941012054681778, 0.0884583592414856, 0.08831539005041122, 0.0942123532295227, 0.08856284618377686, 0.09447633475065231, 0.08907930552959442], [0.09611886739730835, 0.08698233962059021, 0.09570416808128357, 0.08620429039001465, 0.08601813018321991, 0.09464327991008759, 0.09488014131784439, 0.08586136251688004, 0.0944707915186882, 0.08549091964960098, 0.0936257541179657], [0.09634476155042648, 0.08681236207485199, 0.09591122716665268, 0.08600252866744995, 0.08580881357192993, 0.09480249136686325, 0.09504999220371246, 0.08564569801092148, 0.09462227672338486, 0.0852603018283844, 0.0937395840883255], [0.08741617202758789, 0.09354642778635025, 0.08767303824424744, 0.09411855041980743, 0.09425672143697739, 0.08833872526884079, 0.0881890207529068, 0.09437346458435059, 0.08844814449548721, 0.0946507677435875, 0.08898907899856567], [0.09595407545566559, 0.08710635453462601, 0.09555308520793915, 0.08635158091783524, 0.08617095649242401, 0.0945269912481308, 0.0947561115026474, 0.08601884543895721, 0.09436012804508209, 0.08565936982631683, 0.09354250133037567], [0.08703494071960449, 0.09383437037467957, 0.08731880784034729, 0.09447149187326431, 0.09462542831897736, 0.08805494010448456, 0.08788932859897614, 0.09475551545619965, 0.08817598968744278, 0.09506456553936005, 0.08877468854188919], [0.09514322876930237, 0.08771676570177078, 0.09480909258127213, 0.0870778039097786, 0.08692476898431778, 0.09395305812358856, 0.09414432942867279, 0.08679584413766861, 0.0938137099146843, 0.08649102598428726, 0.09313033521175385]], [[0.09089917689561844, 0.09089259058237076, 0.09088600426912308, 0.09086522459983826, 0.09085863828659058, 0.09086625277996063, 0.09115772694349289, 0.09115111827850342, 0.09069759398698807, 0.09083282202482224, 0.09089279174804688], [0.09091018885374069, 0.09091092646121979, 0.09091166406869888, 0.09091398864984512, 0.09091472625732422, 0.09091386944055557, 0.09088130295276642, 0.09088204056024551, 0.09093277156352997, 0.09091761708259583, 0.090910904109478], [0.09092097729444504, 0.09092903882265091, 0.09093710780143738, 0.09096255898475647, 0.09097062051296234, 0.09096129983663559, 0.09060549736022949, 0.09061353653669357, 0.09116832911968231, 0.09100226312875748, 0.09092879295349121], [0.09095359593629837, 0.09098479151725769, 0.0910160019993782, 0.09111456573009491, 0.091145820915699, 0.09110968559980392, 0.08973904699087143, 0.08976982533931732, 0.0919143483042717, 0.09126848727464676, 0.09098383784294128], [0.0909634679555893, 0.09100200235843658, 0.09104055166244507, 0.09116232395172119, 0.09120093286037445, 0.09115628898143768, 0.08946579694747925, 0.0895036980509758, 0.09215151518583298, 0.09135253727436066, 0.09100081771612167], [0.09095202386379242, 0.09098207950592041, 0.091012142598629, 0.0911070853471756, 0.09113718569278717, 0.09110238403081894, 0.08978178352117538, 0.08981144428253174, 0.09187732636928558, 0.09125534445047379, 0.09098115563392639], [0.09029299765825272, 0.09000177681446075, 0.08971148729324341, 0.08880140632390976, 0.08851499855518341, 0.08884623646736145, 0.10248340666294098, 0.10215286165475845, 0.08178345113992691, 0.08740060031414032, 0.09001070261001587], [0.09031275659799576, 0.09002871066331863, 0.08974557369947433, 0.0888577401638031, 0.08857827633619308, 0.08890147507190704, 0.10218261182308197, 0.10186124593019485, 0.08200351148843765, 0.08749072253704071, 0.09003742039203644], [0.09113800525665283, 0.09135662764310837, 0.09157577902078629, 0.09227091819047928, 0.09249226003885269, 0.09223638474941254, 0.082967609167099, 0.08316662907600403, 0.09808045625686646, 0.09336548298597336, 0.09134990721940994], [0.09100012481212616, 0.09106744080781937, 0.09113480895757675, 0.09134775400161743, 0.09141532331705093, 0.09133719652891159, 0.08840014040470123, 0.08846553415060043, 0.09308545291423798, 0.09168081730604172, 0.09106537699699402], [0.09090985357761383, 0.09091037511825562, 0.0909108817577362, 0.09091249853372574, 0.09091301262378693, 0.09091241657733917, 0.09088978171348572, 0.0908902958035469, 0.09092555195093155, 0.0909150242805481, 0.09091035276651382]], [[0.09352631866931915, 0.09167744219303131, 0.08809001743793488, 0.09202219545841217, 0.09210534393787384, 0.09218855202198029, 0.0920923501253128, 0.08848867565393448, 0.09225883334875107, 0.08864864706993103, 0.08890168368816376], [0.08839894086122513, 0.09013183414936066, 0.09369876980781555, 0.08980350196361542, 0.08972468227148056, 0.08964592963457108, 0.08973699063062668, 0.09328830242156982, 0.08957953751087189, 0.09312461316585541, 0.09286689013242722], [0.0785842090845108, 0.08668778836727142, 0.1054798886179924, 0.0851031243801117, 0.08472618460655212, 0.08435092121362686, 0.08478496223688126, 0.10316456854343414, 0.08403557538986206, 0.10225272923707962, 0.10083012282848358], [0.08935204148292542, 0.09043168276548386, 0.09262938797473907, 0.09022773802280426, 0.09017873555421829, 0.09012976288795471, 0.09018638730049133, 0.09237813204526901, 0.09008845686912537, 0.09227781742811203, 0.0921197384595871], [0.08958213031291962, 0.09050321578979492, 0.09237313270568848, 0.09032934159040451, 0.09028755873441696, 0.0902457907795906, 0.09029408544301987, 0.0921596884727478, 0.09021057188510895, 0.0920744463801384, 0.09194008260965347], [0.0898124948143959, 0.0905744731426239, 0.09211725741624832, 0.09043073654174805, 0.09039618819952011, 0.09036165475845337, 0.09040158241987228, 0.09194142371416092, 0.0903325229883194, 0.09187118709087372, 0.09176045656204224], [0.08954616636037827, 0.09049204736948013, 0.09241313487291336, 0.09031347930431366, 0.09027057141065598, 0.09022767841815948, 0.09027726948261261, 0.09219378978013992, 0.09019149839878082, 0.09210620075464249, 0.09196814149618149], [0.07966417819261551, 0.08709996938705444, 0.10411117225885391, 0.08565103262662888, 0.08530603349208832, 0.08496241271495819, 0.0853598341345787, 0.10203118622303009, 0.08467355370521545, 0.10121086239814758, 0.09992972016334534], [0.09000710397958755, 0.09063441306352615, 0.09190167486667633, 0.09051614999771118, 0.09048771858215332, 0.09045930206775665, 0.09049216657876968, 0.09175743907690048, 0.09043532609939575, 0.09169980883598328, 0.0916089341044426], [0.08009837567806244, 0.08726327866315842, 0.10356616973876953, 0.08586911857128143, 0.08553701639175415, 0.08520619571208954, 0.08558881282806396, 0.10157886892557144, 0.08492805808782578, 0.10079466551542282, 0.0995694100856781], [0.08078613877296448, 0.08751916885375977, 0.10270901024341583, 0.08621197938919067, 0.08590038865804672, 0.0855899304151535, 0.08594898879528046, 0.10086631774902344, 0.0853288397192955, 0.10013852268457413, 0.09900066256523132]], [[0.10030847787857056, 0.08449254184961319, 0.08417931944131851, 0.08319833874702454, 0.09804107993841171, 0.09846297651529312, 0.08293802291154861, 0.09773431718349457, 0.08951933681964874, 0.09662339836359024, 0.08450216799974442], [0.09088898450136185, 0.09092302620410919, 0.09092376381158829, 0.09092608839273453, 0.09089352190494537, 0.09089266508817673, 0.09092671424150467, 0.09089414030313492, 0.09091155976057053, 0.09089640527963638, 0.0909230038523674], [0.09068936109542847, 0.09106164425611496, 0.09106971323490143, 0.0910952016711235, 0.09073887765407562, 0.09072957932949066, 0.09110201895236969, 0.09074566513299942, 0.0909360870718956, 0.09077043831348419, 0.09106139093637466], [0.09006055444478989, 0.09149884432554245, 0.09153023362159729, 0.09162935614585876, 0.0902508944272995, 0.09021510928869247, 0.09165587276220322, 0.09027701616287231, 0.09101187437772751, 0.09037235379219055, 0.09149788320064545], [0.09903238713741302, 0.0853511169552803, 0.08507690578699112, 0.08421718329191208, 0.09708981215953827, 0.09745172411203384, 0.08398882299661636, 0.09682654589414597, 0.0897338017821312, 0.0958721861243248, 0.08535955101251602], [0.09927158802747726, 0.08518987149000168, 0.08490826934576035, 0.0840255469083786, 0.09726852923631668, 0.09764161705970764, 0.08379111438989639, 0.09699714928865433, 0.08969418704509735, 0.09601358324289322, 0.0851985290646553], [0.08989278227090836, 0.09161566197872162, 0.09165331721305847, 0.09177226573228836, 0.09012046456336975, 0.09007766097784042, 0.09180408716201782, 0.09015171974897385, 0.09103173017501831, 0.09026581794023514, 0.0916145071387291], [0.09885795414447784, 0.08546878397464752, 0.0851999819278717, 0.0843571126461029, 0.09695936739444733, 0.09731314331293106, 0.08413320779800415, 0.09670199453830719, 0.08976251631975174, 0.09576890617609024, 0.08547704666852951], [0.09401953220367432, 0.0887620747089386, 0.08865159749984741, 0.08830378949642181, 0.09330139309167862, 0.0934358462691307, 0.08821103721857071, 0.09320339560508728, 0.0904991403222084, 0.09284675121307373, 0.0887654721736908], [0.09822261333465576, 0.08589798957109451, 0.08564907312393188, 0.0848681628704071, 0.09648340940475464, 0.09680768847465515, 0.0846606120467186, 0.09624743461608887, 0.08986584842205048, 0.09539151936769485, 0.08590564131736755], [0.09089511632919312, 0.09091877937316895, 0.09091929346323013, 0.09092091023921967, 0.09089827537536621, 0.09089767932891846, 0.09092134237289429, 0.09089870750904083, 0.09091081470251083, 0.09090027958154678, 0.09091876447200775]], [[0.0986328199505806, 0.08691128343343735, 0.08667361736297607, 0.09724994003772736, 0.08569274842739105, 0.09671878069639206, 0.08572942018508911, 0.08549497276544571, 0.08526118099689484, 0.09623168408870697, 0.09540353715419769], [0.08820699900388718, 0.09230808168649673, 0.09239892661571503, 0.0886555165052414, 0.09277745336294174, 0.08883009850978851, 0.09276319295167923, 0.09285448491573334, 0.09294586628675461, 0.08899134397506714, 0.08926805853843689], [0.08798748254776001, 0.09242171794176102, 0.09252012521028519, 0.08847162127494812, 0.09293024986982346, 0.08866012096405029, 0.09291480481624603, 0.09301373362541199, 0.0931127741932869, 0.0888342559337616, 0.08913314342498779], [0.09744302928447723, 0.08752664923667908, 0.08732356131076813, 0.09628283232450485, 0.08648452907800674, 0.09583654254674911, 0.08651591092348099, 0.08631517738103867, 0.08611489832401276, 0.09542694687843323, 0.09472984820604324], [0.0870780348777771, 0.09289238601922989, 0.0930224359035492, 0.08770846575498581, 0.09356491267681122, 0.08795422315597534, 0.09354446083307266, 0.09367542713880539, 0.09380657225847244, 0.08818139880895615, 0.08857163786888123], [0.09698323160409927, 0.08776454627513885, 0.08757501095533371, 0.09590815752744675, 0.08679165691137314, 0.09549437463283539, 0.08682097494602203, 0.08663348108530045, 0.08644639700651169, 0.09511448442935944, 0.09446769952774048], [0.08711213618516922, 0.09287474304437637, 0.09300360083580017, 0.08773711323738098, 0.09354107081890106, 0.08798074722290039, 0.09352081269025803, 0.09365056455135345, 0.09378049522638321, 0.08820593357086182, 0.0885927677154541], [0.08689399063587189, 0.09298763424158096, 0.0931241437792778, 0.08755376935005188, 0.09369367361068726, 0.08781103789806366, 0.09367220848798752, 0.09380973130464554, 0.09394744783639908, 0.08804887533187866, 0.08845750242471695], [0.08667612820863724, 0.09310036152601242, 0.09324455261230469, 0.08737053722143173, 0.09384623914957047, 0.08764138072729111, 0.09382355213165283, 0.09396886080503464, 0.09411440044641495, 0.08789180964231491, 0.08832217007875443], [0.09656018018722534, 0.08798342943191528, 0.08780647069215775, 0.09556295722723007, 0.08707478642463684, 0.09517893195152283, 0.08710217475891113, 0.08692698925733566, 0.08675215393304825, 0.09482626616954803, 0.09422560781240463], [0.09583791345357895, 0.08835722506046295, 0.08820194005966187, 0.09497258067131042, 0.08755944669246674, 0.09463904798030853, 0.0875835046172142, 0.08742958307266235, 0.0872759148478508, 0.09433259814977646, 0.0938103199005127]], [[0.09593713283538818, 0.0880688801407814, 0.08790590614080429, 0.09502525627613068, 0.09484941512346268, 0.0874188095331192, 0.09487686306238174, 0.08709556609392166, 0.09029611945152283, 0.0866004228591919, 0.09192556142807007], [0.08596951514482498, 0.09372644871473312, 0.0939018651843071, 0.08680237829685211, 0.08696483075618744, 0.09443008899688721, 0.08693943172693253, 0.09478387981653214, 0.0913928896188736, 0.09533098340034485, 0.08975762128829956], [0.08575990051031113, 0.09384657442569733, 0.09402979165315628, 0.08662670850753784, 0.08679582923650742, 0.09458158165216446, 0.08676938712596893, 0.09495124965906143, 0.09141066670417786, 0.09552299976348877, 0.08970527350902557], [0.0947982519865036, 0.08870965242385864, 0.08858228474855423, 0.0940985307097435, 0.09396342188119888, 0.08820127695798874, 0.09398452192544937, 0.08794818818569183, 0.09044507890939713, 0.08756007999181747, 0.09170863032341003], [0.09457813203334808, 0.08883369714021683, 0.08871329575777054, 0.09391903877258301, 0.09379175305366516, 0.08835308253765106, 0.09381162375211716, 0.08811374008655548, 0.0904732197523117, 0.08774666488170624, 0.09166581928730011], [0.08513268083333969, 0.09420628100633621, 0.09441301226615906, 0.08610038459300995, 0.08628932386636734, 0.09503593295812607, 0.08625978231430054, 0.09545350074768066, 0.09146247804164886, 0.09609974175691605, 0.08954691141843796], [0.0946124941110611, 0.08881431818008423, 0.08869282901287079, 0.09394706785678864, 0.0938185602426529, 0.08832935988903046, 0.09383862465620041, 0.08808787167072296, 0.09046883136034012, 0.08771749585866928, 0.09167251735925674], [0.08471589535474777, 0.09444551169872284, 0.09466802328824997, 0.08575005829334259, 0.08595208823680878, 0.09533870220184326, 0.08592049777507782, 0.09578845649957657, 0.09149574488401413, 0.09648481011390686, 0.08944021910429001], [0.08882207423448563, 0.09209630638360977, 0.09216848760843277, 0.08918163925409317, 0.08925154060125351, 0.09238538891077042, 0.08924061805009842, 0.0925302803516388, 0.09112841635942459, 0.09275370836257935, 0.09044157713651657], [0.08407656103372574, 0.09481281042098999, 0.09505975246429443, 0.08521181344985962, 0.08543375134468079, 0.09580445289611816, 0.08539904654026031, 0.09630416333675385, 0.09154496341943741, 0.09707833081483841, 0.08927430212497711], [0.09089399874210358, 0.0909176617860794, 0.09091816842556, 0.09089663624763489, 0.09089715778827667, 0.09091971069574356, 0.0908970758318901, 0.09092073142528534, 0.09091075509786606, 0.09092231094837189, 0.0909058079123497]]], "default_policy": {"vf_explained_var": 0.00019472837448120117, "curr_entropy_coeff": 0.0015431216992, "num_trainable_parameters": 16595, "curr_kl_coeff": 0.040395982563495636, "policy_loss": -6.501666939584538e-05, "entropy": 0.6867449283599854, "module_train_batch_size_mean": 997.9429069707118, "weights_seq_no": 2.0, "use_intrinsic_rewards": 0.0, "num_module_steps_trained": 5985, "vf_loss_unclipped": 45.557106018066406, "num_module_steps_trained_lifetime": 11970, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.27802959084510803, "vf_loss": 0.3583257496356964, "mean_kl_loss": 4.036456175526837e-06, "num_module_steps_trained_lifetime_throughput": 755.9369139394609}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 11970, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_trainable_parameters": 8266, "weights_seq_no": 2.0, "num_module_steps_trained": 5985, "module_train_batch_size_mean": 997.9429069707118, "num_module_steps_trained_lifetime_throughput": 755.9510467275142}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 1.6}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.887490930408597e-06, "tensor_to_numpy": 1.4828651905001168e-05, "un_batch_to_individual_items": 6.492735321458701e-06, "remove_single_ts_time_rank_from_batch": 1.1787826099724069e-05, "listify_data_for_vector_env": 1.050049859575502e-05, "get_actions": 3.5181317158463345e-05}}, "connector_pipeline_timer": 0.00011309395395945406}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.807739491984473e-06, "numpy_to_tensor": 1.1854214594132496e-05, "add_states_from_episodes_to_batch": 2.7944841737814008e-06, "batch_individual_items": 1.2256179387460436e-05, "add_time_dim_to_batch_and_zero_pad": 6.925155784966571e-06}}, "connector_pipeline_timer": 5.895245780134906e-05}, "num_agent_steps_sampled": {"default_agent": 400}, "rlmodule_inference_timer": 3.0254964612969787e-05, "episode_duration_sec_mean": 0.005271567797171884, "num_env_steps_sampled_lifetime": 10400, "episode_len_mean": 20.0, "num_episodes_lifetime": 40, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "num_episodes": 20, "env_step_timer": 1.3765808631160585e-05, "weights_seq_no": 2.0, "episode_return_min": -12.5, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.6, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "agent_episode_returns_mean": {"default_agent": 1.6}, "env_to_module_sum_episodes_length_out": 10.366003441359926, "num_env_steps_sampled": 400, "episode_len_max": 20, "env_reset_timer": 0.0006364474003203213, "episode_return_max": 13.5, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.366003441359926, "sample": 0.11775142429862172, "time_between_sampling": 9.56519979191944}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "b4968_00000", "date": "2025-08-11_18-15-15", "timestamp": 1754928915, "time_this_iter_s": 9.633482933044434, "time_total_s": 20.364466905593872, "pid": 10564, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x141ef98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20.364466905593872, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 30.192857142857143, "ram_util_percent": 79.34285714285714}}
{"timers": {"training_iteration": 10.586342034259962, "restore_env_runners": 1.187123741256073e-05, "training_step": 10.58610407492672, "env_runner_sampling_timer": 1.668849409882701, "learner_update_timer": 8.741729127902223, "synch_weights": 0.001832711412385106, "restore_eval_env_runners": 6.05808396358043e-05, "evaluation_iteration": 0.1304781861975789, "synch_eval_env_connectors": 0.00026002476806752384, "synch_env_connectors": 5.326735554262996e-06}, "env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.121932031628514e-06, "numpy_to_tensor": 1.3213361849311498e-05, "add_states_from_episodes_to_batch": 2.7857411541664007e-06, "batch_individual_items": 1.270386094373661e-05, "add_observations_from_episodes_to_batch": 2.9004045406114017e-06}}, "connector_pipeline_timer": 6.119132976078818e-05}, "num_env_steps_sampled_lifetime": -607500.0, "episode_return_mean": -2.3000000000000007, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": -2.3000000000000007}, "module_episode_returns_mean": {"default_policy": -2.3000000000000007}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.006093359312122324, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5902645946199017e-05, "remove_single_ts_time_rank_from_batch": 1.2293445743567898e-05, "normalize_and_clip_actions": 8.215418456712163e-06, "get_actions": 4.252574796310733e-05, "listify_data_for_vector_env": 1.0895274364139875e-05, "un_batch_to_individual_items": 6.808854831061898e-06}}, "connector_pipeline_timer": 0.00012346173257422681}, "time_between_sampling": 0.032648395683316886, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 6.5, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "episode_len_mean": 20.0, "num_episodes": 250.0, "num_episodes_lifetime": -30375.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "rlmodule_inference_timer": 3.3322266927663773e-05, "episode_duration_sec_mean": 0.005469618667848412, "weights_seq_no": 2.0, "env_step_timer": 1.4442798527405879e-05, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "env_reset_timer": 4.171891104773621e-05, "num_env_steps_sampled_lifetime_throughput": 3176.890480547514}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13753595595071091, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.0089471345787053, "add_observations_from_episodes_to_batch": 0.0009091998229618183, "add_columns_from_episodes_to_train_batch": 0.04140418998590903, "add_time_dim_to_batch_and_zero_pad": 0.07662063438456973, "add_states_from_episodes_to_batch": 0.00410598037719028, "batch_individual_items": 0.0052766157217090945, "numpy_to_tensor": 7.431250925874337e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_env_steps_trained": 33000, "num_trainable_parameters": 24861, "num_module_steps_trained": 11970, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 35910, "num_env_steps_trained_lifetime": 99000, "num_env_steps_trained_lifetime_throughput": 4159.656711805594, "num_module_steps_trained_throughput": 30882304.173360065, "num_module_steps_trained_lifetime_throughput": 13500392.630972743}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 215460, "num_env_steps_trained_lifetime": 594000, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 50458.618474705836}, "default_policy": {"vf_loss_unclipped": 42.97477722167969, "module_train_batch_size_mean": 997.6672132667843, "num_module_steps_trained_lifetime": 107730, "diff_num_grad_updates_vs_sampler_policy": 16.0, "vf_loss": 0.35968390107154846, "total_loss": 0.2786462903022766, "vf_explained_var": 0.004682958126068115, "mean_kl_loss": 2.6976933440892026e-05, "policy_loss": -0.0005116306710988283, "entropy": 0.6859667301177979, "weights_seq_no": 18.0, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35910}, "intrinsic_reward_module": {"weights_seq_no": 18.0, "num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.6672132667843, "num_module_steps_trained_lifetime": 107730, "diff_num_grad_updates_vs_sampler_policy": 16.0, "total_loss": 0.0}}}, "IntrinsicAttentionMask": [[[0.09284023195505142, 0.09100492298603058, 0.09108714759349823, 0.08769340813159943, 0.08777263760566711, 0.0915122777223587, 0.09141677618026733, 0.09149937331676483, 0.0915820449590683, 0.09166478365659714, 0.09192643314599991], [0.08904404193162918, 0.09078957885503769, 0.09070990234613419, 0.09412133693695068, 0.09403873234987259, 0.09030013531446457, 0.0903918594121933, 0.09031251817941666, 0.09023325890302658, 0.09015405923128128, 0.0899045541882515], [0.08921462297439575, 0.09080163389444351, 0.0907292515039444, 0.09382308274507523, 0.09374828636646271, 0.09035692363977432, 0.0904402807354927, 0.09036818146705627, 0.09029614180326462, 0.09022416174411774, 0.08999734371900558], [0.08213668316602707, 0.09009865671396255, 0.0897224098443985, 0.10698255151510239, 0.10653579980134964, 0.08780718594789505, 0.08823306113481522, 0.08786460757255554, 0.08749768882989883, 0.08713230490684509, 0.08598904311656952], [0.08230271935462952, 0.09012012183666229, 0.08975102007389069, 0.10665478557348251, 0.10621795803308487, 0.08787167817354202, 0.08828964084386826, 0.08792802691459656, 0.08756790310144424, 0.08720924705266953, 0.08608686178922653], [0.09009591490030289, 0.09086029976606369, 0.09082558751106262, 0.09229657799005508, 0.09226131439208984, 0.09064681082963943, 0.0906868726015091, 0.0906522274017334, 0.0906175896525383, 0.09058297425508499, 0.09047379344701767], [0.08989806473255157, 0.09084766358137131, 0.09080449491739273, 0.09263723343610764, 0.09259321540594101, 0.09058224409818649, 0.09063203632831573, 0.09058897197246552, 0.09054592996835709, 0.09050290286540985, 0.09036725014448166], [0.09006918966770172, 0.09085861593484879, 0.09082276374101639, 0.0923425555229187, 0.09230611473321915, 0.09063811600208282, 0.09067948907613754, 0.09064369648694992, 0.09060792624950409, 0.09057217091321945, 0.0904594138264656], [0.09024041146039963, 0.09086934477090836, 0.09084080159664154, 0.09204858541488647, 0.09201966971158981, 0.09069377928972244, 0.09072672575712204, 0.0906982347369194, 0.09066974371671677, 0.09064126759767532, 0.09055144339799881], [0.09041173756122589, 0.09087985008955002, 0.09085862338542938, 0.09175532311201096, 0.0917338952422142, 0.09074926376342773, 0.09077377617359161, 0.09075257182121277, 0.09073138236999512, 0.09071018546819687, 0.09064333885908127], [0.09095318615436554, 0.09091158956289291, 0.09091346710920334, 0.09083440899848938, 0.0908362865447998, 0.09092316776514053, 0.09092099219560623, 0.09092287719249725, 0.09092475473880768, 0.0909266397356987, 0.09093257784843445]], [[0.0917133167386055, 0.09154360741376877, 0.09137419611215591, 0.09084159135818481, 0.09067349135875702, 0.09086787700653076, 0.09069972485303879, 0.09053188562393188, 0.09385871887207031, 0.09001720696687698, 0.08787836134433746], [0.09167860448360443, 0.09151633083820343, 0.09135434031486511, 0.09084494411945343, 0.09068413823843002, 0.09087008982896805, 0.09070923924446106, 0.09054867178201675, 0.09372888505458832, 0.09005623310804367, 0.08800846338272095], [0.09164389222860336, 0.0914890468120575, 0.09133446216583252, 0.09084826707839966, 0.09069476276636124, 0.09087227284908295, 0.09071873128414154, 0.09056544303894043, 0.09359920769929886, 0.09009525179862976, 0.08813872933387756], [0.09153410792350769, 0.09140268713235855, 0.09127145260572433, 0.09085848182439804, 0.0907280296087265, 0.09087888151407242, 0.09074839949607849, 0.09061810374259949, 0.09319079667329788, 0.09021821618080139, 0.088550865650177], [0.09149926155805588, 0.09137525409460068, 0.09125141054391861, 0.09086163341999054, 0.09073848277330399, 0.09088088572025299, 0.09075770527124405, 0.09063470363616943, 0.09306167811155319, 0.09025712311267853, 0.08868176490068436], [0.09153954684734344, 0.09140697121620178, 0.09127458184957504, 0.09085799008607864, 0.09072639793157578, 0.09087856113910675, 0.0907469391822815, 0.09061550348997116, 0.09321098029613495, 0.0902121365070343, 0.08853043615818024], [0.09150471538305283, 0.0913795456290245, 0.09125454723834991, 0.09086114913225174, 0.09073685854673386, 0.09088058024644852, 0.09075626730918884, 0.0906321182847023, 0.09308184683322906, 0.09025105088949203, 0.0886613130569458], [0.09146986156702042, 0.09135209769010544, 0.091234490275383, 0.09086427092552185, 0.09074728935956955, 0.0908825621008873, 0.09076555073261261, 0.09064869582653046, 0.09295285493135452, 0.09028995037078857, 0.0887923389673233], [0.09214440733194351, 0.09188143908977509, 0.09161922335624695, 0.09079650789499283, 0.09053739160299301, 0.09083705395460129, 0.09057781845331192, 0.09031932055950165, 0.09549135714769363, 0.08952826261520386, 0.08626721799373627], [0.09136241674423218, 0.0912674218416214, 0.09117252379655838, 0.09087365865707397, 0.09077917039394379, 0.09088842570781708, 0.09079392999410629, 0.09069952368736267, 0.09255669265985489, 0.09040955454111099, 0.08919667452573776], [0.09090662002563477, 0.09090713411569595, 0.09090764820575714, 0.09090926498174667, 0.09090977907180786, 0.09090918302536011, 0.09090970456600189, 0.09091021120548248, 0.0909002348780632, 0.09091179072856903, 0.09091843664646149]], [[0.09317997097969055, 0.09133794158697128, 0.08776380121707916, 0.09168142080307007, 0.0880938321352005, 0.09184715896844864, 0.08808141201734543, 0.09183420240879059, 0.09191717952489853, 0.09200022369623184, 0.09226282685995102], [0.08871845155954361, 0.09045761078596115, 0.09403743594884872, 0.090128093957901, 0.09369487315416336, 0.0899699479341507, 0.09370772540569305, 0.0899822935461998, 0.0899033173918724, 0.08982441574335098, 0.08957581967115402], [0.0800255537033081, 0.08827776461839676, 0.10741453617811203, 0.08666403591632843, 0.10545098036527634, 0.0858980342745781, 0.10552413016557693, 0.08595762401819229, 0.08557690680027008, 0.08519787341356277, 0.08401253819465637], [0.08955173194408417, 0.09063378721475601, 0.0928364023566246, 0.09042938798666, 0.09262703359127045, 0.09033118933439255, 0.0926348865032196, 0.09033885598182678, 0.09028979390859604, 0.09024075418710709, 0.09008616209030151], [0.08082905411720276, 0.08850648254156113, 0.10611073672771454, 0.08700957149267197, 0.10431607812643051, 0.08629829436540604, 0.10438298434019089, 0.08635364472866058, 0.08599995821714401, 0.08564773201942444, 0.08454544097185135], [0.08995363116264343, 0.09071680158376694, 0.09226201474666595, 0.09057284146547318, 0.0921156033873558, 0.09050365537405014, 0.09212110191583633, 0.09050905704498291, 0.09047447144985199, 0.09043990820646286, 0.09033089876174927], [0.08079878985881805, 0.08849798142910004, 0.10615957528352737, 0.0869966596364975, 0.10435863584280014, 0.08628331869840622, 0.10442577302455902, 0.0863388255238533, 0.08598412573337555, 0.0856308788061142, 0.0845254510641098], [0.0899222195148468, 0.0907103642821312, 0.09230680018663406, 0.09056167304515839, 0.09215550124645233, 0.09049021452665329, 0.09216117858886719, 0.09049579501152039, 0.09046008437871933, 0.09042438864707947, 0.09031181037425995], [0.09012335538864136, 0.09075147658586502, 0.09202037751674652, 0.09063306450843811, 0.0919003114104271, 0.09057614207267761, 0.09190482646226883, 0.09058058261871338, 0.09055213630199432, 0.09052369743585587, 0.0904339849948883], [0.09032465517520905, 0.09079231321811676, 0.09173455089330673, 0.09070421755313873, 0.09164553880691528, 0.09066185355186462, 0.0916488841176033, 0.09066516160964966, 0.0906439945101738, 0.09062281996011734, 0.09055603295564651], [0.09096091985702515, 0.09091931581497192, 0.09083620458841324, 0.0909271389245987, 0.09084401279687881, 0.09093090146780014, 0.09084372222423553, 0.09093060344457626, 0.09093248844146729, 0.0909343734383583, 0.09094030410051346]], [[0.09741576015949249, 0.09723549336194992, 0.0892607569694519, 0.08874046057462692, 0.08857624977827072, 0.08876614272594452, 0.08860188722610474, 0.08843792229890823, 0.09168780595064163, 0.08793514966964722, 0.0933423638343811], [0.0971260741353035, 0.09695415198802948, 0.08933437615633011, 0.08883624523878098, 0.0886789932847023, 0.08886083215475082, 0.08870354294776917, 0.08854652941226959, 0.09165641665458679, 0.08806496858596802, 0.09323785454034805], [0.08440431952476501, 0.08456910401582718, 0.09254349023103714, 0.0931149274110794, 0.09329671412706375, 0.09308655560016632, 0.09326829761266708, 0.0934503823518753, 0.08996576815843582, 0.09401309490203857, 0.08828733116388321], [0.08358243107795715, 0.08376690745353699, 0.09274884313344955, 0.09339647740125656, 0.09360260516405106, 0.09336431324481964, 0.09357037395238876, 0.0937768965959549, 0.08983394503593445, 0.09441544115543365, 0.08794178813695908], [0.08332327753305435, 0.08351390808820724, 0.09281352162361145, 0.09348537027835846, 0.09369925409555435, 0.09345200657844543, 0.09366580843925476, 0.09388010203838348, 0.08979175984859467, 0.09454279392957687, 0.08783213794231415], [0.08362296223640442, 0.08380647003650665, 0.09273871034383774, 0.0933825671672821, 0.0935874879360199, 0.09335058927536011, 0.09355545043945312, 0.09376075118780136, 0.08984050899744034, 0.09439553320407867, 0.0879589095711708], [0.08336372673511505, 0.08355339616537094, 0.09280344098806381, 0.09347150474786758, 0.09368416666984558, 0.09343831986188889, 0.09365091472864151, 0.09386398643255234, 0.08979836851358414, 0.09452290832996368, 0.08784928172826767], [0.08310507982969284, 0.0833008736371994, 0.09286797791719437, 0.09356028586626053, 0.09378071129322052, 0.09352590143680573, 0.09374624490737915, 0.09396710246801376, 0.08975601941347122, 0.09465021640062332, 0.08773957937955856], [0.08825325965881348, 0.08832243829965591, 0.09157824516296387, 0.09180499613285065, 0.09187696129083633, 0.09179376065731049, 0.09186571091413498, 0.09193772077560425, 0.09054483473300934, 0.09215971827507019, 0.0898623988032341], [0.08231272548437119, 0.08252711594104767, 0.09306550025939941, 0.09383270144462585, 0.09407709538936615, 0.0937945768237114, 0.09403887391090393, 0.0942838042974472, 0.08962444216012955, 0.09504172950983047, 0.08740141987800598], [0.09088978916406631, 0.0908903032541275, 0.09091395884752274, 0.09091558307409286, 0.09091608971357346, 0.0909155011177063, 0.09091601520776749, 0.09091652184724808, 0.0909065455198288, 0.09091810137033463, 0.09090159833431244]], [[0.09283982962369919, 0.09100452810525894, 0.08744342625141144, 0.09134674817323685, 0.09142928570508957, 0.09151188284158707, 0.0914163812994957, 0.0914989709854126, 0.08791852742433548, 0.0916643887758255, 0.09192603826522827], [0.08904366195201874, 0.09078919142484665, 0.094382144510746, 0.0904584676027298, 0.09037907421588898, 0.09029974788427353, 0.09039147198200226, 0.09031213819980621, 0.09388620406389236, 0.09015367925167084, 0.08990417420864105], [0.08160380274057388, 0.09001876413822174, 0.10953294485807419, 0.08837320655584335, 0.08798178285360336, 0.08759210258722305, 0.08804281800985336, 0.08765286207199097, 0.10665417462587357, 0.08687813580036163, 0.08566942065954208], [0.08975359797477722, 0.09083809703588486, 0.093045674264431, 0.09063323587179184, 0.09058400988578796, 0.09053481370210648, 0.09059169143438339, 0.0905424952507019, 0.09274289011955261, 0.0904441773891449, 0.09028924256563187], [0.08992467820644379, 0.09084928035736084, 0.09272634983062744, 0.0906747430562973, 0.09063280373811722, 0.09059087187051773, 0.09063935279846191, 0.09059742093086243, 0.09246928989887238, 0.09051363170146942, 0.09038154780864716], [0.09009585529565811, 0.09086023271083832, 0.09240788966417313, 0.09071604907512665, 0.09068139642477036, 0.09064675122499466, 0.09068679809570312, 0.09065216034650803, 0.0921962708234787, 0.09058290719985962, 0.0904737189412117], [0.08989793807268143, 0.09084753692150116, 0.09277617186307907, 0.09066826850175858, 0.09062518924474716, 0.09058212488889694, 0.09063190966844559, 0.09058885276317596, 0.09251198917627335, 0.0905027836561203, 0.09036713093519211], [0.09006910026073456, 0.09085853397846222, 0.09245757758617401, 0.09070960432291031, 0.09067381173372269, 0.09063802659511566, 0.09067939966917038, 0.09064361453056335, 0.0922388806939125, 0.09057208895683289, 0.09045933187007904], [0.08260150998830795, 0.09015075117349625, 0.10737476497888565, 0.08868075907230377, 0.08833067119121552, 0.08798195421695709, 0.08838527649641037, 0.08803634345531464, 0.10485637933015823, 0.08734261989593506, 0.08625894784927368], [0.0904117077589035, 0.09087982028722763, 0.09182295948266983, 0.09079163521528244, 0.0907704308629036, 0.09074922651052475, 0.09077374637126923, 0.09075254201889038, 0.09169436246156693, 0.09071015566587448, 0.09064330905675888], [0.09095318615436554, 0.09091158956289291, 0.09082847833633423, 0.09091940522193909, 0.09092129021883011, 0.09092316776514053, 0.09092099219560623, 0.09092287719249725, 0.09083975851535797, 0.0909266397356987, 0.09093257784843445]], [[0.09087207913398743, 0.09116357564926147, 0.09085891395807266, 0.09083814173936844, 0.09083155542612076, 0.09113715589046478, 0.09083259105682373, 0.09112395346164703, 0.09067056328058243, 0.09080575406551361, 0.09086570143699646], [0.08876211196184158, 0.10422563552856445, 0.08811944723129272, 0.08711468428373337, 0.08679874241352081, 0.10272183269262314, 0.08684802055358887, 0.10197808593511581, 0.07941067218780518, 0.08557066321372986, 0.08845005184412003], [0.09095405787229538, 0.09059829264879227, 0.09097018837928772, 0.090995654463768, 0.09100372344255447, 0.0906304270029068, 0.091002456843853, 0.09064650535583496, 0.09120149910449982, 0.0910353735089302, 0.09096188098192215], [0.09108101576566696, 0.08971080929040909, 0.09114351123571396, 0.091242216527462, 0.09127351641654968, 0.08983395248651505, 0.0912686213850975, 0.0898955911397934, 0.09204311668872833, 0.09139635413885117, 0.09111130237579346], [0.0911206305027008, 0.0894307941198349, 0.09119784086942673, 0.09131982177495956, 0.09135850518941879, 0.0895824208855629, 0.09135246276855469, 0.08965833485126495, 0.09231072664260864, 0.09151037037372589, 0.09115803986787796], [0.08897635340690613, 0.10299961268901825, 0.0883890762925148, 0.0874701663851738, 0.08718102425336838, 0.10164443403482437, 0.08722613751888275, 0.10097354650497437, 0.08039220422506332, 0.08605622500181198, 0.08869124203920364], [0.09111446142196655, 0.08947450667619705, 0.09118937700986862, 0.09130771458148956, 0.09134524315595627, 0.08962169289588928, 0.09133937954902649, 0.08969537913799286, 0.09226889163255692, 0.09149257093667984, 0.09115076065063477], [0.08908174932003021, 0.10238981992006302, 0.0885223001241684, 0.08764657378196716, 0.08737091720104218, 0.10110780596733093, 0.08741392195224762, 0.1004728302359581, 0.08088576793670654, 0.08629818260669708, 0.08881016820669174], [0.09199857711791992, 0.08275369554758072, 0.09244048595428467, 0.09314218908548355, 0.0933656245470047, 0.08355060964822769, 0.09333068132400513, 0.08395194262266159, 0.09900658577680588, 0.09424709528684616, 0.0922124832868576], [0.09127315133810043, 0.08833815902471542, 0.09140823781490326, 0.09162182360887527, 0.09168960154056549, 0.08859983086585999, 0.09167900681495667, 0.08873096108436584, 0.09336473792791367, 0.09195588529109955, 0.09133859723806381], [0.09091194719076157, 0.09088931977748871, 0.09091297537088394, 0.09091459214687347, 0.09091510623693466, 0.09089136868715286, 0.0909150242805481, 0.09089238941669464, 0.09092764556407928, 0.09091711789369583, 0.09091244637966156]]], "default_policy": {"vf_explained_var": 0.0007722973823547363, "curr_entropy_coeff": 0.0015431216992, "num_trainable_parameters": 16595, "curr_kl_coeff": 0.020197991281747818, "policy_loss": -0.0005303614889271557, "entropy": 0.6859361529350281, "module_train_batch_size_mean": 997.9168410861561, "weights_seq_no": 3.0, "use_intrinsic_rewards": 0.0, "num_module_steps_trained": 5985, "vf_loss_unclipped": 43.104671478271484, "num_module_steps_trained_lifetime": 17955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.27755245566368103, "vf_loss": 0.3583078682422638, "mean_kl_loss": 2.8907834348501638e-05, "num_module_steps_trained_lifetime_throughput": 754.0837920721767}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 17955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_trainable_parameters": 8266, "weights_seq_no": 3.0, "num_module_steps_trained": 5985, "module_train_batch_size_mean": 997.9168410861561, "num_module_steps_trained_lifetime_throughput": 754.097585108416}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 1.6}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.482813045022552e-06, "tensor_to_numpy": 1.6108626561568178e-05, "un_batch_to_individual_items": 7.197339467360859e-06, "remove_single_ts_time_rank_from_batch": 1.2743138506854857e-05, "listify_data_for_vector_env": 1.1116726371514254e-05, "get_actions": 4.0470564710678186e-05}}, "connector_pipeline_timer": 0.00012397187276131166}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9233494346493117e-06, "numpy_to_tensor": 1.3326474475725134e-05, "add_states_from_episodes_to_batch": 2.902193854420591e-06, "batch_individual_items": 1.3478052834771758e-05, "add_time_dim_to_batch_and_zero_pad": 7.371209394135346e-06}}, "connector_pipeline_timer": 6.308699490860878e-05}, "num_agent_steps_sampled": {"default_agent": 400}, "rlmodule_inference_timer": 3.479650263023625e-05, "episode_duration_sec_mean": 0.00548570006309698, "num_env_steps_sampled_lifetime": 15400, "episode_len_mean": 20.0, "num_episodes_lifetime": 60, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "num_episodes": 20, "env_step_timer": 1.5322780493467914e-05, "weights_seq_no": 3.0, "episode_return_min": -12.5, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.6, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "agent_episode_returns_mean": {"default_agent": 1.6}, "env_to_module_sum_episodes_length_out": 10.368205581254823, "num_env_steps_sampled": 400, "episode_len_max": 20, "env_reset_timer": 0.0006339691759319976, "episode_return_max": 13.5, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368205581254823, "sample": 0.11788065130491741, "time_between_sampling": 9.57504891400109}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "b4968_00000", "date": "2025-08-11_18-15-26", "timestamp": 1754928926, "time_this_iter_s": 10.66385293006897, "time_total_s": 31.028319835662842, "pid": 10564, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x141ef98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 31.028319835662842, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 46.99333333333333, "ram_util_percent": 80.77999999999999}}
{"timers": {"training_iteration": 10.583530749327617, "restore_env_runners": 1.1932525244890711e-05, "training_step": 10.583292258346678, "env_runner_sampling_timer": 1.6679003866135955, "learner_update_timer": 8.738330212872787, "synch_weights": 0.0018323392987735568, "restore_eval_env_runners": 6.055628129979596e-05, "evaluation_iteration": 0.13057641683598045, "synch_eval_env_connectors": 0.0002593686795444228, "synch_env_connectors": 5.321808496955783e-06}, "env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.0684127069982394e-06, "numpy_to_tensor": 1.2894420244666418e-05, "add_states_from_episodes_to_batch": 2.7586665606336723e-06, "batch_individual_items": 1.2582746849505394e-05, "add_observations_from_episodes_to_batch": 2.8753909006466885e-06}}, "connector_pipeline_timer": 6.022702340518826e-05}, "num_env_steps_sampled_lifetime": -1225000.0, "episode_return_mean": -2.8600000000000008, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": -2.8600000000000008}, "module_episode_returns_mean": {"default_policy": -2.8600000000000008}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.005815869869841432, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.564234935379088e-05, "remove_single_ts_time_rank_from_batch": 1.212266082050891e-05, "normalize_and_clip_actions": 8.150208752118664e-06, "get_actions": 4.13404039481205e-05, "listify_data_for_vector_env": 1.0771195574883812e-05, "un_batch_to_individual_items": 6.716470104309456e-06}}, "connector_pipeline_timer": 0.00012122655401839329}, "time_between_sampling": 0.03655417681645675, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 6.5, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "episode_len_mean": 20.0, "num_episodes": 250.0, "num_episodes_lifetime": -61250.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "rlmodule_inference_timer": 3.284853922274247e-05, "episode_duration_sec_mean": 0.005392015832941981, "weights_seq_no": 3.0, "env_step_timer": 1.419736174697799e-05, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "env_reset_timer": 4.390010069147148e-05, "num_env_steps_sampled_lifetime_throughput": 3189.0398150854444}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1389450280505875, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008948758232725203, "add_observations_from_episodes_to_batch": 0.0009089369944060453, "add_columns_from_episodes_to_train_batch": 0.04140862558567465, "add_time_dim_to_batch_and_zero_pad": 0.07660089221007542, "add_states_from_episodes_to_batch": 0.004103460573514341, "batch_individual_items": 0.0067025253942043055, "numpy_to_tensor": 7.465022475935984e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_env_steps_trained": 33000, "num_trainable_parameters": 24861, "num_module_steps_trained": 11970, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 47880, "num_env_steps_trained_lifetime": 132000, "num_env_steps_trained_lifetime_throughput": 4145.019559263372, "num_module_steps_trained_throughput": 30077160.21338269, "num_module_steps_trained_lifetime_throughput": 13436677.673806919}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 287280, "num_env_steps_trained_lifetime": 792000, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 49888.74620459365}, "default_policy": {"vf_loss_unclipped": 47.016624450683594, "module_train_batch_size_mean": 997.6156867483631, "num_module_steps_trained_lifetime": 143640, "diff_num_grad_updates_vs_sampler_policy": 21.0, "vf_loss": 0.3596718907356262, "total_loss": 0.2790135443210602, "vf_explained_var": 0.0043984055519104, "mean_kl_loss": 7.631591870449483e-06, "policy_loss": -0.0001328903454123065, "entropy": 0.685309886932373, "weights_seq_no": 24.0, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35910}, "intrinsic_reward_module": {"weights_seq_no": 24.0, "num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.6156867483631, "num_module_steps_trained_lifetime": 143640, "diff_num_grad_updates_vs_sampler_policy": 21.0, "total_loss": 0.0}}}, "IntrinsicAttentionMask": [[[0.09971831738948822, 0.08786778897047043, 0.09917367249727249, 0.08687340468168259, 0.09805134683847427, 0.08639892190694809, 0.09809330850839615, 0.08643589168787003, 0.08619952201843262, 0.08596380054950714, 0.08522401750087738], [0.08784796297550201, 0.09193235635757446, 0.08802095055580139, 0.09230896830558777, 0.08838154375553131, 0.09249074757099152, 0.08836796134710312, 0.09247653186321259, 0.09256754070520401, 0.0926586389541626, 0.09294675290584564], [0.09918886423110962, 0.08805429935455322, 0.09867890924215317, 0.08711612969636917, 0.09762753546237946, 0.08666824549436569, 0.09766685217618942, 0.08670314401388168, 0.08647997677326202, 0.08625738322734833, 0.08555857837200165], [0.08681906759738922, 0.09227204322814941, 0.08704830706119537, 0.09277907013893127, 0.08752662688493729, 0.09302404522895813, 0.08750860393047333, 0.09300488978624344, 0.09312759339809418, 0.09325046092271805, 0.0936393216252327], [0.09809291362762451, 0.0884389579296112, 0.09765396267175674, 0.08761853724718094, 0.09674805402755737, 0.08722645789384842, 0.09678195416927338, 0.087257020175457, 0.0870615765452385, 0.08686656504869461, 0.08625392615795135], [0.08632636070251465, 0.09243390709161758, 0.08658219128847122, 0.09300408512353897, 0.08711627125740051, 0.09327971190214157, 0.08709613233804703, 0.09325815737247467, 0.09339624643325806, 0.09353452920913696, 0.0939723551273346], [0.09813401103019714, 0.08842458575963974, 0.09769242256879807, 0.08759970963001251, 0.09678108990192413, 0.08720552176237106, 0.09681519120931625, 0.08723624795675278, 0.0870397537946701, 0.08684369921684265, 0.08622780442237854], [0.08636479079723358, 0.09242131561040878, 0.08661855012178421, 0.09298654645681381, 0.08714830130338669, 0.0932597666978836, 0.08712833374738693, 0.09323839843273163, 0.09337528795003891, 0.09351237118244171, 0.09394635260105133], [0.08611896634101868, 0.09250190109014511, 0.08638592809438705, 0.09309879690408707, 0.0869433581829071, 0.09338739514350891, 0.08692234009504318, 0.09336482733488083, 0.09350942075252533, 0.09365425258874893, 0.0941128209233284], [0.08587353676557541, 0.09258223325014114, 0.08615361899137497, 0.0932108536362648, 0.08673858642578125, 0.09351487457752228, 0.08671653270721436, 0.0934910923242569, 0.0936434268951416, 0.0937960147857666, 0.09427925199270248], [0.08510151505470276, 0.09283409267663956, 0.08542250841856003, 0.0935632511973381, 0.08609344810247421, 0.093916155397892, 0.08606813848018646, 0.0938885435461998, 0.09406545013189316, 0.09424268454313278, 0.09480427205562592]], [[0.10324924439191818, 0.10286649316549301, 0.08664721995592117, 0.10129085928201675, 0.08532002568244934, 0.08568718284368515, 0.0853695422410965, 0.10059961676597595, 0.07790400087833405, 0.08408629149198532, 0.08697953820228577], [0.10297451168298721, 0.10260104387998581, 0.08674590289592743, 0.1010633036494255, 0.08544579893350601, 0.0858054980635643, 0.08549430966377258, 0.1003885343670845, 0.07817288488149643, 0.08423685282468796, 0.08707135915756226], [0.09062322229146957, 0.09063126146793365, 0.09100329875946045, 0.09066466987133026, 0.0910368412733078, 0.09102750569581985, 0.09103558212518692, 0.09067948907613754, 0.09123469144105911, 0.09106850624084473, 0.09099497646093369], [0.10183578729629517, 0.10150042921304703, 0.08715321123600006, 0.10011841356754303, 0.0859665498137474, 0.08629503101110458, 0.08601085096597672, 0.09951137006282806, 0.07929673045873642, 0.08486160635948181, 0.08745002001523972], [0.08954766392707825, 0.08958559483289719, 0.09135569632053375, 0.08974342793226242, 0.0915166363120079, 0.0914718434214592, 0.0915105864405632, 0.08981353044509888, 0.09247051179409027, 0.09166876971721649, 0.09131583571434021], [0.08984623849391937, 0.08987592160701752, 0.09125819057226181, 0.08999940752983093, 0.09138356894254684, 0.09134867787361145, 0.09137885272502899, 0.09005424380302429, 0.09212571382522583, 0.09150204807519913, 0.09122712165117264], [0.0895879715681076, 0.0896247923374176, 0.09134253859519958, 0.08977799117565155, 0.09149867296218872, 0.09145520627498627, 0.09149279445409775, 0.08984603732824326, 0.09242387115955353, 0.09164624661207199, 0.09130386263132095], [0.10133225470781326, 0.10101356357336044, 0.08733244240283966, 0.0996997058391571, 0.08619653433561325, 0.0865110382437706, 0.08623896539211273, 0.09912233799695969, 0.07979856431484222, 0.0851382166147232, 0.0876164361834526], [0.08334295451641083, 0.08354288339614868, 0.09332205355167389, 0.08437897264957428, 0.09425601363182068, 0.09399526566267014, 0.09422074258327484, 0.08475255221128464, 0.09995076805353165, 0.09514588862657547, 0.09309188276529312], [0.08853853493928909, 0.08860403299331665, 0.09168335050344467, 0.08887676149606705, 0.09196555614471436, 0.091886967420578, 0.09195493161678314, 0.08899801224470139, 0.09364573657512665, 0.09223264455795288, 0.09161350131034851], [0.09089091420173645, 0.09089143574237823, 0.09091509133577347, 0.09089355915784836, 0.09091722220182419, 0.09091662615537643, 0.09091714024543762, 0.09089450538158417, 0.09092976152896881, 0.09091923385858536, 0.09091456234455109]], [[0.0975031703710556, 0.0972365289926529, 0.09697062522172928, 0.08494359999895096, 0.08471130579710007, 0.08447965234518051, 0.09591425955295563, 0.08451580256223679, 0.08428467810153961, 0.09512953460216522, 0.09431087970733643], [0.09730824828147888, 0.09704995900392532, 0.09679236263036728, 0.08511839807033539, 0.08489246666431427, 0.0846671462059021, 0.09576878696680069, 0.08470230549573898, 0.08447747677564621, 0.09500821679830551, 0.0942145586013794], [0.09711339324712753, 0.09686342626810074, 0.09661410748958588, 0.08529327809810638, 0.08507373183965683, 0.08485475927591324, 0.09562322497367859, 0.08488893508911133, 0.08467043191194534, 0.09488674253225327, 0.09411802142858505], [0.08776483684778214, 0.08788063377141953, 0.08799657225608826, 0.09378976374864578, 0.0939135029911995, 0.09403741359710693, 0.08846188336610794, 0.09401804208755493, 0.09414208680391312, 0.08881248533725739, 0.08918283879756927], [0.08757352828979492, 0.0876961350440979, 0.08781890571117401, 0.09396575391292572, 0.0940973088145256, 0.09422904253005981, 0.08831173181533813, 0.09420845657587051, 0.09434034675359726, 0.08868316560983658, 0.08907562494277954], [0.08738231658935547, 0.08751170337200165, 0.08764127641916275, 0.09414173662662506, 0.09428112208843231, 0.09442072361707687, 0.08816151320934296, 0.09439890831708908, 0.09453868120908737, 0.08855371177196503, 0.08896821737289429], [0.09633437544107437, 0.09611738473176956, 0.09590088576078415, 0.08599326014518738, 0.08579956740140915, 0.08560629934072495, 0.0950397402048111, 0.08563646674156189, 0.08544357120990753, 0.09439896792173386, 0.09372948110103607], [0.08741218596696854, 0.08754051476716995, 0.08766902983188629, 0.09411424398422241, 0.09425241500139236, 0.09439078718423843, 0.08818498998880386, 0.09436915814876556, 0.09450770169496536, 0.08857394754886627, 0.08898501843214035], [0.08722107112407684, 0.08735615760087967, 0.08749145269393921, 0.09429022669792175, 0.09443625807762146, 0.09458252042531967, 0.0880347341299057, 0.09455966204404831, 0.09470611065626144, 0.08844439685344696, 0.08887746185064316], [0.09575062245130539, 0.0955580398440361, 0.09536584466695786, 0.0865187719464302, 0.08634475618600845, 0.08617109060287476, 0.09460091590881348, 0.08619819581508636, 0.08602482825517654, 0.09403125196695328, 0.0934356227517128], [0.09513700008392334, 0.09496979415416718, 0.09480287879705429, 0.08707210421562195, 0.08691907674074173, 0.0867663100361824, 0.09413817524909973, 0.08679015934467316, 0.08663762360811234, 0.0936426967382431, 0.09312423318624496]], [[0.10164528340101242, 0.1012684777379036, 0.10089307278394699, 0.08430711925029755, 0.09934766590595245, 0.08435604721307755, 0.08404333889484406, 0.0990368202328682, 0.07669377326965332, 0.08278002589941025, 0.08562832325696945], [0.10141000151634216, 0.10104221105575562, 0.10067575424909592, 0.08445389568805695, 0.0991668701171875, 0.08450184017419815, 0.08419537544250488, 0.09886331111192703, 0.0769851878285408, 0.08295702934265137, 0.08574847131967545], [0.10117480903863907, 0.10081599652767181, 0.10045845061540604, 0.0846005454659462, 0.098985955119133, 0.08464750647544861, 0.08434730768203735, 0.09868966042995453, 0.07727735489606857, 0.08313403278589249, 0.08586840331554413], [0.0899321660399437, 0.08996301144361496, 0.08999387174844742, 0.0914987251162529, 0.09012223035097122, 0.09149382263422012, 0.09152520447969437, 0.09014830738306046, 0.0923018753528595, 0.09165329486131668, 0.0913674384355545], [0.1001981571316719, 0.09987623989582062, 0.0995553582906723, 0.08520855754613876, 0.09823271632194519, 0.08525140583515167, 0.08497750014066696, 0.09796635061502457, 0.07849971950054169, 0.08386961370706558, 0.08636436611413956], [0.08996797353029251, 0.08999769389629364, 0.09002742916345596, 0.0914771631360054, 0.09015113115310669, 0.09147243946790695, 0.09150266647338867, 0.09017625451087952, 0.0922505334019661, 0.09162602573633194, 0.09135071933269501], [0.0897388756275177, 0.08977575600147247, 0.08981265127658844, 0.09161514043807983, 0.08996617048978806, 0.09160925447940826, 0.09164690971374512, 0.08999737352132797, 0.09257955104112625, 0.09180061519145966, 0.09145765751600266], [0.10000006854534149, 0.09968556463718414, 0.09937205165624619, 0.08533170074224472, 0.09807954728603363, 0.08537370711565018, 0.08510520309209824, 0.09781920164823532, 0.07874947041273117, 0.08401893079280853, 0.08646456897258759], [0.08415096998214722, 0.08435283601284027, 0.08455518633127213, 0.09494207799434662, 0.08540140837430954, 0.09490654617547989, 0.09513421356678009, 0.08557423949241638, 0.10091979056596756, 0.09606833010911942, 0.09399440884590149], [0.08880636841058731, 0.08887206763029099, 0.08893780410289764, 0.09217557311058044, 0.08921156078577042, 0.09216492623090744, 0.09223310649394989, 0.08926723897457123, 0.09392902255058289, 0.09251165390014648, 0.09189064055681229], [0.09089300781488419, 0.09089352190494537, 0.09089403599500656, 0.09091880172491074, 0.09089616686105728, 0.09091871976852417, 0.09091923385858536, 0.0908965989947319, 0.09093185514211655, 0.0909213274717331, 0.09091665595769882]], [[0.09749388694763184, 0.09722727537155151, 0.09696139395236969, 0.0849355086684227, 0.0847032368183136, 0.08447161316871643, 0.08473948389291763, 0.09564285725355148, 0.09538130462169647, 0.09512047469615936, 0.0833229124546051], [0.09729953110218048, 0.09704126417636871, 0.09678369760513306, 0.08511076867580414, 0.08488486707210541, 0.08465956151485443, 0.08492011576890945, 0.09550603479146957, 0.09525252878665924, 0.09499970823526382, 0.08354194462299347], [0.09710519015789032, 0.09685524553060532, 0.09660594910383224, 0.08528607338666916, 0.0850665494799614, 0.084847591817379, 0.08510080724954605, 0.09536904096603394, 0.09512356668710709, 0.09487872570753098, 0.08376123756170273], [0.08776284009218216, 0.08787862211465836, 0.08799456804990768, 0.09378762543201447, 0.09391136467456818, 0.09403526037931442, 0.09389202296733856, 0.08857657015323639, 0.08869343250989914, 0.08881045877933502, 0.09465722739696503], [0.08757127821445465, 0.08769387751817703, 0.08781665563583374, 0.09396333992481232, 0.0940948948264122, 0.09422662854194641, 0.09407433122396469, 0.08843310177326202, 0.08855690062046051, 0.08868088573217392, 0.09488806873559952], [0.0873798057436943, 0.08750918507575989, 0.08763876557350159, 0.09413903206586838, 0.09427841752767563, 0.09441801905632019, 0.09425663203001022, 0.0882895216345787, 0.08842024952173233, 0.08855117112398148, 0.09511911123991013], [0.0876011922955513, 0.08772273361682892, 0.08784443885087967, 0.09393589198589325, 0.09406621754169464, 0.09419672936201096, 0.09404584765434265, 0.08845551311969757, 0.0885782390832901, 0.08870113641023636, 0.09485199302434921], [0.09613394737243652, 0.09592512995004654, 0.09571678191423416, 0.08616319298744202, 0.08597603440284729, 0.08578929305076599, 0.08600524812936783, 0.0946817547082901, 0.09447610378265381, 0.09427089244127274, 0.084861621260643], [0.09593978524208069, 0.09573910385370255, 0.09553885459899902, 0.08633872866630554, 0.0861581340432167, 0.08597791194915771, 0.08618631958961487, 0.09454382956027985, 0.0943460762500763, 0.09414873272180557, 0.08508246392011642], [0.09574567526578903, 0.09555310010910034, 0.09536091983318329, 0.08651430159807205, 0.08634030073881149, 0.0861666351556778, 0.08636745810508728, 0.09440577030181885, 0.09421588480472565, 0.09402638673782349, 0.08530358225107193], [0.08642382174730301, 0.08658665418624878, 0.08674979954957962, 0.09501703083515167, 0.09519605338573456, 0.0953754186630249, 0.09516806900501251, 0.08757014572620392, 0.0877351388335228, 0.08790045231580734, 0.09627733379602432]], [[0.09084507077932358, 0.0908384919166565, 0.09112987667322159, 0.09081114083528519, 0.09110243618488312, 0.09081216901540756, 0.09080559015274048, 0.0907990112900734, 0.09094096720218658, 0.0910765528678894, 0.09083869308233261], [0.09091624617576599, 0.09091697633266449, 0.09088440984487534, 0.09092003852128983, 0.09088747203350067, 0.09091992676258087, 0.09092066437005997, 0.09092140197753906, 0.09090550988912582, 0.09089036285877228, 0.0909169614315033], [0.08762484043836594, 0.08731407672166824, 0.10216090083122253, 0.08603425323963165, 0.10066346079111099, 0.08608201891183853, 0.08577672392129898, 0.08547251671552658, 0.09227710217237473, 0.09927056729793549, 0.08732359856367111], [0.09121038019657135, 0.09124166518449783, 0.08986903727054596, 0.0913718044757843, 0.08999721705913544, 0.09136690944433212, 0.09139824658632278, 0.09142959862947464, 0.09075606614351273, 0.09011834114789963, 0.09124070405960083], [0.08794675767421722, 0.08766420185565948, 0.10106370598077774, 0.08649954199790955, 0.0997210219502449, 0.08654303103685379, 0.08626498281955719, 0.08598783612251282, 0.09216566383838654, 0.09847040474414825, 0.08767285943031311], [0.0911993756890297, 0.09122951328754425, 0.08990706503391266, 0.0913548544049263, 0.09003059566020966, 0.09135014563798904, 0.09138032793998718, 0.09141051769256592, 0.09076174348592758, 0.09014730900526047, 0.09122858941555023], [0.09126976877450943, 0.09130728244781494, 0.08966385573148727, 0.0914633572101593, 0.0898171216249466, 0.09145748615264893, 0.0914950743317604, 0.09153267741203308, 0.09072531759738922, 0.08996198326349258, 0.09130613505840302], [0.09134000539779663, 0.0913849025964737, 0.0894210934638977, 0.09157177060842514, 0.08960393816232681, 0.09156473726034164, 0.09160974621772766, 0.09165478497743607, 0.09068868309259415, 0.08977681398391724, 0.09138353168964386], [0.08979124575853348, 0.08967947959899902, 0.09475494921207428, 0.089216448366642, 0.09426571428775787, 0.08923380821943283, 0.08912273496389389, 0.08901180326938629, 0.09143449366092682, 0.09380637854337692, 0.08968290686607361], [0.08824820816516876, 0.08799248188734055, 0.10003532469272614, 0.0869375467300415, 0.0988360047340393, 0.08697696775197983, 0.08672492206096649, 0.08647361397743225, 0.09205709397792816, 0.09771749377250671, 0.08800031989812851], [0.09091407060623169, 0.09091458469629288, 0.09089194238185883, 0.090916708111763, 0.09089407324790955, 0.09091663360595703, 0.09091714024543762, 0.09091765433549881, 0.09090661257505417, 0.09089607745409012, 0.09091456234455109]]], "default_policy": {"vf_explained_var": 0.00018614530563354492, "curr_entropy_coeff": 0.0015431216992, "num_trainable_parameters": 16595, "curr_kl_coeff": 0.010098995640873909, "policy_loss": -0.000136496513732709, "entropy": 0.6852954030036926, "module_train_batch_size_mean": 997.8923005732703, "weights_seq_no": 4.0, "use_intrinsic_rewards": 0.0, "num_module_steps_trained": 5985, "vf_loss_unclipped": 47.52833557128906, "num_module_steps_trained_lifetime": 23940, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.2779449224472046, "vf_loss": 0.3583061397075653, "mean_kl_loss": 8.09208631835645e-06, "num_module_steps_trained_lifetime_throughput": 751.4373555625186}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 23940, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_trainable_parameters": 8266, "weights_seq_no": 4.0, "num_module_steps_trained": 5985, "module_train_batch_size_mean": 997.8923005732703, "num_module_steps_trained_lifetime_throughput": 751.4507460593204}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 2.35}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.2057470499231e-06, "tensor_to_numpy": 1.5492340533914472e-05, "un_batch_to_individual_items": 6.741125422683665e-06, "remove_single_ts_time_rank_from_batch": 1.207882800515521e-05, "listify_data_for_vector_env": 1.086700639938627e-05, "get_actions": 3.8005213152676126e-05}}, "connector_pipeline_timer": 0.00011859528950187054}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.977289813727398e-06, "numpy_to_tensor": 1.2798919263092696e-05, "add_states_from_episodes_to_batch": 2.905370292532851e-06, "batch_individual_items": 1.28712965692358e-05, "add_time_dim_to_batch_and_zero_pad": 7.162462321761558e-06}}, "connector_pipeline_timer": 6.164978191604129e-05}, "num_agent_steps_sampled": {"default_agent": 400}, "rlmodule_inference_timer": 3.223694168339394e-05, "episode_duration_sec_mean": 0.005507312570989598, "num_env_steps_sampled_lifetime": 20400, "episode_len_mean": 20.0, "num_episodes_lifetime": 80, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "num_episodes": 20, "env_step_timer": 1.4565831873833105e-05, "weights_seq_no": 4.0, "episode_return_min": -13.5, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 2.35, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "agent_episode_returns_mean": {"default_agent": 2.35}, "env_to_module_sum_episodes_length_out": 10.368237912813044, "num_env_steps_sampled": 400, "episode_len_max": 20, "env_reset_timer": 0.0006315661439502146, "episode_return_max": 13.5, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368237912813044, "sample": 0.11792773979225708, "time_between_sampling": 9.582725173611578}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "b4968_00000", "date": "2025-08-11_18-15-36", "timestamp": 1754928936, "time_this_iter_s": 10.440388202667236, "time_total_s": 41.46870803833008, "pid": 10564, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x141ef98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 41.46870803833008, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 39.24, "ram_util_percent": 80.02666666666666}}
{"timers": {"training_iteration": 10.575395081834113, "restore_env_runners": 1.1971119704806478e-05, "training_step": 10.575156719512975, "env_runner_sampling_timer": 1.66698580190801, "learner_update_timer": 8.731016088244031, "synch_weights": 0.0018237671558218819, "restore_eval_env_runners": 6.051863899279852e-05, "evaluation_iteration": 0.130590730577243, "synch_eval_env_connectors": 0.00025871374325070067, "synch_env_connectors": 5.327340568299406e-06}, "env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.059056638254223e-06, "numpy_to_tensor": 1.296793472603685e-05, "add_states_from_episodes_to_batch": 2.7636197784194326e-06, "batch_individual_items": 1.2642297520788812e-05, "add_observations_from_episodes_to_batch": 2.876162354706516e-06}}, "connector_pipeline_timer": 6.049269819896688e-05}, "num_env_steps_sampled_lifetime": -1842500.0, "episode_return_mean": -2.379999999999999, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": -2.379999999999999}, "module_episode_returns_mean": {"default_policy": -2.379999999999999}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.005796028157653663, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.565399678754206e-05, "remove_single_ts_time_rank_from_batch": 1.2119288822406476e-05, "normalize_and_clip_actions": 8.185176280188372e-06, "get_actions": 4.140513297340291e-05, "listify_data_for_vector_env": 1.0911118107865831e-05, "un_batch_to_individual_items": 6.7303006932875936e-06}}, "connector_pipeline_timer": 0.00012155242745589198}, "time_between_sampling": 0.03612154500977537, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 6.5, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "episode_len_mean": 20.0, "num_episodes": 250.0, "num_episodes_lifetime": -92125.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "rlmodule_inference_timer": 3.282890453793305e-05, "episode_duration_sec_mean": 0.00540053295902908, "weights_seq_no": 4.0, "env_step_timer": 1.4230693469320034e-05, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "env_reset_timer": 4.547476329036313e-05, "num_env_steps_sampled_lifetime_throughput": 3169.110275666593}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1389315656898276, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008952238559693064, "add_observations_from_episodes_to_batch": 0.0009088867945707203, "add_columns_from_episodes_to_train_batch": 0.04141692724920662, "add_time_dim_to_batch_and_zero_pad": 0.07660490453891179, "add_states_from_episodes_to_batch": 0.004098386387115531, "batch_individual_items": 0.006678769720026718, "numpy_to_tensor": 7.475538324580877e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_env_steps_trained": 33000, "num_trainable_parameters": 24861, "num_module_steps_trained": 11970, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 59850, "num_env_steps_trained_lifetime": 165000, "num_env_steps_trained_lifetime_throughput": 4130.754551672758, "num_module_steps_trained_throughput": 29255222.877590913, "num_module_steps_trained_lifetime_throughput": 13386727.534445085}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 359100, "num_env_steps_trained_lifetime": 990000, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 49240.4898727911}, "default_policy": {"vf_loss_unclipped": 45.67300033569336, "module_train_batch_size_mean": 997.5798029998547, "num_module_steps_trained_lifetime": 179550, "diff_num_grad_updates_vs_sampler_policy": 26.0, "vf_loss": 0.35956698656082153, "total_loss": 0.27885499596595764, "vf_explained_var": 0.004494428634643555, "mean_kl_loss": 1.2754911040246952e-05, "policy_loss": -0.00021147904044482857, "entropy": 0.6847093105316162, "weights_seq_no": 30.0, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35910}, "intrinsic_reward_module": {"weights_seq_no": 30.0, "num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.5798029998547, "num_module_steps_trained_lifetime": 179550, "diff_num_grad_updates_vs_sampler_policy": 26.0, "total_loss": 0.0}}}, "IntrinsicAttentionMask": [[[0.09352542459964752, 0.09167657047510147, 0.08808917552232742, 0.09202131628990173, 0.0921044573187828, 0.08850032091140747, 0.0884079560637474, 0.09217466413974762, 0.09225794672966003, 0.09234130382537842, 0.08890083432197571], [0.08839814364910126, 0.09013102203607559, 0.0936979278922081, 0.08980269730091095, 0.08972387760877609, 0.09327466785907745, 0.09336940944194794, 0.08965742588043213, 0.08957873284816742, 0.08950011432170868, 0.09286605566740036], [0.07856564968824387, 0.08666731417179108, 0.10545497387647629, 0.0850830227136612, 0.08470617234706879, 0.10306870192289352, 0.10359905660152435, 0.08438950031995773, 0.08401572704315186, 0.08364361524581909, 0.10080631077289581], [0.08935175091028214, 0.09043138474225998, 0.0926290825009346, 0.09022743999958038, 0.09017843753099442, 0.09236998856067657, 0.09242802113294601, 0.09013710916042328, 0.09008815884590149, 0.09003923088312149, 0.09211943298578262], [0.08958189934492111, 0.09050297737121582, 0.09237289428710938, 0.090329110622406, 0.09028732776641846, 0.09215278923511505, 0.0922020971775055, 0.09025208652019501, 0.09021034091711044, 0.09016861021518707, 0.09193984419107437], [0.0796826109290123, 0.08709588646888733, 0.10404839366674423, 0.08565150201320648, 0.08530756831169128, 0.1019119992852211, 0.1023872122168541, 0.08501844108104706, 0.08467704802751541, 0.0843370333313942, 0.09988223016262054], [0.0794314444065094, 0.08700034022331238, 0.10436304658651352, 0.08552442491054535, 0.08517306298017502, 0.10217110812664032, 0.10265858471393585, 0.08487772196531296, 0.08452901989221573, 0.0841817557811737, 0.10008955746889114], [0.08977632224559784, 0.09056319296360016, 0.0921570360660553, 0.09041474759578705, 0.09037906676530838, 0.09196966886520386, 0.09201165288686752, 0.09034896641969681, 0.09031331539154053, 0.09027767926454544, 0.09178834408521652], [0.0900069922208786, 0.0906343013048172, 0.09190156310796738, 0.09051603823900223, 0.09048761427402496, 0.09175282716751099, 0.09178616106510162, 0.09046363085508347, 0.0904352143406868, 0.09040681272745132, 0.09160882234573364], [0.09023794531822205, 0.09070515632629395, 0.09164648503065109, 0.09061714261770248, 0.09059598296880722, 0.09153617173433304, 0.09156090021133423, 0.0905781239271164, 0.09055697172880173, 0.09053581953048706, 0.09142933040857315], [0.0807734951376915, 0.08750548213720322, 0.10269294679164886, 0.08619849383831024, 0.08588695526123047, 0.1007935106754303, 0.10121636092662811, 0.08562495559453964, 0.08531549572944641, 0.08500714600086212, 0.09898518025875092]], [[0.09081801027059555, 0.09110932797193527, 0.0911027267575264, 0.09078408777713776, 0.09077750891447067, 0.09078511595726013, 0.09077853709459305, 0.09106972813606262, 0.09091386944055557, 0.09104941785335541, 0.09081163257360458], [0.08620881289243698, 0.1012275218963623, 0.10086039453744888, 0.0846087783575058, 0.0843019187450409, 0.08465681970119476, 0.08434978872537613, 0.09904462844133377, 0.09089245647192001, 0.09794309735298157, 0.08590573072433472], [0.08631578832864761, 0.10099286586046219, 0.10063469409942627, 0.08474896848201752, 0.08444840461015701, 0.0847960114479065, 0.08449528366327286, 0.09886280447244644, 0.0908985510468483, 0.09778754413127899, 0.08601904660463333], [0.09133860468864441, 0.08996451646089554, 0.089995376765728, 0.09150025248527527, 0.09153164178133011, 0.09149535745382309, 0.09152673929929733, 0.09014981985092163, 0.09088364243507385, 0.09024503082036972, 0.09136896580457687], [0.09143912047147751, 0.08974338322877884, 0.08978140354156494, 0.09163901209831238, 0.09167782962322235, 0.09163294732570648, 0.09167176485061646, 0.08997171372175217, 0.090877003967762, 0.09008907526731491, 0.091476671397686], [0.0913228914141655, 0.08999908715486526, 0.09002882987260818, 0.09147858619689941, 0.09150880575180054, 0.09147386252880096, 0.09150408208370209, 0.09017765522003174, 0.09088466316461563, 0.09026940166950226, 0.09135214239358902], [0.09142343699932098, 0.08977791666984558, 0.08981481939554214, 0.09161734580993652, 0.09165500104427338, 0.09161146730184555, 0.0916491150856018, 0.08999954164028168, 0.09087806195020676, 0.09011344611644745, 0.09145986288785934], [0.08684889227151871, 0.09982339292764664, 0.09950944781303406, 0.0854496881365776, 0.08518093824386597, 0.08549173921346664, 0.08522287011146545, 0.09795445203781128, 0.09092509746551514, 0.09700927883386612, 0.08658412098884583], [0.08932779729366302, 0.0943833664059639, 0.0942658856511116, 0.08875597268342972, 0.08864549547433853, 0.08877324312925339, 0.08866274356842041, 0.09368067234754562, 0.09096256643533707, 0.09332221001386642, 0.08922001719474792], [0.08717561513185501, 0.09910666197538376, 0.09881947189569473, 0.08588088303804398, 0.08563201874494553, 0.0859198272228241, 0.0856708511710167, 0.09739594161510468, 0.09093821048736572, 0.09652981162071228, 0.08693074434995651], [0.09091617166996002, 0.09089353680610657, 0.09089405089616776, 0.09091880917549133, 0.09091932326555252, 0.09091873466968536, 0.09091924130916595, 0.0908966064453125, 0.0909087136387825, 0.09089818596839905, 0.09091667085886002]], [[0.09422054141759872, 0.09235794842243195, 0.08874388784170151, 0.08899719268083572, 0.08907760679721832, 0.09287284314632416, 0.09277592599391937, 0.09285974502563477, 0.08922605216503143, 0.08930666744709015, 0.0895615816116333], [0.08776131272315979, 0.08948170393705368, 0.0930229127407074, 0.09276546537876129, 0.09268404543399811, 0.08899930864572525, 0.08908971399068832, 0.08901152014732361, 0.09253411740064621, 0.09245289862155914, 0.09219703078269958], [0.07573273777961731, 0.08354227989912033, 0.10165249556303024, 0.10023823380470276, 0.09979427605867386, 0.08129020780324936, 0.08170849084854126, 0.08134659379720688, 0.09898083657026291, 0.09854243695735931, 0.09717144817113876], [0.07655218988656998, 0.08397282660007477, 0.10103445500135422, 0.09970878064632416, 0.09929240494966507, 0.08183715492486954, 0.08223407715559006, 0.08189066499471664, 0.09852924942970276, 0.09811779111623764, 0.09683039039373398], [0.07681310176849365, 0.08410908281803131, 0.10083867609500885, 0.09954088181257248, 0.09913318604230881, 0.08201060444116592, 0.08240069448947906, 0.0820632055401802, 0.09838586300611496, 0.09798290580511093, 0.09672185778617859], [0.08953049033880234, 0.09029007703065872, 0.09182801842689514, 0.09171733260154724, 0.09168229252099991, 0.09007792919874191, 0.09011773020029068, 0.0900833010673523, 0.09161772578954697, 0.09158272296190262, 0.0914723351597786], [0.08919648081064224, 0.09013866633176804, 0.09205225110054016, 0.09191427379846573, 0.09187059849500656, 0.08987532556056976, 0.08992473036050797, 0.0898820012807846, 0.09179013222455978, 0.09174651652574539, 0.09160900115966797], [0.08948531001806259, 0.09026962518692017, 0.09185830503702164, 0.09174394607543945, 0.0917077362537384, 0.09005054831504822, 0.09009165316820145, 0.09005609899759293, 0.09164102375507355, 0.09160485863685608, 0.09149081259965897], [0.07729574292898178, 0.08436007052659988, 0.10047772526741028, 0.09923108667135239, 0.09883934259414673, 0.08233058452606201, 0.08270798623561859, 0.082381471991539, 0.09812109917402267, 0.0977337434887886, 0.09652114659547806], [0.07755838334560394, 0.08449608087539673, 0.10028199106454849, 0.0990629643201828, 0.09867984056472778, 0.08250423520803452, 0.08287470787763596, 0.08255419135093689, 0.09797730296850204, 0.0975983738899231, 0.09641197323799133], [0.07839132100343704, 0.08492476493120193, 0.09966432303190231, 0.09853184968233109, 0.09817573428153992, 0.08305271714925766, 0.0834011361002922, 0.08309970796108246, 0.09752250462770462, 0.09717003256082535, 0.09606590121984482]], [[0.0927482396364212, 0.09291434288024902, 0.09308073669672012, 0.08633526414632797, 0.09377551823854446, 0.09358171373605728, 0.09374930709600449, 0.09391719847917557, 0.08365281671285629, 0.08709893375635147, 0.08914592862129211], [0.09282861649990082, 0.09300235658884048, 0.09317641705274582, 0.08613177388906479, 0.09390334039926529, 0.09370055049657822, 0.09387592226266861, 0.09405161440372467, 0.08333712816238403, 0.0869280993938446, 0.08906418830156326], [0.09290879219770432, 0.09309016913175583, 0.09327191114425659, 0.08592849224805832, 0.09403106570243835, 0.09381925314664841, 0.09400241822004318, 0.09418594092130661, 0.08302237838506699, 0.0867573469877243, 0.08898225426673889], [0.08935863524675369, 0.08923033624887466, 0.08910222351551056, 0.09465084224939346, 0.0885717123746872, 0.08871898055076599, 0.08859159797430038, 0.0884643942117691, 0.09708050638437271, 0.09398385137319565, 0.09224691241979599], [0.09323971718549728, 0.09345302730798721, 0.09366683661937714, 0.08508601784706116, 0.09456070512533188, 0.0943111851811409, 0.09452695399522781, 0.09474321454763412, 0.08172427117824554, 0.0860484316945076, 0.08863965421915054], [0.09314803034067154, 0.09335243701934814, 0.09355729073286057, 0.08532000333070755, 0.09441356360912323, 0.0941745713353157, 0.09438123553991318, 0.09458835422992706, 0.08208377659320831, 0.08624551445245743, 0.08873529732227325], [0.0932273343205452, 0.09343944489955902, 0.09365203976631165, 0.08511761575937271, 0.09454082697629929, 0.09429273009300232, 0.09450726956129074, 0.09472229331731796, 0.08177276700735092, 0.08607505261898041, 0.0886525884270668], [0.09330645203590393, 0.09352628141641617, 0.0937466248869896, 0.08491545915603638, 0.09466799348592758, 0.09441077709197998, 0.09463320672512054, 0.0948561578989029, 0.08146270364522934, 0.08590468019247055, 0.08856970071792603], [0.08776240050792694, 0.08751194179058075, 0.08726219087839127, 0.09840375185012817, 0.08623180538415909, 0.08651722222566605, 0.08627031743526459, 0.08602411299943924, 0.10349193960428238, 0.09702924638986588, 0.09349498152732849], [0.08979295939207077, 0.08969959616661072, 0.08960632979869843, 0.09361261874437332, 0.08921974152326584, 0.0893271192908287, 0.08923424035310745, 0.08914145827293396, 0.0953463762998581, 0.09313452243804932, 0.09188508987426758], [0.09091503918170929, 0.09091556072235107, 0.09091606736183167, 0.09089453518390656, 0.09091819822788239, 0.09091760963201523, 0.09091811627149582, 0.090918630361557, 0.09088550508022308, 0.09089705348014832, 0.09090370684862137]], [[0.09421858936548233, 0.09235603362321854, 0.08874204754829407, 0.08899535238742828, 0.08907575905323029, 0.09287092089653015, 0.08906318992376328, 0.09285782277584076, 0.0892242044210434, 0.08930481225252151, 0.09329122304916382], [0.0877596065402031, 0.089479960501194, 0.09302110224962234, 0.09276366233825684, 0.09268224239349365, 0.08899758011102676, 0.0926949605345726, 0.08900978416204453, 0.09253231436014175, 0.09245110303163528, 0.08860770612955093], [0.07569570094347, 0.0835014209151268, 0.10160277783870697, 0.100189208984375, 0.09974546730518341, 0.08125044405460358, 0.09981465339660645, 0.0813068076968193, 0.0989324301481247, 0.09849423915147781, 0.07946696877479553], [0.07651886343955994, 0.08393627405166626, 0.10099047422409058, 0.09966538101434708, 0.09924918413162231, 0.08180153369903564, 0.09931408613920212, 0.08185502141714096, 0.09848635643720627, 0.09807507693767548, 0.08010774105787277], [0.07678092271089554, 0.08407384902238846, 0.10079643130302429, 0.0994991809129715, 0.09909165650606155, 0.08197624981403351, 0.09915520995855331, 0.0820288211107254, 0.09834464639425278, 0.09794186055660248, 0.08031118661165237], [0.08953016251325607, 0.09028974920511246, 0.09182768315076828, 0.09171699732542038, 0.09168195724487305, 0.09007760137319565, 0.09168743342161179, 0.09008297324180603, 0.0916173905134201, 0.09158238768577576, 0.08990565687417984], [0.07673993706703186, 0.08405236899852753, 0.10082674771547318, 0.09952515363693237, 0.09911628067493439, 0.08194895833730698, 0.09918004274368286, 0.08200167119503021, 0.09836679697036743, 0.09796267747879028, 0.0802793875336647], [0.08948496729135513, 0.09026928246021271, 0.09185795485973358, 0.0917435958981514, 0.09170738607645035, 0.09005020558834076, 0.09171304106712341, 0.09005575627088547, 0.09164067357778549, 0.09160450845956802, 0.08987266570329666], [0.07726564258337021, 0.08432722091674805, 0.10043860226869583, 0.09919244796037674, 0.09880086034536362, 0.08229852467775345, 0.098861925303936, 0.08234939724206924, 0.09808289259672165, 0.09769568592309952, 0.08068681508302689], [0.07752938568592072, 0.08446449041366577, 0.10024449974298477, 0.09902592748403549, 0.09864294528961182, 0.08247338980436325, 0.09870267659425735, 0.08252332359552383, 0.09794067591428757, 0.09756188839673996, 0.08089082688093185], [0.09098412096500397, 0.09094250947237015, 0.09085937589406967, 0.09086530655622482, 0.09086719155311584, 0.09095409512519836, 0.09086689352989197, 0.09095379710197449, 0.09087065607309341, 0.09087253361940384, 0.09096350520849228]], [[0.09087207913398743, 0.09116357564926147, 0.09085891395807266, 0.09113612771034241, 0.09083155542612076, 0.09113715589046478, 0.09083259105682373, 0.09082600474357605, 0.09067056328058243, 0.09080575406551361, 0.09086570143699646], [0.08875290304422379, 0.10421482473611832, 0.0881102979183197, 0.1026528924703598, 0.08678973466157913, 0.10271117836236954, 0.08683901280164719, 0.08652406930923462, 0.07940244674682617, 0.08556178212165833, 0.08844088017940521], [0.09095405042171478, 0.09059828519821167, 0.09097018092870712, 0.09063167870044708, 0.09100371599197388, 0.0906304195523262, 0.0910024493932724, 0.09101052582263947, 0.09120149165391922, 0.09103536605834961, 0.09096186608076096], [0.08897703140974045, 0.10294312238693237, 0.088391974568367, 0.10154146701097488, 0.08718844503164291, 0.10159379988908768, 0.08723337948322296, 0.08694611489772797, 0.08042383193969727, 0.086067795753479, 0.08869300037622452], [0.09112051129341125, 0.08943068981170654, 0.09119772166013718, 0.0895882397890091, 0.09135838598012924, 0.08958230912685394, 0.09135234355926514, 0.09139104187488556, 0.09231060743331909, 0.09151025116443634, 0.091157928109169], [0.08896870166063309, 0.1029907613992691, 0.08838147670030594, 0.10158314555883408, 0.08717352896928787, 0.10163570195436478, 0.08721864223480225, 0.08693031966686249, 0.08038530498743057, 0.08604883402585983, 0.08868362009525299], [0.0911143571138382, 0.0894743949174881, 0.09118926525115967, 0.08962734043598175, 0.09134513884782791, 0.08962158858776093, 0.09133926779031754, 0.09137681126594543, 0.09226877987384796, 0.09149245917797089, 0.09115064889192581], [0.09115365892648697, 0.08919481933116913, 0.09124330431222916, 0.08937720209360123, 0.09142987430095673, 0.08937034010887146, 0.09142285585403442, 0.09146779775619507, 0.09253672510385513, 0.09160628169775009, 0.09119709581136703], [0.09199468791484833, 0.08275019377470016, 0.09243657439947128, 0.08357834815979004, 0.09336166828870773, 0.08354707807302475, 0.09332673251628876, 0.09355060756206512, 0.09900238364934921, 0.09424310177564621, 0.09220858663320541], [0.09127278625965118, 0.08833780139684677, 0.09140786528587341, 0.0886097103357315, 0.09168922156095505, 0.08859947323799133, 0.09167863428592682, 0.09174645692110062, 0.09336435794830322, 0.0919555127620697, 0.09133822470903397], [0.09091194719076157, 0.09088931977748871, 0.09091297537088394, 0.09089144319295883, 0.09091510623693466, 0.09089136868715286, 0.0909150242805481, 0.09091553837060928, 0.09092764556407928, 0.09091711789369583, 0.09091244637966156]]], "default_policy": {"vf_explained_var": -8.928775787353516e-05, "curr_entropy_coeff": 0.0015431216992, "num_trainable_parameters": 16595, "curr_kl_coeff": 0.0050494978204369545, "policy_loss": -0.00021761661628261209, "entropy": 0.6846879720687866, "module_train_batch_size_mean": 997.8691961675322, "weights_seq_no": 5.0, "use_intrinsic_rewards": 0.0, "num_module_steps_trained": 5985, "vf_loss_unclipped": 46.05840301513672, "num_module_steps_trained_lifetime": 29925, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.277871698141098, "vf_loss": 0.358315110206604, "mean_kl_loss": 1.360443729936378e-05, "num_module_steps_trained_lifetime_throughput": 748.8595830524492}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 29925, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_trainable_parameters": 8266, "weights_seq_no": 5.0, "num_module_steps_trained": 5985, "module_train_batch_size_mean": 997.8691961675322, "num_module_steps_trained_lifetime_throughput": 748.8724986914228}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 2.6}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.1197467023271148e-05, "tensor_to_numpy": 2.946205912848014e-05, "un_batch_to_individual_items": 9.701961923130023e-06, "remove_single_ts_time_rank_from_batch": 1.7035848097504648e-05, "listify_data_for_vector_env": 1.6015960011033188e-05, "get_actions": 7.748667002408863e-05}}, "connector_pipeline_timer": 0.00020200134908210314}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.534333280767135e-06, "numpy_to_tensor": 1.9351761439305676e-05, "add_states_from_episodes_to_batch": 4.173989507874616e-06, "batch_individual_items": 1.746181073395211e-05, "add_time_dim_to_batch_and_zero_pad": 1.2098065139817971e-05}}, "connector_pipeline_timer": 8.938658243124551e-05}, "num_agent_steps_sampled": {"default_agent": 400}, "rlmodule_inference_timer": 5.308249363408645e-05, "episode_duration_sec_mean": 0.005726340049877762, "num_env_steps_sampled_lifetime": 25400, "episode_len_mean": 20.0, "num_episodes_lifetime": 100, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "num_episodes": 20, "env_step_timer": 2.423244306552597e-05, "weights_seq_no": 5.0, "episode_return_min": -13.5, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 2.6, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "agent_episode_returns_mean": {"default_agent": 2.6}, "env_to_module_sum_episodes_length_out": 10.368238387501162, "num_env_steps_sampled": 400, "episode_len_max": 20, "env_reset_timer": 0.0006266150621678052, "episode_return_max": 13.5, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238387501162, "sample": 0.11820272656435905, "time_between_sampling": 9.584949329795892}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "b4968_00000", "date": "2025-08-11_18-15-46", "timestamp": 1754928946, "time_this_iter_s": 9.92771291732788, "time_total_s": 51.39642095565796, "pid": 10564, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x141ef98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 51.39642095565796, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 35.33571428571429, "ram_util_percent": 79.88571428571427}}
{"timers": {"training_iteration": 10.572519541015893, "restore_env_runners": 1.1947248585605655e-05, "training_step": 10.572280826488054, "env_runner_sampling_timer": 1.6673412851384666, "learner_update_timer": 8.72770146652227, "synch_weights": 0.0018217644844847217, "restore_eval_env_runners": 6.013553229155369e-05, "evaluation_iteration": 0.1308343841019333, "synch_eval_env_connectors": 0.00025745577542684624, "synch_env_connectors": 5.367817585436861e-06}, "env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.683130962672775e-06, "numpy_to_tensor": 1.4213670525643748e-05, "add_states_from_episodes_to_batch": 2.938397344646829e-06, "batch_individual_items": 1.3616646651156507e-05, "add_observations_from_episodes_to_batch": 3.1155190857357287e-06}}, "connector_pipeline_timer": 6.502407026858806e-05}, "num_env_steps_sampled_lifetime": -2460000.0, "episode_return_mean": -1.5800000000000005, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": -1.5800000000000005}, "module_episode_returns_mean": {"default_policy": -1.5800000000000005}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.006044640922030187, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.6966060519649615e-05, "remove_single_ts_time_rank_from_batch": 1.2802147497851329e-05, "normalize_and_clip_actions": 8.658149914397218e-06, "get_actions": 4.603141115241426e-05, "listify_data_for_vector_env": 1.1540758509315686e-05, "un_batch_to_individual_items": 7.175376483317144e-06}}, "connector_pipeline_timer": 0.00013135408634275516}, "time_between_sampling": 0.03421860101597347, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 6.5, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "episode_len_mean": 20.0, "num_episodes": 250.0, "num_episodes_lifetime": -123000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "rlmodule_inference_timer": 3.532366503798362e-05, "episode_duration_sec_mean": 0.0058254646868445, "weights_seq_no": 5.0, "env_step_timer": 1.553244027761008e-05, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "env_reset_timer": 5.175919168070552e-05, "num_env_steps_sampled_lifetime_throughput": 2987.546370406974}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13888458003282694, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008951522424228753, "add_observations_from_episodes_to_batch": 0.0009080725158245858, "add_columns_from_episodes_to_train_batch": 0.04142003255681883, "add_time_dim_to_batch_and_zero_pad": 0.07658821091306159, "add_states_from_episodes_to_batch": 0.004093014183231274, "batch_individual_items": 0.006653143272218185, "numpy_to_tensor": 7.477490975947308e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_env_steps_trained": 33000, "num_trainable_parameters": 24861, "num_module_steps_trained": 11970, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 71820, "num_env_steps_trained_lifetime": 198000, "num_env_steps_trained_lifetime_throughput": 4116.866670755038, "num_module_steps_trained_throughput": 28434283.132060517, "num_module_steps_trained_lifetime_throughput": 13334934.160750838}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 430920, "num_env_steps_trained_lifetime": 1188000, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 48543.829818913626}, "default_policy": {"vf_loss_unclipped": 40.93257522583008, "module_train_batch_size_mean": 997.5548130830801, "num_module_steps_trained_lifetime": 215460, "diff_num_grad_updates_vs_sampler_policy": 31.0, "vf_loss": 0.3594149351119995, "total_loss": 0.2785120904445648, "vf_explained_var": 0.004946708679199219, "mean_kl_loss": 2.128823871316854e-05, "policy_loss": -0.0004383279010653496, "entropy": 0.6840463280677795, "weights_seq_no": 36.0, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35910}, "intrinsic_reward_module": {"weights_seq_no": 36.0, "num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.5548130830801, "num_module_steps_trained_lifetime": 215460, "diff_num_grad_updates_vs_sampler_policy": 31.0, "total_loss": 0.0}}}, "IntrinsicAttentionMask": [[[0.09387155622243881, 0.09201585501432419, 0.09209899604320526, 0.08866755664348602, 0.08874766528606415, 0.08882785588502884, 0.09243229031562805, 0.08881531655788422, 0.09259939193725586, 0.08897587656974792, 0.09294760972261429], [0.08807845413684845, 0.08980506658554077, 0.08972625434398651, 0.09310069680213928, 0.09301898628473282, 0.09293734282255173, 0.089411661028862, 0.09295009076595306, 0.08925478160381317, 0.092787005007267, 0.08892964571714401], [0.08833609521389008, 0.08990748226642609, 0.08983580768108368, 0.09289917349815369, 0.09282511472702026, 0.09275111556053162, 0.08954968303442001, 0.09276267141103745, 0.08940696716308594, 0.09261482954025269, 0.08911110460758209], [0.07787515968084335, 0.0854240357875824, 0.08506730943918228, 0.1014319360256195, 0.10100836306810379, 0.10058655589818954, 0.0836552307009697, 0.10065233707427979, 0.08295801281929016, 0.09981344640254974, 0.08152764290571213], [0.07811496406793594, 0.08553460240364075, 0.08518427610397339, 0.10122793912887573, 0.10081333667039871, 0.10040043294429779, 0.08379726111888885, 0.100464828312397, 0.08311223983764648, 0.09964355826377869, 0.08170656114816666], [0.07835520803928375, 0.08564499020576477, 0.08530107885599136, 0.10102397948503494, 0.10061831772327423, 0.10021428763866425, 0.08393920958042145, 0.10027729719877243, 0.08326644450426102, 0.09947358816862106, 0.08188557624816895], [0.08937083929777145, 0.09031487256288528, 0.090271957218647, 0.09209394454956055, 0.09205018728971481, 0.09200644493103027, 0.09010051190853119, 0.09201327711343765, 0.09001490473747253, 0.09192585945129395, 0.08983727544546127], [0.07831764221191406, 0.08562774956226349, 0.0852828398346901, 0.10105583816766739, 0.10064878314733505, 0.10024336725473404, 0.0839170292019844, 0.10030659288167953, 0.08324235677719116, 0.0995001420378685, 0.0818575993180275], [0.08989071846008301, 0.09051720798015594, 0.09048878401517868, 0.09169188141822815, 0.09166307747364044, 0.09163429588079453, 0.0903751477599144, 0.09163878858089447, 0.09031838178634644, 0.09158123284578323, 0.09020054340362549], [0.07879935204982758, 0.08584805577993393, 0.08551603555679321, 0.10064801573753357, 0.10025875270366669, 0.09987100213766098, 0.08420074731111526, 0.09993147850036621, 0.08355069905519485, 0.09915999323129654, 0.08221585303544998], [0.09097638726234436, 0.09093478322029114, 0.09093666076660156, 0.09085758030414581, 0.09085946530103683, 0.09086134284734726, 0.09094418585300446, 0.09086104482412338, 0.0909479483962059, 0.09086481481790543, 0.09095577150583267]], [[0.09084507077932358, 0.09113647788763046, 0.09083190560340881, 0.09110903739929199, 0.0908045545220375, 0.09081216901540756, 0.09080559015274048, 0.0907990038394928, 0.09094096720218658, 0.0910765528678894, 0.09083869308233261], [0.08753718435764313, 0.1027873158454895, 0.08690338581800461, 0.10124678164720535, 0.08560091257095337, 0.08596128225326538, 0.0856495127081871, 0.08533888310194016, 0.09229300171136856, 0.09945227950811386, 0.08722943812608719], [0.09098725765943527, 0.09063135832548141, 0.09100339561700821, 0.09066475927829742, 0.09103693813085556, 0.09102760255336761, 0.09103567153215408, 0.09104374796152115, 0.09086985886096954, 0.09070433676242828, 0.09099507331848145], [0.08786143362522125, 0.10165242105722427, 0.08728371560573578, 0.10026833415031433, 0.08609527349472046, 0.08642425388097763, 0.08613964915275574, 0.08585598319768906, 0.09218432754278183, 0.09865362197160721, 0.08758096396923065], [0.09128061681985855, 0.08958782255649567, 0.09135796129703522, 0.08974564075469971, 0.09151890873908997, 0.09147410839796066, 0.09151285141706467, 0.09155161678791046, 0.09071946889162064, 0.08993291109800339, 0.09131809324026108], [0.09119928628206253, 0.08987727761268616, 0.09125956147909164, 0.09000077098608017, 0.09138495475053787, 0.09135005623102188, 0.09138023853302002, 0.09141042828559875, 0.09076165407896042, 0.0901472270488739, 0.09122850000858307], [0.09126964211463928, 0.08962689340114594, 0.0913446843624115, 0.08978009223937988, 0.09150081872940063, 0.09145735949277878, 0.09149494767189026, 0.09153255075216293, 0.09072519093751907, 0.08996185660362244, 0.09130600839853287], [0.0913398265838623, 0.08937698602676392, 0.09142965823411942, 0.08955974131822586, 0.09161660820245743, 0.09156455844640732, 0.09160956740379333, 0.09165460616350174, 0.09068850427865982, 0.08977664262056351, 0.09138335287570953], [0.08979008346796036, 0.09487181901931763, 0.08956670016050339, 0.09438198059797287, 0.08910425007343292, 0.0892326608300209, 0.08912158757448196, 0.08901065587997437, 0.0914333164691925, 0.09380517154932022, 0.08968175202608109], [0.08824194967746735, 0.10031893104314804, 0.087731271982193, 0.09911621361970901, 0.08667946606874466, 0.08697079867124557, 0.08671877533197403, 0.08646748214960098, 0.09205055981874466, 0.09771055728197098, 0.08799407631158829], [0.09091407060623169, 0.09089142829179764, 0.09091509133577347, 0.09089355915784836, 0.09091722220182419, 0.09091663360595703, 0.09091714024543762, 0.09091765433549881, 0.09090661257505417, 0.09089607745409012, 0.09091456234455109]], [[0.09974678605794907, 0.08789287507534027, 0.08765251934528351, 0.09834828972816467, 0.08666057139635086, 0.0864235907793045, 0.09812130779027939, 0.08646056801080704, 0.08622412383556366, 0.08598834276199341, 0.09648103266954422], [0.0878511518239975, 0.09193569421768188, 0.09202616661787033, 0.08829785138368607, 0.09240315854549408, 0.09249410033226013, 0.0883711725473404, 0.0924798846244812, 0.09257089346647263, 0.09266199916601181, 0.08890792727470398], [0.08760350942611694, 0.09201838821172714, 0.09211637079715729, 0.08808553218841553, 0.0925247073173523, 0.09262322634458542, 0.08816466480493546, 0.09260782599449158, 0.09270643442869186, 0.09280514717102051, 0.08874417096376419], [0.09837625175714493, 0.08836490660905838, 0.08815987408161163, 0.09720494598150253, 0.08731279522180557, 0.08711020648479462, 0.09701459854841232, 0.08714182674884796, 0.08693962544202805, 0.08673790842294693, 0.09563708305358887], [0.0865788459777832, 0.09235985577106476, 0.09248916059732437, 0.08720565587282181, 0.09302852302789688, 0.0931587666273117, 0.08730866760015488, 0.09313841164112091, 0.09326881170272827, 0.09339938312768936, 0.08806388080120087], [0.08633342385292053, 0.09244147688150406, 0.09257835149765015, 0.08699458837509155, 0.09314942359924316, 0.09328734874725342, 0.08710326254367828, 0.09326578676700592, 0.0934038832783699, 0.0935421884059906, 0.08790028840303421], [0.09815296530723572, 0.08844166249036789, 0.08824244886636734, 0.09701831638813019, 0.08741927891969681, 0.08722236752510071, 0.09683389216661453, 0.08725310117006302, 0.08705656230449677, 0.08686047047376633, 0.09549889713525772], [0.08637172728776932, 0.09242873638868332, 0.09256443381309509, 0.08702754229307175, 0.09313053637742996, 0.09326726198196411, 0.08713532984256744, 0.09324589371681213, 0.09338279068470001, 0.09351988136768341, 0.08792583644390106], [0.0861266627907753, 0.0925101786851883, 0.09265345335006714, 0.08681667596101761, 0.09325132519006729, 0.09339574724435806, 0.08693011105060577, 0.09337317198514938, 0.09351778775453568, 0.09366262704133987, 0.0877622738480568], [0.0858820229768753, 0.09259139001369476, 0.09274226427078247, 0.08660604059696198, 0.09337197244167328, 0.09352411329746246, 0.08672510087490082, 0.09350033104419708, 0.09365268796682358, 0.09380529075860977, 0.08759873360395432], [0.09653248637914658, 0.08899758011102676, 0.08884117007255554, 0.09566088765859604, 0.08819402009248734, 0.08803901076316833, 0.09551900625228882, 0.08806321769952774, 0.08790843933820724, 0.08775394409894943, 0.09449020028114319]], [[0.093076691031456, 0.08544304221868515, 0.09273253381252289, 0.08478780835866928, 0.0920214056968689, 0.09221868216991425, 0.0920480340719223, 0.09187769889831543, 0.09525398164987564, 0.09135536849498749, 0.0891847312450409], [0.08866702020168304, 0.0966673418879509, 0.08899921923875809, 0.09742151200771332, 0.0896935686469078, 0.08949986100196838, 0.08966736495494843, 0.08983518928289413, 0.0866212397813797, 0.09035372734069824, 0.09257398545742035], [0.09289031475782394, 0.08590908348560333, 0.09257667511701584, 0.08530738949775696, 0.09192828088998795, 0.09210819751024246, 0.09195256978273392, 0.09179720282554626, 0.09487222135066986, 0.09132060408592224, 0.08933748304843903], [0.08826004713773727, 0.09772375971078873, 0.08865007013082504, 0.09862332046031952, 0.08946610987186432, 0.08923834562301636, 0.08943530172109604, 0.08963268995285034, 0.08586399257183075, 0.09024301916360855, 0.09286336600780487], [0.09250165522098541, 0.08688333630561829, 0.09225107729434967, 0.08639496564865112, 0.09173253178596497, 0.09187649935483932, 0.09175197780132294, 0.09162762016057968, 0.09408117830753326, 0.09124589711427689, 0.08965327590703964], [0.0926099643111229, 0.08661153167486191, 0.09234189242124557, 0.08609135448932648, 0.09178729355335236, 0.09194124490022659, 0.09180808067321777, 0.09167511016130447, 0.09430093318223953, 0.09126702696084976, 0.08956565707921982], [0.09251628816127777, 0.08684657514095306, 0.092263363301754, 0.08635389059782028, 0.0917399451136589, 0.09188525378704071, 0.0917595624923706, 0.09163405001163483, 0.09411085397005081, 0.0912487655878067, 0.08964145183563232], [0.09242252260446548, 0.08708207309246063, 0.09218470007181168, 0.08661705255508423, 0.09169242531061172, 0.09182910621166229, 0.0917108803987503, 0.09159280359745026, 0.09392096102237701, 0.09123032540082932, 0.08971711993217468], [0.09423048049211502, 0.0825747475028038, 0.09369340538978577, 0.08159971237182617, 0.09258708357810974, 0.09289352595806122, 0.09262842684984207, 0.09236408025026321, 0.09765319526195526, 0.09155511111021042, 0.08822023868560791], [0.09213325381278992, 0.08780979365110397, 0.09194175899028778, 0.08743095397949219, 0.09154509007930756, 0.09165526926517487, 0.09155996888875961, 0.09146476536989212, 0.09333760291337967, 0.09117235243320465, 0.08994923532009125], [0.0909024253487587, 0.09092608839273453, 0.09090345352888107, 0.09092821925878525, 0.0909055843949318, 0.09090498834848404, 0.09090550243854523, 0.09090600907802582, 0.09089603275060654, 0.09090758860111237, 0.09091423451900482]], [[0.0945715382695198, 0.08899407833814621, 0.09278576076030731, 0.08932873606681824, 0.08940944075584412, 0.08949021995067596, 0.09312154352664948, 0.09320566803216934, 0.0895584374666214, 0.08963935822248459, 0.08989521861076355], [0.07410559803247452, 0.10045422613620758, 0.08152379840612411, 0.09858489036560059, 0.09814034402370453, 0.09769779443740845, 0.08006324619054794, 0.07970220595598221, 0.09732593595981598, 0.09688705950975418, 0.09551480412483215], [0.08775965124368668, 0.09259936958551407, 0.08924956619739532, 0.09229294955730438, 0.09221937507390976, 0.09214585274457932, 0.08896531909704208, 0.08889439702033997, 0.09208386391401291, 0.09201046079397202, 0.09177915006875992], [0.07526415586471558, 0.0997510477900505, 0.08221517503261566, 0.09803112596273422, 0.09762175381183624, 0.09721408784389496, 0.08085044473409653, 0.08051281422376633, 0.09687143564224243, 0.09646690636873245, 0.09520115703344345], [0.07554493844509125, 0.09958171844482422, 0.08238167315721512, 0.0978974923491478, 0.09749653190374374, 0.09709721058607101, 0.08104028552770615, 0.08070836961269379, 0.0967615470290184, 0.09636523574590683, 0.09512501209974289], [0.07582651078701019, 0.09941235184669495, 0.08254823088645935, 0.09776371717453003, 0.09737115353345871, 0.09698015451431274, 0.08123031258583069, 0.08090412616729736, 0.09665146470069885, 0.09626336395740509, 0.09504861384630203], [0.08902265876531601, 0.0919165387749672, 0.08992026746273041, 0.09173515439033508, 0.09169156849384308, 0.09164800494909286, 0.08974948525428772, 0.08970684558153152, 0.09161125868558884, 0.09156773239374161, 0.09143047034740448], [0.08934043347835541, 0.0917457863688469, 0.0900879055261612, 0.09159540385007858, 0.09155925363302231, 0.09152312576770782, 0.08994579315185547, 0.08991029858589172, 0.0914926528930664, 0.09145654737949371, 0.09134268015623093], [0.07606472074985504, 0.09926940500736237, 0.0826888158917427, 0.09765072911977768, 0.09726522117853165, 0.09688124060630798, 0.08139077574014664, 0.0810694620013237, 0.09655842185020447, 0.09617722779512405, 0.09498394280672073], [0.07634777575731277, 0.09909996390342712, 0.08285549283027649, 0.09751669317483902, 0.09713954478502274, 0.09676384925842285, 0.08158112317323685, 0.08126560598611832, 0.09644798934459686, 0.09607496112585068, 0.09490708261728287], [0.07724633067846298, 0.09856483340263367, 0.08338188380002975, 0.09709266573190689, 0.09674175083637238, 0.09639210253953934, 0.08218295872211456, 0.0818859338760376, 0.09609806537628174, 0.09575074911117554, 0.09466273337602615]], [[0.09095340222120285, 0.09094680845737457, 0.09094022214412689, 0.09091942757368088, 0.0909128412604332, 0.09092045575380325, 0.09091386944055557, 0.09090728312730789, 0.09075170755386353, 0.09088701009750366, 0.09094701707363129], [0.0909041315317154, 0.09090486913919449, 0.09090560674667358, 0.09090793132781982, 0.09090866893529892, 0.09090781956911087, 0.09090854972600937, 0.09090928733348846, 0.09092671424150467, 0.09091155976057053, 0.0909048467874527], [0.09085486084222794, 0.09086292237043381, 0.09087097644805908, 0.09089641273021698, 0.09090446680784225, 0.0908951535820961, 0.09090320765972137, 0.09091126918792725, 0.09110203385353088, 0.0909360870718956, 0.09086266905069351], [0.09069925546646118, 0.09073036164045334, 0.09076148271560669, 0.09085977077484131, 0.09089093655347824, 0.09085490554571152, 0.09088607132434845, 0.09091724455356598, 0.09165731817483902, 0.09101326763629913, 0.09072940796613693], [0.09064991772174835, 0.0906883180141449, 0.09072673320770264, 0.09084808081388474, 0.09088656306266785, 0.09084207564592361, 0.09088055044412613, 0.09091904759407043, 0.09183386713266373, 0.09103764593601227, 0.09068714082241058], [0.0907069593667984, 0.09073693305253983, 0.09076691418886185, 0.09086159616708755, 0.09089162200689316, 0.09085690975189209, 0.0908869281411171, 0.0909169614315033, 0.0916297659277916, 0.0910094603896141, 0.0907360091805458], [0.09065762907266617, 0.09069488942623138, 0.0907321646809578, 0.09084991365671158, 0.09088724851608276, 0.09084407985210419, 0.09088141471147537, 0.09091877192258835, 0.09180627018213272, 0.09103383868932724, 0.09069374948740005], [0.09060829132795334, 0.09065283089876175, 0.09069739282131195, 0.09083819389343262, 0.09088285267353058, 0.0908312201499939, 0.09087587893009186, 0.09092054516077042, 0.09198307991027832, 0.09105820208787918, 0.09065146744251251], [0.08943840861320496, 0.08965296298265457, 0.08986802399158478, 0.09055019915103912, 0.09076741337776184, 0.09051631391048431, 0.09073344618082047, 0.090951107442379, 0.09625139087438583, 0.09162435680627823, 0.0896463617682457], [0.09045635908842087, 0.09052327275276184, 0.0905902311205864, 0.090801902115345, 0.09086907655000687, 0.09079141914844513, 0.0908585786819458, 0.09092578291893005, 0.09252922236919403, 0.09113297611474991, 0.09052121639251709], [0.09090565145015717, 0.09090616554021835, 0.09090667217969894, 0.09090828895568848, 0.09090880304574966, 0.09090821444988251, 0.0909087210893631, 0.09090923517942429, 0.09092134237289429, 0.09091081470251083, 0.09090614318847656]]], "default_policy": {"vf_explained_var": 0.00040096044540405273, "curr_entropy_coeff": 0.0015431216992, "num_trainable_parameters": 16595, "curr_kl_coeff": 0.0025247489102184772, "policy_loss": -0.0004565547569654882, "entropy": 0.6840080618858337, "module_train_batch_size_mean": 997.8474438281662, "weights_seq_no": 6.0, "use_intrinsic_rewards": 0.0, "num_module_steps_trained": 5985, "vf_loss_unclipped": 40.90755844116211, "num_module_steps_trained_lifetime": 35910, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.2776259779930115, "vf_loss": 0.35830509662628174, "mean_kl_loss": 2.3164262529462576e-05, "num_module_steps_trained_lifetime_throughput": 746.3508796448236}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 35910, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_trainable_parameters": 8266, "weights_seq_no": 6.0, "num_module_steps_trained": 5985, "module_train_batch_size_mean": 997.8474438281662, "num_module_steps_trained_lifetime_throughput": 746.3632661331745}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 3.0}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.18599952329203e-06, "tensor_to_numpy": 1.5783420206921865e-05, "un_batch_to_individual_items": 6.70221545109092e-06, "remove_single_ts_time_rank_from_batch": 1.242538788788619e-05, "listify_data_for_vector_env": 1.0980930619125611e-05, "get_actions": 3.910276838001761e-05}}, "connector_pipeline_timer": 0.00012040103696312626}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9546971855388245e-06, "numpy_to_tensor": 1.2953076462141997e-05, "add_states_from_episodes_to_batch": 2.918307115968409e-06, "batch_individual_items": 1.2742860294522738e-05, "add_time_dim_to_batch_and_zero_pad": 7.29396038385964e-06}}, "connector_pipeline_timer": 6.135066514455348e-05}, "num_agent_steps_sampled": {"default_agent": 400}, "rlmodule_inference_timer": 3.28139193362744e-05, "episode_duration_sec_mean": 0.005733327958732843, "num_env_steps_sampled_lifetime": 30400, "episode_len_mean": 20.0, "num_episodes_lifetime": 120, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "num_episodes": 20, "env_step_timer": 1.567198824177149e-05, "weights_seq_no": 6.0, "episode_return_min": -13.5, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 3.0, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "agent_episode_returns_mean": {"default_agent": 3.0}, "env_to_module_sum_episodes_length_out": 10.368238394470474, "num_env_steps_sampled": 400, "episode_len_max": 20, "env_reset_timer": 0.000623537251306654, "episode_return_max": 13.5, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394470474, "sample": 0.11821259596921342, "time_between_sampling": 9.592373174408584}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "b4968_00000", "date": "2025-08-11_18-15-57", "timestamp": 1754928957, "time_this_iter_s": 10.418526887893677, "time_total_s": 61.814947843551636, "pid": 10564, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x141ef98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 61.814947843551636, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 43.893333333333324, "ram_util_percent": 80.22}}
{"timers": {"training_iteration": 10.579947028945748, "restore_env_runners": 1.1979436160259638e-05, "training_step": 10.57970730364325, "env_runner_sampling_timer": 1.6661600089575914, "learner_update_timer": 8.734831944777337, "synch_weights": 0.001833725589806544, "restore_eval_env_runners": 6.0012096789334266e-05, "evaluation_iteration": 0.13080348943150713, "synch_eval_env_connectors": 0.000256772057448602, "synch_env_connectors": 5.365390090863582e-06}, "env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.956776401242303e-06, "numpy_to_tensor": 1.2722098664710282e-05, "add_states_from_episodes_to_batch": 2.7496312144574595e-06, "batch_individual_items": 1.256476439497192e-05, "add_observations_from_episodes_to_batch": 2.830598082658395e-06}}, "connector_pipeline_timer": 5.980386574094358e-05}, "num_env_steps_sampled_lifetime": -3077500.0, "episode_return_mean": -1.8199999999999996, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": -1.8199999999999996}, "module_episode_returns_mean": {"default_policy": -1.8199999999999996}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.005887113301743053, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5474509317940603e-05, "remove_single_ts_time_rank_from_batch": 1.2016560160221591e-05, "normalize_and_clip_actions": 8.055476561591708e-06, "get_actions": 4.045896965010464e-05, "listify_data_for_vector_env": 1.0648732841096337e-05, "un_batch_to_individual_items": 6.667695737890058e-06}}, "connector_pipeline_timer": 0.00011951939879173182}, "time_between_sampling": 0.03537929960365442, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 6.5, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "episode_len_mean": 20.0, "num_episodes": 250.0, "num_episodes_lifetime": -153875.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "rlmodule_inference_timer": 3.218131230003845e-05, "episode_duration_sec_mean": 0.005312526665162294, "weights_seq_no": 6.0, "env_step_timer": 1.3957920453240266e-05, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "env_reset_timer": 4.684332117638079e-05, "num_env_steps_sampled_lifetime_throughput": 3206.2800102928563}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.14022560590251568, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008950610528899915, "add_observations_from_episodes_to_batch": 0.0009078651213283669, "add_columns_from_episodes_to_train_batch": 0.04142667348228493, "add_time_dim_to_batch_and_zero_pad": 0.07657458755407537, "add_states_from_episodes_to_batch": 0.00408803196122219, "batch_individual_items": 0.00800792850020382, "numpy_to_tensor": 7.478091145365155e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_env_steps_trained": 33000, "num_trainable_parameters": 24861, "num_module_steps_trained": 11970, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 83790, "num_env_steps_trained_lifetime": 231000, "num_env_steps_trained_lifetime_throughput": 4094.4621300253793, "num_module_steps_trained_throughput": 27606638.92878064, "num_module_steps_trained_lifetime_throughput": 13266148.14060985}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 502740, "num_env_steps_trained_lifetime": 1386000, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 47805.59389302435}, "default_policy": {"vf_loss_unclipped": 45.6716194152832, "module_train_batch_size_mean": 997.5374097747205, "num_module_steps_trained_lifetime": 251370, "diff_num_grad_updates_vs_sampler_policy": 36.0, "vf_loss": 0.3594248294830322, "total_loss": 0.27890729904174805, "vf_explained_var": 0.004527390003204346, "mean_kl_loss": 1.6811709429020993e-05, "policy_loss": -5.1804916438413784e-05, "entropy": 0.6829749345779419, "weights_seq_no": 42.0, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35910}, "intrinsic_reward_module": {"weights_seq_no": 42.0, "num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.5374097747205, "num_module_steps_trained_lifetime": 251370, "diff_num_grad_updates_vs_sampler_policy": 36.0, "total_loss": 0.0}}}, "IntrinsicAttentionMask": [[[0.09387240558862686, 0.09201668947935104, 0.08841598778963089, 0.09236271679401398, 0.09244616329669952, 0.09252969175577164, 0.08873595297336578, 0.09251663833856583, 0.08889636397361755, 0.08897668123245239, 0.08923065662384033], [0.08807921409606934, 0.08980583399534225, 0.09335986524820328, 0.08947868645191193, 0.08940015733242035, 0.08932169526815414, 0.09303253144025803, 0.08933394402265549, 0.09286929666996002, 0.09278779476881027, 0.0925309956073761], [0.07713745534420013, 0.08509184420108795, 0.10353796929121017, 0.08353634923696518, 0.08316635340452194, 0.08279800415039062, 0.10171578824520111, 0.08285544067621231, 0.1008167564868927, 0.10037022829055786, 0.09897381067276001], [0.08915229141712189, 0.09022951871156693, 0.09242230653762817, 0.09002602845430374, 0.08997713774442673, 0.0899282693862915, 0.092221699655056, 0.08993590623140335, 0.09212155640125275, 0.0920715257525444, 0.09191379696130753], [0.08941158652305603, 0.09033091366291046, 0.09219727665185928, 0.09015737473964691, 0.09011567384004593, 0.09007398784160614, 0.09202680736780167, 0.09008049964904785, 0.09194168448448181, 0.09189915657043457, 0.09176505357027054], [0.08967132121324539, 0.09043209999799728, 0.0919724628329277, 0.09028859436511993, 0.09025409817695618, 0.09021961688995361, 0.0918319895863533, 0.09022500365972519, 0.09176184237003326, 0.09172677993774414, 0.09161622077226639], [0.07809165120124817, 0.08553287386894226, 0.10260272026062012, 0.08408185839653015, 0.08373642712831497, 0.08339241147041321, 0.10092701017856598, 0.08344606310129166, 0.10009943693876266, 0.09968820959329605, 0.09840130805969238], [0.08963071554899216, 0.0904163047671318, 0.09200756251811981, 0.0902680978178978, 0.0902324765920639, 0.0901968702673912, 0.09186241775751114, 0.0902024358510971, 0.09178992360830307, 0.09175370633602142, 0.09163947403430939], [0.07857146859169006, 0.08575239777565002, 0.10213606059551239, 0.08435411751270294, 0.08402111381292343, 0.08368941396474838, 0.10053274780511856, 0.08374114334583282, 0.09974054247140884, 0.09934678673744202, 0.09811417758464813], [0.07881206274032593, 0.08586191385984421, 0.10190298408269882, 0.08449013531208038, 0.0841633677482605, 0.08383785933256149, 0.10033565014600754, 0.08388862758874893, 0.09956104308366776, 0.09917598962783813, 0.0979704037308693], [0.07957437634468079, 0.08620641380548477, 0.10116841644048691, 0.08491884171962738, 0.0846119225025177, 0.08430611342191696, 0.09971374273300171, 0.08435381203889847, 0.09899426996707916, 0.09863648563623428, 0.09751568734645844]], [[0.10009618103504181, 0.09972511976957321, 0.09935543686151505, 0.08302225172519684, 0.09783358126878738, 0.09825459122657776, 0.09789035469293594, 0.08245568722486496, 0.0755249485373497, 0.08151843398809433, 0.08432332426309586], [0.0998978540301323, 0.09953554719686508, 0.09917455911636353, 0.08319457620382309, 0.09768817573785782, 0.09809941798448563, 0.09774363040924072, 0.08263911306858063, 0.07583724707365036, 0.08172003924846649, 0.08446985483169556], [0.09969945251941681, 0.0993458703160286, 0.09899353981018066, 0.08336687833070755, 0.09754252433776855, 0.09794402867555618, 0.097596675157547, 0.08282256126403809, 0.07615047693252563, 0.08192175626754761, 0.08461625128984451], [0.09005886316299438, 0.09008976072072983, 0.09012065082788467, 0.09162763506174088, 0.0902491956949234, 0.09021341800689697, 0.090244360268116, 0.09168559312820435, 0.0924319177865982, 0.09178242087364197, 0.09149616956710815], [0.09887420386075974, 0.09855654090642929, 0.09823989868164062, 0.08408267050981522, 0.0969347357749939, 0.09729606658220291, 0.09698347002267838, 0.08358526229858398, 0.07746247947216034, 0.08276141434907913, 0.08522320538759232], [0.0991038829088211, 0.09877628087997437, 0.09844976663589478, 0.08388359844684601, 0.09710420668125153, 0.09747666865587234, 0.09715444594621658, 0.0833730474114418, 0.07709585875272751, 0.08252763003110886, 0.08505459874868393], [0.09890524297952652, 0.09858623892068863, 0.09826826304197311, 0.08405577391386032, 0.09695764631032944, 0.09732048958539963, 0.09700658917427063, 0.08355658501386642, 0.07741286605596542, 0.08272981643676758, 0.08520043641328812], [0.08969064801931381, 0.08973474055528641, 0.0897788479924202, 0.09193812310695648, 0.0899624228477478, 0.0899113193154335, 0.08995552361011505, 0.09202148020267487, 0.09309687465429306, 0.09216079860925674, 0.09174913913011551], [0.08497677743434906, 0.0851806253194809, 0.08538495749235153, 0.09587378054857254, 0.08623947948217392, 0.08600090444087982, 0.08620721101760864, 0.09629825502634048, 0.10191015154123306, 0.09701108932495117, 0.09491680562496185], [0.08907604217529297, 0.08914193511009216, 0.08920788019895554, 0.09245547652244568, 0.08948246389627457, 0.08940599113702774, 0.08947212249040604, 0.0925816148519516, 0.09421425312757492, 0.0927925854921341, 0.09216967970132828], [0.09089512377977371, 0.0908956378698349, 0.09089615195989609, 0.09092091768980026, 0.09089828282594681, 0.09089768677949905, 0.09089820086956024, 0.09092186391353607, 0.09093397110700607, 0.09092344343662262, 0.09091877192258835]], [[0.09387125819921494, 0.09201556444168091, 0.08841490745544434, 0.08866727352142334, 0.08874738961458206, 0.0925285592675209, 0.09243199974298477, 0.0925155058503151, 0.0888952761888504, 0.09268275648355484, 0.08922956883907318], [0.08807817846536636, 0.08980478346347809, 0.09335877001285553, 0.09310039132833481, 0.09301868081092834, 0.08932064473628998, 0.08941137045621872, 0.08933290094137192, 0.09286820888519287, 0.08917615562677383, 0.09252990782260895], [0.07711423188447952, 0.08506622165441513, 0.10350679606199265, 0.10206674784421921, 0.10161467641592026, 0.08277307450771332, 0.08319898694753647, 0.08283048868179321, 0.10078640282154083, 0.08209837973117828, 0.09894400835037231], [0.07786892354488373, 0.08541720360517502, 0.1027722954750061, 0.10142382234334946, 0.10100027918815613, 0.08324479311704636, 0.08364854753017426, 0.08329923450946808, 0.10022398829460144, 0.08260497450828552, 0.09849591553211212], [0.07810896635055542, 0.08552803099155426, 0.10253985971212387, 0.10122016817331314, 0.1008056029677391, 0.08339415490627289, 0.08379082381725311, 0.0834476426243782, 0.10004566609859467, 0.08276548236608505, 0.09835358709096909], [0.08967112004756927, 0.09043189883232117, 0.09197225421667099, 0.09186139702796936, 0.09182630479335785, 0.0902194157242775, 0.09025928378105164, 0.09022479504346848, 0.09176163375377655, 0.09015587717294693, 0.09161601215600967], [0.0893707424402237, 0.09031477570533752, 0.09223209321498871, 0.09209384769201279, 0.09205009043216705, 0.09005091339349747, 0.09010041505098343, 0.09005759656429291, 0.09196946024894714, 0.08997204154729843, 0.09178797900676727], [0.08963049948215485, 0.0904160812497139, 0.0920073390007019, 0.0918927937746048, 0.09185652434825897, 0.0901966467499733, 0.0902378261089325, 0.0902022123336792, 0.09178970754146576, 0.09013103693723679, 0.09163925051689148], [0.07855269312858582, 0.08573190867900848, 0.10211165249347687, 0.10084474831819534, 0.10044662654399872, 0.08366941660642624, 0.08405295759439468, 0.08372113108634949, 0.09971670806407928, 0.08306140452623367, 0.09809073060750961], [0.09015125036239624, 0.09061802178621292, 0.09155844151973724, 0.0914909690618515, 0.09146960079669952, 0.09048780798912048, 0.0905122458934784, 0.09049110859632492, 0.09143021702766418, 0.09044884890317917, 0.09134149551391602], [0.07955843955278397, 0.0861891508102417, 0.10114815086126328, 0.09999881684780121, 0.09963739663362503, 0.08428922295570374, 0.08464283496141434, 0.08433691412210464, 0.09897444397211075, 0.08372839540243149, 0.0974961519241333]], [[0.10326841473579407, 0.08698577433824539, 0.08666331321001053, 0.10130966454744339, 0.10093410313129425, 0.10136845707893372, 0.08538538962602615, 0.08506885915994644, 0.07791846990585327, 0.08410190045833588, 0.0869956910610199], [0.09088293462991714, 0.09091697633266449, 0.09091771394014359, 0.09088673442602158, 0.09088747203350067, 0.09088662266731262, 0.09092066437005997, 0.09092140197753906, 0.09093882888555527, 0.09092367440462112, 0.0909169539809227], [0.09062322974205017, 0.09099523723125458, 0.09100330621004105, 0.09066466987133026, 0.09067271649837494, 0.09066341072320938, 0.09103558957576752, 0.09104365855455399, 0.09123469889163971, 0.09106851369142532, 0.09099498391151428], [0.10185064375400543, 0.0874539166688919, 0.08716592937707901, 0.1001330241560936, 0.09980327636003494, 0.10018463432788849, 0.08602340519428253, 0.0857401192188263, 0.07930830121040344, 0.0848739892244339, 0.08746277540922165], [0.10157665610313416, 0.08754389733076096, 0.08726263791322708, 0.09990514814853668, 0.0995841771364212, 0.09995538741350174, 0.08614660054445267, 0.08586983382701874, 0.07957969605922699, 0.08502347022294998, 0.08755254000425339], [0.10189347714185715, 0.08743984252214432, 0.08715079724788666, 0.1001686379313469, 0.0998375192284584, 0.1002204567193985, 0.08600414544343948, 0.08571984618902206, 0.07926596701145172, 0.08485063165426254, 0.08744873106479645], [0.08958816528320312, 0.091305211186409, 0.0913427397608757, 0.08977817744016647, 0.08981508016586304, 0.08977241814136505, 0.09149299561977386, 0.09153059870004654, 0.09242407232522964, 0.09164644777774811, 0.09130406379699707], [0.08933035284280777, 0.09138195216655731, 0.09142687171697617, 0.08955701440572739, 0.08960103988647461, 0.08955013751983643, 0.09160678833723068, 0.09165181964635849, 0.09272290021181107, 0.0917905792593956, 0.09138057380914688], [0.08334899693727493, 0.09310548007488251, 0.09332882612943649, 0.08438508957624435, 0.08458751440048218, 0.08435351401567459, 0.09422756731510162, 0.0944536104798317, 0.09995801001787186, 0.09515278786420822, 0.09309862554073334], [0.08853915333747864, 0.09161622077226639, 0.09168399125337601, 0.088877372443676, 0.08894312381744385, 0.08886711299419403, 0.09195557981729507, 0.09202359616756439, 0.09364639222621918, 0.09223329275846481, 0.09161414206027985], [0.09089091420173645, 0.09091457724571228, 0.09091509133577347, 0.09089355915784836, 0.09089407324790955, 0.09089348465204239, 0.09091714024543762, 0.09091765433549881, 0.09092976152896881, 0.09091923385858536, 0.09091456234455109]], [[0.09387344866991043, 0.09201771020889282, 0.0921008512377739, 0.09236374497413635, 0.088749460875988, 0.0888296365737915, 0.08873693645000458, 0.0925176665186882, 0.09260125458240509, 0.08897767215967178, 0.08923164755105972], [0.08808013796806335, 0.08980678021907806, 0.0897279605269432, 0.08947963267564774, 0.09302075207233429, 0.0929391160607338, 0.09303351491689682, 0.0893348827958107, 0.08925647288560867, 0.09278877079486847, 0.0925319716334343], [0.0883374810218811, 0.08990888297557831, 0.0898372158408165, 0.08961136639118195, 0.09282656759023666, 0.09275256842374802, 0.09283813089132309, 0.08947969228029251, 0.08940836787223816, 0.09261627495288849, 0.09238344430923462], [0.08915264904499054, 0.09022988379001617, 0.09018087387084961, 0.0900263860821724, 0.09221423417329788, 0.09216415882110596, 0.09222206473350525, 0.0899362564086914, 0.08988741785287857, 0.09207189083099365, 0.09191416203975677], [0.07814742624759674, 0.08557014912366867, 0.08521968126296997, 0.0841229036450386, 0.10085523873567581, 0.10044216364622116, 0.1009199246764183, 0.08348873257637024, 0.08314678817987442, 0.09968497604131699, 0.09840202331542969], [0.07838650792837143, 0.08567919582128525, 0.0853351578116417, 0.0842583104968071, 0.10065851360559464, 0.10025431960821152, 0.1007217988371849, 0.08363554626703262, 0.08329970389604568, 0.09951332211494446, 0.09825755655765533], [0.07811012119054794, 0.0855531096458435, 0.08520163595676422, 0.08410174399614334, 0.10088597983121872, 0.10047151148319244, 0.10095088183879852, 0.08346579968929291, 0.08312290161848068, 0.09971179068088531, 0.09842458367347717], [0.08963090181350708, 0.09041649103164673, 0.09038081765174866, 0.09026829153299332, 0.091856949031353, 0.09182069450616837, 0.09186261147260666, 0.09020262211561203, 0.09016703069210052, 0.09175390005111694, 0.09163966774940491], [0.08989092707633972, 0.09051742404699326, 0.0904889926314354, 0.09039931744337082, 0.09166329354047775, 0.09163450449705124, 0.0916677936911583, 0.09034697711467743, 0.09031859785318375, 0.09158144146203995, 0.09149068593978882], [0.07882855087518692, 0.0858798697590828, 0.08554772287607193, 0.08450780808925629, 0.10029591619968414, 0.0999080166220665, 0.10035664588212967, 0.08390618115663528, 0.08358166366815567, 0.09919673949480057, 0.09799090772867203], [0.0795888751745224, 0.08622213453054428, 0.08591050654649734, 0.0849343091249466, 0.09967552125453949, 0.09931527078151703, 0.0997319146990776, 0.08436918258666992, 0.08406426012516022, 0.09865445643663406, 0.0975334569811821]], [[0.09081795066595078, 0.0911092683672905, 0.09110266715288162, 0.09078402817249298, 0.09107523411512375, 0.091082863509655, 0.09107626974582672, 0.09077189862728119, 0.09061655402183533, 0.09075165539979935, 0.09081157296895981], [0.08607010543346405, 0.10106465220451355, 0.10069811344146729, 0.0844726487994194, 0.099188894033432, 0.0996064618229866, 0.09924521297216415, 0.08390864729881287, 0.07700228691101074, 0.08297544717788696, 0.08576751500368118], [0.08618290722370148, 0.10083738714456558, 0.10047976672649384, 0.08461849391460419, 0.09900696575641632, 0.09941450506448746, 0.09906192868947983, 0.0840660110116005, 0.0772937536239624, 0.0831516832113266, 0.08588661998510361], [0.09133725613355637, 0.08996319025754929, 0.08999404311180115, 0.09149890393018723, 0.09012240916490555, 0.0900866836309433, 0.09011758118867874, 0.09155678004026413, 0.09230206161737442, 0.0916534811258316, 0.09136762470006943], [0.08664923161268234, 0.09989359974861145, 0.09957265853881836, 0.08522336930036545, 0.09824978560209274, 0.09861602634191513, 0.09829919040203094, 0.0847192108631134, 0.07851336151361465, 0.08388419449329376, 0.08637937903404236], [0.08651990443468094, 0.1001560166478157, 0.0998249426484108, 0.08505530655384064, 0.09846058487892151, 0.09883824735879898, 0.09851152449846268, 0.08453762531280518, 0.07817275822162628, 0.0836803987622261, 0.0862426683306694], [0.08663177490234375, 0.09992904961109161, 0.09960674494504929, 0.08520066738128662, 0.09827827662229538, 0.09864605218172073, 0.0983278900384903, 0.08469468355178833, 0.07846728712320328, 0.08385665714740753, 0.08636092394590378], [0.09152105450630188, 0.0895543172955513, 0.08959833532571793, 0.0917532742023468, 0.08978154510259628, 0.08973053842782974, 0.08977465331554413, 0.09183645993471146, 0.09290969371795654, 0.09197549521923065, 0.09156466275453568], [0.09378504753112793, 0.08436064422130585, 0.08456301689147949, 0.09495086967945099, 0.08540931344032288, 0.08517303317785263, 0.08537735790014267, 0.09537125378847122, 0.1009291335940361, 0.09607722610235214, 0.0940031111240387], [0.09182562679052353, 0.08887286484241486, 0.08893860876560211, 0.0921764075756073, 0.08921236544847488, 0.08913612365722656, 0.08920206129550934, 0.09230216592550278, 0.09392987191677094, 0.09251249581575394, 0.09189146757125854], [0.09091615676879883, 0.09089352190494537, 0.09089403599500656, 0.09091880172491074, 0.09089616686105728, 0.09089557081460953, 0.09089608490467072, 0.09091974794864655, 0.09093185514211655, 0.0909213274717331, 0.09091665595769882]]], "default_policy": {"vf_explained_var": -9.262561798095703e-05, "curr_entropy_coeff": 0.0015431216992, "num_trainable_parameters": 16595, "curr_kl_coeff": 0.0012623744551092386, "policy_loss": -5.1859180530300364e-05, "entropy": 0.6829735040664673, "module_train_batch_size_mean": 997.82696443245, "weights_seq_no": 7.0, "use_intrinsic_rewards": 0.0, "num_module_steps_trained": 5985, "vf_loss_unclipped": 46.067848205566406, "num_module_steps_trained_lifetime": 41895, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.2780327796936035, "vf_loss": 0.35830581188201904, "mean_kl_loss": 1.6871659681783058e-05, "num_module_steps_trained_lifetime_throughput": 742.2980049189241}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 41895, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_trainable_parameters": 8266, "weights_seq_no": 7.0, "num_module_steps_trained": 5985, "module_train_batch_size_mean": 997.82696443245, "num_module_steps_trained_lifetime_throughput": 742.3098550732104}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 3.2}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.0164885878150436e-05, "tensor_to_numpy": 2.0623543711363037e-05, "un_batch_to_individual_items": 8.62036111176649e-06, "remove_single_ts_time_rank_from_batch": 1.548262945987341e-05, "listify_data_for_vector_env": 1.4260000871043938e-05, "get_actions": 5.719201303248802e-05}}, "connector_pipeline_timer": 0.00016292158498875227}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.997404211924944e-06, "numpy_to_tensor": 1.7926914577140723e-05, "add_states_from_episodes_to_batch": 3.623400309032652e-06, "batch_individual_items": 1.7307309566334896e-05, "add_time_dim_to_batch_and_zero_pad": 1.0012335557322725e-05}}, "connector_pipeline_timer": 8.150279321679736e-05}, "num_agent_steps_sampled": {"default_agent": 400}, "rlmodule_inference_timer": 4.536202886579516e-05, "episode_duration_sec_mean": 0.00652236751979217, "num_env_steps_sampled_lifetime": 35400, "episode_len_mean": 20.0, "num_episodes_lifetime": 140, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "num_episodes": 20, "env_step_timer": 2.074375877075764e-05, "weights_seq_no": 7.0, "episode_return_min": -13.5, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 3.2, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "agent_episode_returns_mean": {"default_agent": 3.2}, "env_to_module_sum_episodes_length_out": 10.368238394572801, "num_env_steps_sampled": 400, "episode_len_max": 20, "env_reset_timer": 0.0006227172890626392, "episode_return_max": 13.5, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394572801, "sample": 0.11903788583967898, "time_between_sampling": 9.610030170993749}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "b4968_00000", "date": "2025-08-11_18-16-08", "timestamp": 1754928968, "time_this_iter_s": 11.536886930465698, "time_total_s": 73.35183477401733, "pid": 10564, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x141ef98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 73.35183477401733, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 49.199999999999996, "ram_util_percent": 80.00625000000001}}
{"timers": {"training_iteration": 10.581484624495964, "restore_env_runners": 1.2050472122502188e-05, "training_step": 10.581244062687293, "env_runner_sampling_timer": 1.6691123709483453, "learner_update_timer": 8.731670532409566, "synch_weights": 0.0018344983339022944, "restore_eval_env_runners": 6.0005306299736604e-05, "evaluation_iteration": 0.1316596391268295, "synch_eval_env_connectors": 0.00026370100755609917, "synch_env_connectors": 5.363407130547831e-06}, "env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 8.894928827114419e-06, "numpy_to_tensor": 1.668447966406797e-05, "add_states_from_episodes_to_batch": 3.302007206885848e-06, "batch_individual_items": 1.5254570045630413e-05, "add_observations_from_episodes_to_batch": 3.3985011614360937e-06}}, "connector_pipeline_timer": 7.340877199087567e-05}, "num_env_steps_sampled_lifetime": -3695000.0, "episode_return_mean": -2.3000000000000007, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": -2.3000000000000007}, "module_episode_returns_mean": {"default_policy": -2.3000000000000007}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.006645980266767616, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.960993830329751e-05, "remove_single_ts_time_rank_from_batch": 1.3934744799472057e-05, "normalize_and_clip_actions": 9.674363954848048e-06, "get_actions": 5.507612263162756e-05, "listify_data_for_vector_env": 1.2983381357233716e-05, "un_batch_to_individual_items": 7.766924970921413e-06}}, "connector_pipeline_timer": 0.00015059189285069558}, "time_between_sampling": 0.04024028889701432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 6.5, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "episode_len_mean": 20.0, "num_episodes": 250.0, "num_episodes_lifetime": -184750.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "rlmodule_inference_timer": 4.1050437896806416e-05, "episode_duration_sec_mean": 0.006678230466786768, "weights_seq_no": 7.0, "env_step_timer": 1.811249281820911e-05, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "env_reset_timer": 5.533706737517322e-05, "num_env_steps_sampled_lifetime_throughput": 2753.270282132081}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.14183543776254134, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008955138593644326, "add_observations_from_episodes_to_batch": 0.0009098689701015978, "add_columns_from_episodes_to_train_batch": 0.041428208417631535, "add_time_dim_to_batch_and_zero_pad": 0.07657554000777843, "add_states_from_episodes_to_batch": 0.004084469552074448, "batch_individual_items": 0.009612473375608893, "numpy_to_tensor": 7.505768289973963e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_env_steps_trained": 33000, "num_trainable_parameters": 24861, "num_module_steps_trained": 11970, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 95760, "num_env_steps_trained_lifetime": 264000, "num_env_steps_trained_lifetime_throughput": 4071.8853635129863, "num_module_steps_trained_throughput": 26794220.79730922, "num_module_steps_trained_lifetime_throughput": 13183048.519228691}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 574560, "num_env_steps_trained_lifetime": 1584000, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 47043.47010383705}, "default_policy": {"vf_loss_unclipped": 42.959014892578125, "module_train_batch_size_mean": 997.5252898807411, "num_module_steps_trained_lifetime": 287280, "diff_num_grad_updates_vs_sampler_policy": 41.0, "vf_loss": 0.359314501285553, "total_loss": 0.2786976993083954, "vf_explained_var": 0.0047340989112854, "mean_kl_loss": 5.5229793360922486e-06, "policy_loss": -0.00017410836881026626, "entropy": 0.682654857635498, "weights_seq_no": 48.0, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35910}, "intrinsic_reward_module": {"weights_seq_no": 48.0, "num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.5252898807411, "num_module_steps_trained_lifetime": 287280, "diff_num_grad_updates_vs_sampler_policy": 41.0, "total_loss": 0.0}}}, "IntrinsicAttentionMask": [[[0.09421959519386292, 0.08866289258003235, 0.09244046360254288, 0.09270432591438293, 0.08907671272754669, 0.08915718644857407, 0.08906414359807968, 0.08914460986852646, 0.09294270724058151, 0.09302668273448944, 0.08956068009138107], [0.07545549422502518, 0.10228408873081207, 0.08300882577896118, 0.08183314651250839, 0.09992805868387222, 0.09947744756937027, 0.09999863058328629, 0.09954769909381866, 0.08078810572624207, 0.08042380213737488, 0.0972546935081482], [0.08804645389318466, 0.09290198981761932, 0.0895412415266037, 0.08931614458560944, 0.09252075105905533, 0.09244699031114578, 0.09253227710723877, 0.09245850890874863, 0.08911380916833878, 0.0890427678823471, 0.09207908809185028], [0.0889529213309288, 0.09226572513580322, 0.08997883647680283, 0.08982469886541367, 0.09200764447450638, 0.09195768088102341, 0.09201545268297195, 0.09196548163890839, 0.08968604356050491, 0.08963733166456223, 0.0917082354426384], [0.0767972394824028, 0.10123246908187866, 0.08374729752540588, 0.0826694667339325, 0.09911271184682846, 0.09870677441358566, 0.09917628020048141, 0.09877008199691772, 0.08171021938323975, 0.08137555420398712, 0.09670188277959824], [0.077059306204319, 0.10102860629558563, 0.08389030396938324, 0.08283169567584991, 0.0989542230963707, 0.09855686873197556, 0.09901643544435501, 0.09861882776021957, 0.0818893238902092, 0.08156049996614456, 0.09659391641616821], [0.07675635069608688, 0.10126432031393051, 0.08372495323419571, 0.08264412730932236, 0.09913746267557144, 0.0987301841378212, 0.0992012470960617, 0.09879369288682938, 0.0816822499036789, 0.08134668320417404, 0.09671872854232788], [0.07701833546161652, 0.10106045752763748, 0.08386798202991486, 0.08280635625123978, 0.09897898882627487, 0.09858030080795288, 0.0990414172410965, 0.09864247590303421, 0.08186134696006775, 0.0815315991640091, 0.09661080688238144], [0.08977464586496353, 0.09169312566518784, 0.09037194401025772, 0.0902823880314827, 0.0915447250008583, 0.09151597321033478, 0.09154921770095825, 0.09152046591043472, 0.09020176529884338, 0.09017343074083328, 0.09137234091758728], [0.09006472676992416, 0.0914919301867485, 0.09050989896059036, 0.0904431939125061, 0.09138180315494537, 0.09136046469211578, 0.0913851410150528, 0.09136379510164261, 0.0903831422328949, 0.09036202728748322, 0.09125382453203201], [0.07837872207164764, 0.1000097468495369, 0.08460422605276108, 0.08364287763834, 0.09815993905067444, 0.09780516475439072, 0.09821547567844391, 0.09786050021648407, 0.08278604596853256, 0.0824868455529213, 0.0960504412651062]], [[0.10182229429483414, 0.10144483298063278, 0.0854497179389, 0.08445393294095993, 0.08414085954427719, 0.0845029428601265, 0.09957842528820038, 0.08387760072946548, 0.09087033569812775, 0.09808160364627838, 0.08577744662761688], [0.10157913714647293, 0.10121073573827744, 0.08557043969631195, 0.08459474891424179, 0.08428794145584106, 0.08464277535676956, 0.09938865900039673, 0.08402992784976959, 0.09087737649679184, 0.09792685508728027, 0.0858914852142334], [0.09065631777048111, 0.09066435694694519, 0.09103652834892273, 0.09106200188398361, 0.09107008576393127, 0.09106074273586273, 0.09070456027984619, 0.09107689559459686, 0.09090294688940048, 0.09073736518621445, 0.09102820605039597], [0.08993354439735413, 0.08996438980102539, 0.09140114486217499, 0.09150012582540512, 0.09153151512145996, 0.09149522334337234, 0.09011878073215485, 0.09155800193548203, 0.0908835232257843, 0.09024490416049957, 0.09136883914470673], [0.0897051990032196, 0.08974319696426392, 0.09151641279459, 0.09163881838321686, 0.09167763590812683, 0.09163276106119156, 0.08993343263864517, 0.0917104035615921, 0.09087681025266647, 0.09008888155221939, 0.09147647768259048], [0.08996924757957458, 0.08999897539615631, 0.09138312935829163, 0.09147845953702927, 0.09150868654251099, 0.09147374331951141, 0.09014775604009628, 0.09153419733047485, 0.09088454395532608, 0.09026928246021271, 0.09135202318429947], [0.10036740452051163, 0.10004368424415588, 0.08617258071899414, 0.08529840409755707, 0.08502329140901566, 0.08534146845340729, 0.09844068437814713, 0.08479183912277222, 0.09090841561555862, 0.09715228527784348, 0.08645999431610107], [0.08951276540756226, 0.08955677598714828, 0.09161357581615448, 0.09175579249858856, 0.09180089831352234, 0.09174875169992447, 0.08977711945772171, 0.09183897823095322, 0.0908709317445755, 0.08995723724365234, 0.09156717360019684], [0.09449918568134308, 0.09438156336545944, 0.08910385519266129, 0.08875426650047302, 0.08864379674196243, 0.08877153694629669, 0.09379562735557556, 0.08855068683624268, 0.09096082299947739, 0.09332042187452316, 0.08921831101179123], [0.09938419610261917, 0.09909620136022568, 0.08666196465492249, 0.08587181568145752, 0.08562297374010086, 0.08591075986623764, 0.09766868501901627, 0.08541357517242432, 0.09092860668897629, 0.09651961922645569, 0.0869215652346611], [0.09089301526546478, 0.09089352190494537, 0.0909171849489212, 0.09091880172491074, 0.09091931581497192, 0.09091872721910477, 0.09089608490467072, 0.09091974794864655, 0.0909087061882019, 0.09089817106723785, 0.09091665595769882]], [[0.09646245092153549, 0.08499884605407715, 0.08476641029119492, 0.09510999917984009, 0.08380712568759918, 0.09459052979946136, 0.08384298533201218, 0.09463100135326385, 0.0943722203373909, 0.09411414712667465, 0.09330423176288605], [0.08892551064491272, 0.09306000173091888, 0.09315159171819687, 0.08937767893075943, 0.09353319555521011, 0.08955368399620056, 0.09351882338523865, 0.08953992277383804, 0.08962804079055786, 0.08971624821424484, 0.08999521285295486], [0.08876338601112366, 0.09323672205209732, 0.09333600103855133, 0.0892517939209938, 0.0937497466802597, 0.08944196254014969, 0.09373416006565094, 0.08942709118127823, 0.08952230960130692, 0.08961763232946396, 0.08991915732622147], [0.09561768174171448, 0.08588706701993942, 0.0856877788901329, 0.09447921812534332, 0.08486445993185043, 0.09404128789901733, 0.08489526063203812, 0.09407541900873184, 0.09385713934898376, 0.09363936632871628, 0.0929553210735321], [0.08809009939432144, 0.09397201985120773, 0.09410358965396881, 0.08872785419225693, 0.09465236216783524, 0.08897647261619568, 0.09463167935609818, 0.08895701915025711, 0.08908156305551529, 0.0892062783241272, 0.0896010622382164], [0.09529019892215729, 0.08623243868350983, 0.08604621887207031, 0.09423389285802841, 0.0852765440940857, 0.09382732957601547, 0.0853053480386734, 0.09385902434587479, 0.09365633130073547, 0.09345407783985138, 0.09281858056783676], [0.0881153866648674, 0.09394435584545135, 0.09407469630241394, 0.08874756842851639, 0.09461835771799088, 0.08899399638175964, 0.09459786862134933, 0.0889747217297554, 0.08909816294908524, 0.0892217829823494, 0.08961306512355804], [0.09531576931476593, 0.08620544523000717, 0.08601820468902588, 0.0942530632019043, 0.0852443128824234, 0.09384405612945557, 0.08527327328920364, 0.0938759371638298, 0.09367202967405319, 0.0934685692191124, 0.09282928705215454], [0.09515207260847092, 0.0863782986998558, 0.0861976221203804, 0.09413028508424759, 0.08545072376728058, 0.0937369093298912, 0.08547868579626083, 0.09376757591962814, 0.09357144683599472, 0.09337572008371353, 0.09276065975427628], [0.0949883982539177, 0.08655126392841339, 0.08637718111276627, 0.09400741010904312, 0.08565741032361984, 0.0936296358704567, 0.08568435162305832, 0.09365908801555634, 0.09347070753574371, 0.09328271448612213, 0.0926918312907219], [0.0944720059633255, 0.08709793537855148, 0.08694486320018768, 0.09361901134252548, 0.08631152659654617, 0.09329023212194443, 0.08633524179458618, 0.09331586956977844, 0.09315186738967896, 0.09298814088106155, 0.09247331321239471]], [[0.09448911994695663, 0.09431426972150803, 0.08657912164926529, 0.09359101206064224, 0.09341782331466675, 0.09361809492111206, 0.09344485402107239, 0.08578100800514221, 0.08893325179815292, 0.08529333770275116, 0.09053809940814972], [0.09433338791131973, 0.09416641294956207, 0.08676572889089584, 0.0934755727648735, 0.09331012517213821, 0.09350144863128662, 0.09333594888448715, 0.08600053191184998, 0.08902100473642349, 0.08553282916545868, 0.09055696427822113], [0.08714556694030762, 0.08731570094823837, 0.095549076795578, 0.08802637457847595, 0.0881982296705246, 0.08799955993890762, 0.08817136287689209, 0.09648542106151581, 0.09288763999938965, 0.09706640988588333, 0.09115468710660934], [0.09368612617254257, 0.09355161339044571, 0.08754308521747589, 0.09299461543560028, 0.09286109358072281, 0.09301549196243286, 0.092881940305233, 0.08691641688346863, 0.08938401937484741, 0.08653286844491959, 0.09063274413347244], [0.09353038668632507, 0.09340362250804901, 0.0877305269241333, 0.09287859499454498, 0.09275271743535995, 0.09289827942848206, 0.09277237206697464, 0.0871376097202301, 0.08947093784809113, 0.08677460253238678, 0.09065034240484238], [0.09371045976877213, 0.09357473254203796, 0.08751381933689117, 0.093012735247612, 0.09287802129983902, 0.0930337980389595, 0.09289904683828354, 0.08688189834356308, 0.08937042951583862, 0.08649514615535736, 0.09062997996807098], [0.09355471283197403, 0.09342673420906067, 0.0877012312412262, 0.0928967297077179, 0.09276965260505676, 0.0929165929555893, 0.09278949350118637, 0.08710303157567978, 0.08945737034082413, 0.08673680573701859, 0.0906476080417633], [0.08636989444494247, 0.08657337725162506, 0.09651632606983185, 0.08742424845695496, 0.08763021975755692, 0.08739212155342102, 0.08759801089763641, 0.09765864163637161, 0.09328211843967438, 0.0983685851097107, 0.09118644893169403], [0.0893959179520607, 0.08946599066257477, 0.09276396781206131, 0.08975780755281448, 0.08982816338539124, 0.08974682539701462, 0.08981717377901077, 0.09312809258699417, 0.09171716868877411, 0.09335296601057053, 0.09102589637041092], [0.08589272946119308, 0.08611644804477692, 0.09711316972970963, 0.08705249428749084, 0.08727923035621643, 0.08701713383197784, 0.08724377304315567, 0.09838445484638214, 0.09352245926856995, 0.0991753488779068, 0.0912027433514595], [0.09089820832014084, 0.09089871495962143, 0.09092237800359726, 0.09090084582567215, 0.09090135991573334, 0.09090076386928558, 0.09090127795934677, 0.0909249410033226, 0.09091496467590332, 0.09092652052640915, 0.09091001749038696]], [[0.09750993549823761, 0.08592185378074646, 0.08568688482046127, 0.09614279866218567, 0.09587988257408142, 0.08448551595211029, 0.09592091292142868, 0.09565860033035278, 0.09539701044559479, 0.08406002819538116, 0.08333662897348404], [0.08856172859668732, 0.09267931431531906, 0.092770516872406, 0.08901204913854599, 0.08909964561462402, 0.09324223548173904, 0.08908595889806747, 0.08917362987995148, 0.08926139026880264, 0.09341149032115936, 0.09370195120573044], [0.08837015181779861, 0.09282367676496506, 0.09292250871658325, 0.08885639905929565, 0.08895101398229599, 0.09343380481004715, 0.0889362245798111, 0.089030921459198, 0.08912571519613266, 0.09361731261014938, 0.09393229335546494], [0.09650343656539917, 0.08668267726898193, 0.08648154884576797, 0.09535443037748337, 0.09513317793607712, 0.0854518711566925, 0.09516770392656326, 0.09494689106941223, 0.09472658485174179, 0.0850866511464119, 0.08446509391069412], [0.09630841761827469, 0.08683009445667267, 0.08663559705018997, 0.0952012687921524, 0.09498802572488785, 0.08563964813947678, 0.0950213074684143, 0.09480846673250198, 0.09459610283374786, 0.08528629690408707, 0.08468480408191681], [0.08738397806882858, 0.09356636554002762, 0.09370490908622742, 0.08805318921804428, 0.08818357437849045, 0.09442252665758133, 0.08816318958997726, 0.08829373121261597, 0.08842447400093079, 0.09468047320842743, 0.09512365609407425], [0.09633887559175491, 0.08680705726146698, 0.08661153167486191, 0.09522519260644913, 0.09501070529222488, 0.0856103003025055, 0.09504418075084686, 0.09483009576797485, 0.09461649507284164, 0.08525509387254715, 0.08465046435594559], [0.09614390134811401, 0.08695442229509354, 0.08676555007696152, 0.0950719565153122, 0.09486545622348785, 0.08579817414283752, 0.09489768743515015, 0.09469155967235565, 0.09448588639497757, 0.08545488119125366, 0.08487040549516678], [0.09594900906085968, 0.08710175007581711, 0.08691956102848053, 0.09491866081953049, 0.09472011774778366, 0.0859861820936203, 0.09475111216306686, 0.0945529192686081, 0.09435514360666275, 0.0856548547744751, 0.08509064465761185], [0.08703203499317169, 0.09383124113082886, 0.09398413449525833, 0.08776574581861496, 0.08790875226259232, 0.094776451587677, 0.08788640052080154, 0.08802960813045502, 0.088173046708107, 0.09506139159202576, 0.09555114805698395], [0.08643047511577606, 0.0942838117480278, 0.09446145594120026, 0.08727346360683441, 0.08743790537118912, 0.09538277238607407, 0.08741219341754913, 0.08757689595222473, 0.0877419039607048, 0.09571439027786255, 0.09628475457429886]], [[0.10324420034885406, 0.10286147147417068, 0.08664298802614212, 0.1012859120965004, 0.10091044008731842, 0.08568299561738968, 0.08536536991596222, 0.08504891395568848, 0.07790020108222961, 0.08408218622207642, 0.08697529137134552], [0.1029697135090828, 0.10259626805782318, 0.0867418572306633, 0.10105859488248825, 0.10069208592176437, 0.08580150455236435, 0.08549031615257263, 0.08518026769161224, 0.07816924899816513, 0.08423292636871338, 0.08706730604171753], [0.09062322229146957, 0.09063125401735306, 0.09100329875946045, 0.09066466242074966, 0.09067270904779434, 0.09102750569581985, 0.09103558212518692, 0.09104365110397339, 0.09123469144105911, 0.09106850624084473, 0.09099497646093369], [0.10183186829090118, 0.10149652510881424, 0.08714985847473145, 0.10011456161737442, 0.09978488087654114, 0.08629171550273895, 0.08600754290819168, 0.08572431653738022, 0.07929368317127228, 0.08485834300518036, 0.0874466523528099], [0.10155884921550751, 0.10123255848884583, 0.0872473418712616, 0.09988763183355331, 0.09956672042608261, 0.08640911430120468, 0.0861314982175827, 0.08585477620363235, 0.07956574857234955, 0.08500856906175613, 0.08753719180822372], [0.08984620869159698, 0.08987589925527573, 0.09125816076993942, 0.08999937772750854, 0.09002911299467087, 0.09134864807128906, 0.0913788229227066, 0.09140902012586594, 0.09212568402290344, 0.09150201827287674, 0.09122709184885025], [0.08958792686462402, 0.08962474763393402, 0.091342493891716, 0.08977793902158737, 0.08981484174728394, 0.09145516902208328, 0.09149274975061417, 0.09153035283088684, 0.09242382645606995, 0.09164620190858841, 0.09130381792783737], [0.08932998776435852, 0.08937390148639679, 0.09142649918794632, 0.08955664932727814, 0.08960067480802536, 0.09156139940023422, 0.09160641580820084, 0.09165144711732864, 0.09272252023220062, 0.09179020673036575, 0.09138020128011703], [0.0833413302898407, 0.08354125171899796, 0.09332022815942764, 0.08437731862068176, 0.08457972854375839, 0.0939934179186821, 0.0942188948392868, 0.09444490820169449, 0.09994880110025406, 0.09514402598142624, 0.09309005737304688], [0.08853836357593536, 0.08860385417938232, 0.09168317168951035, 0.08887658268213272, 0.08894233405590057, 0.09188678860664368, 0.09195476025342941, 0.09202278405427933, 0.09364555776119232, 0.09223247319459915, 0.09161332249641418], [0.09089091420173645, 0.09089143574237823, 0.09091509133577347, 0.09089355915784836, 0.09089407324790955, 0.09091662615537643, 0.09091714024543762, 0.09091765433549881, 0.09092976152896881, 0.09091923385858536, 0.09091456234455109]]], "default_policy": {"vf_explained_var": 0.0002607107162475586, "curr_entropy_coeff": 0.0015431216992, "num_trainable_parameters": 16595, "curr_kl_coeff": 0.0006311872275546193, "policy_loss": -0.00018252211157232523, "entropy": 0.6826385259628296, "module_train_batch_size_mean": 997.8076834879114, "weights_seq_no": 8.0, "use_intrinsic_rewards": 0.0, "num_module_steps_trained": 5985, "vf_loss_unclipped": 43.11643600463867, "num_module_steps_trained_lifetime": 47880, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.27790603041648865, "vf_loss": 0.3583102226257324, "mean_kl_loss": 5.9150679589947686e-06, "num_module_steps_trained_lifetime_throughput": 738.2138302930973}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 47880, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_trainable_parameters": 8266, "weights_seq_no": 8.0, "num_module_steps_trained": 5985, "module_train_batch_size_mean": 997.8076834879114, "num_module_steps_trained_lifetime_throughput": 738.2250882609403}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 3.2}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.122621492729802e-06, "tensor_to_numpy": 1.5242524297228463e-05, "un_batch_to_individual_items": 6.597222923767116e-06, "remove_single_ts_time_rank_from_batch": 1.2034163073143393e-05, "listify_data_for_vector_env": 1.0797311368173471e-05, "get_actions": 3.673373098667163e-05}}, "connector_pipeline_timer": 0.00011618576630213519}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.897732543170932e-06, "numpy_to_tensor": 1.2358202312734503e-05, "add_states_from_episodes_to_batch": 2.8343241547696945e-06, "batch_individual_items": 1.2600573700118657e-05, "add_time_dim_to_batch_and_zero_pad": 7.0482406211543315e-06}}, "connector_pipeline_timer": 6.026740104309595e-05}, "num_agent_steps_sampled": {"default_agent": 400}, "rlmodule_inference_timer": 3.156124340781326e-05, "episode_duration_sec_mean": 0.00644603957189247, "num_env_steps_sampled_lifetime": 40400, "episode_len_mean": 20.0, "num_episodes_lifetime": 160, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "num_episodes": 20, "env_step_timer": 1.4252527972864235e-05, "weights_seq_no": 8.0, "episode_return_min": -13.5, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 3.2, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "agent_episode_returns_mean": {"default_agent": 3.2}, "env_to_module_sum_episodes_length_out": 10.3682383945743, "num_env_steps_sampled": 400, "episode_len_max": 20, "env_reset_timer": 0.0006204067862746389, "episode_return_max": 13.5, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.3682383945743, "sample": 0.11906536240124578, "time_between_sampling": 9.621639243864111}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "b4968_00000", "date": "2025-08-11_18-16-19", "timestamp": 1754928979, "time_this_iter_s": 10.868971109390259, "time_total_s": 84.22080588340759, "pid": 10564, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x141ef98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 84.22080588340759, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 48.66875, "ram_util_percent": 80.36875}}
{"timers": {"training_iteration": 10.58368464867087, "restore_env_runners": 1.2046627195279939e-05, "training_step": 10.583443724980748, "env_runner_sampling_timer": 1.6687455505683184, "learner_update_timer": 8.734186765835513, "synch_weights": 0.0018351850100304173, "restore_eval_env_runners": 5.995317359044989e-05, "evaluation_iteration": 0.1316633523256438, "synch_eval_env_connectors": 0.0002632077483790782, "synch_env_connectors": 5.355192497053131e-06}, "env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.3213323797060625e-06, "numpy_to_tensor": 1.355704235318328e-05, "add_states_from_episodes_to_batch": 2.8390261541987923e-06, "batch_individual_items": 1.3062911413835617e-05, "add_observations_from_episodes_to_batch": 2.9669121851437122e-06}}, "connector_pipeline_timer": 6.232411816276799e-05}, "num_env_steps_sampled_lifetime": -4312500.0, "episode_return_mean": -0.54, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": -0.54}, "module_episode_returns_mean": {"default_policy": -0.54}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.006369876886197451, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.6287041798423065e-05, "remove_single_ts_time_rank_from_batch": 1.246185109324232e-05, "normalize_and_clip_actions": 8.421605673811307e-06, "get_actions": 4.340089132578086e-05, "listify_data_for_vector_env": 1.1073084615934211e-05, "un_batch_to_individual_items": 6.920658341805144e-06}}, "connector_pipeline_timer": 0.00012581614550691948}, "time_between_sampling": 0.03661171255668437, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 6.5, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "episode_len_mean": 20.0, "num_episodes": 250.0, "num_episodes_lifetime": -215625.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "rlmodule_inference_timer": 3.426146122216974e-05, "episode_duration_sec_mean": 0.005584630660712718, "weights_seq_no": 8.0, "env_step_timer": 1.4706136191022015e-05, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "env_reset_timer": 5.223381288461787e-05, "num_env_steps_sampled_lifetime_throughput": 3062.26845027489}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.14176805005476784, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008953076377963023, "add_observations_from_episodes_to_batch": 0.0009092319501864838, "add_columns_from_episodes_to_train_batch": 0.041434145912701115, "add_time_dim_to_batch_and_zero_pad": 0.0765599404477697, "add_states_from_episodes_to_batch": 0.004085458186732337, "batch_individual_items": 0.009557065312772015, "numpy_to_tensor": 7.505252618208549e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_env_steps_trained": 33000, "num_trainable_parameters": 24861, "num_module_steps_trained": 11970, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 107730, "num_env_steps_trained_lifetime": 297000, "num_env_steps_trained_lifetime_throughput": 4047.998079496262, "num_module_steps_trained_throughput": 26023457.158523884, "num_module_steps_trained_lifetime_throughput": 13104994.475200972}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 646380, "num_env_steps_trained_lifetime": 1782000, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 46280.861847103406}, "default_policy": {"vf_loss_unclipped": 40.23423385620117, "module_train_batch_size_mean": 997.5168494263723, "num_module_steps_trained_lifetime": 323190, "diff_num_grad_updates_vs_sampler_policy": 46.0, "vf_loss": 0.359211266040802, "total_loss": 0.27870774269104004, "vf_explained_var": 0.005067884922027588, "mean_kl_loss": 9.045335787050135e-07, "policy_loss": -8.294604776892811e-05, "entropy": 0.6826211214065552, "weights_seq_no": 54.0, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35910}, "intrinsic_reward_module": {"weights_seq_no": 54.0, "num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.5168494263723, "num_module_steps_trained_lifetime": 323190, "diff_num_grad_updates_vs_sampler_policy": 46.0, "total_loss": 0.0}}}, "IntrinsicAttentionMask": [[[0.09457015991210938, 0.08899278193712234, 0.09278441220521927, 0.09304925054311752, 0.08940813690423965, 0.0894889160990715, 0.08939552307128906, 0.08947629481554031, 0.08955713361501694, 0.08963804692029953, 0.0936393290758133], [0.07407991588115692, 0.10041941702365875, 0.08149554580450058, 0.08034130185842514, 0.09810633212327957, 0.09766394644975662, 0.09817562252283096, 0.09773291647434235, 0.0972922071814537, 0.09685348719358444, 0.07783935219049454], [0.08775868266820908, 0.0925983414053917, 0.08924857527017593, 0.08902421593666077, 0.09221834689378738, 0.09214483201503754, 0.09222984313964844, 0.0921563133597374, 0.09208284318447113, 0.09200944006443024, 0.08852861821651459], [0.08875469118356705, 0.09206011891365051, 0.08977832645177841, 0.08962453156709671, 0.09180261194705963, 0.09175276011228561, 0.09181040525436401, 0.0917605459690094, 0.09171070903539658, 0.09166090190410614, 0.08928436040878296], [0.0755232498049736, 0.09955313056707382, 0.08235802501440048, 0.08129806816577911, 0.0974685400724411, 0.09706933796405792, 0.09753105044364929, 0.09713158756494522, 0.09673376381397247, 0.09633757174015045, 0.07899568974971771], [0.07580557465553284, 0.09938490390777588, 0.08252543956041336, 0.08148404955863953, 0.09734426438808441, 0.0969533771276474, 0.09740547090768814, 0.09701433777809143, 0.09662477672100067, 0.09623678028583527, 0.07922106236219406], [0.07547920942306519, 0.09957939386367798, 0.08233185857534409, 0.0812690258026123, 0.0974879264831543, 0.09708742797374725, 0.0975506454706192, 0.09714987874031067, 0.09675076603889465, 0.09635328501462936, 0.07896050810813904], [0.07576142251491547, 0.09941118210554123, 0.08249928057193756, 0.08145498484373093, 0.09736368060112, 0.09697149693965912, 0.09742509573698044, 0.09703265875577927, 0.09664180874824524, 0.09625253826379776, 0.0791858360171318], [0.07604441791772842, 0.09924289584159851, 0.08266673237085342, 0.08164107799530029, 0.09723924845457077, 0.09685537219047546, 0.09729935228824615, 0.09691523760557175, 0.09653263539075851, 0.09615154564380646, 0.07941151410341263], [0.07632818818092346, 0.09907454252243042, 0.08283423632383347, 0.0818273052573204, 0.09711462259292603, 0.0967390313744545, 0.09717343002557755, 0.09679760783910751, 0.09642323851585388, 0.09605032205581665, 0.0796375498175621], [0.09099186211824417, 0.09086522459983826, 0.09095212817192078, 0.09095806628465652, 0.09087491780519485, 0.09087679535150528, 0.09087461978197098, 0.090876504778862, 0.09087838232517242, 0.09088025987148285, 0.09097123891115189]], [[0.09552767127752304, 0.09569874405860901, 0.0884217619895935, 0.09641306847333908, 0.0890817642211914, 0.08889766037464142, 0.08905686438083649, 0.08921635895967484, 0.08615968376398087, 0.08970907330513, 0.09181740880012512], [0.09573812037706375, 0.09591729938983917, 0.0883086696267128, 0.09666561335325241, 0.08899763226509094, 0.0888054296374321, 0.08897162973880768, 0.08913815021514893, 0.08594914525747299, 0.0896526649594307, 0.09185569733381271], [0.08664678782224655, 0.086500383913517, 0.09321387112140656, 0.08589455485343933, 0.09256100654602051, 0.09274216741323471, 0.09258546680212021, 0.0924290269613266, 0.09552521258592606, 0.09194914996623993, 0.08995237946510315], [0.09661500155925751, 0.09682823717594147, 0.08783770352602005, 0.09771955758333206, 0.08864625543355942, 0.08842058479785919, 0.08861573040485382, 0.08881131559610367, 0.08507715165615082, 0.08941604942083359, 0.09201239049434662], [0.08748244494199753, 0.08736387640237808, 0.09276130795478821, 0.08687280863523483, 0.09223989397287369, 0.09238465130329132, 0.09225943684577942, 0.09213439375162125, 0.09460152685642242, 0.09175056219100952, 0.09014914184808731], [0.08724956214427948, 0.08712319284677505, 0.09288740158081055, 0.0865999385714531, 0.09232953190803528, 0.09248438477516174, 0.09235043823719025, 0.09221668541431427, 0.09485801309347153, 0.09180618077516556, 0.09009476751089096], [0.08745095133781433, 0.08733132481575012, 0.09277834743261337, 0.08683589845895767, 0.09225200861692429, 0.09239812940359116, 0.09227173775434494, 0.09214551746845245, 0.09463614970445633, 0.09175808727741241, 0.09014180302619934], [0.08765260130167007, 0.08753975480794907, 0.09266919642686844, 0.08707229048013687, 0.09217434376478195, 0.09231173992156982, 0.0921928882598877, 0.0920742005109787, 0.09441458433866501, 0.09170980751514435, 0.0901886522769928], [0.08376765996217728, 0.08352859318256378, 0.09477569162845612, 0.0825422927737236, 0.09365658462047577, 0.09396657347679138, 0.0936984047293663, 0.0934310033917427, 0.09878121316432953, 0.09261269122362137, 0.08923929929733276], [0.08827477693557739, 0.08818299323320389, 0.09233251959085464, 0.08780254423618317, 0.09193415939807892, 0.09204480797052383, 0.09194910526275635, 0.09185349941253662, 0.09373429417610168, 0.09155984222888947, 0.09033152461051941], [0.09092346578836441, 0.090923972427845, 0.09090133756399155, 0.09092610329389572, 0.09090346843004227, 0.09090287238359451, 0.0909033864736557, 0.09090389311313629, 0.09089391678571701, 0.09090547263622284, 0.0909121185541153]], [[0.09352444112300873, 0.09167560189962387, 0.08808824419975281, 0.09202034771442413, 0.0921034887433052, 0.08849938213825226, 0.08840702474117279, 0.09217369556427002, 0.09225697815418243, 0.08864686638116837, 0.092603899538517], [0.08839725703001022, 0.09013012051582336, 0.09369698166847229, 0.08980178833007812, 0.08972297608852386, 0.09327372908592224, 0.09336847066879272, 0.0896565243601799, 0.08957783877849579, 0.09312284737825394, 0.08925152570009232], [0.07854533940553665, 0.08664491027593613, 0.10542771220207214, 0.08506102859973907, 0.08468428254127502, 0.10304205864667892, 0.10357227176427841, 0.08436769247055054, 0.08399401605129242, 0.1022021546959877, 0.08245858550071716], [0.08935140073299408, 0.09043103456497192, 0.09262871742248535, 0.09022708982229233, 0.09017808735370636, 0.09236962348222733, 0.09242766350507736, 0.09013675898313522, 0.09008780866861343, 0.0922771468758583, 0.08988463878631592], [0.08958165347576141, 0.09050273150205612, 0.09237264096736908, 0.09032886475324631, 0.09028708189725876, 0.09215253591537476, 0.0922018438577652, 0.09025183320045471, 0.09021008759737015, 0.092073954641819, 0.0900367870926857], [0.07966571301221848, 0.08707741647958755, 0.10402632504701614, 0.08563333749771118, 0.08528947830200195, 0.10189037770032883, 0.10236549377441406, 0.0850004032254219, 0.08465909212827682, 0.10113729536533356, 0.08325511962175369], [0.07941378653049469, 0.08698099851608276, 0.1043398454785347, 0.085505411028862, 0.08515413850545883, 0.1021483913064003, 0.10263576358556747, 0.08485884964466095, 0.08451022952795029, 0.1013759896159172, 0.08307656645774841], [0.08977615088224411, 0.09056301414966583, 0.09215685725212097, 0.09041457623243332, 0.09037888795137405, 0.09196949005126953, 0.0920114740729332, 0.09034880250692368, 0.0903131440281868, 0.09190258383750916, 0.09016510844230652], [0.09000687301158905, 0.09063418209552765, 0.09190144389867783, 0.09051592648029327, 0.09048750251531601, 0.09175270795822144, 0.09178604185581207, 0.09046351909637451, 0.09043509513139725, 0.09169957786798477, 0.09031710028648376], [0.08006824553012848, 0.08723045885562897, 0.10352721065282822, 0.08583682030439377, 0.08550483733415604, 0.10147920995950699, 0.10193489491939545, 0.08522572368383408, 0.08489610999822617, 0.10075674951076508, 0.08353976160287857], [0.09096865355968475, 0.09092704951763153, 0.09084392338991165, 0.0909348651766777, 0.09093675017356873, 0.09085361659526825, 0.09085144102573395, 0.09093833714723587, 0.09094022214412689, 0.09085708111524582, 0.09094803780317307]], [[0.10027346760034561, 0.09990175068378448, 0.08414994180202484, 0.08316930383443832, 0.08286099135875702, 0.09842861443758011, 0.09806372970342636, 0.08260172605514526, 0.08948809653520584, 0.09658967703580856, 0.08447267860174179], [0.10006735473871231, 0.09970443695783615, 0.08429690450429916, 0.08333573490381241, 0.0830335021018982, 0.0982658639550209, 0.09790948033332825, 0.08277933299541473, 0.08952487260103226, 0.09646942466497421, 0.08461318165063858], [0.09068933874368668, 0.09069737792015076, 0.09106969088315964, 0.09109517931938171, 0.09110325574874878, 0.09072954952716827, 0.09073760360479355, 0.09111007302999496, 0.09093605726957321, 0.0907704159617424, 0.09106136858463287], [0.090060293674469, 0.09009117633104324, 0.0915299579501152, 0.09162908047437668, 0.0916605144739151, 0.09021484851837158, 0.0902457907795906, 0.09168703854084015, 0.09101160615682602, 0.09037209302186966, 0.09149761497974396], [0.08986132591962814, 0.08989938348531723, 0.09167569130659103, 0.0917983129620552, 0.09183719754219055, 0.0900518074631691, 0.09008995443582535, 0.09187001734972, 0.09103497117757797, 0.09024567157030106, 0.09163568168878555], [0.09924404323101044, 0.09891597926616669, 0.08488470315933228, 0.08400223404169083, 0.08372455090284348, 0.09761452674865723, 0.09729184955358505, 0.08349096029996872, 0.08966930955648422, 0.09598694741725922, 0.08517488837242126], [0.0990385189652443, 0.09871909022331238, 0.08503164350986481, 0.08416903764009476, 0.08389756083488464, 0.09745162725448608, 0.09713730961084366, 0.08366917818784714, 0.08970476686954498, 0.09586596488952637, 0.08531524986028671], [0.0896935686469078, 0.0897376611828804, 0.09179861843585968, 0.09194112569093704, 0.09198632091283798, 0.0899142473936081, 0.08995845168828964, 0.09202447533607483, 0.09105447679758072, 0.09013893455266953, 0.09175212681293488], [0.09401584416627884, 0.09389881789684296, 0.08864810317754745, 0.08830031007528305, 0.08819040656089783, 0.09343218058347702, 0.09331588447093964, 0.08809776604175568, 0.09049557894468307, 0.09284311532974243, 0.08876197785139084], [0.0982016772031784, 0.0979171097278595, 0.08563081920146942, 0.08485007286071777, 0.08460419625043869, 0.09678705036640167, 0.09650658071041107, 0.08439727872610092, 0.08984670042991638, 0.09537118673324585, 0.08588733524084091], [0.09089513123035431, 0.0908956378698349, 0.09091930091381073, 0.09092091768980026, 0.09092143177986145, 0.09089768677949905, 0.09089820086956024, 0.09092186391353607, 0.09091082215309143, 0.09090028703212738, 0.09091877192258835]], [[0.09318244457244873, 0.09134037047624588, 0.091422900557518, 0.08801665157079697, 0.09176668524742126, 0.09184959530830383, 0.09175374358892441, 0.09183663874864578, 0.08824297785758972, 0.0883227065205574, 0.09226527065038681], [0.08872073143720627, 0.0904599279165268, 0.09038053452968597, 0.09377958625555038, 0.09005129337310791, 0.08997225761413574, 0.09006364643573761, 0.08998460322618484, 0.09354570508003235, 0.09346360713243484, 0.08957811444997787], [0.08892059326171875, 0.09050236642360687, 0.09043022245168686, 0.0935138538479805, 0.09013096988201141, 0.09005912393331528, 0.09014220535755157, 0.09007034450769424, 0.09330201148986816, 0.09322763234376907, 0.08970072865486145], [0.08068419992923737, 0.08850537240505219, 0.08813577890396118, 0.10509070008993149, 0.0866161361336708, 0.08625442534685135, 0.08667277544736862, 0.08631083369255066, 0.10384749621152878, 0.10341382771730423, 0.08446843177080154], [0.08975324034690857, 0.09067607671022415, 0.09063413739204407, 0.09241452068090439, 0.09046001732349396, 0.09041817486286163, 0.09046655148267746, 0.09042470902204514, 0.09229300916194916, 0.09225030988454819, 0.0902092456817627], [0.08995406329631805, 0.09071724116802216, 0.09068258106708527, 0.09215125441551208, 0.09053868055343628, 0.09050408750772476, 0.09054408222436905, 0.09050948917865753, 0.09205117076635361, 0.09201600402593613, 0.09033133834600449], [0.08972188085317612, 0.09066962450742722, 0.0906265452504158, 0.09245568513870239, 0.09044770151376724, 0.09040472656488419, 0.09045442193746567, 0.09041143953800201, 0.09233081340789795, 0.09228693693876266, 0.09019015729427338], [0.08992267400026321, 0.0907108262181282, 0.09067502617835999, 0.09219234436750412, 0.09052639454603195, 0.0904906764626503, 0.09053198248147964, 0.0904962569475174, 0.09208892285823822, 0.09205257892608643, 0.09031226485967636], [0.08123021572828293, 0.08865412324666977, 0.08830413967370987, 0.10428209602832794, 0.08686425536870956, 0.08652133494615555, 0.0869179517030716, 0.08657481521368027, 0.10311561077833176, 0.10270853340625763, 0.08482692390680313], [0.0814226046204567, 0.08870596438646317, 0.08836289495229721, 0.10399862378835678, 0.08695116639137268, 0.08661487698554993, 0.08700381964445114, 0.08666732162237167, 0.10285887122154236, 0.1024610623717308, 0.08495284616947174], [0.09096091985702515, 0.09091931581497192, 0.09092120081186295, 0.09084213525056839, 0.09092901647090912, 0.09093090146780014, 0.09092872589826584, 0.09093060344457626, 0.09084748476743698, 0.09084935486316681, 0.09094030410051346]], [[0.09876079857349396, 0.09839468449354172, 0.09802993386983871, 0.09688754379749298, 0.08161099255084991, 0.08196219056844711, 0.08165835589170456, 0.09622635692358017, 0.08813813328742981, 0.09513258188962936, 0.08319836854934692], [0.09859010577201843, 0.09823254495859146, 0.09787628054618835, 0.09676027297973633, 0.08180771768093109, 0.0821521058678627, 0.08185416460037231, 0.09611423313617706, 0.08820325136184692, 0.0950452908873558, 0.0833640769124031], [0.09841939806938171, 0.09807035326957703, 0.09772254526615143, 0.09663286805152893, 0.08200465142726898, 0.08234219998121262, 0.08205018192529678, 0.09600193053483963, 0.08826814591884613, 0.09495778381824493, 0.08352985233068466], [0.09788069128990173, 0.09755836427211761, 0.09723709523677826, 0.09623002260923386, 0.0826277807354927, 0.08294350653886795, 0.08267036825418472, 0.09564654529094696, 0.08847159147262573, 0.09468033909797668, 0.084053635597229], [0.09001786261796951, 0.09005599468946457, 0.09009414166212082, 0.09021464735269547, 0.0919971764087677, 0.0919521376490593, 0.09199108928442001, 0.09028511494398117, 0.0911935567855835, 0.09040288627147675, 0.09179531037807465], [0.09021378308534622, 0.09024359285831451, 0.0902734100818634, 0.09036758542060852, 0.0917574092745781, 0.09172236919403076, 0.09175267070531845, 0.09042264521121979, 0.09113157540559769, 0.09051463752985, 0.09160032123327255], [0.09004434198141098, 0.0900813564658165, 0.09011837840080261, 0.09023533016443253, 0.09196478128433228, 0.09192109853029251, 0.09195888042449951, 0.09030371904373169, 0.09118521213531494, 0.0904180109500885, 0.09176898002624512], [0.09756603091955185, 0.09725917875766754, 0.09695329517126083, 0.09599415957927704, 0.08299285918474197, 0.08329568058252335, 0.08303371071815491, 0.09543824940919876, 0.08858945965766907, 0.09451735764741898, 0.08435999602079391], [0.09353633970022202, 0.09341990947723389, 0.0933036282658577, 0.09293756633996964, 0.08774061501026154, 0.08786705136299133, 0.08775768429040909, 0.09272439032793045, 0.09003403037786484, 0.09236958622932434, 0.08830927312374115], [0.0970408022403717, 0.09675959497690201, 0.09647920727729797, 0.09559955447912216, 0.08360406011343002, 0.083885058760643, 0.08364196866750717, 0.095089390873909, 0.0887845903635025, 0.09424377232789993, 0.08487202972173691], [0.09089723229408264, 0.09089773893356323, 0.09089825302362442, 0.09089986979961395, 0.09092353284358978, 0.09092294424772263, 0.09092345088720322, 0.09090081602334976, 0.09091292321681976, 0.09090238809585571, 0.09092088043689728]]], "default_policy": {"vf_explained_var": 0.0014409422874450684, "curr_entropy_coeff": 0.0015431216992, "num_trainable_parameters": 16595, "curr_kl_coeff": 0.00031559361377730966, "policy_loss": -9.195772145176306e-05, "entropy": 0.6825944781303406, "module_train_batch_size_mean": 997.7895308613665, "weights_seq_no": 9.0, "use_intrinsic_rewards": 0.0, "num_module_steps_trained": 5985, "vf_loss_unclipped": 40.143898010253906, "num_module_steps_trained_lifetime": 53865, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.27799272537231445, "vf_loss": 0.3583051860332489, "mean_kl_loss": 1.168300400422595e-06, "num_module_steps_trained_lifetime_throughput": 733.8916878868079}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 53865, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_trainable_parameters": 8266, "weights_seq_no": 9.0, "num_module_steps_trained": 5985, "module_train_batch_size_mean": 997.7895308613665, "num_module_steps_trained_lifetime_throughput": 733.9023508014241}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 2.4}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.223782530850205e-06, "tensor_to_numpy": 1.540032188566545e-05, "un_batch_to_individual_items": 6.663413637940882e-06, "remove_single_ts_time_rank_from_batch": 1.2201040911879565e-05, "listify_data_for_vector_env": 1.0741735186225226e-05, "get_actions": 3.777493621862895e-05}}, "connector_pipeline_timer": 0.0001176486225829228}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8433965262246e-06, "numpy_to_tensor": 1.2373746384265535e-05, "add_states_from_episodes_to_batch": 2.83096272896417e-06, "batch_individual_items": 1.2884468119610482e-05, "add_time_dim_to_batch_and_zero_pad": 7.041564129764987e-06}}, "connector_pipeline_timer": 6.053338731077266e-05}, "num_agent_steps_sampled": {"default_agent": 400}, "rlmodule_inference_timer": 3.259881050973912e-05, "episode_duration_sec_mean": 0.006419797899434343, "num_env_steps_sampled_lifetime": 45400, "episode_len_mean": 20.0, "num_episodes_lifetime": 180, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "num_episodes": 20, "env_step_timer": 1.4369643635725366e-05, "weights_seq_no": 9.0, "episode_return_min": -13.5, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 2.4, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "agent_episode_returns_mean": {"default_agent": 2.4}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "episode_len_max": 20, "env_reset_timer": 0.000617825628419727, "episode_return_max": 13.5, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "sample": 0.11907348919630546, "time_between_sampling": 9.633771022255173}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "b4968_00000", "date": "2025-08-11_18-16-30", "timestamp": 1754928990, "time_this_iter_s": 10.935048818588257, "time_total_s": 95.15585470199585, "pid": 10564, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x141ef98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 95.15585470199585, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 50.76666666666666, "ram_util_percent": 80.7}}
{"timers": {"training_iteration": 10.583846670934337, "restore_env_runners": 1.2045750890980295e-05, "training_step": 10.583602288571475, "env_runner_sampling_timer": 1.6692410929829526, "learner_update_timer": 8.732435379007446, "synch_weights": 0.001843692329523194, "restore_eval_env_runners": 5.988281235652259e-05, "evaluation_iteration": 0.13164596421228766, "synch_eval_env_connectors": 0.00026244692146510783, "synch_env_connectors": 5.3487212565358485e-06}, "env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.6248098106503486e-06, "numpy_to_tensor": 1.4328685804270673e-05, "add_states_from_episodes_to_batch": 2.948496564046223e-06, "batch_individual_items": 1.3554626796526399e-05, "add_observations_from_episodes_to_batch": 3.0605865852772368e-06}}, "connector_pipeline_timer": 6.495935270158959e-05}, "num_env_steps_sampled_lifetime": -4930000.0, "episode_return_mean": -1.9799999999999998, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": -1.9799999999999998}, "module_episode_returns_mean": {"default_policy": -1.9799999999999998}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.006123717989238264, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.685490011403847e-05, "remove_single_ts_time_rank_from_batch": 1.288359714343665e-05, "normalize_and_clip_actions": 8.71925950722869e-06, "get_actions": 4.60904287089786e-05, "listify_data_for_vector_env": 1.1681662599061312e-05, "un_batch_to_individual_items": 7.166842558328413e-06}}, "connector_pipeline_timer": 0.0001317752807435796}, "time_between_sampling": 0.03775942325816777, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 6.5, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "episode_len_mean": 20.0, "num_episodes": 250.0, "num_episodes_lifetime": -246500.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "rlmodule_inference_timer": 3.613733840522207e-05, "episode_duration_sec_mean": 0.005862963836174459, "weights_seq_no": 9.0, "env_step_timer": 1.5443841287812165e-05, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "env_reset_timer": 5.139670526733646e-05, "num_env_steps_sampled_lifetime_throughput": 2971.0490631292264}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.143011937883424, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00895980561490215, "add_observations_from_episodes_to_batch": 0.0009089538002442466, "add_columns_from_episodes_to_train_batch": 0.04144320029332673, "add_time_dim_to_batch_and_zero_pad": 0.07655595395313802, "add_states_from_episodes_to_batch": 0.004081991525175735, "batch_individual_items": 0.010793107999360863, "numpy_to_tensor": 7.514242059083155e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_env_steps_trained": 33000, "num_trainable_parameters": 24861, "num_module_steps_trained": 11970, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 119700, "num_env_steps_trained_lifetime": 330000, "num_env_steps_trained_lifetime_throughput": 4024.7842124405333, "num_module_steps_trained_throughput": 25296776.258409258, "num_module_steps_trained_lifetime_throughput": 13039119.712078214}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 718200, "num_env_steps_trained_lifetime": 1980000, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 45543.37885166898}, "default_policy": {"vf_loss_unclipped": 47.035499572753906, "module_train_batch_size_mean": 997.5109713823833, "num_module_steps_trained_lifetime": 359100, "diff_num_grad_updates_vs_sampler_policy": 51.0, "vf_loss": 0.35926032066345215, "total_loss": 0.2786826193332672, "vf_explained_var": 0.004478156566619873, "mean_kl_loss": 2.396095806034282e-05, "policy_loss": -0.00015238439664244652, "entropy": 0.6810969114303589, "weights_seq_no": 60.0, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35910}, "intrinsic_reward_module": {"weights_seq_no": 60.0, "num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.5109713823833, "num_module_steps_trained_lifetime": 359100, "diff_num_grad_updates_vs_sampler_policy": 51.0, "total_loss": 0.0}}}, "IntrinsicAttentionMask": [[[0.09492377191781998, 0.08932553976774216, 0.08940624445676804, 0.09339717775583267, 0.08974245190620422, 0.08982352912425995, 0.08972978591918945, 0.08981086313724518, 0.09363733977079391, 0.08997321873903275, 0.09023004025220871], [0.07276029884815216, 0.09863059967756271, 0.09818584471940994, 0.07891014218330383, 0.09635872393846512, 0.09592421352863312, 0.09642677754163742, 0.09599195420742035, 0.0779024288058281, 0.09512819349765778, 0.09378084540367126], [0.07305621355772018, 0.09849616885185242, 0.09805992245674133, 0.07911655306816101, 0.09626736491918564, 0.09584098309278488, 0.09633414447307587, 0.09590746462345123, 0.07812410593032837, 0.09505978226661682, 0.09373723715543747], [0.08855749666690826, 0.09185557812452316, 0.09180568903684616, 0.08942539989948273, 0.09159864485263824, 0.09154889732599258, 0.09160642325878143, 0.09155666828155518, 0.08928736299276352, 0.09145724773406982, 0.09130056947469711], [0.07429659366607666, 0.09793617576360703, 0.09753505885601044, 0.0799776166677475, 0.09588544070720673, 0.09549272060394287, 0.09594694525003433, 0.09555396437644958, 0.07904960215091705, 0.09477284550666809, 0.09355311095714569], [0.0745975449681282, 0.09780111163854599, 0.09740839153528214, 0.08018552511930466, 0.0957929939031601, 0.09540833532810211, 0.09585322439670563, 0.09546831995248795, 0.07927326112985611, 0.09470316022634506, 0.09350809454917908], [0.07424966245889664, 0.09795725345611572, 0.09755481779575348, 0.0799451544880867, 0.09589985758066177, 0.09550587832927704, 0.0959615558385849, 0.09556731581687927, 0.07901468873023987, 0.09478370100259781, 0.0935601145029068], [0.07455047219991684, 0.09782222658395767, 0.09742819517850876, 0.08015303313732147, 0.09580745548009872, 0.09542153775691986, 0.09586787968873978, 0.09548172354698181, 0.07923830300569534, 0.09471406787633896, 0.09351515024900436], [0.08954345434904099, 0.09145699441432953, 0.09142826497554779, 0.09004988521337509, 0.09130897372961044, 0.09128029644489288, 0.09131345897912979, 0.09128478169441223, 0.08996947854757309, 0.0912274420261383, 0.09113702923059464], [0.07515504211187363, 0.09755179286003113, 0.0971745103597641, 0.08056964725255966, 0.0956220030784607, 0.09525217860937119, 0.09567990154027939, 0.09530985355377197, 0.07968665659427643, 0.09457404911518097, 0.09342440962791443], [0.07611716538667679, 0.09712404012680054, 0.09677301347255707, 0.08122941851615906, 0.09532760828733444, 0.0949830710887909, 0.09538154304027557, 0.0950368121266365, 0.08039731532335281, 0.09435109049081802, 0.09327898174524307]], [[0.09079098701477051, 0.09078441560268402, 0.09107562154531479, 0.09105479717254639, 0.09104819595813751, 0.09075810015201569, 0.0907515287399292, 0.09104263037443161, 0.09088682383298874, 0.09102232754230499, 0.09078461676836014], [0.09092230349779129, 0.09092304110527039, 0.09089047461748123, 0.09089279919862747, 0.09089353680610657, 0.09092599153518677, 0.09092672914266586, 0.09089415520429611, 0.09091157466173172, 0.09089642018079758, 0.0909230187535286], [0.08508279919624329, 0.08478105813264847, 0.09919717162847519, 0.09809104353189468, 0.09774316847324371, 0.0835847407579422, 0.08328830450773239, 0.09745059162378311, 0.0896001011133194, 0.09639069437980652, 0.08479030430316925], [0.08550151437520981, 0.08521994948387146, 0.09859631955623627, 0.09757517278194427, 0.09725384414196014, 0.08410293608903885, 0.0838259756565094, 0.09698354452848434, 0.08970829844474792, 0.09600383043289185, 0.0852285772562027], [0.08563414961099625, 0.08535902202129364, 0.09840618073940277, 0.09741176664829254, 0.09709880501031876, 0.08426733314990997, 0.08399659395217896, 0.09683551639318466, 0.08974211663007736, 0.09588106721639633, 0.08536744862794876], [0.09144709259271622, 0.09147730469703674, 0.09015126526355743, 0.0902453064918518, 0.09027513116598129, 0.0915982648730278, 0.0916285291314125, 0.0903002992272377, 0.0910082682967186, 0.09039217233657837, 0.09147638082504272], [0.0915781557559967, 0.09161579608917236, 0.08996681123971939, 0.09008356928825378, 0.0901205986738205, 0.09176650643348694, 0.09180422127246857, 0.090151846408844, 0.09103185683488846, 0.09026595205068588, 0.09161464124917984], [0.08574603497982025, 0.08547636866569519, 0.09824582189321518, 0.09727390110492706, 0.09696797281503677, 0.08440612256526947, 0.08414066582918167, 0.09671057760715485, 0.08977048844099045, 0.09577740728855133, 0.08548463135957718], [0.08887392282485962, 0.0887632966041565, 0.09378691762685776, 0.09341895580291748, 0.09330267459154129, 0.08832217752933502, 0.08821224421262741, 0.09320467710494995, 0.09050038456916809, 0.092848040163517, 0.08876669406890869], [0.08615411072969437, 0.08590445667505264, 0.09766152501106262, 0.09677109122276306, 0.09649066627025604, 0.08491303026676178, 0.08466697484254837, 0.09625468403100967, 0.08987261354923248, 0.09539869427680969, 0.08591210842132568], [0.09091827273368835, 0.09091877937316895, 0.09089614450931549, 0.09089776128530502, 0.09089827537536621, 0.0909208282828331, 0.09092134237289429, 0.09089870750904083, 0.09091081470251083, 0.09090027958154678, 0.09091876447200775]], [[0.09422022849321365, 0.0886634886264801, 0.09244108200073242, 0.09270494431257248, 0.08907730877399445, 0.08915778249502182, 0.0927756205201149, 0.08914521336555481, 0.08922574669122696, 0.09302730858325958, 0.08956128358840942], [0.0754680410027504, 0.10230109840631485, 0.08302263170480728, 0.08184675127267838, 0.09994467347860336, 0.09949399530887604, 0.0815352275967598, 0.09956425428390503, 0.099115289747715, 0.08043717592954636, 0.09727086871862411], [0.08804691582918167, 0.09290247410535812, 0.0895417109131813, 0.08931660652160645, 0.09252123534679413, 0.09244747459888458, 0.08925652503967285, 0.09245899319648743, 0.09238528460264206, 0.08904322981834412, 0.09207957237958908], [0.08895313739776611, 0.09226594865322113, 0.08997905254364014, 0.08982491493225098, 0.09200786799192429, 0.09195790439844131, 0.08978375047445297, 0.0919657051563263, 0.09191575646400452, 0.08963754773139954, 0.0917084589600563], [0.07680778205394745, 0.10124636441469193, 0.08375879377126694, 0.08268081396818161, 0.09912631660699844, 0.09872032701969147, 0.08239498734474182, 0.09878363460302353, 0.09837904572486877, 0.08138673007488251, 0.09671515971422195], [0.0770694762468338, 0.10104193538427353, 0.08390137553215027, 0.0828426256775856, 0.09896727651357651, 0.09856986999511719, 0.08256185054779053, 0.0986318439245224, 0.09823578596115112, 0.08157125860452652, 0.09660666435956955], [0.08919639885425568, 0.09209592640399933, 0.09009575843811035, 0.08996071666479111, 0.09187051653862, 0.09182686358690262, 0.0899246409535408, 0.0918336808681488, 0.09179005026817322, 0.0897965207695961, 0.0916089117527008], [0.07702856510877609, 0.10107387602329254, 0.08387911319732666, 0.08281735330820084, 0.09899213165044785, 0.09859339147806168, 0.08253578841686249, 0.0986555740237236, 0.09825818240642548, 0.08154242485761642, 0.09662363678216934], [0.07729078084230423, 0.10086948424577713, 0.08402164280414581, 0.08297917991876602, 0.09883299469947815, 0.09844283014535904, 0.08270267397165298, 0.09850367158651352, 0.09811480343341827, 0.08172706514596939, 0.09651494771242142], [0.09006477147340775, 0.09149197489023209, 0.09050994366407394, 0.09044323861598969, 0.09138184785842896, 0.09136050194501877, 0.09042541682720184, 0.09136383980512619, 0.0913425013422966, 0.0903620719909668, 0.0912538692355156], [0.07838711142539978, 0.10002045333385468, 0.08461327850818634, 0.0836518257856369, 0.0981704443693161, 0.09781564027070999, 0.08339665085077286, 0.09787098318338394, 0.09751725196838379, 0.08249567449092865, 0.09606073051691055]], [[0.09715745598077774, 0.09679728746414185, 0.0964384600520134, 0.09531461447477341, 0.09496127814054489, 0.09536992758512497, 0.09501639008522034, 0.09466416388750076, 0.07330761104822159, 0.07912512868642807, 0.0818476751446724], [0.09702596813440323, 0.09667407721281052, 0.09632346779108047, 0.09522517025470734, 0.09487981349229813, 0.09527923166751862, 0.09493367373943329, 0.09458937495946884, 0.0736570656299591, 0.07937072962522507, 0.08204150199890137], [0.0968942865729332, 0.09655065089464188, 0.09620822966098785, 0.09513543546199799, 0.09479804337024689, 0.09518825262784958, 0.09485067427158356, 0.09451428055763245, 0.07400789111852646, 0.07961678504943848, 0.08223547041416168], [0.09647748619318008, 0.09615977853536606, 0.0958431139588356, 0.09485048055648804, 0.0945381298661232, 0.09489937126636505, 0.09458684921264648, 0.09427537024021149, 0.07512437552213669, 0.08039643615484238, 0.08284865319728851], [0.09634504467248917, 0.09603550285100937, 0.09572696685791016, 0.09475962072610855, 0.09445518255233765, 0.09480727463960648, 0.09450268000364304, 0.09419906139373779, 0.07548101991415024, 0.08064441382884979, 0.08304323256015778], [0.09649815410375595, 0.09617916494607925, 0.09586123377084732, 0.09486464411020279, 0.09455105662345886, 0.09491372108459473, 0.09459997713565826, 0.09428726136684418, 0.07506878674030304, 0.08035773783922195, 0.08281826227903366], [0.09636574983596802, 0.09605494141578674, 0.09574512392282486, 0.09477383643388748, 0.09446816146373749, 0.09482168406248093, 0.0945158451795578, 0.09421100467443466, 0.07542521506547928, 0.080605648458004, 0.08301282674074173], [0.09623314440250397, 0.09593048691749573, 0.0956287831068039, 0.09468274563550949, 0.09438496828079224, 0.09472934901714325, 0.09443142265081406, 0.09413443505764008, 0.07578304409980774, 0.08085400611162186, 0.08320751786231995], [0.08668665587902069, 0.08689460158348083, 0.08710304647684097, 0.08776424080133438, 0.08797477185726166, 0.08773139864206314, 0.08794184774160385, 0.08815280348062515, 0.10396075248718262, 0.09896311163902283, 0.0968266949057579], [0.0896211639046669, 0.08968745917081833, 0.08975380659103394, 0.08996351808309555, 0.09003006666898727, 0.08995313197374344, 0.09001966565847397, 0.09008625894784927, 0.09479081630706787, 0.09336044639348984, 0.0927337259054184], [0.09089933335781097, 0.09089984744787216, 0.09090035408735275, 0.09090197086334229, 0.09090248495340347, 0.09090189635753632, 0.0909024029970169, 0.09090292453765869, 0.09093818068504333, 0.09092764556407928, 0.09092298150062561]], [[0.0942189171910286, 0.08866225183010101, 0.08874235302209854, 0.09270365536212921, 0.08907607197761536, 0.09287124872207642, 0.09277432411909103, 0.08914396911859512, 0.09294203668832779, 0.08930512517690659, 0.08956003189086914], [0.07544157654047012, 0.10226521641016006, 0.10180407017469406, 0.08181804418563843, 0.09990961849689484, 0.081081822514534, 0.0815066248178482, 0.09952933341264725, 0.08077319711446762, 0.09863374382257462, 0.0972367450594902], [0.07570098340511322, 0.1020619198679924, 0.10160987824201584, 0.08198072016239166, 0.09975243359804153, 0.08125612884759903, 0.0816742405295372, 0.09937950223684311, 0.08095234632492065, 0.09850112348794937, 0.09713070839643478], [0.0889526829123497, 0.09226548671722412, 0.09221537411212921, 0.08982446789741516, 0.09200740605592728, 0.08972693234682083, 0.08978330343961716, 0.09196524322032928, 0.08968581259250641, 0.09186538308858871, 0.09170800447463989], [0.07678556442260742, 0.10121708363294601, 0.10080252587795258, 0.08265690505504608, 0.09909765422344208, 0.08198121190071106, 0.08237116038799286, 0.09875506907701492, 0.08169779926538467, 0.09794777631759644, 0.0966871902346611], [0.08953021466732025, 0.09186282753944397, 0.09182772785425186, 0.0901465117931366, 0.09168200939893723, 0.09007764607667923, 0.0901174545288086, 0.09165245294570923, 0.09004861116409302, 0.09158243983983994, 0.09147205203771591], [0.08919605612754822, 0.09209556877613068, 0.09205181151628494, 0.08996036648750305, 0.09187015891075134, 0.08987489342689514, 0.08992429077625275, 0.09183333069086075, 0.08983886241912842, 0.09174607694149017, 0.09160855412483215], [0.07700701057910919, 0.10104560106992722, 0.10063859075307846, 0.0827941820025444, 0.09896443784236908, 0.08212853223085403, 0.08251269906759262, 0.0986279770731926, 0.08184930682182312, 0.09783502668142319, 0.0965966060757637], [0.08977455645799637, 0.09169303625822067, 0.09166423231363297, 0.09028229862451553, 0.09154463559389114, 0.09022559225559235, 0.09025836735963821, 0.09152037650346756, 0.09020167589187622, 0.0914628878235817, 0.09137225151062012], [0.07753360271453857, 0.10063917934894562, 0.10024995356798172, 0.08311957120895386, 0.0986483097076416, 0.0824778750538826, 0.08284823596477509, 0.09832628071308136, 0.08220864087343216, 0.09756719321012497, 0.09638117253780365], [0.07836946845054626, 0.09999793767929077, 0.09963652491569519, 0.08363299816846848, 0.09814834594726562, 0.08302955329418182, 0.08337787538766861, 0.09784895181655884, 0.0827762708067894, 0.09714293479919434, 0.09603910148143768]], [[0.09089916944503784, 0.09089258313179016, 0.09118413925170898, 0.09116329252719879, 0.09085863083600998, 0.09086623787879944, 0.09085965901613235, 0.09085308015346527, 0.09069759398698807, 0.09083281457424164, 0.09089278429746628], [0.09091018885374069, 0.09091092646121979, 0.09087835252285004, 0.09088067710399628, 0.09091472625732422, 0.09091386944055557, 0.09091460704803467, 0.09091534465551376, 0.09093277156352997, 0.09091761708259583, 0.090910904109478], [0.0901828408241272, 0.08986300975084305, 0.10514325648546219, 0.10397082567214966, 0.08823180198669434, 0.08859498798847198, 0.08828078210353851, 0.08796769380569458, 0.08088114112615585, 0.0870109349489212, 0.0898728147149086], [0.09025130420923233, 0.08995410054922104, 0.10407355427742004, 0.10299567878246307, 0.08843710273504257, 0.08877503126859665, 0.08848268538713455, 0.08819130808115005, 0.08157560974359512, 0.08730041235685349, 0.08996320515871048], [0.09096308052539825, 0.09100160747766495, 0.08931399136781693, 0.089433453977108, 0.09120054543018341, 0.09115590155124664, 0.0911945104598999, 0.09123314172029495, 0.09215112030506134, 0.09135214239358902, 0.09100043028593063], [0.09095180034637451, 0.0909818485379219, 0.08966299146413803, 0.08975652605295181, 0.09113695472478867, 0.09110215306282043, 0.091132253408432, 0.09116236865520477, 0.09187709540128708, 0.09125511348247528, 0.09098092466592789], [0.09096158295869827, 0.09099896997213364, 0.08936108648777008, 0.0894770547747612, 0.09119197726249695, 0.09114865958690643, 0.09118612110614777, 0.09122359752655029, 0.09211407601833344, 0.09133905917406082, 0.09099782258272171], [0.09097111970186234, 0.09101583808660507, 0.08905996382236481, 0.08919820934534073, 0.09124677628278732, 0.09119495004415512, 0.09123978018760681, 0.0912846252322197, 0.09235141426324844, 0.09142283350229263, 0.09101446717977524], [0.09112592786550522, 0.09134452790021896, 0.08216537535190582, 0.08278907835483551, 0.09248000383377075, 0.09222416579723358, 0.09244539588689804, 0.09266716241836548, 0.09806744754314423, 0.09335310757160187, 0.09133780747652054], [0.09099894762039185, 0.09106626361608505, 0.0881379172205925, 0.08834385871887207, 0.09141413867473602, 0.09133601933717728, 0.09140358120203018, 0.09147119522094727, 0.09308424592018127, 0.0916796326637268, 0.09106419235467911], [0.09090985357761383, 0.09091037511825562, 0.09088773280382156, 0.0908893495798111, 0.09091301262378693, 0.09091241657733917, 0.09091293066740036, 0.09091344475746155, 0.09092555195093155, 0.0909150242805481, 0.09091035276651382]]], "default_policy": {"vf_explained_var": 0.00017404556274414062, "curr_entropy_coeff": 0.0015431216992, "num_trainable_parameters": 16595, "curr_kl_coeff": 0.00015779680688865483, "policy_loss": -0.00015277380589395761, "entropy": 0.681083619594574, "module_train_batch_size_mean": 997.772440523815, "weights_seq_no": 10.0, "use_intrinsic_rewards": 0.0, "num_module_steps_trained": 5985, "vf_loss_unclipped": 47.51762390136719, "num_module_steps_trained_lifetime": 59850, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.27793535590171814, "vf_loss": 0.3583066165447235, "mean_kl_loss": 2.455366848153062e-05, "num_module_steps_trained_lifetime_throughput": 729.6919156537913}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 59850, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_trainable_parameters": 8266, "weights_seq_no": 10.0, "num_module_steps_trained": 5985, "module_train_batch_size_mean": 997.772440523815, "num_module_steps_trained_lifetime_throughput": 729.7020235213267}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 1.8}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.2705095150541656e-05, "tensor_to_numpy": 2.628705346990027e-05, "un_batch_to_individual_items": 1.0223605327645902e-05, "remove_single_ts_time_rank_from_batch": 1.8504797365470517e-05, "listify_data_for_vector_env": 1.79161518585782e-05, "get_actions": 7.498053780812803e-05}}, "connector_pipeline_timer": 0.00020192638586654903}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.873342606848396e-06, "numpy_to_tensor": 2.4459439768084172e-05, "add_states_from_episodes_to_batch": 4.347949394914643e-06, "batch_individual_items": 2.117939558470786e-05, "add_time_dim_to_batch_and_zero_pad": 1.2049746355116103e-05}}, "connector_pipeline_timer": 0.00010207242757392799}, "num_agent_steps_sampled": {"default_agent": 400}, "rlmodule_inference_timer": 6.081686034384997e-05, "episode_duration_sec_mean": 0.006926528721814975, "num_env_steps_sampled_lifetime": 50400, "episode_len_mean": 20.0, "num_episodes_lifetime": 200, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "num_episodes": 20, "env_step_timer": 2.635457024550992e-05, "weights_seq_no": 10.0, "episode_return_min": -13.5, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.8, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "agent_episode_returns_mean": {"default_agent": 1.8}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "episode_len_max": 20, "env_reset_timer": 0.0006159661221332946, "episode_return_max": 13.5, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "sample": 0.1198686330543258, "time_between_sampling": 9.643893853281876}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "b4968_00000", "date": "2025-08-11_18-16-41", "timestamp": 1754929001, "time_this_iter_s": 10.821749925613403, "time_total_s": 105.97760462760925, "pid": 10564, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x141ef98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 105.97760462760925, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 47.962500000000006, "ram_util_percent": 81.08125}}
{"timers": {"training_iteration": 10.578247713395635, "restore_env_runners": 1.2383214214629958e-05, "training_step": 10.578000052356485, "env_runner_sampling_timer": 1.6695237745533384, "learner_update_timer": 8.725274435217177, "synch_weights": 0.001845661236810566, "restore_eval_env_runners": 6.009898461800337e-05, "evaluation_iteration": 0.1324662179005659, "synch_eval_env_connectors": 0.00026667328322823935, "synch_env_connectors": 5.371063492148901e-06}, "env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.592475945560561e-06, "numpy_to_tensor": 1.4305642785734788e-05, "add_states_from_episodes_to_batch": 2.9444598286945627e-06, "batch_individual_items": 1.3516698418328814e-05, "add_observations_from_episodes_to_batch": 3.0923816579645457e-06}}, "connector_pipeline_timer": 6.476207751025414e-05}, "num_env_steps_sampled_lifetime": -5547500.0, "episode_return_mean": -2.1399999999999997, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": -2.1399999999999997}, "module_episode_returns_mean": {"default_policy": -2.1399999999999997}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.006349332608657256, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.6937906350744535e-05, "remove_single_ts_time_rank_from_batch": 1.2846012982350433e-05, "normalize_and_clip_actions": 8.719257293109679e-06, "get_actions": 4.591543763429346e-05, "listify_data_for_vector_env": 1.1439660941959102e-05, "un_batch_to_individual_items": 7.128895338827334e-06}}, "connector_pipeline_timer": 0.00013102102874015513}, "time_between_sampling": 0.03720131150268204, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 6.5, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "episode_len_mean": 20.0, "num_episodes": 250.0, "num_episodes_lifetime": -277375.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "rlmodule_inference_timer": 3.6061100715031095e-05, "episode_duration_sec_mean": 0.005811693982221184, "weights_seq_no": 10.0, "env_step_timer": 1.546625788271603e-05, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "env_reset_timer": 5.364967800791889e-05, "num_env_steps_sampled_lifetime_throughput": 2992.377264651328}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1441685151740491, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00896014046938547, "add_observations_from_episodes_to_batch": 0.0009095025929081524, "add_columns_from_episodes_to_train_batch": 0.04144594871029298, "add_time_dim_to_batch_and_zero_pad": 0.07654085566345174, "add_states_from_episodes_to_batch": 0.004077526189421106, "batch_individual_items": 0.011966111919762656, "numpy_to_tensor": 7.52626561071024e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_env_steps_trained": 33000, "num_trainable_parameters": 24861, "num_module_steps_trained": 11970, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 131670, "num_env_steps_trained_lifetime": 363000, "num_env_steps_trained_lifetime_throughput": 4004.837928075791, "num_module_steps_trained_throughput": 24602438.232877437, "num_module_steps_trained_lifetime_throughput": 12981533.582491511}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 790020, "num_env_steps_trained_lifetime": 2178000, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 44839.649267706205}, "default_policy": {"vf_loss_unclipped": 43.1655387878418, "module_train_batch_size_mean": 997.5068778348534, "num_module_steps_trained_lifetime": 395010, "diff_num_grad_updates_vs_sampler_policy": 56.0, "vf_loss": 0.35914433002471924, "total_loss": 0.2785381078720093, "vf_explained_var": 0.004687488079071045, "mean_kl_loss": 4.158893716521561e-06, "policy_loss": -0.00020361047063488513, "entropy": 0.6809177994728088, "weights_seq_no": 66.0, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35910}, "intrinsic_reward_module": {"weights_seq_no": 66.0, "num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.5068778348534, "num_module_steps_trained_lifetime": 395010, "diff_num_grad_updates_vs_sampler_policy": 56.0, "total_loss": 0.0}}}, "IntrinsicAttentionMask": [[[0.09284049272537231, 0.09100517630577087, 0.09108740091323853, 0.08769365400075912, 0.0914299264550209, 0.0915125384926796, 0.09141703695058823, 0.08783978968858719, 0.0915822982788086, 0.09166504442691803, 0.0919266864657402], [0.08904428780078888, 0.09078983217477798, 0.09071014076471329, 0.09412159025669098, 0.09037970006465912, 0.09030037373304367, 0.090392105281353, 0.09396933019161224, 0.09023349732160568, 0.09015430510044098, 0.0899048000574112], [0.08921484649181366, 0.09080184996128082, 0.09072946757078171, 0.09382330626249313, 0.09042923152446747, 0.09035714715719223, 0.09044049680233002, 0.09368544816970825, 0.09029636532068253, 0.09022437781095505, 0.0899975597858429], [0.08214200288057327, 0.09010448306798935, 0.0897282138466835, 0.10698947310447693, 0.08818110823631287, 0.0878128632903099, 0.08823876827955246, 0.10616715252399445, 0.0875033512711525, 0.08713793754577637, 0.08599460124969482], [0.08992484956979752, 0.09084945172071457, 0.09080743044614792, 0.09259121865034103, 0.09063297510147095, 0.09059105813503265, 0.09063952416181564, 0.09251226484775543, 0.09055569767951965, 0.09051381051540375, 0.09038172662258148], [0.09009596705436707, 0.09086034446954727, 0.0908256322145462, 0.09229662269353867, 0.09068150818347931, 0.09064685553312302, 0.09068691730499268, 0.0922316163778305, 0.09061763435602188, 0.09058301150798798, 0.09047383815050125], [0.08989813923835754, 0.09084774553775787, 0.0908045843243599, 0.0926373153924942, 0.09062539041042328, 0.09058233350515366, 0.0906321182847023, 0.0925561785697937, 0.09054601192474365, 0.09050299227237701, 0.09036733210086823], [0.08244785666465759, 0.09014347940683365, 0.08978037536144257, 0.10638518631458282, 0.088286854326725, 0.08793123066425323, 0.08834253996610641, 0.10559642314910889, 0.08763228356838226, 0.0872792974114418, 0.08617449551820755], [0.09024044126272202, 0.09086938202381134, 0.09084083884954453, 0.09204861521720886, 0.09072230756282806, 0.09069381654262543, 0.09072676301002502, 0.09199531376361847, 0.09066978096961975, 0.09064129739999771, 0.0905514732003212], [0.09041175246238708, 0.09087987244129181, 0.09085864573717117, 0.09175533801317215, 0.09077047556638718, 0.09074927866458893, 0.09077379107475281, 0.09171582758426666, 0.09073139727115631, 0.09071020036935806, 0.09064335376024246], [0.09095318615436554, 0.09091158956289291, 0.09091346710920334, 0.09083440899848938, 0.09092129021883011, 0.09092316776514053, 0.09092099219560623, 0.09083787351846695, 0.09092475473880768, 0.0909266397356987, 0.09093257784843445]], [[0.10341369360685349, 0.10303033143281937, 0.086785227060318, 0.08577388525009155, 0.08545591682195663, 0.085823655128479, 0.08550550788640976, 0.08518853783607483, 0.09229056537151337, 0.09961453825235367, 0.08711807429790497], [0.10313154757022858, 0.1027575135231018, 0.08687818795442581, 0.08588758856058121, 0.08557609468698502, 0.08593635261058807, 0.08562467992305756, 0.08531413972377777, 0.09226624667644501, 0.09942344576120377, 0.08720414340496063], [0.09062330424785614, 0.09063134342432022, 0.09100338071584702, 0.0910288468003273, 0.09103692322969437, 0.09102758765220642, 0.09103565663099289, 0.09104373306035995, 0.09086984395980835, 0.09070432186126709, 0.09099505841732025], [0.08980710804462433, 0.08983790874481201, 0.09127264469861984, 0.09137149155139923, 0.09140283614397049, 0.09136659651994705, 0.09139793366193771, 0.09142928570508957, 0.09075575321912766, 0.09011803567409515, 0.09124039113521576], [0.08954954892396927, 0.08958747982978821, 0.09135761857032776, 0.0914798155426979, 0.09151856601238251, 0.0914737656712532, 0.09151250869035721, 0.091551274061203, 0.09071912616491318, 0.08993256837129593, 0.09131775051355362], [0.08984740078449249, 0.08987708389759064, 0.09125936776399612, 0.09135456383228302, 0.09138475358486176, 0.09134985506534576, 0.0913800373673439, 0.09141022711992264, 0.0907614529132843, 0.09014702588319778, 0.09122829884290695], [0.08958975225687027, 0.08962657302618027, 0.09134435653686523, 0.09146290272474289, 0.09150049090385437, 0.09145703166723251, 0.091494619846344, 0.09153222292661667, 0.09072486311197281, 0.08996152877807617, 0.0913056805729866], [0.08933261036872864, 0.0893765240907669, 0.09142918884754181, 0.09157112240791321, 0.09161613881587982, 0.09156408905982971, 0.09160909801721573, 0.09165413677692413, 0.09068804234266281, 0.0897761806845665, 0.09138288348913193], [0.09498690068721771, 0.09486866742372513, 0.08956371992826462, 0.0892123356461525, 0.08910128474235535, 0.08922969549894333, 0.08911862224340439, 0.08900769799947739, 0.09143027663230896, 0.0938020572066307, 0.08967877179384232], [0.1005919948220253, 0.10030049830675125, 0.08771514892578125, 0.08691540360450745, 0.08666353672742844, 0.08695481717586517, 0.08670283108949661, 0.08645159006118774, 0.09203364700078964, 0.09769260883331299, 0.08797790855169296], [0.09089092165231705, 0.09089142829179764, 0.09091509133577347, 0.090916708111763, 0.09091722220182419, 0.09091663360595703, 0.09091714024543762, 0.09091765433549881, 0.09090661257505417, 0.09089607745409012, 0.09091456234455109]], [[0.09250098466873169, 0.09067238122224808, 0.0871242806315422, 0.0910133495926857, 0.09109558165073395, 0.09117788821458817, 0.09108273684978485, 0.09116502106189728, 0.09124738723039627, 0.09132982790470123, 0.0915905237197876], [0.08937016129493713, 0.0911220982670784, 0.09472821652889252, 0.09079015254974365, 0.09071046859025955, 0.09063085913658142, 0.09072291105985641, 0.09064329415559769, 0.09056373685598373, 0.09048424661159515, 0.09023383259773254], [0.08321734517812729, 0.09179869294166565, 0.11169872432947159, 0.0901205986738205, 0.0897214412689209, 0.08932405710220337, 0.089783675968647, 0.08938601613044739, 0.08899011462926865, 0.08859596401453018, 0.0873633548617363], [0.08995597064495087, 0.0910429060459137, 0.09325546026229858, 0.09083758294582367, 0.09078825265169144, 0.0907389372587204, 0.09079595655202866, 0.09074664115905762, 0.09069735556840897, 0.0906481072306633, 0.09049281477928162], [0.0900970995426178, 0.09102347493171692, 0.09290414303541183, 0.09084860235452652, 0.09080658107995987, 0.09076457470655441, 0.09081314504146576, 0.0907711386680603, 0.09072914719581604, 0.09068717807531357, 0.0905548483133316], [0.09023831784725189, 0.0910039097070694, 0.09255401045084, 0.09085949510335922, 0.09082478284835815, 0.09079008549451828, 0.09083020687103271, 0.09079550206661224, 0.09076081216335297, 0.09072613716125488, 0.09061679244041443], [0.0900750458240509, 0.09102652221918106, 0.0929589495062828, 0.09084689617156982, 0.09080372750759125, 0.09076058119535446, 0.09081047028303146, 0.09076731652021408, 0.09072419255971909, 0.09068109095096588, 0.0905451625585556], [0.0902162566781044, 0.09100697189569473, 0.09260863065719604, 0.09085780382156372, 0.09082195162773132, 0.09078610688447952, 0.09082754701375961, 0.09079170972108841, 0.0907558798789978, 0.09072006493806839, 0.09060712158679962], [0.09035752713680267, 0.09098727256059647, 0.0922594740986824, 0.09086856245994568, 0.09084001928567886, 0.09081148356199265, 0.09084447473287582, 0.0908159464597702, 0.09078741818666458, 0.09075890481472015, 0.09066896140575409], [0.09049886465072632, 0.09096743166446686, 0.09191147983074188, 0.0908791646361351, 0.09085793793201447, 0.09083671867847443, 0.0908612534403801, 0.09084003418684006, 0.09081881493330002, 0.09079760313034058, 0.0907306894659996], [0.09094545245170593, 0.0909038558602333, 0.09082075208425522, 0.09091167896986008, 0.0909135565161705, 0.09091543406248093, 0.09091326594352722, 0.09091514348983765, 0.09091702848672867, 0.09091890603303909, 0.09092484414577484]], [[0.09275925159454346, 0.08570578694343567, 0.09309178590774536, 0.08634551614522934, 0.09378664940595627, 0.09359283000230789, 0.08647596836090088, 0.09392835199832916, 0.09071024507284164, 0.09444709122180939, 0.08915651589632034], [0.08899933099746704, 0.09624888002872467, 0.08868453651666641, 0.09554276615381241, 0.08803392201662064, 0.0882144346833229, 0.09540005028247833, 0.08790241926908493, 0.09098967909812927, 0.0874243676662445, 0.09255961328744888], [0.09292184561491013, 0.0852467343211174, 0.09328502416610718, 0.08594056963920593, 0.0940442830324173, 0.09383244812488556, 0.08608212321996689, 0.09419917315244675, 0.09068664908409119, 0.09476640075445175, 0.08899475634098053], [0.08936599642038345, 0.09522560983896255, 0.08910956233739853, 0.09465864300727844, 0.08857901394367218, 0.08872628957033157, 0.09454395622015, 0.08847168833017349, 0.09098344296216965, 0.08808127045631409, 0.09225451201200485], [0.09325756877660751, 0.08429785072803497, 0.09368477016687393, 0.08510231226682663, 0.0945788100361824, 0.09432924538850784, 0.08526656776666641, 0.09476135671138763, 0.09063464403152466, 0.09543026983737946, 0.08865661919116974], [0.09316445887088776, 0.08456113189458847, 0.09357380121946335, 0.08533505350351334, 0.09443022310733795, 0.09419118613004684, 0.0854930430650711, 0.09460504353046417, 0.09064950048923492, 0.09524554014205933, 0.08875095099210739], [0.08944012224674225, 0.0950186625123024, 0.08919559419155121, 0.09447962045669556, 0.08868958801031113, 0.08883006125688553, 0.09437055885791779, 0.0885872095823288, 0.09098166227340698, 0.08821473270654678, 0.09219217300415039], [0.09332536160945892, 0.08410604298114777, 0.09376561641693115, 0.08493266254663467, 0.09468717873096466, 0.09442991018295288, 0.08510147780179977, 0.09487538039684296, 0.09062359482049942, 0.09556508809328079, 0.08858764171600342], [0.09172924607992172, 0.08860679715871811, 0.09187310934066772, 0.08889582008123398, 0.0921727791428566, 0.09208931773900986, 0.0889546126127243, 0.09223373979330063, 0.09083636850118637, 0.09245645254850388, 0.09015171974897385], [0.09357166290283203, 0.08340876549482346, 0.09405972808599472, 0.08431538194417953, 0.095082126557827, 0.09479659050703049, 0.08450064808130264, 0.09529104083776474, 0.09058190882205963, 0.09605706483125687, 0.08833513408899307], [0.09091503918170929, 0.09089240431785583, 0.09091605991125107, 0.09089452773332596, 0.09091819077730179, 0.09091760218143463, 0.09089496731758118, 0.09091862291097641, 0.09090864658355713, 0.09092020243406296, 0.09090369939804077]], [[0.09421828389167786, 0.08866165578365326, 0.08874175697565079, 0.09270302951335907, 0.09278678894042969, 0.08915594220161438, 0.08906289935112, 0.08914337307214737, 0.09294141083955765, 0.09302538633346558, 0.08955943584442139], [0.07542908936738968, 0.10224829614162445, 0.10178722441196442, 0.08180450648069382, 0.08143562078475952, 0.09944263845682144, 0.09996363520622253, 0.09951286762952805, 0.08075983822345734, 0.0803956612944603, 0.09722065925598145], [0.07568889111280441, 0.10204561799764633, 0.10159365087747574, 0.08196762949228287, 0.08160458505153656, 0.0992947518825531, 0.09980568289756775, 0.09936363250017166, 0.08093941956758499, 0.0805809274315834, 0.09711519628763199], [0.0889524593949318, 0.09226525574922562, 0.0922151431441307, 0.08982424437999725, 0.0897754579782486, 0.0919572114944458, 0.09201499074697495, 0.09196501225233078, 0.0896855816245079, 0.08963687717914581, 0.09170777350664139], [0.08924099057912827, 0.09206394851207733, 0.09202136099338531, 0.08998535573482513, 0.08994373679161072, 0.09180209040641785, 0.09185121953487396, 0.0918087288737297, 0.08986703306436539, 0.08982546627521515, 0.09158996492624283], [0.07703793048858643, 0.10100057721138, 0.10059501230716705, 0.082808718085289, 0.08247619867324829, 0.09852952510118484, 0.09898896515369415, 0.09859146922826767, 0.08186660706996918, 0.0815378725528717, 0.09656711667776108], [0.07673405855894089, 0.10123490542173386, 0.10081900656223297, 0.08262012153863907, 0.08228069543838501, 0.09870150685310364, 0.0991724282503128, 0.09876500070095062, 0.08165851980447769, 0.0813230499625206, 0.09669063240289688], [0.0769968256354332, 0.10103223472833633, 0.10062527656555176, 0.08278322964906693, 0.0824497789144516, 0.09855277091264725, 0.09901376068592072, 0.09861493110656738, 0.08183848112821579, 0.0815088301897049, 0.09658382833003998], [0.089774489402771, 0.0916929692029953, 0.09166416525840759, 0.09028223156929016, 0.09025387465953827, 0.09151581674814224, 0.09154906123876572, 0.09152030944824219, 0.09020161628723145, 0.09017328172922134, 0.09137218445539474], [0.0900646448135376, 0.09149184823036194, 0.09147047996520996, 0.09044311940670013, 0.09042199701070786, 0.09136038273572922, 0.09138505905866623, 0.09136371314525604, 0.09038306027650833, 0.09036195278167725, 0.09125374257564545], [0.07836110889911652, 0.09998727589845657, 0.09962590038776398, 0.08362407982349396, 0.08332184702157974, 0.09778319299221039, 0.09819340705871582, 0.09783851355314255, 0.08276744186878204, 0.08246830850839615, 0.09602886438369751]], [[0.0966763123869896, 0.08874744176864624, 0.08858321607112885, 0.08806687593460083, 0.09558021277189255, 0.08809235692024231, 0.08792934566736221, 0.09543095529079437, 0.09099183976650238, 0.0872676745057106, 0.09263383597135544], [0.08531761169433594, 0.09301573783159256, 0.09318982064723969, 0.09374140948057175, 0.08630538731813431, 0.09371403604745865, 0.09388942271471024, 0.08644165843725204, 0.09069987386465073, 0.09460809826850891, 0.08907699584960938], [0.08508196473121643, 0.09310471266508102, 0.09328647702932358, 0.09386251121759415, 0.0861096978187561, 0.09383391588926315, 0.09401710331439972, 0.08625152707099915, 0.0906880646944046, 0.09476788341999054, 0.08899614959955215], [0.08434107899665833, 0.09338458627462387, 0.09359069168567657, 0.09424419701099396, 0.08549357950687408, 0.09421174228191376, 0.0944196805357933, 0.08565277606248856, 0.09064933657646179, 0.09527241438627243, 0.08874000608921051], [0.09511000663042068, 0.08933326601982117, 0.08921219408512115, 0.08883112668991089, 0.09431920200586319, 0.08884994685649872, 0.08872952312231064, 0.09421132504940033, 0.09098199754953384, 0.0882401242852211, 0.09218132495880127], [0.08437763899564743, 0.09337076544761658, 0.09357565641403198, 0.09422532469034195, 0.08552402257919312, 0.09419305622577667, 0.09439976513385773, 0.08568235486745834, 0.09065130352973938, 0.09524743258953094, 0.08875270932912827], [0.0841437354683876, 0.09345913678407669, 0.0936717689037323, 0.09434608370065689, 0.08532924205064774, 0.09431259334087372, 0.09452717751264572, 0.08549302816390991, 0.09063858538866043, 0.09540732949972153, 0.0886712595820427], [0.09489656984806061, 0.08941315859556198, 0.08929804712533951, 0.08893568813800812, 0.09414692968130112, 0.08895359188318253, 0.08883906900882721, 0.09404464811086655, 0.09097994118928909, 0.08837355673313141, 0.0921187475323677], [0.08853762596845627, 0.09180138260126114, 0.09187334775924683, 0.09210082143545151, 0.08896572887897491, 0.09208955615758896, 0.09216173738241196, 0.08902455866336823, 0.09083659946918488, 0.09245669096708298, 0.09015195816755295], [0.08319438993930817, 0.09381799399852753, 0.09406234323978424, 0.09483775496482849, 0.08453734219074249, 0.0947992280125618, 0.09504614025354385, 0.0847230926156044, 0.09058443456888199, 0.09605973958969116, 0.08833760023117065], [0.09089189022779465, 0.09091555327177048, 0.09091605991125107, 0.0909176841378212, 0.09089504927396774, 0.09091760218143463, 0.09091811627149582, 0.09089547395706177, 0.09090864658355713, 0.09092020243406296, 0.09090369939804077]]], "default_policy": {"vf_explained_var": 0.00030672550201416016, "curr_entropy_coeff": 0.0015431216992, "num_trainable_parameters": 16595, "curr_kl_coeff": 7.889840344432741e-05, "policy_loss": -0.00021851653582416475, "entropy": 0.6808800101280212, "module_train_batch_size_mean": 997.7563503102639, "weights_seq_no": 11.0, "use_intrinsic_rewards": 0.0, "num_module_steps_trained": 5985, "vf_loss_unclipped": 43.35944366455078, "num_module_steps_trained_lifetime": 65835, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.2778707444667816, "vf_loss": 0.35830768942832947, "mean_kl_loss": 4.879791504208697e-06, "num_module_steps_trained_lifetime_throughput": 726.0844752663094}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 65835, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_trainable_parameters": 8266, "weights_seq_no": 11.0, "num_module_steps_trained": 5985, "module_train_batch_size_mean": 997.7563503102639, "num_module_steps_trained_lifetime_throughput": 726.0940421909384}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 1.6}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.84842207683898e-06, "tensor_to_numpy": 1.757969459532436e-05, "un_batch_to_individual_items": 7.198281296557084e-06, "remove_single_ts_time_rank_from_batch": 1.2863659762726775e-05, "listify_data_for_vector_env": 1.3030105137105706e-05, "get_actions": 4.641235907546301e-05}}, "connector_pipeline_timer": 0.0001354448935021147}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.1587821725455145e-06, "numpy_to_tensor": 1.4910326809332302e-05, "add_states_from_episodes_to_batch": 3.4562607537964283e-06, "batch_individual_items": 1.5170952232724994e-05, "add_time_dim_to_batch_and_zero_pad": 9.41434366921294e-06}}, "connector_pipeline_timer": 7.16494164044e-05}, "num_agent_steps_sampled": {"default_agent": 400}, "rlmodule_inference_timer": 3.7393729168714116e-05, "episode_duration_sec_mean": 0.007010254134656862, "num_env_steps_sampled_lifetime": 55400, "episode_len_mean": 20.0, "num_episodes_lifetime": 220, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "num_episodes": 20, "env_step_timer": 1.7245418668981328e-05, "weights_seq_no": 11.0, "episode_return_min": -13.5, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.6, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "agent_episode_returns_mean": {"default_agent": 1.6}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "episode_len_max": 20, "env_reset_timer": 0.0006134702105788462, "episode_return_max": 13.5, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "sample": 0.11995035463285361, "time_between_sampling": 9.648263012249178}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "b4968_00000", "date": "2025-08-11_18-16-51", "timestamp": 1754929011, "time_this_iter_s": 10.165535926818848, "time_total_s": 116.1431405544281, "pid": 10564, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x141ef98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 116.1431405544281, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 43.49285714285713, "ram_util_percent": 80.64285714285714}}
{"timers": {"training_iteration": 10.579399762511212, "restore_env_runners": 1.2847302730774045e-05, "training_step": 10.579147023083134, "env_runner_sampling_timer": 1.6697629634675233, "learner_update_timer": 8.72601347336518, "synch_weights": 0.0018416342046298853, "restore_eval_env_runners": 5.993841488905256e-05, "evaluation_iteration": 0.13252531489256372, "synch_eval_env_connectors": 0.0002657911297586772, "synch_env_connectors": 5.441933549727288e-06}, "env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.445749953736057e-06, "numpy_to_tensor": 1.3973582946541602e-05, "add_states_from_episodes_to_batch": 2.8783464660395126e-06, "batch_individual_items": 1.3281355349097114e-05, "add_observations_from_episodes_to_batch": 3.0343647354986146e-06}}, "connector_pipeline_timer": 6.368557951998557e-05}, "num_env_steps_sampled_lifetime": -6165000.0, "episode_return_mean": -1.9799999999999998, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": -1.9799999999999998}, "module_episode_returns_mean": {"default_policy": -1.9799999999999998}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.006184585229396134, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.6820201980452967e-05, "remove_single_ts_time_rank_from_batch": 1.2808348034638903e-05, "normalize_and_clip_actions": 8.713498376546848e-06, "get_actions": 4.5508904334376906e-05, "listify_data_for_vector_env": 1.136635643107769e-05, "un_batch_to_individual_items": 7.068878074992892e-06}}, "connector_pipeline_timer": 0.0001302543835666705}, "time_between_sampling": 0.03476520746941392, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 6.5, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "episode_len_mean": 20.0, "num_episodes": 250.0, "num_episodes_lifetime": -308250.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "rlmodule_inference_timer": 3.5272943237142645e-05, "episode_duration_sec_mean": 0.005761630001477896, "weights_seq_no": 11.0, "env_step_timer": 1.5169238097582208e-05, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "env_reset_timer": 5.556841891512365e-05, "num_env_steps_sampled_lifetime_throughput": 2968.817187598581}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.14419553419285605, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00896986239374171, "add_observations_from_episodes_to_batch": 0.000909217146282559, "add_columns_from_episodes_to_train_batch": 0.041467572133936384, "add_time_dim_to_batch_and_zero_pad": 0.0765936383566721, "add_states_from_episodes_to_batch": 0.004077750097686816, "batch_individual_items": 0.011908464959613004, "numpy_to_tensor": 7.568295000218752e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_env_steps_trained": 33000, "num_trainable_parameters": 24861, "num_module_steps_trained": 11970, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 143640, "num_env_steps_trained_lifetime": 396000, "num_env_steps_trained_lifetime_throughput": 3985.572249707056, "num_module_steps_trained_throughput": 23954343.325876575, "num_module_steps_trained_lifetime_throughput": 12935045.509273762}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 861840, "num_env_steps_trained_lifetime": 2376000, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 44151.819762214756}, "default_policy": {"vf_loss_unclipped": 47.262325286865234, "module_train_batch_size_mean": 997.504027034245, "num_module_steps_trained_lifetime": 430920, "diff_num_grad_updates_vs_sampler_policy": 61.0, "vf_loss": 0.3591543138027191, "total_loss": 0.278314471244812, "vf_explained_var": 0.004399538040161133, "mean_kl_loss": 2.152106935682241e-05, "policy_loss": -0.0004399589088279754, "entropy": 0.679502546787262, "weights_seq_no": 72.0, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35910}, "intrinsic_reward_module": {"weights_seq_no": 72.0, "num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.504027034245, "num_module_steps_trained_lifetime": 430920, "diff_num_grad_updates_vs_sampler_policy": 61.0, "total_loss": 0.0}}}, "IntrinsicAttentionMask": [[[0.09318249672651291, 0.09134042263031006, 0.09142295271158218, 0.09168390184640884, 0.08809622377157211, 0.08817581087350845, 0.09175379574298859, 0.09183669090270996, 0.0919196680188179, 0.08832275867462158, 0.09226532280445099], [0.08872076869010925, 0.09045997262001038, 0.09038057923316956, 0.09013044834136963, 0.09369732439517975, 0.0936150848865509, 0.09006369113922119, 0.08998464792966843, 0.08990566432476044, 0.09346365183591843, 0.08957816660404205], [0.08892063051462173, 0.09050241112709045, 0.09043025970458984, 0.0902029275894165, 0.09343934804201126, 0.09336485713720322, 0.09014225006103516, 0.09007038176059723, 0.08999858051538467, 0.09322766959667206, 0.08970076590776443], [0.0895526260137558, 0.09063468873500824, 0.09058547019958496, 0.09043028205633163, 0.09262795001268387, 0.09257764369249344, 0.09038884192705154, 0.09033975750207901, 0.09029068797826767, 0.0924849659204483, 0.09008706361055374], [0.08087696135044098, 0.08855895698070526, 0.08819624036550522, 0.08706115186214447, 0.10437791794538498, 0.10395041108131409, 0.08676017820835114, 0.08640483021736145, 0.08605094254016876, 0.10316678136587143, 0.08459555357694626], [0.08106895536184311, 0.08861120790243149, 0.0882553905248642, 0.08714169263839722, 0.10410312563180923, 0.10368509590625763, 0.08684635162353516, 0.08649761974811554, 0.08615028858184814, 0.10291874408721924, 0.08472158759832382], [0.0897219106554985, 0.090669646859169, 0.09062656760215759, 0.09049072861671448, 0.09241177886724472, 0.09236786514520645, 0.09045444428920746, 0.0904114618897438, 0.09036850929260254, 0.09228696674108505, 0.09019017964601517], [0.08992268890142441, 0.0907108411192894, 0.09067504107952118, 0.09056214988231659, 0.09215597808361053, 0.09211961179971695, 0.09053199738264084, 0.09049627184867859, 0.09046056121587753, 0.09205259382724762, 0.09031228721141815], [0.09012366831302643, 0.0907517820596695, 0.09072328358888626, 0.09063337743282318, 0.09190062433481216, 0.09187175333499908, 0.0906093567609787, 0.09058089554309845, 0.0905524492263794, 0.09181856364011765, 0.09043429046869278], [0.08142345398664474, 0.08870689570903778, 0.08836381137371063, 0.08728966116905212, 0.1035974845290184, 0.10319681465625763, 0.08700472116470337, 0.0866682305932045, 0.0863330289721489, 0.10246213525533676, 0.08495373278856277], [0.09096091985702515, 0.09091931581497192, 0.09092120081186295, 0.0909271389245987, 0.09084401279687881, 0.09084589034318924, 0.09092872589826584, 0.09093060344457626, 0.09093248844146729, 0.09084935486316681, 0.09094030410051346]], [[0.09079091995954514, 0.0910821482539177, 0.09107554703950882, 0.09105472266674042, 0.09104812890291214, 0.09105575084686279, 0.09104915708303452, 0.09074488282203674, 0.09058958292007446, 0.0907246395945549, 0.09078454226255417], [0.08479167520999908, 0.09956350177526474, 0.09920240938663483, 0.09807128459215164, 0.0977156013250351, 0.09812697023153305, 0.09777108579874039, 0.08266232162714005, 0.07585854828357697, 0.08174298703670502, 0.08449357748031616], [0.08493094891309738, 0.09937255084514618, 0.09902013093233109, 0.09791597723960876, 0.09756871312856674, 0.09797033667564392, 0.09762288630008698, 0.0828448012471199, 0.07617094367742538, 0.08194375783205032, 0.08463897556066513], [0.08536960929632187, 0.09876947104930878, 0.09844421595335007, 0.09742464125156403, 0.09710381180047989, 0.0974748507142067, 0.09715386480093002, 0.08342103660106659, 0.07716318964958191, 0.08257832378149033, 0.08509709686040878], [0.08550829440355301, 0.09857826679944992, 0.09826155006885529, 0.09726860374212265, 0.09695609658956528, 0.09731750935316086, 0.09700485318899155, 0.08360368013381958, 0.07747955620288849, 0.082779660820961, 0.08524199575185776], [0.08534792810678482, 0.09879932552576065, 0.09847273677587509, 0.09744899719953537, 0.09712686389684677, 0.09749940782785416, 0.09717711061239243, 0.08339250087738037, 0.07711384445428848, 0.08254688233137131, 0.08507444709539413], [0.08548662811517715, 0.09860812872648239, 0.0982900857925415, 0.09729298204183578, 0.09697917848825455, 0.09734208881855011, 0.09702813625335693, 0.08357514441013336, 0.07743006199598312, 0.08274818956851959, 0.0852193534374237], [0.09170591831207275, 0.08973520249128342, 0.0897793173789978, 0.08991868793964386, 0.08996289223432541, 0.08991178870201111, 0.08995598554611206, 0.09202195703983307, 0.09309735894203186, 0.09216127544641495, 0.09174961596727371], [0.09470807015895844, 0.08519091457128525, 0.08539528399705887, 0.08604349941015244, 0.08624991029500961, 0.08601130545139313, 0.08621762692928314, 0.09630989283323288, 0.10192245990037918, 0.09702280908823013, 0.09492827951908112], [0.09210469573736191, 0.08914296329021454, 0.08920890092849731, 0.08941734582185745, 0.08948349207639694, 0.08940701931715012, 0.08947315067052841, 0.09258268028497696, 0.09421533346176147, 0.09279365092515945, 0.09217073768377304], [0.09091827273368835, 0.0908956378698349, 0.09089615195989609, 0.09089776128530502, 0.09089828282594681, 0.09089768677949905, 0.09089820086956024, 0.09092186391353607, 0.09093397110700607, 0.09092344343662262, 0.09091877192258835]], [[0.0985739529132843, 0.098304383456707, 0.09803555905818939, 0.09719190001487732, 0.08564160764217377, 0.08540741354227066, 0.09696758538484573, 0.08544395864009857, 0.08521029353141785, 0.08497727662324905, 0.08424598723649979], [0.0983462706208229, 0.09808523207902908, 0.09782488644123077, 0.09700769186019897, 0.08579804748296738, 0.0855703130364418, 0.0967903882265091, 0.08560585230588913, 0.08537863194942474, 0.08515200763940811, 0.0844406858086586], [0.09811869263648987, 0.09786614030599594, 0.09761423617601395, 0.09682343155145645, 0.08595439791679382, 0.08573316037654877, 0.09661310166120529, 0.08576768636703491, 0.08554692566394806, 0.08532673120498657, 0.08463545888662338], [0.0974011942744255, 0.09717519581317902, 0.09694971889257431, 0.09624149650335312, 0.08644739538431168, 0.08624681085348129, 0.09605304151773453, 0.08627811819314957, 0.08607792109251022, 0.08587820082902908, 0.0852508544921875], [0.08706455677747726, 0.08718644082546234, 0.08730850368738174, 0.08769488334655762, 0.0935504212975502, 0.09368138760328293, 0.08779846876859665, 0.09366092085838318, 0.09379204362630844, 0.09392335265874863, 0.09433900564908981], [0.08684489130973816, 0.08697348833084106, 0.08710227161645889, 0.08750998228788376, 0.09370128065347672, 0.09384002536535263, 0.08761930465698242, 0.09381833672523499, 0.09395725280046463, 0.09409637004137039, 0.09453682601451874], [0.09720958769321442, 0.09699063003063202, 0.09677215665578842, 0.09608583897352219, 0.08657906949520111, 0.08638405054807663, 0.0959031954407692, 0.08641448616981506, 0.08621983975172043, 0.08602562546730042, 0.08541553467512131], [0.086879201233387, 0.08700674027204514, 0.0871344730257988, 0.08753886073827744, 0.09367772191762924, 0.09381525218486786, 0.08764728903770447, 0.09379374980926514, 0.09393145143985748, 0.09406935423612595, 0.0945059210062027], [0.08665969222784042, 0.086793914437294, 0.0869283378124237, 0.08735397458076477, 0.09382845461368561, 0.09397377073764801, 0.08746811747550964, 0.09395105391740799, 0.09409656375646591, 0.09424229711294174, 0.09470374882221222], [0.08644040673971176, 0.0865812599658966, 0.08672233670949936, 0.08716913312673569, 0.09397904574871063, 0.0941321849822998, 0.08728896826505661, 0.09410825371742249, 0.09426159411668777, 0.09441518783569336, 0.09490161389112473], [0.08574958145618439, 0.08591115474700928, 0.08607302606105804, 0.08658593147993088, 0.09445338696241379, 0.09463135153055191, 0.08672356605529785, 0.094603531062603, 0.0947817862033844, 0.09496036916971207, 0.09552623331546783]], [[0.0962432324886322, 0.0889248475432396, 0.08908409625291824, 0.0971352681517601, 0.0897490456700325, 0.08956357091665268, 0.08972395956516266, 0.08988464623689651, 0.0868050828576088, 0.09038105607032776, 0.09250517934560776], [0.08582884818315506, 0.09282014518976212, 0.09265584498643875, 0.0850483775138855, 0.091976098716259, 0.09216469526290894, 0.09200155735015869, 0.09183871001005173, 0.09506421536207199, 0.09133924543857574, 0.08926229923963547], [0.08605547994375229, 0.0927344337105751, 0.0925777405500412, 0.08530837297439575, 0.09192933887243271, 0.09210926294326782, 0.09195362776517868, 0.09179826080799103, 0.09487330913543701, 0.091321662068367, 0.0893385037779808], [0.09751053154468536, 0.0884566456079483, 0.0886518731713295, 0.09862532466650009, 0.08946792781352997, 0.08924015611410141, 0.08943711221218109, 0.08963450789451599, 0.08586574345827103, 0.0902448520064354, 0.09286525845527649], [0.08700189739465714, 0.09237696975469589, 0.09225177019834518, 0.08639561384916306, 0.09173322468996048, 0.09187718480825424, 0.09175265580415726, 0.0916283056139946, 0.09408187866210938, 0.0912465825676918, 0.08965395390987396], [0.08673790097236633, 0.09247661381959915, 0.09234267473220825, 0.08609208464622498, 0.09178807586431503, 0.09194202721118927, 0.09180886298418045, 0.09167589247226715, 0.0943017303943634, 0.09126779437065125, 0.0895664170384407], [0.08696619421243668, 0.09239044040441513, 0.09226405620574951, 0.08635454624891281, 0.09174063801765442, 0.09188594669103622, 0.09176026284694672, 0.09163473546504974, 0.09411156177520752, 0.09124945849180222, 0.08964212983846664], [0.08719491958618164, 0.09230415523052216, 0.09218532592058182, 0.08661763370037079, 0.09169305115938187, 0.09182973206043243, 0.09171150624752045, 0.0915934294462204, 0.09392159432172775, 0.09123093634843826, 0.08971773087978363], [0.08281378448009491, 0.09396462887525558, 0.0936964601278305, 0.08160237222909927, 0.0925900936126709, 0.09289655834436417, 0.09263144433498383, 0.09236709028482437, 0.09765636920928955, 0.09155809879302979, 0.08822312206029892], [0.08790157735347748, 0.0920378640294075, 0.09194216877222061, 0.08743134140968323, 0.09154549241065979, 0.0916556715965271, 0.09156037122011185, 0.09146517515182495, 0.0933380126953125, 0.09117275476455688, 0.08994963765144348], [0.09092558175325394, 0.09090293943881989, 0.09090345352888107, 0.09092821925878525, 0.0909055843949318, 0.09090498834848404, 0.09090550243854523, 0.09090600907802582, 0.09089603275060654, 0.09090758860111237, 0.09091423451900482]], [[0.09456825256347656, 0.08899098634719849, 0.08907138556241989, 0.08932562917470932, 0.09313143789768219, 0.08948711305856705, 0.0893937200307846, 0.09320243448019028, 0.08955532312393188, 0.08963624387979507, 0.09363744407892227], [0.07404327392578125, 0.10036974400281906, 0.09991714358329773, 0.09850198030471802, 0.07993944734334946, 0.09761562943458557, 0.09812705963850021, 0.07963518053293228, 0.09724407643079758, 0.09680557996034622, 0.07780084758996964], [0.07432272285223007, 0.10020370781421661, 0.09975989907979965, 0.0983719676733017, 0.0801316350698471, 0.09750249236822128, 0.09800420701503754, 0.079832062125206, 0.09713797271251678, 0.09670774638652802, 0.07802559435367584], [0.07520975172519684, 0.09967894107103348, 0.09926268458366394, 0.09796026349067688, 0.08073920011520386, 0.09714382141828537, 0.09761497378349304, 0.08045461773872375, 0.09680140763521194, 0.09639716893434525, 0.07873722165822983], [0.08907143771648407, 0.09188903123140335, 0.0918465256690979, 0.09171250462532043, 0.08977284282445908, 0.09162767231464386, 0.09167670458555222, 0.08973780274391174, 0.09159190952777863, 0.09154953807592392, 0.08952397108078003], [0.07577579468488693, 0.0993458554148674, 0.09894692897796631, 0.09769832342863083, 0.08112496882677078, 0.09691528230905533, 0.09736719727516174, 0.0808500126004219, 0.09658680856227875, 0.09619896858930588, 0.07918994128704071], [0.075448177754879, 0.09953845292329788, 0.09912952035665512, 0.09784983843564987, 0.0809018686413765, 0.09704750776290894, 0.09751053899526596, 0.08062133193016052, 0.09671098738908768, 0.09631367027759552, 0.07892804592847824], [0.08933985233306885, 0.09174519032239914, 0.09170898050069809, 0.09159480780363083, 0.0899396613240242, 0.09152252972126007, 0.09156431257724762, 0.08990971744060516, 0.09149205684661865, 0.09145595133304596, 0.08972691744565964], [0.07601552456617355, 0.09920518845319748, 0.09881354868412018, 0.09758755564689636, 0.08128788322210312, 0.09681857377290726, 0.09726238250732422, 0.08101701736450195, 0.09649595618247986, 0.09611501544713974, 0.07938133925199509], [0.07630034536123276, 0.09903839975595474, 0.09865536540746689, 0.09745611250400543, 0.08148109912872314, 0.09670373797416687, 0.09713798016309738, 0.08121512085199356, 0.0963880643248558, 0.09601528197526932, 0.0796085000038147], [0.09099186211824417, 0.09086522459983826, 0.09086710214614868, 0.09087304025888443, 0.09095995128154755, 0.09087679535150528, 0.09087461978197098, 0.09096153825521469, 0.09087838232517242, 0.09088025987148285, 0.09097123891115189]], [[0.09481636434793472, 0.09498617053031921, 0.08776336163282394, 0.09569516777992249, 0.08841845393180847, 0.08823572099208832, 0.09583975374698639, 0.08855204284191132, 0.08551813662052155, 0.0890410915017128, 0.0911337286233902], [0.0949927419424057, 0.0951705276966095, 0.08762113749980927, 0.09591301530599594, 0.08830472826957703, 0.08811402320861816, 0.09606445580720901, 0.08844415843486786, 0.08527997881174088, 0.08895466476678848, 0.09114054590463638], [0.08724119514226913, 0.087093785405159, 0.09385332465171814, 0.08648379892110825, 0.09319598972797394, 0.09337838739156723, 0.08636047691106796, 0.0930631011724472, 0.0961805209517479, 0.09257993847131729, 0.09056945890188217], [0.09572611004114151, 0.09593738615512848, 0.08702956140041351, 0.09682049602270126, 0.08783067762851715, 0.08760707825422287, 0.09700077772140503, 0.08799421787261963, 0.0842944085597992, 0.08859338611364365, 0.09116584062576294], [0.08796500414609909, 0.08784578740596771, 0.09327299147844315, 0.08735200762748718, 0.09274870157241821, 0.09289425611495972, 0.08725209534168243, 0.09264262765645981, 0.09512335807085037, 0.09225667268037796, 0.0906464159488678], [0.08776351809501648, 0.08763641119003296, 0.09343457221984863, 0.08711007237434387, 0.09287341684103012, 0.09302918612957001, 0.08700360357761383, 0.09275989979505539, 0.09541679173707962, 0.09234698116779327, 0.09062548726797104], [0.09587505459785461, 0.09609319269657135, 0.08690937608480453, 0.09700514376163483, 0.0877341702580452, 0.08750393986701965, 0.09719134122133255, 0.08790256828069687, 0.08409516513347626, 0.0885196402668953, 0.09117037802934647], [0.08811211585998535, 0.08799868077039719, 0.09315501153469086, 0.0875287652015686, 0.09265755861997604, 0.09279567748308182, 0.08743366599082947, 0.092556893825531, 0.09490954875946045, 0.09219058603048325, 0.09066146612167358], [0.08472976088523865, 0.08448795974254608, 0.09586422890424728, 0.08349032700061798, 0.09473226219415665, 0.09504581987857819, 0.083289235830307, 0.09450409561395645, 0.0999157503247261, 0.09367638826370239, 0.09026425331830978], [0.0886491909623146, 0.08855701982975006, 0.09272414445877075, 0.08817495405673981, 0.09232410043478012, 0.09243521094322205, 0.08809758722782135, 0.09224309772253036, 0.09413186460733414, 0.09194819629192352, 0.09071467071771622], [0.09092136472463608, 0.09092187136411667, 0.09089923650026321, 0.09092400223016739, 0.09090135991573334, 0.09090077131986618, 0.09092443436384201, 0.09090179949998856, 0.09089182317256927, 0.0909033715724945, 0.09091001749038696]]], "default_policy": {"vf_explained_var": 0.0009320378303527832, "curr_entropy_coeff": 0.0015431216992, "num_trainable_parameters": 16595, "curr_kl_coeff": 3.944920172216371e-05, "policy_loss": -0.00045842869440093637, "entropy": 0.6794546246528625, "module_train_batch_size_mean": 997.7412016936058, "weights_seq_no": 12.0, "use_intrinsic_rewards": 0.0, "num_module_steps_trained": 5985, "vf_loss_unclipped": 47.73604965209961, "num_module_steps_trained_lifetime": 71820, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.2776326835155487, "vf_loss": 0.35830724239349365, "mean_kl_loss": 2.346773362660315e-05, "num_module_steps_trained_lifetime_throughput": 722.600359327744}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 71820, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_trainable_parameters": 8266, "weights_seq_no": 12.0, "num_module_steps_trained": 5985, "module_train_batch_size_mean": 997.7412016936058, "num_module_steps_trained_lifetime_throughput": 722.6094142622769}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 1.8}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.900921949139842e-06, "tensor_to_numpy": 1.4945304698087853e-05, "un_batch_to_individual_items": 6.552044912528998e-06, "remove_single_ts_time_rank_from_batch": 1.194622542823341e-05, "listify_data_for_vector_env": 1.0515991330220363e-05, "get_actions": 3.538164385394789e-05}}, "connector_pipeline_timer": 0.00011365953460417137}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.797086333614354e-06, "numpy_to_tensor": 1.1859598999232454e-05, "add_states_from_episodes_to_batch": 2.7939058962801395e-06, "batch_individual_items": 1.2505396857693089e-05, "add_time_dim_to_batch_and_zero_pad": 7.10077640938648e-06}}, "connector_pipeline_timer": 5.944107650519203e-05}, "num_agent_steps_sampled": {"default_agent": 400}, "rlmodule_inference_timer": 3.0497551336891966e-05, "episode_duration_sec_mean": 0.006224629116477445, "num_env_steps_sampled_lifetime": 60400, "episode_len_mean": 20.0, "num_episodes_lifetime": 240, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "num_episodes": 20, "env_step_timer": 1.3720912301038088e-05, "weights_seq_no": 12.0, "episode_return_min": -13.5, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.8, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "agent_episode_returns_mean": {"default_agent": 1.8}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "episode_len_max": 20, "env_reset_timer": 0.0006113734193126005, "episode_return_max": 13.5, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "sample": 0.1198945381664185, "time_between_sampling": 9.659118972957017}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "b4968_00000", "date": "2025-08-11_18-17-02", "timestamp": 1754929022, "time_this_iter_s": 10.819869041442871, "time_total_s": 126.96300959587097, "pid": 10564, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x141ef98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 126.96300959587097, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 49.15333333333332, "ram_util_percent": 81.44666666666667}}
{"timers": {"training_iteration": 10.57860072488614, "restore_env_runners": 1.2852999526025064e-05, "training_step": 10.578347688262733, "env_runner_sampling_timer": 1.6685351646629638, "learner_update_timer": 8.724929900711455, "synch_weights": 0.0018413649530335157, "restore_eval_env_runners": 5.977778146167626e-05, "evaluation_iteration": 0.13243086633437925, "synch_eval_env_connectors": 0.0002648536378474922, "synch_env_connectors": 5.42751451880975e-06}, "env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.938502632247544e-06, "numpy_to_tensor": 1.2762609030826634e-05, "add_states_from_episodes_to_batch": 2.732047319744301e-06, "batch_individual_items": 1.246609999236828e-05, "add_observations_from_episodes_to_batch": 2.844100815969236e-06}}, "connector_pipeline_timer": 5.9643805858459246e-05}, "num_env_steps_sampled_lifetime": -6782500.0, "episode_return_mean": -2.2199999999999998, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": -2.2199999999999998}, "module_episode_returns_mean": {"default_policy": -2.2199999999999998}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.005856300742001957, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5474354402923632e-05, "remove_single_ts_time_rank_from_batch": 1.2037416658348465e-05, "normalize_and_clip_actions": 8.060939289770179e-06, "get_actions": 4.046581126088144e-05, "listify_data_for_vector_env": 1.0647907373016972e-05, "un_batch_to_individual_items": 6.671251692908239e-06}}, "connector_pipeline_timer": 0.0001195366442125142}, "time_between_sampling": 0.036918451782349364, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 6.5, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "episode_len_mean": 20.0, "num_episodes": 250.0, "num_episodes_lifetime": -339125.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "rlmodule_inference_timer": 3.218075658487803e-05, "episode_duration_sec_mean": 0.005303757824935016, "weights_seq_no": 12.0, "env_step_timer": 1.4028066124568601e-05, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "env_reset_timer": 4.6728790070347873e-05, "num_env_steps_sampled_lifetime_throughput": 3213.4607965993905}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.14559908175996755, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008969672520047406, "add_observations_from_episodes_to_batch": 0.0009087691442490504, "add_columns_from_episodes_to_train_batch": 0.041472634332762076, "add_time_dim_to_batch_and_zero_pad": 0.07658451113275305, "add_states_from_episodes_to_batch": 0.0040729375969891955, "batch_individual_items": 0.013321896149224792, "numpy_to_tensor": 7.582487006973395e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_env_steps_trained": 33000, "num_trainable_parameters": 24861, "num_module_steps_trained": 11970, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 155610, "num_env_steps_trained_lifetime": 429000, "num_env_steps_trained_lifetime_throughput": 3966.0205511583013, "num_module_steps_trained_throughput": 23316659.99662026, "num_module_steps_trained_lifetime_throughput": 12866189.414618885}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 933660, "num_env_steps_trained_lifetime": 2574000, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 43501.48297118635}, "default_policy": {"vf_loss_unclipped": 44.53678894042969, "module_train_batch_size_mean": 997.5020416990191, "num_module_steps_trained_lifetime": 466830, "diff_num_grad_updates_vs_sampler_policy": 66.0, "vf_loss": 0.35906851291656494, "total_loss": 0.2786772847175598, "vf_explained_var": 0.004577219486236572, "mean_kl_loss": 6.421673333534272e-06, "policy_loss": -8.519758921465836e-06, "entropy": 0.679093599319458, "weights_seq_no": 78.0, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35910}, "intrinsic_reward_module": {"weights_seq_no": 78.0, "num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.5020416990191, "num_module_steps_trained_lifetime": 466830, "diff_num_grad_updates_vs_sampler_policy": 66.0, "total_loss": 0.0}}}, "IntrinsicAttentionMask": [[[0.09352672845125198, 0.09167784452438354, 0.09176068007946014, 0.0883418470621109, 0.09210573881864548, 0.08850155025720596, 0.09209275245666504, 0.08848906308412552, 0.0922592282295227, 0.09234258532524109, 0.0889020711183548], [0.08839932084083557, 0.0901322215795517, 0.09005311131477356, 0.09343984723091125, 0.089725062251091, 0.09327589720487595, 0.08973737061023712, 0.09328868985176086, 0.08957991749048233, 0.08950129896402359, 0.09286727756261826], [0.08862811326980591, 0.09020468592643738, 0.09013277292251587, 0.0932062640786171, 0.08983451873064041, 0.09305771440267563, 0.0898457020521164, 0.09306930750608444, 0.08970251679420471, 0.08963100612163544, 0.09268738329410553], [0.07927301526069641, 0.08695739507675171, 0.08659426867961884, 0.10325264185667038, 0.08510120213031769, 0.10239208489656448, 0.08515685051679611, 0.10245904326438904, 0.08444710820913315, 0.08409446477890015, 0.10027193278074265], [0.08958223462104797, 0.09050331264734268, 0.09046144783496857, 0.09223844110965729, 0.09028765559196472, 0.09215312451124191, 0.09029418230056763, 0.09215978533029556, 0.09021066874265671, 0.09016893804073334, 0.09194018691778183], [0.07970546931028366, 0.08712086826562881, 0.08677103370428085, 0.10276488214731216, 0.08533204346895218, 0.10194123536348343, 0.08538569509983063, 0.10200533270835876, 0.08470133692026138, 0.08436121791601181, 0.09991088509559631], [0.08954627811908722, 0.09049216657876968, 0.09044916927814484, 0.0922747328877449, 0.09027068316936493, 0.0921870619058609, 0.09027738124132156, 0.09219390898942947, 0.09019161760807037, 0.09014876186847687, 0.09196826070547104], [0.07967164367437363, 0.08710812777280807, 0.08675725758075714, 0.10280294716358185, 0.08531402796506882, 0.1019764319062233, 0.0853678360581398, 0.10204074531793594, 0.08468149602413177, 0.08434039354324341, 0.09993908554315567], [0.09000714868307114, 0.09063445776700974, 0.09060598909854889, 0.09181064367294312, 0.0904877632856369, 0.09175298362970352, 0.09049221128225327, 0.09175747632980347, 0.09043537080287933, 0.09040696918964386, 0.09160897880792618], [0.09023802727460861, 0.09070523828268051, 0.09068405628204346, 0.09157902747392654, 0.09059605747461319, 0.0915362536907196, 0.09059936553239822, 0.09153959155082703, 0.0905570536851883, 0.09053590148687363, 0.09142941236495972], [0.08079219609498978, 0.08752573281526566, 0.08720938861370087, 0.10154955089092255, 0.08590683341026306, 0.10081683099269867, 0.0859554335474968, 0.10087387263774872, 0.08533523231744766, 0.085026815533638, 0.09900807589292526]], [[0.09087207913398743, 0.09086550027132034, 0.091156966984272, 0.09083813428878784, 0.09083155542612076, 0.09113715589046478, 0.09113054722547531, 0.09082600474357605, 0.09067056328058243, 0.09080574661493301, 0.09086570143699646], [0.09091322124004364, 0.09091395884752274, 0.09088138490915298, 0.09091702103614807, 0.09091775119304657, 0.09088359773159027, 0.09088433533906937, 0.09091837704181671, 0.09093580394983292, 0.09092064946889877, 0.09091393649578094], [0.08881618827581406, 0.0885012075304985, 0.10354989022016525, 0.0872039794921875, 0.08689471334218979, 0.10245207697153091, 0.10208872705698013, 0.08663460612297058, 0.07965544611215591, 0.08569234609603882, 0.08851085603237152], [0.09108100831508636, 0.09111225605010986, 0.08974157273769379, 0.09124220907688141, 0.09127350896596909, 0.08983394503593445, 0.08986476063728333, 0.09129992127418518, 0.09204310923814774, 0.09139634668827057, 0.09111129492521286], [0.0911206305027008, 0.09115922451019287, 0.08946868032217026, 0.09131982177495956, 0.09135850518941879, 0.0895824283361435, 0.08962036669254303, 0.09139116108417511, 0.09231072664260864, 0.09151037037372589, 0.09115803986787796], [0.0889764279127121, 0.08868230134248734, 0.10265921801328659, 0.08747024089097977, 0.08718109875917435, 0.10164451599121094, 0.10130851715803146, 0.08693785965442657, 0.0803922787308693, 0.08605629950761795, 0.08869131654500961], [0.08902925252914429, 0.08874210715293884, 0.10236329585313797, 0.08755853772163391, 0.08727613091468811, 0.101376011967659, 0.101049043238163, 0.087038554251194, 0.0806388258934021, 0.08617733418941498, 0.08875090628862381], [0.0911538302898407, 0.0911986380815506, 0.08923882991075516, 0.0913851261138916, 0.09143004566431046, 0.08937050402164459, 0.08941444009542465, 0.0914679691195488, 0.09253689646720886, 0.09160644561052322, 0.09119726717472076], [0.09199856221675873, 0.09221924841403961, 0.08295219391584396, 0.09314216673374176, 0.09336560219526291, 0.0835506021976471, 0.08375102281570435, 0.0935545489192009, 0.0990065485239029, 0.09424707293510437, 0.09221246838569641], [0.09127315133810043, 0.09134067595005035, 0.08840350061655045, 0.09162183105945587, 0.09168960154056549, 0.08859983086585999, 0.08866536617279053, 0.09174682945013046, 0.09336473792791367, 0.09195589274168015, 0.09133859723806381], [0.09091194719076157, 0.09091246128082275, 0.0908898264169693, 0.09091459214687347, 0.09091510623693466, 0.09089136868715286, 0.09089187532663345, 0.09091553837060928, 0.09092764556407928, 0.09091711789369583, 0.09091244637966156]], [[0.0938696339726448, 0.08833356946706772, 0.09209711104631424, 0.08866573870182037, 0.0887458547949791, 0.09252695739269257, 0.09243039786815643, 0.08881349861621857, 0.09259749203920364, 0.08897405862808228, 0.09294569492340088], [0.07684265077114105, 0.10416445136070251, 0.08453483879566193, 0.10222607851028442, 0.10176510363817215, 0.08258764445781708, 0.08302033692598343, 0.10137775540351868, 0.08227328956127167, 0.10046553611755371, 0.08074228465557098], [0.08833466470241547, 0.09320609271526337, 0.08983434736728668, 0.09289766103029251, 0.09282360970973969, 0.08946570008993149, 0.08954823017120361, 0.09276115894317627, 0.08940551429986954, 0.0926133245229721, 0.08910965919494629], [0.0778399407863617, 0.10316485166549683, 0.08502884209156036, 0.10138607025146484, 0.10096268355846405, 0.08321381360292435, 0.08361741155385971, 0.10060682147741318, 0.08292049914598465, 0.09976831078529358, 0.08149076998233795], [0.07808099687099457, 0.10292469710111618, 0.08514723926782608, 0.1011839285492897, 0.10076950490474701, 0.08336430042982101, 0.0837608277797699, 0.10042114555835724, 0.0830761045217514, 0.09960023313760757, 0.08167103677988052], [0.08967084437608719, 0.0920071229338646, 0.09039707481861115, 0.09186111390590668, 0.09182602167129517, 0.09021913260221481, 0.09025900810956955, 0.09179642051458359, 0.09019005298614502, 0.09172629565000534, 0.09004692733287811], [0.08937031030654907, 0.09227549284696579, 0.09027142822742462, 0.09209340065717697, 0.09204964339733124, 0.09005048125982285, 0.09009998291730881, 0.09201274067163467, 0.09001437574625015, 0.09192532300949097, 0.08983674645423889], [0.07828472554683685, 0.10272216796875, 0.08524700254201889, 0.10101336240768433, 0.10060647130012512, 0.08349122852087021, 0.08388175815343857, 0.10026443004608154, 0.08320736885070801, 0.09945832192897797, 0.0818231925368309], [0.0898904800415039, 0.09181143343448639, 0.09048854559659958, 0.09169164299964905, 0.09166283905506134, 0.09034208953380585, 0.0903749167919159, 0.09163855016231537, 0.09031815081834793, 0.09158099442720413, 0.09020030498504639], [0.07876883447170258, 0.10224252194166183, 0.08548292517662048, 0.10060904175043106, 0.10021993517875671, 0.08379187434911728, 0.08416813611984253, 0.09989278018474579, 0.08351835608482361, 0.0991215929389, 0.08218401670455933], [0.09097638726234436, 0.09084977209568024, 0.09093666076660156, 0.09085758030414581, 0.09085945785045624, 0.09094636142253876, 0.09094418585300446, 0.09086104482412338, 0.0909479483962059, 0.09086480736732483, 0.09095577150583267]], [[0.0927482396364212, 0.09291434288024902, 0.09308073669672012, 0.08633526414632797, 0.09377551823854446, 0.09358171373605728, 0.09374930709600449, 0.09391719847917557, 0.08365281671285629, 0.08709893375635147, 0.08914592862129211], [0.09282861649990082, 0.09300235658884048, 0.09317641705274582, 0.08613176643848419, 0.09390334039926529, 0.09370055049657822, 0.09387592226266861, 0.09405161440372467, 0.08333713561296463, 0.0869280993938446, 0.08906418830156326], [0.09290879219770432, 0.09309016913175583, 0.09327191114425659, 0.08592849224805832, 0.09403106570243835, 0.09381925314664841, 0.09400241822004318, 0.09418594092130661, 0.08302238583564758, 0.0867573469877243, 0.08898225426673889], [0.08935863524675369, 0.08923033624887466, 0.08910221606492996, 0.09465084224939346, 0.0885717123746872, 0.0887189731001854, 0.08859159052371979, 0.0884643942117691, 0.09708049893379211, 0.09398385137319565, 0.09224691241979599], [0.09323971718549728, 0.09345302730798721, 0.09366683661937714, 0.08508601784706116, 0.09456070512533188, 0.0943111851811409, 0.09452695399522781, 0.09474321454763412, 0.08172427117824554, 0.0860484316945076, 0.08863964676856995], [0.09314803034067154, 0.09335243701934814, 0.09355729073286057, 0.08532000333070755, 0.09441356360912323, 0.0941745787858963, 0.09438124299049377, 0.09458835422992706, 0.08208377659320831, 0.08624551445245743, 0.08873529732227325], [0.0932273343205452, 0.09343944489955902, 0.09365203976631165, 0.08511760830879211, 0.09454082697629929, 0.09429273009300232, 0.09450726956129074, 0.09472229331731796, 0.08177276700735092, 0.08607505261898041, 0.0886525884270668], [0.09330645203590393, 0.09352628141641617, 0.0937466248869896, 0.08491545915603638, 0.09466799348592758, 0.09441077709197998, 0.09463320672512054, 0.0948561578989029, 0.08146271109580994, 0.08590468019247055, 0.08856970071792603], [0.08776240795850754, 0.08751194924116135, 0.08726220577955246, 0.09840375185012817, 0.08623182028532028, 0.08651723712682724, 0.08627032488584518, 0.08602412045001984, 0.10349193215370178, 0.09702925384044647, 0.09349498897790909], [0.08979295194149017, 0.08969958871603012, 0.08960632234811783, 0.09361260384321213, 0.08921973407268524, 0.08932711184024811, 0.08923423290252686, 0.08914145082235336, 0.0953463613986969, 0.09313451498746872, 0.09188507497310638], [0.09091503918170929, 0.09091556072235107, 0.09091606736183167, 0.09089453518390656, 0.09091819822788239, 0.09091760963201523, 0.09091811627149582, 0.090918630361557, 0.09088550508022308, 0.09089705348014832, 0.09090370684862137]], [[0.09421996027231216, 0.08866323530673981, 0.09244082123041153, 0.08899664878845215, 0.08907705545425415, 0.08915752917528152, 0.09277535229921341, 0.0928591713309288, 0.09294306486845016, 0.08930611610412598, 0.08956103026866913], [0.07546265423297882, 0.10229378938674927, 0.08301670104265213, 0.10039022564888, 0.09993753582239151, 0.09948688000440598, 0.081529401242733, 0.0811617523431778, 0.0807957649230957, 0.09866130352020264, 0.09726391732692719], [0.08804672211408615, 0.09290226548910141, 0.08954151719808578, 0.09259483963251114, 0.09252102673053741, 0.09244726598262787, 0.08925632387399673, 0.08918517082929611, 0.08911407738924026, 0.09231142699718475, 0.09207936376333237], [0.07654200494289398, 0.10144463926553726, 0.08361104130744934, 0.09969551861286163, 0.09927919507026672, 0.0988646075129509, 0.08222313970327377, 0.08187977969646454, 0.08153785020112991, 0.09810473769903183, 0.0968175008893013], [0.07680326700210571, 0.10124041885137558, 0.08375387638807297, 0.09952814131975174, 0.09912049770355225, 0.09871453046798706, 0.08239015191793442, 0.08205270022153854, 0.0817166343331337, 0.09797035902738571, 0.0967094749212265], [0.0770651176571846, 0.10103622823953629, 0.08389663696289062, 0.09936066716909409, 0.09896168857812881, 0.09856430441141129, 0.08255717903375626, 0.08222568035125732, 0.08189550042152405, 0.09783580154180527, 0.096601203083992], [0.0891963317990303, 0.09209585934877396, 0.09009569138288498, 0.09191412478685379, 0.09187044948339462, 0.09182679653167725, 0.08992458134889603, 0.08988185226917267, 0.0898391455411911, 0.09174636751413345, 0.09160885214805603], [0.08948521316051483, 0.09189446270465851, 0.09023389965295792, 0.0917438343167305, 0.09170763194561005, 0.09167144447565079, 0.09009155631065369, 0.09005600214004517, 0.09002046287059784, 0.09160475432872772, 0.09149070829153061], [0.08977468311786652, 0.09169316291809082, 0.09037197381258011, 0.09157352894544601, 0.09154476225376129, 0.09151601046323776, 0.09025849401950836, 0.09023014456033707, 0.09020180255174637, 0.09146301448345184, 0.09137237817049026], [0.0775495320558548, 0.10065985471010208, 0.08415968716144562, 0.09905166178941727, 0.09866857528686523, 0.09828697144985199, 0.08286525309085846, 0.08254476636648178, 0.08222552388906479, 0.09758724272251129, 0.09640096873044968], [0.07838352024555206, 0.10001587122678757, 0.08460940420627594, 0.09852202981710434, 0.09816595166921616, 0.09781115502119064, 0.08339282870292664, 0.08309143036603928, 0.08279111236333847, 0.09716035425662994, 0.09605632722377777]], [[0.0914352610707283, 0.0915990099310875, 0.09176304936408997, 0.0922827273607254, 0.09244798868894577, 0.09225693345069885, 0.09242215752601624, 0.08539431542158127, 0.08941549807786942, 0.09309900552034378, 0.08788394182920456], [0.09145768731832504, 0.09162885695695877, 0.09180034697055817, 0.09234371781349182, 0.09251654148101807, 0.09231674671173096, 0.09248952567577362, 0.08515280485153198, 0.08934752643108368, 0.09319747984409332, 0.08774884790182114], [0.09147998690605164, 0.0916585847735405, 0.09183753281831741, 0.09240460395812988, 0.0925850123167038, 0.0923764631152153, 0.09255680441856384, 0.08491184562444687, 0.08927948027849197, 0.09329592436552048, 0.08761383593082428], [0.09154966473579407, 0.09175172448158264, 0.09195423126220703, 0.09259630739688873, 0.09280067682266235, 0.0925644263625145, 0.09276872128248215, 0.08415510505437851, 0.08906431496143341, 0.09360654652118683, 0.08718835562467575], [0.09157150983810425, 0.09178100526332855, 0.09199099242687225, 0.09265688061714172, 0.0928688645362854, 0.09262381494045258, 0.09283572435379028, 0.08391653746366501, 0.08899601548910141, 0.09370493143796921, 0.08705374598503113], [0.09154623746871948, 0.09174713492393494, 0.09194846451282501, 0.09258683025836945, 0.09279000759124756, 0.09255512803792953, 0.09275823831558228, 0.0841924175620079, 0.08907496929168701, 0.09359116852283478, 0.08720938116312027], [0.09156809747219086, 0.09177643805742264, 0.09198524802923203, 0.09264742583036423, 0.0928582176566124, 0.0926145389676094, 0.0928252562880516, 0.08395376056432724, 0.0890066847205162, 0.09368956089019775, 0.08707476407289505], [0.09049618244171143, 0.09037967771291733, 0.09026331454515457, 0.0898970440030098, 0.08978130668401718, 0.08991513401269913, 0.08979937434196472, 0.09506122022867203, 0.09196338802576065, 0.089328832924366, 0.09311450272798538], [0.09114622324705124, 0.09121766686439514, 0.09128916263580322, 0.0915151983499527, 0.09158693253993988, 0.09150400012731552, 0.09157571941614151, 0.08845849335193634, 0.09025901556015015, 0.0918688029050827, 0.08957871794700623], [0.0916561484336853, 0.09189487248659134, 0.09213421493768692, 0.09289373457431793, 0.09313568472862244, 0.09285599738359451, 0.09309785068035126, 0.08298640698194504, 0.08872760832309723, 0.09409067034721375, 0.08652681857347488], [0.09091082960367203, 0.09091134369373322, 0.0909118503332138, 0.09091347455978394, 0.09091398119926453, 0.09091339260339737, 0.09091390669345856, 0.0908912643790245, 0.09090443700551987, 0.0909159928560257, 0.09089948982000351]]], "default_policy": {"vf_explained_var": 0.0026803016662597656, "curr_entropy_coeff": 0.0015431216992, "num_trainable_parameters": 16595, "curr_kl_coeff": 1.9724600861081854e-05, "policy_loss": -9.295058589486871e-06, "entropy": 0.6790979504585266, "module_train_batch_size_mean": 997.7269395717314, "weights_seq_no": 13.0, "use_intrinsic_rewards": 0.0, "num_module_steps_trained": 5985, "vf_loss_unclipped": 44.73887634277344, "num_module_steps_trained_lifetime": 77805, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.27808845043182373, "vf_loss": 0.35831502079963684, "mean_kl_loss": 6.319293333945097e-06, "num_module_steps_trained_lifetime_throughput": 719.063717999252}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 77805, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_trainable_parameters": 8266, "weights_seq_no": 13.0, "num_module_steps_trained": 5985, "module_train_batch_size_mean": 997.7269395717314, "num_module_steps_trained_lifetime_throughput": 719.0722823738392}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 1.6}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.123744999917208e-06, "tensor_to_numpy": 1.6942379404696335e-05, "un_batch_to_individual_items": 7.058904787888253e-06, "remove_single_ts_time_rank_from_batch": 1.339458802612194e-05, "listify_data_for_vector_env": 1.1515423690710143e-05, "get_actions": 4.38896769957999e-05}}, "connector_pipeline_timer": 0.0001319466903834017}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.0533553443244874e-06, "numpy_to_tensor": 1.4413924425479298e-05, "add_states_from_episodes_to_batch": 3.1368475767286884e-06, "batch_individual_items": 1.369489276872117e-05, "add_time_dim_to_batch_and_zero_pad": 8.134954438422964e-06}}, "connector_pipeline_timer": 6.747590611879572e-05}, "num_agent_steps_sampled": {"default_agent": 400}, "rlmodule_inference_timer": 3.6262914896430485e-05, "episode_duration_sec_mean": 0.006354759156238288, "num_env_steps_sampled_lifetime": 65400, "episode_len_mean": 20.0, "num_episodes_lifetime": 260, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "num_episodes": 20, "env_step_timer": 1.6384960748858566e-05, "weights_seq_no": 13.0, "episode_return_min": -13.5, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.6, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "agent_episode_returns_mean": {"default_agent": 1.6}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "episode_len_max": 20, "env_reset_timer": 0.0006093380246719813, "episode_return_max": 13.5, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "sample": 0.12005317361439889, "time_between_sampling": 9.667853352387496}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "b4968_00000", "date": "2025-08-11_18-17-13", "timestamp": 1754929033, "time_this_iter_s": 10.649027109146118, "time_total_s": 137.6120367050171, "pid": 10564, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x141ef98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 137.6120367050171, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 47.70625, "ram_util_percent": 80.675}}
{"timers": {"training_iteration": 10.574355457636898, "restore_env_runners": 1.2854059574562903e-05, "training_step": 10.574102352630016, "env_runner_sampling_timer": 1.6680537830162492, "learner_update_timer": 8.719780270873743, "synch_weights": 0.0018400825538548479, "restore_eval_env_runners": 5.968792369619041e-05, "evaluation_iteration": 0.13256867517094018, "synch_eval_env_connectors": 0.0002645163518967552, "synch_env_connectors": 5.418239716273854e-06}, "env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.235117656857419e-06, "numpy_to_tensor": 1.335453296344671e-05, "add_states_from_episodes_to_batch": 2.7917693576196027e-06, "batch_individual_items": 1.2811281628485548e-05, "add_observations_from_episodes_to_batch": 2.9413524408462352e-06}}, "connector_pipeline_timer": 6.16143474206568e-05}, "num_env_steps_sampled_lifetime": -7400000.0, "episode_return_mean": -2.3000000000000007, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": -2.3000000000000007}, "module_episode_returns_mean": {"default_policy": -2.3000000000000007}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.005893776093059264, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.606568592709883e-05, "remove_single_ts_time_rank_from_batch": 1.2441421640468872e-05, "normalize_and_clip_actions": 8.400930163444241e-06, "get_actions": 4.2924146714288455e-05, "listify_data_for_vector_env": 1.1111828793411846e-05, "un_batch_to_individual_items": 6.847339097209191e-06}}, "connector_pipeline_timer": 0.0001249026653983628}, "time_between_sampling": 0.037032789260665805, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 6.5, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "episode_len_mean": 20.0, "num_episodes": 250.0, "num_episodes_lifetime": -370000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "rlmodule_inference_timer": 3.3988718384017983e-05, "episode_duration_sec_mean": 0.0055411963532678785, "weights_seq_no": 13.0, "env_step_timer": 1.4691638482411055e-05, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "env_reset_timer": 4.8027183769162776e-05, "num_env_steps_sampled_lifetime_throughput": 3099.106638616769}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.14688544802293738, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00897029037544019, "add_observations_from_episodes_to_batch": 0.0009096747919968195, "add_columns_from_episodes_to_train_batch": 0.04147876465967812, "add_time_dim_to_batch_and_zero_pad": 0.0765704501917048, "add_states_from_episodes_to_batch": 0.004068698220639547, "batch_individual_items": 0.01461931843748608, "numpy_to_tensor": 7.600079146242396e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_env_steps_trained": 33000, "num_trainable_parameters": 24861, "num_module_steps_trained": 11970, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 167580, "num_env_steps_trained_lifetime": 462000, "num_env_steps_trained_lifetime_throughput": 3948.6590194492064, "num_module_steps_trained_throughput": 22701676.42360668, "num_module_steps_trained_lifetime_throughput": 12791179.110988926}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1005480, "num_env_steps_trained_lifetime": 2772000, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 42872.95302811133}, "default_policy": {"vf_loss_unclipped": 41.797550201416016, "module_train_batch_size_mean": 997.5006590853257, "num_module_steps_trained_lifetime": 502740, "diff_num_grad_updates_vs_sampler_policy": 71.0, "vf_loss": 0.3589879870414734, "total_loss": 0.27801480889320374, "vf_explained_var": 0.004810452461242676, "mean_kl_loss": 3.223562816856429e-05, "policy_loss": -0.0006141386111266911, "entropy": 0.6779754161834717, "weights_seq_no": 84.0, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35910}, "intrinsic_reward_module": {"weights_seq_no": 84.0, "num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.5006590853257, "num_module_steps_trained_lifetime": 502740, "diff_num_grad_updates_vs_sampler_policy": 71.0, "total_loss": 0.0}}}, "IntrinsicAttentionMask": [[[0.0938696414232254, 0.08833357691764832, 0.08841338008642197, 0.08866574615240097, 0.09244344383478165, 0.09252696484327316, 0.09243040531873703, 0.09251391142606735, 0.08889374881982803, 0.0926811620593071, 0.08922802656888962], [0.07684194296598434, 0.10416349768638611, 0.10369379073381424, 0.10222513973712921, 0.08296098560094833, 0.08258688449859619, 0.08301957696676254, 0.08264521509408951, 0.1009196862578392, 0.08190154284238815, 0.09904169291257858], [0.07708125561475754, 0.10392283648252487, 0.10346255451440811, 0.10202310979366302, 0.08310577273368835, 0.08273768424987793, 0.08316342532634735, 0.08279508352279663, 0.10074331611394882, 0.08206328004598618, 0.09890171885490417], [0.07783936709165573, 0.10316409915685654, 0.10273329168558121, 0.10138533264398575, 0.08356215059757233, 0.0832132026553154, 0.08361680060625076, 0.08326762169599533, 0.10018595308065414, 0.08257362991571426, 0.09845853596925735], [0.08941088616847992, 0.09223921597003937, 0.09219654649496078, 0.09206201136112213, 0.09011495858430862, 0.09007328003644943, 0.09012147784233093, 0.09007979184389114, 0.09194096177816391, 0.08999647200107574, 0.09176433086395264], [0.08967084437608719, 0.0920071229338646, 0.0919719710946083, 0.09186111390590668, 0.09025362133979797, 0.09021913260221481, 0.09025900810956955, 0.09022451937198639, 0.09176135063171387, 0.09015559405088425, 0.09161573648452759], [0.08937031775712967, 0.09227550029754639, 0.09223165363073349, 0.09209340810775757, 0.09009329229593277, 0.09005048871040344, 0.0900999903678894, 0.09005717933177948, 0.09196902811527252, 0.08997160941362381, 0.09178753942251205], [0.08963020890951157, 0.09204336255788803, 0.09200704097747803, 0.09189248830080032, 0.09023196995258331, 0.09019635617733002, 0.09023753553628922, 0.09020192176103592, 0.09178940951824188, 0.0901307463645935, 0.0916389524936676], [0.0785260945558548, 0.1024816483259201, 0.10207707434892654, 0.10081058740615845, 0.08397258073091507, 0.08364107459783554, 0.08402448892593384, 0.0836927741765976, 0.09968294203281403, 0.08303327858448029, 0.09805751591920853], [0.09015114605426788, 0.09157972037792206, 0.09155833721160889, 0.09149085730314255, 0.0905088409781456, 0.09048769623041153, 0.09051214158535004, 0.09049100428819656, 0.09143010526895523, 0.09044874459505081, 0.09134139120578766], [0.07953589409589767, 0.10148628801107407, 0.1011194959282875, 0.09997048228979111, 0.0845710039138794, 0.0842653438448906, 0.08461885154247284, 0.08431302011013031, 0.09894639998674393, 0.08370467275381088, 0.0974685400724411]], [[0.09593284130096436, 0.08806494623422623, 0.09557811915874481, 0.08738961070775986, 0.09484517574310303, 0.08741489797830582, 0.0948726162314415, 0.08709167689085007, 0.0902920812368393, 0.08659655600786209, 0.09192144870758057], [0.08596564084291458, 0.09372223168611526, 0.0862877294421196, 0.09445342421531677, 0.08696091175079346, 0.09442583471536636, 0.08693552017211914, 0.0947796180844307, 0.09138878434896469, 0.09532669186592102, 0.08975358307361603], [0.09549107402563095, 0.08831438422203064, 0.09516865760087967, 0.08769584447145462, 0.09450210630893707, 0.08771901577711105, 0.09452707320451736, 0.08742283284664154, 0.09035131335258484, 0.08696895092725754, 0.0918387621641159], [0.08509477227926254, 0.09421908855438232, 0.08547081053256989, 0.09508638828992844, 0.08625757694244385, 0.09505364298820496, 0.08622787147760391, 0.09547369182109833, 0.09145940840244293, 0.09612379223108292, 0.0895330086350441], [0.09457585960626602, 0.08883156627416611, 0.0943196639418602, 0.08833224326372147, 0.0937894955277443, 0.08835095912218094, 0.09380936622619629, 0.08811162412166595, 0.09047102928161621, 0.08774455636739731, 0.09166362136602402], [0.08512741327285767, 0.09420045465230942, 0.08550144731998444, 0.09506260603666306, 0.08628398180007935, 0.0950300544500351, 0.08625444024801254, 0.0954475924372673, 0.0914568305015564, 0.0960937961935997, 0.08954136073589325], [0.09461018443107605, 0.08881215006113052, 0.09435152262449265, 0.08830831199884415, 0.09381626546382904, 0.08832719922065735, 0.09383632987737656, 0.08808572590351105, 0.09046661108732224, 0.08771536499261856, 0.09167028218507767], [0.08470986783504486, 0.09443879127502441, 0.08510947972536087, 0.09536696970462799, 0.0859459638595581, 0.09533191472291946, 0.08591438084840775, 0.09578164666891098, 0.09148924797773361, 0.0964779406785965, 0.08943384885787964], [0.08882135152816772, 0.09209557622671127, 0.08896064758300781, 0.09239597618579865, 0.0892508253455162, 0.09238467365503311, 0.08923990279436111, 0.09252955764532089, 0.09112770110368729, 0.09275298565626144, 0.09044086188077927], [0.08406925946474075, 0.09480457752943039, 0.0845077633857727, 0.09583506733179092, 0.08542633056640625, 0.0957961305975914, 0.08539162576198578, 0.0962957963347435, 0.09153702110052109, 0.09706989675760269, 0.08926654607057571], [0.09089399874210358, 0.0909176617860794, 0.09089502692222595, 0.09091979265213013, 0.09089715778827667, 0.09091971069574356, 0.0908970758318901, 0.09092073142528534, 0.09091075509786606, 0.09092231094837189, 0.0909058079123497]], [[0.09352444112300873, 0.09167560189962387, 0.08808824419975281, 0.09202034771442413, 0.08841949701309204, 0.09218670427799225, 0.09209049493074417, 0.08848690241575241, 0.09225697815418243, 0.08864686638116837, 0.092603899538517], [0.08839725703001022, 0.09013012051582336, 0.09369698166847229, 0.08980178833007812, 0.09335566312074661, 0.08964423090219498, 0.08973528444766998, 0.09328652173280716, 0.08957783877849579, 0.09312283992767334, 0.08925152570009232], [0.07854533940553665, 0.08664491027593613, 0.10542771220207214, 0.08506102859973907, 0.10350047796964645, 0.08430920541286469, 0.08474302291870117, 0.10311353206634521, 0.08399401605129242, 0.1022021472454071, 0.08245858550071716], [0.08935139328241348, 0.09043103456497192, 0.09262871742248535, 0.09022708982229233, 0.0924198180437088, 0.09012910723686218, 0.0901857316493988, 0.09237746149301529, 0.09008780866861343, 0.0922771468758583, 0.08988463878631592], [0.07944781333208084, 0.08699405193328857, 0.10429747402667999, 0.08552271872758865, 0.1025334894657135, 0.0848236009478569, 0.08522706478834152, 0.10217902809381485, 0.08453036099672318, 0.10134374350309372, 0.08310069888830185], [0.08981217443943024, 0.09057414531707764, 0.09211692959070206, 0.09043041616678238, 0.09197074919939041, 0.0903613343834877, 0.09040126204490662, 0.09194109588861465, 0.09033220261335373, 0.09187086671590805, 0.09018885344266891], [0.08954567462205887, 0.09049154818058014, 0.09241262078285217, 0.09031298011541367, 0.09223026037216187, 0.0902271717786789, 0.09027677029371262, 0.09219327569007874, 0.09019099920988083, 0.0921056941151619, 0.09001302719116211], [0.07963165640830994, 0.08706441521644592, 0.10406866669654846, 0.0856160819530487, 0.10233745723962784, 0.08492773771286011, 0.08532499521970749, 0.10198952257633209, 0.08463899046182632, 0.10116954147815704, 0.08323100209236145], [0.09000687301158905, 0.09063418209552765, 0.09190144389867783, 0.09051592648029327, 0.09178152680397034, 0.09045907855033875, 0.09049193561077118, 0.09175720810890198, 0.09043510258197784, 0.09169957786798477, 0.09031710028648376], [0.08006824553012848, 0.08723045885562897, 0.10352721065282822, 0.08583682030439377, 0.10187321156263351, 0.08517414331436157, 0.08555661886930466, 0.10154065489768982, 0.08489610999822617, 0.10075674951076508, 0.08353976905345917], [0.09096865355968475, 0.09092704951763153, 0.09084393084049225, 0.0909348651766777, 0.09085173904895782, 0.09093862771987915, 0.09093645960092545, 0.09085332602262497, 0.09094022214412689, 0.09085708111524582, 0.09094803780317307]], [[0.09274925291538239, 0.0929153561592102, 0.0930817499756813, 0.09360890090465546, 0.09377653896808624, 0.09358274191617966, 0.08646664768457413, 0.09391822665929794, 0.08365374058485031, 0.08709988743066788, 0.08914690464735031], [0.09282973408699036, 0.09300347417593002, 0.09317753463983536, 0.09372904896736145, 0.09390447288751602, 0.09370167553424835, 0.08626880496740341, 0.0940527468919754, 0.08333813399076462, 0.08692914992570877, 0.08906525373458862], [0.09290999919176102, 0.09309137612581253, 0.0932731181383133, 0.0938490629196167, 0.09403228759765625, 0.0938204750418663, 0.08607114106416702, 0.0941871628165245, 0.08302346616983414, 0.08675847202539444, 0.08898340910673141], [0.09316197782754898, 0.09336759150028229, 0.093573659658432, 0.09422705322504044, 0.09443502128124237, 0.09419460594654083, 0.08544859290122986, 0.09461085498332977, 0.08203649520874023, 0.08622030913829803, 0.08872386068105698], [0.0932413786649704, 0.09345469623804092, 0.09366850554943085, 0.0943465456366539, 0.09456239640712738, 0.0943128690123558, 0.08525176346302032, 0.09474490582942963, 0.08172573149204254, 0.08604996651411057, 0.08864123374223709], [0.09314955025911331, 0.09335396438837051, 0.09355882555246353, 0.09420836716890335, 0.0944151058793068, 0.09417612105607986, 0.08547936379909515, 0.09458990395069122, 0.08208511769771576, 0.08624693006277084, 0.08873675018548965], [0.08943402767181396, 0.08931168913841248, 0.08918951451778412, 0.08880502730607986, 0.08868354558944702, 0.08882401883602142, 0.09436412900686264, 0.08858117461204529, 0.0967821553349495, 0.09383884072303772, 0.09218589216470718], [0.093308225274086, 0.09352805465459824, 0.09374839812517166, 0.09444727748632431, 0.09466978907585144, 0.09441256523132324, 0.08508584648370743, 0.09485795348882675, 0.0814642533659935, 0.08590631186962128, 0.08857137709856033], [0.0877649337053299, 0.0875144675374031, 0.08726471662521362, 0.08648110181093216, 0.08623429387807846, 0.08651971817016602, 0.09816955775022507, 0.08602659404277802, 0.10349489003419876, 0.09703203290700912, 0.09349767118692398], [0.08979329466819763, 0.08969993144273758, 0.08960666507482529, 0.08931293338537216, 0.0892200767993927, 0.08932745456695557, 0.09353083372116089, 0.08914179354906082, 0.09534672647714615, 0.09313487261533737, 0.09188543260097504], [0.09091503918170929, 0.09091556072235107, 0.09091606736183167, 0.0909176841378212, 0.09091819822788239, 0.09091760963201523, 0.09089496731758118, 0.090918630361557, 0.09088550508022308, 0.09089705348014832, 0.09090370684862137]], [[0.10206834971904755, 0.08993854373693466, 0.08969259262084961, 0.0889207273721695, 0.08867756277322769, 0.08843506127595901, 0.08871550112962723, 0.08847290277481079, 0.09985664486885071, 0.0879896804690361, 0.08723247051239014], [0.08714970201253891, 0.09120162576436996, 0.09129137545824051, 0.0915752425789833, 0.0916653648018837, 0.09175557643175125, 0.09165128320455551, 0.09174147248268127, 0.08783820271492004, 0.09192213416099548, 0.09220796078443527], [0.08684752881526947, 0.0912243202328682, 0.0913214460015297, 0.09162870794534683, 0.09172626584768295, 0.09182393550872803, 0.09171102195978165, 0.09180866926908493, 0.08759007602930069, 0.09200428426265717, 0.09231383353471756], [0.08589942008256912, 0.09129463136196136, 0.09141508489847183, 0.09179628640413284, 0.09191740304231644, 0.09203866869211197, 0.09189847111701965, 0.0920197144150734, 0.08681026846170425, 0.09226268529891968, 0.09264742583036423], [0.08560079336166382, 0.09131650626659393, 0.09144435077905655, 0.09184902906417847, 0.09197761863470078, 0.09210638701915741, 0.09195751696825027, 0.09208626300096512, 0.08656425029039383, 0.09234428405761719, 0.09275294840335846], [0.08530303835868835, 0.09133820235729218, 0.09147344529628754, 0.09190161526203156, 0.09203769266605377, 0.0921739712357521, 0.09201642125844955, 0.0921526700258255, 0.08631875365972519, 0.09242577105760574, 0.09285840392112732], [0.08564738184213638, 0.09131309390068054, 0.09143979102373123, 0.09184079617261887, 0.09196821600198746, 0.09209581464529037, 0.09194830060005188, 0.092075876891613, 0.08660264313220978, 0.09233154356479645, 0.09273646771907806], [0.08534949272871017, 0.09133481979370117, 0.09146890044212341, 0.09189340472221375, 0.09202831983566284, 0.09216342121362686, 0.09200722724199295, 0.09214229881763458, 0.08635706454515457, 0.0924130529165268, 0.09284193068742752], [0.0993487760424614, 0.09018803387880325, 0.08999938517808914, 0.0894065648317337, 0.08921954780817032, 0.08903293311595917, 0.08924873173236847, 0.08906205743551254, 0.09769843518733978, 0.08868986368179321, 0.08810567110776901], [0.0847562700510025, 0.09137769788503647, 0.0915265902876854, 0.0919981300830841, 0.09214803576469421, 0.09229818731546402, 0.09212460368871689, 0.09227471798658371, 0.08586744964122772, 0.09257567673921585, 0.09305262565612793], [0.08382702618837357, 0.09144379943609238, 0.09161609411239624, 0.09216202795505524, 0.09233567863702774, 0.09250964969396591, 0.09230852872133255, 0.09248245507478714, 0.08509894460439682, 0.09283129125833511, 0.09338446706533432]], [[0.09343625605106354, 0.086331307888031, 0.08648591488599777, 0.08697570115327835, 0.09447114914655685, 0.09427591413259506, 0.09444475173950195, 0.08726311475038528, 0.0913722962141037, 0.09513641148805618, 0.08980721980333328], [0.08834723383188248, 0.09554367512464523, 0.09537455439567566, 0.09484273940324783, 0.08738890290260315, 0.08756809681653976, 0.08741308748722076, 0.09453343600034714, 0.09032300114631653, 0.08678381890058517, 0.09188143163919449], [0.08846490830183029, 0.0953308641910553, 0.0951697826385498, 0.09466318041086197, 0.08754871040582657, 0.08772005885839462, 0.08757183700799942, 0.09436848014593124, 0.09035239368677139, 0.08696998655796051, 0.09183986485004425], [0.08883557468652725, 0.09466041624546051, 0.09452451020479202, 0.09409681707620621, 0.08805326372385025, 0.0881996676325798, 0.08807303011417389, 0.0938478633761406, 0.09044341742992401, 0.08755847811698914, 0.09170694649219513], [0.09412495791912079, 0.08508190512657166, 0.08527655899524689, 0.08589384704828262, 0.0954584851861, 0.0952065959572792, 0.09542441368103027, 0.08625652641057968, 0.0914776399731636, 0.09631786495447159, 0.08948121964931488], [0.09399601817131042, 0.08531589806079865, 0.08550311625003815, 0.08609673380851746, 0.09527307748794556, 0.09503190964460373, 0.09524045884609222, 0.0864454135298729, 0.09145861864089966, 0.09609567373991013, 0.08954311907291412], [0.09410754591226578, 0.08511349558830261, 0.08530715107917786, 0.08592125028371811, 0.09543342888355255, 0.09518299251794815, 0.09539955854415894, 0.08628202974796295, 0.09147508442401886, 0.09628783166408539, 0.08948959410190582], [0.08905161172151566, 0.09426964819431305, 0.09414827823638916, 0.0937662422657013, 0.0883481502532959, 0.08847984671592712, 0.08836592733860016, 0.09354378283023834, 0.09049540013074875, 0.08790289610624313, 0.09162814170122147], [0.09202367812395096, 0.08889119327068329, 0.08896087110042572, 0.08918114751577377, 0.09246862679719925, 0.09238490462303162, 0.09245731681585312, 0.08931007236242294, 0.09112793207168579, 0.09275321662425995, 0.09044108539819717], [0.0945608839392662, 0.08429054170846939, 0.08451007306575775, 0.08520673960447311, 0.09608730673789978, 0.09579875320196152, 0.0960482731461525, 0.08561637997627258, 0.09153953194618225, 0.0970725566148758, 0.0892689973115921], [0.09091714769601822, 0.09089450538158417, 0.09089501947164536, 0.09089663624763489, 0.09092029184103012, 0.09091970324516296, 0.09092021733522415, 0.0908975824713707, 0.09091074764728546, 0.09092230349779129, 0.0909058004617691]]], "default_policy": {"vf_explained_var": 0.004833877086639404, "curr_entropy_coeff": 0.0015431216992, "num_trainable_parameters": 16595, "curr_kl_coeff": 9.862300430540927e-06, "policy_loss": -0.00063841458177194, "entropy": 0.6779211759567261, "module_train_batch_size_mean": 997.7135120670981, "weights_seq_no": 14.0, "use_intrinsic_rewards": 0.0, "num_module_steps_trained": 5985, "vf_loss_unclipped": 41.75376892089844, "num_module_steps_trained_lifetime": 83790, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.2774619162082672, "vf_loss": 0.35831600427627563, "mean_kl_loss": 3.482106330920942e-05, "num_module_steps_trained_lifetime_throughput": 715.9239998680864}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 83790, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_trainable_parameters": 8266, "weights_seq_no": 14.0, "num_module_steps_trained": 5985, "module_train_batch_size_mean": 997.7135120670981, "num_module_steps_trained_lifetime_throughput": 715.9320593273843}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 1.4}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.564138327143392e-06, "tensor_to_numpy": 1.8992830341122595e-05, "un_batch_to_individual_items": 7.693646581354922e-06, "remove_single_ts_time_rank_from_batch": 1.38147982613634e-05, "listify_data_for_vector_env": 1.221401507478502e-05, "get_actions": 4.9266247128419764e-05}}, "connector_pipeline_timer": 0.0001424589427721833}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.2304237290866854e-06, "numpy_to_tensor": 1.58209880497591e-05, "add_states_from_episodes_to_batch": 3.1860989377941363e-06, "batch_individual_items": 1.5250402221242637e-05, "add_time_dim_to_batch_and_zero_pad": 8.08079478822183e-06}}, "connector_pipeline_timer": 7.126005805174472e-05}, "num_agent_steps_sampled": {"default_agent": 400}, "rlmodule_inference_timer": 4.053826977807115e-05, "episode_duration_sec_mean": 0.0066216179018374535, "num_env_steps_sampled_lifetime": 70400, "episode_len_mean": 20.0, "num_episodes_lifetime": 280, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "num_episodes": 20, "env_step_timer": 1.8242877273642425e-05, "weights_seq_no": 14.0, "episode_return_min": -13.5, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.4, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "agent_episode_returns_mean": {"default_agent": 1.4}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "episode_len_max": 20, "env_reset_timer": 0.0006066008946610723, "episode_return_max": 13.5, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "sample": 0.1203441793786606, "time_between_sampling": 9.673110603453354}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "b4968_00000", "date": "2025-08-11_18-17-23", "timestamp": 1754929043, "time_this_iter_s": 10.31803584098816, "time_total_s": 147.93007254600525, "pid": 10564, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x141ef98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 147.93007254600525, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 43.68571428571429, "ram_util_percent": 81.01428571428572}}
{"timers": {"training_iteration": 10.575539969730027, "restore_env_runners": 1.2886769333539416e-05, "training_step": 10.57528683951277, "env_runner_sampling_timer": 1.667367556856161, "learner_update_timer": 8.721664819415112, "synch_weights": 0.0018370729782244337, "restore_eval_env_runners": 5.9763544341285815e-05, "evaluation_iteration": 0.1328381388389745, "synch_eval_env_connectors": 0.0002637599384987851, "synch_env_connectors": 5.422807475424297e-06}, "env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.213505959450288e-06, "numpy_to_tensor": 1.3143718436988053e-05, "add_states_from_episodes_to_batch": 2.8391805992832816e-06, "batch_individual_items": 1.2970379980621638e-05, "add_observations_from_episodes_to_batch": 2.918749106693785e-06}}, "connector_pipeline_timer": 6.147796769719478e-05}, "num_env_steps_sampled_lifetime": -8017500.0, "episode_return_mean": -2.1399999999999997, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": -2.1399999999999997}, "module_episode_returns_mean": {"default_policy": -2.1399999999999997}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.005921430841449995, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5992367707870397e-05, "remove_single_ts_time_rank_from_batch": 1.2250269883588156e-05, "normalize_and_clip_actions": 8.221605367830647e-06, "get_actions": 4.229291908851421e-05, "listify_data_for_vector_env": 1.0896398889381e-05, "un_batch_to_individual_items": 6.8036135410378745e-06}}, "connector_pipeline_timer": 0.00012328666715978983}, "time_between_sampling": 0.03555068675708692, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 6.5, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "episode_len_mean": 20.0, "num_episodes": 250.0, "num_episodes_lifetime": -400875.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "rlmodule_inference_timer": 3.352367976891066e-05, "episode_duration_sec_mean": 0.0054828504910692565, "weights_seq_no": 14.0, "env_step_timer": 1.453027422561103e-05, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "env_reset_timer": 4.7614252085332916e-05, "num_env_steps_sampled_lifetime_throughput": 3159.1140848843547}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.14677264229316628, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008968544971467412, "add_observations_from_episodes_to_batch": 0.0009087747141732189, "add_columns_from_episodes_to_train_batch": 0.04147780534342865, "add_time_dim_to_batch_and_zero_pad": 0.07656825194001089, "add_states_from_episodes_to_batch": 0.004064689567776128, "batch_individual_items": 0.014516813172498814, "numpy_to_tensor": 7.621787364203825e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_env_steps_trained": 33000, "num_trainable_parameters": 24861, "num_module_steps_trained": 11970, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 179550, "num_env_steps_trained_lifetime": 495000, "num_env_steps_trained_lifetime_throughput": 3934.6117414900664, "num_module_steps_trained_throughput": 22148354.87567626, "num_module_steps_trained_lifetime_throughput": 12749320.428942947}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1077300, "num_env_steps_trained_lifetime": 2970000, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 42253.32137854924}, "default_policy": {"vf_loss_unclipped": 44.31621170043945, "module_train_batch_size_mean": 997.4996962148737, "num_module_steps_trained_lifetime": 538650, "diff_num_grad_updates_vs_sampler_policy": 76.0, "vf_loss": 0.35898372530937195, "total_loss": 0.2786036431789398, "vf_explained_var": 0.004657864570617676, "mean_kl_loss": 2.191657522132573e-08, "policy_loss": -1.7274669517064467e-05, "entropy": 0.6776708960533142, "weights_seq_no": 90.0, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35910}, "intrinsic_reward_module": {"weights_seq_no": 90.0, "num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.4996962148737, "num_module_steps_trained_lifetime": 538650, "diff_num_grad_updates_vs_sampler_policy": 76.0, "total_loss": 0.0}}}, "IntrinsicAttentionMask": [[[0.09972192347049713, 0.08787096291780472, 0.09917726367712021, 0.08687654882669449, 0.098054900765419, 0.09778675436973572, 0.08667603880167007, 0.08643902093172073, 0.08620263636112213, 0.08596690744161606, 0.0852271020412445], [0.08784836530685425, 0.09193277359008789, 0.08802135288715363, 0.0923093855381012, 0.08838194608688354, 0.08846892416477203, 0.09238603711128235, 0.09247694909572601, 0.09256796538829803, 0.09265906363725662, 0.09294717758893967], [0.0991920456290245, 0.08805712312459946, 0.09868207573890686, 0.08711892366409302, 0.09763067215681076, 0.09737937152385712, 0.08692967891693115, 0.08670593053102493, 0.08648274838924408, 0.08626014739274979, 0.08556132018566132], [0.08681978285312653, 0.0922728031873703, 0.08704902231693268, 0.09277983009815216, 0.08752734214067459, 0.08764282613992691, 0.09288311004638672, 0.09300564974546432, 0.09312836080789566, 0.09325122833251953, 0.09364008903503418], [0.09809529036283493, 0.08844110369682312, 0.09765633195638657, 0.08762066066265106, 0.0967504009604454, 0.09653369337320328, 0.08745502680540085, 0.08725913614034653, 0.08706367760896683, 0.08686866611242294, 0.08625601977109909], [0.09783229976892471, 0.08853290230035782, 0.09741020947694778, 0.08774098753929138, 0.09653888642787933, 0.09633040428161621, 0.0875810757279396, 0.0873919427394867, 0.08720321208238602, 0.08701489865779877, 0.08642318844795227], [0.0866117924451828, 0.09234129637479782, 0.0868522897362709, 0.09287494421005249, 0.08735421299934387, 0.08747540414333344, 0.0929836556315422, 0.09311266243457794, 0.093241848051548, 0.09337121248245239, 0.09378069639205933], [0.08636565506458282, 0.0924222469329834, 0.08661942929029465, 0.09298748522996902, 0.08714918047189713, 0.0872771218419075, 0.09310265630483627, 0.09323933720588684, 0.09337622672319412, 0.09351330995559692, 0.09394729882478714], [0.08611993491649628, 0.09250294417142868, 0.08638690412044525, 0.09309984743595123, 0.0869443342089653, 0.0870789885520935, 0.09322149306535721, 0.093365877866745, 0.0935104712843895, 0.0936553031206131, 0.09411387890577316], [0.08587460964918137, 0.09258339554071426, 0.08615469932556152, 0.09321201592683792, 0.0867396742105484, 0.08688101172447205, 0.09334015846252441, 0.09349226206541061, 0.09364459663629532, 0.09379718452692032, 0.0942804291844368], [0.08510292321443558, 0.09283562749624252, 0.08542392402887344, 0.09356479346752167, 0.08609487116336823, 0.08625709265470505, 0.09371352195739746, 0.09389009326696396, 0.09406699985265732, 0.09424424171447754, 0.09480583667755127]], [[0.10166295617818832, 0.08563344925642014, 0.10091061890125275, 0.0843217745423317, 0.09936493635177612, 0.09979254007339478, 0.09942260384559631, 0.08374634385108948, 0.07670712471008301, 0.08279441297054291, 0.0856432169675827], [0.09088596701622009, 0.09092001616954803, 0.09088744223117828, 0.09092307835817337, 0.09089050441980362, 0.09088965505361557, 0.09089039266109467, 0.09092443436384201, 0.09094186127185822, 0.09092670679092407, 0.09091998636722565], [0.10119088739156723, 0.08587267994880676, 0.10047440975904465, 0.08461398631334305, 0.0990016981959343, 0.09940920770168304, 0.0990566536784172, 0.08406153321266174, 0.0772896558046341, 0.08314725011587143, 0.08588205277919769], [0.08993230015039444, 0.09136853367090225, 0.08999400585889816, 0.09149885922670364, 0.09012236446142197, 0.09008663892745972, 0.09011753648519516, 0.09155672788619995, 0.09230200946331024, 0.09165343642234802, 0.09136757254600525], [0.10021119564771652, 0.08636707812547684, 0.09956831485033035, 0.08521964401006699, 0.09824550151824951, 0.09861171990633011, 0.09829489886760712, 0.08471550792455673, 0.07850994914770126, 0.08388052880764008, 0.08637560158967972], [0.10048355162143707, 0.08622992038726807, 0.0998203307390213, 0.08505138009786606, 0.09845604002475739, 0.09883368760347366, 0.09850697964429855, 0.08453372120857239, 0.07816915214061737, 0.0836765319108963, 0.08623868227005005], [0.10024799406528473, 0.08634857088327408, 0.09960237145423889, 0.08519692718982697, 0.09827396273612976, 0.09864172339439392, 0.09832356870174408, 0.08469096571207047, 0.0784638449549675, 0.08385296911001205, 0.08635713160037994], [0.0895102247595787, 0.09156595170497894, 0.08959825336933136, 0.09175318479537964, 0.08978145569562912, 0.08973045647144318, 0.08977457135915756, 0.0918363705277443, 0.09290959686040878, 0.09197539836168289, 0.09156457334756851], [0.084156833589077, 0.09400784224271774, 0.0845610722899437, 0.0949486643075943, 0.08540734648704529, 0.08517107367515564, 0.08537539094686508, 0.09536904096603394, 0.10092677175998688, 0.09607499837875366, 0.0940009355545044], [0.08880697190761566, 0.09189335256814957, 0.088938407599926, 0.09217619895935059, 0.08921216428279877, 0.08913592994213104, 0.08920186758041382, 0.09230195730924606, 0.09392965584993362, 0.09251228719949722, 0.09189125895500183], [0.09089301526546478, 0.09091667085886002, 0.09089404344558716, 0.09091880172491074, 0.09089616686105728, 0.09089557081460953, 0.09089609235525131, 0.09091974794864655, 0.09093185514211655, 0.0909213274717331, 0.09091665595769882]], [[0.0974883958697319, 0.09722179919481277, 0.09695593267679214, 0.09612156450748444, 0.08469847589731216, 0.084466852247715, 0.084734708070755, 0.08450299501419067, 0.09537593275308609, 0.09511511772871017, 0.08331821858882904], [0.09729436784982681, 0.09703611582517624, 0.09677855670452118, 0.09597011655569077, 0.08488036692142487, 0.08465506881475449, 0.08491561561822891, 0.08469022065401077, 0.09524747729301453, 0.09499466419219971, 0.0835375115275383], [0.09710033982992172, 0.09685041010379791, 0.09660112112760544, 0.09581851959228516, 0.08506229519844055, 0.08484335243701935, 0.08509655296802521, 0.08487752079963684, 0.09511881321668625, 0.09487398713827133, 0.08375705778598785], [0.0964880883693695, 0.09626420587301254, 0.09604084491729736, 0.09533926099538803, 0.08563698083162308, 0.08543827384710312, 0.08566805720329285, 0.08546929061412811, 0.09471151977777481, 0.09449176490306854, 0.08445166051387787], [0.08756998181343079, 0.08769258111715317, 0.08781535178422928, 0.08820396661758423, 0.09409349411725998, 0.09422522783279419, 0.09407293051481247, 0.09420463442802429, 0.08855559676885605, 0.08867957442998886, 0.0948866605758667], [0.0873783603310585, 0.08750774711370468, 0.08763731271028519, 0.08804753422737122, 0.09427686035633087, 0.09441645443439484, 0.09425507485866547, 0.09439463913440704, 0.08841878920793533, 0.08854971081018448, 0.09511753916740417], [0.08759991824626923, 0.08772145956754684, 0.0878431648015976, 0.08822839707136154, 0.0940648540854454, 0.09419535845518112, 0.09404448419809341, 0.09417495876550674, 0.08857695013284683, 0.08869984745979309, 0.09485061466693878], [0.08740828931331635, 0.08753661066293716, 0.0876651257276535, 0.08807196468114853, 0.0942482128739357, 0.09438657760620117, 0.09422662109136581, 0.0943649485707283, 0.08844015747308731, 0.0885699987411499, 0.09508145600557327], [0.09593662619590759, 0.09573595225811005, 0.09553571045398712, 0.09490641206502914, 0.08615528792142868, 0.08597508072853088, 0.08618347346782684, 0.08600320667028427, 0.09434296935796738, 0.09414563328027725, 0.08507966250181198], [0.09574274718761444, 0.09555017948150635, 0.0953579992055893, 0.09475396573543549, 0.08633765578269958, 0.08616400510072708, 0.08636481314897537, 0.08619111031293869, 0.09421300888061523, 0.09402351081371307, 0.085300974547863], [0.08642149716615677, 0.08658432960510254, 0.08674746751785278, 0.08726439625024796, 0.09519349783658981, 0.09537285566329956, 0.09516551345586777, 0.09534481912851334, 0.08773278445005417, 0.08789809048175812, 0.09627474844455719]], [[0.1016930416226387, 0.08565879613161087, 0.08534125983715057, 0.09976416826248169, 0.09939435124397278, 0.08439568430185318, 0.09945202618837357, 0.09908334910869598, 0.07672982662916183, 0.08281891793012619, 0.08566855639219284], [0.09088596701622009, 0.09092001616954803, 0.09092075377702713, 0.09088976681232452, 0.09089050441980362, 0.09092295914888382, 0.09089039266109467, 0.09089113026857376, 0.09094186127185822, 0.09092670679092407, 0.09091998636722565], [0.09065625071525574, 0.09102838486433029, 0.09103646129369736, 0.09069770574569702, 0.0907057523727417, 0.09106067568063736, 0.09070449322462082, 0.0907125324010849, 0.09126793593168259, 0.09110169112682343, 0.0910281389951706], [0.100470170378685, 0.08626857399940491, 0.0859844908118248, 0.09877583384513855, 0.09845055639743805, 0.08513782173395157, 0.0985013023018837, 0.09817692637443542, 0.07823337614536285, 0.08372361212968826, 0.0862773135304451], [0.10023344308137894, 0.08638624101877213, 0.08610870689153671, 0.09858404099941254, 0.09826730936765671, 0.08528141677379608, 0.0983167216181755, 0.09800084680318832, 0.07852736860513687, 0.08389914780855179, 0.0863947793841362], [0.08996829390525818, 0.09135197848081589, 0.09138216078281403, 0.09012167155742645, 0.09015145152807236, 0.09147276729345322, 0.09014679491519928, 0.09017658233642578, 0.09225086122751236, 0.09162634611129761, 0.09135105460882187], [0.10027041286230087, 0.08636787533760071, 0.08608931303024292, 0.09861399978399277, 0.09829594194889069, 0.08525899797677994, 0.0983455553650856, 0.09802835434675217, 0.07848139852285385, 0.08387172222137451, 0.08637644350528717], [0.10003378987312317, 0.0864853635430336, 0.0862133651971817, 0.09842216968536377, 0.09811262786388397, 0.0854024887084961, 0.09816091507673264, 0.0978521928191185, 0.0787760317325592, 0.08404726535081863, 0.08649373054504395], [0.08416695147752762, 0.09401915222406387, 0.09424468874931335, 0.08521321415901184, 0.08541762083768845, 0.09492455422878265, 0.08538565784692764, 0.08559048175811768, 0.10093890875577927, 0.09608655422925949, 0.09401223808526993], [0.08880799263715744, 0.09189440310001373, 0.09196237474679947, 0.08914723992347717, 0.08921318501234055, 0.09216661006212234, 0.089202880859375, 0.08926887065172195, 0.09393072873353958, 0.09251334518194199, 0.091892309486866], [0.09089301526546478, 0.09091667085886002, 0.0909171849489212, 0.0908956527709961, 0.09089616686105728, 0.09091871976852417, 0.09089609235525131, 0.0908965989947319, 0.09093185514211655, 0.0909213274717331, 0.09091665595769882]], [[0.10087347775697708, 0.08888566493988037, 0.10032252222299576, 0.08787976950407028, 0.08763944357633591, 0.0989159643650055, 0.08767694979906082, 0.08743718266487122, 0.08719807118177414, 0.08695961534976959, 0.08621127158403397], [0.08749677985906601, 0.09156484156847, 0.08766907453536987, 0.09193994849920273, 0.09203042834997177, 0.08811485767364502, 0.09201628714799881, 0.09210684150457382, 0.0921974927186966, 0.09228821843862534, 0.09257518500089645], [0.10026852786540985, 0.0890127643942833, 0.09975302219390869, 0.08806437999010086, 0.08783771097660065, 0.09843618422746658, 0.08787307888269424, 0.08764690160751343, 0.08742129802703857, 0.08719628304243088, 0.08648987114429474], [0.08635562658309937, 0.09177949279546738, 0.08658363670110703, 0.09228380769491196, 0.09240556508302689, 0.08717427402734756, 0.09238653630018234, 0.09250842779874802, 0.09263047575950623, 0.09275268763303757, 0.09313946962356567], [0.08608260750770569, 0.09183049201965332, 0.0863238126039505, 0.09236600995063782, 0.09249532222747803, 0.08694878220558167, 0.09247510880231857, 0.09260457754135132, 0.09273422509431839, 0.09286405891180038, 0.09327501803636551], [0.0987195372581482, 0.08933579921722412, 0.09829361736774445, 0.08853669464588165, 0.08834550529718399, 0.09720402210950851, 0.08837534487247467, 0.08818449079990387, 0.0879940539598465, 0.08780402690172195, 0.08720695227384567], [0.08612522482872009, 0.091822549700737, 0.08636438101530075, 0.09235319495201111, 0.09248132258653641, 0.08698399364948273, 0.09246129542589188, 0.09258957952260971, 0.09271803498268127, 0.09284667670726776, 0.09325385838747025], [0.08585270494222641, 0.09187331795692444, 0.08610497415065765, 0.09243520349264145, 0.09257090836763382, 0.08675875514745712, 0.09254968911409378, 0.09268556535243988, 0.0928216353058815, 0.09295790642499924, 0.09338931739330292], [0.08558081090450287, 0.09192385524511337, 0.08584610372781754, 0.09251702576875687, 0.09266030788421631, 0.08653385937213898, 0.09263791143894196, 0.09278138726949692, 0.09292507916688919, 0.09306900203227997, 0.09352470934391022], [0.08530949801206589, 0.09197413921356201, 0.0855877473950386, 0.09259862452745438, 0.09274950623512268, 0.0863092765212059, 0.09272592514753342, 0.09287702292203903, 0.09302835911512375, 0.09317994117736816, 0.09366000443696976], [0.0844571441411972, 0.09213117510080338, 0.08477570861577988, 0.092854805290699, 0.09302975982427597, 0.08560255169868469, 0.09300240874290466, 0.09317763894796371, 0.09335320442914963, 0.0935290977358818, 0.0940864309668541]], [[0.09089918434619904, 0.09089259803295135, 0.09088601171970367, 0.09116329997777939, 0.09085863828659058, 0.09116433560848236, 0.09085967391729355, 0.09085308760404587, 0.09069760143756866, 0.09083282947540283, 0.09089279919862747], [0.09091018885374069, 0.09091092646121979, 0.09091166406869888, 0.09088068455457687, 0.09091472625732422, 0.09088057279586792, 0.09091460704803467, 0.09091534465551376, 0.09093277156352997, 0.09091761708259583, 0.090910904109478], [0.09092097729444504, 0.09092903137207031, 0.09093710035085678, 0.0905987098813057, 0.09097061306238174, 0.09059746563434601, 0.09096935391426086, 0.09097742289304733, 0.09116832166910172, 0.09100225567817688, 0.09092878550291061], [0.09026411920785904, 0.08996686339378357, 0.08967059850692749, 0.10301031172275543, 0.08844965696334839, 0.10306339710950851, 0.08849524706602097, 0.08820381760597229, 0.08158719539642334, 0.08731280267238617, 0.08997597545385361], [0.09096328169107437, 0.09100181609392166, 0.09104036539793015, 0.08943365514278412, 0.09120074659585953, 0.08942773938179016, 0.09119471907615662, 0.09123334288597107, 0.09215132147073746, 0.09135235100984573, 0.09100063145160675], [0.09026087820529938, 0.08996251225471497, 0.08966512978076935, 0.10305853933095932, 0.08843964338302612, 0.10311185568571091, 0.08848539739847183, 0.0881928950548172, 0.08155282586812973, 0.08729860186576843, 0.08997165411710739], [0.0909617692232132, 0.09099915623664856, 0.09103655815124512, 0.08947724103927612, 0.09119216352701187, 0.08947150409221649, 0.09118631482124329, 0.09122379124164581, 0.09211426228284836, 0.09133924543857574, 0.09099800884723663], [0.09097138792276382, 0.09101610630750656, 0.09106085449457169, 0.08919848501682281, 0.09124705195426941, 0.08919163793325424, 0.0912400409579277, 0.09128490090370178, 0.09235168248414993, 0.09142309427261353, 0.09101473540067673], [0.09113210439682007, 0.09135071188211441, 0.09156985580921173, 0.08279469609260559, 0.09248626977205276, 0.08276371657848358, 0.09245166927576065, 0.09267343580722809, 0.09807407855987549, 0.09335944056510925, 0.09134399890899658], [0.0909995511174202, 0.0910668671131134, 0.09113422781229019, 0.08834444731473923, 0.09141474217176437, 0.08833424746990204, 0.09140418469905853, 0.09147179871797562, 0.09308485686779022, 0.09168023616075516, 0.09106479585170746], [0.09090985357761383, 0.09091037511825562, 0.0909108817577362, 0.0908893570303917, 0.09091301262378693, 0.09088927507400513, 0.09091293066740036, 0.09091344475746155, 0.09092555195093155, 0.0909150242805481, 0.09091035276651382]]], "default_policy": {"vf_explained_var": 0.0033605098724365234, "curr_entropy_coeff": 0.0015431216992, "num_trainable_parameters": 16595, "curr_kl_coeff": 4.931150215270463e-06, "policy_loss": -2.004625457630027e-05, "entropy": 0.6776530742645264, "module_train_batch_size_mean": 997.7008703380301, "weights_seq_no": 15.0, "use_intrinsic_rewards": 0.0, "num_module_steps_trained": 5985, "vf_loss_unclipped": 44.46820831298828, "num_module_steps_trained_lifetime": 89775, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.278075248003006, "vf_loss": 0.35830897092819214, "mean_kl_loss": 2.8320274125803735e-08, "num_module_steps_trained_lifetime_throughput": 713.3848433485148}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 89775, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_trainable_parameters": 8266, "weights_seq_no": 15.0, "num_module_steps_trained": 5985, "module_train_batch_size_mean": 997.7008703380301, "num_module_steps_trained_lifetime_throughput": 713.3924185225382}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 1.2}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.027884977750629e-06, "tensor_to_numpy": 1.4923359395006376e-05, "un_batch_to_individual_items": 6.536122629489774e-06, "remove_single_ts_time_rank_from_batch": 1.1818878716400029e-05, "listify_data_for_vector_env": 1.0719818809591165e-05, "get_actions": 3.545817530656788e-05}}, "connector_pipeline_timer": 0.00011384087343789579}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7917990176852795e-06, "numpy_to_tensor": 1.1996840148958793e-05, "add_states_from_episodes_to_batch": 2.7618471541203144e-06, "batch_individual_items": 1.2178393528882677e-05, "add_time_dim_to_batch_and_zero_pad": 6.809558879739803e-06}}, "connector_pipeline_timer": 5.853828651964285e-05}, "num_agent_steps_sampled": {"default_agent": 400}, "rlmodule_inference_timer": 3.084808772066724e-05, "episode_duration_sec_mean": 0.005836404976435006, "num_env_steps_sampled_lifetime": 75400, "episode_len_mean": 20.0, "num_episodes_lifetime": 300, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "num_episodes": 20, "env_step_timer": 1.3839177739444059e-05, "weights_seq_no": 15.0, "episode_return_min": -13.5, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.2, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "agent_episode_returns_mean": {"default_agent": 1.2}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "episode_len_max": 20, "env_reset_timer": 0.0006034065455316357, "episode_return_max": 13.5, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "sample": 0.12028077674409184, "time_between_sampling": 9.683690135748765}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "b4968_00000", "date": "2025-08-11_18-17-34", "timestamp": 1754929054, "time_this_iter_s": 10.818132877349854, "time_total_s": 158.7482054233551, "pid": 10564, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x141ef98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 158.7482054233551, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 50.493750000000006, "ram_util_percent": 81.925}}
{"timers": {"training_iteration": 10.572905300873328, "restore_env_runners": 1.2872482256558965e-05, "training_step": 10.572652345707475, "env_runner_sampling_timer": 1.6660539283772338, "learner_update_timer": 8.718757607881221, "synch_weights": 0.0018330422482036217, "restore_eval_env_runners": 5.9540078219603696e-05, "evaluation_iteration": 0.13273198912040185, "synch_eval_env_connectors": 0.0002627044186808124, "synch_env_connectors": 5.413989525255086e-06}, "env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.865247348666169e-06, "numpy_to_tensor": 1.2677401060504901e-05, "add_states_from_episodes_to_batch": 2.746274350255563e-06, "batch_individual_items": 1.2413784338058082e-05, "add_observations_from_episodes_to_batch": 2.8124741672149263e-06}}, "connector_pipeline_timer": 5.933328103671564e-05}, "num_env_steps_sampled_lifetime": -8635000.0, "episode_return_mean": -1.3400000000000003, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": -1.3400000000000003}, "module_episode_returns_mean": {"default_policy": -1.3400000000000003}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.005654605145410458, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.536088838693627e-05, "remove_single_ts_time_rank_from_batch": 1.2022331168849999e-05, "normalize_and_clip_actions": 8.036947597051067e-06, "get_actions": 3.998931604298997e-05, "listify_data_for_vector_env": 1.0578123841948218e-05, "un_batch_to_individual_items": 6.670155232158936e-06}}, "connector_pipeline_timer": 0.00011885834172854553}, "time_between_sampling": 0.03729780071855771, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 6.5, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "episode_len_mean": 20.0, "num_episodes": 250.0, "num_episodes_lifetime": -431750.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "rlmodule_inference_timer": 3.180126849618169e-05, "episode_duration_sec_mean": 0.00527676280634478, "weights_seq_no": 15.0, "env_step_timer": 1.3804365168036695e-05, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "env_reset_timer": 4.0922149864242874e-05, "num_env_steps_sampled_lifetime_throughput": 3248.9850861751506}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.14826317045038775, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008969963271335282, "add_observations_from_episodes_to_batch": 0.0009079769672913629, "add_columns_from_episodes_to_train_batch": 0.04148793229024888, "add_time_dim_to_batch_and_zero_pad": 0.07656455942063894, "add_states_from_episodes_to_batch": 0.004061542261478244, "batch_individual_items": 0.01600415504068233, "numpy_to_tensor": 7.610194429675641e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_env_steps_trained": 33000, "num_trainable_parameters": 24861, "num_module_steps_trained": 11970, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 191520, "num_env_steps_trained_lifetime": 528000, "num_env_steps_trained_lifetime_throughput": 3920.575868293024, "num_module_steps_trained_throughput": 21631433.88886399, "num_module_steps_trained_lifetime_throughput": 12727702.076885846}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1149120, "num_env_steps_trained_lifetime": 3168000, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 41673.60337558991}, "default_policy": {"vf_loss_unclipped": 38.817447662353516, "module_train_batch_size_mean": 997.4990256591639, "num_module_steps_trained_lifetime": 574560, "diff_num_grad_updates_vs_sampler_policy": 81.0, "vf_loss": 0.3588786721229553, "total_loss": 0.27803316712379456, "vf_explained_var": 0.0052710771560668945, "mean_kl_loss": 2.5711560738272965e-05, "policy_loss": -0.0005112267099320889, "entropy": 0.6769139766693115, "weights_seq_no": 96.0, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35910}, "intrinsic_reward_module": {"weights_seq_no": 96.0, "num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.4990256591639, "num_module_steps_trained_lifetime": 574560, "diff_num_grad_updates_vs_sampler_policy": 81.0, "total_loss": 0.0}}}, "IntrinsicAttentionMask": [[[0.09862009435892105, 0.08690007030963898, 0.09808144718408585, 0.08591664582490921, 0.08568169176578522, 0.09670630842447281, 0.08571835607290268, 0.08548394590616226, 0.09648311138153076, 0.08501704782247543, 0.09539122879505157], [0.08820555359125137, 0.09230656176805496, 0.08837924152612686, 0.09268470853567123, 0.09277591854333878, 0.08882863074541092, 0.09276166558265686, 0.09285295754671097, 0.08890238404273987, 0.09303580224514008, 0.0892665833234787], [0.09815938025712967, 0.08714038133621216, 0.09765471518039703, 0.08621194213628769, 0.0859900414943695, 0.09636557847261429, 0.08602467179298401, 0.08580324798822403, 0.09615624696016312, 0.08536211401224136, 0.09513174742460251], [0.087293840944767, 0.09277663379907608, 0.08752433210611343, 0.09328643232584, 0.09340950846672058, 0.08812138438224792, 0.09339027106761932, 0.09351348876953125, 0.08821947127580643, 0.0937604010105133, 0.08870422840118408], [0.0870751440525055, 0.09288930147886276, 0.08731912821531296, 0.09343099594116211, 0.0935617983341217, 0.08795130252838135, 0.09354135394096375, 0.09367231279611588, 0.08805519342422485, 0.09393478184938431, 0.08856869488954544], [0.09697544574737549, 0.08775749057531357, 0.09655705094337463, 0.08697250485420227, 0.08678469061851501, 0.09548670798540115, 0.08681400120258331, 0.08662652224302292, 0.0953126847743988, 0.08625278621912003, 0.09446011483669281], [0.08710929751396179, 0.09287171065807343, 0.08735117316246033, 0.09340842068195343, 0.09353801608085632, 0.08797787129878998, 0.09351775795221329, 0.09364750981330872, 0.08808085322380066, 0.09390754252672195, 0.0885898768901825], [0.0868908166885376, 0.09298422187566757, 0.08714612573385239, 0.09355289489030838, 0.09369023889303207, 0.08780781924724579, 0.09366877377033234, 0.09380628913640976, 0.08791657537221909, 0.09408192336559296, 0.08845426142215729], [0.09678224474191666, 0.0878581553697586, 0.09637778997421265, 0.08709686994552612, 0.08691468834877014, 0.09534283727407455, 0.0869431272149086, 0.08676126599311829, 0.09517453610897064, 0.08639869093894958, 0.09434986114501953], [0.08645464479923248, 0.09320874512195587, 0.08673662692308426, 0.09384161978960037, 0.09399452805519104, 0.08746784180402756, 0.09397062659263611, 0.09412374347448349, 0.08758808672428131, 0.09443073719739914, 0.08818279951810837], [0.09583280980587006, 0.08835252374410629, 0.09549624472856522, 0.08770892769098282, 0.08755477517843246, 0.09463401138782501, 0.08757884055376053, 0.08742491900920868, 0.09449364989995956, 0.08711788803339005, 0.09380532056093216]], [[0.0914331004023552, 0.09159684926271439, 0.09176088124513626, 0.08511105924844742, 0.09244581311941147, 0.09225475788116455, 0.09241997450590134, 0.0925854817032814, 0.08941338956356049, 0.09309680759906769, 0.08788186311721802], [0.09145531058311462, 0.09162648022174835, 0.09179796278476715, 0.08485753834247589, 0.09251413494348526, 0.09231434762477875, 0.09248711913824081, 0.09266021102666855, 0.08934520930051804, 0.09319505840539932, 0.08774656802415848], [0.0914774090051651, 0.09165599942207336, 0.09183493256568909, 0.0846046581864357, 0.09258239716291428, 0.09237384796142578, 0.09255418926477432, 0.09273488074541092, 0.08927695453166962, 0.09329328685998917, 0.0876113623380661], [0.09044528007507324, 0.09031542390584946, 0.0901857540011406, 0.09580185264348984, 0.0896487906575203, 0.08979783952236176, 0.08966891467571259, 0.08954016864299774, 0.09208225458860397, 0.08914503455162048, 0.09336867928504944], [0.0915679931640625, 0.09177748113870621, 0.09198746085166931, 0.08356049656867981, 0.09286529570817947, 0.09262025356292725, 0.09283215552568436, 0.09304454177618027, 0.08899260312318802, 0.0937013328075409, 0.0870504081249237], [0.09154299646615982, 0.09174389392137527, 0.09194521605968475, 0.08384986966848373, 0.09278672933578491, 0.09255185723304749, 0.09275496006011963, 0.09295850992202759, 0.08907182514667511, 0.09358786046504974, 0.08720630407333374], [0.0915646180510521, 0.09177294373512268, 0.09198174625635147, 0.0835995301604271, 0.09285467863082886, 0.09261100739240646, 0.09282172471284866, 0.09303291141986847, 0.0890032947063446, 0.09368599206209183, 0.08707145601511002], [0.09158613532781601, 0.09180191159248352, 0.09201819449663162, 0.08334985375404358, 0.09292257577180862, 0.09267009794712067, 0.09288842976093292, 0.09310726821422577, 0.08893472701311111, 0.09378412365913391, 0.08693671971559525], [0.09114580601453781, 0.09121724963188171, 0.0912887454032898, 0.08833038806915283, 0.09158651530742645, 0.0915035828948021, 0.09157530218362808, 0.09164708852767944, 0.09025860577821732, 0.09186838567256927, 0.0895783081650734], [0.09165161103010178, 0.09189032763242722, 0.0921296551823616, 0.08258526772260666, 0.09313107281923294, 0.09285140037536621, 0.09309323877096176, 0.09333571046590805, 0.08872321993112564, 0.09408601373434067, 0.08652254194021225], [0.09091083705425262, 0.09091134369373322, 0.0909118577837944, 0.0908903256058693, 0.09091398119926453, 0.09091339260339737, 0.09091390669345856, 0.09091441333293915, 0.09090443700551987, 0.0909159928560257, 0.09089948982000351]], [[0.09863538295030594, 0.08691354095935822, 0.08667586743831635, 0.09725247323513031, 0.08569497615098953, 0.08546063303947449, 0.08573164790868759, 0.08549720048904419, 0.09649806469678879, 0.09623418003320694, 0.09540601819753647], [0.08820728957653046, 0.09230838716030121, 0.0923992246389389, 0.08865580707788467, 0.09277775138616562, 0.09286905825138092, 0.0927634984254837, 0.09285479038953781, 0.08890414983034134, 0.08899164199829102, 0.08926834911108017], [0.08798781782388687, 0.09242206811904907, 0.09252047538757324, 0.08847196400165558, 0.09293060749769211, 0.09302955865859985, 0.09291516244411469, 0.09301409125328064, 0.08874011039733887, 0.08883460611104965, 0.08913348615169525], [0.09744486212730408, 0.087528295814991, 0.08732520788908005, 0.0962846428155899, 0.08648615330457687, 0.08628547191619873, 0.08651754260063171, 0.0863167941570282, 0.09565068036317825, 0.09542873501777649, 0.09473162889480591], [0.08707863837480545, 0.09289301931858063, 0.09302306920289993, 0.08770906925201416, 0.09356554597616196, 0.09369654208421707, 0.093545101583004, 0.09367606788873672, 0.0880587175488472, 0.0881820023059845, 0.08857224136590958], [0.08686060458421707, 0.0930059552192688, 0.09314367175102234, 0.08752580732107162, 0.09371822327375412, 0.09385699033737183, 0.09369656443595886, 0.09383530169725418, 0.08789486438035965, 0.08802501112222672, 0.0884370431303978], [0.08711271733045578, 0.09287536144256592, 0.09300421923398972, 0.08773770183324814, 0.0935416892170906, 0.09367147088050842, 0.09352143108844757, 0.0936511904001236, 0.08808431029319763, 0.08820652216672897, 0.08859335631132126], [0.08689463883638382, 0.09298831224441528, 0.09312482923269272, 0.08755441755056381, 0.09369436651468277, 0.09383191913366318, 0.09367290139198303, 0.09381041675806046, 0.08792044967412949, 0.0880495235323906, 0.08845815807580948], [0.09679099917411804, 0.08786610513925552, 0.08768230676651001, 0.09575161337852478, 0.0869225487112999, 0.08674073219299316, 0.08695098757743835, 0.08676911145448685, 0.09518314898014069, 0.09498405456542969, 0.0943583995103836], [0.09656154364347458, 0.08798467367887497, 0.08780771493911743, 0.09556430578231812, 0.08707601577043533, 0.08690088242292404, 0.08710340410470963, 0.08692821115255356, 0.09501872211694717, 0.09482760727405548, 0.09422694146633148], [0.09583893418312073, 0.08835816383361816, 0.08820287138223648, 0.0949735939502716, 0.08756037056446075, 0.08740648627281189, 0.08758443593978882, 0.08743050694465637, 0.09449969232082367, 0.09433360397815704, 0.09381131827831268]], [[0.09343728423118591, 0.08633226156234741, 0.08648686856031418, 0.09430330246686935, 0.09447219222784042, 0.09427695721387863, 0.0871080830693245, 0.08726408332586288, 0.09137330949306488, 0.09513746201992035, 0.08980821073055267], [0.08834820240736008, 0.0955447256565094, 0.09537560492753983, 0.08754482120275497, 0.08738986402750015, 0.08756905794143677, 0.0947021096944809, 0.0945344790816307, 0.09032399207353592, 0.08678476512432098, 0.09188244491815567], [0.08846578747034073, 0.09533181041479111, 0.09517072886228561, 0.08769775182008743, 0.08754958212375641, 0.08772093057632446, 0.09452913701534271, 0.09436941891908646, 0.09035328775644302, 0.08697084337472916, 0.09184077382087708], [0.09401503205299377, 0.08528570085763931, 0.08547393232584, 0.0950898602604866, 0.09529972821474075, 0.09505711495876312, 0.08623102307319641, 0.08642134815454483, 0.09146274626255035, 0.09612730145454407, 0.08953627198934555], [0.09412664920091629, 0.08508343994617462, 0.08527809381484985, 0.09524230659008026, 0.0954602062702179, 0.0952083170413971, 0.08606118708848953, 0.08625807613134384, 0.09147929400205612, 0.09631960093975067, 0.08948283642530441], [0.09399756789207458, 0.08531730622053146, 0.08550453186035156, 0.09506603330373764, 0.09527464956045151, 0.09503348171710968, 0.08625755459070206, 0.0864468440413475, 0.09146013110876083, 0.09609726071357727, 0.08954459428787231], [0.08893507719039917, 0.09448212385177612, 0.09435287863016129, 0.08830957859754562, 0.0881887823343277, 0.08832846581935883, 0.0938376784324646, 0.0937093198299408, 0.0904679074883461, 0.08771661669015884, 0.09167159348726273], [0.08905213326215744, 0.09427019953727722, 0.09414882957935333, 0.08846255391836166, 0.08834866434335709, 0.08848036080598831, 0.09366492182016373, 0.09354433417320251, 0.09049592912197113, 0.08790341019630432, 0.09162867814302444], [0.09202387183904648, 0.08889137953519821, 0.08896106481552124, 0.09239640086889267, 0.09246882051229477, 0.09238509088754654, 0.08924031257629395, 0.08931025862693787, 0.09112811833620071, 0.09275341033935547, 0.0904412716627121], [0.0945630893111229, 0.08429250866174698, 0.08451204746961594, 0.09583992511034012, 0.09608954191207886, 0.0958009883761406, 0.08539596199989319, 0.08561837673187256, 0.09154167026281357, 0.09707482159137726, 0.08927108347415924], [0.09091715514659882, 0.09089451283216476, 0.09089502692222595, 0.09091979265213013, 0.09092029929161072, 0.09091971069574356, 0.0908970758318901, 0.0908975899219513, 0.09091075509786606, 0.09092231094837189, 0.0909058079123497]], [[0.09352292865514755, 0.08800731599330902, 0.09175695478916168, 0.08833826333284378, 0.08841807395219803, 0.09218521416187286, 0.09208901226520538, 0.0884854793548584, 0.09225548803806305, 0.09233883768320084, 0.09260240942239761], [0.07829607278108597, 0.10613465309143066, 0.08613375574350357, 0.10415961593389511, 0.10368992388248444, 0.08414972573518753, 0.0845906063914299, 0.10329525172710419, 0.08382943272590637, 0.08345141261816025, 0.08226946741342545], [0.08862527459859848, 0.09351273626089096, 0.09012989699840546, 0.09320329129695892, 0.0931289941072464, 0.08976002782583237, 0.08984283357858658, 0.09306634217500687, 0.0896996483206749, 0.08962813764810562, 0.08940281718969345], [0.07920174300670624, 0.10496971756219864, 0.08651641756296158, 0.1031598150730133, 0.10272902250289917, 0.08466962724924088, 0.08508028835058212, 0.10236692428588867, 0.0843711867928505, 0.08401884883642197, 0.08291645348072052], [0.07942036539316177, 0.10469023883342743, 0.08660782873630524, 0.10291961580514908, 0.10249808430671692, 0.0847942978143692, 0.08519762754440308, 0.10214374214410782, 0.08450116217136383, 0.08415507525205612, 0.0830719918012619], [0.08981189876794815, 0.09215186536312103, 0.09053927659988403, 0.09200562536716461, 0.09197048097848892, 0.09036105871200562, 0.09040099382400513, 0.09194082766771317, 0.09033193439245224, 0.09029742330312729, 0.09018858522176743], [0.08954526484012604, 0.0924561396241188, 0.09044814854860306, 0.09227368980646133, 0.09222985059022903, 0.09022676944732666, 0.09027636051177979, 0.0921928733587265, 0.0901905968785286, 0.09014773368835449, 0.09001261740922928], [0.07960505783557892, 0.10445466637611389, 0.08668475598096848, 0.10271703451871872, 0.10230328887701035, 0.08489937335252762, 0.08529649674892426, 0.10195546597242355, 0.08461073040962219, 0.0842699185013771, 0.08320320397615433], [0.09000670164823532, 0.09193014353513718, 0.09060554206371307, 0.0918101891875267, 0.0917813628911972, 0.09045889973640442, 0.09049176424741745, 0.09175702929496765, 0.09043492376804352, 0.09040651470422745, 0.09031692892313004], [0.09023778140544891, 0.09166773408651352, 0.09068381786346436, 0.09157878905534744, 0.09155739843845367, 0.09057465940713882, 0.09059912711381912, 0.09153935313224792, 0.09055681526660919, 0.09053566306829453, 0.09046893566846848], [0.09096865355968475, 0.09084205329418182, 0.09092893451452255, 0.0908498615026474, 0.09085173904895782, 0.09093862771987915, 0.09093645960092545, 0.09085333347320557, 0.09094022214412689, 0.09094209969043732, 0.09094803780317307]], [[0.0908721387386322, 0.09116363525390625, 0.09085897356271744, 0.09083819389343262, 0.09083161503076553, 0.09083922207355499, 0.09083264321088791, 0.09082606434822083, 0.0909680649638176, 0.0911036878824234, 0.09086575359106064], [0.08890040963888168, 0.104388028383255, 0.08825673162937164, 0.08725041896104813, 0.08693397790193558, 0.08729995042085648, 0.0869833305478096, 0.08666787296533585, 0.09373029321432114, 0.1010010614991188, 0.08858786523342133], [0.09095413982868195, 0.09059837460517883, 0.09097027033567429, 0.09099572896957397, 0.09100379794836044, 0.0909944698214531, 0.09100253880023956, 0.09101060777902603, 0.0908367857336998, 0.09067132323980331, 0.09096195548772812], [0.09108228981494904, 0.08971205353736877, 0.09114477783441544, 0.09124348312616348, 0.09127478301525116, 0.0912385955452919, 0.09126988798379898, 0.09130119532346725, 0.09062860161066055, 0.08999178558588028, 0.09111256897449493], [0.09112256020307541, 0.08943269401788712, 0.09119977056980133, 0.09132175892591476, 0.09136044234037399, 0.09131571650505066, 0.09135439246892929, 0.09139309078454971, 0.0905623808503151, 0.08977718651294708, 0.09115996956825256], [0.09107597917318344, 0.08975575864315033, 0.09113617241382599, 0.09123124182224274, 0.09126138687133789, 0.09122654050588608, 0.09125667810440063, 0.09128683060407639, 0.09063893556594849, 0.09002534300088882, 0.0911051481962204], [0.0911162793636322, 0.08947628736495972, 0.09119119495153427, 0.09130953997373581, 0.09134706109762192, 0.09130367636680603, 0.09134119749069214, 0.09137874096632004, 0.09057273715734482, 0.08981068432331085, 0.09115257859230042], [0.09115643054246902, 0.08919753134250641, 0.09124607592821121, 0.09138772636651993, 0.09143265336751938, 0.09138070791959763, 0.09142562747001648, 0.09147057682275772, 0.0905064195394516, 0.08959639072418213, 0.09119986742734909], [0.09025640785694122, 0.09536455571651459, 0.09003186225891113, 0.08967863768339157, 0.08956700563430786, 0.08969608694314957, 0.08958443999290466, 0.0894729271531105, 0.09190818667411804, 0.09429236501455307, 0.09014751017093658], [0.08933041244745255, 0.10155636817216873, 0.08881343901157379, 0.08800368010997772, 0.08774865418672562, 0.08804358541965485, 0.08778844773769379, 0.08753405511379242, 0.09318602085113525, 0.09891582280397415, 0.08907948434352875], [0.09091196209192276, 0.0908893272280693, 0.09091298282146454, 0.09091459959745407, 0.09091511368751526, 0.0909145250916481, 0.09091503173112869, 0.09091554582118988, 0.09090450406074524, 0.09089397639036179, 0.09091245383024216]]], "default_policy": {"vf_explained_var": 0.0036754608154296875, "curr_entropy_coeff": 0.0015431216992, "num_trainable_parameters": 16595, "curr_kl_coeff": 2.4655751076352317e-06, "policy_loss": -0.0005343922530300915, "entropy": 0.6768568754196167, "module_train_batch_size_mean": 997.6889684010584, "weights_seq_no": 16.0, "use_intrinsic_rewards": 0.0, "num_module_steps_trained": 5985, "vf_loss_unclipped": 38.643943786621094, "num_module_steps_trained_lifetime": 95760, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.2775667905807495, "vf_loss": 0.35831496119499207, "mean_kl_loss": 2.8054364520357922e-05, "num_module_steps_trained_lifetime_throughput": 710.8476959366444}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 95760, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_trainable_parameters": 8266, "weights_seq_no": 16.0, "num_module_steps_trained": 5985, "module_train_batch_size_mean": 997.6889684010584, "num_module_steps_trained_lifetime_throughput": 710.8548055541818}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 1.4}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.008231543981158e-06, "tensor_to_numpy": 1.544140328107335e-05, "un_batch_to_individual_items": 6.661785771812108e-06, "remove_single_ts_time_rank_from_batch": 1.1897297169949442e-05, "listify_data_for_vector_env": 1.0601122644026329e-05, "get_actions": 3.650058413132322e-05}}, "connector_pipeline_timer": 0.00011570377042597809}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.834445548983174e-06, "numpy_to_tensor": 1.2041050592935291e-05, "add_states_from_episodes_to_batch": 2.8409192909312425e-06, "batch_individual_items": 1.2324114221640654e-05, "add_time_dim_to_batch_and_zero_pad": 6.890661027685612e-06}}, "connector_pipeline_timer": 5.9077724750012524e-05}, "num_agent_steps_sampled": {"default_agent": 400}, "rlmodule_inference_timer": 3.1487674141982836e-05, "episode_duration_sec_mean": 0.005740110393380746, "num_env_steps_sampled_lifetime": 80400, "episode_len_mean": 20.0, "num_episodes_lifetime": 320, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "num_episodes": 20, "env_step_timer": 1.401217533331908e-05, "weights_seq_no": 16.0, "episode_return_min": -13.5, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.4, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "agent_episode_returns_mean": {"default_agent": 1.4}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "episode_len_max": 20, "env_reset_timer": 0.0006005387300295297, "episode_return_max": 13.5, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "sample": 0.12024479355635548, "time_between_sampling": 9.690286461051404}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "b4968_00000", "date": "2025-08-11_18-17-44", "timestamp": 1754929064, "time_this_iter_s": 10.440928936004639, "time_total_s": 169.18913435935974, "pid": 10564, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x141ef98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 169.18913435935974, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 44.73571428571429, "ram_util_percent": 81.25714285714285}}
{"timers": {"training_iteration": 10.567076135365392, "restore_env_runners": 1.2928346732435382e-05, "training_step": 10.566822934329597, "env_runner_sampling_timer": 1.6651213390938984, "learner_update_timer": 8.712426826391608, "synch_weights": 0.0018318059954649446, "restore_eval_env_runners": 5.942009782114415e-05, "evaluation_iteration": 0.13266123172969144, "synch_eval_env_connectors": 0.00026206153395615816, "synch_env_connectors": 5.399019893337644e-06}, "env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.075359944079101e-06, "numpy_to_tensor": 1.3004846084399414e-05, "add_states_from_episodes_to_batch": 2.767299714782293e-06, "batch_individual_items": 1.265260164258049e-05, "add_observations_from_episodes_to_batch": 2.8665153889315883e-06}}, "connector_pipeline_timer": 6.054097293986642e-05}, "num_env_steps_sampled_lifetime": -9252500.0, "episode_return_mean": -2.2199999999999998, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": -2.2199999999999998}, "module_episode_returns_mean": {"default_policy": -2.2199999999999998}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.005707995688719236, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5644576217710287e-05, "remove_single_ts_time_rank_from_batch": 1.2293839850279256e-05, "normalize_and_clip_actions": 8.167402387478421e-06, "get_actions": 4.1464742423004105e-05, "listify_data_for_vector_env": 1.0716874517570207e-05, "un_batch_to_individual_items": 6.693838462986216e-06}}, "connector_pipeline_timer": 0.00012158493490742808}, "time_between_sampling": 0.03630637413064988, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 6.5, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "episode_len_mean": 20.0, "num_episodes": 250.0, "num_episodes_lifetime": -462625.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "rlmodule_inference_timer": 3.3002413573832435e-05, "episode_duration_sec_mean": 0.005403542171232401, "weights_seq_no": 16.0, "env_step_timer": 1.4278148314889322e-05, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "env_reset_timer": 4.163806401624249e-05, "num_env_steps_sampled_lifetime_throughput": 3188.582178706748}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1495961854066309, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008969156557633343, "add_observations_from_episodes_to_batch": 0.0009084259477065151, "add_columns_from_episodes_to_train_batch": 0.04149349754714139, "add_time_dim_to_batch_and_zero_pad": 0.0765586425764137, "add_states_from_episodes_to_batch": 0.004058691008837714, "batch_individual_items": 0.017341025159658335, "numpy_to_tensor": 7.614800550449096e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_env_steps_trained": 33000, "num_trainable_parameters": 24861, "num_module_steps_trained": 11970, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 203490, "num_env_steps_trained_lifetime": 561000, "num_env_steps_trained_lifetime_throughput": 3907.725455013294, "num_module_steps_trained_throughput": 21124979.42838065, "num_module_steps_trained_lifetime_throughput": 12690544.59170931}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1220940, "num_env_steps_trained_lifetime": 3366000, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 41130.1309216936}, "default_policy": {"vf_loss_unclipped": 41.56310272216797, "module_train_batch_size_mean": 997.498558675304, "num_module_steps_trained_lifetime": 610470, "diff_num_grad_updates_vs_sampler_policy": 86.0, "vf_loss": 0.3588778078556061, "total_loss": 0.2783050835132599, "vf_explained_var": 0.004871964454650879, "mean_kl_loss": 8.402172170463018e-06, "policy_loss": -0.00023751414846628904, "entropy": 0.6758416295051575, "weights_seq_no": 102.0, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35910}, "intrinsic_reward_module": {"weights_seq_no": 102.0, "num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.498558675304, "num_module_steps_trained_lifetime": 610470, "diff_num_grad_updates_vs_sampler_policy": 86.0, "total_loss": 0.0}}}, "IntrinsicAttentionMask": [[[0.09352413564920425, 0.08800844848155975, 0.08808796852827072, 0.09202004969120026, 0.09210319072008133, 0.09218639880418777, 0.0920901969075203, 0.09217339754104614, 0.08856656402349472, 0.09234002977609634, 0.08889961242675781], [0.07832132279872894, 0.10616887360811234, 0.1056901216506958, 0.08494118601083755, 0.0845581665635109, 0.08417686074972153, 0.08461788296699524, 0.08423631638288498, 0.10286261141300201, 0.08347831666469574, 0.10094846040010452], [0.0785379484295845, 0.1058867797255516, 0.10541779547929764, 0.08505301922559738, 0.08467631042003632, 0.08430126309394836, 0.08473505079746246, 0.08435974270105362, 0.10264717042446136, 0.08361411839723587, 0.10077076405286789], [0.08935128897428513, 0.09267894178628922, 0.0926286056637764, 0.09022697806358337, 0.0901779755949974, 0.09012899547815323, 0.09018562734127045, 0.09013664722442627, 0.09232718497514725, 0.09003876894712448, 0.09211895614862442], [0.08958157151937485, 0.09241531044244766, 0.09237255901098251, 0.09032878279685974, 0.09028699994087219, 0.09024523198604584, 0.0902935191988945, 0.09025175869464874, 0.09211648255586624, 0.09016827493906021, 0.0919395163655281], [0.08981210738420486, 0.09215207397937775, 0.09211686253547668, 0.090430349111557, 0.09039580076932907, 0.09036126732826233, 0.09040119498968124, 0.0903666615486145, 0.09190591424703598, 0.0902976244688034, 0.0917600691318512], [0.0895455852150917, 0.09245646744966507, 0.09241253137588501, 0.0903128907084465, 0.09026998281478882, 0.09022708982229233, 0.09027668088674545, 0.09023378789424896, 0.09214939177036285, 0.09014805406332016, 0.09196754544973373], [0.08977608382701874, 0.09219317138195038, 0.0921567901968956, 0.09041450172662735, 0.09037882089614868, 0.09034315496683121, 0.09038439393043518, 0.0903487280011177, 0.0919388011097908, 0.09027743339538574, 0.09178810566663742], [0.0798439159989357, 0.10420150309801102, 0.10379013419151306, 0.08572021871805191, 0.08538182079792023, 0.0850447490811348, 0.08543459326028824, 0.0850973129272461, 0.10135582834482193, 0.08442675322294235, 0.09970312565565109], [0.09023784846067429, 0.09166780114173889, 0.09164639562368393, 0.09061704576015472, 0.09059588611125946, 0.0905747264623642, 0.0905991941690445, 0.09057802706956863, 0.09151804447174072, 0.0905357301235199, 0.09142924100160599], [0.08075469732284546, 0.10304146260023117, 0.10266905277967453, 0.08617843687534332, 0.08586696535348892, 0.08555662631988525, 0.08591555058956146, 0.08560502529144287, 0.1004626527428627, 0.08498735725879669, 0.09896214306354523]], [[0.09207858890295029, 0.0922434851527214, 0.0924086794257164, 0.09293201565742493, 0.09309844672679901, 0.09290604293346405, 0.09307242929935455, 0.09323910623788834, 0.08304884284734726, 0.08647007495164871, 0.08850228786468506], [0.09212879091501236, 0.09230121970176697, 0.09247396141290665, 0.09302131086587906, 0.09319540858268738, 0.09299414604902267, 0.09316819161176682, 0.09334256500005722, 0.08270886540412903, 0.08627275377511978, 0.08839273452758789], [0.09217879921197891, 0.09235875308513641, 0.09253906458616257, 0.09311047941446304, 0.0932922512292862, 0.09308210760354996, 0.09326383471488953, 0.09344591200351715, 0.0823700800538063, 0.08607568591833115, 0.08828310668468475], [0.09233520925045013, 0.09253900498151779, 0.09274324774742126, 0.09339083731174469, 0.09359695762395859, 0.09335868060588837, 0.0935647264122963, 0.09377123415470123, 0.08130846917629242, 0.08545515686273575, 0.08793648332357407], [0.09238434582948685, 0.09259570389986038, 0.09280754625797272, 0.09347935020923615, 0.09369321912527084, 0.09344598650932312, 0.09365977346897125, 0.09387405216693878, 0.08097454905509949, 0.08525904268026352, 0.08782648295164108], [0.09232752025127411, 0.09253013134002686, 0.09273318201303482, 0.0933769941329956, 0.0935819074511528, 0.0933450311422348, 0.09354986995458603, 0.09375516325235367, 0.08136074244976044, 0.08548581600189209, 0.08795366436243057], [0.09237667918205261, 0.09258685261011124, 0.09279751032590866, 0.09346552938222885, 0.09367818385362625, 0.09343235194683075, 0.09364493191242218, 0.09385799616575241, 0.08102662861347198, 0.08528965711593628, 0.08784367144107819], [0.0924256294965744, 0.0926433801651001, 0.09286164492368698, 0.09355390816926956, 0.09377431869506836, 0.09351953119039536, 0.09373985230922699, 0.093960702419281, 0.08069369941949844, 0.08509372919797897, 0.08773358911275864], [0.08882161974906921, 0.08856814354658127, 0.08831537514925003, 0.08752232789993286, 0.08727256208658218, 0.08756142109632492, 0.0873115286231041, 0.08706235885620117, 0.10474096983671188, 0.09820030629634857, 0.0946233868598938], [0.09018073230981827, 0.09008696675300598, 0.08999329805374146, 0.08969829231500626, 0.08960503339767456, 0.08971288055181503, 0.08961959183216095, 0.08952640742063522, 0.09575812518596649, 0.09353672713041306, 0.09228189289569855], [0.09091293811798096, 0.09091345220804214, 0.09091395884752274, 0.09091557562351227, 0.09091608971357346, 0.0909155011177063, 0.09091600775718689, 0.09091652184724808, 0.09088340401649475, 0.09089494496583939, 0.09090159833431244]], [[0.10087994486093521, 0.08889136463403702, 0.08864827454090118, 0.09946556389331818, 0.08764506876468658, 0.08740539103746414, 0.09923600405454636, 0.0874427855014801, 0.08720366656780243, 0.08696518838405609, 0.08621679991483688], [0.08749747276306152, 0.0915655642747879, 0.0916556715965271, 0.08794236928224564, 0.09203115850687027, 0.09212172776460648, 0.08801539987325668, 0.09210756421089172, 0.0921982154250145, 0.09228894859552383, 0.09257591515779495], [0.08722207695245743, 0.09161773324012756, 0.09171528369188309, 0.08770200610160828, 0.09212184697389603, 0.09221993386745453, 0.08778078854084015, 0.09220460802316666, 0.09230278432369232, 0.09240106493234634, 0.09271194785833359], [0.0993230789899826, 0.08921537548303604, 0.08900836855173111, 0.09814050048589706, 0.08815314620733261, 0.08794859796762466, 0.09794832020998001, 0.08798051625490189, 0.08777638524770737, 0.08757271617650986, 0.08693299442529678], [0.08608396351337433, 0.09183192998170853, 0.09196050465106964, 0.08670719712972641, 0.09249678254127502, 0.09262628108263016, 0.08680962026119232, 0.09260603785514832, 0.09273568540811539, 0.09286551922559738, 0.0932764858007431], [0.08581170439720154, 0.0918828472495079, 0.09201889485120773, 0.08646887540817261, 0.09258650988340378, 0.09272360056638718, 0.08657689392566681, 0.09270218014717102, 0.09283944219350815, 0.09297690540552139, 0.0934121161699295], [0.09906980395317078, 0.0892677903175354, 0.08906671404838562, 0.09792455285787582, 0.08823584765195847, 0.08803710341453552, 0.09773840755224228, 0.08806812763214111, 0.08786974847316742, 0.08767182379961014, 0.08705005794763565], [0.0858541950583458, 0.09187491238117218, 0.09200979024171829, 0.08650607615709305, 0.09257251024246216, 0.09270840883255005, 0.08661322295665741, 0.09268716722726822, 0.09282324463129044, 0.09295951575040817, 0.09339093416929245], [0.08558245003223419, 0.09192562103271484, 0.09206799417734146, 0.0862681046128273, 0.09266208857297897, 0.09280560165643692, 0.08638082444667816, 0.09278316795825958, 0.09292686730623245, 0.09307079017162323, 0.09352650493383408], [0.08531130850315094, 0.0919760912656784, 0.09212595969438553, 0.0860305204987526, 0.09275148063898087, 0.09290261566638947, 0.08614879101514816, 0.09287898987531662, 0.09303033351898193, 0.09318192303180695, 0.09366199374198914], [0.08445954322814941, 0.0921337902545929, 0.09230738878250122, 0.0852833092212677, 0.09303240478038788, 0.09320768713951111, 0.08541887253522873, 0.09318029135465622, 0.09335585683584213, 0.09353175759315491, 0.09408910572528839]], [[0.10327944159507751, 0.08699506521224976, 0.0866725742816925, 0.08566252887248993, 0.1009448915719986, 0.10137928277254105, 0.08539450913667679, 0.1006290391087532, 0.07792680710554123, 0.08411089330911636, 0.08700498193502426], [0.09088294208049774, 0.09091698378324509, 0.09091772139072418, 0.09092004597187042, 0.09088747948408127, 0.09088662266731262, 0.09092067182064056, 0.09088809788227081, 0.09093882888555527, 0.09092367440462112, 0.0909169614315033], [0.09062322974205017, 0.09099522978067398, 0.09100329875946045, 0.09102877229452133, 0.09067270904779434, 0.09066341817378998, 0.09103558212518692, 0.09067949652671814, 0.09123469144105911, 0.09106850624084473, 0.09099498391151428], [0.08980609476566315, 0.0912403091788292, 0.09127160906791687, 0.09137044847011566, 0.08999589085578918, 0.08996021747589111, 0.09139689058065414, 0.09002193063497543, 0.09217247366905212, 0.09152480959892273, 0.09123935550451279], [0.1015847846865654, 0.08755090087652206, 0.0872696191072464, 0.0863877460360527, 0.09959214180707932, 0.09996338188648224, 0.08615349233150482, 0.09932208806276321, 0.07958607375621796, 0.08503026515245438, 0.08755955100059509], [0.10190211236476898, 0.08744725584983826, 0.08715818077325821, 0.08625207841396332, 0.09984597563743591, 0.10022895783185959, 0.08601143956184387, 0.09956740587949753, 0.07927269488573074, 0.08485782146453857, 0.08745614439249039], [0.08958828449249268, 0.09130533039569855, 0.09134285897016525, 0.09146140515804291, 0.08981520682573318, 0.0897725448012352, 0.09149312227964401, 0.08984635025262833, 0.0924241915345192, 0.09164656698703766, 0.09130418300628662], [0.1013534739613533, 0.08762631565332413, 0.08735072612762451, 0.0864865854382515, 0.09940696507692337, 0.09976966679096222, 0.08625701814889908, 0.09914310276508331, 0.07981528341770172, 0.08515604585409164, 0.08763478696346283], [0.08335257321596146, 0.09310944378376007, 0.09333279728889465, 0.09404127299785614, 0.08459114283323288, 0.0843571349978447, 0.09423159062862396, 0.0847623348236084, 0.0999622493982315, 0.09515684098005295, 0.0931025967001915], [0.08853952586650848, 0.09161660075187683, 0.09168437123298645, 0.0918985977768898, 0.0889434888958931, 0.08886748552322388, 0.09195595234632492, 0.08899900317192078, 0.09364677220582962, 0.09223367273807526, 0.09161451458930969], [0.09089092165231705, 0.09091457724571228, 0.09091509133577347, 0.090916708111763, 0.09089407324790955, 0.09089348465204239, 0.09091714024543762, 0.09089450538158417, 0.09092976152896881, 0.09091923385858536, 0.09091456234455109]], [[0.09318120032548904, 0.09133914858102798, 0.09142167866230011, 0.08801548182964325, 0.09176546335220337, 0.09184837341308594, 0.08808257430791855, 0.08816215395927429, 0.09191839396953583, 0.09200143814086914, 0.09226404875516891], [0.08871959149837494, 0.09045877307653427, 0.09037937968969345, 0.09377839416265488, 0.09005014598369598, 0.08997111022472382, 0.09370893985033035, 0.09362669289112091, 0.08990447223186493, 0.08982556313276291, 0.08957697451114655], [0.08891964703798294, 0.09050141274929047, 0.09042926877737045, 0.0935128703713417, 0.09013001620769501, 0.09005817025899887, 0.09344996511936188, 0.09337546676397324, 0.08999758958816528, 0.0899258479475975, 0.08969977498054504], [0.08065997809171677, 0.08847881853580475, 0.0881093367934227, 0.1050591692328453, 0.08659014105796814, 0.08622854202985764, 0.104688860476017, 0.1042516827583313, 0.08592461049556732, 0.08556579053401947, 0.08444308489561081], [0.0897529199719429, 0.09067574888467789, 0.0906338095664978, 0.09241419285535812, 0.09045968949794769, 0.09041784703731537, 0.09237811714410782, 0.09233538806438446, 0.09038255363702774, 0.0903407484292984, 0.09020891785621643], [0.08995384722948074, 0.09071702510118484, 0.09068236500024796, 0.09215103834867477, 0.09053846448659897, 0.09050387144088745, 0.09212132543325424, 0.09208613634109497, 0.0904746949672699, 0.09044013172388077, 0.09033112227916718], [0.08082256466150284, 0.08852402120828629, 0.08816033601760864, 0.10481996834278107, 0.08666474372148514, 0.08630870282649994, 0.10445649176836014, 0.10402735322713852, 0.08600941300392151, 0.0856560692191124, 0.08455031365156174], [0.0810154378414154, 0.08857734501361847, 0.08822055906057358, 0.10453688353300095, 0.0867529883980751, 0.08640354126691818, 0.10418146848678589, 0.10376182198524475, 0.08610977977514267, 0.08576293289661407, 0.0846773236989975], [0.0901235044002533, 0.09075162559747696, 0.09072311967611313, 0.09192933887243271, 0.0906047523021698, 0.09057629108428955, 0.09190497547388077, 0.09187610447406769, 0.09055228531360626, 0.09052383899688721, 0.09043413400650024], [0.09032472968101501, 0.09079239517450333, 0.09077119082212448, 0.09166702628135681, 0.09068311750888824, 0.0906619280576706, 0.09164896607398987, 0.09162755310535431, 0.09064406156539917, 0.09062289446592331, 0.09055611491203308], [0.09096091985702515, 0.09091931581497192, 0.09092120081186295, 0.09084214270114899, 0.09092901647090912, 0.09093090146780014, 0.09084372222423553, 0.09084560722112656, 0.09093248844146729, 0.0909343734383583, 0.09094030410051346]], [[0.09079097211360931, 0.09108220785856247, 0.0910756066441536, 0.09075705707073212, 0.09075048565864563, 0.09075808525085449, 0.09104921668767929, 0.09104262292385101, 0.09088680893182755, 0.0910223126411438, 0.09078459441661835], [0.08493015915155411, 0.0997261106967926, 0.09936442971229553, 0.08335386216640472, 0.08305155485868454, 0.08340118080377579, 0.09793075919151306, 0.0975755900144577, 0.08954434841871262, 0.09649039804935455, 0.08463157713413239], [0.08506370335817337, 0.09952788054943085, 0.09917490929365158, 0.08351960778236389, 0.08322340995073318, 0.08356598019599915, 0.09777548164129257, 0.09742871671915054, 0.0895799994468689, 0.09636905789375305, 0.08477127552032471], [0.09146737307310104, 0.09009134769439697, 0.09012225270271301, 0.09162924438714981, 0.09166067838668823, 0.09162434190511703, 0.09024595469236374, 0.09027691185474396, 0.09101177006959915, 0.09037225693464279, 0.09149777889251709], [0.09159833937883377, 0.08989965915679932, 0.0899377390742302, 0.0917985811829567, 0.09183746576309204, 0.0917925089597702, 0.09009022265672684, 0.09012838453054428, 0.09103524684906006, 0.09024594724178314, 0.09163594990968704], [0.0914469063282013, 0.0901213139295578, 0.09015108644962311, 0.09160280972719193, 0.09163307398557663, 0.09159807860851288, 0.09027029573917389, 0.09030012041330338, 0.09100808203220367, 0.09039198607206345, 0.0914761945605278], [0.08559753745794296, 0.09873606264591217, 0.09841760993003845, 0.08418351411819458, 0.08391199260950089, 0.08422601222991943, 0.09715401381254196, 0.09684065729379654, 0.08972020447254181, 0.09588245302438736, 0.08532992005348206], [0.0857309103012085, 0.09853839874267578, 0.09822849184274673, 0.08434971421957016, 0.08408443629741669, 0.08439123630523682, 0.09699858725070953, 0.09669351577758789, 0.08975465595722198, 0.09576050937175751, 0.08546954393386841], [0.08887145668268204, 0.09390122443437576, 0.09378433972597122, 0.08830255270004272, 0.0881926417350769, 0.08831973373889923, 0.09331827610731125, 0.09320211410522461, 0.09049789607524872, 0.09284548461437225, 0.0887642353773117], [0.0861412063241005, 0.09793068468570709, 0.09764689952135086, 0.08486184477806091, 0.08461592346429825, 0.08490031957626343, 0.09651996195316315, 0.09624026715755463, 0.08985916525125504, 0.09538441151380539, 0.0858992412686348], [0.09091827273368835, 0.0908956304192543, 0.09089615195989609, 0.09092091023921967, 0.09092142432928085, 0.0909208357334137, 0.09089819341897964, 0.09089870750904083, 0.09091081470251083, 0.09090028703212738, 0.09091877192258835]]], "default_policy": {"vf_explained_var": 0.002118706703186035, "curr_entropy_coeff": 0.0015431216992, "num_trainable_parameters": 16595, "curr_kl_coeff": 1.2327875538176158e-06, "policy_loss": -0.0002501706767361611, "entropy": 0.675803005695343, "module_train_batch_size_mean": 997.6777629636601, "weights_seq_no": 17.0, "use_intrinsic_rewards": 0.0, "num_module_steps_trained": 5985, "vf_loss_unclipped": 41.588958740234375, "num_module_steps_trained_lifetime": 101745, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.2778491973876953, "vf_loss": 0.3583105802536011, "mean_kl_loss": 9.30508213059511e-06, "num_module_steps_trained_lifetime_throughput": 708.5252470404743}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 101745, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_trainable_parameters": 8266, "weights_seq_no": 17.0, "num_module_steps_trained": 5985, "module_train_batch_size_mean": 997.6777629636601, "num_module_steps_trained_lifetime_throughput": 708.5319164637339}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 1.2}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.03187592841745e-06, "tensor_to_numpy": 1.5421992733403075e-05, "un_batch_to_individual_items": 6.705182504457822e-06, "remove_single_ts_time_rank_from_batch": 1.1933005739285843e-05, "listify_data_for_vector_env": 1.0752482712062233e-05, "get_actions": 3.7197256659355434e-05}}, "connector_pipeline_timer": 0.0001166552262789098}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8710474777021377e-06, "numpy_to_tensor": 1.2494088747251658e-05, "add_states_from_episodes_to_batch": 2.8823613932249954e-06, "batch_individual_items": 1.255539387046583e-05, "add_time_dim_to_batch_and_zero_pad": 7.10448817428374e-06}}, "connector_pipeline_timer": 6.0559820552030295e-05}, "num_agent_steps_sampled": {"default_agent": 400}, "rlmodule_inference_timer": 3.204356442638377e-05, "episode_duration_sec_mean": 0.005765310414135456, "num_env_steps_sampled_lifetime": 85400, "episode_len_mean": 20.0, "num_episodes_lifetime": 340, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "num_episodes": 20, "env_step_timer": 1.438702705524415e-05, "weights_seq_no": 17.0, "episode_return_min": -13.5, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.2, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "agent_episode_returns_mean": {"default_agent": 1.2}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "episode_len_max": 20, "env_reset_timer": 0.0005978008425802974, "episode_return_max": 13.5, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "sample": 0.12021039979076714, "time_between_sampling": 9.693641193521088}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "b4968_00000", "date": "2025-08-11_18-17-54", "timestamp": 1754929074, "time_this_iter_s": 10.119216203689575, "time_total_s": 179.30835056304932, "pid": 10564, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x141ef98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 179.30835056304932, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 40.38, "ram_util_percent": 81.24666666666667}}
{"timers": {"training_iteration": 10.581459563591999, "restore_env_runners": 1.2919063014697013e-05, "training_step": 10.581206102485929, "env_runner_sampling_timer": 1.669848894032701, "learner_update_timer": 8.72212850104868, "synch_weights": 0.0018307425150897528, "restore_eval_env_runners": 5.928131591022612e-05, "evaluation_iteration": 0.1325928490024156, "synch_eval_env_connectors": 0.0002616388387285359, "synch_env_connectors": 5.385450258295798e-06}, "env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 9.212057233002669e-06, "numpy_to_tensor": 1.807727114966997e-05, "add_states_from_episodes_to_batch": 3.375708366967029e-06, "batch_individual_items": 1.5651136610233084e-05, "add_observations_from_episodes_to_batch": 4.4203960254841415e-06}}, "connector_pipeline_timer": 7.795447813351689e-05}, "num_env_steps_sampled_lifetime": -9870000.0, "episode_return_mean": -1.74, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": -1.74}, "module_episode_returns_mean": {"default_policy": -1.74}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.0071031250486762775, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.101846218529951e-05, "remove_single_ts_time_rank_from_batch": 1.576536287021818e-05, "normalize_and_clip_actions": 1.0403186388697228e-05, "get_actions": 6.468004159349979e-05, "listify_data_for_vector_env": 1.3490217790957806e-05, "un_batch_to_individual_items": 8.38623816393921e-06}}, "connector_pipeline_timer": 0.00016700385158433152}, "time_between_sampling": 0.035042928762219566, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 6.5, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "episode_len_mean": 20.0, "num_episodes": 250.0, "num_episodes_lifetime": -493500.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "rlmodule_inference_timer": 4.607256615382602e-05, "episode_duration_sec_mean": 0.007278484141919761, "weights_seq_no": 17.0, "env_step_timer": 1.936578147563853e-05, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "env_reset_timer": 5.566013809084467e-05, "num_env_steps_sampled_lifetime_throughput": 2734.5617984378896}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.14944351814304335, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008972313323026001, "add_observations_from_episodes_to_batch": 0.0009077841879043065, "add_columns_from_episodes_to_train_batch": 0.04149472632142999, "add_time_dim_to_batch_and_zero_pad": 0.07653723990100705, "add_states_from_episodes_to_batch": 0.004055132018647146, "batch_individual_items": 0.017210441997844557, "numpy_to_tensor": 7.603193548611424e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_env_steps_trained": 33000, "num_trainable_parameters": 24861, "num_module_steps_trained": 11970, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 215460, "num_env_steps_trained_lifetime": 594000, "num_env_steps_trained_lifetime_throughput": 3889.446243872493, "num_module_steps_trained_throughput": 20638599.43275906, "num_module_steps_trained_lifetime_throughput": 12647888.339923145}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1292760, "num_env_steps_trained_lifetime": 3564000, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 40582.008708505964}, "default_policy": {"vf_loss_unclipped": 42.93767166137695, "module_train_batch_size_mean": 997.4982334615715, "num_module_steps_trained_lifetime": 646380, "diff_num_grad_updates_vs_sampler_policy": 91.0, "vf_loss": 0.3588608205318451, "total_loss": 0.27845752239227295, "vf_explained_var": 0.004730403423309326, "mean_kl_loss": 1.6816851712064818e-05, "policy_loss": -7.51749612390995e-05, "entropy": 0.6745677590370178, "weights_seq_no": 108.0, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35910}, "intrinsic_reward_module": {"weights_seq_no": 108.0, "num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.4982334615715, "num_module_steps_trained_lifetime": 646380, "diff_num_grad_updates_vs_sampler_policy": 91.0, "total_loss": 0.0}}}, "IntrinsicAttentionMask": [[[0.09318125247955322, 0.09133920073509216, 0.09142173081636429, 0.08801552653312683, 0.0880950465798378, 0.09184842556715012, 0.09175257384777069, 0.08816220611333847, 0.0919184461236, 0.09200148284435272, 0.0922641009092331], [0.08871963620185852, 0.09045881778001785, 0.09037942439317703, 0.09377843886613846, 0.09369613230228424, 0.0899711549282074, 0.09006254374980927, 0.09362673759460449, 0.08990451693534851, 0.08982560783624649, 0.08957701176404953], [0.08891969174146652, 0.09050145745277405, 0.09042930603027344, 0.09351291507482529, 0.09343836456537247, 0.09005821496248245, 0.09014129638671875, 0.09337551146745682, 0.08999763429164886, 0.08992588520050049, 0.08969981968402863], [0.08066093176603317, 0.08847986161708832, 0.08811037242412567, 0.1050604060292244, 0.10462167859077454, 0.08622955530881882, 0.08664777874946594, 0.10425291210412979, 0.0859256163239479, 0.08556679636240005, 0.0844440758228302], [0.08085358887910843, 0.08853336423635483, 0.08817075937986374, 0.10477690398693085, 0.10434776544570923, 0.08632450550794601, 0.08673511445522308, 0.10398703068494797, 0.08602607995271683, 0.0856737345457077, 0.08457111567258835], [0.08995384722948074, 0.09071703255176544, 0.09068237245082855, 0.09215104579925537, 0.09211583435535431, 0.09050387889146805, 0.09054387360811234, 0.09208614379167557, 0.0904747024178505, 0.09044013172388077, 0.09033112972974777], [0.08972156047821045, 0.09066930413246155, 0.09062621742486954, 0.09245535731315613, 0.09241142868995667, 0.09040440618991852, 0.0904540941119194, 0.09237437695264816, 0.09036815911531448, 0.09032522141933441, 0.09018982946872711], [0.08101630955934525, 0.08857830613851547, 0.08822151273488998, 0.10453801602125168, 0.10411693155765533, 0.0864044800400734, 0.08680864423513412, 0.10376294702291489, 0.08611071109771729, 0.08576386421918869, 0.08467824012041092], [0.09012351930141449, 0.09075164049863815, 0.09072313457727432, 0.0919293537735939, 0.09190047532320023, 0.09057630598545074, 0.09060920774936676, 0.09187611937522888, 0.09055230021476746, 0.0905238538980484, 0.09043414890766144], [0.09032472968101501, 0.09079239517450333, 0.09077119082212448, 0.09166702628135681, 0.09164562076330185, 0.0906619280576706, 0.09068641811609268, 0.09162755310535431, 0.09064406156539917, 0.09062289446592331, 0.09055611491203308], [0.09096091985702515, 0.09091931581497192, 0.09092120081186295, 0.09084214270114899, 0.09084402024745941, 0.09093090146780014, 0.09092872589826584, 0.09084560722112656, 0.09093248844146729, 0.0909343734383583, 0.09094030410051346]], [[0.10029806941747665, 0.08448377251625061, 0.08417058736085892, 0.09839566797018051, 0.09803090989589691, 0.09845276176929474, 0.08292941749095917, 0.0826219916343689, 0.08951007574796677, 0.09661337733268738, 0.08449340611696243], [0.09088899940252304, 0.09092303365468979, 0.09092377126216888, 0.09089279174804688, 0.09089352935552597, 0.09089267253875732, 0.09092672169208527, 0.09092745929956436, 0.09091156721115112, 0.09089642018079758, 0.0909230187535286], [0.09068936109542847, 0.09106162935495377, 0.09106970578432083, 0.09073082357645035, 0.09073887765407562, 0.09072957187891006, 0.0911020040512085, 0.09111008793115616, 0.0909360721707344, 0.0907704308629036, 0.09106138348579407], [0.09923112392425537, 0.08520466834306717, 0.08492407947778702, 0.0975576862692833, 0.09723641723394394, 0.09760796278715134, 0.0838109478354454, 0.08353494852781296, 0.08969222754240036, 0.09598661959171295, 0.08521329611539841], [0.09902465343475342, 0.08534445613622665, 0.08507025986909866, 0.0973951444029808, 0.0970822349190712, 0.09744411706924438, 0.08398225903511047, 0.08371244370937347, 0.08972681313753128, 0.09586470574140549, 0.08535288274288177], [0.09926339238882065, 0.08518283814191818, 0.08490125089883804, 0.09758307784795761, 0.0972604975104332, 0.09763356298208237, 0.08378420025110245, 0.083507239818573, 0.0896868035197258, 0.09600565582513809, 0.08519149571657181], [0.0898926705121994, 0.09161555022001266, 0.09165320545434952, 0.09008333086967468, 0.0901203528046608, 0.09007754921913147, 0.09180396795272827, 0.09184170514345169, 0.09103161841630936, 0.09026570618152618, 0.09161439538002014], [0.08969394862651825, 0.09175389260053635, 0.09179900586605072, 0.08992153406143188, 0.08996573835611343, 0.08991463482379913, 0.09197964519262314, 0.09202486276626587, 0.09105485677719116, 0.09013931453227997, 0.09175251424312592], [0.09401843696832657, 0.08876101672649384, 0.08865053206682205, 0.09341657906770706, 0.09330030530691147, 0.09343475848436356, 0.08820997178554535, 0.08810018002986908, 0.09049807488918304, 0.09284567087888718, 0.08876441419124603], [0.09821637719869614, 0.08589253574609756, 0.08564363420009613, 0.096757672727108, 0.09647728502750397, 0.09680154919624329, 0.08465523272752762, 0.0844099149107933, 0.08986016362905502, 0.09538546949625015, 0.0859001874923706], [0.09089513123035431, 0.09091879427433014, 0.09091930091381073, 0.09089776873588562, 0.09089828282594681, 0.09089769423007965, 0.09092134982347488, 0.09092186391353607, 0.09091082215309143, 0.09090028703212738, 0.09091877192258835]], [[0.09749194979667664, 0.09722534567117691, 0.0856710746884346, 0.09612506628036499, 0.09586220234632492, 0.08446992933750153, 0.09590321779251099, 0.0845060721039772, 0.09537941217422485, 0.08404451608657837, 0.08332125842571259], [0.09729769825935364, 0.09703943878412247, 0.08582612127065659, 0.09597339481115341, 0.09571865946054459, 0.08465795964002609, 0.09575840830802917, 0.08469311147928238, 0.09525074064731598, 0.08424410969018936, 0.08354037255048752], [0.08836769312620163, 0.08846177905797958, 0.09291991591453552, 0.08885392546653748, 0.08894852548837662, 0.09343119710683823, 0.08893374353647232, 0.09341566264629364, 0.08912323415279388, 0.09361470490694046, 0.09392967075109482], [0.09649062156677246, 0.0962667390704155, 0.08647006750106812, 0.0953417643904686, 0.09512054920196533, 0.08544051647186279, 0.09515506774187088, 0.08547152578830719, 0.09471400827169418, 0.08507534861564636, 0.08445386588573456], [0.09629649668931961, 0.09608079493045807, 0.0866248682141304, 0.09518948942422867, 0.0949762687087059, 0.08562903851270676, 0.09500954300165176, 0.08565904200077057, 0.0945843979716301, 0.08527573198080063, 0.08467432111501694], [0.08737925440073013, 0.08750864118337631, 0.09369983524084091, 0.08804842829704285, 0.08817880600690842, 0.09441741555929184, 0.08815842866897583, 0.09439560025930405, 0.08841969072818756, 0.09467534720897675, 0.09511850774288177], [0.09632682055234909, 0.09610984474420547, 0.08660069108009338, 0.09521327912807465, 0.0949988141655922, 0.08559958636760712, 0.09503228962421417, 0.08562974631786346, 0.09460465610027313, 0.08524442464113235, 0.08463986963033676], [0.08740916848182678, 0.0875374972820282, 0.09367625415325165, 0.08807286620140076, 0.08820215612649918, 0.09438753128051758, 0.08818195015192032, 0.09436590224504471, 0.08844105899333954, 0.09464318305253983, 0.09508241713047028], [0.09593866020441055, 0.095737986266613, 0.086910180747509, 0.09490842372179031, 0.09470990300178528, 0.08597689867019653, 0.09474088996648788, 0.08600502461194992, 0.09434496611356735, 0.08564560860395432, 0.08508146554231644], [0.08702634274959564, 0.08716815710067749, 0.09397799521684647, 0.08776000887155533, 0.08790300786495209, 0.09477026015520096, 0.08788065612316132, 0.0947461649775505, 0.08816728740930557, 0.09505517780780792, 0.09554490447044373], [0.08642292022705078, 0.08658576011657715, 0.09445320069789886, 0.08726583421230316, 0.08743025362491608, 0.09537442773580551, 0.08740455657243729, 0.09534639120101929, 0.08773423731327057, 0.0957060307264328, 0.09627633541822433]], [[0.09092627465724945, 0.09091968834400177, 0.09091310203075409, 0.09119047969579697, 0.09088572859764099, 0.09089334309101105, 0.09088675677776337, 0.09088017046451569, 0.0907246395945549, 0.09085990488529205, 0.09091988950967789], [0.09090716391801834, 0.09090790152549744, 0.09090863913297653, 0.09087765961885452, 0.09091170132160187, 0.09091085195541382, 0.09091158956289291, 0.09091231971979141, 0.09092974662780762, 0.09091459214687347, 0.09090788662433624], [0.09088790416717529, 0.09089595824480057, 0.09090401977300644, 0.0905657634139061, 0.0909375250339508, 0.09092820435762405, 0.09093626588582993, 0.0909443274140358, 0.09113515913486481, 0.09096915274858475, 0.09089571237564087], [0.0915713682770729, 0.09126981347799301, 0.0909692570567131, 0.10450215637683868, 0.0897306352853775, 0.09007350355386734, 0.08977688103914261, 0.08948123455047607, 0.08276879042387009, 0.08857730776071548, 0.0912790596485138], [0.09080633521080017, 0.09084480255842209, 0.0908832848072052, 0.08927934616804123, 0.0910433903336525, 0.0909988284111023, 0.09103737026453018, 0.09107593446969986, 0.0919923260807991, 0.09119473397731781, 0.09084362536668777], [0.0908292755484581, 0.09085927903652191, 0.09088930487632751, 0.08963561803102493, 0.09101418405771255, 0.09097941964864731, 0.0910094827413559, 0.09103955328464508, 0.09175331890583038, 0.09113217145204544, 0.09085836261510849], [0.09080944955348969, 0.09084676951169968, 0.09088411182165146, 0.08932741731405258, 0.09103945642709732, 0.09099622070789337, 0.09103361517190933, 0.09107103198766708, 0.09196001291275024, 0.0911862924695015, 0.09084562957286835], [0.09078948199748993, 0.0908341109752655, 0.09087876230478287, 0.08902011811733246, 0.09106458723545074, 0.0910128578543663, 0.09105759114027023, 0.09110236167907715, 0.09216701239347458, 0.0912402868270874, 0.09083274006843567], [0.09027748554944992, 0.09049403667449951, 0.09071111679077148, 0.08201826363801956, 0.09161894768476486, 0.09136549383401871, 0.09158466011285782, 0.09180436283349991, 0.09715434908866882, 0.09248392283916473, 0.09048738330602646], [0.09072715044021606, 0.09079427272081375, 0.09086143225431442, 0.08808000385761261, 0.09114110469818115, 0.09106322377920151, 0.0911305770277977, 0.09119799733161926, 0.09280622005462646, 0.09140580147504807, 0.0907922089099884], [0.0909077376127243, 0.09090825915336609, 0.09090876579284668, 0.09088724106550217, 0.0909108966588974, 0.09091030806303024, 0.09091081470251083, 0.09091132879257202, 0.09092343598604202, 0.09091290831565857, 0.0909082368016243]], [[0.09352625906467438, 0.09167739003896713, 0.09176021814346313, 0.0920221358537674, 0.09210528433322906, 0.09218849241733551, 0.08840874582529068, 0.0884886309504509, 0.08856857568025589, 0.08864859491586685, 0.09260571002960205], [0.08839889615774155, 0.09013178944587708, 0.09005267918109894, 0.08980345726013184, 0.08972464501857758, 0.0896458849310875, 0.09337020665407181, 0.09328825771808624, 0.09320638328790665, 0.09312456846237183, 0.08925317972898483], [0.08862776309251785, 0.09020433574914932, 0.09013242274522781, 0.08990583568811417, 0.08983416855335236, 0.08976254612207413, 0.09314320981502533, 0.09306895732879639, 0.09299476444721222, 0.09292063117027283, 0.08940533548593521], [0.08935203403234482, 0.09043167531490326, 0.09038256853818893, 0.09022773057222366, 0.0901787281036377, 0.09012974798679352, 0.09242831915616989, 0.09237811714410782, 0.09232795238494873, 0.09227780997753143, 0.08988527208566666], [0.08958210796117783, 0.09050318598747253, 0.09046132117509842, 0.09032931923866272, 0.09028753638267517, 0.09024576842784882, 0.0922023132443428, 0.09215965867042542, 0.09211703389883041, 0.0920744240283966, 0.09003724157810211], [0.08981248736381531, 0.0905744656920433, 0.09053986519575119, 0.09043072909116745, 0.09039618074893951, 0.09036164730787277, 0.09197656810283661, 0.09194142371416092, 0.09190630167722702, 0.09187118709087372, 0.09018916636705399], [0.07944723963737488, 0.08701764047145844, 0.08666014671325684, 0.08554142713546753, 0.08519000560045242, 0.08484002202749252, 0.10267899930477142, 0.10225716978311539, 0.10183706879615784, 0.10141868889331818, 0.08311156183481216], [0.07966385781764984, 0.08709962666034698, 0.08674878627061844, 0.08565069735050201, 0.08530569821596146, 0.08496208488941193, 0.10244342684745789, 0.10203078389167786, 0.10161980241537094, 0.10121046751737595, 0.08326466381549835], [0.07988081872463226, 0.08718141168355942, 0.08683723211288452, 0.08575984090566635, 0.08542127907276154, 0.08508405089378357, 0.10220806300640106, 0.10180456936359406, 0.1014026626944542, 0.10100235044956207, 0.08341778814792633], [0.08009807020425797, 0.08726295083761215, 0.0869254618883133, 0.08586879819631577, 0.08553669601678848, 0.08520587533712387, 0.10197287052869797, 0.1015784814953804, 0.1011856272816658, 0.10079428553581238, 0.08357088267803192], [0.09096865355968475, 0.09092704951763153, 0.09092893451452255, 0.0909348651766777, 0.09093675017356873, 0.09093862771987915, 0.09085144847631454, 0.09085333347320557, 0.09085521101951599, 0.09085708856582642, 0.09094803780317307]], [[0.10324829816818237, 0.1028655543923378, 0.0866464376449585, 0.0856366977095604, 0.08531924337148666, 0.10134871304035187, 0.08536875993013382, 0.10059870034456253, 0.07790330797433853, 0.08408552408218384, 0.0869787409901619], [0.10297361761331558, 0.10260016471147537, 0.08674515038728714, 0.08575606346130371, 0.08544505387544632, 0.10111980885267258, 0.0854935571551323, 0.10038766264915466, 0.0781722143292427, 0.08423612266778946, 0.08707060664892197], [0.09062321484088898, 0.09063125401735306, 0.09100328385829926, 0.09102875739336014, 0.0910368263721466, 0.09066340327262878, 0.09103556722402573, 0.09067948162555695, 0.09123467653989792, 0.09106849133968353, 0.09099496901035309], [0.08980586379766464, 0.08983665704727173, 0.09127137064933777, 0.09137021750211716, 0.09140155464410782, 0.08995997905731201, 0.09139665961265564, 0.09002169966697693, 0.09217223525047302, 0.09152457118034363, 0.09123911708593369], [0.08954764902591705, 0.08958557993173599, 0.09135567396879196, 0.09147787094116211, 0.09151661396026611, 0.08973746746778488, 0.09151056408882141, 0.08981350064277649, 0.09247048199176788, 0.0916687399148941, 0.09131580591201782], [0.10187775641679764, 0.10154099017381668, 0.08713734894990921, 0.08623146265745163, 0.08594641089439392, 0.10020500421524048, 0.08599087595939636, 0.09954360872507095, 0.07925374805927277, 0.08483754098415375, 0.08743523806333542], [0.0895879715681076, 0.0896247923374176, 0.09134253114461899, 0.09146107733249664, 0.09149866551160812, 0.08977222442626953, 0.09149279445409775, 0.08984602987766266, 0.09242386370897293, 0.0916462391614914, 0.09130385518074036], [0.10133158415555954, 0.10101290047168732, 0.0873318612575531, 0.08646790683269501, 0.08619596064090729, 0.09974811971187592, 0.08623838424682617, 0.09912168979644775, 0.07979804277420044, 0.08513765782117844, 0.08761586248874664], [0.08334267139434814, 0.083542600274086, 0.09332171082496643, 0.09403010457754135, 0.09425566345453262, 0.08434710651636124, 0.09422039240598679, 0.08475226163864136, 0.09995037317276001, 0.09514553844928741, 0.09309154003858566], [0.0885385125875473, 0.08860400319099426, 0.09168332070112228, 0.09189754724502563, 0.09196552634239197, 0.0888664647936821, 0.09195490181446075, 0.0889979898929596, 0.09364569932222366, 0.0922326147556305, 0.09161347150802612], [0.09089092165231705, 0.09089143574237823, 0.09091509133577347, 0.090916708111763, 0.09091722220182419, 0.09089348465204239, 0.09091714024543762, 0.09089450538158417, 0.09092976152896881, 0.09091923385858536, 0.09091456234455109]]], "default_policy": {"vf_explained_var": 0.000503242015838623, "curr_entropy_coeff": 0.0015431216992, "num_trainable_parameters": 16595, "curr_kl_coeff": 6.163937769088079e-07, "policy_loss": -7.594373164465651e-05, "entropy": 0.6745657324790955, "module_train_batch_size_mean": 997.6672132667843, "weights_seq_no": 18.0, "use_intrinsic_rewards": 0.0, "num_module_steps_trained": 5985, "vf_loss_unclipped": 43.09987258911133, "num_module_steps_trained_lifetime": 107730, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.2780262529850006, "vf_loss": 0.3583117723464966, "mean_kl_loss": 1.6872993001015857e-05, "num_module_steps_trained_lifetime_throughput": 705.2177322738524}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 107730, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_trainable_parameters": 8266, "weights_seq_no": 18.0, "num_module_steps_trained": 5985, "module_train_batch_size_mean": 997.6672132667843, "num_module_steps_trained_lifetime_throughput": 705.2239980738938}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 0.4}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.930793025959254e-06, "tensor_to_numpy": 1.5611724588182366e-05, "un_batch_to_individual_items": 6.5201923319255945e-06, "remove_single_ts_time_rank_from_batch": 1.1770380762664981e-05, "listify_data_for_vector_env": 1.0546927401294694e-05, "get_actions": 3.618768406595278e-05}}, "connector_pipeline_timer": 0.00011489528917435772}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.824716769800192e-06, "numpy_to_tensor": 1.227064255830927e-05, "add_states_from_episodes_to_batch": 2.8063457582472124e-06, "batch_individual_items": 1.2552597954564052e-05, "add_time_dim_to_batch_and_zero_pad": 7.015363617718049e-06}}, "connector_pipeline_timer": 5.969266538437632e-05}, "num_agent_steps_sampled": {"default_agent": 400}, "rlmodule_inference_timer": 3.1232268573889875e-05, "episode_duration_sec_mean": 0.005614016661420465, "num_env_steps_sampled_lifetime": 90400, "episode_len_mean": 20.0, "num_episodes_lifetime": 360, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "num_episodes": 20, "env_step_timer": 1.4067063490271408e-05, "weights_seq_no": 18.0, "episode_return_min": -13.5, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 0.4, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "agent_episode_returns_mean": {"default_agent": 0.4}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "episode_len_max": 20, "env_reset_timer": 0.0005952282535656322, "episode_return_max": 13.5, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "sample": 0.12020488871331927, "time_between_sampling": 9.717112247836349}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "b4968_00000", "date": "2025-08-11_18-18-06", "timestamp": 1754929086, "time_this_iter_s": 12.136882305145264, "time_total_s": 191.44523286819458, "pid": 10564, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x141ef98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 191.44523286819458, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 64.69411764705882, "ram_util_percent": 82.09411764705882}}
{"timers": {"training_iteration": 10.575967564206413, "restore_env_runners": 1.2948622138159341e-05, "training_step": 10.575713701460874, "env_runner_sampling_timer": 1.670060382592701, "learner_update_timer": 8.71528301603823, "synch_weights": 0.0018322505097394348, "restore_eval_env_runners": 5.930475307798083e-05, "evaluation_iteration": 0.13254762718275953, "synch_eval_env_connectors": 0.0002606791206974199, "synch_env_connectors": 5.371175800980779e-06}, "env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.446177899355383e-06, "numpy_to_tensor": 1.3935276753222239e-05, "add_states_from_episodes_to_batch": 2.9185225954412233e-06, "batch_individual_items": 1.3367792190522639e-05, "add_observations_from_episodes_to_batch": 3.086115625920181e-06}}, "connector_pipeline_timer": 6.369386890932137e-05}, "num_env_steps_sampled_lifetime": -10487500.0, "episode_return_mean": -0.86, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": -0.86}, "module_episode_returns_mean": {"default_policy": -0.86}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.006838972617572418, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.6889246853566512e-05, "remove_single_ts_time_rank_from_batch": 1.2739764657406796e-05, "normalize_and_clip_actions": 8.84834714448025e-06, "get_actions": 4.5280490495216404e-05, "listify_data_for_vector_env": 1.141779518028744e-05, "un_batch_to_individual_items": 7.1174266923515675e-06}}, "connector_pipeline_timer": 0.00013015188378974002}, "time_between_sampling": 0.04026329336116082, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 6.5, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "episode_len_mean": 20.0, "num_episodes": 250.0, "num_episodes_lifetime": -524375.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "rlmodule_inference_timer": 3.572496108570948e-05, "episode_duration_sec_mean": 0.005789262369740754, "weights_seq_no": 18.0, "env_step_timer": 1.5661333402550093e-05, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "env_reset_timer": 6.0995633703203534e-05, "num_env_steps_sampled_lifetime_throughput": 3088.767883027713}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15049150463270913, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008972321849768781, "add_observations_from_episodes_to_batch": 0.0009073450963213495, "add_columns_from_episodes_to_train_batch": 0.04150348864890217, "add_time_dim_to_batch_and_zero_pad": 0.07652077250250668, "add_states_from_episodes_to_batch": 0.004050698198154902, "batch_individual_items": 0.018271830917834957, "numpy_to_tensor": 7.592703555729195e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_env_steps_trained": 33000, "num_trainable_parameters": 24861, "num_module_steps_trained": 11970, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 227430, "num_env_steps_trained_lifetime": 627000, "num_env_steps_trained_lifetime_throughput": 3874.411365148642, "num_module_steps_trained_throughput": 20188561.940395124, "num_module_steps_trained_lifetime_throughput": 12618028.189075828}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1364580, "num_env_steps_trained_lifetime": 3762000, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 40067.10941897444}, "default_policy": {"vf_loss_unclipped": 41.782466888427734, "module_train_batch_size_mean": 997.4980069784294, "num_module_steps_trained_lifetime": 682290, "diff_num_grad_updates_vs_sampler_policy": 96.0, "vf_loss": 0.35881420969963074, "total_loss": 0.278030663728714, "vf_explained_var": 0.00475919246673584, "mean_kl_loss": 1.5333873307099566e-05, "policy_loss": -0.0004669099871534854, "entropy": 0.6736145615577698, "weights_seq_no": 114.0, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35910}, "intrinsic_reward_module": {"weights_seq_no": 114.0, "num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.4980069784294, "num_module_steps_trained_lifetime": 682290, "diff_num_grad_updates_vs_sampler_policy": 96.0, "total_loss": 0.0}}}, "IntrinsicAttentionMask": [[[0.09318028390407562, 0.08768487721681595, 0.09142077714204788, 0.09168172627687454, 0.09176456183195114, 0.08817372471094131, 0.09175162017345428, 0.08816128969192505, 0.091917484998703, 0.09200052917003632, 0.09226313978433609], [0.0798395499587059, 0.10822691768407822, 0.08783173561096191, 0.08658774197101593, 0.08619729429483414, 0.10525720566511154, 0.086258165538311, 0.10533154010772705, 0.08548198640346527, 0.08509651571512222, 0.08389127254486084], [0.08891893923282623, 0.09382259845733643, 0.09042854607105255, 0.09020121395587921, 0.0901293084025383, 0.09336309134960175, 0.09014053642749786, 0.09337472170591354, 0.08999687433242798, 0.0899251252412796, 0.08969905972480774], [0.08955183625221252, 0.09288696199655533, 0.09058468043804169, 0.09042949229478836, 0.09038037806749344, 0.09257683902978897, 0.09038805216550827, 0.09258469939231873, 0.0902898982167244, 0.09024086594581604, 0.09008627384901047], [0.0897526815533638, 0.09259182959794998, 0.0906335711479187, 0.0905013158917427, 0.09045945107936859, 0.09232847392559052, 0.0904659852385521, 0.09233514219522476, 0.09038231521844864, 0.0903405025601387, 0.09020867943763733], [0.08102834224700928, 0.10623221099376678, 0.08821117877960205, 0.08709804713726044, 0.08674830198287964, 0.10363315790891647, 0.08680284768342972, 0.10369832068681717, 0.08610712736845016, 0.08576136082410812, 0.08467914909124374], [0.08972130715847015, 0.09263790398836136, 0.09062596410512924, 0.09049011766910553, 0.09044712781906128, 0.0923672616481781, 0.09045384079217911, 0.09237411618232727, 0.09036790579557419, 0.09032496064901352, 0.09018957614898682], [0.08099808543920517, 0.106282539665699, 0.08820167183876038, 0.08708519488573074, 0.08673442155122757, 0.10367422550916672, 0.08678912371397018, 0.10373961180448532, 0.08609134703874588, 0.08574457466602325, 0.08465919643640518], [0.09012339264154434, 0.09204933047294617, 0.09072301536798477, 0.0906331017613411, 0.09060463309288025, 0.09187149256467819, 0.09060908108949661, 0.09187599271535873, 0.09055217355489731, 0.09052372723817825, 0.09043402224779129], [0.09032467007637024, 0.09175600111484528, 0.0907711312174797, 0.09070423245429993, 0.09068305790424347, 0.09162415564060211, 0.0906863659620285, 0.09162750095129013, 0.09064400941133499, 0.09062284231185913, 0.09055604785680771], [0.09096091985702515, 0.09083432704210281, 0.09092120081186295, 0.0909271389245987, 0.09092901647090912, 0.09084589779376984, 0.09092872589826584, 0.09084560722112656, 0.09093248844146729, 0.0909343734383583, 0.09094030410051346]], [[0.09275423735380173, 0.08570115268230438, 0.08585463464260101, 0.09361393004655838, 0.09378158301115036, 0.08631671965122223, 0.09375537186861038, 0.09392327815294266, 0.09070535004138947, 0.0944419875741005, 0.08915169537067413], [0.08899449557065964, 0.09624365717172623, 0.09607329964637756, 0.08818523585796356, 0.08802914619445801, 0.09556403011083603, 0.08805350959300995, 0.0878976434469223, 0.09098473191261292, 0.08741961419582367, 0.09255458414554596], [0.08908338099718094, 0.09599734097719193, 0.0958351343870163, 0.08830998837947845, 0.08816078305244446, 0.09535017609596252, 0.08818406611680984, 0.08803506940603256, 0.09098406136035919, 0.08757800608873367, 0.09248193353414536], [0.0931694507598877, 0.08451863378286362, 0.0847051665186882, 0.09423460811376572, 0.09444259107112885, 0.08526726812124252, 0.09441007673740387, 0.09461844712495804, 0.0906401202082634, 0.09526272118091583, 0.08873097598552704], [0.09324938803911209, 0.08429045230150223, 0.08448329567909241, 0.09435464441776276, 0.09457051008939743, 0.08506447821855545, 0.09453675895929337, 0.09475304186344147, 0.09062670171260834, 0.09542189538478851, 0.08864884823560715], [0.08934902399778366, 0.09526050090789795, 0.09512253105640411, 0.08868376910686493, 0.08855532854795456, 0.09470982104539871, 0.08857537806034088, 0.08844709396362305, 0.09098044782876968, 0.08805336803197861, 0.09226269274950027], [0.09323690086603165, 0.08432606607675552, 0.08451792597770691, 0.0943358913064003, 0.09455052018165588, 0.08509612828493118, 0.09451696276664734, 0.09473200887441635, 0.09062879532575607, 0.09539701789617538, 0.08866167813539505], [0.0933166891336441, 0.08409822732210159, 0.08429636061191559, 0.09445584565401077, 0.0946783795952797, 0.08489356189966202, 0.09464358538389206, 0.0948665589094162, 0.0906151756644249, 0.09555620700120926, 0.08857941627502441], [0.09172829985618591, 0.08860587328672409, 0.08867532759904861, 0.0920996367931366, 0.09217182546854019, 0.08888401091098785, 0.09216054528951645, 0.09223278611898422, 0.09083542972803116, 0.09245549887418747, 0.09015078842639923], [0.09356105327606201, 0.08339930325746536, 0.08361651748418808, 0.09482436627149582, 0.09507133811712265, 0.08427157253026962, 0.0950327143073082, 0.0952802374958992, 0.09057164937257767, 0.09604617208242416, 0.0883251279592514], [0.09091504663228989, 0.09089240431785583, 0.09089291840791702, 0.0909176841378212, 0.09091819077730179, 0.09089445322751999, 0.09091811627149582, 0.09091862291097641, 0.09090864658355713, 0.09092020243406296, 0.09090369939804077]], [[0.09352542459964752, 0.09167657047510147, 0.09175939857959747, 0.08834061771631241, 0.08842042833566666, 0.09218767285346985, 0.09209146350622177, 0.08848783373832703, 0.09225794672966003, 0.08864780515432358, 0.09260488301515579], [0.08839814364910126, 0.09013102948665619, 0.09005191922187805, 0.09343861788511276, 0.09335660934448242, 0.08964512497186661, 0.08973618596792221, 0.09328746795654297, 0.08957873284816742, 0.09312377870082855, 0.08925241976976395], [0.08862713724374771, 0.09020370244979858, 0.09013178944587708, 0.09320525079965591, 0.09313094615936279, 0.08976192027330399, 0.0898447185754776, 0.09306829422712326, 0.08970153331756592, 0.0929199755191803, 0.08940470218658447], [0.07924894243478775, 0.08693099766969681, 0.08656798303127289, 0.10322129726409912, 0.10279025137424469, 0.08472008258104324, 0.08513098955154419, 0.10242793709039688, 0.08442147076129913, 0.10157424956560135, 0.08296586573123932], [0.07946586608886719, 0.08701382577419281, 0.08665744215250015, 0.10297857224941254, 0.10255680233240128, 0.08484287559986115, 0.08524643629789352, 0.10220225900411606, 0.08454957604408264, 0.10136678069829941, 0.08311958611011505], [0.08981233835220337, 0.09057431668043137, 0.09053971618413925, 0.09200607985258102, 0.09197092801332474, 0.09036150574684143, 0.09040143340826035, 0.09194128215312958, 0.09033237397670746, 0.09187104552984238, 0.09018902480602264], [0.08954593539237976, 0.09049182385206223, 0.09044882655143738, 0.09227438271045685, 0.09223053604364395, 0.09022743999958038, 0.0902770385146141, 0.09219355881214142, 0.09019126743078232, 0.09210596978664398, 0.090013287961483], [0.07964915037155151, 0.08708353340625763, 0.08673276007175446, 0.10277391970157623, 0.10235994309186935, 0.08494638651609421, 0.08534373342990875, 0.10201193392276764, 0.08465757966041565, 0.10119177401065826, 0.0832492858171463], [0.0900069922208786, 0.0906343013048172, 0.09060584008693695, 0.09181049466133118, 0.09178165346384048, 0.0904591977596283, 0.09049205482006073, 0.09175732731819153, 0.0904352217912674, 0.09169970452785492, 0.09031721949577332], [0.08008444309234619, 0.08724810183048248, 0.0869106650352478, 0.10228943079710007, 0.1018938198685646, 0.08519137650728226, 0.08557392656803131, 0.10156120359897614, 0.08491327613592148, 0.10077713429927826, 0.08355666697025299], [0.09096865355968475, 0.09092704951763153, 0.09092893451452255, 0.0908498615026474, 0.09085173904895782, 0.09093862771987915, 0.09093645960092545, 0.09085333347320557, 0.09094022214412689, 0.09085708856582642, 0.09094803780317307]], [[0.0907909944653511, 0.09078441560268402, 0.09077783674001694, 0.09075707942247391, 0.0910482108592987, 0.09105583280324936, 0.09104923158884048, 0.09104263782501221, 0.09088683128356934, 0.09102233499288559, 0.09078461676836014], [0.09092230349779129, 0.09092304110527039, 0.09092377871274948, 0.09092610329389572, 0.09089352935552597, 0.09089267998933792, 0.09089341759681702, 0.09089415520429611, 0.09091157466173172, 0.09089642018079758, 0.0909230187535286], [0.09105358272790909, 0.09106165915727615, 0.09106973558664322, 0.0910952240228653, 0.09073890745639801, 0.09072960168123245, 0.09073764830827713, 0.09074569493532181, 0.09093610942363739, 0.09077046066522598, 0.09106141328811646], [0.09146773815155029, 0.09149910509586334, 0.09153049439191818, 0.09162961691617966, 0.09025115519762039, 0.09021537750959396, 0.09024631977081299, 0.0902772769331932, 0.0910121351480484, 0.09037262201309204, 0.09149814397096634], [0.08564817160367966, 0.08537299931049347, 0.08509872108697891, 0.08423877507448196, 0.09711471199989319, 0.09747671335935593, 0.09716353565454483, 0.09685137867927551, 0.08975683152675629, 0.09589677304029465, 0.08538143336772919], [0.08549561351537704, 0.08521300554275513, 0.08493132144212723, 0.08404836058616638, 0.09729494154453278, 0.0976681336760521, 0.0973452776670456, 0.09702349454164505, 0.08971856534481049, 0.09603965282440186, 0.08522165566682816], [0.08562756329774857, 0.0853513851761818, 0.08507610112428665, 0.08421304821968079, 0.09713906049728394, 0.09750257432460785, 0.09718810021877289, 0.09687463194131851, 0.08975168317556381, 0.09591608494520187, 0.0853598490357399], [0.0857594832777977, 0.08548977226018906, 0.08522090315818787, 0.08437784016132355, 0.09698318690061569, 0.09733704477548599, 0.09703091531991959, 0.09672574698925018, 0.08978458493947983, 0.09579242765903473, 0.08549803495407104], [0.08887607604265213, 0.088765449821949, 0.08865496516227722, 0.08830714225769043, 0.09330496937036514, 0.09343942999839783, 0.09332312643527985, 0.0932069644331932, 0.09050259739160538, 0.09285031259059906, 0.0887688472867012], [0.08616558462381363, 0.08591589331626892, 0.08566692471504211, 0.0848858505487442, 0.09650351852178574, 0.09682786464691162, 0.09654727578163147, 0.09626750648021698, 0.08988460153341293, 0.09541140496730804, 0.08592354506254196], [0.09091828018426895, 0.09091878682374954, 0.09091930091381073, 0.09092091768980026, 0.09089828282594681, 0.09089769423007965, 0.09089820086956024, 0.09089871495962143, 0.09091082215309143, 0.09090029448270798, 0.09091877192258835]], [[0.0964270606637001, 0.09616336226463318, 0.08473530411720276, 0.08400610089302063, 0.09481512010097504, 0.09455583244562149, 0.09485568106174469, 0.09459628909826279, 0.08335445821285248, 0.09407962113618851, 0.08241115510463715], [0.0962652638554573, 0.0960097461938858, 0.0849154144525528, 0.08420606702566147, 0.09470297396183014, 0.09445160627365112, 0.0947423055768013, 0.09449083358049393, 0.08357200771570206, 0.09398987889289856, 0.08265391737222672], [0.08875833451747894, 0.08885283768177032, 0.09333068132400513, 0.09364469349384308, 0.08934173732995987, 0.08943686634302139, 0.0893268883228302, 0.08942200243473053, 0.09392852336168289, 0.08961252868175507, 0.09434489905834198], [0.08824427425861359, 0.08836070448160172, 0.09391050785779953, 0.09430211782455444, 0.08896345645189285, 0.08908083289861679, 0.08894513547420502, 0.08906248211860657, 0.09465636312961578, 0.08929764479398727, 0.09517648816108704], [0.09543035924434662, 0.09521660208702087, 0.08584572374820709, 0.08524028956890106, 0.0941220074892044, 0.09391118586063385, 0.09415498375892639, 0.09394408017396927, 0.08469843864440918, 0.09352369606494904, 0.08391271531581879], [0.09526830911636353, 0.09506257623434067, 0.08602644503116608, 0.0854414626955986, 0.09400879591703415, 0.09380577504634857, 0.09404055029153824, 0.09383746236562729, 0.08491779118776321, 0.09343260526657104, 0.08415820449590683], [0.09545565396547318, 0.09524064511060715, 0.08581748604774475, 0.08520886301994324, 0.09413965791463852, 0.09392761439085007, 0.09417282789945602, 0.093960702419281, 0.08466418832540512, 0.09353789687156677, 0.08387439697980881], [0.09529362618923187, 0.09508663415908813, 0.08599821478128433, 0.08541002869606018, 0.09402649104595184, 0.09382225573062897, 0.09405843168497086, 0.09385412931442261, 0.08488350361585617, 0.09344685822725296, 0.08411982655525208], [0.08778109401464462, 0.08791705220937729, 0.0944332554936409, 0.09489563852548599, 0.08862140029668808, 0.08875865489244461, 0.08859997987747192, 0.08873720467090607, 0.09531418979167938, 0.0890122801065445, 0.09592923521995544], [0.09496945887804031, 0.09477844834327698, 0.08635995537042618, 0.08581292629241943, 0.09379962831735611, 0.0936109647154808, 0.09382913261651993, 0.09364040940999985, 0.08532300591468811, 0.09326411038637161, 0.08461201936006546], [0.08710417151451111, 0.08726829290390015, 0.09519775211811066, 0.09576503187417984, 0.08811944723129272, 0.08828548341989517, 0.08809354156255722, 0.08825952559709549, 0.09627904742956161, 0.08859243243932724, 0.09703525900840759]], [[0.09447067230939865, 0.09429585188627243, 0.08656220883131027, 0.086057648062706, 0.08589839935302734, 0.09359981119632721, 0.09342660754919052, 0.08576425909996033, 0.09668056666851044, 0.09272357076406479, 0.09052041918039322], [0.09431654214859009, 0.09414959698915482, 0.08675023913383484, 0.08626651018857956, 0.0861138105392456, 0.09348475933074951, 0.09331928193569183, 0.08598517626523972, 0.09642580896615982, 0.092647485435009, 0.0905407965183258], [0.08712710440158844, 0.08729720115661621, 0.09552882611751556, 0.09611870348453522, 0.09630635380744934, 0.08798091858625412, 0.088152676820755, 0.09646497666835785, 0.08503130078315735, 0.08885663002729416, 0.09113537520170212], [0.08663242310285568, 0.08682362735271454, 0.09613331407308578, 0.09680458158254623, 0.09701823443174362, 0.08759267628192902, 0.0877859964966774, 0.09719888120889664, 0.08428055793046951, 0.08857882022857666, 0.09115085005760193], [0.08647563308477402, 0.08667347580194473, 0.09632492065429688, 0.09702219069004059, 0.09724416583776474, 0.08746937662363052, 0.0876694917678833, 0.09743185341358185, 0.0840434581041336, 0.08849033713340759, 0.09115508943796158], [0.09369926899671555, 0.09356356412172318, 0.08750336617231369, 0.08710398524999619, 0.08697783201932907, 0.09302268922328949, 0.09288796037435532, 0.08687152713537216, 0.09541013091802597, 0.09234053641557693, 0.09061916172504425], [0.09354475885629654, 0.09341679513454437, 0.08769188821315765, 0.08731385320425034, 0.08719442039728165, 0.09290670603513718, 0.09277961403131485, 0.0870937630534172, 0.09515704214572906, 0.09226313978433609, 0.09063795208930969], [0.08634332567453384, 0.08654674142599106, 0.0964866355061531, 0.09720592200756073, 0.09743493050336838, 0.08736523240804672, 0.08757106214761734, 0.09762859344482422, 0.08384368568658829, 0.0884154886007309, 0.09115839749574661], [0.09638772904872894, 0.09611265361309052, 0.08422411233186722, 0.08346780389547348, 0.08322959393262863, 0.09502017498016357, 0.09474900364875793, 0.0830291286110878, 0.09988879412412643, 0.09365111589431763, 0.09023989737033844], [0.0929139032959938, 0.09281729906797409, 0.088461734354496, 0.08817175775766373, 0.08808008581399918, 0.09243186563253403, 0.0923357605934143, 0.08800280094146729, 0.09412845969200134, 0.0919448584318161, 0.09071138501167297], [0.09089820832014084, 0.09089872241020203, 0.09092237800359726, 0.09092399477958679, 0.09092450886964798, 0.09090077131986618, 0.09090127795934677, 0.0909249410033226, 0.09089181572198868, 0.09090336412191391, 0.09091001749038696]]], "default_policy": {"vf_explained_var": 0.0012434124946594238, "curr_entropy_coeff": 0.0015431216992, "num_trainable_parameters": 16595, "curr_kl_coeff": 3.0819688845440396e-07, "policy_loss": -0.0004964703693985939, "entropy": 0.673547089099884, "module_train_batch_size_mean": 997.6572809365935, "weights_seq_no": 19.0, "use_intrinsic_rewards": 0.0, "num_module_steps_trained": 5985, "vf_loss_unclipped": 41.86454391479492, "num_module_steps_trained_lifetime": 113715, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.2776075005531311, "vf_loss": 0.35831204056739807, "mean_kl_loss": 1.730907206365373e-05, "num_module_steps_trained_lifetime_throughput": 702.4983028743582}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 113715, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_trainable_parameters": 8266, "weights_seq_no": 19.0, "num_module_steps_trained": 5985, "module_train_batch_size_mean": 997.6572809365935, "num_module_steps_trained_lifetime_throughput": 702.5041772438981}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 0.6}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.074314500489959e-05, "tensor_to_numpy": 2.3677564667884574e-05, "un_batch_to_individual_items": 7.933051461637401e-06, "remove_single_ts_time_rank_from_batch": 1.4733868488812108e-05, "listify_data_for_vector_env": 1.3389033865892983e-05, "get_actions": 6.0507862692161714e-05}}, "connector_pipeline_timer": 0.00016899681228596335}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.960231566221267e-06, "numpy_to_tensor": 1.674582532375146e-05, "add_states_from_episodes_to_batch": 5.770521256197068e-06, "batch_individual_items": 1.765596214128036e-05, "add_time_dim_to_batch_and_zero_pad": 9.83636160370185e-06}}, "connector_pipeline_timer": 9.184437267508972e-05}, "num_agent_steps_sampled": {"default_agent": 400}, "rlmodule_inference_timer": 4.6812563250573906e-05, "episode_duration_sec_mean": 0.005632057453040034, "num_env_steps_sampled_lifetime": 95400, "episode_len_mean": 20.0, "num_episodes_lifetime": 380, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "num_episodes": 20, "env_step_timer": 2.0042930043157985e-05, "weights_seq_no": 19.0, "episode_return_min": -12.5, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 0.6, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "agent_episode_returns_mean": {"default_agent": 0.6}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "episode_len_max": 20, "env_reset_timer": 0.0005926259709271578, "episode_return_max": 13.5, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "sample": 0.12051340982657753, "time_between_sampling": 9.720649520777629}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "b4968_00000", "date": "2025-08-11_18-18-17", "timestamp": 1754929097, "time_this_iter_s": 10.198276996612549, "time_total_s": 201.64350986480713, "pid": 10564, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x141ef98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 201.64350986480713, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 37.56000000000001, "ram_util_percent": 80.86}}
{"timers": {"training_iteration": 10.577458105224672, "restore_env_runners": 1.323454536626567e-05, "training_step": 10.577200956526731, "env_runner_sampling_timer": 1.677037293766646, "learner_update_timer": 8.708145811708121, "synch_weights": 0.0018276763340076664, "restore_eval_env_runners": 5.9313374854999166e-05, "evaluation_iteration": 0.1328394559114774, "synch_eval_env_connectors": 0.00026189983011316517, "synch_env_connectors": 5.389964012945132e-06}, "env_runners": {"episode_len_min": 20, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.343455965656805e-05, "numpy_to_tensor": 1.9890662725175764e-05, "add_states_from_episodes_to_batch": 3.5689881234055215e-06, "batch_individual_items": 1.7284091940718963e-05, "add_observations_from_episodes_to_batch": 4.92840846223453e-06}}, "connector_pipeline_timer": 8.837340298560291e-05}, "num_env_steps_sampled_lifetime": -11105000.0, "episode_return_mean": -1.5800000000000005, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": -1.5800000000000005}, "module_episode_returns_mean": {"default_policy": -1.5800000000000005}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.008415668279829121, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.2947105215634012e-05, "remove_single_ts_time_rank_from_batch": 1.6169589420202327e-05, "normalize_and_clip_actions": 1.1015851792584799e-05, "get_actions": 6.971833880493535e-05, "listify_data_for_vector_env": 1.5296774446042825e-05, "un_batch_to_individual_items": 8.909050427250289e-06}}, "connector_pipeline_timer": 0.00017914546726945573}, "time_between_sampling": 0.03556037647364786, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 6.5, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "episode_len_mean": 20.0, "num_episodes": 250.0, "num_episodes_lifetime": -555250.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "rlmodule_inference_timer": 5.201674537989382e-05, "episode_duration_sec_mean": 0.008086863994132725, "weights_seq_no": 19.0, "env_step_timer": 2.1933135912035724e-05, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_max": 20, "env_reset_timer": 9.677117711907997e-05, "num_env_steps_sampled_lifetime_throughput": 2678.5756660740544}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15196047333676485, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008994641961716978, "add_observations_from_episodes_to_batch": 0.000911368725294551, "add_columns_from_episodes_to_train_batch": 0.04153251918330152, "add_time_dim_to_batch_and_zero_pad": 0.07650444477780094, "add_states_from_episodes_to_batch": 0.004048150386468279, "batch_individual_items": 0.019702472608266717, "numpy_to_tensor": 7.799360511237526e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_env_steps_trained": 33000, "num_trainable_parameters": 24861, "num_module_steps_trained": 11970, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 239400, "num_env_steps_trained_lifetime": 660000, "num_env_steps_trained_lifetime_throughput": 3861.613098844888, "num_module_steps_trained_throughput": 19772377.26185079, "num_module_steps_trained_lifetime_throughput": 12587162.45860139}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1436400, "num_env_steps_trained_lifetime": 3960000, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 39590.18793264583}, "default_policy": {"vf_loss_unclipped": 42.929359436035156, "module_train_batch_size_mean": 997.4978492525759, "num_module_steps_trained_lifetime": 718200, "diff_num_grad_updates_vs_sampler_policy": 101.0, "vf_loss": 0.35879945755004883, "total_loss": 0.2784440517425537, "vf_explained_var": 0.00472337007522583, "mean_kl_loss": 3.594998361222679e-07, "policy_loss": -4.011461714981124e-05, "entropy": 0.67326420545578, "weights_seq_no": 120.0, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35910}, "intrinsic_reward_module": {"weights_seq_no": 120.0, "num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.4978492525759, "num_module_steps_trained_lifetime": 718200, "diff_num_grad_updates_vs_sampler_policy": 101.0, "total_loss": 0.0}}}, "IntrinsicAttentionMask": [[[0.09352382272481918, 0.08800815790891647, 0.09175782650709152, 0.08833910524845123, 0.09210288524627686, 0.0921860933303833, 0.09208989143371582, 0.08848632127046585, 0.09225636720657349, 0.0886462852358818, 0.09260329604148865], [0.07831524312496185, 0.10616063326597214, 0.08615484088659286, 0.10418511182069778, 0.084551602602005, 0.08417032659053802, 0.08461131155490875, 0.10332053899765015, 0.0838499516248703, 0.1023908257484436, 0.08228959888219833], [0.0886259377002716, 0.09351343661546707, 0.09013056755065918, 0.09320399165153503, 0.08983231335878372, 0.08976069837808609, 0.0898435041308403, 0.09306704252958298, 0.08970031887292862, 0.09291871637105942, 0.08940348774194717], [0.07921832799911499, 0.10499169677495956, 0.0865345373749733, 0.10318141430616379, 0.08504249155521393, 0.08468735963106155, 0.08509810268878937, 0.10238836705684662, 0.0843888521194458, 0.10153500735759735, 0.08293381333351135], [0.08958149701356888, 0.0924152284860611, 0.09046070277690887, 0.092237688601017, 0.09028691798448563, 0.09024515748023987, 0.09029343724250793, 0.09215903282165527, 0.09020993113517761, 0.09207379072904587, 0.09003662317991257], [0.08981207013130188, 0.09215202927589417, 0.09053943306207657, 0.09200578927993774, 0.09039575606584549, 0.09036122262477875, 0.09040115028619766, 0.0919409915804863, 0.09033209085464478, 0.0918707549571991, 0.09018874168395996], [0.08954549580812454, 0.0924563780426979, 0.09044837951660156, 0.09227392822504044, 0.09026989340782166, 0.09022700041532516, 0.09027659893035889, 0.0921931117773056, 0.0901908278465271, 0.09210551530122757, 0.09001284837722778], [0.07962056994438171, 0.10447501391172409, 0.0867016464471817, 0.10273704677820206, 0.0852593407034874, 0.08491591364145279, 0.0853131115436554, 0.10197533667087555, 0.08462721109390259, 0.10115546733140945, 0.08321941643953323], [0.09000679850578308, 0.09193024784326553, 0.09060563892126083, 0.09181029349565506, 0.09048742055892944, 0.09045899659395218, 0.0904918685555458, 0.09175713360309601, 0.09043502807617188, 0.0916995108127594, 0.09031703323125839], [0.08005798608064651, 0.10391585528850555, 0.08688196539878845, 0.10225564241409302, 0.08549389243125916, 0.08516324311494827, 0.08554565906524658, 0.10152765363454819, 0.08488523215055466, 0.1007438525557518, 0.08352906256914139], [0.09096865355968475, 0.09084205329418182, 0.09092893451452255, 0.0908498615026474, 0.09093675017356873, 0.09093862771987915, 0.09093645960092545, 0.09085333347320557, 0.09094022214412689, 0.09085708856582642, 0.09094803780317307]], [[0.09208470582962036, 0.0850825235247612, 0.08523489534854889, 0.09293819218873978, 0.09310463070869446, 0.0929122194647789, 0.0930786058306694, 0.09324529767036438, 0.0900505855679512, 0.09376026690006256, 0.08850815892219543], [0.08965384215116501, 0.09695671498775482, 0.09678509086370468, 0.088838592171669, 0.08868134021759033, 0.08886317908763885, 0.0887058824300766, 0.08854886889457703, 0.09165883809328079, 0.08806729316711426, 0.09324031323194504], [0.08971288800239563, 0.09667570143938065, 0.09651234745979309, 0.088934026658535, 0.08878376334905624, 0.0889575257897377, 0.08880721777677536, 0.08865717053413391, 0.09162700176239014, 0.08819687366485596, 0.09313545376062393], [0.09234436601400375, 0.08377015590667725, 0.08395504206418991, 0.09340009093284607, 0.09360623359680176, 0.09336792677640915, 0.09357399493455887, 0.0937805250287056, 0.08983743190765381, 0.09441909939050674, 0.08794519305229187], [0.0923941358923912, 0.08351737260818481, 0.08370845019817352, 0.09348925203084946, 0.09370315074920654, 0.09345588833093643, 0.09366970509290695, 0.09388399869203568, 0.08979549258947372, 0.09454672038555145, 0.08783579617738724], [0.09233656525611877, 0.08380968868732452, 0.08399360626935959, 0.09338615089654922, 0.09359107911586761, 0.09335417300462723, 0.09355903416872025, 0.09376434981822968, 0.08984395861625671, 0.09439915418624878, 0.08796227723360062], [0.0923863872885704, 0.08355683088302612, 0.08374693989753723, 0.0934753492474556, 0.09368802607059479, 0.0934421643614769, 0.09365476667881012, 0.09386785328388214, 0.08980207145214081, 0.09452679753303528, 0.08785289525985718], [0.09243600070476532, 0.08330453932285309, 0.08350080251693726, 0.09356440603733063, 0.09378483891487122, 0.09353002160787582, 0.09375037252902985, 0.09397124499082565, 0.08975996822118759, 0.094654381275177, 0.08774343878030777], [0.09143529832363129, 0.08832286298274994, 0.08839209377765656, 0.09180545061826706, 0.09187740832567215, 0.0917942151427269, 0.0918661579489708, 0.09193817526102066, 0.09054528176784515, 0.0921601727604866, 0.08986283093690872], [0.09258756786584854, 0.08253154903650284, 0.08274649828672409, 0.09383773058652878, 0.09408213943243027, 0.09379960596561432, 0.09404391795396805, 0.09428885579109192, 0.08962925523519516, 0.09504682570695877, 0.08740611374378204], [0.09091294556856155, 0.0908903032541275, 0.09089081734418869, 0.09091558307409286, 0.09091608971357346, 0.0909155011177063, 0.09091601520776749, 0.09091652184724808, 0.0909065455198288, 0.09091810137033463, 0.09090159833431244]], [[0.09750614315271378, 0.09723949432373047, 0.09697358310222626, 0.08494618535041809, 0.0847138911485672, 0.08448223024606705, 0.08475013822317123, 0.09565488249063492, 0.08428724855184555, 0.09513243287801743, 0.09431374818086624], [0.09731105715036392, 0.09705276042222977, 0.09679515659809113, 0.08512085676193237, 0.08489491790533066, 0.0846695825457573, 0.0849301740527153, 0.0955173447728157, 0.0844799131155014, 0.09501096606254578, 0.09421727806329727], [0.09711601585149765, 0.09686604142189026, 0.0966167151927948, 0.08529557287693024, 0.08507603406906128, 0.0848570466041565, 0.08511028438806534, 0.09537967294454575, 0.0846727192401886, 0.09488930553197861, 0.0941205695271492], [0.08776546269655228, 0.08788125962018967, 0.087997205555439, 0.0937904343008995, 0.09391417354345322, 0.09403808414936066, 0.0938948392868042, 0.08857923001050949, 0.09414275735616684, 0.08881311863660812, 0.08918347209692001], [0.08757422864437103, 0.08769683539867401, 0.08781961351633072, 0.0939665138721466, 0.09409806877374649, 0.0942298024892807, 0.09407750517129898, 0.0884360820055008, 0.09434110671281815, 0.08868388086557388, 0.08907634019851685], [0.08738311380147934, 0.08751249313354492, 0.08764207363128662, 0.09414258599281311, 0.09428197890520096, 0.09442158043384552, 0.09426018595695496, 0.08829285204410553, 0.09453953802585602, 0.0885545164346695, 0.08896902948617935], [0.0876041054725647, 0.08772564679384232, 0.08784735947847366, 0.09393901377916336, 0.09406933933496475, 0.09419985115528107, 0.09404896944761276, 0.08845845609903336, 0.09431011974811554, 0.08870407938957214, 0.08909309655427933], [0.09614159166812897, 0.09593275934457779, 0.09572438895702362, 0.08617004007101059, 0.08598287403583527, 0.08579611033201218, 0.08601208031177521, 0.09468928724527359, 0.08563883602619171, 0.09427838772535324, 0.09363356232643127], [0.08722192794084549, 0.08735702186822891, 0.08749230951070786, 0.09429115056991577, 0.09443718940019608, 0.09458345174789429, 0.0944143608212471, 0.08817194402217865, 0.09470704197883606, 0.0884452685713768, 0.088878333568573], [0.09575221687555313, 0.09555962681770325, 0.095367431640625, 0.08652020990848541, 0.08634619414806366, 0.08617252111434937, 0.08637335151433945, 0.09441221505403519, 0.08602625876665115, 0.09403281658887863, 0.09343717992305756], [0.09513820707798004, 0.09497100114822388, 0.09480408579111099, 0.08707320690155029, 0.08692017197608948, 0.08676741272211075, 0.08694406598806381, 0.09397391229867935, 0.08663871884346008, 0.09364388138055801, 0.09312541782855988]], [[0.1016336977481842, 0.10125694423913956, 0.10088158398866653, 0.09970595687627792, 0.08398501574993134, 0.08434642851352692, 0.09939399361610413, 0.08372224122285843, 0.07668502628803253, 0.08277058601379395, 0.08561856299638748], [0.10139894485473633, 0.10103119164705276, 0.10066477954387665, 0.09951698035001755, 0.0841384157538414, 0.08449262380599976, 0.09921235591173172, 0.08388086408376694, 0.07697678357362747, 0.0829479768872261, 0.08573911339044571], [0.10116425156593323, 0.10080547630786896, 0.10044796764850616, 0.09932789206504822, 0.08429170399904251, 0.08463867753744125, 0.09903057664632797, 0.08403939008712769, 0.0772692859172821, 0.08312535285949707, 0.08585943281650543], [0.10042398422956467, 0.10009327530860901, 0.0997636690735817, 0.0987304225564003, 0.08477474749088287, 0.08509868383407593, 0.0984560176730156, 0.08453912287950516, 0.07819739729166031, 0.08368512243032455, 0.08623764663934708], [0.08970297127962112, 0.08974096924066544, 0.08977898210287094, 0.08989907056093216, 0.09167535603046417, 0.0916304737329483, 0.0899311974644661, 0.09170812368392944, 0.09263087809085846, 0.09182775020599365, 0.09147419780492783], [0.08996789902448654, 0.08999761939048767, 0.09002735465765, 0.09012127667665482, 0.09150730818510056, 0.09147236496210098, 0.09014639258384705, 0.09153281897306442, 0.09225045144557953, 0.09162594377994537, 0.09135064482688904], [0.10022618621587753, 0.0999029204249382, 0.09958069771528244, 0.09857050329446793, 0.08490365743637085, 0.08522138744592667, 0.09830217808485031, 0.08467254042625427, 0.07844676077365875, 0.08383473008871078, 0.0863383412361145], [0.08950977772474289, 0.08955378085374832, 0.08959780633449554, 0.08973689377307892, 0.091797836124897, 0.09174568206071854, 0.08977412432432175, 0.09183590859174728, 0.09290913492441177, 0.09197494387626648, 0.0915641188621521], [0.08414703607559204, 0.0843488872051239, 0.08455123007297516, 0.08519304543733597, 0.09516537934541702, 0.09490210562944412, 0.08536545187234879, 0.09535796195268631, 0.10091506689786911, 0.09606382995843887, 0.09399000555276871], [0.08880598098039627, 0.08887167274951935, 0.0889374166727066, 0.0891452208161354, 0.09224335104227066, 0.0921645238995552, 0.08920086175203323, 0.09230092167854309, 0.09392860531806946, 0.09251125156879425, 0.09189023822546005], [0.09089301526546478, 0.09089352190494537, 0.09089404344558716, 0.0908956527709961, 0.09091931581497192, 0.09091871976852417, 0.09089609235525131, 0.09091974794864655, 0.09093185514211655, 0.0909213274717331, 0.09091665595769882]], [[0.09752516448497772, 0.08593526482582092, 0.08570026606321335, 0.09615781158208847, 0.09589485824108124, 0.08449870347976685, 0.0959358885884285, 0.08453486114740372, 0.09541190415620804, 0.08407314866781235, 0.09433215111494064], [0.08856356889009476, 0.09268122911453247, 0.09277243912220001, 0.08901389688253403, 0.08910149335861206, 0.09324416518211365, 0.08908779919147491, 0.09322983771562576, 0.08926323801279068, 0.09341342747211456, 0.0896289125084877], [0.08837228268384933, 0.09282590448856354, 0.09292474389076233, 0.08885853737592697, 0.08895314484834671, 0.09343604743480682, 0.08893836289644241, 0.09342051297426224, 0.08912785351276398, 0.09361956268548965, 0.08952295780181885], [0.09651430696249008, 0.0866924375295639, 0.08649128675460815, 0.09536517411470413, 0.0951438918709755, 0.08546148985624313, 0.09517842531204224, 0.08549250662326813, 0.09473725408315659, 0.08509623259305954, 0.09382698684930801], [0.09631853550672531, 0.0868392065167427, 0.08664469420909882, 0.09521126747131348, 0.09499800950288773, 0.08564864099025726, 0.09503128379583359, 0.08567864447832108, 0.09460604190826416, 0.08529525250196457, 0.09372840821743011], [0.0873880609869957, 0.09357073158025742, 0.09370928257703781, 0.08805730193853378, 0.08818769454956055, 0.09442693740129471, 0.08816730976104736, 0.09440511465072632, 0.08842860162258148, 0.0946848914027214, 0.08897407352924347], [0.09634911268949509, 0.08681628108024597, 0.08662072569131851, 0.09523531794548035, 0.09502080082893372, 0.08561939001083374, 0.09505428373813629, 0.08564955741167068, 0.0946265459060669, 0.08526415377855301, 0.09374382346868515], [0.087417833507061, 0.09354820102453232, 0.09368553757667542, 0.08808158338069916, 0.08821089565753937, 0.09439688175916672, 0.08819068223237991, 0.09437524527311325, 0.08844981342554092, 0.09465255588293076, 0.08899076282978058], [0.09595780819654465, 0.08710973709821701, 0.08692752569913864, 0.0949273630976677, 0.09472880512475967, 0.08599405735731125, 0.09475979954004288, 0.08602219074964523, 0.09436380118131638, 0.08566270023584366, 0.09354613721370697], [0.08703697472810745, 0.09383656084537506, 0.09398946166038513, 0.0877707228064537, 0.08791374415159225, 0.09478183090686798, 0.08789138495922089, 0.09475772827863693, 0.08817804604768753, 0.09506678581237793, 0.08877675980329514], [0.09514585137367249, 0.08771917968988419, 0.08756501227617264, 0.09428676962852478, 0.0941210612654686, 0.08677438646554947, 0.09414692968130112, 0.08679822832345963, 0.09381628781557083, 0.08649340271949768, 0.09313289821147919]], [[0.10322515666484833, 0.10284250229597092, 0.10246126353740692, 0.08561749756336212, 0.10089182108640671, 0.085667185485363, 0.08534961938858032, 0.08503322303295135, 0.07788582146167755, 0.08406667411327362, 0.08695924282073975], [0.1029515340924263, 0.10257815569639206, 0.10220612585544586, 0.0857376754283905, 0.10067430138587952, 0.0857863500714302, 0.08547522127628326, 0.08516521751880646, 0.07815542817115784, 0.08421804755926132, 0.08705192804336548], [0.10267817229032516, 0.10231402516365051, 0.10195117443799973, 0.08585762232542038, 0.10045679658651352, 0.0859052911400795, 0.08560062944889069, 0.08529704809188843, 0.07842561602592468, 0.08436932414770126, 0.08714431524276733], [0.08980569988489151, 0.0898365005850792, 0.08986730873584747, 0.09137005358934402, 0.08999549597501755, 0.09136515855789185, 0.09139649569988251, 0.09142784029245377, 0.09217207133769989, 0.0915243998169899, 0.09123895317316055], [0.10154484212398529, 0.10121860355138779, 0.10089340806007385, 0.08635377138853073, 0.09955298155546188, 0.0863971933722496, 0.0861196219921112, 0.08584292978048325, 0.07955475896596909, 0.08499683439731598, 0.08752511441707611], [0.08984607458114624, 0.08987576514482498, 0.08990545570850372, 0.09135322272777557, 0.09002897888422012, 0.09134850651025772, 0.09137868881225586, 0.0914088785648346, 0.0921255424618721, 0.0915018767118454, 0.0912269577383995], [0.0895877256989479, 0.0896245464682579, 0.0896613746881485, 0.09146082401275635, 0.08981464058160782, 0.09145495295524597, 0.09149254113435745, 0.09153014421463013, 0.09242361038923264, 0.0916459858417511, 0.09130360931158066], [0.08932972699403763, 0.0893736407160759, 0.08941757678985596, 0.09156816452741623, 0.08960041403770447, 0.09156113117933273, 0.09160614013671875, 0.09165117144584656, 0.09272224456071854, 0.09178993105888367, 0.09137993305921555], [0.0833352655172348, 0.08353517204523087, 0.08373556286096573, 0.09402177482843399, 0.08457357436418533, 0.09398659318685532, 0.09421204775571823, 0.09443804621696472, 0.09994155168533325, 0.0951371118426323, 0.09308329224586487], [0.08853774517774582, 0.08860323578119278, 0.08866877853870392, 0.09189675003290176, 0.08894170820713043, 0.09188614040613174, 0.09195410460233688, 0.0920221209526062, 0.0936448946595192, 0.09223181754350662, 0.09161267429590225], [0.09089092165231705, 0.09089143574237823, 0.09089194983243942, 0.090916708111763, 0.09089407324790955, 0.09091662615537643, 0.09091714024543762, 0.09091765433549881, 0.09092976152896881, 0.09091923385858536, 0.09091456234455109]]], "default_policy": {"vf_explained_var": 0.0034427642822265625, "curr_entropy_coeff": 0.0015431216992, "num_trainable_parameters": 16595, "curr_kl_coeff": 1.5409844422720198e-07, "policy_loss": -4.205161167192273e-05, "entropy": 0.6732622981071472, "module_train_batch_size_mean": 997.6479298448816, "weights_seq_no": 20.0, "use_intrinsic_rewards": 0.0, "num_module_steps_trained": 5985, "vf_loss_unclipped": 43.002986907958984, "num_module_steps_trained_lifetime": 119700, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.2780610918998718, "vf_loss": 0.35831037163734436, "mean_kl_loss": 3.8189557471923763e-07, "num_module_steps_trained_lifetime_throughput": 700.1840271607787}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 119700, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_trainable_parameters": 8266, "weights_seq_no": 20.0, "num_module_steps_trained": 5985, "module_train_batch_size_mean": 997.6479298448816, "num_module_steps_trained_lifetime_throughput": 700.1895209048423}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 1.6}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.02597869993073e-06, "tensor_to_numpy": 1.5191245282091712e-05, "un_batch_to_individual_items": 6.5254350086499e-06, "remove_single_ts_time_rank_from_batch": 1.1854071941622812e-05, "listify_data_for_vector_env": 1.0667170807953938e-05, "get_actions": 3.605470293750871e-05}}, "connector_pipeline_timer": 0.00011492154797126754}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.844580211818758e-06, "numpy_to_tensor": 1.2104907370842235e-05, "add_states_from_episodes_to_batch": 2.8840905303932763e-06, "batch_individual_items": 1.2473949643563726e-05, "add_time_dim_to_batch_and_zero_pad": 7.047673843430032e-06}}, "connector_pipeline_timer": 5.97773182912866e-05}, "num_agent_steps_sampled": {"default_agent": 400}, "rlmodule_inference_timer": 3.121789875619863e-05, "episode_duration_sec_mean": 0.005670775847975164, "num_env_steps_sampled_lifetime": 100400, "episode_len_mean": 20.0, "num_episodes_lifetime": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "num_episodes": 20, "env_step_timer": 1.3888949947435267e-05, "weights_seq_no": 20.0, "episode_return_min": -12.5, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.6, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "agent_episode_returns_mean": {"default_agent": 1.6}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "episode_len_max": 20, "env_reset_timer": 0.0005896718013690471, "episode_return_max": 13.5, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "sample": 0.12049308072781413, "time_between_sampling": 9.731877516400257}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "b4968_00000", "date": "2025-08-11_18-18-28", "timestamp": 1754929108, "time_this_iter_s": 10.85558009147644, "time_total_s": 212.49908995628357, "pid": 10564, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x141ef98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 212.49908995628357, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 49.44666666666667, "ram_util_percent": 82.03999999999999}}
