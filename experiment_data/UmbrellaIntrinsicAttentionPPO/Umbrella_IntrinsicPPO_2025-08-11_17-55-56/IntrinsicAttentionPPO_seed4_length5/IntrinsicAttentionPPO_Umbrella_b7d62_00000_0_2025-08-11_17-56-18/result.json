{"timers": {"training_iteration": 9.381521083996631, "restore_env_runners": 1.0291929356753826e-05, "training_step": 9.38131462491583, "env_runner_sampling_timer": 1.655357375042513, "learner_update_timer": 7.531659208005294, "synch_weights": 0.001434416975826025}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.851631505152988e-06, "remove_single_ts_time_rank_from_batch": 1.223336921390623e-05, "tensor_to_numpy": 1.58415506237419e-05, "get_actions": 0.00010744282591666105, "normalize_and_clip_actions": 1.1475682487848353e-05, "listify_data_for_vector_env": 1.1127122470001578e-05}}, "connector_pipeline_timer": 0.00019242180885756436}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.381115590362958e-06, "numpy_to_tensor": 1.3321032754329883e-05, "add_observations_from_episodes_to_batch": 3.0978998354208114e-06, "add_states_from_episodes_to_batch": 2.823983716125561e-06, "batch_individual_items": 1.295243008829539e-05}}, "connector_pipeline_timer": 6.393445684873683e-05}, "episode_duration_sec_mean": 0.005733893669676035, "episode_len_mean": 20.0, "sample": 0.008239198175758978, "num_episodes_lifetime": 31375.0, "episode_return_max": 12.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_episode_returns_mean": {"default_policy": 3.38}, "episode_len_min": 20, "time_between_sampling": 0.0005248690447497581, "agent_episode_returns_mean": {"default_agent": 3.38}, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "rlmodule_inference_timer": 5.671981164205264e-05, "episode_return_mean": 3.38, "num_env_steps_sampled_lifetime": 627500.0, "env_reset_timer": 8.853584152735308e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -7.5, "env_step_timer": 1.5645415244456208e-05, "env_to_module_sum_episodes_length_in": 10.191744832559449, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.191744832559449, "num_episodes": 250.0, "weights_seq_no": 0.0, "num_env_steps_sampled_lifetime_throughput": 2996.9672639750406}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000, "learner_connector": {"connector_pipeline_timer": 0.1559482499724254, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009329416090622544, "add_observations_from_episodes_to_batch": 0.0008852920727804303, "add_columns_from_episodes_to_train_batch": 0.04264283401425928, "add_time_dim_to_batch_and_zero_pad": 0.09142641699872911, "add_states_from_episodes_to_batch": 0.003599666990339756, "batch_individual_items": 0.007824082975275815, "numpy_to_tensor": 7.812492549419403e-05}}}, "learner_connector_sum_episodes_length_out": 5250}, "learners": {"default_policy": {"curr_kl_coeff": 0.08079196512699127, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 1.0, "entropy": 0.6881505846977234, "vf_explained_var": -0.0032140016555786133, "module_train_batch_size_mean": 998.9117791197002, "num_module_steps_trained_lifetime": 5985, "vf_loss": 0.32054683566093445, "use_intrinsic_rewards": 0.0, "policy_loss": -0.00010518132330616936, "vf_loss_unclipped": 42.51954650878906, "num_module_steps_trained": 5985, "total_loss": 0.24855604767799377, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 4.900341536995256e-06, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 792.5681064471648}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_explained_var": 0.0027816295623779297, "module_train_batch_size_mean": 998.5423314844973, "num_module_steps_trained_lifetime": 35910, "vf_loss": 0.32054954767227173, "use_intrinsic_rewards": 1.0, "policy_loss": -0.00010054926679003984, "vf_loss_unclipped": 42.3297004699707, "num_module_steps_trained": 35910, "total_loss": 0.24856269359588623, "mean_kl_loss": 4.4047865230822936e-06, "diff_num_grad_updates_vs_sampler_policy": 6.0, "entropy": 0.6881667375564575, "weights_seq_no": 6.0}, "intrinsic_reward_module": {"weights_seq_no": 6.0, "module_train_batch_size_mean": 998.5423314844973, "num_module_steps_trained": 35910, "total_loss": 0.0, "num_module_steps_trained_lifetime": 35910, "diff_num_grad_updates_vs_sampler_policy": 6.0}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 71820, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 216000, "num_env_steps_trained_lifetime_throughput": 64486.21535671003}}}, "intrinsic_reward_module": {"total_loss": 0.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 5985, "num_trainable_parameters": 8266, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "weights_seq_no": 1.0, "module_train_batch_size_mean": 998.9117791197002, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 792.5812974328425}, "__all_modules__": {"num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 36000, "num_module_steps_trained_lifetime": 11970, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 4773.311007302182, "num_module_steps_trained_throughput": 28983317.64834527, "num_module_steps_trained_lifetime_throughput": 13048562.075760297}, "IntrinsicAttentionMask": [[[0.16814056038856506, 0.1652466356754303, 0.16506782174110413, 0.16759534180164337, 0.16741397976875305, 0.16653569042682648], [0.16776378452777863, 0.16560880839824677, 0.16547533869743347, 0.16735850274562836, 0.16722363233566284, 0.16656988859176636], [0.16774030029773712, 0.16563138365745544, 0.16550076007843018, 0.16734373569488525, 0.16721175611019135, 0.16657201945781708], [0.16807004809379578, 0.16531436145305634, 0.16514402627944946, 0.16755104064941406, 0.16737839579582214, 0.16654212772846222], [0.16804654896259308, 0.1653369516134262, 0.16516941785812378, 0.16753627359867096, 0.16736653447151184, 0.16654427349567413], [0.16793237626552582, 0.16544665396213531, 0.1652928739786148, 0.16746452450752258, 0.16730886697769165, 0.16655464470386505]], [[0.16506358981132507, 0.16692879796028137, 0.16745644807815552, 0.1672716736793518, 0.16637681424617767, 0.16690270602703094], [0.1648099422454834, 0.1669701337814331, 0.1675819307565689, 0.16736763715744019, 0.16633044183254242, 0.1669398844242096], [0.1647387444972992, 0.16698172688484192, 0.16761717200279236, 0.16739459335803986, 0.1663174033164978, 0.1669503152370453], [0.1647636592388153, 0.1669776886701584, 0.16760484874248505, 0.16738516092300415, 0.16632196307182312, 0.166946679353714], [0.16488467156887054, 0.16695797443389893, 0.16754494607448578, 0.16733936965465546, 0.16634412109851837, 0.1669289469718933], [0.16481347382068634, 0.16696956753730774, 0.16758018732070923, 0.16736631095409393, 0.16633108258247375, 0.166939377784729]], [[0.16813956201076508, 0.1679576188325882, 0.16506683826446533, 0.16488823294639587, 0.16741298139095306, 0.16653470695018768], [0.16811609268188477, 0.16793707013130188, 0.16509225964546204, 0.16491647064685822, 0.16740116477012634, 0.16653689742088318], [0.16773979365825653, 0.16760750114917755, 0.16550026834011078, 0.16536973416805267, 0.16721124947071075, 0.1665715128183365], [0.16771632432937622, 0.16758693754673004, 0.16552571952342987, 0.1653980165719986, 0.16719937324523926, 0.166573628783226], [0.16804568469524384, 0.16787542402744293, 0.16516856849193573, 0.16500122845172882, 0.1673656702041626, 0.16654342412948608], [0.1679316610097885, 0.16777555644512177, 0.1652921587228775, 0.16513851284980774, 0.16730815172195435, 0.16655392944812775]], [[0.16576991975307465, 0.16681347787380219, 0.16710776090621948, 0.1670047491788864, 0.16650520265102386, 0.1667989194393158], [0.1655154526233673, 0.1668550670146942, 0.16723325848579407, 0.16710086166858673, 0.1664590686559677, 0.16683635115623474], [0.1654440313577652, 0.166866734623909, 0.16726849973201752, 0.1671278327703476, 0.16644608974456787, 0.1668468564748764], [0.1654690057039261, 0.1668626368045807, 0.167256161570549, 0.1671183854341507, 0.1664506196975708, 0.16684317588806152], [0.16559043526649475, 0.16684281826019287, 0.16719625890254974, 0.16707251965999603, 0.1664726585149765, 0.1668253242969513], [0.16551898419857025, 0.16685448586940765, 0.1672315001487732, 0.1670995056629181, 0.16645969450473785, 0.16683582961559296]], [[0.16320089995861053, 0.1669083684682846, 0.16677097976207733, 0.1666336953639984, 0.16649654507637024, 0.16998952627182007], [0.161244198679924, 0.16703613102436066, 0.16682018339633942, 0.16660450398921967, 0.1663891077041626, 0.17190589010715485], [0.16131563484668732, 0.16703157126903534, 0.1668184995651245, 0.16660569608211517, 0.16639316082000732, 0.17183539271354675], [0.161387100815773, 0.16702701151371002, 0.1668168157339096, 0.16660688817501068, 0.16639722883701324, 0.17176491022109985], [0.1614585965871811, 0.1670224368572235, 0.1668151319026947, 0.166608065366745, 0.16640128195285797, 0.17169445753097534], [0.1596628725528717, 0.16713465750217438, 0.16685467958450317, 0.16657516360282898, 0.166296124458313, 0.17347656190395355]], [[0.1659720540046692, 0.16784754395484924, 0.16560596227645874, 0.1654232144355774, 0.1700928509235382, 0.16505834460258484], [0.16586022078990936, 0.16803419589996338, 0.16543632745742798, 0.16522477567195892, 0.1706419438123703, 0.16480250656604767], [0.16599398851394653, 0.1678108274936676, 0.165639266371727, 0.1654621958732605, 0.1699851006269455, 0.16510862112045288], [0.166004940867424, 0.1677924543619156, 0.16565591096878052, 0.16548167169094086, 0.16993123292922974, 0.1651337444782257], [0.16572746634483337, 0.16825458407402039, 0.16523532569408417, 0.16498979926109314, 0.1712929606437683, 0.16449984908103943], [0.16602686047554016, 0.16775573790073395, 0.16568921506404877, 0.16552063822746277, 0.1698235720396042, 0.16518402099609375]]]}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 400}, "env_to_module_sum_episodes_length_in": 10.216013141322508, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0598068545047394e-05, "remove_single_ts_time_rank_from_batch": 1.2700765755530422e-05, "tensor_to_numpy": 1.7076885769500337e-05, "get_actions": 4.557443853107822e-05, "un_batch_to_individual_items": 6.765039838612659e-06, "normalize_and_clip_actions": 9.030987941516367e-06}}, "connector_pipeline_timer": 0.00012803522938382517}, "env_to_module_sum_episodes_length_out": 10.216013141322508, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.2537189019656736e-06, "add_states_from_episodes_to_batch": 2.810185970181808e-06, "batch_individual_items": 1.2970221656895973e-05, "add_time_dim_to_batch_and_zero_pad": 8.028182015243806e-06, "numpy_to_tensor": 1.2956982051374616e-05}}, "connector_pipeline_timer": 6.470459091595752e-05}, "sample": 0.11870416591409594, "num_module_steps_sampled": {"default_policy": 400}, "rlmodule_inference_timer": 3.6212555904671726e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "env_step_timer": 1.558923950442664e-05, "agent_episode_returns_mean": {"default_agent": -0.85}, "num_episodes": 20, "episode_len_mean": 20.0, "num_episodes_lifetime": 20, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_mean": -0.85, "episode_return_min": -16.5, "episode_len_max": 20, "weights_seq_no": 1.0, "episode_duration_sec_mean": 0.0053946749598253515, "episode_return_max": 11.5, "num_env_steps_sampled_lifetime": 5400, "env_reset_timer": 0.0005667500663548708, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": -0.85}}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "b7d62_00000", "date": "2025-08-11_18-37-44", "timestamp": 1754930264, "time_this_iter_s": 9.513048887252808, "time_total_s": 9.513048887252808, "pid": 11547, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1550f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9.513048887252808, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 36.82857142857143, "ram_util_percent": 82.47142857142856}}
{"timers": {"training_iteration": 9.385462235246086, "restore_env_runners": 1.0339010041207075e-05, "training_step": 9.385254955337151, "env_runner_sampling_timer": 1.6587094133812934, "learner_update_timer": 7.532043189255055, "synch_weights": 0.0014342603064142166, "restore_eval_env_runners": 4.283396992832422e-05, "evaluation_iteration": 0.12906662502791733, "synch_eval_env_connectors": 0.0001433748984709382, "synch_env_connectors": 4.708999767899513e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 7.2592644150720015e-06, "remove_single_ts_time_rank_from_batch": 1.2989110975612677e-05, "tensor_to_numpy": 1.7914130589410936e-05, "get_actions": 4.7901974921763376e-05, "normalize_and_clip_actions": 9.1042251027716e-06, "listify_data_for_vector_env": 1.2330783109865914e-05}}, "connector_pipeline_timer": 0.00013675154415778245}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 8.26457935329784e-06, "numpy_to_tensor": 1.532785258152539e-05, "add_observations_from_episodes_to_batch": 3.610461670968091e-06, "add_states_from_episodes_to_batch": 3.0423658873901725e-06, "batch_individual_items": 1.4065247264396622e-05}}, "connector_pipeline_timer": 6.89222145254971e-05}, "episode_duration_sec_mean": 0.00618853683769703, "episode_len_mean": 20.0, "sample": 0.0062652687049139285, "num_episodes_lifetime": 500.0, "episode_return_max": 12.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_episode_returns_mean": {"default_policy": 3.7799999999999994}, "episode_len_min": 20, "time_between_sampling": 0.02982366980085231, "agent_episode_returns_mean": {"default_agent": 3.7799999999999994}, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "rlmodule_inference_timer": 3.740094398045924e-05, "episode_return_mean": 3.7799999999999994, "num_env_steps_sampled_lifetime": 10000.0, "env_reset_timer": 4.714764871259612e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -7.5, "env_step_timer": 1.7265005719722745e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "weights_seq_no": 1.0, "num_env_steps_sampled_lifetime_throughput": 3106.065867755102}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1559873033023905, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009330103179672734, "add_observations_from_episodes_to_batch": 0.0008854291529860347, "add_columns_from_episodes_to_train_batch": 0.042646095254458484, "add_time_dim_to_batch_and_zero_pad": 0.09145141991903075, "add_states_from_episodes_to_batch": 0.003602676569717005, "batch_individual_items": 0.007831002145539969, "numpy_to_tensor": 7.815492572262883e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_kl_coeff": 0.040395982563495636, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 2.0, "entropy": 0.6877992749214172, "vf_explained_var": -0.002556443214416504, "module_train_batch_size_mean": 998.828720912135, "num_module_steps_trained_lifetime": 11970, "vf_loss": 0.3205872178077698, "use_intrinsic_rewards": 0.0, "policy_loss": -0.00013794400729238987, "vf_loss_unclipped": 42.41720199584961, "num_module_steps_trained": 5985, "total_loss": 0.24855516850948334, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 8.372587217309047e-06, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 791.6084169370336}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_explained_var": 0.00275266170501709, "module_train_batch_size_mean": 998.2236050808158, "num_module_steps_trained_lifetime": 71820, "vf_loss": 0.3205505311489105, "use_intrinsic_rewards": 1.0, "policy_loss": -0.00013372465036809444, "vf_loss_unclipped": 42.24402618408203, "num_module_steps_trained": 35910, "total_loss": 0.24853134155273438, "mean_kl_loss": 7.786901733197737e-06, "diff_num_grad_updates_vs_sampler_policy": 11.0, "entropy": 0.6878140568733215, "weights_seq_no": 12.0}, "intrinsic_reward_module": {"weights_seq_no": 12.0, "module_train_batch_size_mean": 998.2236050808158, "num_module_steps_trained": 35910, "total_loss": 0.0, "num_module_steps_trained_lifetime": 71820, "diff_num_grad_updates_vs_sampler_policy": 11.0}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 143640, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 432000, "num_env_steps_trained_lifetime_throughput": 64138.64226371961}}}, "intrinsic_reward_module": {"total_loss": 0.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 11970, "num_trainable_parameters": 8266, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "weights_seq_no": 2.0, "module_train_batch_size_mean": 998.828720912135, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 791.6214038799081}, "__all_modules__": {"num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 72000, "num_module_steps_trained_lifetime": 23940, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 4767.470043933939, "num_module_steps_trained_throughput": 28584991.40982989, "num_module_steps_trained_lifetime_throughput": 13024559.887092402}, "IntrinsicAttentionMask": [[[0.16814056038856506, 0.1652466356754303, 0.16506782174110413, 0.16759534180164337, 0.16741397976875305, 0.16653569042682648], [0.16776378452777863, 0.16560880839824677, 0.16547533869743347, 0.16735850274562836, 0.16722363233566284, 0.16656988859176636], [0.16774030029773712, 0.16563138365745544, 0.16550076007843018, 0.16734373569488525, 0.16721175611019135, 0.16657201945781708], [0.16807004809379578, 0.16531436145305634, 0.16514402627944946, 0.16755104064941406, 0.16737839579582214, 0.16654212772846222], [0.16804654896259308, 0.1653369516134262, 0.16516943275928497, 0.16753627359867096, 0.16736653447151184, 0.16654427349567413], [0.16793237626552582, 0.16544665396213531, 0.1652928739786148, 0.16746452450752258, 0.16730886697769165, 0.16655464470386505]], [[0.16721200942993164, 0.16870909929275513, 0.16473574936389923, 0.16677325963974, 0.1682664155960083, 0.1643034815788269], [0.16731949150562286, 0.1691192239522934, 0.16434969007968903, 0.16679264605045319, 0.16858671605587006, 0.16383220255374908], [0.16703078150749207, 0.16802331805229187, 0.1653824895620346, 0.1667393296957016, 0.16773013770580292, 0.16509391367435455], [0.16718022525310516, 0.16858826577663422, 0.16484959423542023, 0.166767418384552, 0.1681719869375229, 0.1644425392150879], [0.16728787124156952, 0.16899830102920532, 0.16446347534656525, 0.1667870134115219, 0.16849231719970703, 0.16397105157375336], [0.1669986993074417, 0.1679026484489441, 0.16549645364284515, 0.16673317551612854, 0.16763567924499512, 0.165233314037323]], [[0.16286224126815796, 0.16863712668418884, 0.1664249151945114, 0.16628792881965637, 0.1661510467529297, 0.1696367859840393], [0.15954284369945526, 0.17037835717201233, 0.166188046336174, 0.16593018174171448, 0.16567270457744598, 0.1722879558801651], [0.160795196890831, 0.16971896588802338, 0.16628029942512512, 0.1660681962966919, 0.16585634648799896, 0.17128100991249084], [0.16087351739406586, 0.16967782378196716, 0.1662859469652176, 0.16607670485973358, 0.16586770117282867, 0.17121830582618713], [0.1609518826007843, 0.16963669657707214, 0.16629160940647125, 0.16608519852161407, 0.1658790409564972, 0.17115561664104462], [0.1589844971895218, 0.17067328095436096, 0.16614575684070587, 0.16586743295192719, 0.1655895709991455, 0.17273950576782227]], [[0.16808530688285828, 0.1704336553812027, 0.16762764751911163, 0.1640028953552246, 0.16629421710968018, 0.16355635225772858], [0.16826623678207397, 0.17092202603816986, 0.16774922609329224, 0.16366077959537506, 0.16624386608600616, 0.16315791010856628], [0.16804972290992737, 0.17033778131008148, 0.16760370135307312, 0.16407015919685364, 0.16630405187606812, 0.16363470256328583], [0.16776373982429504, 0.169570192694664, 0.16741101443767548, 0.16460956633090973, 0.1663820743560791, 0.16426348686218262], [0.16794532537460327, 0.17005710303783417, 0.16753342747688293, 0.1642671674489975, 0.1663326919078827, 0.16386428475379944], [0.167727991938591, 0.16947458684444427, 0.16738688945770264, 0.16467685997486115, 0.16639168560504913, 0.16434195637702942]], [[0.16813550889492035, 0.16524165868759155, 0.16506285965442657, 0.16759030520915985, 0.16470584273338318, 0.16926376521587372], [0.16776101291179657, 0.1656060516834259, 0.1654725968837738, 0.1673557311296463, 0.16520598530769348, 0.16859860718250275], [0.16773764789104462, 0.16562877595424652, 0.16549815237522125, 0.16734108328819275, 0.1652372032403946, 0.16855718195438385], [0.16806548833847046, 0.165309876203537, 0.16513952612876892, 0.16754648089408875, 0.16479937732219696, 0.16913922131061554], [0.16769090294837952, 0.16567419469356537, 0.16554923355579376, 0.16731177270412445, 0.16529960930347443, 0.16847433149814606], [0.16827969253063202, 0.16510121524333954, 0.16490499675273895, 0.16768044233322144, 0.1645132601261139, 0.16952039301395416]], [[0.16505743563175201, 0.16692258417606354, 0.1674502044916153, 0.16726543009281158, 0.1691555231809616, 0.16414876282215118], [0.164801687002182, 0.16696178913116455, 0.16757354140281677, 0.16735927760601044, 0.16955289244651794, 0.16375072300434113], [0.16472987830638885, 0.16697274148464203, 0.1676081418991089, 0.16738559305667877, 0.16966460645198822, 0.16363905370235443], [0.16475501656532288, 0.1669689267873764, 0.16759605705738068, 0.16737639904022217, 0.16962553560733795, 0.1636781245470047], [0.16449926793575287, 0.1670076549053192, 0.1677190363407135, 0.1674698144197464, 0.17002351582050323, 0.16328075528144836], [0.16518309712409973, 0.16690319776535034, 0.16738951206207275, 0.16721922159194946, 0.16896051168441772, 0.16434453427791595]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 800}, "env_to_module_sum_episodes_length_in": 10.366003441359926, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.028606574410635e-05, "remove_single_ts_time_rank_from_batch": 1.1776443029991316e-05, "tensor_to_numpy": 1.487933797474798e-05, "get_actions": 3.530692902410543e-05, "un_batch_to_individual_items": 6.514757405337893e-06, "normalize_and_clip_actions": 7.86681469892869e-06}}, "connector_pipeline_timer": 0.0001125592143148367}, "env_to_module_sum_episodes_length_out": 10.366003441359926, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.805374076288681e-06, "add_states_from_episodes_to_batch": 2.7196567351162462e-06, "batch_individual_items": 1.2409487778952472e-05, "add_time_dim_to_batch_and_zero_pad": 6.989258553188251e-06, "numpy_to_tensor": 1.1812188991184859e-05}}, "connector_pipeline_timer": 5.860490385917581e-05}, "sample": 0.11865044300444423, "num_module_steps_sampled": {"default_policy": 400}, "rlmodule_inference_timer": 3.0252919967918157e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "env_step_timer": 1.3717739353248708e-05, "agent_episode_returns_mean": {"default_agent": -0.85}, "num_episodes": 20, "episode_len_mean": 20.0, "num_episodes_lifetime": 40, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_mean": -0.85, "episode_return_min": -16.5, "episode_len_max": 20, "weights_seq_no": 2.0, "episode_duration_sec_mean": 0.0052770042035263035, "episode_return_max": 11.5, "num_env_steps_sampled_lifetime": 10400, "env_reset_timer": 0.0005646813160274178, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": -0.85}, "time_between_sampling": 9.826314541976899}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "b7d62_00000", "date": "2025-08-11_18-37-54", "timestamp": 1754930274, "time_this_iter_s": 9.900463819503784, "time_total_s": 19.413512706756592, "pid": 11547, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1550f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.413512706756592, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 46.199999999999996, "ram_util_percent": 81.97142857142856}}
{"timers": {"training_iteration": 9.389954459142812, "restore_env_runners": 1.0335619538091124e-05, "training_step": 9.389746734942788, "env_runner_sampling_timer": 1.6574963584168814, "learner_update_timer": 7.535972590272059, "synch_weights": 0.001439611454005353, "restore_eval_env_runners": 4.2836050270125276e-05, "evaluation_iteration": 0.12899499419727362, "synch_eval_env_connectors": 0.0001452986500225961, "synch_env_connectors": 4.7048297710716725e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.624645091339742e-06, "remove_single_ts_time_rank_from_batch": 1.1924720826708657e-05, "tensor_to_numpy": 1.5358372612157628e-05, "get_actions": 3.9124207345402424e-05, "normalize_and_clip_actions": 8.088670669298515e-06, "listify_data_for_vector_env": 1.0675757042548004e-05}}, "connector_pipeline_timer": 0.00011821680470069984}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.077784511908901e-06, "numpy_to_tensor": 1.2590223191573001e-05, "add_observations_from_episodes_to_batch": 2.8916545978010443e-06, "add_states_from_episodes_to_batch": 2.768656367250488e-06, "batch_individual_items": 1.2697962103450186e-05}}, "connector_pipeline_timer": 6.044272250091249e-05}, "episode_duration_sec_mean": 0.005262779786251483, "episode_len_mean": 20.0, "sample": 0.006410248194234896, "num_episodes_lifetime": -30375.0, "episode_return_max": 12.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_episode_returns_mean": {"default_policy": 3.5400000000000005}, "episode_len_min": 20, "time_between_sampling": 0.03250466104194888, "agent_episode_returns_mean": {"default_agent": 3.5400000000000005}, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "rlmodule_inference_timer": 3.165602892815397e-05, "episode_return_mean": 3.5400000000000005, "num_env_steps_sampled_lifetime": -607500.0, "env_reset_timer": 5.132587155575582e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -7.5, "env_step_timer": 1.416931499919252e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "weights_seq_no": 2.0, "num_env_steps_sampled_lifetime_throughput": 3161.12374991733}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15763760026945964, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009327882147568745, "add_observations_from_episodes_to_batch": 0.0008852756913867778, "add_columns_from_episodes_to_train_batch": 0.04264351305221207, "add_time_dim_to_batch_and_zero_pad": 0.09144048446969828, "add_states_from_episodes_to_batch": 0.0036040827235090545, "batch_individual_items": 0.009496007953747176, "numpy_to_tensor": 7.818212651181965e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_kl_coeff": 0.020197991281747818, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 3.0, "entropy": 0.6871467232704163, "vf_explained_var": 0.0004011392593383789, "module_train_batch_size_mean": 998.7505232584676, "num_module_steps_trained_lifetime": 17955, "vf_loss": 0.32051557302474976, "use_intrinsic_rewards": 0.0, "policy_loss": -3.8723905163351446e-05, "vf_loss_unclipped": 42.52561569213867, "num_module_steps_trained": 5985, "total_loss": 0.24859924614429474, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 8.836279448587447e-06, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 789.6003942973857}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_explained_var": 0.0029081106185913086, "module_train_batch_size_mean": 998.0016398003509, "num_module_steps_trained_lifetime": 107730, "vf_loss": 0.3205345571041107, "use_intrinsic_rewards": 1.0, "policy_loss": -3.823298538918607e-05, "vf_loss_unclipped": 42.50206756591797, "num_module_steps_trained": 35910, "total_loss": 0.24861563742160797, "mean_kl_loss": 8.73604767548386e-06, "diff_num_grad_updates_vs_sampler_policy": 16.0, "entropy": 0.6871495246887207, "weights_seq_no": 18.0}, "intrinsic_reward_module": {"weights_seq_no": 18.0, "module_train_batch_size_mean": 998.0016398003509, "num_module_steps_trained": 35910, "total_loss": 0.0, "num_module_steps_trained_lifetime": 107730, "diff_num_grad_updates_vs_sampler_policy": 16.0}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 215460, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 648000, "num_env_steps_trained_lifetime_throughput": 63521.753904895275}}}, "intrinsic_reward_module": {"total_loss": 0.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 17955, "num_trainable_parameters": 8266, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "weights_seq_no": 3.0, "module_train_batch_size_mean": 998.7505232584676, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 789.6128779507567}, "__all_modules__": {"num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 108000, "num_module_steps_trained_lifetime": 35910, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 4755.2736563864855, "num_module_steps_trained_throughput": 27961899.810174085, "num_module_steps_trained_lifetime_throughput": 12955327.763135618}, "IntrinsicAttentionMask": [[[0.16218994557857513, 0.16794098913669586, 0.16780275106430054, 0.16766463220119476, 0.16546517610549927, 0.16893652081489563], [0.15830084681510925, 0.16905200481414795, 0.16878969967365265, 0.1685277819633484, 0.16438297927379608, 0.17094673216342926], [0.15839192271232605, 0.1690259426832199, 0.1687665730714798, 0.16850760579109192, 0.16440874338150024, 0.17089922726154327], [0.15848304331302643, 0.16899986565113068, 0.16874344646930695, 0.16848741471767426, 0.1644344925880432, 0.1708517223596573], [0.15994974970817566, 0.16858048737049103, 0.16837124526500702, 0.1681622564792633, 0.1648462414741516, 0.1700899600982666], [0.1576482504606247, 0.16923877596855164, 0.1689552664756775, 0.16867224872112274, 0.16419778764247894, 0.1712876409292221]], [[0.16758547723293304, 0.16687391698360443, 0.16729219257831573, 0.1649591326713562, 0.16643604636192322, 0.16685321927070618], [0.16749759018421173, 0.16685427725315094, 0.1672324687242508, 0.16512185335159302, 0.16645827889442444, 0.16683556139469147], [0.16754929721355438, 0.16686584055423737, 0.1672676056623459, 0.16502609848976135, 0.16644521057605743, 0.16684596240520477], [0.16725921630859375, 0.16680079698562622, 0.16707035899162292, 0.16556376218795776, 0.16651836037635803, 0.16678746044635773], [0.16744332015514374, 0.16684213280677795, 0.16719557344913483, 0.1652223765850067, 0.16647198796272278, 0.16682463884353638], [0.1674950271844864, 0.16685371100902557, 0.1672307252883911, 0.16512659192085266, 0.16645891964435577, 0.16683505475521088]], [[0.16219021379947662, 0.16794127225875854, 0.16780303418636322, 0.16560176014900208, 0.16752690076828003, 0.1689368039369583], [0.15830180048942566, 0.16905301809310913, 0.16879069805145264, 0.1646394282579422, 0.16826729476451874, 0.17094776034355164], [0.15839286148548126, 0.1690269410610199, 0.16876757144927979, 0.16466239094734192, 0.16825003921985626, 0.17090024054050446], [0.1598586142063141, 0.16860736906528473, 0.16839519143104553, 0.16502895951271057, 0.1679716408252716, 0.1701381355524063], [0.1585751175880432, 0.16897474229335785, 0.1687212735414505, 0.16470825672149658, 0.16821548342704773, 0.1708052009344101], [0.15764935314655304, 0.16923996806144714, 0.168956458568573, 0.1644744873046875, 0.16839087009429932, 0.1712888479232788]], [[0.16721169650554657, 0.16870877146720886, 0.1669190526008606, 0.1645912081003189, 0.16826608777046204, 0.16430316865444183], [0.16731902956962585, 0.1691187620162964, 0.16696761548519135, 0.1641765683889389, 0.16858625411987305, 0.16383175551891327], [0.1671905368566513, 0.1686282455921173, 0.16690945625305176, 0.16467274725437164, 0.16820316016674042, 0.16439588367938995], [0.16701996326446533, 0.16798296570777893, 0.166831374168396, 0.16532693803310394, 0.16769853234291077, 0.16514025628566742], [0.1672874540090561, 0.1689978837966919, 0.16695336997509003, 0.16429875791072845, 0.1684918999671936, 0.16397063434123993], [0.16699858009815216, 0.16790252923965454, 0.16682150959968567, 0.16540858149528503, 0.16763556003570557, 0.16523319482803345]], [[0.16252636909484863, 0.16621850430965424, 0.16608168184757233, 0.16801239550113678, 0.16787411272525787, 0.16928693652153015], [0.16019640862941742, 0.1659507006406784, 0.1657361388206482, 0.16877306997776031, 0.1685548722743988, 0.17078880965709686], [0.16028138995170593, 0.1659606695175171, 0.1657489687204361, 0.16874529421329498, 0.16853003203868866, 0.17073369026184082], [0.1590917408466339, 0.1658196747303009, 0.16556808352470398, 0.16913454234600067, 0.16887791454792023, 0.17150792479515076], [0.1591762900352478, 0.16582980751991272, 0.16558106243610382, 0.1691068708896637, 0.16885320842266083, 0.17145274579524994], [0.1583174616098404, 0.16572628915309906, 0.16544866561889648, 0.16938826441764832, 0.16910450160503387, 0.1720147579908371]], [[0.16551220417022705, 0.17018434405326843, 0.16514712572097778, 0.1677262783050537, 0.16682898998260498, 0.16460102796554565], [0.16505412757396698, 0.17158332467079163, 0.16454698145389557, 0.16813932359218597, 0.1668870598077774, 0.16378915309906006], [0.1655484437942505, 0.1700737178325653, 0.16519469022750854, 0.16769342124462128, 0.16682425141334534, 0.16466546058654785], [0.16529379785060883, 0.17085117101669312, 0.1648607850074768, 0.16792374849319458, 0.16685713827610016, 0.1642133891582489], [0.1653819978237152, 0.17058175802230835, 0.16497638821601868, 0.16784408688545227, 0.16684585809707642, 0.16436982154846191], [0.16560280323028564, 0.16990786790847778, 0.1652660071849823, 0.16764409840106964, 0.1668170839548111, 0.16476210951805115]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 1200}, "env_to_module_sum_episodes_length_in": 10.368205581254823, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0198923561343247e-05, "remove_single_ts_time_rank_from_batch": 1.1803733420153762e-05, "tensor_to_numpy": 1.4800595987925531e-05, "get_actions": 3.5463240431206285e-05, "un_batch_to_individual_items": 6.540172021339207e-06, "normalize_and_clip_actions": 7.747601163675186e-06}}, "connector_pipeline_timer": 0.00011217998172932672}, "env_to_module_sum_episodes_length_out": 10.368205581254823, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.769731773883977e-06, "add_states_from_episodes_to_batch": 2.718872000058571e-06, "batch_individual_items": 1.236326793007452e-05, "add_time_dim_to_batch_and_zero_pad": 6.9295994845375635e-06, "numpy_to_tensor": 1.1720210557818552e-05}}, "connector_pipeline_timer": 5.821619113972306e-05}, "sample": 0.11859944690517148, "num_module_steps_sampled": {"default_policy": 400}, "rlmodule_inference_timer": 3.081718175304177e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "env_step_timer": 1.3724532664673843e-05, "agent_episode_returns_mean": {"default_agent": -1.1833333333333333}, "num_episodes": 20, "episode_len_mean": 20.0, "num_episodes_lifetime": 60, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_mean": -1.1833333333333333, "episode_return_min": -16.5, "episode_len_max": 20, "weights_seq_no": 3.0, "episode_duration_sec_mean": 0.005244085510882238, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 15400, "env_reset_timer": 0.0005627565929084085, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": -1.1833333333333333}, "time_between_sampling": 9.82669011405669}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "b7d62_00000", "date": "2025-08-11_18-38-04", "timestamp": 1754930284, "time_this_iter_s": 9.960600852966309, "time_total_s": 29.3741135597229, "pid": 11547, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1550f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 29.3741135597229, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 45.49285714285715, "ram_util_percent": 81.35}}
{"timers": {"training_iteration": 9.389516794551925, "restore_env_runners": 1.0298093878896907e-05, "training_step": 9.3893086238436, "env_runner_sampling_timer": 1.6562892844127965, "learner_update_timer": 7.536672574368583, "synch_weights": 0.0014345045091493519, "restore_eval_env_runners": 4.2960189899895344e-05, "evaluation_iteration": 0.12893450258433586, "synch_eval_env_connectors": 0.00014608941285405304, "synch_env_connectors": 4.700281214900315e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.5761245390297704e-06, "remove_single_ts_time_rank_from_batch": 1.1832370796872767e-05, "tensor_to_numpy": 1.5188525852551239e-05, "get_actions": 3.868393016156933e-05, "normalize_and_clip_actions": 8.040087341026995e-06, "listify_data_for_vector_env": 1.0587289224064576e-05}}, "connector_pipeline_timer": 0.00011721753604017334}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.104396790656525e-06, "numpy_to_tensor": 1.2503045521589874e-05, "add_observations_from_episodes_to_batch": 2.875378722140845e-06, "add_states_from_episodes_to_batch": 2.7465386188780805e-06, "batch_individual_items": 1.2570228083766224e-05}}, "connector_pipeline_timer": 6.013586762000718e-05}, "episode_duration_sec_mean": 0.005264870153274385, "episode_len_mean": 20.0, "sample": 0.005671963047380576, "num_episodes_lifetime": -61250.0, "episode_return_max": 12.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_episode_returns_mean": {"default_policy": 3.8600000000000008}, "episode_len_min": 20, "time_between_sampling": 0.03412815770771621, "agent_episode_returns_mean": {"default_agent": 3.8600000000000008}, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "rlmodule_inference_timer": 3.125615349892051e-05, "episode_return_mean": 3.8600000000000008, "num_env_steps_sampled_lifetime": -1225000.0, "env_reset_timer": 4.224056580428383e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -7.5, "env_step_timer": 1.4038701319565147e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "weights_seq_no": 3.0, "num_env_steps_sampled_lifetime_throughput": 3256.411630764677}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15760417967789747, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009326474156021723, "add_observations_from_episodes_to_batch": 0.0008853004339676116, "add_columns_from_episodes_to_train_batch": 0.04264482625092891, "add_time_dim_to_batch_and_zero_pad": 0.09142548920458009, "add_states_from_episodes_to_batch": 0.0036054518959146224, "batch_individual_items": 0.009476844124230789, "numpy_to_tensor": 7.808780524297615e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_kl_coeff": 0.010098995640873909, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 4.0, "entropy": 0.6863016486167908, "vf_explained_var": 0.0013399124145507812, "module_train_batch_size_mean": 998.6769017198101, "num_module_steps_trained_lifetime": 23940, "vf_loss": 0.3205406367778778, "use_intrinsic_rewards": 0.0, "policy_loss": -0.00046856593689881265, "vf_loss_unclipped": 42.38144302368164, "num_module_steps_trained": 5985, "total_loss": 0.24819044768810272, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 2.7389340175432153e-05, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 787.4058548454537}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_explained_var": 0.002959311008453369, "module_train_batch_size_mean": 997.847060245087, "num_module_steps_trained_lifetime": 143640, "vf_loss": 0.32053306698799133, "use_intrinsic_rewards": 1.0, "policy_loss": -0.0004465745878405869, "vf_loss_unclipped": 42.43146896362305, "num_module_steps_trained": 35910, "total_loss": 0.24820995330810547, "mean_kl_loss": 2.48305696004536e-05, "diff_num_grad_updates_vs_sampler_policy": 21.0, "entropy": 0.6863426566123962, "weights_seq_no": 24.0}, "intrinsic_reward_module": {"weights_seq_no": 24.0, "module_train_batch_size_mean": 997.847060245087, "num_module_steps_trained": 35910, "total_loss": 0.0, "num_module_steps_trained_lifetime": 143640, "diff_num_grad_updates_vs_sampler_policy": 21.0}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 287280, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 864000, "num_env_steps_trained_lifetime_throughput": 62719.61995845834}}}, "intrinsic_reward_module": {"total_loss": 0.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 23940, "num_trainable_parameters": 8266, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "weights_seq_no": 4.0, "module_train_batch_size_mean": 998.6769017198101, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 787.4178052618693}, "__all_modules__": {"num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 144000, "num_module_steps_trained_lifetime": 47880, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 4741.925508083927, "num_module_steps_trained_throughput": 27287889.933569744, "num_module_steps_trained_lifetime_throughput": 12916910.409463335}, "IntrinsicAttentionMask": [[[0.16768482327461243, 0.16750337183475494, 0.16732212901115417, 0.16714107990264893, 0.16426435112953186, 0.16608431935310364], [0.16766862571239471, 0.16749007999897003, 0.16731174290180206, 0.16713356971740723, 0.16430237889289856, 0.1660936325788498], [0.167652428150177, 0.16747678816318512, 0.16730134189128876, 0.16712605953216553, 0.16434042155742645, 0.16610294580459595], [0.1676362305879593, 0.1674634963274002, 0.16729094088077545, 0.16711856424808502, 0.16437847912311554, 0.1661122590303421], [0.16737648844718933, 0.16725024580955505, 0.16712410748004913, 0.16699805855751038, 0.1649896651506424, 0.16626150906085968], [0.16754135489463806, 0.16738562285900116, 0.1672300398349762, 0.16707459092140198, 0.16460156440734863, 0.16616684198379517]], [[0.16597674787044525, 0.1678522676229477, 0.16838283836841583, 0.16542790830135345, 0.16729722917079926, 0.1650630086660385], [0.16586652398109436, 0.16804058849811554, 0.16865628957748413, 0.16523104906082153, 0.16739678382873535, 0.16480876505374908], [0.16583554446697235, 0.1680934727191925, 0.1687331348657608, 0.16517578065395355, 0.16742472350597382, 0.16473740339279175], [0.16600920259952545, 0.1677967607975006, 0.1683022677898407, 0.1654859185218811, 0.167267844080925, 0.16513797640800476], [0.16589902341365814, 0.16798508167266846, 0.16857565939426422, 0.16528907418251038, 0.16736745834350586, 0.16488368809223175], [0.16603083908557892, 0.1677597612142563, 0.16824857890605927, 0.16552461683750153, 0.16724826395511627, 0.1651879847049713]], [[0.1618562936782837, 0.1675955057144165, 0.16745755076408386, 0.16731971502304077, 0.16718198359012604, 0.16858899593353271], [0.15768848359584808, 0.16839805245399475, 0.16813676059246063, 0.16787587106227875, 0.1676153689622879, 0.17028546333312988], [0.15778596699237823, 0.1683792918920517, 0.16812092065811157, 0.1678629368543625, 0.16760537028312683, 0.17024542391300201], [0.15788350999355316, 0.16836053133010864, 0.1681050956249237, 0.16785003244876862, 0.16759537160396576, 0.17020539939403534], [0.15798109769821167, 0.1683417707681656, 0.16808925569057465, 0.16783711314201355, 0.1675853431224823, 0.17016537487506866], [0.1569901704788208, 0.1685323268175125, 0.16825000941753387, 0.16796815395355225, 0.16768677532672882, 0.17057263851165771]], [[0.16597674787044525, 0.1678522825241089, 0.16838283836841583, 0.16542790830135345, 0.16729722917079926, 0.1650630086660385], [0.16586650907993317, 0.16804058849811554, 0.16865628957748413, 0.16523104906082153, 0.16739678382873535, 0.16480876505374908], [0.16583554446697235, 0.1680934727191925, 0.1687331348657608, 0.16517578065395355, 0.16742472350597382, 0.16473740339279175], [0.16600920259952545, 0.1677967607975006, 0.1683022677898407, 0.1654859185218811, 0.167267844080925, 0.16513797640800476], [0.16589902341365814, 0.16798508167266846, 0.16857565939426422, 0.16528907418251038, 0.16736745834350586, 0.16488368809223175], [0.16603083908557892, 0.1677597612142563, 0.16824857890605927, 0.16552461683750153, 0.16724826395511627, 0.1651879847049713]], [[0.16768579185009003, 0.16750434041023254, 0.16462135314941406, 0.16714204847812653, 0.1669611781835556, 0.16608527302742004], [0.16766957938671112, 0.16749103367328644, 0.16465379297733307, 0.16713452339172363, 0.16695654392242432, 0.1660945862531662], [0.16740940511226654, 0.16727736592292786, 0.16517429053783417, 0.16701361536979675, 0.16688190400600433, 0.16624343395233154], [0.16763712465763092, 0.16746439039707184, 0.1647186428308487, 0.16711945831775665, 0.16694724559783936, 0.16611315310001373], [0.16762089729309082, 0.16745106875896454, 0.1647510677576065, 0.16711191833019257, 0.16694259643554688, 0.1661224365234375], [0.16754208505153656, 0.16738635301589966, 0.16490870714187622, 0.16707532107830048, 0.1669200211763382, 0.16616755723953247]], [[0.1660257875919342, 0.16707095503807068, 0.1673656851053238, 0.1657189428806305, 0.16676218807697296, 0.1670563668012619], [0.16584353148937225, 0.16718579828739166, 0.1675647348165512, 0.16544991731643677, 0.1667890101671219, 0.1671670526266098], [0.165792316198349, 0.16721801459789276, 0.16762062907218933, 0.16537439823150635, 0.1667964905500412, 0.1671980917453766], [0.1660795360803604, 0.16703711450099945, 0.167307049036026, 0.16579832136631012, 0.16675427556037903, 0.16702376306056976], [0.16589725017547607, 0.16715195775032043, 0.16750605404376984, 0.16552919149398804, 0.16678112745285034, 0.16713443398475647], [0.165846049785614, 0.16718418896198273, 0.16756194829940796, 0.16545365750789642, 0.16678862273693085, 0.16716550290584564]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 1600}, "env_to_module_sum_episodes_length_in": 10.368237912813044, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0339374609843688e-05, "remove_single_ts_time_rank_from_batch": 1.2040561503049499e-05, "tensor_to_numpy": 1.4818842217432535e-05, "get_actions": 3.5248292115607506e-05, "un_batch_to_individual_items": 6.639584152012779e-06, "normalize_and_clip_actions": 7.906882662573972e-06}}, "connector_pipeline_timer": 0.00011308325248121583}, "env_to_module_sum_episodes_length_out": 10.368237912813044, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.832289235876325e-06, "add_states_from_episodes_to_batch": 2.7160017142373263e-06, "batch_individual_items": 1.2402421065646879e-05, "add_time_dim_to_batch_and_zero_pad": 6.9402080970276185e-06, "numpy_to_tensor": 1.1738467698597443e-05}}, "connector_pipeline_timer": 5.859747541711273e-05}, "sample": 0.11853159743677497, "num_module_steps_sampled": {"default_policy": 400}, "rlmodule_inference_timer": 3.023009273023073e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "env_step_timer": 1.3805513628269363e-05, "agent_episode_returns_mean": {"default_agent": -1.6}, "num_episodes": 20, "episode_len_mean": 20.0, "num_episodes_lifetime": 80, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_mean": -1.6, "episode_return_min": -16.5, "episode_len_max": 20, "weights_seq_no": 4.0, "episode_duration_sec_mean": 0.005219031356682535, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 20400, "env_reset_timer": 0.000558017777634901, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": -1.6}, "time_between_sampling": 9.822166355416876}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "b7d62_00000", "date": "2025-08-11_18-38-13", "timestamp": 1754930293, "time_this_iter_s": 9.466188907623291, "time_total_s": 38.84030246734619, "pid": 11547, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1550f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 38.84030246734619, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 38.50714285714286, "ram_util_percent": 81.3}}
{"timers": {"training_iteration": 9.392676826196219, "restore_env_runners": 1.0249693099593277e-05, "training_step": 9.392468581355512, "env_runner_sampling_timer": 1.6550795136486465, "learner_update_timer": 7.540957538204374, "synch_weights": 0.0014301473748016612, "restore_eval_env_runners": 4.26364176775096e-05, "evaluation_iteration": 0.12881783922819712, "synch_eval_env_connectors": 0.00014575184858287683, "synch_env_connectors": 4.692867761244997e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.652300992007714e-06, "remove_single_ts_time_rank_from_batch": 1.1940284372719155e-05, "tensor_to_numpy": 1.523515911240642e-05, "get_actions": 3.864357881381801e-05, "normalize_and_clip_actions": 8.125336090558539e-06, "listify_data_for_vector_env": 1.0652919738093583e-05}}, "connector_pipeline_timer": 0.00011768978598686429}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.076897086963402e-06, "numpy_to_tensor": 1.2402061438213667e-05, "add_observations_from_episodes_to_batch": 2.8859011530790087e-06, "add_states_from_episodes_to_batch": 2.7731949629435936e-06, "batch_individual_items": 1.2630071253736538e-05}}, "connector_pipeline_timer": 6.008078413920442e-05}, "episode_duration_sec_mean": 0.00527627467690036, "episode_len_mean": 20.0, "sample": 0.005649001570266887, "num_episodes_lifetime": -92125.0, "episode_return_max": 12.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_episode_returns_mean": {"default_policy": 4.019999999999998}, "episode_len_min": 20, "time_between_sampling": 0.0324235716870257, "agent_episode_returns_mean": {"default_agent": 4.019999999999998}, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "rlmodule_inference_timer": 3.1659834551973314e-05, "episode_return_mean": 4.019999999999998, "num_env_steps_sampled_lifetime": -1842500.0, "env_reset_timer": 4.1039560159576755e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -7.5, "env_step_timer": 1.4005430588871281e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "weights_seq_no": 4.0, "num_env_steps_sampled_lifetime_throughput": 3242.696283186189}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15757758204130984, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009323807744596032, "add_observations_from_episodes_to_batch": 0.0008854749302648111, "add_columns_from_episodes_to_train_batch": 0.042645852578670845, "add_time_dim_to_batch_and_zero_pad": 0.09142105931251492, "add_states_from_episodes_to_batch": 0.0036066182168321575, "batch_individual_items": 0.009455732353272007, "numpy_to_tensor": 7.792317751740337e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_kl_coeff": 0.0050494978204369545, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 5.0, "entropy": 0.6856908202171326, "vf_explained_var": 0.00043845176696777344, "module_train_batch_size_mean": 998.6075885025957, "num_module_steps_trained_lifetime": 29925, "vf_loss": 0.32051047682762146, "use_intrinsic_rewards": 0.0, "policy_loss": -0.0002514888474252075, "vf_loss_unclipped": 42.30585861206055, "num_module_steps_trained": 5985, "total_loss": 0.24838463962078094, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 2.165413388866e-05, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 784.8796948085547}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_explained_var": 0.0028707385063171387, "module_train_batch_size_mean": 997.7394089995611, "num_module_steps_trained_lifetime": 179550, "vf_loss": 0.32053861021995544, "use_intrinsic_rewards": 1.0, "policy_loss": -0.00024380664399359375, "vf_loss_unclipped": 42.25987243652344, "num_module_steps_trained": 35910, "total_loss": 0.24841725826263428, "mean_kl_loss": 2.0400024368427694e-05, "diff_num_grad_updates_vs_sampler_policy": 26.0, "entropy": 0.6857141852378845, "weights_seq_no": 30.0}, "intrinsic_reward_module": {"weights_seq_no": 30.0, "module_train_batch_size_mean": 997.7394089995611, "num_module_steps_trained": 35910, "total_loss": 0.0, "num_module_steps_trained_lifetime": 179550, "diff_num_grad_updates_vs_sampler_policy": 26.0}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 359100, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 1080000, "num_env_steps_trained_lifetime_throughput": 61796.47744829758}}}, "intrinsic_reward_module": {"total_loss": 0.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 29925, "num_trainable_parameters": 8266, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "weights_seq_no": 5.0, "module_train_batch_size_mean": 998.6075885025957, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 784.8910964661444}, "__all_modules__": {"num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 180000, "num_module_steps_trained_lifetime": 59850, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 4726.56299658815, "num_module_steps_trained_throughput": 26581451.786970757, "num_module_steps_trained_lifetime_throughput": 12889073.753424538}, "IntrinsicAttentionMask": [[[0.16252835094928741, 0.16829140484333038, 0.16608372330665588, 0.16801446676254272, 0.16787616908550262, 0.16720588505268097], [0.1589297503232956, 0.16972362995147705, 0.1655494123697281, 0.16919733583927155, 0.16893479228019714, 0.16766506433486938], [0.16028611361980438, 0.16918163001537323, 0.16575385630130768, 0.16875027120113373, 0.1685350090265274, 0.16749307513237], [0.15909843146800995, 0.16965608298778534, 0.1655750423669815, 0.16914165019989014, 0.1688850224018097, 0.167643740773201], [0.1591828316450119, 0.1696223020553589, 0.16558784246444702, 0.16911379992961884, 0.16886012256145477, 0.1676330715417862], [0.15959332883358002, 0.16945815086364746, 0.1656499058008194, 0.16897843778133392, 0.16873909533023834, 0.16758109629154205]], [[0.16808606684207916, 0.17043443024158478, 0.16422736644744873, 0.1674000322818756, 0.16629497706890106, 0.16355708241462708], [0.16826723515987396, 0.17092303931713104, 0.16391374170780182, 0.16749228537082672, 0.16624484956264496, 0.1631588488817215], [0.16778205335140228, 0.16961847245693207, 0.16475249826908112, 0.1672445386648178, 0.1663777083158493, 0.16422468423843384], [0.16803260147571564, 0.17029057443141937, 0.16431982815265656, 0.16737274825572968, 0.166309654712677, 0.16367457807064056], [0.1679459512233734, 0.1700577437877655, 0.16446958482265472, 0.16732847690582275, 0.16633331775665283, 0.1638648957014084], [0.16772843897342682, 0.16947504878044128, 0.16484501957893372, 0.16721703112125397, 0.16639214754104614, 0.16434238851070404]], [[0.16219274699687958, 0.16794389486312866, 0.16780565679073334, 0.16766752302646637, 0.16752952337265015, 0.16686061024665833], [0.1583106368780136, 0.16906246542930603, 0.16880013048648834, 0.16853821277618408, 0.16827669739723206, 0.16701191663742065], [0.1584015190601349, 0.1690361648797989, 0.16877678036689758, 0.1685177981853485, 0.16825921833515167, 0.16700854897499084], [0.15849241614341736, 0.16900984942913055, 0.16875341534614563, 0.16849738359451294, 0.1682417243719101, 0.16700518131256104], [0.1585833877325058, 0.1689835488796234, 0.16873006522655487, 0.16847696900367737, 0.1682242453098297, 0.16700181365013123], [0.1590258926153183, 0.16885563731193542, 0.16861645877361298, 0.16837762296199799, 0.16813914477825165, 0.16698525846004486]], [[0.16551321744918823, 0.170185387134552, 0.16514813899993896, 0.1649658977985382, 0.16683001816272736, 0.16735734045505524], [0.16505607962608337, 0.17158536612987518, 0.16454891860485077, 0.16429592669010162, 0.1668890416622162, 0.16762466728687286], [0.1655494123697281, 0.1700747013092041, 0.16519564390182495, 0.16501903533935547, 0.16682521998882294, 0.16733603179454803], [0.16556750237941742, 0.17001938819885254, 0.16521939635276794, 0.1650456190109253, 0.16682282090187073, 0.16732537746429443], [0.1653832495212555, 0.17058305442333221, 0.16497762501239777, 0.16477519273757935, 0.1668471246957779, 0.1674336940050125], [0.16533145308494568, 0.17074161767959595, 0.1649097055196762, 0.1646992415189743, 0.1668538600206375, 0.16746406257152557]], [[0.16286450624465942, 0.16863948106765747, 0.16850066184997559, 0.1662902534008026, 0.16615337133407593, 0.16755171120166779], [0.15955083072185516, 0.1703868955373764, 0.17012250423431396, 0.16593849658966064, 0.16568100452423096, 0.16832028329372406], [0.15962857007980347, 0.17034560441970825, 0.17008420825004578, 0.16594699025154114, 0.16569235920906067, 0.1683022826910019], [0.16087882220745087, 0.16968341171741486, 0.16946987807750702, 0.16608215868473053, 0.16587316989898682, 0.1680126041173935], [0.16095702350139618, 0.1696421056985855, 0.16943153738975525, 0.16609050333499908, 0.1658843457698822, 0.16799446940422058], [0.16016240417957306, 0.17006239295005798, 0.16982151567935944, 0.16600510478019714, 0.16576997935771942, 0.16817864775657654]], [[0.1668483316898346, 0.16834215819835663, 0.16655632853507996, 0.16423353552818298, 0.1679004281759262, 0.1661192923784256], [0.1668834388256073, 0.16867849230766296, 0.1665329486131668, 0.16374915838241577, 0.16814737021923065, 0.16600856184959412], [0.16684135794639587, 0.16827607154846191, 0.16656085848808289, 0.16432882845401764, 0.16785188019275665, 0.16614100337028503], [0.16678501665592194, 0.1677466630935669, 0.1665966808795929, 0.16509436070919037, 0.16746263206005096, 0.16631460189819336], [0.16687314212322235, 0.1685793250799179, 0.16653987765312195, 0.16389183700084686, 0.1680745929479599, 0.16604124009609222], [0.1668308973312378, 0.16817699372768402, 0.16656765341758728, 0.16447186470031738, 0.1677790880203247, 0.1661735475063324]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 2000}, "env_to_module_sum_episodes_length_in": 10.368238387501162, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0317495831278975e-05, "remove_single_ts_time_rank_from_batch": 1.1793472289618954e-05, "tensor_to_numpy": 1.4723896212026532e-05, "get_actions": 3.56239030447721e-05, "un_batch_to_individual_items": 6.5127089337943225e-06, "normalize_and_clip_actions": 7.796766130670499e-06}}, "connector_pipeline_timer": 0.00011248327027572463}, "env_to_module_sum_episodes_length_out": 10.368238387501162, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8090783600141766e-06, "add_states_from_episodes_to_batch": 2.72623621875258e-06, "batch_individual_items": 1.2485679905566053e-05, "add_time_dim_to_batch_and_zero_pad": 6.9399375398796456e-06, "numpy_to_tensor": 1.1705239756388666e-05}}, "connector_pipeline_timer": 5.8445714415799055e-05}, "sample": 0.11848638396203752, "num_module_steps_sampled": {"default_policy": 400}, "rlmodule_inference_timer": 3.104399424783393e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "env_step_timer": 1.3801825926060825e-05, "agent_episode_returns_mean": {"default_agent": -1.25}, "num_episodes": 20, "episode_len_mean": 20.0, "num_episodes_lifetime": 100, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_mean": -1.25, "episode_return_min": -16.5, "episode_len_max": 20, "weights_seq_no": 5.0, "episode_duration_sec_mean": 0.005215187175199389, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 25400, "env_reset_timer": 0.0005558384301777033, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": -1.25}, "time_between_sampling": 9.82123812811289}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "b7d62_00000", "date": "2025-08-11_18-38-23", "timestamp": 1754930303, "time_this_iter_s": 9.830579042434692, "time_total_s": 48.670881509780884, "pid": 11547, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1550f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 48.670881509780884, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 42.42142857142857, "ram_util_percent": 81.25714285714287}}
{"timers": {"training_iteration": 9.39426838709408, "restore_env_runners": 1.0201776328082683e-05, "training_step": 9.394059968461084, "env_runner_sampling_timer": 1.6537770122619153, "learner_update_timer": 7.54377757782264, "synch_weights": 0.0014315000609962864, "restore_eval_env_runners": 4.2315473395414886e-05, "evaluation_iteration": 0.12875238708574965, "synch_eval_env_connectors": 0.00014543266123278296, "synch_env_connectors": 4.686769429456909e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.598052311850615e-06, "remove_single_ts_time_rank_from_batch": 1.1812196064764972e-05, "tensor_to_numpy": 1.5106071759631881e-05, "get_actions": 3.825394260856654e-05, "normalize_and_clip_actions": 8.096729042471956e-06, "listify_data_for_vector_env": 1.0536755416214466e-05}}, "connector_pipeline_timer": 0.00011676120999953582}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.019248686102642e-06, "numpy_to_tensor": 1.234409548010657e-05, "add_observations_from_episodes_to_batch": 2.862857659551947e-06, "add_states_from_episodes_to_batch": 2.7575260537273296e-06, "batch_individual_items": 1.2534600270657772e-05}}, "connector_pipeline_timer": 5.984904187946274e-05}, "episode_duration_sec_mean": 0.005238913181703538, "episode_len_mean": 20.0, "sample": 0.005616325262178893, "num_episodes_lifetime": -123000.0, "episode_return_max": 12.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_episode_returns_mean": {"default_policy": 4.420000000000002}, "episode_len_min": 20, "time_between_sampling": 0.033632851482977226, "agent_episode_returns_mean": {"default_agent": 4.420000000000002}, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "rlmodule_inference_timer": 3.122258915038847e-05, "episode_return_mean": 4.420000000000002, "num_env_steps_sampled_lifetime": -2460000.0, "env_reset_timer": 3.958069955110909e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -7.5, "env_step_timer": 1.3917040370511544e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "weights_seq_no": 5.0, "num_env_steps_sampled_lifetime_throughput": 3264.8074550551737}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1575418037212642, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009320623007104538, "add_observations_from_episodes_to_batch": 0.0008850072611230639, "add_columns_from_episodes_to_train_batch": 0.042642689893039466, "add_time_dim_to_batch_and_zero_pad": 0.09141059663933668, "add_states_from_episodes_to_batch": 0.0036075662047479846, "batch_individual_items": 0.00943704252942979, "numpy_to_tensor": 7.781811502000164e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_kl_coeff": 0.0025247489102184772, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 6.0, "entropy": 0.6849592924118042, "vf_explained_var": -0.0001996755599975586, "module_train_batch_size_mean": 998.5423314844973, "num_module_steps_trained_lifetime": 35910, "vf_loss": 0.3205145001411438, "use_intrinsic_rewards": 0.0, "policy_loss": -0.00021854885562788695, "vf_loss_unclipped": 42.33578109741211, "num_module_steps_trained": 5985, "total_loss": 0.24842172861099243, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 1.7260908862226643e-05, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 781.9265722654425}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_explained_var": 0.0028792619705200195, "module_train_batch_size_mean": 997.6644392492373, "num_module_steps_trained_lifetime": 215460, "vf_loss": 0.3205373287200928, "use_intrinsic_rewards": 1.0, "policy_loss": -0.00021148759697098285, "vf_loss_unclipped": 42.26250076293945, "num_module_steps_trained": 35910, "total_loss": 0.24844905734062195, "mean_kl_loss": 1.6123703971970826e-05, "diff_num_grad_updates_vs_sampler_policy": 31.0, "entropy": 0.684984028339386, "weights_seq_no": 36.0}, "intrinsic_reward_module": {"weights_seq_no": 36.0, "module_train_batch_size_mean": 997.6644392492373, "num_module_steps_trained": 35910, "total_loss": 0.0, "num_module_steps_trained_lifetime": 215460, "diff_num_grad_updates_vs_sampler_policy": 31.0}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 430920, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 1296000, "num_env_steps_trained_lifetime_throughput": 60808.19971261338}}}, "intrinsic_reward_module": {"total_loss": 0.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 35910, "num_trainable_parameters": 8266, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "weights_seq_no": 6.0, "module_train_batch_size_mean": 998.5423314844973, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 781.9374254989995}, "__all_modules__": {"num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 216000, "num_module_steps_trained_lifetime": 71820, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 4708.623040279643, "num_module_steps_trained_throughput": 25888278.061206732, "num_module_steps_trained_lifetime_throughput": 12867320.086798009}, "IntrinsicAttentionMask": [[[0.16286307573318481, 0.16656287014484406, 0.16642576456069946, 0.16628877818584442, 0.16822189092636108, 0.16963765025138855], [0.16071894764900208, 0.16649200022220612, 0.166276752948761, 0.16606177389621735, 0.169104665517807, 0.17134590446949005], [0.16079719364643097, 0.16649474203586578, 0.16628237068653107, 0.16607025265693665, 0.16907238960266113, 0.17128314077854156], [0.16087546944618225, 0.16649748384952545, 0.16628795862197876, 0.16607870161533356, 0.16904008388519287, 0.17122037708759308], [0.15977934002876282, 0.16645805537700653, 0.16620835661888123, 0.16595904529094696, 0.1694929152727127, 0.17210230231285095], [0.1589878797531128, 0.1664280742406845, 0.1661492884159088, 0.16587094962596893, 0.16982059180736542, 0.17274318635463715]], [[0.16551473736763, 0.1673850566148758, 0.16514964401721954, 0.16496741771697998, 0.1696241796016693, 0.1673588752746582], [0.16533096134662628, 0.16749800741672516, 0.16490840911865234, 0.1646975427865982, 0.17009742558002472, 0.1674676388502121], [0.1655508428812027, 0.16736282408237457, 0.16519705951213837, 0.16502046585083008, 0.16953130066394806, 0.16733747720718384], [0.16556888818740845, 0.16735172271728516, 0.16522078216075897, 0.16504698991775513, 0.16948488354682922, 0.16732677817344666], [0.16511334478855133, 0.1676311194896698, 0.16462302207946777, 0.16437841951847076, 0.17065823078155518, 0.16759581863880157], [0.16533352434635162, 0.1674964278936386, 0.16491176187992096, 0.16470129787921906, 0.17009083926677704, 0.16746613383293152]], [[0.1625286191701889, 0.16622081398963928, 0.16815315186977386, 0.1680147349834442, 0.1678764522075653, 0.16720615327358246], [0.16020195186138153, 0.16595643758773804, 0.1689974069595337, 0.1687789261341095, 0.1685607135295868, 0.16750457882881165], [0.15901502966880798, 0.16581767797470093, 0.16943049430847168, 0.16917051374912262, 0.1689109355211258, 0.16765540838241577], [0.15909937024116516, 0.16582761704921722, 0.1693996638059616, 0.16914264857769012, 0.1688860058784485, 0.16764472424983978], [0.15918374061584473, 0.16583755612373352, 0.16936883330345154, 0.16911478340625763, 0.16886109113693237, 0.1676340252161026], [0.15959413349628448, 0.16588568687438965, 0.169218972325325, 0.16897928714752197, 0.1687399446964264, 0.1675819307565689]], [[0.16758547723293304, 0.16687391698360443, 0.16729219257831573, 0.1649591326713562, 0.16643604636192322, 0.16685321927070618], [0.16749759018421173, 0.16685429215431213, 0.1672324687242508, 0.16512185335159302, 0.16645827889442444, 0.16683556139469147], [0.16754931211471558, 0.16686585545539856, 0.16726762056350708, 0.16502611339092255, 0.16644522547721863, 0.16684597730636597], [0.16725921630859375, 0.16680079698562622, 0.16707035899162292, 0.16556376218795776, 0.16651837527751923, 0.16678746044635773], [0.16744332015514374, 0.16684213280677795, 0.16719557344913483, 0.1652223765850067, 0.16647198796272278, 0.16682463884353638], [0.1674950271844864, 0.16685371100902557, 0.1672307252883911, 0.16512659192085266, 0.16645893454551697, 0.16683505475521088]], [[0.1635430008172989, 0.16725824773311615, 0.167120561003685, 0.1669829934835434, 0.16684554517269135, 0.1682497262954712], [0.1617799699306488, 0.1675911247730255, 0.16737446188926697, 0.1671580672264099, 0.16694195568561554, 0.16915452480316162], [0.16184431314468384, 0.16757896542549133, 0.1673651933670044, 0.16715170443058014, 0.16693846881389618, 0.16912132501602173], [0.16190870106220245, 0.16756683588027954, 0.1673559695482254, 0.16714535653591156, 0.1669350117444992, 0.16908815503120422], [0.16197310388088226, 0.16755467653274536, 0.16734670102596283, 0.1671389937400818, 0.16693153977394104, 0.16905497014522552], [0.1613185554742813, 0.167678102850914, 0.16744059324264526, 0.16720342636108398, 0.16696660220623016, 0.1693926602602005]], [[0.1655111312866211, 0.1681044101715088, 0.1668468862771988, 0.16520525515079498, 0.16779373586177826, 0.1665385216474533], [0.16469742357730865, 0.16912110149860382, 0.1669699251651764, 0.16417883336544037, 0.1685885787010193, 0.16644418239593506], [0.16509035229682922, 0.1686297357082367, 0.16691091656684875, 0.16467419266700745, 0.1682046502828598, 0.16649018228054047], [0.1656080186367035, 0.16798363626003265, 0.16683202981948853, 0.16532759368419647, 0.1676992028951645, 0.16654954850673676], [0.1647942066192627, 0.16899998486042023, 0.16695545613765717, 0.164300799369812, 0.16849398612976074, 0.16645556688308716], [0.16518716514110565, 0.16850876808166504, 0.166896253824234, 0.16479632258415222, 0.16811007261276245, 0.16650137305259705]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 2400}, "env_to_module_sum_episodes_length_in": 10.368238394470474, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.083650814296849e-05, "remove_single_ts_time_rank_from_batch": 1.2193300367385197e-05, "tensor_to_numpy": 1.552415494769118e-05, "get_actions": 3.8517219106870936e-05, "un_batch_to_individual_items": 6.801476410404103e-06, "normalize_and_clip_actions": 8.177522801934781e-06}}, "connector_pipeline_timer": 0.00011877480685178575}, "env_to_module_sum_episodes_length_out": 10.368238394470474, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.899120293748476e-06, "add_states_from_episodes_to_batch": 2.8164066417630624e-06, "batch_individual_items": 1.2776508113279172e-05, "add_time_dim_to_batch_and_zero_pad": 7.288156430772614e-06, "numpy_to_tensor": 1.301268593610153e-05}}, "connector_pipeline_timer": 6.127090327820366e-05}, "sample": 0.11848028762193107, "num_module_steps_sampled": {"default_policy": 400}, "rlmodule_inference_timer": 3.247333718922787e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "env_step_timer": 1.4878191938130815e-05, "agent_episode_returns_mean": {"default_agent": -0.85}, "num_episodes": 20, "episode_len_mean": 20.0, "num_episodes_lifetime": 120, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_mean": -0.85, "episode_return_min": -16.5, "episode_len_max": 20, "weights_seq_no": 6.0, "episode_duration_sec_mean": 0.005215805124025792, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 30400, "env_reset_timer": 0.0005511321268692806, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": -0.85}, "time_between_sampling": 9.818799300581075}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "b7d62_00000", "date": "2025-08-11_18-38-33", "timestamp": 1754930313, "time_this_iter_s": 9.679641962051392, "time_total_s": 58.350523471832275, "pid": 11547, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1550f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 58.350523471832275, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 42.0, "ram_util_percent": 81.11538461538461}}
{"timers": {"training_iteration": 9.39448055530353, "restore_env_runners": 1.0163927854346082e-05, "training_step": 9.394272010026294, "env_runner_sampling_timer": 1.6528284892186293, "learner_update_timer": 7.544901008295331, "synch_weights": 0.0014269446399386612, "restore_eval_env_runners": 4.2222739105248904e-05, "evaluation_iteration": 0.12871316238471195, "synch_eval_env_connectors": 0.0001465558350382837, "synch_env_connectors": 4.688231556018791e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.629161134959732e-06, "remove_single_ts_time_rank_from_batch": 1.1951781632456059e-05, "tensor_to_numpy": 1.5459092655567377e-05, "get_actions": 3.946348946845979e-05, "normalize_and_clip_actions": 8.141881410059206e-06, "listify_data_for_vector_env": 1.0702203396555875e-05}}, "connector_pipeline_timer": 0.00011892332424108697}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.243267339535863e-06, "numpy_to_tensor": 1.2546114117248377e-05, "add_observations_from_episodes_to_batch": 2.9179663712705478e-06, "add_states_from_episodes_to_batch": 2.8084324107020943e-06, "batch_individual_items": 1.2847384410256845e-05}}, "connector_pipeline_timer": 6.097898602348879e-05}, "episode_duration_sec_mean": 0.00535278393747285, "episode_len_mean": 20.0, "sample": 0.005666171027249957, "num_episodes_lifetime": -153875.0, "episode_return_max": 12.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_episode_returns_mean": {"default_policy": 3.5400000000000005}, "episode_len_min": 20, "time_between_sampling": 0.03322975700092462, "agent_episode_returns_mean": {"default_agent": 3.5400000000000005}, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "rlmodule_inference_timer": 3.209975001996174e-05, "episode_return_mean": 3.5400000000000005, "num_env_steps_sampled_lifetime": -3077500.0, "env_reset_timer": 4.0535701797257166e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -7.5, "env_step_timer": 1.4363622965515722e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "weights_seq_no": 6.0, "num_env_steps_sampled_lifetime_throughput": 3214.6243341750746}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15748671193451713, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009315087187318265, "add_observations_from_episodes_to_batch": 0.0008844342794766721, "add_columns_from_episodes_to_train_batch": 0.04263611215377075, "add_time_dim_to_batch_and_zero_pad": 0.09138712359314331, "add_states_from_episodes_to_batch": 0.003610051372990003, "batch_individual_items": 0.009416421683159062, "numpy_to_tensor": 7.761701393332347e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_kl_coeff": 0.0012623744551092386, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 7.0, "entropy": 0.6845404505729675, "vf_explained_var": -0.0001518726348876953, "module_train_batch_size_mean": 998.4808932973482, "num_module_steps_trained_lifetime": 41895, "vf_loss": 0.3205088675022125, "use_intrinsic_rewards": 0.0, "policy_loss": -0.000134440662804991, "vf_loss_unclipped": 42.255775451660156, "num_module_steps_trained": 5985, "total_loss": 0.24850201606750488, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 8.226313184422906e-06, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 778.9073345663818}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_explained_var": 0.002851247787475586, "module_train_batch_size_mean": 997.6122293241576, "num_module_steps_trained_lifetime": 251370, "vf_loss": 0.3205389380455017, "use_intrinsic_rewards": 1.0, "policy_loss": -0.00012926134513691068, "vf_loss_unclipped": 42.17011642456055, "num_module_steps_trained": 35910, "total_loss": 0.2485317885875702, "mean_kl_loss": 7.5692769314628094e-06, "diff_num_grad_updates_vs_sampler_policy": 36.0, "entropy": 0.6845619678497314, "weights_seq_no": 42.0}, "intrinsic_reward_module": {"weights_seq_no": 42.0, "module_train_batch_size_mean": 997.6122293241576, "num_module_steps_trained": 35910, "total_loss": 0.0, "num_module_steps_trained_lifetime": 251370, "diff_num_grad_updates_vs_sampler_policy": 36.0}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 502740, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 1512000, "num_env_steps_trained_lifetime_throughput": 59785.97720167518}}}, "intrinsic_reward_module": {"total_loss": 0.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 41895, "num_trainable_parameters": 8266, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "weights_seq_no": 7.0, "module_train_batch_size_mean": 998.4808932973482, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 778.9176523168466}, "__all_modules__": {"num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 252000, "num_module_steps_trained_lifetime": 83790, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 4690.276875336832, "num_module_steps_trained_throughput": 25211353.323166616, "num_module_steps_trained_lifetime_throughput": 12840148.504260896}, "IntrinsicAttentionMask": [[[0.16252779960632324, 0.16829083859920502, 0.168152317404747, 0.16801390051841736, 0.16580985486507416, 0.1672053188085556], [0.1589278280735016, 0.1697215735912323, 0.16945822536945343, 0.1691952794790268, 0.16503405570983887, 0.16766302287578583], [0.15901218354701996, 0.16968783736228943, 0.16942745447158813, 0.16916747391223907, 0.16505256295204163, 0.1676524132490158], [0.1590965986251831, 0.16965413093566895, 0.16939672827720642, 0.16913969814777374, 0.16507108509540558, 0.1676418036222458], [0.1604546755552292, 0.1691126525402069, 0.16890275478363037, 0.16869311034679413, 0.16536661982536316, 0.16747014224529266], [0.15959171950817108, 0.16945643723011017, 0.16921642422676086, 0.16897673904895782, 0.1651793122291565, 0.16757939755916595]], [[0.1669551283121109, 0.16585297882556915, 0.1665005385875702, 0.16627369821071625, 0.16859674453735352, 0.16582097113132477], [0.16693753004074097, 0.1659030169248581, 0.16651089489459991, 0.16629797220230103, 0.16847768425941467, 0.1658729463815689], [0.1669478714466095, 0.16587357223033905, 0.16650478541851044, 0.16628369688987732, 0.16854771971702576, 0.16584235429763794], [0.1669442504644394, 0.165883868932724, 0.16650691628456116, 0.16628867387771606, 0.16852320730686188, 0.16585305333137512], [0.166981041431427, 0.16577905416488647, 0.16648519039154053, 0.16623781621456146, 0.16877272725105286, 0.16574415564537048], [0.16693702340126038, 0.1659044623374939, 0.1665111780166626, 0.16629867255687714, 0.1684742122888565, 0.1658744513988495]], [[0.16813956201076508, 0.1652456521987915, 0.16777588427066803, 0.16759434342384338, 0.16470980644226074, 0.16653472185134888], [0.16776324808597565, 0.1656082719564438, 0.16749295592308044, 0.16735796630382538, 0.16520820558071136, 0.16656936705112457], [0.16809262335300446, 0.16529087722301483, 0.1677406132221222, 0.16756488382816315, 0.1647719293832779, 0.16653907299041748], [0.16806913912296295, 0.1653134673833847, 0.16772295534610748, 0.16755013167858124, 0.16480296850204468, 0.1665412336587906], [0.1676928550004959, 0.16567611694335938, 0.1674399971961975, 0.16731370985507965, 0.16530153155326843, 0.16657575964927673], [0.1679316610097885, 0.1654459536075592, 0.16761961579322815, 0.16746380925178528, 0.16498501598834991, 0.16655394434928894]], [[0.166025772690773, 0.16707095503807068, 0.1673656851053238, 0.1657189428806305, 0.16676218807697296, 0.1670563817024231], [0.16584353148937225, 0.16718579828739166, 0.1675647348165512, 0.16544991731643677, 0.1667890101671219, 0.1671670526266098], [0.165792316198349, 0.16721801459789276, 0.16762062907218933, 0.16537439823150635, 0.1667964905500412, 0.1671980917453766], [0.1660795360803604, 0.16703711450099945, 0.167307049036026, 0.16579832136631012, 0.16675427556037903, 0.16702376306056976], [0.16589725017547607, 0.16715195775032043, 0.16750605404376984, 0.16552919149398804, 0.16678112745285034, 0.16713443398475647], [0.1658460646867752, 0.16718420386314392, 0.16756196320056915, 0.16545367240905762, 0.16678863763809204, 0.16716551780700684]], [[0.1676807701587677, 0.1674993336200714, 0.1646164357662201, 0.1671370416879654, 0.1642603725194931, 0.16880598664283752], [0.16766472160816193, 0.16748617589473724, 0.16464902460575104, 0.16712968051433563, 0.16429854929447174, 0.16877184808254242], [0.16740675270557404, 0.16727472841739655, 0.16517166793346405, 0.16701097786426544, 0.16491124033927917, 0.16822467744350433], [0.167632594704628, 0.1674598604440689, 0.16471417248249054, 0.16711492836475372, 0.16437490284442902, 0.1687035709619522], [0.16737452149391174, 0.16724829375743866, 0.16523689031600952, 0.1669960916042328, 0.1649877279996872, 0.1681564748287201], [0.16777996718883514, 0.16758055984973907, 0.16441527009010315, 0.16718247532844543, 0.1640247106552124, 0.1690169721841812]], [[0.1675848364830017, 0.1668732762336731, 0.1672915518283844, 0.16714510321617126, 0.16643540561199188, 0.16466981172561646], [0.16749706864356995, 0.16685377061367035, 0.167231947183609, 0.16709953546524048, 0.16645777225494385, 0.16485998034477234], [0.16754868626594543, 0.16686522960662842, 0.16726699471473694, 0.16712632775306702, 0.1664445996284485, 0.16474805772304535], [0.16753064095973969, 0.16686123609542847, 0.1672547459602356, 0.16711698472499847, 0.16644921898841858, 0.16478721797466278], [0.16744284331798553, 0.16684165596961975, 0.16719509661197662, 0.1670713573694229, 0.16647151112556458, 0.16497744619846344], [0.16722281277179718, 0.16679243743419647, 0.1670455038547516, 0.16695693135261536, 0.16652722656726837, 0.16545507311820984]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 2800}, "env_to_module_sum_episodes_length_in": 10.368238394572801, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0309795268171775e-05, "remove_single_ts_time_rank_from_batch": 1.1843285500953321e-05, "tensor_to_numpy": 1.4902155527640663e-05, "get_actions": 3.551633576992807e-05, "un_batch_to_individual_items": 6.487181073546992e-06, "normalize_and_clip_actions": 7.721830796256268e-06}}, "connector_pipeline_timer": 0.0001124768826624901}, "env_to_module_sum_episodes_length_out": 10.368238394572801, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8096055960825507e-06, "add_states_from_episodes_to_batch": 2.733589218295561e-06, "batch_individual_items": 1.2489633774904345e-05, "add_time_dim_to_batch_and_zero_pad": 7.0868272355938364e-06, "numpy_to_tensor": 1.1754643268516348e-05}}, "connector_pipeline_timer": 5.852813623344125e-05}, "sample": 0.11845529140469126, "num_module_steps_sampled": {"default_policy": 400}, "rlmodule_inference_timer": 3.0141853773460284e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "env_step_timer": 1.3745252064361159e-05, "agent_episode_returns_mean": {"default_agent": -0.65}, "num_episodes": 20, "episode_len_mean": 20.0, "num_episodes_lifetime": 140, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_mean": -0.65, "episode_return_min": -16.5, "episode_len_max": 20, "weights_seq_no": 7.0, "episode_duration_sec_mean": 0.005235316762700677, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 35400, "env_reset_timer": 0.000549157465824787, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": -0.65}, "time_between_sampling": 9.81507124674473}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "b7d62_00000", "date": "2025-08-11_18-38-42", "timestamp": 1754930322, "time_this_iter_s": 9.54291319847107, "time_total_s": 67.89343667030334, "pid": 11547, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1550f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 67.89343667030334, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 38.75714285714285, "ram_util_percent": 78.73571428571428}}
{"timers": {"training_iteration": 9.397618003079486, "restore_env_runners": 1.0125627824102221e-05, "training_step": 9.397409559516984, "env_runner_sampling_timer": 1.651356614326404, "learner_update_timer": 7.549466926551893, "synch_weights": 0.001422108944068117, "restore_eval_env_runners": 4.1888421580320806e-05, "evaluation_iteration": 0.128672268670519, "synch_eval_env_connectors": 0.00014645819630057679, "synch_env_connectors": 4.680519503793713e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.52856992060369e-06, "remove_single_ts_time_rank_from_batch": 1.1761735380187762e-05, "tensor_to_numpy": 1.5080586683761715e-05, "get_actions": 3.7988997999387195e-05, "normalize_and_clip_actions": 7.993823946450948e-06, "listify_data_for_vector_env": 1.0508961885600879e-05}}, "connector_pipeline_timer": 0.0001159886060165378}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.990261752980128e-06, "numpy_to_tensor": 1.2287050472085358e-05, "add_observations_from_episodes_to_batch": 2.8392872130845777e-06, "add_states_from_episodes_to_batch": 2.7441917856747457e-06, "batch_individual_items": 1.2557376662758904e-05}}, "connector_pipeline_timer": 5.9525638028937595e-05}, "episode_duration_sec_mean": 0.0052027823338285095, "episode_len_mean": 20.0, "sample": 0.005613684827768687, "num_episodes_lifetime": -184750.0, "episode_return_max": 12.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_episode_returns_mean": {"default_policy": 3.5400000000000005}, "episode_len_min": 20, "time_between_sampling": 0.032546975149958836, "agent_episode_returns_mean": {"default_agent": 3.5400000000000005}, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "rlmodule_inference_timer": 3.088317748376407e-05, "episode_return_mean": 3.5400000000000005, "num_env_steps_sampled_lifetime": -3695000.0, "env_reset_timer": 3.6504353988984414e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -7.5, "env_step_timer": 1.3867256071178997e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "weights_seq_no": 7.0, "num_env_steps_sampled_lifetime_throughput": 3305.8831935750027}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15744266356578812, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009309965486319587, "add_observations_from_episodes_to_batch": 0.000884044527252087, "add_columns_from_episodes_to_train_batch": 0.04263990187219883, "add_time_dim_to_batch_and_zero_pad": 0.09136477443668524, "add_states_from_episodes_to_batch": 0.0036113550288214445, "batch_individual_items": 0.009395971636466756, "numpy_to_tensor": 7.740626369887792e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_kl_coeff": 0.0006311872275546193, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 8.0, "entropy": 0.6838856339454651, "vf_explained_var": -0.00021898746490478516, "module_train_batch_size_mean": 998.4230504637324, "num_module_steps_trained_lifetime": 47880, "vf_loss": 0.32050958275794983, "use_intrinsic_rewards": 0.0, "policy_loss": -0.00021696770272683352, "vf_loss_unclipped": 42.38315200805664, "num_module_steps_trained": 5985, "total_loss": 0.2484210580587387, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 9.969648999685887e-06, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 775.55674869633}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_explained_var": 0.002855658531188965, "module_train_batch_size_mean": 997.5758696422192, "num_module_steps_trained_lifetime": 287280, "vf_loss": 0.32053664326667786, "use_intrinsic_rewards": 1.0, "policy_loss": -0.00020557414973154664, "vf_loss_unclipped": 42.30660629272461, "num_module_steps_trained": 35910, "total_loss": 0.24845486879348755, "mean_kl_loss": 8.852012797433417e-06, "diff_num_grad_updates_vs_sampler_policy": 41.0, "entropy": 0.6839206218719482, "weights_seq_no": 48.0}, "intrinsic_reward_module": {"weights_seq_no": 48.0, "module_train_batch_size_mean": 997.5758696422192, "num_module_steps_trained": 35910, "total_loss": 0.0, "num_module_steps_trained_lifetime": 287280, "diff_num_grad_updates_vs_sampler_policy": 41.0}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 574560, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 1728000, "num_env_steps_trained_lifetime_throughput": 58744.06697800219}}}, "intrinsic_reward_module": {"total_loss": 0.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 47880, "num_trainable_parameters": 8266, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "weights_seq_no": 8.0, "module_train_batch_size_mean": 998.4230504637324, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 775.5665379701286}, "__all_modules__": {"num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 288000, "num_module_steps_trained_lifetime": 95760, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 4669.93532669879, "num_module_steps_trained_throughput": 24565052.57235318, "num_module_steps_trained_lifetime_throughput": 12822436.992787937}, "IntrinsicAttentionMask": [[[0.16768531501293182, 0.16750386357307434, 0.16732260584831238, 0.1644427627325058, 0.1669607013463974, 0.16608481109142303], [0.16766908764839172, 0.16749054193496704, 0.16731218993663788, 0.16447797417640686, 0.16695605218410492, 0.1660940796136856], [0.167652890086174, 0.16747725009918213, 0.16730180382728577, 0.1645132303237915, 0.16695143282413483, 0.16610340774059296], [0.16739292442798615, 0.16726379096508026, 0.16713474690914154, 0.16507908701896667, 0.16687697172164917, 0.16625244915485382], [0.1676204651594162, 0.16745062172412872, 0.16728097200393677, 0.1645837128162384, 0.16694216430187225, 0.16612200438976288], [0.1675417125225067, 0.1673859804868698, 0.16723039746284485, 0.16475506126880646, 0.16691964864730835, 0.16616719961166382]], [[0.16628021001815796, 0.16888552904129028, 0.16607525944709778, 0.16597290337085724, 0.16701774299144745, 0.1657683402299881], [0.1660042703151703, 0.17046304047107697, 0.16565561294555664, 0.1654815524816513, 0.1672615259885788, 0.165133997797966], [0.16630198061466217, 0.16876088082790375, 0.16610845923423767, 0.16601179540157318, 0.1669982671737671, 0.16581861674785614], [0.1663128286600113, 0.16869856417179108, 0.16612504422664642, 0.16603121161460876, 0.1669885218143463, 0.16584374010562897], [0.16620196402072906, 0.16933347284793854, 0.165956050157547, 0.1658332347869873, 0.16708746552467346, 0.1655878722667694], [0.1663345843553543, 0.1685740351676941, 0.16615822911262512, 0.1660701185464859, 0.16696904599666595, 0.1658940315246582]], [[0.16722948849201202, 0.16704852879047394, 0.16686777770519257, 0.16399575769901276, 0.1665068417787552, 0.1683516651391983], [0.1672205924987793, 0.16704252362251282, 0.16686464846134186, 0.16403800249099731, 0.1665094643831253, 0.1683247834444046], [0.16721168160438538, 0.1670365184545517, 0.16686151921749115, 0.16408029198646545, 0.16651208698749542, 0.1682979017496109], [0.167068749666214, 0.1669398695230484, 0.16681107878684998, 0.16475939750671387, 0.166553795337677, 0.16786713898181915], [0.16719388961791992, 0.16702449321746826, 0.16685526072978973, 0.16416487097740173, 0.16651731729507446, 0.1682441532611847], [0.16728436946868896, 0.16708555817604065, 0.16688698530197144, 0.1637348085641861, 0.1664905548095703, 0.16851772367954254]], [[0.1692461520433426, 0.16812889277935028, 0.16536082327365875, 0.16513554751873016, 0.1674426794052124, 0.164685919880867], [0.16908703744411469, 0.16803918778896332, 0.16544122993946075, 0.1652296930551529, 0.16739539802074432, 0.16480739414691925], [0.16868863999843597, 0.16781431436538696, 0.16564270853996277, 0.16546563804149628, 0.16727669537067413, 0.16511204838752747], [0.16865593194961548, 0.1677958369255066, 0.16565923392772675, 0.16548499464988708, 0.16726692020893097, 0.16513706743717194], [0.16898883879184723, 0.1679838001728058, 0.16549088060855865, 0.1652878224849701, 0.16736619174480438, 0.16488243639469147], [0.16859054565429688, 0.16775888204574585, 0.1656922996044159, 0.1655237227678299, 0.16724736988544464, 0.16518710553646088]], [[0.1628647893667221, 0.16863976418972015, 0.16642752289772034, 0.16836225986480713, 0.16615363955497742, 0.16755199432373047], [0.15955179929733276, 0.17038792371749878, 0.16619737446308136, 0.16985955834388733, 0.16568200290203094, 0.16832129657268524], [0.16080130636692047, 0.16972540318965912, 0.16628660261631012, 0.1692926585674286, 0.16586263477802277, 0.16803142428398132], [0.1597072333097458, 0.1703052967786789, 0.1662086397409439, 0.1697888970375061, 0.1657046675682068, 0.16828525066375732], [0.16095764935016632, 0.16964276134967804, 0.1662975549697876, 0.1692219078540802, 0.16588498651981354, 0.16799511015415192], [0.16016320884227753, 0.17006325721740723, 0.16624142229557037, 0.1695818454027176, 0.16577081382274628, 0.1681794971227646]], [[0.1692461520433426, 0.16812889277935028, 0.16536082327365875, 0.16513554751873016, 0.1674426794052124, 0.164685919880867], [0.16908703744411469, 0.16803918778896332, 0.16544122993946075, 0.1652296930551529, 0.16739539802074432, 0.16480739414691925], [0.16868863999843597, 0.16781431436538696, 0.16564270853996277, 0.16546563804149628, 0.16727669537067413, 0.16511204838752747], [0.16865593194961548, 0.1677958369255066, 0.16565923392772675, 0.16548499464988708, 0.16726692020893097, 0.16513706743717194], [0.16898883879184723, 0.1679838001728058, 0.16549088060855865, 0.1652878224849701, 0.16736619174480438, 0.16488243639469147], [0.16859054565429688, 0.16775888204574585, 0.1656922996044159, 0.1655237227678299, 0.16724736988544464, 0.16518710553646088]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 3200}, "env_to_module_sum_episodes_length_in": 10.3682383945743, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0167334880131667e-05, "remove_single_ts_time_rank_from_batch": 1.1725125305845898e-05, "tensor_to_numpy": 1.4724866664957075e-05, "get_actions": 3.4608728698183843e-05, "un_batch_to_individual_items": 6.435378753692489e-06, "normalize_and_clip_actions": 7.662935022657943e-06}}, "connector_pipeline_timer": 0.00011096754907291217}, "env_to_module_sum_episodes_length_out": 10.3682383945743, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.754583489106724e-06, "add_states_from_episodes_to_batch": 2.6889778692554733e-06, "batch_individual_items": 1.2304203415923118e-05, "add_time_dim_to_batch_and_zero_pad": 7.0035914065455025e-06, "numpy_to_tensor": 1.1626856039903326e-05}}, "connector_pipeline_timer": 5.809238343501359e-05}, "sample": 0.11839919639986145, "num_module_steps_sampled": {"default_policy": 400}, "rlmodule_inference_timer": 2.9819680908801463e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "env_step_timer": 1.3557008134239307e-05, "agent_episode_returns_mean": {"default_agent": -0.25}, "num_episodes": 20, "episode_len_mean": 20.0, "num_episodes_lifetime": 160, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_mean": -0.25, "episode_return_min": -16.5, "episode_len_max": 20, "weights_seq_no": 8.0, "episode_duration_sec_mean": 0.005229808776639402, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 40400, "env_reset_timer": 0.000547145890889452, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": -0.25}, "time_between_sampling": 9.814275426357465}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "b7d62_00000", "date": "2025-08-11_18-38-52", "timestamp": 1754930332, "time_this_iter_s": 9.832659006118774, "time_total_s": 77.72609567642212, "pid": 11547, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1550f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 77.72609567642212, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 45.449999999999996, "ram_util_percent": 78.2}}
{"timers": {"training_iteration": 9.40399891804949, "restore_env_runners": 1.009062117720647e-05, "training_step": 9.403790406421939, "env_runner_sampling_timer": 1.649890171103072, "learner_update_timer": 7.557251586446369, "synch_weights": 0.0014237361836853526, "restore_eval_env_runners": 4.156370804664984e-05, "evaluation_iteration": 0.12860166014488425, "synch_eval_env_connectors": 0.0001463519541334138, "synch_env_connectors": 4.6782932279429635e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.544437140414189e-06, "remove_single_ts_time_rank_from_batch": 1.1758686918246956e-05, "tensor_to_numpy": 1.5052139068068434e-05, "get_actions": 3.789543674981999e-05, "normalize_and_clip_actions": 7.959975985642852e-06, "listify_data_for_vector_env": 1.0479973695863342e-05}}, "connector_pipeline_timer": 0.00011587787031360465}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.972916483389568e-06, "numpy_to_tensor": 1.2237270067655712e-05, "add_observations_from_episodes_to_batch": 2.847804662713033e-06, "add_states_from_episodes_to_batch": 2.7485434624757944e-06, "batch_individual_items": 1.249226595248367e-05}}, "connector_pipeline_timer": 5.942096980992823e-05}, "episode_duration_sec_mean": 0.005200141512788831, "episode_len_mean": 20.0, "sample": 0.005535382008584817, "num_episodes_lifetime": -215625.0, "episode_return_max": 12.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_episode_returns_mean": {"default_policy": 3.7}, "episode_len_min": 20, "time_between_sampling": 0.03373961003605544, "agent_episode_returns_mean": {"default_agent": 3.7}, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "rlmodule_inference_timer": 3.0945936239494625e-05, "episode_return_mean": 3.7, "num_env_steps_sampled_lifetime": -4312500.0, "env_reset_timer": 3.3122350320877144e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -7.5, "env_step_timer": 1.3869251647076458e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "weights_seq_no": 8.0, "num_env_steps_sampled_lifetime_throughput": 3316.0869320269876}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1574012269301081, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009306635830487369, "add_observations_from_episodes_to_batch": 0.0008836349214957886, "add_columns_from_episodes_to_train_batch": 0.04263382077340169, "add_time_dim_to_batch_and_zero_pad": 0.091352598771886, "add_states_from_episodes_to_batch": 0.003613847729424692, "batch_individual_items": 0.0093748160902971, "numpy_to_tensor": 7.725011147123537e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_kl_coeff": 0.00031559361377730966, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 9.0, "entropy": 0.6834394335746765, "vf_explained_var": -0.0002777576446533203, "module_train_batch_size_mean": 998.3685925840979, "num_module_steps_trained_lifetime": 53865, "vf_loss": 0.32050850987434387, "use_intrinsic_rewards": 0.0, "policy_loss": -2.9891352824051864e-05, "vf_loss_unclipped": 42.365447998046875, "num_module_steps_trained": 5985, "total_loss": 0.24860796332359314, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 6.289903922152007e-06, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 771.6261339507694}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_explained_var": 0.002862393856048584, "module_train_batch_size_mean": 997.5505482791133, "num_module_steps_trained_lifetime": 323190, "vf_loss": 0.3205367922782898, "use_intrinsic_rewards": 1.0, "policy_loss": -2.9581507988041267e-05, "vf_loss_unclipped": 42.2772331237793, "num_module_steps_trained": 35910, "total_loss": 0.2486312836408615, "mean_kl_loss": 6.211775598785607e-06, "diff_num_grad_updates_vs_sampler_policy": 46.0, "entropy": 0.6834425330162048, "weights_seq_no": 54.0}, "intrinsic_reward_module": {"weights_seq_no": 54.0, "module_train_batch_size_mean": 997.5505482791133, "num_module_steps_trained": 35910, "total_loss": 0.0, "num_module_steps_trained_lifetime": 323190, "diff_num_grad_updates_vs_sampler_policy": 46.0}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 646380, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 1944000, "num_env_steps_trained_lifetime_throughput": 57699.55087155267}}}, "intrinsic_reward_module": {"total_loss": 0.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 53865, "num_trainable_parameters": 8266, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "weights_seq_no": 9.0, "module_train_batch_size_mean": 998.3685925840979, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 771.6353922334824}, "__all_modules__": {"num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 324000, "num_module_steps_trained_lifetime": 107730, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 4646.104328697218, "num_module_steps_trained_throughput": 23919424.412778333, "num_module_steps_trained_lifetime_throughput": 12779905.397160843}, "IntrinsicAttentionMask": [[[0.16320374608039856, 0.1669112741947174, 0.16677388548851013, 0.1666366159915924, 0.1685737818479538, 0.1679007112979889], [0.16125120222568512, 0.16704337298870087, 0.16682741045951843, 0.1666117161512375, 0.16966469585895538, 0.1686016470193863], [0.1613224446773529, 0.16703861951828003, 0.166825532913208, 0.16661272943019867, 0.1696246713399887, 0.16857600212097168], [0.16139373183250427, 0.1670338660478592, 0.16682365536689758, 0.16661372780799866, 0.16958466172218323, 0.16855034232139587], [0.16039542853832245, 0.16709989309310913, 0.16684924066066742, 0.16659896075725555, 0.17014645040035248, 0.16891004145145416], [0.1607404351234436, 0.1670771986246109, 0.1668405532836914, 0.16660422086715698, 0.16995194554328918, 0.16878561675548553]], [[0.16721591353416443, 0.1687130331993103, 0.16473957896232605, 0.16677714884281158, 0.16606903076171875, 0.1664852797985077], [0.16732512414455414, 0.16912491619586945, 0.16435521841049194, 0.16679824888706207, 0.1659485250711441, 0.1664479374885559], [0.16703252494335175, 0.16802506148815155, 0.1653842031955719, 0.16674105823040009, 0.16627013683319092, 0.166547030210495], [0.16718366742134094, 0.16859173774719238, 0.16485297679901123, 0.16677086055278778, 0.1661044806241989, 0.16649621725082397], [0.16713140904903412, 0.16839544475078583, 0.16503673791885376, 0.1667606085538864, 0.16616187989711761, 0.16651387512683868], [0.16716217994689941, 0.16851092875003815, 0.1649286299943924, 0.16676665842533112, 0.16612812876701355, 0.16650350391864777]], [[0.16252607107162476, 0.16621822118759155, 0.16815052926540375, 0.16594469547271729, 0.167873814702034, 0.16928663849830627], [0.1601957380771637, 0.1659499853849411, 0.1689908355474472, 0.16552115976810455, 0.1685541719198227, 0.17078809440135956], [0.15900632739067078, 0.16580858826637268, 0.1694212108850479, 0.1653001308441162, 0.16890168190002441, 0.17156215012073517], [0.1603657603263855, 0.16596995294094086, 0.16892941296100616, 0.16555249691009521, 0.1685045063495636, 0.17067788541316986], [0.15917539596557617, 0.1658288687467575, 0.1693599671125412, 0.16533173620700836, 0.16885225474834442, 0.17145177721977234], [0.15831635892391205, 0.16572514176368713, 0.16967131197452545, 0.165170356631279, 0.16910330951213837, 0.1720135658979416]], [[0.16525685787200928, 0.16784614324569702, 0.16659055650234222, 0.16648785769939423, 0.1675359457731247, 0.16628266870975494], [0.16426774859428406, 0.168679878115654, 0.16653431951999664, 0.1663593351840973, 0.16814875602722168, 0.16600994765758514], [0.16474498808383942, 0.16827696561813354, 0.16656175255775452, 0.16642166674137115, 0.16785277426242828, 0.16614188253879547], [0.16478420794010162, 0.1682438850402832, 0.1665639579296112, 0.16642676293849945, 0.16782845556735992, 0.166152685880661], [0.16438524425029755, 0.1685805767774582, 0.16654111444950104, 0.16637474298477173, 0.168075829744339, 0.1660424917936325], [0.1648627072572708, 0.1681777834892273, 0.16656844317913055, 0.16643697023391724, 0.16777987778186798, 0.16617433726787567]], [[0.1618562787771225, 0.1675954908132553, 0.16745755076408386, 0.16731970012187958, 0.16718198359012604, 0.16858898103237152], [0.15768848359584808, 0.16839806735515594, 0.16813676059246063, 0.16787587106227875, 0.1676153838634491, 0.17028546333312988], [0.15778596699237823, 0.1683793067932129, 0.16812093555927277, 0.16786295175552368, 0.16760537028312683, 0.17024542391300201], [0.15788350999355316, 0.16836054623126984, 0.1681050956249237, 0.16785003244876862, 0.16759537160396576, 0.17020539939403534], [0.15798109769821167, 0.1683417707681656, 0.16808925569057465, 0.16783711314201355, 0.1675853580236435, 0.17016537487506866], [0.1569901704788208, 0.16853231191635132, 0.16824999451637268, 0.16796813905239105, 0.16768676042556763, 0.17057262361049652]], [[0.16751790046691895, 0.16985832154750824, 0.16706177592277527, 0.1634492725133896, 0.16573286056518555, 0.1663799285888672], [0.16762611269950867, 0.17027179896831512, 0.16711105406284332, 0.16303816437721252, 0.16561143100261688, 0.16634142398834229], [0.16749659180641174, 0.16977714002132416, 0.16705204546451569, 0.1635301411151886, 0.16575667262077332, 0.16638745367527008], [0.16732534766197205, 0.16912709176540375, 0.1669735461473465, 0.16417942941188812, 0.1659473031759262, 0.1664472222328186], [0.16743411123752594, 0.1695394665002823, 0.1670234650373459, 0.16376714408397675, 0.16582639515399933, 0.16640937328338623], [0.16746461391448975, 0.16965539753437042, 0.16703741252422333, 0.1636514663696289, 0.16579237580299377, 0.16639868915081024]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 3600}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0363118728598896e-05, "remove_single_ts_time_rank_from_batch": 1.176985165508371e-05, "tensor_to_numpy": 1.5043039984730592e-05, "get_actions": 3.6226965174391515e-05, "un_batch_to_individual_items": 6.59324426286298e-06, "normalize_and_clip_actions": 7.76174006895012e-06}}, "connector_pipeline_timer": 0.00011350167847282065}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7960952382036425e-06, "add_states_from_episodes_to_batch": 2.8045577671065788e-06, "batch_individual_items": 1.243771553920487e-05, "add_time_dim_to_batch_and_zero_pad": 6.972315685421001e-06, "numpy_to_tensor": 1.1949382752562899e-05}}, "connector_pipeline_timer": 5.888260575325741e-05}, "sample": 0.11840446652518236, "num_module_steps_sampled": {"default_policy": 400}, "rlmodule_inference_timer": 3.0855660076047134e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "env_step_timer": 1.3846592705500866e-05, "agent_episode_returns_mean": {"default_agent": 0.15}, "num_episodes": 20, "episode_len_mean": 20.0, "num_episodes_lifetime": 180, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_mean": 0.15, "episode_return_min": -16.5, "episode_len_max": 20, "weights_seq_no": 9.0, "episode_duration_sec_mean": 0.005279824598692358, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 45400, "env_reset_timer": 0.0005461331818801982, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": 0.15}, "time_between_sampling": 9.816774253763805}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "b7d62_00000", "date": "2025-08-11_18-39-02", "timestamp": 1754930342, "time_this_iter_s": 10.167312860488892, "time_total_s": 87.89340853691101, "pid": 11547, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1550f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 87.89340853691101, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 46.36428571428571, "ram_util_percent": 79.55714285714286}}
{"timers": {"training_iteration": 9.405668182618806, "restore_env_runners": 1.0088044002862308e-05, "training_step": 9.40545977235785, "env_runner_sampling_timer": 1.6505703781430479, "learner_update_timer": 7.5581490493314245, "synch_weights": 0.0014194342420878433, "restore_eval_env_runners": 4.154140108573357e-05, "evaluation_iteration": 0.12860011146363073, "synch_eval_env_connectors": 0.00014677718354892387, "synch_env_connectors": 4.673170682732521e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.684387298224681e-06, "remove_single_ts_time_rank_from_batch": 1.2045600069675623e-05, "tensor_to_numpy": 1.5790407473624896e-05, "get_actions": 4.0757296183230966e-05, "normalize_and_clip_actions": 8.506981072492703e-06, "listify_data_for_vector_env": 1.0904226108894514e-05}}, "connector_pipeline_timer": 0.00012196230364970145}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.247774678316628e-06, "numpy_to_tensor": 1.278577492847285e-05, "add_observations_from_episodes_to_batch": 2.9421491147340703e-06, "add_states_from_episodes_to_batch": 2.7766977849289894e-06, "batch_individual_items": 1.3088000458787006e-05}}, "connector_pipeline_timer": 6.155732114268418e-05}, "episode_duration_sec_mean": 0.005468053160700949, "episode_len_mean": 20.0, "sample": 0.005769666090550707, "num_episodes_lifetime": -246500.0, "episode_return_max": 12.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_episode_returns_mean": {"default_policy": 3.2200000000000006}, "episode_len_min": 20, "time_between_sampling": 0.03553439129565797, "agent_episode_returns_mean": {"default_agent": 3.2200000000000006}, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "rlmodule_inference_timer": 3.2574551373943644e-05, "episode_return_mean": 3.2200000000000006, "num_env_steps_sampled_lifetime": -4930000.0, "env_reset_timer": 4.1961269686784366e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -7.5, "env_step_timer": 1.4615531225092498e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "weights_seq_no": 9.0, "num_env_steps_sampled_lifetime_throughput": 3210.1164340375326}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15738750674061894, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009303046551637306, "add_observations_from_episodes_to_batch": 0.0008838123219398922, "add_columns_from_episodes_to_train_batch": 0.04264303131635134, "add_time_dim_to_batch_and_zero_pad": 0.09134840528447218, "add_states_from_episodes_to_batch": 0.0036156963329987786, "batch_individual_items": 0.009356868759193976, "numpy_to_tensor": 7.832469077722571e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_kl_coeff": 0.00015779680688865483, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 10.0, "entropy": 0.6825544238090515, "vf_explained_var": -1.728534698486328e-05, "module_train_batch_size_mean": 998.3173215714437, "num_module_steps_trained_lifetime": 59850, "vf_loss": 0.32050803303718567, "use_intrinsic_rewards": 0.0, "policy_loss": -0.00042958601261489093, "vf_loss_unclipped": 42.332427978515625, "num_module_steps_trained": 5985, "total_loss": 0.24820925295352936, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 2.142477205779869e-05, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 768.136861748549}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_explained_var": 0.0028756260871887207, "module_train_batch_size_mean": 997.532914147147, "num_module_steps_trained_lifetime": 359100, "vf_loss": 0.32053694128990173, "use_intrinsic_rewards": 1.0, "policy_loss": -0.0004071693983860314, "vf_loss_unclipped": 42.24757766723633, "num_module_steps_trained": 35910, "total_loss": 0.24825720489025116, "mean_kl_loss": 1.9169567167409696e-05, "diff_num_grad_updates_vs_sampler_policy": 51.0, "entropy": 0.6826057434082031, "weights_seq_no": 60.0}, "intrinsic_reward_module": {"weights_seq_no": 60.0, "module_train_batch_size_mean": 997.532914147147, "num_module_steps_trained": 35910, "total_loss": 0.0, "num_module_steps_trained_lifetime": 359100, "diff_num_grad_updates_vs_sampler_policy": 51.0}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 718200, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 2160000, "num_env_steps_trained_lifetime_throughput": 56666.14588258382}}}, "intrinsic_reward_module": {"total_loss": 0.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 59850, "num_trainable_parameters": 8266, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "weights_seq_no": 10.0, "module_train_batch_size_mean": 998.3173215714437, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 768.1455100494618}, "__all_modules__": {"num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 360000, "num_module_steps_trained_lifetime": 119700, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 4624.93385508772, "num_module_steps_trained_throughput": 23314384.297045026, "num_module_steps_trained_lifetime_throughput": 12746407.71186741}, "IntrinsicAttentionMask": [[[0.16219021379947662, 0.16794127225875854, 0.16780303418636322, 0.16560176014900208, 0.16752690076828003, 0.1689368039369583], [0.15830180048942566, 0.16905301809310913, 0.16879069805145264, 0.1646394282579422, 0.16826729476451874, 0.17094776034355164], [0.15839286148548126, 0.1690269410610199, 0.16876757144927979, 0.16466239094734192, 0.16825003921985626, 0.17090024054050446], [0.15985862910747528, 0.16860738396644592, 0.16839520633220673, 0.16502897441387177, 0.1679716408252716, 0.1701381504535675], [0.1585751175880432, 0.16897474229335785, 0.1687212735414505, 0.1647082418203354, 0.16821548342704773, 0.1708052009344101], [0.15764935314655304, 0.16923996806144714, 0.168956458568573, 0.1644744724035263, 0.16839087009429932, 0.1712888479232788]], [[0.16758058965206146, 0.1690809726715088, 0.16728730499744415, 0.16495433449745178, 0.16643120348453522, 0.16466563940048218], [0.16776256263256073, 0.1695670634508133, 0.167410209774971, 0.16461177170276642, 0.16638237237930298, 0.16426603496074677], [0.16754479706287384, 0.1689855456352234, 0.16726310551166534, 0.16502165794372559, 0.16644072532653809, 0.16474422812461853], [0.1672571897506714, 0.16822156310081482, 0.16706833243370056, 0.1655617505311966, 0.16651634871959686, 0.16537481546401978], [0.16743981838226318, 0.16870619356632233, 0.16719208657741547, 0.16521891951560974, 0.16646850109100342, 0.16497446596622467], [0.16722126305103302, 0.1681264191865921, 0.16704395413398743, 0.16562914848327637, 0.1665256917476654, 0.16545352339744568]], [[0.16678059101104736, 0.16660012304782867, 0.1664198487997055, 0.16623978316783905, 0.16605989634990692, 0.16789975762367249], [0.1667787879705429, 0.16660119593143463, 0.16642379760742188, 0.16624657809734344, 0.16606955230236053, 0.1678800731897354], [0.16677699983119965, 0.16660228371620178, 0.16642774641513824, 0.16625338792800903, 0.16607920825481415, 0.16786038875579834], [0.1667751967906952, 0.16660335659980774, 0.16643169522285461, 0.16626018285751343, 0.16608887910842896, 0.16784070432186127], [0.16677340865135193, 0.1666044294834137, 0.1664356291294098, 0.16626699268817902, 0.16609853506088257, 0.1678210198879242], [0.16679169237613678, 0.16659346222877502, 0.16639548540115356, 0.16619773209095, 0.16600021719932556, 0.16802141070365906]], [[0.16576606035232544, 0.16836333274841309, 0.1655617654323578, 0.16700085997581482, 0.16805218160152435, 0.16525578498840332], [0.1651288866996765, 0.1695641428232193, 0.1647820621728897, 0.16723144054412842, 0.16903023421764374, 0.16426321864128113], [0.1658165156841278, 0.16826824843883514, 0.16562357544898987, 0.16698238253593445, 0.16797463595867157, 0.1653345823287964], [0.16546213626861572, 0.16893604397773743, 0.16518965363502502, 0.16711144149303436, 0.16851891577243805, 0.16478176414966583], [0.16520480811595917, 0.16942106187343597, 0.1648748815059662, 0.16720423102378845, 0.1689138114452362, 0.1643812358379364], [0.16589218378067017, 0.1681256741285324, 0.165716290473938, 0.1669546365737915, 0.16785834729671478, 0.16545279324054718]], [[0.16252607107162476, 0.16621822118759155, 0.16815052926540375, 0.16594469547271729, 0.167873814702034, 0.16928663849830627], [0.1601957231760025, 0.1659499853849411, 0.1689908355474472, 0.16552115976810455, 0.1685541570186615, 0.17078807950019836], [0.15900631248950958, 0.16580858826637268, 0.1694212108850479, 0.16530011594295502, 0.16890166699886322, 0.17156213521957397], [0.1603657603263855, 0.16596996784210205, 0.16892941296100616, 0.16555249691009521, 0.1685045063495636, 0.17067788541316986], [0.15917539596557617, 0.1658288687467575, 0.1693599671125412, 0.16533173620700836, 0.16885225474834442, 0.17145177721977234], [0.15831635892391205, 0.16572512686252594, 0.16967129707336426, 0.1651703417301178, 0.16910330951213837, 0.1720135509967804]], [[0.1686708927154541, 0.16755743324756622, 0.164798766374588, 0.1645742654800415, 0.16687355935573578, 0.16752508282661438], [0.16854746639728546, 0.16750295460224152, 0.16491329669952393, 0.1647024154663086, 0.16686122119426727, 0.16747261583805084], [0.16823828220367432, 0.16736628115177155, 0.16520048677921295, 0.16502389311790466, 0.16683010756969452, 0.167340949177742], [0.1682129055261612, 0.16735506057739258, 0.165224090218544, 0.16505029797554016, 0.16682752966880798, 0.16733011603355408], [0.16847127676010132, 0.1674693077802658, 0.16498403251171112, 0.1647815853357315, 0.16685359179973602, 0.16744019091129303], [0.16854387521743774, 0.16750137507915497, 0.16491663455963135, 0.16470617055892944, 0.16686086356639862, 0.16747108101844788]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 4000}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0360707642753667e-05, "remove_single_ts_time_rank_from_batch": 1.1844262321426212e-05, "tensor_to_numpy": 1.4796829936791897e-05, "get_actions": 3.5364383079367865e-05, "un_batch_to_individual_items": 6.560511021407958e-06, "normalize_and_clip_actions": 7.824637345826367e-06}}, "connector_pipeline_timer": 0.00011255033114492634}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8054666937890894e-06, "add_states_from_episodes_to_batch": 2.738981283230706e-06, "batch_individual_items": 1.248091185736957e-05, "add_time_dim_to_batch_and_zero_pad": 7.1671821903416335e-06, "numpy_to_tensor": 1.1677229330321677e-05}}, "connector_pipeline_timer": 5.894727828471809e-05}, "sample": 0.11834166685974346, "num_module_steps_sampled": {"default_policy": 400}, "rlmodule_inference_timer": 3.025324958604574e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "env_step_timer": 1.3742844961961803e-05, "agent_episode_returns_mean": {"default_agent": -0.45}, "num_episodes": 20, "episode_len_mean": 20.0, "num_episodes_lifetime": 200, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_mean": -0.45, "episode_return_min": -16.5, "episode_len_max": 20, "weights_seq_no": 10.0, "episode_duration_sec_mean": 0.005270661689573899, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 50400, "env_reset_timer": 0.0005414868504464422, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": -0.45}, "time_between_sampling": 9.814583186226441}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "b7d62_00000", "date": "2025-08-11_18-39-12", "timestamp": 1754930352, "time_this_iter_s": 9.69140100479126, "time_total_s": 97.58480954170227, "pid": 11547, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1550f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 97.58480954170227, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 39.035714285714285, "ram_util_percent": 78.55000000000003}}
{"timers": {"training_iteration": 9.40943286662264, "restore_env_runners": 1.005258315293433e-05, "training_step": 9.4092239958838, "env_runner_sampling_timer": 1.6503074039418801, "learner_update_timer": 7.562061595508186, "synch_weights": 0.0014203290692772566, "restore_eval_env_runners": 4.120556742472391e-05, "evaluation_iteration": 0.12848975992954015, "synch_eval_env_connectors": 0.00014624899162682728, "synch_env_connectors": 4.666858375643507e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.597591432638704e-06, "remove_single_ts_time_rank_from_batch": 1.1858334450221167e-05, "tensor_to_numpy": 1.5266336438108037e-05, "get_actions": 3.872273685696855e-05, "normalize_and_clip_actions": 8.053666629189257e-06, "listify_data_for_vector_env": 1.0603108705722107e-05}}, "connector_pipeline_timer": 0.00011746919481904428}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.061910082074634e-06, "numpy_to_tensor": 2.73714251427497e-05, "add_observations_from_episodes_to_batch": 2.8846823748215676e-06, "add_states_from_episodes_to_batch": 2.773716223866728e-06, "batch_individual_items": 1.2588972576409755e-05}}, "connector_pipeline_timer": 7.5049932485228e-05}, "episode_duration_sec_mean": 0.005616013818886129, "episode_len_mean": 20.0, "sample": 0.006000288797991662, "num_episodes_lifetime": -277375.0, "episode_return_max": 12.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_episode_returns_mean": {"default_policy": 4.420000000000002}, "episode_len_min": 20, "time_between_sampling": 0.03270870925467743, "agent_episode_returns_mean": {"default_agent": 4.420000000000002}, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "rlmodule_inference_timer": 3.1454358817949224e-05, "episode_return_mean": 4.420000000000002, "num_env_steps_sampled_lifetime": -5547500.0, "env_reset_timer": 4.277226410290516e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -7.5, "env_step_timer": 1.402546934973967e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "weights_seq_no": 10.0, "num_env_steps_sampled_lifetime_throughput": 3233.477568106622}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15739124126323464, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00929701150523576, "add_observations_from_episodes_to_batch": 0.0008834300395912313, "add_columns_from_episodes_to_train_batch": 0.04263781975302205, "add_time_dim_to_batch_and_zero_pad": 0.09137797915171272, "add_states_from_episodes_to_batch": 0.003620216029806042, "batch_individual_items": 0.009338638401954714, "numpy_to_tensor": 7.825228397360123e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_kl_coeff": 7.889840344432741e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 11.0, "entropy": 0.6810581088066101, "vf_explained_var": 0.00016897916793823242, "module_train_batch_size_mean": 998.2690509307901, "num_module_steps_trained_lifetime": 65835, "vf_loss": 0.32050836086273193, "use_intrinsic_rewards": 0.0, "policy_loss": -0.0004261448048055172, "vf_loss_unclipped": 42.36069107055664, "num_module_steps_trained": 5985, "total_loss": 0.24821525812149048, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 3.455149271758273e-05, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 764.6926421616176}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_explained_var": 0.0029952526092529297, "module_train_batch_size_mean": 997.5206335045569, "num_module_steps_trained_lifetime": 395010, "vf_loss": 0.32053473591804504, "use_intrinsic_rewards": 1.0, "policy_loss": -0.00041283233440481126, "vf_loss_unclipped": 42.33015060424805, "num_module_steps_trained": 35910, "total_loss": 0.24825425446033478, "mean_kl_loss": 3.222698433091864e-05, "diff_num_grad_updates_vs_sampler_policy": 56.0, "entropy": 0.6811017990112305, "weights_seq_no": 66.0}, "intrinsic_reward_module": {"weights_seq_no": 66.0, "module_train_batch_size_mean": 997.5206335045569, "num_module_steps_trained": 35910, "total_loss": 0.0, "num_module_steps_trained_lifetime": 395010, "diff_num_grad_updates_vs_sampler_policy": 56.0}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 790020, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 2376000, "num_env_steps_trained_lifetime_throughput": 55656.84868830973}}}, "intrinsic_reward_module": {"total_loss": 0.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 65835, "num_trainable_parameters": 8266, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "weights_seq_no": 11.0, "module_train_batch_size_mean": 998.2690509307901, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 764.7007285816826}, "__all_modules__": {"num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 396000, "num_module_steps_trained_lifetime": 131670, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 4604.036201459848, "num_module_steps_trained_throughput": 22741324.608742345, "num_module_steps_trained_lifetime_throughput": 12715719.503095768}, "IntrinsicAttentionMask": [[[0.16813908517360687, 0.16795714199543, 0.16506637632846832, 0.16759386658668518, 0.16470934450626373, 0.16653424501419067], [0.16811563074588776, 0.16793660819530487, 0.16509182751178741, 0.16757914423942566, 0.1647404134273529, 0.16653643548488617], [0.16773952543735504, 0.16760723292827606, 0.1655000001192093, 0.16734296083450317, 0.16523905098438263, 0.166571244597435], [0.16806870698928833, 0.16789552569389343, 0.1651427000761032, 0.16754969954490662, 0.16480255126953125, 0.16654081642627716], [0.1676926165819168, 0.16756613552570343, 0.16555091738700867, 0.16731347143650055, 0.16530129313468933, 0.16657552123069763], [0.16793130338191986, 0.1677751988172531, 0.16529181599617004, 0.16746345162391663, 0.16498467326164246, 0.1665535867214203]], [[0.16576798260211945, 0.16836528480052948, 0.1655636876821518, 0.16700279712677002, 0.16650325059890747, 0.1667969673871994], [0.165134459733963, 0.16956986486911774, 0.16478762030601501, 0.1672370880842209, 0.16638511419296265, 0.1668858379125595], [0.1658182442188263, 0.16826999187469482, 0.16562528908252716, 0.16698411107063293, 0.16651251912117004, 0.16678981482982635], [0.1654655784368515, 0.16893956065177917, 0.1651930958032608, 0.16711492836475372, 0.16644716262817383, 0.16683970391750336], [0.1655876487493515, 0.16870757937431335, 0.16534265875816345, 0.1670697182416916, 0.16646987199783325, 0.16682252287864685], [0.16551582515239716, 0.16884402930736542, 0.1652546375989914, 0.1670963168144226, 0.16645652055740356, 0.16683264076709747]], [[0.16723397374153137, 0.1670530140399933, 0.16687226295471191, 0.16669169068336487, 0.16651131212711334, 0.1656377762556076], [0.1672249436378479, 0.16704687476158142, 0.16686899960041046, 0.16669130325317383, 0.16651380062103271, 0.16565410792827606], [0.16721591353416443, 0.16704073548316956, 0.166865736246109, 0.1666909158229828, 0.1665162891149521, 0.1656704694032669], [0.16720686852931976, 0.1670345813035965, 0.16686245799064636, 0.16669052839279175, 0.16651876270771027, 0.16568680107593536], [0.1671978235244751, 0.16702842712402344, 0.16685917973518372, 0.16669012606143951, 0.16652123630046844, 0.16570314764976501], [0.16715392470359802, 0.16699855029582977, 0.16684332489967346, 0.1666882336139679, 0.16653330624103546, 0.16578258574008942]], [[0.16459853947162628, 0.1692448854446411, 0.1669846475124359, 0.1640542447566986, 0.16868524253368378, 0.1664324700832367], [0.16378554701805115, 0.17026455700397491, 0.16710394620895386, 0.16303123533725739, 0.16948041319847107, 0.1663343608379364], [0.16417811810970306, 0.16977174580097198, 0.16704675555229187, 0.16352494060993195, 0.16909632086753845, 0.16638216376304626], [0.16469530761241913, 0.16912372410297394, 0.16697022318840027, 0.16417616605758667, 0.16859062016010284, 0.16644391417503357], [0.16388224065303802, 0.17014308273792267, 0.16708992421627045, 0.1631527990102768, 0.16938577592372894, 0.1663462072610855], [0.16427484154701233, 0.16965042054653168, 0.16703252494335175, 0.1636466681957245, 0.16900169849395752, 0.16639380156993866]], [[0.16723397374153137, 0.1670530140399933, 0.16687226295471191, 0.16669169068336487, 0.16651131212711334, 0.1656377762556076], [0.1672249436378479, 0.16704687476158142, 0.16686899960041046, 0.16669130325317383, 0.16651380062103271, 0.16565410792827606], [0.16721591353416443, 0.16704073548316956, 0.166865736246109, 0.1666909158229828, 0.1665162891149521, 0.1656704694032669], [0.16720686852931976, 0.1670345813035965, 0.16686245799064636, 0.16669052839279175, 0.16651876270771027, 0.16568680107593536], [0.1671978235244751, 0.16702842712402344, 0.16685917973518372, 0.16669012606143951, 0.16652123630046844, 0.16570314764976501], [0.16715392470359802, 0.16699855029582977, 0.16684332489967346, 0.1666882336139679, 0.16653330624103546, 0.16578258574008942]], [[0.16758251190185547, 0.16687096655368805, 0.16510075330734253, 0.1649562120437622, 0.16863924264907837, 0.1668502688407898], [0.16749516129493713, 0.16685186326503754, 0.1652502864599228, 0.1651194542646408, 0.16845005750656128, 0.16683314740657806], [0.16727600991725922, 0.16680358350276947, 0.16562530398368835, 0.16552892327308655, 0.16797639429569244, 0.16678982973098755], [0.16725799441337585, 0.16679957509040833, 0.16565610468387604, 0.16556255519390106, 0.1679375171661377, 0.16678623855113983], [0.16771146655082703, 0.16689902544021606, 0.1648799180984497, 0.16471518576145172, 0.16891895234584808, 0.16687539219856262], [0.16749261319637299, 0.16685129702091217, 0.1652546525001526, 0.16512420773506165, 0.16844454407691956, 0.16683265566825867]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 4400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0328083779451475e-05, "remove_single_ts_time_rank_from_batch": 1.1874724983853895e-05, "tensor_to_numpy": 1.4968308142572647e-05, "get_actions": 3.568808980825652e-05, "un_batch_to_individual_items": 6.51890563956517e-06, "normalize_and_clip_actions": 7.76093517270313e-06}}, "connector_pipeline_timer": 0.00011289134721532019}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.823929329483604e-06, "add_states_from_episodes_to_batch": 2.773419793118945e-06, "batch_individual_items": 1.245002204942168e-05, "add_time_dim_to_batch_and_zero_pad": 7.07006924727596e-06, "numpy_to_tensor": 1.17964365942997e-05}}, "connector_pipeline_timer": 5.8824317471686666e-05}, "sample": 0.11830591310108032, "num_module_steps_sampled": {"default_policy": 400}, "rlmodule_inference_timer": 3.024153597496194e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "env_step_timer": 1.3845786281680331e-05, "agent_episode_returns_mean": {"default_agent": -0.85}, "num_episodes": 20, "episode_len_mean": 20.0, "num_episodes_lifetime": 220, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_mean": -0.85, "episode_return_min": -16.5, "episode_len_max": 20, "weights_seq_no": 11.0, "episode_duration_sec_mean": 0.0052356508385855705, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 55400, "env_reset_timer": 0.0005396407320496387, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": -0.85}, "time_between_sampling": 9.814513731034681}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "b7d62_00000", "date": "2025-08-11_18-39-22", "timestamp": 1754930362, "time_this_iter_s": 9.909830093383789, "time_total_s": 107.49463963508606, "pid": 11547, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1550f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 107.49463963508606, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 42.121428571428574, "ram_util_percent": 79.01428571428572}}
{"timers": {"training_iteration": 9.41396417795593, "restore_env_runners": 1.0124967834761315e-05, "training_step": 9.413755223015034, "env_runner_sampling_timer": 1.6508186649028833, "learner_update_timer": 7.565971972462671, "synch_weights": 0.0014165507788031586, "restore_eval_env_runners": 4.1216012057217075e-05, "evaluation_iteration": 0.12844877108013805, "synch_eval_env_connectors": 0.00014639442198656008, "synch_env_connectors": 4.663109792738226e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.708016593617684e-06, "remove_single_ts_time_rank_from_batch": 1.2035224090312076e-05, "tensor_to_numpy": 1.5523731579466386e-05, "get_actions": 3.9966954495276515e-05, "normalize_and_clip_actions": 8.185875517719687e-06, "listify_data_for_vector_env": 1.0819261026978643e-05}}, "connector_pipeline_timer": 0.00011994373819271312}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.199331135973963e-06, "numpy_to_tensor": 1.2683770482194712e-05, "add_observations_from_episodes_to_batch": 2.9347544736188916e-06, "add_states_from_episodes_to_batch": 2.7766016700540616e-06, "batch_individual_items": 1.286883661021246e-05}}, "connector_pipeline_timer": 6.106214498202997e-05}, "episode_duration_sec_mean": 0.00589420116180554, "episode_len_mean": 20.0, "sample": 0.006222262093141136, "num_episodes_lifetime": -308250.0, "episode_return_max": 12.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_episode_returns_mean": {"default_policy": 4.019999999999998}, "episode_len_min": 20, "time_between_sampling": 0.03364630590222903, "agent_episode_returns_mean": {"default_agent": 4.019999999999998}, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "rlmodule_inference_timer": 5.7624460768164145e-05, "episode_return_mean": 4.019999999999998, "num_env_steps_sampled_lifetime": -6165000.0, "env_reset_timer": 4.6342769004923316e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -7.5, "env_step_timer": 1.4424403989902052e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "weights_seq_no": 11.0, "num_env_steps_sampled_lifetime_throughput": 3162.234857208416}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15740345843099385, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009293629730089589, "add_observations_from_episodes_to_batch": 0.0008833003188634384, "add_columns_from_episodes_to_train_batch": 0.04264367572563998, "add_time_dim_to_batch_and_zero_pad": 0.09139794978100438, "add_states_from_episodes_to_batch": 0.0036232813699048, "batch_individual_items": 0.009325584108082006, "numpy_to_tensor": 7.820684008739958e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_kl_coeff": 3.944920172216371e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 12.0, "entropy": 0.6803168058395386, "vf_explained_var": 0.0001423358917236328, "module_train_batch_size_mean": 998.2236050808158, "num_module_steps_trained_lifetime": 71820, "vf_loss": 0.3205080032348633, "use_intrinsic_rewards": 0.0, "policy_loss": -0.00029529700987040997, "vf_loss_unclipped": 42.247920989990234, "num_module_steps_trained": 5985, "total_loss": 0.2483469694852829, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 2.019653948082123e-05, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 761.227528471554}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_explained_var": 0.002942979335784912, "module_train_batch_size_mean": 997.512081102731, "num_module_steps_trained_lifetime": 430920, "vf_loss": 0.3205365240573883, "use_intrinsic_rewards": 1.0, "policy_loss": -0.00028274583746679127, "vf_loss_unclipped": 42.17442321777344, "num_module_steps_trained": 35910, "total_loss": 0.24838469922542572, "mean_kl_loss": 1.8572309272713028e-05, "diff_num_grad_updates_vs_sampler_policy": 61.0, "entropy": 0.6803580522537231, "weights_seq_no": 72.0}, "intrinsic_reward_module": {"weights_seq_no": 72.0, "module_train_batch_size_mean": 997.512081102731, "num_module_steps_trained": 35910, "total_loss": 0.0, "num_module_steps_trained_lifetime": 430920, "diff_num_grad_updates_vs_sampler_policy": 61.0}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 861840, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 2592000, "num_env_steps_trained_lifetime_throughput": 54682.066087717976}}}, "intrinsic_reward_module": {"total_loss": 0.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 71820, "num_trainable_parameters": 8266, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "weights_seq_no": 12.0, "module_train_batch_size_mean": 998.2236050808158, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 761.2350884471803}, "__all_modules__": {"num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 432000, "num_module_steps_trained_lifetime": 143640, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 4583.017020933463, "num_module_steps_trained_throughput": 22200449.63762028, "num_module_steps_trained_lifetime_throughput": 12697415.396335373}, "IntrinsicAttentionMask": [[[0.16813603043556213, 0.16524216532707214, 0.16506336629390717, 0.1648847609758377, 0.16740946471691132, 0.1692642867565155], [0.16776128113269806, 0.1656063348054886, 0.1654728651046753, 0.16533951461315155, 0.16722114384174347, 0.16859889030456543], [0.1677379012107849, 0.16562902927398682, 0.16549839079380035, 0.16536787152290344, 0.16720935702323914, 0.16855743527412415], [0.16771453619003296, 0.16565173864364624, 0.1655239462852478, 0.16539624333381653, 0.167197585105896, 0.16851601004600525], [0.16804257035255432, 0.16533301770687103, 0.1651654988527298, 0.1649981588125229, 0.16736257076263428, 0.1690981537103653], [0.16828028857707977, 0.1651017814874649, 0.1649055778980255, 0.16470959782600403, 0.16748175024986267, 0.16952098906040192]], [[0.16694490611553192, 0.16927732527256012, 0.1664903610944748, 0.16289019584655762, 0.16858643293380737, 0.16581083834171295], [0.1669788658618927, 0.16961432993412018, 0.16646578907966614, 0.16240863502025604, 0.1688331812620163, 0.16569913923740387], [0.1669381856918335, 0.16921111941337585, 0.16649512946605682, 0.1629849374294281, 0.1685379296541214, 0.1658327281475067], [0.1668836772441864, 0.16868066787719727, 0.16653281450271606, 0.16374607384204865, 0.1681489646434784, 0.1660078763961792], [0.16696889698505402, 0.1695149689912796, 0.16647307574748993, 0.16255047917366028, 0.16876044869422913, 0.16573210060596466], [0.16692805290222168, 0.16911181807518005, 0.1665022373199463, 0.1631271243095398, 0.16846515238285065, 0.16586554050445557]], [[0.16813956201076508, 0.1652456521987915, 0.16777588427066803, 0.16759434342384338, 0.16470980644226074, 0.16653472185134888], [0.16776324808597565, 0.1656082719564438, 0.16749295592308044, 0.16735796630382538, 0.16520820558071136, 0.16656936705112457], [0.16809262335300446, 0.16529087722301483, 0.1677406132221222, 0.16756488382816315, 0.1647719293832779, 0.16653907299041748], [0.16806913912296295, 0.1653134673833847, 0.16772295534610748, 0.16755013167858124, 0.16480296850204468, 0.1665412336587906], [0.1676928550004959, 0.16567611694335938, 0.1674399971961975, 0.16731370985507965, 0.16530153155326843, 0.16657575964927673], [0.1679316610097885, 0.1654459536075592, 0.16761961579322815, 0.16746380925178528, 0.16498501598834991, 0.16655394434928894]], [[0.16505591571331024, 0.16971518099308014, 0.16744866967201233, 0.16726389527320862, 0.16636908054351807, 0.1641472578048706], [0.16442090272903442, 0.1709250509738922, 0.1677521914243698, 0.1674942672252655, 0.16624680161476135, 0.1631607860326767], [0.16472765803337097, 0.17034001648426056, 0.1676059067249298, 0.1673833280801773, 0.16630621254444122, 0.16363684833049774], [0.16475285589694977, 0.17029203474521637, 0.167593851685524, 0.16737419366836548, 0.16631107032299042, 0.16367597877979279], [0.16487519443035126, 0.17005902528762817, 0.16753531992435455, 0.16732974350452423, 0.16633456945419312, 0.16386613249778748], [0.16518180072307587, 0.16947591304779053, 0.1673881858587265, 0.1672178953886032, 0.1663929969072342, 0.1643432378768921]], [[0.16813956201076508, 0.1652456521987915, 0.16777588427066803, 0.16759434342384338, 0.16470980644226074, 0.16653472185134888], [0.16776324808597565, 0.1656082719564438, 0.16749295592308044, 0.16735796630382538, 0.16520820558071136, 0.16656936705112457], [0.16809262335300446, 0.16529087722301483, 0.1677406132221222, 0.16756488382816315, 0.1647719293832779, 0.16653907299041748], [0.16806913912296295, 0.1653134673833847, 0.16772295534610748, 0.16755013167858124, 0.16480296850204468, 0.1665412336587906], [0.1676928550004959, 0.16567611694335938, 0.1674399971961975, 0.16731370985507965, 0.16530153155326843, 0.16657575964927673], [0.1679316610097885, 0.1654459536075592, 0.16761961579322815, 0.16746380925178528, 0.16498501598834991, 0.16655394434928894]], [[0.16758188605308533, 0.1668703407049179, 0.16510014235973358, 0.16714215278625488, 0.16863861680030823, 0.16466692090034485], [0.16749463975429535, 0.16685134172439575, 0.1652497798204422, 0.16709712147712708, 0.1684495359659195, 0.16485758125782013], [0.16727571189403534, 0.1668032854795456, 0.16562500596046448, 0.16698384284973145, 0.16797609627246857, 0.165336012840271], [0.16752801835536957, 0.16685862839221954, 0.16519254446029663, 0.16711436212062836, 0.16852185130119324, 0.16478464007377625], [0.16771063208580017, 0.1668981909751892, 0.16487909853458405, 0.1672084927558899, 0.16891811788082123, 0.16438543796539307], [0.16722173988819122, 0.16679136455059052, 0.16571751236915588, 0.1669558584690094, 0.16785958409309387, 0.16545401513576508]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 4800}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0234776971787373e-05, "remove_single_ts_time_rank_from_batch": 1.1773297296551662e-05, "tensor_to_numpy": 1.4902780655206701e-05, "get_actions": 3.557432524019083e-05, "un_batch_to_individual_items": 6.459022807977756e-06, "normalize_and_clip_actions": 7.817238213125e-06}}, "connector_pipeline_timer": 0.00011256260565544757}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8311469607985432e-06, "add_states_from_episodes_to_batch": 2.7345034018249645e-06, "batch_individual_items": 1.2325860920412952e-05, "add_time_dim_to_batch_and_zero_pad": 7.0919581918917865e-06, "numpy_to_tensor": 1.1846751008122022e-05}}, "connector_pipeline_timer": 5.861703225504596e-05}, "sample": 0.11825751938988277, "num_module_steps_sampled": {"default_policy": 400}, "rlmodule_inference_timer": 3.052936207284597e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "env_step_timer": 1.4102207139277026e-05, "agent_episode_returns_mean": {"default_agent": -0.05}, "num_episodes": 20, "episode_len_mean": 20.0, "num_episodes_lifetime": 240, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_mean": -0.05, "episode_return_min": -16.5, "episode_len_max": 20, "weights_seq_no": 12.0, "episode_duration_sec_mean": 0.005222185438033194, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 60400, "env_reset_timer": 0.0005360697437509127, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": -0.05}, "time_between_sampling": 9.815272353303742}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "b7d62_00000", "date": "2025-08-11_18-39-32", "timestamp": 1754930372, "time_this_iter_s": 9.985389232635498, "time_total_s": 117.48002886772156, "pid": 11547, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1550f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 117.48002886772156, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 42.84285714285714, "ram_util_percent": 78.39285714285714}}
{"timers": {"training_iteration": 9.41581097408684, "restore_env_runners": 1.0089547528447179e-05, "training_step": 9.415601634534488, "env_runner_sampling_timer": 1.6508975711640492, "learner_update_timer": 7.567668128987538, "synch_weights": 0.0014128565207128568, "restore_eval_env_runners": 4.093301240790545e-05, "evaluation_iteration": 0.12836279502966852, "synch_eval_env_connectors": 0.00014619714748151787, "synch_env_connectors": 4.659388218283033e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.614135381095931e-06, "remove_single_ts_time_rank_from_batch": 1.191392126282649e-05, "tensor_to_numpy": 1.5431994196933857e-05, "get_actions": 3.9533304572146525e-05, "normalize_and_clip_actions": 8.084009325818508e-06, "listify_data_for_vector_env": 1.0785448392276938e-05}}, "connector_pipeline_timer": 0.00011884435594905731}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.194754138851251e-06, "numpy_to_tensor": 1.2569992722293293e-05, "add_observations_from_episodes_to_batch": 2.905178856457519e-06, "add_states_from_episodes_to_batch": 2.7857290988751737e-06, "batch_individual_items": 1.2705034518332707e-05}}, "connector_pipeline_timer": 6.066803556377671e-05}, "episode_duration_sec_mean": 0.005332792013883591, "episode_len_mean": 20.0, "sample": 0.005786592054486439, "num_episodes_lifetime": -339125.0, "episode_return_max": 12.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_episode_returns_mean": {"default_policy": 4.5}, "episode_len_min": 20, "time_between_sampling": 0.03403936891417565, "agent_episode_returns_mean": {"default_agent": 4.5}, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "rlmodule_inference_timer": 3.2053040967195124e-05, "episode_return_mean": 4.5, "num_env_steps_sampled_lifetime": -6782500.0, "env_reset_timer": 4.490911760211799e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -7.5, "env_step_timer": 1.4281781325316477e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "weights_seq_no": 12.0, "num_env_steps_sampled_lifetime_throughput": 3193.9436491699535}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1573821313460427, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009288784683297717, "add_observations_from_episodes_to_batch": 0.0008828973158365561, "add_columns_from_episodes_to_train_batch": 0.04264923021817213, "add_time_dim_to_batch_and_zero_pad": 0.09139213112382115, "add_states_from_episodes_to_batch": 0.0036257843959768585, "batch_individual_items": 0.009307516177116533, "numpy_to_tensor": 7.826102136026465e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_kl_coeff": 1.9724600861081854e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 13.0, "entropy": 0.679234504699707, "vf_explained_var": 4.6133995056152344e-05, "module_train_batch_size_mean": 998.1808187151925, "num_module_steps_trained_lifetime": 77805, "vf_loss": 0.3205079138278961, "use_intrinsic_rewards": 0.0, "policy_loss": -0.0001337498106295243, "vf_loss_unclipped": 42.27463912963867, "num_module_steps_trained": 5985, "total_loss": 0.24851013720035553, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 2.0016035705339164e-05, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 758.0690375558355}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_explained_var": 0.0029637813568115234, "module_train_batch_size_mean": 997.5061250970534, "num_module_steps_trained_lifetime": 466830, "vf_loss": 0.3205360472202301, "use_intrinsic_rewards": 1.0, "policy_loss": -0.00013161523384042084, "vf_loss_unclipped": 42.208309173583984, "num_module_steps_trained": 35910, "total_loss": 0.24853725731372833, "mean_kl_loss": 1.935480031534098e-05, "diff_num_grad_updates_vs_sampler_policy": 66.0, "entropy": 0.6792522668838501, "weights_seq_no": 78.0}, "intrinsic_reward_module": {"weights_seq_no": 78.0, "module_train_batch_size_mean": 997.5061250970534, "num_module_steps_trained": 35910, "total_loss": 0.0, "num_module_steps_trained_lifetime": 466830, "diff_num_grad_updates_vs_sampler_policy": 66.0}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 933660, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 2808000, "num_env_steps_trained_lifetime_throughput": 53738.11892728231}}}, "intrinsic_reward_module": {"total_loss": 0.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 77805, "num_trainable_parameters": 8266, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "weights_seq_no": 13.0, "module_train_batch_size_mean": 998.1808187151925, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 758.0761073828274}, "__all_modules__": {"num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 468000, "num_module_steps_trained_lifetime": 155610, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 4563.850158982743, "num_module_steps_trained_throughput": 21684828.989799276, "num_module_steps_trained_lifetime_throughput": 12676724.635597773}, "IntrinsicAttentionMask": [[[0.1685968041419983, 0.16569502651691437, 0.1655157208442688, 0.16533662378787994, 0.1678682565689087, 0.1669875979423523], [0.16810277104377747, 0.1659434288740158, 0.16580970585346222, 0.1656760722398758, 0.16756153106689453, 0.1669064611196518], [0.16807200014591217, 0.1659589260816574, 0.16582803428173065, 0.16569724678993225, 0.16754239797592163, 0.1669013947248459], [0.16804121434688568, 0.16597440838813782, 0.16584636270999908, 0.1657184213399887, 0.16752326488494873, 0.16689631342887878], [0.1684734970331192, 0.16575701534748077, 0.16558906435966492, 0.1654212921857834, 0.16779175400733948, 0.16696742177009583], [0.16832378506660461, 0.1658322662115097, 0.16567812860012054, 0.16552412509918213, 0.16769881546497345, 0.16694284975528717]], [[0.16694335639476776, 0.16927576065063477, 0.16648881137371063, 0.16626200079917908, 0.16858486831188202, 0.16244517266750336], [0.1669769287109375, 0.1696123629808426, 0.16646386682987213, 0.1662079244852066, 0.1688312143087387, 0.16190771758556366], [0.1669367253780365, 0.16920964419841766, 0.16649366915225983, 0.16627256572246552, 0.1685364544391632, 0.16255095601081848], [0.16693337261676788, 0.16917656362056732, 0.16649606823921204, 0.16627784073352814, 0.168512225151062, 0.16260384023189545], [0.16696707904338837, 0.16951312124729156, 0.16647125780582428, 0.1662239134311676, 0.16875861585140228, 0.1620660126209259], [0.1668759435415268, 0.16861367225646973, 0.16653656959533691, 0.16636714339256287, 0.1680995672941208, 0.1635071188211441]], [[0.1676812618970871, 0.1674998253583908, 0.1646169126033783, 0.16443879902362823, 0.16695667803287506, 0.16880647838115692], [0.16766519844532013, 0.16748665273189545, 0.16464948654174805, 0.16447415947914124, 0.16695217788219452, 0.16877232491970062], [0.16740702092647552, 0.16727498173713684, 0.16517193615436554, 0.16504167020320892, 0.16687951982021332, 0.16822494566440582], [0.16739089787006378, 0.1672617644071579, 0.16520452499389648, 0.1650770753622055, 0.1668749451637268, 0.1681908220052719], [0.16761693358421326, 0.16744711995124817, 0.1647471785545349, 0.16458025574684143, 0.1669386774301529, 0.16866986453533173], [0.1677805632352829, 0.16758117079734802, 0.1644158661365509, 0.16422048211097717, 0.16698439419269562, 0.16901758313179016]], [[0.16752102971076965, 0.16641515493392944, 0.16367530822753906, 0.16683730483055115, 0.16916821897029877, 0.1663830280303955], [0.1674688756465912, 0.16643106937408447, 0.16385796666145325, 0.1668272763490677, 0.16901393234729767, 0.16640090942382812], [0.16733798384666443, 0.16647066175937653, 0.16431644558906555, 0.16680189967155457, 0.1686275750398636, 0.16644544899463654], [0.16748882830142975, 0.16642498970031738, 0.1637880802154541, 0.1668311208486557, 0.1690729409456253, 0.16639408469200134], [0.16759797930717468, 0.1663915514945984, 0.16340570151805878, 0.16685199737548828, 0.1693962812423706, 0.16635651886463165], [0.1674673706293106, 0.16643153131008148, 0.16386330127716064, 0.166826993227005, 0.16900944709777832, 0.1664014309644699]], [[0.16678059101104736, 0.16660012304782867, 0.1664198487997055, 0.16623978316783905, 0.16605989634990692, 0.16789975762367249], [0.1667787879705429, 0.16660119593143463, 0.16642379760742188, 0.16624657809734344, 0.16606955230236053, 0.1678800731897354], [0.16677699983119965, 0.16660228371620178, 0.16642774641513824, 0.16625338792800903, 0.16607920825481415, 0.16786038875579834], [0.1667751967906952, 0.16660334169864655, 0.16643168032169342, 0.16626018285751343, 0.16608886420726776, 0.16784070432186127], [0.16677340865135193, 0.1666044294834137, 0.1664356291294098, 0.16626699268817902, 0.16609853506088257, 0.1678210198879242], [0.16679169237613678, 0.16659346222877502, 0.16639548540115356, 0.16619773209095, 0.16600021719932556, 0.16802141070365906]], [[0.1657678335905075, 0.16836513578891754, 0.16710565984249115, 0.1654614806175232, 0.16650310158729553, 0.16679681837558746], [0.165133997797966, 0.16956940293312073, 0.16741251945495605, 0.16461403667926788, 0.16638466715812683, 0.1668853908777237], [0.1654401421546936, 0.16898702085018158, 0.16726455092430115, 0.1650231033563614, 0.1664421707391739, 0.16684292256832123], [0.16584323346614838, 0.16822223365306854, 0.16706900298595428, 0.16556242108345032, 0.16651701927185059, 0.1667861044406891], [0.1655874103307724, 0.16870734095573425, 0.1671932190656662, 0.16522005200386047, 0.16646963357925415, 0.16682228446006775], [0.16551557183265686, 0.16884377598762512, 0.16722805798053741, 0.16512395441532135, 0.16645626723766327, 0.16683238744735718]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 5200}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0316316051011838e-05, "remove_single_ts_time_rank_from_batch": 1.1877325984005723e-05, "tensor_to_numpy": 1.4867788134529788e-05, "get_actions": 3.583947823501915e-05, "un_batch_to_individual_items": 6.568678111909457e-06, "normalize_and_clip_actions": 7.773413644746204e-06}}, "connector_pipeline_timer": 0.0001131115799575279}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.82075179943078e-06, "add_states_from_episodes_to_batch": 2.7800129676941505e-06, "batch_individual_items": 1.2547739558241184e-05, "add_time_dim_to_batch_and_zero_pad": 7.087610274690176e-06, "numpy_to_tensor": 1.1866436854182999e-05}}, "connector_pipeline_timer": 5.9054380666903334e-05}, "sample": 0.11820602835569904, "num_module_steps_sampled": {"default_policy": 400}, "rlmodule_inference_timer": 3.0601319920822446e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "env_step_timer": 1.4039928074424976e-05, "agent_episode_returns_mean": {"default_agent": 0.15}, "num_episodes": 20, "episode_len_mean": 20.0, "num_episodes_lifetime": 260, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_mean": 0.15, "episode_return_min": -16.5, "episode_len_max": 20, "weights_seq_no": 13.0, "episode_duration_sec_mean": 0.005229630848625675, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 65400, "env_reset_timer": 0.0005315144564042374, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": 0.15}, "time_between_sampling": 9.813338654349746}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "b7d62_00000", "date": "2025-08-11_18-39-42", "timestamp": 1754930382, "time_this_iter_s": 9.720008850097656, "time_total_s": 127.20003771781921, "pid": 11547, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1550f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 127.20003771781921, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 39.92142857142857, "ram_util_percent": 78.3}}
{"timers": {"training_iteration": 9.417402917255105, "restore_env_runners": 1.0049072769344104e-05, "training_step": 9.417193401108932, "env_runner_sampling_timer": 1.6506886404516337, "learner_update_timer": 7.569401836447221, "synch_weights": 0.0014091887953453803, "restore_eval_env_runners": 4.058618217765562e-05, "evaluation_iteration": 0.12826230999986218, "synch_eval_env_connectors": 0.00014581934607811082, "synch_env_connectors": 4.651955286209565e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.61208084546416e-06, "remove_single_ts_time_rank_from_batch": 1.1921142920944592e-05, "tensor_to_numpy": 1.537479806241947e-05, "get_actions": 3.9165812345056784e-05, "normalize_and_clip_actions": 8.014997876996194e-06, "listify_data_for_vector_env": 1.0663800993329731e-05}}, "connector_pipeline_timer": 0.0001181113853518498}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.073830475339725e-06, "numpy_to_tensor": 1.2423323071002069e-05, "add_observations_from_episodes_to_batch": 2.884157138284323e-06, "add_states_from_episodes_to_batch": 2.765983651279473e-06, "batch_individual_items": 1.2573991891916551e-05}}, "connector_pipeline_timer": 6.004759425497462e-05}, "episode_duration_sec_mean": 0.005286431156564503, "episode_len_mean": 20.0, "sample": 0.005694150405395419, "num_episodes_lifetime": -370000.0, "episode_return_max": 12.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_episode_returns_mean": {"default_policy": 5.14}, "episode_len_min": 20, "time_between_sampling": 0.03319009190399179, "agent_episode_returns_mean": {"default_agent": 5.14}, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "rlmodule_inference_timer": 3.1681543356203384e-05, "episode_return_mean": 5.14, "num_env_steps_sampled_lifetime": -7400000.0, "env_reset_timer": 4.403297466395063e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -7.5, "env_step_timer": 1.4027655968511295e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "weights_seq_no": 13.0, "num_env_steps_sampled_lifetime_throughput": 3216.350322524272}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15734464545267857, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00928535766666893, "add_observations_from_episodes_to_batch": 0.0008824800120833679, "add_columns_from_episodes_to_train_batch": 0.04264745499630412, "add_time_dim_to_batch_and_zero_pad": 0.0913752927225246, "add_states_from_episodes_to_batch": 0.003626939882300106, "batch_individual_items": 0.00929174893461852, "numpy_to_tensor": 7.816757122542595e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_kl_coeff": 9.862300430540927e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 14.0, "entropy": 0.6777009963989258, "vf_explained_var": -1.2040138244628906e-05, "module_train_batch_size_mean": 998.1405362012929, "num_module_steps_trained_lifetime": 83790, "vf_loss": 0.3205079734325409, "use_intrinsic_rewards": 0.0, "policy_loss": -0.0003967415832448751, "vf_loss_unclipped": 42.5863151550293, "num_module_steps_trained": 5985, "total_loss": 0.24824954569339752, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 1.6163194231921807e-05, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 755.1754161856709}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_explained_var": 0.003083348274230957, "module_train_batch_size_mean": 997.501977255973, "num_module_steps_trained_lifetime": 502740, "vf_loss": 0.32053297758102417, "use_intrinsic_rewards": 1.0, "policy_loss": -0.0003691514430101961, "vf_loss_unclipped": 42.61868667602539, "num_module_steps_trained": 35910, "total_loss": 0.2482987642288208, "mean_kl_loss": 1.3920697711000685e-05, "diff_num_grad_updates_vs_sampler_policy": 71.0, "entropy": 0.6777719259262085, "weights_seq_no": 84.0}, "intrinsic_reward_module": {"weights_seq_no": 84.0, "module_train_batch_size_mean": 997.501977255973, "num_module_steps_trained": 35910, "total_loss": 0.0, "num_module_steps_trained_lifetime": 502740, "diff_num_grad_updates_vs_sampler_policy": 71.0}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 1005480, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 3024000, "num_env_steps_trained_lifetime_throughput": 52831.759362536286}}}, "intrinsic_reward_module": {"total_loss": 0.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 83790, "num_trainable_parameters": 8266, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "weights_seq_no": 14.0, "module_train_batch_size_mean": 998.1405362012929, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 755.1820167132041}, "__all_modules__": {"num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 504000, "num_module_steps_trained_lifetime": 167580, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 4546.282855132147, "num_module_steps_trained_throughput": 21197056.26219319, "num_module_steps_trained_lifetime_throughput": 12659160.405537218}, "IntrinsicAttentionMask": [[[0.16678059101104736, 0.16660012304782867, 0.1664198487997055, 0.16623976826667786, 0.16605989634990692, 0.16789975762367249], [0.1667787879705429, 0.16660119593143463, 0.16642379760742188, 0.16624657809734344, 0.16606955230236053, 0.1678800731897354], [0.16677699983119965, 0.16660228371620178, 0.16642773151397705, 0.16625338792800903, 0.16607920825481415, 0.16786038875579834], [0.1667751967906952, 0.16660334169864655, 0.16643168032169342, 0.16626018285751343, 0.16608886420726776, 0.16784070432186127], [0.16677340865135193, 0.1666044443845749, 0.16643564403057098, 0.1662670075893402, 0.16609854996204376, 0.1678210347890854], [0.16679169237613678, 0.16659347712993622, 0.16639548540115356, 0.1661977469921112, 0.16600023210048676, 0.16802142560482025]], [[0.16648589074611664, 0.1679764688014984, 0.16619452834129333, 0.1660490334033966, 0.1675357073545456, 0.1657584309577942], [0.16644920408725739, 0.16823959350585938, 0.16609962284564972, 0.16592510044574738, 0.1677098572254181, 0.16557662189006805], [0.16649305820465088, 0.16792477667331696, 0.16621313989162445, 0.16607336699962616, 0.16750147938728333, 0.16579416394233704], [0.1664966344833374, 0.16789892315864563, 0.1662224531173706, 0.16608551144599915, 0.1674843430519104, 0.16581200063228607], [0.1664600372314453, 0.168162003159523, 0.16612760722637177, 0.1659616380929947, 0.16765852272510529, 0.16563020646572113], [0.16650383174419403, 0.16784727573394775, 0.16624107956886292, 0.1661098748445511, 0.16745014488697052, 0.1658477634191513]], [[0.16814006865024567, 0.1652461439371109, 0.16777639091014862, 0.16488872468471527, 0.16741348803043365, 0.16653521358966827], [0.16776351630687714, 0.16560854017734528, 0.16749322414398193, 0.16534170508384705, 0.16722336411476135, 0.16656963527202606], [0.16809308528900146, 0.16529132425785065, 0.1677410751581192, 0.16494517028331757, 0.16738979518413544, 0.1665395349264145], [0.16771657764911652, 0.1656537652015686, 0.16745790839195251, 0.1653982698917389, 0.16719962656497955, 0.1665738970041275], [0.16804611682891846, 0.1653365194797516, 0.16770575940608978, 0.16500166058540344, 0.16736610233783722, 0.1665438562631607], [0.16793203353881836, 0.16544631123542786, 0.167619988322258, 0.16513888537883759, 0.1673085242509842, 0.1665543168783188]], [[0.16576607525348663, 0.16836334764957428, 0.1655617654323578, 0.167000874876976, 0.16805218160152435, 0.16525579988956451], [0.1651288866996765, 0.1695641577243805, 0.1647820621728897, 0.16723144054412842, 0.16903024911880493, 0.16426321864128113], [0.1658165156841278, 0.16826824843883514, 0.16562357544898987, 0.16698238253593445, 0.16797463595867157, 0.1653345823287964], [0.16546215116977692, 0.16893605887889862, 0.16518965363502502, 0.16711144149303436, 0.16851893067359924, 0.16478177905082703], [0.16520480811595917, 0.16942107677459717, 0.16487489640712738, 0.16720424592494965, 0.1689138263463974, 0.1643812507390976], [0.16589218378067017, 0.1681256741285324, 0.165716290473938, 0.1669546365737915, 0.16785834729671478, 0.16545279324054718]], [[0.16286535561084747, 0.1665652096271515, 0.16850154101848602, 0.16629111766815186, 0.1682242602109909, 0.16755259037017822], [0.16072450578212738, 0.16649775207042694, 0.1695486456155777, 0.16606752574443817, 0.1691105216741562, 0.16805095970630646], [0.1596314162015915, 0.16646042466163635, 0.17008724808692932, 0.1659499555826187, 0.16956566274166107, 0.16830529272556305], [0.16088072955608368, 0.1665029376745224, 0.1694718897342682, 0.16608412563800812, 0.16904562711715698, 0.16801460087299347], [0.15978682041168213, 0.1664658486843109, 0.170010507106781, 0.16596682369709015, 0.16950084269046783, 0.16826914250850677], [0.16016481816768646, 0.16647888720035553, 0.16982409358024597, 0.1660076230764389, 0.16934335231781006, 0.16818119585514069]], [[0.1692461520433426, 0.16812890768051147, 0.16536082327365875, 0.16513554751873016, 0.1674426943063736, 0.164685919880867], [0.16908703744411469, 0.1680392026901245, 0.16544122993946075, 0.1652296781539917, 0.16739539802074432, 0.16480739414691925], [0.16868863999843597, 0.16781431436538696, 0.16564270853996277, 0.16546563804149628, 0.16727669537067413, 0.16511204838752747], [0.16865593194961548, 0.1677958369255066, 0.16565923392772675, 0.16548499464988708, 0.16726692020893097, 0.16513706743717194], [0.16898883879184723, 0.1679838001728058, 0.16549088060855865, 0.1652878224849701, 0.16736619174480438, 0.16488243639469147], [0.16859054565429688, 0.16775888204574585, 0.1656922996044159, 0.1655237227678299, 0.16724738478660583, 0.16518710553646088]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 5600}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0212837378608944e-05, "remove_single_ts_time_rank_from_batch": 1.1858282661597854e-05, "tensor_to_numpy": 1.4753399884740356e-05, "get_actions": 3.543867241713909e-05, "un_batch_to_individual_items": 6.484907894833129e-06, "normalize_and_clip_actions": 7.734464209518951e-06}}, "connector_pipeline_timer": 0.00011216601947448798}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.806975543832369e-06, "add_states_from_episodes_to_batch": 2.727095376664451e-06, "batch_individual_items": 1.2294575290303505e-05, "add_time_dim_to_batch_and_zero_pad": 7.025860416068425e-06, "numpy_to_tensor": 1.1747539085670234e-05}}, "connector_pipeline_timer": 5.8583678475901524e-05}, "sample": 0.11814585141208914, "num_module_steps_sampled": {"default_policy": 400}, "rlmodule_inference_timer": 3.0041889819222166e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "env_step_timer": 1.3660337631558297e-05, "agent_episode_returns_mean": {"default_agent": 0.55}, "num_episodes": 20, "episode_len_mean": 20.0, "num_episodes_lifetime": 280, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_mean": 0.55, "episode_return_min": -16.5, "episode_len_max": 20, "weights_seq_no": 14.0, "episode_duration_sec_mean": 0.005180056258104741, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 70400, "env_reset_timer": 0.0005276359816853291, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": 0.55}, "time_between_sampling": 9.811182899885987}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "b7d62_00000", "date": "2025-08-11_18-39-51", "timestamp": 1754930391, "time_this_iter_s": 9.696376085281372, "time_total_s": 136.8964138031006, "pid": 11547, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1550f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 136.8964138031006, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 42.064285714285724, "ram_util_percent": 77.94285714285715}}
{"timers": {"training_iteration": 9.418448883502746, "restore_env_runners": 1.0029422005280504e-05, "training_step": 9.418239390848012, "env_runner_sampling_timer": 1.6504228136367827, "learner_update_timer": 7.570618495582585, "synch_weights": 0.001404618156840807, "restore_eval_env_runners": 4.0333650976257317e-05, "evaluation_iteration": 0.1281631685598366, "synch_eval_env_connectors": 0.00014556990338123775, "synch_env_connectors": 4.6429354368143615e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.54217767510919e-06, "remove_single_ts_time_rank_from_batch": 1.1738145855485403e-05, "tensor_to_numpy": 1.5093151469234263e-05, "get_actions": 3.8267154752827006e-05, "normalize_and_clip_actions": 8.007118179421378e-06, "listify_data_for_vector_env": 1.0470974572800412e-05}}, "connector_pipeline_timer": 0.00011632790909819035}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.003536131870169e-06, "numpy_to_tensor": 1.2235744099362161e-05, "add_observations_from_episodes_to_batch": 2.870323957991947e-06, "add_states_from_episodes_to_batch": 2.7366817874550084e-06, "batch_individual_items": 1.244174106226947e-05}}, "connector_pipeline_timer": 5.94753173950629e-05}, "episode_duration_sec_mean": 0.005224325316026805, "episode_len_mean": 20.0, "sample": 0.005606398127968245, "num_episodes_lifetime": -400875.0, "episode_return_max": 12.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_episode_returns_mean": {"default_policy": 4.740000000000002}, "episode_len_min": 20, "time_between_sampling": 0.03315701708149254, "agent_episode_returns_mean": {"default_agent": 4.740000000000002}, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "rlmodule_inference_timer": 3.132035453403374e-05, "episode_return_mean": 4.740000000000002, "num_env_steps_sampled_lifetime": -8017500.0, "env_reset_timer": 4.187675316195025e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -7.5, "env_step_timer": 1.3886554681338206e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "weights_seq_no": 14.0, "num_env_steps_sampled_lifetime_throughput": 3262.4329940735083}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15733647357806793, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009280533679971906, "add_observations_from_episodes_to_batch": 0.0008820818710045499, "add_columns_from_episodes_to_train_batch": 0.04267372169580553, "add_time_dim_to_batch_and_zero_pad": 0.09136270063617576, "add_states_from_episodes_to_batch": 0.0036298575630054515, "batch_individual_items": 0.009272842695671388, "numpy_to_tensor": 7.801214591617359e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_kl_coeff": 4.931150215270463e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 15.0, "entropy": 0.676540195941925, "vf_explained_var": -4.2319297790527344e-05, "module_train_batch_size_mean": 998.1026110140886, "num_module_steps_trained_lifetime": 89775, "vf_loss": 0.3205079138278961, "use_intrinsic_rewards": 0.0, "policy_loss": -0.0004315049445722252, "vf_loss_unclipped": 42.56651306152344, "num_module_steps_trained": 5985, "total_loss": 0.24821653962135315, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 2.3793008949724026e-05, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 752.5689858501041}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_explained_var": 0.00307542085647583, "module_train_batch_size_mean": 997.499088644618, "num_module_steps_trained_lifetime": 538650, "vf_loss": 0.3205335736274719, "use_intrinsic_rewards": 1.0, "policy_loss": -0.0004099318175576627, "vf_loss_unclipped": 42.59358215332031, "num_module_steps_trained": 35910, "total_loss": 0.24826142191886902, "mean_kl_loss": 2.1307874703779817e-05, "diff_num_grad_updates_vs_sampler_policy": 76.0, "entropy": 0.6766065359115601, "weights_seq_no": 90.0}, "intrinsic_reward_module": {"weights_seq_no": 90.0, "module_train_batch_size_mean": 997.499088644618, "num_module_steps_trained": 35910, "total_loss": 0.0, "num_module_steps_trained_lifetime": 538650, "diff_num_grad_updates_vs_sampler_policy": 76.0}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 1077300, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 3240000, "num_env_steps_trained_lifetime_throughput": 51970.10697033097}}}, "intrinsic_reward_module": {"total_loss": 0.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 89775, "num_trainable_parameters": 8266, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "weights_seq_no": 15.0, "module_train_batch_size_mean": 998.1026110140886, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 752.5751608236191}, "__all_modules__": {"num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 540000, "num_module_steps_trained_lifetime": 179550, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 4530.451125121132, "num_module_steps_trained_throughput": 20734546.25856011, "num_module_steps_trained_lifetime_throughput": 12637348.788905596}, "IntrinsicAttentionMask": [[[0.1685968041419983, 0.16569502651691437, 0.1655157208442688, 0.16533662378787994, 0.1678682565689087, 0.1669875979423523], [0.16810277104377747, 0.1659434288740158, 0.16580970585346222, 0.1656760722398758, 0.16756153106689453, 0.166906476020813], [0.16807200014591217, 0.1659589260816574, 0.16582803428173065, 0.16569724678993225, 0.16754239797592163, 0.16690140962600708], [0.16804121434688568, 0.16597440838813782, 0.16584636270999908, 0.1657184213399887, 0.16752326488494873, 0.16689632833003998], [0.1684734970331192, 0.16575701534748077, 0.16558906435966492, 0.1654212921857834, 0.16779175400733948, 0.16696742177009583], [0.16832378506660461, 0.1658322662115097, 0.16567812860012054, 0.16552412509918213, 0.16769881546497345, 0.16694284975528717]], [[0.1679491102695465, 0.16723601520061493, 0.165461927652359, 0.16531707346439362, 0.16900816559791565, 0.16502775251865387], [0.16782663762569427, 0.167182058095932, 0.16557732224464417, 0.1654462218284607, 0.16878342628479004, 0.16518434882164001], [0.1675194948911667, 0.16704638302326202, 0.16586637496948242, 0.16576986014842987, 0.1682208925485611, 0.1655769646167755], [0.1674942672252655, 0.16703520715236664, 0.16589011251926422, 0.1657964289188385, 0.16817475855350494, 0.165609210729599], [0.16812998056411743, 0.1673154979944229, 0.16529133915901184, 0.16512621939182281, 0.16934047639369965, 0.16479645669460297], [0.16744379699230194, 0.16701285541057587, 0.16593755781650543, 0.16584956645965576, 0.16808249056339264, 0.16567371785640717]], [[0.16768531501293182, 0.16750386357307434, 0.16732260584831238, 0.1644427627325058, 0.1669607013463974, 0.16608481109142303], [0.16766908764839172, 0.16749054193496704, 0.16731218993663788, 0.16447797417640686, 0.16695605218410492, 0.1660940945148468], [0.167652890086174, 0.16747725009918213, 0.16730180382728577, 0.1645132303237915, 0.16695143282413483, 0.16610340774059296], [0.16739292442798615, 0.16726379096508026, 0.16713474690914154, 0.16507908701896667, 0.16687697172164917, 0.16625244915485382], [0.1676204651594162, 0.16745062172412872, 0.16728097200393677, 0.1645837128162384, 0.16694216430187225, 0.16612200438976288], [0.1675417125225067, 0.1673859804868698, 0.16723039746284485, 0.16475506126880646, 0.16691964864730835, 0.16616719961166382]], [[0.16551129519939423, 0.16810457408428192, 0.16530729830265045, 0.1667441874742508, 0.1677938997745514, 0.16653868556022644], [0.16469787061214447, 0.16912156343460083, 0.1643519550561905, 0.16679494082927704, 0.1685890406370163, 0.16644462943077087], [0.16557586193084717, 0.16802403330802917, 0.16538318991661072, 0.1667400449514389, 0.16773085296154022, 0.1665460169315338], [0.16512291133403778, 0.16858969628810883, 0.16485098004341125, 0.16676881909370422, 0.1681734174489975, 0.1664941906929016], [0.16479462385177612, 0.16900041699409485, 0.1644655168056488, 0.16678906977176666, 0.16849441826343536, 0.16645599901676178], [0.16518743336200714, 0.16850903630256653, 0.16492676734924316, 0.1667647808790207, 0.16811034083366394, 0.16650164127349854]], [[0.16219021379947662, 0.16794125735759735, 0.16780303418636322, 0.16560174524784088, 0.16752690076828003, 0.1689368039369583], [0.15830178558826447, 0.16905300319194794, 0.16879068315029144, 0.1646394282579422, 0.16826727986335754, 0.17094776034355164], [0.15839284658432007, 0.1690269261598587, 0.1687675565481186, 0.16466236114501953, 0.16825002431869507, 0.17090024054050446], [0.1598586142063141, 0.16860736906528473, 0.16839519143104553, 0.16502895951271057, 0.1679716259241104, 0.1701381504535675], [0.15857510268688202, 0.16897474229335785, 0.1687212586402893, 0.1647082418203354, 0.16821546852588654, 0.1708052009344101], [0.15764936804771423, 0.16923998296260834, 0.1689564734697342, 0.1644744873046875, 0.1683908849954605, 0.1712888777256012]], [[0.1686708927154541, 0.16755743324756622, 0.164798766374588, 0.1645742654800415, 0.16687355935573578, 0.16752508282661438], [0.16854746639728546, 0.1675029695034027, 0.16491329669952393, 0.1647024154663086, 0.16686123609542847, 0.16747261583805084], [0.16823826730251312, 0.16736629605293274, 0.16520047187805176, 0.16502387821674347, 0.16683010756969452, 0.1673409342765808], [0.1682129055261612, 0.16735506057739258, 0.165224090218544, 0.16505029797554016, 0.16682755947113037, 0.16733011603355408], [0.16847127676010132, 0.167469322681427, 0.16498403251171112, 0.1647815853357315, 0.16685360670089722, 0.16744019091129303], [0.16854387521743774, 0.16750138998031616, 0.16491664946079254, 0.16470617055892944, 0.16686087846755981, 0.16747108101844788]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 6000}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0571450658091324e-05, "remove_single_ts_time_rank_from_batch": 1.232160586831656e-05, "tensor_to_numpy": 1.5698919005728018e-05, "get_actions": 3.937913796130504e-05, "un_batch_to_individual_items": 6.738343057385451e-06, "normalize_and_clip_actions": 8.097606614137716e-06}}, "connector_pipeline_timer": 0.00011938016645278492}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9279015386578475e-06, "add_states_from_episodes_to_batch": 2.9792910220990176e-06, "batch_individual_items": 1.2879441648561797e-05, "add_time_dim_to_batch_and_zero_pad": 7.379857160402534e-06, "numpy_to_tensor": 1.3348296156848795e-05}}, "connector_pipeline_timer": 6.206723964480881e-05}, "sample": 0.11813912414788927, "num_module_steps_sampled": {"default_policy": 400}, "rlmodule_inference_timer": 3.289234528924994e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "env_step_timer": 1.6407653443047502e-05, "agent_episode_returns_mean": {"default_agent": 1.35}, "num_episodes": 20, "episode_len_mean": 20.0, "num_episodes_lifetime": 300, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_mean": 1.35, "episode_return_min": -16.5, "episode_len_max": 20, "weights_seq_no": 15.0, "episode_duration_sec_mean": 0.005225721236784011, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 75400, "env_reset_timer": 0.0005231679516555811, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": 1.35}, "time_between_sampling": 9.808508470057022}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "b7d62_00000", "date": "2025-08-11_18-40-01", "timestamp": 1754930401, "time_this_iter_s": 9.653496026992798, "time_total_s": 146.54990983009338, "pid": 11547, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1550f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 146.54990983009338, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 40.27142857142858, "ram_util_percent": 77.8}}
{"timers": {"training_iteration": 9.421619752577993, "restore_env_runners": 9.996217935196562e-06, "training_step": 9.421409943610257, "env_runner_sampling_timer": 1.6493110217505278, "learner_update_timer": 7.57399687353748, "synch_weights": 0.001398943225277838, "restore_eval_env_runners": 3.999114380045575e-05, "evaluation_iteration": 0.12816578062392567, "synch_eval_env_connectors": 0.00014528462420246868, "synch_env_connectors": 4.644845216528416e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.555437212639029e-06, "remove_single_ts_time_rank_from_batch": 1.1777784277646755e-05, "tensor_to_numpy": 1.51885278638523e-05, "get_actions": 3.967618747993785e-05, "normalize_and_clip_actions": 8.001525830515156e-06, "listify_data_for_vector_env": 1.05463221239917e-05}}, "connector_pipeline_timer": 0.00011797899428938042}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.0813290711666355e-06, "numpy_to_tensor": 1.248550202912241e-05, "add_observations_from_episodes_to_batch": 2.8948301569539907e-06, "add_states_from_episodes_to_batch": 2.7428942781565866e-06, "batch_individual_items": 1.2525583802919776e-05}}, "connector_pipeline_timer": 6.004908844809964e-05}, "episode_duration_sec_mean": 0.005274824612308294, "episode_len_mean": 20.0, "sample": 0.005650634854532099, "num_episodes_lifetime": -431750.0, "episode_return_max": 12.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_episode_returns_mean": {"default_policy": 4.899999999999999}, "episode_len_min": 20, "time_between_sampling": 0.032873843670421864, "agent_episode_returns_mean": {"default_agent": 4.899999999999999}, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "rlmodule_inference_timer": 3.161794823775775e-05, "episode_return_mean": 4.899999999999999, "num_env_steps_sampled_lifetime": -8635000.0, "env_reset_timer": 4.272135460504106e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -7.5, "env_step_timer": 1.4012732623393228e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "weights_seq_no": 15.0, "num_env_steps_sampled_lifetime_throughput": 3242.679403451204}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15815333967234757, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009276876683220454, "add_observations_from_episodes_to_batch": 0.0008817143913999764, "add_columns_from_episodes_to_train_batch": 0.0426736707289865, "add_time_dim_to_batch_and_zero_pad": 0.09135621905060186, "add_states_from_episodes_to_batch": 0.0036317323269378873, "batch_individual_items": 0.010098818857845032, "numpy_to_tensor": 7.793452340335075e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_kl_coeff": 2.4655751076352317e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 16.0, "entropy": 0.6757588386535645, "vf_explained_var": 4.988908767700195e-05, "module_train_batch_size_mean": 998.0669052031734, "num_module_steps_trained_lifetime": 95760, "vf_loss": 0.32050788402557373, "use_intrinsic_rewards": 0.0, "policy_loss": -0.0005122413276694715, "vf_loss_unclipped": 42.2978630065918, "num_module_steps_trained": 5985, "total_loss": 0.2481369525194168, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 2.5367837224621326e-05, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 749.8472532335674}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_explained_var": 0.003010272979736328, "module_train_batch_size_mean": 997.4970769774884, "num_module_steps_trained_lifetime": 574560, "vf_loss": 0.3205357789993286, "use_intrinsic_rewards": 1.0, "policy_loss": -0.0004824427596759051, "vf_loss_unclipped": 42.247615814208984, "num_module_steps_trained": 35910, "total_loss": 0.24819204211235046, "mean_kl_loss": 2.2541429643752053e-05, "diff_num_grad_updates_vs_sampler_policy": 81.0, "entropy": 0.6758343577384949, "weights_seq_no": 96.0}, "intrinsic_reward_module": {"weights_seq_no": 96.0, "module_train_batch_size_mean": 997.4970769774884, "num_module_steps_trained": 35910, "total_loss": 0.0, "num_module_steps_trained_lifetime": 574560, "diff_num_grad_updates_vs_sampler_policy": 81.0}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 1149120, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 3456000, "num_env_steps_trained_lifetime_throughput": 51149.47063261613}}}, "intrinsic_reward_module": {"total_loss": 0.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 95760, "num_trainable_parameters": 8266, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "weights_seq_no": 16.0, "module_train_batch_size_mean": 998.0669052031734, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 749.8530158391094}, "__all_modules__": {"num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 576000, "num_module_steps_trained_lifetime": 191520, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 4513.931920227419, "num_module_steps_trained_throughput": 20300569.484248467, "num_module_steps_trained_lifetime_throughput": 12624508.595505755}, "IntrinsicAttentionMask": [[[0.16678059101104736, 0.16660012304782867, 0.1664198487997055, 0.16623976826667786, 0.16605988144874573, 0.16789975762367249], [0.1667788028717041, 0.16660121083259583, 0.16642379760742188, 0.16624659299850464, 0.16606956720352173, 0.1678800880908966], [0.16677698493003845, 0.1666022688150406, 0.16642773151397705, 0.16625338792800903, 0.16607920825481415, 0.16786038875579834], [0.166775181889534, 0.16660334169864655, 0.16643168032169342, 0.16626018285751343, 0.16608886420726776, 0.16784070432186127], [0.16677340865135193, 0.1666044294834137, 0.1664356291294098, 0.1662670075893402, 0.16609854996204376, 0.1678210347890854], [0.16679169237613678, 0.16659346222877502, 0.16639548540115356, 0.16619773209095, 0.16600021719932556, 0.16802142560482025]], [[0.16721200942993164, 0.16870909929275513, 0.16473573446273804, 0.1667732447385788, 0.1682664155960083, 0.1643034666776657], [0.16731949150562286, 0.1691192388534546, 0.16434970498085022, 0.16679264605045319, 0.16858673095703125, 0.16383220255374908], [0.16703078150749207, 0.16802331805229187, 0.1653824895620346, 0.1667393296957016, 0.16773013770580292, 0.16509391367435455], [0.16718021035194397, 0.16858826577663422, 0.16484957933425903, 0.166767418384552, 0.1681719869375229, 0.1644425243139267], [0.16728787124156952, 0.16899831593036652, 0.16446347534656525, 0.16678699851036072, 0.16849233210086823, 0.16397105157375336], [0.1669986993074417, 0.1679026484489441, 0.16549645364284515, 0.16673316061496735, 0.16763567924499512, 0.165233314037323]], [[0.16859173774719238, 0.16569003462791443, 0.16551074385643005, 0.1653316617012024, 0.16515275835990906, 0.16972306370735168], [0.16809998452663422, 0.16594067215919495, 0.16580693423748016, 0.16567331552505493, 0.16553980112075806, 0.1689392775297165], [0.16806931793689728, 0.1659562885761261, 0.16582541167736053, 0.16569462418556213, 0.1655639410018921, 0.16889049112796783], [0.16803866624832153, 0.16597189009189606, 0.16584384441375732, 0.16571590304374695, 0.16558806598186493, 0.16884170472621918], [0.1680079996585846, 0.16598747670650482, 0.1658622920513153, 0.16573718190193176, 0.16561217606067657, 0.16879291832447052], [0.16878122091293335, 0.1655932515859604, 0.16539645195007324, 0.1651998907327652, 0.16500356793403625, 0.17002563178539276]], [[0.16602353751659393, 0.1686248481273651, 0.16581891477108002, 0.16726025938987732, 0.1667599380016327, 0.16551247239112854], [0.16556774079799652, 0.17001479864120483, 0.1652200073003769, 0.16767588257789612, 0.1668217033147812, 0.1646997630596161], [0.16605961322784424, 0.16851495206356049, 0.1658664047718048, 0.16722720861434937, 0.16675491631031036, 0.1655769795179367], [0.16580623388290405, 0.16928736865520477, 0.1655331701040268, 0.16745896637439728, 0.16678985953330994, 0.16512443125247955], [0.16589400172233582, 0.16901971399784088, 0.16564854979515076, 0.16737881302833557, 0.1667778640985489, 0.1652810424566269], [0.16611367464065552, 0.16835016012191772, 0.16593755781650543, 0.16717755794525146, 0.1667473018169403, 0.16567371785640717]], [[0.16678059101104736, 0.16660010814666748, 0.1664198487997055, 0.16623976826667786, 0.16605988144874573, 0.16789975762367249], [0.1667788028717041, 0.16660121083259583, 0.16642379760742188, 0.16624659299850464, 0.16606955230236053, 0.1678800880908966], [0.16677698493003845, 0.1666022688150406, 0.16642773151397705, 0.16625337302684784, 0.16607920825481415, 0.16786038875579834], [0.166775181889534, 0.16660334169864655, 0.16643168032169342, 0.16626018285751343, 0.16608886420726776, 0.16784070432186127], [0.16677340865135193, 0.1666044294834137, 0.1664356291294098, 0.1662670075893402, 0.16609854996204376, 0.1678210347890854], [0.16679167747497559, 0.16659346222877502, 0.16639547049999237, 0.16619773209095, 0.16600020229816437, 0.16802142560482025]], [[0.16551129519939423, 0.16810457408428192, 0.16530729830265045, 0.1667441874742508, 0.1677938997745514, 0.16653868556022644], [0.16469787061214447, 0.16912156343460083, 0.1643519550561905, 0.16679494082927704, 0.1685890406370163, 0.16644462943077087], [0.16557584702968597, 0.16802403330802917, 0.16538318991661072, 0.1667400449514389, 0.16773085296154022, 0.1665460169315338], [0.16512291133403778, 0.16858969628810883, 0.16485098004341125, 0.16676881909370422, 0.1681734174489975, 0.1664941906929016], [0.16479462385177612, 0.16900041699409485, 0.1644655019044876, 0.16678906977176666, 0.16849441826343536, 0.16645599901676178], [0.16518743336200714, 0.16850903630256653, 0.16492676734924316, 0.1667647808790207, 0.16811034083366394, 0.16650162637233734]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 6400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0314525720528305e-05, "remove_single_ts_time_rank_from_batch": 1.1880718497359436e-05, "tensor_to_numpy": 1.5028721852302781e-05, "get_actions": 3.5498580551980924e-05, "un_batch_to_individual_items": 6.500989906052378e-06, "normalize_and_clip_actions": 7.777589709865577e-06}}, "connector_pipeline_timer": 0.00011303514972471755}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7926049294335785e-06, "add_states_from_episodes_to_batch": 2.7630406883391006e-06, "batch_individual_items": 1.2402540457192108e-05, "add_time_dim_to_batch_and_zero_pad": 6.954489664799328e-06, "numpy_to_tensor": 1.1826938345490207e-05}}, "connector_pipeline_timer": 5.869664408507109e-05}, "sample": 0.1180845570767614, "num_module_steps_sampled": {"default_policy": 400}, "rlmodule_inference_timer": 3.0113303345011752e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "env_step_timer": 1.3886859441657177e-05, "agent_episode_returns_mean": {"default_agent": 1.75}, "num_episodes": 20, "episode_len_mean": 20.0, "num_episodes_lifetime": 320, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_mean": 1.75, "episode_return_min": -16.5, "episode_len_max": 20, "weights_seq_no": 16.0, "episode_duration_sec_mean": 0.005215846233768389, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 80400, "env_reset_timer": 0.0005187625217366194, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": 1.75}, "time_between_sampling": 9.808126845776469}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "b7d62_00000", "date": "2025-08-11_18-40-11", "timestamp": 1754930411, "time_this_iter_s": 9.857092142105103, "time_total_s": 156.4070019721985, "pid": 11547, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1550f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 156.4070019721985, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 38.05714285714286, "ram_util_percent": 78.17142857142858}}
{"timers": {"training_iteration": 9.436332307972105, "restore_env_runners": 9.960415732163075e-06, "training_step": 9.43612229250374, "env_runner_sampling_timer": 1.6485942602838282, "learner_update_timer": 7.589238943972444, "synch_weights": 0.0014009783830292951, "restore_eval_env_runners": 3.966164151324534e-05, "evaluation_iteration": 0.12806891823737196, "synch_eval_env_connectors": 0.00014489468826578013, "synch_env_connectors": 4.643805724794946e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.7026369246782105e-06, "remove_single_ts_time_rank_from_batch": 1.2109949117264962e-05, "tensor_to_numpy": 1.552217073123206e-05, "get_actions": 4.0127578251538426e-05, "normalize_and_clip_actions": 8.179977228061964e-06, "listify_data_for_vector_env": 1.0851974338745851e-05}}, "connector_pipeline_timer": 0.00012023969937272943}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.353808227149946e-06, "numpy_to_tensor": 1.2790339308979183e-05, "add_observations_from_episodes_to_batch": 2.9617009471570104e-06, "add_states_from_episodes_to_batch": 2.817182768632848e-06, "batch_individual_items": 1.2858831881418818e-05}}, "connector_pipeline_timer": 6.140787079234684e-05}, "episode_duration_sec_mean": 0.005422570697031913, "episode_len_mean": 20.0, "sample": 0.005717240671399456, "num_episodes_lifetime": -462625.0, "episode_return_max": 12.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_episode_returns_mean": {"default_policy": 4.579999999999998}, "episode_len_min": 20, "time_between_sampling": 0.033746373639857975, "agent_episode_returns_mean": {"default_agent": 4.579999999999998}, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "rlmodule_inference_timer": 3.2604006364861785e-05, "episode_return_mean": 4.579999999999998, "num_env_steps_sampled_lifetime": -9252500.0, "env_reset_timer": 4.054169226675673e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -7.5, "env_step_timer": 1.4704796096355396e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "weights_seq_no": 16.0, "num_env_steps_sampled_lifetime_throughput": 3209.5704395946004}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15820272544619, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009282229166436529, "add_observations_from_episodes_to_batch": 0.0008849809984026215, "add_columns_from_episodes_to_train_batch": 0.04270466902164202, "add_time_dim_to_batch_and_zero_pad": 0.09139008560973724, "add_states_from_episodes_to_batch": 0.0036325212536156095, "batch_individual_items": 0.01007437232892163, "numpy_to_tensor": 7.782142771274566e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_kl_coeff": 1.2327875538176158e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 17.0, "entropy": 0.6749987602233887, "vf_explained_var": 0.00011712312698364258, "module_train_batch_size_mean": 998.0332888909784, "num_module_steps_trained_lifetime": 101745, "vf_loss": 0.32050788402557373, "use_intrinsic_rewards": 0.0, "policy_loss": -1.7869573639472947e-05, "vf_loss_unclipped": 42.295467376708984, "num_module_steps_trained": 5985, "total_loss": 0.2486325204372406, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 8.307191819767468e-06, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 746.6782022473478}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_explained_var": 0.0030173659324645996, "module_train_batch_size_mean": 997.4956760259092, "num_module_steps_trained_lifetime": 610470, "vf_loss": 0.3205358386039734, "use_intrinsic_rewards": 1.0, "policy_loss": -1.726522714307066e-05, "vf_loss_unclipped": 42.24897003173828, "num_module_steps_trained": 35910, "total_loss": 0.2486562877893448, "mean_kl_loss": 8.393083589908201e-06, "diff_num_grad_updates_vs_sampler_policy": 86.0, "entropy": 0.6749950051307678, "weights_seq_no": 102.0}, "intrinsic_reward_module": {"weights_seq_no": 102.0, "module_train_batch_size_mean": 997.4956760259092, "num_module_steps_trained": 35910, "total_loss": 0.0, "num_module_steps_trained_lifetime": 610470, "diff_num_grad_updates_vs_sampler_policy": 86.0}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 1220940, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 3672000, "num_env_steps_trained_lifetime_throughput": 50333.88941005974}}}, "intrinsic_reward_module": {"total_loss": 0.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 101745, "num_trainable_parameters": 8266, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "weights_seq_no": 17.0, "module_train_batch_size_mean": 998.0332888909784, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 746.6834712564538}, "__all_modules__": {"num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 612000, "num_module_steps_trained_lifetime": 203490, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 4494.730339406125, "num_module_steps_trained_throughput": 19847680.243138243, "num_module_steps_trained_lifetime_throughput": 12576485.355918525}, "IntrinsicAttentionMask": [[[0.16723044216632843, 0.1643521636724472, 0.16686873137950897, 0.16668815910816193, 0.1665077954530716, 0.1683526337146759], [0.1670871376991272, 0.16494084894657135, 0.16681794822216034, 0.16668350994586945, 0.1665491759777069, 0.16792139410972595], [0.1672125905752182, 0.16442552208900452, 0.16686242818832397, 0.16668760776519775, 0.16651298105716705, 0.16829882562160492], [0.16720367968082428, 0.16446219384670258, 0.16685928404331207, 0.16668733954429626, 0.16651558876037598, 0.16827192902565002], [0.16719473898410797, 0.16449886560440063, 0.16685611009597778, 0.16668705642223358, 0.1665181815624237, 0.16824501752853394], [0.16728554666042328, 0.16412582993507385, 0.16688816249370575, 0.16668982803821564, 0.16649173200130463, 0.16851893067359924]], [[0.1655147522687912, 0.16738508641719818, 0.16514967381954193, 0.16496743261814117, 0.1696242094039917, 0.1673588901758194], [0.1653309464454651, 0.16749800741672516, 0.16490839421749115, 0.164697527885437, 0.17009742558002472, 0.1674676388502121], [0.1655508428812027, 0.16736283898353577, 0.16519707441329956, 0.16502046585083008, 0.16953131556510925, 0.16733747720718384], [0.16556888818740845, 0.16735172271728516, 0.16522076725959778, 0.16504698991775513, 0.16948488354682922, 0.16732677817344666], [0.16511334478855133, 0.167631134390831, 0.16462303698062897, 0.16437841951847076, 0.17065824568271637, 0.16759581863880157], [0.16533350944519043, 0.1674964278936386, 0.16491176187992096, 0.16470128297805786, 0.17009083926677704, 0.16746613383293152]], [[0.16252580285072327, 0.16621793806552887, 0.16815024614334106, 0.1680118441581726, 0.1658078283071518, 0.16928637027740479], [0.16019506752490997, 0.16594929993152618, 0.1689901351928711, 0.1687716543674469, 0.16530649363994598, 0.17078739404678345], [0.15900537371635437, 0.1658076047897339, 0.16942019760608673, 0.16916023194789886, 0.16504549980163574, 0.171561136841774], [0.15908992290496826, 0.1658177673816681, 0.16938959062099457, 0.16913259029388428, 0.16506415605545044, 0.17150597274303436], [0.16045019030570984, 0.1659792810678482, 0.16889803111553192, 0.16868838667869568, 0.16536200046539307, 0.17062214016914368], [0.15831522643566132, 0.16572394967079163, 0.16967010498046875, 0.1693858653306961, 0.16489249467849731, 0.1720123589038849]], [[0.16795238852500916, 0.16723927855491638, 0.16546514630317688, 0.1675116866827011, 0.16680045425891876, 0.16503098607063293], [0.16782933473587036, 0.1671847701072693, 0.16557998955249786, 0.16743101179599762, 0.1667879819869995, 0.16518700122833252], [0.1675209403038025, 0.16704782843589783, 0.16586782038211823, 0.16722863912582397, 0.16675634682178497, 0.16557839512825012], [0.16787639260292053, 0.16720561683177948, 0.1655360460281372, 0.16746187210083008, 0.16679275035858154, 0.16512730717658997], [0.16775333881378174, 0.1671510487794876, 0.165650874376297, 0.1673811674118042, 0.16678021848201752, 0.16528338193893433], [0.16744500398635864, 0.16701406240463257, 0.16593874990940094, 0.16717876493930817, 0.166748508810997, 0.16567490994930267]], [[0.16286307573318481, 0.16656287014484406, 0.16642576456069946, 0.16628877818584442, 0.16822189092636108, 0.16963766515254974], [0.16071894764900208, 0.16649200022220612, 0.166276752948761, 0.16606177389621735, 0.1691046804189682, 0.17134591937065125], [0.16079719364643097, 0.16649474203586578, 0.16628235578536987, 0.16607023775577545, 0.16907237470149994, 0.17128314077854156], [0.16087545454502106, 0.16649746894836426, 0.16628794372081757, 0.16607868671417236, 0.16904008388519287, 0.17122037708759308], [0.15977934002876282, 0.16645804047584534, 0.16620834171772003, 0.16595903038978577, 0.16949288547039032, 0.17210230231285095], [0.1589878797531128, 0.1664280891418457, 0.1661492884159088, 0.16587094962596893, 0.1698206067085266, 0.17274321615695953]], [[0.1675776094198227, 0.16907797753810883, 0.16509592533111572, 0.1649513989686966, 0.1686343252658844, 0.16466271877288818], [0.1677582710981369, 0.16956274211406708, 0.16478067636489868, 0.16460755467414856, 0.16902883350849152, 0.1642618328332901], [0.1672738492488861, 0.16826783120632172, 0.16562315821647644, 0.16552676260471344, 0.16797423362731934, 0.16533416509628296], [0.1672559529542923, 0.16822032630443573, 0.16565409302711487, 0.1655605435371399, 0.16793549060821533, 0.16537359356880188], [0.16770508885383606, 0.1694197952747345, 0.1648736298084259, 0.1647089272737503, 0.16891254484653473, 0.16437998414039612], [0.16722017526626587, 0.16812533140182495, 0.16571594774723053, 0.16562806069850922, 0.16785800457000732, 0.16545245051383972]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 6800}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0636035910694148e-05, "remove_single_ts_time_rank_from_batch": 1.2070935428920612e-05, "tensor_to_numpy": 1.569047610705617e-05, "get_actions": 3.8320022231181643e-05, "un_batch_to_individual_items": 6.706834977607257e-06, "normalize_and_clip_actions": 8.130944671740645e-06}}, "connector_pipeline_timer": 0.0001181988102401207}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9540388780926627e-06, "add_states_from_episodes_to_batch": 2.7985950838329915e-06, "batch_individual_items": 1.283679568042952e-05, "add_time_dim_to_batch_and_zero_pad": 7.235147672425681e-06, "numpy_to_tensor": 1.2380518792816198e-05}}, "connector_pipeline_timer": 6.069524615632823e-05}, "sample": 0.11821746359562087, "num_module_steps_sampled": {"default_policy": 400}, "rlmodule_inference_timer": 3.2674163790556306e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "env_step_timer": 1.4502663316208014e-05, "agent_episode_returns_mean": {"default_agent": 1.55}, "num_episodes": 20, "episode_len_mean": 20.0, "num_episodes_lifetime": 340, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_mean": 1.55, "episode_return_min": -16.5, "episode_len_max": 20, "weights_seq_no": 17.0, "episode_duration_sec_mean": 0.00537366621545516, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 85400, "env_reset_timer": 0.0005170507262453383, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": 1.55}, "time_between_sampling": 9.819258229408478}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "b7d62_00000", "date": "2025-08-11_18-40-22", "timestamp": 1754930422, "time_this_iter_s": 11.04000210762024, "time_total_s": 167.44700407981873, "pid": 11547, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1550f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 167.44700407981873, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 41.13333333333333, "ram_util_percent": 78.86666666666669}}
{"timers": {"training_iteration": 9.438026872392303, "restore_env_runners": 9.982891666228478e-06, "training_step": 9.437816884988338, "env_runner_sampling_timer": 1.6490180893508788, "learner_update_timer": 7.590475319952777, "synch_weights": 0.0013949369392680577, "restore_eval_env_runners": 3.9741685305026835e-05, "evaluation_iteration": 0.12821662655542007, "synch_eval_env_connectors": 0.0001492611616828908, "synch_env_connectors": 4.640697450330981e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 7.020484009130959e-06, "remove_single_ts_time_rank_from_batch": 1.2716329709238818e-05, "tensor_to_numpy": 1.676683107865111e-05, "get_actions": 4.493666053281962e-05, "normalize_and_clip_actions": 8.589951040593707e-06, "listify_data_for_vector_env": 1.1476025150334072e-05}}, "connector_pipeline_timer": 0.00012970367318434193}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.810193692856352e-06, "numpy_to_tensor": 1.4019359877494696e-05, "add_observations_from_episodes_to_batch": 3.1620016516890864e-06, "add_states_from_episodes_to_batch": 2.9436919017475337e-06, "batch_individual_items": 1.3640436871672969e-05}}, "connector_pipeline_timer": 6.54381346459721e-05}, "episode_duration_sec_mean": 0.005797047843225302, "episode_len_mean": 20.0, "sample": 0.006018800776672522, "num_episodes_lifetime": -493500.0, "episode_return_max": 12.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_episode_returns_mean": {"default_policy": 4.019999999999998}, "episode_len_min": 20, "time_between_sampling": 0.03806426274053533, "agent_episode_returns_mean": {"default_agent": 4.019999999999998}, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "rlmodule_inference_timer": 3.527892734351646e-05, "episode_return_mean": 4.019999999999998, "num_env_steps_sampled_lifetime": -9870000.0, "env_reset_timer": 4.5933831306026196e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -7.5, "env_step_timer": 1.5678088664413113e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "weights_seq_no": 17.0, "num_env_steps_sampled_lifetime_throughput": 2985.911778113101}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15814157777120322, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009276549375332893, "add_observations_from_episodes_to_batch": 0.0008847082676979435, "add_columns_from_episodes_to_train_batch": 0.04268930108079506, "add_time_dim_to_batch_and_zero_pad": 0.09137427433364491, "add_states_from_episodes_to_batch": 0.0036340422908405132, "batch_individual_items": 0.010049509436041418, "numpy_to_tensor": 7.765404346509091e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_kl_coeff": 6.163937769088079e-07, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 18.0, "entropy": 0.6738768815994263, "vf_explained_var": 0.00012093782424926758, "module_train_batch_size_mean": 998.0016398003509, "num_module_steps_trained_lifetime": 107730, "vf_loss": 0.32050782442092896, "use_intrinsic_rewards": 0.0, "policy_loss": -0.00010506589023862034, "vf_loss_unclipped": 42.27214431762695, "num_module_steps_trained": 5985, "total_loss": 0.2485470324754715, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 1.9609331502579153e-05, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 743.958274515495}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_explained_var": 0.0030219554901123047, "module_train_batch_size_mean": 997.4947003847115, "num_module_steps_trained_lifetime": 646380, "vf_loss": 0.3205361068248749, "use_intrinsic_rewards": 1.0, "policy_loss": -0.0001034173255902715, "vf_loss_unclipped": 42.214332580566406, "num_module_steps_trained": 35910, "total_loss": 0.24857379496097565, "mean_kl_loss": 1.9205090211471543e-05, "diff_num_grad_updates_vs_sampler_policy": 91.0, "entropy": 0.6738896369934082, "weights_seq_no": 108.0}, "intrinsic_reward_module": {"weights_seq_no": 108.0, "module_train_batch_size_mean": 997.4947003847115, "num_module_steps_trained": 35910, "total_loss": 0.0, "num_module_steps_trained_lifetime": 646380, "diff_num_grad_updates_vs_sampler_policy": 91.0}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 1292760, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 3888000, "num_env_steps_trained_lifetime_throughput": 49552.769136464216}}}, "intrinsic_reward_module": {"total_loss": 0.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 107730, "num_trainable_parameters": 8266, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "weights_seq_no": 18.0, "module_train_batch_size_mean": 998.0016398003509, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 743.9631019340471}, "__all_modules__": {"num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 648000, "num_module_steps_trained_lifetime": 215460, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 4478.236713344456, "num_module_steps_trained_throughput": 19449277.81627962, "num_module_steps_trained_lifetime_throughput": 12559137.468577515}, "IntrinsicAttentionMask": [[[0.16768226027488708, 0.16479621827602386, 0.1646178960800171, 0.16713851690292358, 0.16695766150951385, 0.1688074916601181], [0.16742368042469025, 0.16527307033538818, 0.16513986885547638, 0.16701921820640564, 0.1668846160173416, 0.1682596057653427], [0.16740751266479492, 0.1653027981519699, 0.16517242789268494, 0.16701173782348633, 0.16688001155853271, 0.1682254523038864], [0.16763392090797424, 0.16488538682460785, 0.1647154837846756, 0.16711626946926117, 0.16694405674934387, 0.16870492696762085], [0.1676177829504013, 0.16491509974002838, 0.16474801301956177, 0.16710881888866425, 0.16693951189517975, 0.16867072880268097], [0.1677817404270172, 0.16461265087127686, 0.16441701352596283, 0.1671842634677887, 0.16698557138442993, 0.16901879012584686]], [[0.16758187115192413, 0.1668703407049179, 0.1651001274585724, 0.16714215278625488, 0.16863861680030823, 0.16466690599918365], [0.16749462485313416, 0.16685134172439575, 0.165249764919281, 0.16709710657596588, 0.1684495359659195, 0.16485756635665894], [0.16727571189403534, 0.1668032854795456, 0.16562500596046448, 0.16698382794857025, 0.16797609627246857, 0.165336012840271], [0.16752800345420837, 0.16685862839221954, 0.16519251465797424, 0.16711434721946716, 0.16852185130119324, 0.16478464007377625], [0.16771064698696136, 0.1668982058763504, 0.16487909853458405, 0.1672084927558899, 0.16891813278198242, 0.16438543796539307], [0.16722173988819122, 0.16679136455059052, 0.1657174974679947, 0.1669558584690094, 0.16785958409309387, 0.16545401513576508]], [[0.16813956201076508, 0.1679576188325882, 0.16506683826446533, 0.16488823294639587, 0.16741298139095306, 0.16653473675251007], [0.16811609268188477, 0.16793707013130188, 0.16509227454662323, 0.16491647064685822, 0.16740116477012634, 0.16653691232204437], [0.16773977875709534, 0.16760748624801636, 0.16550025343894958, 0.16536971926689148, 0.16721123456954956, 0.1665715128183365], [0.16771632432937622, 0.16758693754673004, 0.16552571952342987, 0.1653980165719986, 0.16719937324523926, 0.1665736585855484], [0.16804568469524384, 0.16787542402744293, 0.16516858339309692, 0.16500122845172882, 0.1673656702041626, 0.16654343903064728], [0.1679316610097885, 0.16777555644512177, 0.1652921587228775, 0.16513851284980774, 0.16730815172195435, 0.16655395925045013]], [[0.16751869022846222, 0.1664128601551056, 0.16706256568431854, 0.1668349653482437, 0.16916586458683014, 0.16300499439239502], [0.16746681928634644, 0.1664290428161621, 0.16703882813453674, 0.16682521998882294, 0.16901187598705292, 0.16322819888591766], [0.16749735176563263, 0.16641953587532043, 0.16705280542373657, 0.16683097183704376, 0.1691024750471115, 0.1630968600511551], [0.16748666763305664, 0.16642284393310547, 0.1670479029417038, 0.1668289601802826, 0.169070765376091, 0.16314280033111572], [0.16759522259235382, 0.16638882458209991, 0.1670975387096405, 0.16684924066066742, 0.16939350962638855, 0.16267569363117218], [0.1673043966293335, 0.16647906601428986, 0.16696414351463318, 0.16679427027702332, 0.1685311645269394, 0.16392691433429718]], [[0.1618562787771225, 0.1675954908132553, 0.16745755076408386, 0.16731970012187958, 0.16718198359012604, 0.16858899593353271], [0.1576884686946869, 0.16839803755283356, 0.16813674569129944, 0.16787584125995636, 0.1676153540611267, 0.17028546333312988], [0.15778598189353943, 0.1683792918920517, 0.16812093555927277, 0.16786295175552368, 0.16760537028312683, 0.1702454537153244], [0.15788352489471436, 0.16836054623126984, 0.1681050956249237, 0.1678500473499298, 0.16759537160396576, 0.17020542919635773], [0.15798109769821167, 0.1683417558670044, 0.16808924078941345, 0.16783709824085236, 0.1675853431224823, 0.17016538977622986], [0.1569901704788208, 0.16853231191635132, 0.16825000941753387, 0.16796815395355225, 0.16768676042556763, 0.1705726683139801]], [[0.16525684297084808, 0.16784614324569702, 0.16659054160118103, 0.16648784279823303, 0.1675359457731247, 0.16628265380859375], [0.16426774859428406, 0.16867990791797638, 0.16653431951999664, 0.16635935008525848, 0.16814878582954407, 0.16600994765758514], [0.16474497318267822, 0.16827696561813354, 0.16656172275543213, 0.16642166674137115, 0.16785277426242828, 0.16614186763763428], [0.16478419303894043, 0.1682438850402832, 0.1665639579296112, 0.16642673313617706, 0.16782845556735992, 0.16615267097949982], [0.16438522934913635, 0.16858059167861938, 0.16654111444950104, 0.16637472808361053, 0.16807584464550018, 0.1660424768924713], [0.16486269235610962, 0.1681777834892273, 0.16656842827796936, 0.16643695533275604, 0.16777987778186798, 0.16617432236671448]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 7200}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.026559019474496e-05, "remove_single_ts_time_rank_from_batch": 1.1718954542920306e-05, "tensor_to_numpy": 1.4811651450811663e-05, "get_actions": 3.574793095537169e-05, "un_batch_to_individual_items": 6.496448003167691e-06, "normalize_and_clip_actions": 7.768405888492219e-06}}, "connector_pipeline_timer": 0.0001125034094046209}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.798825038027181e-06, "add_states_from_episodes_to_batch": 2.719239906230293e-06, "batch_individual_items": 1.2422442190208863e-05, "add_time_dim_to_batch_and_zero_pad": 7.03101484191612e-06, "numpy_to_tensor": 1.177857535678464e-05}}, "connector_pipeline_timer": 5.839343526480782e-05}, "sample": 0.11814844187923464, "num_module_steps_sampled": {"default_policy": 400}, "rlmodule_inference_timer": 3.0371372863378757e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "env_step_timer": 1.3951007829314819e-05, "agent_episode_returns_mean": {"default_agent": 1.35}, "num_episodes": 20, "episode_len_mean": 20.0, "num_episodes_lifetime": 360, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_mean": 1.35, "episode_return_min": -16.5, "episode_len_max": 20, "weights_seq_no": 18.0, "episode_duration_sec_mean": 0.005361174172721803, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 90400, "env_reset_timer": 0.0005127052194440759, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": 1.35}, "time_between_sampling": 9.817384424194554}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "b7d62_00000", "date": "2025-08-11_18-40-32", "timestamp": 1754930432, "time_this_iter_s": 9.725712299346924, "time_total_s": 177.17271637916565, "pid": 11547, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1550f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 177.17271637916565, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 40.65714285714286, "ram_util_percent": 78.27142857142856}}
{"timers": {"training_iteration": 9.441662846588802, "restore_env_runners": 9.940982864634749e-06, "training_step": 9.441453024048798, "env_runner_sampling_timer": 1.6479853709569867, "learner_update_timer": 7.595104330922335, "synch_weights": 0.0013886000690509703, "restore_eval_env_runners": 3.940551920940259e-05, "evaluation_iteration": 0.12810273195975103, "synch_eval_env_connectors": 0.00014882729968779593, "synch_env_connectors": 4.638040517923451e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.629401085970152e-06, "remove_single_ts_time_rank_from_batch": 1.1901687060967027e-05, "tensor_to_numpy": 1.535741781870203e-05, "get_actions": 3.954320799748154e-05, "normalize_and_clip_actions": 8.078868616406712e-06, "listify_data_for_vector_env": 1.0738477949381933e-05}}, "connector_pipeline_timer": 0.00011886477746123533}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.142564275686772e-06, "numpy_to_tensor": 1.2570034967082742e-05, "add_observations_from_episodes_to_batch": 2.8978036537664056e-06, "add_states_from_episodes_to_batch": 2.7754709920284977e-06, "batch_individual_items": 1.2675652864083416e-05}}, "connector_pipeline_timer": 6.060473647149432e-05}, "episode_duration_sec_mean": 0.005323721503838895, "episode_len_mean": 20.0, "sample": 0.005919639082235479, "num_episodes_lifetime": -524375.0, "episode_return_max": 12.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_episode_returns_mean": {"default_policy": 4.34}, "episode_len_min": 20, "time_between_sampling": 0.03314180305812602, "agent_episode_returns_mean": {"default_agent": 4.34}, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "rlmodule_inference_timer": 3.2104351741247e-05, "episode_return_mean": 4.34, "num_env_steps_sampled_lifetime": -10487500.0, "env_reset_timer": 4.260444590099201e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -7.5, "env_step_timer": 1.4154605690496934e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "weights_seq_no": 18.0, "num_env_steps_sampled_lifetime_throughput": 3200.4905422560455}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15810263324377752, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009272538052153811, "add_observations_from_episodes_to_batch": 0.0008841945255410032, "add_columns_from_episodes_to_train_batch": 0.042690478910412895, "add_time_dim_to_batch_and_zero_pad": 0.09136326284011587, "add_states_from_episodes_to_batch": 0.0036352635381106555, "batch_individual_items": 0.01002408226135999, "numpy_to_tensor": 7.769042307368497e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_kl_coeff": 3.0819688845440396e-07, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 19.0, "entropy": 0.6724927425384521, "vf_explained_var": 0.0001264810562133789, "module_train_batch_size_mean": 997.9718428097785, "num_module_steps_trained_lifetime": 113715, "vf_loss": 0.32050788402557373, "use_intrinsic_rewards": 0.0, "policy_loss": -0.000305063120322302, "vf_loss_unclipped": 42.29513931274414, "num_module_steps_trained": 5985, "total_loss": 0.24834918975830078, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 2.1650845155818388e-05, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 741.1548611037749}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_explained_var": 0.00304257869720459, "module_train_batch_size_mean": 997.4940209352853, "num_module_steps_trained_lifetime": 682290, "vf_loss": 0.32053616642951965, "use_intrinsic_rewards": 1.0, "policy_loss": -0.0002944311127066612, "vf_loss_unclipped": 42.248497009277344, "num_module_steps_trained": 35910, "total_loss": 0.2483849972486496, "mean_kl_loss": 2.003281952056568e-05, "diff_num_grad_updates_vs_sampler_policy": 96.0, "entropy": 0.6725432276725769, "weights_seq_no": 114.0}, "intrinsic_reward_module": {"weights_seq_no": 114.0, "module_train_batch_size_mean": 997.4940209352853, "num_module_steps_trained": 35910, "total_loss": 0.0, "num_module_steps_trained_lifetime": 682290, "diff_num_grad_updates_vs_sampler_policy": 96.0}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 1364580, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 4104000, "num_env_steps_trained_lifetime_throughput": 48805.83136961607}}}, "intrinsic_reward_module": {"total_loss": 0.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 113715, "num_trainable_parameters": 8266, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "weights_seq_no": 19.0, "module_train_batch_size_mean": 997.9718428097785, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 741.1592880642805}, "__all_modules__": {"num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 684000, "num_module_steps_trained_lifetime": 227430, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 4461.249766455745, "num_module_steps_trained_throughput": 19074408.89317011, "num_module_steps_trained_lifetime_throughput": 12546438.330340812}, "IntrinsicAttentionMask": [[[0.16678057610988617, 0.16660010814666748, 0.1664198338985443, 0.16623975336551666, 0.16605986654758453, 0.16789975762367249], [0.1667787879705429, 0.16660121083259583, 0.16642379760742188, 0.16624657809734344, 0.16606955230236053, 0.1678800880908966], [0.16677699983119965, 0.1666022688150406, 0.16642774641513824, 0.16625338792800903, 0.16607922315597534, 0.16786040365695953], [0.166775181889534, 0.16660334169864655, 0.16643166542053223, 0.16626018285751343, 0.16608886420726776, 0.16784070432186127], [0.16677339375019073, 0.1666044145822525, 0.1664356142282486, 0.16626699268817902, 0.16609853506088257, 0.1678210347890854], [0.16679167747497559, 0.16659346222877502, 0.16639547049999237, 0.16619771718978882, 0.16600020229816437, 0.16802142560482025]], [[0.1655111461877823, 0.16810442507266998, 0.1668468862771988, 0.16520525515079498, 0.16779375076293945, 0.1665385365486145], [0.16469740867614746, 0.16912111639976501, 0.1669699251651764, 0.16417881846427917, 0.16858859360218048, 0.16644416749477386], [0.16509036719799042, 0.1686297506093979, 0.16691091656684875, 0.16467420756816864, 0.168204665184021, 0.16649016737937927], [0.1656080037355423, 0.16798363626003265, 0.16683202981948853, 0.16532759368419647, 0.1676992028951645, 0.16654953360557556], [0.1647941917181015, 0.16899998486042023, 0.16695542633533478, 0.16430076956748962, 0.16849398612976074, 0.16645555198192596], [0.16518718004226685, 0.16850878298282623, 0.166896253824234, 0.16479633748531342, 0.16811008751392365, 0.16650137305259705]], [[0.16286307573318481, 0.16656287014484406, 0.16642576456069946, 0.16628877818584442, 0.16822189092636108, 0.16963766515254974], [0.16071894764900208, 0.16649198532104492, 0.1662767380475998, 0.16606177389621735, 0.169104665517807, 0.17134591937065125], [0.16079717874526978, 0.16649474203586578, 0.16628234088420868, 0.16607022285461426, 0.16907235980033875, 0.17128314077854156], [0.16087545454502106, 0.16649746894836426, 0.16628794372081757, 0.16607867181301117, 0.16904006898403168, 0.17122037708759308], [0.15977932512760162, 0.16645804047584534, 0.16620834171772003, 0.16595903038978577, 0.16949288547039032, 0.17210230231285095], [0.1589878797531128, 0.1664280891418457, 0.1661492884159088, 0.16587094962596893, 0.16982059180736542, 0.17274321615695953]], [[0.16597725450992584, 0.16785280406475067, 0.1656111478805542, 0.16819754242897034, 0.16729776561260223, 0.1650635153055191], [0.16586719453334808, 0.16804127395153046, 0.1654432713985443, 0.1684413105249405, 0.16739748418331146, 0.1648094356060028], [0.16599884629249573, 0.16781575977802277, 0.16564412415027618, 0.1681496500968933, 0.16727814078330994, 0.16511346399784088], [0.1658470779657364, 0.16807569563388824, 0.16541261970996857, 0.1684858351945877, 0.16741567850112915, 0.16476306319236755], [0.16589964926242828, 0.167985737323761, 0.16549277305603027, 0.16836944222450256, 0.1673681139945984, 0.1648843139410019], [0.16603125631809235, 0.1677602082490921, 0.16569359600543976, 0.16807782649993896, 0.1672487109899521, 0.16518840193748474]], [[0.16768530011177063, 0.16750384867191315, 0.16732260584831238, 0.1644427478313446, 0.1669606864452362, 0.16608481109142303], [0.16766908764839172, 0.16749054193496704, 0.16731218993663788, 0.16447797417640686, 0.16695605218410492, 0.166094109416008], [0.16765287518501282, 0.16747723519802094, 0.16730178892612457, 0.1645132154226303, 0.16695141792297363, 0.16610342264175415], [0.16739292442798615, 0.16726379096508026, 0.16713474690914154, 0.16507908701896667, 0.16687697172164917, 0.16625246405601501], [0.1676204651594162, 0.16745062172412872, 0.16728097200393677, 0.1645837128162384, 0.16694216430187225, 0.16612203419208527], [0.1675417125225067, 0.1673859804868698, 0.16723039746284485, 0.16475506126880646, 0.16691964864730835, 0.16616719961166382]], [[0.16525684297084808, 0.16784614324569702, 0.16659054160118103, 0.16648784279823303, 0.1675359457731247, 0.16628265380859375], [0.16426774859428406, 0.16867990791797638, 0.16653431951999664, 0.16635935008525848, 0.16814878582954407, 0.16600994765758514], [0.16474497318267822, 0.16827696561813354, 0.16656172275543213, 0.16642166674137115, 0.16785277426242828, 0.16614186763763428], [0.16478420794010162, 0.1682438999414444, 0.1665639579296112, 0.16642674803733826, 0.16782847046852112, 0.166152685880661], [0.16438522934913635, 0.16858059167861938, 0.16654111444950104, 0.16637472808361053, 0.16807584464550018, 0.1660424768924713], [0.16486269235610962, 0.1681777834892273, 0.16656842827796936, 0.16643695533275604, 0.16777987778186798, 0.16617432236671448]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 7600}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0332303283687938e-05, "remove_single_ts_time_rank_from_batch": 1.1860769816305267e-05, "tensor_to_numpy": 1.4739498252894048e-05, "get_actions": 3.611797898477483e-05, "un_batch_to_individual_items": 6.539118127833523e-06, "normalize_and_clip_actions": 7.811635169926545e-06}}, "connector_pipeline_timer": 0.00011299004375481627}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.790441304120256e-06, "add_states_from_episodes_to_batch": 2.7528873782374717e-06, "batch_individual_items": 1.2464464781876936e-05, "add_time_dim_to_batch_and_zero_pad": 7.03372278696825e-06, "numpy_to_tensor": 1.1640868824671328e-05}}, "connector_pipeline_timer": 5.839129239314676e-05}, "sample": 0.11808351329998645, "num_module_steps_sampled": {"default_policy": 400}, "rlmodule_inference_timer": 3.001801712812962e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "env_step_timer": 1.3676145941541696e-05, "agent_episode_returns_mean": {"default_agent": 0.95}, "num_episodes": 20, "episode_len_mean": 20.0, "num_episodes_lifetime": 380, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_mean": 0.95, "episode_return_min": -16.5, "episode_len_max": 20, "weights_seq_no": 19.0, "episode_duration_sec_mean": 0.0053599187615327535, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 95400, "env_reset_timer": 0.0005082835870563986, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": 0.95}, "time_between_sampling": 9.817444477033254}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "b7d62_00000", "date": "2025-08-11_18-40-42", "timestamp": 1754930442, "time_this_iter_s": 9.922073125839233, "time_total_s": 187.09478950500488, "pid": 11547, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1550f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 187.09478950500488, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 41.28571428571428, "ram_util_percent": 78.62857142857142}}
{"timers": {"training_iteration": 9.44196851271265, "restore_env_runners": 9.899902932989787e-06, "training_step": 9.44175887963846, "env_runner_sampling_timer": 1.6469564464178912, "learner_update_timer": 7.596290339272049, "synch_weights": 0.0013836465682739592, "restore_eval_env_runners": 3.9082714850879516e-05, "evaluation_iteration": 0.12799356631059916, "synch_eval_env_connectors": 0.00014854235715744174, "synch_env_connectors": 4.632910717880372e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.606159883886018e-06, "remove_single_ts_time_rank_from_batch": 1.191074392032601e-05, "tensor_to_numpy": 1.5294657797536072e-05, "get_actions": 3.927781948602235e-05, "normalize_and_clip_actions": 8.066014524230204e-06, "listify_data_for_vector_env": 1.0683970228638192e-05}}, "connector_pipeline_timer": 0.00011833410582661175}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.266481110631514e-06, "numpy_to_tensor": 1.2697064024026192e-05, "add_observations_from_episodes_to_batch": 2.882853316115168e-06, "add_states_from_episodes_to_batch": 2.7788346682737246e-06, "batch_individual_items": 1.269619405281078e-05}}, "connector_pipeline_timer": 6.0794137872791296e-05}, "episode_duration_sec_mean": 0.0053193335495889185, "episode_len_mean": 20.0, "sample": 0.005679715453618958, "num_episodes_lifetime": -555250.0, "episode_return_max": 12.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_episode_returns_mean": {"default_policy": 4.579999999999998}, "episode_len_min": 20, "time_between_sampling": 0.033987645305307845, "agent_episode_returns_mean": {"default_agent": 4.579999999999998}, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "rlmodule_inference_timer": 3.177352653933971e-05, "episode_return_mean": 4.579999999999998, "num_env_steps_sampled_lifetime": -11105000.0, "env_reset_timer": 3.7157221066342895e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_min": -7.5, "env_step_timer": 1.4086407794710084e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "weights_seq_no": 19.0, "num_env_steps_sampled_lifetime_throughput": 3242.5421148406695}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15810903691141207, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00927245225246693, "add_observations_from_episodes_to_batch": 0.0008839742501256608, "add_columns_from_episodes_to_train_batch": 0.04269653912240013, "add_time_dim_to_batch_and_zero_pad": 0.09137658229088602, "add_states_from_episodes_to_batch": 0.003638438402777829, "batch_individual_items": 0.010008423108399224, "numpy_to_tensor": 7.771434799086813e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_kl_coeff": 1.5409844422720198e-07, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 20.0, "entropy": 0.6715964674949646, "vf_explained_var": 0.00018870830535888672, "module_train_batch_size_mean": 997.9437895346426, "num_module_steps_trained_lifetime": 119700, "vf_loss": 0.32050788402557373, "use_intrinsic_rewards": 0.0, "policy_loss": -0.0003155666054226458, "vf_loss_unclipped": 42.27950668334961, "num_module_steps_trained": 5985, "total_loss": 0.24834008514881134, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 1.9936462194891647e-05, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 738.7677151427725}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"vf_explained_var": 0.002971649169921875, "module_train_batch_size_mean": 997.4935477577241, "num_module_steps_trained_lifetime": 718200, "vf_loss": 0.3205362856388092, "use_intrinsic_rewards": 1.0, "policy_loss": -0.00030218748725019395, "vf_loss_unclipped": 42.18549346923828, "num_module_steps_trained": 35910, "total_loss": 0.2483784705400467, "mean_kl_loss": 1.828197855502367e-05, "diff_num_grad_updates_vs_sampler_policy": 101.0, "entropy": 0.6716517806053162, "weights_seq_no": 120.0}, "intrinsic_reward_module": {"weights_seq_no": 120.0, "module_train_batch_size_mean": 997.4935477577241, "num_module_steps_trained": 35910, "total_loss": 0.0, "num_module_steps_trained_lifetime": 718200, "diff_num_grad_updates_vs_sampler_policy": 101.0}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 1436400, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 4320000, "num_env_steps_trained_lifetime_throughput": 48095.88597944773}}}, "intrinsic_reward_module": {"total_loss": 0.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime": 119700, "num_trainable_parameters": 8266, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0, "weights_seq_no": 20.0, "module_train_batch_size_mean": 997.9437895346426, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 738.7717313394028}, "__all_modules__": {"num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 720000, "num_module_steps_trained_lifetime": 239400, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 4446.774180000363, "num_module_steps_trained_throughput": 18728611.86160588, "num_module_steps_trained_lifetime_throughput": 12543538.410500962}, "IntrinsicAttentionMask": [[[0.16252608597278595, 0.16621822118759155, 0.16815051436424255, 0.16594469547271729, 0.167873814702034, 0.16928665339946747], [0.1601957231760025, 0.1659499853849411, 0.1689908355474472, 0.16552115976810455, 0.1685541570186615, 0.17078810930252075], [0.15900631248950958, 0.1658085733652115, 0.16942119598388672, 0.16530010104179382, 0.16890165209770203, 0.17156215012073517], [0.1603657454252243, 0.16596995294094086, 0.16892939805984497, 0.16555249691009521, 0.1685044914484024, 0.17067790031433105], [0.15917539596557617, 0.1658288538455963, 0.16935995221138, 0.16533173620700836, 0.16885223984718323, 0.17145179212093353], [0.15831635892391205, 0.16572514176368713, 0.16967131197452545, 0.165170356631279, 0.16910330951213837, 0.17201359570026398]], [[0.1657683104276657, 0.16681186854839325, 0.16710612177848816, 0.1654619425535202, 0.168054461479187, 0.16679729521274567], [0.1655128002166748, 0.16685239970684052, 0.16723056137561798, 0.1651199758052826, 0.16845060884952545, 0.16683368384838104], [0.16544103622436523, 0.16686372458934784, 0.16726547479629517, 0.16502399742603302, 0.16856196522712708, 0.16684383153915405], [0.16584362089633942, 0.16679984331130981, 0.16706939041614532, 0.16556280851364136, 0.16793778538703918, 0.16678649187088013], [0.16521066427230835, 0.1668998748064041, 0.16737738251686096, 0.16471600532531738, 0.16891981661319733, 0.16687622666358948], [0.16551634669303894, 0.16685183346271515, 0.1672288328409195, 0.16512472927570343, 0.16844508051872253, 0.16683316230773926]], [[0.16252809762954712, 0.1682911217212677, 0.1681526005268097, 0.16594673693180084, 0.16787588596343994, 0.16720561683177948], [0.1589287966489792, 0.16972260177135468, 0.1694592386484146, 0.16529153287410736, 0.16893376410007477, 0.1676640659570694], [0.15901313722133636, 0.1696888506412506, 0.16942846775054932, 0.1653072088956833, 0.16890889406204224, 0.167653426527977], [0.1603703647851944, 0.16914711892604828, 0.16893425583839417, 0.16555725038051605, 0.1685093492269516, 0.16748161613941193], [0.15918192267417908, 0.1696213334798813, 0.16936689615249634, 0.16533851623535156, 0.16885916888713837, 0.16763213276863098], [0.15959250926971436, 0.16945728659629822, 0.1692172735929489, 0.16541443765163422, 0.1687382310628891, 0.1675802618265152]], [[0.1668483167886734, 0.16834215819835663, 0.16655632853507996, 0.1642335206270218, 0.1679004281759262, 0.1661192774772644], [0.1668834537267685, 0.16867852210998535, 0.1665329486131668, 0.16374915838241577, 0.16814740002155304, 0.1660085916519165], [0.16684134304523468, 0.16827607154846191, 0.1665608435869217, 0.16432882845401764, 0.16785188019275665, 0.16614097356796265], [0.16678501665592194, 0.1677466630935669, 0.1665966808795929, 0.16509436070919037, 0.16746263206005096, 0.16631458699703217], [0.16687312722206116, 0.1685793399810791, 0.16653987765312195, 0.16389182209968567, 0.1680746078491211, 0.16604124009609222], [0.1668308973312378, 0.16817699372768402, 0.1665676385164261, 0.1644718497991562, 0.1677790880203247, 0.1661735475063324]], [[0.16252779960632324, 0.16829082369804382, 0.16815230250358582, 0.16801388561725616, 0.16580985486507416, 0.1672053337097168], [0.15892784297466278, 0.1697215735912323, 0.16945822536945343, 0.1691952794790268, 0.16503405570983887, 0.16766305267810822], [0.15901218354701996, 0.16968783736228943, 0.16942745447158813, 0.16916747391223907, 0.16505256295204163, 0.1676524430513382], [0.1590965986251831, 0.16965411603450775, 0.16939671337604523, 0.16913968324661255, 0.16507107019424438, 0.16764181852340698], [0.1604546755552292, 0.1691126525402069, 0.16890275478363037, 0.16869311034679413, 0.16536663472652435, 0.16747017204761505], [0.1595916897058487, 0.16945642232894897, 0.16921640932559967, 0.16897670924663544, 0.1651792973279953, 0.16757941246032715]], [[0.16751869022846222, 0.16641287505626678, 0.16706256568431854, 0.1668349802494049, 0.16916587948799133, 0.16300499439239502], [0.16746681928634644, 0.1664290428161621, 0.16703881323337555, 0.16682521998882294, 0.16901187598705292, 0.16322818398475647], [0.16749735176563263, 0.16641953587532043, 0.16705280542373657, 0.16683097183704376, 0.1691024750471115, 0.1630968451499939], [0.16748666763305664, 0.16642285883426666, 0.167047917842865, 0.1668289750814438, 0.1690707802772522, 0.16314280033111572], [0.16759520769119263, 0.16638882458209991, 0.1670975238084793, 0.16684924066066742, 0.16939350962638855, 0.16267569363117218], [0.1673043817281723, 0.16647906601428986, 0.16696414351463318, 0.16679427027702332, 0.1685311645269394, 0.16392691433429718]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 8000}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0206410939103899e-05, "remove_single_ts_time_rank_from_batch": 1.1637454972328838e-05, "tensor_to_numpy": 1.475522842343885e-05, "get_actions": 3.4938198688175955e-05, "un_batch_to_individual_items": 6.407566389106826e-06, "normalize_and_clip_actions": 7.706908940724813e-06}}, "connector_pipeline_timer": 0.00011127774229726096}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.792550484040142e-06, "add_states_from_episodes_to_batch": 2.7311045617005885e-06, "batch_individual_items": 1.2398376866910606e-05, "add_time_dim_to_batch_and_zero_pad": 7.062283995529612e-06, "numpy_to_tensor": 1.1646442219727325e-05}}, "connector_pipeline_timer": 5.839120931573492e-05}, "sample": 0.1180290889965884, "num_module_steps_sampled": {"default_policy": 400}, "rlmodule_inference_timer": 2.9873663455190228e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "env_step_timer": 1.3592666856884774e-05, "agent_episode_returns_mean": {"default_agent": 0.95}, "num_episodes": 20, "episode_len_mean": 20.0, "num_episodes_lifetime": 400, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_mean": 0.95, "episode_return_min": -16.5, "episode_len_max": 20, "weights_seq_no": 20.0, "episode_duration_sec_mean": 0.005313539613271132, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 100400, "env_reset_timer": 0.0005068590817194882, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": 0.95}, "time_between_sampling": 9.814276232673347}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "b7d62_00000", "date": "2025-08-11_18-40-51", "timestamp": 1754930451, "time_this_iter_s": 9.597049951553345, "time_total_s": 196.69183945655823, "pid": 11547, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1550f98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 196.69183945655823, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 38.550000000000004, "ram_util_percent": 78.67857142857143}}
