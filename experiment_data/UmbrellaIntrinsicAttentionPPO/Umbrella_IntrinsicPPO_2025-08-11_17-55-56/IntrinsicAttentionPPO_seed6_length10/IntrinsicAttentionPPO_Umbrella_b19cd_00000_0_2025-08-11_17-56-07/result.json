{"timers": {"training_iteration": 9.127641916973516, "restore_env_runners": 9.582960046827793e-06, "training_step": 9.127521750051528, "env_runner_sampling_timer": 1.6722724169958383, "learner_update_timer": 7.283565874909982, "synch_weights": 0.0008185419719666243}, "env_runners": {"env_to_module_sum_episodes_length_out": 10.191744832559449, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "env_reset_timer": 8.03933738176477e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.524063078873282e-05, "listify_data_for_vector_env": 1.1057847518706354e-05, "tensor_to_numpy": 1.6105944210151068e-05, "un_batch_to_individual_items": 7.417303237272067e-06, "remove_single_ts_time_rank_from_batch": 1.2497134176640206e-05, "normalize_and_clip_actions": 1.0375200513029931e-05}}, "connector_pipeline_timer": 0.00012974085572418936}, "episode_duration_sec_mean": 0.005415719143580645, "sample": 0.006403455493759347, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.8411844003810316e-06, "numpy_to_tensor": 1.3523769044638805e-05, "batch_individual_items": 1.307217633782144e-05, "add_observations_from_episodes_to_batch": 2.932909135436923e-06, "add_time_dim_to_batch_and_zero_pad": 7.163096023518204e-06}}, "connector_pipeline_timer": 6.350773477262423e-05}, "agent_episode_returns_mean": {"default_agent": 2.899999999999998}, "time_between_sampling": 0.0006650154984669188, "weights_seq_no": 0.0, "num_episodes_lifetime": 31375.0, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 2.899999999999998}, "env_to_module_sum_episodes_length_in": 10.191744832559449, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "episode_return_mean": 2.899999999999998, "episode_len_max": 20, "env_step_timer": 1.535331172293049e-05, "num_env_steps_sampled_lifetime": 627500.0, "episode_len_mean": 20.0, "rlmodule_inference_timer": 3.562015970530974e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime_throughput": 3053.778891423689}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000, "learner_connector": {"connector_pipeline_timer": 0.13504695799201727, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009062707889825106, "add_observations_from_episodes_to_batch": 0.000887917005456984, "add_columns_from_episodes_to_train_batch": 0.04193087504245341, "add_time_dim_to_batch_and_zero_pad": 0.07520033302716911, "add_states_from_episodes_to_batch": 0.0035345839569345117, "batch_individual_items": 0.004217208013869822, "numpy_to_tensor": 6.254203617572784e-05}}}, "learner_connector_sum_episodes_length_out": 5250}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 6.0, "module_train_batch_size_mean": 997.8474438281662, "total_loss": 0.0, "weights_seq_no": 6.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 35910}, "default_policy": {"module_train_batch_size_mean": 997.8474438281662, "mean_kl_loss": 4.407949290907709e-06, "weights_seq_no": 6.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 35910, "diff_num_grad_updates_vs_sampler_policy": 6.0, "use_intrinsic_rewards": 1.0, "entropy": 0.6836696267127991, "vf_loss_unclipped": 44.27152633666992, "vf_explained_var": 0.0034554004669189453, "policy_loss": -2.0808489352930337e-05, "total_loss": 0.27812936902046204, "vf_loss": 0.3583904504776001}, "__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 71820, "num_env_steps_trained_lifetime": 198000, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 60934.26464834367}}}, "default_policy": {"curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.35831788182258606, "mean_kl_loss": 4.290740889700828e-06, "num_module_steps_trained_lifetime": 5985, "module_train_batch_size_mean": 997.9705930399, "weights_seq_no": 1.0, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 16595, "use_intrinsic_rewards": 0.0, "entropy": 0.6836762428283691, "vf_loss_unclipped": 44.22529602050781, "vf_explained_var": 0.004030346870422363, "curr_kl_coeff": 0.08079196512699127, "policy_loss": -2.2469632313004695e-05, "total_loss": 0.2780711352825165, "num_module_steps_trained_lifetime_throughput": 829.5896569340651}, "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 997.9705930399, "weights_seq_no": 1.0, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 829.6062959146988}, "__all_modules__": {"num_env_steps_trained_lifetime": 33000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 33000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4576.1889197848095, "num_module_steps_trained_throughput": 31491796.91808456, "num_module_steps_trained_lifetime_throughput": 13186076.55829014}, "IntrinsicAttentionMask": [[[0.09125632047653198, 0.09054308384656906, 0.09098507463932037, 0.09083761274814606, 0.09079337120056152, 0.09064622968435287, 0.09091521054506302, 0.09111464023590088, 0.09096697717905045, 0.09092266857624054, 0.09101877361536026], [0.09158679842948914, 0.0901966392993927, 0.09105689078569412, 0.0907694548368454, 0.09068328887224197, 0.09039703011512756, 0.09092065691947937, 0.09130983799695969, 0.0910215973854065, 0.09093519300222397, 0.09112264961004257], [0.09138160198926926, 0.09041153639554977, 0.09101235866546631, 0.09081179648637772, 0.09075163304805756, 0.09055165201425552, 0.09091732650995255, 0.0911886915564537, 0.09098774194717407, 0.09092746675014496, 0.09105821698904037], [0.09144990891218185, 0.09033991396427155, 0.09102720022201538, 0.09079770743846893, 0.09072887897491455, 0.0905001312494278, 0.09091844409704208, 0.09122903645038605, 0.09099902957677841, 0.09093005210161209, 0.09107968956232071], [0.09147043526172638, 0.09031841158866882, 0.09103165566921234, 0.09079346805810928, 0.09072203934192657, 0.09048465639352798, 0.09091877937316895, 0.09124115854501724, 0.09100241959095001, 0.09093082696199417, 0.09108613431453705], [0.09153879433870316, 0.09024684876203537, 0.09104648977518082, 0.0907793641090393, 0.09069927781820297, 0.09043316543102264, 0.09091988950967789, 0.09128151088953018, 0.09101369231939316, 0.09093339741230011, 0.09110759943723679], [0.0914139449596405, 0.09037761390209198, 0.0910193920135498, 0.09080512076616287, 0.0907408595085144, 0.0905272513628006, 0.09091785550117493, 0.09120780229568481, 0.09099308401346207, 0.09092868864536285, 0.09106837958097458], [0.09132169932126999, 0.09047441184520721, 0.09099932760000229, 0.09082414954900742, 0.09077159315347672, 0.09059686213731766, 0.09091632068157196, 0.09115330129861832, 0.09097782522439957, 0.0909251868724823, 0.09103937447071075], [0.0913899689912796, 0.090402752161026, 0.09101417660713196, 0.09081006050109863, 0.09074883908033371, 0.09054532647132874, 0.09091745316982269, 0.09119363129138947, 0.0909891203045845, 0.09092777967453003, 0.09106084704399109], [0.09141049534082413, 0.09038124233484268, 0.09101863950490952, 0.09080583602190018, 0.09074201434850693, 0.09052985906600952, 0.09091780334711075, 0.09120576083660126, 0.0909925177693367, 0.0909285619854927, 0.09106729924678802], [0.0913660004734993, 0.09042789041996002, 0.09100895375013351, 0.0908150002360344, 0.09075682610273361, 0.09056340157985687, 0.09091705828905106, 0.09117946773767471, 0.09098514914512634, 0.09092686325311661, 0.0910532996058464]], [[0.09072951972484589, 0.09050171077251434, 0.09060218185186386, 0.09081091731786728, 0.09058290719985962, 0.0906834676861763, 0.09071057289838791, 0.09091956913471222, 0.09269334375858307, 0.09088289737701416, 0.09088289737701416], [0.09067942947149277, 0.09038905799388885, 0.0905170887708664, 0.09078323096036911, 0.09049252420663834, 0.09062070399522781, 0.09065527468919754, 0.09092181921005249, 0.09319083392620087, 0.0908750370144844, 0.0908750370144844], [0.09070156514644623, 0.09043879061937332, 0.09055466204881668, 0.09079547971487045, 0.09053242951631546, 0.09064842760562897, 0.09067970514297485, 0.09092085063457489, 0.09297098219394684, 0.09087854623794556, 0.09087854623794556], [0.09074733406305313, 0.09054186195135117, 0.09063248336315155, 0.09082073718309402, 0.09061510115861893, 0.09070579707622528, 0.09073024243116379, 0.09091869741678238, 0.0925164669752121, 0.09088563919067383, 0.09088563919067383], [0.09069732576608658, 0.09042925387620926, 0.09054746478796005, 0.09079313278198242, 0.09052478522062302, 0.09064312279224396, 0.09067502617835999, 0.09092104434967041, 0.09301310777664185, 0.09087787568569183, 0.09087787568569183], [0.09071941673755646, 0.09047896414995193, 0.09058500826358795, 0.09080534428358078, 0.09056466072797775, 0.09067080169916153, 0.09069941937923431, 0.09092003852128983, 0.09279362857341766, 0.0908813327550888, 0.0908813327550888], [0.090725377202034, 0.0904923602938652, 0.09059511870145798, 0.09080863744020462, 0.09057540446519852, 0.09067826718091965, 0.0907059982419014, 0.09091977030038834, 0.09273459017276764, 0.09088226407766342, 0.09088226407766342], [0.09077102690935135, 0.09059536457061768, 0.09067285060882568, 0.09083376824855804, 0.09065798670053482, 0.090735524892807, 0.09075642377138138, 0.09091749042272568, 0.09228110313415527, 0.09088923782110214, 0.09088923782110214], [0.09114610403776169, 0.09145569801330566, 0.09131893515586853, 0.09103593230247498, 0.09134514629840851, 0.0912085548043251, 0.09117178618907928, 0.09088923037052155, 0.08855122327804565, 0.09093869477510452, 0.09093869477510452], [0.09076303243637085, 0.09057731181383133, 0.0906592309474945, 0.09082937240600586, 0.0906435176730156, 0.09072549641132355, 0.09074759483337402, 0.09091790020465851, 0.09236043691635132, 0.09088802337646484, 0.09088802337646484], [0.09076303243637085, 0.09057731181383133, 0.0906592309474945, 0.09082937240600586, 0.0906435176730156, 0.09072549641132355, 0.09074759483337402, 0.09091790020465851, 0.09236043691635132, 0.09088802337646484, 0.09088802337646484]], [[0.09068715572357178, 0.09081409871578217, 0.09107795357704163, 0.09056083112955093, 0.09114661812782288, 0.0909510925412178, 0.09066327661275864, 0.0912497267127037, 0.09105397760868073, 0.09099525213241577, 0.09080004692077637], [0.09070857614278793, 0.09082328528165817, 0.09106165915727615, 0.09059441834688187, 0.09112368524074554, 0.09094705432653427, 0.09068699926137924, 0.0912168100476265, 0.0910400003194809, 0.0909869521856308, 0.09081058949232101], [0.09075300395488739, 0.09084232151508331, 0.09102785587310791, 0.0906640812754631, 0.09107612073421478, 0.09093867242336273, 0.09073620289564133, 0.09114855527877808, 0.09101100265979767, 0.09096971899271011, 0.0908324345946312], [0.090665802359581, 0.09080493450164795, 0.09109418839216232, 0.09052737802267075, 0.09116947650909424, 0.09095510095357895, 0.0906396359205246, 0.09128253161907196, 0.09106789529323578, 0.09100352227687836, 0.09078953415155411], [0.09076455235481262, 0.09084726870059967, 0.09101908653974533, 0.09068220108747482, 0.09106376767158508, 0.09093649685382843, 0.09074898809194565, 0.09113083779811859, 0.09100347012281418, 0.09096524864435196, 0.09083811938762665], [0.0907316654920578, 0.09083317965269089, 0.0910440981388092, 0.09063061326742172, 0.09109897166490555, 0.09094270318746567, 0.09071256220340729, 0.09118134528398514, 0.09102493524551392, 0.09097800403833389, 0.09082193672657013], [0.09068311750888824, 0.09081237018108368, 0.09108102321624756, 0.09055452048778534, 0.09115093946456909, 0.09095185250043869, 0.09065881371498108, 0.09125592559576035, 0.09105660021305084, 0.09099681675434113, 0.09079806506633759], [0.09078186005353928, 0.09085468202829361, 0.09100589901208878, 0.09070935100317001, 0.09104522317647934, 0.09093321859836578, 0.09076815843582153, 0.09110424667596817, 0.09099216759204865, 0.09095852822065353, 0.09084662050008774], [0.09074898064136505, 0.09084060043096542, 0.09103093296289444, 0.09065777063369751, 0.0910804346203804, 0.09093943983316422, 0.09073173999786377, 0.09115475416183472, 0.09101364016532898, 0.09097129106521606, 0.09083046019077301], [0.09073909372091293, 0.09083636105060577, 0.09103843569755554, 0.09064226597547531, 0.09109100699424744, 0.09094129502773285, 0.09072078764438629, 0.09116992354393005, 0.09102008491754532, 0.09097512066364288, 0.09082559496164322], [0.09070620685815811, 0.0908222645521164, 0.0910634696483612, 0.0905907079577446, 0.0911262258887291, 0.09094750881195068, 0.09068437665700912, 0.09122045338153839, 0.09104155004024506, 0.09098787605762482, 0.0908094272017479]], [[0.09082268923521042, 0.09059464186429977, 0.09069521725177765, 0.09090416878461838, 0.09067592024803162, 0.09052158892154694, 0.09080372005701065, 0.09075727313756943, 0.09252788126468658, 0.09072066843509674, 0.09097622334957123], [0.09079834073781967, 0.09050758928060532, 0.09063579142093658, 0.09090227633714676, 0.09061118960380554, 0.09041448682546616, 0.09077414870262146, 0.09071491658687592, 0.09297876805067062, 0.09066824615001678, 0.0909942090511322], [0.09080912172794342, 0.09054602682590485, 0.09066203981637955, 0.090903140604496, 0.09063978493213654, 0.09046176820993423, 0.09078723192214966, 0.09073363244533539, 0.09277953952550888, 0.09069141000509262, 0.09098630398511887], [0.09083131700754166, 0.09062565118074417, 0.09071636199951172, 0.09090478718280792, 0.0906989574432373, 0.09055976569652557, 0.09081421047449112, 0.09077233076095581, 0.09236752241849899, 0.09073932468891144, 0.0909697562456131], [0.09080705791711807, 0.09053865820169449, 0.09065701067447662, 0.09090298414230347, 0.0906343013048172, 0.09045270085334778, 0.09078472852706909, 0.09073004126548767, 0.09281771630048752, 0.09068696945905685, 0.09098781645298004], [0.09079047292470932, 0.09047961980104446, 0.09061668068170547, 0.09090161323547363, 0.09059038013219833, 0.09038009494543076, 0.0907646119594574, 0.09070127457380295, 0.09312386065721512, 0.09065137803554535, 0.09099993109703064], [0.09082067757844925, 0.09058742225170135, 0.09069029241800308, 0.09090402722358704, 0.09067055583000183, 0.0905127003788948, 0.09080127626657486, 0.09075376391410828, 0.09256526827812195, 0.09071632474660873, 0.0909777283668518], [0.09081573784351349, 0.09056970477104187, 0.09067820012569427, 0.09090365469455719, 0.09065739065408707, 0.0904908999800682, 0.09079527109861374, 0.09074515104293823, 0.09265691041946411, 0.09070567041635513, 0.09098140150308609], [0.09099586308002472, 0.09123414754867554, 0.09112890809774399, 0.09091101586818695, 0.09114907681941986, 0.09131073951721191, 0.09101563692092896, 0.09106409549713135, 0.08925207704305649, 0.09110230952501297, 0.09083611518144608], [0.0908118337392807, 0.09055574238300323, 0.0906686782836914, 0.09090335667133331, 0.09064700454473495, 0.0904737263917923, 0.0907905325293541, 0.09073836356401443, 0.09272921085357666, 0.0906972587108612, 0.0909842997789383], [0.09083891659975052, 0.09065303951501846, 0.09073502570390701, 0.09090530872344971, 0.0907192975282669, 0.09059347957372665, 0.0908234566450119, 0.09078560769557953, 0.092226043343544, 0.09075577557086945, 0.09096400439739227]], [[0.09132297337055206, 0.09060921519994736, 0.09105152636766434, 0.09066081047058105, 0.09085968881845474, 0.09095572680234909, 0.09073825925588608, 0.0911811888217926, 0.09078992158174515, 0.09098907560110092, 0.0908416137099266], [0.09171716123819351, 0.09032502770423889, 0.09118650108575821, 0.09042531251907349, 0.09081237018108368, 0.09099957346916199, 0.0905759409070015, 0.09143980592489243, 0.09067649394273758, 0.09106463193893433, 0.09077717363834381], [0.09147237241268158, 0.0905013456940651, 0.09110276401042938, 0.09057144075632095, 0.09084177762269974, 0.0909724086523056, 0.0906766951084137, 0.0912792757153511, 0.0907469242811203, 0.09101778268814087, 0.09081721305847168], [0.09168852120637894, 0.09034562855958939, 0.09117671847343445, 0.09044238924980164, 0.09081581979990005, 0.0909964069724083, 0.09058772027492523, 0.09142103046178818, 0.09068473428487778, 0.09105916321277618, 0.09078186005353928], [0.09157833456993103, 0.09042495489120483, 0.0911390408873558, 0.09050813317298889, 0.09082905948162079, 0.09098418802022934, 0.09063305705785751, 0.0913487896323204, 0.09071643650531769, 0.09103809297084808, 0.09079988300800323], [0.09152524918317795, 0.09046321362257004, 0.0911208763718605, 0.0905398428440094, 0.09083543717861176, 0.09097829461097717, 0.09065490961074829, 0.09131396561861038, 0.09073170274496078, 0.09102792292833328, 0.09080856293439865], [0.09164557605981827, 0.09037654101848602, 0.09116204082965851, 0.09046801179647446, 0.09082098305225372, 0.09099165350198746, 0.09060539305210114, 0.091392882168293, 0.09069709479808807, 0.09105095267295837, 0.09078888595104218], [0.09140092879533768, 0.0905529037117958, 0.0910782739520073, 0.09061416238546371, 0.0908503457903862, 0.09096444398164749, 0.09070612490177155, 0.09123238176107407, 0.09076748043298721, 0.09100406616926193, 0.09082888811826706], [0.09161695092916489, 0.09039714932441711, 0.09115225076675415, 0.0904850885272026, 0.0908244177699089, 0.09098847955465317, 0.09061716496944427, 0.09137410670518875, 0.09070532768964767, 0.09104548394680023, 0.09079357236623764], [0.09150682389736176, 0.09047648310661316, 0.09111455827951431, 0.09055084735155106, 0.09083763509988785, 0.09097623825073242, 0.09066249430179596, 0.09130187332630157, 0.0907370001077652, 0.09102438390254974, 0.09081157296895981], [0.0915883332490921, 0.09041775017976761, 0.09114246070384979, 0.09050217270851135, 0.09082785993814468, 0.09098529815673828, 0.09062894433736801, 0.0913553461432457, 0.09071356058120728, 0.09104000777006149, 0.09079825133085251]], [[0.09079951047897339, 0.09057151526212692, 0.090672068297863, 0.09088096767663956, 0.09090813994407654, 0.09075341373682022, 0.0905255377292633, 0.09073410928249359, 0.09250426292419434, 0.0906975120306015, 0.09095300734043121], [0.09076877683401108, 0.09047812223434448, 0.09060627967119217, 0.09087268263101578, 0.09090734273195267, 0.09070999920368195, 0.09041952341794968, 0.09068538248538971, 0.09294849634170532, 0.09063872694969177, 0.09096457809209824], [0.09078236669301987, 0.09051935374736786, 0.09063533693552017, 0.09087636321783066, 0.09090772271156311, 0.09072918444871902, 0.09046632051467896, 0.09070690721273422, 0.09275221079587936, 0.09066469967365265, 0.09095950424671173], [0.09081040322780609, 0.09060478210449219, 0.09069547057151794, 0.09088385850191116, 0.09090835601091385, 0.09076883643865585, 0.09056331217288971, 0.09075142443180084, 0.09234625101089478, 0.09071842581033707, 0.09094880521297455], [0.09081403911113739, 0.0906158834695816, 0.09070327877998352, 0.09088481962680817, 0.09090842306613922, 0.09077397733926773, 0.09057591110467911, 0.09075719863176346, 0.0922936424612999, 0.09072539955377579, 0.09094740450382233], [0.09079331904649734, 0.0905526652932167, 0.09065879136323929, 0.09087931364774704, 0.0909079909324646, 0.09074465930461884, 0.09050413221120834, 0.09072427451610565, 0.09259383380413055, 0.0906856507062912, 0.09095535427331924], [0.09076255559921265, 0.09045924991369247, 0.09059298038482666, 0.09087099134922028, 0.09090716391801834, 0.09070121496915817, 0.09039811044931412, 0.09067551791667938, 0.09303846210241318, 0.09062683582305908, 0.09096690267324448], [0.09079071879386902, 0.09054476022720337, 0.09065321832895279, 0.09087861329317093, 0.09090792387723923, 0.09074097871780396, 0.09049516171216965, 0.09072014689445496, 0.09263138473033905, 0.09068068116903305, 0.09095633774995804], [0.0910201221704483, 0.0912584662437439, 0.09115320444107056, 0.09093525260686874, 0.09090698510408401, 0.09106820821762085, 0.09130668640136719, 0.09108836948871613, 0.08927586674690247, 0.09112659841775894, 0.09086033701896667], [0.09078580141067505, 0.09052978456020355, 0.09064268320798874, 0.09087729454040527, 0.09090781211853027, 0.09073403477668762, 0.09047815948724747, 0.09071235358715057, 0.09270262718200684, 0.09067125618457794, 0.09095821529626846], [0.09082002192735672, 0.09063418209552765, 0.090716153383255, 0.09088639914989471, 0.09090853482484818, 0.09078245609998703, 0.09059669822454453, 0.09076672047376633, 0.09220685809850693, 0.09073689579963684, 0.09094508737325668]]]}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"episode_return_max": 13.5, "env_reset_timer": 0.0005850420566275716, "episode_duration_sec_mean": 0.005295322852907703, "sample": 0.11642391700297594, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2419539903492288e-05, "batch_individual_items": 1.2806995614772457e-05, "add_time_dim_to_batch_and_zero_pad": 8.312798439291487e-06, "add_observations_from_episodes_to_batch": 3.2847320708205917e-06, "add_states_from_episodes_to_batch": 2.781529942241397e-06}}, "connector_pipeline_timer": 6.457267780485771e-05}, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2666757653605916e-05, "normalize_and_clip_actions": 8.813373509544815e-06, "get_actions": 4.2878524008019835e-05, "listify_data_for_vector_env": 1.034587356421e-05, "un_batch_to_individual_items": 6.704809734645476e-06, "tensor_to_numpy": 1.6498681703761278e-05}}, "connector_pipeline_timer": 0.00012427822087856247}, "env_to_module_sum_episodes_length_in": 10.216013141322508, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -0.35}, "episode_return_mean": -0.35, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "env_to_module_sum_episodes_length_out": 10.216013141322508, "num_env_steps_sampled": 400, "weights_seq_no": 1.0, "episode_len_max": 20, "episode_return_min": -13.5, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": -0.35}, "num_episodes_lifetime": 20, "episode_len_min": 20, "env_step_timer": 1.5170842059548925e-05, "num_env_steps_sampled_lifetime": 5400, "rlmodule_inference_timer": 3.471147511646793e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 400}}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "b19cd_00000", "date": "2025-08-11_18-40-02", "timestamp": 1754930402, "time_this_iter_s": 9.257114887237549, "time_total_s": 9.257114887237549, "pid": 11628, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1629fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9.257114887237549, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 38.214285714285715, "ram_util_percent": 77.8}}
{"timers": {"training_iteration": 9.129749531133566, "restore_env_runners": 9.552550036460161e-06, "training_step": 9.12962879047147, "env_runner_sampling_timer": 1.671668833665317, "learner_update_timer": 7.286169463241239, "synch_weights": 0.0008179198927246034, "restore_eval_env_runners": 9.167008101940155e-06, "evaluation_iteration": 0.12728808308020234, "synch_eval_env_connectors": 0.00018137495499104261, "synch_env_connectors": 4.624947905540466e-06}, "env_runners": {"env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "env_reset_timer": 4.399994800093983e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.8701037802179445e-05, "listify_data_for_vector_env": 1.0369636728852054e-05, "tensor_to_numpy": 1.5035330403938503e-05, "un_batch_to_individual_items": 6.633859047821632e-06, "remove_single_ts_time_rank_from_batch": 1.1942843457958193e-05, "normalize_and_clip_actions": 7.975686209115967e-06}}, "connector_pipeline_timer": 0.00011694029244490617}, "episode_duration_sec_mean": 0.0052194316890090695, "sample": 0.005715771691975816, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.6980760478442925e-06, "numpy_to_tensor": 1.2488993772707755e-05, "batch_individual_items": 1.2346461192382561e-05, "add_observations_from_episodes_to_batch": 2.7657092639293462e-06, "add_time_dim_to_batch_and_zero_pad": 6.779186845673544e-06}}, "connector_pipeline_timer": 5.8973429834082985e-05}, "agent_episode_returns_mean": {"default_agent": 2.5}, "time_between_sampling": 0.02869519697262243, "weights_seq_no": 1.0, "num_episodes_lifetime": 500.0, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 2.5}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "episode_return_mean": 2.5, "episode_len_max": 20, "env_step_timer": 1.39349403071098e-05, "num_env_steps_sampled_lifetime": 10000.0, "episode_len_mean": 20.0, "rlmodule_inference_timer": 3.0924576481417084e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime_throughput": 3269.7443016817183}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13503452299279162, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00905916248098947, "add_observations_from_episodes_to_batch": 0.0008870169951114803, "add_columns_from_episodes_to_train_batch": 0.04192569338250905, "add_time_dim_to_batch_and_zero_pad": 0.07519601636682638, "add_states_from_episodes_to_batch": 0.0035344251978676766, "batch_individual_items": 0.004219207182759419, "numpy_to_tensor": 6.266203592531383e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 11.0, "module_train_batch_size_mean": 997.7412016936058, "total_loss": 0.0, "weights_seq_no": 12.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 71820}, "default_policy": {"module_train_batch_size_mean": 997.7412016936058, "mean_kl_loss": 9.87212570180418e-06, "weights_seq_no": 12.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 71820, "diff_num_grad_updates_vs_sampler_policy": 11.0, "use_intrinsic_rewards": 1.0, "entropy": 0.6830348372459412, "vf_loss_unclipped": 44.050384521484375, "vf_explained_var": 0.003456294536590576, "policy_loss": -1.343736130365869e-05, "total_loss": 0.27813783288002014, "vf_loss": 0.3583894968032837}, "__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 143640, "num_env_steps_trained_lifetime": 396000, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 60605.989491066386}}}, "default_policy": {"curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.3583585023880005, "mean_kl_loss": 9.82903475232888e-06, "num_module_steps_trained_lifetime": 11970, "module_train_batch_size_mean": 997.9429069707118, "weights_seq_no": 2.0, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 16595, "use_intrinsic_rewards": 0.0, "entropy": 0.683036208152771, "vf_loss_unclipped": 44.09420394897461, "vf_explained_var": 0.00320589542388916, "curr_kl_coeff": 0.040395982563495636, "policy_loss": -1.3569007023761515e-05, "total_loss": 0.2781127393245697, "num_module_steps_trained_lifetime_throughput": 828.1299292669087}, "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 997.9429069707118, "weights_seq_no": 2.0, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 11970, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 828.1463090423094}, "__all_modules__": {"num_env_steps_trained_lifetime": 66000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 33000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 23940, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4568.117350758886, "num_module_steps_trained_throughput": 31050110.35090008, "num_module_steps_trained_lifetime_throughput": 13173299.7303852}, "IntrinsicAttentionMask": [[[0.09127848595380783, 0.0908079743385315, 0.09076374024152756, 0.09061664342880249, 0.09105899184942245, 0.09066824615001678, 0.09069405496120453, 0.09113677591085434, 0.09098907560110092, 0.09118866920471191, 0.09079735726118088], [0.09150993078947067, 0.09074453264474869, 0.09067270904779434, 0.0904339998960495, 0.09115256369113922, 0.09051770716905594, 0.09055958688259125, 0.09127914905548096, 0.09103884547948837, 0.09136363118886948, 0.0907273069024086], [0.09153177589178085, 0.09073854982852936, 0.09066412597894669, 0.0904167965054512, 0.09116138517856598, 0.0905035212635994, 0.09054691344499588, 0.09129257500171661, 0.09104353189468384, 0.09138014167547226, 0.09072069823741913], [0.09160450100898743, 0.09071860462427139, 0.09063553065061569, 0.09035950899124146, 0.09119072556495667, 0.0904562845826149, 0.0905047133564949, 0.09133725613355637, 0.09105910360813141, 0.09143508225679398, 0.09069866687059402], [0.09138625860214233, 0.09077844023704529, 0.09072134643793106, 0.09053153544664383, 0.09110260009765625, 0.09059810638427734, 0.0906314104795456, 0.09120309352874756, 0.09101228415966034, 0.09127016365528107, 0.09076474606990814], [0.09157897531986237, 0.0907256081700325, 0.09064556658267975, 0.09037961810827255, 0.09118042886257172, 0.09047286212444305, 0.09051952511072159, 0.09132158011198044, 0.09105364978313446, 0.09141580015420914, 0.09070640057325363], [0.09156621247529984, 0.09072910249233246, 0.09065058082342148, 0.0903896614909172, 0.09117528051137924, 0.09048115462064743, 0.09052692353725433, 0.09131373465061188, 0.09105090796947479, 0.09140615910291672, 0.09071026742458344], [0.09134802967309952, 0.09078892320394516, 0.09073638916015625, 0.09056171774864197, 0.09108714014291763, 0.09062298387289047, 0.09065362811088562, 0.09117957949638367, 0.09100405871868134, 0.091241255402565, 0.09077631682157516], [0.09142066538333893, 0.09076901525259018, 0.09070782363414764, 0.09050440043210983, 0.0911165103316307, 0.09057573974132538, 0.09061142802238464, 0.09122426062822342, 0.09101968258619308, 0.09129616618156433, 0.09075433015823364], [0.09132254123687744, 0.09079589694738388, 0.09074640274047852, 0.09058183431625366, 0.0910768210887909, 0.09063956141471863, 0.09066843241453171, 0.09116389602422714, 0.0909985676407814, 0.09122198075056076, 0.09078402072191238], [0.09151517599821091, 0.09074310958385468, 0.09067065268754959, 0.0904298797249794, 0.09115468710660934, 0.09051430970430374, 0.0905565544962883, 0.09128237515687943, 0.0910399779677391, 0.09136759489774704, 0.09072572737932205]], [[0.09084583073854446, 0.09061772376298904, 0.09071832150220871, 0.09067191183567047, 0.09069902449846268, 0.09054465591907501, 0.09057172387838364, 0.0910361185669899, 0.09255145490169525, 0.0907437801361084, 0.09099940210580826], [0.0908278375864029, 0.09053698927164078, 0.09066523611545563, 0.09060606360435486, 0.09064062684774399, 0.09044385701417923, 0.09047835320234299, 0.09107061475515366, 0.09300897270441055, 0.09069769829511642, 0.0910237655043602], [0.0908358097076416, 0.09057264029979706, 0.09068868309259415, 0.09063515067100525, 0.09066642075777054, 0.09048835188150406, 0.09051957726478577, 0.09105541557073593, 0.09280680865049362, 0.09071806818246841, 0.09101304411888123], [0.09083213657140732, 0.09055619686841965, 0.09067787230014801, 0.09062174707651138, 0.09065452963113785, 0.09046783298254013, 0.09050057083368301, 0.09106243401765823, 0.09289999306201935, 0.0907086730003357, 0.09101799130439758], [0.09083428233861923, 0.09056580066680908, 0.0906841903924942, 0.09062957018613815, 0.09066147357225418, 0.09047982096672058, 0.09051167219877243, 0.09105832874774933, 0.09284554421901703, 0.09071415662765503, 0.09101510047912598], [0.0908220112323761, 0.09051104635000229, 0.09064815193414688, 0.090584896504879, 0.09062183648347855, 0.0904114842414856, 0.09044836461544037, 0.0910816416144371, 0.09315620362758636, 0.09068286418914795, 0.09103153645992279], [0.0908241719007492, 0.09052065759897232, 0.09065447747707367, 0.09059273451566696, 0.09062880277633667, 0.09042348712682724, 0.09045947343111038, 0.09107755869626999, 0.0931016206741333, 0.09068835526704788, 0.09102865308523178], [0.09086062759160995, 0.09068479388952255, 0.09076235443353653, 0.0907265767455101, 0.09074747562408447, 0.09062845259904861, 0.0906493291258812, 0.09100723266601562, 0.09217220544815063, 0.09078197926282883, 0.0909789577126503], [0.09097157418727875, 0.09120979905128479, 0.09110458940267563, 0.0911530926823616, 0.0911247506737709, 0.09128636866807938, 0.0912579894065857, 0.09077377617359161, 0.08922825753688812, 0.09107799828052521, 0.09081187099218369], [0.09083782136440277, 0.09058165550231934, 0.0906946212053299, 0.09064250439405441, 0.09067294001579285, 0.09049960970878601, 0.09053000062704086, 0.09105157107114792, 0.0927557423710823, 0.09072320908308029, 0.09101033210754395], [0.09085778892040253, 0.09067188203334808, 0.09075387567281723, 0.09071604907512665, 0.09073814749717712, 0.09061230719089508, 0.09063437581062317, 0.09101281315088272, 0.0922452062368393, 0.09077463299036026, 0.09098290652036667]], [[0.0906871110200882, 0.09081404656171799, 0.09107790887355804, 0.09056079387664795, 0.09082391113042831, 0.09095104783773422, 0.09098532795906067, 0.09124968200922012, 0.09073159098625183, 0.09131848067045212, 0.09079999476671219], [0.09070853888988495, 0.09082324802875519, 0.09106162935495377, 0.09059438109397888, 0.09083215892314911, 0.09094701707363129, 0.0909779965877533, 0.09121678024530411, 0.09074873477220535, 0.09127891063690186, 0.09081055223941803], [0.0907529890537262, 0.09084230661392212, 0.09102784097194672, 0.09066407382488251, 0.09084924310445786, 0.09093865752220154, 0.09096276015043259, 0.09114854037761688, 0.09078428894281387, 0.09119686484336853, 0.09083241969347], [0.09066576510667801, 0.09080488979816437, 0.09109414368867874, 0.09052733331918716, 0.0908157005906105, 0.09095506370067596, 0.09099264442920685, 0.09128248691558838, 0.09071451425552368, 0.09135793894529343, 0.09078948944807053], [0.09071021527051926, 0.09082397073507309, 0.09106037020683289, 0.090597003698349, 0.09083280712366104, 0.09094671905040741, 0.09097743034362793, 0.09121423214673996, 0.0907500758767128, 0.09127584844827652, 0.09081137925386429], [0.09073163568973541, 0.0908331498503685, 0.09104407578706741, 0.09063059091567993, 0.09084104001522064, 0.09094268083572388, 0.09097008407115936, 0.09118132293224335, 0.09076721221208572, 0.09123627841472626, 0.09082192182540894], [0.09073740988969803, 0.09083563089370728, 0.09103968739509583, 0.0906396433711052, 0.09084326028823853, 0.09094160050153732, 0.09096810221672058, 0.0911724641919136, 0.09077183157205582, 0.09122562408447266, 0.09082476049661636], [0.09078186005353928, 0.09085467457771301, 0.09100589901208878, 0.09070935845375061, 0.09086033701896667, 0.09093321859836578, 0.09095285832881927, 0.09110424667596817, 0.09080738574266434, 0.09114361554384232, 0.09084662050008774], [0.09069462865591049, 0.09081728756427765, 0.0910722091794014, 0.09057257324457169, 0.09082681685686111, 0.090949647128582, 0.09098276495933533, 0.09123814851045609, 0.09073761105537415, 0.09130461513996124, 0.09080370515584946], [0.09079340100288391, 0.09085961431264877, 0.090997114777565, 0.09072746336460114, 0.09086476266384125, 0.09093103557825089, 0.09094889461994171, 0.09108652919530869, 0.09081660956144333, 0.09112231433391571, 0.090852290391922], [0.09070617705583572, 0.090822234749794, 0.09106343239545822, 0.09059067070484161, 0.09083124995231628, 0.0909474715590477, 0.09097880870103836, 0.091220423579216, 0.09074684232473373, 0.09128329157829285, 0.09080938994884491]], [[0.09046179056167603, 0.09083091467618942, 0.09062866866588593, 0.09056800603866577, 0.09060343354940414, 0.09073507785797119, 0.09043706953525543, 0.09104432910680771, 0.09303246438503265, 0.09066195785999298, 0.09099628776311874], [0.09057877212762833, 0.0908518135547638, 0.09070225059986115, 0.09065736830234528, 0.09068358689546585, 0.09078095108270645, 0.09056047350168228, 0.09100954979658127, 0.09247437864542007, 0.09072686731815338, 0.09097404778003693], [0.09051475673913956, 0.0908404067158699, 0.09066200256347656, 0.09060848504304886, 0.09063974767923355, 0.0907558798789978, 0.09049294143915176, 0.0910286232829094, 0.0927795022726059, 0.09069137275218964, 0.09098626673221588], [0.0904955267906189, 0.09083697199821472, 0.09064990282058716, 0.09059378504753113, 0.09062656760215759, 0.09074833244085312, 0.09047265350818634, 0.09103434532880783, 0.09287133812904358, 0.09068069607019424, 0.09098991751670837], [0.09050676226615906, 0.0908389762043953, 0.09065697342157364, 0.09060236811637878, 0.09063426405191422, 0.0907527431845665, 0.09048450738191605, 0.09103100001811981, 0.09281767904758453, 0.09068693220615387, 0.09098778665065765], [0.09054847061634064, 0.09084643423557281, 0.09068320691585541, 0.09063423424959183, 0.09066283702850342, 0.09076909720897675, 0.09052851051092148, 0.09101860225200653, 0.09261877089738846, 0.09071007370948792, 0.09097985178232193], [0.09045393764972687, 0.09082949161529541, 0.09062372148036957, 0.09056200087070465, 0.09059805423021317, 0.09073198586702347, 0.09042878448963165, 0.09104664623737335, 0.09307003021240234, 0.09065758436918259, 0.09099777042865753], [0.09064608812332153, 0.09086368978023529, 0.0907445102930069, 0.09070874005556107, 0.09072963148355484, 0.0908072292804718, 0.09063150733709335, 0.09098934382200241, 0.09215408563613892, 0.0907641351222992, 0.09096106886863708], [0.09126249700784683, 0.09096755087375641, 0.0911288857460022, 0.09117740392684937, 0.09114905446767807, 0.09104391932487488, 0.09128233045339584, 0.09079799056053162, 0.0892520546913147, 0.09110228717327118, 0.09083610028028488], [0.0905253142118454, 0.09084230661392212, 0.09066864103078842, 0.09061654657125473, 0.09064697474241257, 0.09076002240180969, 0.09050408005714417, 0.09102550148963928, 0.09272918105125427, 0.09069722890853882, 0.0909842699766159], [0.09063094854354858, 0.09086102992296219, 0.09073501080274582, 0.09069719165563583, 0.09071928262710571, 0.09080132842063904, 0.09061553329229355, 0.09099388867616653, 0.09222602844238281, 0.09075576066970825, 0.09096399694681168]], [[0.09123410284519196, 0.09052104502916336, 0.09096292406320572, 0.09081549942493439, 0.09101471304893494, 0.09086721390485764, 0.09064995497465134, 0.09084880352020264, 0.09094482660293579, 0.09114433079957962, 0.09099661558866501], [0.09154331684112549, 0.09015382081270218, 0.09101366251707077, 0.09072636067867279, 0.09111470729112625, 0.0908270850777626, 0.09040425717830658, 0.09079122543334961, 0.09097839146852493, 0.09136781096458435, 0.09107939153909683], [0.09135132282972336, 0.09038157761096954, 0.09098220616579056, 0.09078170359134674, 0.09105267375707626, 0.09085202217102051, 0.09055669605731964, 0.09082698822021484, 0.09095758944749832, 0.09122908115386963, 0.09102804213762283], [0.09141524136066437, 0.09030567109584808, 0.09099269658327103, 0.09076328575611115, 0.09107334166765213, 0.09084372967481613, 0.09050590544939041, 0.09081508964300156, 0.09096453338861465, 0.09127528220415115, 0.09104516357183456], [0.09132890403270721, 0.09040824323892593, 0.09097851812839508, 0.09078817814588547, 0.09104542434215546, 0.0908549353480339, 0.09057452529668808, 0.09083116799592972, 0.09095516055822372, 0.09121287614107132, 0.09102204442024231], [0.09139280766248703, 0.09033230692148209, 0.09098901599645615, 0.09076975286006927, 0.09106609225273132, 0.09084664285182953, 0.09052372723817825, 0.09081926941871643, 0.09096209704875946, 0.09125906974077225, 0.09103915840387344], [0.09148717671632767, 0.09022033214569092, 0.09100447595119476, 0.09074253588914871, 0.09109658747911453, 0.09083438664674759, 0.0904487892985344, 0.09080168604850769, 0.09097231924533844, 0.0913272574543953, 0.09106439352035522], [0.09140079468488693, 0.0903228297829628, 0.0909903272986412, 0.09076745063066483, 0.09106867015361786, 0.09084560722112656, 0.09051738679409027, 0.09081778675317764, 0.0909629687666893, 0.09126484394073486, 0.09104128926992416], [0.09135916829109192, 0.09037227928638458, 0.09098350256681442, 0.09077946096658707, 0.09105521440505981, 0.09085100889205933, 0.09055047482252121, 0.09082553535699844, 0.09095845371484756, 0.09123475849628448, 0.09103015810251236], [0.09127286076545715, 0.09047490358352661, 0.09096930176019669, 0.0908043310046196, 0.09102727472782135, 0.09086219221353531, 0.09061910957098007, 0.09084159880876541, 0.09094905853271484, 0.09117235988378525, 0.09100701659917831], [0.09133674949407578, 0.09039893746376038, 0.09097982197999954, 0.0907859280705452, 0.09104796499013901, 0.09085392951965332, 0.09056831151247025, 0.09082972258329391, 0.09095602482557297, 0.09121855348348618, 0.09102415293455124]], [[0.09040147811174393, 0.09077035635709763, 0.09056824445724487, 0.0908413901925087, 0.09087692946195602, 0.09067458659410477, 0.09071005880832672, 0.09064934402704239, 0.09297043830156326, 0.09060151129961014, 0.09093562513589859], [0.09053408354520798, 0.0908069908618927, 0.09065750241279602, 0.09085951000452042, 0.09088578820228577, 0.09073616564273834, 0.09076239913702011, 0.09071749448776245, 0.09242875874042511, 0.09068211168050766, 0.09092917293310165], [0.09046152234077454, 0.09078697860240936, 0.09060867875814438, 0.09084963798522949, 0.09088099002838135, 0.09070250391960144, 0.09073379635810852, 0.09068023413419724, 0.09272493422031403, 0.09063803404569626, 0.09093274921178818], [0.09055954962968826, 0.0908140018582344, 0.09067462384700775, 0.09086296707391739, 0.09088745713233948, 0.09074796736240387, 0.09077242761850357, 0.09073056280612946, 0.09232502430677414, 0.09069757163524628, 0.09092789888381958], [0.09057227522134781, 0.09081749618053436, 0.09068317711353302, 0.09086468070745468, 0.09088827669620514, 0.09075386077165604, 0.0907774344086647, 0.09073708951473236, 0.09227319061756134, 0.09070529043674469, 0.09092725068330765], [0.09049972146749496, 0.0907975286245346, 0.09063439071178436, 0.09085485339164734, 0.0908835232257843, 0.09072023630142212, 0.0907488688826561, 0.09069985896348953, 0.09256891161203384, 0.09066124260425568, 0.09093087911605835], [0.0905124619603157, 0.09080103784799576, 0.09064295887947083, 0.09085658192634583, 0.09088437259197235, 0.09072614461183548, 0.09075389057397842, 0.09070640057325363, 0.0925169587135315, 0.09066898375749588, 0.09093025326728821], [0.0904906615614891, 0.09079502522945404, 0.09062828868627548, 0.09085361659526825, 0.09088292717933655, 0.09071602672338486, 0.09074529260396957, 0.09069520235061646, 0.09260591119527817, 0.09065574407577515, 0.09093132615089417], [0.09131120145320892, 0.09101609140634537, 0.09117751568555832, 0.09095950424671173, 0.090931236743927, 0.09109250456094742, 0.09106418490409851, 0.0911126658320427, 0.08929968625307083, 0.0911509096622467, 0.09088457375764847], [0.0904734656214714, 0.0907902792096138, 0.09061671793460846, 0.09085126966238022, 0.09088177233934402, 0.09070803970098495, 0.09073850512504578, 0.0906863659620285, 0.0926760733127594, 0.09064528346061707, 0.09093216061592102], [0.09059327840805054, 0.09082326292991638, 0.09069729596376419, 0.09086751192808151, 0.09088964760303497, 0.09076359122991562, 0.0907856896519661, 0.09074785560369492, 0.09218769520521164, 0.09071803838014603, 0.09092618525028229]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_return_max": 13.5, "env_reset_timer": 0.0005799991358071565, "episode_duration_sec_mean": 0.0052102373767411335, "sample": 0.11637434117379598, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1732563944005383e-05, "batch_individual_items": 1.2254194257473598e-05, "add_time_dim_to_batch_and_zero_pad": 7.0908550492783935e-06, "add_observations_from_episodes_to_batch": 2.809009657846557e-06, "add_states_from_episodes_to_batch": 2.691528603731429e-06}}, "connector_pipeline_timer": 5.862099874687697e-05}, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1738832385423236e-05, "normalize_and_clip_actions": 7.788782024291741e-06, "get_actions": 3.568257440340718e-05, "listify_data_for_vector_env": 1.0258020436018675e-05, "un_batch_to_individual_items": 6.4936244444680485e-06, "tensor_to_numpy": 1.4724615624667961e-05}}, "connector_pipeline_timer": 0.00011250756110695076}, "env_to_module_sum_episodes_length_in": 10.366003441359926, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 0.65}, "episode_return_mean": 0.65, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "env_to_module_sum_episodes_length_out": 10.366003441359926, "num_env_steps_sampled": 400, "weights_seq_no": 2.0, "episode_len_max": 20, "episode_return_min": -13.5, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 0.65}, "num_episodes_lifetime": 40, "episode_len_min": 20, "env_step_timer": 1.3698108921642666e-05, "num_env_steps_sampled_lifetime": 10400, "rlmodule_inference_timer": 3.0272376909211653e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "time_between_sampling": 9.373072332935408}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "b19cd_00000", "date": "2025-08-11_18-40-12", "timestamp": 1754930412, "time_this_iter_s": 9.457283020019531, "time_total_s": 18.71439790725708, "pid": 11628, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1629fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18.71439790725708, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 40.43846153846154, "ram_util_percent": 78.26153846153845}}
{"timers": {"training_iteration": 9.14252539707257, "restore_env_runners": 9.52619502786547e-06, "training_step": 9.142403608816222, "env_runner_sampling_timer": 1.671501946578885, "learner_update_timer": 7.298300398608587, "synch_weights": 0.0008240886039799079, "restore_eval_env_runners": 9.143258212134241e-06, "evaluation_iteration": 0.127178033918608, "synch_eval_env_connectors": 0.00018069454468786717, "synch_env_connectors": 4.625368164852262e-06}, "env_runners": {"env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "env_reset_timer": 4.0790313606954845e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.36190955665048e-05, "listify_data_for_vector_env": 1.1349457860241467e-05, "tensor_to_numpy": 1.7392061006754944e-05, "un_batch_to_individual_items": 6.999856760367523e-06, "remove_single_ts_time_rank_from_batch": 1.2539516187651304e-05, "normalize_and_clip_actions": 8.571553788106294e-06}}, "connector_pipeline_timer": 0.0001286362902240533}, "episode_duration_sec_mean": 0.005675303984899075, "sample": 0.006016990218335585, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.8309168171684103e-06, "numpy_to_tensor": 1.362438616636032e-05, "batch_individual_items": 1.3280399282434633e-05, "add_observations_from_episodes_to_batch": 2.9203504656668943e-06, "add_time_dim_to_batch_and_zero_pad": 7.4090256506312185e-06}}, "connector_pipeline_timer": 6.316047881677415e-05}, "agent_episode_returns_mean": {"default_agent": 2.0200000000000005}, "time_between_sampling": 0.03170181082331804, "weights_seq_no": 2.0, "num_episodes_lifetime": -30375.0, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 2.0200000000000005}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "episode_return_mean": 2.0200000000000005, "episode_len_max": 20, "env_step_timer": 1.5122583529826878e-05, "num_env_steps_sampled_lifetime": -607500.0, "episode_len_mean": 20.0, "rlmodule_inference_timer": 3.35937271577448e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime_throughput": 3156.9366562303753}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13542060901274672, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009061105026432778, "add_observations_from_episodes_to_batch": 0.0008873105759616009, "add_columns_from_episodes_to_train_batch": 0.041960374778276306, "add_time_dim_to_batch_and_zero_pad": 0.07550147620359203, "add_states_from_episodes_to_batch": 0.0035475209456984885, "batch_individual_items": 0.00424746011182433, "numpy_to_tensor": 6.397583546349779e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 16.0, "module_train_batch_size_mean": 997.6672132667843, "total_loss": 0.0, "weights_seq_no": 18.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 107730}, "default_policy": {"module_train_batch_size_mean": 997.6672132667843, "mean_kl_loss": 1.5319048998208018e-06, "weights_seq_no": 18.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 107730, "diff_num_grad_updates_vs_sampler_policy": 16.0, "use_intrinsic_rewards": 1.0, "entropy": 0.6830512285232544, "vf_loss_unclipped": 45.71027755737305, "vf_explained_var": 0.003603339195251465, "policy_loss": -2.748471342783887e-05, "total_loss": 0.2781037390232086, "vf_loss": 0.3583655059337616}, "__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 215460, "num_env_steps_trained_lifetime": 594000, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 59988.282345453554}}}, "default_policy": {"curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.35830479860305786, "mean_kl_loss": 1.5212993957902654e-06, "num_module_steps_trained_lifetime": 17955, "module_train_batch_size_mean": 997.9168410861561, "weights_seq_no": 3.0, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 16595, "use_intrinsic_rewards": 0.0, "entropy": 0.6830528378486633, "vf_loss_unclipped": 45.75371170043945, "vf_explained_var": 0.00032532215118408203, "curr_kl_coeff": 0.020197991281747818, "policy_loss": -2.8352968001854606e-05, "total_loss": 0.2780553698539734, "num_module_steps_trained_lifetime_throughput": 825.4065890642289}, "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 997.9168410861561, "weights_seq_no": 3.0, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 17955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 825.4225252077272}, "__all_modules__": {"num_env_steps_trained_lifetime": 99000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 33000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 35910, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4553.062710072888, "num_module_steps_trained_throughput": 30382832.04621581, "num_module_steps_trained_lifetime_throughput": 13145777.57870806}, "IntrinsicAttentionMask": [[[0.09130077064037323, 0.09083014726638794, 0.09102939069271088, 0.09063877165317535, 0.09083759784698486, 0.09069038182497025, 0.09071619808673859, 0.09115902334451675, 0.09101128578186035, 0.09096695482730865, 0.09081953018903732], [0.09154628962278366, 0.0907805860042572, 0.09110446274280548, 0.09046993404626846, 0.0907926931977272, 0.09055367112159729, 0.09059556573629379, 0.09131541848182678, 0.09107501804828644, 0.0910029262304306, 0.09076335281133652], [0.09144213050603867, 0.09080161899328232, 0.09107264131307602, 0.09054149687290192, 0.09081174433231354, 0.09061162918806076, 0.09064671397209167, 0.09124909341335297, 0.09104800969362259, 0.09098769724369049, 0.09078718721866608], [0.09164664149284363, 0.09076033532619476, 0.09113506972789764, 0.0904010757803917, 0.09077433496713638, 0.09049789607524872, 0.09054634720087051, 0.09137927740812302, 0.09110099822282791, 0.09101757407188416, 0.0907403901219368], [0.09154239296913147, 0.09078137576580048, 0.09110327064990997, 0.09047261625528336, 0.09079340845346451, 0.090555839240551, 0.0905974805355072, 0.091312937438488, 0.09107401221990585, 0.09100235998630524, 0.09076424688100815], [0.0916195660829544, 0.0907658189535141, 0.09112682193517685, 0.09041967242956161, 0.09077930450439453, 0.0905129611492157, 0.09055964648723602, 0.09136205166578293, 0.0910940021276474, 0.09101363271474838, 0.09074660390615463], [0.0916060209274292, 0.09076854586601257, 0.09112269431352615, 0.09042896330356598, 0.09078177809715271, 0.09052048623561859, 0.09056628495454788, 0.09135343134403229, 0.09109049290418625, 0.0910116583108902, 0.09074970334768295], [0.09137453138828278, 0.09081526100635529, 0.09105197340250015, 0.09058798849582672, 0.09082410484552383, 0.09064927697181702, 0.09067992866039276, 0.09120602905750275, 0.09103045612573624, 0.09097778797149658, 0.09080265462398529], [0.09145158529281616, 0.0907997116446495, 0.09107553958892822, 0.090535007417202, 0.09081002324819565, 0.09060637652873993, 0.09064207971096039, 0.09125511348247528, 0.09105046838521957, 0.09098908305168152, 0.09078502655029297], [0.0914747342467308, 0.09079504013061523, 0.0910826027393341, 0.09051909297704697, 0.090805783867836, 0.09059347957372665, 0.09063069522380829, 0.09126985818147659, 0.0910564661026001, 0.09099246561527252, 0.09077972918748856], [0.09155185520648956, 0.09077947586774826, 0.09110616147518158, 0.09046612679958344, 0.09079168736934662, 0.09055058658123016, 0.09059284627437592, 0.09131895750761032, 0.09107646346092224, 0.09100374579429626, 0.09076208621263504]], [[0.09075261652469635, 0.09052474051713943, 0.09062524139881134, 0.09083402901887894, 0.09086118638515472, 0.09045174717903137, 0.09047878533601761, 0.09094270318746567, 0.09271693229675293, 0.09090603142976761, 0.09090603142976761], [0.09070882201194763, 0.09041835367679596, 0.09054642915725708, 0.09081265330314636, 0.09084729105234146, 0.09032534807920456, 0.09035979956388474, 0.09095128625631332, 0.0932210385799408, 0.09090449661016464, 0.09090449661016464], [0.09072817862033844, 0.09046532958745956, 0.09058123081922531, 0.09082212299108505, 0.09085345268249512, 0.09038114547729492, 0.09041232615709305, 0.09094753116369247, 0.09299825876951218, 0.09090520441532135, 0.09090520441532135], [0.09076815843582153, 0.09056264162063599, 0.09065328538417816, 0.09084158390760422, 0.09086606651544571, 0.09049679338932037, 0.0905211865901947, 0.09093956649303436, 0.09253770112991333, 0.09090650081634521, 0.09090650081634521], [0.0907733365893364, 0.09057527035474777, 0.0906626358628273, 0.09084409475326538, 0.09086769074201584, 0.09051181375980377, 0.09053532034158707, 0.0909385159611702, 0.09247802942991257, 0.09090664982795715, 0.09090664982795715], [0.09069471061229706, 0.09038417786359787, 0.09052109718322754, 0.09080573171377182, 0.09084277600049973, 0.09028476476669312, 0.09032159298658371, 0.09095397591590881, 0.0933833122253418, 0.09090393781661987, 0.09090393781661987], [0.0906999483704567, 0.09039685130119324, 0.09053049236536026, 0.09080830961465836, 0.09084445238113403, 0.0902998074889183, 0.09033574908971786, 0.09095298498868942, 0.09332315623760223, 0.09090414643287659, 0.09090414643287659], [0.0907888412475586, 0.09061314910650253, 0.09069065004587173, 0.09085159748792648, 0.09087251871824265, 0.09055684506893158, 0.09057770669460297, 0.09093533456325531, 0.0922992154955864, 0.09090707451105118, 0.09090707451105118], [0.09111445397138596, 0.09142393618822098, 0.09128722548484802, 0.09100431948900223, 0.09096763283014297, 0.09152346849441528, 0.09148657321929932, 0.09085766971111298, 0.08852047473192215, 0.09090711176395416, 0.09090711176395416], [0.09078187495470047, 0.09059611707925797, 0.09067805111408234, 0.09084822237491608, 0.09087035059928894, 0.09053659439086914, 0.09055864810943604, 0.09093677252531052, 0.0923796072602272, 0.09090688824653625, 0.09090688824653625], [0.09078187495470047, 0.09059611707925797, 0.09067805111408234, 0.09084822237491608, 0.09087035059928894, 0.09053659439086914, 0.09055864810943604, 0.09093677252531052, 0.0923796072602272, 0.09090688824653625, 0.09090688824653625]], [[0.0906287133693695, 0.09075557440519333, 0.09101925790309906, 0.09082400053739548, 0.09108789265155792, 0.0908924788236618, 0.09092673659324646, 0.09119092673063278, 0.09067316353321075, 0.0912596806883812, 0.09074153751134872], [0.09065576642751694, 0.0907704085111618, 0.09100864827632904, 0.09083224087953568, 0.09107063710689545, 0.09089411050081253, 0.09092506021261215, 0.09116370975971222, 0.09069593995809555, 0.09122580289840698, 0.09075772017240524], [0.09071187674999237, 0.09080115705728531, 0.09098660200834274, 0.09084929525852203, 0.09103483706712723, 0.09089745581150055, 0.090921550989151, 0.09110724925994873, 0.09074316173791885, 0.09115555137395859, 0.09079127013683319], [0.09067033976316452, 0.0907783955335617, 0.09100291877985, 0.09083666652441025, 0.09106133878231049, 0.09089497476816177, 0.09092415124177933, 0.09114903956651688, 0.09070820361375809, 0.09120754897594452, 0.09076643735170364], [0.09072644263505936, 0.09080912917852402, 0.09098086506128311, 0.09085370600223541, 0.09102553874254227, 0.09089832007884979, 0.09092062711715698, 0.09109257161617279, 0.09075542539358139, 0.09113729745149612, 0.090799979865551], [0.0906849130988121, 0.09078637510538101, 0.09099718928337097, 0.09084109961986542, 0.09105204045772552, 0.09089584648609161, 0.0909232348203659, 0.09113436937332153, 0.09072047472000122, 0.09118929505348206, 0.09077515453100204], [0.09069220721721649, 0.09079037606716156, 0.09099433571100235, 0.0908433198928833, 0.09104739129543304, 0.09089629352092743, 0.09092278778553009, 0.09112703800201416, 0.09072661399841309, 0.09118017554283142, 0.09077951312065125], [0.09074832499027252, 0.09082111716270447, 0.09097228199243546, 0.09086035937070847, 0.09101159125566483, 0.09089962393045425, 0.09091926366090775, 0.09107059240341187, 0.09077383577823639, 0.09110994637012482, 0.0908130630850792], [0.09063819795846939, 0.09076077491044998, 0.0910155400633812, 0.09082689136266708, 0.09108184278011322, 0.09089305251836777, 0.0909261554479599, 0.09118138253688812, 0.09068115055561066, 0.0912478044629097, 0.09074720740318298], [0.0907629132270813, 0.09082910418510437, 0.09096655994653702, 0.09086479246616364, 0.09100230038166046, 0.0909004956483841, 0.09091835469007492, 0.09105593711137772, 0.09078611433506012, 0.09109171479940414, 0.0908217802643776], [0.09065277129411697, 0.09076876193284988, 0.09100981801748276, 0.09083132445812225, 0.09107254445552826, 0.0908939316868782, 0.09092524647712708, 0.09116671979427338, 0.09069342166185379, 0.09122955054044724, 0.09075592458248138]], [[0.09075263887643814, 0.09077976644039154, 0.09037069231271744, 0.09057889878749847, 0.09060598164796829, 0.09070656448602676, 0.09073368459939957, 0.09094272553920746, 0.09271695464849472, 0.0909060537815094, 0.0909060537815094], [0.090757817029953, 0.09078405797481537, 0.09038835018873215, 0.09058976173400879, 0.09061595797538757, 0.0907132476568222, 0.09073948115110397, 0.09094168245792389, 0.092657171189785, 0.09090621024370193, 0.09090621024370193], [0.09067905694246292, 0.09071870148181915, 0.09012141823768616, 0.09042526036500931, 0.09046480804681778, 0.09061173349618912, 0.09065135568380356, 0.09095698595046997, 0.09356404840946198, 0.09090334177017212, 0.09090334177017212], [0.0907192975282669, 0.09075211733579636, 0.09025745093822479, 0.09050916135311127, 0.09054190665483475, 0.09066356718540192, 0.09069636464118958, 0.09094930440187454, 0.09310097992420197, 0.09090492129325867, 0.09090492129325867], [0.09072451293468475, 0.09075644612312317, 0.0902751237154007, 0.09052005410194397, 0.09055192023515701, 0.09067028760910034, 0.09070220589637756, 0.09094829857349396, 0.09304098784923553, 0.09090511500835419, 0.09090511500835419], [0.09074381738901138, 0.09077245742082596, 0.09034068882465363, 0.0905604287981987, 0.0905890166759491, 0.09069517999887466, 0.09072380512952805, 0.09094448387622833, 0.09281858056783676, 0.09090577065944672, 0.09090577065944672], [0.09074901044368744, 0.09077676385641098, 0.09035834670066833, 0.09057130664587021, 0.09059900045394897, 0.0907018855214119, 0.09072962403297424, 0.09094344824552536, 0.09275874495506287, 0.09090593457221985, 0.09090593457221985], [0.09078885614871979, 0.09080977737903595, 0.0904943123459816, 0.09065491706132889, 0.09067580103874207, 0.09075334668159485, 0.09077425301074982, 0.0909353494644165, 0.09229923039674759, 0.09090708941221237, 0.09090708941221237], [0.09111449867486954, 0.0910777673125267, 0.09163428097963333, 0.09135030210018158, 0.09131347388029099, 0.09117692708969116, 0.09114017337560654, 0.09085772186517715, 0.08852052688598633, 0.09090715646743774, 0.09090715646743774], [0.09078188985586166, 0.09080400317907333, 0.09047048538923264, 0.09064027667045593, 0.09066234529018402, 0.09074433892965317, 0.09076644480228424, 0.09093678742647171, 0.0923796221613884, 0.09090691059827805, 0.09090691059827805], [0.09078188985586166, 0.09080400317907333, 0.09047048538923264, 0.09064027667045593, 0.09066234529018402, 0.09074433892965317, 0.09076644480228424, 0.09093678742647171, 0.0923796221613884, 0.09090691059827805, 0.09090691059827805]], [[0.09068708121776581, 0.0908140242099762, 0.09075545519590378, 0.09056076407432556, 0.09082388132810593, 0.09095101803541183, 0.09066320210695267, 0.09124965220689774, 0.09105389565229416, 0.09131845086812973, 0.09112255275249481], [0.09070850908756256, 0.0908232182264328, 0.09077029675245285, 0.09059435874223709, 0.09083212912082672, 0.0909469947218895, 0.09068693220615387, 0.09121675044298172, 0.09103993326425552, 0.09127888083457947, 0.09110195189714432], [0.09069862216711044, 0.09081897884607315, 0.09076344966888428, 0.09057886153459549, 0.09082832932472229, 0.09094884246587753, 0.09067598730325699, 0.09123191982507706, 0.09104637056589127, 0.09129712730646133, 0.0911114513874054], [0.09066572785377502, 0.09080485254526138, 0.09074066579341888, 0.09052730351686478, 0.09081566333770752, 0.09095502644777298, 0.09063956141471863, 0.0912824496626854, 0.09106781333684921, 0.09135790169239044, 0.09114308655261993], [0.09071017801761627, 0.0908239409327507, 0.09077145159244537, 0.09059696644544601, 0.09083276987075806, 0.09094668179750443, 0.0906887799501419, 0.09121419489383698, 0.09103885293006897, 0.09127581119537354, 0.09110035002231598], [0.09073161333799362, 0.09083312749862671, 0.09078630059957504, 0.09063056856393814, 0.09084101766347885, 0.09094265848398209, 0.0907125174999237, 0.09118130058050156, 0.09102489054203033, 0.09123625606298447, 0.09107974916696548], [0.09068304300308228, 0.09081228822469711, 0.09075265377759933, 0.09055443853139877, 0.09082233160734177, 0.09095177054405212, 0.09065873920917511, 0.09125584363937378, 0.09105652570724487, 0.09132590144872665, 0.09112642705440521], [0.09078185260295868, 0.09085466712713242, 0.09082107990980148, 0.09070935100317001, 0.09086032956838608, 0.09093321114778519, 0.09076815098524094, 0.09110423922538757, 0.09099216014146805, 0.09114360809326172, 0.09103147685527802], [0.09074893593788147, 0.09084056317806244, 0.09079829603433609, 0.09065772593021393, 0.0908476784825325, 0.09093939512968063, 0.09073169529438019, 0.09115471690893173, 0.091013602912426, 0.09120429307222366, 0.09106309711933136], [0.09079338610172272, 0.09085960686206818, 0.09082905948162079, 0.09072744846343994, 0.09086474776268005, 0.09093102067708969, 0.09078092873096466, 0.09108651429414749, 0.09098461270332336, 0.09112229943275452, 0.091020368039608], [0.0907604843378067, 0.0908455103635788, 0.09080628305673599, 0.09067583829164505, 0.09085211157798767, 0.09093721956014633, 0.09074448049068451, 0.09113699197769165, 0.09100606292486191, 0.09118298441171646, 0.09105199575424194]], [[0.09105860441923141, 0.09092329442501068, 0.09083171933889389, 0.09110691398382187, 0.09112302958965302, 0.09087991714477539, 0.09104735404253006, 0.09117137640714645, 0.08991074562072754, 0.0909980908036232, 0.09094905853271484], [0.09112796187400818, 0.09092949330806732, 0.09079525619745255, 0.0911988690495491, 0.09122250974178314, 0.09086589515209198, 0.09111145883798599, 0.09129348397254944, 0.08944866061210632, 0.09103918075561523, 0.09096726775169373], [0.09117484092712402, 0.09093353897333145, 0.09077040106058121, 0.09126106649637222, 0.09128982573747635, 0.09085624665021896, 0.09115476906299591, 0.0913761630654335, 0.08913677930831909, 0.0910668894648552, 0.09097945690155029], [0.09103379398584366, 0.09092099219560623, 0.09084464609622955, 0.09107405692338943, 0.09108748286962509, 0.09088483452796936, 0.09102441370487213, 0.09112777560949326, 0.09007605165243149, 0.09098334610462189, 0.09094247221946716], [0.09102553129196167, 0.09092023968696594, 0.09084896743297577, 0.09106311947107315, 0.09107564389705658, 0.09088647365570068, 0.09101677685976028, 0.09111325442790985, 0.0901312381029129, 0.09097844362258911, 0.09094028919935226], [0.0911501795053482, 0.09093142300844193, 0.0907834991812706, 0.09122833609580994, 0.09125439822673798, 0.09086134284734726, 0.09113198518753052, 0.09133264422416687, 0.08930084109306335, 0.09105231612920761, 0.09097305685281754], [0.09106437861919403, 0.09092381596565247, 0.09082870185375214, 0.09111455827951431, 0.0911312997341156, 0.09087876230478287, 0.09105268865823746, 0.09118152409791946, 0.08987227082252502, 0.09100151062011719, 0.09095057845115662], [0.09100070595741272, 0.0909179225564003, 0.09086187928915024, 0.09103025496006012, 0.09104010462760925, 0.09089137613773346, 0.09099382162094116, 0.09106966108083725, 0.09029693156480789, 0.0909636840224266, 0.09093368798494339], [0.09164363890886307, 0.09096787869930267, 0.09051284193992615, 0.09188589453697205, 0.09196678549051285, 0.09075210243463516, 0.09158731251955032, 0.09220989048480988, 0.08603651076555252, 0.09134092181921005, 0.09109623730182648], [0.091089628636837, 0.09092608094215393, 0.09081543982028961, 0.09114803373813629, 0.09116750955581665, 0.09087367355823517, 0.09107603132724762, 0.09122596681118011, 0.08970389515161514, 0.09101647883653641, 0.09095721691846848], [0.09111475944519043, 0.0909283235669136, 0.09080221503973007, 0.09118135273456573, 0.09120356291532516, 0.09086857736110687, 0.09109925478696823, 0.09127022325992584, 0.08953652530908585, 0.09103137254714966, 0.09096381068229675]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_return_max": 13.5, "env_reset_timer": 0.000578450394514948, "episode_duration_sec_mean": 0.00551212284869204, "sample": 0.11655960609220202, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.4020378190186454e-05, "batch_individual_items": 1.4481189492851734e-05, "add_time_dim_to_batch_and_zero_pad": 7.793703227452937e-06, "add_observations_from_episodes_to_batch": 3.067345545677327e-06, "add_states_from_episodes_to_batch": 3.50548201918709e-06}}, "connector_pipeline_timer": 6.714958401022468e-05}, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2995721233187514e-05, "normalize_and_clip_actions": 8.54104470576825e-06, "get_actions": 4.4036058416779704e-05, "listify_data_for_vector_env": 1.1887370528650847e-05, "un_batch_to_individual_items": 7.963946114016578e-06, "tensor_to_numpy": 1.7635411850424898e-05}}, "connector_pipeline_timer": 0.00013346233495985861}, "env_to_module_sum_episodes_length_in": 10.368205581254823, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 0.9833333333333333}, "episode_return_mean": 0.9833333333333333, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "env_to_module_sum_episodes_length_out": 10.368205581254823, "num_env_steps_sampled": 400, "weights_seq_no": 3.0, "episode_len_max": 20, "episode_return_min": -13.5, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 0.9833333333333333}, "num_episodes_lifetime": 60, "episode_len_min": 20, "env_step_timer": 1.674113738637332e-05, "num_env_steps_sampled_lifetime": 15400, "rlmodule_inference_timer": 3.7576813129235684e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "time_between_sampling": 9.383719443356386}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "b19cd_00000", "date": "2025-08-11_18-40-22", "timestamp": 1754930422, "time_this_iter_s": 10.554588079452515, "time_total_s": 29.268985986709595, "pid": 11628, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1629fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 29.268985986709595, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 51.64, "ram_util_percent": 79.02666666666666}}
{"timers": {"training_iteration": 9.141910218101305, "restore_env_runners": 9.494263012660668e-06, "training_step": 9.141787225648544, "env_runner_sampling_timer": 1.6710285487827108, "learner_update_timer": 7.298052696291956, "synch_weights": 0.0008236847985696513, "restore_eval_env_runners": 9.378495172131806e-06, "evaluation_iteration": 0.12734902315901128, "synch_eval_env_connectors": 0.0001832263493910432, "synch_env_connectors": 4.62495534447953e-06}, "env_runners": {"env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "env_reset_timer": 4.694154048808361e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.272840862154087e-05, "listify_data_for_vector_env": 1.0986803505424405e-05, "tensor_to_numpy": 1.6085236471279623e-05, "un_batch_to_individual_items": 6.9733245577910015e-06, "remove_single_ts_time_rank_from_batch": 1.2395246944055295e-05, "normalize_and_clip_actions": 8.382171633834966e-06}}, "connector_pipeline_timer": 0.00012502113642402614}, "episode_duration_sec_mean": 0.0055688696783036, "sample": 0.006174730318500474, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.816697977920283e-06, "numpy_to_tensor": 1.3484385723388663e-05, "batch_individual_items": 1.3148713686098004e-05, "add_observations_from_episodes_to_batch": 2.92217957070177e-06, "add_time_dim_to_batch_and_zero_pad": 7.347519574855454e-06}}, "connector_pipeline_timer": 6.267085247458416e-05}, "agent_episode_returns_mean": {"default_agent": 2.8199999999999994}, "time_between_sampling": 0.03588626074132972, "weights_seq_no": 3.0, "num_episodes_lifetime": -61250.0, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 2.8199999999999994}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "episode_return_mean": 2.8199999999999994, "episode_len_max": 20, "env_step_timer": 1.5000908493942007e-05, "num_env_steps_sampled_lifetime": -1225000.0, "episode_len_mean": 20.0, "rlmodule_inference_timer": 3.3469309876077876e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime_throughput": 3059.3471407128177}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13540242792340193, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009056250636141861, "add_observations_from_episodes_to_batch": 0.0008867491411740192, "add_columns_from_episodes_to_train_batch": 0.04195732937115104, "add_time_dim_to_batch_and_zero_pad": 0.07549213852109586, "add_states_from_episodes_to_batch": 0.0035477548963887386, "batch_individual_items": 0.004247184261595015, "numpy_to_tensor": 6.409232733759564e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 21.0, "module_train_batch_size_mean": 997.6156867483631, "total_loss": 0.0, "weights_seq_no": 24.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 143640}, "default_policy": {"module_train_batch_size_mean": 997.6156867483631, "mean_kl_loss": 2.8836075216531754e-05, "weights_seq_no": 24.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 143640, "diff_num_grad_updates_vs_sampler_policy": 21.0, "use_intrinsic_rewards": 1.0, "entropy": 0.6818796396255493, "vf_loss_unclipped": 45.27812576293945, "vf_explained_var": 0.0035742521286010742, "policy_loss": -0.0001324838522123173, "total_loss": 0.278006911277771, "vf_loss": 0.35836800932884216}, "__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 287280, "num_env_steps_trained_lifetime": 792000, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 59200.641008356695}}}, "default_policy": {"curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.3583156168460846, "mean_kl_loss": 2.941702950920444e-05, "num_module_steps_trained_lifetime": 23940, "module_train_batch_size_mean": 997.8923005732703, "weights_seq_no": 4.0, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 16595, "use_intrinsic_rewards": 0.0, "entropy": 0.6818684339523315, "vf_loss_unclipped": 45.35639190673828, "vf_explained_var": -0.0012418031692504883, "curr_kl_coeff": 0.010098995640873909, "policy_loss": -0.00013174372725188732, "total_loss": 0.2779627740383148, "num_module_steps_trained_lifetime_throughput": 822.5095665540881}, "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 997.8923005732703, "weights_seq_no": 4.0, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 23940, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 822.5249624275101}, "__all_modules__": {"num_env_steps_trained_lifetime": 132000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 33000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 47880, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4537.0402715858545, "num_module_steps_trained_throughput": 29618127.612626474, "num_module_steps_trained_lifetime_throughput": 13115146.88220821}, "IntrinsicAttentionMask": [[[0.09062863886356354, 0.09075549989938736, 0.09101918339729309, 0.09082392603158951, 0.09108781814575195, 0.09057063609361649, 0.09060477465391159, 0.09119085222482681, 0.09099522233009338, 0.09125960618257523, 0.09106383472681046], [0.09065569937229156, 0.09077034145593643, 0.09100858122110367, 0.0908321738243103, 0.09107057005167007, 0.09060327708721161, 0.09063412994146347, 0.09116364270448685, 0.09098692983388901, 0.09122573584318161, 0.09104891121387482], [0.09071183204650879, 0.09080111235380173, 0.09098655730485916, 0.09084925055503845, 0.09103479236364365, 0.09067100286483765, 0.09069503843784332, 0.09110720455646515, 0.09096971154212952, 0.091155506670475, 0.0910179391503334], [0.09067028015851974, 0.09077833592891693, 0.09100285917520523, 0.09083660691976547, 0.09106127917766571, 0.09062086790800095, 0.09064995497465134, 0.0911489799618721, 0.09098245948553085, 0.09120748937129974, 0.09104086458683014], [0.09072642773389816, 0.09080911427736282, 0.09098085016012192, 0.09085369110107422, 0.09102552384138107, 0.09068861603736877, 0.09071087092161179, 0.0910925567150116, 0.09096524864435196, 0.09113728255033493, 0.09100990742444992], [0.09061625599861145, 0.09074870496988297, 0.09102404117584229, 0.09082015603780746, 0.0910957083106041, 0.09055570513010025, 0.09059134870767593, 0.09120330959558487, 0.09099902212619781, 0.09127511084079742, 0.09107065945863724], [0.09062353521585464, 0.09075270593166351, 0.09102118015289307, 0.09082236886024475, 0.09109105169773102, 0.09056449681520462, 0.09059924632310867, 0.0911959633231163, 0.09099677950143814, 0.0912659764289856, 0.0910666286945343], [0.09074829518795013, 0.09082108736038208, 0.09097225219011307, 0.09086032956838608, 0.09101156145334244, 0.09071499854326248, 0.09073460102081299, 0.09107056260108948, 0.09095852077007294, 0.09110991656780243, 0.09099783003330231], [0.0907067283987999, 0.09079831838607788, 0.09098855406045914, 0.0908476933836937, 0.0910380408167839, 0.09066485613584518, 0.09068950265645981, 0.09111232310533524, 0.09097127616405487, 0.09116187691688538, 0.09102074801921844], [0.09076288342475891, 0.09082907438278198, 0.09096653014421463, 0.09086476266384125, 0.09100227057933807, 0.09073260426521301, 0.09075042605400085, 0.09105590730905533, 0.09095405042171478, 0.09109168499708176, 0.09098978340625763], [0.09072132408618927, 0.09080631285905838, 0.0909828394651413, 0.09085214138031006, 0.09102875739336014, 0.09068245440721512, 0.09070533514022827, 0.09109767526388168, 0.09096680581569672, 0.0911436453461647, 0.09101271629333496]], [[0.09084583073854446, 0.09061772376298904, 0.09071832150220871, 0.09067191928625107, 0.09069902449846268, 0.09054465591907501, 0.09057172387838364, 0.0910361185669899, 0.09255145490169525, 0.090743787586689, 0.09099940210580826], [0.0908278301358223, 0.09053698182106018, 0.09066522866487503, 0.09060605615377426, 0.09064061939716339, 0.09044385701417923, 0.09047835320234299, 0.09107061475515366, 0.09300896525382996, 0.09069769084453583, 0.0910237580537796], [0.0908358097076416, 0.09057264029979706, 0.09068869054317474, 0.09063515067100525, 0.09066642075777054, 0.09048835933208466, 0.09051958471536636, 0.09105542302131653, 0.09280680865049362, 0.09071806818246841, 0.09101304411888123], [0.09083213657140732, 0.09055620431900024, 0.09067787230014801, 0.09062174707651138, 0.09065452963113785, 0.09046784043312073, 0.09050057083368301, 0.09106243401765823, 0.09289999306201935, 0.09070868045091629, 0.09101799875497818], [0.09083428233861923, 0.09056580066680908, 0.0906841903924942, 0.09062957763671875, 0.09066147357225418, 0.09047982841730118, 0.09051167219877243, 0.09105833619832993, 0.09284554421901703, 0.09071415662765503, 0.09101510792970657], [0.0908220037817955, 0.09051104635000229, 0.09064814448356628, 0.0905848890542984, 0.09062183648347855, 0.0904114842414856, 0.09044835716485977, 0.0910816341638565, 0.09315619617700577, 0.09068285673856735, 0.0910315290093422], [0.0908241719007492, 0.09052065759897232, 0.09065448492765427, 0.09059274196624756, 0.09062880277633667, 0.09042348712682724, 0.09045948088169098, 0.09107755869626999, 0.0931016206741333, 0.09068836271762848, 0.09102865308523178], [0.09086062759160995, 0.09068479388952255, 0.09076234698295593, 0.0907265767455101, 0.09074746817350388, 0.09062844514846802, 0.0906493216753006, 0.09100722521543503, 0.09217219799757004, 0.09078197181224823, 0.0909789502620697], [0.09097157418727875, 0.09120979905128479, 0.09110458940267563, 0.0911530926823616, 0.0911247506737709, 0.09128636866807938, 0.0912579894065857, 0.09077377617359161, 0.08922825753688812, 0.09107799828052521, 0.09081187099218369], [0.09083782136440277, 0.09058165550231934, 0.0906946212053299, 0.09064250439405441, 0.09067294746637344, 0.09049960970878601, 0.09053000062704086, 0.09105157107114792, 0.0927557423710823, 0.09072321653366089, 0.09101033210754395], [0.09085778892040253, 0.09067188203334808, 0.09075387567281723, 0.09071605652570724, 0.09073814749717712, 0.09061230719089508, 0.09063437581062317, 0.09101281315088272, 0.0922452062368393, 0.09077463299036026, 0.09098291397094727]], [[0.09125636518001556, 0.09078596532344818, 0.09098511934280396, 0.09083765745162964, 0.09103692322969437, 0.09088938683271408, 0.0906720757484436, 0.09111468493938446, 0.09072370082139969, 0.09092271327972412, 0.09077535569667816], [0.0914740189909935, 0.09070892632007599, 0.09103253483772278, 0.09079287946224213, 0.09111679345369339, 0.09087692201137543, 0.09052404761314392, 0.09124332666397095, 0.09060782939195633, 0.09093108773231506, 0.0906917005777359], [0.09138168394565582, 0.0907415971159935, 0.09101244062185287, 0.09081187844276428, 0.09108293056488037, 0.09088221192359924, 0.09058679640293121, 0.09118877351284027, 0.09065695106983185, 0.09092754870653152, 0.09072717279195786], [0.09145002067089081, 0.09071740508079529, 0.09102731198072433, 0.09079781919717789, 0.09110799431800842, 0.09087829291820526, 0.0905403420329094, 0.091229148209095, 0.09062058478593826, 0.09093016386032104, 0.0907009094953537], [0.09135770797729492, 0.0907500758767128, 0.09100721031427383, 0.09081681072711945, 0.091074138879776, 0.09088359028100967, 0.09060309082269669, 0.09117460250854492, 0.09066971391439438, 0.0909266248345375, 0.09073638916015625], [0.09142603725194931, 0.09072589874267578, 0.09102209657430649, 0.09080275148153305, 0.09109920263290405, 0.09087967127561569, 0.09055665135383606, 0.09121498465538025, 0.09063335508108139, 0.09092925488948822, 0.09071013331413269], [0.09152694046497345, 0.09069019556045532, 0.09104403108358383, 0.09078197926282883, 0.09113617986440659, 0.09087386727333069, 0.09048809856176376, 0.09127457439899445, 0.09057968854904175, 0.09093309193849564, 0.0906713679432869], [0.09132175892591476, 0.09076281636953354, 0.09099938720464706, 0.09082420915365219, 0.09106094390153885, 0.09088564664125443, 0.09062755852937698, 0.0911533534526825, 0.09068886190652847, 0.09092524647712708, 0.09075020998716354], [0.09150292724370956, 0.09069867432117462, 0.09103880822658539, 0.09078691899776459, 0.09112737327814102, 0.09087523818016052, 0.09050438553094864, 0.0912603884935379, 0.09059243649244308, 0.09093216806650162, 0.0906805768609047], [0.09141059219837189, 0.09073137491941452, 0.09101873636245728, 0.09080593287944794, 0.09109354019165039, 0.09088056534528732, 0.09056714922189713, 0.09120585769414902, 0.0906415805220604, 0.09092865884304047, 0.09071607142686844], [0.09147893637418747, 0.09070717543363571, 0.09103360027074814, 0.09079185873270035, 0.09111858904361725, 0.09087662398815155, 0.09052068740129471, 0.09124622493982315, 0.09060520678758621, 0.09093126654624939, 0.09068979322910309]], [[0.09082265198230743, 0.09084980189800262, 0.09044040739536285, 0.0909041315317154, 0.09067588299512863, 0.09052154421806335, 0.09080368280410767, 0.09075722843408585, 0.092527836561203, 0.09072063118219376, 0.09097618609666824], [0.09082553535699844, 0.0908517986536026, 0.0904557928442955, 0.0909043475985527, 0.09068357199430466, 0.0905342772603035, 0.09080719202756882, 0.09076225757598877, 0.09247436374425888, 0.09072685241699219, 0.09097403287887573], [0.09078162908554077, 0.09082133322954178, 0.09022336453199387, 0.09090077877044678, 0.09056714177131653, 0.09034177660942078, 0.09075390547513962, 0.09068600833415985, 0.09328529983758926, 0.09063252061605453, 0.09100618213415146], [0.09083127975463867, 0.09085576236248016, 0.09048653393983841, 0.09090474992990494, 0.09069892764091492, 0.09055972844362259, 0.09081418067216873, 0.09077229350805283, 0.09236748516559601, 0.09073928743600845, 0.09096971899271011], [0.0908070057630539, 0.0908389687538147, 0.09035719931125641, 0.09090293198823929, 0.09063424915075302, 0.0904526561498642, 0.09078467637300491, 0.09072999656200409, 0.09281766414642334, 0.09068691730499268, 0.09098777174949646], [0.09079041332006454, 0.09082744270563126, 0.090269535779953, 0.09090155363082886, 0.09059032052755356, 0.09038003534078598, 0.09076455235481262, 0.09070121496915817, 0.09312379360198975, 0.09065131843090057, 0.09099986404180527], [0.09082064032554626, 0.090848408639431, 0.09042967110872269, 0.09090398252010345, 0.09067051112651825, 0.09051265567541122, 0.09080123156309128, 0.0907537192106247, 0.09256522357463837, 0.09071628004312515, 0.09097768366336823], [0.09081568568944931, 0.09084498137235641, 0.09040334075689316, 0.09090360254049301, 0.09065733850002289, 0.09049085527658463, 0.09079521894454956, 0.09074510633945465, 0.09265685826539993, 0.09070561826229095, 0.09098134934902191], [0.09099581837654114, 0.09096752852201462, 0.09139591455459595, 0.09091097861528397, 0.09114903956651688, 0.09131069481372833, 0.09101559221744537, 0.09106405079364777, 0.0892520397901535, 0.09110226482152939, 0.09083607792854309], [0.09081178158521652, 0.09084228426218033, 0.09038259088993073, 0.09090330451726913, 0.09064695984125137, 0.09047367423772812, 0.09079048037528992, 0.09073831140995026, 0.09272915869951248, 0.09069721400737762, 0.09098424762487411], [0.09083889424800873, 0.09086102247238159, 0.09052729606628418, 0.09090528637170792, 0.09071927517652512, 0.09059345722198486, 0.09082344174385071, 0.09078558534383774, 0.09222602099180222, 0.09075575321912766, 0.09096398949623108]], [[0.09130075573921204, 0.09058717638254166, 0.09078589081764221, 0.09063875675201416, 0.09108120203018188, 0.09093359857797623, 0.09071618318557739, 0.09091518074274063, 0.09101127088069916, 0.09096693992614746, 0.09106309711933136], [0.09167368710041046, 0.09028221666812897, 0.09066866338253021, 0.09038244932889938, 0.09124447405338287, 0.0909564346075058, 0.09053301066160202, 0.09092053025960922, 0.09110795706510544, 0.09102146327495575, 0.09120910614728928], [0.0915694311261177, 0.09036731719970703, 0.09070142358541489, 0.09045398980379105, 0.0911988914012909, 0.09095010161399841, 0.0905841663479805, 0.09091906994581223, 0.09108098596334457, 0.09100627899169922, 0.0911683440208435], [0.09164659678936005, 0.09030432254076004, 0.0906771793961525, 0.09040103107690811, 0.09123263508081436, 0.09095479547977448, 0.09054630249738693, 0.09092015027999878, 0.09110095351934433, 0.09101752936840057, 0.09119851887226105], [0.09141506999731064, 0.09049353748559952, 0.09074994921684265, 0.09056007862091064, 0.09113132208585739, 0.09094065427780151, 0.0906599834561348, 0.09091686457395554, 0.09104097634553909, 0.09098371863365173, 0.09110791981220245], [0.09149213880300522, 0.09043049067258835, 0.09072571992874146, 0.09050709009170532, 0.09116506576538086, 0.09094537794589996, 0.09062211960554123, 0.09091797471046448, 0.09106096625328064, 0.09099499136209488, 0.09113810211420059], [0.09160596132278442, 0.09033747017383575, 0.09068993479013443, 0.0904289111495018, 0.0912148654460907, 0.0909523218870163, 0.0905662253499031, 0.09091957658529282, 0.09109043329954147, 0.09101160615682602, 0.0911826342344284], [0.09150176495313644, 0.0904226154088974, 0.09072268754243851, 0.09050047397613525, 0.09116927534341812, 0.09094596654176712, 0.09061738103628159, 0.09091811627149582, 0.09106346219778061, 0.0909963995218277, 0.09114187210798264], [0.09145155549049377, 0.09046366810798645, 0.09073846787214279, 0.09053497761487961, 0.0911472961306572, 0.0909428820014, 0.090642049908638, 0.09091738611459732, 0.09105043858289719, 0.09098905324935913, 0.09112221002578735], [0.09147470444440842, 0.09044472873210907, 0.0907311886548996, 0.09051906317472458, 0.09115742892026901, 0.090944305062294, 0.0906306728720665, 0.09091771394014359, 0.0910564437508583, 0.09099243581295013, 0.09113127738237381], [0.09142450243234634, 0.09048578888177872, 0.09074696153402328, 0.09055356681346893, 0.09113544225692749, 0.09094122052192688, 0.09065532684326172, 0.09091698378324509, 0.09104341268539429, 0.09098508208990097, 0.09111160784959793]], [[0.09088482707738876, 0.09113973379135132, 0.09100010991096497, 0.09118879586458206, 0.09121333062648773, 0.09084329009056091, 0.09109809994697571, 0.09128697961568832, 0.08937328308820724, 0.09102309495210648, 0.09094847738742828], [0.09089434891939163, 0.09105252474546432, 0.09096591174602509, 0.09108295291662216, 0.09109815955162048, 0.09086856991052628, 0.09102670103311539, 0.09114381670951843, 0.08995296061038971, 0.0909801796078682, 0.09093386679887772], [0.09088917821645737, 0.0911002978682518, 0.09098467230796814, 0.09114091843366623, 0.09116122871637344, 0.09085477143526077, 0.09106581658124924, 0.09122219681739807, 0.0896352231502533, 0.09100370854139328, 0.0909419059753418], [0.0908961370587349, 0.09103574603796005, 0.09095929563045502, 0.09106258302927017, 0.09107600897550583, 0.09087338298559189, 0.09101294726133347, 0.0911162942647934, 0.09006470441818237, 0.09097188711166382, 0.09093102067708969], [0.09089703112840652, 0.09102734178304672, 0.09095598757266998, 0.09105240553617477, 0.0910649299621582, 0.0908757820725441, 0.0910060703754425, 0.09110253304243088, 0.09012062847614288, 0.09096773713827133, 0.09092959016561508], [0.09088323265314102, 0.09115393459796906, 0.09100565314292908, 0.09120603650808334, 0.09123209863901138, 0.09083913266658783, 0.09110970795154572, 0.09131032228469849, 0.08927901834249496, 0.0910300686955452, 0.09095082432031631], [0.09089282900094986, 0.09106677770614624, 0.09097151458263397, 0.09110023826360703, 0.09111697226762772, 0.09086447209119797, 0.09103836864233017, 0.09116718918085098, 0.08985814452171326, 0.0909872055053711, 0.09093628078699112], [0.09089966863393784, 0.09100212156772614, 0.0909460261464119, 0.0910218209028244, 0.09103167057037354, 0.09088295698165894, 0.09098539501428604, 0.09106122702360153, 0.09028857201337814, 0.09095526486635208, 0.09092526137828827], [0.09081944078207016, 0.09165526926517487, 0.09119679033756256, 0.0918167233467102, 0.09189755469560623, 0.09068378806114197, 0.09151836484670639, 0.09214047342538834, 0.08597174286842346, 0.09127216041088104, 0.0910276547074318], [0.09089004993438721, 0.09109244495630264, 0.09098159521818161, 0.09113138169050217, 0.09115085005760193, 0.09085706621408463, 0.09105938673019409, 0.0912092998623848, 0.08968751132488251, 0.09099985659122467, 0.09094060212373734], [0.09088724106550217, 0.0911179706454277, 0.09099159389734268, 0.09116236120462418, 0.09118456393480301, 0.09084964543581009, 0.09108027815818787, 0.09125120937824249, 0.08951786905527115, 0.09101240336894989, 0.09094486385583878]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_return_max": 13.5, "env_reset_timer": 0.0005735008911071344, "episode_duration_sec_mean": 0.005425822336110287, "sample": 0.11651713753203943, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1631585358239639e-05, "batch_individual_items": 1.2305717903999445e-05, "add_time_dim_to_batch_and_zero_pad": 6.907956430499369e-06, "add_observations_from_episodes_to_batch": 2.8070332966094813e-06, "add_states_from_episodes_to_batch": 2.721058225741425e-06}}, "connector_pipeline_timer": 5.851608915146303e-05}, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.185235325920931e-05, "normalize_and_clip_actions": 7.819650737992725e-06, "get_actions": 3.54587242055642e-05, "listify_data_for_vector_env": 1.0273686343625578e-05, "un_batch_to_individual_items": 6.640723285774722e-06, "tensor_to_numpy": 1.4776506032717896e-05}}, "connector_pipeline_timer": 0.000112881102101097}, "env_to_module_sum_episodes_length_in": 10.368237912813044, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 1.15}, "episode_return_mean": 1.15, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "env_to_module_sum_episodes_length_out": 10.368237912813044, "num_env_steps_sampled": 400, "weights_seq_no": 4.0, "episode_len_max": 20, "episode_return_min": -13.5, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 1.15}, "num_episodes_lifetime": 80, "episode_len_min": 20, "env_step_timer": 1.3779399942493072e-05, "num_env_steps_sampled_lifetime": 20400, "rlmodule_inference_timer": 3.0696341754547336e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "time_between_sampling": 9.381019845172869}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "b19cd_00000", "date": "2025-08-11_18-40-32", "timestamp": 1754930432, "time_this_iter_s": 9.20136308670044, "time_total_s": 38.470349073410034, "pid": 11628, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1629fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 38.470349073410034, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 40.51538461538461, "ram_util_percent": 78.21538461538462}}
{"timers": {"training_iteration": 9.143829583010216, "restore_env_runners": 9.457240497602616e-06, "training_step": 9.143705192973036, "env_runner_sampling_timer": 1.6696755495451023, "learner_update_timer": 7.301253142668396, "synch_weights": 0.0008265162909748754, "restore_eval_env_runners": 9.393459593295118e-06, "evaluation_iteration": 0.12725209167670576, "synch_eval_env_connectors": 0.00018265491505526008, "synch_env_connectors": 4.6270356118911875e-06}, "env_runners": {"env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "env_reset_timer": 3.957979326963918e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.966384686132582e-05, "listify_data_for_vector_env": 1.0586471716527188e-05, "tensor_to_numpy": 1.5258780236246116e-05, "un_batch_to_individual_items": 6.666021803985971e-06, "remove_single_ts_time_rank_from_batch": 1.2011650041869815e-05, "normalize_and_clip_actions": 7.992426362224501e-06}}, "connector_pipeline_timer": 0.00011867088221131928}, "episode_duration_sec_mean": 0.005297997826244679, "sample": 0.00577897322150134, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.71386640425792e-06, "numpy_to_tensor": 1.2680315462479338e-05, "batch_individual_items": 1.2597690848656353e-05, "add_observations_from_episodes_to_batch": 2.784906279277275e-06, "add_time_dim_to_batch_and_zero_pad": 6.887645061563133e-06}}, "connector_pipeline_timer": 5.981351779119239e-05}, "agent_episode_returns_mean": {"default_agent": 2.660000000000001}, "time_between_sampling": 0.03128214360093016, "weights_seq_no": 4.0, "num_episodes_lifetime": -92125.0, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 2.660000000000001}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "episode_return_mean": 2.660000000000001, "episode_len_max": 20, "env_step_timer": 1.4114695220235338e-05, "num_env_steps_sampled_lifetime": -1842500.0, "episode_len_mean": 20.0, "rlmodule_inference_timer": 3.171081860805302e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime_throughput": 3249.9586061125224}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1353664082341614, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00905242021045238, "add_observations_from_episodes_to_batch": 0.0008861366497556481, "add_columns_from_episodes_to_train_batch": 0.041945085247705696, "add_time_dim_to_batch_and_zero_pad": 0.07547662463567135, "add_states_from_episodes_to_batch": 0.0035474660973230762, "batch_individual_items": 0.00424412074815485, "numpy_to_tensor": 6.41772338052059e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 26.0, "module_train_batch_size_mean": 997.5798029998547, "total_loss": 0.0, "weights_seq_no": 30.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 179550}, "default_policy": {"module_train_batch_size_mean": 997.5798029998547, "mean_kl_loss": 2.508835677872412e-05, "weights_seq_no": 30.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 179550, "diff_num_grad_updates_vs_sampler_policy": 26.0, "use_intrinsic_rewards": 1.0, "entropy": 0.6807472705841064, "vf_loss_unclipped": 45.06739044189453, "vf_explained_var": 0.003572702407836914, "policy_loss": -0.00013621915422845632, "total_loss": 0.2780044972896576, "vf_loss": 0.3583682179450989}, "__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 359100, "num_env_steps_trained_lifetime": 990000, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 58311.02232285575}}}, "default_policy": {"curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.35830530524253845, "mean_kl_loss": 2.565068098192569e-05, "num_module_steps_trained_lifetime": 29925, "module_train_batch_size_mean": 997.8691961675322, "weights_seq_no": 5.0, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 16595, "use_intrinsic_rewards": 0.0, "entropy": 0.6807351112365723, "vf_loss_unclipped": 45.16712951660156, "vf_explained_var": -0.00018906593322753906, "curr_kl_coeff": 0.0050494978204369545, "policy_loss": -0.00013711907377000898, "total_loss": 0.27795079350471497, "num_module_steps_trained_lifetime_throughput": 819.0333049081156}, "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 997.8691961675322, "weights_seq_no": 5.0, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 29925, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 819.048079013168}, "__all_modules__": {"num_env_steps_trained_lifetime": 165000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 33000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 59850, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4517.816603179588, "num_module_steps_trained_throughput": 28827320.125806086, "num_module_steps_trained_lifetime_throughput": 13089605.257773513}, "IntrinsicAttentionMask": [[[0.09062867611646652, 0.09075553715229034, 0.09069700539112091, 0.09082396328449249, 0.09108785539865494, 0.09057067334651947, 0.09092669934034348, 0.0911908894777298, 0.09099525958299637, 0.09125964343547821, 0.09106387197971344], [0.09065572172403336, 0.09077036380767822, 0.09071747213602066, 0.0908321961760521, 0.09107059240341187, 0.0906032994389534, 0.09092501550912857, 0.09116366505622864, 0.0909869521856308, 0.0912257581949234, 0.09104893356561661], [0.09064323455095291, 0.09076351672410965, 0.09070802479982376, 0.09082838892936707, 0.09107854217290878, 0.09058824926614761, 0.09092578291893005, 0.09117620438337326, 0.09099077433347702, 0.09124137461185455, 0.09105581045150757], [0.09067030251026154, 0.09077835828065872, 0.0907285064458847, 0.09083662927150726, 0.0910613015294075, 0.09062089025974274, 0.09092411398887634, 0.09114900231361389, 0.09098248183727264, 0.09120751172304153, 0.09104088693857193], [0.09072642773389816, 0.09080911427736282, 0.09077097475528717, 0.09085369110107422, 0.09102552384138107, 0.09068861603736877, 0.09092061221599579, 0.0910925567150116, 0.09096524864435196, 0.09113728255033493, 0.09100990742444992], [0.09061629325151443, 0.09074874222278595, 0.09068764001131058, 0.09082019329071045, 0.09109574556350708, 0.09055574238300323, 0.09092746675014496, 0.09120334684848785, 0.0909990593791008, 0.09127514809370041, 0.09107069671154022], [0.09069216996431351, 0.09079033881425858, 0.09074505418539047, 0.09084328263998032, 0.09104735404253006, 0.09064727276563644, 0.0909227505326271, 0.09112700074911118, 0.09097576141357422, 0.09118013828992844, 0.09102880954742432], [0.09074831008911133, 0.09082110226154327, 0.09078752249479294, 0.09086034446954727, 0.09101157635450363, 0.09071501344442368, 0.09091924875974655, 0.09107057750225067, 0.09095853567123413, 0.09110993146896362, 0.0909978449344635], [0.09070674329996109, 0.09079833328723907, 0.09075608104467392, 0.09084770828485489, 0.0910380557179451, 0.09066487103700638, 0.09092183411121368, 0.09111233800649643, 0.09097129106521606, 0.09116189181804657, 0.09102076292037964], [0.09076289087533951, 0.09082908183336258, 0.09079855680465698, 0.09086477011442184, 0.09100227802991867, 0.09073261171579361, 0.09091833233833313, 0.09105591475963593, 0.09095405787229538, 0.09109169244766235, 0.09098979085683823], [0.09072133153676987, 0.09080632030963898, 0.09076711535453796, 0.09085214883089066, 0.09102876484394073, 0.09068246185779572, 0.09092092514038086, 0.09109768271446228, 0.09096681326627731, 0.0911436527967453, 0.09101272374391556]], [[0.09072956442832947, 0.09075668454170227, 0.09060221910476685, 0.09081096202135086, 0.0905829444527626, 0.09068350493907928, 0.0907106101512909, 0.09066420793533325, 0.09269338101148605, 0.09088294208049774, 0.09088294208049774], [0.09073550254106522, 0.09076174348592758, 0.09061232954263687, 0.09081424027681351, 0.09059368073940277, 0.09069095551967621, 0.09071718156337738, 0.09067229181528091, 0.09263439476490021, 0.09088385850191116, 0.09088385850191116], [0.0907016173005104, 0.09073290973901749, 0.09055471420288086, 0.09079552441835403, 0.09053247421979904, 0.09064847975969315, 0.09067974984645844, 0.09062622487545013, 0.09297102689743042, 0.09087859094142914, 0.09087859094142914], [0.09074736386537552, 0.09077182412147522, 0.09063251316547394, 0.09082076698541641, 0.09061512351036072, 0.09070581942796707, 0.09073027223348618, 0.09068842232227325, 0.09251649677753448, 0.09088566899299622, 0.09088566899299622], [0.09069739282131195, 0.09072931855916977, 0.09054753184318542, 0.09079320728778839, 0.09052484482526779, 0.09064318239688873, 0.09067509323358536, 0.0906204804778099, 0.09301317483186722, 0.0908779427409172, 0.0908779427409172], [0.09071947634220123, 0.09074810892343521, 0.09058506041765213, 0.09080539643764496, 0.09056471288204193, 0.0906708613038063, 0.09069947898387909, 0.09065049141645432, 0.09279368072748184, 0.09088138490915298, 0.09088138490915298], [0.09072541445493698, 0.09075316041707993, 0.09059516340494156, 0.0908086746931076, 0.0905754491686821, 0.09067830443382263, 0.09070603549480438, 0.09065856784582138, 0.09273462742567062, 0.0908823013305664, 0.0908823013305664], [0.09071522951126099, 0.0907444953918457, 0.0905778557062149, 0.09080304950475693, 0.09055706113576889, 0.0906655341386795, 0.09069478511810303, 0.0906447246670723, 0.09283572435379028, 0.09088071435689926, 0.09088071435689926], [0.09114618599414825, 0.09110944718122482, 0.0913190171122551, 0.09103600680828094, 0.09134522825479507, 0.09120863676071167, 0.09117186814546585, 0.09123481065034866, 0.08855131268501282, 0.09093876928091049, 0.09093876928091049], [0.09076307713985443, 0.0907851830124855, 0.09065927565097809, 0.09082941710948944, 0.09064355492591858, 0.09072553366422653, 0.09074763208627701, 0.09070980548858643, 0.0923604741692543, 0.09088806807994843, 0.09088806807994843], [0.09076307713985443, 0.0907851830124855, 0.09065927565097809, 0.09082941710948944, 0.09064355492591858, 0.09072553366422653, 0.09074763208627701, 0.09070980548858643, 0.0923604741692543, 0.09088806807994843, 0.09088806807994843]], [[0.09123413264751434, 0.09076385200023651, 0.09071964025497437, 0.09081552922725677, 0.09077129513025284, 0.09086724370718002, 0.09089310467243195, 0.09109248965978622, 0.09070159494876862, 0.09114436060190201, 0.0909966453909874], [0.09143780171871185, 0.09067300707101822, 0.09060124307870865, 0.09075693786144257, 0.09068509936332703, 0.09084093570709229, 0.09088297188282013, 0.09120719879865646, 0.09057195484638214, 0.09129162132740021, 0.09105128794908524], [0.09145700931549072, 0.09066443145275116, 0.09059006720781326, 0.09075139462947845, 0.09067695587873459, 0.09083843976259232, 0.09088199585676193, 0.091218002140522, 0.09055972844362259, 0.09130549430847168, 0.09105642139911652], [0.09141535311937332, 0.09068301320075989, 0.09061428159475327, 0.0907633975148201, 0.09069459140300751, 0.09084384143352509, 0.09088408946990967, 0.09119456261396408, 0.09058623760938644, 0.09127539396286011, 0.09104527533054352], [0.09143456816673279, 0.09067445248365402, 0.09060311317443848, 0.09075786918401718, 0.09068647027015686, 0.09084135293960571, 0.09088312834501266, 0.09120538085699081, 0.09057401865720749, 0.09128928184509277, 0.0910504162311554], [0.09139291197061539, 0.09069302678108215, 0.09062732011079788, 0.09076985716819763, 0.09070409089326859, 0.09084674715995789, 0.0908852145075798, 0.0911819338798523, 0.09060051292181015, 0.0912591740489006, 0.0910392552614212], [0.09138169139623642, 0.09069803357124329, 0.09063384681940079, 0.0907730832695961, 0.09070883691310883, 0.09084819257259369, 0.09088578075170517, 0.0911756157875061, 0.0906076580286026, 0.09125106036663055, 0.09103625267744064], [0.09129533171653748, 0.09073654562234879, 0.09068404138088226, 0.09079792350530624, 0.09074538201093674, 0.09085934609174728, 0.090890072286129, 0.09112697839736938, 0.09066262096166611, 0.09118862450122833, 0.09101308882236481], [0.09146485477685928, 0.0906609371304512, 0.09058551490306854, 0.09074913710355759, 0.09067364037036896, 0.09083742648363113, 0.0908816009759903, 0.09122241288423538, 0.09055474400520325, 0.09131116420030594, 0.09105852246284485], [0.09127291291952133, 0.09074655175209045, 0.09069708734750748, 0.09080438315868378, 0.09075488150119781, 0.09086224436759949, 0.09089119732379913, 0.0911143496632576, 0.09067690372467041, 0.09117241203784943, 0.09100706875324249], [0.09133680909872055, 0.09071803838014603, 0.09065991640090942, 0.09078598767518997, 0.09072782844305038, 0.0908539891242981, 0.09088800847530365, 0.09115033596754074, 0.09063620865345001, 0.09121861308813095, 0.09102421253919601]], [[0.09104499220848083, 0.09106109291315079, 0.09096938371658325, 0.09094185382127762, 0.09095793217420578, 0.0908663272857666, 0.09103374928236008, 0.09100619703531265, 0.09004700928926468, 0.09113600105047226, 0.09093546122312546], [0.09103748202323914, 0.09105268865823746, 0.09096606820821762, 0.09094006568193436, 0.09095525741577148, 0.09086872637271881, 0.09102685749530792, 0.09100084006786346, 0.09009460359811783, 0.09112343937158585, 0.09093402326107025], [0.09108027070760727, 0.09110057353973389, 0.09098494797945023, 0.09095024317502975, 0.09097051620483398, 0.09085505455732346, 0.09106609225273132, 0.09103135764598846, 0.08982367813587189, 0.09119504690170288, 0.09094218164682388], [0.09109312295913696, 0.09111495316028595, 0.09099061042070389, 0.0909532904624939, 0.0909750834107399, 0.09085093438625336, 0.09107787162065506, 0.09104051440954208, 0.08974245190620422, 0.0912165567278862, 0.09094462543725967], [0.09108562022447586, 0.09110655635595322, 0.09098730981349945, 0.09095151722431183, 0.0909724161028862, 0.09085334837436676, 0.0910709947347641, 0.09103517234325409, 0.08978989720344543, 0.09120399504899979, 0.09094320237636566], [0.09112834185361862, 0.09115438163280487, 0.09100610017776489, 0.09096159785985947, 0.09098758548498154, 0.09083957225084305, 0.09111014753580093, 0.09106560051441193, 0.08951980620622635, 0.09127557277679443, 0.09095127135515213], [0.09105024486780167, 0.09106697142124176, 0.09097170829772949, 0.0909431055188179, 0.0909598097205162, 0.09086465835571289, 0.09103856235742569, 0.0910099446773529, 0.0900137647986412, 0.09114478528499603, 0.09093646705150604], [0.09106309711933136, 0.09108135104179382, 0.09097737073898315, 0.09094616770744324, 0.09096439927816391, 0.09086054563522339, 0.09105034917593002, 0.09101910889148712, 0.08993237465620041, 0.09116629511117935, 0.09093891829252243], [0.09150943160057068, 0.0915815457701683, 0.09117134660482407, 0.09104848653078079, 0.09112023562192917, 0.09071209281682968, 0.09145907312631607, 0.09133582562208176, 0.08712435513734818, 0.09191767126321793, 0.09101995825767517], [0.09100250154733658, 0.09101355075836182, 0.09095059335231781, 0.09093168377876282, 0.09094273298978806, 0.09087981283664703, 0.09099478274583817, 0.09097586572170258, 0.09031623601913452, 0.09106496721506119, 0.09092729538679123], [0.09109610319137573, 0.09111829102039337, 0.09099192172288895, 0.09095399081707001, 0.09097614139318466, 0.09084996581077576, 0.09108059853315353, 0.09104263782501221, 0.08972357958555222, 0.09122154861688614, 0.09094517678022385]], [[0.09074560552835464, 0.0908726304769516, 0.09113665670156479, 0.09061920642852783, 0.09088249504566193, 0.09068752825260162, 0.09072171151638031, 0.09098529815673828, 0.09079011529684067, 0.0913773849606514, 0.09118136018514633], [0.09076139330863953, 0.09087616950273514, 0.09111468493938446, 0.09064716845750809, 0.09088508784770966, 0.0907089114189148, 0.09073980152606964, 0.09097795933485031, 0.09080161154270172, 0.0913320928812027, 0.09115505963563919], [0.0907941460609436, 0.09088350087404251, 0.09106912463903427, 0.09070519357919693, 0.09089044481515884, 0.09075327962636948, 0.09077733010053635, 0.0909627303481102, 0.09082546085119247, 0.09123822301626205, 0.0911005362868309], [0.09072986245155334, 0.09086909145116806, 0.09115854650735855, 0.09059134125709534, 0.0908799096941948, 0.09066621959209442, 0.09070368111133575, 0.09099260717630386, 0.090778648853302, 0.09142252802848816, 0.09120756387710571], [0.09076262265443802, 0.09087644517421722, 0.09111298620700836, 0.09064934402704239, 0.09088528901338577, 0.0907105803489685, 0.09074120968580246, 0.09097739309072495, 0.09080250561237335, 0.09132858365774155, 0.09115301817655563], [0.09073837101459503, 0.09087099879980087, 0.09114670753479004, 0.09060640633106232, 0.09088130295276642, 0.09067773818969727, 0.09071342647075653, 0.0909886509180069, 0.09078484773635864, 0.09139811247587204, 0.09119338542222977], [0.09074262529611588, 0.09087195992469788, 0.09114078432321548, 0.0906139388680458, 0.09088200330734253, 0.09068350493907928, 0.09071830660104752, 0.09098667651414871, 0.09078794717788696, 0.09138590842485428, 0.09118629992008209], [0.09077538549900055, 0.09087930619716644, 0.0910952240228653, 0.09067194908857346, 0.09088737517595291, 0.09072786569595337, 0.09075583517551422, 0.0909714624285698, 0.09081180393695831, 0.09129199385643005, 0.0911317691206932], [0.09075114130973816, 0.09087387472391129, 0.09112895280122757, 0.09062901139259338, 0.09088341146707535, 0.09069503098726273, 0.09072805941104889, 0.09098272770643234, 0.0907941535115242, 0.09136150777339935, 0.09117213636636734], [0.09082391113042831, 0.09089015424251556, 0.09102769941091537, 0.09075795114040375, 0.09089529514312744, 0.09079361706972122, 0.09081144630908966, 0.09094887226819992, 0.09084713459014893, 0.09115293622016907, 0.09105096757411957], [0.09079968929290771, 0.0908847525715828, 0.09106143563985825, 0.09071500599384308, 0.09089136123657227, 0.09076078981161118, 0.09078368544578552, 0.09096016734838486, 0.09082949906587601, 0.0912223756313324, 0.0910913348197937]], [[0.09101743996143341, 0.09103353321552277, 0.09094184637069702, 0.09091433137655258, 0.09108182787895203, 0.0909901037812233, 0.09100619703531265, 0.09097865223884583, 0.09001975506544113, 0.09110841900110245, 0.09090793877840042], [0.09101144224405289, 0.09102664887905121, 0.09094005078077316, 0.0909140557050705, 0.09107226878404617, 0.09098563343286514, 0.09100082516670227, 0.09097481518983841, 0.09006883949041367, 0.0910973772406578, 0.09090802073478699], [0.09104551374912262, 0.09106580913066864, 0.09095022827386856, 0.09091553092002869, 0.09112671762704849, 0.09101105481386185, 0.09103134274482727, 0.09099661558866501, 0.08978940546512604, 0.09116024523973465, 0.09090747684240341], [0.0910557433962822, 0.09107756614685059, 0.0909532681107521, 0.09091596305370331, 0.09114306420087814, 0.0910186842083931, 0.09104049950838089, 0.09100315719842911, 0.08970562368631363, 0.09117912501096725, 0.09090730547904968], [0.0909934714436531, 0.09100599586963654, 0.09093465656042099, 0.09091324359178543, 0.09104357659816742, 0.09097220748662949, 0.09098472446203232, 0.09096329659223557, 0.0902162492275238, 0.09106425940990448, 0.09090826660394669], [0.09102758765220642, 0.09104520827531815, 0.09094488620758057, 0.0909147709608078, 0.09109806269407272, 0.09099768102169037, 0.0910152867436409, 0.09098515659570694, 0.08993641287088394, 0.09112715721130371, 0.09090777486562729], [0.09102161228656769, 0.09103833138942719, 0.0909430980682373, 0.09091451019048691, 0.09108850359916687, 0.09099321812391281, 0.09100992977619171, 0.09098131954669952, 0.08998546004295349, 0.09111612290143967, 0.09090786427259445], [0.09103184938430786, 0.09105009585618973, 0.09094615280628204, 0.09091495722532272, 0.09110486507415771, 0.09100086241960526, 0.09101910144090652, 0.09098787605762482, 0.08990151435136795, 0.09113501012325287, 0.09090770781040192], [0.09138578921556473, 0.0914578065276146, 0.09104815870523453, 0.09092546254396439, 0.09167419373989105, 0.09126357734203339, 0.09133549779653549, 0.09121242165565491, 0.08700663596391678, 0.0917934775352478, 0.09089697897434235], [0.09098359197378159, 0.09099464118480682, 0.09093169122934341, 0.09091278910636902, 0.09102778881788254, 0.09096482396125793, 0.09097586572170258, 0.09095696359872818, 0.09029746055603027, 0.091046042740345, 0.09090840071439743], [0.09105812013149261, 0.09108030050992966, 0.09095397591590881, 0.09091606736183167, 0.09114686399698257, 0.09102044999599457, 0.09104262292385101, 0.09100467711687088, 0.08968617022037506, 0.09118351340293884, 0.0909072607755661]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_return_max": 13.5, "env_reset_timer": 0.0005687829621175024, "episode_duration_sec_mean": 0.005373392428737134, "sample": 0.11647656573737206, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1568356954391697e-05, "batch_individual_items": 1.2188768861648657e-05, "add_time_dim_to_batch_and_zero_pad": 6.770315598092976e-06, "add_observations_from_episodes_to_batch": 2.789550494244331e-06, "add_states_from_episodes_to_batch": 2.7065379872588165e-06}}, "connector_pipeline_timer": 5.7957041288894356e-05}, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1814586424265646e-05, "normalize_and_clip_actions": 7.783632263427359e-06, "get_actions": 3.5582792860304055e-05, "listify_data_for_vector_env": 1.0357740675998745e-05, "un_batch_to_individual_items": 6.566912909076292e-06, "tensor_to_numpy": 1.4543960348210624e-05}}, "connector_pipeline_timer": 0.00011241806562402167}, "env_to_module_sum_episodes_length_in": 10.368238387501162, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 1.65}, "episode_return_mean": 1.65, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "env_to_module_sum_episodes_length_out": 10.368238387501162, "num_env_steps_sampled": 400, "weights_seq_no": 5.0, "episode_len_max": 20, "episode_return_min": -13.5, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 1.65}, "num_episodes_lifetime": 100, "episode_len_min": 20, "env_step_timer": 1.3790031286783035e-05, "num_env_steps_sampled_lifetime": 25400, "rlmodule_inference_timer": 3.0840192063893486e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "time_between_sampling": 9.380793120890857}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "b19cd_00000", "date": "2025-08-11_18-40-41", "timestamp": 1754930441, "time_this_iter_s": 9.45481014251709, "time_total_s": 47.925159215927124, "pid": 11628, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1629fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 47.925159215927124, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 42.77142857142858, "ram_util_percent": 78.60000000000001}}
{"timers": {"training_iteration": 9.142985964260049, "restore_env_runners": 9.423917685899396e-06, "training_step": 9.142860887293637, "env_runner_sampling_timer": 1.6684992498892293, "learner_update_timer": 7.301474542491418, "synch_weights": 0.0008277486287883545, "restore_eval_env_runners": 9.391184601002604e-06, "evaluation_iteration": 0.12716092534900053, "synch_eval_env_connectors": 0.00018227169587040323, "synch_env_connectors": 4.624925079800887e-06}, "env_runners": {"env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "env_reset_timer": 4.145975734108248e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.0046801043639626e-05, "listify_data_for_vector_env": 1.0565380589151172e-05, "tensor_to_numpy": 1.52785695056073e-05, "un_batch_to_individual_items": 6.757636176472458e-06, "remove_single_ts_time_rank_from_batch": 1.2055702800055944e-05, "normalize_and_clip_actions": 7.980934582121746e-06}}, "connector_pipeline_timer": 0.00011922092223533182}, "episode_duration_sec_mean": 0.005335286497138441, "sample": 0.005706900036112588, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7303299489221675e-06, "numpy_to_tensor": 1.2837179400304929e-05, "batch_individual_items": 1.2597974914154466e-05, "add_observations_from_episodes_to_batch": 2.8239069618244023e-06, "add_time_dim_to_batch_and_zero_pad": 6.968305870669434e-06}}, "connector_pipeline_timer": 6.017141639500071e-05}, "agent_episode_returns_mean": {"default_agent": 2.18}, "time_between_sampling": 0.032165569396914485, "weights_seq_no": 5.0, "num_episodes_lifetime": -123000.0, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 2.18}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "episode_return_mean": 2.18, "episode_len_max": 20, "env_step_timer": 1.4332721258599249e-05, "num_env_steps_sampled_lifetime": -2460000.0, "episode_len_mean": 20.0, "rlmodule_inference_timer": 3.178754747438037e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime_throughput": 3222.4948316189993}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13535742707184545, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00904763100808649, "add_observations_from_episodes_to_batch": 0.0008853607033804618, "add_columns_from_episodes_to_train_batch": 0.04193705772588955, "add_time_dim_to_batch_and_zero_pad": 0.07548318004898019, "add_states_from_episodes_to_batch": 0.0035477589368714604, "batch_individual_items": 0.004242620380936222, "numpy_to_tensor": 6.407212096678418e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 31.0, "module_train_batch_size_mean": 997.5548130830801, "total_loss": 0.0, "weights_seq_no": 36.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 215460}, "default_policy": {"module_train_batch_size_mean": 997.5548130830801, "mean_kl_loss": 2.7020614652428776e-06, "weights_seq_no": 36.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 215460, "diff_num_grad_updates_vs_sampler_policy": 31.0, "use_intrinsic_rewards": 1.0, "entropy": 0.6801804304122925, "vf_loss_unclipped": 44.2012825012207, "vf_explained_var": 0.0034839510917663574, "policy_loss": 3.120193287031725e-05, "total_loss": 0.2781737446784973, "vf_loss": 0.35837405920028687}, "__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 430920, "num_env_steps_trained_lifetime": 1188000, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 57354.137729362825}}}, "default_policy": {"curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.3583085238933563, "mean_kl_loss": 2.4111914171953686e-06, "num_module_steps_trained_lifetime": 35910, "module_train_batch_size_mean": 997.8474438281662, "weights_seq_no": 6.0, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 16595, "use_intrinsic_rewards": 0.0, "entropy": 0.6802010536193848, "vf_loss_unclipped": 44.33397674560547, "vf_explained_var": 0.0004467964172363281, "curr_kl_coeff": 0.0025247489102184772, "policy_loss": 2.723247598623857e-05, "total_loss": 0.27811822295188904, "num_module_steps_trained_lifetime_throughput": 815.6211038467445}, "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 997.8474438281662, "weights_seq_no": 6.0, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 35910, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 815.6352097715773}, "__all_modules__": {"num_env_steps_trained_lifetime": 198000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 33000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 71820, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4498.942290617796, "num_module_steps_trained_throughput": 28019813.347928148, "num_module_steps_trained_lifetime_throughput": 13033811.769014647}, "IntrinsicAttentionMask": [[[0.09065800905227661, 0.09078491479158401, 0.09072636812925339, 0.09085336327552795, 0.09111732989549637, 0.09092186391353607, 0.09095613658428192, 0.09122040122747421, 0.09102471172809601, 0.09096600860357285, 0.09077086299657822], [0.09068223834037781, 0.09079691022634506, 0.0907440111041069, 0.09085875749588013, 0.09109722822904587, 0.09092064946889877, 0.09095160663127899, 0.09119032323360443, 0.09101356565952301, 0.0909605324268341, 0.0907842218875885], [0.09067106246948242, 0.09079137444496155, 0.09073587507009506, 0.09085626900196075, 0.09110650420188904, 0.09092120826244354, 0.09095369279384613, 0.0912041962146759, 0.09101870656013489, 0.09096306562423706, 0.09077806025743484], [0.09069528430700302, 0.0908033698797226, 0.09075351059436798, 0.09086166322231293, 0.09108639508485794, 0.09091999381780624, 0.0909491702914238, 0.09117411822080612, 0.09100755304098129, 0.09095758199691772, 0.09079141169786453], [0.09074553102254868, 0.09082823246717453, 0.09079008549451828, 0.09087283164262772, 0.09104468673467636, 0.0909174457192421, 0.09093976020812988, 0.09111174196004868, 0.09098440408706665, 0.09094619005918503, 0.09081908315420151], [0.09070833772420883, 0.09080982953310013, 0.09076301008462906, 0.09086456149816513, 0.09107555449008942, 0.09091932326555252, 0.09094671905040741, 0.09115790575742722, 0.09100154042243958, 0.09095461666584015, 0.09079860150814056], [0.09071485698223114, 0.0908130556344986, 0.0907677561044693, 0.09086600691080093, 0.09107013046741486, 0.09091898798942566, 0.09094548970460892, 0.09114979952573776, 0.09099852293729782, 0.09095313400030136, 0.09080218523740768], [0.09076512604951859, 0.09083793312311172, 0.09080434590578079, 0.09087718278169632, 0.09102844446897507, 0.0909164547920227, 0.0909360945224762, 0.0910874530673027, 0.09097539633512497, 0.09094175696372986, 0.09082987159490585], [0.09072792530059814, 0.09081953018903732, 0.09077727049589157, 0.09086892008781433, 0.09105931222438812, 0.09091834723949432, 0.09094306826591492, 0.09113360941410065, 0.0909925252199173, 0.09095019102096558, 0.09080938994884491], [0.09071674197912216, 0.09081398695707321, 0.09076912701129913, 0.09086643159389496, 0.0910685732960701, 0.0909188985824585, 0.09094514697790146, 0.09114746749401093, 0.09099766612052917, 0.09095270931720734, 0.09080322086811066], [0.09067955613136292, 0.09079558402299881, 0.09074205905199051, 0.09085816144943237, 0.09109945595264435, 0.09092079102993011, 0.09095211327075958, 0.09119365364313126, 0.0910148024559021, 0.09096114337444305, 0.09078274667263031]], [[0.0910310447216034, 0.09104713797569275, 0.09095544368028641, 0.09107933938503265, 0.0910954475402832, 0.09085240960121155, 0.09101979434490204, 0.09114377945661545, 0.08988352864980698, 0.09097054600715637, 0.09092152863740921], [0.09102430939674377, 0.0910395085811615, 0.09095290303230286, 0.09106992930173874, 0.09108513593673706, 0.09085557609796524, 0.09101368486881256, 0.09113078564405441, 0.08994010090827942, 0.09096717089414597, 0.09092086553573608], [0.09106262773275375, 0.09108292311429977, 0.0909673199057579, 0.0911235362291336, 0.09114384651184082, 0.09083744883537292, 0.09104844927787781, 0.09120479971170425, 0.08961812406778336, 0.09098634868860245, 0.09092456102371216], [0.09101084619760513, 0.09102426469326019, 0.09094782918691635, 0.09105110168457031, 0.09106452018022537, 0.09086192399263382, 0.0910014733672142, 0.09110480546951294, 0.09005334973335266, 0.09096041321754456, 0.09091955423355103], [0.09100410342216492, 0.09101662039756775, 0.0909452736377716, 0.0910416767001152, 0.09105420857667923, 0.09086508303880692, 0.09099534898996353, 0.09109180420637131, 0.09011001884937286, 0.09095703065395355, 0.0909188836812973], [0.09110561013221741, 0.09113163501024246, 0.09098339080810547, 0.09118372946977615, 0.091209776699543, 0.0908169150352478, 0.09108742326498032, 0.09128798544406891, 0.08925717324018478, 0.09100779891014099, 0.0909285768866539], [0.09103575348854065, 0.09105246514081955, 0.09095721691846848, 0.09108591824769974, 0.09110265225172043, 0.09085018932819366, 0.09102406352758408, 0.0911528617143631, 0.08984401822090149, 0.0909729078412056, 0.09092198312282562], [0.09098385274410248, 0.09099369496107101, 0.09093759953975677, 0.09101339429616928, 0.09102324396371841, 0.09087453782558441, 0.09097696840763092, 0.09105279296636581, 0.0902802050113678, 0.09094683825969696, 0.09091684222221375], [0.09150554984807968, 0.09158610552549362, 0.09112796932458878, 0.09174743294715881, 0.09182820469141006, 0.09061535447835922, 0.0914493054151535, 0.09207094460725784, 0.08590687066316605, 0.09120328724384308, 0.09095896780490875], [0.09105630964040756, 0.09107577055692673, 0.09096494317054749, 0.09111469238996506, 0.09113416820764542, 0.09084043651819229, 0.09104271978139877, 0.09119260311126709, 0.08967109024524689, 0.09098319709300995, 0.09092395007610321], [0.09107678383588791, 0.09109897166490555, 0.09097261726856232, 0.09114334732294083, 0.09116555005311966, 0.09083070605993271, 0.09106128662824631, 0.09123218059539795, 0.08949920535087585, 0.09099342674016953, 0.0909259021282196]], [[0.09127859026193619, 0.09080807864665985, 0.0910072773694992, 0.0908597782254219, 0.09081552922725677, 0.09066835045814514, 0.09093739837408066, 0.0911368802189827, 0.09074579179286957, 0.09094485640525818, 0.09079746901988983], [0.09151021391153336, 0.09074481576681137, 0.0910685583949089, 0.0908288061618805, 0.09075691550970078, 0.09051799029111862, 0.09095494449138641, 0.09127943217754364, 0.09064368158578873, 0.09096706658601761, 0.09072758257389069], [0.09141194820404053, 0.0907716453075409, 0.09104258567094803, 0.09084194898605347, 0.09078177064657211, 0.09058172255754471, 0.09094751626253128, 0.0912189781665802, 0.09068697690963745, 0.09095766395330429, 0.09075722098350525], [0.0914846807718277, 0.09075178951025009, 0.09106181561946869, 0.09083222597837448, 0.09076337516307831, 0.09053454548120499, 0.09095301479101181, 0.09126372635364532, 0.09065493196249008, 0.09096462279558182, 0.0907352864742279], [0.09150653332471848, 0.09074581414461136, 0.09106758236885071, 0.09082929790019989, 0.09075784683227539, 0.09052036702632904, 0.09095466136932373, 0.09127716720104218, 0.09064530581235886, 0.09096671640872955, 0.09072869271039963], [0.09157932549715042, 0.09072595089673996, 0.09108680486679077, 0.09081955999135971, 0.09073943644762039, 0.09047321230173111, 0.09096014499664307, 0.0913219302892685, 0.09061326086521149, 0.09097366034984589, 0.09070675075054169], [0.09144638478755951, 0.09076224267482758, 0.09105169028043747, 0.09083734452724457, 0.09077306091785431, 0.09055937826633453, 0.0909501239657402, 0.09124016761779785, 0.09067180007696152, 0.09096096456050873, 0.09074683487415314], [0.09134817123413086, 0.0907890647649765, 0.0910257026553154, 0.09085047245025635, 0.09079790860414505, 0.09062312543392181, 0.09094267338514328, 0.09117972105741501, 0.09071508795022964, 0.09095153957605362, 0.0907764583826065], [0.09154099971055984, 0.09073641151189804, 0.09107668697834015, 0.09082469344139099, 0.09074912965297699, 0.09049803763628006, 0.09095726162195206, 0.09129835665225983, 0.09063012897968292, 0.0909700095653534, 0.09071830660104752], [0.09144270420074463, 0.09076324850320816, 0.09105071425437927, 0.09083783626556396, 0.09077398478984833, 0.09056176245212555, 0.09094984084367752, 0.09123790264129639, 0.09067342430353165, 0.09096060693264008, 0.09074793756008148], [0.091515451669693, 0.09074337780475616, 0.09106993675231934, 0.09082809835672379, 0.09075558185577393, 0.09051458537578583, 0.09095533192157745, 0.09128265082836151, 0.09064137190580368, 0.090967558324337, 0.09072599560022354]], [[0.09037043154239655, 0.0907391756772995, 0.09053713828325272, 0.09047653526067734, 0.09051193296909332, 0.09064344316720963, 0.09067890048027039, 0.09095238149166107, 0.09328123182058334, 0.09090438485145569, 0.09090438485145569], [0.0905112475156784, 0.09078408777713776, 0.09063463658094406, 0.09058979153633118, 0.09061598777770996, 0.09071328490972519, 0.09073951095342636, 0.09094171226024628, 0.09265720099210739, 0.09090623259544373, 0.09090623259544373], [0.09043420106172562, 0.09075956046581268, 0.09058132022619247, 0.09052784740924835, 0.09055907279253006, 0.09067510813474655, 0.09070639312267303, 0.09094761312007904, 0.09299834072589874, 0.09090528637170792, 0.09090528637170792], [0.09041103720664978, 0.09075216203927994, 0.0905652716755867, 0.09050920605659485, 0.09054195135831833, 0.0906636118888855, 0.09069640934467316, 0.09094934910535812, 0.09310102462768555, 0.09090496599674225, 0.09090496599674225], [0.09042457491159439, 0.09075649082660675, 0.09057464450597763, 0.09052009880542755, 0.09055195748806, 0.09067033231258392, 0.09070225059986115, 0.09094834327697754, 0.09304103255271912, 0.09090515971183777, 0.09090515971183777], [0.09047477692365646, 0.09077249467372894, 0.09060940146446228, 0.09056046605110168, 0.09058905392885208, 0.09069522470235825, 0.09072384983301163, 0.09094452857971191, 0.09281861782073975, 0.0909058079123497, 0.0909058079123497], [0.09048829227685928, 0.09077679365873337, 0.09061875194311142, 0.0905713364481926, 0.09059903025627136, 0.09070191532373428, 0.09072965383529663, 0.09094347804784775, 0.09275877475738525, 0.09090596437454224, 0.09090596437454224], [0.09059232473373413, 0.09080979973077774, 0.09069068729877472, 0.09065493941307068, 0.09067582339048386, 0.09075336903333664, 0.09077427536249161, 0.0909353718161583, 0.09229925274848938, 0.09090711176395416, 0.09090711176395416], [0.09146091341972351, 0.09107783436775208, 0.09128732979297638, 0.09135035425424576, 0.09131353348493576, 0.09117698669433594, 0.09114023298025131, 0.09085777401924133, 0.0885205864906311, 0.09090722352266312, 0.09090722352266312], [0.09057409316301346, 0.09080402553081512, 0.09067808836698532, 0.09064029902219772, 0.09066236764192581, 0.09074436128139496, 0.09076646715402603, 0.0909368097782135, 0.09237964451313019, 0.09090693295001984, 0.09090693295001984], [0.09057409316301346, 0.09080402553081512, 0.09067808836698532, 0.09064029902219772, 0.09066236764192581, 0.09074436128139496, 0.09076646715402603, 0.0909368097782135, 0.09237964451313019, 0.09090693295001984, 0.09090693295001984]], [[0.0912785604596138, 0.09056515246629715, 0.09100724756717682, 0.09085974842309952, 0.09105906635522842, 0.09091149270534515, 0.0906941294670105, 0.09089307487010956, 0.09074576199054718, 0.09094482660293579, 0.0910409539937973], [0.09163032472133636, 0.090239517390728, 0.09110017120838165, 0.09081259369850159, 0.0912013128399849, 0.09091341495513916, 0.0904901847243309, 0.09087751805782318, 0.09059064835309982, 0.09097841382026672, 0.09116596728563309], [0.09141189604997635, 0.0904415100812912, 0.09104253351688385, 0.09084189683198929, 0.09111304581165314, 0.09091226011514664, 0.09061674028635025, 0.09088721126317978, 0.09068692475557327, 0.09095761179924011, 0.09108840674161911], [0.09148459881544113, 0.0903741866350174, 0.09106173366308212, 0.09083214402198792, 0.091142438352108, 0.09091265499591827, 0.09057457745075226, 0.09088399261236191, 0.09065485000610352, 0.09096454083919525, 0.09111423790454865], [0.09138638526201248, 0.09046514332294464, 0.09103578329086304, 0.09084531664848328, 0.0911027267575264, 0.0909121185541153, 0.09063152968883514, 0.09088833630084991, 0.09069817513227463, 0.09095516800880432, 0.09107933193445206], [0.09145908057689667, 0.09039781242609024, 0.0910549983382225, 0.0908355712890625, 0.09113212674856186, 0.09091252088546753, 0.09058937430381775, 0.09088512510061264, 0.09066610783338547, 0.09096211940050125, 0.09110517054796219], [0.09156644344329834, 0.09029850363731384, 0.09108332544565201, 0.09082116186618805, 0.09117551147937775, 0.0909130871295929, 0.09052715450525284, 0.09088035672903061, 0.09061878174543381, 0.09097234159708023, 0.09114329516887665], [0.09146816283464432, 0.09038940817117691, 0.09105738997459412, 0.0908343568444252, 0.09113579988479614, 0.09091256558895111, 0.09058410674333572, 0.0908847227692604, 0.09066210687160492, 0.0909629836678505, 0.09110840409994125], [0.09154090285301208, 0.0903221070766449, 0.09107659012079239, 0.09082459658384323, 0.09116519242525101, 0.09091295301914215, 0.09054195135831833, 0.09088148921728134, 0.09063003212213516, 0.09096991270780563, 0.09113422781229019], [0.09144265204668045, 0.09041303396224976, 0.0910506621003151, 0.09083778411149979, 0.09112548828125, 0.09091243892908096, 0.09059891104698181, 0.09088586270809174, 0.09067337214946747, 0.0909605547785759, 0.0910993441939354], [0.0913952961564064, 0.09045688807964325, 0.09103813767433167, 0.09084411710500717, 0.09110632538795471, 0.09091216325759888, 0.09062636643648148, 0.09088794142007828, 0.09069424867630005, 0.09095601737499237, 0.09108249843120575]], [[0.09107240289449692, 0.0909370705485344, 0.09099676460027695, 0.09112071990966797, 0.09098531305789948, 0.0908936858177185, 0.09090975672006607, 0.09118518978357315, 0.08992436528205872, 0.09101187437772751, 0.09096283465623856], [0.0911482498049736, 0.09094973653554916, 0.09103728830814362, 0.09121917188167572, 0.09102049469947815, 0.09088612347841263, 0.0909096896648407, 0.09131380915641785, 0.0894685760140419, 0.09105944633483887, 0.09098751842975616], [0.09111479669809341, 0.09094417095184326, 0.09101942926645279, 0.09117573499679565, 0.09100499749183655, 0.09088948369026184, 0.09090974926948547, 0.09125705063343048, 0.08966946601867676, 0.09103847295045853, 0.09097665548324585], [0.09104529768228531, 0.09093248844146729, 0.09098225831985474, 0.09108556807041168, 0.09097271412611008, 0.09089632332324982, 0.09090971946716309, 0.0911392942070961, 0.09008743613958359, 0.09099484980106354, 0.09095396846532822], [0.09112121164798737, 0.09094524383544922, 0.09102285653352737, 0.09118406474590302, 0.09100797027349472, 0.0908888429403305, 0.09090974181890488, 0.09126793593168259, 0.08963090926408768, 0.09104250371456146, 0.09097874164581299], [0.09117253869771957, 0.09095373004674911, 0.09105022996664047, 0.0912507101893425, 0.09103171527385712, 0.09088362753391266, 0.09090960025787354, 0.09135504812002182, 0.08932274580001831, 0.09107465296983719, 0.09099537134170532], [0.0911635309457779, 0.09095223993062973, 0.09104543179273605, 0.09123902022838593, 0.09102755039930344, 0.09088454395532608, 0.09090962260961533, 0.09133975952863693, 0.08937674760818481, 0.09106901288032532, 0.09099245816469193], [0.09100914001464844, 0.09092634916305542, 0.09096287935972214, 0.09103868901729584, 0.09095586836338043, 0.09089979529380798, 0.09090963751077652, 0.09107810258865356, 0.09030530601739883, 0.09097211807966232, 0.09094211459159851], [0.09171344339847565, 0.09103716909885406, 0.09133501350879669, 0.09195588529109955, 0.0912778228521347, 0.09082122892141342, 0.09090118855237961, 0.09228012710809708, 0.08610204607248306, 0.09141049534082413, 0.09116562455892563], [0.09110632538795471, 0.09094275534152985, 0.09101490676403046, 0.09116474539041519, 0.09100106358528137, 0.09089033305644989, 0.09090975672006607, 0.09124269336462021, 0.08972034603357315, 0.09103316813707352, 0.09097389876842499], [0.09113381057977676, 0.09094732999801636, 0.0910295844078064, 0.09120041877031326, 0.09101380407810211, 0.09088757634162903, 0.09090971946716309, 0.09128930419683456, 0.08955524116754532, 0.0910504013299942, 0.0909828320145607]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_return_max": 14.5, "env_reset_timer": 0.000564593472194046, "episode_duration_sec_mean": 0.0053370361588895325, "sample": 0.11642457050073031, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1538474736835059e-05, "batch_individual_items": 1.2142439363097018e-05, "add_time_dim_to_batch_and_zero_pad": 6.8257785883207025e-06, "add_observations_from_episodes_to_batch": 2.8046590696519897e-06, "add_states_from_episodes_to_batch": 2.7859197788638735e-06}}, "connector_pipeline_timer": 5.8086685607366337e-05}, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.179031314350115e-05, "normalize_and_clip_actions": 7.754649425661484e-06, "get_actions": 3.4907815848203756e-05, "listify_data_for_vector_env": 1.020975927688855e-05, "un_batch_to_individual_items": 6.493064381872231e-06, "tensor_to_numpy": 1.468045782722214e-05}}, "connector_pipeline_timer": 0.00011161133854707171}, "env_to_module_sum_episodes_length_in": 10.368238394470474, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 2.05}, "episode_return_mean": 2.05, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "env_to_module_sum_episodes_length_out": 10.368238394470474, "num_env_steps_sampled": 400, "weights_seq_no": 6.0, "episode_len_max": 20, "episode_return_min": -13.5, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 2.05}, "num_episodes_lifetime": 120, "episode_len_min": 20, "env_step_timer": 1.3534681213748485e-05, "num_env_steps_sampled_lifetime": 30400, "rlmodule_inference_timer": 2.9997383316121128e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "time_between_sampling": 9.377827438431634}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "b19cd_00000", "date": "2025-08-11_18-40-50", "timestamp": 1754930450, "time_this_iter_s": 9.179319143295288, "time_total_s": 57.10447835922241, "pid": 11628, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1629fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 57.10447835922241, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 41.32307692307692, "ram_util_percent": 78.7}}
{"timers": {"training_iteration": 9.140046319198118, "restore_env_runners": 9.480927623464393e-06, "training_step": 9.13992042384126, "env_runner_sampling_timer": 1.6668008848903755, "learner_update_timer": 7.300139724986262, "synch_weights": 0.0008281615520956177, "restore_eval_env_runners": 9.458932891647551e-06, "evaluation_iteration": 0.12705997359613516, "synch_eval_env_connectors": 0.00018153439811951054, "synch_env_connectors": 4.620756475383661e-06}, "env_runners": {"env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "env_reset_timer": 3.698030292644669e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.799220270203755e-05, "listify_data_for_vector_env": 1.0308752011759942e-05, "tensor_to_numpy": 1.4819439968631e-05, "un_batch_to_individual_items": 6.5803653411382215e-06, "remove_single_ts_time_rank_from_batch": 1.1822331506363718e-05, "normalize_and_clip_actions": 7.825246188546575e-06}}, "connector_pipeline_timer": 0.00011548072629962458}, "episode_duration_sec_mean": 0.005159922507591548, "sample": 0.005551367081100345, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7074284589030297e-06, "numpy_to_tensor": 1.2217409669932778e-05, "batch_individual_items": 1.2355114044939687e-05, "add_observations_from_episodes_to_batch": 2.7387980249114765e-06, "add_time_dim_to_batch_and_zero_pad": 6.722896220514151e-06}}, "connector_pipeline_timer": 5.84765373675116e-05}, "agent_episode_returns_mean": {"default_agent": 3.06}, "time_between_sampling": 0.031162379438024027, "weights_seq_no": 6.0, "num_episodes_lifetime": -153875.0, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 3.06}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "episode_return_mean": 3.06, "episode_len_max": 20, "env_step_timer": 1.3731644874935969e-05, "num_env_steps_sampled_lifetime": -3077500.0, "episode_len_mean": 20.0, "rlmodule_inference_timer": 3.058300117626273e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime_throughput": 3323.939815742364}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13530988364104146, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00904231761771881, "add_observations_from_episodes_to_batch": 0.000884689596370052, "add_columns_from_episodes_to_train_batch": 0.04192097964904461, "add_time_dim_to_batch_and_zero_pad": 0.07546098991794631, "add_states_from_episodes_to_batch": 0.0035494409273087754, "batch_individual_items": 0.004238248346981008, "numpy_to_tensor": 6.402349041223456e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 36.0, "module_train_batch_size_mean": 997.5374097747205, "total_loss": 0.0, "weights_seq_no": 42.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 251370}, "default_policy": {"module_train_batch_size_mean": 997.5374097747205, "mean_kl_loss": 4.3183501929888735e-07, "weights_seq_no": 42.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 251370, "diff_num_grad_updates_vs_sampler_policy": 36.0, "use_intrinsic_rewards": 1.0, "entropy": 0.6803510785102844, "vf_loss_unclipped": 44.27080154418945, "vf_explained_var": 0.0034648776054382324, "policy_loss": -5.781487197964452e-05, "total_loss": 0.27808114886283875, "vf_loss": 0.3583703339099884}, "__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 502740, "num_env_steps_trained_lifetime": 1386000, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 56385.171507159605}}}, "default_policy": {"curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.3583044111728668, "mean_kl_loss": 6.028337793395622e-07, "num_module_steps_trained_lifetime": 41895, "module_train_batch_size_mean": 997.82696443245, "weights_seq_no": 7.0, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 16595, "use_intrinsic_rewards": 0.0, "entropy": 0.6803808808326721, "vf_loss_unclipped": 44.37504959106445, "vf_explained_var": 0.0009059309959411621, "curr_kl_coeff": 0.0012623744551092386, "policy_loss": -6.550557009177282e-05, "total_loss": 0.27802199125289917, "num_module_steps_trained_lifetime_throughput": 812.4633680716229}, "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 997.82696443245, "weights_seq_no": 7.0, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 41895, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 812.476801255461}, "__all_modules__": {"num_env_steps_trained_lifetime": 231000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 33000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 83790, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4481.468428986869, "num_module_steps_trained_throughput": 27237037.35961638, "num_module_steps_trained_lifetime_throughput": 13000615.412121601}, "IntrinsicAttentionMask": [[[0.09071635454893112, 0.09052174538373947, 0.09078475087881088, 0.09091183543205261, 0.09117597341537476, 0.09098038077354431, 0.09069246798753738, 0.09095597267150879, 0.09108329564332962, 0.09134793281555176, 0.0908292829990387], [0.09068778902292252, 0.09046444296836853, 0.0907663032412529, 0.09091220051050186, 0.09121555089950562, 0.09099090844392776, 0.09066037088632584, 0.09096288681030273, 0.09110909700393677, 0.09141311049461365, 0.0908174216747284], [0.09072638303041458, 0.09054186195135117, 0.09079122543334961, 0.09091170132160187, 0.09116208553314209, 0.09097667783498764, 0.09070373326539993, 0.09095355123281479, 0.09107423573732376, 0.0913250669836998, 0.09083344787359238], [0.0907450020313263, 0.09057921916246414, 0.09080325067043304, 0.09091146290302277, 0.09113632142543793, 0.09096982330083847, 0.0907246544957161, 0.09094905108213425, 0.0910574346780777, 0.09128265082836151, 0.09084117412567139], [0.09078358858823776, 0.09065671265125275, 0.09082816541194916, 0.09091093391180038, 0.0910828709602356, 0.09095557779073715, 0.09076802432537079, 0.09093968570232391, 0.0910225659608841, 0.09119470417499542, 0.09085717052221298], [0.09075502306222916, 0.09059934318065643, 0.09080972522497177, 0.09091132879257202, 0.09112242609262466, 0.0909661203622818, 0.09073591977357864, 0.09094661474227905, 0.09104836732149124, 0.09125979244709015, 0.09084533154964447], [0.09071285277605057, 0.09051472693681717, 0.09078249335289001, 0.09091188758611679, 0.09118083119392395, 0.09098167717456818, 0.0906885415315628, 0.09095682948827744, 0.09108646214008331, 0.09135592728853226, 0.0908278375864029], [0.09075146168470383, 0.09059218317270279, 0.09080742299556732, 0.0909113809466362, 0.09112738072872162, 0.09096744656562805, 0.0907319188117981, 0.09094748646020889, 0.0910516008734703, 0.09126793593168259, 0.09084385633468628], [0.09077007323503494, 0.09062954783439636, 0.09081944078207016, 0.0909111350774765, 0.09110161662101746, 0.09096057713031769, 0.09075282514095306, 0.09094297885894775, 0.09103479981422424, 0.0912255346775055, 0.09085157513618469], [0.09080864489078522, 0.09070706367492676, 0.09084433317184448, 0.09091058373451233, 0.09104815870523453, 0.09094630926847458, 0.09079618752002716, 0.09093359112739563, 0.09099990874528885, 0.09113761782646179, 0.0908675491809845], [0.09073290973901749, 0.09055496007204056, 0.09079544246196747, 0.0909116193652153, 0.09115305542945862, 0.09097427874803543, 0.0907110720872879, 0.09095197170972824, 0.09106834977865219, 0.09131019562482834, 0.09083615243434906]], [[0.09079941362142563, 0.09057142585515976, 0.0904172733426094, 0.0908808708190918, 0.09090804308652878, 0.09049838781356812, 0.09078045189380646, 0.0909896045923233, 0.09250416606664658, 0.09069742262363434, 0.09095291048288345], [0.09076863527297974, 0.09047797322273254, 0.09028156846761703, 0.09087253361940384, 0.09090720117092133, 0.09038490802049637, 0.09074445068836212, 0.09101126343011856, 0.09294834733009338, 0.09063857793807983, 0.09096444398164749], [0.0907476618885994, 0.09041459113359451, 0.0901896059513092, 0.09086675941944122, 0.09090649336576462, 0.09030797332525253, 0.09071994572877884, 0.09102580696344376, 0.09325039386749268, 0.09059860557317734, 0.09097212553024292], [0.09081033617258072, 0.09060472249984741, 0.09046567231416702, 0.09088379144668579, 0.09090828895568848, 0.09053884446620941, 0.09079323709011078, 0.09098181873559952, 0.0923461839556694, 0.0907183587551117, 0.09094873815774918], [0.09081397205591202, 0.09061581641435623, 0.09048180282115936, 0.0908847525715828, 0.09090836346149445, 0.09055232256650925, 0.09079749137163162, 0.09097921848297119, 0.09229357540607452, 0.09072533249855042, 0.09094733744859695], [0.09075871855020523, 0.09044796973466873, 0.09023801982402802, 0.09086982160806656, 0.09090688079595566, 0.09034848213195801, 0.09073285758495331, 0.09101816266775131, 0.09309127926826477, 0.09061966836452484, 0.09096808731555939], [0.09079687297344208, 0.09056366980075836, 0.09040600806474686, 0.09088019281625748, 0.0909079909324646, 0.0904889702796936, 0.09077747166156769, 0.09099141508340836, 0.09254100173711777, 0.09069254249334335, 0.09095387905836105], [0.09082484990358353, 0.0906490832567215, 0.09053018689155579, 0.0908876284956932, 0.09090855717658997, 0.09059275686740875, 0.09081023186445236, 0.09097139537334442, 0.09213590621948242, 0.09074623137712479, 0.09094312787055969], [0.09102001786231995, 0.09125836193561554, 0.09142021834850311, 0.09093515574932098, 0.09090688079595566, 0.09133497625589371, 0.09103979915380478, 0.09082211554050446, 0.0892757773399353, 0.09112649410963058, 0.09086023271083832], [0.0907856747508049, 0.090529665350914, 0.09035660326480865, 0.09087717533111572, 0.09090769290924072, 0.09044766426086426, 0.09076438099145889, 0.0909993126988411, 0.09270250052213669, 0.09067113697528839, 0.09095808863639832], [0.09081996232271194, 0.09063412249088287, 0.09050843119621277, 0.09088633954524994, 0.0909084752202034, 0.09057457745075226, 0.09080450981855392, 0.09097491949796677, 0.09220679849386215, 0.09073683619499207, 0.0909450352191925]], [[0.09065786749124527, 0.09078476577997208, 0.09104853868484497, 0.09085322171449661, 0.09111718833446503, 0.09059984982013702, 0.09063399583101273, 0.09122025966644287, 0.09102457016706467, 0.09128903597593307, 0.09077072143554688], [0.09068211913108826, 0.09079679101705551, 0.09103509783744812, 0.09085863828659058, 0.09109710901975632, 0.0906296819448471, 0.09066054224967957, 0.09119020402431488, 0.09101343899965286, 0.09125231951475143, 0.09078409522771835], [0.0907323956489563, 0.09082169830799103, 0.09100718796253204, 0.09086984395980835, 0.09105543792247772, 0.09069155901670456, 0.09071560204029083, 0.09112786501646042, 0.0909903347492218, 0.09117617458105087, 0.09081181138753891], [0.09069517254829407, 0.09080325812101364, 0.09102784097194672, 0.09086154401302338, 0.09108627587556839, 0.09064575284719467, 0.09067483991384506, 0.09117400646209717, 0.09100744128227234, 0.091232530772686, 0.09079129248857498], [0.0907454714179039, 0.09082816541194916, 0.09099994599819183, 0.09087275713682175, 0.09104461967945099, 0.09070764482021332, 0.09072990715503693, 0.0911116749048233, 0.09098433703184128, 0.09115640819072723, 0.09081901609897614], [0.09064677357673645, 0.09077925980091095, 0.09105469286441803, 0.09085073322057724, 0.09112638235092163, 0.09058620035648346, 0.09062185138463974, 0.09123402088880539, 0.09102965891361237, 0.09130584448575974, 0.0907646045088768], [0.09065330028533936, 0.09078250825405121, 0.09105107188224792, 0.09085220098495483, 0.09112096577882767, 0.09059423953294754, 0.09062900394201279, 0.09122591465711594, 0.0910266637802124, 0.09129595011472702, 0.09076820313930511], [0.0907650738954544, 0.09083788096904755, 0.09098906815052032, 0.09087713062763214, 0.09102839231491089, 0.09073176980018616, 0.09075137227773666, 0.09108740091323853, 0.09097534418106079, 0.09112676233053207, 0.09082982689142227], [0.09072783589363098, 0.09081944078207016, 0.0910097286105156, 0.09086883813142776, 0.09105922281742096, 0.09068594872951508, 0.0907106027007103, 0.09113352000713348, 0.09099244326353073, 0.09118308871984482, 0.09080930054187775], [0.09077814221382141, 0.09084434807300568, 0.09098182618618011, 0.09088004380464554, 0.09101757407188416, 0.09074786305427551, 0.09076568484306335, 0.0910712257027626, 0.09096933901309967, 0.09110700339078903, 0.0908370241522789], [0.09067942202091217, 0.09079544991254807, 0.09103657305240631, 0.09085802733898163, 0.0910993218421936, 0.09062637388706207, 0.09065760672092438, 0.09119351953268051, 0.09101466834545135, 0.09125637263059616, 0.09078261256217957]], [[0.09107240289449692, 0.09108851104974747, 0.090845488011837, 0.09112072736024857, 0.09098532050848007, 0.09104505181312561, 0.09090976417064667, 0.09103360027074814, 0.08992437273263931, 0.0910118818283081, 0.09096284210681915], [0.09106338024139404, 0.09107858687639236, 0.09084904193878174, 0.0911090150475502, 0.090981125831604, 0.09103754162788391, 0.09090975672006607, 0.09102672338485718, 0.08997870236635208, 0.09100621193647385, 0.09095989167690277], [0.09119954705238342, 0.09122829139232635, 0.09079499542713165, 0.09128579497337341, 0.09104420244693756, 0.09115074574947357, 0.09090950340032578, 0.09113030135631561, 0.08916092664003372, 0.0910915657877922, 0.09100411087274551], [0.0910453200340271, 0.09105873852968216, 0.0908561497926712, 0.09108559042215347, 0.09097272902727127, 0.09102252125740051, 0.09090974181890488, 0.09101296961307526, 0.09008745849132538, 0.09099487215280533, 0.09095399081707001], [0.09112121909856796, 0.09114217013120651, 0.09082620590925217, 0.09118407219648361, 0.09100797772407532, 0.09108565002679825, 0.09090974926948547, 0.0910707488656044, 0.08963091671466827, 0.09104250371456146, 0.09097874164581299], [0.09108775109052658, 0.0911053717136383, 0.0908394530415535, 0.09114062786102295, 0.09099245071411133, 0.09105781465768814, 0.09090977162122726, 0.09104527533054352, 0.08983214944601059, 0.09102150797843933, 0.09096784889698029], [0.09116356074810028, 0.0911887139081955, 0.09080938249826431, 0.09123904258012772, 0.09102757275104523, 0.09112083911895752, 0.09090965241193771, 0.0911029502749443, 0.0893767774105072, 0.0910690426826477, 0.09099248051643372], [0.09109416604042053, 0.09111242741346359, 0.09083690494298935, 0.09114895761013031, 0.0909954309463501, 0.09106315672397614, 0.09090977162122726, 0.0910501629114151, 0.08979352563619614, 0.09102553874254227, 0.09096993505954742], [0.09171362966299057, 0.09179437160491943, 0.09058196097612381, 0.09195606410503387, 0.09127800166606903, 0.09157662838697433, 0.09090136736631393, 0.09151928871870041, 0.08610221743583679, 0.09141068160533905, 0.09116580337285995], [0.09110633283853531, 0.09112580120563507, 0.09083209931850433, 0.09116475284099579, 0.09100107103586197, 0.09107327461242676, 0.09090975672006607, 0.09105942398309708, 0.08972035348415375, 0.09103317558765411, 0.09097389876842499], [0.09113381803035736, 0.0911560133099556, 0.09082120656967163, 0.09120042622089386, 0.09101381152868271, 0.09109611809253693, 0.09090971946716309, 0.09108033776283264, 0.08955524861812592, 0.0910504013299942, 0.0909828320145607]], [[0.09065786749124527, 0.09078476577997208, 0.09104853868484497, 0.09085322171449661, 0.09111718833446503, 0.09059984982013702, 0.09063399583101273, 0.09122025966644287, 0.09102457016706467, 0.09128903597593307, 0.09077072143554688], [0.09068211913108826, 0.09079679101705551, 0.09103509783744812, 0.09085863828659058, 0.09109710901975632, 0.0906296819448471, 0.09066054224967957, 0.09119020402431488, 0.09101343899965286, 0.09125231951475143, 0.09078409522771835], [0.0907323956489563, 0.09082169830799103, 0.09100718796253204, 0.09086984395980835, 0.09105543792247772, 0.09069155901670456, 0.09071560204029083, 0.09112786501646042, 0.0909903347492218, 0.09117617458105087, 0.09081181138753891], [0.09069517254829407, 0.09080325812101364, 0.09102784097194672, 0.09086154401302338, 0.09108627587556839, 0.09064575284719467, 0.09067483991384506, 0.09117400646209717, 0.09100744128227234, 0.091232530772686, 0.09079129248857498], [0.0907454714179039, 0.09082816541194916, 0.09099994599819183, 0.09087275713682175, 0.09104461967945099, 0.09070764482021332, 0.09072990715503693, 0.0911116749048233, 0.09098433703184128, 0.09115640819072723, 0.09081901609897614], [0.09064677357673645, 0.09077925980091095, 0.09105469286441803, 0.09085073322057724, 0.09112638235092163, 0.09058620035648346, 0.09062185138463974, 0.09123402088880539, 0.09102965891361237, 0.09130584448575974, 0.0907646045088768], [0.09065330028533936, 0.09078250825405121, 0.09105107188224792, 0.09085220098495483, 0.09112096577882767, 0.09059423953294754, 0.09062900394201279, 0.09122591465711594, 0.0910266637802124, 0.09129595011472702, 0.09076820313930511], [0.0907650738954544, 0.09083788096904755, 0.09098906815052032, 0.09087713062763214, 0.09102839231491089, 0.09073176980018616, 0.09075137227773666, 0.09108740091323853, 0.09097534418106079, 0.09112676233053207, 0.09082982689142227], [0.09072783589363098, 0.09081944078207016, 0.0910097286105156, 0.09086883813142776, 0.09105922281742096, 0.09068594872951508, 0.0907106027007103, 0.09113352000713348, 0.09099244326353073, 0.09118308871984482, 0.09080930054187775], [0.09077814221382141, 0.09084434807300568, 0.09098182618618011, 0.09088004380464554, 0.09101757407188416, 0.09074786305427551, 0.09076568484306335, 0.0910712257027626, 0.09096933901309967, 0.09110700339078903, 0.0908370241522789], [0.09067942202091217, 0.09079544991254807, 0.09103657305240631, 0.09085802733898163, 0.0910993218421936, 0.09062637388706207, 0.09065760672092438, 0.09119351953268051, 0.09101466834545135, 0.09125637263059616, 0.09078261256217957]], [[0.09084582328796387, 0.09061771631240845, 0.09046348929405212, 0.09067191183567047, 0.09095451235771179, 0.09054464846849442, 0.0908268541097641, 0.09078038483858109, 0.09255144745111465, 0.0907437801361084, 0.09099939465522766], [0.0908278226852417, 0.09053697437047958, 0.09034043550491333, 0.09060605615377426, 0.09096647799015045, 0.09044384956359863, 0.09080362319946289, 0.09074436873197556, 0.09300895780324936, 0.09069768339395523, 0.0910237580537796], [0.0908154845237732, 0.09048216044902802, 0.09025701135396957, 0.09056131541728973, 0.09097443521022797, 0.09037546813488007, 0.09078774601221085, 0.09071982651948929, 0.0933200865983963, 0.09066632390022278, 0.09104011952877045], [0.09083212167024612, 0.09055618941783905, 0.09036970138549805, 0.09062173217535019, 0.09096364676952362, 0.09046782553195953, 0.090809166431427, 0.09075295180082321, 0.09289997816085815, 0.0907086655497551, 0.09101798385381699], [0.09085430949926376, 0.09065606445074081, 0.09052199125289917, 0.09070316702127457, 0.09094874560832977, 0.09059254825115204, 0.09083782136440277, 0.09079744666814804, 0.0923345685005188, 0.09076562523841858, 0.09098773449659348], [0.0908219963312149, 0.0905110314488411, 0.09030093252658844, 0.09058487415313721, 0.09097026288509369, 0.0904114693403244, 0.09079612046480179, 0.09073276072740555, 0.09315618127584457, 0.09068284928798676, 0.091031514108181], [0.09084434062242508, 0.09061101824045181, 0.09045327454805374, 0.09066645056009293, 0.09095551818609238, 0.09053628146648407, 0.09082493185997009, 0.09077741205692291, 0.09258938580751419, 0.09073996543884277, 0.09100143611431122], [0.09084068983793259, 0.0905945897102356, 0.09042822569608688, 0.09065305441617966, 0.09095796197652817, 0.09051577001810074, 0.09082021564245224, 0.09077008813619614, 0.0926823690533638, 0.09073059260845184, 0.09100639820098877], [0.09097155183553696, 0.091209776699543, 0.09137154370546341, 0.09115307033061981, 0.09085847437381744, 0.09128634631633759, 0.09099132567644119, 0.09103976935148239, 0.08922824263572693, 0.09107797592878342, 0.09081185609102249], [0.09083781391382217, 0.09058164805173874, 0.09040848910808563, 0.09064249694347382, 0.09095989167690277, 0.09049960225820541, 0.09081650525331497, 0.09076432138681412, 0.09275573492050171, 0.09072320908308029, 0.09101032465696335], [0.09085778146982193, 0.09067187458276749, 0.0905461236834526, 0.09071604907512665, 0.09094633907079697, 0.09061229974031448, 0.09084232896566391, 0.09080445766448975, 0.0922451987862587, 0.09077462553977966, 0.09098290652036667]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_return_max": 14.5, "env_reset_timer": 0.0005596341969497567, "episode_duration_sec_mean": 0.005356975377071649, "sample": 0.11639687312510054, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1770942429764522e-05, "batch_individual_items": 1.2135082046565703e-05, "add_time_dim_to_batch_and_zero_pad": 6.788785233937813e-06, "add_observations_from_episodes_to_batch": 2.789300910455109e-06, "add_states_from_episodes_to_batch": 2.71534001738964e-06}}, "connector_pipeline_timer": 5.8043028842882496e-05}, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1808837362540946e-05, "normalize_and_clip_actions": 7.780510504716313e-06, "get_actions": 3.5212908879890356e-05, "listify_data_for_vector_env": 1.0303505195000287e-05, "un_batch_to_individual_items": 6.530118823359605e-06, "tensor_to_numpy": 1.4768083214352033e-05}}, "connector_pipeline_timer": 0.00011230312673836847}, "env_to_module_sum_episodes_length_in": 10.368238394572801, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 2.45}, "episode_return_mean": 2.45, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "env_to_module_sum_episodes_length_out": 10.368238394572801, "num_env_steps_sampled": 400, "weights_seq_no": 7.0, "episode_len_max": 20, "episode_return_min": -13.5, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 2.45}, "num_episodes_lifetime": 140, "episode_len_min": 20, "env_step_timer": 1.3877549060869356e-05, "num_env_steps_sampled_lifetime": 35400, "rlmodule_inference_timer": 3.060606083613938e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "time_between_sampling": 9.372829009466658}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "b19cd_00000", "date": "2025-08-11_18-40-59", "timestamp": 1754930459, "time_this_iter_s": 8.971184015274048, "time_total_s": 66.07566237449646, "pid": 11628, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1629fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 66.07566237449646, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 36.4, "ram_util_percent": 77.45833333333333}}
{"timers": {"training_iteration": 9.140303883505354, "restore_env_runners": 9.44611880409935e-06, "training_step": 9.140177339603255, "env_runner_sampling_timer": 1.6653395439620462, "learner_update_timer": 7.301739045647198, "synch_weights": 0.0008272945157333103, "restore_eval_env_runners": 9.45101360567801e-06, "evaluation_iteration": 0.12698070176964713, "synch_eval_env_connectors": 0.00018083946429940832, "synch_env_connectors": 4.620799553838447e-06}, "env_runners": {"env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "env_reset_timer": 3.5992986686304604e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.868810011706385e-05, "listify_data_for_vector_env": 1.0445067845701512e-05, "tensor_to_numpy": 1.5066090889513109e-05, "un_batch_to_individual_items": 6.688337438391809e-06, "remove_single_ts_time_rank_from_batch": 1.1946484758454227e-05, "normalize_and_clip_actions": 7.892167583480225e-06}}, "connector_pipeline_timer": 0.0001170596682281048}, "episode_duration_sec_mean": 0.005243041333276779, "sample": 0.005567540085075834, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7173548647334943e-06, "numpy_to_tensor": 1.2402458712888243e-05, "batch_individual_items": 1.2567941966639042e-05, "add_observations_from_episodes_to_batch": 2.770855975100207e-06, "add_time_dim_to_batch_and_zero_pad": 6.8908080431492944e-06}}, "connector_pipeline_timer": 5.945532334092218e-05}, "agent_episode_returns_mean": {"default_agent": 1.3000000000000003}, "time_between_sampling": 0.03049234418888127, "weights_seq_no": 7.0, "num_episodes_lifetime": -184750.0, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 1.3000000000000003}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "episode_return_mean": 1.3000000000000003, "episode_len_max": 20, "env_step_timer": 1.4037934140367753e-05, "num_env_steps_sampled_lifetime": -3695000.0, "episode_len_mean": 20.0, "rlmodule_inference_timer": 3.098386096754029e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime_throughput": 3289.42530698673}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13531216396442616, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009039332351802255, "add_observations_from_episodes_to_batch": 0.000884248110159674, "add_columns_from_episodes_to_train_batch": 0.04192135068188395, "add_time_dim_to_batch_and_zero_pad": 0.07546532418885069, "add_states_from_episodes_to_batch": 0.003549999857753597, "batch_individual_items": 0.004238751703450316, "numpy_to_tensor": 6.419033499466111e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 41.0, "module_train_batch_size_mean": 997.5252898807411, "total_loss": 0.0, "weights_seq_no": 48.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 287280}, "default_policy": {"module_train_batch_size_mean": 997.5252898807411, "mean_kl_loss": 1.286465590055741e-06, "weights_seq_no": 48.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 287280, "diff_num_grad_updates_vs_sampler_policy": 41.0, "use_intrinsic_rewards": 1.0, "entropy": 0.680168092250824, "vf_loss_unclipped": 44.41921615600586, "vf_explained_var": 0.003437519073486328, "policy_loss": -0.0001056337496265769, "total_loss": 0.27802932262420654, "vf_loss": 0.35836467146873474}, "__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 574560, "num_env_steps_trained_lifetime": 1584000, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 55406.265935551106}}}, "default_policy": {"curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.35830581188201904, "mean_kl_loss": 1.7077040865842719e-06, "num_module_steps_trained_lifetime": 47880, "module_train_batch_size_mean": 997.8076834879114, "weights_seq_no": 8.0, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 16595, "use_intrinsic_rewards": 0.0, "entropy": 0.6801280379295349, "vf_loss_unclipped": 44.53135681152344, "vf_explained_var": 0.0006040334701538086, "curr_kl_coeff": 0.0006311872275546193, "policy_loss": -0.00011878571240231395, "total_loss": 0.27797022461891174, "num_module_steps_trained_lifetime_throughput": 809.1488475920241}, "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 997.8076834879114, "weights_seq_no": 8.0, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 47880, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 809.1616144939113}, "__all_modules__": {"num_env_steps_trained_lifetime": 264000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 33000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 95760, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4463.128818458111, "num_module_steps_trained_throughput": 26473606.578808606, "num_module_steps_trained_lifetime_throughput": 12952124.930092387}, "IntrinsicAttentionMask": [[[0.09130068123340607, 0.09058710187673569, 0.09078581631183624, 0.09063868224620819, 0.09108113497495651, 0.09093352407217026, 0.09071610867977142, 0.09115893393754959, 0.0907677561044693, 0.09121084213256836, 0.09081944823265076], [0.09167340397834778, 0.09028194099664688, 0.09066838026046753, 0.0903821662068367, 0.09124419093132019, 0.09095615893602371, 0.09053272753953934, 0.09139618277549744, 0.09063324332237244, 0.09149765223264694, 0.09073386341333389], [0.09156922250986099, 0.09036710858345032, 0.09070121496915817, 0.09045378863811493, 0.09119868278503418, 0.0909498929977417, 0.09058395773172379, 0.09132992476224899, 0.09067084640264511, 0.09141752123832703, 0.0907578095793724], [0.09164634346961975, 0.09030406922101974, 0.0906769260764122, 0.09040078520774841, 0.09123238176107407, 0.09095454216003418, 0.09054604917764664, 0.09137897938489914, 0.0906430184841156, 0.09147684276103973, 0.09074009954929352], [0.09141494333744049, 0.09049341082572937, 0.0907498225569725, 0.0905599519610405, 0.09113119542598724, 0.09094052761793137, 0.09065985679626465, 0.09123172610998154, 0.09072651714086533, 0.09129881113767624, 0.09079323709011078], [0.09149197489023209, 0.09043032675981522, 0.09072555601596832, 0.09050693362951279, 0.09116490185260773, 0.09094521403312683, 0.0906219556927681, 0.09128076583147049, 0.0906987190246582, 0.09135808795690536, 0.09077554941177368], [0.09160573035478592, 0.09033724665641785, 0.09068970382213593, 0.0904286801815033, 0.0912146344780922, 0.09095209091901779, 0.0905659943819046, 0.0913531482219696, 0.09065765887498856, 0.09144560992717743, 0.09074942022562027], [0.09137441217899323, 0.09052663296461105, 0.09076259285211563, 0.09058787673711777, 0.09111344814300537, 0.09093805402517319, 0.09067981690168381, 0.0912059098482132, 0.09074115008115768, 0.09126760810613632, 0.09080253541469574], [0.09157868474721909, 0.0903593897819519, 0.0906982496380806, 0.09044729918241501, 0.09120282530784607, 0.09095047414302826, 0.0905793160200119, 0.09133594483137131, 0.09066744148731232, 0.09142480045557022, 0.0907556489109993], [0.09134739637374878, 0.0905487909913063, 0.09077110141515732, 0.09060648828744888, 0.09110160917043686, 0.09093639254570007, 0.09069310873746872, 0.0911887064576149, 0.09075090289115906, 0.09124681353569031, 0.09080873429775238], [0.09155162423849106, 0.09038151055574417, 0.09070676565170288, 0.09046589583158493, 0.09119098633527756, 0.09094883501529694, 0.09059261530637741, 0.09131872653961182, 0.09067720174789429, 0.09140399098396301, 0.09076185524463654]], [[0.09037041664123535, 0.0907391607761383, 0.09053712338209152, 0.09081017225980759, 0.09084570407867432, 0.09031038731336594, 0.09067889302968979, 0.09061819314956665, 0.09328121691942215, 0.0909043699502945, 0.0909043699502945], [0.09051124006509781, 0.09078408032655716, 0.09063462913036346, 0.09083659201860428, 0.09086285531520844, 0.09046680480241776, 0.09073950350284576, 0.0906946137547493, 0.0926571935415268, 0.09090622514486313, 0.09090622514486313], [0.09043418616056442, 0.09075954556465149, 0.09058130532503128, 0.09082219004631042, 0.09085352718830109, 0.0903812050819397, 0.09070637822151184, 0.09065283089876175, 0.09299832582473755, 0.09090527147054672, 0.09090527147054672], [0.09053827822208405, 0.09079266339540482, 0.09065332263708115, 0.0908416211605072, 0.0908661037683487, 0.09049683064222336, 0.09075110405683517, 0.09070924669504166, 0.09253773838281631, 0.0909065380692482, 0.0909065380692482], [0.09055177867412567, 0.09079694747924805, 0.09066266566514969, 0.09084412455558777, 0.09086772054433823, 0.09051184356212616, 0.09075690060853958, 0.09071655571460724, 0.09247805923223495, 0.09090667963027954, 0.09090667963027954], [0.09034740924835205, 0.09073179215192795, 0.0905211791396141, 0.09080582112073898, 0.09084285795688629, 0.09028484672307968, 0.09066896140575409, 0.09060568362474442, 0.09338339418172836, 0.09090402722358704, 0.09090402722358704], [0.09048827737569809, 0.09077677875757217, 0.09061873704195023, 0.09083230793476105, 0.09086008369922638, 0.09044129401445389, 0.09072963893413544, 0.09068216383457184, 0.09275875985622406, 0.09090594947338104, 0.09090594947338104], [0.09046512842178345, 0.09076941013336182, 0.09060272574424744, 0.09082797914743423, 0.09085728228092194, 0.0904155746102333, 0.09071968495845795, 0.09066960960626602, 0.09286121279001236, 0.09090566635131836, 0.09090566635131836], [0.09146088361740112, 0.09107781201601028, 0.09128730744123459, 0.0910044014453888, 0.09096771478652954, 0.09152355045080185, 0.09114020317792892, 0.09120313078165054, 0.08852056413888931, 0.09090719372034073, 0.09090719372034073], [0.09057409316301346, 0.09080402553081512, 0.09067808836698532, 0.09084826707839966, 0.09087038785219193, 0.09053663164377213, 0.09076646715402603, 0.09072863310575485, 0.09237964451313019, 0.09090693295001984, 0.09090693295001984], [0.09057409316301346, 0.09080402553081512, 0.09067808836698532, 0.09084826707839966, 0.09087038785219193, 0.09053663164377213, 0.09076646715402603, 0.09072863310575485, 0.09237964451313019, 0.09090693295001984, 0.09090693295001984]], [[0.09125632792711258, 0.0907859280705452, 0.09098508208990097, 0.09059464931488037, 0.09103688597679138, 0.0908893495798111, 0.09067203849554062, 0.0908709391951561, 0.09096698462963104, 0.09116653352975845, 0.09077532589435577], [0.09147389978170395, 0.09070880711078644, 0.09103241562843323, 0.0903983935713768, 0.09111667424440384, 0.09087680280208588, 0.09052392840385437, 0.09084688127040863, 0.09100300073623657, 0.09132765978574753, 0.09069158136844635], [0.09138160198926926, 0.09074151515960693, 0.09101235866546631, 0.09048156440258026, 0.0910828486084938, 0.09088212996721268, 0.09058671444654465, 0.09085709601640701, 0.09098774194717407, 0.09125932306051254, 0.09072709083557129], [0.09156279265880585, 0.09067729860544205, 0.09105169028043747, 0.09031836688518524, 0.0911492109298706, 0.09087162464857101, 0.09046350419521332, 0.0908370092511177, 0.09101764857769012, 0.09139344841241837, 0.09065736830234528], [0.09135763347148895, 0.09075000137090683, 0.09100713580846786, 0.09050317853689194, 0.09107406437397003, 0.0908835157752037, 0.09060301631689072, 0.09085974097251892, 0.09098377078771591, 0.09124156832695007, 0.09073631465435028], [0.09142594039440155, 0.09072580188512802, 0.09102199971675873, 0.09044160693883896, 0.09109910577535629, 0.09087957441806793, 0.0905565544962883, 0.09085219353437424, 0.09099508076906204, 0.09129215031862259, 0.09071003645658493], [0.09152679890394211, 0.09069005399942398, 0.09104388952255249, 0.09035076200962067, 0.09113603830337524, 0.09087372571229935, 0.09048796445131302, 0.09084101021289825, 0.09101171791553497, 0.09136681258678436, 0.09067122638225555], [0.09143447130918503, 0.09072277694940567, 0.09102385491132736, 0.09043391048908234, 0.0911022275686264, 0.09087908267974854, 0.0905507430434227, 0.09085124731063843, 0.09099648892879486, 0.09129846841096878, 0.09070675075054169], [0.0913899764418602, 0.09073854237794876, 0.09101418405771255, 0.09047401696443558, 0.09108591824769974, 0.09088164567947388, 0.090581014752388, 0.0908561646938324, 0.0909891277551651, 0.09126552194356918, 0.09072386473417282], [0.09129774570465088, 0.09077124297618866, 0.09099410474300385, 0.09055723994970322, 0.0910520926117897, 0.09088696539402008, 0.09064381569623947, 0.09086636453866959, 0.0909738540649414, 0.09119721502065659, 0.09075937420129776], [0.09147882461547852, 0.09070706367492676, 0.09103348851203918, 0.09039396047592163, 0.0911184772849083, 0.0908765122294426, 0.09052058309316635, 0.09084633737802505, 0.09100381284952164, 0.09133130311965942, 0.09068968892097473]], [[0.09034024178981781, 0.09070886671543121, 0.0905068963766098, 0.0907798558473587, 0.09081537276506424, 0.09061316400766373, 0.0903155580163002, 0.09092199802398682, 0.09325007349252701, 0.09087401628494263, 0.09087401628494263], [0.09048890322446823, 0.09076166898012161, 0.0906122550368309, 0.09081416577100754, 0.0908404290676117, 0.09069088846445084, 0.09047062695026398, 0.09091924875974655, 0.09263432025909424, 0.0908837839961052, 0.0908837839961052], [0.09040754288434982, 0.09073280543088913, 0.0905546098947525, 0.09079542756080627, 0.09082675725221634, 0.09064837545156479, 0.09038574993610382, 0.09092079848051071, 0.09297092258930206, 0.09087848663330078, 0.09087848663330078], [0.09051743894815445, 0.09077176451683044, 0.09063245356082916, 0.09082070738077164, 0.09084518998861313, 0.0907057672739029, 0.09050039201974869, 0.09091866761445999, 0.09251643717288971, 0.09088560938835144, 0.09088560938835144], [0.09053169935941696, 0.09077680855989456, 0.09064255654811859, 0.09082397073507309, 0.09084756672382355, 0.09071320295333862, 0.09051527082920074, 0.09091837704181671, 0.09245754778385162, 0.09088651835918427, 0.09088651835918427], [0.09045038372278214, 0.09074801951646805, 0.09058497101068497, 0.09080531448125839, 0.09083396941423416, 0.09067077189683914, 0.09043043851852417, 0.09092000871896744, 0.09279359132051468, 0.09088129550218582, 0.09088129550218582], [0.09033025056123734, 0.09070529788732529, 0.09049980342388153, 0.09077752381563187, 0.09081366658210754, 0.09060791879892349, 0.0903051346540451, 0.09092215448617935, 0.0932915210723877, 0.0908733382821083, 0.0908733382821083], [0.0905744805932045, 0.09079191088676453, 0.0906728208065033, 0.09083373844623566, 0.09085466712713242, 0.09073549509048462, 0.09055990725755692, 0.09091746062040329, 0.09228107333183289, 0.09088920801877975, 0.09088920801877975], [0.09149251133203506, 0.09110929816961288, 0.09131886810064316, 0.0910358652472496, 0.09099917113780975, 0.09120848029851913, 0.09151829034090042, 0.09088917076587677, 0.08855117112398148, 0.09093862771987915, 0.09093862771987915], [0.09055524319410324, 0.09078512340784073, 0.09065921604633331, 0.09082935750484467, 0.09085147827863693, 0.09072547405958176, 0.0905398279428482, 0.09091787785291672, 0.09236041456460953, 0.09088800847530365, 0.09088800847530365], [0.09055524319410324, 0.09078512340784073, 0.09065921604633331, 0.09082935750484467, 0.09085147827863693, 0.09072547405958176, 0.0905398279428482, 0.09091787785291672, 0.09236041456460953, 0.09088800847530365, 0.09088800847530365]], [[0.09068716317415237, 0.09081409871578217, 0.09107795357704163, 0.09056084603071213, 0.09082396328449249, 0.0909510999917984, 0.09098538011312485, 0.09092669934034348, 0.09073164314031601, 0.0913185328245163, 0.09112263470888138], [0.09070857614278793, 0.09082328528165817, 0.09106166660785675, 0.09059441834688187, 0.0908321961760521, 0.09094706177711487, 0.09097803384065628, 0.09092502295970917, 0.09074877202510834, 0.09127894788980484, 0.09110201895236969], [0.09075301140546799, 0.09084232896566391, 0.09102786332368851, 0.0906640961766243, 0.09084926545619965, 0.09093867987394333, 0.09096278250217438, 0.09092152118682861, 0.09078431129455566, 0.09119688719511032, 0.09105926007032394], [0.09066580981016159, 0.09080493450164795, 0.09109418839216232, 0.09052737802267075, 0.09081574529409409, 0.09095510840415955, 0.09099268913269043, 0.09092836827039719, 0.09071455895900726, 0.09135798364877701, 0.0911431685090065], [0.09071024507284164, 0.09082400053739548, 0.09106040000915527, 0.09059703350067139, 0.09083283692598343, 0.0909467488527298, 0.09097746014595032, 0.09092488884925842, 0.09075010567903519, 0.09127587825059891, 0.09110041707754135], [0.0907316580414772, 0.09083317220211029, 0.0910440981388092, 0.09063061326742172, 0.09084106236696243, 0.09094270318746567, 0.09097010642290115, 0.09092320501804352, 0.09076723456382751, 0.09123630076646805, 0.09107979387044907], [0.09073743224143982, 0.09083565324544907, 0.09103970974683762, 0.09063966572284698, 0.09084328263998032, 0.09094162285327911, 0.09096812456846237, 0.0909227505326271, 0.09077185392379761, 0.09122564643621445, 0.09107424318790436], [0.0907275527715683, 0.09083142131567001, 0.09104722738265991, 0.09062417596578598, 0.09083949029445648, 0.09094348549842834, 0.09097152203321457, 0.09092352539300919, 0.09076395630836487, 0.09124389290809631, 0.09108375757932663], [0.09069465845823288, 0.09081731736660004, 0.09107223898172379, 0.09057260304689407, 0.0908268466591835, 0.09094967693090439, 0.09098279476165771, 0.09092610329389572, 0.09073764085769653, 0.09130464494228363, 0.09111539274454117], [0.09079340845346451, 0.09085962176322937, 0.0909971222281456, 0.09072747081518173, 0.09086477011442184, 0.09093104302883148, 0.09094890207052231, 0.09091832488775253, 0.09081661701202393, 0.09112232178449631, 0.09102039039134979], [0.09076052159070969, 0.09084554761648178, 0.09102214872837067, 0.09067587554454803, 0.09085214883089066, 0.09093725681304932, 0.09096019715070724, 0.09092092514038086, 0.09079031646251678, 0.09118302166461945, 0.09105203300714493]], [[0.0910448506474495, 0.09090956300497055, 0.09096924960613251, 0.09109316021203995, 0.0911092683672905, 0.09101751446723938, 0.09103360772132874, 0.09100605547428131, 0.08989716321229935, 0.09098434448242188, 0.09093531966209412], [0.0911078080534935, 0.09090937674045563, 0.09099689871072769, 0.09117869287729263, 0.09120233356952667, 0.09106769412755966, 0.09109130501747131, 0.0910508930683136, 0.08942887932062149, 0.09101904183626175, 0.09094715118408203], [0.09108004719018936, 0.09090948104858398, 0.09098471701145172, 0.09114095568656921, 0.09116127341985703, 0.0910455659031868, 0.09106586128473282, 0.09103112667798996, 0.08963526785373688, 0.09100375324487686, 0.09094195067882538], [0.09102234244346619, 0.09090956300497055, 0.09095931798219681, 0.09106260538101196, 0.09107603132724762, 0.0909995511174202, 0.09101296961307526, 0.09099000692367554, 0.09006472676992416, 0.09097190946340561, 0.09093104302883148], [0.09101482480764389, 0.09090954810380936, 0.09095599502325058, 0.09105240553617477, 0.0910649374127388, 0.09099355340003967, 0.0910060703754425, 0.09098463505506516, 0.09012063592672348, 0.09096774458885193, 0.09092959016561508], [0.09105757623910904, 0.09090953320264816, 0.0909748375415802, 0.09111043810844421, 0.09112806618213654, 0.0910276547074318, 0.09104526787996292, 0.09101512283086777, 0.08980239182710648, 0.09099136292934418, 0.09093771874904633], [0.09105008095502853, 0.09090954810380936, 0.09097154438495636, 0.09110026061534882, 0.0911169946193695, 0.09102167934179306, 0.09103839844465256, 0.09100978076457977, 0.08985816687345505, 0.09098722785711288, 0.09093630313873291], [0.09106291085481644, 0.09090952575206757, 0.09097718447446823, 0.09111768752336502, 0.09113594889640808, 0.09103190898895264, 0.0910501629114151, 0.0910189226269722, 0.08976271003484726, 0.09099430590867996, 0.09093872457742691], [0.0915752500295639, 0.0908999890089035, 0.09119738638401031, 0.09181731939315796, 0.09189815074205399, 0.09143845736980438, 0.09151895344257355, 0.09138119965791702, 0.08597230911254883, 0.0912727564573288, 0.09102825075387955], [0.09107301384210587, 0.09090950340032578, 0.0909816324710846, 0.09113141894340515, 0.09115088731050491, 0.09103997051715851, 0.09105942398309708, 0.09102611988782883, 0.0896875411272049, 0.09099987894296646, 0.09094063192605972], [0.09109582751989365, 0.0909094288945198, 0.09099165350198746, 0.09116241335868835, 0.09118461608886719, 0.0910581573843956, 0.09108033031225204, 0.09104236960411072, 0.08951792120933533, 0.09101245552301407, 0.09094491600990295]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_return_max": 14.5, "env_reset_timer": 0.0005548378552510877, "episode_duration_sec_mean": 0.005160495357122272, "sample": 0.1163460681435369, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1837367173437347e-05, "batch_individual_items": 1.2278155638014122e-05, "add_time_dim_to_batch_and_zero_pad": 6.880529878129519e-06, "add_observations_from_episodes_to_batch": 2.7853069558916108e-06, "add_states_from_episodes_to_batch": 2.6676152946720786e-06}}, "connector_pipeline_timer": 5.8344670792383176e-05}, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1797974038176402e-05, "normalize_and_clip_actions": 7.823278622619853e-06, "get_actions": 3.572387773185923e-05, "listify_data_for_vector_env": 1.0212418286624857e-05, "un_batch_to_individual_items": 6.626168595151722e-06, "tensor_to_numpy": 1.4765163490716338e-05}}, "connector_pipeline_timer": 0.00011288958555397691}, "env_to_module_sum_episodes_length_in": 10.3682383945743, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 2.05}, "episode_return_mean": 2.05, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "env_to_module_sum_episodes_length_out": 10.3682383945743, "num_env_steps_sampled": 400, "weights_seq_no": 8.0, "episode_len_max": 20, "episode_return_min": -13.5, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 2.05}, "num_episodes_lifetime": 160, "episode_len_min": 20, "env_step_timer": 1.3679833719304925e-05, "num_env_steps_sampled_lifetime": 40400, "rlmodule_inference_timer": 3.05842733421483e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "time_between_sampling": 9.370996051042521}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "b19cd_00000", "date": "2025-08-11_18-41-09", "timestamp": 1754930469, "time_this_iter_s": 9.284984111785889, "time_total_s": 75.36064648628235, "pid": 11628, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1629fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 75.36064648628235, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 40.364285714285714, "ram_util_percent": 78.81428571428572}}
{"timers": {"training_iteration": 9.156504180090435, "restore_env_runners": 9.409577731126911e-06, "training_step": 9.156377023707353, "env_runner_sampling_timer": 1.6738216651922597, "learner_update_timer": 7.309287275600051, "synch_weights": 0.0008280694916244545, "restore_eval_env_runners": 9.418162844826865e-06, "evaluation_iteration": 0.1268747430819846, "synch_eval_env_connectors": 0.00018020231955270216, "synch_env_connectors": 4.618751382328674e-06}, "env_runners": {"env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "env_reset_timer": 6.403197265907379e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 7.613062545596734e-05, "listify_data_for_vector_env": 1.7146995469405873e-05, "tensor_to_numpy": 2.413593488815644e-05, "un_batch_to_individual_items": 9.408927760082767e-06, "remove_single_ts_time_rank_from_batch": 1.6689915862753864e-05, "normalize_and_clip_actions": 1.219741185080877e-05}}, "connector_pipeline_timer": 0.00019401207637997705}, "episode_duration_sec_mean": 0.008719689356628807, "sample": 0.008223130071080578, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.876042051337048e-06, "numpy_to_tensor": 2.235404752936903e-05, "batch_individual_items": 2.0223533401480296e-05, "add_observations_from_episodes_to_batch": 4.263295010514942e-06, "add_time_dim_to_batch_and_zero_pad": 1.1177869188856174e-05}}, "connector_pipeline_timer": 9.240564403299097e-05}, "agent_episode_returns_mean": {"default_agent": 0.8199999999999998}, "time_between_sampling": 0.03169772500313183, "weights_seq_no": 8.0, "num_episodes_lifetime": -215625.0, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 0.8199999999999998}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "episode_return_mean": 0.8199999999999998, "episode_len_max": 20, "env_step_timer": 2.5803505226613526e-05, "num_env_steps_sampled_lifetime": -4312500.0, "episode_len_mean": 20.0, "rlmodule_inference_timer": 5.520067446853086e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime_throughput": 2471.508189981265}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13533600732530887, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009038989028283114, "add_observations_from_episodes_to_batch": 0.0008840768790195578, "add_columns_from_episodes_to_train_batch": 0.041923228424510565, "add_time_dim_to_batch_and_zero_pad": 0.07548554969705173, "add_states_from_episodes_to_batch": 0.0035522890188632973, "batch_individual_items": 0.00423871043668165, "numpy_to_tensor": 6.428260137935641e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 46.0, "module_train_batch_size_mean": 997.5168494263723, "total_loss": 0.0, "weights_seq_no": 54.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 323190}, "default_policy": {"module_train_batch_size_mean": 997.5168494263723, "mean_kl_loss": 1.1991309293080121e-05, "weights_seq_no": 54.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 323190, "diff_num_grad_updates_vs_sampler_policy": 46.0, "use_intrinsic_rewards": 1.0, "entropy": 0.6794891357421875, "vf_loss_unclipped": 45.057640075683594, "vf_explained_var": 0.0034728050231933594, "policy_loss": -0.00017231909441761672, "total_loss": 0.27795830368995667, "vf_loss": 0.35835546255111694}, "__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 646380, "num_env_steps_trained_lifetime": 1782000, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 54403.996688069325}}}, "default_policy": {"curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.3583044409751892, "mean_kl_loss": 1.2784450518665835e-05, "num_module_steps_trained_lifetime": 53865, "module_train_batch_size_mean": 997.7895308613665, "weights_seq_no": 9.0, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 16595, "use_intrinsic_rewards": 0.0, "entropy": 0.6794629096984863, "vf_loss_unclipped": 45.14247131347656, "vf_explained_var": 0.0015390515327453613, "curr_kl_coeff": 0.00031559361377730966, "policy_loss": -0.00017804316303227097, "total_loss": 0.27791091799736023, "num_module_steps_trained_lifetime_throughput": 805.1424477816488}, "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 997.7895308613665, "weights_seq_no": 9.0, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 53865, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 805.1545397222917}, "__all_modules__": {"num_env_steps_trained_lifetime": 297000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 33000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 107730, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4440.975124169458, "num_module_steps_trained_throughput": 25757797.872291494, "num_module_steps_trained_lifetime_throughput": 12922546.554960307}, "IntrinsicAttentionMask": [[[0.09062861651182175, 0.09075547754764557, 0.0910191610455513, 0.09050238132476807, 0.09108778834342957, 0.09089238196611404, 0.0906047523021698, 0.09119082987308502, 0.09099519997835159, 0.09125958383083344, 0.09106381237506866], [0.09065567702054977, 0.09077031910419464, 0.09100855886936188, 0.09054158627986908, 0.09107054769992828, 0.09089402109384537, 0.09063410758972168, 0.09116362035274506, 0.09098690748214722, 0.09122571349143982, 0.09104888886213303], [0.09071182459592819, 0.09080110490322113, 0.09098654985427856, 0.09062294661998749, 0.09103478491306305, 0.09089740365743637, 0.09069503098726273, 0.09110719710588455, 0.09096970409154892, 0.09115549921989441, 0.09101793169975281], [0.09060164541006088, 0.09074068069458008, 0.09102972596883774, 0.0904633179306984, 0.09110496938228607, 0.09089074283838272, 0.09057550132274628, 0.09121793508529663, 0.09100345522165298, 0.0912933349609375, 0.09107867628335953], [0.09072641283273697, 0.09080909937620163, 0.09098083525896072, 0.09064409136772156, 0.09102550894021988, 0.0908982902765274, 0.09071085602045059, 0.0910925418138504, 0.09096523374319077, 0.09113726764917374, 0.09100989252328873], [0.09068484604358673, 0.09078630805015564, 0.0909971222281456, 0.09058384597301483, 0.09105197340250015, 0.09089577943086624, 0.09066575765609741, 0.09113430231809616, 0.09097796678543091, 0.09118922799825668, 0.09103280305862427], [0.09062352031469345, 0.09075269103050232, 0.09102116525173187, 0.09049500524997711, 0.09109103679656982, 0.09089207649230957, 0.09059923142194748, 0.09119594842195511, 0.09099676460027695, 0.0912659615278244, 0.09106661379337311], [0.09074829518795013, 0.09082108736038208, 0.09097225219011307, 0.09067581593990326, 0.09101156145334244, 0.09089959412813187, 0.09073460102081299, 0.09107056260108948, 0.09095852077007294, 0.09110991656780243, 0.09099783003330231], [0.0907067209482193, 0.09079831093549728, 0.09098854660987854, 0.09061555564403534, 0.09103803336620331, 0.0908970981836319, 0.09068949520587921, 0.09111231565475464, 0.09097126871347427, 0.09116186946630478, 0.09102074056863785], [0.09076287597417831, 0.09082906693220139, 0.09096652269363403, 0.09069696068763733, 0.09100226312875748, 0.09090045839548111, 0.09075041860342026, 0.09105589985847473, 0.09095404297113419, 0.09109167754650116, 0.09098977595567703], [0.09072131663560867, 0.09080630540847778, 0.0909828320145607, 0.09063670784235, 0.09102874994277954, 0.09089798480272293, 0.09070532768964767, 0.09109766781330109, 0.09096679836511612, 0.0911436378955841, 0.09101270884275436]], [[0.0910036489367485, 0.09101974219083786, 0.0909280776977539, 0.09105193614959717, 0.09106803685426712, 0.09097632765769958, 0.09099241346120834, 0.09096487611532211, 0.09000612050294876, 0.09109462052583694, 0.0908941701054573], [0.09099843353033066, 0.09101363271474838, 0.09092704951763153, 0.09104404598474503, 0.09105925261974335, 0.09097262471914291, 0.09098781645298004, 0.09096180647611618, 0.09005595743656158, 0.09108435362577438, 0.09089501947164536], [0.09102814644575119, 0.09104843437671661, 0.09093287587165833, 0.09108903259038925, 0.09110932797193527, 0.09099369496107101, 0.09101397544145584, 0.09097926318645477, 0.08977227658033371, 0.09114285558462143, 0.09089013189077377], [0.09098798781633377, 0.09100140631198883, 0.09092499315738678, 0.09102823585271835, 0.09104165434837341, 0.09096521139144897, 0.09097861498594284, 0.09095565974712372, 0.0901557132601738, 0.09106381237506866, 0.09089671820402145], [0.09098276495933533, 0.09099528193473816, 0.09092395007610321, 0.09102033078670502, 0.09103286266326904, 0.0909615010023117, 0.09097401052713394, 0.09095259010791779, 0.09020562469959259, 0.0910535380244255, 0.0908975601196289], [0.09101251512765884, 0.09103012084960938, 0.09092982113361359, 0.09106535464525223, 0.09108296781778336, 0.09098260849714279, 0.09100021421909332, 0.09097008407115936, 0.08992151916027069, 0.09111206233501434, 0.0908927172422409], [0.091007299721241, 0.0910240113735199, 0.09092880040407181, 0.09105745702981949, 0.09107418358325958, 0.09097890555858612, 0.09099561721086502, 0.09096701443195343, 0.08997131139039993, 0.09110179543495178, 0.09089357405900955], [0.09101622551679611, 0.09103447198867798, 0.09093054383993149, 0.09107097238302231, 0.09108922630548477, 0.0909852460026741, 0.09100348502397537, 0.09097226709127426, 0.08988608419895172, 0.09111937135457993, 0.09089211374521255], [0.09132400155067444, 0.09139596670866013, 0.09098660200834274, 0.09154007583856583, 0.09161221235990524, 0.09120187908411026, 0.09127374738454819, 0.09115074574947357, 0.08694781363010406, 0.09173141419887543, 0.09083552658557892], [0.09097412973642349, 0.09098517894744873, 0.09092222899198532, 0.0910072773694992, 0.09101832658052444, 0.09095536172389984, 0.09096640348434448, 0.09094750136137009, 0.09028807282447815, 0.09103657305240631, 0.09089894592761993], [0.09103912115097046, 0.0910613015294075, 0.09093500673770905, 0.09110566228628159, 0.09112785011529922, 0.0910014659166336, 0.09102363139390945, 0.09098569303750992, 0.08966746181249619, 0.0911644920706749, 0.09088829904794693]], [[0.09065781533718109, 0.0907847136259079, 0.09104848653078079, 0.09053154289722443, 0.09111713618040085, 0.09059979766607285, 0.0909559354186058, 0.09122020751237869, 0.09070228040218353, 0.0912889838218689, 0.09109314531087875], [0.09068206697702408, 0.09079673886299133, 0.09103504568338394, 0.0905679389834404, 0.09109705686569214, 0.09062962979078293, 0.09095143526792526, 0.0911901518702507, 0.09072224795818329, 0.09125226736068726, 0.09107539057731628], [0.0907323807477951, 0.09082168340682983, 0.09100717306137085, 0.0906434878706932, 0.09105542302131653, 0.09069154411554337, 0.09094210714101791, 0.09112785011529922, 0.09076368063688278, 0.09117615967988968, 0.09103856235742569], [0.09063363820314407, 0.09077271819114685, 0.09106186777353287, 0.09049525856971741, 0.09113713353872299, 0.09057005494832993, 0.09096039831638336, 0.09125014394521713, 0.09068237245082855, 0.09132556617259979, 0.09111082553863525], [0.0907454565167427, 0.09082815051078796, 0.09099993109703064, 0.0906631126999855, 0.0910446047782898, 0.09070762991905212, 0.09093967825174332, 0.09111166000366211, 0.09077443927526474, 0.09115639328956604, 0.09102899581193924], [0.09064671397209167, 0.09077920019626617, 0.09105463325977325, 0.09051487594842911, 0.09112632274627686, 0.09058614075183868, 0.09095798432826996, 0.09123396128416061, 0.09069313853979111, 0.09130578488111496, 0.0911012664437294], [0.09071473777294159, 0.09081293642520905, 0.09101694822311401, 0.09061700105667114, 0.0910700187087059, 0.09066984057426453, 0.09094537794589996, 0.09114968031644821, 0.09074915945529938, 0.09120283275842667, 0.09105146676301956], [0.09076505154371262, 0.09083785861730576, 0.09098904579877853, 0.09069256484508514, 0.0910283699631691, 0.09073174744844437, 0.09093602001667023, 0.09108737856149673, 0.09079056978225708, 0.09112673997879028, 0.09101463109254837], [0.09066631644964218, 0.09078893065452576, 0.09104377031326294, 0.09054429829120636, 0.09111009538173676, 0.09061025083065033, 0.09095435589551926, 0.09120966494083405, 0.09070928394794464, 0.09127610921859741, 0.09108691662549973], [0.09077811986207962, 0.09084432572126389, 0.09098180383443832, 0.09071219712495804, 0.09101755172014236, 0.09074784070253372, 0.09093359112739563, 0.09107120335102081, 0.09080132842063904, 0.09110698103904724, 0.09100506454706192], [0.0907408818602562, 0.0908258855342865, 0.091002456843853, 0.09065625071525574, 0.09104838222265244, 0.09070200473070145, 0.09094052016735077, 0.09111731499433517, 0.0907706692814827, 0.09116329252719879, 0.09103233367204666]], [[0.0910448282957077, 0.09106092900037766, 0.09096921980381012, 0.09094169735908508, 0.0911092460155487, 0.09101749211549759, 0.09088223427534103, 0.09115758538246155, 0.08989714086055756, 0.09098432213068008, 0.09093529731035233], [0.0910373255610466, 0.09105253219604492, 0.09096591919660568, 0.09093990921974182, 0.09109816700220108, 0.09101150929927826, 0.0908837541937828, 0.09114382416009903, 0.0899529680609703, 0.09098018705844879, 0.09093387424945831], [0.09108001738786697, 0.09110032021999359, 0.09098469465970993, 0.09094998240470886, 0.09116125106811523, 0.09104554355144501, 0.0908750519156456, 0.09122221916913986, 0.08963524550199509, 0.09100373089313507, 0.09094192832708359], [0.09109281748533249, 0.09111464768648148, 0.09099030494689941, 0.09095298498868942, 0.09118018299341202, 0.0910557433962822, 0.09087240695953369, 0.09124575555324554, 0.08953999727964401, 0.09101077914237976, 0.0909443199634552], [0.09101482480764389, 0.09102734923362732, 0.09095599502325058, 0.09093456715345383, 0.0910649374127388, 0.09099355340003967, 0.09088829904794693, 0.09110254049301147, 0.09012063592672348, 0.09096774458885193, 0.09092959761619568], [0.09105756133794785, 0.09107518196105957, 0.0909748300909996, 0.09094469994306564, 0.09112805873155594, 0.0910276398062706, 0.0908796489238739, 0.0911809578537941, 0.08980237692594528, 0.09099134802818298, 0.09093770384788513], [0.09112046658992767, 0.0911456048488617, 0.09100241959095001, 0.09095945209264755, 0.09122107177972794, 0.0910777673125267, 0.09086667001247406, 0.09129660576581955, 0.08933452516794205, 0.09102599322795868, 0.09094946831464767], [0.0909922868013382, 0.09100212901830673, 0.09094603359699249, 0.09092918783426285, 0.09103167802095413, 0.0909755602478981, 0.09089279919862747, 0.09106123447418213, 0.09028857946395874, 0.09095527231693268, 0.09092526882886887], [0.09157489985227585, 0.09165551513433456, 0.09119703620672226, 0.09105976670980453, 0.09189780056476593, 0.09143811464309692, 0.0907638669013977, 0.09214072674512863, 0.08597198128700256, 0.09127241373062134, 0.09102790802717209], [0.09107299894094467, 0.09109245985746384, 0.0909816101193428, 0.09094834327697754, 0.09115086495876312, 0.09103994816541672, 0.0908764973282814, 0.09120931476354599, 0.0896875262260437, 0.09099987149238586, 0.09094061702489853], [0.09109579771757126, 0.0911179855465889, 0.09099160879850388, 0.09095368534326553, 0.0911845788359642, 0.09105812013149261, 0.09087179601192474, 0.09125122427940369, 0.08951788395643234, 0.09101241827011108, 0.09094487875699997]], [[0.09130077809095383, 0.09083015471696854, 0.090785913169384, 0.09063877910375595, 0.09083760529756546, 0.09093362092971802, 0.09071620553731918, 0.09115903079509735, 0.09076785296201706, 0.09096696227788925, 0.09106311947107315], [0.09154632687568665, 0.09078062325716019, 0.09070877730846405, 0.09046997129917145, 0.09079273045063019, 0.09094875305891037, 0.09059560298919678, 0.09131545573472977, 0.09067945182323456, 0.09100296348333359, 0.09115935117006302], [0.09156949818134308, 0.09077594429254532, 0.09070149064064026, 0.09045405685901642, 0.09078848361968994, 0.09095016866922379, 0.09058423340320587, 0.09133020043373108, 0.0906711146235466, 0.09100634604692459, 0.09116841107606888], [0.0916466936469078, 0.09076038748025894, 0.09067727625370026, 0.09040112793445587, 0.09077438712120056, 0.09095489233732224, 0.09054639935493469, 0.0913793295621872, 0.09064336866140366, 0.09101762622594833, 0.09119861572980881], [0.09154242277145386, 0.09078140556812286, 0.09070999175310135, 0.09047264605760574, 0.0907934382557869, 0.09094850718975067, 0.09059751033782959, 0.0913129672408104, 0.09068085998296738, 0.09100238978862762, 0.09115782380104065], [0.0914921909570694, 0.09079154580831528, 0.09072577208280563, 0.0905071422457695, 0.0908026248216629, 0.09094543009996414, 0.09062217175960541, 0.0912809818983078, 0.09069893509149551, 0.09099504351615906, 0.09113815426826477], [0.09160605072975159, 0.09076857566833496, 0.09069002419710159, 0.09042899310588837, 0.0907818153500557, 0.09095241129398346, 0.09056631475687027, 0.09135346114635468, 0.09065797924995422, 0.09101169556379318, 0.09118272364139557], [0.09137454628944397, 0.09081527590751648, 0.09076272696256638, 0.09058800339698792, 0.09082411974668503, 0.09093818813562393, 0.09067994356155396, 0.09120604395866394, 0.09074128419160843, 0.09097780287265778, 0.0910920575261116], [0.09157896041870117, 0.0907740369439125, 0.09069851785898209, 0.0904475674033165, 0.09078675508499146, 0.09095074981451035, 0.09057959169149399, 0.0913362205028534, 0.0906677097082138, 0.09100773185491562, 0.09117212146520615], [0.0914747565984726, 0.09079506248235703, 0.09073124080896378, 0.09051911532878876, 0.09080580621957779, 0.09094435721635818, 0.09063071757555008, 0.09126988053321838, 0.09070520848035812, 0.09099248796701431, 0.09113132953643799], [0.09142455458641052, 0.09080518782138824, 0.09074701368808746, 0.09055361896753311, 0.0908149853348732, 0.09094127267599106, 0.0906553789973259, 0.09123790264129639, 0.09072328358888626, 0.09098513424396515, 0.09111166000366211]], [[0.09088516980409622, 0.09114007651805878, 0.09077034145593643, 0.09095855057239532, 0.09098302572965622, 0.09107393026351929, 0.09109843522310257, 0.09128732234239578, 0.08960019052028656, 0.09125418215990067, 0.09094882011413574], [0.09089448302984238, 0.09105265885591507, 0.09082318842411041, 0.09094003587961197, 0.0909552276134491, 0.09101163595914841, 0.09102683514356613, 0.09114395081996918, 0.09009458124637604, 0.09112340956926346, 0.09093400090932846], [0.0908808559179306, 0.09117946028709412, 0.09074640274047852, 0.09096679836511612, 0.09099546819925308, 0.09110195189714432, 0.09113066643476486, 0.09135200083255768, 0.08937783539295197, 0.09131316840648651, 0.09095540642738342], [0.0908878743648529, 0.09111490100622177, 0.09078559279441833, 0.09095323830842972, 0.09097503870725632, 0.09105599671602249, 0.09107781946659088, 0.09124600887298584, 0.08974239975214005, 0.09121651202440262, 0.0909445732831955], [0.09088878333568573, 0.09110652655363083, 0.09079068154096603, 0.09095147252082825, 0.09097238630056381, 0.09105002880096436, 0.09107095748186111, 0.09123224765062332, 0.08978986740112305, 0.0912039577960968, 0.09094316512346268], [0.09089209884405136, 0.0910753458738327, 0.09080950915813446, 0.09094486385583878, 0.09096246212720871, 0.09102780371904373, 0.09104541689157486, 0.09118112176656723, 0.08996618539094925, 0.09115732461214066, 0.09093786776065826], [0.0908929854631424, 0.09106693416833878, 0.09081457555294037, 0.09094307571649551, 0.09095977991819382, 0.0910218134522438, 0.0910385251045227, 0.09116734564304352, 0.09001373499631882, 0.09114475548267365, 0.09093642979860306], [0.09089972823858261, 0.09100218117237091, 0.09085351973772049, 0.09092923998832703, 0.09093907475471497, 0.09097561240196228, 0.09098545461893082, 0.09106128662824631, 0.09038061648607254, 0.0910479873418808, 0.09092532098293304], [0.09083308279514313, 0.0915810614824295, 0.09049749374389648, 0.0910479947924614, 0.09111975133419037, 0.0913865715265274, 0.09145858883857727, 0.09201493859291077, 0.08712389320135117, 0.09191717952489853, 0.09101947396993637], [0.0908985510468483, 0.09101353585720062, 0.09084669500589371, 0.09093166887760162, 0.09094271808862686, 0.09098371863365173, 0.09099476039409637, 0.09107987582683563, 0.09031621366739273, 0.0910649523139, 0.09092728048563004], [0.09088752418756485, 0.09111825376749039, 0.09078358113765717, 0.09095395356416702, 0.09097610414028168, 0.0910583883523941, 0.09108056128025055, 0.09125149250030518, 0.08972354233264923, 0.09122151136398315, 0.09094514697790146]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_return_max": 14.5, "env_reset_timer": 0.000552308647534191, "episode_duration_sec_mean": 0.005161461216630414, "sample": 0.11631135537236269, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1646763256936473e-05, "batch_individual_items": 1.219660752505696e-05, "add_time_dim_to_batch_and_zero_pad": 6.707529409256519e-06, "add_observations_from_episodes_to_batch": 2.7613298257677513e-06, "add_states_from_episodes_to_batch": 2.681094449357527e-06}}, "connector_pipeline_timer": 5.783393675132205e-05}, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1736772564815785e-05, "normalize_and_clip_actions": 7.799521492972362e-06, "get_actions": 3.5233457343677814e-05, "listify_data_for_vector_env": 1.0283187950614336e-05, "un_batch_to_individual_items": 6.557727666487048e-06, "tensor_to_numpy": 1.463660281584011e-05}}, "connector_pipeline_timer": 0.00011220334110662882}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 1.85}, "episode_return_mean": 1.85, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "weights_seq_no": 9.0, "episode_len_max": 20, "episode_return_min": -13.5, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 1.85}, "num_episodes_lifetime": 180, "episode_len_min": 20, "env_step_timer": 1.3703306717666997e-05, "num_env_steps_sampled_lifetime": 45400, "rlmodule_inference_timer": 3.0254635712342273e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "time_between_sampling": 9.385159814281167}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "b19cd_00000", "date": "2025-08-11_18-41-19", "timestamp": 1754930479, "time_this_iter_s": 10.883893966674805, "time_total_s": 86.24454045295715, "pid": 11628, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1629fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 86.24454045295715, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 56.72000000000001, "ram_util_percent": 78.54666666666665}}
{"timers": {"training_iteration": 9.157263804959122, "restore_env_runners": 9.377572065712038e-06, "training_step": 9.157135777639274, "env_runner_sampling_timer": 1.6726144372913165, "learner_update_timer": 7.31115282409439, "synch_weights": 0.0008283050466535972, "restore_eval_env_runners": 9.420651335470465e-06, "evaluation_iteration": 0.1268125356508584, "synch_eval_env_connectors": 0.00017989946609613838, "synch_env_connectors": 4.614653828111916e-06}, "env_runners": {"env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "env_reset_timer": 5.059643995829795e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.043101541902006e-05, "listify_data_for_vector_env": 1.072153348903452e-05, "tensor_to_numpy": 1.5446784025141387e-05, "un_batch_to_individual_items": 6.782745795484259e-06, "remove_single_ts_time_rank_from_batch": 1.2190984599397548e-05, "normalize_and_clip_actions": 8.1455503369424e-06}}, "connector_pipeline_timer": 0.00012039622234417441}, "episode_duration_sec_mean": 0.0053602833319455374, "sample": 0.006655941112499329, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.748311853782593e-06, "numpy_to_tensor": 1.28032562143909e-05, "batch_individual_items": 1.2817703365609248e-05, "add_observations_from_episodes_to_batch": 2.821803335516666e-06, "add_time_dim_to_batch_and_zero_pad": 7.013022192408527e-06}}, "connector_pipeline_timer": 6.0363560972910944e-05}, "agent_episode_returns_mean": {"default_agent": 1.699999999999999}, "time_between_sampling": 0.03394950657647883, "weights_seq_no": 9.0, "num_episodes_lifetime": -246500.0, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 1.699999999999999}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "episode_return_mean": 1.699999999999999, "episode_len_max": 20, "env_step_timer": 1.4517866301917876e-05, "num_env_steps_sampled_lifetime": -4930000.0, "episode_len_mean": 20.0, "rlmodule_inference_timer": 3.2032399575003436e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime_throughput": 3189.495557672223}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13533204559215434, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009035502467938933, "add_observations_from_episodes_to_batch": 0.0008835894404243123, "add_columns_from_episodes_to_train_batch": 0.041914135730068754, "add_time_dim_to_batch_and_zero_pad": 0.07549170127993582, "add_states_from_episodes_to_batch": 0.00355372528902679, "batch_individual_items": 0.004240172911839082, "numpy_to_tensor": 6.451727564443808e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 51.0, "module_train_batch_size_mean": 997.5109713823833, "total_loss": 0.0, "weights_seq_no": 60.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 359100}, "default_policy": {"module_train_batch_size_mean": 997.5109713823833, "mean_kl_loss": 1.831774352467619e-05, "weights_seq_no": 60.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 359100, "diff_num_grad_updates_vs_sampler_policy": 51.0, "use_intrinsic_rewards": 1.0, "entropy": 0.6780104041099548, "vf_loss_unclipped": 43.333072662353516, "vf_explained_var": 0.003390669822692871, "policy_loss": -0.0005119628040120006, "total_loss": 0.27763283252716064, "vf_loss": 0.35836949944496155}, "__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 718200, "num_env_steps_trained_lifetime": 1980000, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 53414.093975918295}}}, "default_policy": {"curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.3583044707775116, "mean_kl_loss": 2.085039704979863e-05, "num_module_steps_trained_lifetime": 59850, "module_train_batch_size_mean": 997.772440523815, "weights_seq_no": 10.0, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 16595, "use_intrinsic_rewards": 0.0, "entropy": 0.6779401898384094, "vf_loss_unclipped": 43.529850006103516, "vf_explained_var": -0.0004856586456298828, "curr_kl_coeff": 0.00015779680688865483, "policy_loss": -0.0005444430280476809, "total_loss": 0.27754685282707214, "num_module_steps_trained_lifetime_throughput": 801.2875594074702}, "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 997.772440523815, "weights_seq_no": 10.0, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 59850, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 801.2990037065614}, "__all_modules__": {"num_env_steps_trained_lifetime": 330000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 33000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 119700, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4419.657006392365, "num_module_steps_trained_throughput": 25070186.14775331, "num_module_steps_trained_lifetime_throughput": 12890600.89490253}, "IntrinsicAttentionMask": [[[0.09068715572357178, 0.0904926061630249, 0.09075552970170975, 0.0908825695514679, 0.09114661812782288, 0.0909510925412178, 0.09098537266254425, 0.0912497267127037, 0.09105397760868073, 0.09099525213241577, 0.09080004692077637], [0.09065427631139755, 0.09043101221323013, 0.09073276072740555, 0.09087860584259033, 0.09118185192346573, 0.09095728397369385, 0.0909966453909874, 0.09130028635263443, 0.09107543528079987, 0.09100799262523651, 0.09078386425971985], [0.09069869667291641, 0.09051424264907837, 0.09076353162527084, 0.09088396281003952, 0.09113427251577377, 0.0909489244222641, 0.09098141640424728, 0.09123199433088303, 0.09104645252227783, 0.09099078923463821, 0.09080573171377182], [0.09072011709213257, 0.090554378926754, 0.09077835828065872, 0.09088653326034546, 0.09111133217811584, 0.09094488620758057, 0.09097407013177872, 0.09119907766580582, 0.0910324677824974, 0.09098248183727264, 0.09081626683473587], [0.09076455235481262, 0.0906376987695694, 0.09080911427736282, 0.09089187532663345, 0.09106376767158508, 0.09093649685382843, 0.09095881879329681, 0.09113083779811859, 0.09100347012281418, 0.09096524864435196, 0.09083811938762665], [0.0907316654920578, 0.09057602286338806, 0.09078634530305862, 0.09088792651891708, 0.09109897166490555, 0.09094270318746567, 0.09097010642290115, 0.09118134528398514, 0.09102493524551392, 0.09097800403833389, 0.09082194417715073], [0.09073743224143982, 0.0905868411064148, 0.09079033881425858, 0.0908886194229126, 0.0910927876830101, 0.09094161540269852, 0.09096812456846237, 0.0911724790930748, 0.09102116525173187, 0.09097576141357422, 0.09082478284835815], [0.09078186750411987, 0.09067018330097198, 0.09082109481096268, 0.0908939465880394, 0.09104523062705994, 0.09093322604894638, 0.09095287322998047, 0.09110425412654877, 0.09099217504262924, 0.09095853567123413, 0.09084662795066833], [0.09074898809194565, 0.09060849249362946, 0.09079834073781967, 0.09089001268148422, 0.091080442070961, 0.09093944728374481, 0.090964175760746, 0.09115476161241531, 0.09101364016532898, 0.09097129851579666, 0.09083046764135361], [0.09073910117149353, 0.0905899628996849, 0.0907914936542511, 0.09088882058858871, 0.09109101444482803, 0.09094130247831345, 0.090967558324337, 0.09116993099451065, 0.09102009236812592, 0.09097512811422348, 0.09082560241222382], [0.09070621430873871, 0.09052831679582596, 0.0907687321305275, 0.09088487178087234, 0.09112623333930969, 0.09094751626253128, 0.09097884595394135, 0.09122046083211899, 0.09104155749082565, 0.09098788350820541, 0.09080943465232849]], [[0.0909058153629303, 0.09116078913211823, 0.09102112799882889, 0.09097921848297119, 0.09100370109081268, 0.09109462797641754, 0.09111914038658142, 0.09130806475877762, 0.08939392864704132, 0.091044120490551, 0.09096948057413101], [0.09090737253427505, 0.09106557071208954, 0.09097893536090851, 0.09095292538404465, 0.09096811711788177, 0.09102453291416168, 0.09103973954916, 0.09115687012672424, 0.08996584266424179, 0.09099320322275162, 0.09094689041376114], [0.09090656787157059, 0.0911177322268486, 0.09100208431482315, 0.09096737205982208, 0.09098764508962631, 0.09106294810771942, 0.09108324348926544, 0.09123965352773666, 0.08965237438678741, 0.09102112054824829, 0.09095931053161621], [0.0909063071012497, 0.09113337844610214, 0.09100900590419769, 0.0909716784954071, 0.0909934788942337, 0.09107445925474167, 0.09109628945589066, 0.091264508664608, 0.08955840021371841, 0.09102948009967804, 0.09096301347017288], [0.09090644866228104, 0.09112422913312912, 0.09100495278835297, 0.09096915274858475, 0.09099006652832031, 0.09106772392988205, 0.09108865261077881, 0.091249980032444, 0.08961328119039536, 0.09102459251880646, 0.09096083790063858], [0.0909070074558258, 0.09109027683734894, 0.09098991006612778, 0.09095977991819382, 0.09097737818956375, 0.09104273468255997, 0.0910603478550911, 0.09119607508182526, 0.08981727063655853, 0.09100643545389175, 0.0909527838230133], [0.09090714901685715, 0.09108112752437592, 0.09098584949970245, 0.09095724672079086, 0.09097395837306976, 0.09103599935770035, 0.09105271846055984, 0.09118155390024185, 0.08987230062484741, 0.09100154042243958, 0.090950608253479], [0.09090809524059296, 0.09101056307554245, 0.09095445275306702, 0.09093760699033737, 0.09094744920730591, 0.09098398685455322, 0.09099382907152176, 0.09106966853141785, 0.09029693901538849, 0.0909636914730072, 0.09093369543552399], [0.090888611972332, 0.09172507375478745, 0.09126624464988708, 0.091128870844841, 0.09120909869670868, 0.09150750190019608, 0.09158806502819061, 0.09221065044403076, 0.08603721857070923, 0.09134167432785034, 0.09109698981046677], [0.09090670943260193, 0.09110914915800095, 0.09099827706813812, 0.09096499532461166, 0.09098443388938904, 0.09105662256479263, 0.0910760834813118, 0.0912260189652443, 0.08970394730567932, 0.09101653099060059, 0.09095726907253265], [0.09090624004602432, 0.09113701432943344, 0.09101061522960663, 0.09097267687320709, 0.09099483489990234, 0.09107713401317596, 0.091099314391613, 0.09127028286457062, 0.08953658491373062, 0.09103142470121384, 0.09096387028694153]], [[0.09127850830554962, 0.09080799669027328, 0.09076376259326935, 0.09061666578054428, 0.09105901420116425, 0.09066826850175858, 0.09069407731294632, 0.09089302271604538, 0.09098909795284271, 0.0911886915564537, 0.09104090183973312], [0.09150999784469604, 0.09074459969997406, 0.09067277610301971, 0.09043406695127487, 0.0911526307463646, 0.09051777422428131, 0.09055965393781662, 0.09088272601366043, 0.09103891253471375, 0.09136369824409485, 0.09112317860126495], [0.09153184294700623, 0.09073861688375473, 0.09066419303417206, 0.09041686356067657, 0.09116145223379135, 0.09050358831882477, 0.09054698050022125, 0.09088174998760223, 0.09104359894990921, 0.09138020873069763, 0.09113092720508575], [0.09160459041595459, 0.09071869403123856, 0.09063561260700226, 0.09035959839820862, 0.09119081497192383, 0.09045637398958206, 0.09050479531288147, 0.09087847918272018, 0.09105919301509857, 0.09143517166376114, 0.0911567211151123], [0.09138630330562592, 0.09077848494052887, 0.09072139114141464, 0.09053158015012741, 0.09110264480113983, 0.09059815108776093, 0.09063144773244858, 0.09088825434446335, 0.09101232886314392, 0.09127020835876465, 0.09107924997806549], [0.09157905727624893, 0.09072568267583847, 0.09064564853906631, 0.09037970006465912, 0.09118051081895828, 0.09047294408082962, 0.09051960706710815, 0.09087963402271271, 0.09105372428894043, 0.0914158821105957, 0.09114766865968704], [0.09156627953052521, 0.09072916954755783, 0.09065064787864685, 0.09038973599672318, 0.09117534756660461, 0.0904812216758728, 0.0905269905924797, 0.09088019281625748, 0.09105097502470016, 0.09140622615814209, 0.09114313125610352], [0.09146805107593536, 0.09075609594583511, 0.0906892642378807, 0.09046712517738342, 0.09113568812608719, 0.09054502099752426, 0.09058399498462677, 0.09088461101055145, 0.09102990478277206, 0.09133199602365494, 0.0911082923412323], [0.09142071008682251, 0.09076905995607376, 0.09070786088705063, 0.09050444513559341, 0.09111655503511429, 0.09057578444480896, 0.09061147272586823, 0.09088671952486038, 0.09101972728967667, 0.09129621088504791, 0.09109147638082504], [0.09132257103919983, 0.09079592674970627, 0.0907464325428009, 0.09058186411857605, 0.09107685089111328, 0.09063959121704102, 0.0906684622168541, 0.09089107066392899, 0.09099859744310379, 0.09122201055288315, 0.09105657786130905], [0.09139520674943924, 0.09077604115009308, 0.09071788191795349, 0.09052455425262451, 0.09110624343156815, 0.09059235453605652, 0.09062627702951431, 0.09088785201311111, 0.09101424366235733, 0.09127693623304367, 0.09108240902423859]], [[0.09072944521903992, 0.09075656533241272, 0.09034760296344757, 0.09081084281206131, 0.0908379927277565, 0.0904286578297615, 0.09071049839258194, 0.09091948717832565, 0.0926932618021965, 0.09088282287120819, 0.09088282287120819], [0.09073539078235626, 0.09076162427663803, 0.09036601334810257, 0.09081412106752396, 0.09084038436412811, 0.0904444232583046, 0.09071706235408783, 0.09091921150684357, 0.09263427555561066, 0.09088374674320221, 0.09088374674320221], [0.09064516425132751, 0.09068480134010315, 0.09008774161338806, 0.0907641351222992, 0.09080382436513901, 0.09020597487688065, 0.09061748534440994, 0.0909229964017868, 0.09352908283472061, 0.09086937457323074, 0.09086937457323074], [0.09074726700782776, 0.09077172726392746, 0.09040284156799316, 0.09082067012786865, 0.09084515273571014, 0.09047596156597137, 0.09073017537593842, 0.090918630361557, 0.09251639991998672, 0.09088557213544846, 0.09088557213544846], [0.09075319766998291, 0.09077677875757217, 0.09042125195264816, 0.0908239409327507, 0.09084752947092056, 0.09049172699451447, 0.09073673188686371, 0.09091833978891373, 0.09245751053094864, 0.09088648110628128, 0.09088648110628128], [0.09066314995288849, 0.09070012718439102, 0.09014299511909485, 0.09077412635087967, 0.09081115573644638, 0.09025334566831589, 0.09063731878995895, 0.09092231839895248, 0.09335080534219742, 0.09087230265140533, 0.09087230265140533], [0.09072528779506683, 0.09075302630662918, 0.09033472836017609, 0.09080854803323746, 0.09083631634712219, 0.09041763097047806, 0.09070590138435364, 0.09091968089342117, 0.09273449331521988, 0.09088217467069626, 0.09088217467069626], [0.09077098220586777, 0.09079189598560333, 0.09047649800777435, 0.09083372354507446, 0.09085465222597122, 0.09053903073072433, 0.0907563790678978, 0.0909174457192421, 0.09228105843067169, 0.09088919311761856, 0.09088919311761856], [0.09114596247673035, 0.09110922366380692, 0.09166592359542847, 0.09103579074144363, 0.09099909663200378, 0.09155511856079102, 0.09117164462804794, 0.0908890962600708, 0.0885510966181755, 0.09093855321407318, 0.09093855321407318], [0.09076299518346786, 0.09078510105609894, 0.09045165777206421, 0.09082933515310287, 0.09085145592689514, 0.09051776677370071, 0.09074755012989044, 0.09091785550117493, 0.09236039221286774, 0.09088798612356186, 0.09088798612356186], [0.09076299518346786, 0.09078510105609894, 0.09045165777206421, 0.09082933515310287, 0.09085145592689514, 0.09051776677370071, 0.09074755012989044, 0.09091785550117493, 0.09236039221286774, 0.09088798612356186, 0.09088798612356186]], [[0.09062864631414413, 0.09043422341346741, 0.09101919084787369, 0.0908239334821701, 0.09076536446809769, 0.09089241176843643, 0.09092666953802109, 0.09119085967540741, 0.09099522978067398, 0.09125961363315582, 0.09106384217739105], [0.09058710932731628, 0.090364009141922, 0.09103547781705856, 0.09081127494573593, 0.0907440260052681, 0.09088989347219467, 0.09092923253774643, 0.09123263508081436, 0.09100794792175293, 0.09131162613630295, 0.091086745262146], [0.09071184694766998, 0.0905749499797821, 0.09098657220602036, 0.09084926545619965, 0.09080805629491806, 0.09089742600917816, 0.09092152118682861, 0.09110721945762634, 0.09096972644329071, 0.0911555215716362, 0.0910179540514946], [0.09067029505968094, 0.09050464630126953, 0.09100287407636642, 0.09083662182092667, 0.09078674763441086, 0.09089493006467819, 0.09092410653829575, 0.0911489948630333, 0.09098247438669205, 0.09120750427246094, 0.09104087948799133], [0.09065781533718109, 0.09048353880643845, 0.0910077691078186, 0.09083282202482224, 0.0907803401350975, 0.0908941850066185, 0.09092488139867783, 0.09116153419017792, 0.09098629653453827, 0.09122312068939209, 0.09104776382446289], [0.09068486839532852, 0.09052931517362595, 0.09099714457988739, 0.09084105491638184, 0.09079422056674957, 0.09089580178260803, 0.09092319011688232, 0.09113432466983795, 0.0909779891371727, 0.09118925034999847, 0.09103282541036606], [0.09069215506315231, 0.09054164588451385, 0.09099428355693817, 0.09084326773881912, 0.09079795330762863, 0.09089624136686325, 0.09092273563146591, 0.09112698584794998, 0.09097574651241302, 0.09118012338876724, 0.09102879464626312], [0.09074830263853073, 0.09063666313886642, 0.09097225964069366, 0.09086033701896667, 0.09082674980163574, 0.09089960157871246, 0.09091924130916595, 0.09107057005167007, 0.09095852822065353, 0.09110992401838303, 0.0909978374838829], [0.09070674329996109, 0.09056632220745087, 0.09098856896162033, 0.09084770828485489, 0.09080544114112854, 0.09089712053537369, 0.09092183411121368, 0.09111233800649643, 0.09097129106521606, 0.09116189181804657, 0.09102076292037964], [0.09076288342475891, 0.09066134691238403, 0.09096653014421463, 0.09086476266384125, 0.09083421528339386, 0.0909004658460617, 0.09091832488775253, 0.09105590730905533, 0.09095405042171478, 0.09109168499708176, 0.09098978340625763], [0.09072133153676987, 0.09059100598096848, 0.0909828469157219, 0.09085214883089066, 0.09081292152404785, 0.09089799970388412, 0.09092092514038086, 0.09109768271446228, 0.09096681326627731, 0.0911436527967453, 0.09101272374391556]], [[0.09108621627092361, 0.0909508615732193, 0.09085926413536072, 0.09098303318023682, 0.09099911898374557, 0.09105886518955231, 0.09107495844364166, 0.09104740619659424, 0.08993799984455109, 0.09102568030357361, 0.09097663313150406], [0.09116853028535843, 0.09096996486186981, 0.09083567559719086, 0.09101714193820953, 0.09104074537754059, 0.0911283865571022, 0.09115201979875565, 0.09111157804727554, 0.08948847651481628, 0.0910797119140625, 0.091007761657238], [0.09122421592473984, 0.09098278731107712, 0.09081955999135971, 0.09104014188051224, 0.0910688266158104, 0.09117539972066879, 0.09120413661003113, 0.09115495532751083, 0.08918505162000656, 0.09111620485782623, 0.09102872759103775], [0.0911489799618721, 0.09096544981002808, 0.09084130823612213, 0.09100905805826187, 0.09103087335824966, 0.09111188352108002, 0.0911337211728096, 0.09109634160995483, 0.08959520608186722, 0.0910668894648552, 0.09100039303302765], [0.09113918244838715, 0.09096317738294601, 0.09084410965442657, 0.09100499749183655, 0.09102591127157211, 0.09110360592603683, 0.09112454950809479, 0.09108869731426239, 0.08964858949184418, 0.09106045961380005, 0.09099667519330978], [0.09110284596681595, 0.0909547358751297, 0.09085451066493988, 0.09098993241786957, 0.0910075381398201, 0.09107290953397751, 0.09109053015708923, 0.09106037020683289, 0.08984704315662384, 0.0910366028547287, 0.09098292887210846], [0.09109305590391159, 0.09095244854688644, 0.09085731208324432, 0.09098587185144424, 0.09100258350372314, 0.09106463938951492, 0.09108136594295502, 0.09105273336172104, 0.08990057557821274, 0.09103017300367355, 0.09097922593355179], [0.09110981971025467, 0.09095636010169983, 0.0908525213599205, 0.09099282324314117, 0.09101106226444244, 0.09107880294322968, 0.09109705686569214, 0.09106580913066864, 0.08980895578861237, 0.0910411849617958, 0.09098557382822037], [0.09178333729505539, 0.09110654890537262, 0.09065081924200058, 0.09126703441143036, 0.09134738147258759, 0.0916462391614914, 0.09172692149877548, 0.09158884733915329, 0.08616766333580017, 0.09148015826940536, 0.09123509377241135], [0.09112302958965302, 0.09095942974090576, 0.09084874391555786, 0.09099830687046051, 0.09101774543523788, 0.09108996391296387, 0.09110942482948303, 0.09107610583305359, 0.08973678946495056, 0.09104984998703003, 0.0909905731678009], [0.0911528617143631, 0.09096634387969971, 0.090840183198452, 0.0910106673836708, 0.09103283286094666, 0.09111516177654266, 0.0911373496055603, 0.09109936654567719, 0.08957396447658539, 0.09106943011283875, 0.09100184589624405]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_return_max": 14.5, "env_reset_timer": 0.0005476363905874939, "episode_duration_sec_mean": 0.005157187929144129, "sample": 0.1162682959886627, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1736125504496665e-05, "batch_individual_items": 1.216280680955643e-05, "add_time_dim_to_batch_and_zero_pad": 6.833178697895823e-06, "add_observations_from_episodes_to_batch": 2.8302689956740537e-06, "add_states_from_episodes_to_batch": 2.723238828130511e-06}}, "connector_pipeline_timer": 5.826593699043452e-05}, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1699615090802682e-05, "normalize_and_clip_actions": 7.815297342376924e-06, "get_actions": 3.5789197804196334e-05, "listify_data_for_vector_env": 1.0253354465870704e-05, "un_batch_to_individual_items": 6.524303968527323e-06, "tensor_to_numpy": 1.483725081906022e-05}}, "connector_pipeline_timer": 0.00011282866438738113}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 0.85}, "episode_return_mean": 0.85, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "weights_seq_no": 10.0, "episode_len_max": 20, "episode_return_min": -13.5, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 0.85}, "num_episodes_lifetime": 200, "episode_len_min": 20, "env_step_timer": 1.3808757624234413e-05, "num_env_steps_sampled_lifetime": 50400, "rlmodule_inference_timer": 3.0346831397375963e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "time_between_sampling": 9.38396275155836}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "b19cd_00000", "date": "2025-08-11_18-41-29", "timestamp": 1754930489, "time_this_iter_s": 9.35274338722229, "time_total_s": 95.59728384017944, "pid": 11628, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1629fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 95.59728384017944, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 40.0, "ram_util_percent": 77.96923076923078}}
{"timers": {"training_iteration": 9.158660871489559, "restore_env_runners": 9.34671533404272e-06, "training_step": 9.158531578612115, "env_runner_sampling_timer": 1.6722184775080091, "learner_update_timer": 7.312860373773847, "synch_weights": 0.0008367349069155903, "restore_eval_env_runners": 9.397695655686717e-06, "evaluation_iteration": 0.12671825612425763, "synch_eval_env_connectors": 0.00017927589132829276, "synch_env_connectors": 4.611007031370155e-06}, "env_runners": {"env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "env_reset_timer": 4.3313560824486836e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.304730154911131e-05, "listify_data_for_vector_env": 1.099732293464482e-05, "tensor_to_numpy": 1.6047407678983888e-05, "un_batch_to_individual_items": 6.962981016336943e-06, "remove_single_ts_time_rank_from_batch": 1.2609763734921221e-05, "normalize_and_clip_actions": 8.332172787387165e-06}}, "connector_pipeline_timer": 0.0001253871504677955}, "episode_duration_sec_mean": 0.005609357036650181, "sample": 0.005973608885063882, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.8130990718365504e-06, "numpy_to_tensor": 1.3584297758090573e-05, "batch_individual_items": 1.3385710828033395e-05, "add_observations_from_episodes_to_batch": 2.8883407328009055e-06, "add_time_dim_to_batch_and_zero_pad": 7.314131396343988e-06}}, "connector_pipeline_timer": 6.285396420620051e-05}, "agent_episode_returns_mean": {"default_agent": 1.699999999999999}, "time_between_sampling": 0.03195866432169274, "weights_seq_no": 10.0, "num_episodes_lifetime": -277375.0, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 1.699999999999999}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "episode_return_mean": 1.699999999999999, "episode_len_max": 20, "env_step_timer": 1.5244880583157848e-05, "num_env_steps_sampled_lifetime": -5547500.0, "episode_len_mean": 20.0, "rlmodule_inference_timer": 3.391131962553788e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime_throughput": 3074.924889236281}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13530873846609448, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009033114113076068, "add_observations_from_episodes_to_batch": 0.0008829264650624776, "add_columns_from_episodes_to_train_batch": 0.04190527978207517, "add_time_dim_to_batch_and_zero_pad": 0.07548269176635855, "add_states_from_episodes_to_batch": 0.0035540730358066108, "batch_individual_items": 0.0042382257631692595, "numpy_to_tensor": 6.435710308856333e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 56.0, "module_train_batch_size_mean": 997.5068778348534, "total_loss": 0.0, "weights_seq_no": 66.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 395010}, "default_policy": {"module_train_batch_size_mean": 997.5068778348534, "mean_kl_loss": 2.5089944756473415e-05, "weights_seq_no": 66.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 395010, "diff_num_grad_updates_vs_sampler_policy": 56.0, "use_intrinsic_rewards": 1.0, "entropy": 0.6769042015075684, "vf_loss_unclipped": 44.0348014831543, "vf_explained_var": 0.003425896167755127, "policy_loss": -0.0006780016119591892, "total_loss": 0.27746331691741943, "vf_loss": 0.3583614230155945}, "__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 790020, "num_env_steps_trained_lifetime": 2178000, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 52449.435553989504}}}, "default_policy": {"curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.3583049774169922, "mean_kl_loss": 2.819197288772557e-05, "num_module_steps_trained_lifetime": 65835, "module_train_batch_size_mean": 997.7563503102639, "weights_seq_no": 11.0, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 16595, "use_intrinsic_rewards": 0.0, "entropy": 0.6768284440040588, "vf_loss_unclipped": 44.191463470458984, "vf_explained_var": 0.0005457401275634766, "curr_kl_coeff": 7.889840344432741e-05, "policy_loss": -0.000712722830940038, "total_loss": 0.27738070487976074, "num_module_steps_trained_lifetime_throughput": 797.7715903953263}, "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 997.7563503102639, "weights_seq_no": 11.0, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 65835, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 797.782393448934}, "__all_modules__": {"num_env_steps_trained_lifetime": 363000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 33000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 131670, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4400.209295405503, "num_module_steps_trained_throughput": 24414843.839592487, "num_module_steps_trained_lifetime_throughput": 12860830.184242334}, "IntrinsicAttentionMask": [[[0.09068719297647476, 0.09081412851810455, 0.09107798337936401, 0.09088260680437088, 0.09082399308681488, 0.09095112979412079, 0.09066331386566162, 0.09092672914266586, 0.0907316729426384, 0.09131856262683868, 0.09112266451120377], [0.09070860594511032, 0.09082331508398056, 0.09106169641017914, 0.09088518470525742, 0.09083222597837448, 0.09094709157943726, 0.09068702906370163, 0.09092505276203156, 0.09074880182743073, 0.09127897769212723, 0.09110204875469208], [0.09075302630662918, 0.0908423438668251, 0.0910278782248497, 0.09089050441980362, 0.09084928035736084, 0.09093869477510452, 0.09073622524738312, 0.09092153608798981, 0.09078432619571686, 0.09119690209627151, 0.09105927497148514], [0.09072014689445496, 0.09082825481891632, 0.09105290472507477, 0.09088656306266785, 0.09083665162324905, 0.09094490110874176, 0.09069980680942535, 0.09092413634061813, 0.09075802564620972, 0.09125764667987823, 0.09109093248844147], [0.09071027487516403, 0.09082403033971786, 0.09106042981147766, 0.09088538587093353, 0.09083286672830582, 0.09094677865505219, 0.09068887680768967, 0.09092491865158081, 0.09075013548135757, 0.0912759080529213, 0.09110044687986374], [0.090731680393219, 0.09083319455385208, 0.091044120490551, 0.09088794887065887, 0.09084108471870422, 0.09094272553920746, 0.09071258455514908, 0.09092322736978531, 0.0907672569155693, 0.09123632311820984, 0.09107981622219086], [0.09068315476179123, 0.09081239998340607, 0.09108105301856995, 0.09088211506605148, 0.09082243591547012, 0.09095188230276108, 0.09065884351730347, 0.09092704951763153, 0.09072843939065933, 0.09132601320743561, 0.09112653881311417], [0.09072757512331009, 0.0908314436674118, 0.0910472497344017, 0.09088745713233948, 0.09083951264619827, 0.09094350785017014, 0.09070803970098495, 0.09092354774475098, 0.09076397866010666, 0.0912439152598381, 0.09108377993106842], [0.09069469571113586, 0.09081735461950302, 0.09107227623462677, 0.09088350832462311, 0.09082688391208649, 0.09094970673322678, 0.09067162871360779, 0.0909261405467987, 0.09073767811059952, 0.09130468219518661, 0.09111542999744415], [0.0907934159040451, 0.09085962921380997, 0.0909971296787262, 0.09089533239603043, 0.09086477756500244, 0.09093105047941208, 0.09078095853328705, 0.09091833233833313, 0.09081662446260452, 0.0911223292350769, 0.09102039784193039], [0.09076054394245148, 0.09084556996822357, 0.09102217108011246, 0.09089141339063644, 0.09085217118263245, 0.09093727916479111, 0.09074454009532928, 0.09092094749212265, 0.09079033881425858, 0.09118304401636124, 0.09105205535888672]], [[0.09105860441923141, 0.09107470512390137, 0.09083171933889389, 0.09110691398382187, 0.09097152948379517, 0.0910312607884407, 0.09089598804712296, 0.09117137640714645, 0.08991074562072754, 0.0909980908036232, 0.09094905853271484], [0.09105033427476883, 0.09106554836034775, 0.0908360406756401, 0.09109596908092499, 0.09096809476613998, 0.09102451056241989, 0.09089674055576324, 0.09115684777498245, 0.0899658203125, 0.09099318087100983, 0.09094686806201935], [0.09117487072944641, 0.09120360761880875, 0.0907704308629036, 0.09126109629869461, 0.09101956337690353, 0.09112608432769775, 0.09088490903377533, 0.09137619286775589, 0.08913680166006088, 0.09106691926717758, 0.09097948670387268], [0.09103381633758545, 0.09104723483324051, 0.09084466844797134, 0.09107407927513123, 0.09096124023199081, 0.09101101756095886, 0.09089825302362442, 0.09112779796123505, 0.09007607400417328, 0.09098336845636368, 0.09094249457120895], [0.09110325574874878, 0.09112419933080673, 0.09080830216407776, 0.09116610139608383, 0.09099003672599792, 0.09106769412755966, 0.09089182317256927, 0.09124995023012161, 0.08961325138807297, 0.09102456271648407, 0.09096080809831619], [0.09107262641191483, 0.09109024703502655, 0.09082437306642532, 0.0911255031824112, 0.09097734838724136, 0.09104270488023758, 0.0908946841955185, 0.09119604527950287, 0.08981724083423615, 0.09100640565156937, 0.09095275402069092], [0.09114197641611099, 0.09116712212562561, 0.09078788012266159, 0.09121744334697723, 0.09100602567195892, 0.09109926968812943, 0.0908881276845932, 0.09131816029548645, 0.08935561776161194, 0.09104748070240021, 0.09097094088792801], [0.09100070595741272, 0.09101055562496185, 0.09086187928915024, 0.09103025496006012, 0.09094744175672531, 0.09098397940397263, 0.0909012109041214, 0.09106966108083725, 0.09029693156480789, 0.0909636840224266, 0.09093368798494339], [0.09164387732744217, 0.09172455221414566, 0.09051307290792465, 0.09188613295555115, 0.09120858460664749, 0.09150698781013489, 0.09083223342895508, 0.09221012890338898, 0.08603673428297043, 0.09134116023778915, 0.09109646826982498], [0.0910896435379982, 0.09110911190509796, 0.0908154547214508, 0.09114804863929749, 0.09098439663648605, 0.09105658531188965, 0.09089310467243195, 0.09122598171234131, 0.08970391005277634, 0.0910164937376976, 0.09095723181962967], [0.09111477434635162, 0.09113696962594986, 0.09080222994089127, 0.09118136763572693, 0.09099479019641876, 0.09107708930969238, 0.09089072793722153, 0.09127023816108704, 0.08953654021024704, 0.09103138744831085, 0.09096382558345795]], [[0.09127853810787201, 0.09080802649259567, 0.09100722521543503, 0.09061669558286667, 0.0908154770731926, 0.09091147035360336, 0.09069410711526871, 0.09089305251836777, 0.09074573963880539, 0.09118872135877609, 0.09104093164205551], [0.09151008725166321, 0.09074468910694122, 0.09106843173503876, 0.09043415635824203, 0.09075678884983063, 0.09091275185346603, 0.09055974334478378, 0.0908828154206276, 0.09064356237649918, 0.09136378765106201, 0.09112326800823212], [0.09141185134649277, 0.09077154844999313, 0.09104248881340027, 0.0905115157365799, 0.09078167378902435, 0.09091221541166306, 0.09061669558286667, 0.0908871740102768, 0.09068688005208969, 0.09128952771425247, 0.09108836203813553], [0.09160470217466354, 0.09071879833936691, 0.09109336882829666, 0.09035971015691757, 0.09073279798030853, 0.09091322124004364, 0.09050490707159042, 0.09087859094142914, 0.0906018391251564, 0.09143528342247009, 0.09115683287382126], [0.09150640666484833, 0.09074569493532181, 0.09106745570898056, 0.09043704718351364, 0.09075772017240524, 0.09091272950172424, 0.0905618667602539, 0.09088297933340073, 0.09064517915248871, 0.09136100858449936, 0.09112195670604706], [0.09145903587341309, 0.09075864404439926, 0.09105495363473892, 0.09047434478998184, 0.09076972305774689, 0.09091247618198395, 0.09058932960033417, 0.09088508039712906, 0.09066606312990189, 0.09132520109415054, 0.09110512584447861], [0.09156639128923416, 0.09072928130626678, 0.09108327329158783, 0.09038984775543213, 0.09074251353740692, 0.09091303497552872, 0.09052710235118866, 0.09088030457496643, 0.09061872959136963, 0.09140633791685104, 0.09114324301481247], [0.09146811813116074, 0.09075616300106049, 0.09105734527111053, 0.0904671847820282, 0.09076742082834244, 0.09091252088546753, 0.09058406203985214, 0.09088467806577682, 0.09066206216812134, 0.09133206307888031, 0.09110835939645767], [0.0915408506989479, 0.0907362625002861, 0.09107653796672821, 0.09040993452072144, 0.09074898064136505, 0.09091290086507797, 0.09054189920425415, 0.09088143706321716, 0.09062997996807098, 0.09138703346252441, 0.09113417565822601], [0.09132262319326401, 0.09079597890377045, 0.09101890027523041, 0.09058191627264023, 0.09080430865287781, 0.09091173112392426, 0.09066851437091827, 0.09089112281799316, 0.09072629362344742, 0.09122206270694733, 0.09105663001537323], [0.09139525890350342, 0.09077609330415726, 0.09103810042142868, 0.09052460640668869, 0.09078588336706161, 0.09091212600469589, 0.09062632918357849, 0.09088790416717529, 0.09069421142339706, 0.09127698838710785, 0.09108246117830276]], [[0.09075266122817993, 0.09052478522062302, 0.09062527865171432, 0.09083408117294312, 0.0908612385392189, 0.09045179188251495, 0.09073370695114136, 0.09068728983402252, 0.09271697700023651, 0.09090607613325119, 0.09090607613325119], [0.0907089039683342, 0.09041843563318253, 0.09054651111364365, 0.09081273525953293, 0.09084738045930862, 0.09032543003559113, 0.09068473428487778, 0.09062555432319641, 0.09322112053632736, 0.09090457111597061, 0.09090457111597061], [0.09072825312614441, 0.09046539664268494, 0.09058131277561188, 0.09082219749689102, 0.09085353463888168, 0.0903812125325203, 0.09070638567209244, 0.09065283834934235, 0.09299833327531815, 0.09090527892112732, 0.09090527892112732], [0.09076820313930511, 0.09056268632411957, 0.09065333008766174, 0.0908416211605072, 0.09086611121892929, 0.09049683809280396, 0.09075111150741577, 0.09070925414562225, 0.09253774583339691, 0.0909065455198288, 0.0909065455198288], [0.09077337384223938, 0.09057530760765076, 0.09066267311573029, 0.09084413200616837, 0.09086772799491882, 0.09051185101270676, 0.09075690805912018, 0.09071656316518784, 0.09247806668281555, 0.09090668708086014, 0.09090668708086014], [0.09069480746984482, 0.09038427472114563, 0.0905211865901947, 0.09080582857131958, 0.09084286540746689, 0.09028485417366028, 0.09066896885633469, 0.09060569107532501, 0.09338340163230896, 0.09090403467416763, 0.09090403467416763], [0.09074903279542923, 0.09051596373319626, 0.09061874449253082, 0.09083231538534164, 0.09086009114980698, 0.09044130146503448, 0.09072964638471603, 0.09068217128515244, 0.09275876730680466, 0.09090595692396164, 0.09090595692396164], [0.0907401517033577, 0.09049432724714279, 0.09060273319482803, 0.09082800149917603, 0.09085729718208313, 0.0904155895113945, 0.09071969985961914, 0.09066962450742722, 0.09286122769117355, 0.09090568125247955, 0.09090568125247955], [0.09111455082893372, 0.09142403304576874, 0.09128732234239578, 0.09100441634654999, 0.09096772968769073, 0.09152356535196304, 0.09114021807909012, 0.09120314568281174, 0.0885205790400505, 0.09090720862150192, 0.09090720862150192], [0.09078191965818405, 0.09059615433216095, 0.09067808836698532, 0.09084826707839966, 0.09087038785219193, 0.09053663164377213, 0.09076646715402603, 0.09072863310575485, 0.09237964451313019, 0.09090693295001984, 0.09090693295001984], [0.09078191965818405, 0.09059615433216095, 0.09067808836698532, 0.09084826707839966, 0.09087038785219193, 0.09053663164377213, 0.09076646715402603, 0.09072863310575485, 0.09237964451313019, 0.09090693295001984, 0.09090693295001984]], [[0.09065788239240646, 0.09078478068113327, 0.09072623401880264, 0.0905316099524498, 0.0907946452498436, 0.09092173725366592, 0.09095600247383118, 0.09122027456760406, 0.09102458506822586, 0.09128905087709427, 0.09109321236610413], [0.09068211913108826, 0.09079679846763611, 0.09074389189481735, 0.09056799858808517, 0.09080570936203003, 0.09092053771018982, 0.09095149487257004, 0.09119021147489548, 0.09101344645023346, 0.09125232696533203, 0.09107545018196106], [0.09067094326019287, 0.0907912626862526, 0.09073574841022491, 0.0905512198805809, 0.09080060571432114, 0.09092108905315399, 0.09095357358455658, 0.09120407700538635, 0.09101857990026474, 0.09126926213502884, 0.09108363837003708], [0.09063372015953064, 0.09077280014753342, 0.09070862829685211, 0.09049534052610397, 0.09078361093997955, 0.09092291444540024, 0.09096048027276993, 0.0912502259016037, 0.09103566408157349, 0.09132564812898636, 0.09111090749502182], [0.09068400412797928, 0.09079772979021072, 0.09074526280164719, 0.09057082235813141, 0.09080656617879868, 0.09092044085264206, 0.09095114469528198, 0.09118787199258804, 0.09101258218288422, 0.09124947339296341, 0.09107406437397003], [0.09070825576782227, 0.09080974757671356, 0.09076292812824249, 0.09060723334550858, 0.09081763029098511, 0.09091924130916595, 0.09094663709402084, 0.09115782380104065, 0.09100145101547241, 0.09121276438236237, 0.09105630218982697], [0.09071478247642517, 0.09081298112869263, 0.09076768159866333, 0.09061704576015472, 0.09082061052322388, 0.09091892093420029, 0.09094542264938354, 0.0911497250199318, 0.09099845588207245, 0.09120287746191025, 0.09105151146650314], [0.0907650738954544, 0.09083788096904755, 0.09080429375171661, 0.09069258719682693, 0.09084353595972061, 0.09091640263795853, 0.09093604236841202, 0.09108740091323853, 0.09097534418106079, 0.09112676233053207, 0.09101465344429016], [0.09072784334421158, 0.09081944823265076, 0.0907771959900856, 0.09063666313886642, 0.09082656353712082, 0.09091826528310776, 0.09094298630952835, 0.09113352745771408, 0.09099245071411133, 0.09118309617042542, 0.0910419374704361], [0.09077814221382141, 0.09084434807300568, 0.09081381559371948, 0.09071221947669983, 0.09084949642419815, 0.0909157544374466, 0.09093361347913742, 0.0910712257027626, 0.09096933901309967, 0.09110700339078903, 0.09100508689880371], [0.09074091166257858, 0.09082591533660889, 0.09078670293092728, 0.09065628051757812, 0.09083252400159836, 0.09091760963201523, 0.09094054996967316, 0.09111734479665756, 0.09098644554615021, 0.09116332232952118, 0.09103236347436905]], [[0.09072951227426529, 0.09075663238763809, 0.09060216695070267, 0.09081090986728668, 0.09058289229869843, 0.09042872488498688, 0.09071055799722672, 0.09091955423355103, 0.09269332885742188, 0.09088288992643356, 0.09088288992643356], [0.09073545038700104, 0.0907616838812828, 0.0906122699379921, 0.09081418067216873, 0.090593621134758, 0.09044448286294937, 0.0907171219587326, 0.09091926366090775, 0.09263433516025543, 0.09088379889726639, 0.09088379889726639], [0.09070155024528503, 0.09073284268379211, 0.09055464714765549, 0.09079546481370926, 0.09053241461515427, 0.09035461395978928, 0.09067969024181366, 0.0909208357334137, 0.09297095984220505, 0.09087852388620377, 0.09087852388620377], [0.09074731916189194, 0.09077177941799164, 0.09063246846199036, 0.09082072228193283, 0.09061508625745773, 0.09047601372003555, 0.0907302275300026, 0.09091868251562119, 0.0925164520740509, 0.09088562428951263, 0.09088562428951263], [0.09069729596376419, 0.09072921425104141, 0.09054743498563766, 0.09079310297966003, 0.09052474796772003, 0.09034337103366852, 0.090674988925457, 0.09092100709676743, 0.09301307052373886, 0.09087783843278885, 0.09087783843278885], [0.09066326171159744, 0.09070023894309998, 0.0904897078871727, 0.09077424556016922, 0.09046344459056854, 0.09025345742702484, 0.09063743054866791, 0.09092243760824203, 0.09335092455148697, 0.09087242186069489, 0.09087242186069489], [0.0907253548502922, 0.09075309336185455, 0.09059509634971619, 0.09080861508846283, 0.09057538211345673, 0.09041769802570343, 0.09070596843957901, 0.09091974794864655, 0.09273456037044525, 0.09088223427534103, 0.09088223427534103], [0.09077101200819016, 0.09079192578792572, 0.09067283570766449, 0.09083375334739685, 0.09065797179937363, 0.09053906053304672, 0.09075640887022018, 0.09091747552156448, 0.09228108823299408, 0.09088922291994095, 0.09088922291994095], [0.0911460742354393, 0.09110933542251587, 0.09131890535354614, 0.09103589504957199, 0.09134511649608612, 0.09155523031949997, 0.0911717563867569, 0.09088920801877975, 0.08855120837688446, 0.09093866497278214, 0.09093866497278214], [0.09076303243637085, 0.09078513830900192, 0.0906592309474945, 0.09082937240600586, 0.090643510222435, 0.0905178040266037, 0.09074758738279343, 0.09091789275407791, 0.09236042946577072, 0.09088802337646484, 0.09088802337646484], [0.09076303243637085, 0.09078513830900192, 0.0906592309474945, 0.09082937240600586, 0.090643510222435, 0.0905178040266037, 0.09074758738279343, 0.09091789275407791, 0.09236042946577072, 0.09088802337646484, 0.09088802337646484]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_return_max": 14.5, "env_reset_timer": 0.0005458666963493546, "episode_duration_sec_mean": 0.005200390062527731, "sample": 0.11627682968965376, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1916369400778577e-05, "batch_individual_items": 1.229909665970012e-05, "add_time_dim_to_batch_and_zero_pad": 6.810654807725874e-06, "add_observations_from_episodes_to_batch": 2.8622312030170293e-06, "add_states_from_episodes_to_batch": 2.793722648455498e-06}}, "connector_pipeline_timer": 5.879394266064688e-05}, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1944310042702413e-05, "normalize_and_clip_actions": 7.815742464348553e-06, "get_actions": 3.64394075977189e-05, "listify_data_for_vector_env": 1.0278101393369468e-05, "un_batch_to_individual_items": 6.6753575869918076e-06, "tensor_to_numpy": 1.4906939911179135e-05}}, "connector_pipeline_timer": 0.00011421590869381436}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 1.25}, "episode_return_mean": 1.25, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "weights_seq_no": 11.0, "episode_len_max": 20, "episode_return_min": -13.5, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 1.25}, "num_episodes_lifetime": 220, "episode_len_min": 20, "env_step_timer": 1.4088961988899067e-05, "num_env_steps_sampled_lifetime": 55400, "rlmodule_inference_timer": 3.06901404847737e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "time_between_sampling": 9.383375634463057}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "b19cd_00000", "date": "2025-08-11_18-41-38", "timestamp": 1754930498, "time_this_iter_s": 9.42619276046753, "time_total_s": 105.02347660064697, "pid": 11628, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1629fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 105.02347660064697, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 42.00714285714285, "ram_util_percent": 79.35714285714286}}
{"timers": {"training_iteration": 9.156741566114475, "restore_env_runners": 9.376167626559698e-06, "training_step": 9.156611413655817, "env_runner_sampling_timer": 1.6721756669034187, "learner_update_timer": 7.3109184762864095, "synch_weights": 0.0008369133877609447, "restore_eval_env_runners": 9.751638291391164e-06, "evaluation_iteration": 0.1267093548123352, "synch_eval_env_connectors": 0.00017947229307938942, "synch_env_connectors": 4.611146440111858e-06}, "env_runners": {"env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "env_reset_timer": 4.119992478220492e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.92325079971548e-05, "listify_data_for_vector_env": 1.0561784534612145e-05, "tensor_to_numpy": 1.5122550091143269e-05, "un_batch_to_individual_items": 6.650464335259869e-06, "remove_single_ts_time_rank_from_batch": 1.1957823764080697e-05, "normalize_and_clip_actions": 7.928357048635235e-06}}, "connector_pipeline_timer": 0.00011769156257981206}, "episode_duration_sec_mean": 0.005807607508730142, "sample": 0.0062003960190042656, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7170402550397275e-06, "numpy_to_tensor": 1.2438089269237474e-05, "batch_individual_items": 1.2464548649600167e-05, "add_observations_from_episodes_to_batch": 2.7856638793119705e-06, "add_time_dim_to_batch_and_zero_pad": 6.859818544447364e-06}}, "connector_pipeline_timer": 5.925313153915157e-05}, "agent_episode_returns_mean": {"default_agent": 2.259999999999999}, "time_between_sampling": 0.031784132829056934, "weights_seq_no": 11.0, "num_episodes_lifetime": -308250.0, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 2.259999999999999}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "episode_return_mean": 2.259999999999999, "episode_len_max": 20, "env_step_timer": 1.4126850089794232e-05, "num_env_steps_sampled_lifetime": -6165000.0, "episode_len_mean": 20.0, "rlmodule_inference_timer": 6.136432530584918e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime_throughput": 3248.128704473373}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13528261441251824, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009030233381719044, "add_observations_from_episodes_to_batch": 0.000882048449547511, "add_columns_from_episodes_to_train_batch": 0.041893816984213295, "add_time_dim_to_batch_and_zero_pad": 0.07547144484823869, "add_states_from_episodes_to_batch": 0.003554267725399924, "batch_individual_items": 0.004238863926245329, "numpy_to_tensor": 6.438478163917858e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 61.0, "module_train_batch_size_mean": 997.504027034245, "total_loss": 0.0, "weights_seq_no": 72.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 430920}, "default_policy": {"module_train_batch_size_mean": 997.504027034245, "mean_kl_loss": 6.637932528974488e-06, "weights_seq_no": 72.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 430920, "diff_num_grad_updates_vs_sampler_policy": 61.0, "use_intrinsic_rewards": 1.0, "entropy": 0.6761733293533325, "vf_loss_unclipped": 44.02834701538086, "vf_explained_var": 0.003412485122680664, "policy_loss": -3.707974246935919e-05, "total_loss": 0.27810049057006836, "vf_loss": 0.3583589792251587}, "__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 861840, "num_env_steps_trained_lifetime": 2376000, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 51536.33965995151}}}, "default_policy": {"curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.35830458998680115, "mean_kl_loss": 6.63612763673882e-06, "num_module_steps_trained_lifetime": 71820, "module_train_batch_size_mean": 997.7412016936058, "weights_seq_no": 12.0, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 16595, "use_intrinsic_rewards": 0.0, "entropy": 0.6761741042137146, "vf_loss_unclipped": 44.1848030090332, "vf_explained_var": 0.0009185671806335449, "curr_kl_coeff": 3.944920172216371e-05, "policy_loss": -3.540252146194689e-05, "total_loss": 0.2780587375164032, "num_module_steps_trained_lifetime_throughput": 794.8709475525719}, "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 997.7412016936058, "weights_seq_no": 12.0, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 71820, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 794.8811312303491}, "__all_modules__": {"num_env_steps_trained_lifetime": 396000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 33000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 143640, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4384.157041761809, "num_module_steps_trained_throughput": 23796443.170891274, "num_module_steps_trained_lifetime_throughput": 12841170.203280479}, "IntrinsicAttentionMask": [[[0.09068719297647476, 0.09049264341592789, 0.09107799082994461, 0.09088260680437088, 0.09082399308681488, 0.09095112979412079, 0.09098540991544724, 0.09124976396560669, 0.09105401486158371, 0.09099528938531876, 0.09080007672309875], [0.09065430611371994, 0.09043104201555252, 0.09110300242900848, 0.09087863564491272, 0.0908113420009613, 0.09095731377601624, 0.09099667519330978, 0.09130031615495682, 0.09107545763254166, 0.0910080224275589, 0.09078389406204224], [0.09075301885604858, 0.09061606228351593, 0.0910278707742691, 0.09089049696922302, 0.09084927290678024, 0.09093868732452393, 0.09096278995275497, 0.09114857017993927, 0.09101101756095886, 0.09096973389387131, 0.09083244949579239], [0.09072013199329376, 0.09055440127849579, 0.09105289727449417, 0.09088654816150665, 0.09083664417266846, 0.09094490110874176, 0.09097408503293991, 0.09119909256696701, 0.0910324826836586, 0.09098249673843384, 0.09081628173589706], [0.09071025997400284, 0.09053588658571243, 0.09106041491031647, 0.09088537096977234, 0.09083285182714462, 0.09094676375389099, 0.09097747504711151, 0.09121427685022354, 0.09103893488645554, 0.09098632633686066, 0.09081142395734787], [0.090731680393219, 0.09057603031396866, 0.0910441130399704, 0.09088794142007828, 0.09084107726812363, 0.09094271808862686, 0.09097012132406235, 0.09118136018514633, 0.09102495014667511, 0.09097801893949509, 0.09082195907831192], [0.09073745459318161, 0.09058686345815659, 0.0910397320985794, 0.09088864177465439, 0.0908433049917221, 0.09094163775444031, 0.09096814692020416, 0.09117250144481659, 0.09102118760347366, 0.09097578376531601, 0.09082480520009995], [0.09078187495470047, 0.09067019075155258, 0.09100591391324997, 0.09089395403862, 0.09086035192012787, 0.09093323349952698, 0.09095288068056107, 0.09110426157712936, 0.09099218249320984, 0.09095854312181473, 0.09084663540124893], [0.09074899554252625, 0.09060849994421005, 0.09103094786405563, 0.09089002013206482, 0.09084773063659668, 0.09093945473432541, 0.0909641832113266, 0.09115476906299591, 0.09101364761590958, 0.09097130596637726, 0.0908304750919342], [0.09073911607265472, 0.0905899778008461, 0.09103845804929733, 0.09088883548974991, 0.09084393829107285, 0.09094131737947464, 0.0909675732254982, 0.09116994589567184, 0.09102010726928711, 0.09097514301538467, 0.09082561731338501], [0.0907062217593193, 0.09052833169698715, 0.0910634845495224, 0.09088487923145294, 0.09083129465579987, 0.09094752371311188, 0.09097885340452194, 0.09122046828269958, 0.09104156494140625, 0.09098789095878601, 0.09080944210290909]], [[0.0904315933585167, 0.09080058336257935, 0.09059841185808182, 0.0908716470003128, 0.09057319164276123, 0.0907047837972641, 0.0904068797826767, 0.09101393818855286, 0.09300140291452408, 0.09063169360160828, 0.09096591174602509], [0.09055639803409576, 0.09082937240600586, 0.0906798392534256, 0.09088190644979477, 0.0906611829996109, 0.09075852483510971, 0.09053810685873032, 0.09098707139492035, 0.0924515351653099, 0.09070445597171783, 0.0909515768289566], [0.09048810601234436, 0.09081365913152695, 0.09063530713319778, 0.09087633341550827, 0.09061305224895477, 0.09072914719581604, 0.09046629071235657, 0.09100181609392166, 0.09275217354297638, 0.09066466242074966, 0.09095947444438934], [0.09058035910129547, 0.09083486348390579, 0.09069546312093735, 0.09088384360074997, 0.09067806601524353, 0.09076882153749466, 0.09056329727172852, 0.0909818708896637, 0.09234623610973358, 0.09071841090917587, 0.09094879031181335], [0.09047956764698029, 0.09081168472766876, 0.09062972664833069, 0.09087563306093216, 0.09060703217983246, 0.09072547405958176, 0.09045731276273727, 0.0910036489367485, 0.09278978407382965, 0.09065967798233032, 0.09096044301986694], [0.09052406251430511, 0.09082193672657013, 0.0906587541103363, 0.09087927639484406, 0.09063839912414551, 0.09074462950229645, 0.09050410240888596, 0.09099406749010086, 0.09259379655122757, 0.09068562090396881, 0.09095532447099686], [0.09042321145534515, 0.09079863876104355, 0.09059293568134308, 0.0908709391951561, 0.09056727588176727, 0.09070117026567459, 0.09039806574583054, 0.09101571887731552, 0.093038409948349, 0.0906267911195755, 0.0909668579697609], [0.0906282514333725, 0.09084580838680267, 0.09072665870189667, 0.09088767319917679, 0.09071178734302521, 0.09078937023878098, 0.09061367064714432, 0.090971440076828, 0.092135950922966, 0.09074627608060837, 0.09094317257404327], [0.091286800801754, 0.0909917801618576, 0.09115315973758698, 0.09093520790338516, 0.09117333590984344, 0.09106816351413727, 0.0913066416978836, 0.09082218259572983, 0.08927583694458008, 0.09112655371427536, 0.0908602923154831], [0.09049935638904572, 0.09081624448299408, 0.09064263850450516, 0.09087725728750229, 0.0906209796667099, 0.09073399752378464, 0.09047812223434448, 0.09099938720464706, 0.09270258247852325, 0.09067121893167496, 0.09095817059278488], [0.09061210602521896, 0.09084212779998779, 0.09071613848209381, 0.09088638424873352, 0.0907004103064537, 0.09078244119882584, 0.09059668332338333, 0.09097497165203094, 0.09220684319734573, 0.09073688089847565, 0.09094507247209549]], [[0.09071635454893112, 0.09052175283432007, 0.09078475832939148, 0.09091183543205261, 0.09117597341537476, 0.09098038077354431, 0.09069247543811798, 0.09127911180257797, 0.09076085686683655, 0.09102455526590347, 0.09115196764469147], [0.09068778157234192, 0.09046443551778793, 0.0907662957906723, 0.09091219305992126, 0.09121555089950562, 0.09099090099334717, 0.09066036343574524, 0.0913340300321579, 0.09073885530233383, 0.09104163199663162, 0.0911879763007164], [0.09072638303041458, 0.09054186940193176, 0.0907912328839302, 0.09091170132160187, 0.09116209298372269, 0.09097668528556824, 0.09070374071598053, 0.09125984460115433, 0.09076857566833496, 0.09101856499910355, 0.09113933891057968], [0.0907449945807457, 0.09057921916246414, 0.09080325067043304, 0.09091146290302277, 0.09113632142543793, 0.09096982330083847, 0.0907246544957161, 0.09122408926486969, 0.09078289568424225, 0.09100743383169174, 0.09111588448286057], [0.09078358858823776, 0.09065670520067215, 0.09082815796136856, 0.09091093391180038, 0.091082863509655, 0.09095557034015656, 0.09076802432537079, 0.0911499485373497, 0.09081258624792099, 0.09098432213068008, 0.09106724709272385], [0.09075502306222916, 0.09059934318065643, 0.09080972522497177, 0.09091132879257202, 0.09112243354320526, 0.0909661203622818, 0.09073591977357864, 0.09120482206344604, 0.09079060703516006, 0.09100142866373062, 0.09110324829816818], [0.09071284532546997, 0.09051471948623657, 0.09078248590230942, 0.0909118726849556, 0.09118082374334335, 0.09098166972398758, 0.09068853408098221, 0.091285839676857, 0.09075815230607986, 0.09102664142847061, 0.09115637838840485], [0.09079863131046295, 0.09068692475557327, 0.09083786606788635, 0.09091073274612427, 0.0910620465874672, 0.09095001220703125, 0.09078492969274521, 0.09112107753753662, 0.09082415699958801, 0.0909753292798996, 0.09104830771684647], [0.09072287380695343, 0.09053482860326767, 0.09078896045684814, 0.09091173857450485, 0.09116693586111069, 0.09097796678543091, 0.09069979935884476, 0.09126656502485275, 0.09076586365699768, 0.09102065116167068, 0.09114374220371246], [0.09076148271560669, 0.09061230719089508, 0.09081389009952545, 0.09091123938560486, 0.09111348539590836, 0.09096373617649078, 0.09074317663908005, 0.09119241684675217, 0.09079557657241821, 0.09099756181240082, 0.09109511226415634], [0.09078008681535721, 0.09064967185258865, 0.09082590043544769, 0.09091098606586456, 0.0910877138376236, 0.09095686674118042, 0.09076408296823502, 0.09115667641162872, 0.0908098891377449, 0.09098643064498901, 0.09107165783643723]], [[0.09040141850709915, 0.09043678641319275, 0.0905681848526001, 0.09084133058786392, 0.09087686985731125, 0.09067452698945999, 0.09070999920368195, 0.0909835696220398, 0.09297037124633789, 0.09060145169496536, 0.09093555808067322], [0.09041416645050049, 0.09044864773750305, 0.09057676792144775, 0.0908430814743042, 0.09087773412466049, 0.09068045020103455, 0.09071503579616547, 0.09098175913095474, 0.09291821718215942, 0.09060920029878616, 0.09093495458364487], [0.09046146273612976, 0.09049267321825027, 0.0906086191534996, 0.09084957838058472, 0.09088093042373657, 0.09070243686437607, 0.09073373675346375, 0.09097503125667572, 0.09272486716508865, 0.09063796699047089, 0.0909326896071434], [0.09055950492620468, 0.0905839204788208, 0.09067458659410477, 0.09086292237043381, 0.0908874124288559, 0.09074793010950089, 0.09077239036560059, 0.09096092730760574, 0.09232497960329056, 0.0906975269317627, 0.090927854180336], [0.09057223796844482, 0.09059576690196991, 0.09068314731121063, 0.0908646434545517, 0.09088824689388275, 0.09075382351875305, 0.09077740460634232, 0.0909590870141983, 0.09227315336465836, 0.0907052531838417, 0.09092722088098526], [0.09049967676401138, 0.09052824229001999, 0.09063434600830078, 0.09085480123758316, 0.09088347852230072, 0.09072018414735794, 0.09074881672859192, 0.09096955507993698, 0.09256885945796967, 0.0906611979007721, 0.09093082696199417], [0.09051241725683212, 0.0905400887131691, 0.09064291417598724, 0.09085653722286224, 0.09088432043790817, 0.0907260924577713, 0.09075383841991425, 0.09096772223711014, 0.09251690655946732, 0.0906689316034317, 0.09093020111322403], [0.09061042219400406, 0.09063129872083664, 0.09070880711078644, 0.09086978435516357, 0.09089072048664093, 0.09077150374650955, 0.09079241007566452, 0.09095354378223419, 0.09211782366037369, 0.09072841703891754, 0.09092527627944946], [0.09131114929914474, 0.09128276258707047, 0.09117746353149414, 0.09095945954322815, 0.09093118458986282, 0.09109245240688324, 0.09106413275003433, 0.09084639698266983, 0.08929964900016785, 0.09115085750818253, 0.09088452160358429], [0.09047342091798782, 0.09050380438566208, 0.09061667323112488, 0.09085121750831604, 0.09088172763586044, 0.09070799499750137, 0.0907384529709816, 0.09097331762313843, 0.09267602115869522, 0.09064523875713348, 0.09093210846185684], [0.09059324860572815, 0.09061530977487564, 0.0906972661614418, 0.09086747467517853, 0.09088961035013199, 0.09076355397701263, 0.09078565984964371, 0.09095603972673416, 0.09218765795230865, 0.09071800112724304, 0.0909261554479599]], [[0.09065792709589005, 0.09078483283519745, 0.09104860574007034, 0.09053164720535278, 0.0911172479391098, 0.0909217819571495, 0.09095605462789536, 0.09122031927108765, 0.09070239961147308, 0.09096592664718628, 0.09109325706958771], [0.09068216383457184, 0.09079683572053909, 0.0910351425409317, 0.09056803584098816, 0.0910971537232399, 0.0909205749630928, 0.09095153212547302, 0.09119024872779846, 0.09072234481573105, 0.09096045792102814, 0.09107548743486404], [0.09073243290185928, 0.09082172811031342, 0.09100721776485443, 0.09064354002475739, 0.0910554751753807, 0.09091805666685104, 0.0909421518445015, 0.0911278948187828, 0.09076372534036636, 0.09094910323619843, 0.09103861451148987], [0.09063377976417542, 0.0907728523015976, 0.09106200933456421, 0.09049540013074875, 0.09113726764917374, 0.09092297405004501, 0.0909605398774147, 0.09125028550624847, 0.0906825065612793, 0.09097137302160263, 0.0911109670996666], [0.09074550122022629, 0.09082819521427155, 0.09099997580051422, 0.09066316485404968, 0.09104464948177338, 0.09091740846633911, 0.0909397229552269, 0.09111170470714569, 0.09077448397874832, 0.09094615280628204, 0.09102904051542282], [0.09070828557014465, 0.09080977737903595, 0.09102064371109009, 0.09060726314783096, 0.09107550233602524, 0.09091927111148834, 0.09094666689634323, 0.09115785360336304, 0.09074385464191437, 0.09095456451177597, 0.09105633199214935], [0.09071481227874756, 0.09081301093101501, 0.09101701527833939, 0.09061706811189651, 0.09107008576393127, 0.09091894328594208, 0.09094545245170593, 0.09114975482225418, 0.09074922651052475, 0.09095308929681778, 0.09105154126882553], [0.0907650962471962, 0.09083790332078934, 0.09098909795284271, 0.09069260209798813, 0.09102841466665268, 0.09091642498970032, 0.09093606472015381, 0.09108742326498032, 0.09079061448574066, 0.09094172716140747, 0.09101467579603195], [0.09066641330718994, 0.09078902751207352, 0.0910438746213913, 0.09054439514875412, 0.09111019968986511, 0.09092134982347488, 0.09095446020364761, 0.0912097692489624, 0.0907093808054924, 0.09096400439739227, 0.09108702093362808], [0.09071668982505798, 0.09081393480300903, 0.09101596474647522, 0.09061989188194275, 0.09106852114200592, 0.09091884642839432, 0.09094509482383728, 0.09114741533994675, 0.09075076878070831, 0.09095265716314316, 0.0910501554608345], [0.09074093401432037, 0.09082593768835068, 0.09100250154733658, 0.09065630286931992, 0.09104842692613602, 0.09091763198375702, 0.09094057232141495, 0.09111735969781876, 0.09077072143554688, 0.09094718098640442, 0.09103237837553024]], [[0.09046177566051483, 0.09083089232444763, 0.09062865376472473, 0.09090197831392288, 0.090937539935112, 0.09040168672800064, 0.09043705463409424, 0.09070980548858643, 0.09303244203329086, 0.09066193550825119, 0.09099627286195755], [0.09057874977588654, 0.0908517986536026, 0.09070222824811935, 0.0909043401479721, 0.09093062579631805, 0.0905342772603035, 0.09056045114994049, 0.09076225757598877, 0.09247435629367828, 0.09072685241699219, 0.09097403287887573], [0.09051473438739777, 0.09084038436412811, 0.09066198021173477, 0.09090308845043182, 0.09093444794416428, 0.09046171605587006, 0.09049292653799057, 0.09073357284069061, 0.09277947247028351, 0.09069135040044785, 0.09098624438047409], [0.09060119837522507, 0.09085576981306076, 0.09071633219718933, 0.09090475738048553, 0.09092926234006882, 0.09055973589420319, 0.09058414399623871, 0.09077229350805283, 0.09236748516559601, 0.09073928743600845, 0.09096971899271011], [0.09061242640018463, 0.09085775166749954, 0.09072338044643402, 0.09090496599674225, 0.0909285768866539, 0.09057246148586273, 0.09059598296880722, 0.09077730774879456, 0.09231409430503845, 0.09074550867080688, 0.0909675657749176], [0.09044265747070312, 0.09082743525505066, 0.0906166061758995, 0.09090154618024826, 0.09093862026929855, 0.09038002789020538, 0.09041689336299896, 0.09070120751857758, 0.09312377870082855, 0.09065130352973938, 0.09099985659122467], [0.09045391529798508, 0.09082947671413422, 0.09062370657920837, 0.09090180695056915, 0.09093798696994781, 0.09039278328418732, 0.09042876958847046, 0.09070626646280289, 0.09307000786066055, 0.09065757691860199, 0.09099775552749634], [0.09054045379161835, 0.09084498137235641, 0.0906781554222107, 0.09090360999107361, 0.0909329280257225, 0.09049085527658463, 0.09052005410194397, 0.09074510633945465, 0.09265685826539993, 0.09070561826229095, 0.09098135679960251], [0.09126246720552444, 0.09096752107143402, 0.09112885594367981, 0.09091096371412277, 0.09088270366191864, 0.09131068736314774, 0.09128230065107346, 0.09106404334306717, 0.0892520397901535, 0.09110225737094879, 0.0908360704779625], [0.09052528440952301, 0.09084227681159973, 0.09066861867904663, 0.09090328961610794, 0.09093382209539413, 0.09047366678714752, 0.09050405025482178, 0.09073830395936966, 0.09272914379835129, 0.09069719910621643, 0.09098424017429352], [0.09063094854354858, 0.09086102247238159, 0.09073501080274582, 0.09090528637170792, 0.09092742949724197, 0.09059345722198486, 0.09061553329229355, 0.09078558534383774, 0.09222602099180222, 0.09075575321912766, 0.09096398949623108]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_return_max": 14.5, "env_reset_timer": 0.0005412401195401512, "episode_duration_sec_mean": 0.005193200905341655, "sample": 0.11624392222301766, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.175290279650445e-05, "batch_individual_items": 1.2256254781054975e-05, "add_time_dim_to_batch_and_zero_pad": 6.9181450192124255e-06, "add_observations_from_episodes_to_batch": 2.8314948736545988e-06, "add_states_from_episodes_to_batch": 2.731329290775724e-06}}, "connector_pipeline_timer": 5.867312640453356e-05}, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1673405269802775e-05, "normalize_and_clip_actions": 7.830461449297326e-06, "get_actions": 3.5809674323731845e-05, "listify_data_for_vector_env": 1.0357504030517934e-05, "un_batch_to_individual_items": 6.5398465132468585e-06, "tensor_to_numpy": 1.4663816913303564e-05}}, "connector_pipeline_timer": 0.00011291286668336747}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 0.05}, "episode_return_mean": 0.05, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "weights_seq_no": 12.0, "episode_len_max": 20, "episode_return_min": -13.5, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 0.05}, "num_episodes_lifetime": 240, "episode_len_min": 20, "env_step_timer": 1.3864562011403854e-05, "num_env_steps_sampled_lifetime": 60400, "rlmodule_inference_timer": 3.064788591138832e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "time_between_sampling": 9.379514030207893}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "b19cd_00000", "date": "2025-08-11_18-41-47", "timestamp": 1754930507, "time_this_iter_s": 9.087583065032959, "time_total_s": 114.11105966567993, "pid": 11628, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1629fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 114.11105966567993, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 40.28461538461538, "ram_util_percent": 78.73076923076923}}
{"timers": {"training_iteration": 9.153521027953047, "restore_env_runners": 9.351156182752216e-06, "training_step": 9.153390058688526, "env_runner_sampling_timer": 1.6716083019045183, "learner_update_timer": 7.30819305277396, "synch_weights": 0.0008373742547625782, "restore_eval_env_runners": 9.718702144107527e-06, "evaluation_iteration": 0.12662251085417287, "synch_eval_env_connectors": 0.0001786421502523505, "synch_env_connectors": 4.60670584015869e-06}, "env_runners": {"env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "env_reset_timer": 3.843308663373145e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.903420756232282e-05, "listify_data_for_vector_env": 1.0522244244630799e-05, "tensor_to_numpy": 1.5131720386381547e-05, "un_batch_to_individual_items": 6.667508558046288e-06, "remove_single_ts_time_rank_from_batch": 1.1958809916567015e-05, "normalize_and_clip_actions": 7.955855280416838e-06}}, "connector_pipeline_timer": 0.00011755887484602478}, "episode_duration_sec_mean": 0.005259986703284085, "sample": 0.005920592005301299, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7002871272564424e-06, "numpy_to_tensor": 1.2549180684529983e-05, "batch_individual_items": 1.2457029447909026e-05, "add_observations_from_episodes_to_batch": 2.783234774954425e-06, "add_time_dim_to_batch_and_zero_pad": 6.867820300131658e-06}}, "connector_pipeline_timer": 5.937518533828725e-05}, "agent_episode_returns_mean": {"default_agent": 3.1399999999999992}, "time_between_sampling": 0.03036111258498511, "weights_seq_no": 12.0, "num_episodes_lifetime": -339125.0, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 3.1399999999999992}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "episode_return_mean": 3.1399999999999992, "episode_len_max": 20, "env_step_timer": 1.4116771208101325e-05, "num_env_steps_sampled_lifetime": -6782500.0, "episode_len_mean": 20.0, "rlmodule_inference_timer": 3.135515161955682e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime_throughput": 3261.4556125341837}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13525925243807785, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00902803271758218, "add_observations_from_episodes_to_batch": 0.0008819658849041734, "add_columns_from_episodes_to_train_batch": 0.04188431881444701, "add_time_dim_to_batch_and_zero_pad": 0.07546258955984429, "add_states_from_episodes_to_batch": 0.0035543533881201342, "batch_individual_items": 0.004236914876630452, "numpy_to_tensor": 6.423802375452815e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 66.0, "module_train_batch_size_mean": 997.5020416990191, "total_loss": 0.0, "weights_seq_no": 78.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 466830}, "default_policy": {"module_train_batch_size_mean": 997.5020416990191, "mean_kl_loss": 1.5186200471362099e-05, "weights_seq_no": 78.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 466830, "diff_num_grad_updates_vs_sampler_policy": 66.0, "use_intrinsic_rewards": 1.0, "entropy": 0.6757753491401672, "vf_loss_unclipped": 45.69882583618164, "vf_explained_var": 0.0035755038261413574, "policy_loss": -0.00037735956721007824, "total_loss": 0.2777489125728607, "vf_loss": 0.35834190249443054}, "__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 933660, "num_env_steps_trained_lifetime": 2574000, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 50681.663330396594}}}, "default_policy": {"curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.35830453038215637, "mean_kl_loss": 1.6834066627779976e-05, "num_module_steps_trained_lifetime": 77805, "module_train_batch_size_mean": 997.7269395717314, "weights_seq_no": 13.0, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 16595, "use_intrinsic_rewards": 0.0, "entropy": 0.6757214665412903, "vf_loss_unclipped": 45.7986946105957, "vf_explained_var": 0.003958404064178467, "curr_kl_coeff": 1.9724600861081854e-05, "policy_loss": -0.0003926314238924533, "total_loss": 0.2777021527290344, "num_module_steps_trained_lifetime_throughput": 792.4928767193105}, "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 997.7269395717314, "weights_seq_no": 13.0, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 77805, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 792.5024776377511}, "__all_modules__": {"num_env_steps_trained_lifetime": 429000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 33000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 155610, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4370.9886693624785, "num_module_steps_trained_throughput": 23213707.962543216, "num_module_steps_trained_lifetime_throughput": 12825673.450157266}, "IntrinsicAttentionMask": [[[0.09130067378282547, 0.09058709442615509, 0.09078580886125565, 0.0906386747956276, 0.09108112752437592, 0.09069028496742249, 0.09095939993858337, 0.091158926486969, 0.0907677486538887, 0.09121083468198776, 0.09081944078207016], [0.09167338907718658, 0.09028192609548569, 0.09066836535930634, 0.0903821513056755, 0.091244176030159, 0.09048249572515488, 0.09100662171840668, 0.09139616787433624, 0.09063322842121124, 0.09149763733148575, 0.0907338485121727], [0.0915692076086998, 0.09036709368228912, 0.09070120006799698, 0.09045377373695374, 0.09119866788387299, 0.09054052829742432, 0.0909934863448143, 0.0913299098610878, 0.09067083150148392, 0.09141750633716583, 0.09075779467821121], [0.09164631366729736, 0.09030403941869736, 0.09067689627408981, 0.09040075540542603, 0.09123235195875168, 0.09049757570028305, 0.09100320935249329, 0.09137894958257675, 0.09064298868179321, 0.09147681295871735, 0.09074006974697113], [0.0914149358868599, 0.09049340337514877, 0.0907498151063919, 0.0905599445104599, 0.09113118797540665, 0.0906265377998352, 0.09097394347190857, 0.09123171865940094, 0.09072650969028473, 0.09129880368709564, 0.09079322963953018], [0.09161924570798874, 0.09032616764307022, 0.09068542718887329, 0.09041935950517654, 0.09122052788734436, 0.09051264822483063, 0.0909997969865799, 0.09136173874139786, 0.09065275639295578, 0.09145599603652954, 0.09074629098176956], [0.09147843718528748, 0.09044137597084045, 0.09072979539632797, 0.09051621705293655, 0.09115897119045258, 0.09059111773967743, 0.09098199754953384, 0.09127214550971985, 0.090703584253788, 0.09134767204523087, 0.0907786414027214], [0.09137439727783203, 0.09052661806344986, 0.09076257795095444, 0.09058786183595657, 0.09111343324184418, 0.09064914286136627, 0.0909687876701355, 0.091205894947052, 0.09074114263057709, 0.09126759320497513, 0.09080252051353455], [0.0915786549448967, 0.09035935997962952, 0.09069821983575821, 0.09044726938009262, 0.09120279550552368, 0.09053526073694229, 0.09099467843770981, 0.09133591502904892, 0.09066741168498993, 0.09142477065324783, 0.09075561910867691], [0.09134737402200699, 0.09054876863956451, 0.09077107906341553, 0.09060646593570709, 0.09110158681869507, 0.09066420793533325, 0.09096534550189972, 0.09118868410587311, 0.09075088053941727, 0.09124679118394852, 0.09080871194601059], [0.09155160188674927, 0.09038149565458298, 0.09070675075054169, 0.09046587347984314, 0.09119097143411636, 0.09055034071207047, 0.09099125862121582, 0.09131870418787003, 0.0906771793961525, 0.09140396863222122, 0.09076183289289474]], [[0.09049205482006073, 0.09086129069328308, 0.09065898507833481, 0.09059830754995346, 0.09063374996185303, 0.09043195098638535, 0.090800940990448, 0.09074016660451889, 0.09306357800960541, 0.09069228172302246, 0.09102673083543777], [0.09060115367174149, 0.09087426960468292, 0.09072466194629669, 0.09067977964878082, 0.0907059982419014, 0.09055667370557785, 0.09082964062690735, 0.0907847061753273, 0.09249722957611084, 0.09074929356575012, 0.09099653363227844], [0.09054145961999893, 0.09086721390485764, 0.09068875759840012, 0.09063521772623062, 0.09066648781299591, 0.09048842638731003, 0.09081397950649261, 0.09076036512851715, 0.0928068682551384, 0.09071812778711319, 0.0910131111741066], [0.09052352607250214, 0.09086507558822632, 0.09067794680595398, 0.09062181413173676, 0.09065460413694382, 0.0904679149389267, 0.09080924838781357, 0.09075303375720978, 0.09290006011724472, 0.09070874750614166, 0.09101806581020355], [0.09053399413824081, 0.09086631238460541, 0.09068425744771957, 0.09062963724136353, 0.09066154062747955, 0.09047988802194595, 0.09081200510263443, 0.09075731039047241, 0.0928456038236618, 0.0907142236828804, 0.09101516008377075], [0.09047422558069229, 0.09085913747549057, 0.09064823389053345, 0.09058497846126556, 0.09062192589044571, 0.09041157364845276, 0.09079621732234955, 0.09073285758495331, 0.09315627813339233, 0.09068293869495392, 0.09103161096572876], [0.09058338403701782, 0.09087219089269638, 0.0907139852643013, 0.0906665176153183, 0.09069424122571945, 0.09053634852170944, 0.09082499891519547, 0.09077747166156769, 0.09258944541215897, 0.09074002504348755, 0.091001495718956], [0.09056543558835983, 0.09087005257606506, 0.09070318192243576, 0.09065311402082443, 0.09068235754966736, 0.09051582962274551, 0.09082028269767761, 0.09077014774084091, 0.09268242865800858, 0.09073065221309662, 0.09100646525621414], [0.09123820811510086, 0.090943343937397, 0.09110463410615921, 0.09115313738584518, 0.09112479537725449, 0.09128641337156296, 0.09099138528108597, 0.09103983640670776, 0.0892283171415329, 0.09107804298400879, 0.09081192314624786], [0.09055129438638687, 0.09086837619543076, 0.09069466590881348, 0.09064255654811859, 0.09067299216985703, 0.09049966186285019, 0.09081655740737915, 0.0907643735408783, 0.09275578707456589, 0.09072326123714447, 0.09101037681102753], [0.09064982831478119, 0.09087994694709778, 0.09075390547513962, 0.09071607887744904, 0.09073817729949951, 0.09061232954263687, 0.0908423587679863, 0.09080449491739273, 0.09224522858858109, 0.09077465534210205, 0.09098293632268906]], [[0.09071632474660873, 0.09052171558141708, 0.09110724925994873, 0.09091180562973022, 0.09085317701101303, 0.0906582698225975, 0.090692438185215, 0.0909559428691864, 0.09108326584100723, 0.09134790301322937, 0.09115193784236908], [0.09068773686885834, 0.09046439081430435, 0.09113659709692001, 0.09091214835643768, 0.09084483236074448, 0.09062109887599945, 0.09066032618284225, 0.09096283465623856, 0.09110904484987259, 0.09141305834054947, 0.09118792414665222], [0.0907735526561737, 0.09063656628131866, 0.0910484716296196, 0.09091106802225113, 0.09086982905864716, 0.09073270112276077, 0.09075675159692764, 0.09094210714101791, 0.09103161096572876, 0.0912175327539444, 0.09107987582683563], [0.0907449722290039, 0.09057918936014175, 0.09107781946659088, 0.09091143310070038, 0.09086151421070099, 0.09069552272558212, 0.09072462469339371, 0.09094902127981186, 0.09105740487575531, 0.09128262102603912, 0.09111586213111877], [0.09073638916015625, 0.09056196361780167, 0.09108664840459824, 0.09091155230998993, 0.09085901826620102, 0.09068436175584793, 0.09071498364210129, 0.0909510999917984, 0.09106516093015671, 0.09130218625068665, 0.09112667292356491], [0.09070780873298645, 0.09050463140010834, 0.09111600369215012, 0.09091190993785858, 0.09085069596767426, 0.09064719825983047, 0.09068287163972855, 0.09095800668001175, 0.09109095484018326, 0.09136732667684555, 0.09116267412900925], [0.09071280807256699, 0.09051468223333359, 0.09111084043979645, 0.09091184288263321, 0.09085214138031006, 0.09065371006727219, 0.09068849682807922, 0.09095678478479385, 0.09108641743659973, 0.09135588258504868, 0.09115634113550186], [0.09075142443180084, 0.0905921459197998, 0.09107118099927902, 0.09091134369373322, 0.09086338430643082, 0.09070391952991486, 0.09073188155889511, 0.09094744920730591, 0.09105156362056732, 0.0912678986787796, 0.09110771864652634], [0.09077004343271255, 0.09062951803207397, 0.09105206280946732, 0.09091110527515411, 0.09086880832910538, 0.09072813391685486, 0.09075280278921127, 0.09094294905662537, 0.09103477001190186, 0.0912255048751831, 0.09108427911996841], [0.09080864489078522, 0.09070706367492676, 0.0910123959183693, 0.09091058373451233, 0.09088002145290375, 0.09077835828065872, 0.09079618752002716, 0.09093359112739563, 0.09099990874528885, 0.09113761782646179, 0.09103566408157349], [0.09078007191419601, 0.09064965695142746, 0.09104175120592117, 0.09091096371412277, 0.09087171405553818, 0.09074117243289948, 0.09076406806707382, 0.09094051271677017, 0.0910257026553154, 0.09120266139507294, 0.09107164293527603]], [[0.09090577065944672, 0.09093023091554642, 0.0910210832953453, 0.09120981395244598, 0.09123434871435165, 0.09109458327293396, 0.09088868647813797, 0.09130802005529404, 0.08939389139413834, 0.09104407578706741, 0.09096943587064743], [0.09090594947338104, 0.09092952311038971, 0.09101705998182297, 0.09119889885187149, 0.09122253954410553, 0.09108787029981613, 0.09088948369026184, 0.09129351377487183, 0.08944869041442871, 0.09103921800851822, 0.09096729755401611], [0.0909065529704094, 0.09092681109905243, 0.09100206196308136, 0.09115833044052124, 0.09117864817380905, 0.09106292575597763, 0.09089239686727524, 0.09123963117599487, 0.08965235948562622, 0.0910211056470871, 0.09095928817987442], [0.09090761840343475, 0.09092101454734802, 0.09097077697515488, 0.09107407927513123, 0.09108750522136688, 0.09101101756095886, 0.09089825302362442, 0.09112779796123505, 0.09007608145475388, 0.09098336845636368, 0.09094249457120895], [0.0909077376127243, 0.09092024713754654, 0.09096669405698776, 0.09106312692165375, 0.09107565134763718, 0.09100425988435745, 0.09089899808168411, 0.09111326187849045, 0.0901312455534935, 0.09097845107316971, 0.09094029664993286], [0.09090699255466461, 0.09092457592487335, 0.09098989516496658, 0.09112551808357239, 0.09114314615726471, 0.09104271978139877, 0.09089469909667969, 0.09119606018066406, 0.08981725573539734, 0.09100642055273056, 0.09095276892185211], [0.09090565890073776, 0.0909307450056076, 0.09102390706539154, 0.09121745079755783, 0.09124261885881424, 0.09109927713871002, 0.0908881351351738, 0.09131816774606705, 0.08935562521219254, 0.0910474881529808, 0.0909709483385086], [0.09090809524059296, 0.0909179300069809, 0.09095445275306702, 0.09103026241064072, 0.09104011207818985, 0.09098398685455322, 0.090901218354702, 0.09106966853141785, 0.09029693901538849, 0.0909636914730072, 0.09093369543552399], [0.09088820219039917, 0.09096821397542953, 0.09126583486795425, 0.09188622981309891, 0.09196712076663971, 0.09150708466768265, 0.09083233028650284, 0.09221022576093674, 0.08603684604167938, 0.09134126454591751, 0.09109656512737274], [0.09090667963027954, 0.09092610329389572, 0.09099824726581573, 0.09114805608987808, 0.09116753190755844, 0.09105659276247025, 0.09089311212301254, 0.0912259891629219, 0.08970391750335693, 0.0910165011882782, 0.09095723927021027], [0.09090621024370193, 0.09092835336923599, 0.09101058542728424, 0.09118138253688812, 0.09120359271764755, 0.09107710421085358, 0.09089074283838272, 0.09127025306224823, 0.08953655511140823, 0.09103140234947205, 0.09096384048461914]], [[0.09118980169296265, 0.09071975201368332, 0.09091874957084656, 0.09077140688896179, 0.09097051620483398, 0.09082309156656265, 0.09084893763065338, 0.0910482257604599, 0.09090067446231842, 0.0908563956618309, 0.09095242619514465], [0.09136566519737244, 0.09060147404670715, 0.0909247100353241, 0.09068533778190613, 0.09100886434316635, 0.09076926857233047, 0.09081126749515533, 0.09113524854183197, 0.09089531749486923, 0.09082337468862534, 0.09097945690155029], [0.09129106998443604, 0.09065161645412445, 0.09092219173908234, 0.09072183072566986, 0.09099261462688446, 0.09079209715127945, 0.09082725644111633, 0.091098353266716, 0.09089759737253189, 0.09083738178014755, 0.09096800535917282], [0.09134627878665924, 0.09061449766159058, 0.09092404693365097, 0.09069481492042542, 0.0910046398639679, 0.09077519923448563, 0.09081541746854782, 0.09112565219402313, 0.09089591354131699, 0.09082701057195663, 0.09097647666931152], [0.09127169847488403, 0.09066464006900787, 0.09092153608798981, 0.09073130786418915, 0.090988390147686, 0.0907980278134346, 0.09083139896392822, 0.09108876436948776, 0.09089818596839905, 0.09084101766347885, 0.09096502512693405], [0.09132689982652664, 0.090627521276474, 0.09092339873313904, 0.0907042920589447, 0.09100042283535004, 0.09078112989664078, 0.09081956744194031, 0.09111607074737549, 0.09089650213718414, 0.09083065390586853, 0.09097350388765335], [0.09131721407175064, 0.09063404053449631, 0.09092307835817337, 0.09070903807878494, 0.09099831432104111, 0.09078409522771835, 0.09082165360450745, 0.09111128747463226, 0.09089680016040802, 0.09083247184753418, 0.09097202122211456], [0.09124264866113663, 0.0906841903924942, 0.09092055261135101, 0.09074553102254868, 0.09098205715417862, 0.09080691635608673, 0.09083762764930725, 0.0910743921995163, 0.09089907258749008, 0.0908464789390564, 0.0909605622291565], [0.09129783511161804, 0.09064706414937973, 0.09092241525650024, 0.09071851521730423, 0.09099408239126205, 0.0907900258898735, 0.09082579612731934, 0.09110169857740402, 0.09089738875627518, 0.09083610773086548, 0.0909690409898758], [0.0913144201040268, 0.09063591063022614, 0.09092297405004501, 0.09071040153503418, 0.09099770337343216, 0.0907849445939064, 0.0908222496509552, 0.09110990166664124, 0.09089688956737518, 0.09083299338817596, 0.09097158908843994], [0.09127847105264664, 0.09066009521484375, 0.09092176705598831, 0.09072799980640411, 0.09098987281322479, 0.09079595655202866, 0.09082995355129242, 0.09109211713075638, 0.09089799225330353, 0.09083975851535797, 0.09096607565879822]], [[0.09075262397527695, 0.09052474796772003, 0.09037066996097565, 0.09057888388633728, 0.09086119383573532, 0.09070654958486557, 0.09073366224765778, 0.09094271063804626, 0.09271693229675293, 0.0909060388803482, 0.0909060388803482], [0.09070882946252823, 0.09041836112737656, 0.0902220755815506, 0.09048734605312347, 0.09084729850292206, 0.09065008908510208, 0.09068465977907181, 0.09095129370689392, 0.0932210385799408, 0.09090449661016464, 0.09090449661016464], [0.09067900478839874, 0.09034617990255356, 0.09012136608362198, 0.09042521566152573, 0.09083771705627441, 0.09061168134212494, 0.09065130352973938, 0.09095694124698639, 0.0935639888048172, 0.09090329706668854, 0.09090329706668854], [0.09071926772594452, 0.0904436707496643, 0.0902574211359024, 0.09050913155078888, 0.09085062891244888, 0.09066353738307953, 0.09069633483886719, 0.09094927459955215, 0.09310094267129898, 0.09090489149093628, 0.09090489149093628], [0.09077334403991699, 0.09057527780532837, 0.09044132381677628, 0.09062234312295914, 0.09086769074201584, 0.09073330461978912, 0.0907568708062172, 0.0909385234117508, 0.09247802942991257, 0.09090665727853775, 0.09090665727853775], [0.09074379503726959, 0.0905032753944397, 0.09034066647291183, 0.09056040644645691, 0.09085840731859207, 0.09069516509771347, 0.09072379022836685, 0.09094446897506714, 0.09281855076551437, 0.09090574830770493, 0.09090574830770493], [0.09074898064136505, 0.09051590412855148, 0.09035831689834595, 0.09057127684354782, 0.0908600389957428, 0.09070185571908951, 0.09072959423065186, 0.09094341844320297, 0.09275870770215988, 0.09090590476989746, 0.09090590476989746], [0.09078884869813919, 0.09061315655708313, 0.090494304895401, 0.0906549021601677, 0.09087252616882324, 0.09075333923101425, 0.09077424556016922, 0.09093533456325531, 0.0922992154955864, 0.09090708196163177, 0.09090708196163177], [0.09111446142196655, 0.09142394363880157, 0.09163423627614975, 0.091350257396698, 0.09096764028072357, 0.09117688238620758, 0.09114012867212296, 0.09085767716169357, 0.08852050453424454, 0.09090711921453476, 0.09090711921453476], [0.09078188240528107, 0.09059611707925797, 0.09047047793865204, 0.09064026176929474, 0.09087035804986954, 0.09074433147907257, 0.09076643735170364, 0.09093677252531052, 0.0923796072602272, 0.09090689569711685, 0.09090689569711685], [0.09078188240528107, 0.09059611707925797, 0.09047047793865204, 0.09064026176929474, 0.09087035804986954, 0.09074433147907257, 0.09076643735170364, 0.09093677252531052, 0.0923796072602272, 0.09090689569711685, 0.09090689569711685]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_return_max": 14.5, "env_reset_timer": 0.0005366889682088511, "episode_duration_sec_mean": 0.005210928416345268, "sample": 0.11621786258149942, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1870851236581287e-05, "batch_individual_items": 1.2286291773206718e-05, "add_time_dim_to_batch_and_zero_pad": 6.767833115029152e-06, "add_observations_from_episodes_to_batch": 2.8227021018484263e-06, "add_states_from_episodes_to_batch": 2.732079118730151e-06}}, "connector_pipeline_timer": 5.848009439470966e-05}, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1843114391606828e-05, "normalize_and_clip_actions": 7.863115906934755e-06, "get_actions": 3.611678622561048e-05, "listify_data_for_vector_env": 1.0327954972196586e-05, "un_batch_to_individual_items": 6.6253162702049005e-06, "tensor_to_numpy": 1.4824161540119418e-05}}, "connector_pipeline_timer": 0.00011373729421415677}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -0.75}, "episode_return_mean": -0.75, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "weights_seq_no": 13.0, "episode_len_max": 20, "episode_return_min": -13.5, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": -0.75}, "num_episodes_lifetime": 260, "episode_len_min": 20, "env_step_timer": 1.4028479684501394e-05, "num_env_steps_sampled_lifetime": 65400, "rlmodule_inference_timer": 3.09586562744975e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "time_between_sampling": 9.37430999907546}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "b19cd_00000", "date": "2025-08-11_18-41-56", "timestamp": 1754930516, "time_this_iter_s": 8.956614255905151, "time_total_s": 123.06767392158508, "pid": 11628, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1629fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 123.06767392158508, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 39.675000000000004, "ram_util_percent": 77.79166666666666}}
{"timers": {"training_iteration": 9.152261762254305, "restore_env_runners": 9.319724255442125e-06, "training_step": 9.152129581442045, "env_runner_sampling_timer": 1.6708779380558945, "learner_update_timer": 7.3075599430765426, "synch_weights": 0.0008505688417541024, "restore_eval_env_runners": 9.710675289347266e-06, "evaluation_iteration": 0.12654539574648177, "synch_eval_env_connectors": 0.0001782357287804489, "synch_env_connectors": 4.6031385232964625e-06}, "env_runners": {"env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "env_reset_timer": 3.786163477737718e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.845931750281159e-05, "listify_data_for_vector_env": 1.0300005963059688e-05, "tensor_to_numpy": 1.488518683121483e-05, "un_batch_to_individual_items": 6.567837832461048e-06, "remove_single_ts_time_rank_from_batch": 1.187132962460142e-05, "normalize_and_clip_actions": 7.859902398247697e-06}}, "connector_pipeline_timer": 0.00011607642256601617}, "episode_duration_sec_mean": 0.005546625677030535, "sample": 0.005796779146408053, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.6802833372620423e-06, "numpy_to_tensor": 1.2425882906673574e-05, "batch_individual_items": 1.2269458234905804e-05, "add_observations_from_episodes_to_batch": 2.755307289613971e-06, "add_time_dim_to_batch_and_zero_pad": 6.740028921667097e-06}}, "connector_pipeline_timer": 5.876087890768637e-05}, "agent_episode_returns_mean": {"default_agent": 4.100000000000001}, "time_between_sampling": 0.02995552214690973, "weights_seq_no": 13.0, "num_episodes_lifetime": -370000.0, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 4.100000000000001}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "episode_return_mean": 4.100000000000001, "episode_len_max": 20, "env_step_timer": 1.3828271758013842e-05, "num_env_steps_sampled_lifetime": -7400000.0, "episode_len_mean": 20.0, "rlmodule_inference_timer": 5.0428547513071744e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime_throughput": 3291.541588345265}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13524050116327663, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009028227810408252, "add_observations_from_episodes_to_batch": 0.0008814078954822882, "add_columns_from_episodes_to_train_batch": 0.041877388127160846, "add_time_dim_to_batch_and_zero_pad": 0.07545301824428427, "add_states_from_episodes_to_batch": 0.0035533544444010462, "batch_individual_items": 0.004236641147349269, "numpy_to_tensor": 6.413064409827717e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 71.0, "module_train_batch_size_mean": 997.5006590853257, "total_loss": 0.0, "weights_seq_no": 84.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 502740}, "default_policy": {"module_train_batch_size_mean": 997.5006590853257, "mean_kl_loss": 5.8959426496585365e-06, "weights_seq_no": 84.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 502740, "diff_num_grad_updates_vs_sampler_policy": 71.0, "use_intrinsic_rewards": 1.0, "entropy": 0.6754133105278015, "vf_loss_unclipped": 46.527103424072266, "vf_explained_var": 0.0037730932235717773, "policy_loss": -0.00013591315655503422, "total_loss": 0.2779824733734131, "vf_loss": 0.3583329916000366}, "__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1005480, "num_env_steps_trained_lifetime": 2772000, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 49877.54309128407}}}, "default_policy": {"curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.3583047688007355, "mean_kl_loss": 6.424269031413132e-06, "num_module_steps_trained_lifetime": 83790, "module_train_batch_size_mean": 997.7135120670981, "weights_seq_no": 14.0, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 16595, "use_intrinsic_rewards": 0.0, "entropy": 0.6753851771354675, "vf_loss_unclipped": 46.60994338989258, "vf_explained_var": 0.006364762783050537, "curr_kl_coeff": 9.862300430540927e-06, "policy_loss": -0.00014395859034266323, "total_loss": 0.27795153856277466, "num_module_steps_trained_lifetime_throughput": 790.2004069695063}, "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 997.7135120670981, "weights_seq_no": 14.0, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 83790, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 790.2094606199794}, "__all_modules__": {"num_env_steps_trained_lifetime": 462000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 33000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 167580, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4358.295311404091, "num_module_steps_trained_throughput": 22652217.09389181, "num_module_steps_trained_lifetime_throughput": 12805982.249888899}, "IntrinsicAttentionMask": [[[0.0912785455584526, 0.09056513756513596, 0.09100723266601562, 0.09085974097251892, 0.0908154845237732, 0.09091147780418396, 0.0906941145658493, 0.09113683551549911, 0.0909891352057457, 0.0909448117017746, 0.09079742431640625], [0.09163030236959457, 0.0902394950389862, 0.09110014885663986, 0.0908125713467598, 0.09072636812925339, 0.09091340005397797, 0.09049016237258911, 0.09135320782661438, 0.09106483310461044, 0.09097839146852493, 0.09069120138883591], [0.09141188114881516, 0.09044149518013, 0.09104251861572266, 0.09084188938140869, 0.09078170359134674, 0.09091224521398544, 0.09061672538518906, 0.09121891111135483, 0.09101788699626923, 0.09095759689807892, 0.09075715392827988], [0.09148458391427994, 0.0903741717338562, 0.09106171876192093, 0.09083212912082672, 0.09076327830553055, 0.09091264009475708, 0.09057456254959106, 0.09126362949609756, 0.09103353321552277, 0.09096452593803406, 0.09073518961668015], [0.09150643646717072, 0.09035396575927734, 0.09106748551130295, 0.09082920104265213, 0.09075774997472763, 0.09091275930404663, 0.0905618965625763, 0.09127707034349442, 0.09103823453187943, 0.0909666195511818, 0.09072859585285187], [0.09145906567573547, 0.09039779752492905, 0.09105498343706131, 0.0908355563879013, 0.09076974540948868, 0.09091250598430634, 0.09058935940265656, 0.09124793112277985, 0.09102804958820343, 0.09096210449934006, 0.09074290096759796], [0.09156642109155655, 0.09029848128557205, 0.09108330309391022, 0.09082114696502686, 0.09074254333972931, 0.0909130647778511, 0.09052713215351105, 0.09131394326686859, 0.0910511165857315, 0.09097231924533844, 0.09071047604084015], [0.09134812653064728, 0.0905006006360054, 0.09102565795183182, 0.09085043519735336, 0.09079786390066147, 0.09091189503669739, 0.09065372496843338, 0.09117967635393143, 0.0910041555762291, 0.09095149487257004, 0.09077641367912292], [0.09142079204320908, 0.09043323993682861, 0.09104486554861069, 0.09084068983793259, 0.09077944606542587, 0.09091229736804962, 0.09061155468225479, 0.09122438728809357, 0.09101980924606323, 0.09095844626426697, 0.09075445681810379], [0.09144263714551926, 0.09041301906108856, 0.0910506471991539, 0.09083776921033859, 0.09077391773462296, 0.09091242402791977, 0.09059889614582062, 0.09123783558607101, 0.09102451801300049, 0.0909605398774147, 0.09074787050485611], [0.09151534736156464, 0.09034570306539536, 0.09106983244419098, 0.09082799404859543, 0.09075547754764557, 0.09091280400753021, 0.09055672585964203, 0.09128254652023315, 0.09104014933109283, 0.09096745401620865, 0.09072589129209518]], [[0.0908433049917221, 0.09109809994697571, 0.09095854312181473, 0.09114713966846466, 0.09094112366437912, 0.0910319834947586, 0.09105648100376129, 0.09124527871608734, 0.0895589292049408, 0.09121216088533401, 0.09090693295001984], [0.0908685028553009, 0.09102663397789001, 0.09094004333019257, 0.09105704724788666, 0.09092922508716583, 0.09098561853170395, 0.09100081026554108, 0.09111789613962173, 0.09006883203983307, 0.09109736979007721, 0.0909080058336258], [0.09085474908351898, 0.09106578677892685, 0.09095020592212677, 0.09110639244318008, 0.09093578159809113, 0.09101103246212006, 0.09103132039308548, 0.09118764102458954, 0.08978939056396484, 0.09116022288799286, 0.09090745449066162], [0.09087330847978592, 0.0910128727555275, 0.09093644469976425, 0.09103970974683762, 0.09092690795660019, 0.09097667038440704, 0.0909900888800621, 0.09109340608119965, 0.0901670828461647, 0.09107528626918793, 0.09090817719697952], [0.09085302799940109, 0.09107067435979843, 0.09095146507024765, 0.09111254662275314, 0.0909365862607956, 0.09101420640945435, 0.09103512018918991, 0.09119635075330734, 0.08975453674793243, 0.09116807579994202, 0.09090737998485565], [0.09086200594902039, 0.09104518592357635, 0.09094487130641937, 0.09108041971921921, 0.09093234688043594, 0.09099766612052917, 0.0910152718424797, 0.0911509320139885, 0.08993640542030334, 0.09112714231014252, 0.0909077599644661], [0.09086441248655319, 0.09103831648826599, 0.09094307571649551, 0.09107176214456558, 0.09093119204044342, 0.09099320322275162, 0.09100991487503052, 0.09113869071006775, 0.0899854451417923, 0.09111610800027847, 0.09090784937143326], [0.09088288992643356, 0.09098532795906067, 0.09092923998832703, 0.09100501984357834, 0.09092222899198532, 0.09095875918865204, 0.09096860140562057, 0.09104441851377487, 0.09036387503147125, 0.09103112667798996, 0.090908482670784], [0.09071054309606552, 0.09145750850439072, 0.09104786813259125, 0.09160171449184418, 0.09099682420492172, 0.0912632867693901, 0.09133521467447281, 0.09189080446958542, 0.08700639009475708, 0.09179317951202393, 0.09089668840169907], [0.0908796638250351, 0.09099461883306503, 0.09093167632818222, 0.0910167247056961, 0.09092381596565247, 0.09096480160951614, 0.09097585827112198, 0.09106094390153885, 0.09029744565486908, 0.09104602038860321, 0.09090838581323624], [0.09084963798522949, 0.09108027070760727, 0.09095395356416702, 0.09112463891506195, 0.09093818068504333, 0.09102042764425278, 0.09104259312152863, 0.09121345728635788, 0.08968614786863327, 0.09118349105119705, 0.09090723842382431]], [[0.09130068868398666, 0.09058710932731628, 0.09078582376241684, 0.09063868969678879, 0.0908375158905983, 0.09069029986858368, 0.09095941483974457, 0.09115894138813019, 0.09101121127605438, 0.09121084958314896, 0.09081945568323135], [0.09167345613241196, 0.09028199315071106, 0.09066843241453171, 0.09038222581148148, 0.09076908975839615, 0.09048257023096085, 0.09100668877363205, 0.09139623492956161, 0.09110772609710693, 0.09149770438671112, 0.09073391556739807], [0.09156925231218338, 0.0903671458363533, 0.09070124477148056, 0.09045381844043732, 0.09078823775053024, 0.0905405730009079, 0.09099353104829788, 0.09132995456457138, 0.09108080714941025, 0.09141755104064941, 0.0907578393816948], [0.09164637327194214, 0.09030409902334213, 0.09067695587873459, 0.0904008150100708, 0.0907740667462349, 0.09049763530492783, 0.09100326895713806, 0.09137900918722153, 0.09110073000192642, 0.09147687256336212, 0.0907401293516159], [0.09154219925403595, 0.09038927406072617, 0.09070976823568344, 0.09047242254018784, 0.09079321473836899, 0.09055565297603607, 0.0909901112318039, 0.09131274372339249, 0.09107381850481033, 0.0913967415690422, 0.09076405316591263], [0.09161930531263351, 0.090326227247715, 0.09068548679351807, 0.09041941910982132, 0.09077904373407364, 0.0905127078294754, 0.09099985659122467, 0.09136179834604263, 0.09109374135732651, 0.09145605564117432, 0.09074635058641434], [0.09147848188877106, 0.09044142812490463, 0.09072984009981155, 0.09051626175642014, 0.09080491960048676, 0.09059116244316101, 0.09098204225301743, 0.09127219021320343, 0.09105733036994934, 0.09134771674871445, 0.09077868610620499], [0.09137442708015442, 0.09052665531635284, 0.09076260775327682, 0.09058789163827896, 0.09082400053739548, 0.09064917266368866, 0.09096882492303848, 0.09120592474937439, 0.09103035181760788, 0.09126762300729752, 0.09080255031585693], [0.09145144373178482, 0.0904635637998581, 0.09073835611343384, 0.09053487330675125, 0.0908098891377449, 0.09060623496770859, 0.09097861498594284, 0.09125497937202454, 0.09105032682418823, 0.09132690727710724, 0.09078488498926163], [0.09134741127490997, 0.0905488058924675, 0.09077111631631851, 0.09060650318861008, 0.09082895517349243, 0.09066424518823624, 0.0909653827548027, 0.09118872135877609, 0.09102334827184677, 0.0912468284368515, 0.09080874919891357], [0.09155164659023285, 0.09038154035806656, 0.09070679545402527, 0.09046591818332672, 0.0907914787530899, 0.09055037796497345, 0.0909913033246994, 0.09131874889135361, 0.09107625484466553, 0.0914040133357048, 0.09076187759637833]], [[0.09105876833200455, 0.09092345833778381, 0.09098314493894577, 0.0911070853471756, 0.0909717008471489, 0.09088008105754852, 0.09089615195989609, 0.09101996570825577, 0.09006063640117645, 0.09114979207515717, 0.09094921499490738], [0.09112834185361862, 0.09092986583709717, 0.09101740270853043, 0.09119924157857895, 0.09100060909986496, 0.09086626768112183, 0.0908898264169693, 0.09107141196727753, 0.08966752141714096, 0.09126193076372147, 0.09096764028072357], [0.0910976380109787, 0.09092704951763153, 0.09100230038166046, 0.09115856885910034, 0.09098786115646362, 0.0908723771572113, 0.09089263528585434, 0.0910487174987793, 0.08984081447124481, 0.0912124365568161, 0.09095951914787292], [0.0910339280962944, 0.09092113375663757, 0.09097089618444443, 0.09107419848442078, 0.09096135199069977, 0.0908849686384201, 0.09089836478233337, 0.09100158512592316, 0.090201236307621, 0.09110978990793228, 0.09094260632991791], [0.09110353142023087, 0.09092758595943451, 0.09100519865751266, 0.09116636961698532, 0.09099030494689941, 0.09087120741605759, 0.09089209139347076, 0.0910530686378479, 0.08980755507946014, 0.09122192859649658, 0.09096108376979828], [0.09115062654018402, 0.09093187749385834, 0.0910283550620079, 0.09122878313064575, 0.09100984036922455, 0.09086178988218307, 0.09088775515556335, 0.09108787775039673, 0.08954170346260071, 0.09129789471626282, 0.09097351133823395], [0.09114236384630203, 0.09093112498521805, 0.09102429449558258, 0.09121783822774887, 0.09100642055273056, 0.09086345136165619, 0.09088852256536484, 0.09108177572488785, 0.08958829939365387, 0.09128456562757492, 0.09097133576869965], [0.09107872098684311, 0.09092531353235245, 0.09099297970533371, 0.09113350510597229, 0.09098000079393387, 0.09087613224983215, 0.09089435636997223, 0.09103472530841827, 0.08994780480861664, 0.0911819338798523, 0.09095451235771179], [0.09157118201255798, 0.09096649289131165, 0.09123286604881287, 0.09178783744573593, 0.09118171781301498, 0.0907733142375946, 0.09084484726190567, 0.09139745682477951, 0.08718317747116089, 0.09197969734668732, 0.09108138829469681], [0.09101195633411407, 0.09091904759407043, 0.09096004068851471, 0.09104511886835098, 0.09095218032598495, 0.09088926017284393, 0.09090030193328857, 0.09098532050848007, 0.09032561630010605, 0.09107442945241928, 0.09093674272298813], [0.0911150872707367, 0.09092865139245987, 0.09101088345050812, 0.091181680560112, 0.09099511057138443, 0.09086890518665314, 0.0908910408616066, 0.09106161445379257, 0.08974228799343109, 0.09124056249856949, 0.09096413850784302]], [[0.09065789729356766, 0.09078479558229446, 0.09072624891996384, 0.090853251516819, 0.09111721813678741, 0.09059987962245941, 0.09095601737499237, 0.09122028946876526, 0.09102459996938705, 0.09128906577825546, 0.09077075123786926], [0.09068212658166885, 0.0907968059182167, 0.09074389934539795, 0.09085865318775177, 0.09109712392091751, 0.0906297042965889, 0.09095150232315063, 0.09119021892547607, 0.09101346135139465, 0.09125233441591263, 0.09078411012887955], [0.09067095071077347, 0.09079127013683319, 0.09073575586080551, 0.0908561572432518, 0.09110638499259949, 0.09061594307422638, 0.09095358103513718, 0.09120408445596695, 0.09101858735084534, 0.09126926958560944, 0.09077794849872589], [0.09069518744945526, 0.09080327302217484, 0.09075341373682022, 0.09086155891418457, 0.09108629077672958, 0.09064576774835587, 0.09094906598329544, 0.09117402136325836, 0.09100745618343353, 0.0912325456738472, 0.09079130738973618], [0.0907454863190651, 0.09082818031311035, 0.0907900333404541, 0.09087277948856354, 0.09104463458061218, 0.09070765972137451, 0.0909397080540657, 0.0911116898059845, 0.09098435193300247, 0.09115642309188843, 0.09081903100013733], [0.09064680337905884, 0.09077929705381393, 0.09071816504001617, 0.09085076302289963, 0.09112641215324402, 0.09058623015880585, 0.09095807373523712, 0.09123405069112778, 0.09102968871593475, 0.09130587428808212, 0.09076463431119919], [0.09071478992700577, 0.09081298857927322, 0.09076768904924393, 0.09086594730615616, 0.09107007086277008, 0.0906698927283287, 0.09094543009996414, 0.09114973247051239, 0.09099846333265305, 0.09120288491249084, 0.09080212563276291], [0.0907650738954544, 0.09083788096904755, 0.09080429375171661, 0.09087713062763214, 0.09102839231491089, 0.09073176980018616, 0.09093604236841202, 0.09108740091323853, 0.09097534418106079, 0.09112676233053207, 0.09082982689142227], [0.09072785079479218, 0.09081945568323135, 0.0907772034406662, 0.09086885303258896, 0.09105923771858215, 0.09068596363067627, 0.09094299376010895, 0.09113353490829468, 0.09099245816469193, 0.09118310362100601, 0.09080932289361954], [0.09077814221382141, 0.09084434807300568, 0.09081380814313889, 0.09088004380464554, 0.09101757407188416, 0.09074786305427551, 0.09093361347913742, 0.0910712257027626, 0.09096933901309967, 0.09110700339078903, 0.0908370241522789], [0.09067945182323456, 0.09079547971487045, 0.09074195474386215, 0.09085805714130402, 0.09109935164451599, 0.09062640368938446, 0.09095200896263123, 0.0911935493350029, 0.09101469814777374, 0.09125640243291855, 0.09078264236450195]], [[0.09084580838680267, 0.09087296575307846, 0.09046346694231033, 0.09067189693450928, 0.09095449000597, 0.09054463356733322, 0.09057170152664185, 0.09078036993741989, 0.09255142509937286, 0.0907437652349472, 0.09099937975406647], [0.0908479392528534, 0.09087421000003815, 0.09047809988260269, 0.09067972004413605, 0.09095306694507599, 0.09055662155151367, 0.09058280289173126, 0.09078464657068253, 0.09249716997146606, 0.09074923396110535, 0.09099648147821426], [0.0908154621720314, 0.090855173766613, 0.09025698900222778, 0.09056128561496735, 0.09097441285848618, 0.09037543833255768, 0.09041496366262436, 0.0907197967171669, 0.09332004934549332, 0.09066630154848099, 0.09104008972644806], [0.09083211421966553, 0.09086497873067856, 0.09036969393491745, 0.090621717274189, 0.09096363931894302, 0.09046781808137894, 0.09050055593252182, 0.09075294435024261, 0.09289996325969696, 0.0907086580991745, 0.09101797640323639], [0.09085430204868317, 0.09087790548801422, 0.09052199125289917, 0.09070316702127457, 0.09094873815774918, 0.09059254080057144, 0.09061607718467712, 0.09079743921756744, 0.0923345610499382, 0.09076562523841858, 0.09098773449659348], [0.09082197397947311, 0.09085901826620102, 0.09030091017484665, 0.09058485925197601, 0.0909702405333519, 0.09041145443916321, 0.09044832736253738, 0.09073273837566376, 0.09315615147352219, 0.09068281948566437, 0.09103149175643921], [0.09082412719726562, 0.0908602848649025, 0.0903155505657196, 0.09059270471334457, 0.09096883237361908, 0.09042344242334366, 0.090459443628788, 0.09073703736066818, 0.09310156852006912, 0.0906883254647255, 0.0910286158323288], [0.09084068238735199, 0.09086998552083969, 0.09042821824550629, 0.09065304696559906, 0.09095795452594757, 0.09051576256752014, 0.09054496139287949, 0.09077008068561554, 0.0926823541522026, 0.09073057770729065, 0.09100639075040817], [0.09097154438495636, 0.09094326198101044, 0.09137152880430222, 0.09115306288003922, 0.09085846692323685, 0.09128633141517639, 0.09125795215368271, 0.0910397619009018, 0.08922825753688812, 0.09107796102762222, 0.0908118486404419], [0.09083779156208038, 0.09086829423904419, 0.09040847420692444, 0.09064247459173203, 0.09095987677574158, 0.09049958735704422, 0.09052997827529907, 0.09076429903507233, 0.09275570511817932, 0.0907231867313385, 0.09101030230522156], [0.09085778146982193, 0.0908799096941948, 0.09054611623287201, 0.09071604907512665, 0.09094633907079697, 0.09061229228973389, 0.09063436836004257, 0.09080445766448975, 0.0922451913356781, 0.09077462553977966, 0.09098290652036667]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_return_max": 14.5, "env_reset_timer": 0.000532699158861113, "episode_duration_sec_mean": 0.005263039227575064, "sample": 0.11624406645623421, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2494475446445812e-05, "batch_individual_items": 1.2501105365448784e-05, "add_time_dim_to_batch_and_zero_pad": 7.126093668224501e-06, "add_observations_from_episodes_to_batch": 2.9649995661367542e-06, "add_states_from_episodes_to_batch": 2.7713078635306825e-06}}, "connector_pipeline_timer": 6.0434465411984584e-05}, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.221238484035602e-05, "normalize_and_clip_actions": 8.124273616360403e-06, "get_actions": 3.823283244537734e-05, "listify_data_for_vector_env": 1.0561058045251642e-05, "un_batch_to_individual_items": 6.705753591877715e-06, "tensor_to_numpy": 1.545015749872476e-05}}, "connector_pipeline_timer": 0.00011791419108218084}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -0.15}, "episode_return_mean": -0.15, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "weights_seq_no": 14.0, "episode_len_max": 20, "episode_return_min": -13.5, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": -0.15}, "num_episodes_lifetime": 280, "episode_len_min": 20, "env_step_timer": 1.4411942984074435e-05, "num_env_steps_sampled_lifetime": 70400, "rlmodule_inference_timer": 3.1548869670700915e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "time_between_sampling": 9.371107132414808}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "b19cd_00000", "date": "2025-08-11_18-42-06", "timestamp": 1754930526, "time_this_iter_s": 9.156782150268555, "time_total_s": 132.22445607185364, "pid": 11628, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1629fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 132.22445607185364, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 39.435714285714276, "ram_util_percent": 78.38571428571429}}
{"timers": {"training_iteration": 9.152803056711665, "restore_env_runners": 9.31319705583464e-06, "training_step": 9.152669908967166, "env_runner_sampling_timer": 1.6696602032653525, "learner_update_timer": 7.309214265725491, "synch_weights": 0.0008498069038025952, "restore_eval_env_runners": 1.0032317941524933e-05, "evaluation_iteration": 0.12654047136861168, "synch_eval_env_connectors": 0.00017820628239536806, "synch_env_connectors": 4.598356579046436e-06}, "env_runners": {"env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "env_reset_timer": 4.022665726472334e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.9352998617592656e-05, "listify_data_for_vector_env": 1.0519307702964507e-05, "tensor_to_numpy": 1.528130998382814e-05, "un_batch_to_individual_items": 6.695280014144591e-06, "remove_single_ts_time_rank_from_batch": 1.204294852516214e-05, "normalize_and_clip_actions": 7.997090050245001e-06}}, "connector_pipeline_timer": 0.00011838923045530711}, "episode_duration_sec_mean": 0.005301827167160807, "sample": 0.005796691248133697, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7286731938417897e-06, "numpy_to_tensor": 1.2578840360326603e-05, "batch_individual_items": 1.2498658075993295e-05, "add_observations_from_episodes_to_batch": 2.7957055563310696e-06, "add_time_dim_to_batch_and_zero_pad": 6.847329367780815e-06}}, "connector_pipeline_timer": 5.948726636412266e-05}, "agent_episode_returns_mean": {"default_agent": 2.740000000000001}, "time_between_sampling": 0.03073687260760615, "weights_seq_no": 14.0, "num_episodes_lifetime": -400875.0, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 2.740000000000001}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "episode_return_mean": 2.740000000000001, "episode_len_max": 20, "env_step_timer": 1.4059268123990553e-05, "num_env_steps_sampled_lifetime": -8017500.0, "episode_len_mean": 20.0, "rlmodule_inference_timer": 3.159765610299696e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime_throughput": 3259.0435728784505}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13522339448216691, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009025981362135085, "add_observations_from_episodes_to_batch": 0.0008809758966502937, "add_columns_from_episodes_to_train_batch": 0.04186617258670134, "add_time_dim_to_batch_and_zero_pad": 0.07544788556086257, "add_states_from_episodes_to_batch": 0.0035552042393248427, "batch_individual_items": 0.004237059315439663, "numpy_to_tensor": 6.416225663451027e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 76.0, "module_train_batch_size_mean": 997.4996962148737, "total_loss": 0.0, "weights_seq_no": 90.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 538650}, "default_policy": {"module_train_batch_size_mean": 997.4996962148737, "mean_kl_loss": 5.344571945897769e-06, "weights_seq_no": 90.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 538650, "diff_num_grad_updates_vs_sampler_policy": 76.0, "use_intrinsic_rewards": 1.0, "entropy": 0.6740736961364746, "vf_loss_unclipped": 44.85546875, "vf_explained_var": 0.0034612417221069336, "policy_loss": -2.8708711397484876e-05, "total_loss": 0.2781018018722534, "vf_loss": 0.35834598541259766}, "__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1077300, "num_env_steps_trained_lifetime": 2970000, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 49103.95201206667}}}, "default_policy": {"curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.3583051562309265, "mean_kl_loss": 5.447317107609706e-06, "num_module_steps_trained_lifetime": 89775, "module_train_batch_size_mean": 997.7008703380301, "weights_seq_no": 15.0, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 16595, "use_intrinsic_rewards": 0.0, "entropy": 0.6740680932998657, "vf_loss_unclipped": 45.00166320800781, "vf_explained_var": 0.0021178126335144043, "curr_kl_coeff": 4.931150215270463e-06, "policy_loss": -2.835146187862847e-05, "total_loss": 0.27806949615478516, "num_module_steps_trained_lifetime_throughput": 787.9179408178276}, "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 997.7008703380301, "weights_seq_no": 15.0, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 89775, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 787.9264742347503}, "__all_modules__": {"num_env_steps_trained_lifetime": 495000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 33000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 179550, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4345.659649895992, "num_module_steps_trained_throughput": 22121242.110240206, "num_module_steps_trained_lifetime_throughput": 12786960.7373455}, "IntrinsicAttentionMask": [[[0.09125632792711258, 0.0907859280705452, 0.09074170887470245, 0.09059464931488037, 0.09103688597679138, 0.0908893495798111, 0.09091521799564362, 0.0908709391951561, 0.0907236635684967, 0.09116653352975845, 0.09101878106594086], [0.09147390723228455, 0.09070881456136703, 0.09063701331615448, 0.0903984010219574, 0.09111668169498444, 0.09087681025266647, 0.09091885387897491, 0.09084688872098923, 0.09060772508382797, 0.09132766723632812, 0.0910872370004654], [0.09149443358182907, 0.09070153534412384, 0.09062713384628296, 0.09037990868091583, 0.09112419933080673, 0.09087561815977097, 0.09091918170452118, 0.09084460884332657, 0.09059678763151169, 0.09134285897016525, 0.09109368175268173], [0.09156280755996704, 0.09067731350660324, 0.09059427678585052, 0.09031838178634644, 0.0911492183804512, 0.0908716470003128, 0.09092028439044952, 0.0908370241522789, 0.09056039899587631, 0.09139346331357956, 0.09111513942480087], [0.09135764092206955, 0.09075000882148743, 0.09069293737411499, 0.09050319343805313, 0.09107407182455063, 0.0908835232257843, 0.09091692417860031, 0.09085974842309952, 0.090669646859169, 0.09124157577753067, 0.09105068445205688], [0.09142594039440155, 0.09072580188512802, 0.09066007286310196, 0.09044160693883896, 0.09109910577535629, 0.09087957441806793, 0.09091806411743164, 0.09085219353437424, 0.09063326567411423, 0.09129215031862259, 0.09107215702533722], [0.0914139524102211, 0.09073005616664886, 0.09066583961248398, 0.0904524102807045, 0.09109470993280411, 0.09088027477264404, 0.09091786295175552, 0.09085351973772049, 0.09063965082168579, 0.09128327667713165, 0.09106838703155518], [0.09143447875976562, 0.09072278439998627, 0.09065597504377365, 0.09043392539024353, 0.091102235019207, 0.09087909013032913, 0.09091820567846298, 0.09085125476121902, 0.0906287208199501, 0.09129847586154938, 0.09107484668493271], [0.09150281548500061, 0.09069856256246567, 0.09062311053276062, 0.09037236869335175, 0.09112726151943207, 0.09087512642145157, 0.09091932326555252, 0.09084367752075195, 0.09059232473373413, 0.09134906530380249, 0.09109631180763245], [0.09129774570465088, 0.09077124297618866, 0.09072176367044449, 0.09055723994970322, 0.0910520926117897, 0.09088696539402008, 0.09091592580080032, 0.09086636453866959, 0.09070158004760742, 0.09119721502065659, 0.09103182703256607], [0.09136601537466049, 0.09074704349040985, 0.09068891406059265, 0.09049563854932785, 0.09107714146375656, 0.0908830389380455, 0.09091707319021225, 0.0908588245511055, 0.09066519141197205, 0.09124778211116791, 0.0910533219575882]], [[0.09103119373321533, 0.09104728698730469, 0.09080438315868378, 0.09107949584722519, 0.09094414860010147, 0.09100385755300522, 0.09101995080709457, 0.09099239856004715, 0.09003335982561111, 0.09112218767404556, 0.09092167764902115], [0.09102445095777512, 0.09103965759277344, 0.09081020951271057, 0.09107007086277008, 0.09094223380088806, 0.09099863469600677, 0.0910138264298439, 0.09098781645298004, 0.09008171409368515, 0.09111039340496063, 0.09092100709676743], [0.09112616628408432, 0.09115488827228546, 0.09072194248437881, 0.09121234714984894, 0.09097094088792801, 0.09107740968465805, 0.0911061093211174, 0.09105698019266129, 0.08935375511646271, 0.09128855913877487, 0.09093089401721954], [0.09101095050573349, 0.09102436155080795, 0.09082185477018356, 0.09105120599269867, 0.09093838930130005, 0.0909881666302681, 0.09100157022476196, 0.09097861498594284, 0.0901784673333168, 0.09108678996562958, 0.09091965109109879], [0.09106767177581787, 0.09108860790729523, 0.0907728299498558, 0.09113048762083054, 0.0909544974565506, 0.09103212505578995, 0.09105304628610611, 0.0910172313451767, 0.08977220952510834, 0.0911860242486, 0.09092528373003006], [0.0910426527261734, 0.09106027334928513, 0.09079448878765106, 0.09109551459550858, 0.09094740450382233, 0.09101274609565735, 0.09103035181760788, 0.09100020676851273, 0.0899512991309166, 0.09114223718643188, 0.09092281758785248], [0.09103591740131378, 0.09105263650417328, 0.09080032259225845, 0.09108608961105347, 0.09094549715518951, 0.0910075232386589, 0.0910242348909378, 0.09099561721086502, 0.08999960869550705, 0.09113044291734695, 0.09092215448617935], [0.09104745835065842, 0.09106570482254028, 0.09079033136367798, 0.0911022201180458, 0.09094876796007156, 0.09101646393537521, 0.09103470295667648, 0.09100347757339478, 0.08991692960262299, 0.09115063399076462, 0.09092328697443008], [0.09144731611013412, 0.09151938557624817, 0.09043655544519424, 0.09166368097066879, 0.09105838090181351, 0.09132502973079681, 0.0913970023393631, 0.09127382934093475, 0.08706525713205338, 0.09185528010129929, 0.09095818549394608], [0.09099303930997849, 0.09100408852100372, 0.0908372700214386, 0.0910261943936348, 0.09093327075242996, 0.09097427129745483, 0.09098531305789948, 0.09096641093492508, 0.0903068408370018, 0.0910554975271225, 0.09091784060001373], [0.09107708185911179, 0.09109926968812943, 0.09076466411352158, 0.0911436453461647, 0.0909571498632431, 0.09103941172361374, 0.09106158465147018, 0.09102363139390945, 0.08970485627651215, 0.0912025049328804, 0.09092619270086288]], [[0.09068720042705536, 0.09049265086650848, 0.09075557440519333, 0.09088261425495148, 0.09114667028188705, 0.09095113724470139, 0.09098541736602783, 0.09092674404382706, 0.0910540223121643, 0.09099530428647995, 0.09112267196178436], [0.09065432846546173, 0.09043107181787491, 0.09073282033205032, 0.09087865799665451, 0.09118190407752991, 0.09095734357833862, 0.09099670499563217, 0.09092932939529419, 0.09107548743486404, 0.09100805222988129, 0.09115434437990189], [0.0906987339258194, 0.09051427245140076, 0.09076356142759323, 0.09088399261236191, 0.09113430231809616, 0.09094895422458649, 0.09098145365715027, 0.09092583507299423, 0.09104648232460022, 0.0909908190369606, 0.09111155569553375], [0.09072014689445496, 0.09055441617965698, 0.09077838808298111, 0.09088657051324844, 0.09111136198043823, 0.09094490855932236, 0.0909740999341011, 0.09092414379119873, 0.0910324975848198, 0.09098251163959503, 0.09109093993902206], [0.09076456725597382, 0.09063771367073059, 0.09080912917852402, 0.09089189022779465, 0.09106378257274628, 0.09093651175498962, 0.09095883369445801, 0.09092062711715698, 0.09100349247455597, 0.09096527099609375, 0.09104816615581512], [0.09073169529438019, 0.09057606011629105, 0.09078638255596161, 0.09088796377182007, 0.09109900891780853, 0.09094274044036865, 0.09097014367580414, 0.0909232422709465, 0.0910249724984169, 0.09097804129123688, 0.09107983857393265], [0.09073745459318161, 0.09058686345815659, 0.09079036116600037, 0.09088864177465439, 0.09109281748533249, 0.09094163775444031, 0.09096814692020416, 0.0909227728843689, 0.09102118760347366, 0.0909757912158966, 0.09107427299022675], [0.09072758257389069, 0.09056834131479263, 0.09078352898359299, 0.09088745713233948, 0.09110339730978012, 0.09094350785017014, 0.09097154438495636, 0.09092355519533157, 0.0910276398062706, 0.09097962081432343, 0.09108377993106842], [0.09074899554252625, 0.09060850739479065, 0.09079834818840027, 0.09089002758264542, 0.09108045697212219, 0.09093945473432541, 0.0909641832113266, 0.09092185646295547, 0.09101365506649017, 0.09097131341695786, 0.09106315672397614], [0.09073911607265472, 0.0905899852514267, 0.09079151600599289, 0.09088883548974991, 0.09109103679656982, 0.09094132483005524, 0.0909675732254982, 0.09092263877391815, 0.09102010726928711, 0.09097514301538467, 0.09107267111539841], [0.09076053649187088, 0.09063015878200531, 0.09080634266138077, 0.09089140594005585, 0.09106810390949249, 0.09093727916479111, 0.09096021950244904, 0.09092094749212265, 0.09100612252950668, 0.0909668356180191, 0.09105205535888672]], [[0.09088487178087234, 0.0911397859454155, 0.09100015461444855, 0.09118884056806564, 0.09121337532997131, 0.09107363224029541, 0.09109813719987869, 0.09105619043111801, 0.08937333524227142, 0.09102314710617065, 0.09094852209091187], [0.09089437127113342, 0.09105254709720612, 0.09096593409776688, 0.09108296781778336, 0.09109818190336227, 0.09101152420043945, 0.09102671593427658, 0.09100069850683212, 0.0899529829621315, 0.09098019450902939, 0.09093388170003891], [0.09088921546936035, 0.09110033512115479, 0.09098470956087112, 0.09114094823598862, 0.09116126596927643, 0.0910455584526062, 0.09106585383415222, 0.09103111922740936, 0.08963526785373688, 0.09100374579429626, 0.09094194322824478], [0.09089615195989609, 0.09103575348854065, 0.09095931053161621, 0.09106259793043137, 0.09107602387666702, 0.0909995436668396, 0.09101296216249466, 0.09098999947309494, 0.09006471931934357, 0.09097190201282501, 0.09093103557825089], [0.09089703857898712, 0.09102734923362732, 0.09095599502325058, 0.09105240553617477, 0.0910649374127388, 0.09099355340003967, 0.0910060703754425, 0.09098463505506516, 0.09012063592672348, 0.09096774458885193, 0.09092959016561508], [0.09089194983243942, 0.09107519686222076, 0.0909748375415802, 0.09111043810844421, 0.09112806618213654, 0.0910276547074318, 0.09104526787996292, 0.09101512283086777, 0.08980239927768707, 0.09099136292934418, 0.09093771874904633], [0.09089285135269165, 0.09106680750846863, 0.09097154438495636, 0.09110026061534882, 0.0911169946193695, 0.09102167934179306, 0.09103839844465256, 0.09100978076457977, 0.08985817432403564, 0.09098722785711288, 0.09093630313873291], [0.09089130163192749, 0.0910811573266983, 0.09097717702388763, 0.09111768007278442, 0.09113594144582748, 0.09103190153837204, 0.0910501554608345, 0.0910189151763916, 0.08976271003484726, 0.09099429845809937, 0.09093871712684631], [0.09081996977329254, 0.09165579080581665, 0.09119731932878494, 0.09181724488735199, 0.09189807623624802, 0.09143839031457901, 0.09151888638734818, 0.09138112515211105, 0.08597227185964584, 0.09127268940210342, 0.09102818369865417], [0.090890072286129, 0.09109246730804443, 0.090981625020504, 0.09113141149282455, 0.09115087985992432, 0.09103996306657791, 0.09105941653251648, 0.09102611243724823, 0.0896875411272049, 0.09099987149238586, 0.09094062447547913], [0.09088728576898575, 0.09111801534891129, 0.09099164605140686, 0.09116240590810776, 0.09118460863828659, 0.091058149933815, 0.09108033031225204, 0.09104236215353012, 0.08951792120933533, 0.09101244807243347, 0.09094490855932236]], [[0.09068699181079865, 0.09049244970083237, 0.0910777896642685, 0.09088240563869476, 0.09114645421504974, 0.0906289592385292, 0.0906631126999855, 0.09124956279993057, 0.09073147177696228, 0.09131836146116257, 0.09112246334552765], [0.09065404534339905, 0.09043078124523163, 0.09110274165868759, 0.09087837487459183, 0.09118161350488663, 0.09058743715286255, 0.09062664210796356, 0.09130005538463593, 0.09070510417222977, 0.09137909859418869, 0.09115404635667801], [0.09075292944908142, 0.09061596542596817, 0.09102778136730194, 0.09089040756225586, 0.09107603877782822, 0.09071208536624908, 0.09073612838983536, 0.0911484807729721, 0.0907842293381691, 0.09119680523872375, 0.09105917811393738], [0.09072000533342361, 0.09055426716804504, 0.09105276316404343, 0.0908864215016365, 0.0911112129688263, 0.09067057073116302, 0.09069966524839401, 0.09119895845651627, 0.09075789153575897, 0.0912575051188469, 0.09109079092741013], [0.09076447784900665, 0.09063762426376343, 0.09101900458335876, 0.09089180082082748, 0.09106369316577911, 0.09072665125131607, 0.09074891358613968, 0.09113076329231262, 0.09079346805810928, 0.09117550402879715, 0.09104807674884796], [0.0906771719455719, 0.09047406166791916, 0.09108522534370422, 0.09088120609521866, 0.09115694463253021, 0.09061657637357712, 0.09065224230289459, 0.09126461297273636, 0.09072361886501312, 0.09133646637201309, 0.09113188087940216], [0.09068296104669571, 0.09048488736152649, 0.09108085185289383, 0.09088191390037537, 0.09115077555179596, 0.0906238704919815, 0.09065864980220795, 0.09125575423240662, 0.09072823822498322, 0.09132581204175949, 0.09112634509801865], [0.0907818078994751, 0.09067012369632721, 0.0910058468580246, 0.09089388698339462, 0.09104517102241516, 0.09074850380420685, 0.09076810628175735, 0.09110419452190399, 0.09080733358860016, 0.09114356338977814, 0.09103143215179443], [0.09069450944662094, 0.09050652384757996, 0.09107208997011185, 0.09088332206010818, 0.09113842993974686, 0.09063843637704849, 0.09067144244909286, 0.09123802930116653, 0.0907374918460846, 0.09130449593067169, 0.09111525118350983], [0.09079336374998093, 0.09069179743528366, 0.09099707752466202, 0.09089528024196625, 0.09103283286094666, 0.09076307713985443, 0.09078090637922287, 0.0910864919424057, 0.09081657230854034, 0.09112227708101273, 0.09102034568786621], [0.09076044708490372, 0.09063006192445755, 0.0910220742225647, 0.09089131653308868, 0.09106800705194473, 0.09072156250476837, 0.09074444323778152, 0.09113695472478867, 0.09079024195671082, 0.09118294715881348, 0.09105195850133896]], [[0.09037038683891296, 0.09073912352323532, 0.09053708612918854, 0.09047648310661316, 0.09084565937519073, 0.09064339101314545, 0.09034568816423416, 0.0909523218870163, 0.09328117221593857, 0.0909043401479721, 0.0909043401479721], [0.09051122516393661, 0.09078406542539597, 0.09063461422920227, 0.09058976918458939, 0.09086284041404724, 0.0907132625579834, 0.09049294888973236, 0.09094168245792389, 0.092657171189785, 0.09090621024370193, 0.09090621024370193], [0.09043415635824203, 0.0907595157623291, 0.09058127552270889, 0.09052779525518417, 0.0908534973859787, 0.09067506343126297, 0.09041236340999603, 0.09094756841659546, 0.09299828857183456, 0.09090524911880493, 0.09090524911880493], [0.0904109999537468, 0.09075212478637695, 0.09056523442268372, 0.09050916880369186, 0.09085066616535187, 0.09066357463598251, 0.09038814902305603, 0.09094931185245514, 0.09310097992420197, 0.09090492874383926, 0.09090492874383926], [0.09055177122354507, 0.09079693257808685, 0.09066265821456909, 0.09062235802412033, 0.09086771309375763, 0.09073331952095032, 0.09053534269332886, 0.09093853831291199, 0.09247804433107376, 0.09090667217969894, 0.09090667217969894], [0.09047473222017288, 0.09077244997024536, 0.0906093642115593, 0.0905604287981987, 0.09085842221975327, 0.09069517999887466, 0.09045478701591492, 0.09094448387622833, 0.09281856566667557, 0.09090576320886612, 0.09090576320886612], [0.09036091715097427, 0.09073609113693237, 0.09053052961826324, 0.0904688760638237, 0.09084449708461761, 0.09063868969678879, 0.09033579379320145, 0.09095302224159241, 0.09332318603992462, 0.09090419858694077, 0.09090419858694077], [0.09059229493141174, 0.09080976992845535, 0.09069066494703293, 0.09065490961074829, 0.09087253361940384, 0.09075334668159485, 0.09057772159576416, 0.09093534201383591, 0.09229922294616699, 0.09090708941221237, 0.09090708941221237], [0.09146084636449814, 0.0910777673125267, 0.09128725528717041, 0.09135028719902039, 0.09096767008304596, 0.09117691963911057, 0.0914866104722023, 0.09085771441459656, 0.08852054178714752, 0.09090715646743774, 0.09090715646743774], [0.09057406336069107, 0.09080399572849274, 0.09067805856466293, 0.09064026176929474, 0.09087035804986954, 0.09074433147907257, 0.09055864810943604, 0.09093677252531052, 0.0923796072602272, 0.09090689569711685, 0.09090689569711685], [0.09057406336069107, 0.09080399572849274, 0.09067805856466293, 0.09064026176929474, 0.09087035804986954, 0.09074433147907257, 0.09055864810943604, 0.09093677252531052, 0.0923796072602272, 0.09090689569711685, 0.09090689569711685]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_return_max": 14.5, "env_reset_timer": 0.0005283392468132165, "episode_duration_sec_mean": 0.005265659193973989, "sample": 0.11620294954179339, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1694644987110123e-05, "batch_individual_items": 1.2239808989702567e-05, "add_time_dim_to_batch_and_zero_pad": 6.815226637693472e-06, "add_observations_from_episodes_to_batch": 2.7897528870075897e-06, "add_states_from_episodes_to_batch": 2.7096295581345496e-06}}, "connector_pipeline_timer": 5.829949151977194e-05}, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.178865786875328e-05, "normalize_and_clip_actions": 7.928310396373774e-06, "get_actions": 3.528309472861864e-05, "listify_data_for_vector_env": 1.0282323751605654e-05, "un_batch_to_individual_items": 6.64775910904696e-06, "tensor_to_numpy": 1.4667218893030504e-05}}, "connector_pipeline_timer": 0.00011271280744234061}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -0.35}, "episode_return_mean": -0.35, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "weights_seq_no": 15.0, "episode_len_max": 20, "episode_return_min": -13.5, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": -0.35}, "num_episodes_lifetime": 300, "episode_len_min": 20, "env_step_timer": 1.3666664710363604e-05, "num_env_steps_sampled_lifetime": 75400, "rlmodule_inference_timer": 3.0412413410867333e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "time_between_sampling": 9.369725886510826}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "b19cd_00000", "date": "2025-08-11_18-42-15", "timestamp": 1754930535, "time_this_iter_s": 9.3265860080719, "time_total_s": 141.55104207992554, "pid": 11628, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1629fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 141.55104207992554, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 41.369230769230775, "ram_util_percent": 79.0923076923077}}
{"timers": {"training_iteration": 9.151552138224332, "restore_env_runners": 9.281724460481929e-06, "training_step": 9.151418346127333, "env_runner_sampling_timer": 1.6682251487329665, "learner_update_timer": 7.308394183897218, "synch_weights": 0.0008492700851405255, "restore_eval_env_runners": 9.999083747925328e-06, "evaluation_iteration": 0.12644742040478751, "synch_eval_env_connectors": 0.0001775492199886469, "synch_env_connectors": 4.59362245423891e-06}, "env_runners": {"env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "env_reset_timer": 4.213783374471668e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.9180902146187324e-05, "listify_data_for_vector_env": 1.0462889131861428e-05, "tensor_to_numpy": 1.5045242227891539e-05, "un_batch_to_individual_items": 6.664711225206742e-06, "remove_single_ts_time_rank_from_batch": 1.2002671268933264e-05, "normalize_and_clip_actions": 7.944879789484008e-06}}, "connector_pipeline_timer": 0.00011768741735243512}, "episode_duration_sec_mean": 0.005245282845571639, "sample": 0.005713711915912653, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.709157131471599e-06, "numpy_to_tensor": 1.2564201820028726e-05, "batch_individual_items": 1.252498440336982e-05, "add_observations_from_episodes_to_batch": 2.767812388721438e-06, "add_time_dim_to_batch_and_zero_pad": 6.840622342551866e-06}}, "connector_pipeline_timer": 5.949890803082233e-05}, "agent_episode_returns_mean": {"default_agent": 2.8199999999999994}, "time_between_sampling": 0.03160243901657941, "weights_seq_no": 15.0, "num_episodes_lifetime": -431750.0, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 2.8199999999999994}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "episode_return_mean": 2.8199999999999994, "episode_len_max": 20, "env_step_timer": 1.4082411108774868e-05, "num_env_steps_sampled_lifetime": -8635000.0, "episode_len_mean": 20.0, "rlmodule_inference_timer": 3.136891919825178e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime_throughput": 3237.4865637963594}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13519866928701837, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00902310445835557, "add_observations_from_episodes_to_batch": 0.0008801782184817163, "add_columns_from_episodes_to_train_batch": 0.04185576336176326, "add_time_dim_to_batch_and_zero_pad": 0.0754388583756268, "add_states_from_episodes_to_batch": 0.003554548447512963, "batch_individual_items": 0.0042366620523657745, "numpy_to_tensor": 6.404979409276341e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 81.0, "module_train_batch_size_mean": 997.4990256591639, "total_loss": 0.0, "weights_seq_no": 96.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 574560}, "default_policy": {"module_train_batch_size_mean": 997.4990256591639, "mean_kl_loss": 1.2390824849717319e-05, "weights_seq_no": 96.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 574560, "diff_num_grad_updates_vs_sampler_policy": 81.0, "use_intrinsic_rewards": 1.0, "entropy": 0.673276960849762, "vf_loss_unclipped": 45.27120590209961, "vf_explained_var": 0.0034935474395751953, "policy_loss": -1.9619663362391293e-05, "total_loss": 0.2781091332435608, "vf_loss": 0.3583407402038574}, "__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1149120, "num_env_steps_trained_lifetime": 3168000, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 48366.344241347375}}}, "default_policy": {"curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.3583049774169922, "mean_kl_loss": 1.2359555512375664e-05, "num_module_steps_trained_lifetime": 95760, "module_train_batch_size_mean": 997.6889684010584, "weights_seq_no": 16.0, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 16595, "use_intrinsic_rewards": 0.0, "entropy": 0.6732784509658813, "vf_loss_unclipped": 45.40951156616211, "vf_explained_var": 0.003080606460571289, "curr_kl_coeff": 2.4655751076352317e-06, "policy_loss": -1.964177135960199e-05, "total_loss": 0.2780793011188507, "num_module_steps_trained_lifetime_throughput": 785.83207467959}, "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 997.6889684010584, "weights_seq_no": 16.0, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 95760, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 785.8401213830224}, "__all_modules__": {"num_env_steps_trained_lifetime": 528000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 33000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 191520, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4334.110379762599, "num_module_steps_trained_throughput": 21614319.163644046, "num_module_steps_trained_lifetime_throughput": 12762305.176458817}, "IntrinsicAttentionMask": [[[0.09065788984298706, 0.09046339988708496, 0.09072624146938324, 0.0908532440662384, 0.09111721068620682, 0.09092174470424652, 0.09095600992441177, 0.09089735150337219, 0.09102459251880646, 0.09128905832767487, 0.09109321981668472], [0.09062068164348602, 0.09039749950170517, 0.09069913625717163, 0.09084492921829224, 0.09114805608987808, 0.09092357754707336, 0.09096293151378632, 0.09089557826519012, 0.0910416767001152, 0.09134546667337418, 0.09112050384283066], [0.09067095071077347, 0.0904865488409996, 0.09073575586080551, 0.0908561572432518, 0.09110638499259949, 0.09092109650373459, 0.09095358103513718, 0.09089797735214233, 0.09101858735084534, 0.09126926958560944, 0.09108364582061768], [0.09069518744945526, 0.09052950143814087, 0.09075341373682022, 0.09086155891418457, 0.09108629077672958, 0.09091989696025848, 0.09094906598329544, 0.09089912474155426, 0.09100745618343353, 0.0912325456738472, 0.09106587618589401], [0.0907454863190651, 0.09061865508556366, 0.0907900333404541, 0.09087277948856354, 0.09104463458061218, 0.09091739356517792, 0.0909397080540657, 0.09090150892734528, 0.09098435193300247, 0.09115642309188843, 0.09102902561426163], [0.09070826321840286, 0.0905526652932167, 0.09076293557882309, 0.09086448699235916, 0.09107547998428345, 0.09091924875974655, 0.09094664454460144, 0.0908997505903244, 0.09100145846605301, 0.09121277183294296, 0.09105630964040756], [0.09071478992700577, 0.09056424349546432, 0.09076768904924393, 0.09086594730615616, 0.09107007086277008, 0.09091892838478088, 0.09094543009996414, 0.09090006351470947, 0.09099846333265305, 0.09120288491249084, 0.09105151891708374], [0.09070361405611038, 0.09054442495107651, 0.09075954556465149, 0.09086344391107559, 0.09107933193445206, 0.09091947972774506, 0.09094750881195068, 0.09089953452348709, 0.09100359678268433, 0.09121981263160706, 0.09105971455574036], [0.09072785079479218, 0.09058739989995956, 0.0907772034406662, 0.09086885303258896, 0.09105923771858215, 0.09091827273368835, 0.09094299376010895, 0.09090067446231842, 0.09099245816469193, 0.09118310362100601, 0.0910419449210167], [0.09077814221382141, 0.09067659825086594, 0.09081380814313889, 0.09088004380464554, 0.09101757407188416, 0.0909157544374466, 0.09093361347913742, 0.09090304374694824, 0.09096933901309967, 0.09110700339078903, 0.09100508689880371], [0.09074092656373978, 0.090610571205616, 0.09078671783208847, 0.09087176620960236, 0.09104842692613602, 0.09091762453317642, 0.09094056487083435, 0.09090130031108856, 0.0909864604473114, 0.09116333723068237, 0.09103237837553024]], [[0.09107238799333572, 0.09108848869800568, 0.09084546566009521, 0.09096921980381012, 0.09113682061433792, 0.09089367091655731, 0.09090974181890488, 0.09118517488241196, 0.08992435038089752, 0.09101185947656631, 0.09096281975507736], [0.09106335788965225, 0.09107857197523117, 0.09084903448820114, 0.09096591919660568, 0.09112421423196793, 0.09089455753564835, 0.09090974181890488, 0.09116988629102707, 0.08997868746519089, 0.09100619703531265, 0.09095987677574158], [0.09119947254657745, 0.09122821688652039, 0.09079492092132568, 0.09101544320583344, 0.09131448715925217, 0.09088078886270523, 0.0909094288945198, 0.09140084683895111, 0.08916085958480835, 0.09109148383140564, 0.09100403636693954], [0.09113018959760666, 0.09115202724933624, 0.09082258492708206, 0.09099029749631882, 0.09121758490800858, 0.0908878967165947, 0.0909096822142601, 0.09128318727016449, 0.08957673609256744, 0.09104811400175095, 0.0909816324710846], [0.09103626012802124, 0.09104878455400467, 0.09085967391729355, 0.09095598012208939, 0.09108638018369675, 0.09089718759059906, 0.0909096971154213, 0.09112399071455002, 0.09014185518026352, 0.09098916500806808, 0.09095100313425064], [0.09117250144481659, 0.09119854867458344, 0.09080573171377182, 0.09100567549467087, 0.09127674996852875, 0.09088359773159027, 0.09090956300497055, 0.09135501086711884, 0.08932271599769592, 0.0910746157169342, 0.09099533408880234], [0.09116349369287491, 0.09118864685297012, 0.09080932289361954, 0.09100240468978882, 0.09126415848731995, 0.0908845067024231, 0.09090959280729294, 0.09133972227573395, 0.08937671780586243, 0.09106897562742233, 0.09099242091178894], [0.09100913256406784, 0.09101898223161697, 0.09087029099464417, 0.0909460186958313, 0.09104853868484497, 0.09089978784322739, 0.09090963006019592, 0.09107809513807297, 0.09030529856681824, 0.09097211062908173, 0.09094210714101791], [0.09171303361654282, 0.09179377555847168, 0.09058137983083725, 0.09119712561368942, 0.0920364186167717, 0.09082082659006119, 0.09090077877044678, 0.09227970987558365, 0.08610168844461441, 0.0914100930094719, 0.0911652147769928], [0.09110630303621292, 0.09112577885389328, 0.09083206951618195, 0.09098160266876221, 0.09118419885635376, 0.0908903107047081, 0.09090973436832428, 0.09124267101287842, 0.08972033113241196, 0.09103314578533173, 0.0909738764166832], [0.09113378077745438, 0.09115597605705261, 0.09082116931676865, 0.09099160879850388, 0.0912225991487503, 0.09088754653930664, 0.0909096896648407, 0.09128927439451218, 0.08955521881580353, 0.09105037152767181, 0.09098280221223831]], [[0.09125629812479019, 0.09054306149482727, 0.09074167907238007, 0.09083759784698486, 0.09079334884881973, 0.09088931977748871, 0.09091518819332123, 0.09111461788415909, 0.09072363376617432, 0.09116650372743607, 0.09101875126361847], [0.09158669412136078, 0.09019654244184494, 0.09058262407779694, 0.09076935052871704, 0.09068318456411362, 0.09087012708187103, 0.09092055261135101, 0.09130973368883133, 0.09054751694202423, 0.09141110628843307, 0.09112255275249481], [0.09149434417486191, 0.09029322117567062, 0.09062705188989639, 0.09078844636678696, 0.0907139703631401, 0.0908755287528038, 0.09091909229755402, 0.09125524014234543, 0.09059669822454453, 0.09134276956319809, 0.09109359234571457], [0.09144984185695648, 0.09033984690904617, 0.09064846485853195, 0.09079764038324356, 0.09072881191968918, 0.09087811410427094, 0.09091837704181671, 0.09122896939516068, 0.09062041342258453, 0.09130983054637909, 0.09107962250709534], [0.09147036075592041, 0.09031834453344345, 0.09063858538866043, 0.09079339355230331, 0.0907219648361206, 0.09087691456079483, 0.09091870486736298, 0.09124108403921127, 0.09060947597026825, 0.09132502228021622, 0.09108605980873108], [0.09142587333917618, 0.09036499261856079, 0.09066000580787659, 0.09080259501934052, 0.09073680639266968, 0.09087950736284256, 0.09091799706220627, 0.09121482074260712, 0.09063319861888885, 0.09129208326339722, 0.09107208997011185], [0.09141389280557632, 0.0903775691986084, 0.0906657800078392, 0.0908050686120987, 0.09074080735445023, 0.09088020771741867, 0.09091780334711075, 0.09120775014162064, 0.09063959121704102, 0.09128321707248688, 0.091068334877491], [0.091321662068367, 0.09047437459230423, 0.09071019291877747, 0.09082411229610443, 0.09077155590057373, 0.09088554978370667, 0.09091629087924957, 0.09115326404571533, 0.09068877249956131, 0.09121491760015488, 0.09103933721780777], [0.09150272607803345, 0.09028444439172745, 0.09062302112579346, 0.09078671783208847, 0.09071118384599686, 0.0908750370144844, 0.09091923385858536, 0.09126018732786179, 0.09059223532676697, 0.09134897589683533, 0.09109622240066528], [0.0912977084517479, 0.09049953520298004, 0.0907217264175415, 0.09082905203104019, 0.09077953547239304, 0.0908869281411171, 0.09091588854789734, 0.09113910049200058, 0.09070154279470444, 0.0911971777677536, 0.09103178977966309], [0.09136596322059631, 0.09042785316705704, 0.09068886190652847, 0.09081496298313141, 0.09075678884983063, 0.09088298678398132, 0.09091702103614807, 0.09117943048477173, 0.09066513925790787, 0.09124772995710373, 0.09105326980352402]], [[0.09090612083673477, 0.09093058109283447, 0.09079127758741379, 0.09097952395677567, 0.0912347063422203, 0.09109492599964142, 0.0911194458603859, 0.09107748419046402, 0.08962085843086243, 0.09127523005008698, 0.09096978604793549], [0.09090626984834671, 0.09092984348535538, 0.0907956063747406, 0.0909770056605339, 0.0912228599190712, 0.0910881981253624, 0.09111180901527405, 0.09107138961553574, 0.08966750651597977, 0.09126190841197968, 0.09096761792898178], [0.09090541303157806, 0.09093406051397324, 0.09077092260122299, 0.09099138528108597, 0.09129034727811813, 0.09112657606601715, 0.09115529805421829, 0.09110613912343979, 0.08940199762582779, 0.09133784472942352, 0.09097998589277267], [0.0909065529704094, 0.0909283384680748, 0.09080424904823303, 0.0909719318151474, 0.09119916707277298, 0.09107470512390137, 0.09109653532505035, 0.09105917066335678, 0.08976084738969803, 0.09123525023460388, 0.09096325933933258], [0.09090783447027206, 0.0909203439950943, 0.09084907919168472, 0.09094537049531937, 0.09107575565576553, 0.09100436419248581, 0.09101688116788864, 0.09099544584751129, 0.09024814516305923, 0.09109644591808319, 0.09094039350748062], [0.09090716391801834, 0.09092475473880768, 0.09082456678152084, 0.09095994383096695, 0.09114332497119904, 0.0910428985953331, 0.09106051176786423, 0.09103035926818848, 0.08998110890388489, 0.09117243438959122, 0.09095294028520584], [0.09090729057788849, 0.0909239873290062, 0.09082887321710587, 0.0909573882818222, 0.09113147109746933, 0.09103614091873169, 0.09105286002159119, 0.0910242348909378, 0.09002790600061417, 0.09115909785032272, 0.09095074236392975], [0.09090707451105118, 0.09092529863119125, 0.09082149714231491, 0.090961754322052, 0.09115175902843475, 0.09104769676923752, 0.09106595069169998, 0.09103471040725708, 0.08994778990745544, 0.0911819189786911, 0.0909545049071312], [0.09089469909667969, 0.09096632897853851, 0.09055888652801514, 0.0911097601056099, 0.09186001121997833, 0.09144856035709381, 0.09152062982320786, 0.09139729291200638, 0.08718302100896835, 0.09197953343391418, 0.09108122438192368], [0.0909079983830452, 0.09091904014348984, 0.0908561497926712, 0.09094112366437912, 0.09105616807937622, 0.09099318087100983, 0.09100423008203506, 0.09098531305789948, 0.09032560884952545, 0.09107442200183868, 0.09093673527240753], [0.09090649336576462, 0.09092863649129868, 0.09080252796411514, 0.09097293764352798, 0.09120387583971024, 0.09107738733291626, 0.0910995677113533, 0.09106159955263138, 0.0897422730922699, 0.0912405475974083, 0.09096412360668182]], [[0.09123403578996658, 0.09052097797393799, 0.09096285700798035, 0.09057251363992691, 0.09101464599370956, 0.09086714684963226, 0.09064988791942596, 0.09109239280223846, 0.09094476699829102, 0.09114426374435425, 0.09099654853343964], [0.091543048620224, 0.09015356004238129, 0.09101339429616928, 0.09025365114212036, 0.09111444652080536, 0.09082682430744171, 0.09040399640798569, 0.0912662222981453, 0.09097812324762344, 0.09136754274368286, 0.09107913076877594], [0.09135120362043381, 0.09038146585226059, 0.09098208695650101, 0.09045147150754929, 0.09105255454778671, 0.09085190296173096, 0.09055657684803009, 0.09115836024284363, 0.09095747023820877, 0.09122896194458008, 0.09102792292833328], [0.09152062237262726, 0.09018018841743469, 0.09100975841283798, 0.09027677029371262, 0.09110722690820694, 0.0908297747373581, 0.09042184054851532, 0.0912536233663559, 0.09097573161125183, 0.09135136008262634, 0.0910731628537178], [0.09132879227399826, 0.09040813148021698, 0.09097840636968613, 0.09047461301088333, 0.0910453125834465, 0.09085482358932495, 0.09057442098855972, 0.09114574640989304, 0.09095504879951477, 0.09121276438236237, 0.09102193266153336], [0.09139266610145569, 0.09033217281103134, 0.0909888744354248, 0.09040869027376175, 0.09106595069169998, 0.09084650129079819, 0.09052359312772751, 0.0911816880106926, 0.09096196293830872, 0.0912589281797409, 0.0910390168428421], [0.09148696064949036, 0.09022011607885361, 0.09100425988435745, 0.0903114378452301, 0.09109637141227722, 0.09083417057991028, 0.09044857323169708, 0.0912347063422203, 0.09097210317850113, 0.09132704138755798, 0.09106417745351791], [0.09129518270492554, 0.09044814109802246, 0.090972900390625, 0.0905093252658844, 0.09103444218635559, 0.09085919708013535, 0.09060118347406387, 0.09112682938575745, 0.09095140546560287, 0.0911884754896164, 0.09101293981075287], [0.09135902673006058, 0.09037214517593384, 0.09098336100578308, 0.09044338017702103, 0.09105507284402847, 0.09085087478160858, 0.09055034071207047, 0.09116275608539581, 0.09095831215381622, 0.09123461693525314, 0.09103001654148102], [0.09127277135848999, 0.09047482162714005, 0.09096921235322952, 0.09053246676921844, 0.09102718532085419, 0.09086210280656815, 0.09061902016401291, 0.09111420810222626, 0.09094896912574768, 0.09117227047681808, 0.09100692719221115], [0.09133662283420563, 0.09039881080389023, 0.0909796953201294, 0.09046652913093567, 0.09104783833026886, 0.09085380285978317, 0.0905681848526001, 0.09115014970302582, 0.09095589816570282, 0.09121842682361603, 0.09102402627468109]], [[0.09040045738220215, 0.09076932072639465, 0.09023445844650269, 0.09050659835338593, 0.09087589383125305, 0.0906735509634018, 0.09037575125694275, 0.090982586145401, 0.09331221133470535, 0.09093458205461502, 0.09093458205461502], [0.09053350985050201, 0.09080641716718674, 0.09041061252355576, 0.09061206877231598, 0.0908852145075798, 0.09073559939861298, 0.09051522612571716, 0.09096407890319824, 0.09267998486757278, 0.0909285917878151, 0.0909285917878151], [0.09034030884504318, 0.09075242280960083, 0.09015491604804993, 0.09045886993408203, 0.09087153524160385, 0.09064541012048721, 0.09031271189451218, 0.09099079668521881, 0.09359881281852722, 0.09093713015317917, 0.09093713015317917], [0.0904388278722763, 0.09078005701303482, 0.09028523415327072, 0.09053702652454376, 0.09087863564491272, 0.090691477060318, 0.09041596949100494, 0.09097730368375778, 0.09312963485717773, 0.09093291312456131, 0.09093291312456131], [0.0905718207359314, 0.09081703424453735, 0.0904613584280014, 0.09064242243766785, 0.09088782966136932, 0.09075340628623962, 0.09055538475513458, 0.09095866978168488, 0.09249851852655411, 0.09092679619789124, 0.09092679619789124], [0.09049905836582184, 0.09079685062170029, 0.0903649628162384, 0.09058476984500885, 0.09088285267353058, 0.0907195582985878, 0.09047909826040268, 0.09096892923116684, 0.09284351766109467, 0.09093020111322403, 0.09093020111322403], [0.09039150923490524, 0.09076680988073349, 0.09022262692451477, 0.09049949795007706, 0.09087524563074112, 0.09066937118768692, 0.09036637842655182, 0.0909838154911995, 0.09335477650165558, 0.09093496948480606, 0.09093496948480606], [0.0906100869178772, 0.09082759916782379, 0.09051208943128586, 0.09067271649837494, 0.09089037775993347, 0.09077116847038269, 0.09059551358222961, 0.09095320105552673, 0.09231735020875931, 0.0909249410033226, 0.0909249410033226], [0.09142912924289703, 0.09104617685079575, 0.09160248935222626, 0.09131860733032227, 0.09093612432479858, 0.09114529937505722, 0.0914548859000206, 0.09082619845867157, 0.0884898453950882, 0.09087562561035156, 0.09087562561035156], [0.0905928760766983, 0.09082285314798355, 0.09048926830291748, 0.09065908938646317, 0.09088923037052155, 0.09076318144798279, 0.09057746082544327, 0.09095565974712372, 0.09239879250526428, 0.09092577546834946, 0.09092577546834946], [0.0905928760766983, 0.09082285314798355, 0.09048926830291748, 0.09065908938646317, 0.09088923037052155, 0.09076318144798279, 0.09057746082544327, 0.09095565974712372, 0.09239879250526428, 0.09092577546834946, 0.09092577546834946]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_return_max": 14.5, "env_reset_timer": 0.0005239433535359513, "episode_duration_sec_mean": 0.005223672912688926, "sample": 0.11615330587628608, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1532307664430125e-05, "batch_individual_items": 1.2111594327988136e-05, "add_time_dim_to_batch_and_zero_pad": 6.756001537570551e-06, "add_observations_from_episodes_to_batch": 2.7910991376926544e-06, "add_states_from_episodes_to_batch": 2.7050304309681455e-06}}, "connector_pipeline_timer": 5.7990320558029406e-05}, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1698877547132236e-05, "normalize_and_clip_actions": 7.803643996547326e-06, "get_actions": 3.524066185434947e-05, "listify_data_for_vector_env": 1.0244091775758074e-05, "un_batch_to_individual_items": 6.468627071599178e-06, "tensor_to_numpy": 1.4585330512843121e-05}}, "connector_pipeline_timer": 0.00011192996745026018}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -0.35}, "episode_return_mean": -0.35, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "weights_seq_no": 16.0, "episode_len_max": 20, "episode_return_min": -13.5, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": -0.35}, "num_episodes_lifetime": 320, "episode_len_min": 20, "env_step_timer": 1.365935791725973e-05, "num_env_steps_sampled_lifetime": 80400, "rlmodule_inference_timer": 3.0179300921833577e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "time_between_sampling": 9.366549472235638}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "b19cd_00000", "date": "2025-08-11_18-42-24", "timestamp": 1754930544, "time_this_iter_s": 9.147114992141724, "time_total_s": 150.69815707206726, "pid": 11628, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1629fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 150.69815707206726, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 39.353846153846156, "ram_util_percent": 78.60000000000001}}
{"timers": {"training_iteration": 9.153673382261594, "restore_env_runners": 9.248487413434915e-06, "training_step": 9.153538970164952, "env_runner_sampling_timer": 1.667318099325313, "learner_update_timer": 7.311247993717903, "synch_weights": 0.0008504032235914366, "restore_eval_env_runners": 9.972422921664859e-06, "evaluation_iteration": 0.12634675620102886, "synch_eval_env_connectors": 0.0001769883074678323, "synch_env_connectors": 4.592685408195504e-06}, "env_runners": {"env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "env_reset_timer": 3.975760736213615e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.1053186308562634e-05, "listify_data_for_vector_env": 1.0737943830485666e-05, "tensor_to_numpy": 1.550145360615107e-05, "un_batch_to_individual_items": 6.737422793218929e-06, "remove_single_ts_time_rank_from_batch": 1.2232225290037447e-05, "normalize_and_clip_actions": 8.24701617512929e-06}}, "connector_pipeline_timer": 0.00012155295567706631}, "episode_duration_sec_mean": 0.005414661166258153, "sample": 0.005618704836251306, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7460923073353408e-06, "numpy_to_tensor": 1.3109301227612711e-05, "batch_individual_items": 1.2730190922607715e-05, "add_observations_from_episodes_to_batch": 2.8121064766023966e-06, "add_time_dim_to_batch_and_zero_pad": 7.006040359692463e-06}}, "connector_pipeline_timer": 6.074164265767753e-05}, "agent_episode_returns_mean": {"default_agent": 3.5400000000000005}, "time_between_sampling": 0.031088119648125932, "weights_seq_no": 16.0, "num_episodes_lifetime": -462625.0, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 3.5400000000000005}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "episode_return_mean": 3.5400000000000005, "episode_len_max": 20, "env_step_timer": 1.4355900670623826e-05, "num_env_steps_sampled_lifetime": -9252500.0, "episode_len_mean": 20.0, "rlmodule_inference_timer": 3.21209094555459e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime_throughput": 3231.8175053083023}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13525237551423697, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009039558823327225, "add_observations_from_episodes_to_batch": 0.0008807235260960202, "add_columns_from_episodes_to_train_batch": 0.04186842405819552, "add_time_dim_to_batch_and_zero_pad": 0.07546162604125772, "add_states_from_episodes_to_batch": 0.0035562250439018454, "batch_individual_items": 0.00423631293105988, "numpy_to_tensor": 6.412679637654529e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 86.0, "module_train_batch_size_mean": 997.498558675304, "total_loss": 0.0, "weights_seq_no": 102.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 610470}, "default_policy": {"module_train_batch_size_mean": 997.498558675304, "mean_kl_loss": 3.060046583414078e-05, "weights_seq_no": 102.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 610470, "diff_num_grad_updates_vs_sampler_policy": 86.0, "use_intrinsic_rewards": 1.0, "entropy": 0.672258198261261, "vf_loss_unclipped": 46.45204162597656, "vf_explained_var": 0.003747880458831787, "policy_loss": -0.00022965965035837144, "total_loss": 0.27789467573165894, "vf_loss": 0.35832923650741577}, "__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1220940, "num_env_steps_trained_lifetime": 3366000, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 47654.955156318625}}}, "default_policy": {"curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.3583049476146698, "mean_kl_loss": 3.1661948014516383e-05, "num_module_steps_trained_lifetime": 101745, "module_train_batch_size_mean": 997.6777629636601, "weights_seq_no": 17.0, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 16595, "use_intrinsic_rewards": 0.0, "entropy": 0.6722310781478882, "vf_loss_unclipped": 46.569881439208984, "vf_explained_var": 0.0058609843254089355, "curr_kl_coeff": 1.2327875538176158e-06, "policy_loss": -0.00022906775120645761, "total_loss": 0.27787142992019653, "num_module_steps_trained_lifetime_throughput": 783.578258168123}, "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 997.6777629636601, "weights_seq_no": 17.0, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 101745, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 783.5858479824127}, "__all_modules__": {"num_env_steps_trained_lifetime": 561000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 33000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 203490, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4321.636924239449, "num_module_steps_trained_throughput": 21138239.545628063, "num_module_steps_trained_lifetime_throughput": 12743229.39296082}, "IntrinsicAttentionMask": [[[0.09068716317415237, 0.09081409871578217, 0.09075553715229034, 0.09088257700204849, 0.09082396328449249, 0.0909510999917984, 0.09066328406333923, 0.0912497341632843, 0.09105397760868073, 0.0913185328245163, 0.09080005437135696], [0.09070857614278793, 0.09082328528165817, 0.09077036380767822, 0.09088515490293503, 0.0908321961760521, 0.09094706177711487, 0.09068700671195984, 0.09121681749820709, 0.09104000777006149, 0.09127894788980484, 0.09081058949232101], [0.09069869667291641, 0.09081905335187912, 0.09076352417469025, 0.09088396281003952, 0.09082840383052826, 0.0909489244222641, 0.09067606925964355, 0.09123199433088303, 0.09104644507169724, 0.0912972018122673, 0.09080573171377182], [0.09072012454271317, 0.09082823246717453, 0.09077835828065872, 0.09088654071092606, 0.09083662927150726, 0.09094488620758057, 0.09069978445768356, 0.09119907766580582, 0.091032475233078, 0.09125762432813644, 0.09081626683473587], [0.09071023762226105, 0.09082399308681488, 0.09077151119709015, 0.09088534861803055, 0.09083282947540283, 0.0909467414021492, 0.09068883955478668, 0.09121425449848175, 0.09103891253471375, 0.09127587080001831, 0.09081140905618668], [0.0907316580414772, 0.09083317965269089, 0.09078634530305862, 0.09088792651891708, 0.09084106236696243, 0.09094270318746567, 0.09071256220340729, 0.09118134528398514, 0.09102493524551392, 0.09123630076646805, 0.09082194417715073], [0.09068313241004944, 0.09081237763166428, 0.0907527431845665, 0.09088209271430969, 0.09082241356372833, 0.09095185995101929, 0.09065882861614227, 0.09125593304634094, 0.09105661511421204, 0.09132599085569382, 0.09079807251691818], [0.09078186750411987, 0.09085468202829361, 0.09082109481096268, 0.0908939465880394, 0.09086034446954727, 0.09093322604894638, 0.09076816588640213, 0.09110425412654877, 0.09099217504262924, 0.09114362299442291, 0.09084662795066833], [0.09074897319078445, 0.09084060043096542, 0.09079833328723907, 0.09089000523090363, 0.09084771573543549, 0.09093943238258362, 0.09073173999786377, 0.09115475416183472, 0.09101364016532898, 0.09120433032512665, 0.09083046019077301], [0.09079340845346451, 0.09085962176322937, 0.09082908183336258, 0.09089532494544983, 0.09086477011442184, 0.09093104302883148, 0.09078095108270645, 0.09108653664588928, 0.09098463505506516, 0.09112232178449631, 0.0908522978425026], [0.09070620685815811, 0.0908222645521164, 0.0907687172293663, 0.09088486433029175, 0.09083127975463867, 0.09094750136137009, 0.09068437665700912, 0.09122045338153839, 0.09104154258966446, 0.09128332138061523, 0.0908094272017479]], [[0.09077578037977219, 0.09080292284488678, 0.09039374440908432, 0.09060200303792953, 0.09088438749313354, 0.09047483652830124, 0.09075682610273361, 0.09071039408445358, 0.09274059534072876, 0.09092923998832703, 0.09092923998832703], [0.09078022092580795, 0.09080646932125092, 0.09041066467761993, 0.09061212092638016, 0.09088526666164398, 0.09048911184072495, 0.09076188504695892, 0.09071698039770126, 0.09268003702163696, 0.09092865139245987, 0.09092865139245987], [0.09071283787488937, 0.0907525047659874, 0.0901549905538559, 0.0904589593410492, 0.09087160974740982, 0.09027332067489624, 0.09068512916564941, 0.09061728417873383, 0.09359889477491379, 0.09093721210956573, 0.09093721210956573], [0.09074728935956955, 0.09078012406826019, 0.0902853012084961, 0.09053709357976913, 0.0908786952495575, 0.09038333594799042, 0.09072435647249222, 0.0906681939959526, 0.0931297019124031, 0.09093297272920609, 0.09093297272920609], [0.09079348295927048, 0.09081706404685974, 0.09046138823032379, 0.09064244478940964, 0.09088785946369171, 0.09053190052509308, 0.09077700972557068, 0.09073665738105774, 0.0924985483288765, 0.09092682600021362, 0.09092682600021362], [0.09072630107402802, 0.09076330810785294, 0.09020578861236572, 0.09048943221569061, 0.09087441116571426, 0.09031621366739273, 0.09070045500993729, 0.09063715487718582, 0.09341581910848618, 0.0909356027841568, 0.0909356027841568], [0.09077268838882446, 0.0908004492521286, 0.0903819277882576, 0.09059493988752365, 0.0908837765455246, 0.09046486765146255, 0.09075329452753067, 0.09070581197738647, 0.09278293699026108, 0.09092965722084045, 0.09092965722084045], [0.0907650887966156, 0.09079436212778091, 0.09035296738147736, 0.09057760238647461, 0.09088226407766342, 0.09044043719768524, 0.09074463695287704, 0.09069453924894333, 0.09288673847913742, 0.09093066304922104, 0.09093066304922104], [0.09108297526836395, 0.09104625880718231, 0.09160257130861282, 0.09131868928670883, 0.09093620628118515, 0.09149184077978134, 0.09110863506793976, 0.09117153286933899, 0.08848992735147476, 0.09087571501731873, 0.09087571501731873], [0.09080076962709427, 0.09082288295030594, 0.09048929810523987, 0.09065911918878555, 0.09088926017284393, 0.09055543690919876, 0.09078531712293625, 0.09074747562408447, 0.09239882230758667, 0.09092580527067184, 0.09092580527067184], [0.09080076962709427, 0.09082288295030594, 0.09048929810523987, 0.09065911918878555, 0.09088926017284393, 0.09055543690919876, 0.09078531712293625, 0.09074747562408447, 0.09239882230758667, 0.09092580527067184, 0.09092580527067184]], [[0.09127853810787201, 0.09080802649259567, 0.09100722521543503, 0.09061669558286667, 0.09105904400348663, 0.09066829830408096, 0.09093734622001648, 0.09113682806491852, 0.09074573963880539, 0.090944804251194, 0.09079741686582565], [0.09151008725166321, 0.09074469655752182, 0.09106843173503876, 0.09043415635824203, 0.09115272015333176, 0.09051786363124847, 0.09095481783151627, 0.09127930551767349, 0.09064356237649918, 0.09096693992614746, 0.09072745591402054], [0.09141186624765396, 0.09077156335115433, 0.09104250371456146, 0.09051153063774109, 0.09111301600933075, 0.09058164060115814, 0.09094743430614471, 0.09121889621019363, 0.09068690240383148, 0.09095758199691772, 0.09075713902711868], [0.09160470962524414, 0.09071880578994751, 0.09109337627887726, 0.09035971760749817, 0.09119093418121338, 0.09045649319887161, 0.09096189588308334, 0.09133746474981308, 0.090601846575737, 0.09097592532634735, 0.09069887548685074], [0.0913863554596901, 0.09077853709459305, 0.09103575348854065, 0.09053163975477219, 0.09110269695520401, 0.0905982032418251, 0.09094550460577011, 0.09120319038629532, 0.09069814532995224, 0.09095513075590134, 0.0907648429274559], [0.09157915413379669, 0.09072578698396683, 0.09108663350343704, 0.09037978947162628, 0.09118060767650604, 0.09047304093837738, 0.09095998108386993, 0.09132175892591476, 0.09061309695243835, 0.09097348898649216, 0.09070658683776855], [0.09144628047943115, 0.09076213836669922, 0.09105158597230911, 0.09048439562320709, 0.0911269262433052, 0.09055927395820618, 0.09095001965761185, 0.0912400633096695, 0.09067170321941376, 0.09096085280179977, 0.09074673056602478], [0.09134811162948608, 0.09078900516033173, 0.09102564305067062, 0.09056179970502853, 0.0910872220993042, 0.09062306582927704, 0.0909426212310791, 0.09117966145277023, 0.09071503579616547, 0.09095147997140884, 0.09077639877796173], [0.0915408581495285, 0.0907362699508667, 0.09107654541730881, 0.09040994197130203, 0.09116514772176743, 0.09049789607524872, 0.09095712006092072, 0.09129821509122849, 0.09062998741865158, 0.09096986800432205, 0.09071816504001617], [0.09144260734319687, 0.0907631516456604, 0.09105061739683151, 0.09048730134963989, 0.09112544357776642, 0.09056166559457779, 0.09094974398612976, 0.09123780578374863, 0.09067332744598389, 0.09096051007509232, 0.09074784070253372], [0.09151532500982285, 0.09074325859546661, 0.09106981009244919, 0.09043002873659134, 0.09115483611822128, 0.09051445871591568, 0.0909552052617073, 0.09128252416849136, 0.09064124524593353, 0.09096743166446686, 0.0907258689403534]], [[0.09103122353553772, 0.09104731678962708, 0.09095562249422073, 0.0909281000494957, 0.09094417840242386, 0.0910038873553276, 0.09101998060941696, 0.09099242836236954, 0.0900333896279335, 0.09112221747636795, 0.09092170745134354], [0.0910244733095169, 0.09103967994451523, 0.09095306694507599, 0.09092706441879272, 0.09094225615262985, 0.09099865704774857, 0.0910138487815857, 0.09098783880472183, 0.09008173644542694, 0.09111041575670242, 0.09092102944850922], [0.09106289595365524, 0.09108319878578186, 0.0909675881266594, 0.09093289077281952, 0.09095316380262375, 0.09102842956781387, 0.0910487174987793, 0.09101399034261703, 0.08980655670166016, 0.09117764979600906, 0.09092482924461365], [0.09107443690299988, 0.09109626710414886, 0.0909719467163086, 0.0909346342086792, 0.0909564271569252, 0.09103737026453018, 0.09105919301509857, 0.09102184325456619, 0.08972404897212982, 0.09119784832000732, 0.09092596918344498], [0.09106770157814026, 0.09108863770961761, 0.09096941351890564, 0.09093362092971802, 0.09095452725887299, 0.09103215485811234, 0.0910530760884285, 0.09101726114749908, 0.08977224677801132, 0.0911860540509224, 0.09092531353235245], [0.09104267507791519, 0.09106029570102692, 0.09095995873212814, 0.09092983603477478, 0.09094742685556412, 0.09101276844739914, 0.09103037416934967, 0.09100022912025452, 0.08995132148265839, 0.09114225953817368, 0.09092283993959427], [0.09103593230247498, 0.09105265140533447, 0.0909574031829834, 0.090928815305233, 0.09094551205635071, 0.0910075381398201, 0.091024249792099, 0.09099563211202621, 0.08999962359666824, 0.09113045781850815, 0.09092216938734055], [0.09104748070240021, 0.09106572717428207, 0.0909617692232132, 0.09093056619167328, 0.09094879031181335, 0.091016486287117, 0.09103472530841827, 0.09100349992513657, 0.08991695195436478, 0.09115065634250641, 0.09092330932617188], [0.09144770354032516, 0.09151977300643921, 0.09110984951257706, 0.09098706394433975, 0.09105877578258514, 0.09132541716098785, 0.09139738976955414, 0.0912742167711258, 0.08706563711166382, 0.09185566753149033, 0.09095856547355652], [0.09099303930997849, 0.09100408852100372, 0.09094113111495972, 0.09092222899198532, 0.09093327075242996, 0.09097427129745483, 0.09098531305789948, 0.09096641093492508, 0.0903068408370018, 0.0910554975271225, 0.09091784060001373], [0.09107711166143417, 0.09109929949045181, 0.09097295254468918, 0.09093502908945084, 0.09095717966556549, 0.09103944152593613, 0.09106161445379257, 0.09102366119623184, 0.08970489352941513, 0.09120253473520279, 0.09092622250318527]], [[0.09123410284519196, 0.09052104502916336, 0.09096292406320572, 0.09081550687551498, 0.09101471304893494, 0.09062416106462479, 0.09089307487010956, 0.09109245985746384, 0.09094483405351639, 0.09090053290128708, 0.09099661558866501], [0.09154333919286728, 0.09015385061502457, 0.09101368486881256, 0.09072639048099518, 0.09111472964286804, 0.09035414457321167, 0.09087751805782318, 0.09126650542020798, 0.09097840636968613, 0.09089204668998718, 0.09107942134141922], [0.09135133773088455, 0.09038159251213074, 0.09098222106695175, 0.09078172594308853, 0.09105268865823746, 0.0905216634273529, 0.09088721126317978, 0.09115849435329437, 0.09095761179924011, 0.09089735150337219, 0.09102805703878403], [0.09141526371240616, 0.09030569344758987, 0.09099271893501282, 0.09076330810785294, 0.09107336401939392, 0.09046585112810135, 0.0908840000629425, 0.09119447320699692, 0.09096455574035645, 0.09089560061693192, 0.09104518592357635], [0.09132891893386841, 0.09040825814008713, 0.09097853302955627, 0.09078819304704666, 0.09104543924331665, 0.09054126590490341, 0.09088834375143051, 0.09114587306976318, 0.09095517545938492, 0.09089796990156174, 0.0910220593214035], [0.09149842709302902, 0.0902070552110672, 0.09100634604692459, 0.09073933213949203, 0.09110023081302643, 0.09039328992366791, 0.09087979793548584, 0.091241255402565, 0.09097356349229813, 0.09089329838752747, 0.09106741845607758], [0.09138160943984985, 0.09034565091133118, 0.0909871906042099, 0.09077300131320953, 0.09106248617172241, 0.09049522876739502, 0.0908856987953186, 0.09117553383111954, 0.09096090495586395, 0.09089653193950653, 0.09103617817163467], [0.0912952870130539, 0.09044825285673141, 0.09097300469875336, 0.09079788625240326, 0.09103454649448395, 0.09057065844535828, 0.09089003503322601, 0.0911269336938858, 0.09095150977373123, 0.09089888632297516, 0.09101304411888123], [0.09135917574167252, 0.09037228673696518, 0.09098351001739502, 0.09077946841716766, 0.09105522185564041, 0.09051481634378433, 0.09088682383298874, 0.09116290509700775, 0.09095846116542816, 0.09089714288711548, 0.09103016555309296], [0.09137837588787079, 0.09034948796033859, 0.09098666161298752, 0.09077394008636475, 0.09106143563985825, 0.09049805253744125, 0.09088585525751114, 0.09117371588945389, 0.0909605547785759, 0.0908966138958931, 0.09103530645370483], [0.09133674949407578, 0.09039894491434097, 0.09097982197999954, 0.0907859355211258, 0.09104796499013901, 0.09053441882133484, 0.09088794887065887, 0.09115027636289597, 0.09095602482557297, 0.09089775383472443, 0.09102415293455124]], [[0.09107238799333572, 0.09108848869800568, 0.09084546566009521, 0.09096921235322952, 0.09113682061433792, 0.09089367091655731, 0.09090974181890488, 0.09118517488241196, 0.08992435783147812, 0.09101185947656631, 0.09096281975507736], [0.09106335788965225, 0.09107857197523117, 0.09084903448820114, 0.09096591919660568, 0.09112421423196793, 0.09089455753564835, 0.09090974181890488, 0.09116988629102707, 0.08997869491577148, 0.09100619703531265, 0.09095987677574158], [0.09119947254657745, 0.09122821688652039, 0.09079492092132568, 0.09101544320583344, 0.09131448715925217, 0.09088078886270523, 0.0909094363451004, 0.09140084683895111, 0.08916087448596954, 0.09109148383140564, 0.09100403636693954], [0.09113018959760666, 0.09115202724933624, 0.09082258492708206, 0.09099029749631882, 0.09121758490800858, 0.0908878967165947, 0.0909096822142601, 0.09128318727016449, 0.08957674354314804, 0.09104811400175095, 0.0909816324710846], [0.09103626012802124, 0.09104878455400467, 0.09085967391729355, 0.09095598012208939, 0.09108638018369675, 0.09089718759059906, 0.0909096971154213, 0.09112399071455002, 0.09014186263084412, 0.09098916500806808, 0.09095100313425064], [0.09117250144481659, 0.09119854867458344, 0.09080573171377182, 0.09100567549467087, 0.09127674996852875, 0.09088359773159027, 0.09090956300497055, 0.09135501086711884, 0.08932272344827652, 0.0910746157169342, 0.09099533408880234], [0.09116349369287491, 0.09118864685297012, 0.09080932289361954, 0.09100240468978882, 0.09126415848731995, 0.0908845067024231, 0.09090959280729294, 0.09133972227573395, 0.08937672525644302, 0.09106897562742233, 0.09099242091178894], [0.09100913256406784, 0.09101898223161697, 0.09087029099464417, 0.0909460186958313, 0.09104853123426437, 0.09089979529380798, 0.09090963006019592, 0.09107809513807297, 0.09030529856681824, 0.09097211062908173, 0.09094210714101791], [0.09171302616596222, 0.09179376810789108, 0.09058137983083725, 0.09119711816310883, 0.0920364111661911, 0.09082082659006119, 0.09090077877044678, 0.09227970242500305, 0.0861017107963562, 0.0914100855588913, 0.0911652073264122], [0.09110630303621292, 0.09112577885389328, 0.09083206951618195, 0.09098160266876221, 0.09118419885635376, 0.0908903107047081, 0.09090973436832428, 0.09124267101287842, 0.08972033113241196, 0.09103314578533173, 0.0909738764166832], [0.09113378077745438, 0.09115597605705261, 0.09082116931676865, 0.09099160879850388, 0.0912225991487503, 0.09088754653930664, 0.0909096896648407, 0.09128927439451218, 0.08955521881580353, 0.09105037152767181, 0.09098280221223831]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_return_max": 14.5, "env_reset_timer": 0.0005204351695043832, "episode_duration_sec_mean": 0.005220025822054595, "sample": 0.11612102656749171, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2071908314324835e-05, "batch_individual_items": 1.2221148430112909e-05, "add_time_dim_to_batch_and_zero_pad": 6.814695754422682e-06, "add_observations_from_episodes_to_batch": 2.8425282567038292e-06, "add_states_from_episodes_to_batch": 2.7465915182520317e-06}}, "connector_pipeline_timer": 5.8646338575533916e-05}, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1878489033616168e-05, "normalize_and_clip_actions": 7.938064684309601e-06, "get_actions": 3.652517182385667e-05, "listify_data_for_vector_env": 1.0367933164560183e-05, "un_batch_to_individual_items": 6.7751720351235044e-06, "tensor_to_numpy": 1.4893394740018882e-05}}, "connector_pipeline_timer": 0.00011460696773665585}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -0.15}, "episode_return_mean": -0.15, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "weights_seq_no": 17.0, "episode_len_max": 20, "episode_return_min": -13.5, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": -0.15}, "num_episodes_lifetime": 340, "episode_len_min": 20, "env_step_timer": 1.4166478952423459e-05, "num_env_steps_sampled_lifetime": 85400, "rlmodule_inference_timer": 3.1839515296935816e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "time_between_sampling": 9.366771998763303}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "b19cd_00000", "date": "2025-08-11_18-42-34", "timestamp": 1754930554, "time_this_iter_s": 9.485668182373047, "time_total_s": 160.1838252544403, "pid": 11628, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1629fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 160.1838252544403, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 43.73076923076923, "ram_util_percent": 78.99230769230768}}
{"timers": {"training_iteration": 9.156609867189186, "restore_env_runners": 9.234752847903615e-06, "training_step": 9.156474501292639, "env_runner_sampling_timer": 1.6664633454114168, "learner_update_timer": 7.314967441280459, "synch_weights": 0.0008522558616010505, "restore_eval_env_runners": 1.0044789641938877e-05, "evaluation_iteration": 0.12627311780832548, "synch_eval_env_connectors": 0.00017650550404220005, "synch_env_connectors": 4.588428254408283e-06}, "env_runners": {"env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "env_reset_timer": 4.636243732322601e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.0716445992432345e-05, "listify_data_for_vector_env": 1.0820492136538447e-05, "tensor_to_numpy": 1.5486348494749663e-05, "un_batch_to_individual_items": 6.814432239338854e-06, "remove_single_ts_time_rank_from_batch": 1.2219601866861853e-05, "normalize_and_clip_actions": 8.208441184813612e-06}}, "connector_pipeline_timer": 0.0001212037791476328}, "episode_duration_sec_mean": 0.005411477325484158, "sample": 0.005899283903039897, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7882413228756944e-06, "numpy_to_tensor": 1.3152537283454529e-05, "batch_individual_items": 1.2821671869466515e-05, "add_observations_from_episodes_to_batch": 2.8506010812017436e-06, "add_time_dim_to_batch_and_zero_pad": 7.076444410899599e-06}}, "connector_pipeline_timer": 6.124133197895078e-05}, "agent_episode_returns_mean": {"default_agent": 3.38}, "time_between_sampling": 0.03214724995582702, "weights_seq_no": 17.0, "num_episodes_lifetime": -493500.0, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 3.38}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "episode_return_mean": 3.38, "episode_len_max": 20, "env_step_timer": 1.462986980179789e-05, "num_env_steps_sampled_lifetime": -9870000.0, "episode_len_mean": 20.0, "rlmodule_inference_timer": 3.234114325904712e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime_throughput": 3132.2026645993765}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1352371350989117, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009035586564870106, "add_observations_from_episodes_to_batch": 0.0008801650404898, "add_columns_from_episodes_to_train_batch": 0.04186400023739768, "add_time_dim_to_batch_and_zero_pad": 0.07545486603064509, "add_states_from_episodes_to_batch": 0.0035580602935903808, "batch_individual_items": 0.004235562711157568, "numpy_to_tensor": 6.403344876649048e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 91.0, "module_train_batch_size_mean": 997.4982334615715, "total_loss": 0.0, "weights_seq_no": 108.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 646380}, "default_policy": {"module_train_batch_size_mean": 997.4982334615715, "mean_kl_loss": 2.3274416889762506e-05, "weights_seq_no": 108.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 646380, "diff_num_grad_updates_vs_sampler_policy": 91.0, "use_intrinsic_rewards": 1.0, "entropy": 0.6703112125396729, "vf_loss_unclipped": 45.414154052734375, "vf_explained_var": 0.0035306215286254883, "policy_loss": -0.0005769212148152292, "total_loss": 0.277554988861084, "vf_loss": 0.3583366572856903}, "__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1292760, "num_env_steps_trained_lifetime": 3564000, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 46967.5606987448}}}, "default_policy": {"curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.3583051264286041, "mean_kl_loss": 2.5815294065978378e-05, "num_module_steps_trained_lifetime": 107730, "module_train_batch_size_mean": 997.6672132667843, "weights_seq_no": 18.0, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 16595, "use_intrinsic_rewards": 0.0, "entropy": 0.6702353358268738, "vf_loss_unclipped": 45.57191467285156, "vf_explained_var": 0.002916276454925537, "curr_kl_coeff": 6.163937769088079e-07, "policy_loss": -0.0006078463047742844, "total_loss": 0.2774958610534668, "num_module_steps_trained_lifetime_throughput": 780.9507673284503}, "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 997.6672132667843, "weights_seq_no": 18.0, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 107730, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 780.9579307010957}, "__all_modules__": {"num_env_steps_trained_lifetime": 594000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 33000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 215460, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4307.10459896051, "num_module_steps_trained_throughput": 20682355.72948892, "num_module_steps_trained_lifetime_throughput": 12730116.580807855}, "IntrinsicAttentionMask": [[[0.09127848595380783, 0.09056507796049118, 0.09100717306137085, 0.09061664342880249, 0.09081542491912842, 0.09091141819953918, 0.0909372940659523, 0.09113677591085434, 0.09074569493532181, 0.09118866920471191, 0.09079736471176147], [0.09163003414869308, 0.09023922681808472, 0.09109988063573837, 0.09033941477537155, 0.0907260999083519, 0.09091313183307648, 0.09096358716487885, 0.09135293960571289, 0.09059036523103714, 0.09145436435937881, 0.09069094061851501], [0.09141175448894501, 0.09044136852025986, 0.09104239195585251, 0.09051142632961273, 0.09078157693147659, 0.0909121185541153, 0.09094732254743576, 0.09121878445148468, 0.09068679064512253, 0.09128943085670471, 0.09075702726840973], [0.09160450100898743, 0.09026284515857697, 0.09109316766262054, 0.09035951644182205, 0.09073259681463242, 0.09091302007436752, 0.09096169471740723, 0.09133725613355637, 0.09060164541006088, 0.09143508225679398, 0.09069867432117462], [0.09150625020265579, 0.09035377949476242, 0.09106729924678802, 0.0904368981719017, 0.09075756371021271, 0.0909125804901123, 0.09095438569784164, 0.09127688407897949, 0.09064503014087677, 0.09136085212230682, 0.09072840958833694], [0.09145891666412354, 0.0903976559638977, 0.09105483442544937, 0.09047422558069229, 0.09076960384845734, 0.0909123569726944, 0.0909508615732193, 0.09124778211116791, 0.09066595137119293, 0.09132508188486099, 0.09074275940656662], [0.0914461612701416, 0.09040947258472443, 0.09105146676301956, 0.09048428386449814, 0.090772844851017, 0.09091229736804962, 0.0909499004483223, 0.09123994410037994, 0.0906715840101242, 0.09131544083356857, 0.09074661135673523], [0.09134802967309952, 0.09050050377845764, 0.09102556109428406, 0.09056172519922256, 0.09079776704311371, 0.09091179817914963, 0.09094253927469254, 0.09117957949638367, 0.0907149538397789, 0.091241255402565, 0.09077631682157516], [0.09154070168733597, 0.09032191336154938, 0.09107638895511627, 0.0904097855091095, 0.09074883162975311, 0.09091275185346603, 0.09095696359872818, 0.09129805862903595, 0.09062983840703964, 0.09138688445091248, 0.09071800857782364], [0.09132254123687744, 0.09052415192127228, 0.09101881831884384, 0.09058183431625366, 0.09080422669649124, 0.09091164916753769, 0.09094061702489853, 0.09116389602422714, 0.09072621166706085, 0.09122198075056076, 0.09078402072191238], [0.09151516854763031, 0.09034552425146103, 0.09106965363025665, 0.0904298722743988, 0.09075530618429184, 0.09091262519359589, 0.09095504879951477, 0.09128236770629883, 0.090641088783741, 0.09136758744716644, 0.09072571992874146]], [[0.09092679619789124, 0.09095125645399094, 0.09104213118553162, 0.09100021421909332, 0.09125544875860214, 0.09111564606428146, 0.09114016592502594, 0.09109819680452347, 0.0894145667552948, 0.09106513112783432, 0.09099047631025314], [0.09092618525028229, 0.09094976633787155, 0.0910373255610466, 0.09099692851305008, 0.09124284982681274, 0.09110815823078156, 0.0911317765712738, 0.0910913422703743, 0.08946861326694489, 0.09105948358774185, 0.09098754823207855], [0.09092393517494202, 0.09094420820474625, 0.09101946651935577, 0.09098474681377411, 0.09119608998298645, 0.09108034521341324, 0.09110064804553986, 0.0910658910870552, 0.08966951072216034, 0.09103851765394211, 0.09097668528556824], [0.09092497825622559, 0.09094677120447159, 0.09102770686149597, 0.09099037200212479, 0.09121765941381454, 0.09109317511320114, 0.09111500531435013, 0.09107763320207596, 0.08957681059837341, 0.09104818850755692, 0.09098170697689056], [0.09091845899820328, 0.09093097597360611, 0.09097743034362793, 0.09095600247383118, 0.09108640253543854, 0.09101499617099762, 0.09102752059698105, 0.0910060852766037, 0.09014188498258591, 0.09098918735980988, 0.09095102548599243], [0.09092207998037338, 0.09093967080116272, 0.09100499749183655, 0.09097486734390259, 0.09115827828645706, 0.09105783700942993, 0.09107545018196106, 0.09104529768228531, 0.08983217179775238, 0.09102153033018112, 0.09096787124872208], [0.09092145413160324, 0.09093815088272095, 0.09100016206502914, 0.09097155928611755, 0.09114566445350647, 0.09105031937360764, 0.09106704592704773, 0.09103842079639435, 0.08988644927740097, 0.09101585298776627, 0.0909649133682251], [0.0909225270152092, 0.09094075113534927, 0.09100843220949173, 0.09097721427679062, 0.09116724878549576, 0.09106317162513733, 0.09108143299818039, 0.0910501778125763, 0.08979355543851852, 0.09102556109428406, 0.09096995741128922], [0.09095758944749832, 0.09103766828775406, 0.09133552014827728, 0.09119803458452225, 0.09203733503818512, 0.09157694876194, 0.09165757149457932, 0.09151960164308548, 0.08610258251428604, 0.09141100198030472, 0.09116612374782562], [0.09092335402965546, 0.09094278514385223, 0.09101494401693344, 0.09098165482282639, 0.09118425846099854, 0.09107330441474915, 0.09109275788068771, 0.09105944633483887, 0.08972038328647614, 0.0910331979393959, 0.09097392857074738], [0.09092522412538528, 0.09094737470149994, 0.09102962911128998, 0.09099168330430984, 0.09122267365455627, 0.09109615534543991, 0.09111835062503815, 0.09108036756515503, 0.0895552933216095, 0.09105043858289719, 0.09098286926746368]], [[0.09068715572357178, 0.0904926061630249, 0.09107794612646103, 0.0908825695514679, 0.0908239558339119, 0.0909510925412178, 0.09098537266254425, 0.0912497267127037, 0.09073163568973541, 0.09099525213241577, 0.09112262725830078], [0.09065427631139755, 0.09043101221323013, 0.0911029726266861, 0.09087860584259033, 0.09081131219863892, 0.09095728397369385, 0.090996652841568, 0.09130028635263443, 0.09070533514022827, 0.09100799262523651, 0.09115428477525711], [0.09075301140546799, 0.09061605483293533, 0.09102786332368851, 0.09089048951864243, 0.09084926545619965, 0.09093867987394333, 0.09096278250217438, 0.09114856272935867, 0.09078431129455566, 0.09096972644329071, 0.09105926007032394], [0.09072012454271317, 0.0905543863773346, 0.09105288237333298, 0.09088654071092606, 0.09083662927150726, 0.09094488620758057, 0.09097407013177872, 0.09119907766580582, 0.09075800329446793, 0.09098248183727264, 0.09109091013669968], [0.09071023762226105, 0.09053586423397064, 0.09106039255857468, 0.09088534861803055, 0.09083282947540283, 0.0909467414021492, 0.09097745269536972, 0.09121425449848175, 0.09075010567903519, 0.09098630398511887, 0.09110041707754135], [0.0907316654920578, 0.09057602286338806, 0.0910440981388092, 0.09088792651891708, 0.09084106236696243, 0.09094271063804626, 0.09097010642290115, 0.09118134528398514, 0.09076723456382751, 0.09097800403833389, 0.09107980132102966], [0.09073743224143982, 0.0905868411064148, 0.09103970974683762, 0.0908886194229126, 0.09084328263998032, 0.09094161540269852, 0.09096812456846237, 0.0911724790930748, 0.09077185392379761, 0.09097576141357422, 0.09107424318790436], [0.09078186005353928, 0.09067017585039139, 0.09100589901208878, 0.0908939391374588, 0.09086033701896667, 0.09093321859836578, 0.09095286577939987, 0.09110424667596817, 0.09080737829208374, 0.09095852822065353, 0.09103148430585861], [0.09069466590881348, 0.09050668030977249, 0.09107223898172379, 0.09088347107172012, 0.0908268466591835, 0.09094967693090439, 0.09098279476165771, 0.09123818576335907, 0.09073764830827713, 0.09099234640598297, 0.09111540019512177], [0.09073910117149353, 0.0905899628996849, 0.09103844314813614, 0.09088882058858871, 0.09084392338991165, 0.09094130247831345, 0.0909675657749176, 0.09116993099451065, 0.09077318757772446, 0.09097512811422348, 0.09107264876365662], [0.09076052159070969, 0.09063013643026352, 0.09102214872837067, 0.09089139103889465, 0.09085214883089066, 0.09093725681304932, 0.09096019715070724, 0.09113702923059464, 0.09079031646251678, 0.09096681326627731, 0.09105203300714493]], [[0.09037043899297714, 0.0907391831278801, 0.09053715318441391, 0.09047654271125793, 0.09051194041967392, 0.09064345061779022, 0.09067891538143158, 0.09095238894224167, 0.09328122437000275, 0.09090439230203629, 0.09090439230203629], [0.090511254966259, 0.09078409522771835, 0.09063463658094406, 0.09058979153633118, 0.09061598777770996, 0.09071329236030579, 0.09073951840400696, 0.09094171226024628, 0.0926571935415268, 0.09090624004602432, 0.09090624004602432], [0.09043420851230621, 0.09075956791639328, 0.09058132022619247, 0.09052784740924835, 0.09055907279253006, 0.09067510813474655, 0.09070639312267303, 0.09094761312007904, 0.09299832582473755, 0.09090528637170792, 0.09090528637170792], [0.09041103720664978, 0.09075216203927994, 0.0905652716755867, 0.09050920605659485, 0.09054195880889893, 0.0906636118888855, 0.09069641679525375, 0.09094934910535812, 0.09310100972652435, 0.09090496599674225, 0.09090496599674225], [0.09042457491159439, 0.09075649082660675, 0.09057465195655823, 0.09052009880542755, 0.0905519649386406, 0.09067033231258392, 0.09070225059986115, 0.09094834327697754, 0.09304101765155792, 0.09090515971183777, 0.09090515971183777], [0.09047477692365646, 0.09077249467372894, 0.09060940146446228, 0.09056046605110168, 0.09058904647827148, 0.09069522470235825, 0.09072384983301163, 0.09094452112913132, 0.09281860291957855, 0.0909058079123497, 0.0909058079123497], [0.09048829227685928, 0.09077679365873337, 0.09061875939369202, 0.0905713364481926, 0.09059903770685196, 0.09070191532373428, 0.09072965383529663, 0.09094348549842834, 0.09275875985622406, 0.09090597182512283, 0.09090597182512283], [0.09059231728315353, 0.09080978482961655, 0.09069067984819412, 0.09065493196249008, 0.09067580848932266, 0.09075336158275604, 0.09077426791191101, 0.0909353643655777, 0.09229923784732819, 0.09090711176395416, 0.09090711176395416], [0.09146089851856232, 0.09107781946659088, 0.09128731489181519, 0.09135033935308456, 0.09131352603435516, 0.09117697179317474, 0.09114021807909012, 0.09085777401924133, 0.08852062374353409, 0.09090720862150192, 0.09090720862150192], [0.09057410061359406, 0.09080402553081512, 0.09067809581756592, 0.09064029902219772, 0.09066237509250641, 0.09074436873197556, 0.09076646715402603, 0.0909368097782135, 0.09237963706254959, 0.09090693295001984, 0.09090693295001984], [0.09057410061359406, 0.09080402553081512, 0.09067809581756592, 0.09064029902219772, 0.09066237509250641, 0.09074436873197556, 0.09076646715402603, 0.0909368097782135, 0.09237963706254959, 0.09090693295001984, 0.09090693295001984]], [[0.09068716317415237, 0.0904926210641861, 0.09107796102762222, 0.09088257700204849, 0.09114663302898407, 0.09062913060188293, 0.09098538011312485, 0.09092670679092407, 0.09105398505926132, 0.09099526703357697, 0.09112263470888138], [0.09065426141023636, 0.09043100476264954, 0.0911029577255249, 0.09087859839200974, 0.09118183702230453, 0.09058766067028046, 0.0909966453909874, 0.09092926234006882, 0.09107542037963867, 0.09100798517465591, 0.09115427732467651], [0.09075301140546799, 0.09061605483293533, 0.0910278707742691, 0.09089048951864243, 0.09107612818479538, 0.09071216732263565, 0.09096278250217438, 0.09092152863740921, 0.09101101011037827, 0.09096973389387131, 0.09105926752090454], [0.09072012454271317, 0.09055439382791519, 0.09105288982391357, 0.09088654816150665, 0.09111133962869644, 0.09067069739103317, 0.09097407758235931, 0.09092412143945694, 0.0910324826836586, 0.09098248928785324, 0.09109091758728027], [0.09076454490423203, 0.0906376913189888, 0.09101907163858414, 0.09089186787605286, 0.09106376022100449, 0.09072671085596085, 0.09095881134271622, 0.09092060476541519, 0.09100347012281418, 0.09096524864435196, 0.09104814380407333], [0.09067735821008682, 0.09047424793243408, 0.09108541160821915, 0.09088139235973358, 0.09115712344646454, 0.09061676263809204, 0.09098874032497406, 0.09092746675014496, 0.09106037020683289, 0.0909990519285202, 0.09113206714391708], [0.09073743224143982, 0.0905868411064148, 0.09103970974683762, 0.0908886194229126, 0.0910927951335907, 0.09069252014160156, 0.09096812456846237, 0.0909227505326271, 0.09102117270231247, 0.09097576886415482, 0.09107425063848495], [0.0907275527715683, 0.09056831151247025, 0.09104721993207932, 0.09088742733001709, 0.09110336750745773, 0.09068005532026291, 0.09097151458263397, 0.09092352539300919, 0.09102761745452881, 0.09097959101200104, 0.09108375012874603], [0.09074898064136505, 0.09060849249362946, 0.09103093296289444, 0.09089001268148422, 0.091080442070961, 0.09070707857608795, 0.0909641683101654, 0.09092184156179428, 0.09101364016532898, 0.09097129851579666, 0.09106314182281494], [0.09073909372091293, 0.0905899628996849, 0.09103844314813614, 0.09088882058858871, 0.09109101444482803, 0.0906946137547493, 0.09096755087375641, 0.09092261642217636, 0.09102008491754532, 0.09097512066364288, 0.09107264876365662], [0.09076052159070969, 0.09063014388084412, 0.09102215617895126, 0.09089139103889465, 0.0910680890083313, 0.09072164446115494, 0.09096021205186844, 0.09092093259096146, 0.09100610762834549, 0.09096682071685791, 0.09105204045772552]], [[0.09094773232936859, 0.09120282530784607, 0.09106310456991196, 0.09102117270231247, 0.09127646684646606, 0.09090618044137955, 0.09093064069747925, 0.0911191776394844, 0.0894351601600647, 0.09108610451221466, 0.09101143479347229], [0.09093336760997772, 0.09109161794185638, 0.09100496023893356, 0.0909789428114891, 0.09113726764917374, 0.09090758115053177, 0.0909227579832077, 0.0910397469997406, 0.08999157696962357, 0.09101922810077667, 0.090972900390625], [0.09094128012657166, 0.09115252643823624, 0.0910368338227272, 0.09100210666656494, 0.09121348708868027, 0.09090685844421387, 0.0909271240234375, 0.09108326584100723, 0.08968661725521088, 0.09105587750673294, 0.09099403768777847], [0.09094363451004028, 0.09117081016302109, 0.09104638546705246, 0.09100904315710068, 0.09123637527227402, 0.09090662747621536, 0.09092841297388077, 0.09109631925821304, 0.08959519118070602, 0.0910668671131134, 0.09100037068128586], [0.09092917293310165, 0.09105952829122543, 0.0909881517291069, 0.09096671640872955, 0.09109713137149811, 0.09090791642665863, 0.09092042595148087, 0.09101679921150208, 0.09015250205993652, 0.09099990874528885, 0.09096173942089081], [0.09095004200935364, 0.09122094511985779, 0.09107255190610886, 0.09102801978588104, 0.0912991613149643, 0.09090591222047806, 0.09093188494443893, 0.09113210439682007, 0.08934465795755386, 0.09109698235988617, 0.09101767838001251], [0.090948686003685, 0.09121028333902359, 0.09106699377298355, 0.0910239890217781, 0.09128580242395401, 0.0909060686826706, 0.09093115478754044, 0.09112449735403061, 0.08939792960882187, 0.09109057486057281, 0.09101400524377823], [0.09093811362981796, 0.09112807363271713, 0.09102404862642288, 0.09099281579256058, 0.0911828875541687, 0.09090715646743774, 0.09092538058757782, 0.09106579422950745, 0.08980895578861237, 0.09104117006063461, 0.09098555892705917], [0.09102623909711838, 0.0918639525771141, 0.09140444546937943, 0.09126685559749603, 0.09210678935050964, 0.09089027345180511, 0.09097029268741608, 0.09158866852521896, 0.08616756647825241, 0.09147997945547104, 0.09123492240905762], [0.09093998372554779, 0.09114249050617218, 0.09103158861398697, 0.09099829196929932, 0.09120093286037445, 0.09090698510408401, 0.0909264087677002, 0.09107609838247299, 0.08973679691553116, 0.09104984253644943, 0.0909905657172203], [0.09094417840242386, 0.09117504954338074, 0.09104859828948975, 0.09101064503192902, 0.09124168753623962, 0.09090656787157059, 0.09092870354652405, 0.09109935164451599, 0.08957396447658539, 0.09106942266225815, 0.09100183844566345]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_return_max": 14.5, "env_reset_timer": 0.0005166933178860803, "episode_duration_sec_mean": 0.0055619645735714585, "sample": 0.11656729672231496, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.8287361066974977e-05, "batch_individual_items": 1.6105647875085187e-05, "add_time_dim_to_batch_and_zero_pad": 9.656044264114792e-06, "add_observations_from_episodes_to_batch": 3.612280868325989e-06, "add_states_from_episodes_to_batch": 3.3704845264582547e-06}}, "connector_pipeline_timer": 7.825385006699128e-05}, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.7784194480604694e-05, "normalize_and_clip_actions": 9.786870700050194e-06, "get_actions": 6.37864003672617e-05, "listify_data_for_vector_env": 1.3836567639538377e-05, "un_batch_to_individual_items": 8.364717266863018e-06, "tensor_to_numpy": 2.0355302537057524e-05}}, "connector_pipeline_timer": 0.000167524558420707}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 0.65}, "episode_return_mean": 0.65, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "weights_seq_no": 18.0, "episode_len_max": 20, "episode_return_min": -13.5, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 0.65}, "num_episodes_lifetime": 360, "episode_len_min": 20, "env_step_timer": 2.1114242508864472e-05, "num_env_steps_sampled_lifetime": 90400, "rlmodule_inference_timer": 4.358970572458705e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "time_between_sampling": 9.367862230855778}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "b19cd_00000", "date": "2025-08-11_18-42-43", "timestamp": 1754930563, "time_this_iter_s": 9.620291709899902, "time_total_s": 169.8041169643402, "pid": 11628, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1629fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 169.8041169643402, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 43.364285714285714, "ram_util_percent": 79.72857142857141}}
{"timers": {"training_iteration": 9.162503963516878, "restore_env_runners": 9.253245511489222e-06, "training_step": 9.162366695448918, "env_runner_sampling_timer": 1.6665553269569153, "learner_update_timer": 7.320694190617261, "synch_weights": 0.0008588495519633419, "restore_eval_env_runners": 1.0171431949654072e-05, "evaluation_iteration": 0.12670561829982466, "synch_eval_env_connectors": 0.00017609710892452687, "synch_env_connectors": 4.588374355761028e-06}, "env_runners": {"env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "env_reset_timer": 4.910453716011216e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.315527915573748e-05, "listify_data_for_vector_env": 1.1299904598087697e-05, "tensor_to_numpy": 1.6156722952723168e-05, "un_batch_to_individual_items": 6.906329521761807e-06, "remove_single_ts_time_rank_from_batch": 1.2537256257410935e-05, "normalize_and_clip_actions": 8.399539732911792e-06}}, "connector_pipeline_timer": 0.0001261743354590631}, "episode_duration_sec_mean": 0.005706540018320082, "sample": 0.006161956972789816, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.9291109596330755e-06, "numpy_to_tensor": 1.417484537878986e-05, "batch_individual_items": 1.4161565806505444e-05, "add_observations_from_episodes_to_batch": 3.049668259618173e-06, "add_time_dim_to_batch_and_zero_pad": 7.636852834124275e-06}}, "connector_pipeline_timer": 6.540170028727055e-05}, "agent_episode_returns_mean": {"default_agent": 2.8199999999999994}, "time_between_sampling": 0.03285153592166452, "weights_seq_no": 18.0, "num_episodes_lifetime": -524375.0, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 2.8199999999999994}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "episode_return_mean": 2.8199999999999994, "episode_len_max": 20, "env_step_timer": 1.5505465541574716e-05, "num_env_steps_sampled_lifetime": -10487500.0, "episode_len_mean": 20.0, "rlmodule_inference_timer": 3.407301520687983e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime_throughput": 3121.6070864349526}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1352154891577116, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009034219448997441, "add_observations_from_episodes_to_batch": 0.0008796417208729183, "add_columns_from_episodes_to_train_batch": 0.041857465234437424, "add_time_dim_to_batch_and_zero_pad": 0.07544380445066494, "add_states_from_episodes_to_batch": 0.003557759271279251, "batch_individual_items": 0.004234092084535644, "numpy_to_tensor": 6.403394337257987e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 96.0, "module_train_batch_size_mean": 997.4980069784294, "total_loss": 0.0, "weights_seq_no": 114.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 682290}, "default_policy": {"module_train_batch_size_mean": 997.4980069784294, "mean_kl_loss": 6.993458100623684e-06, "weights_seq_no": 114.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 682290, "diff_num_grad_updates_vs_sampler_policy": 96.0, "use_intrinsic_rewards": 1.0, "entropy": 0.6690231561660767, "vf_loss_unclipped": 44.64577102661133, "vf_explained_var": 0.003431379795074463, "policy_loss": 5.093816798762418e-05, "total_loss": 0.27818605303764343, "vf_loss": 0.3583415746688843}, "__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1364580, "num_env_steps_trained_lifetime": 3762000, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 46292.889079816174}}}, "default_policy": {"curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.35830557346343994, "mean_kl_loss": 6.557648248417536e-06, "num_module_steps_trained_lifetime": 113715, "module_train_batch_size_mean": 997.6572809365935, "weights_seq_no": 19.0, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 16595, "use_intrinsic_rewards": 0.0, "entropy": 0.6690487265586853, "vf_loss_unclipped": 44.80961608886719, "vf_explained_var": 0.002072274684906006, "curr_kl_coeff": 3.0819688845440396e-07, "policy_loss": 4.858915417571552e-05, "total_loss": 0.2781544625759125, "num_module_steps_trained_lifetime_throughput": 778.022337732789}, "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 997.6572809365935, "weights_seq_no": 19.0, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 113715, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 778.0290905394156}, "__all_modules__": {"num_env_steps_trained_lifetime": 627000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 33000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 227430, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4290.915324035978, "num_module_steps_trained_throughput": 20239336.359888937, "num_module_steps_trained_lifetime_throughput": 12705247.260004276}, "IntrinsicAttentionMask": [[[0.09068725258111954, 0.09081419557332993, 0.09075562655925751, 0.09088266640901566, 0.09114672243595123, 0.09095118939876556, 0.090663380920887, 0.09092679619789124, 0.09105407446622849, 0.09099535644054413, 0.09112272411584854], [0.0907086655497551, 0.09082336723804474, 0.09077045321464539, 0.0908852368593216, 0.09112377464771271, 0.09094714373350143, 0.09068708121776581, 0.09092510491609573, 0.09104008972644806, 0.09098704159259796, 0.09110210090875626], [0.09069878607988358, 0.09081914275884628, 0.09076361358165741, 0.09088405221700668, 0.09113435447216034, 0.09094900637865067, 0.09067614376544952, 0.09092588722705841, 0.0910465344786644, 0.09099087119102478, 0.09111160784959793], [0.09072019159793854, 0.0908283069729805, 0.09077843278646469, 0.09088661521673203, 0.09111140668392181, 0.09094495326280594, 0.09069985896348953, 0.09092418849468231, 0.09103254973888397, 0.09098255634307861, 0.09109098464250565], [0.0907645896077156, 0.09084731340408325, 0.09080915153026581, 0.09089191257953644, 0.09106380492448807, 0.09093654155731201, 0.09074902534484863, 0.09092064946889877, 0.09100351482629776, 0.09096529334783554, 0.09104818850755692], [0.09073172509670258, 0.09083324670791626, 0.090786412358284, 0.09088799357414246, 0.09109903872013092, 0.09094277024269104, 0.09071262925863266, 0.09092327207326889, 0.09102500230073929, 0.09097807109355927, 0.09107986837625504], [0.0906832218170166, 0.09081246703863144, 0.09075284004211426, 0.09088218212127686, 0.09115104377269745, 0.09095195680856705, 0.09065891802310944, 0.0909271165728569, 0.0910567119717598, 0.09099692106246948, 0.09112661331892014], [0.09072761982679367, 0.09083148092031479, 0.09078356623649597, 0.09088749438524246, 0.0911034345626831, 0.09094354510307312, 0.09070807695388794, 0.09092359244823456, 0.09102768450975418, 0.09097965806722641, 0.0910838171839714], [0.09074903279542923, 0.0908406525850296, 0.09079838544130325, 0.0908900648355484, 0.09108049422502518, 0.09093949943780899, 0.09073179215192795, 0.09092189371585846, 0.09101369231939316, 0.09097135066986084, 0.09106319397687912], [0.0907391607761383, 0.09083643555641174, 0.09079156070947647, 0.09088888764381409, 0.0910910815000534, 0.09094136953353882, 0.09072086215019226, 0.09092268347740173, 0.09102015197277069, 0.09097518771886826, 0.09107271581888199], [0.09076055139303207, 0.09084557741880417, 0.09080635756254196, 0.09089142084121704, 0.09106811881065369, 0.0909372940659523, 0.09074456244707108, 0.09092096239328384, 0.09100613743066788, 0.0909668505191803, 0.09105207026004791]], [[0.09086426347494125, 0.09088871628046036, 0.09097952395677567, 0.09116816520690918, 0.09119269251823425, 0.09105298668146133, 0.09107748419046402, 0.09103555232286453, 0.08957959711551666, 0.09123320132493973, 0.09092789888381958], [0.09086592495441437, 0.09088948369026184, 0.09097699075937271, 0.09115874022245407, 0.09118238091468811, 0.09104777127504349, 0.09107137471437454, 0.09103097021579742, 0.0896277129650116, 0.0912214070558548, 0.09092725068330765], [0.09087210148572922, 0.09089235216379166, 0.0909675732254982, 0.0911237895488739, 0.09114409983158112, 0.09102841466665268, 0.0910487025976181, 0.09101397544145584, 0.08980654925107956, 0.09117763489484787, 0.09092481434345245], [0.09088478237390518, 0.09089817851781845, 0.09094793349504471, 0.09105120599269867, 0.09106462448835373, 0.0909881666302681, 0.09100157022476196, 0.09097861498594284, 0.0901784673333168, 0.09108678996562958, 0.09091965109109879], [0.0908864215016365, 0.09089893102645874, 0.09094537049531937, 0.09104177355766296, 0.09105429798364639, 0.09098292887210846, 0.09099544584751129, 0.09097401052713394, 0.09022688120603561, 0.09107498824596405, 0.09091897308826447], [0.09087706357240677, 0.09089464694261551, 0.09095994383096695, 0.09109552204608917, 0.0911131426692009, 0.09101275354623795, 0.09103035926818848, 0.09100021421909332, 0.08995131403207779, 0.09114224463701248, 0.09092282503843307], [0.09087871015071869, 0.0908954069018364, 0.0909573882818222, 0.09108608961105347, 0.09110282361507416, 0.0910075232386589, 0.0910242348909378, 0.09099561721086502, 0.08999961614608765, 0.09113044291734695, 0.09092215448617935], [0.09087588638067245, 0.09089410305023193, 0.090961754322052, 0.0911022275686264, 0.09112048894166946, 0.09101647138595581, 0.09103471040725708, 0.09100348502397537, 0.08991694450378418, 0.09115064144134521, 0.09092329442501068], [0.09077200293540955, 0.09084352850914001, 0.09110954403877258, 0.09166376292705536, 0.09173600375652313, 0.09132511168718338, 0.09139708429574966, 0.09127391874790192, 0.08706536889076233, 0.09185536205768585, 0.09095826745033264], [0.090889111161232, 0.09090015292167664, 0.09094113111495972, 0.0910261943936348, 0.09103724360466003, 0.09097427129745483, 0.09098531305789948, 0.09096641093492508, 0.0903068482875824, 0.0910554975271225, 0.09091784060001373], [0.09086859226226807, 0.09089072793722153, 0.09097293019294739, 0.0911436527967453, 0.09116585552692413, 0.09103941917419434, 0.09106159210205078, 0.09102363884449005, 0.08970487117767334, 0.091202512383461, 0.09092620015144348]], [[0.09121192991733551, 0.09074176102876663, 0.09094081819057465, 0.0907934308052063, 0.09074920415878296, 0.09060212969779968, 0.09087098389863968, 0.09107032418251038, 0.09092273563146591, 0.09112217277288437, 0.09097450226545334], [0.09140162169933319, 0.09063713997602463, 0.09096048772335052, 0.0907210260629654, 0.09064921736717224, 0.09041057527065277, 0.09084700793027878, 0.09117111563682556, 0.09093109518289566, 0.09125549346208572, 0.09101525694131851], [0.09132115542888641, 0.09068149328231812, 0.09095215797424316, 0.09075172990560532, 0.09069160372018814, 0.09049175679683685, 0.09085718542337418, 0.09112837165594101, 0.09092756360769272, 0.09119895845651627, 0.09099798649549484], [0.09138071537017822, 0.09064865857362747, 0.09095832705497742, 0.0907290056347847, 0.0906602293252945, 0.09043166041374207, 0.09084965288639069, 0.09116000682115555, 0.09093017876148224, 0.09124080836772919, 0.09101077169179916], [0.09139860421419144, 0.09063879400491714, 0.09096017479896545, 0.09072216600179672, 0.09065079689025879, 0.09041360765695572, 0.09084738790988922, 0.09116950631141663, 0.09093095362186432, 0.0912533774971962, 0.09101460874080658], [0.09145819395780563, 0.0906059518456459, 0.09096632897853851, 0.09069943428039551, 0.09061941504478455, 0.09035354107618332, 0.09083984047174454, 0.09120113402605057, 0.09093356132507324, 0.09129523485898972, 0.09102737903594971], [0.09134935587644577, 0.09066594392061234, 0.09095507860183716, 0.09074096381664276, 0.09067674726247787, 0.09046328812837601, 0.09085361659526825, 0.09114335477352142, 0.09092880040407181, 0.09121876955032349, 0.09100404381752014], [0.09126893430948257, 0.09071031212806702, 0.0909467414021492, 0.09077167510986328, 0.09071914851665497, 0.09054451435804367, 0.09086379408836365, 0.09110063314437866, 0.09092526137828827, 0.09116225689649582, 0.09098677337169647], [0.0913284569978714, 0.09067746996879578, 0.09095291048288345, 0.09074894338846207, 0.09068775922060013, 0.0904843807220459, 0.09085626155138016, 0.091132253408432, 0.09092787653207779, 0.09120408445596695, 0.0909995511174202], [0.0912480428814888, 0.09072183072566986, 0.0909445658326149, 0.09077963978052139, 0.09073015302419662, 0.09056562185287476, 0.09086643159389496, 0.09108952432870865, 0.09092433005571365, 0.09114756435155869, 0.09098227322101593], [0.09130756556987762, 0.09068899601697922, 0.09095075726509094, 0.09075692296028137, 0.09069877862930298, 0.09050548821687698, 0.09085890650749207, 0.09112115204334259, 0.09092696756124496, 0.09118940681219101, 0.09099507331848145]], [[0.09105861932039261, 0.09107472002506256, 0.09083174169063568, 0.0909554660320282, 0.09112304449081421, 0.0910312756896019, 0.09104736894369125, 0.09101981669664383, 0.08991076797246933, 0.0909980982542038, 0.09094907343387604], [0.09105036407709122, 0.09106556326150894, 0.0908360555768013, 0.09095293283462524, 0.0911112055182457, 0.09102453291416168, 0.0910397320985794, 0.09101370722055435, 0.08996584266424179, 0.09099320322275162, 0.09094688296318054], [0.09117492288351059, 0.09120365232229233, 0.09077048301696777, 0.09099093824625015, 0.09128990769386292, 0.09112613648176193, 0.09115485101938248, 0.09110569953918457, 0.08913686871528625, 0.09106696397066116, 0.09097953885793686], [0.09111153334379196, 0.09113336354494095, 0.09080398082733154, 0.09097166359424591, 0.09119890630245209, 0.09107444435358047, 0.09109627455472946, 0.09105890989303589, 0.08955840021371841, 0.09102947264909744, 0.09096299856901169], [0.09102555364370346, 0.09103807061910629, 0.09084898978471756, 0.0909452810883522, 0.09107566624879837, 0.09100426733493805, 0.09101679176092148, 0.09099535644054413, 0.0901312604546547, 0.0909784659743309, 0.09094030410051346], [0.09107264876365662, 0.09109027683734894, 0.09082439541816711, 0.09095977246761322, 0.0911431536078453, 0.09104272723197937, 0.0910603404045105, 0.09103018790483475, 0.08981727063655853, 0.09100642800331116, 0.09095277637243271], [0.09106439352035522, 0.09108112752437592, 0.09082872420549393, 0.09095723927021027, 0.09113132208585739, 0.09103599190711975, 0.09105271100997925, 0.09102409332990646, 0.08987230807542801, 0.09100153297185898, 0.09095060080289841], [0.09107852727174759, 0.09109678864479065, 0.09082131832838058, 0.09096157550811768, 0.09115158021450043, 0.09104751795530319, 0.09106577932834625, 0.09103453159332275, 0.0897781178355217, 0.09100991487503052, 0.09095431864261627], [0.0916442796587944, 0.09172496199607849, 0.09051348268985748, 0.09112875908613205, 0.09196742624044418, 0.09150739759206772, 0.09158795326948166, 0.09145008772611618, 0.08603719621896744, 0.09134156256914139, 0.09109687805175781], [0.09108966588973999, 0.09110913425683975, 0.0908154845237732, 0.09096498787403107, 0.09116755425930023, 0.09105662256479263, 0.0910760760307312, 0.09104276448488235, 0.08970395475625992, 0.09101652354001999, 0.09095726162195206], [0.09111481159925461, 0.09113700687885284, 0.09080226719379425, 0.0909726694226265, 0.09120361506938934, 0.09107712656259537, 0.091099314391613, 0.09106133878231049, 0.08953658491373062, 0.09103141725063324, 0.09096386283636093]], [[0.09123416990041733, 0.0907638892531395, 0.09096299111843109, 0.09081557393074036, 0.09077133238315582, 0.09062422066926956, 0.09089314192533493, 0.09109252691268921, 0.09094490110874176, 0.09090059995651245, 0.09099668264389038], [0.09143786877393723, 0.09067308157682419, 0.09099656343460083, 0.09075700491666794, 0.0906851664185524, 0.09044642746448517, 0.0908830389380455, 0.09120726585388184, 0.09096715599298477, 0.0908951535820961, 0.09105135500431061], [0.0913514494895935, 0.0907115712761879, 0.0909823328256607, 0.09078183770179749, 0.09072168916463852, 0.09052177518606186, 0.09088732302188873, 0.09115860611200333, 0.09095772355794907, 0.09089746326208115, 0.09102816879749298], [0.0914154127240181, 0.09068308025598526, 0.09099286794662476, 0.09076345711946487, 0.09069465100765228, 0.09046599268913269, 0.09088414907455444, 0.09119462221860886, 0.09096470475196838, 0.09089574962854385, 0.0910453349351883], [0.09143462777137756, 0.0906745120882988, 0.09099601954221725, 0.09075792878866196, 0.09068652987480164, 0.0904492437839508, 0.09088319540023804, 0.09120544046163559, 0.09096679836511612, 0.09089523553848267, 0.09105047583580017], [0.09149862825870514, 0.09064601361751556, 0.09100653976202011, 0.09073953330516815, 0.0906594768166542, 0.09039348363876343, 0.09087999910116196, 0.09124145656824112, 0.09097375720739365, 0.09089349955320358, 0.09106762707233429], [0.09138173609972, 0.09069807827472687, 0.09098731726408005, 0.09077312797307968, 0.090708889067173, 0.09049535542726517, 0.09088582545518875, 0.09117566049098969, 0.0909610316157341, 0.09089665859937668, 0.09103630483150482], [0.09129536896944046, 0.09073658287525177, 0.09097308665513992, 0.09079796820878983, 0.09074541926383972, 0.09057074040174484, 0.09089011698961258, 0.09112701565027237, 0.0909515991806984, 0.09089896827936172, 0.09101312607526779], [0.09135930240154266, 0.09070809185504913, 0.09098362922668457, 0.09077959507703781, 0.09071838855743408, 0.09051494300365448, 0.09088695049285889, 0.0911630317568779, 0.09095858782529831, 0.09089726954698563, 0.0910302922129631], [0.09137850254774094, 0.09069952368736267, 0.09098678082227707, 0.0907740592956543, 0.09071025252342224, 0.0904981791973114, 0.09088598191738129, 0.09117384254932404, 0.09096068143844604, 0.09089674055576324, 0.09103543311357498], [0.09133686125278473, 0.0907180905342102, 0.0909799337387085, 0.09078603982925415, 0.09072788059711456, 0.0905345231294632, 0.09088806062936783, 0.09115038812160492, 0.09095613658428192, 0.09089786559343338, 0.09102426469326019]], [[0.09079952538013458, 0.09057154506444931, 0.0906720906496048, 0.09062570333480835, 0.09090816229581833, 0.09075343608856201, 0.09078057110309601, 0.09073413163423538, 0.09250427037477493, 0.09069753438234329, 0.090953029692173], [0.09076883643865585, 0.09047817438840866, 0.09060633927583694, 0.09054721146821976, 0.09090739488601685, 0.09071005880832672, 0.09074465930461884, 0.09068543463945389, 0.0929485335946083, 0.09063878655433655, 0.09096463769674301], [0.09078240394592285, 0.09051939845085144, 0.09063537418842316, 0.09058186411857605, 0.0909077599644661, 0.09072922170162201, 0.09076052159070969, 0.09070694446563721, 0.09275222569704056, 0.09066472947597504, 0.09095954149961472], [0.09077615290880203, 0.09050038456916809, 0.09062198549509048, 0.09056588262319565, 0.09090759605169296, 0.09072038531303406, 0.0907532125711441, 0.0906970277428627, 0.0928427129983902, 0.09065276384353638, 0.09096189588308334], [0.09081405401229858, 0.0906159058213234, 0.09070330113172531, 0.09066298604011536, 0.09090844541788101, 0.09077399969100952, 0.09079758077859879, 0.09075721353292465, 0.0922936499118805, 0.09072542190551758, 0.09094742685556412], [0.09079334139823914, 0.0905526876449585, 0.09065882116556168, 0.09060985594987869, 0.09090802073478699, 0.09074468910694122, 0.0907733291387558, 0.09072430431842804, 0.09259384125471115, 0.09068568050861359, 0.09095538407564163], [0.09079698473215103, 0.09056378155946732, 0.09066662937402725, 0.09061918407678604, 0.09090810269117355, 0.0907498374581337, 0.09077759087085724, 0.09073008596897125, 0.09254109859466553, 0.0906926617026329, 0.0909539982676506], [0.090790756046772, 0.09054479748010635, 0.09065326303243637, 0.09060321748256683, 0.09090796858072281, 0.09074102342128754, 0.09077029675245285, 0.09072019159793854, 0.09263140708208084, 0.09068071842193604, 0.09095637500286102], [0.0910201370716095, 0.09125848114490509, 0.09115321189165115, 0.09120174497365952, 0.09090700000524521, 0.09106822311878204, 0.09103991091251373, 0.09108838438987732, 0.08927594125270844, 0.09112661331892014, 0.09086035192012787], [0.09078583121299744, 0.09052981436252594, 0.09064271301031113, 0.09059062600135803, 0.09090784192085266, 0.09073406457901001, 0.09076453745365143, 0.09071237593889236, 0.09270263463258743, 0.09067128598690033, 0.09095823764801025], [0.09082004427909851, 0.09063421189785004, 0.0907161757349968, 0.09067836403846741, 0.09090855717658997, 0.09078247845172882, 0.09080459177494049, 0.09076673537492752, 0.09220686554908752, 0.09073691815137863, 0.09094510972499847]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_return_max": 14.5, "env_reset_timer": 0.0005146184746079664, "episode_duration_sec_mean": 0.005514976237900555, "sample": 0.11654098416525312, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1807984003564239e-05, "batch_individual_items": 1.2195051932087656e-05, "add_time_dim_to_batch_and_zero_pad": 6.81534556901233e-06, "add_observations_from_episodes_to_batch": 2.813522573593483e-06, "add_states_from_episodes_to_batch": 2.7380213974489235e-06}}, "connector_pipeline_timer": 5.8374913665822254e-05}, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1984260637360563e-05, "normalize_and_clip_actions": 7.809003642161758e-06, "get_actions": 3.6036966479106176e-05, "listify_data_for_vector_env": 1.028616332576519e-05, "un_batch_to_individual_items": 6.628219383690812e-06, "tensor_to_numpy": 1.4852421763130101e-05}}, "connector_pipeline_timer": 0.00011359865730151804}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -0.15}, "episode_return_mean": -0.15, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "weights_seq_no": 19.0, "episode_len_max": 20, "episode_return_min": -13.5, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": -0.15}, "num_episodes_lifetime": 380, "episode_len_min": 20, "env_step_timer": 1.3916020994440002e-05, "num_env_steps_sampled_lifetime": 95400, "rlmodule_inference_timer": 3.0924128264442156e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "time_between_sampling": 9.372361263966788}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "b19cd_00000", "date": "2025-08-11_18-42-53", "timestamp": 1754930573, "time_this_iter_s": 9.872357845306396, "time_total_s": 179.6764748096466, "pid": 11628, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1629fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 179.6764748096466, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 44.121428571428574, "ram_util_percent": 80.55714285714284}}
{"timers": {"training_iteration": 9.163230655132237, "restore_env_runners": 9.296133179489511e-06, "training_step": 9.163092698073845, "env_runner_sampling_timer": 1.6650542736873015, "learner_update_timer": 7.322855356211342, "synch_weights": 0.0008610506368540549, "restore_eval_env_runners": 1.062637844623095e-05, "evaluation_iteration": 0.12666343628639215, "synch_eval_env_connectors": 0.00017583321791921807, "synch_env_connectors": 4.582489752629934e-06}, "env_runners": {"env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "env_reset_timer": 4.041314358865465e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.872416204721729e-05, "listify_data_for_vector_env": 1.0385139680990578e-05, "tensor_to_numpy": 1.4919539809741471e-05, "un_batch_to_individual_items": 6.631764783062709e-06, "remove_single_ts_time_rank_from_batch": 1.1914699752481292e-05, "normalize_and_clip_actions": 7.88387704078175e-06}}, "connector_pipeline_timer": 0.00011668384888762463}, "episode_duration_sec_mean": 0.00521864850539714, "sample": 0.005653491825338689, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.6946554939459825e-06, "numpy_to_tensor": 1.2365527449349707e-05, "batch_individual_items": 1.2363543498095096e-05, "add_observations_from_episodes_to_batch": 2.762243475790945e-06, "add_time_dim_to_batch_and_zero_pad": 6.8308024821885286e-06}}, "connector_pipeline_timer": 5.9000703012120656e-05}, "agent_episode_returns_mean": {"default_agent": 3.38}, "time_between_sampling": 0.03332476658353251, "weights_seq_no": 19.0, "num_episodes_lifetime": -555250.0, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 3.38}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "episode_return_mean": 3.38, "episode_len_max": 20, "env_step_timer": 1.391053274924431e-05, "num_env_steps_sampled_lifetime": -11105000.0, "episode_len_mean": 20.0, "rlmodule_inference_timer": 3.106392373889157e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime_throughput": 3289.3446394740267}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13519584301662718, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009030688084323852, "add_observations_from_episodes_to_batch": 0.0008789690535312708, "add_columns_from_episodes_to_train_batch": 0.04184639183283132, "add_time_dim_to_batch_and_zero_pad": 0.07544151098663242, "add_states_from_episodes_to_batch": 0.0035579116793846067, "batch_individual_items": 0.004232617824110139, "numpy_to_tensor": 6.387235380079481e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 101.0, "module_train_batch_size_mean": 997.4978492525759, "total_loss": 0.0, "weights_seq_no": 120.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 718200}, "default_policy": {"module_train_batch_size_mean": 997.4978492525759, "mean_kl_loss": 3.106643998762593e-05, "weights_seq_no": 120.0, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 718200, "diff_num_grad_updates_vs_sampler_policy": 101.0, "use_intrinsic_rewards": 1.0, "entropy": 0.6681157946586609, "vf_loss_unclipped": 46.0350456237793, "vf_explained_var": 0.0036388635635375977, "policy_loss": -0.0005300630582496524, "total_loss": 0.2776006758213043, "vf_loss": 0.35832923650741577}, "__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1436400, "num_env_steps_trained_lifetime": 3960000, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime_throughput": 45651.44222844607}}}, "default_policy": {"curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.3583051860332489, "mean_kl_loss": 3.32281160808634e-05, "num_module_steps_trained_lifetime": 119700, "module_train_batch_size_mean": 997.6479298448816, "weights_seq_no": 20.0, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 16595, "use_intrinsic_rewards": 0.0, "entropy": 0.668056070804596, "vf_loss_unclipped": 46.16763687133789, "vf_explained_var": 0.0052599310874938965, "curr_kl_coeff": 1.5409844422720198e-07, "policy_loss": -0.0005432391189970076, "total_loss": 0.2775638699531555, "num_module_steps_trained_lifetime_throughput": 775.1991732452258}, "intrinsic_reward_module": {"default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 997.6479298448816, "weights_seq_no": 20.0, "num_module_steps_trained": 5985, "num_module_steps_trained_lifetime": 119700, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 775.20551849539}, "__all_modules__": {"num_env_steps_trained_lifetime": 660000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 33000, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 239400, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4275.308076944158, "num_module_steps_trained_throughput": 19831187.898748733, "num_module_steps_trained_lifetime_throughput": 12687488.849671436}, "IntrinsicAttentionMask": [[[0.0907161682844162, 0.09052156656980515, 0.0911070927977562, 0.09058981388807297, 0.09117578715085983, 0.09065812081098557, 0.09069228917360306, 0.09127892553806305, 0.09076066315174103, 0.09134774655103683, 0.09115178138017654], [0.09068754315376282, 0.09046419709920883, 0.0911364033818245, 0.09054252505302429, 0.09121530503034592, 0.09062091261148453, 0.09066013246774673, 0.0913337916135788, 0.09073862433433533, 0.09141286462545395, 0.0911877378821373], [0.09077347069978714, 0.0906364843249321, 0.09104838967323303, 0.09068454056978226, 0.0910966545343399, 0.0907326191663742, 0.09075666964054108, 0.09116911888122559, 0.09080478549003601, 0.09121745079755783, 0.09107979387044907], [0.09069758653640747, 0.09048432856798172, 0.09112612158060074, 0.09055911749601364, 0.09120143949985504, 0.09063396602869034, 0.09067142009735107, 0.09131453186273575, 0.09074635803699493, 0.09139000624418259, 0.09117511659860611], [0.0907835140824318, 0.09065663814544678, 0.09103810042142868, 0.0907011479139328, 0.09108279645442963, 0.09074568003416061, 0.09076794981956482, 0.09114988148212433, 0.09081251919269562, 0.09119462966918945, 0.09106718003749847], [0.09070763736963272, 0.0905044674873352, 0.09111583232879639, 0.09057571738958359, 0.09118757396936417, 0.09064702689647675, 0.09068270027637482, 0.0912952795624733, 0.09075409919023514, 0.09136715531349182, 0.09116250276565552], [0.09071266651153564, 0.09051453322172165, 0.09111069142818451, 0.09058401733636856, 0.09118063747882843, 0.09065356105566025, 0.09068834781646729, 0.09128565341234207, 0.09075797349214554, 0.09135573357343674, 0.09115619957447052], [0.09079857170581818, 0.0906868651509285, 0.09102265536785126, 0.09072605520486832, 0.09106198698282242, 0.09076526015996933, 0.09078487008810043, 0.09112101793289185, 0.09082409739494324, 0.09116039425134659, 0.09104824811220169], [0.0907227173447609, 0.09053467214107513, 0.09110040962696075, 0.0906006246805191, 0.09116677194833755, 0.09066662937402725, 0.09069964289665222, 0.09126640111207962, 0.09076570719480515, 0.09133289009332657, 0.09114358574151993], [0.09080859273672104, 0.09070701152086258, 0.09101235121488571, 0.09074265509843826, 0.09104810655117035, 0.09077830612659454, 0.09079613536596298, 0.09110177308320999, 0.09083181619644165, 0.09113756567239761, 0.09103561192750931], [0.09078001230955124, 0.09064959734678268, 0.0910416916012764, 0.0906953439116478, 0.09108763933181763, 0.0907411128282547, 0.09076400846242905, 0.09115660190582275, 0.09080981463193893, 0.09120260179042816, 0.09107158333063126]], [[0.0907757580280304, 0.0905478298664093, 0.09039371460676193, 0.09085720032453537, 0.09062907099723816, 0.09072967618703842, 0.09050186723470688, 0.09096590429544449, 0.09274056553840637, 0.09092921763658524, 0.09092921763658524], [0.09073831140995026, 0.09044775366783142, 0.09025140106678009, 0.09084217995405197, 0.09055128693580627, 0.09067954868078232, 0.0903891772031784, 0.09098085016012192, 0.09325132519006729, 0.09093405306339264, 0.09093405306339264], [0.0907127782702446, 0.09037983417510986, 0.09015493839979172, 0.09083183854818344, 0.09049844741821289, 0.090645432472229, 0.09031274169683456, 0.0909908190369606, 0.09359882026910782, 0.09093715250492096, 0.09093715250492096], [0.09078903496265411, 0.09058347344398499, 0.09044445306062698, 0.09086247533559799, 0.09065674245357513, 0.09074748307466507, 0.0905420109629631, 0.09096048027276993, 0.09255897253751755, 0.09092740714550018, 0.09092740714550018], [0.09075171500444412, 0.09048347920179367, 0.09030219167470932, 0.09084758907556534, 0.0905790701508522, 0.09069747477769852, 0.0904294028878212, 0.0909755676984787, 0.09306886792182922, 0.09093237668275833, 0.09093237668275833], [0.09076821804046631, 0.09052763134241104, 0.0903649777173996, 0.09085418283939362, 0.09061337262392044, 0.09071957319974899, 0.09047911316156387, 0.09096894413232803, 0.09284351766109467, 0.09093021601438522, 0.09093021601438522], [0.09073072671890259, 0.09042752534151077, 0.09022266417741776, 0.09083911776542664, 0.09053555876016617, 0.0906694084405899, 0.0903664082288742, 0.09098385274410248, 0.09335479885339737, 0.09093499928712845, 0.09093499928712845], [0.09080670028924942, 0.09063097089529037, 0.09051209688186646, 0.0908694714307785, 0.09069361537694931, 0.09077118337154388, 0.09059552103281021, 0.09095321595668793, 0.0923173576593399, 0.0909249559044838, 0.0909249559044838], [0.09108292311429977, 0.09139229357242584, 0.09160251170396805, 0.09097282588481903, 0.09128182381391525, 0.09114532172679901, 0.09145490825176239, 0.09082623571157455, 0.08848990499973297, 0.09087565541267395, 0.09087565541267395], [0.09080076217651367, 0.09061495959758759, 0.09048929065465927, 0.09086712449789047, 0.09068119525909424, 0.09076320379972458, 0.09057748317718506, 0.09095568209886551, 0.09239880740642548, 0.09092579782009125, 0.09092579782009125], [0.09080076217651367, 0.09061495959758759, 0.09048929065465927, 0.09086712449789047, 0.09068119525909424, 0.09076320379972458, 0.09057748317718506, 0.09095568209886551, 0.09239880740642548, 0.09092579782009125, 0.09092579782009125]], [[0.09127853065729141, 0.09056512266397476, 0.09100721776485443, 0.09061668813228607, 0.09105903655290604, 0.09091146290302277, 0.09069409966468811, 0.09089303761720657, 0.0909891203045845, 0.0909447968006134, 0.09104092419147491], [0.09163019806146622, 0.09023939073085785, 0.0911000445485115, 0.09033957868814468, 0.09120118618011475, 0.09091329574584961, 0.09049006551504135, 0.09087739139795303, 0.09106473624706268, 0.09097828716039658, 0.09116584062576294], [0.09141183644533157, 0.09044145792722702, 0.09104246646165848, 0.0905115008354187, 0.09111298620700836, 0.09091220051050186, 0.09061668068170547, 0.0908871591091156, 0.09101784974336624, 0.09095755219459534, 0.09108834713697433], [0.09160465002059937, 0.0902629941701889, 0.09109331667423248, 0.09035966545343399, 0.0911908745765686, 0.09091316908597946, 0.09050486236810684, 0.09087853878736496, 0.09105926007032394, 0.09097586572170258, 0.09115678071975708], [0.0913863331079483, 0.09046509861946106, 0.09103573113679886, 0.0905316174030304, 0.09110267460346222, 0.09091206640005112, 0.09063148498535156, 0.09088828414678574, 0.09101235866546631, 0.09095510840415955, 0.09107927978038788], [0.0914590060710907, 0.09039774537086487, 0.09105492383241653, 0.09047431498765945, 0.09113205224275589, 0.09091245383024216, 0.09058930724859238, 0.09088505059480667, 0.09102798998355865, 0.09096204489469528, 0.09110510349273682], [0.09156633913516998, 0.09029840677976608, 0.09108322113752365, 0.09038979560136795, 0.09117540717124939, 0.09091298282146454, 0.09052705764770508, 0.09088025242090225, 0.09105104207992554, 0.09097223728895187, 0.09114319086074829], [0.09146808832883835, 0.09038933366537094, 0.09105731546878815, 0.09046716243028641, 0.09113572537899017, 0.09091249108314514, 0.09058403968811035, 0.09088464826345444, 0.09102994203567505, 0.09096290916204453, 0.09110832959413528], [0.0914207473397255, 0.09043319523334503, 0.0910448282957077, 0.0905044823884964, 0.09111659228801727, 0.09091225266456604, 0.09061150997877121, 0.09088675677776337, 0.09101976454257965, 0.09095840156078339, 0.09109151363372803], [0.09144257009029388, 0.09041295945644379, 0.09105058014392853, 0.09048726409673691, 0.09112540632486343, 0.0909123569726944, 0.09059882909059525, 0.09088578075170517, 0.09102445095777512, 0.09096047282218933, 0.09109926223754883], [0.09139523655176163, 0.09045682847499847, 0.09103807806968689, 0.0905245840549469, 0.09110627323389053, 0.0909121036529541, 0.0906263068318367, 0.0908878818154335, 0.09101427346467972, 0.0909559577703476, 0.09108243882656097]], [[0.09077581763267517, 0.09080296009778976, 0.09039377421140671, 0.09060204029083252, 0.09062912315130234, 0.0907297357916832, 0.0907568633556366, 0.09071043133735657, 0.09274062514305115, 0.09092927724123001, 0.09092927724123001], [0.09078025072813034, 0.0908064991235733, 0.09041068702936172, 0.09061215817928314, 0.09063835442066193, 0.09073567390441895, 0.09076191484928131, 0.09071700274944305, 0.09268005937337875, 0.09092868119478226, 0.09092868119478226], [0.09071291983127594, 0.09075259417295456, 0.09015507996082306, 0.09045904129743576, 0.09049859642982483, 0.09064557403326035, 0.09068521857261658, 0.09061736613512039, 0.09359896928071976, 0.0909373015165329, 0.0909373015165329], [0.09074734896421432, 0.09078018367290497, 0.09028536081314087, 0.09053715318441391, 0.09056990593671799, 0.09069160372018814, 0.09072442352771759, 0.09066825360059738, 0.09312975406646729, 0.09093303978443146, 0.09093303978443146], [0.09075180441141129, 0.0907837450504303, 0.09030227363109589, 0.09054728597402573, 0.09057915210723877, 0.09069756418466568, 0.0907294899225235, 0.09067484736442566, 0.09306895732879639, 0.0909324660897255, 0.0909324660897255], [0.09076829254627228, 0.09079694747924805, 0.09036505967378616, 0.09058485925197601, 0.09061344712972641, 0.09071965515613556, 0.09074828773736954, 0.09069927781820297, 0.09284359961748123, 0.09093029797077179, 0.09093029797077179], [0.09077273309230804, 0.09080049395561218, 0.09038197249174118, 0.09059498459100723, 0.0906226858496666, 0.0907256007194519, 0.09075334668159485, 0.09070584923028946, 0.09278297424316406, 0.09092970192432404, 0.09092970192432404], [0.09076512604951859, 0.09079441428184509, 0.09035301208496094, 0.09057765454053879, 0.09060686826705933, 0.09071541577577591, 0.09074467420578003, 0.09069459140300751, 0.0928867757320404, 0.09093070775270462, 0.09093070775270462], [0.09108303487300873, 0.09104631841182709, 0.091602623462677, 0.09131874144077301, 0.0912819355726242, 0.09114543348550797, 0.09110868722200394, 0.09117159247398376, 0.08849001675844193, 0.0908757671713829, 0.0908757671713829], [0.09080079197883606, 0.09082291275262833, 0.09048932790756226, 0.09065914154052734, 0.09068123251199722, 0.09076324105262756, 0.09078534692525864, 0.09074750542640686, 0.09239884465932846, 0.09092583507299423, 0.09092583507299423], [0.09080079197883606, 0.09082291275262833, 0.09048932790756226, 0.09065914154052734, 0.09068123251199722, 0.09076324105262756, 0.09078534692525864, 0.09074750542640686, 0.09239884465932846, 0.09092583507299423, 0.09092583507299423]], [[0.0906577929854393, 0.0904633104801178, 0.091048464179039, 0.09053152054548264, 0.09079455584287643, 0.09092164784669876, 0.09095591306686401, 0.0912201851606369, 0.0910244956612587, 0.0912889614701271, 0.09109312295913696], [0.09062054753303528, 0.09039737284183502, 0.09106907993555069, 0.09047563374042511, 0.09077752381563187, 0.09092344343662262, 0.09096279740333557, 0.09126631170511246, 0.09104155004024506, 0.09134533256292343, 0.09112036973237991], [0.09073237329721451, 0.09059545397758484, 0.09100716561079025, 0.09064348042011261, 0.09082861244678497, 0.09091800451278687, 0.09094209969043732, 0.09112784266471863, 0.09099031239748001, 0.09117615222930908, 0.09103855490684509], [0.09063361585140228, 0.09042050689458847, 0.09106184542179108, 0.09049524366855621, 0.0907835066318512, 0.09092281013727188, 0.09096038341522217, 0.09125012159347534, 0.09103555977344513, 0.091325543820858, 0.09111080318689346], [0.0906839445233345, 0.09050962328910828, 0.09103400260210037, 0.09057076275348663, 0.0908065065741539, 0.09092038124799728, 0.09095108509063721, 0.09118781238794327, 0.09101253002882004, 0.09124941378831863, 0.09107400476932526], [0.09070819616317749, 0.09055259823799133, 0.09102054685354233, 0.0906071737408638, 0.09081757068634033, 0.09091918170452118, 0.09094657748937607, 0.09115776419639587, 0.09100139886140823, 0.09121270477771759, 0.09105624258518219], [0.09071473032236099, 0.09056418389081955, 0.09101694077253342, 0.09061699360609055, 0.0908205583691597, 0.09091886878013611, 0.09094537049531937, 0.09114967286586761, 0.09099840372800827, 0.09120282530784607, 0.09105146676301956], [0.09076504409313202, 0.09065338224172592, 0.09098903834819794, 0.09069255739450455, 0.09084350615739822, 0.09091637283563614, 0.09093601256608963, 0.09108737111091614, 0.0909753143787384, 0.09112673252820969, 0.09101462364196777], [0.090727798640728, 0.09058734774589539, 0.09100969135761261, 0.09063661843538284, 0.09082651883363724, 0.09091822057962418, 0.09094294160604477, 0.0911334827542305, 0.09099240601062775, 0.09118305146694183, 0.09104189276695251], [0.09077811241149902, 0.09067656844854355, 0.09098179638385773, 0.09071219712495804, 0.09084946662187576, 0.0909157246351242, 0.09093358367681503, 0.09107119590044022, 0.09096931666135788, 0.09110697358846664, 0.09100505709648132], [0.0907408744096756, 0.09061051905155182, 0.0910024493932724, 0.09065625071525574, 0.09083248674869537, 0.09091757237911224, 0.09094051271677017, 0.09111730754375458, 0.09098640829324722, 0.0911632850766182, 0.09103232622146606]], [[0.09104494005441666, 0.09090965241193771, 0.09081809222698212, 0.09109324216842651, 0.09110935777425766, 0.09086628258228302, 0.09088234603404999, 0.0911576971411705, 0.0900469645857811, 0.09113594889640808, 0.09093540906906128], [0.09110802412033081, 0.09090959280729294, 0.09077538549900055, 0.09117890894412994, 0.09120254963636398, 0.09084601700305939, 0.09086956828832626, 0.09127350896596909, 0.08964754641056061, 0.09124158322811127, 0.09094735980033875], [0.09115065634250641, 0.09090942144393921, 0.09074632823467255, 0.09123685956001282, 0.09126561135053635, 0.09083215147256851, 0.0908607766032219, 0.09135192632675171, 0.08937778323888779, 0.09131309390068054, 0.09095533192157745], [0.09102240949869156, 0.09090963006019592, 0.09083329141139984, 0.09106267243623734, 0.09107609838247299, 0.09087347239255905, 0.09088686853647232, 0.09111638367176056, 0.09018982946872711, 0.09109826385974884, 0.09093111008405685], [0.09101489186286926, 0.09090961515903473, 0.09083835035562515, 0.09105248004198074, 0.09106500446796417, 0.09087586402893066, 0.0908883661031723, 0.09110260754823685, 0.09023749083280563, 0.09108569473028183, 0.09092966467142105], [0.09112823009490967, 0.09090952575206757, 0.09076163917779922, 0.09120636433362961, 0.09123242646455765, 0.0908394604921341, 0.09086541831493378, 0.09131065011024475, 0.08951970934867859, 0.09127546101808548, 0.09095115214586258], [0.09112073481082916, 0.09090954810380936, 0.09076672792434692, 0.09119618684053421, 0.09122134745121002, 0.09084188938140869, 0.09086695313453674, 0.09129688143730164, 0.08956705033779144, 0.09126290678977966, 0.09094974398612976], [0.09099232405424118, 0.09090954810380936, 0.0908535048365593, 0.09102186560630798, 0.09103171527385712, 0.09088300168514252, 0.09089283645153046, 0.09106127172708511, 0.09038060903549194, 0.0910479798913002, 0.09092530608177185], [0.09150851517915726, 0.09090425074100494, 0.09049708396196365, 0.09172502905130386, 0.09179731458425522, 0.09071120619773865, 0.09078268706798553, 0.09201450645923615, 0.0871235653758049, 0.0919167548418045, 0.09101905673742294], [0.09100247919559479, 0.09090958535671234, 0.09084669500589371, 0.0910356417298317, 0.09104669094085693, 0.09087979793548584, 0.09089083224534988, 0.09107986837625504, 0.09031622111797333, 0.0910649448633194, 0.09092727303504944], [0.09109600633382797, 0.09090960770845413, 0.09078352898359299, 0.09116259217262268, 0.09118479490280151, 0.09084988385438919, 0.09087201207876205, 0.091251440346241, 0.08972350507974625, 0.09122145920991898, 0.09094509482383728]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_return_max": 14.5, "env_reset_timer": 0.0005103547901788344, "episode_duration_sec_mean": 0.005537324587348849, "sample": 0.11652207223397722, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.249624255829961e-05, "batch_individual_items": 1.2863645927783635e-05, "add_time_dim_to_batch_and_zero_pad": 7.121264386753717e-06, "add_observations_from_episodes_to_batch": 2.8840755332893423e-06, "add_states_from_episodes_to_batch": 2.7853254948754007e-06}}, "connector_pipeline_timer": 6.079733715709082e-05}, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.3509488362494884e-05, "normalize_and_clip_actions": 8.063061730538176e-06, "get_actions": 3.886269490731178e-05, "listify_data_for_vector_env": 1.3053885837401894e-05, "un_batch_to_individual_items": 6.774815263146728e-06, "tensor_to_numpy": 1.5461429251930096e-05}}, "connector_pipeline_timer": 0.0001227764672564422}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -0.35}, "episode_return_mean": -0.35, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "weights_seq_no": 20.0, "episode_len_max": 20, "episode_return_min": -13.5, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": -0.35}, "num_episodes_lifetime": 400, "episode_len_min": 20, "env_step_timer": 1.4600364183973945e-05, "num_env_steps_sampled_lifetime": 100400, "rlmodule_inference_timer": 3.451773718055383e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "time_between_sampling": 9.371301672577214}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "b19cd_00000", "date": "2025-08-11_18-43-02", "timestamp": 1754930582, "time_this_iter_s": 9.358464002609253, "time_total_s": 189.03493881225586, "pid": 11628, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1629fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 189.03493881225586, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 37.723076923076924, "ram_util_percent": 79.41538461538461}}
