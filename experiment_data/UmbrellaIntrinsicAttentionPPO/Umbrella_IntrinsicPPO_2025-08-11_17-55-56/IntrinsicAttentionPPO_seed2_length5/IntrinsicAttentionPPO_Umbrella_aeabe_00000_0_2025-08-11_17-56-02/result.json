{"timers": {"training_iteration": 9.214525041985326, "restore_env_runners": 8.750008419156075e-06, "training_step": 9.214376332936808, "env_runner_sampling_timer": 1.6174306250177324, "learner_update_timer": 7.406458624987863, "synch_weights": 0.0008889170130714774}, "env_runners": {"module_episode_returns_mean": {"default_policy": -1.9}, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.7794326285795595e-06, "remove_single_ts_time_rank_from_batch": 1.205089972180988e-05, "normalize_and_clip_actions": 1.0030164264436894e-05, "get_actions": 4.234549989151026e-05, "tensor_to_numpy": 1.517961734016609e-05, "listify_data_for_vector_env": 1.0584175260165317e-05}}, "connector_pipeline_timer": 0.00012417764473644446}, "episode_return_min": -11.5, "time_between_sampling": 0.0006648424478109019, "agent_episode_returns_mean": {"default_agent": -1.9}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3027611406076721e-05, "add_states_from_episodes_to_batch": 2.712322290461312e-06, "add_observations_from_episodes_to_batch": 2.919018096808899e-06, "add_time_dim_to_batch_and_zero_pad": 7.121373563936958e-06, "batch_individual_items": 1.271776471578049e-05}}, "connector_pipeline_timer": 6.239554892821068e-05}, "env_step_timer": 1.4565721341051607e-05, "episode_duration_sec_mean": 0.005217829637695105, "episode_return_mean": -1.9, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.191744832559449, "weights_seq_no": 0.0, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "episode_return_max": 8.5, "env_to_module_sum_episodes_length_out": 10.191744832559449, "episode_len_min": 20, "rlmodule_inference_timer": 3.355523219870238e-05, "sample": 0.006187163973638681, "num_episodes_lifetime": 31375.0, "num_env_steps_sampled_lifetime": 627500.0, "env_reset_timer": 8.193993614763055e-05, "num_env_steps_sampled_lifetime_throughput": 3118.227218864313}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000, "learner_connector": {"connector_pipeline_timer": 0.15339591598603874, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009463166003115475, "add_observations_from_episodes_to_batch": 0.0008717499440535903, "add_columns_from_episodes_to_train_batch": 0.04212962498422712, "add_time_dim_to_batch_and_zero_pad": 0.08957716694567353, "add_states_from_episodes_to_batch": 0.003590415930375457, "batch_individual_items": 0.007508874987252057, "numpy_to_tensor": 8.616701234132051e-05}}}, "learner_connector_sum_episodes_length_out": 5250}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained_lifetime": 35910, "policy_loss": -4.258588523953222e-05, "diff_num_grad_updates_vs_sampler_policy": 6.0, "weights_seq_no": 6.0, "total_loss": 0.24870631098747253, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 8.825674740364775e-06, "vf_loss_unclipped": 43.26570510864258, "num_module_steps_trained": 35910, "vf_explained_var": -0.0027681589126586914, "module_train_batch_size_mean": 998.5423314844973, "vf_loss": 0.32066816091537476, "entropy": 0.6929886341094971}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 71820, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 216000, "num_env_steps_trained_lifetime_throughput": 66754.9783499611}, "intrinsic_reward_module": {"module_train_batch_size_mean": 998.5423314844973, "num_module_steps_trained_lifetime": 35910, "diff_num_grad_updates_vs_sampler_policy": 6.0, "weights_seq_no": 6.0, "total_loss": 0.0, "num_module_steps_trained": 35910}}}, "__all_modules__": {"num_module_steps_trained_lifetime": 11970, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 36000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4877.136438141391, "num_module_steps_trained_throughput": 31525919.306577623, "num_module_steps_trained_lifetime_throughput": 13398418.304781152}, "intrinsic_reward_module": {"module_train_batch_size_mean": 998.9117791197002, "num_trainable_parameters": 8266, "num_module_steps_trained_lifetime": 5985, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "weights_seq_no": 1.0, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 809.8215809075234}, "default_policy": {"vf_explained_var": 0.0018462538719177246, "module_train_batch_size_mean": 998.9117791197002, "num_trainable_parameters": 16595, "vf_loss_unclipped": 43.01667022705078, "num_module_steps_trained_lifetime": 5985, "policy_loss": -4.3471151002449915e-05, "num_module_steps_trained": 5985, "vf_loss": 0.3205278217792511, "entropy": 0.6929892301559448, "curr_kl_coeff": 0.08079196512699127, "total_loss": 0.24859614670276642, "diff_num_grad_updates_vs_sampler_policy": 1.0, "use_intrinsic_rewards": 0.0, "weights_seq_no": 1.0, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 8.985024578578304e-06, "num_module_steps_trained_lifetime_throughput": 809.8042001286055}, "IntrinsicAttentionMask": [[[0.1505126804113388, 0.1527967005968094, 0.15511536598205566, 0.20645476877689362, 0.16629844903945923, 0.1688220202922821], [0.1508604884147644, 0.15310050547122955, 0.15537379682064056, 0.2055394947528839, 0.16632796823978424, 0.16879767179489136], [0.15120820701122284, 0.15340404212474823, 0.15563175082206726, 0.20462708175182343, 0.16635653376579285, 0.16877233982086182], [0.1577896624803543, 0.1591062992811203, 0.16043391823768616, 0.187847301363945, 0.1667158603668213, 0.16810698807239532], [0.15281425416469574, 0.15480302274227142, 0.15681767463684082, 0.2004467397928238, 0.16647587716579437, 0.16864244639873505], [0.1531614363193512, 0.15510481595993042, 0.15707284212112427, 0.19955036044120789, 0.16649897396564484, 0.1686115860939026]], [[0.17186883091926575, 0.159032940864563, 0.17344699800014496, 0.15858133137226105, 0.16122841835021973, 0.17584148049354553], [0.1778673380613327, 0.14999665319919586, 0.18147306144237518, 0.14906300604343414, 0.15458077192306519, 0.18701916933059692], [0.171145960688591, 0.16010425984859467, 0.17249536514282227, 0.1597135365009308, 0.16200150549411774, 0.17453943192958832], [0.17808207869529724, 0.14966799318790436, 0.18176493048667908, 0.14871788024902344, 0.15433473885059357, 0.18743248283863068], [0.17682687938213348, 0.15158386528491974, 0.18006356060504913, 0.15073084831237793, 0.15576481819152832, 0.1850300282239914], [0.1700555682182312, 0.1617135852575302, 0.1710658073425293, 0.16141584515571594, 0.16315676271915436, 0.17259246110916138]], [[0.1484222412109375, 0.15858986973762512, 0.1549740731716156, 0.2106998860836029, 0.1594439148902893, 0.16787007451057434], [0.15034955739974976, 0.15953044593334198, 0.15627287328243256, 0.2056925892829895, 0.16029873490333557, 0.1678558737039566], [0.14967869222164154, 0.15920540690422058, 0.1558224856853485, 0.20742575824260712, 0.1600036919116974, 0.16786396503448486], [0.15860909223556519, 0.16332614421844482, 0.1616685539484024, 0.1851952075958252, 0.16371458768844604, 0.16748635470867157], [0.15050576627254486, 0.1596057415008545, 0.15637747943401337, 0.20529045164585114, 0.16036704182624817, 0.1678534895181656], [0.15200361609458923, 0.16032104194164276, 0.1573755294084549, 0.2014634609222412, 0.1610148400068283, 0.16782157123088837]], [[0.17121636867523193, 0.1584082692861557, 0.17308035492897034, 0.16013281047344208, 0.1587325781583786, 0.17842964828014374], [0.17488721013069153, 0.15141570568084717, 0.17843252420425415, 0.15448521077632904, 0.15199080109596252, 0.1887885183095932], [0.1706891506910324, 0.15938664972782135, 0.1723254770040512, 0.1609146147966385, 0.15967413783073425, 0.17700989544391632], [0.17438843846321106, 0.1523856371641159, 0.17769481241703033, 0.15527483820915222, 0.1529272198677063, 0.18732903897762299], [0.1747933328151703, 0.15159882605075836, 0.1782933920621872, 0.15463444590568542, 0.15216760337352753, 0.18851244449615479], [0.16918712854385376, 0.16214203834533691, 0.17019222676753998, 0.16310527920722961, 0.16232354938983917, 0.17304974794387817]], [[0.15024533867835999, 0.15252530574798584, 0.15483984351158142, 0.21439002454280853, 0.16600307822227478, 0.16199640929698944], [0.1506044566631317, 0.15284070372581482, 0.15511012077331543, 0.2132764756679535, 0.16604571044445038, 0.16212259232997894], [0.15096323192119598, 0.15315550565719604, 0.15537959337234497, 0.21216699481010437, 0.16608700156211853, 0.16224758327007294], [0.158629909157753, 0.15981866419315338, 0.1610163152217865, 0.18920183181762695, 0.1666698455810547, 0.1646634191274643], [0.15261727571487427, 0.15460346639156342, 0.1566155105829239, 0.20709237456321716, 0.16626127064228058, 0.16281013190746307], [0.1520376056432724, 0.15409667789936066, 0.1561836153268814, 0.20886337757110596, 0.16620326042175293, 0.162615567445755]], [[0.17103351652622223, 0.16002753376960754, 0.17219793796539307, 0.16111701726913452, 0.16166453063488007, 0.17395943403244019], [0.17888092994689941, 0.147899329662323, 0.18238531053066254, 0.1507967710494995, 0.1522666960954666, 0.1877710074186325], [0.17021244764328003, 0.16128124296665192, 0.17115086317062378, 0.1621704250574112, 0.16261684894561768, 0.1725682020187378], [0.1780983954668045, 0.14912183582782745, 0.1813538819551468, 0.15184767544269562, 0.15322920680046082, 0.1863490492105484], [0.17770549654960632, 0.14973442256450653, 0.18083739280700684, 0.15237337350845337, 0.15371021628379822, 0.18563906848430634], [0.1689743548631668, 0.1631668657064438, 0.16957826912403107, 0.16375002264976501, 0.1640423983335495, 0.17048819363117218]]]}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.05262558118723e-05, "remove_single_ts_time_rank_from_batch": 1.2520994604530458e-05, "un_batch_to_individual_items": 6.603666575268529e-06, "normalize_and_clip_actions": 8.489612445159956e-06, "tensor_to_numpy": 1.6102144913825297e-05, "get_actions": 4.06351868655101e-05}}, "connector_pipeline_timer": 0.00012077296680104959}, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2542089978393291e-05, "add_states_from_episodes_to_batch": 2.6699992811000105e-06, "add_time_dim_to_batch_and_zero_pad": 7.304824967160531e-06, "numpy_to_tensor": 1.2409010440044441e-05, "add_observations_from_episodes_to_batch": 2.9443083360518597e-06}}, "connector_pipeline_timer": 6.139701781484072e-05}, "weights_seq_no": 1.0, "episode_len_mean": 20.0, "num_episodes": 20, "episode_return_max": 14.5, "rlmodule_inference_timer": 3.262601969835642e-05, "num_episodes_lifetime": 20, "env_step_timer": 1.4631491305671008e-05, "episode_duration_sec_mean": 0.0052734291064552965, "agent_episode_returns_mean": {"default_agent": -0.2}, "env_to_module_sum_episodes_length_out": 10.216013141322508, "env_reset_timer": 0.00018908397760242224, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "episode_len_max": 20, "episode_return_mean": -0.2, "module_episode_returns_mean": {"default_policy": -0.2}, "env_to_module_sum_episodes_length_in": 10.216013141322508, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "sample": 0.11518833402078599, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 5400, "episode_return_min": -13.5, "num_agent_steps_sampled_lifetime": {"default_agent": 400}}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "aeabe_00000", "date": "2025-08-11_18-49-25", "timestamp": 1754930965, "time_this_iter_s": 9.338825941085815, "time_total_s": 9.338825941085815, "pid": 11811, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161dfd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9.338825941085815, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 33.357142857142854, "ram_util_percent": 77.32142857142857}}
{"timers": {"training_iteration": 9.214783703235442, "restore_env_runners": 8.731258567422629e-06, "training_step": 9.214634567108005, "env_runner_sampling_timer": 1.6173391383478883, "learner_update_timer": 7.406718604988418, "synch_weights": 0.0008895657630637289, "restore_eval_env_runners": 8.25000461190939e-06, "evaluation_iteration": 0.12204395805019885, "synch_eval_env_connectors": 0.00011408294085413218, "synch_env_connectors": 4.917033948004246e-06}, "env_runners": {"module_episode_returns_mean": {"default_policy": -1.2600000000000002}, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.601385066306569e-06, "remove_single_ts_time_rank_from_batch": 1.1860417549334433e-05, "normalize_and_clip_actions": 7.98593175779581e-06, "get_actions": 3.818893333618471e-05, "tensor_to_numpy": 1.4980999057529433e-05, "listify_data_for_vector_env": 1.037809380258678e-05}}, "connector_pipeline_timer": 0.00011660563403044117}, "episode_return_min": -11.5, "time_between_sampling": 0.02918121949868407, "agent_episode_returns_mean": {"default_agent": -1.2600000000000002}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2552776628252317e-05, "add_states_from_episodes_to_batch": 2.6762955126973088e-06, "add_observations_from_episodes_to_batch": 2.7842982614316794e-06, "add_time_dim_to_batch_and_zero_pad": 6.81504348328941e-06, "batch_individual_items": 1.2392579508798788e-05}}, "connector_pipeline_timer": 5.940258258225148e-05}, "env_step_timer": 1.380698985612279e-05, "episode_duration_sec_mean": 0.00556800016248599, "episode_return_mean": -1.2600000000000002, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 1.0, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "episode_return_max": 8.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "rlmodule_inference_timer": 3.9523301448099895e-05, "sample": 0.0056464089851659335, "num_episodes_lifetime": 500.0, "num_env_steps_sampled_lifetime": 10000.0, "env_reset_timer": 4.313894769783412e-05, "num_env_steps_sampled_lifetime_throughput": 3277.483807954628}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15336722890613602, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009458996002795175, "add_observations_from_episodes_to_batch": 0.0008710820344276726, "add_columns_from_episodes_to_train_batch": 0.042115589154418556, "add_time_dim_to_batch_and_zero_pad": 0.08956751193618402, "add_states_from_episodes_to_batch": 0.003593223021598533, "batch_individual_items": 0.0075067458173725754, "numpy_to_tensor": 8.591534220613538e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained_lifetime": 71820, "policy_loss": -0.0003155635786242783, "diff_num_grad_updates_vs_sampler_policy": 11.0, "weights_seq_no": 12.0, "total_loss": 0.24839168787002563, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 4.384655403555371e-05, "vf_loss_unclipped": 41.87077713012695, "num_module_steps_trained": 35910, "vf_explained_var": -0.002687811851501465, "module_train_batch_size_mean": 998.2236050808158, "vf_loss": 0.3206075429916382, "entropy": 0.6930448412895203}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 143640, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 432000, "num_env_steps_trained_lifetime_throughput": 66391.3421466759}, "intrinsic_reward_module": {"module_train_batch_size_mean": 998.2236050808158, "num_module_steps_trained_lifetime": 71820, "diff_num_grad_updates_vs_sampler_policy": 11.0, "weights_seq_no": 12.0, "total_loss": 0.0, "num_module_steps_trained": 35910}}}, "__all_modules__": {"num_module_steps_trained_lifetime": 23940, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 72000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4870.827998841034, "num_module_steps_trained_throughput": 31088829.196148865, "num_module_steps_trained_lifetime_throughput": 13386148.265138498}, "intrinsic_reward_module": {"module_train_batch_size_mean": 998.828720912135, "num_trainable_parameters": 8266, "num_module_steps_trained_lifetime": 11970, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "weights_seq_no": 2.0, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 808.7841065888937}, "default_policy": {"vf_explained_var": -0.0027997493743896484, "module_train_batch_size_mean": 998.828720912135, "num_trainable_parameters": 16595, "vf_loss_unclipped": 41.884742736816406, "num_module_steps_trained_lifetime": 11970, "policy_loss": -0.0003203963569831103, "num_module_steps_trained": 5985, "vf_loss": 0.3205326497554779, "entropy": 0.6930443048477173, "curr_kl_coeff": 0.040395982563495636, "total_loss": 0.24832510948181152, "diff_num_grad_updates_vs_sampler_policy": 1.0, "use_intrinsic_rewards": 0.0, "weights_seq_no": 2.0, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 4.539605652098544e-05, "num_module_steps_trained_lifetime_throughput": 808.7669688671621}, "IntrinsicAttentionMask": [[[0.1484602838754654, 0.15863053500652313, 0.16090193390846252, 0.21075396239757538, 0.15948480367660522, 0.16176843643188477], [0.15038050711154938, 0.15956330299377441, 0.16160555183887482, 0.2057350128889084, 0.16033177077770233, 0.16238383948802948], [0.15079259872436523, 0.15976081788539886, 0.1617535501718521, 0.2046695053577423, 0.16051071882247925, 0.16251279413700104], [0.15861724317073822, 0.16333451867103577, 0.16436484456062317, 0.18520472943782806, 0.16372299194335938, 0.16475576162338257], [0.1505361944437027, 0.15963804721832275, 0.16166158020496368, 0.20533202588558197, 0.16039949655532837, 0.1624326854944229], [0.15094827115535736, 0.15983518958091736, 0.16180916130542755, 0.20426802337169647, 0.16057805716991425, 0.16256120800971985]], [[0.17255720496177673, 0.15776778757572174, 0.17414170503616333, 0.15921646356582642, 0.1618741750717163, 0.1744426190853119], [0.18048208951950073, 0.14581696689128876, 0.18445178866386414, 0.14902421832084656, 0.1550135314464569, 0.18521136045455933], [0.17173469066619873, 0.15900923311710358, 0.17308872938156128, 0.16026294231414795, 0.16255874931812286, 0.173345685005188], [0.17968609929084778, 0.1470169872045517, 0.18340210616588593, 0.1500573754310608, 0.15572483837604523, 0.18411259353160858], [0.17823690176010132, 0.14920175075531006, 0.1814994066953659, 0.15193277597427368, 0.1570068746805191, 0.18212231993675232], [0.171579048037529, 0.15924414992332458, 0.1728898286819458, 0.1604606956243515, 0.16268771886825562, 0.1731385439634323]], [[0.14869342744350433, 0.1588796228170395, 0.1611545830965042, 0.20336033403873444, 0.15973524749279022, 0.1681768000125885], [0.1505674123764038, 0.15976160764694214, 0.1618063896894455, 0.19923439621925354, 0.16053102910518646, 0.16809912025928497], [0.1509702503681183, 0.15994900465011597, 0.16194407641887665, 0.1983570009469986, 0.16069979965686798, 0.16807985305786133], [0.15759554505348206, 0.16292181611061096, 0.1640879064798355, 0.18439684808254242, 0.1633613407611847, 0.16763648390769958], [0.1507195681333542, 0.15983249247074127, 0.16185851395130157, 0.19890262186527252, 0.1605948805809021, 0.16809195280075073], [0.15218022465705872, 0.16050729155540466, 0.1623525321483612, 0.19574151933193207, 0.16120189428329468, 0.16801656782627106]], [[0.17121703922748566, 0.1561759114265442, 0.17555572092533112, 0.1601334512233734, 0.1610027402639389, 0.17591515183448792], [0.1755405068397522, 0.14592839777469635, 0.18459267914295197, 0.15345355868339539, 0.1551319807767868, 0.1853528469800949], [0.16999250650405884, 0.15902520716190338, 0.1731061339378357, 0.16193795204162598, 0.1625751107931137, 0.1733631193637848], [0.17439202964305878, 0.14868195354938507, 0.18212874233722687, 0.1552780568599701, 0.1567431539297104, 0.18277603387832642], [0.17414075136184692, 0.14928121864795685, 0.181596040725708, 0.15567222237586975, 0.15709049999713898, 0.18221929669380188], [0.16989155113697052, 0.15925918519496918, 0.17290614545345306, 0.1620851308107376, 0.16270308196544647, 0.17315489053726196]], [[0.15139828622341156, 0.15584991872310638, 0.15808148682117462, 0.2070595771074295, 0.16264097392559052, 0.164969801902771], [0.15211021900177002, 0.15637359023094177, 0.15850868821144104, 0.20505034923553467, 0.1628667414188385, 0.16509048640727997], [0.15245923399925232, 0.15662965178489685, 0.15871717035770416, 0.2040698081254959, 0.16297604143619537, 0.16514813899993896], [0.159053236246109, 0.1613822877407074, 0.1625373661518097, 0.18610242009162903, 0.16487236320972443, 0.1660524159669876], [0.1531568169593811, 0.15714006125926971, 0.1591319590806961, 0.20211896300315857, 0.1631917953491211, 0.16526038944721222], [0.1535053700208664, 0.1573944240808487, 0.15933826565742493, 0.20114867389202118, 0.16329826414585114, 0.16531501710414886]], [[0.17222470045089722, 0.15936222672462463, 0.17173562943935394, 0.15890967845916748, 0.1615622639656067, 0.1762055903673172], [0.17870956659317017, 0.1507069319486618, 0.17759722471237183, 0.1497688740491867, 0.15531274676322937, 0.1879047304391861], [0.17246554791927338, 0.15904341638088226, 0.17195437848567963, 0.1585720330476761, 0.16133591532707214, 0.1766287237405777], [0.17894338071346283, 0.15039187669754028, 0.17780742049217224, 0.14943717420101166, 0.15508119761943817, 0.1883389949798584], [0.17757834494113922, 0.15222808718681335, 0.1765790581703186, 0.15137144923210144, 0.1564267873764038, 0.18581636250019073], [0.17028090357780457, 0.16192784905433655, 0.1699673980474472, 0.16162973642349243, 0.1633729487657547, 0.17282116413116455]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0281912375128372e-05, "remove_single_ts_time_rank_from_batch": 1.1786912166856536e-05, "un_batch_to_individual_items": 6.387461093897714e-06, "normalize_and_clip_actions": 7.901414938657953e-06, "tensor_to_numpy": 1.488671600351187e-05, "get_actions": 3.529450883138734e-05}}, "connector_pipeline_timer": 0.00011247274576645058}, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2347250849574086e-05, "add_states_from_episodes_to_batch": 2.684489536495927e-06, "add_time_dim_to_batch_and_zero_pad": 6.9714354924450754e-06, "numpy_to_tensor": 1.1675490653068951e-05, "add_observations_from_episodes_to_batch": 2.792839071626752e-06}}, "connector_pipeline_timer": 5.856385751386321e-05}, "weights_seq_no": 2.0, "episode_len_mean": 20.0, "num_episodes": 20, "episode_return_max": 14.5, "rlmodule_inference_timer": 3.0250415015397635e-05, "num_episodes_lifetime": 40, "env_step_timer": 1.3973837826260035e-05, "episode_duration_sec_mean": 0.005209711453062482, "agent_episode_returns_mean": {"default_agent": -2.2}, "env_to_module_sum_episodes_length_out": 10.366003441359926, "env_reset_timer": 0.00018791438778862358, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "episode_len_max": 20, "episode_return_mean": -2.2, "module_episode_returns_mean": {"default_policy": -2.2}, "env_to_module_sum_episodes_length_in": 10.366003441359926, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "sample": 0.11515485276118853, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 10400, "episode_return_min": -13.5, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "time_between_sampling": 9.269646708038636}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "aeabe_00000", "date": "2025-08-11_18-49-34", "timestamp": 1754930974, "time_this_iter_s": 9.35960078239441, "time_total_s": 18.698426723480225, "pid": 11811, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161dfd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18.698426723480225, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 31.638461538461534, "ram_util_percent": 76.74615384615385}}
{"timers": {"training_iteration": 9.215712547453327, "restore_env_runners": 8.710196777246893e-06, "training_step": 9.215562993517796, "env_runner_sampling_timer": 1.6162671244650961, "learner_update_timer": 7.408530821437947, "synch_weights": 0.0008892601056490094, "restore_eval_env_runners": 8.243754273280501e-06, "evaluation_iteration": 0.12198921430041083, "synch_eval_env_connectors": 0.00011399295181035995, "synch_env_connectors": 4.92286286316812e-06}, "env_runners": {"module_episode_returns_mean": {"default_policy": -1.9}, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.581811631201513e-06, "remove_single_ts_time_rank_from_batch": 1.1797206283415363e-05, "normalize_and_clip_actions": 7.977561187266536e-06, "get_actions": 3.819379622665564e-05, "tensor_to_numpy": 1.4928233930205183e-05, "listify_data_for_vector_env": 1.032851409809989e-05}}, "connector_pipeline_timer": 0.00011637445470997823}, "episode_return_min": -11.5, "time_between_sampling": 0.031354020514367066, "agent_episode_returns_mean": {"default_agent": -1.9}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2595196002456743e-05, "add_states_from_episodes_to_batch": 2.664644652472994e-06, "add_observations_from_episodes_to_batch": 2.789976391780901e-06, "add_time_dim_to_batch_and_zero_pad": 6.7841088973518214e-06, "batch_individual_items": 1.231172383401086e-05}}, "connector_pipeline_timer": 5.92118564725965e-05}, "env_step_timer": 1.3723539460258625e-05, "episode_duration_sec_mean": 0.005202380669303238, "episode_return_mean": -1.9, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 2.0, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "episode_return_max": 8.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "rlmodule_inference_timer": 4.1403527057708366e-05, "sample": 0.005852200030882939, "num_episodes_lifetime": -30375.0, "num_env_steps_sampled_lifetime": -607500.0, "env_reset_timer": 3.623047364624146e-05, "num_env_steps_sampled_lifetime_throughput": 3303.6546357593506}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15341207619656344, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009450842292315792, "add_observations_from_episodes_to_batch": 0.0008708037136821076, "add_columns_from_episodes_to_train_batch": 0.04210924451339524, "add_time_dim_to_batch_and_zero_pad": 0.08961760098685045, "add_states_from_episodes_to_batch": 0.0036013274619705045, "batch_individual_items": 0.007508343358559068, "numpy_to_tensor": 8.594785913592204e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained_lifetime": 107730, "policy_loss": -8.04466544650495e-05, "diff_num_grad_updates_vs_sampler_policy": 16.0, "weights_seq_no": 18.0, "total_loss": 0.24862590432167053, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 6.441402547352482e-06, "vf_loss_unclipped": 42.880271911621094, "num_module_steps_trained": 35910, "vf_explained_var": -0.0027332305908203125, "module_train_batch_size_mean": 998.0016398003509, "vf_loss": 0.32061412930488586, "entropy": 0.6930509209632874}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 215460, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 648000, "num_env_steps_trained_lifetime_throughput": 65743.53836411377}, "intrinsic_reward_module": {"module_train_batch_size_mean": 998.0016398003509, "num_module_steps_trained_lifetime": 107730, "diff_num_grad_updates_vs_sampler_policy": 16.0, "weights_seq_no": 18.0, "total_loss": 0.0, "num_module_steps_trained": 35910}}}, "__all_modules__": {"num_module_steps_trained_lifetime": 35910, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 108000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4859.277192112676, "num_module_steps_trained_throughput": 30436628.217526343, "num_module_steps_trained_lifetime_throughput": 13366418.372728312}, "intrinsic_reward_module": {"module_train_batch_size_mean": 998.7505232584676, "num_trainable_parameters": 8266, "num_module_steps_trained_lifetime": 17955, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "weights_seq_no": 3.0, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 806.8832368748514}, "default_policy": {"vf_explained_var": -0.0020160675048828125, "module_train_batch_size_mean": 998.7505232584676, "num_trainable_parameters": 16595, "vf_loss_unclipped": 42.82020568847656, "num_module_steps_trained_lifetime": 17955, "policy_loss": -8.265026553999633e-05, "num_module_steps_trained": 5985, "vf_loss": 0.32051968574523926, "entropy": 0.6930508017539978, "curr_kl_coeff": 0.020197991281747818, "total_loss": 0.24854932725429535, "diff_num_grad_updates_vs_sampler_policy": 1.0, "use_intrinsic_rewards": 0.0, "weights_seq_no": 3.0, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 6.737124749633949e-06, "num_module_steps_trained_lifetime_throughput": 806.8665168880084}, "IntrinsicAttentionMask": [[[0.15054146945476532, 0.15282592177391052, 0.16139477491378784, 0.20649418234825134, 0.1598893702030182, 0.16885429620742798], [0.150888130068779, 0.15312857925891876, 0.16152606904506683, 0.20557712018489838, 0.16005146503448486, 0.16882862150669098], [0.15214331448078156, 0.15422256290912628, 0.16199474036693573, 0.20227955281734467, 0.16063231229782104, 0.16872753202915192], [0.15779897570610046, 0.15911570191383362, 0.16397777199745178, 0.18785840272903442, 0.16313211619853973, 0.16811692714691162], [0.15192778408527374, 0.15403491258621216, 0.16191498935222626, 0.2028433084487915, 0.16053324937820435, 0.16874580085277557], [0.15318211913108826, 0.15512575209140778, 0.16237476468086243, 0.1995772421360016, 0.16110587120056152, 0.1686343252658844]], [[0.169921413064003, 0.15989187359809875, 0.17328137159347534, 0.15947097539901733, 0.16193684935569763, 0.17549759149551392], [0.17324483394622803, 0.15255239605903625, 0.18048438429832458, 0.1517139971256256, 0.15666013956069946, 0.18534424901008606], [0.16880066692829132, 0.16226619482040405, 0.1709592640399933, 0.16198886930942535, 0.16360995173454285, 0.17237502336502075], [0.17338323593139648, 0.1522359400987625, 0.18079577386379242, 0.15138041973114014, 0.15642906725406647, 0.18577556312084198], [0.17257095873355865, 0.1540801227092743, 0.17898203432559967, 0.1533253937959671, 0.15777148306369781, 0.18326999247074127], [0.16806049644947052, 0.16380971670150757, 0.16945192217826843, 0.1636279970407486, 0.16468870639801025, 0.17036117613315582]], [[0.1483655571937561, 0.15668433904647827, 0.15290258824825287, 0.21170757710933685, 0.1639261394739151, 0.16641370952129364], [0.14978747069835663, 0.1575196385383606, 0.15400859713554382, 0.20793665945529938, 0.16422486305236816, 0.1665227711200714], [0.14915072917938232, 0.15714682638645172, 0.1535140872001648, 0.20961956679821014, 0.16409294307231903, 0.16647587716579437], [0.15761876106262207, 0.16193947196006775, 0.15998996794223785, 0.1879958212375641, 0.1656074821949005, 0.16684852540493011], [0.15096472203731537, 0.15820355713367462, 0.15491965413093567, 0.20484985411167145, 0.16446098685264587, 0.16660131514072418], [0.1513570249080658, 0.15842992067337036, 0.1552223265171051, 0.20382821559906006, 0.16453740000724792, 0.16662511229515076]], [[0.17122119665145874, 0.15841275453567505, 0.17555999755859375, 0.1578799933195114, 0.16100668907165527, 0.17591942846775055], [0.17490553855895996, 0.1514316201210022, 0.1832091510295868, 0.15048907697200775, 0.1560596227645874, 0.1839049756526947], [0.16999471187591553, 0.16067323088645935, 0.17310838401317596, 0.16028112173080444, 0.16257721185684204, 0.17336536943912506], [0.1750607043504715, 0.1511308252811432, 0.1835414171218872, 0.1501714289188385, 0.15584319829940796, 0.18425245583057404], [0.1741521954536438, 0.15288403630256653, 0.18160796165466309, 0.15202370285987854, 0.1571008414030075, 0.18223126232624054], [0.16989362239837646, 0.16085822880268097, 0.1729082614183426, 0.16047780215740204, 0.16270507872104645, 0.1731570065021515]], [[0.14933966100215912, 0.1595701426267624, 0.1559320092201233, 0.21200215816497803, 0.16042949259281158, 0.16272664070129395], [0.1511818915605545, 0.16041359305381775, 0.15713800489902496, 0.2068312019109726, 0.16118614375591278, 0.1632491648197174], [0.15054097771644592, 0.1601225733757019, 0.15672016143798828, 0.2086206078529358, 0.16092544794082642, 0.1630702167749405], [0.15904474258422852, 0.1637747436761856, 0.16211259365081787, 0.18570387363433838, 0.16416426002979279, 0.16519980132579803], [0.1513310819864273, 0.16048097610473633, 0.15723499655723572, 0.20641610026359558, 0.16124644875526428, 0.1632903814315796], [0.15172596275806427, 0.16065861284732819, 0.15749122202396393, 0.20532022416591644, 0.16140532493591309, 0.16339868307113647]], [[0.17289060354232788, 0.1580726057291031, 0.17447815835475922, 0.1595240980386734, 0.1602548360824585, 0.17477966845035553], [0.18127226829528809, 0.14645546674728394, 0.18525934219360352, 0.14967675507068634, 0.1513138711452484, 0.18602225184440613], [0.17202115058898926, 0.15927445888519287, 0.17337745428085327, 0.16053026914596558, 0.1611618846654892, 0.1736348420381546], [0.1804300844669342, 0.14762578904628754, 0.1841614991426468, 0.15067878365516663, 0.15222886204719543, 0.18487492203712463], [0.18000784516334534, 0.14821229875087738, 0.18361231684684753, 0.15118010342121124, 0.152686208486557, 0.1843012273311615], [0.17185665667057037, 0.1595017910003662, 0.1731695532798767, 0.1607203185558319, 0.16133306920528412, 0.17341867089271545]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.2399290759578523e-05, "remove_single_ts_time_rank_from_batch": 1.3377258537115911e-05, "un_batch_to_individual_items": 7.433640952047264e-06, "normalize_and_clip_actions": 9.227481780023404e-06, "tensor_to_numpy": 1.8180829171817933e-05, "get_actions": 4.620407160724014e-05}}, "connector_pipeline_timer": 0.0001388701028052235}, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.4784761006474357e-05, "add_states_from_episodes_to_batch": 2.927617790917725e-06, "add_time_dim_to_batch_and_zero_pad": 8.974888527197076e-06, "numpy_to_tensor": 1.575916682125533e-05, "add_observations_from_episodes_to_batch": 3.2663464594300603e-06}}, "connector_pipeline_timer": 7.260075536872341e-05}, "weights_seq_no": 3.0, "episode_len_mean": 20.0, "num_episodes": 20, "episode_return_max": 14.5, "rlmodule_inference_timer": 3.882027220473544e-05, "num_episodes_lifetime": 60, "env_step_timer": 1.7860040660220486e-05, "episode_duration_sec_mean": 0.005480751406867057, "agent_episode_returns_mean": {"default_agent": -0.8666666666666667}, "env_to_module_sum_episodes_length_out": 10.368205581254823, "env_reset_timer": 0.00018675441353116186, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "episode_len_max": 20, "episode_return_mean": -0.8666666666666667, "module_episode_returns_mean": {"default_policy": -0.8666666666666667}, "env_to_module_sum_episodes_length_in": 10.368205581254823, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "sample": 0.11531472757438897, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 15400, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "time_between_sampling": 9.270238158458378}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "aeabe_00000", "date": "2025-08-11_18-49-44", "timestamp": 1754930984, "time_this_iter_s": 9.447510004043579, "time_total_s": 28.145936727523804, "pid": 11811, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161dfd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 28.145936727523804, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 30.384615384615383, "ram_util_percent": 77.29230769230767}}
{"timers": {"training_iteration": 9.215279609059774, "restore_env_runners": 8.700594817521052e-06, "training_step": 9.21512945441248, "env_runner_sampling_timer": 1.6153199548904722, "learner_update_timer": 7.408919504052996, "synch_weights": 0.0008881112550585531, "restore_eval_env_runners": 8.24798677349463e-06, "evaluation_iteration": 0.1221411242373637, "synch_eval_env_connectors": 0.0001140359416604042, "synch_env_connectors": 4.921134014148265e-06}, "env_runners": {"module_episode_returns_mean": {"default_policy": -1.9}, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.647261020999739e-06, "remove_single_ts_time_rank_from_batch": 1.1854908447940227e-05, "normalize_and_clip_actions": 8.048713217904935e-06, "get_actions": 3.832938158680807e-05, "tensor_to_numpy": 1.505963802171987e-05, "listify_data_for_vector_env": 1.0511774553289652e-05}}, "connector_pipeline_timer": 0.00011725037961532602}, "episode_return_min": -11.5, "time_between_sampling": 0.03225455894938733, "agent_episode_returns_mean": {"default_agent": -1.9}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2661441704190688e-05, "add_states_from_episodes_to_batch": 2.689300341522107e-06, "add_observations_from_episodes_to_batch": 2.8256316356926775e-06, "add_time_dim_to_batch_and_zero_pad": 6.93701117618198e-06, "batch_individual_items": 1.2579704015742941e-05}}, "connector_pipeline_timer": 5.983432093704277e-05}, "env_step_timer": 1.3833404717186425e-05, "episode_duration_sec_mean": 0.005241498717572539, "episode_return_mean": -1.9, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 3.0, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "episode_return_max": 8.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "rlmodule_inference_timer": 3.068317452297821e-05, "sample": 0.0056273693433380656, "num_episodes_lifetime": -61250.0, "num_env_steps_sampled_lifetime": -1225000.0, "env_reset_timer": 3.707036683364405e-05, "num_env_steps_sampled_lifetime_throughput": 3295.7574200965214}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15340702835352696, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009442028038785443, "add_observations_from_episodes_to_batch": 0.0008704731757252011, "add_columns_from_episodes_to_train_batch": 0.04210495373906031, "add_time_dim_to_batch_and_zero_pad": 0.08962146413760609, "add_states_from_episodes_to_batch": 0.0036065358574587153, "batch_individual_items": 0.007508147845610161, "numpy_to_tensor": 8.590547058463562e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained_lifetime": 143640, "policy_loss": -8.401488594245166e-05, "diff_num_grad_updates_vs_sampler_policy": 21.0, "weights_seq_no": 24.0, "total_loss": 0.2486124187707901, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 1.2497493116825353e-05, "vf_loss_unclipped": 42.81059646606445, "num_module_steps_trained": 35910, "vf_explained_var": -0.0026993751525878906, "module_train_batch_size_mean": 997.847060245087, "vf_loss": 0.32060006260871887, "entropy": 0.6930234432220459}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 287280, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 864000, "num_env_steps_trained_lifetime_throughput": 64900.233692156144}, "intrinsic_reward_module": {"module_train_batch_size_mean": 997.847060245087, "num_module_steps_trained_lifetime": 143640, "diff_num_grad_updates_vs_sampler_policy": 21.0, "weights_seq_no": 24.0, "total_loss": 0.0, "num_module_steps_trained": 35910}}}, "__all_modules__": {"num_module_steps_trained_lifetime": 47880, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 144000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4845.354014542823, "num_module_steps_trained_throughput": 29696005.670559, "num_module_steps_trained_lifetime_throughput": 13347823.749226531}, "intrinsic_reward_module": {"module_train_batch_size_mean": 998.6769017198101, "num_trainable_parameters": 8266, "num_module_steps_trained_lifetime": 23940, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "weights_seq_no": 4.0, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 804.5932188635162}, "default_policy": {"vf_explained_var": 0.00036603212356567383, "module_train_batch_size_mean": 998.6769017198101, "num_trainable_parameters": 16595, "vf_loss_unclipped": 42.67420196533203, "num_module_steps_trained_lifetime": 23940, "policy_loss": -8.642069587949663e-05, "num_module_steps_trained": 5985, "vf_loss": 0.3205114006996155, "entropy": 0.6930227875709534, "curr_kl_coeff": 0.010098995640873909, "total_loss": 0.24853914976119995, "diff_num_grad_updates_vs_sampler_policy": 1.0, "use_intrinsic_rewards": 0.0, "weights_seq_no": 4.0, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 1.2890936886833515e-05, "num_module_steps_trained_lifetime_throughput": 804.5770496318443}, "IntrinsicAttentionMask": [[[0.15021681785583496, 0.15463371574878693, 0.15684786438941956, 0.21324734389781952, 0.16137176752090454, 0.16368241608142853], [0.15098939836025238, 0.1552213728427887, 0.15734073519706726, 0.2109077125787735, 0.16166667640209198, 0.1638740450143814], [0.15136800706386566, 0.15550856292247772, 0.1575811356306076, 0.2097667008638382, 0.1618095338344574, 0.1639660745859146], [0.15947183966636658, 0.16152901947498322, 0.16254793107509613, 0.18620258569717407, 0.16460511088371277, 0.16564345359802246], [0.15212427079677582, 0.1560806781053543, 0.15805912017822266, 0.2074979990720749, 0.16209159791469574, 0.16414625942707062], [0.15250198543071747, 0.15636563301086426, 0.15829673409461975, 0.20637036859989166, 0.16223086416721344, 0.16423442959785461]], [[0.16992267966270447, 0.15989308059215546, 0.1732826828956604, 0.16125352680683136, 0.16014917194843292, 0.17549891769886017], [0.17325031757354736, 0.15255725383758545, 0.18049009144306183, 0.15528368949890137, 0.15306854248046875, 0.18535010516643524], [0.1688012182712555, 0.16226671636104584, 0.17095981538295746, 0.16316133737564087, 0.16243532299995422, 0.17237558960914612], [0.17280152440071106, 0.15357476472854614, 0.1794879138469696, 0.15611833333969116, 0.1540520191192627, 0.18396545946598053], [0.1731659173965454, 0.15274934470653534, 0.18030084669589996, 0.15544141829013824, 0.15325424075126648, 0.18508826196193695], [0.16806071996688843, 0.16380994021892548, 0.16945216059684753, 0.16439540684223175, 0.16392037272453308, 0.17036141455173492]], [[0.14963488280773163, 0.1580248475074768, 0.16042287647724152, 0.2052506059408188, 0.16532860696315765, 0.161338210105896], [0.15094727277755737, 0.15873929858207703, 0.16096046566963196, 0.20204882323741913, 0.16549646854400635, 0.16180762648582458], [0.1513098180294037, 0.15893523395061493, 0.16110728681087494, 0.20117133855819702, 0.16554085910320282, 0.16193553805351257], [0.15725253522396088, 0.16205768287181854, 0.16340991854667664, 0.18720783293247223, 0.1661483645439148, 0.1639236956834793], [0.15203511714935303, 0.1593252718448639, 0.161398783326149, 0.1994246244430542, 0.16562707722187042, 0.16218909621238708], [0.15144677460193634, 0.15900906920433044, 0.16116254031658173, 0.2008405327796936, 0.1655573844909668, 0.1619836390018463]], [[0.17203740775585175, 0.15916790068149567, 0.17391033470630646, 0.15863260626792908, 0.15949377417564392, 0.1767580360174179], [0.17646028101444244, 0.15277773141860962, 0.1800374686717987, 0.15182679891586304, 0.15335799753665924, 0.18553970754146576], [0.1714092344045639, 0.16005904972553253, 0.17305245995521545, 0.1595846563577652, 0.16034777462482452, 0.17554689943790436], [0.17664825916290283, 0.1525014042854309, 0.18030144274234772, 0.151533305644989, 0.1530921906232834, 0.18592336773872375], [0.17634598910808563, 0.15294553339481354, 0.1798771470785141, 0.15200504660606384, 0.1535193771123886, 0.18530689179897308], [0.17046160995960236, 0.16139602661132812, 0.17176386713981628, 0.16101433336734772, 0.16162820160388947, 0.17373591661453247]], [[0.14840784668922424, 0.15672899782657623, 0.15910734236240387, 0.21176782250404358, 0.1639728546142578, 0.16001519560813904], [0.14982394874095917, 0.15755797922611237, 0.15976260602474213, 0.2079872041940689, 0.16426484286785126, 0.16060346364974976], [0.15021486580371857, 0.1577850729227066, 0.1599414199590683, 0.20695209503173828, 0.16434291005134583, 0.160763680934906], [0.1576300412416458, 0.16195105016231537, 0.16316470503807068, 0.18800926208496094, 0.16561932861804962, 0.1636255532503128], [0.1509966403245926, 0.15823698043823242, 0.16029633581638336, 0.2048930674791336, 0.16449575126171112, 0.1610812544822693], [0.1503625214099884, 0.15787066519260406, 0.1600087285041809, 0.20656201243400574, 0.16437210142612457, 0.16082394123077393]], [[0.17022335529327393, 0.1584065705537796, 0.173589289188385, 0.16153883934020996, 0.16043254733085632, 0.17580945789813995], [0.17449411749839783, 0.14798933267593384, 0.18249614536762238, 0.15477590262889862, 0.15235933661460876, 0.187885120511055], [0.16899819672107697, 0.16128918528556824, 0.1711593121290207, 0.16335172951221466, 0.16262486577033997, 0.17257674038410187], [0.17336881160736084, 0.15079596638679504, 0.18007713556289673, 0.15663087368011475, 0.15455776453018188, 0.18456938862800598], [0.17376698553562164, 0.14980843663215637, 0.18092668056488037, 0.15598097443580627, 0.15378621220588684, 0.1857307106256485], [0.16818930208683014, 0.1631702184677124, 0.169581800699234, 0.16452117264270782, 0.1640457659959793, 0.1704917550086975]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.030405417167881e-05, "remove_single_ts_time_rank_from_batch": 1.1937322072206044e-05, "un_batch_to_individual_items": 6.43208776908065e-06, "normalize_and_clip_actions": 7.776800263731516e-06, "tensor_to_numpy": 1.4751848551332832e-05, "get_actions": 3.547372978582378e-05}}, "connector_pipeline_timer": 0.00011258645399491265}, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2304301327548543e-05, "add_states_from_episodes_to_batch": 2.645318686606109e-06, "add_time_dim_to_batch_and_zero_pad": 6.826064824866512e-06, "numpy_to_tensor": 1.1703587429111194e-05, "add_observations_from_episodes_to_batch": 2.809872857536286e-06}}, "connector_pipeline_timer": 5.8213308603268516e-05}, "weights_seq_no": 4.0, "episode_len_mean": 20.0, "num_episodes": 20, "episode_return_max": 14.5, "rlmodule_inference_timer": 3.0077275895389854e-05, "num_episodes_lifetime": 80, "env_step_timer": 1.3764196441020718e-05, "episode_duration_sec_mean": 0.005384612010675483, "agent_episode_returns_mean": {"default_agent": -0.45}, "env_to_module_sum_episodes_length_out": 10.368237912813044, "env_reset_timer": 0.00018561019969987687, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "episode_len_max": 20, "episode_return_mean": -0.45, "module_episode_returns_mean": {"default_policy": -0.45}, "env_to_module_sum_episodes_length_in": 10.368237912813044, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "sample": 0.11526766404913705, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 20400, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "time_between_sampling": 9.269591759374109}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "aeabe_00000", "date": "2025-08-11_18-49-53", "timestamp": 1754930993, "time_this_iter_s": 9.290791273117065, "time_total_s": 37.43672800064087, "pid": 11811, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161dfd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 37.43672800064087, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 34.42142857142857, "ram_util_percent": 76.98571428571428}}
{"timers": {"training_iteration": 9.214507282139575, "restore_env_runners": 8.671918766347228e-06, "training_step": 9.214356695699236, "env_runner_sampling_timer": 1.6141890570108, "learner_update_timer": 7.40918952609252, "synch_weights": 0.0008895051427486213, "restore_eval_env_runners": 8.252167635480873e-06, "evaluation_iteration": 0.12207646382511327, "synch_eval_env_connectors": 0.00011388850132934748, "synch_env_connectors": 4.917342111817561e-06}, "env_runners": {"module_episode_returns_mean": {"default_policy": -2.1399999999999997}, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.584843266686314e-06, "remove_single_ts_time_rank_from_batch": 1.1762398469157803e-05, "normalize_and_clip_actions": 7.93100772636084e-06, "get_actions": 3.775700179434679e-05, "tensor_to_numpy": 1.477870207772405e-05, "listify_data_for_vector_env": 1.0303683087739965e-05}}, "connector_pipeline_timer": 0.00011562348068007832}, "episode_return_min": -11.5, "time_between_sampling": 0.031664415111902953, "agent_episode_returns_mean": {"default_agent": -2.1399999999999997}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2360593544719601e-05, "add_states_from_episodes_to_batch": 2.6617530161792075e-06, "add_observations_from_episodes_to_batch": 2.7925931061685214e-06, "add_time_dim_to_batch_and_zero_pad": 6.852034647944398e-06, "batch_individual_items": 1.2381307790044957e-05}}, "connector_pipeline_timer": 5.913074103510299e-05}, "env_step_timer": 1.3683375444230434e-05, "episode_duration_sec_mean": 0.005174528637435288, "episode_return_mean": -2.1399999999999997, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 4.0, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "episode_return_max": 8.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "rlmodule_inference_timer": 3.041142327962446e-05, "sample": 0.005534933372170909, "num_episodes_lifetime": -92125.0, "num_env_steps_sampled_lifetime": -1842500.0, "env_reset_timer": 3.6291316953861915e-05, "num_env_steps_sampled_lifetime_throughput": 3310.2660920781827}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1533851001603514, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009434182347765545, "add_observations_from_episodes_to_batch": 0.0008699401138739544, "add_columns_from_episodes_to_train_batch": 0.042096324202317834, "add_time_dim_to_batch_and_zero_pad": 0.089612134077062, "add_states_from_episodes_to_batch": 0.0036074984083045588, "batch_individual_items": 0.007512271786323798, "numpy_to_tensor": 8.575391602735384e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained_lifetime": 179550, "policy_loss": -0.0005775212193839252, "diff_num_grad_updates_vs_sampler_policy": 26.0, "weights_seq_no": 30.0, "total_loss": 0.24811260402202606, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 4.535272819339298e-05, "vf_loss_unclipped": 42.73196029663086, "num_module_steps_trained": 35910, "vf_explained_var": -0.0027108192443847656, "module_train_batch_size_mean": 997.7394089995611, "vf_loss": 0.32058489322662354, "entropy": 0.6928853988647461}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 359100, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 1080000, "num_env_steps_trained_lifetime_throughput": 63935.03399635587}, "intrinsic_reward_module": {"module_train_batch_size_mean": 997.7394089995611, "num_module_steps_trained_lifetime": 179550, "diff_num_grad_updates_vs_sampler_policy": 26.0, "weights_seq_no": 30.0, "total_loss": 0.0, "num_module_steps_trained": 35910}}}, "__all_modules__": {"num_module_steps_trained_lifetime": 59850, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 180000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4830.049386407847, "num_module_steps_trained_throughput": 28920435.90883463, "num_module_steps_trained_lifetime_throughput": 13326159.549034337}, "intrinsic_reward_module": {"module_train_batch_size_mean": 998.6075885025957, "num_trainable_parameters": 8266, "num_module_steps_trained_lifetime": 29925, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "weights_seq_no": 5.0, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 802.0768751072237}, "default_policy": {"vf_explained_var": 0.0016373395919799805, "module_train_batch_size_mean": 998.6075885025957, "num_trainable_parameters": 16595, "vf_loss_unclipped": 42.55321502685547, "num_module_steps_trained_lifetime": 29925, "policy_loss": -0.0005978808621875942, "num_module_steps_trained": 5985, "vf_loss": 0.3205161392688751, "entropy": 0.6928795576095581, "curr_kl_coeff": 0.0050494978204369545, "total_loss": 0.2480318546295166, "diff_num_grad_updates_vs_sampler_policy": 1.0, "use_intrinsic_rewards": 0.0, "weights_seq_no": 5.0, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 4.840844849240966e-05, "num_module_steps_trained_lifetime_throughput": 802.0613528737396}, "IntrinsicAttentionMask": [[[0.1495780646800995, 0.15184789896011353, 0.16036193072795868, 0.2051725834608078, 0.16526581346988678, 0.16777370870113373], [0.14994247257709503, 0.152168869972229, 0.1605137288570404, 0.2042885571718216, 0.16531582176685333, 0.16777049005031586], [0.15126290917396545, 0.15333010256290436, 0.16105732321739197, 0.2011089026927948, 0.16548952460289001, 0.16775114834308624], [0.15723395347595215, 0.15854595601558685, 0.1633906364440918, 0.18718571960926056, 0.1661287546157837, 0.16751496493816376], [0.15199227631092072, 0.15397034585475922, 0.16135329008102417, 0.19936837255954742, 0.1655804067850113, 0.16773530840873718], [0.15235701203346252, 0.15429016947746277, 0.16150014102458954, 0.19850213825702667, 0.1656244993209839, 0.16772599518299103]], [[0.17164179682731628, 0.15656335651874542, 0.17351041734218597, 0.1605307161808014, 0.16140218079090118, 0.17635156214237213], [0.176456481218338, 0.14668993651866913, 0.18033765256404877, 0.15425436198711395, 0.15594156086444855, 0.18632002174854279], [0.17106066644191742, 0.15774786472320557, 0.17270056903362274, 0.16126488149166107, 0.1620360165834427, 0.17518992722034454], [0.17516805231571198, 0.14934363961219788, 0.17848919332027435, 0.15596909821033478, 0.15744072198867798, 0.18358935415744781], [0.17488709092140198, 0.14992107450962067, 0.1780882626771927, 0.15633948147296906, 0.15776382386684418, 0.18300025165081024], [0.1701836884021759, 0.1595330536365509, 0.1714838147163391, 0.16236385703086853, 0.16298288106918335, 0.17345266044139862]], [[0.14835193753242493, 0.15060316026210785, 0.15904740989208221, 0.21168801188468933, 0.16391108930110931, 0.16639842092990875], [0.14874504506587982, 0.15095365047454834, 0.15923188626766205, 0.21064303815364838, 0.163995623588562, 0.16643071174621582], [0.15016864240169525, 0.15222090482711792, 0.15989220142364502, 0.20688840746879578, 0.1642923355102539, 0.16653761267662048], [0.1576150506734848, 0.15879619121551514, 0.1631491780281067, 0.18799136579036713, 0.16560357809066772, 0.16684459149837494], [0.15095435082912445, 0.15291890501976013, 0.1602514535188675, 0.2048356831073761, 0.16444967687129974, 0.1665898710489273], [0.15134714543819427, 0.1532674878835678, 0.1604296714067459, 0.2038148194551468, 0.16452665627002716, 0.16661423444747925]], [[0.17025145888328552, 0.16020244359970093, 0.17361795902252197, 0.15978072583675385, 0.16225139796733856, 0.17389602959156036], [0.17398510873317719, 0.1532043069601059, 0.18125559389591217, 0.15236233174800873, 0.15732958912849426, 0.18186306953430176], [0.16900993883609772, 0.1624673455953598, 0.17117121815681458, 0.16218969225883484, 0.1638127863407135, 0.17134907841682434], [0.1741424798965454, 0.15290263295173645, 0.18158748745918274, 0.1520433872938156, 0.1571141481399536, 0.18220986425876617], [0.17322112619876862, 0.1546606868505478, 0.17965637147426605, 0.15390309691429138, 0.15836594998836517, 0.180192768573761], [0.16890762746334076, 0.16265267133712769, 0.17097151279449463, 0.1623869687318802, 0.16393986344337463, 0.17114131152629852]], [[0.14931342005729675, 0.1576853096485138, 0.15387941896915436, 0.2130599468946457, 0.1585850715637207, 0.1674768626689911], [0.15067288279533386, 0.15845072269439697, 0.15491895377635956, 0.20916566252708435, 0.15928469598293304, 0.1675070822238922], [0.15006430447101593, 0.1581093817949295, 0.15445439517498016, 0.21090339124202728, 0.15897290408611298, 0.16749556362628937], [0.15812642872333527, 0.162461057305336, 0.1605052798986435, 0.1886013150215149, 0.16291992366313934, 0.16738592088222504], [0.15081451833248138, 0.1585298627614975, 0.1550268977880478, 0.20876245200634003, 0.15935693681240082, 0.1675093024969101], [0.1521712839603424, 0.15928223729133606, 0.15605740249156952, 0.20492467284202576, 0.16004274785518646, 0.16752155125141144]], [[0.17203740775585175, 0.15916790068149567, 0.17391033470630646, 0.15863262116909027, 0.15949377417564392, 0.1767580360174179], [0.17646026611328125, 0.152777761220932, 0.1800374537706375, 0.15182682871818542, 0.15335801243782043, 0.18553967773914337], [0.1714092344045639, 0.16005904972553253, 0.17305245995521545, 0.1595846563577652, 0.16034777462482452, 0.17554689943790436], [0.17664824426174164, 0.1525014340877533, 0.18030142784118652, 0.1515333354473114, 0.15309222042560577, 0.18592335283756256], [0.17634598910808563, 0.15294556319713593, 0.1798771321773529, 0.15200507640838623, 0.153519406914711, 0.1853068768978119], [0.17046160995960236, 0.16139601171016693, 0.17176386713981628, 0.16101433336734772, 0.16162820160388947, 0.17373591661453247]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0317967694071585e-05, "remove_single_ts_time_rank_from_batch": 1.1832513336785168e-05, "un_batch_to_individual_items": 6.470238844328619e-06, "normalize_and_clip_actions": 7.873625848334705e-06, "tensor_to_numpy": 1.4629287616791205e-05, "get_actions": 3.495449964556713e-05}}, "connector_pipeline_timer": 0.00011182756258513279}, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2148709512402287e-05, "add_states_from_episodes_to_batch": 2.611868953679043e-06, "add_time_dim_to_batch_and_zero_pad": 6.688390540756903e-06, "numpy_to_tensor": 1.1685021623729792e-05, "add_observations_from_episodes_to_batch": 2.7767355555317715e-06}}, "connector_pipeline_timer": 5.7681186724509246e-05}, "weights_seq_no": 5.0, "episode_len_mean": 20.0, "num_episodes": 20, "episode_return_max": 14.5, "rlmodule_inference_timer": 3.0492122090601337e-05, "num_episodes_lifetime": 100, "env_step_timer": 1.3594764853137031e-05, "episode_duration_sec_mean": 0.005325675430940464, "agent_episode_returns_mean": {"default_agent": -1.0}, "env_to_module_sum_episodes_length_out": 10.368238387501162, "env_reset_timer": 0.0001845228486088687, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "episode_len_max": 20, "episode_return_mean": -1.0, "module_episode_returns_mean": {"default_policy": -1.0}, "env_to_module_sum_episodes_length_in": 10.368238387501162, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "sample": 0.11521997074796468, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 25400, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "time_between_sampling": 9.268483532200351}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "aeabe_00000", "date": "2025-08-11_18-50-02", "timestamp": 1754931002, "time_this_iter_s": 9.237913846969604, "time_total_s": 46.674641847610474, "pid": 11811, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161dfd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 46.674641847610474, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 34.230769230769226, "ram_util_percent": 76.9076923076923}}
{"timers": {"training_iteration": 9.213633408487748, "restore_env_runners": 8.647699472512982e-06, "training_step": 9.213482264991564, "env_runner_sampling_timer": 1.6130665372715425, "learner_update_timer": 7.409367219161657, "synch_weights": 0.000888455921726266, "restore_eval_env_runners": 8.234235507982085e-06, "evaluation_iteration": 0.12201282001631024, "synch_eval_env_connectors": 0.00011385461541684343, "synch_env_connectors": 4.916918770867632e-06}, "env_runners": {"module_episode_returns_mean": {"default_policy": -0.54}, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.5718355731518905e-06, "remove_single_ts_time_rank_from_batch": 1.1758764430343207e-05, "normalize_and_clip_actions": 7.919362241995214e-06, "get_actions": 3.766808714944872e-05, "tensor_to_numpy": 1.4804849222043875e-05, "listify_data_for_vector_env": 1.0304969813145043e-05}}, "connector_pipeline_timer": 0.00011550999817919413}, "episode_return_min": -11.5, "time_between_sampling": 0.03156394196721146, "agent_episode_returns_mean": {"default_agent": -0.54}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2360979550120859e-05, "add_states_from_episodes_to_batch": 2.6571191827148635e-06, "add_observations_from_episodes_to_batch": 2.7604998911644724e-06, "add_time_dim_to_batch_and_zero_pad": 6.7753630186613725e-06, "batch_individual_items": 1.233940373681147e-05}}, "connector_pipeline_timer": 5.891998666329018e-05}, "env_step_timer": 1.3616345905410002e-05, "episode_duration_sec_mean": 0.005166951634455471, "episode_return_mean": -0.54, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 5.0, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "episode_return_max": 8.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "rlmodule_inference_timer": 3.0300751743760514e-05, "sample": 0.0055236583828111, "num_episodes_lifetime": -123000.0, "num_env_steps_sampled_lifetime": -2460000.0, "env_reset_timer": 3.828473001542693e-05, "num_env_steps_sampled_lifetime_throughput": 3317.822624032419}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15334397207912281, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009425701364332805, "add_observations_from_episodes_to_batch": 0.0008708707127211332, "add_columns_from_episodes_to_train_batch": 0.04207807179038895, "add_time_dim_to_batch_and_zero_pad": 0.08959819898681971, "add_states_from_episodes_to_batch": 0.0036095363337545964, "batch_individual_items": 0.007509392818788758, "numpy_to_tensor": 8.564387732022461e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained_lifetime": 215460, "policy_loss": -0.0002961108402814716, "diff_num_grad_updates_vs_sampler_policy": 31.0, "weights_seq_no": 36.0, "total_loss": 0.2483764886856079, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 1.6986383343464695e-05, "vf_loss_unclipped": 42.097469329833984, "num_module_steps_trained": 35910, "vf_explained_var": -0.0026700496673583984, "module_train_batch_size_mean": 997.6644392492373, "vf_loss": 0.3205679655075073, "entropy": 0.6927126049995422}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 430920, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 1296000, "num_env_steps_trained_lifetime_throughput": 62899.006061955166}, "intrinsic_reward_module": {"module_train_batch_size_mean": 997.6644392492373, "num_module_steps_trained_lifetime": 215460, "diff_num_grad_updates_vs_sampler_policy": 31.0, "weights_seq_no": 36.0, "total_loss": 0.0, "num_module_steps_trained": 35910}}}, "__all_modules__": {"num_module_steps_trained_lifetime": 71820, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 216000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4814.03628168164, "num_module_steps_trained_throughput": 28147350.795452762, "num_module_steps_trained_lifetime_throughput": 13304384.636077773}, "intrinsic_reward_module": {"module_train_batch_size_mean": 998.5423314844973, "num_trainable_parameters": 8266, "num_module_steps_trained_lifetime": 35910, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "weights_seq_no": 6.0, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 799.4443857984521}, "default_policy": {"vf_explained_var": 0.0008717775344848633, "module_train_batch_size_mean": 998.5423314844973, "num_trainable_parameters": 16595, "vf_loss_unclipped": 41.968631744384766, "num_module_steps_trained_lifetime": 35910, "policy_loss": -0.0003104944189544767, "num_module_steps_trained": 5985, "vf_loss": 0.3205115795135498, "entropy": 0.6927063465118408, "curr_kl_coeff": 0.0025247489102184772, "total_loss": 0.24831552803516388, "diff_num_grad_updates_vs_sampler_policy": 1.0, "use_intrinsic_rewards": 0.0, "weights_seq_no": 6.0, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 1.8467313566361554e-05, "num_module_steps_trained_lifetime_throughput": 799.4295479911383}, "IntrinsicAttentionMask": [[[0.1475536972284317, 0.1576617956161499, 0.15991933643817902, 0.20946665108203888, 0.15851087868213654, 0.16688771545886993], [0.14955702424049377, 0.1586894989013672, 0.1607205867767334, 0.20460814237594604, 0.15945376455783844, 0.16697107255458832], [0.1499873250722885, 0.15890762209892273, 0.16088970005512238, 0.2035762369632721, 0.15965351462364197, 0.16698551177978516], [0.15818393230438232, 0.16288834810256958, 0.16391584277153015, 0.18469879031181335, 0.16327576339244843, 0.16703741252422333], [0.14971956610679626, 0.15877199172973633, 0.16078458726406097, 0.20421786606311798, 0.15952932834625244, 0.166976660490036], [0.15127922594547272, 0.15955697000026703, 0.16139130294322968, 0.2005031555891037, 0.16024747490882874, 0.16702178120613098]], [[0.17288565635681152, 0.15806809067726135, 0.17239470779895782, 0.15951953828334808, 0.16025026142597198, 0.1768818348646164], [0.18124091625213623, 0.14643020927906036, 0.18001830577850342, 0.1496509313583374, 0.1512877643108368, 0.19137190282344818], [0.17315515875816345, 0.15769433975219727, 0.17264194786548615, 0.1592060923576355, 0.15996740758419037, 0.1773349940776825], [0.18040263652801514, 0.14760339260101318, 0.17925743758678436, 0.15065592527389526, 0.15220576524734497, 0.18987487256526947], [0.17998220026493073, 0.14819125831127167, 0.17887547612190247, 0.1511586308479309, 0.15266452729701996, 0.1891278773546219], [0.170710489153862, 0.16108053922653198, 0.17039619386196136, 0.16203747689723969, 0.16251808404922485, 0.17325717210769653]], [[0.15059906244277954, 0.1590430736541748, 0.16145652532577515, 0.2065729945898056, 0.15995055437088013, 0.16237780451774597], [0.1518465131521225, 0.1596849411725998, 0.16191932559013367, 0.20325234532356262, 0.1605253964662552, 0.1627715528011322], [0.15219080448150635, 0.15986059606075287, 0.16204530000686646, 0.20234251022338867, 0.16068245470523834, 0.1628783941268921], [0.15781769156455994, 0.16264010965824127, 0.16399721801280975, 0.18788063526153564, 0.16315147280693054, 0.16451284289360046], [0.1519765704870224, 0.15975138545036316, 0.16196700930595398, 0.20290827751159668, 0.16058482229709625, 0.1628120094537735], [0.15232084691524506, 0.15992678701877594, 0.1620926856994629, 0.20199955999851227, 0.16074158251285553, 0.16291853785514832]], [[0.17104730010032654, 0.16004040837287903, 0.17068661749362946, 0.16112998127937317, 0.1631222665309906, 0.17397348582744598], [0.17899860441684723, 0.14799678325653076, 0.17792144417762756, 0.1508961319923401, 0.15629248321056366, 0.1878945231437683], [0.17130371928215027, 0.1596524566411972, 0.170921191573143, 0.16080376505851746, 0.1629101037979126, 0.17440877854824066], [0.17820052802562714, 0.14920750260353088, 0.1771990954875946, 0.1519349068403244, 0.1570020467042923, 0.18645590543746948], [0.1767471432685852, 0.15141093730926514, 0.17588138580322266, 0.15381968021392822, 0.15828010439872742, 0.18386070430278778], [0.16897810995578766, 0.1631704419851303, 0.16879065334796906, 0.16375361382961273, 0.16481514275074005, 0.1704920083284378]], [[0.14929959177970886, 0.15156519412994385, 0.16006337106227875, 0.21304014325141907, 0.15857037901878357, 0.1674613356590271], [0.1496756672859192, 0.1518980860710144, 0.16022810339927673, 0.2119608223438263, 0.15876536071300507, 0.1674719601869583], [0.151036337018013, 0.15310044586658478, 0.16081608831882477, 0.20808373391628265, 0.1594635546207428, 0.16749988496303558], [0.158122718334198, 0.15930767357349396, 0.16367468237876892, 0.18859687447547913, 0.16291609406471252, 0.16738200187683105], [0.15080279111862183, 0.1528943032026291, 0.16071605682373047, 0.20874612033367157, 0.15934452414512634, 0.16749626398086548], [0.15216132998466492, 0.15409201383590698, 0.16129271686077118, 0.20491118729114532, 0.1600322723388672, 0.16751056909561157]], [[0.17024469375610352, 0.158426433801651, 0.17169320583343506, 0.1615591049194336, 0.16224496066570282, 0.17583151161670685], [0.17460903525352478, 0.14808686077594757, 0.17802971601486206, 0.1548779010772705, 0.156387597322464, 0.1880088597536087], [0.16971173882484436, 0.15966588258743286, 0.17093558609485626, 0.16233952343463898, 0.16292381286621094, 0.1744234561920166], [0.17345067858695984, 0.15086722373962402, 0.17632344365119934, 0.1567048579454422, 0.1579972505569458, 0.1846565306186676], [0.17319710552692413, 0.15147210657596588, 0.17595241963863373, 0.15709935128688812, 0.15834403038024902, 0.18393495678901672], [0.1681930422782898, 0.1631738245487213, 0.1687941700220108, 0.16452482342720032, 0.16481857001781464, 0.17049555480480194]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.030242603024019e-05, "remove_single_ts_time_rank_from_batch": 1.184555044226436e-05, "un_batch_to_individual_items": 6.367493652168337e-06, "normalize_and_clip_actions": 7.814994313065855e-06, "tensor_to_numpy": 1.462151806894746e-05, "get_actions": 3.488648577605843e-05}}, "connector_pipeline_timer": 0.00011168617503839415}, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.223472942189908e-05, "add_states_from_episodes_to_batch": 2.606725586309826e-06, "add_time_dim_to_batch_and_zero_pad": 6.813970949700234e-06, "numpy_to_tensor": 1.1618874030054644e-05, "add_observations_from_episodes_to_batch": 2.783205024810198e-06}}, "connector_pipeline_timer": 5.8057961415008596e-05}, "weights_seq_no": 6.0, "episode_len_mean": 20.0, "num_episodes": 20, "episode_return_max": 14.5, "rlmodule_inference_timer": 2.955570186495685e-05, "num_episodes_lifetime": 120, "env_step_timer": 1.3702264561428205e-05, "episode_duration_sec_mean": 0.005290290019474924, "agent_episode_returns_mean": {"default_agent": -1.0}, "env_to_module_sum_episodes_length_out": 10.368238394470474, "env_reset_timer": 0.00018342971083206395, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "episode_len_max": 20, "episode_return_mean": -1.0, "module_episode_returns_mean": {"default_policy": -1.0}, "env_to_module_sum_episodes_length_in": 10.368238394470474, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "sample": 0.11517403936979806, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 30400, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "time_between_sampling": 9.267283343128376}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "aeabe_00000", "date": "2025-08-11_18-50-12", "timestamp": 1754931012, "time_this_iter_s": 9.233123779296875, "time_total_s": 55.90776562690735, "pid": 11811, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161dfd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 55.90776562690735, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 32.5076923076923, "ram_util_percent": 76.7}}
{"timers": {"training_iteration": 9.213042793562638, "restore_env_runners": 8.612471994915723e-06, "training_step": 9.212891134421952, "env_runner_sampling_timer": 1.6119819223181595, "learner_update_timer": 7.409759455720253, "synch_weights": 0.0008899546918632299, "restore_eval_env_runners": 8.212723651016492e-06, "evaluation_iteration": 0.121954254316203, "synch_eval_env_connectors": 0.00011399898007904643, "synch_env_connectors": 4.911088679168687e-06}, "env_runners": {"module_episode_returns_mean": {"default_policy": -0.38000000000000006}, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.579423822718467e-06, "remove_single_ts_time_rank_from_batch": 1.1786936331909483e-05, "normalize_and_clip_actions": 7.941060366384003e-06, "get_actions": 3.753760426392561e-05, "tensor_to_numpy": 1.476314513738566e-05, "listify_data_for_vector_env": 1.034316307492815e-05}}, "connector_pipeline_timer": 0.00011543501203385164}, "episode_return_min": -11.5, "time_between_sampling": 0.031517303576610936, "agent_episode_returns_mean": {"default_agent": -0.38000000000000006}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2339075506680411e-05, "add_states_from_episodes_to_batch": 2.672320239200713e-06, "add_observations_from_episodes_to_batch": 2.802028247501179e-06, "add_time_dim_to_batch_and_zero_pad": 6.827006002200989e-06, "batch_individual_items": 1.2339915717299836e-05}}, "connector_pipeline_timer": 5.9005459169177413e-05}, "env_step_timer": 1.3641960970103809e-05, "episode_duration_sec_mean": 0.005172340657096355, "episode_return_mean": -0.38000000000000006, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 6.0, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "episode_return_max": 8.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "rlmodule_inference_timer": 3.052013999588465e-05, "sample": 0.005521574044795936, "num_episodes_lifetime": -153875.0, "num_env_steps_sampled_lifetime": -3077500.0, "env_reset_timer": 3.796088656759347e-05, "num_env_steps_sampled_lifetime_throughput": 3313.834520224844}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15332881527775524, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009417126440828493, "add_observations_from_episodes_to_batch": 0.0008708953456672988, "add_columns_from_episodes_to_train_batch": 0.042074486072239486, "add_time_dim_to_batch_and_zero_pad": 0.08959085116735709, "add_states_from_episodes_to_batch": 0.0036149430605880296, "batch_individual_items": 0.007508855560752522, "numpy_to_tensor": 8.558618851729454e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained_lifetime": 251370, "policy_loss": -0.0005559141864068806, "diff_num_grad_updates_vs_sampler_policy": 36.0, "weights_seq_no": 42.0, "total_loss": 0.2481261044740677, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 2.280186708958354e-05, "vf_loss_unclipped": 43.29818344116211, "num_module_steps_trained": 35910, "vf_explained_var": -0.0027521848678588867, "module_train_batch_size_mean": 997.6122293241576, "vf_loss": 0.3205786645412445, "entropy": 0.6926208734512329}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 502740, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 1512000, "num_env_steps_trained_lifetime_throughput": 61826.842102251794}, "intrinsic_reward_module": {"module_train_batch_size_mean": 997.6122293241576, "num_module_steps_trained_lifetime": 251370, "diff_num_grad_updates_vs_sampler_policy": 36.0, "weights_seq_no": 42.0, "total_loss": 0.0, "num_module_steps_trained": 35910}}}, "__all_modules__": {"num_module_steps_trained_lifetime": 83790, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 252000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4797.539702073053, "num_module_steps_trained_throughput": 27381890.74566291, "num_module_steps_trained_lifetime_throughput": 13276119.979296409}, "intrinsic_reward_module": {"module_train_batch_size_mean": 998.4808932973482, "num_trainable_parameters": 8266, "num_module_steps_trained_lifetime": 41895, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "weights_seq_no": 7.0, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 796.7327021624932}, "default_policy": {"vf_explained_var": -7.021427154541016e-05, "module_train_batch_size_mean": 998.4808932973482, "num_trainable_parameters": 16595, "vf_loss_unclipped": 43.15806579589844, "num_module_steps_trained_lifetime": 41895, "policy_loss": -0.0005930345505475998, "num_module_steps_trained": 5985, "vf_loss": 0.3205098807811737, "entropy": 0.6926074624061584, "curr_kl_coeff": 0.0012623744551092386, "total_loss": 0.24803179502487183, "diff_num_grad_updates_vs_sampler_policy": 1.0, "use_intrinsic_rewards": 0.0, "weights_seq_no": 7.0, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 2.594625584606547e-05, "num_module_steps_trained_lifetime_throughput": 796.7185619633663}, "IntrinsicAttentionMask": [[[0.15050733089447021, 0.16081780195236206, 0.1571512073278427, 0.2058408260345459, 0.1616838574409485, 0.16399897634983063], [0.15221451222896576, 0.16150926053524017, 0.15821130573749542, 0.2014136165380478, 0.16228710114955902, 0.16436421871185303], [0.1516203135251999, 0.16127058863639832, 0.15784379839897156, 0.20294666290283203, 0.16207922995090485, 0.16423939168453217], [0.15857012569904327, 0.16392934322357178, 0.16204369068145752, 0.18553714454174042, 0.16437160968780518, 0.16554807126522064], [0.15235288441181183, 0.16156452894210815, 0.1582966446876526, 0.2010578066110611, 0.16233517229557037, 0.16439291834831238], [0.1527191400527954, 0.16171027719974518, 0.15852215886116028, 0.20011821389198303, 0.16246186196804047, 0.16446828842163086]], [[0.17125840485095978, 0.15844717621803284, 0.1731228530406952, 0.16017216444015503, 0.16104169189929962, 0.17595766484737396], [0.1750359982252121, 0.15154467523097992, 0.17858432233333588, 0.15461678802967072, 0.1561761200428009, 0.18404212594032288], [0.17072166502475739, 0.1594170182943344, 0.17235830426216125, 0.16094529628753662, 0.16171492636203766, 0.1748427450656891], [0.17451821267604828, 0.15249918401241302, 0.17782703042030334, 0.15539053082466125, 0.1568567007780075, 0.18290826678276062], [0.1742583066225052, 0.15297730267047882, 0.17744798958301544, 0.1557774543762207, 0.15719667077064514, 0.1823423057794571], [0.16991187632083893, 0.16087551414966583, 0.1712099313735962, 0.1621045470237732, 0.16272257268428802, 0.1731756329536438]], [[0.14842282235622406, 0.1527869552373886, 0.1608612984418869, 0.2107003927230835, 0.1655009686946869, 0.16172760725021362], [0.14926566183567047, 0.15344931185245514, 0.16117534041404724, 0.2084997445344925, 0.16560670733451843, 0.16200318932533264], [0.15076349675655365, 0.15462139248847961, 0.16172227263450623, 0.20462964475154877, 0.16578181087970734, 0.1624813973903656], [0.15860913693904877, 0.1606551855802536, 0.16435645520687103, 0.18519526720046997, 0.16643653810024261, 0.16474737226963043], [0.1515904814004898, 0.15526574850082397, 0.16201816499233246, 0.20251502096652985, 0.1658715307712555, 0.1627391129732132], [0.15091969072818756, 0.1547432392835617, 0.1617784947156906, 0.20422899723052979, 0.16579914093017578, 0.16253040730953217]], [[0.17057602107524872, 0.1587347537279129, 0.1720273643732071, 0.16187351942062378, 0.16256071627140045, 0.1742275506258011], [0.17543745040893555, 0.1487894505262375, 0.17887435853481293, 0.15561270713806152, 0.15712957084178925, 0.1841563880443573], [0.16998974978923798, 0.15992744266986847, 0.17121560871601105, 0.16260546445846558, 0.16319070756435394, 0.1730709969997406], [0.17413580417633057, 0.15146315097808838, 0.1770199090242386, 0.15732386708259583, 0.15862134099006653, 0.18143589794635773], [0.17385204136371613, 0.1520448923110962, 0.17661777138710022, 0.15769343078136444, 0.1589428037405014, 0.1808490753173828], [0.1691051721572876, 0.1617247611284256, 0.16999615728855133, 0.1637008935213089, 0.16413158178329468, 0.17134146392345428]], [[0.1505073457956314, 0.16081780195236206, 0.1571512073278427, 0.20584078133106232, 0.1616838425397873, 0.16399897634983063], [0.15221451222896576, 0.16150926053524017, 0.15821130573749542, 0.2014135718345642, 0.16228708624839783, 0.16436420381069183], [0.15162032842636108, 0.1612706035375595, 0.15784381330013275, 0.20294664800167084, 0.16207922995090485, 0.16423939168453217], [0.15857014060020447, 0.16392935812473297, 0.16204369068145752, 0.18553714454174042, 0.16437160968780518, 0.16554808616638184], [0.15235288441181183, 0.16156454384326935, 0.15829665958881378, 0.2010577917098999, 0.16233518719673157, 0.16439293324947357], [0.1527191698551178, 0.16171030700206757, 0.15852217376232147, 0.20011821389198303, 0.16246187686920166, 0.16446831822395325]], [[0.17187032103538513, 0.15903432667255402, 0.17344851791858673, 0.1604946404695511, 0.15930913388729095, 0.1758430302143097], [0.1778743863105774, 0.15000274777412415, 0.18148024380207062, 0.15304359793663025, 0.15057246387004852, 0.18702656030654907], [0.17114706337451935, 0.16010528802871704, 0.1724964827299118, 0.16136763989925385, 0.1603429764509201, 0.17454059422016144], [0.17718081176280975, 0.15105974674224854, 0.18054012954235077, 0.15392380952835083, 0.15159663558006287, 0.18569888174533844], [0.17774367332458496, 0.15020225942134857, 0.18130280077457428, 0.15320990979671478, 0.1507658213376999, 0.1867755800485611], [0.17005619406700134, 0.16171416640281677, 0.17106646299362183, 0.16267487406730652, 0.16189518570899963, 0.1725931316614151]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0174061217986924e-05, "remove_single_ts_time_rank_from_batch": 1.1759131366180434e-05, "un_batch_to_individual_items": 6.391104361613695e-06, "normalize_and_clip_actions": 7.719559828088802e-06, "tensor_to_numpy": 1.4700607712553692e-05, "get_actions": 3.491162965398982e-05}}, "connector_pipeline_timer": 0.00011135507774293222}, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2091495538392124e-05, "add_states_from_episodes_to_batch": 2.590067794449526e-06, "add_time_dim_to_batch_and_zero_pad": 6.707095142165895e-06, "numpy_to_tensor": 1.1682371985338876e-05, "add_observations_from_episodes_to_batch": 2.7513461924771337e-06}}, "connector_pipeline_timer": 5.741134537451794e-05}, "weights_seq_no": 7.0, "episode_len_mean": 20.0, "num_episodes": 20, "episode_return_max": 14.5, "rlmodule_inference_timer": 2.9739066553169464e-05, "num_episodes_lifetime": 140, "env_step_timer": 1.3639418791578459e-05, "episode_duration_sec_mean": 0.005275521682342514, "agent_episode_returns_mean": {"default_agent": -0.8}, "env_to_module_sum_episodes_length_out": 10.368238394572801, "env_reset_timer": 0.00018237999478519593, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "episode_len_max": 20, "episode_return_mean": -0.8, "module_episode_returns_mean": {"default_policy": -0.8}, "env_to_module_sum_episodes_length_in": 10.368238394572801, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "sample": 0.11512625647640884, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 35400, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "time_between_sampling": 9.266361854277063}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "aeabe_00000", "date": "2025-08-11_18-50-21", "timestamp": 1754931021, "time_this_iter_s": 9.265893936157227, "time_total_s": 65.17365956306458, "pid": 11811, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161dfd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 65.17365956306458, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 32.9076923076923, "ram_util_percent": 76.67692307692307}}
{"timers": {"training_iteration": 9.213388703956737, "restore_env_runners": 8.602177887298196e-06, "training_step": 9.213236324327559, "env_runner_sampling_timer": 1.6109708330951888, "learner_update_timer": 7.41104397699232, "synch_weights": 0.0008897230654278739, "restore_eval_env_runners": 8.195595745295177e-06, "evaluation_iteration": 0.1218920721828931, "synch_eval_env_connectors": 0.00011403731939026419, "synch_env_connectors": 4.908227271432405e-06}, "env_runners": {"module_episode_returns_mean": {"default_policy": -0.06}, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.6245380779637005e-06, "remove_single_ts_time_rank_from_batch": 1.1825287142672239e-05, "normalize_and_clip_actions": 7.952585652938303e-06, "get_actions": 3.7761365422293634e-05, "tensor_to_numpy": 1.4817270242463124e-05, "listify_data_for_vector_env": 1.0337350206574295e-05}}, "connector_pipeline_timer": 0.00011589167349560697}, "episode_return_min": -11.5, "time_between_sampling": 0.03160799844441011, "agent_episode_returns_mean": {"default_agent": -0.06}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2334613031870773e-05, "add_states_from_episodes_to_batch": 2.66580150503594e-06, "add_observations_from_episodes_to_batch": 2.802520400599421e-06, "add_time_dim_to_batch_and_zero_pad": 6.823017922307328e-06, "batch_individual_items": 1.2352750736245257e-05}}, "connector_pipeline_timer": 5.9100632016040014e-05}, "env_step_timer": 1.3683275322185776e-05, "episode_duration_sec_mean": 0.005191091656219214, "episode_return_mean": -0.06, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 7.0, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "episode_return_max": 8.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "rlmodule_inference_timer": 3.071099919263961e-05, "sample": 0.00554117589870558, "num_episodes_lifetime": -184750.0, "num_env_steps_sampled_lifetime": -3695000.0, "env_reset_timer": 3.901764762199511e-05, "num_env_steps_sampled_lifetime_throughput": 3298.987575344073}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15328683754449246, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009411029756255145, "add_observations_from_episodes_to_batch": 0.0008709263924045645, "add_columns_from_episodes_to_train_batch": 0.042060150800858, "add_time_dim_to_batch_and_zero_pad": 0.08957014973549082, "add_states_from_episodes_to_batch": 0.0036166632105378562, "batch_individual_items": 0.007506739504910452, "numpy_to_tensor": 8.548282595918515e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained_lifetime": 287280, "policy_loss": -3.4314168715354754e-06, "diff_num_grad_updates_vs_sampler_policy": 41.0, "weights_seq_no": 48.0, "total_loss": 0.24865196645259857, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 4.4138523946912755e-08, "vf_loss_unclipped": 41.736122131347656, "num_module_steps_trained": 35910, "vf_explained_var": -0.0026732683181762695, "module_train_batch_size_mean": 997.5758696422192, "vf_loss": 0.3205488622188568, "entropy": 0.692431628704071}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 574560, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 1728000, "num_env_steps_trained_lifetime_throughput": 60736.241960192274}, "intrinsic_reward_module": {"module_train_batch_size_mean": 997.5758696422192, "num_module_steps_trained_lifetime": 287280, "diff_num_grad_updates_vs_sampler_policy": 41.0, "weights_seq_no": 48.0, "total_loss": 0.0, "num_module_steps_trained": 35910}}}, "__all_modules__": {"num_module_steps_trained_lifetime": 95760, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 288000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4780.128639779529, "num_module_steps_trained_throughput": 26635038.58170891, "num_module_steps_trained_lifetime_throughput": 13240367.853841366}, "intrinsic_reward_module": {"module_train_batch_size_mean": 998.4230504637324, "num_trainable_parameters": 8266, "num_module_steps_trained_lifetime": 47880, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "weights_seq_no": 8.0, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 793.8688987006251}, "default_policy": {"vf_explained_var": -0.0008488893508911133, "module_train_batch_size_mean": 998.4230504637324, "num_trainable_parameters": 16595, "vf_loss_unclipped": 41.68286895751953, "num_module_steps_trained_lifetime": 47880, "policy_loss": -3.825763087661471e-06, "num_module_steps_trained": 5985, "vf_loss": 0.32051151990890503, "entropy": 0.6924316883087158, "curr_kl_coeff": 0.0006311872275546193, "total_loss": 0.24862249195575714, "diff_num_grad_updates_vs_sampler_policy": 1.0, "use_intrinsic_rewards": 0.0, "weights_seq_no": 8.0, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 4.954328147732667e-08, "num_module_steps_trained_lifetime_throughput": 793.8554735788027}, "IntrinsicAttentionMask": [[[0.14840786159038544, 0.15672902762889862, 0.15910735726356506, 0.21176762878894806, 0.1639728844165802, 0.16001522541046143], [0.14982396364212036, 0.15755800902843475, 0.15976263582706451, 0.20798704028129578, 0.16426487267017365, 0.16060349345207214], [0.15021486580371857, 0.157785102725029, 0.1599414348602295, 0.20695193111896515, 0.16434292495250702, 0.1607637107372284], [0.1576300412416458, 0.16195106506347656, 0.16316470503807068, 0.18800923228263855, 0.165619358420372, 0.1636255532503128], [0.15099665522575378, 0.158237025141716, 0.16029635071754456, 0.20489291846752167, 0.16449576616287231, 0.16108128428459167], [0.1503625512123108, 0.15787069499492645, 0.1600087434053421, 0.2065618634223938, 0.16437213122844696, 0.1608239859342575]], [[0.17125838994979858, 0.15844717621803284, 0.1731228530406952, 0.16017216444015503, 0.16104167699813843, 0.17595764994621277], [0.1750359684228897, 0.1515446901321411, 0.1785842925310135, 0.1546168178319931, 0.1561761498451233, 0.1840420961380005], [0.17072166502475739, 0.1594170331954956, 0.17235830426216125, 0.16094531118869781, 0.16171492636203766, 0.1748427450656891], [0.17451819777488708, 0.1524992138147354, 0.17782701551914215, 0.15539057552814484, 0.1568567305803299, 0.18290825188159943], [0.174258291721344, 0.15297731757164001, 0.17744795978069305, 0.1557774692773819, 0.15719668567180634, 0.1823422759771347], [0.16991187632083893, 0.16087551414966583, 0.1712099313735962, 0.1621045470237732, 0.16272257268428802, 0.1731756329536438]], [[0.14835196733474731, 0.15060320496559143, 0.1590474396944046, 0.2116878181695938, 0.1639111191034317, 0.16639845073223114], [0.1487450748682022, 0.15095371007919312, 0.15923191606998444, 0.21064284443855286, 0.1639956831932068, 0.16643072664737701], [0.15016865730285645, 0.1522209197282791, 0.1598922163248062, 0.20688819885253906, 0.1642923504114151, 0.16653761267662048], [0.1576150506734848, 0.15879620611667633, 0.16314919292926788, 0.18799133598804474, 0.1656036078929901, 0.16684462130069733], [0.15095438063144684, 0.1529189497232437, 0.1602514684200287, 0.20483551919460297, 0.16444972157478333, 0.1665899008512497], [0.15134716033935547, 0.1532675176858902, 0.1604296863079071, 0.20381464064121246, 0.16452668607234955, 0.16661426424980164]], [[0.17160436511039734, 0.1565292477607727, 0.17595288157463074, 0.15823334455490112, 0.1613670289516449, 0.176313117146492], [0.17630121111869812, 0.14656099677085876, 0.1853926032781601, 0.1497846096754074, 0.15580447018146515, 0.18615606427192688], [0.17027495801448822, 0.15928944945335388, 0.17339377105236053, 0.16054537892341614, 0.16284525394439697, 0.17365118861198425], [0.1757640391588211, 0.14772002398967743, 0.18427880108356476, 0.15077495574951172, 0.15646949410438538, 0.1849927008152008], [0.17478008568286896, 0.1498294621706009, 0.18226273357868195, 0.15257199108600616, 0.15766742825508118, 0.18288826942443848], [0.17016535997390747, 0.1595158725976944, 0.1731848418712616, 0.16073450446128845, 0.1629653424024582, 0.17343398928642273]], [[0.14843519032001495, 0.15860366821289062, 0.15498755872249603, 0.21071776747703552, 0.1655147224664688, 0.16174106299877167], [0.1503600776195526, 0.15954157710075378, 0.15628379583358765, 0.20570655167102814, 0.16574621200561523, 0.162361741065979], [0.14969004690647125, 0.1592174470424652, 0.15583428740501404, 0.207441046833992, 0.16566869616508484, 0.16214846074581146], [0.15861181914806366, 0.16332897543907166, 0.16167134046554565, 0.18519838154315948, 0.16643936932086945, 0.16475015878677368], [0.1515992134809494, 0.16013440489768982, 0.1571103185415268, 0.20252655446529388, 0.16588106751441956, 0.16274847090244293], [0.15092915296554565, 0.15981489419937134, 0.1566641628742218, 0.20424166321754456, 0.1658095121383667, 0.16254059970378876]], [[0.1725567728281021, 0.15966951847076416, 0.17206677794456482, 0.15921610593795776, 0.15994544327259064, 0.17654536664485931], [0.1794331669807434, 0.15131735801696777, 0.17831632494926453, 0.15037551522254944, 0.1518920660018921, 0.18866555392742157], [0.17281213402748108, 0.1593630462884903, 0.17229993641376495, 0.1588907092809677, 0.1596505045890808, 0.17698368430137634], [0.17968115210533142, 0.15101216733455658, 0.17854052782058716, 0.15005353093147278, 0.15159718692302704, 0.1891154944896698], [0.17928247153759003, 0.15150269865989685, 0.1781800389289856, 0.1505710780620575, 0.15207113325595856, 0.18839256465435028], [0.1704963892698288, 0.16213275492191315, 0.1701824814081192, 0.161834254860878, 0.1623142510652542, 0.17303988337516785]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0352253381492435e-05, "remove_single_ts_time_rank_from_batch": 1.1865285804291616e-05, "un_batch_to_individual_items": 6.4266616268332375e-06, "normalize_and_clip_actions": 7.78347082855715e-06, "tensor_to_numpy": 1.4825686590664954e-05, "get_actions": 3.54741980096169e-05}}, "connector_pipeline_timer": 0.00011269392198141488}, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2355942734601619e-05, "add_states_from_episodes_to_batch": 2.5990345018068642e-06, "add_time_dim_to_batch_and_zero_pad": 6.91754150137282e-06, "numpy_to_tensor": 1.1728894766797095e-05, "add_observations_from_episodes_to_batch": 2.796675653939986e-06}}, "connector_pipeline_timer": 5.837891915728571e-05}, "weights_seq_no": 8.0, "episode_len_mean": 20.0, "num_episodes": 20, "episode_return_max": 14.5, "rlmodule_inference_timer": 2.9990007620521753e-05, "num_episodes_lifetime": 160, "env_step_timer": 1.383865950804735e-05, "episode_duration_sec_mean": 0.005103341249050573, "agent_episode_returns_mean": {"default_agent": -2.0}, "env_to_module_sum_episodes_length_out": 10.3682383945743, "env_reset_timer": 0.00018135494480761615, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "episode_len_max": 20, "episode_return_mean": -2.0, "module_episode_returns_mean": {"default_policy": -2.0}, "env_to_module_sum_episodes_length_in": 10.3682383945743, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "sample": 0.11509917432146924, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 40400, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "time_between_sampling": 9.266390401564232}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "aeabe_00000", "date": "2025-08-11_18-50-30", "timestamp": 1754931030, "time_this_iter_s": 9.36408281326294, "time_total_s": 74.53774237632751, "pid": 11811, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161dfd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 74.53774237632751, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 35.07142857142858, "ram_util_percent": 77.24285714285713}}
{"timers": {"training_iteration": 9.246076347337036, "restore_env_runners": 8.573655964181974e-06, "training_step": 9.245922604833742, "env_runner_sampling_timer": 1.6127007605936783, "learner_update_timer": 7.4416736134725605, "synch_weights": 0.0009100991752521346, "restore_eval_env_runners": 8.180309678499293e-06, "evaluation_iteration": 0.12184933105146634, "synch_eval_env_connectors": 0.00011411444673585809, "synch_env_connectors": 4.904565600682078e-06}, "env_runners": {"module_episode_returns_mean": {"default_policy": -1.9799999999999998}, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 7.026367780700371e-06, "remove_single_ts_time_rank_from_batch": 1.2461261856225415e-05, "normalize_and_clip_actions": 8.54574045156231e-06, "get_actions": 4.294571663854109e-05, "tensor_to_numpy": 1.6145021556563953e-05, "listify_data_for_vector_env": 1.1254471244714221e-05}}, "connector_pipeline_timer": 0.0001264461764865763}, "episode_return_min": -11.5, "time_between_sampling": 0.032380212712531324, "agent_episode_returns_mean": {"default_agent": -1.9799999999999998}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3912864517341937e-05, "add_states_from_episodes_to_batch": 2.816541532031349e-06, "add_observations_from_episodes_to_batch": 3.0185499707207393e-06, "add_time_dim_to_batch_and_zero_pad": 7.379867879523947e-06, "batch_individual_items": 1.3303335689509584e-05}}, "connector_pipeline_timer": 6.35655632147002e-05}, "env_step_timer": 1.519205723757148e-05, "episode_duration_sec_mean": 0.0056712423451244845, "episode_return_mean": -1.9799999999999998, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 8.0, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "episode_return_max": 8.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "rlmodule_inference_timer": 3.4189702812300024e-05, "sample": 0.005916393329555451, "num_episodes_lifetime": -215625.0, "num_env_steps_sampled_lifetime": -4312500.0, "env_reset_timer": 5.2181380186591045e-05, "num_env_steps_sampled_lifetime_throughput": 3009.1204313464605}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15338867499941297, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009416077377868518, "add_observations_from_episodes_to_batch": 0.0008715354683517614, "add_columns_from_episodes_to_train_batch": 0.04210084762260509, "add_time_dim_to_batch_and_zero_pad": 0.08960972781843472, "add_states_from_episodes_to_batch": 0.0036208194884954463, "batch_individual_items": 0.007518077940086324, "numpy_to_tensor": 8.575133803433656e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained_lifetime": 323190, "policy_loss": -0.00010849654790945351, "diff_num_grad_updates_vs_sampler_policy": 46.0, "weights_seq_no": 54.0, "total_loss": 0.2485542893409729, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 3.97840267396532e-06, "vf_loss_unclipped": 42.728309631347656, "num_module_steps_trained": 35910, "vf_explained_var": -0.002697467803955078, "module_train_batch_size_mean": 997.5505482791133, "vf_loss": 0.32055753469467163, "entropy": 0.6924493908882141}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 646380, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 1944000, "num_env_steps_trained_lifetime_throughput": 59573.200850945526}, "intrinsic_reward_module": {"module_train_batch_size_mean": 997.5505482791133, "num_module_steps_trained_lifetime": 323190, "diff_num_grad_updates_vs_sampler_policy": 46.0, "weights_seq_no": 54.0, "total_loss": 0.0, "num_module_steps_trained": 35910}}}, "__all_modules__": {"num_module_steps_trained_lifetime": 107730, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 324000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4747.786375454049, "num_module_steps_trained_throughput": 25883158.423127588, "num_module_steps_trained_lifetime_throughput": 13176134.059315681}, "intrinsic_reward_module": {"module_train_batch_size_mean": 998.3685925840979, "num_trainable_parameters": 8266, "num_module_steps_trained_lifetime": 53865, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "weights_seq_no": 9.0, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 788.5235839790719}, "default_policy": {"vf_explained_var": -9.059906005859375e-05, "module_train_batch_size_mean": 998.3685925840979, "num_trainable_parameters": 16595, "vf_loss_unclipped": 42.614112854003906, "num_module_steps_trained_lifetime": 53865, "policy_loss": -0.00011415119661251083, "num_module_steps_trained": 5985, "vf_loss": 0.3205093741416931, "entropy": 0.6924440860748291, "curr_kl_coeff": 0.00031559361377730966, "total_loss": 0.24851049482822418, "diff_num_grad_updates_vs_sampler_policy": 1.0, "use_intrinsic_rewards": 0.0, "weights_seq_no": 9.0, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 4.4159473873151e-06, "num_module_steps_trained_lifetime_throughput": 788.510852003824}, "IntrinsicAttentionMask": [[[0.1493397206068039, 0.15957017242908478, 0.15593205392360687, 0.21200183033943176, 0.16042953729629517, 0.16272668540477753], [0.15118196606636047, 0.16041365265846252, 0.15713806450366974, 0.2068309485912323, 0.16118621826171875, 0.16324922442436218], [0.1505410522222519, 0.16012261807918549, 0.15672023594379425, 0.2086203247308731, 0.16092552244663239, 0.16307027637958527], [0.15904472768306732, 0.1637747436761856, 0.16211259365081787, 0.185703843832016, 0.16416427493095398, 0.16519981622695923], [0.15133114159107208, 0.16048099100589752, 0.1572350412607193, 0.2064158022403717, 0.16124649345874786, 0.16329041123390198], [0.15172602236270905, 0.16065865755081177, 0.1574912965297699, 0.20531995594501495, 0.16140536963939667, 0.16339874267578125]], [[0.17080402374267578, 0.1598127782344818, 0.17196688055992126, 0.16233858466148376, 0.1628902554512024, 0.1721874326467514], [0.17832942306995392, 0.14744362235069275, 0.1818229705095291, 0.15420515835285187, 0.15570831298828125, 0.1824905276298523], [0.17002367973327637, 0.16110235452651978, 0.17096106708049774, 0.16316251456737518, 0.16361166536808014, 0.1711387187242508], [0.17657692730426788, 0.150314062833786, 0.1795014590024948, 0.15613028407096863, 0.15741793811321259, 0.1800592988729477], [0.17619594931602478, 0.15093886852264404, 0.17899896204471588, 0.15654629468917847, 0.15778659284114838, 0.17953340709209442], [0.16987602412700653, 0.1613464653491974, 0.17077109217643738, 0.1633179783821106, 0.1637476682662964, 0.17094068229198456]], [[0.1514882892370224, 0.15378712117671967, 0.15612082183361053, 0.2077924758195877, 0.16089500486850739, 0.1699163019657135], [0.1518179178237915, 0.15407215058803558, 0.15635986626148224, 0.20684342086315155, 0.16103769838809967, 0.16986891627311707], [0.1521473377943039, 0.15435679256916046, 0.15659832954406738, 0.20589745044708252, 0.1611795574426651, 0.16982051730155945], [0.15835869312286377, 0.1596800982952118, 0.16101250052452087, 0.18852463364601135, 0.16371077299118042, 0.1687132716178894], [0.15280552208423615, 0.15492480993270874, 0.157073512673378, 0.20401477813720703, 0.16146069765090942, 0.16972067952156067], [0.15399539470672607, 0.15594933927059174, 0.15792807936668396, 0.20063644647598267, 0.16196119785308838, 0.16952961683273315]], [[0.17129743099212646, 0.1602744311094284, 0.17246365547180176, 0.16136561334133148, 0.16191399097442627, 0.17268483340740204], [0.17972838878631592, 0.14860031008720398, 0.1832493543624878, 0.15151146054267883, 0.15298835933208466, 0.18392214179039001], [0.170423686504364, 0.1614813655614853, 0.17136327922344208, 0.1623716503381729, 0.16281865537166595, 0.17154134809970856], [0.17888060212135315, 0.14977705478668213, 0.18215037882328033, 0.15251484513282776, 0.15390245616436005, 0.18277469277381897], [0.17845557630062103, 0.15036670863628387, 0.18160070478916168, 0.15301679074764252, 0.15435929596424103, 0.18220098316669464], [0.17025838792324066, 0.16170963644981384, 0.17115546762943268, 0.16256166994571686, 0.16298936307430267, 0.1713254451751709]], [[0.1496349573135376, 0.15802490711212158, 0.1604229211807251, 0.2052503079175949, 0.16532866656780243, 0.16133829951286316], [0.15094736218452454, 0.158739373087883, 0.16096052527427673, 0.20204855501651764, 0.16549651324748993, 0.16180770099163055], [0.15130987763404846, 0.15893526375293732, 0.16110731661319733, 0.20117104053497314, 0.1655408889055252, 0.16193559765815735], [0.15725252032279968, 0.16205768287181854, 0.16340993344783783, 0.18720774352550507, 0.16614839434623718, 0.1639237254858017], [0.152035191655159, 0.15932534635066986, 0.16139884293079376, 0.1994243860244751, 0.1656271368265152, 0.16218917071819305], [0.1514468491077423, 0.15900912880897522, 0.1611625999212265, 0.20084026455879211, 0.16555744409561157, 0.16198371350765228]], [[0.17255224287509918, 0.15776327252388, 0.1720622479915619, 0.15921194851398468, 0.1618695706129074, 0.17654073238372803], [0.18045088648796082, 0.14579206705093384, 0.1792335957288742, 0.14899876713752747, 0.15498703718185425, 0.190537691116333], [0.17280717194080353, 0.1573774367570877, 0.1722950041294098, 0.1588861644268036, 0.16165554523468018, 0.17697861790657043], [0.17965872585773468, 0.14699490368366241, 0.17851825058460236, 0.1500348299741745, 0.1557014286518097, 0.18909189105033875], [0.17821578681468964, 0.14918434619903564, 0.1772129237651825, 0.1519150584936142, 0.15698854625225067, 0.18648336827754974], [0.17049448192119598, 0.16087670624256134, 0.17018058896064758, 0.16183245182037354, 0.1635778695344925, 0.17303794622421265]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.4376913349706321e-05, "remove_single_ts_time_rank_from_batch": 1.4439427517469566e-05, "un_batch_to_individual_items": 8.92752656576427e-06, "normalize_and_clip_actions": 1.0593629790240705e-05, "tensor_to_numpy": 2.1222233768827986e-05, "get_actions": 5.52831185651495e-05}}, "connector_pipeline_timer": 0.00016009055371814842}, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.5945836979969287e-05, "add_states_from_episodes_to_batch": 3.374456290961101e-06, "add_time_dim_to_batch_and_zero_pad": 8.862416658492111e-06, "numpy_to_tensor": 1.637727657479076e-05, "add_observations_from_episodes_to_batch": 3.6435911951291874e-06}}, "connector_pipeline_timer": 7.526442563955395e-05}, "weights_seq_no": 9.0, "episode_len_mean": 20.0, "num_episodes": 20, "episode_return_max": 14.5, "rlmodule_inference_timer": 4.12624814096072e-05, "num_episodes_lifetime": 180, "env_step_timer": 2.1882368180448347e-05, "episode_duration_sec_mean": 0.005736078293994069, "agent_episode_returns_mean": {"default_agent": -1.8}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.00018398847462316754, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "episode_len_max": 20, "episode_return_mean": -1.8, "module_episode_returns_mean": {"default_policy": -1.8}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "sample": 0.11575688215839683, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 45400, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "time_between_sampling": 9.298857477548257}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "aeabe_00000", "date": "2025-08-11_18-50-43", "timestamp": 1754931043, "time_this_iter_s": 12.67540693283081, "time_total_s": 87.21314930915833, "pid": 11811, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161dfd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 87.21314930915833, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 58.35555555555556, "ram_util_percent": 80.52777777777777}}
{"timers": {"training_iteration": 9.258192726364449, "restore_env_runners": 8.549168997812959e-06, "training_step": 9.258037703375326, "env_runner_sampling_timer": 1.6187186113172984, "learner_update_timer": 7.447261632747734, "synch_weights": 0.0009176031842097281, "restore_eval_env_runners": 8.569755804469732e-06, "evaluation_iteration": 0.12255335982108254, "synch_eval_env_connectors": 0.00011532371248219349, "synch_env_connectors": 4.90510006608813e-06}, "env_runners": {"module_episode_returns_mean": {"default_policy": -1.74}, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 7.862570292566411e-06, "remove_single_ts_time_rank_from_batch": 1.4175483137863174e-05, "normalize_and_clip_actions": 9.895503190878246e-06, "get_actions": 5.326359967232655e-05, "tensor_to_numpy": 1.9294098479946605e-05, "listify_data_for_vector_env": 1.299208130049798e-05}}, "connector_pipeline_timer": 0.00014904838599734093}, "episode_return_min": -11.5, "time_between_sampling": 0.0442269095955585, "agent_episode_returns_mean": {"default_agent": -1.74}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.7113757100480372e-05, "add_states_from_episodes_to_batch": 3.2197053253813944e-06, "add_observations_from_episodes_to_batch": 3.465510643024258e-06, "add_time_dim_to_batch_and_zero_pad": 8.727593721887285e-06, "batch_individual_items": 1.5490872268565804e-05}}, "connector_pipeline_timer": 7.485337762389932e-05}, "env_step_timer": 1.8219543323607343e-05, "episode_duration_sec_mean": 0.006678270504344255, "episode_return_mean": -1.74, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 9.0, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "episode_return_max": 8.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "rlmodule_inference_timer": 4.118132905277881e-05, "sample": 0.007016100947300031, "num_episodes_lifetime": -246500.0, "num_env_steps_sampled_lifetime": -4930000.0, "env_reset_timer": 7.238837276066389e-05, "num_env_steps_sampled_lifetime_throughput": 2700.494359087097}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1537065686698209, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009422898274055964, "add_observations_from_episodes_to_batch": 0.0008722005238607782, "add_columns_from_episodes_to_train_batch": 0.042230163736091585, "add_time_dim_to_batch_and_zero_pad": 0.08978530845018154, "add_states_from_episodes_to_batch": 0.003624184214260736, "batch_individual_items": 0.0075199725810986265, "numpy_to_tensor": 8.576382429368311e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained_lifetime": 359100, "policy_loss": 7.349529187195003e-05, "diff_num_grad_updates_vs_sampler_policy": 51.0, "weights_seq_no": 60.0, "total_loss": 0.2487250715494156, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 1.465164950786857e-05, "vf_loss_unclipped": 41.528289794921875, "num_module_steps_trained": 35910, "vf_explained_var": -0.0026282072067260742, "module_train_batch_size_mean": 997.532914147147, "vf_loss": 0.3205402195453644, "entropy": 0.6921043992042542}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 718200, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 2160000, "num_env_steps_trained_lifetime_throughput": 58402.504454541595}, "intrinsic_reward_module": {"module_train_batch_size_mean": 997.532914147147, "num_module_steps_trained_lifetime": 359100, "diff_num_grad_updates_vs_sampler_policy": 51.0, "weights_seq_no": 60.0, "total_loss": 0.0, "num_module_steps_trained": 35910}}}, "__all_modules__": {"num_module_steps_trained_lifetime": 119700, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 360000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4717.037622573901, "num_module_steps_trained_throughput": 25173815.946375113, "num_module_steps_trained_lifetime_throughput": 13122499.656376105}, "intrinsic_reward_module": {"module_train_batch_size_mean": 998.3173215714437, "num_trainable_parameters": 8266, "num_module_steps_trained_lifetime": 59850, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "weights_seq_no": 10.0, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 783.4418691319498}, "default_policy": {"vf_explained_var": 0.00096893310546875, "module_train_batch_size_mean": 998.3173215714437, "num_trainable_parameters": 16595, "vf_loss_unclipped": 41.41883850097656, "num_module_steps_trained_lifetime": 59850, "policy_loss": 7.151249883463606e-05, "num_module_steps_trained": 5985, "vf_loss": 0.3205137550830841, "entropy": 0.6921080350875854, "curr_kl_coeff": 0.00015779680688865483, "total_loss": 0.24870005249977112, "diff_num_grad_updates_vs_sampler_policy": 1.0, "use_intrinsic_rewards": 0.0, "weights_seq_no": 10.0, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 1.421161232428858e-05, "num_module_steps_trained_lifetime_throughput": 783.4298362714464}, "IntrinsicAttentionMask": [[[0.1475166380405426, 0.15185411274433136, 0.1598791629076004, 0.20941376686096191, 0.1644905060529709, 0.16684579849243164], [0.14839541912078857, 0.1525547057390213, 0.16023565828800201, 0.20728397369384766, 0.16464118659496307, 0.16688916087150574], [0.1499585211277008, 0.15379580855369568, 0.16085879504680634, 0.20353688299655914, 0.1648966521024704, 0.1669534146785736], [0.15817590057849884, 0.16021636128425598, 0.16390754282474518, 0.18468938767910004, 0.1659819334745407, 0.16702894866466522], [0.15082232654094696, 0.15447895228862762, 0.16119714081287384, 0.20148861408233643, 0.16503097116947174, 0.16698193550109863], [0.15125441551208496, 0.15481996536254883, 0.1613648235797882, 0.20047004520893097, 0.16509637236595154, 0.1669943779706955]], [[0.1705571562051773, 0.16049012541770935, 0.17392970621585846, 0.16006764769554138, 0.16074717044830322, 0.17420828342437744], [0.17461572587490082, 0.15375973284244537, 0.18191254138946533, 0.15291470289230347, 0.1542750597000122, 0.1825222373008728], [0.16920901834964752, 0.1626587212085724, 0.17137286067008972, 0.16238072514533997, 0.1628277450799942, 0.1715509295463562], [0.17478692531585693, 0.15346862375736237, 0.1822594702243805, 0.15260618925094604, 0.1539946347475052, 0.18288415670394897], [0.17451158165931702, 0.153936505317688, 0.18170194327831268, 0.1531020998954773, 0.1544453352689743, 0.1823025494813919], [0.16909795999526978, 0.162835955619812, 0.17116419970989227, 0.16256995499134064, 0.16299767792224884, 0.1713341772556305]], [[0.14957615733146667, 0.15397419035434723, 0.1621112823486328, 0.204567089676857, 0.16678698360919952, 0.16298431158065796], [0.15036097168922424, 0.15457531809806824, 0.16235801577568054, 0.20269186794757843, 0.1668218970298767, 0.16319194436073303], [0.15175670385360718, 0.15564000606536865, 0.16278767585754395, 0.19938987493515015, 0.16687394678592682, 0.16355179250240326], [0.158076211810112, 0.1603909730911255, 0.16458839178085327, 0.18495918810367584, 0.16695286333560944, 0.16503243148326874], [0.15252792835235596, 0.15622591972351074, 0.1630200892686844, 0.19758334755897522, 0.1668972671031952, 0.1637454777956009], [0.15190234780311584, 0.15575078129768372, 0.16283181309700012, 0.19904771447181702, 0.16687864065170288, 0.16358862817287445]], [[0.17083552479743958, 0.15805597603321075, 0.17516455054283142, 0.1597766876220703, 0.160644069314003, 0.17552319169044495], [0.1742064505815506, 0.1508265733718872, 0.18247683346271515, 0.1538841277360916, 0.15543606877326965, 0.1831699013710022], [0.16971313953399658, 0.16040712594985962, 0.17282167077064514, 0.16167186200618744, 0.1623079776763916, 0.1730782389640808], [0.17374786734580994, 0.15182612836360931, 0.18145595490932465, 0.1547047197818756, 0.15616440773010254, 0.18210087716579437], [0.17351721227169037, 0.1523268073797226, 0.18094578385353088, 0.1551150381565094, 0.15652823448181152, 0.18156681954860687], [0.16962061822414398, 0.16059976816177368, 0.1726304441690445, 0.16182668507099152, 0.16244365274906158, 0.17287878692150116]], [[0.15139836072921753, 0.15584997832775116, 0.1580815464258194, 0.20705918967723846, 0.1626410335302353, 0.16496986150741577], [0.152110293507576, 0.15637366473674774, 0.15850874781608582, 0.20504999160766602, 0.16286678612232208, 0.16509056091308594], [0.1524593085050583, 0.15662971138954163, 0.15871721506118774, 0.20406945049762726, 0.16297610104084015, 0.16514818370342255], [0.15905322134494781, 0.1613822728395462, 0.1625373512506485, 0.18610233068466187, 0.16487236320972443, 0.1660524159669876], [0.15315689146518707, 0.15714013576507568, 0.15913201868534088, 0.2021186351776123, 0.16319185495376587, 0.1652604639530182], [0.15350542962551117, 0.15739446878433228, 0.1593383103609085, 0.20114833116531372, 0.16329830884933472, 0.16531506180763245]], [[0.17088548839092255, 0.1607990860939026, 0.17233945429325104, 0.16037578880786896, 0.16105662286281586, 0.17454364895820618], [0.17534799873828888, 0.15440456569194794, 0.17848174273967743, 0.1535559892654419, 0.15492205321788788, 0.18328766524791718], [0.17025212943553925, 0.16169044375419617, 0.17147988080978394, 0.16132938861846924, 0.1619100421667099, 0.1733381301164627], [0.17553779482841492, 0.15412792563438416, 0.17874647676944733, 0.15326178073883057, 0.15465618669986725, 0.1836698055267334], [0.17523260414600372, 0.154572531580925, 0.17832091450691223, 0.15373466908931732, 0.15508347749710083, 0.18305575847625732], [0.16929695010185242, 0.1630275696516037, 0.17018896341323853, 0.16276125609874725, 0.16318947076797485, 0.17153578996658325]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0459847828175501e-05, "remove_single_ts_time_rank_from_batch": 1.2018606369647296e-05, "un_batch_to_individual_items": 6.482159152615657e-06, "normalize_and_clip_actions": 7.97862777067578e-06, "tensor_to_numpy": 1.4969947455473687e-05, "get_actions": 3.544733880707178e-05}}, "connector_pipeline_timer": 0.00011343669585653048}, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2437774562744974e-05, "add_states_from_episodes_to_batch": 2.607932319431969e-06, "add_time_dim_to_batch_and_zero_pad": 7.033577163806252e-06, "numpy_to_tensor": 1.18130740965615e-05, "add_observations_from_episodes_to_batch": 2.8311787488265158e-06}}, "connector_pipeline_timer": 5.8757032736121024e-05}, "weights_seq_no": 10.0, "episode_len_mean": 20.0, "num_episodes": 20, "episode_return_max": 14.5, "rlmodule_inference_timer": 3.0149646642355997e-05, "num_episodes_lifetime": 200, "env_step_timer": 1.4061452531754378e-05, "episode_duration_sec_mean": 0.00575148290139623, "agent_episode_returns_mean": {"default_agent": -0.4}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.0001851819296213696, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "episode_len_max": 20, "episode_return_mean": -0.4, "module_episode_returns_mean": {"default_policy": -0.4}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "sample": 0.11573257499739245, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 50400, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "time_between_sampling": 9.310796129443327}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "aeabe_00000", "date": "2025-08-11_18-50-54", "timestamp": 1754931054, "time_this_iter_s": 10.581008195877075, "time_total_s": 97.7941575050354, "pid": 11811, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161dfd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 97.7941575050354, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 46.5, "ram_util_percent": 81.08666666666666}}
{"timers": {"training_iteration": 9.261474894100656, "restore_env_runners": 8.587847054248657e-06, "training_step": 9.26131932051169, "env_runner_sampling_timer": 1.619060133534714, "learner_update_timer": 7.450124528919815, "synch_weights": 0.0009160884016233923, "restore_eval_env_runners": 8.81405843090141e-06, "evaluation_iteration": 0.1225422745528643, "synch_eval_env_connectors": 0.00011556380494234262, "synch_env_connectors": 4.911888838694757e-06}, "env_runners": {"module_episode_returns_mean": {"default_policy": -1.0999999999999996}, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.605683633240207e-06, "remove_single_ts_time_rank_from_batch": 1.187352732073376e-05, "normalize_and_clip_actions": 7.976117610676368e-06, "get_actions": 3.797396960265287e-05, "tensor_to_numpy": 1.4940418947523213e-05, "listify_data_for_vector_env": 1.0372552389597725e-05}}, "connector_pipeline_timer": 0.00011636161321255711}, "episode_return_min": -11.5, "time_between_sampling": 0.034938138452934225, "agent_episode_returns_mean": {"default_agent": -1.0999999999999996}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.653439585686998e-05, "add_states_from_episodes_to_batch": 2.6848028280952076e-06, "add_observations_from_episodes_to_batch": 2.8197752554965563e-06, "add_time_dim_to_batch_and_zero_pad": 6.845997995221569e-06, "batch_individual_items": 1.2366972228836373e-05}}, "connector_pipeline_timer": 8.337038462228164e-05}, "env_step_timer": 1.3746332285516008e-05, "episode_duration_sec_mean": 0.005755267317872494, "episode_return_mean": -1.0999999999999996, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 10.0, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "episode_return_max": 8.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "rlmodule_inference_timer": 3.062634051910889e-05, "sample": 0.006373836127470054, "num_episodes_lifetime": -277375.0, "num_env_steps_sampled_lifetime": -5547500.0, "env_reset_timer": 4.990240336937279e-05, "num_env_steps_sampled_lifetime_throughput": 3257.874135563329}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15368148507342824, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009413598451390668, "add_observations_from_episodes_to_batch": 0.0008719026887046054, "add_columns_from_episodes_to_train_batch": 0.0422223529288839, "add_time_dim_to_batch_and_zero_pad": 0.08977712744503612, "add_states_from_episodes_to_batch": 0.0036248244527215196, "batch_individual_items": 0.007520382024722396, "numpy_to_tensor": 8.573660564516826e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained_lifetime": 395010, "policy_loss": -1.9748502381844446e-05, "diff_num_grad_updates_vs_sampler_policy": 56.0, "weights_seq_no": 66.0, "total_loss": 0.248633474111557, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 3.047483005502727e-06, "vf_loss_unclipped": 42.30154800415039, "num_module_steps_trained": 35910, "vf_explained_var": -0.0026568174362182617, "module_train_batch_size_mean": 997.5206335045569, "vf_loss": 0.3205447196960449, "entropy": 0.6920862793922424}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 790020, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 2376000, "num_env_steps_trained_lifetime_throughput": 57268.216529161335}, "intrinsic_reward_module": {"module_train_batch_size_mean": 997.5206335045569, "num_module_steps_trained_lifetime": 395010, "diff_num_grad_updates_vs_sampler_policy": 56.0, "weights_seq_no": 66.0, "total_loss": 0.0, "num_module_steps_trained": 35910}}}, "__all_modules__": {"num_module_steps_trained_lifetime": 131670, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 396000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4689.644464663718, "num_module_steps_trained_throughput": 24519523.383536495, "num_module_steps_trained_lifetime_throughput": 13088694.954019407}, "intrinsic_reward_module": {"module_train_batch_size_mean": 998.2690509307901, "num_trainable_parameters": 8266, "num_module_steps_trained_lifetime": 65835, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "weights_seq_no": 11.0, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 778.9174726672699}, "default_policy": {"vf_explained_var": 0.0006892681121826172, "module_train_batch_size_mean": 998.2690509307901, "num_trainable_parameters": 16595, "vf_loss_unclipped": 42.175750732421875, "num_module_steps_trained_lifetime": 65835, "policy_loss": -2.2152808014652692e-05, "num_module_steps_trained": 5985, "vf_loss": 0.3205109238624573, "entropy": 0.6920886039733887, "curr_kl_coeff": 7.889840344432741e-05, "total_loss": 0.2486042082309723, "diff_num_grad_updates_vs_sampler_policy": 1.0, "use_intrinsic_rewards": 0.0, "weights_seq_no": 11.0, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 2.944417246908415e-06, "num_module_steps_trained_lifetime_throughput": 778.9061098134819}, "IntrinsicAttentionMask": [[[0.1505703330039978, 0.15901271998882294, 0.15517476201057434, 0.2065332680940628, 0.16636212170124054, 0.16234679520130157], [0.15182174742221832, 0.15965890884399414, 0.15610021352767944, 0.20321893692016602, 0.16645517945289612, 0.16274501383304596], [0.15126138925552368, 0.15937063097953796, 0.15568648278713226, 0.20469848811626434, 0.1664149910211563, 0.16256801784038544], [0.1578083634376526, 0.16263049840927124, 0.1604529470205307, 0.18786944448947906, 0.1667356640100479, 0.16450312733650208], [0.1528576761484146, 0.1601872593164444, 0.15686221420764923, 0.20050320029258728, 0.16652314364910126, 0.1630665808916092], [0.15229757130146027, 0.15990233421325684, 0.15645065903663635, 0.20196841657161713, 0.1664874255657196, 0.162893608212471]], [[0.1722562164068222, 0.15939141809940338, 0.17176707088947296, 0.1608550250530243, 0.16159187257289886, 0.1741383671760559], [0.17886801064014435, 0.15084078907966614, 0.17775468528270721, 0.15389862656593323, 0.1554507166147232, 0.18318714201450348], [0.17249995470046997, 0.15907518565654755, 0.17198869585990906, 0.16060017049312592, 0.16136814653873444, 0.1744678020477295], [0.17809425294399261, 0.15183863043785095, 0.17705662548542023, 0.15471744537353516, 0.15617726743221283, 0.182115837931633], [0.17770683765411377, 0.15233848989009857, 0.17670683562755585, 0.1551269292831421, 0.15654022991657257, 0.18158070743083954], [0.17132383584976196, 0.16060185432434082, 0.17091867327690125, 0.16182880103588104, 0.1624457687139511, 0.17288103699684143]], [[0.15150320529937744, 0.15380224585533142, 0.1561361700296402, 0.20781287550926208, 0.16739284992218018, 0.16335263848304749], [0.1518322378396988, 0.15408669412136078, 0.15637460350990295, 0.2068628966808319, 0.1673993468284607, 0.16344425082206726], [0.15216106176376343, 0.1543707251548767, 0.15661247074604034, 0.20591600239276886, 0.16740481555461884, 0.16353493928909302], [0.158363476395607, 0.1596849113702774, 0.16101735830307007, 0.1885303109884262, 0.16732218861579895, 0.16508179903030396], [0.15367835760116577, 0.15567836165428162, 0.1577043980360031, 0.20157968997955322, 0.16741721332073212, 0.16394206881523132], [0.15314634144306183, 0.1552204042673111, 0.15732257068157196, 0.2030939906835556, 0.16741526126861572, 0.1638014316558838]], [[0.1705441176891327, 0.1609954684972763, 0.1717052161693573, 0.16209156811237335, 0.16120193898677826, 0.1734617054462433], [0.1766020953655243, 0.15193884074687958, 0.1797582358121872, 0.15465423464775085, 0.15244808793067932, 0.18459853529930115], [0.1698150634765625, 0.16206875443458557, 0.17075130343437195, 0.16296230256557465, 0.16223716735839844, 0.17216534912586212], [0.17590174078941345, 0.15299926698207855, 0.178815096616745, 0.1555333137512207, 0.15347474813461304, 0.18327584862709045], [0.1764700710773468, 0.15213902294635773, 0.1795801967382431, 0.15482033789157867, 0.1526419222354889, 0.1843484789133072], [0.16871576011180878, 0.16368094086647034, 0.1693187654018402, 0.1642659604549408, 0.16379129886627197, 0.1702273190021515]], [[0.1484079211950302, 0.156729057431221, 0.15910740196704865, 0.21176746487617493, 0.1639729142189026, 0.1600152552127838], [0.14982400834560394, 0.15755802392959595, 0.1597626656293869, 0.20798687636852264, 0.16426490247249603, 0.16060352325439453], [0.15021489560604095, 0.15778513252735138, 0.15994146466255188, 0.20695176720619202, 0.1643429547548294, 0.1607637256383896], [0.157630056142807, 0.16195107996463776, 0.16316471993923187, 0.18800920248031616, 0.1656193733215332, 0.163625568151474], [0.15099667012691498, 0.1582370400428772, 0.16029636561870575, 0.20489275455474854, 0.1644957810640335, 0.16108129918575287], [0.15036259591579437, 0.15787072479724884, 0.1600087732076645, 0.20656169950962067, 0.16437216103076935, 0.1608240008354187]], [[0.17121700942516327, 0.15617592632770538, 0.17555570602416992, 0.1601334810256958, 0.16100279986858368, 0.17591513693332672], [0.17554035782814026, 0.14592856168746948, 0.18459251523017883, 0.15345372259616852, 0.15513215959072113, 0.18535268306732178], [0.16999246180057526, 0.1590251922607422, 0.1731061190366745, 0.16193796694278717, 0.1625751107931137, 0.1733631044626236], [0.17439191043376923, 0.148682102560997, 0.18212859332561493, 0.15527820587158203, 0.15674330294132233, 0.18277588486671448], [0.17414060235023499, 0.1492813527584076, 0.18159587681293488, 0.1556723564863205, 0.15709061920642853, 0.18221913278102875], [0.16989152133464813, 0.15925917029380798, 0.17290614545345306, 0.1620851457118988, 0.16270309686660767, 0.17315489053726196]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0370838696555831e-05, "remove_single_ts_time_rank_from_batch": 1.1741387821614143e-05, "un_batch_to_individual_items": 6.372318616540643e-06, "normalize_and_clip_actions": 7.785504851565271e-06, "tensor_to_numpy": 1.4850227996016454e-05, "get_actions": 3.562339997118942e-05}}, "connector_pipeline_timer": 0.00011258244396694142}, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2371218014374429e-05, "add_states_from_episodes_to_batch": 2.639467073060655e-06, "add_time_dim_to_batch_and_zero_pad": 6.877981058870163e-06, "numpy_to_tensor": 1.1783831497709587e-05, "add_observations_from_episodes_to_batch": 2.79691150621336e-06}}, "connector_pipeline_timer": 5.8507186137427595e-05}, "weights_seq_no": 11.0, "episode_len_mean": 20.0, "num_episodes": 20, "episode_return_max": 14.5, "rlmodule_inference_timer": 2.986392496609834e-05, "num_episodes_lifetime": 220, "env_step_timer": 1.3959988720006774e-05, "episode_duration_sec_mean": 0.005761462918017059, "agent_episode_returns_mean": {"default_agent": -0.4}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.00018402845091619914, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "episode_len_max": 20, "episode_return_mean": -0.4, "module_episode_returns_mean": {"default_policy": -0.4}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "sample": 0.11569366049806382, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 55400, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "time_between_sampling": 9.313812794397968}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "aeabe_00000", "date": "2025-08-11_18-51-03", "timestamp": 1754931063, "time_this_iter_s": 9.706220865249634, "time_total_s": 107.50037837028503, "pid": 11811, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161dfd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 107.50037837028503, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 36.8, "ram_util_percent": 80.76923076923077}}
{"timers": {"training_iteration": 9.26841570015962, "restore_env_runners": 8.565718778091819e-06, "training_step": 9.268259130226575, "env_runner_sampling_timer": 1.619250098868762, "learner_update_timer": 7.456764756130202, "synch_weights": 0.0009233075177681654, "restore_eval_env_runners": 8.842588117974132e-06, "evaluation_iteration": 0.12248964514727359, "synch_eval_env_connectors": 0.00011544191632429088, "synch_env_connectors": 4.904850596688591e-06}, "env_runners": {"module_episode_returns_mean": {"default_policy": -1.5800000000000005}, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.713610957022241e-06, "remove_single_ts_time_rank_from_batch": 1.1997475484148857e-05, "normalize_and_clip_actions": 8.119306967865347e-06, "get_actions": 3.916839861720888e-05, "tensor_to_numpy": 1.5231797071498233e-05, "listify_data_for_vector_env": 1.0591976431000535e-05}}, "connector_pipeline_timer": 0.0001187901892245665}, "episode_return_min": -11.5, "time_between_sampling": 0.03323299450556403, "agent_episode_returns_mean": {"default_agent": -1.5800000000000005}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2705205403007008e-05, "add_states_from_episodes_to_batch": 2.7179306590875762e-06, "add_observations_from_episodes_to_batch": 2.831649567639896e-06, "add_time_dim_to_batch_and_zero_pad": 6.93414306727377e-06, "batch_individual_items": 1.2595896201490901e-05}}, "connector_pipeline_timer": 6.023748014132177e-05}, "env_step_timer": 1.4095959539263973e-05, "episode_duration_sec_mean": 0.005312634186819194, "episode_return_mean": -1.5800000000000005, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 11.0, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "episode_return_max": 8.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "rlmodule_inference_timer": 3.1499994923981435e-05, "sample": 0.005767600956803932, "num_episodes_lifetime": -308250.0, "num_env_steps_sampled_lifetime": -6165000.0, "env_reset_timer": 4.203065696128934e-05, "num_env_steps_sampled_lifetime_throughput": 3213.4714697722334}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1536706502228453, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009406869557345094, "add_observations_from_episodes_to_batch": 0.0008739624109463629, "add_columns_from_episodes_to_train_batch": 0.04221766564991066, "add_time_dim_to_batch_and_zero_pad": 0.08977281159074084, "add_states_from_episodes_to_batch": 0.0036268466276578194, "batch_individual_items": 0.007521952374631741, "numpy_to_tensor": 8.545881908919807e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained_lifetime": 430920, "policy_loss": -5.190482988837175e-05, "diff_num_grad_updates_vs_sampler_policy": 61.0, "weights_seq_no": 72.0, "total_loss": 0.24860042333602905, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 1.416007216903381e-05, "vf_loss_unclipped": 42.15926742553711, "num_module_steps_trained": 35910, "vf_explained_var": -0.0026416778564453125, "module_train_batch_size_mean": 997.512081102731, "vf_loss": 0.32054072618484497, "entropy": 0.6918235421180725}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 861840, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 2592000, "num_env_steps_trained_lifetime_throughput": 56165.22306304968}, "intrinsic_reward_module": {"module_train_batch_size_mean": 997.512081102731, "num_module_steps_trained_lifetime": 430920, "diff_num_grad_updates_vs_sampler_policy": 61.0, "weights_seq_no": 72.0, "total_loss": 0.0, "num_module_steps_trained": 35910}}}, "__all_modules__": {"num_module_steps_trained_lifetime": 143640, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 432000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4662.028947899283, "num_module_steps_trained_throughput": 23885497.732205663, "num_module_steps_trained_lifetime_throughput": 13045563.173895324}, "intrinsic_reward_module": {"module_train_batch_size_mean": 998.2236050808158, "num_trainable_parameters": 8266, "num_module_steps_trained_lifetime": 71820, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "weights_seq_no": 12.0, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 774.3549363014412}, "default_policy": {"vf_explained_var": -0.0006127357482910156, "module_train_batch_size_mean": 998.2236050808158, "num_trainable_parameters": 16595, "vf_loss_unclipped": 42.084415435791016, "num_module_steps_trained_lifetime": 71820, "policy_loss": -5.427895666798577e-05, "num_module_steps_trained": 5985, "vf_loss": 0.32051053643226624, "entropy": 0.6918241381645203, "curr_kl_coeff": 3.944920172216371e-05, "total_loss": 0.2485722303390503, "diff_num_grad_updates_vs_sampler_policy": 1.0, "use_intrinsic_rewards": 0.0, "weights_seq_no": 12.0, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 1.4116204511083197e-05, "num_module_steps_trained_lifetime_throughput": 774.3442660068152}, "IntrinsicAttentionMask": [[[0.14953751862049103, 0.15393440425395966, 0.1561385542154312, 0.20451417565345764, 0.16674387454986572, 0.16913144290447235], [0.15032555162906647, 0.15453891456127167, 0.15664894878864288, 0.20264409482479095, 0.16678260266780853, 0.16905981302261353], [0.15071231126785278, 0.15483492612838745, 0.15689851343631744, 0.20173104107379913, 0.16680006682872772, 0.16902314126491547], [0.1580657809972763, 0.16038037836551666, 0.16152828931808472, 0.1849469691514969, 0.166941836476326, 0.16813671588897705], [0.15250086784362793, 0.156198188662529, 0.1580447405576706, 0.19754824042320251, 0.16686765849590302, 0.16884033381938934], [0.1528880000114441, 0.15649205446243286, 0.15829113125801086, 0.19665144383907318, 0.16687943041324615, 0.16879794001579285]], [[0.17203737795352936, 0.15916791558265686, 0.17391030490398407, 0.15863263607025146, 0.1594938039779663, 0.1767580211162567], [0.1764601767063141, 0.15277785062789917, 0.18003734946250916, 0.1518269181251526, 0.1533581167459488, 0.18553957343101501], [0.17140918970108032, 0.16005906462669373, 0.17305244505405426, 0.1595846563577652, 0.16034777462482452, 0.17554688453674316], [0.17664815485477448, 0.15250152349472046, 0.18030132353305817, 0.15153342485427856, 0.15309232473373413, 0.185923233628273], [0.17634588479995728, 0.1529456526041031, 0.17987702786922455, 0.1520051658153534, 0.15351949632167816, 0.18530675768852234], [0.17046160995960236, 0.16139604151248932, 0.17176386713981628, 0.1610143482685089, 0.16162821650505066, 0.17373593151569366]], [[0.1502740979194641, 0.1525544971227646, 0.1611081212759018, 0.21443039178848267, 0.15960539877414703, 0.16202740371227264], [0.1506320983171463, 0.15286873281002045, 0.1612519472837448, 0.213314950466156, 0.1597798764705658, 0.16215233504772186], [0.1519262194633484, 0.15400248765945435, 0.16176357865333557, 0.20930945873260498, 0.1604030877351761, 0.1625952124595642], [0.15863749384880066, 0.15982630848884583, 0.16420753300189972, 0.18921080231666565, 0.16344648599624634, 0.16467133164405823], [0.15170422196388245, 0.15380823612213135, 0.16167673468589783, 0.2099936306476593, 0.16029700636863708, 0.16252021491527557], [0.15206094086170197, 0.1541203111410141, 0.1618160754442215, 0.20889483392238617, 0.16046729683876038, 0.1626405268907547]], [[0.17161065340042114, 0.15877310931682587, 0.17595933377742767, 0.15823915600776672, 0.15909817814826965, 0.17631958425045013], [0.17561717331409454, 0.1520479917526245, 0.18395453691482544, 0.15110160410404205, 0.15262548625469208, 0.18465319275856018], [0.17027826607227325, 0.16094127297401428, 0.17339715361595154, 0.16054850816726685, 0.16118019819259644, 0.17365457117557526], [0.17578601837158203, 0.15175724029541016, 0.18430185317993164, 0.1507938802242279, 0.15234516561031342, 0.18501584231853485], [0.17551444470882416, 0.1522245556116104, 0.1837436705827713, 0.1512884944677353, 0.1527956873178482, 0.18443307280540466], [0.17016848921775818, 0.1611185073852539, 0.17318804562091827, 0.16073748469352722, 0.1613502949476242, 0.1734371930360794]], [[0.14752884209156036, 0.15763525664806366, 0.15404120087623596, 0.2094310224056244, 0.16450408101081848, 0.16685958206653595], [0.14953677356243134, 0.15866801142692566, 0.15542805194854736, 0.20458009839057922, 0.16483865678310394, 0.16694842278957367], [0.14883749186992645, 0.1583106517791748, 0.15494674444198608, 0.20625947415828705, 0.16472512483596802, 0.16692054271697998], [0.15817853808403015, 0.16288281977176666, 0.1612297147512436, 0.18469247221946716, 0.16598470509052277, 0.16703175008296967], [0.1508309543132782, 0.15932288765907288, 0.15631413459777832, 0.20150011777877808, 0.16504041850566864, 0.16699150204658508], [0.15126259624958038, 0.15953944623470306, 0.15660831332206726, 0.2004808485507965, 0.16510529816150665, 0.16700342297554016]], [[0.17121700942516327, 0.15617592632770538, 0.17555570602416992, 0.1601334810256958, 0.16100279986858368, 0.17591513693332672], [0.17554035782814026, 0.14592856168746948, 0.18459251523017883, 0.15345372259616852, 0.15513214468955994, 0.18535268306732178], [0.16999246180057526, 0.1590251922607422, 0.1731061190366745, 0.16193796694278717, 0.1625751107931137, 0.1733631044626236], [0.17439191043376923, 0.148682102560997, 0.18212859332561493, 0.15527820587158203, 0.15674330294132233, 0.18277588486671448], [0.17414060235023499, 0.1492813378572464, 0.18159587681293488, 0.1556723564863205, 0.15709061920642853, 0.18221913278102875], [0.16989152133464813, 0.15925917029380798, 0.17290614545345306, 0.1620851457118988, 0.16270309686660767, 0.17315489053726196]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0424388755496175e-05, "remove_single_ts_time_rank_from_batch": 1.190622910522182e-05, "un_batch_to_individual_items": 6.497417863009685e-06, "normalize_and_clip_actions": 7.8920166648907e-06, "tensor_to_numpy": 1.4865953187548305e-05, "get_actions": 3.531768695002393e-05}}, "connector_pipeline_timer": 0.00011290633811440429}, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2383772940074761e-05, "add_states_from_episodes_to_batch": 2.6181830037667423e-06, "add_time_dim_to_batch_and_zero_pad": 6.9142350603406795e-06, "numpy_to_tensor": 1.1882767314867541e-05, "add_observations_from_episodes_to_batch": 2.8100860378100084e-06}}, "connector_pipeline_timer": 5.8670767805143445e-05}, "weights_seq_no": 12.0, "episode_len_mean": 20.0, "num_episodes": 20, "episode_return_max": 14.5, "rlmodule_inference_timer": 2.9851661873992875e-05, "num_episodes_lifetime": 240, "env_step_timer": 1.3991925688265218e-05, "episode_duration_sec_mean": 0.005789944995194673, "agent_episode_returns_mean": {"default_agent": -0.6}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.00018539274726911222, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "episode_len_max": 20, "episode_return_mean": -0.6, "module_episode_returns_mean": {"default_policy": -0.6}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "sample": 0.1156797634837623, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 60400, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "time_between_sampling": 9.320494048122919}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "aeabe_00000", "date": "2025-08-11_18-51-13", "timestamp": 1754931073, "time_this_iter_s": 10.08088994026184, "time_total_s": 117.58126831054688, "pid": 11811, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161dfd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 117.58126831054688, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 39.373333333333335, "ram_util_percent": 80.85333333333332}}
{"timers": {"training_iteration": 9.27356390356769, "restore_env_runners": 8.627152349439232e-06, "training_step": 9.273406640173583, "env_runner_sampling_timer": 1.62064302870986, "learner_update_timer": 7.460239881068511, "synch_weights": 0.0009291544421658752, "restore_eval_env_runners": 9.142492318272151e-06, "evaluation_iteration": 0.12249136952593069, "synch_eval_env_connectors": 0.00011762957732388607, "synch_env_connectors": 4.898301832261064e-06}, "env_runners": {"module_episode_returns_mean": {"default_policy": -1.3400000000000003}, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.827951575117831e-06, "remove_single_ts_time_rank_from_batch": 1.2285713461248797e-05, "normalize_and_clip_actions": 8.316976991503376e-06, "get_actions": 4.132125347461595e-05, "tensor_to_numpy": 1.5784352236176814e-05, "listify_data_for_vector_env": 1.0788887960292535e-05}}, "connector_pipeline_timer": 0.00012286918649412795}, "episode_return_min": -11.5, "time_between_sampling": 0.03470611390598139, "agent_episode_returns_mean": {"default_agent": -1.3400000000000003}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3251187526520063e-05, "add_states_from_episodes_to_batch": 2.7935346335827013e-06, "add_observations_from_episodes_to_batch": 2.880948531333795e-06, "add_time_dim_to_batch_and_zero_pad": 7.112552850524997e-06, "batch_individual_items": 1.2928608998188395e-05}}, "connector_pipeline_timer": 6.160279283804662e-05}, "env_step_timer": 1.4563225860272887e-05, "episode_duration_sec_mean": 0.005486435665283355, "episode_return_mean": -1.3400000000000003, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 12.0, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "episode_return_max": 8.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "rlmodule_inference_timer": 3.24905715705114e-05, "sample": 0.005813995328602271, "num_episodes_lifetime": -339125.0, "num_env_steps_sampled_lifetime": -6782500.0, "env_reset_timer": 4.54306136341644e-05, "num_env_steps_sampled_lifetime_throughput": 3142.4143227739814}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1538043433000692, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009406224192462355, "add_observations_from_episodes_to_batch": 0.0008741777875038007, "add_columns_from_episodes_to_train_batch": 0.04225058441330459, "add_time_dim_to_batch_and_zero_pad": 0.08986408722556187, "add_states_from_episodes_to_batch": 0.003634961910281386, "batch_individual_items": 0.007523810350476237, "numpy_to_tensor": 8.554256051114233e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained_lifetime": 466830, "policy_loss": -8.958201215136796e-05, "diff_num_grad_updates_vs_sampler_policy": 66.0, "weights_seq_no": 78.0, "total_loss": 0.24856264889240265, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 6.022882189427037e-06, "vf_loss_unclipped": 42.377281188964844, "num_module_steps_trained": 35910, "vf_explained_var": -0.002622842788696289, "module_train_batch_size_mean": 997.5061250970534, "vf_loss": 0.3205420970916748, "entropy": 0.6917035579681396}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 933660, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 2808000, "num_env_steps_trained_lifetime_throughput": 55098.49225554977}, "intrinsic_reward_module": {"module_train_batch_size_mean": 997.5061250970534, "num_module_steps_trained_lifetime": 466830, "diff_num_grad_updates_vs_sampler_policy": 66.0, "weights_seq_no": 78.0, "total_loss": 0.0, "num_module_steps_trained": 35910}}}, "__all_modules__": {"num_module_steps_trained_lifetime": 155610, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 468000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4636.9909910503475, "num_module_steps_trained_throughput": 23282462.700291354, "num_module_steps_trained_lifetime_throughput": 13002098.907976596}, "intrinsic_reward_module": {"module_train_batch_size_mean": 998.1808187151925, "num_trainable_parameters": 8266, "num_module_steps_trained_lifetime": 77805, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "weights_seq_no": 13.0, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 770.219718232678}, "default_policy": {"vf_explained_var": -0.0005918741226196289, "module_train_batch_size_mean": 998.1808187151925, "num_trainable_parameters": 16595, "vf_loss_unclipped": 42.29138946533203, "num_module_steps_trained_lifetime": 77805, "policy_loss": -9.240078361472115e-05, "num_module_steps_trained": 5985, "vf_loss": 0.3205114006996155, "entropy": 0.6916988492012024, "curr_kl_coeff": 1.9724600861081854e-05, "total_loss": 0.24853499233722687, "diff_num_grad_updates_vs_sampler_policy": 1.0, "use_intrinsic_rewards": 0.0, "weights_seq_no": 13.0, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 6.341929292830173e-06, "num_module_steps_trained_lifetime_throughput": 770.2096939864778}, "IntrinsicAttentionMask": [[[0.15028811991214752, 0.15871469676494598, 0.1548839509487152, 0.2144504189491272, 0.15962029993534088, 0.1620425283908844], [0.15158145129680634, 0.15940620005130768, 0.15585310757160187, 0.21042658388614655, 0.16024518013000488, 0.16248741745948792], [0.15100273489952087, 0.15909810364246368, 0.1554202437400818, 0.2122218757867813, 0.15996702015399933, 0.16229002177715302], [0.1586412489414215, 0.16298998892307281, 0.16102784872055054, 0.189215287566185, 0.16345036029815674, 0.16467523574829102], [0.15171609818935394, 0.1594775766134262, 0.15595366060733795, 0.2100100964307785, 0.1603095680475235, 0.1625329554080963], [0.15207232534885406, 0.15966585278511047, 0.15621928870677948, 0.2089104950428009, 0.1604793220758438, 0.16265271604061127]], [[0.17255717515945435, 0.15776778757572174, 0.17414169013500214, 0.1592164933681488, 0.1618742048740387, 0.1744426190853119], [0.1804819107055664, 0.14581716060638428, 0.18445159494876862, 0.14902441203594208, 0.15501371026039124, 0.185211181640625], [0.17173466086387634, 0.1590092033147812, 0.17308872938156128, 0.16026292741298676, 0.16255877912044525, 0.173345685005188], [0.17968592047691345, 0.14701715111732483, 0.1834019124507904, 0.15005755424499512, 0.15572500228881836, 0.18411241471767426], [0.17823673784732819, 0.1492018848657608, 0.18149922788143158, 0.15193292498588562, 0.15700700879096985, 0.1821221560239792], [0.1715790331363678, 0.1592441350221634, 0.1728898286819458, 0.1604606956243515, 0.1626877337694168, 0.1731385439634323]], [[0.14931410551071167, 0.15157993137836456, 0.16007892787456512, 0.21306057274341583, 0.1649741679430008, 0.1609923392534256], [0.14968961477279663, 0.15191225707530975, 0.16024303436279297, 0.21198029816150665, 0.16503705084323883, 0.16113777458667755], [0.15104830265045166, 0.15311257541179657, 0.16082881391048431, 0.20809994637966156, 0.16525472700595856, 0.16165564954280853], [0.15812654793262482, 0.15931151807308197, 0.1636786311864853, 0.18860137462615967, 0.16614101827144623, 0.16414093971252441], [0.15179747343063354, 0.1537729948759079, 0.16114647686481476, 0.2059793919324875, 0.16536816954612732, 0.16193556785583496], [0.1511898636817932, 0.15323743224143982, 0.16088911890983582, 0.20769819617271423, 0.16527651250362396, 0.16170884668827057]], [[0.17024725675582886, 0.16019852459430695, 0.1716957986354828, 0.15977680683135986, 0.1622474193572998, 0.17583417892456055], [0.17396552860736847, 0.15318724513053894, 0.1770745813846588, 0.15234535932540894, 0.1573120653629303, 0.18611526489257812], [0.1697135865688324, 0.16117897629737854, 0.1709374636411667, 0.16081906855106354, 0.1629256010055542, 0.1744253784418106], [0.17412196099758148, 0.15288479626178741, 0.17730477452278137, 0.15202562510967255, 0.157095804810524, 0.18656708300113678], [0.17320577800273895, 0.15464714169502258, 0.1759612113237381, 0.15388961136341095, 0.1583520621061325, 0.18394415080547333], [0.1681935042142868, 0.16393934190273285, 0.168794646859169, 0.16375747323036194, 0.16481901705265045, 0.17049604654312134]], [[0.15045559406280518, 0.15487948060035706, 0.15709716081619263, 0.20576977729797363, 0.16162824630737305, 0.17016983032226562], [0.1512066125869751, 0.1554446518421173, 0.1575670689344406, 0.2038317769765854, 0.16189919412136078, 0.17005068063735962], [0.1515749990940094, 0.15572121739387512, 0.15779662132263184, 0.20288576185703278, 0.16203077137470245, 0.1699906289577484], [0.15855620801448822, 0.160877987742424, 0.1620294600725174, 0.18552079796791077, 0.16435717046260834, 0.16865839064121246], [0.15231162309646606, 0.15627287328243256, 0.1582537740468979, 0.20100311934947968, 0.16229118406772614, 0.16986745595932007], [0.1536451280117035, 0.15726704895496368, 0.1590750366449356, 0.1976253092288971, 0.162753626704216, 0.1696338802576065]], [[0.1699439436197281, 0.1599131077528, 0.1713898926973343, 0.16127371788024902, 0.16195836663246155, 0.1755209118127823], [0.17334502935409546, 0.15264084935188293, 0.1764429807662964, 0.15536877512931824, 0.15675096213817596, 0.1854514181613922], [0.1694556027650833, 0.1609339714050293, 0.17067761719226837, 0.16209453344345093, 0.16267794370651245, 0.17416024208068848], [0.1728827953338623, 0.15364715456962585, 0.1757461428642273, 0.15619193017482758, 0.15748007595539093, 0.18405194580554962], [0.17265023291110992, 0.15415111184120178, 0.1753968447446823, 0.15660342574119568, 0.1578441709280014, 0.18335416913032532], [0.16806446015834808, 0.16381356120109558, 0.16866514086723328, 0.16439905762672424, 0.16469256579875946, 0.17036524415016174]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1049500452490848e-05, "remove_single_ts_time_rank_from_batch": 1.2477247082169502e-05, "un_batch_to_individual_items": 7.0550891802865535e-06, "normalize_and_clip_actions": 8.233350214941058e-06, "tensor_to_numpy": 1.5829011056064125e-05, "get_actions": 3.9936667930395785e-05}}, "connector_pipeline_timer": 0.00012219676954526706}, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.275841628316202e-05, "add_states_from_episodes_to_batch": 2.7106808615057914e-06, "add_time_dim_to_batch_and_zero_pad": 7.254220459658493e-06, "numpy_to_tensor": 1.2673169150211018e-05, "add_observations_from_episodes_to_batch": 2.970843921920067e-06}}, "connector_pipeline_timer": 6.10296278871391e-05}, "weights_seq_no": 13.0, "episode_len_mean": 20.0, "num_episodes": 20, "episode_return_max": 14.5, "rlmodule_inference_timer": 3.3362861670460736e-05, "num_episodes_lifetime": 260, "env_step_timer": 1.5051201134126492e-05, "episode_duration_sec_mean": 0.00586068999604322, "agent_episode_returns_mean": {"default_agent": 0.8}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.00018673922949751512, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "episode_len_max": 20, "episode_return_mean": 0.8, "module_episode_returns_mean": {"default_policy": 0.8}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "sample": 0.11574267126784109, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 65400, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "time_between_sampling": 9.32540903556116}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "aeabe_00000", "date": "2025-08-11_18-51-23", "timestamp": 1754931083, "time_this_iter_s": 9.916943073272705, "time_total_s": 127.49821138381958, "pid": 11811, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161dfd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 127.49821138381958, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 39.3, "ram_util_percent": 80.97857142857143}}
{"timers": {"training_iteration": 9.279391137031473, "restore_env_runners": 8.624210913308561e-06, "training_step": 9.279233131692566, "env_runner_sampling_timer": 1.6206808396722763, "learner_update_timer": 7.465927932677824, "synch_weights": 0.0009286191471887757, "restore_eval_env_runners": 9.653147648973626e-06, "evaluation_iteration": 0.12257483249054339, "synch_eval_env_connectors": 0.00011838036141635615, "synch_env_connectors": 4.888898859206392e-06}, "env_runners": {"module_episode_returns_mean": {"default_policy": -0.6199999999999999}, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.596558375398567e-06, "remove_single_ts_time_rank_from_batch": 1.1887488808293079e-05, "normalize_and_clip_actions": 8.036892094511398e-06, "get_actions": 3.8723353302344e-05, "tensor_to_numpy": 1.5055860687912916e-05, "listify_data_for_vector_env": 1.0408175747041021e-05}}, "connector_pipeline_timer": 0.00011753833944269201}, "episode_return_min": -11.5, "time_between_sampling": 0.03370138133184745, "agent_episode_returns_mean": {"default_agent": -0.6199999999999999}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2544384379906062e-05, "add_states_from_episodes_to_batch": 2.6784219721747727e-06, "add_observations_from_episodes_to_batch": 2.8200946914506764e-06, "add_time_dim_to_batch_and_zero_pad": 6.851515670953615e-06, "batch_individual_items": 1.2435088527847185e-05}}, "connector_pipeline_timer": 5.961367298330043e-05}, "env_step_timer": 1.3762359404100642e-05, "episode_duration_sec_mean": 0.0052334632892161595, "episode_return_mean": -0.6199999999999999, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 13.0, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "episode_return_max": 8.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "rlmodule_inference_timer": 3.112463354394671e-05, "sample": 0.0056980766225899725, "num_episodes_lifetime": -370000.0, "num_env_steps_sampled_lifetime": -7400000.0, "env_reset_timer": 4.266423321664738e-05, "num_env_steps_sampled_lifetime_throughput": 3244.7436806492997}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1537977044475238, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009401085699818824, "add_observations_from_episodes_to_batch": 0.0008737210098505666, "add_columns_from_episodes_to_train_batch": 0.042239374818538844, "add_time_dim_to_batch_and_zero_pad": 0.0898620634331584, "add_states_from_episodes_to_batch": 0.003640383951504621, "batch_individual_items": 0.007530674746408062, "numpy_to_tensor": 8.562046448079468e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained_lifetime": 502740, "policy_loss": -0.00033061314024962485, "diff_num_grad_updates_vs_sampler_policy": 71.0, "weights_seq_no": 84.0, "total_loss": 0.24832317233085632, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 4.2417530494276434e-05, "vf_loss_unclipped": 41.81266403198242, "num_module_steps_trained": 35910, "vf_explained_var": -0.0025796890258789062, "module_train_batch_size_mean": 997.501977255973, "vf_loss": 0.3205353319644928, "entropy": 0.6910800933837891}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 1005480, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 3024000, "num_env_steps_trained_lifetime_throughput": 54070.44302512496}, "intrinsic_reward_module": {"module_train_batch_size_mean": 997.501977255973, "num_module_steps_trained_lifetime": 502740, "diff_num_grad_updates_vs_sampler_policy": 71.0, "weights_seq_no": 84.0, "total_loss": 0.0, "num_module_steps_trained": 35910}}}, "__all_modules__": {"num_module_steps_trained_lifetime": 167580, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 504000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4613.275019291673, "num_module_steps_trained_throughput": 22707532.517264675, "num_module_steps_trained_lifetime_throughput": 12960049.233683843}, "intrinsic_reward_module": {"module_train_batch_size_mean": 998.1405362012929, "num_trainable_parameters": 8266, "num_module_steps_trained_lifetime": 83790, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "weights_seq_no": 14.0, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 766.3032434406305}, "default_policy": {"vf_explained_var": 0.0015073418617248535, "module_train_batch_size_mean": 998.1405362012929, "num_trainable_parameters": 16595, "vf_loss_unclipped": 41.67076110839844, "num_module_steps_trained_lifetime": 83790, "policy_loss": -0.0003391650097910315, "num_module_steps_trained": 5985, "vf_loss": 0.3205161690711975, "entropy": 0.6910691857337952, "curr_kl_coeff": 9.862300430540927e-06, "total_loss": 0.24829287827014923, "diff_num_grad_updates_vs_sampler_policy": 1.0, "use_intrinsic_rewards": 0.0, "weights_seq_no": 14.0, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 4.4026812247466296e-05, "num_module_steps_trained_lifetime_throughput": 766.293926507471}, "IntrinsicAttentionMask": [[[0.14755374193191528, 0.15766184031963348, 0.1599193513393402, 0.2094663679599762, 0.15851089358329773, 0.16688774526119232], [0.14955706894397736, 0.15868954360485077, 0.1607205867767334, 0.20460787415504456, 0.15945379436016083, 0.1669710874557495], [0.14998739957809448, 0.1589076817035675, 0.16088975965976715, 0.20357604324817657, 0.15965357422828674, 0.16698558628559113], [0.15818391740322113, 0.16288834810256958, 0.16391585767269135, 0.18469874560832977, 0.16327574849128723, 0.16703742742538452], [0.14971962571144104, 0.1587720513343811, 0.16078461706638336, 0.20421764254570007, 0.15952937304973602, 0.1669766902923584], [0.1512793004512787, 0.1595570296049118, 0.16139136254787445, 0.20050297677516937, 0.1602475345134735, 0.16702184081077576]], [[0.1702527403831482, 0.16020366549491882, 0.17361928522586823, 0.16156676411628723, 0.16046026349067688, 0.17389735579490662], [0.17399054765701294, 0.15320926904678345, 0.18126127123832703, 0.15594735741615295, 0.15372274816036224, 0.1818687617778778], [0.1690104901790619, 0.1624678671360016, 0.17117178440093994, 0.16336360573768616, 0.1626366823911667, 0.1713496446609497], [0.17348144948482513, 0.15417920053005219, 0.18019412457942963, 0.15673278272151947, 0.15465833246707916, 0.18075409531593323], [0.17389468848705292, 0.15339237451553345, 0.18105964362621307, 0.15609578788280487, 0.1538994014263153, 0.18165811896324158], [0.16890813410282135, 0.1626531481742859, 0.1709720343351364, 0.16351014375686646, 0.1628146767616272, 0.1711418330669403]], [[0.14842286705970764, 0.1527869701385498, 0.1608613282442093, 0.21070018410682678, 0.16550098359584808, 0.16172762215137482], [0.14926572144031525, 0.15344935655593872, 0.16117538511753082, 0.20849958062171936, 0.16560673713684082, 0.16200321912765503], [0.15076352655887604, 0.1546214073896408, 0.1617223173379898, 0.20462948083877563, 0.16578184068202972, 0.1624814122915268], [0.15860912203788757, 0.1606551855802536, 0.16435647010803223, 0.18519523739814758, 0.1664365530014038, 0.16474737226963043], [0.15159054100513458, 0.15526577830314636, 0.16201819479465485, 0.2025148719549179, 0.16587156057357788, 0.1627391278743744], [0.15091975033283234, 0.1547432839870453, 0.1617785394191742, 0.20422883331775665, 0.16579917073249817, 0.16253043711185455]], [[0.17055456340312958, 0.15871478617191315, 0.17392708361148834, 0.16185319423675537, 0.16074472665786743, 0.17420564591884613], [0.17532135546207428, 0.1486911028623581, 0.18336132168769836, 0.1555098444223404, 0.15308183431625366, 0.18403451144695282], [0.16920793056488037, 0.161489337682724, 0.17137175798416138, 0.16355445981025696, 0.16282668709754944, 0.17154982686042786], [0.17405323684215546, 0.15139144659042358, 0.180788055062294, 0.15724937617778778, 0.1551680862903595, 0.18134987354278564], [0.17450083792209625, 0.1504412740468979, 0.1816907674074173, 0.15663987398147583, 0.15443584322929382, 0.18229132890701294], [0.16909697651863098, 0.16171693801879883, 0.17116320133209229, 0.16369296610355377, 0.16299670934677124, 0.1713331788778305]], [[0.1496349722146988, 0.15802492201328278, 0.1604229360818863, 0.2052503079175949, 0.16532866656780243, 0.16133826971054077], [0.15094736218452454, 0.158739373087883, 0.16096054017543793, 0.20204855501651764, 0.16549651324748993, 0.16180768609046936], [0.15130987763404846, 0.15893526375293732, 0.16110733151435852, 0.20117104053497314, 0.1655408889055252, 0.16193558275699615], [0.15725252032279968, 0.16205768287181854, 0.16340993344783783, 0.18720774352550507, 0.16614839434623718, 0.1639237105846405], [0.1520351767539978, 0.15932533144950867, 0.16139884293079376, 0.1994243711233139, 0.1656271368265152, 0.16218914091587067], [0.1514468491077423, 0.15900911390781403, 0.1611625999212265, 0.20084026455879211, 0.16555742919445038, 0.1619836837053299]], [[0.17106622457504272, 0.16148832440376282, 0.17070549726486206, 0.161147803068161, 0.16314031183719635, 0.17245174944400787], [0.1780860871076584, 0.15321557223796844, 0.17710734903812408, 0.1523735225200653, 0.1573411524295807, 0.1818762719631195], [0.17132499814033508, 0.1611836552619934, 0.17094242572784424, 0.1608237326145172, 0.16293033957481384, 0.17279484868049622], [0.1783413589000702, 0.15291441977024078, 0.17733915150165558, 0.15205508470535278, 0.15712623298168182, 0.18222372233867645], [0.17685319483280182, 0.15466967225074768, 0.1759869009256363, 0.15391205251216888, 0.15837515890598297, 0.18020309507846832], [0.17007647454738617, 0.16265366971492767, 0.16979864239692688, 0.16238796710968018, 0.16394087672233582, 0.17114238440990448]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0367794915755843e-05, "remove_single_ts_time_rank_from_batch": 1.1892724405737182e-05, "un_batch_to_individual_items": 6.562654410716331e-06, "normalize_and_clip_actions": 7.807577380312405e-06, "tensor_to_numpy": 1.505989796699556e-05, "get_actions": 3.582845419332392e-05}}, "connector_pipeline_timer": 0.00011354781694978963}, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.242713624470276e-05, "add_states_from_episodes_to_batch": 2.5986813694107587e-06, "add_time_dim_to_batch_and_zero_pad": 6.925687575961117e-06, "numpy_to_tensor": 1.1985054560825326e-05, "add_observations_from_episodes_to_batch": 2.800746676535616e-06}}, "connector_pipeline_timer": 5.88220352574601e-05}, "weights_seq_no": 14.0, "episode_len_mean": 20.0, "num_episodes": 20, "episode_return_max": 14.5, "rlmodule_inference_timer": 3.005487276720336e-05, "num_episodes_lifetime": 280, "env_step_timer": 1.3835807508299103e-05, "episode_duration_sec_mean": 0.005243727117776871, "agent_episode_returns_mean": {"default_agent": -0.4}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.00018571600777477615, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "episode_len_max": 20, "episode_return_mean": -0.4, "module_episode_returns_mean": {"default_policy": -0.4}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "sample": 0.11570964747541253, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 70400, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "time_between_sampling": 9.330985176865362}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "aeabe_00000", "date": "2025-08-11_18-51-33", "timestamp": 1754931093, "time_this_iter_s": 9.976938009262085, "time_total_s": 137.47514939308167, "pid": 11811, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161dfd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 137.47514939308167, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 40.107142857142854, "ram_util_percent": 81.35}}
{"timers": {"training_iteration": 9.279016189410818, "restore_env_runners": 8.593799264217236e-06, "training_step": 9.278857552045594, "env_runner_sampling_timer": 1.6195929850264879, "learner_update_timer": 7.46572180960041, "synch_weights": 0.0009291929551258334, "restore_eval_env_runners": 9.619116066313116e-06, "evaluation_iteration": 0.12252805833610857, "synch_eval_env_connectors": 0.0001183698973535073, "synch_env_connectors": 4.879589915882268e-06}, "env_runners": {"module_episode_returns_mean": {"default_policy": -1.6599999999999997}, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.5689607686373085e-06, "remove_single_ts_time_rank_from_batch": 1.1804475405251054e-05, "normalize_and_clip_actions": 7.988336927923302e-06, "get_actions": 3.832390200497325e-05, "tensor_to_numpy": 1.4867056494722749e-05, "listify_data_for_vector_env": 1.0302758011028299e-05}}, "connector_pipeline_timer": 0.0001163976620415535}, "episode_return_min": -11.5, "time_between_sampling": 0.03411072868386513, "agent_episode_returns_mean": {"default_agent": -1.6599999999999997}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2457637734024055e-05, "add_states_from_episodes_to_batch": 2.661981800213012e-06, "add_observations_from_episodes_to_batch": 2.7832005597529406e-06, "add_time_dim_to_batch_and_zero_pad": 6.786128706102323e-06, "batch_individual_items": 1.2347330102418169e-05}}, "connector_pipeline_timer": 5.9123662907929995e-05}, "env_step_timer": 1.3654148877939208e-05, "episode_duration_sec_mean": 0.005191670514643192, "episode_return_mean": -1.6599999999999997, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 14.0, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "episode_return_max": 8.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "rlmodule_inference_timer": 3.0759535374256214e-05, "sample": 0.005571446810921713, "num_episodes_lifetime": -400875.0, "num_env_steps_sampled_lifetime": -8017500.0, "env_reset_timer": 3.9799940343069744e-05, "num_env_steps_sampled_lifetime_throughput": 3294.882800055779}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1546177503231374, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00939234859341266, "add_observations_from_episodes_to_batch": 0.0008742817203758552, "add_columns_from_episodes_to_train_batch": 0.04308022982082776, "add_time_dim_to_batch_and_zero_pad": 0.08984817820962701, "add_states_from_episodes_to_batch": 0.0036434955223066823, "batch_individual_items": 0.007529657158327607, "numpy_to_tensor": 8.532967974087442e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained_lifetime": 538650, "policy_loss": 2.7081132429884747e-06, "diff_num_grad_updates_vs_sampler_policy": 76.0, "weights_seq_no": 90.0, "total_loss": 0.24865500628948212, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 6.4857777033466846e-06, "vf_loss_unclipped": 42.65169143676758, "num_module_steps_trained": 35910, "vf_explained_var": -0.002584695816040039, "module_train_batch_size_mean": 997.499088644618, "vf_loss": 0.3205406665802002, "entropy": 0.6909797787666321}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 1077300, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 3240000, "num_env_steps_trained_lifetime_throughput": 53109.241888279925}, "intrinsic_reward_module": {"module_train_batch_size_mean": 997.499088644618, "num_module_steps_trained_lifetime": 538650, "diff_num_grad_updates_vs_sampler_policy": 76.0, "weights_seq_no": 90.0, "total_loss": 0.0, "num_module_steps_trained": 35910}}}, "__all_modules__": {"num_module_steps_trained_lifetime": 179550, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 540000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4594.01501139477, "num_module_steps_trained_throughput": 22176177.068951737, "num_module_steps_trained_lifetime_throughput": 12933583.23216286}, "intrinsic_reward_module": {"module_train_batch_size_mean": 998.1026110140886, "num_trainable_parameters": 8266, "num_module_steps_trained_lifetime": 89775, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "weights_seq_no": 15.0, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 763.1265417525739}, "default_policy": {"vf_explained_var": 0.0020477771759033203, "module_train_batch_size_mean": 998.1026110140886, "num_trainable_parameters": 16595, "vf_loss_unclipped": 42.463478088378906, "num_module_steps_trained_lifetime": 89775, "policy_loss": -6.056033043932985e-07, "num_module_steps_trained": 5985, "vf_loss": 0.32052338123321533, "entropy": 0.6909841895103455, "curr_kl_coeff": 4.931150215270463e-06, "total_loss": 0.24863719940185547, "diff_num_grad_updates_vs_sampler_policy": 1.0, "use_intrinsic_rewards": 0.0, "weights_seq_no": 15.0, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 6.2540543694922235e-06, "num_module_steps_trained_lifetime_throughput": 763.1178725732466}, "IntrinsicAttentionMask": [[[0.150507390499115, 0.16081781685352325, 0.1571512371301651, 0.20584067702293396, 0.16168387234210968, 0.16399899125099182], [0.15221455693244934, 0.16150930523872375, 0.15821132063865662, 0.20141348242759705, 0.16228711605072021, 0.16436423361301422], [0.15162035822868347, 0.1612706333398819, 0.15784381330013275, 0.20294654369354248, 0.16207925975322723, 0.16423940658569336], [0.15857014060020447, 0.16392934322357178, 0.16204369068145752, 0.18553711473941803, 0.16437160968780518, 0.16554807126522064], [0.1523529440164566, 0.16156457364559174, 0.15829667448997498, 0.20105770230293274, 0.16233520209789276, 0.16439294815063477], [0.152719184756279, 0.16171030700206757, 0.15852217376232147, 0.20011810958385468, 0.16246189177036285, 0.16446831822395325]], [[0.17080652713775635, 0.16124318540096283, 0.17196941375732422, 0.1623409539461136, 0.16144996881484985, 0.17218995094299316], [0.17735369503498077, 0.1525854468345642, 0.18052327632904053, 0.15531238913536072, 0.15309683978557587, 0.18112829327583313], [0.17002533376216888, 0.1622694432735443, 0.17096272110939026, 0.16316409409046173, 0.1624380499124527, 0.1711403727531433], [0.17659135162830353, 0.15359905362129211, 0.17951613664627075, 0.15614302456378937, 0.15407638251781464, 0.18007400631904602], [0.17720989882946014, 0.1527767926454544, 0.18033307790756226, 0.15546934306621552, 0.1532817780971527, 0.18092915415763855], [0.1698775440454483, 0.16246341168880463, 0.17077261209487915, 0.1633194237947464, 0.1626247614622116, 0.17094220221042633]], [[0.1496204137802124, 0.1580095738172531, 0.16040734946727753, 0.20523042976856232, 0.15891113877296448, 0.1678212285041809], [0.1509348452091217, 0.15872620046138763, 0.16094718873500824, 0.20203185081481934, 0.15956160426139832, 0.16779831051826477], [0.15129788219928741, 0.1589226871728897, 0.1610945612192154, 0.2011551558971405, 0.159739688038826, 0.16778993606567383], [0.15724782645702362, 0.16205283999443054, 0.16340504586696625, 0.18720217049121857, 0.16256235539913177, 0.16752976179122925], [0.15107198059558868, 0.15880051255226135, 0.161002978682518, 0.201700359582901, 0.1596289873123169, 0.16779525578022003], [0.15238752961158752, 0.1595085859298706, 0.16153249144554138, 0.19854165613651276, 0.16027015447616577, 0.16775958240032196]], [[0.1708056926727295, 0.16124239563941956, 0.17196857929229736, 0.16090238094329834, 0.16289184987545013, 0.1721891164779663], [0.1773480921983719, 0.1525806039571762, 0.18051756918430328, 0.15174204111099243, 0.1566890925168991, 0.1811225712299347], [0.1700247824192047, 0.16226892173290253, 0.1709621697664261, 0.16199159622192383, 0.1636127233505249, 0.17113982141017914], [0.17758451402187347, 0.15226541459560394, 0.18083059787750244, 0.15140973031520844, 0.15645937621593475, 0.18145038187503815], [0.17620481550693512, 0.15410257875919342, 0.17900794744491577, 0.15334773063659668, 0.15779447555541992, 0.1795424222946167], [0.1698770672082901, 0.1624629646539688, 0.17077213525772095, 0.16219757497310638, 0.16374865174293518, 0.17094172537326813]], [[0.14957615733146667, 0.15397416055202484, 0.16211125254631042, 0.20456714928150177, 0.16678696870803833, 0.16298428177833557], [0.15036095678806305, 0.15457527339458466, 0.16235801577568054, 0.2026919424533844, 0.16682188212871552, 0.16319192945957184], [0.15175671875476837, 0.15563997626304626, 0.16278767585754395, 0.19938994944095612, 0.166873961687088, 0.16355179250240326], [0.1580761969089508, 0.1603909432888031, 0.16458836197853088, 0.18495918810367584, 0.16695284843444824, 0.16503240168094635], [0.15252792835235596, 0.15622588992118835, 0.1630200743675232, 0.19758340716362, 0.1668972671031952, 0.1637454628944397], [0.15190234780311584, 0.15575076639652252, 0.16283181309700012, 0.19904778897762299, 0.16687864065170288, 0.16358862817287445]], [[0.17085586488246918, 0.15899516642093658, 0.17230959236621857, 0.16034796833992004, 0.1610286831855774, 0.17646275460720062], [0.17598481476306915, 0.149253711104393, 0.1794324517250061, 0.15217767655849457, 0.15366105735301971, 0.18949022889137268], [0.1702309101819992, 0.1601543426513672, 0.17145851254463196, 0.16130927205085754, 0.16188986599445343, 0.1749570667743683], [0.175398051738739, 0.15039068460464478, 0.17860418558120728, 0.15313971042633057, 0.1545329988002777, 0.18793439865112305], [0.17510287463665009, 0.15096025168895721, 0.17818892002105713, 0.15362079441547394, 0.15496860444545746, 0.18715858459472656], [0.1684519499540329, 0.163425013422966, 0.16905400156974792, 0.16400910913944244, 0.16430193185806274, 0.17075802385807037]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.051445003512498e-05, "remove_single_ts_time_rank_from_batch": 1.1915602937796866e-05, "un_batch_to_individual_items": 6.517006710059169e-06, "normalize_and_clip_actions": 7.885516273140917e-06, "tensor_to_numpy": 1.5045332922880056e-05, "get_actions": 3.592070925387739e-05}}, "connector_pipeline_timer": 0.00011401073383816738}, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2370852973840026e-05, "add_states_from_episodes_to_batch": 2.618756324716266e-06, "add_time_dim_to_batch_and_zero_pad": 6.86967396479226e-06, "numpy_to_tensor": 1.1971670797176643e-05, "add_observations_from_episodes_to_batch": 2.8088078094901195e-06}}, "connector_pipeline_timer": 5.88828732336004e-05}, "weights_seq_no": 15.0, "episode_len_mean": 20.0, "num_episodes": 20, "episode_return_max": 14.5, "rlmodule_inference_timer": 3.037224559808094e-05, "num_episodes_lifetime": 300, "env_step_timer": 1.4056454249437875e-05, "episode_duration_sec_mean": 0.005243349187076092, "agent_episode_returns_mean": {"default_agent": -0.8}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.00018478093737246977, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "episode_len_max": 20, "episode_return_mean": -0.8, "module_episode_returns_mean": {"default_policy": -0.8}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "sample": 0.11567806933103128, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 75400, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "time_between_sampling": 9.330324392177054}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "aeabe_00000", "date": "2025-08-11_18-51-43", "timestamp": 1754931103, "time_this_iter_s": 9.362752914428711, "time_total_s": 146.83790230751038, "pid": 11811, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161dfd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 146.83790230751038, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 34.784615384615385, "ram_util_percent": 80.43076923076924}}
{"timers": {"training_iteration": 9.288828892096241, "restore_env_runners": 8.564110826775401e-06, "training_step": 9.288669861934766, "env_runner_sampling_timer": 1.6207540639267732, "learner_update_timer": 7.47424652941409, "synch_weights": 0.0009299001960083049, "restore_eval_env_runners": 9.587095359347427e-06, "evaluation_iteration": 0.12248330775229418, "synch_eval_env_connectors": 0.00011872578751867378, "synch_env_connectors": 4.874544058819225e-06}, "env_runners": {"module_episode_returns_mean": {"default_policy": -1.2600000000000002}, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 7.299919947681135e-06, "remove_single_ts_time_rank_from_batch": 1.2928969381132218e-05, "normalize_and_clip_actions": 8.780985885358496e-06, "get_actions": 4.5886738665003466e-05, "tensor_to_numpy": 1.7036143836896354e-05, "listify_data_for_vector_env": 1.1555236588638067e-05}}, "connector_pipeline_timer": 0.00013261507448933141}, "episode_return_min": -11.5, "time_between_sampling": 0.032177530197546024, "agent_episode_returns_mean": {"default_agent": -1.2600000000000002}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.4710912986033542e-05, "add_states_from_episodes_to_batch": 2.9471341428076926e-06, "add_observations_from_episodes_to_batch": 3.0896181142430966e-06, "add_time_dim_to_batch_and_zero_pad": 7.690747662205431e-06, "batch_individual_items": 1.3873586150747213e-05}}, "connector_pipeline_timer": 6.667174324568817e-05}, "env_step_timer": 1.5861655036038353e-05, "episode_duration_sec_mean": 0.005929491968359798, "episode_return_mean": -1.2600000000000002, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 15.0, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "episode_return_max": 8.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "rlmodule_inference_timer": 3.5474822095664546e-05, "sample": 0.0061115053969607765, "num_episodes_lifetime": -431750.0, "num_env_steps_sampled_lifetime": -8635000.0, "env_reset_timer": 4.986338734485339e-05, "num_env_steps_sampled_lifetime_throughput": 2952.1264288899056}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.154625719899493, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00938462885700296, "add_observations_from_episodes_to_batch": 0.0008736376528488159, "add_columns_from_episodes_to_train_batch": 0.04306080502289649, "add_time_dim_to_batch_and_zero_pad": 0.08988049392829942, "add_states_from_episodes_to_batch": 0.0036467105663184405, "batch_individual_items": 0.007530211837184213, "numpy_to_tensor": 8.546346263647017e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained_lifetime": 574560, "policy_loss": -0.0004477993934415281, "diff_num_grad_updates_vs_sampler_policy": 81.0, "weights_seq_no": 96.0, "total_loss": 0.24820950627326965, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 3.9025435398798436e-05, "vf_loss_unclipped": 42.64816665649414, "num_module_steps_trained": 35910, "vf_explained_var": -0.002567887306213379, "module_train_batch_size_mean": 997.4970769774884, "vf_loss": 0.32053908705711365, "entropy": 0.6903704404830933}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 1149120, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 3456000, "num_env_steps_trained_lifetime_throughput": 52184.463957994114}, "intrinsic_reward_module": {"module_train_batch_size_mean": 997.4970769774884, "num_module_steps_trained_lifetime": 574560, "diff_num_grad_updates_vs_sampler_policy": 81.0, "weights_seq_no": 96.0, "total_loss": 0.0, "num_module_steps_trained": 35910}}}, "__all_modules__": {"num_module_steps_trained_lifetime": 191520, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 576000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4572.302121877309, "num_module_steps_trained_throughput": 21663489.460838694, "num_module_steps_trained_lifetime_throughput": 12898437.652203877}, "intrinsic_reward_module": {"module_train_batch_size_mean": 998.0669052031734, "num_trainable_parameters": 8266, "num_module_steps_trained_lifetime": 95760, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "weights_seq_no": 16.0, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 759.5412531259344}, "default_policy": {"vf_explained_var": 3.153085708618164e-05, "module_train_batch_size_mean": 998.0669052031734, "num_trainable_parameters": 16595, "vf_loss_unclipped": 42.52979278564453, "num_module_steps_trained_lifetime": 95760, "policy_loss": -0.00046168701373972, "num_module_steps_trained": 5985, "vf_loss": 0.32051098346710205, "entropy": 0.690350353717804, "curr_kl_coeff": 2.4655751076352317e-06, "total_loss": 0.24816745519638062, "diff_num_grad_updates_vs_sampler_policy": 1.0, "use_intrinsic_rewards": 0.0, "weights_seq_no": 16.0, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 4.145861021243036e-05, "num_module_steps_trained_lifetime_throughput": 759.5331735042032}, "IntrinsicAttentionMask": [[[0.15121746063232422, 0.15351217985153198, 0.15584169328212738, 0.2157767117023468, 0.16060733795166016, 0.1630445420742035], [0.15155860781669617, 0.15380899608135223, 0.1560928076505661, 0.2146272212266922, 0.16076266765594482, 0.16314971446990967], [0.1518992781639099, 0.15410515666007996, 0.15634304285049438, 0.2134821116924286, 0.1609167903661728, 0.16325360536575317], [0.15914414823055267, 0.16033674776554108, 0.16153830289840698, 0.18981513381004333, 0.16396847367286682, 0.1651972532272339], [0.15257924795150757, 0.15469540655612946, 0.15684092044830322, 0.21120508015155792, 0.16122162342071533, 0.16345764696598053], [0.15291854739189148, 0.15498954057693481, 0.15708857774734497, 0.21007318794727325, 0.1613723337650299, 0.16355781257152557]], [[0.17040787637233734, 0.15766029059886932, 0.17472608387470245, 0.15937671065330505, 0.16024191677570343, 0.1775871366262436], [0.17335985600948334, 0.15009354054927826, 0.18159006536006927, 0.1531362384557724, 0.15468062460422516, 0.18713973462581635], [0.16940967738628387, 0.16012029349803925, 0.17251263558864594, 0.1613827645778656, 0.16201773285865784, 0.1745569407939911], [0.17296263575553894, 0.15113992989063263, 0.18063592910766602, 0.1540055125951767, 0.15545859932899475, 0.18579742312431335], [0.17276231944561005, 0.15166406333446503, 0.1801586002111435, 0.15444014966487885, 0.1558472067117691, 0.18512767553329468], [0.16874966025352478, 0.161722794175148, 0.17107559740543365, 0.16268354654312134, 0.1631660759449005, 0.1726023405790329]], [[0.14927129447460175, 0.1515364795923233, 0.15383604168891907, 0.21299970149993896, 0.16492688655853271, 0.1674296259880066], [0.14964847266674042, 0.1518705040216446, 0.15412552654743195, 0.21192224323749542, 0.16499170660972595, 0.16744154691696167], [0.15002544224262238, 0.15220408141613007, 0.15441438555717468, 0.2108485996723175, 0.1650552749633789, 0.16745218634605408], [0.15811516344547272, 0.1593000739812851, 0.1604938507080078, 0.18858785927295685, 0.16612906754016876, 0.16737402975559235], [0.15176518261432648, 0.1537402868270874, 0.15574109554290771, 0.2059357613325119, 0.16533300280570984, 0.16748468577861786], [0.15214094519615173, 0.1540713608264923, 0.15602627396583557, 0.2048836499452591, 0.16538961231708527, 0.16748812794685364]], [[0.1725587099790573, 0.15776915848255157, 0.1741432249546051, 0.16113747656345367, 0.1599472165107727, 0.17444415390491486], [0.18049047887325287, 0.14582397043704987, 0.1844603717327118, 0.15334375202655792, 0.1506614238023758, 0.18521997332572937], [0.17173580825328827, 0.15901026129722595, 0.173089861869812, 0.16192275285720825, 0.16089454293251038, 0.17334683239459991], [0.17864421010017395, 0.14860254526138306, 0.1820312738418579, 0.15519511699676514, 0.1528487205505371, 0.1826782077550888], [0.1792939305305481, 0.14762461185455322, 0.1828841120004654, 0.15454620122909546, 0.15208078920841217, 0.1835702806711197], [0.17158010601997375, 0.15924511849880219, 0.17289090156555176, 0.1620708405971527, 0.1610734462738037, 0.17313961684703827]], [[0.1493397057056427, 0.15957017242908478, 0.15593202412128448, 0.21200193464756012, 0.16042950749397278, 0.16272665560245514], [0.1511819213628769, 0.16041362285614014, 0.15713801980018616, 0.20683102309703827, 0.16118617355823517, 0.1632491946220398], [0.1505410373210907, 0.16012261807918549, 0.15672019124031067, 0.20862044394016266, 0.1609254777431488, 0.16307026147842407], [0.15904472768306732, 0.1637747436761856, 0.16211259365081787, 0.18570387363433838, 0.16416426002979279, 0.16519981622695923], [0.15133114159107208, 0.1604810208082199, 0.1572350263595581, 0.20641593635082245, 0.16124647855758667, 0.16329042613506317], [0.15172599256038666, 0.16065865755081177, 0.1574912667274475, 0.2053200751543045, 0.16140535473823547, 0.16339872777462006]], [[0.17103353142738342, 0.16002751886844635, 0.17219795286655426, 0.16111700236797333, 0.16166453063488007, 0.17395947873592377], [0.17888084053993225, 0.14789944887161255, 0.18238520622253418, 0.15079686045646667, 0.15226680040359497, 0.18777088820934296], [0.17021244764328003, 0.16128119826316833, 0.17115087807178497, 0.1621703952550888, 0.1626168191432953, 0.17256823182106018], [0.17809830605983734, 0.149121955037117, 0.18135379254817963, 0.15184776484966278, 0.15322932600975037, 0.18634894490242004], [0.17770540714263916, 0.14973454177379608, 0.18083731830120087, 0.15237347781658173, 0.15371033549308777, 0.18563897907733917], [0.1689743548631668, 0.163166806101799, 0.16957828402519226, 0.16374997794628143, 0.16404233872890472, 0.17048822343349457]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0435174347122384e-05, "remove_single_ts_time_rank_from_batch": 1.190807974945824e-05, "un_batch_to_individual_items": 6.5206723060327414e-06, "normalize_and_clip_actions": 7.827760718626812e-06, "tensor_to_numpy": 1.4900552224334843e-05, "get_actions": 3.5615220417765444e-05}}, "connector_pipeline_timer": 0.00011329331332623971}, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.241707400132124e-05, "add_states_from_episodes_to_batch": 2.616664000883994e-06, "add_time_dim_to_batch_and_zero_pad": 6.885464533722886e-06, "numpy_to_tensor": 1.1805878947905936e-05, "add_observations_from_episodes_to_batch": 2.8017636497668394e-06}}, "connector_pipeline_timer": 5.859485482876999e-05}, "weights_seq_no": 16.0, "episode_len_mean": 20.0, "num_episodes": 20, "episode_return_max": 14.5, "rlmodule_inference_timer": 3.0139978210472708e-05, "num_episodes_lifetime": 320, "env_step_timer": 1.402561061089274e-05, "episode_duration_sec_mean": 0.005270298338728025, "agent_episode_returns_mean": {"default_agent": -0.4}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.000186639798830634, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "episode_len_max": 20, "episode_return_mean": -0.4, "module_episode_returns_mean": {"default_policy": -0.4}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "sample": 0.11568454530783649, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 80400, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "time_between_sampling": 9.33987119408483}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "aeabe_00000", "date": "2025-08-11_18-51-53", "timestamp": 1754931113, "time_this_iter_s": 10.387695074081421, "time_total_s": 157.2255973815918, "pid": 11811, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161dfd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 157.2255973815918, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 41.766666666666666, "ram_util_percent": 81.16}}
{"timers": {"training_iteration": 9.297957834424762, "restore_env_runners": 8.53554931495261e-06, "training_step": 9.297797671235667, "env_runner_sampling_timer": 1.6213084832870726, "learner_update_timer": 7.482388158700027, "synch_weights": 0.0009320774444135983, "restore_eval_env_runners": 9.55914459696744e-06, "evaluation_iteration": 0.12250451967375975, "synch_eval_env_connectors": 0.00011849685940861315, "synch_env_connectors": 4.868709305856441e-06}, "env_runners": {"module_episode_returns_mean": {"default_policy": -1.2600000000000002}, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 7.02952119566371e-06, "remove_single_ts_time_rank_from_batch": 1.260107831945011e-05, "normalize_and_clip_actions": 8.637725296890181e-06, "get_actions": 4.3512923897578125e-05, "tensor_to_numpy": 1.616980681413192e-05, "listify_data_for_vector_env": 1.1154009636888257e-05}}, "connector_pipeline_timer": 0.000127386555445966}, "episode_return_min": -11.5, "time_between_sampling": 0.034977301735912396, "agent_episode_returns_mean": {"default_agent": -1.2600000000000002}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3853462434368077e-05, "add_states_from_episodes_to_batch": 2.836273843941807e-06, "add_observations_from_episodes_to_batch": 2.9986542842026907e-06, "add_time_dim_to_batch_and_zero_pad": 7.491561039206571e-06, "batch_individual_items": 1.3365921772051283e-05}}, "connector_pipeline_timer": 6.391784214347046e-05}, "env_step_timer": 1.516440939178764e-05, "episode_duration_sec_mean": 0.005730259343981743, "episode_return_mean": -1.2600000000000002, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 16.0, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "episode_return_max": 8.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "rlmodule_inference_timer": 3.432719399039333e-05, "sample": 0.006114426272123392, "num_episodes_lifetime": -462625.0, "num_env_steps_sampled_lifetime": -9252500.0, "env_reset_timer": 5.189773690920455e-05, "num_env_steps_sampled_lifetime_throughput": 3049.777933395301}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15484030852976513, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009384748819439282, "add_observations_from_episodes_to_batch": 0.0008745375266448751, "add_columns_from_episodes_to_train_batch": 0.043118677391820875, "add_time_dim_to_batch_and_zero_pad": 0.090023497319936, "add_states_from_episodes_to_batch": 0.003648802210602953, "batch_individual_items": 0.007540653469490746, "numpy_to_tensor": 8.555798774033127e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained_lifetime": 610470, "policy_loss": -7.504551467718557e-05, "diff_num_grad_updates_vs_sampler_policy": 86.0, "weights_seq_no": 102.0, "total_loss": 0.24857304990291595, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 4.452529083209811e-06, "vf_loss_unclipped": 42.30099105834961, "num_module_steps_trained": 35910, "vf_explained_var": -0.002548813819885254, "module_train_batch_size_mean": 997.4956760259092, "vf_loss": 0.320533812046051, "entropy": 0.6900318264961243}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 1220940, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 3672000, "num_env_steps_trained_lifetime_throughput": 51286.45315639143}, "intrinsic_reward_module": {"module_train_batch_size_mean": 997.4956760259092, "num_module_steps_trained_lifetime": 610470, "diff_num_grad_updates_vs_sampler_policy": 86.0, "weights_seq_no": 102.0, "total_loss": 0.0, "num_module_steps_trained": 35910}}}, "__all_modules__": {"num_module_steps_trained_lifetime": 203490, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 612000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4549.215729513875, "num_module_steps_trained_throughput": 21134860.71037662, "num_module_steps_trained_lifetime_throughput": 12821408.057903295}, "intrinsic_reward_module": {"module_train_batch_size_mean": 998.0332888909784, "num_trainable_parameters": 8266, "num_module_steps_trained_lifetime": 101745, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "weights_seq_no": 17.0, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 755.7264196072038}, "default_policy": {"vf_explained_var": -0.0007292032241821289, "module_train_batch_size_mean": 998.0332888909784, "num_trainable_parameters": 16595, "vf_loss_unclipped": 42.21620178222656, "num_module_steps_trained_lifetime": 101745, "policy_loss": -7.765604823362082e-05, "num_module_steps_trained": 5985, "vf_loss": 0.3205137848854065, "entropy": 0.6900259852409363, "curr_kl_coeff": 1.2327875538176158e-06, "total_loss": 0.24855415523052216, "diff_num_grad_updates_vs_sampler_policy": 1.0, "use_intrinsic_rewards": 0.0, "weights_seq_no": 17.0, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 4.667370376409963e-06, "num_module_steps_trained_lifetime_throughput": 755.7187077690871}, "IntrinsicAttentionMask": [[[0.1466706246137619, 0.15671822428703308, 0.15896223485469818, 0.20821286737918854, 0.16354712843894958, 0.16588890552520752], [0.14875271916389465, 0.15783606469631195, 0.15985620021820068, 0.20350760221481323, 0.16397437453269958, 0.16607308387756348], [0.14920036494731903, 0.15807384252548218, 0.16004550457000732, 0.20250795781612396, 0.164062961935997, 0.1661093384027481], [0.15775568783283234, 0.16244736313819885, 0.16347208619117737, 0.18419873714447021, 0.16554096341133118, 0.16658519208431244], [0.1500966101884842, 0.15854722261428833, 0.16042152047157288, 0.20051924884319305, 0.1642369031906128, 0.16617849469184875], [0.15054522454738617, 0.15878279507160187, 0.1606082171201706, 0.19953018426895142, 0.16432227194309235, 0.16621136665344238]], [[0.17029879987239838, 0.16076388955116272, 0.17145822942256927, 0.16185839474201202, 0.16240844130516052, 0.1732121855020523], [0.17597180604934692, 0.1513965129852295, 0.17911669611930847, 0.15410220623016357, 0.15547312796115875, 0.18393972516059875], [0.1696159690618515, 0.161878764629364, 0.1705511063337326, 0.16277125477790833, 0.16321933269500732, 0.17196349799633026], [0.1753160059452057, 0.15248972177505493, 0.17821966111660004, 0.15501531958580017, 0.15629376471042633, 0.18266557157039642], [0.1749868243932724, 0.15303736925125122, 0.17777059972286224, 0.15547195076942444, 0.15670374035835266, 0.18202951550483704], [0.16858626902103424, 0.1635553389787674, 0.16918881237506866, 0.16413989663124084, 0.16443297266960144, 0.17009666562080383]], [[0.15021689236164093, 0.1546337604522705, 0.15684792399406433, 0.213247150182724, 0.16137181222438812, 0.1636824756860733], [0.15098948776721954, 0.15522140264511108, 0.15734079480171204, 0.21090754866600037, 0.16166670620441437, 0.1638740748167038], [0.15136805176734924, 0.1555085927248001, 0.15758116543293, 0.20976650714874268, 0.1618095487356186, 0.163966104388237], [0.15947186946868896, 0.1615290343761444, 0.16254796087741852, 0.18620258569717407, 0.16460514068603516, 0.16564346849918365], [0.1521243453025818, 0.1560807079076767, 0.15805916488170624, 0.20749783515930176, 0.16209162771701813, 0.164146289229393], [0.15250204503536224, 0.15636564791202545, 0.15829679369926453, 0.20637020468711853, 0.16223089396953583, 0.164234459400177]], [[0.17219655215740204, 0.15743805468082428, 0.1737777441740036, 0.1607993096113205, 0.1596115380525589, 0.17617680132389069], [0.17952829599380493, 0.14504657685756683, 0.1834770143032074, 0.15252628922462463, 0.1498582363128662, 0.18956352770328522], [0.17142823338508606, 0.15872548520565033, 0.1727798581123352, 0.16163276135921478, 0.16060639917850494, 0.17482732236385345], [0.17783427238464355, 0.14792881906032562, 0.18120597302913666, 0.15449151396751404, 0.15215572714805603, 0.18638373911380768], [0.17843134701251984, 0.14691437780857086, 0.18200424313545227, 0.15380267798900604, 0.15134911239147186, 0.18749819695949554], [0.1702692061662674, 0.1606641560792923, 0.17128072679042816, 0.1628786325454712, 0.1620979756116867, 0.17280930280685425]], [[0.14840784668922424, 0.15672902762889862, 0.15910737216472626, 0.21176762878894806, 0.1639728993177414, 0.16001519560813904], [0.14982397854328156, 0.15755802392959595, 0.1597626656293869, 0.20798704028129578, 0.16426488757133484, 0.16060349345207214], [0.15021488070487976, 0.157785102725029, 0.15994144976139069, 0.20695191621780396, 0.1643429398536682, 0.1607636958360672], [0.157630056142807, 0.16195107996463776, 0.16316471993923187, 0.18800923228263855, 0.165619358420372, 0.163625568151474], [0.1509966403245926, 0.158237025141716, 0.16029636561870575, 0.20489290356636047, 0.1644957810640335, 0.16108126938343048], [0.1503625363111496, 0.15787069499492645, 0.1600087732076645, 0.2065618634223938, 0.16437214612960815, 0.1608239710330963]], [[0.1732506901025772, 0.15840184688568115, 0.17275869846343994, 0.159856379032135, 0.16058863699436188, 0.17514368891716003], [0.18222159147262573, 0.1472225934267044, 0.18099232017993927, 0.15046074986457825, 0.15210643410682678, 0.18699641525745392], [0.1735377460718155, 0.158042773604393, 0.17302338778972626, 0.15955786406993866, 0.16032084822654724, 0.17551741003990173], [0.18131425976753235, 0.1483493596315384, 0.18016324937343597, 0.1514173001050949, 0.15297497808933258, 0.1857808530330658], [0.18085987865924835, 0.14891396462917328, 0.17974771559238434, 0.15189580619335175, 0.15340906381607056, 0.18517355620861053], [0.17215263843536377, 0.159776508808136, 0.17174549400806427, 0.16099713742733002, 0.1616109311580658, 0.17371734976768494]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1832497001786571e-05, "remove_single_ts_time_rank_from_batch": 1.296016655130459e-05, "un_batch_to_individual_items": 7.2023910515212316e-06, "normalize_and_clip_actions": 8.743393481675822e-06, "tensor_to_numpy": 1.715264523577929e-05, "get_actions": 4.440123375612882e-05}}, "connector_pipeline_timer": 0.00013086794342814413}, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.3688234004114071e-05, "add_states_from_episodes_to_batch": 2.8015233759296678e-06, "add_time_dim_to_batch_and_zero_pad": 7.65283622283166e-06, "numpy_to_tensor": 1.4050639370961615e-05, "add_observations_from_episodes_to_batch": 3.0508524675293934e-06}}, "connector_pipeline_timer": 6.529265082256514e-05}, "weights_seq_no": 17.0, "episode_len_mean": 20.0, "num_episodes": 20, "episode_return_max": 14.5, "rlmodule_inference_timer": 3.600496980946167e-05, "num_episodes_lifetime": 340, "env_step_timer": 1.6334192766211257e-05, "episode_duration_sec_mean": 0.005429141689091921, "agent_episode_returns_mean": {"default_agent": 0.0}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.00018566173123859243, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "episode_len_max": 20, "episode_return_mean": 0.0, "module_episode_returns_mean": {"default_policy": 0.0}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "sample": 0.11583490402491067, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 85400, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "time_between_sampling": 9.348754414644173}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "aeabe_00000", "date": "2025-08-11_18-52-03", "timestamp": 1754931123, "time_this_iter_s": 10.341938972473145, "time_total_s": 167.56753635406494, "pid": 11811, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161dfd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 167.56753635406494, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 41.64666666666666, "ram_util_percent": 81.46666666666667}}
{"timers": {"training_iteration": 9.301818398581103, "restore_env_runners": 8.530604212895384e-06, "training_step": 9.301656877023477, "env_runner_sampling_timer": 1.6217983905344469, "learner_update_timer": 7.485534742533539, "synch_weights": 0.0009305541705537367, "restore_eval_env_runners": 9.577303726108083e-06, "evaluation_iteration": 0.12264732781794781, "synch_eval_env_connectors": 0.00011861230118207548, "synch_env_connectors": 4.857931698197599e-06}, "env_runners": {"module_episode_returns_mean": {"default_policy": -2.6999999999999993}, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 7.174590102654775e-06, "remove_single_ts_time_rank_from_batch": 1.2624133063944425e-05, "normalize_and_clip_actions": 8.59332329430143e-06, "get_actions": 4.416810979939544e-05, "tensor_to_numpy": 1.640967395873443e-05, "listify_data_for_vector_env": 1.1278659208669876e-05}}, "connector_pipeline_timer": 0.00012881110814616758}, "episode_return_min": -11.5, "time_between_sampling": 0.035255340406638136, "agent_episode_returns_mean": {"default_agent": -2.6999999999999993}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.428285048279599e-05, "add_states_from_episodes_to_batch": 2.8670821454892767e-06, "add_observations_from_episodes_to_batch": 3.015797037520781e-06, "add_time_dim_to_batch_and_zero_pad": 7.580426286687474e-06, "batch_individual_items": 1.3537589967407412e-05}}, "connector_pipeline_timer": 6.508384522853712e-05}, "env_step_timer": 1.558770667557109e-05, "episode_duration_sec_mean": 0.005725770330056546, "episode_return_mean": -2.6999999999999993, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 17.0, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "episode_return_max": 8.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "rlmodule_inference_timer": 3.4615013152384136e-05, "sample": 0.006177247679516771, "num_episodes_lifetime": -493500.0, "num_env_steps_sampled_lifetime": -9870000.0, "env_reset_timer": 5.077288078281719e-05, "num_env_steps_sampled_lifetime_throughput": 2997.488343652607}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15493588419410217, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009379148002029318, "add_observations_from_episodes_to_batch": 0.0008753346512801531, "add_columns_from_episodes_to_train_batch": 0.04312885395768071, "add_time_dim_to_batch_and_zero_pad": 0.09009714609642097, "add_states_from_episodes_to_batch": 0.003657329608097455, "batch_individual_items": 0.007548835265103814, "numpy_to_tensor": 8.545448693067972e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained_lifetime": 646380, "policy_loss": -0.0003158814797643572, "diff_num_grad_updates_vs_sampler_policy": 91.0, "weights_seq_no": 108.0, "total_loss": 0.2483372539281845, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 4.1495452023809776e-05, "vf_loss_unclipped": 41.95733642578125, "num_module_steps_trained": 35910, "vf_explained_var": -0.0025075674057006836, "module_train_batch_size_mean": 997.4947003847115, "vf_loss": 0.3205309510231018, "entropy": 0.6892300844192505}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 1292760, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 3888000, "num_env_steps_trained_lifetime_throughput": 50433.49789707581}, "intrinsic_reward_module": {"module_train_batch_size_mean": 997.4947003847115, "num_module_steps_trained_lifetime": 646380, "diff_num_grad_updates_vs_sampler_policy": 91.0, "weights_seq_no": 108.0, "total_loss": 0.0, "num_module_steps_trained": 35910}}}, "__all_modules__": {"num_module_steps_trained_lifetime": 215460, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 648000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4529.35395371017, "num_module_steps_trained_throughput": 20653858.11273292, "num_module_steps_trained_lifetime_throughput": 12769440.029635841}, "intrinsic_reward_module": {"module_train_batch_size_mean": 998.0016398003509, "num_trainable_parameters": 8266, "num_module_steps_trained_lifetime": 107730, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "weights_seq_no": 18.0, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 752.446648425658}, "default_policy": {"vf_explained_var": 4.875659942626953e-05, "module_train_batch_size_mean": 998.0016398003509, "num_trainable_parameters": 16595, "vf_loss_unclipped": 41.853538513183594, "num_module_steps_trained_lifetime": 107730, "policy_loss": -0.00032326439395546913, "num_module_steps_trained": 5985, "vf_loss": 0.32051002979278564, "entropy": 0.6892136931419373, "curr_kl_coeff": 6.163937769088079e-07, "total_loss": 0.24830688536167145, "diff_num_grad_updates_vs_sampler_policy": 1.0, "use_intrinsic_rewards": 0.0, "weights_seq_no": 18.0, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 4.321720916777849e-05, "num_module_steps_trained_lifetime_throughput": 752.4393724528098}, "IntrinsicAttentionMask": [[[0.14756646752357483, 0.15767543017864227, 0.1599331498146057, 0.2094845324754715, 0.16454602777957916, 0.1607944220304489], [0.14956742525100708, 0.15870051085948944, 0.1607317179441452, 0.20462213456630707, 0.1648724526166916, 0.1615057736635208], [0.1499972641468048, 0.1589181274175644, 0.16090033948421478, 0.2035895138978958, 0.16493923962116241, 0.16165556013584137], [0.1581866443157196, 0.16289113461971283, 0.1639186590909958, 0.18470190465450287, 0.16599318385124207, 0.16430850327014923], [0.15085743367671967, 0.15935084223747253, 0.16123467683792114, 0.20153558254241943, 0.16506938636302948, 0.16195209324359894], [0.15015965700149536, 0.15900009870529175, 0.160963773727417, 0.20320038497447968, 0.16496415436267853, 0.16171187162399292]], [[0.1710524559020996, 0.16147536039352417, 0.1722170114517212, 0.16113485395908356, 0.16168244183063507, 0.1724378615617752], [0.17798833549022675, 0.15313145518302917, 0.18116925656795502, 0.15228985249996185, 0.1536446511745453, 0.18177641928195953], [0.17022480070590973, 0.1624598503112793, 0.17116330564022064, 0.16218219697475433, 0.1626286506652832, 0.1713411509990692], [0.17823901772499084, 0.15282662212848663, 0.18149708211421967, 0.15196776390075684, 0.15335041284561157, 0.18211913108825684], [0.17783603072166443, 0.15331657230854034, 0.1809702217578888, 0.15248548984527588, 0.15382333099842072, 0.18156839907169342], [0.17006826400756836, 0.1626458466053009, 0.1709643304347992, 0.1623801440000534, 0.16280736029148102, 0.1711341142654419]], [[0.15150316059589386, 0.15380221605300903, 0.1561361402273178, 0.20781297981739044, 0.16739284992218018, 0.1633525937795639], [0.1518322080373764, 0.1540866643190384, 0.15637458860874176, 0.20686300098896027, 0.1673993617296219, 0.16344422101974487], [0.15216101706027985, 0.15437069535255432, 0.15661244094371796, 0.20591610670089722, 0.16740483045578003, 0.16353490948677063], [0.1583634614944458, 0.1596848964691162, 0.16101734340190887, 0.1885303258895874, 0.16732218861579895, 0.16508178412914276], [0.15367832779884338, 0.15567834675312042, 0.15770438313484192, 0.2015797644853592, 0.16741721332073212, 0.16394203901290894], [0.15314629673957825, 0.1552203893661499, 0.15732255578041077, 0.20309409499168396, 0.1674152910709381, 0.1638014018535614]], [[0.17121632397174835, 0.1584082841873169, 0.17308031022548676, 0.16013284027576447, 0.1587325930595398, 0.17842964828014374], [0.17488710582256317, 0.1514158397912979, 0.1784324049949646, 0.1544853299856186, 0.15199090540409088, 0.18878838419914246], [0.17068912088871002, 0.15938667953014374, 0.17232546210289001, 0.16091465950012207, 0.15967415273189545, 0.17700991034507751], [0.1743883192539215, 0.15238577127456665, 0.1776946783065796, 0.15527495741844177, 0.15292733907699585, 0.18732890486717224], [0.17479319870471954, 0.15159893035888672, 0.17829325795173645, 0.15463455021381378, 0.15216770768165588, 0.18851231038570404], [0.16918711364269257, 0.16214203834533691, 0.1701921969652176, 0.1631052941083908, 0.16232354938983917, 0.17304976284503937]], [[0.14927127957344055, 0.1515364795923233, 0.15383601188659668, 0.21299970149993896, 0.1649269014596939, 0.16742964088916779], [0.14964845776557922, 0.1518705040216446, 0.15412551164627075, 0.21192224323749542, 0.16499172151088715, 0.16744156181812286], [0.15002542734146118, 0.15220408141613007, 0.1544143557548523, 0.2108485996723175, 0.1650552898645401, 0.16745218634605408], [0.15811516344547272, 0.1593000590801239, 0.16049383580684662, 0.18858781456947327, 0.16612905263900757, 0.16737401485443115], [0.15176516771316528, 0.1537402868270874, 0.15574108064174652, 0.2059357464313507, 0.16533301770687103, 0.16748470067977905], [0.15214094519615173, 0.1540713757276535, 0.15602627396583557, 0.2048836499452591, 0.16538962721824646, 0.16748814284801483]], [[0.17080385982990265, 0.16124068200588226, 0.17044368386268616, 0.16233843564987183, 0.1614474654197693, 0.17372587323188782], [0.17733393609523773, 0.15256842970848083, 0.17635931074619293, 0.15529505908489227, 0.15307974815368652, 0.1853635162115097], [0.1710461676120758, 0.1609213501214981, 0.1706642210483551, 0.16208182275295258, 0.16113990545272827, 0.17414656281471252], [0.17657452821731567, 0.15358440577983856, 0.1756744086742401, 0.15612812340259552, 0.1540616750717163, 0.18397684395313263], [0.17719070613384247, 0.15276020765304565, 0.17623019218444824, 0.15545247495174408, 0.153265118598938, 0.18510128557682037], [0.1688491702079773, 0.16381040215492249, 0.16866184771060944, 0.16439586877822876, 0.1639208346605301, 0.17036190629005432]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0410280925359185e-05, "remove_single_ts_time_rank_from_batch": 1.180652951715917e-05, "un_batch_to_individual_items": 6.394884340012711e-06, "normalize_and_clip_actions": 7.754594871219257e-06, "tensor_to_numpy": 1.4730458648265691e-05, "get_actions": 3.537524949139544e-05}}, "connector_pipeline_timer": 0.00011242884226362182}, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2349952168490382e-05, "add_states_from_episodes_to_batch": 2.6157372247595985e-06, "add_time_dim_to_batch_and_zero_pad": 6.947239218173483e-06, "numpy_to_tensor": 1.1697936549532444e-05, "add_observations_from_episodes_to_batch": 2.8121944465723447e-06}}, "connector_pipeline_timer": 5.8459541981580916e-05}, "weights_seq_no": 18.0, "episode_len_mean": 20.0, "num_episodes": 20, "episode_return_max": 14.5, "rlmodule_inference_timer": 2.9903833690065406e-05, "num_episodes_lifetime": 360, "env_step_timer": 1.3754589687142783e-05, "episode_duration_sec_mean": 0.005345087129389867, "agent_episode_returns_mean": {"default_agent": -0.8}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.00018460011415896265, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "episode_len_max": 20, "episode_return_mean": -0.8, "module_episode_returns_mean": {"default_policy": -0.8}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "sample": 0.11578526207526847, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 90400, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "time_between_sampling": 9.352355031747143}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "aeabe_00000", "date": "2025-08-11_18-52-13", "timestamp": 1754931133, "time_this_iter_s": 9.803138732910156, "time_total_s": 177.3706750869751, "pid": 11811, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161dfd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 177.3706750869751, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 40.56428571428571, "ram_util_percent": 81.08571428571429}}
{"timers": {"training_iteration": 9.306676944184481, "restore_env_runners": 8.50404832707961e-06, "training_step": 9.306514980333167, "env_runner_sampling_timer": 1.6212555012084489, "learner_update_timer": 7.490851665528211, "synch_weights": 0.0009302232094080789, "restore_eval_env_runners": 9.542370500186977e-06, "evaluation_iteration": 0.1225829995401851, "synch_eval_env_connectors": 0.00011832034795906235, "synch_env_connectors": 4.84768329008036e-06}, "env_runners": {"module_episode_returns_mean": {"default_policy": -0.7000000000000002}, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.7476236522057835e-06, "remove_single_ts_time_rank_from_batch": 1.2026760717563396e-05, "normalize_and_clip_actions": 8.184397824452017e-06, "get_actions": 4.0449375642831326e-05, "tensor_to_numpy": 1.5592782361229257e-05, "listify_data_for_vector_env": 1.0650539811207291e-05}}, "connector_pipeline_timer": 0.00012090619511889332}, "episode_return_min": -11.5, "time_between_sampling": 0.03327496115482576, "agent_episode_returns_mean": {"default_agent": -0.7000000000000002}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.306913357099057e-05, "add_states_from_episodes_to_batch": 2.721455722477819e-06, "add_observations_from_episodes_to_batch": 2.842963606802437e-06, "add_time_dim_to_batch_and_zero_pad": 7.003485252299196e-06, "batch_individual_items": 1.280473627726023e-05}}, "connector_pipeline_timer": 6.091242606548206e-05}, "env_step_timer": 1.4297143123988806e-05, "episode_duration_sec_mean": 0.005378334509674462, "episode_return_mean": -0.7000000000000002, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 18.0, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "episode_return_max": 8.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "rlmodule_inference_timer": 3.203509210448642e-05, "sample": 0.005864685291606457, "num_episodes_lifetime": -524375.0, "num_env_steps_sampled_lifetime": -10487500.0, "env_reset_timer": 4.4163591875834474e-05, "num_env_steps_sampled_lifetime_throughput": 3178.9682838472268}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15491991118169554, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009376524862304577, "add_observations_from_episodes_to_batch": 0.0008748875542778484, "add_columns_from_episodes_to_train_batch": 0.043116591668123566, "add_time_dim_to_batch_and_zero_pad": 0.09009119754484657, "add_states_from_episodes_to_batch": 0.0036592129820250804, "batch_individual_items": 0.007552778162212868, "numpy_to_tensor": 8.53657721069389e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained_lifetime": 682290, "policy_loss": -5.34419777977746e-05, "diff_num_grad_updates_vs_sampler_policy": 96.0, "weights_seq_no": 114.0, "total_loss": 0.2485952526330948, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 1.3916900570620783e-05, "vf_loss_unclipped": 41.95462417602539, "num_module_steps_trained": 35910, "vf_explained_var": -0.0024874210357666016, "module_train_batch_size_mean": 997.4940209352853, "vf_loss": 0.3205300569534302, "entropy": 0.6887362599372864}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 1364580, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 4104000, "num_env_steps_trained_lifetime_throughput": 49630.61262226648}, "intrinsic_reward_module": {"module_train_batch_size_mean": 997.4940209352853, "num_module_steps_trained_lifetime": 682290, "diff_num_grad_updates_vs_sampler_policy": 96.0, "weights_seq_no": 114.0, "total_loss": 0.0, "num_module_steps_trained": 35910}}}, "__all_modules__": {"num_module_steps_trained_lifetime": 227430, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 684000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4509.699075667868, "num_module_steps_trained_throughput": 20189743.617490362, "num_module_steps_trained_lifetime_throughput": 12719478.49225887}, "intrinsic_reward_module": {"module_train_batch_size_mean": 997.9718428097785, "num_trainable_parameters": 8266, "num_module_steps_trained_lifetime": 113715, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "weights_seq_no": 19.0, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 749.1998117793137}, "default_policy": {"vf_explained_var": 0.0010105371475219727, "module_train_batch_size_mean": 997.9718428097785, "num_trainable_parameters": 16595, "vf_loss_unclipped": 41.82076644897461, "num_module_steps_trained_lifetime": 113715, "policy_loss": -5.50213735550642e-05, "num_module_steps_trained": 5985, "vf_loss": 0.3205125331878662, "entropy": 0.6887317895889282, "curr_kl_coeff": 3.0819688845440396e-07, "total_loss": 0.2485777735710144, "diff_num_grad_updates_vs_sampler_policy": 1.0, "use_intrinsic_rewards": 0.0, "weights_seq_no": 19.0, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 1.4173489944369067e-05, "num_module_steps_trained_lifetime_throughput": 749.1930727432585}, "IntrinsicAttentionMask": [[[0.1502169370651245, 0.1546337604522705, 0.15684792399406433, 0.213247150182724, 0.16137181222438812, 0.16368244588375092], [0.15098948776721954, 0.15522140264511108, 0.15734076499938965, 0.21090754866600037, 0.16166669130325317, 0.1638740450143814], [0.15136809647083282, 0.1555086076259613, 0.1575811803340912, 0.20976653695106506, 0.16180956363677979, 0.163966104388237], [0.15947185456752777, 0.16152900457382202, 0.16254794597625732, 0.1862025409936905, 0.16460511088371277, 0.16564343869686127], [0.15212436020374298, 0.1560807079076767, 0.15805916488170624, 0.20749783515930176, 0.16209162771701813, 0.1641462743282318], [0.15250205993652344, 0.15636563301086426, 0.15829677879810333, 0.20637020468711853, 0.16223086416721344, 0.16423442959785461]], [[0.17255717515945435, 0.15776778757572174, 0.17414169013500214, 0.1592164784669876, 0.1618742048740387, 0.1744425892829895], [0.18048198521137238, 0.1458171010017395, 0.18445166945457458, 0.14902432262897491, 0.15501366555690765, 0.1852112114429474], [0.17173466086387634, 0.15900921821594238, 0.1730886995792389, 0.16026292741298676, 0.16255877912044525, 0.1733456552028656], [0.17968599498271942, 0.14701709151268005, 0.18340198695659637, 0.15005749464035034, 0.15572495758533478, 0.18411244451999664], [0.17823678255081177, 0.14920185506343842, 0.18149928748607635, 0.15193288028240204, 0.15700697898864746, 0.18212217092514038], [0.171579048037529, 0.15924414992332458, 0.172889843583107, 0.1604607105255127, 0.162687748670578, 0.1731385439634323]], [[0.14866824448108673, 0.158852681517601, 0.15523084998130798, 0.20332537591457367, 0.16577458381652832, 0.16814826428890228], [0.15054692327976227, 0.15973983705043793, 0.15647795796394348, 0.19920684397220612, 0.1659521907567978, 0.16807618737220764], [0.1498924195766449, 0.15943270921707153, 0.15604493021965027, 0.2006336748600006, 0.16589267551898956, 0.16810362040996552], [0.15758869051933289, 0.1629147082567215, 0.16104070842266083, 0.18438872694969177, 0.16643793880939484, 0.1676291972398758], [0.15175896883010864, 0.16030313074588776, 0.15727584064006805, 0.1965872347354889, 0.1660558432340622, 0.16801893711090088], [0.15216343104839325, 0.1604895442724228, 0.1575409322977066, 0.19571952521800995, 0.16608856618404388, 0.16799795627593994]], [[0.1707867980003357, 0.15979667007923126, 0.17194953560829163, 0.16088458895683289, 0.16287384927272797, 0.17370851337909698], [0.17818185687065125, 0.14732150733470917, 0.18167252838611603, 0.15020762383937836, 0.15557938814163208, 0.1870371699333191], [0.170012429356575, 0.16109171509742737, 0.1709497570991516, 0.16197985410690308, 0.1636008620262146, 0.1723654419183731], [0.17744481563568115, 0.14857476949691772, 0.18068836629390717, 0.15129061043262482, 0.15633629262447357, 0.18566519021987915], [0.1760995090007782, 0.15085619688034058, 0.17890100181102753, 0.15325608849525452, 0.15770019590854645, 0.18318699300289154], [0.16884447634220123, 0.16304141283035278, 0.16944792866706848, 0.1636241376399994, 0.16468481719493866, 0.17035716772079468]], [[0.15055620670318604, 0.15284086763858795, 0.1614106446504593, 0.20651410520076752, 0.16634659469127655, 0.16233158111572266], [0.15090231597423553, 0.15314295887947083, 0.16154128313064575, 0.20559611916542053, 0.16637413203716278, 0.16244320571422577], [0.15215544402599335, 0.1542348563671112, 0.16200770437717438, 0.20229536294937134, 0.16646604239940643, 0.16284051537513733], [0.1578037291765213, 0.15912048518657684, 0.16398274898529053, 0.18786397576332092, 0.16673079133033752, 0.16449829936027527], [0.15284700691699982, 0.15483619272708893, 0.16226071119308472, 0.200489342212677, 0.16651158034801483, 0.1630551964044571], [0.152286097407341, 0.15434852242469788, 0.16205574572086334, 0.20195336639881134, 0.16647493839263916, 0.16288134455680847]], [[0.1707867980003357, 0.15979668498039246, 0.17194953560829163, 0.16088460385799408, 0.16287386417388916, 0.17370851337909698], [0.17818184196949005, 0.14732150733470917, 0.18167251348495483, 0.15020759403705597, 0.1555793732404709, 0.1870371550321579], [0.170012429356575, 0.16109171509742737, 0.17094974219799042, 0.16197985410690308, 0.1636008620262146, 0.17236542701721191], [0.17744481563568115, 0.14857476949691772, 0.18068836629390717, 0.15129061043262482, 0.15633629262447357, 0.18566519021987915], [0.1760995090007782, 0.15085619688034058, 0.17890100181102753, 0.15325608849525452, 0.15770019590854645, 0.18318699300289154], [0.16884447634220123, 0.16304142773151398, 0.16944792866706848, 0.1636241376399994, 0.16468483209609985, 0.17035716772079468]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0702484685441196e-05, "remove_single_ts_time_rank_from_batch": 1.2257149039669105e-05, "un_batch_to_individual_items": 6.673591366723873e-06, "normalize_and_clip_actions": 8.082265769476208e-06, "tensor_to_numpy": 1.578589704479034e-05, "get_actions": 3.8276592434853905e-05}}, "connector_pipeline_timer": 0.00011854575687960762}, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2953416530783023e-05, "add_states_from_episodes_to_batch": 2.7086035678056432e-06, "add_time_dim_to_batch_and_zero_pad": 7.121151140264401e-06, "numpy_to_tensor": 1.3027122942268663e-05, "add_observations_from_episodes_to_batch": 2.8890588233629687e-06}}, "connector_pipeline_timer": 6.145889274033449e-05}, "weights_seq_no": 19.0, "episode_len_mean": 20.0, "num_episodes": 20, "episode_return_max": 14.5, "rlmodule_inference_timer": 3.199783046514143e-05, "num_episodes_lifetime": 380, "env_step_timer": 1.4779990979879316e-05, "episode_duration_sec_mean": 0.005447017519036308, "agent_episode_returns_mean": {"default_agent": 0.0}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.00018616077225168818, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "episode_len_max": 20, "episode_return_mean": 0.0, "module_episode_returns_mean": {"default_policy": 0.0}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "sample": 0.11587453820448054, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 95400, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "time_between_sampling": 9.35695531101913}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "aeabe_00000", "date": "2025-08-11_18-52-23", "timestamp": 1754931143, "time_this_iter_s": 9.923877000808716, "time_total_s": 187.2945520877838, "pid": 11811, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161dfd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 187.2945520877838, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 39.421428571428564, "ram_util_percent": 81.14285714285714}}
{"timers": {"training_iteration": 9.31377043765212, "restore_env_runners": 8.478177095280571e-06, "training_step": 9.31360792594901, "env_runner_sampling_timer": 1.6210563120266592, "learner_update_timer": 7.498091959702896, "synch_weights": 0.0009320355567065951, "restore_eval_env_runners": 9.519867024471063e-06, "evaluation_iteration": 0.12268929162411281, "synch_eval_env_connectors": 0.0001181792339044991, "synch_env_connectors": 4.8475362780360085e-06}, "env_runners": {"module_episode_returns_mean": {"default_policy": -0.7000000000000002}, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.860954887366698e-06, "remove_single_ts_time_rank_from_batch": 1.2269910065762933e-05, "normalize_and_clip_actions": 8.338348218229654e-06, "get_actions": 4.151233819941369e-05, "tensor_to_numpy": 1.5704999233109803e-05, "listify_data_for_vector_env": 1.0930824851719551e-05}}, "connector_pipeline_timer": 0.00012304886110599102}, "episode_return_min": -11.5, "time_between_sampling": 0.03395742217549882, "agent_episode_returns_mean": {"default_agent": -0.7000000000000002}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3361485301478084e-05, "add_states_from_episodes_to_batch": 2.795687469443604e-06, "add_observations_from_episodes_to_batch": 2.9204968878241674e-06, "add_time_dim_to_batch_and_zero_pad": 7.172114893996181e-06, "batch_individual_items": 1.3073913258744261e-05}}, "connector_pipeline_timer": 6.217443743145326e-05}, "env_step_timer": 1.4630815571478527e-05, "episode_duration_sec_mean": 0.005500929673667997, "episode_return_mean": -0.7000000000000002, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "weights_seq_no": 19.0, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "episode_return_max": 8.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "rlmodule_inference_timer": 3.29978770543997e-05, "sample": 0.005892822054335594, "num_episodes_lifetime": -555250.0, "num_env_steps_sampled_lifetime": -11105000.0, "env_reset_timer": 4.444194927408984e-05, "num_env_steps_sampled_lifetime_throughput": 3129.0163926831688}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1548802279097403, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009369492533707937, "add_observations_from_episodes_to_batch": 0.0008756065994891748, "add_columns_from_episodes_to_train_batch": 0.04309499742190378, "add_time_dim_to_batch_and_zero_pad": 0.09007907681899742, "add_states_from_episodes_to_batch": 0.003659787521703959, "batch_individual_items": 0.007553299960829499, "numpy_to_tensor": 8.51521146025324e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained_lifetime": 718200, "policy_loss": -0.0003861103323288262, "diff_num_grad_updates_vs_sampler_policy": 101.0, "weights_seq_no": 120.0, "total_loss": 0.248266339302063, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 3.1657691579312086e-05, "vf_loss_unclipped": 42.1568717956543, "num_module_steps_trained": 35910, "vf_explained_var": -0.002471327781677246, "module_train_batch_size_mean": 997.4935477577241, "vf_loss": 0.32052963972091675, "entropy": 0.6879724860191345}, "__all_modules__": {"num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 1436400, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime": 4320000, "num_env_steps_trained_lifetime_throughput": 48863.40041273369}, "intrinsic_reward_module": {"module_train_batch_size_mean": 997.4935477577241, "num_module_steps_trained_lifetime": 718200, "diff_num_grad_updates_vs_sampler_policy": 101.0, "weights_seq_no": 120.0, "total_loss": 0.0, "num_module_steps_trained": 35910}}}, "__all_modules__": {"num_module_steps_trained_lifetime": 239400, "num_env_steps_trained": 36000, "num_env_steps_trained_lifetime": 720000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 4489.403420076682, "num_module_steps_trained_throughput": 19736338.646751013, "num_module_steps_trained_lifetime_throughput": 12662830.878929347}, "intrinsic_reward_module": {"module_train_batch_size_mean": 997.9437895346426, "num_trainable_parameters": 8266, "num_module_steps_trained_lifetime": 119700, "num_module_steps_trained": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 0.0, "weights_seq_no": 20.0, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime_throughput": 745.8462054945836}, "default_policy": {"vf_explained_var": 0.0013769268989562988, "module_train_batch_size_mean": 997.9437895346426, "num_trainable_parameters": 16595, "vf_loss_unclipped": 42.00725555419922, "num_module_steps_trained_lifetime": 119700, "policy_loss": -0.0004005401860922575, "num_module_steps_trained": 5985, "vf_loss": 0.3205164670944214, "entropy": 0.687944233417511, "curr_kl_coeff": 1.5409844422720198e-07, "total_loss": 0.24823658168315887, "diff_num_grad_updates_vs_sampler_policy": 1.0, "use_intrinsic_rewards": 0.0, "weights_seq_no": 20.0, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 3.392853614059277e-05, "num_module_steps_trained_lifetime_throughput": 745.8399410638208}, "IntrinsicAttentionMask": [[[0.14841000735759735, 0.1527736783027649, 0.16084738075733185, 0.21068206429481506, 0.15943069756031036, 0.16785620152950287], [0.1492539346218109, 0.15343719720840454, 0.16116264462471008, 0.2084832787513733, 0.15980839729309082, 0.16785463690757751], [0.15075357258319855, 0.15461115539073944, 0.16171161830425262, 0.20461606979370117, 0.16046907007694244, 0.16783855855464935], [0.15860643982887268, 0.16065242886543274, 0.1643536537885666, 0.1851920485496521, 0.16371183097362518, 0.16748355329036713], [0.1504959613084793, 0.15440994501113892, 0.16161833703517914, 0.2052767127752304, 0.1603565216064453, 0.16784250736236572], [0.151995450258255, 0.1555784046649933, 0.1621553599834442, 0.20145224034786224, 0.16100609302520752, 0.1678124964237213]], [[0.17129743099212646, 0.1602744609117508, 0.17246364057064056, 0.16136562824249268, 0.16191400587558746, 0.17268480360507965], [0.1797284483909607, 0.1486002504825592, 0.18324942886829376, 0.15151140093803406, 0.15298829972743988, 0.1839221566915512], [0.170423686504364, 0.16148139536380768, 0.17136326432228088, 0.1623716801404953, 0.16281865537166595, 0.17154131829738617], [0.17888066172599792, 0.14977701008319855, 0.1821504533290863, 0.15251480042934418, 0.15390241146087646, 0.18277470767498016], [0.1784556359052658, 0.1503666639328003, 0.18160076439380646, 0.15301674604415894, 0.15435925126075745, 0.18220099806785583], [0.17025838792324066, 0.16170965135097504, 0.17115545272827148, 0.16256166994571686, 0.16298936307430267, 0.1713254153728485]], [[0.14842234551906586, 0.1585899442434311, 0.154974102973938, 0.21069957315921783, 0.1594439446926117, 0.1678701490163803], [0.15034963190555573, 0.15953049063682556, 0.15627288818359375, 0.20569230616092682, 0.16029874980449677, 0.16785593330860138], [0.1496787816286087, 0.15920548141002655, 0.1558225005865097, 0.20742549002170563, 0.16000370681285858, 0.16786405444145203], [0.15860912203788757, 0.1633261740207672, 0.1616685539484024, 0.1851951777935028, 0.16371460258960724, 0.16748639941215515], [0.15050585567951202, 0.15960581600666046, 0.15637750923633575, 0.20529021322727203, 0.16036707162857056, 0.16785356402397156], [0.1520037055015564, 0.16032108664512634, 0.15737555921077728, 0.20146319270133972, 0.1610148400068283, 0.16782163083553314]], [[0.17085584998130798, 0.15899518132209778, 0.17230957746505737, 0.16034798324108124, 0.1610286980867386, 0.17646273970603943], [0.17598482966423035, 0.1492537260055542, 0.1794324517250061, 0.15217767655849457, 0.1536610722541809, 0.18949025869369507], [0.170230895280838, 0.1601543426513672, 0.17145848274230957, 0.16130927205085754, 0.16188986599445343, 0.1749570369720459], [0.17539803683757782, 0.15039068460464478, 0.1786041557788849, 0.15313969552516937, 0.1545329988002777, 0.18793439865112305], [0.17510287463665009, 0.15096023678779602, 0.17818890511989594, 0.15362077951431274, 0.15496858954429626, 0.18715858459472656], [0.1684519201517105, 0.1634250432252884, 0.16905397176742554, 0.16400912404060364, 0.16430194675922394, 0.1707579791545868]], [[0.15023073554039001, 0.15251047909259796, 0.15482480823993683, 0.2143687605857849, 0.15955933928489685, 0.16850581765174866], [0.1505904346704483, 0.1528264582157135, 0.1550956666469574, 0.21325619518756866, 0.15973569452762604, 0.1684955656528473], [0.15094979107379913, 0.15314187109470367, 0.15536577999591827, 0.21214771270751953, 0.15991093218326569, 0.1684839427471161], [0.15862607955932617, 0.15981480479240417, 0.1610124409198761, 0.18919718265533447, 0.163434699177742, 0.16791485249996185], [0.15166747570037842, 0.15377098321914673, 0.1559036672115326, 0.20994296669960022, 0.16025817394256592, 0.16845670342445374], [0.15296371281147003, 0.1549045741558075, 0.1568700522184372, 0.20599161088466644, 0.16087613999843597, 0.16839390993118286]], [[0.1718658059835434, 0.15713568031787872, 0.1734439581632614, 0.160490483045578, 0.16122564673423767, 0.1758383959531784], [0.17875315248966217, 0.1444203406572342, 0.18268480896949768, 0.15186776220798492, 0.1535288244485855, 0.18874505162239075], [0.17114372551441193, 0.15846209228038788, 0.172493115067482, 0.16136454045772552, 0.1619994342327118, 0.17453716695308685], [0.17716220021247864, 0.14736980199813843, 0.1805211454629898, 0.15390770137310028, 0.1553598791360855, 0.1856793463230133], [0.1768152266740799, 0.14801190793514252, 0.18005171418190002, 0.15434858202934265, 0.15575478971004486, 0.18501782417297363], [0.17005427181720734, 0.16046136617660522, 0.17106451094150543, 0.16267305612564087, 0.16315554082393646, 0.17259114980697632]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0376155892730255e-05, "remove_single_ts_time_rank_from_batch": 1.1913216603568362e-05, "un_batch_to_individual_items": 6.502713852733792e-06, "normalize_and_clip_actions": 7.778696169810883e-06, "tensor_to_numpy": 1.481072247862406e-05, "get_actions": 3.6070342840792355e-05}}, "connector_pipeline_timer": 0.0001133644559589491}, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2711138746525068e-05, "add_states_from_episodes_to_batch": 2.59828901550539e-06, "add_time_dim_to_batch_and_zero_pad": 6.91810334933498e-06, "numpy_to_tensor": 1.2066678186281877e-05, "add_observations_from_episodes_to_batch": 2.7947351403650328e-06}}, "connector_pipeline_timer": 5.914997786395425e-05}, "weights_seq_no": 20.0, "episode_len_mean": 20.0, "num_episodes": 20, "episode_return_max": 14.5, "rlmodule_inference_timer": 3.0172692432763967e-05, "num_episodes_lifetime": 400, "env_step_timer": 1.4075976153072696e-05, "episode_duration_sec_mean": 0.005447165878722444, "agent_episode_returns_mean": {"default_agent": 0.2}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.00018516916533301443, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "episode_len_max": 20, "episode_return_mean": 0.2, "module_episode_returns_mean": {"default_policy": 0.2}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "sample": 0.11584191907245504, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 100400, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "time_between_sampling": 9.363820790408893}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "aeabe_00000", "date": "2025-08-11_18-52-33", "timestamp": 1754931153, "time_this_iter_s": 10.137613773345947, "time_total_s": 197.43216586112976, "pid": 11811, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161dfd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 197.43216586112976, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 39.42142857142857, "ram_util_percent": 81.12857142857142}}
