{"timers": {"training_iteration": 9.392290042014793, "restore_env_runners": 1.1165975593030453e-05, "training_step": 9.392143583041616, "env_runner_sampling_timer": 1.612919959006831, "learner_update_timer": 7.589661042089574, "synch_weights": 0.0011077499948441982}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.0001252427041679535, "timers": {"connectors": {"get_actions": 4.323075547677806e-05, "un_batch_to_individual_items": 6.701288722574047e-06, "remove_single_ts_time_rank_from_batch": 1.2011504738144778e-05, "tensor_to_numpy": 1.539761334288792e-05, "normalize_and_clip_actions": 1.0364228794485098e-05, "listify_data_for_vector_env": 1.0491034341945505e-05}}}, "time_between_sampling": 0.0006463425367779707, "num_env_steps_sampled_lifetime": 627500.0, "module_episode_returns_mean": {"default_policy": -0.7000000000000002}, "num_episodes": 250.0, "env_reset_timer": 7.849788216498003e-05, "env_to_module_sum_episodes_length_out": 10.191744832559449, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9195985562989025e-06, "numpy_to_tensor": 1.2960505115433675e-05, "batch_individual_items": 1.2690454409677574e-05, "add_states_from_episodes_to_batch": 2.7629293921001334e-06, "add_time_dim_to_batch_and_zero_pad": 7.2310730267289585e-06}}, "connector_pipeline_timer": 6.230044380440582e-05}, "episode_return_max": 10.5, "env_step_timer": 1.4553436043221203e-05, "rlmodule_inference_timer": 3.491115369830919e-05, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.191744832559449, "episode_return_min": -9.5, "agent_episode_returns_mean": {"default_agent": -0.7000000000000002}, "episode_return_mean": -0.7000000000000002, "episode_duration_sec_mean": 0.005247956514824185, "weights_seq_no": 0.0, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "num_episodes_lifetime": 31375.0, "sample": 0.006264409579165311, "num_env_steps_sampled_lifetime_throughput": 3096.3891924695754}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000, "learner_connector": {"connector_pipeline_timer": 0.15240529202856123, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008956791018135846, "add_observations_from_episodes_to_batch": 0.0009083750192075968, "add_columns_from_episodes_to_train_batch": 0.04154316696804017, "add_time_dim_to_batch_and_zero_pad": 0.08964820799883455, "add_states_from_episodes_to_batch": 0.003634750028140843, "batch_individual_items": 0.007501333020627499, "numpy_to_tensor": 5.879101809114218e-05}}}, "learner_connector_sum_episodes_length_out": 5250}, "learners": {"intrinsic_reward_module": {"total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 5985, "weights_seq_no": 1.0, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained": 5985, "module_train_batch_size_mean": 998.9117791197002, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 792.9960399048666}, "default_policy": {"num_module_steps_trained_lifetime": 5985, "mean_kl_loss": 2.1837899112142622e-05, "vf_loss": 0.3206541836261749, "weights_seq_no": 1.0, "policy_loss": -0.0003823137376457453, "module_train_batch_size_mean": 998.9117791197002, "use_intrinsic_rewards": 0.0, "entropy": 0.6883262991905212, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5985, "vf_explained_var": -0.0003720521926879883, "vf_loss_unclipped": 41.405216217041016, "total_loss": 0.24836501479148865, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.08079196512699127, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 792.9827651440593}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "policy_loss": -0.00036551780067384243, "use_intrinsic_rewards": 1.0, "entropy": 0.6882981061935425, "module_train_batch_size_mean": 998.5423314844973, "total_loss": 0.2487017661333084, "diff_num_grad_updates_vs_sampler_policy": 6.0, "vf_explained_var": -0.0022798776626586914, "num_module_steps_trained_lifetime": 35910, "mean_kl_loss": 1.9989036445622332e-05, "vf_loss_unclipped": 41.521297454833984, "vf_loss": 0.3210652470588684, "weights_seq_no": 6.0}, "__all_modules__": {"num_module_steps_trained_lifetime": 71820, "num_env_steps_trained_lifetime": 216000, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 63103.42707204123}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 6.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 35910, "weights_seq_no": 6.0, "module_train_batch_size_mean": 998.5423314844973, "num_module_steps_trained": 35910}}}, "IntrinsicAttentionMask": [[[0.16947059333324432, 0.16435003280639648, 0.17256899178028107, 0.16367508471012115, 0.17186030745506287, 0.15807496011257172], [0.16735897958278656, 0.16611486673355103, 0.16809801757335663, 0.16594870388507843, 0.16792987287044525, 0.16454960405826569], [0.1706865131855011, 0.16327506303787231, 0.17522019147872925, 0.1623057723045349, 0.17417998611927032, 0.1543325036764145], [0.16707080602645874, 0.16634610295295715, 0.16750024259090424, 0.1662491261959076, 0.16740259528160095, 0.16543106734752655], [0.17041239142417908, 0.16352130472660065, 0.17461733520030975, 0.1626184582710266, 0.1736532300710678, 0.1551772505044937], [0.16458760201931, 0.16824866831302643, 0.16246318817138672, 0.16874587535858154, 0.1629433035850525, 0.1730114221572876]], [[0.17493322491645813, 0.16699832677841187, 0.16217052936553955, 0.15481454133987427, 0.17728234827518463, 0.16380110383033752], [0.17132484912872314, 0.16689680516719818, 0.1641577184200287, 0.15991492569446564, 0.17261888086795807, 0.1650867611169815], [0.1690482199192047, 0.16679835319519043, 0.16539201140403748, 0.1631908118724823, 0.16970033943653107, 0.1658702939748764], [0.16545327007770538, 0.16658824682235718, 0.16730950772762299, 0.16845721006393433, 0.16512855887413025, 0.1670631766319275], [0.17597109079360962, 0.16701515018939972, 0.1615920066833496, 0.15336789190769196, 0.17863237857818604, 0.1634214222431183], [0.1698242723941803, 0.16683490574359894, 0.16497299075126648, 0.16206903755664825, 0.17069314420223236, 0.16560563445091248]], [[0.16803276538848877, 0.17145730555057526, 0.1626206934452057, 0.17075318098068237, 0.17040221393108368, 0.15673381090164185], [0.16865217685699463, 0.1738259196281433, 0.16058242321014404, 0.17275790870189667, 0.17222636938095093, 0.1519552618265152], [0.16694220900535583, 0.1675916463136673, 0.16589371860027313, 0.16745898127555847, 0.16739268600940704, 0.16472074389457703], [0.16852907836437225, 0.17334367334842682, 0.1609993427991867, 0.17235060036182404, 0.17185620963573456, 0.15292106568813324], [0.16846689581871033, 0.17310237884521484, 0.16120758652687073, 0.17214663326740265, 0.17167074978351593, 0.15340566635131836], [0.1655867099761963, 0.16320842504501343, 0.16951993107795715, 0.1636907309293747, 0.1639324128627777, 0.17406168580055237]], [[0.16702383756637573, 0.16789734363555908, 0.1653600037097931, 0.16777156293392181, 0.16523611545562744, 0.16671118140220642], [0.1683533936738968, 0.1726931631565094, 0.1603272557258606, 0.17206281423568726, 0.15974202752113342, 0.16682133078575134], [0.16422560811042786, 0.1587960422039032, 0.1751721352338791, 0.15956497192382812, 0.17602036893367767, 0.16622087359428406], [0.1681678742170334, 0.17200206220149994, 0.16104671359062195, 0.171445831656456, 0.16052591800689697, 0.16681160032749176], [0.1640033721923828, 0.1581207811832428, 0.1759139746427536, 0.15895283222198486, 0.1768396496772766, 0.1661694049835205], [0.16652454435825348, 0.16618317365646362, 0.16718170046806335, 0.166232168674469, 0.1672309935092926, 0.16664732992649078]], [[0.16694916784763336, 0.16703660786151886, 0.16712407767772675, 0.1672116070985794, 0.16514809429645538, 0.16653041541576385], [0.16700522601604462, 0.1671101450920105, 0.16721510887145996, 0.1673201620578766, 0.1648465245962143, 0.16650289297103882], [0.16706115007400513, 0.1671835482120514, 0.167306050658226, 0.1674286425113678, 0.16454537212848663, 0.16647525131702423], [0.16711698472499847, 0.1672569066286087, 0.1673969328403473, 0.16753707826137543, 0.1642446368932724, 0.1664474904537201], [0.16576512157917023, 0.16549350321292877, 0.16522234678268433, 0.1649516373872757, 0.171493262052536, 0.16707412898540497], [0.16667893528938293, 0.16668272018432617, 0.1666865050792694, 0.16669027507305145, 0.16660068929195404, 0.1666608303785324]], [[0.16490507125854492, 0.16625241935253143, 0.16825920343399048, 0.16343024373054504, 0.16851302981376648, 0.16864007711410522], [0.16226159036159515, 0.16559088230133057, 0.1706250160932541, 0.15866363048553467, 0.17126818001270294, 0.1715906709432602], [0.15835025906562805, 0.16452613472938538, 0.17407472431659698, 0.15180078148841858, 0.1753128468990326, 0.17593520879745483], [0.16781184077262878, 0.166924387216568, 0.16562436521053314, 0.16879712045192719, 0.16546176373958588, 0.16538050770759583], [0.15785807371139526, 0.16438502073287964, 0.17450469732284546, 0.15095265209674835, 0.1758192926645279, 0.17648030817508698], [0.1576119214296341, 0.16431383788585663, 0.17471937835216522, 0.15052977204322815, 0.1760723739862442, 0.17675279080867767]]], "__all_modules__": {"num_env_steps_trained": 36000, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 11970, "num_env_steps_trained_lifetime": 36000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 4775.826622494133, "num_module_steps_trained_throughput": 31449948.981039833, "num_module_steps_trained_lifetime_throughput": 13449088.974822238}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.6356935629237502e-05, "normalize_and_clip_actions": 8.890998154060812e-06, "remove_single_ts_time_rank_from_batch": 1.268695299869059e-05, "listify_data_for_vector_env": 1.0576728548571439e-05, "get_actions": 4.1556987492290893e-05, "un_batch_to_individual_items": 6.742678845443659e-06}}, "connector_pipeline_timer": 0.00012333698856800885}, "episode_duration_sec_mean": 0.005265216651605442, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.2293035770682907e-06, "numpy_to_tensor": 1.2565573074316743e-05, "add_time_dim_to_batch_and_zero_pad": 7.61311614057212e-06, "batch_individual_items": 1.260925439047642e-05, "add_states_from_episodes_to_batch": 2.766243354320106e-06}}, "connector_pipeline_timer": 6.250945717766131e-05}, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "num_episodes_lifetime": 20, "num_env_steps_sampled_lifetime": 5400, "env_to_module_sum_episodes_length_out": 10.216013141322508, "module_episode_returns_mean": {"default_policy": 0.05}, "episode_return_max": 12.5, "env_step_timer": 1.4947384958865953e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "rlmodule_inference_timer": 3.430757774385643e-05, "env_to_module_sum_episodes_length_in": 10.216013141322508, "episode_return_mean": 0.05, "env_reset_timer": 0.00032933405600488186, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_min": -12.5, "agent_episode_returns_mean": {"default_agent": 0.05}, "weights_seq_no": 1.0, "sample": 0.11492687510326505, "episode_len_max": 20, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "b483a_00000", "date": "2025-08-11_18-53-01", "timestamp": 1754931181, "time_this_iter_s": 9.516984701156616, "time_total_s": 9.516984701156616, "pid": 11892, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fcf98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9.516984701156616, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 36.792857142857144, "ram_util_percent": 79.07857142857142}}
{"timers": {"training_iteration": 9.391715087014017, "restore_env_runners": 1.111723599024117e-05, "training_step": 9.391568160961613, "env_runner_sampling_timer": 1.6136428706662265, "learner_update_timer": 7.588289300828473, "synch_weights": 0.0011061016644816845, "restore_eval_env_runners": 1.0416028089821339e-05, "evaluation_iteration": 0.12261025002226233, "synch_eval_env_connectors": 0.00015004095621407032, "synch_env_connectors": 4.415982402861118e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00012303040749888475, "timers": {"connectors": {"get_actions": 4.172996221250438e-05, "un_batch_to_individual_items": 6.849919498855263e-06, "remove_single_ts_time_rank_from_batch": 1.2183524418168116e-05, "tensor_to_numpy": 1.5993991256973877e-05, "normalize_and_clip_actions": 8.278730517423968e-06, "listify_data_for_vector_env": 1.0625128407214331e-05}}}, "time_between_sampling": 0.029839017446165662, "num_env_steps_sampled_lifetime": 10000.0, "module_episode_returns_mean": {"default_policy": 1.699999999999999}, "num_episodes": 250.0, "env_reset_timer": 4.182717469303139e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9003102455450274e-06, "numpy_to_tensor": 1.319244552673918e-05, "batch_individual_items": 1.299153930884216e-05, "add_states_from_episodes_to_batch": 2.8014436030757907e-06, "add_time_dim_to_batch_and_zero_pad": 7.33904447606483e-06}}, "connector_pipeline_timer": 6.180081191765985e-05}, "episode_return_max": 10.5, "env_step_timer": 1.4468140451015004e-05, "rlmodule_inference_timer": 4.2487906777164615e-05, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -9.5, "agent_episode_returns_mean": {"default_agent": 1.699999999999999}, "episode_return_mean": 1.699999999999999, "episode_duration_sec_mean": 0.005856376016046852, "weights_seq_no": 1.0, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "num_episodes_lifetime": 500.0, "sample": 0.005788648802126125, "num_env_steps_sampled_lifetime_throughput": 3228.324665294854}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15237694618874228, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008956652687629685, "add_observations_from_episodes_to_batch": 0.0009074991894885897, "add_columns_from_episodes_to_train_batch": 0.0415301423787605, "add_time_dim_to_batch_and_zero_pad": 0.0896352379990276, "add_states_from_episodes_to_batch": 0.003636818357044831, "batch_individual_items": 0.007498311770614236, "numpy_to_tensor": 5.890144850127399e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 11970, "weights_seq_no": 2.0, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained": 5985, "module_train_batch_size_mean": 998.828720912135, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 792.1753686377982}, "default_policy": {"num_module_steps_trained_lifetime": 11970, "mean_kl_loss": 2.395332558080554e-05, "vf_loss": 0.3208920955657959, "weights_seq_no": 2.0, "policy_loss": -0.0001991388708120212, "module_train_batch_size_mean": 998.828720912135, "use_intrinsic_rewards": 0.0, "entropy": 0.6888523101806641, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5985, "vf_explained_var": -0.0008989572525024414, "vf_loss_unclipped": 42.344993591308594, "total_loss": 0.24873115122318268, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.040395982563495636, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 792.1623024063704}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "policy_loss": -0.00019508223340380937, "use_intrinsic_rewards": 1.0, "entropy": 0.6888422966003418, "module_train_batch_size_mean": 998.2236050808158, "total_loss": 0.24875248968601227, "diff_num_grad_updates_vs_sampler_policy": 11.0, "vf_explained_var": -0.0020285844802856445, "num_module_steps_trained_lifetime": 71820, "mean_kl_loss": 2.3191336367744952e-05, "vf_loss_unclipped": 42.32759475708008, "vf_loss": 0.3209119737148285, "weights_seq_no": 12.0}, "__all_modules__": {"num_module_steps_trained_lifetime": 143640, "num_env_steps_trained_lifetime": 432000, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 62781.62060680838}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 11.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 71820, "weights_seq_no": 12.0, "module_train_batch_size_mean": 998.2236050808158, "num_module_steps_trained": 35910}}}, "IntrinsicAttentionMask": [[[0.16807852685451508, 0.17150400578975677, 0.162664994597435, 0.17079968750476837, 0.1619969755411148, 0.16495577991008759], [0.1687542200088501, 0.1739310920238495, 0.16067957878112793, 0.17286242544651031, 0.15969234704971313, 0.16408038139343262], [0.16694390773773193, 0.1675933599472046, 0.16589541733264923, 0.16746069490909576, 0.16576409339904785, 0.16634249687194824], [0.1686178743839264, 0.1734350025653839, 0.16108419001102448, 0.17244140803813934, 0.1601613461971283, 0.16426020860671997], [0.16679799556732178, 0.1671043038368225, 0.1663021594285965, 0.16704177856445312, 0.166239932179451, 0.16651378571987152], [0.16743431985378265, 0.16925956308841705, 0.16451430320739746, 0.16888566315174103, 0.1641508787870407, 0.16575534641742706]], [[0.1670253574848175, 0.16789887845516205, 0.16536150872707367, 0.1662263423204422, 0.1667751967906952, 0.1667127013206482], [0.16839012503623962, 0.17273083329200745, 0.16036221385002136, 0.16449598968029022, 0.16716308891773224, 0.16685771942138672], [0.16428881883621216, 0.15885715186595917, 0.17523956298828125, 0.16944585740566254, 0.16588371992111206, 0.16628485918045044], [0.16573351621627808, 0.16352984309196472, 0.1700465977191925, 0.16778557002544403, 0.16637223958969116, 0.16653230786323547], [0.16662533581256866, 0.16652564704418182, 0.1668168157339096, 0.1667170226573944, 0.16665399074554443, 0.16666114330291748], [0.16652479767799377, 0.16618342697620392, 0.16718195378780365, 0.16683922708034515, 0.16662301123142242, 0.16664758324623108]], [[0.16730549931526184, 0.16739310324192047, 0.16532735526561737, 0.16541394591331482, 0.16550058126449585, 0.16905955970287323], [0.1674318164587021, 0.16753700375556946, 0.1650601625442505, 0.16516384482383728, 0.16526760160923004, 0.16953952610492706], [0.16434140503406525, 0.16403786838054657, 0.1713901311159134, 0.1710735708475113, 0.17075759172439575, 0.15839941799640656], [0.16447556018829346, 0.1641889214515686, 0.17112360894680023, 0.17082537710666656, 0.17052766680717468, 0.15885885059833527], [0.1646094024181366, 0.16433967649936676, 0.1708570420742035, 0.17057709395885468, 0.17029760777950287, 0.1593191772699356], [0.1697528064250946, 0.17019538581371307, 0.16000314056873322, 0.16042031347751617, 0.1608385592699051, 0.17878985404968262]], [[0.16541875898838043, 0.16677029430866241, 0.1656682789325714, 0.16393932700157166, 0.16903793811798096, 0.16916538774967194], [0.16352924704551697, 0.16688455641269684, 0.16414566338062286, 0.1599031686782837, 0.1726061999797821, 0.17293120920658112], [0.16507075726985931, 0.16679514944553375, 0.16538885235786438, 0.1631876677274704, 0.1696970909833908, 0.16986051201820374], [0.16747309267520905, 0.16658742725849152, 0.16730867326259613, 0.16845637559890747, 0.1651277393102646, 0.16504666209220886], [0.1603364497423172, 0.16696587204933167, 0.1615443229675293, 0.15332263708114624, 0.1785796582698822, 0.1792510598897934], [0.16015630960464478, 0.16696642339229584, 0.16139651834964752, 0.15295983850955963, 0.17891477048397064, 0.17960616946220398]], [[0.166945219039917, 0.1648849993944168, 0.16497135162353516, 0.16720765829086304, 0.16729523241519928, 0.16869550943374634], [0.16553562879562378, 0.1733839213848114, 0.17304560542106628, 0.16456852853298187, 0.16424740850925446, 0.159218892455101], [0.1655997335910797, 0.17302200198173523, 0.17270243167877197, 0.16468383371829987, 0.16437965631484985, 0.159612238407135], [0.16710691154003143, 0.16382291913032532, 0.16396008431911469, 0.167526975274086, 0.1676672250032425, 0.16991598904132843], [0.16715994477272034, 0.16346955299377441, 0.16362349689006805, 0.16763265430927277, 0.1677905172109604, 0.17032386362552643], [0.16794787347316742, 0.1578902304172516, 0.15830188989639282, 0.16926492750644684, 0.16970624029636383, 0.1768888384103775]], [[0.16593682765960693, 0.16729259490966797, 0.1661871373653412, 0.16445277631282806, 0.16956734657287598, 0.16656331717967987], [0.16482418775558472, 0.16820606589317322, 0.1654454916715622, 0.1611694097518921, 0.17397302389144897, 0.1663818359375], [0.16573259234428406, 0.16746388375759125, 0.1660519391298294, 0.16384194791316986, 0.1703774631023407, 0.16653212904930115], [0.16713620722293854, 0.16625231504440308, 0.1669721156358719, 0.16811750829219818, 0.16479557752609253, 0.16672629117965698], [0.16292332112789154, 0.16965970396995544, 0.164150670170784, 0.1557963341474533, 0.18146087229251862, 0.1660090684890747], [0.165424644947052, 0.1677190661430359, 0.1658472865819931, 0.16292794048786163, 0.17159776389598846, 0.16648328304290771]]], "__all_modules__": {"num_env_steps_trained": 36000, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 23940, "num_env_steps_trained_lifetime": 72000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 4770.823756776672, "num_module_steps_trained_throughput": 31022894.08155711, "num_module_steps_trained_lifetime_throughput": 13441031.837197352}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4833768839012402e-05, "normalize_and_clip_actions": 7.879803373961838e-06, "remove_single_ts_time_rank_from_batch": 1.1662071858130717e-05, "listify_data_for_vector_env": 1.0304259364358454e-05, "get_actions": 3.528325187746704e-05, "un_batch_to_individual_items": 6.458051967906908e-06}}, "connector_pipeline_timer": 0.00011177396382692563}, "episode_duration_sec_mean": 0.005178333327057772, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7455882128740648e-06, "numpy_to_tensor": 1.1711321670885575e-05, "add_time_dim_to_batch_and_zero_pad": 7.00485265250164e-06, "batch_individual_items": 1.2313994814847125e-05, "add_states_from_episodes_to_batch": 2.6438364435796265e-06}}, "connector_pipeline_timer": 5.799229901901758e-05}, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "num_episodes_lifetime": 40, "num_env_steps_sampled_lifetime": 10400, "env_to_module_sum_episodes_length_out": 10.366003441359926, "module_episode_returns_mean": {"default_policy": -2.45}, "episode_return_max": 14.5, "env_step_timer": 1.3611963829565385e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "rlmodule_inference_timer": 3.032459477890134e-05, "env_to_module_sum_episodes_length_in": 10.366003441359926, "episode_return_mean": -2.45, "env_reset_timer": 0.0003268240462057292, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_min": -12.5, "agent_episode_returns_mean": {"default_agent": -2.45}, "weights_seq_no": 2.0, "sample": 0.11488268635235727, "episode_len_max": 20, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "time_between_sampling": 9.366594000020996}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "b483a_00000", "date": "2025-08-11_18-53-11", "timestamp": 1754931191, "time_this_iter_s": 9.453099012374878, "time_total_s": 18.970083713531494, "pid": 11892, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fcf98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18.970083713531494, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 34.53076923076923, "ram_util_percent": 78.26923076923076}}
{"timers": {"training_iteration": 9.390033325723895, "restore_env_runners": 1.1071062961127608e-05, "training_step": 9.389886119351756, "env_runner_sampling_timer": 1.6126022348787288, "learner_update_timer": 7.587564898649823, "synch_weights": 0.0011026523076579904, "restore_eval_env_runners": 1.0410617105662823e-05, "evaluation_iteration": 0.12254131127148866, "synch_eval_env_connectors": 0.00014984679641202094, "synch_env_connectors": 4.41682175733149e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00011640789634256943, "timers": {"connectors": {"get_actions": 3.872304251176246e-05, "un_batch_to_individual_items": 6.510302752437758e-06, "remove_single_ts_time_rank_from_batch": 1.1746139010695964e-05, "tensor_to_numpy": 1.5052614314736342e-05, "normalize_and_clip_actions": 7.92311038732136e-06, "listify_data_for_vector_env": 1.0200672472602416e-05}}}, "time_between_sampling": 0.03147351855293304, "num_env_steps_sampled_lifetime": -607500.0, "module_episode_returns_mean": {"default_policy": -1.1800000000000002}, "num_episodes": 250.0, "env_reset_timer": 3.7996536689835877e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7832223189447045e-06, "numpy_to_tensor": 1.2443982657783212e-05, "batch_individual_items": 1.2359252945640099e-05, "add_states_from_episodes_to_batch": 2.712945108174095e-06, "add_time_dim_to_batch_and_zero_pad": 7.082968536602308e-06}}, "connector_pipeline_timer": 5.9218448868580374e-05}, "episode_return_max": 10.5, "env_step_timer": 1.3718614647483414e-05, "rlmodule_inference_timer": 4.2769949293601616e-05, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -9.5, "agent_episode_returns_mean": {"default_agent": -1.1800000000000002}, "episode_return_mean": -1.1800000000000002, "episode_duration_sec_mean": 0.0052053291890770195, "weights_seq_no": 2.0, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "num_episodes_lifetime": -30375.0, "sample": 0.006011123699831067, "num_env_steps_sampled_lifetime_throughput": 3287.0590014727363}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15235521922692422, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008954275331052485, "add_observations_from_episodes_to_batch": 0.0009066112773958594, "add_columns_from_episodes_to_train_batch": 0.04152130970541621, "add_time_dim_to_batch_and_zero_pad": 0.0896239376993035, "add_states_from_episodes_to_batch": 0.0036376355835120193, "batch_individual_items": 0.007499442403600551, "numpy_to_tensor": 5.9057854127604514e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 17955, "weights_seq_no": 3.0, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained": 5985, "module_train_batch_size_mean": 998.7505232584676, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 790.7650621590274}, "default_policy": {"num_module_steps_trained_lifetime": 17955, "mean_kl_loss": 2.925374428741634e-05, "vf_loss": 0.3205867111682892, "weights_seq_no": 3.0, "policy_loss": -0.00033530002110637724, "module_train_batch_size_mean": 998.7505232584676, "use_intrinsic_rewards": 0.0, "entropy": 0.6896588802337646, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5985, "vf_explained_var": 0.0002766251564025879, "vf_loss_unclipped": 41.142555236816406, "total_loss": 0.24835506081581116, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.020197991281747818, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 790.7523409692037}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "policy_loss": -0.0003246908891014755, "use_intrinsic_rewards": 1.0, "entropy": 0.6896420121192932, "module_train_batch_size_mean": 998.0016398003509, "total_loss": 0.24857550859451294, "diff_num_grad_updates_vs_sampler_policy": 16.0, "vf_explained_var": -0.002074122428894043, "num_module_steps_trained_lifetime": 107730, "mean_kl_loss": 2.7723806852009147e-05, "vf_loss_unclipped": 41.357948303222656, "vf_loss": 0.32085177302360535, "weights_seq_no": 18.0}, "__all_modules__": {"num_module_steps_trained_lifetime": 215460, "num_env_steps_trained_lifetime": 648000, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 62210.97502239996}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 16.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 107730, "weights_seq_no": 18.0, "module_train_batch_size_mean": 998.0016398003509, "num_module_steps_trained": 35910}}}, "IntrinsicAttentionMask": [[[0.16661913692951202, 0.1700148731470108, 0.1696654111146927, 0.16931667923927307, 0.16896864771842957, 0.15541525185108185], [0.16653572022914886, 0.17164452373981476, 0.1711164116859436, 0.17058990895748138, 0.1700650453567505, 0.15004834532737732], [0.16654598712921143, 0.17147943377494812, 0.17096967995166779, 0.17046143114566803, 0.16995471715927124, 0.15058869123458862], [0.16655589640140533, 0.17131412029266357, 0.17082269489765167, 0.17033268511295319, 0.16984406113624573, 0.15113064646720886], [0.16656535863876343, 0.17114850878715515, 0.1706753820180893, 0.1702035516500473, 0.16973304748535156, 0.15167415142059326], [0.16659806668758392, 0.16420525312423706, 0.16444769501686096, 0.1646905094385147, 0.16493366658687592, 0.17512479424476624]], [[0.16702507436275482, 0.16789859533309937, 0.16689994931221008, 0.16622605919837952, 0.1667749136686325, 0.1651754379272461], [0.16838330030441284, 0.17272382974624634, 0.1677686870098114, 0.16448932886123657, 0.16715630888938904, 0.159478560090065], [0.16682571172714233, 0.1672113537788391, 0.16677038371562958, 0.16647198796272278, 0.16671507060527802, 0.1660054326057434], [0.16573159396648407, 0.1635279357433319, 0.16605064272880554, 0.16778361797332764, 0.16637030243873596, 0.1705358773469925], [0.16662533581256866, 0.16652566194534302, 0.16663967072963715, 0.1667170226573944, 0.16665399074554443, 0.16683833301067352], [0.1639566719532013, 0.1578461229801178, 0.16485384106636047, 0.1697826087474823, 0.16575594246387482, 0.17780473828315735]], [[0.16667278110980988, 0.16163676977157593, 0.16972003877162933, 0.16937118768692017, 0.1690230518579483, 0.1635761708021164], [0.1666734516620636, 0.16543443500995636, 0.16740946471691132, 0.1673257201910019, 0.16724200546741486, 0.16591499745845795], [0.16665706038475037, 0.15942054986953735, 0.17108368873596191, 0.1705750972032547, 0.17006804049015045, 0.1621956080198288], [0.1666593998670578, 0.15967124700546265, 0.17092885076999664, 0.17043852806091309, 0.16994962096214294, 0.16235235333442688], [0.16666162014007568, 0.15992219746112823, 0.17077401280403137, 0.1703019142150879, 0.16983112692832947, 0.16250911355018616], [0.1666770875453949, 0.16395147144794464, 0.16830787062644958, 0.16812187433242798, 0.1679360717535019, 0.16500569880008698]], [[0.16676893830299377, 0.1660955846309662, 0.16664400696754456, 0.16751553118228912, 0.1665191650390625, 0.16645677387714386], [0.16645801067352295, 0.1678163856267929, 0.1667088121175766, 0.16497108340263367, 0.1669599860906601, 0.1670857071876526], [0.16671207547187805, 0.1664137840270996, 0.16665677726268768, 0.16704201698303223, 0.1666014939546585, 0.16657386720180511], [0.16710105538368225, 0.16420461237430573, 0.16656069457530975, 0.17035822570323944, 0.16602206230163574, 0.16575340926647186], [0.16665486991405487, 0.16673223674297333, 0.16666920483112335, 0.16656948626041412, 0.16668352484703064, 0.16669069230556488], [0.16662614047527313, 0.16689155995845795, 0.16667526960372925, 0.16633360087871552, 0.16672442853450775, 0.1667490005493164]], [[0.1709301918745041, 0.16576555371284485, 0.16542483866214752, 0.17369753122329712, 0.1647454798221588, 0.15943643450737], [0.16770532727241516, 0.16645865142345428, 0.16637536883354187, 0.168361634016037, 0.16620895266532898, 0.1648901402950287], [0.16748864948749542, 0.16650265455245972, 0.16643673181533813, 0.16800710558891296, 0.16630497574806213, 0.1652599275112152], [0.17261315882205963, 0.16537536680698395, 0.1649009734392166, 0.17652729153633118, 0.16395626962184906, 0.15662693977355957], [0.167055144906044, 0.16658972203731537, 0.16655854880809784, 0.1672993004322052, 0.16649623215198517, 0.16600102186203003], [0.16359898447990417, 0.1672380566596985, 0.16748498380184174, 0.16172577440738678, 0.16797992587089539, 0.17197221517562866]], [[0.1654195338487625, 0.1667710691690445, 0.16878411173820496, 0.16394008696079254, 0.1659189760684967, 0.1691661775112152], [0.16353406012058258, 0.16688945889472961, 0.17196306586265564, 0.15990787744522095, 0.164769247174263, 0.17293629050254822], [0.1607130765914917, 0.16698111593723297, 0.17667217552661896, 0.15406586229801178, 0.16300737857818604, 0.17856040596961975], [0.1674734205007553, 0.16658775508403778, 0.16529035568237305, 0.16845670342445374, 0.1671447455883026, 0.16504700481891632], [0.1647237092256546, 0.1668202430009842, 0.1699603796005249, 0.16243967413902283, 0.16549734771251678, 0.17055870592594147], [0.1601763218641281, 0.1669873148202896, 0.17756213247776031, 0.15297897160053253, 0.1626666784286499, 0.1796286255121231]]], "__all_modules__": {"num_env_steps_trained": 36000, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 35910, "num_env_steps_trained_lifetime": 108000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 4762.227304719068, "num_module_steps_trained_throughput": 30383406.894626044, "num_module_steps_trained_lifetime_throughput": 13426499.254277198}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5000903564079544e-05, "normalize_and_clip_actions": 7.854141706286123e-06, "remove_single_ts_time_rank_from_batch": 1.163668563997539e-05, "listify_data_for_vector_env": 1.031976427940602e-05, "get_actions": 3.653263778884074e-05, "un_batch_to_individual_items": 6.522002875955146e-06}}, "connector_pipeline_timer": 0.00011372302799317402}, "episode_duration_sec_mean": 0.005157427798258141, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.735173321298588e-06, "numpy_to_tensor": 1.1945179667570982e-05, "add_time_dim_to_batch_and_zero_pad": 6.826278471790787e-06, "batch_individual_items": 1.2307162592476603e-05, "add_states_from_episodes_to_batch": 2.6629069269741606e-06}}, "connector_pipeline_timer": 5.819676522968765e-05}, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "num_episodes_lifetime": 60, "num_env_steps_sampled_lifetime": 15400, "env_to_module_sum_episodes_length_out": 10.368205581254823, "module_episode_returns_mean": {"default_policy": -2.283333333333333}, "episode_return_max": 14.5, "env_step_timer": 1.4043377892377745e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "rlmodule_inference_timer": 3.15507136225857e-05, "env_to_module_sum_episodes_length_in": 10.368205581254823, "episode_return_mean": -2.283333333333333, "env_reset_timer": 0.0003242712256265804, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_min": -12.5, "agent_episode_returns_mean": {"default_agent": -2.283333333333333}, "weights_seq_no": 3.0, "sample": 0.11484350907905026, "episode_len_max": 20, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "time_between_sampling": 9.36537012669025}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "b483a_00000", "date": "2025-08-11_18-53-20", "timestamp": 1754931200, "time_this_iter_s": 9.341938972473145, "time_total_s": 28.31202268600464, "pid": 11892, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fcf98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 28.31202268600464, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 33.60714285714286, "ram_util_percent": 78.07857142857142}}
{"timers": {"training_iteration": 9.389188717466524, "restore_env_runners": 1.1035351738450117e-05, "training_step": 9.389041072318177, "env_runner_sampling_timer": 1.611652777950057, "learner_update_timer": 7.587569320073529, "synch_weights": 0.0011010487038287098, "restore_eval_env_runners": 1.040526139549911e-05, "evaluation_iteration": 0.12247570023913867, "synch_eval_env_connectors": 0.00014949457815382632, "synch_env_connectors": 4.415993799921125e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00011678054727334832, "timers": {"connectors": {"get_actions": 3.873312278531189e-05, "un_batch_to_individual_items": 6.547925584385231e-06, "remove_single_ts_time_rank_from_batch": 1.1761407833762228e-05, "tensor_to_numpy": 1.5030945604403617e-05, "normalize_and_clip_actions": 7.937819503775311e-06, "listify_data_for_vector_env": 1.0349933216171483e-05}}}, "time_between_sampling": 0.03183324698071661, "num_env_steps_sampled_lifetime": -1225000.0, "module_episode_returns_mean": {"default_policy": 0.019999999999999997}, "num_episodes": 250.0, "env_reset_timer": 3.718450508971364e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7939510092095847e-06, "numpy_to_tensor": 1.2559586682966422e-05, "batch_individual_items": 1.2515507142655776e-05, "add_states_from_episodes_to_batch": 2.7159148228260455e-06, "add_time_dim_to_batch_and_zero_pad": 7.0190899069212354e-06}}, "connector_pipeline_timer": 5.9514399008389697e-05}, "episode_return_max": 10.5, "env_step_timer": 1.3874364237609728e-05, "rlmodule_inference_timer": 3.141973007759805e-05, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -9.5, "agent_episode_returns_mean": {"default_agent": 0.019999999999999997}, "episode_return_mean": 0.019999999999999997, "episode_duration_sec_mean": 0.005228956641163674, "weights_seq_no": 3.0, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "num_episodes_lifetime": -61250.0, "sample": 0.005604969356013985, "num_env_steps_sampled_lifetime_throughput": 3287.420565970366}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1523484024545188, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008952405497941072, "add_observations_from_episodes_to_batch": 0.000905740573940333, "add_columns_from_episodes_to_train_batch": 0.04151786035837874, "add_time_dim_to_batch_and_zero_pad": 0.08962322457197064, "add_states_from_episodes_to_batch": 0.0036381296376442767, "batch_individual_items": 0.007499529229962034, "numpy_to_tensor": 5.9060604900470934e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 23940, "weights_seq_no": 4.0, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained": 5985, "module_train_batch_size_mean": 998.6769017198101, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 788.837639759483}, "default_policy": {"num_module_steps_trained_lifetime": 23940, "mean_kl_loss": 4.019244443043135e-05, "vf_loss": 0.32057783007621765, "weights_seq_no": 4.0, "policy_loss": -0.000487751851323992, "module_train_batch_size_mean": 998.6769017198101, "use_intrinsic_rewards": 0.0, "entropy": 0.6901734471321106, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5985, "vf_explained_var": 0.0006392002105712891, "vf_loss_unclipped": 42.99098587036133, "total_loss": 0.24819450080394745, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.010098995640873909, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 788.8253586811467}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "policy_loss": -0.0004730694927275181, "use_intrinsic_rewards": 1.0, "entropy": 0.6901538968086243, "module_train_batch_size_mean": 997.847060245087, "total_loss": 0.24833469092845917, "diff_num_grad_updates_vs_sampler_policy": 21.0, "vf_explained_var": -0.0016672611236572266, "num_module_steps_trained_lifetime": 143640, "mean_kl_loss": 3.79518824047409e-05, "vf_loss_unclipped": 43.02273941040039, "vf_loss": 0.320732057094574, "weights_seq_no": 24.0}, "__all_modules__": {"num_module_steps_trained_lifetime": 287280, "num_env_steps_trained_lifetime": 864000, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 61463.85108134048}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 21.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 143640, "weights_seq_no": 24.0, "module_train_batch_size_mean": 997.847060245087, "num_module_steps_trained": 35910}}}, "IntrinsicAttentionMask": [[[0.16666989028453827, 0.17006665468215942, 0.16130174696445465, 0.16936823725700378, 0.16902011632919312, 0.16357332468032837], [0.16664807498455048, 0.17176033556461334, 0.1586742252111435, 0.17070500552654266, 0.17017978429794312, 0.1620325893163681], [0.16667219996452332, 0.16732057929039001, 0.1656254082918167, 0.1671881228685379, 0.16712193191051483, 0.16607174277305603], [0.16665376722812653, 0.1714147925376892, 0.15920785069465637, 0.17043277621269226, 0.16994386911392212, 0.16234688460826874], [0.16665640473365784, 0.17124205827713013, 0.15947511792182922, 0.1702965945005417, 0.16982582211494446, 0.16250404715538025], [0.16667625308036804, 0.16849322617053986, 0.1637694537639618, 0.16812101006507874, 0.16793522238731384, 0.16500486433506012]], [[0.16645696759223938, 0.16471977531909943, 0.1667080670595169, 0.16807013750076294, 0.16695955395698547, 0.1670854240655899], [0.16685618460178375, 0.16848991811275482, 0.16662275791168213, 0.16536825895309448, 0.16638965904712677, 0.16627322137355804], [0.1663978397846222, 0.16418324410915375, 0.1667184829711914, 0.16846008598804474, 0.16703973710536957, 0.16720059514045715], [0.16607096791267395, 0.16130906343460083, 0.16676661372184753, 0.17057254910469055, 0.16746516525745392, 0.16781555116176605], [0.1663382649421692, 0.16364799439907074, 0.1667284071445465, 0.16885045170783997, 0.16711948812007904, 0.16731536388397217], [0.16630832850933075, 0.16338087618350983, 0.16673322021961212, 0.1690458208322525, 0.16715921461582184, 0.16737262904644012]], [[0.16666989028453827, 0.17006665468215942, 0.16130174696445465, 0.16936823725700378, 0.16902011632919312, 0.16357332468032837], [0.16664807498455048, 0.17176033556461334, 0.1586742252111435, 0.17070500552654266, 0.17017978429794312, 0.1620325893163681], [0.16667219996452332, 0.16732057929039001, 0.1656254082918167, 0.1671881228685379, 0.16712193191051483, 0.16607174277305603], [0.16665376722812653, 0.1714147925376892, 0.15920785069465637, 0.17043277621269226, 0.16994386911392212, 0.16234688460826874], [0.16665638983249664, 0.17124204337596893, 0.15947511792182922, 0.1702965795993805, 0.16982580721378326, 0.16250403225421906], [0.16667625308036804, 0.16849322617053986, 0.1637694388628006, 0.16812101006507874, 0.16793522238731384, 0.16500486433506012]], [[0.1670253574848175, 0.16789887845516205, 0.16536150872707367, 0.1662263423204422, 0.1667751967906952, 0.1667127013206482], [0.16839012503623962, 0.17273081839084625, 0.16036224365234375, 0.16449598968029022, 0.16716308891773224, 0.1668577343225479], [0.16428880393505096, 0.15885716676712036, 0.17523954808712006, 0.16944585740566254, 0.16588371992111206, 0.16628485918045044], [0.16573351621627808, 0.16352982819080353, 0.1700465977191925, 0.16778557002544403, 0.16637223958969116, 0.16653230786323547], [0.16662533581256866, 0.16652564704418182, 0.1668168157339096, 0.1667170226573944, 0.16665399074554443, 0.16666115820407867], [0.16652479767799377, 0.16618342697620392, 0.16718195378780365, 0.16683924198150635, 0.16662302613258362, 0.16664758324623108]], [[0.16802982985973358, 0.1714543104171753, 0.1711018979549408, 0.16228361427783966, 0.1703992336988449, 0.15673111379146576], [0.16864557564258575, 0.17381910979747772, 0.17328430712223053, 0.16008208692073822, 0.17221961915493011, 0.15194934606552124], [0.1685846894979477, 0.17357851564884186, 0.1730625182390213, 0.1603071391582489, 0.1720351278781891, 0.15243206918239594], [0.16687005758285522, 0.1673477590084076, 0.16729898750782013, 0.16604937613010406, 0.1672014594078064, 0.16523230075836182], [0.16846157610416412, 0.1730969101190567, 0.17261838912963867, 0.1607568860054016, 0.17166532576084137, 0.15340086817741394], [0.16558526456356049, 0.16320697963237762, 0.16344796121120453, 0.16976872086524963, 0.1639309823513031, 0.1740601360797882]], [[0.1654195338487625, 0.1667710691690445, 0.16878411173820496, 0.16394010186195374, 0.1659189760684967, 0.1691661775112152], [0.16353406012058258, 0.16688945889472961, 0.17196306586265564, 0.15990787744522095, 0.164769247174263, 0.17293629050254822], [0.1607130765914917, 0.16698111593723297, 0.17667217552661896, 0.15406587719917297, 0.16300737857818604, 0.17856040596961975], [0.1674734205007553, 0.16658775508403778, 0.16529037058353424, 0.16845670342445374, 0.1671447455883026, 0.16504700481891632], [0.1647236943244934, 0.166820228099823, 0.1699603646993637, 0.16243965923786163, 0.16549734771251678, 0.17055869102478027], [0.1601763218641281, 0.16698729991912842, 0.17756211757659912, 0.15297897160053253, 0.1626666784286499, 0.17962861061096191]]], "__all_modules__": {"num_env_steps_trained": 36000, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 47880, "num_env_steps_trained_lifetime": 144000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 4750.488249843082, "num_module_steps_trained_throughput": 29647186.2057337, "num_module_steps_trained_lifetime_throughput": 13408816.759430846}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4729036523850992e-05, "normalize_and_clip_actions": 7.814260380632213e-06, "remove_single_ts_time_rank_from_batch": 1.1713672576617068e-05, "listify_data_for_vector_env": 1.0222161513491083e-05, "get_actions": 3.477437706123322e-05, "un_batch_to_individual_items": 6.36685479198951e-06}}, "connector_pipeline_timer": 0.00011128848785885559}, "episode_duration_sec_mean": 0.005134241699124686, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7177511878966383e-06, "numpy_to_tensor": 1.1650630453621014e-05, "add_time_dim_to_batch_and_zero_pad": 6.639244555166536e-06, "batch_individual_items": 1.218617099873906e-05, "add_states_from_episodes_to_batch": 2.643751596488432e-06}}, "connector_pipeline_timer": 5.7394692226679494e-05}, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "num_episodes_lifetime": 80, "num_env_steps_sampled_lifetime": 20400, "env_to_module_sum_episodes_length_out": 10.368237912813044, "module_episode_returns_mean": {"default_policy": -2.7}, "episode_return_max": 14.5, "env_step_timer": 1.3608756785364338e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "rlmodule_inference_timer": 3.0212412200634775e-05, "env_to_module_sum_episodes_length_in": 10.368237912813044, "episode_return_mean": -2.7, "env_reset_timer": 0.00032185559300915335, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_min": -12.5, "agent_episode_returns_mean": {"default_agent": -2.7}, "weights_seq_no": 4.0, "sample": 0.11479351023814546, "episode_len_max": 20, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "time_between_sampling": 9.364988433333185}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "b483a_00000", "date": "2025-08-11_18-53-29", "timestamp": 1754931209, "time_this_iter_s": 9.423489093780518, "time_total_s": 37.735511779785156, "pid": 11892, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fcf98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 37.735511779785156, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 35.30769230769231, "ram_util_percent": 78.16923076923077}}
{"timers": {"training_iteration": 9.393486952792387, "restore_env_runners": 1.0984578418623421e-05, "training_step": 9.393338905345479, "env_runner_sampling_timer": 1.611333351840734, "learner_update_timer": 7.5920298872830525, "synch_weights": 0.0011000328062812385, "restore_eval_env_runners": 1.0423288872931154e-05, "evaluation_iteration": 0.12240263656619517, "synch_eval_env_connectors": 0.0001491475421607029, "synch_env_connectors": 4.418914546375163e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00012098361154995452, "timers": {"connectors": {"get_actions": 4.102190915346854e-05, "un_batch_to_individual_items": 6.671093643903476e-06, "remove_single_ts_time_rank_from_batch": 1.2009912108723517e-05, "tensor_to_numpy": 1.544520636129707e-05, "normalize_and_clip_actions": 8.141583636233511e-06, "listify_data_for_vector_env": 1.0531695323591755e-05}}}, "time_between_sampling": 0.03216081382086128, "num_env_steps_sampled_lifetime": -1842500.0, "module_episode_returns_mean": {"default_policy": -2.2199999999999998}, "num_episodes": 250.0, "env_reset_timer": 3.956909558399195e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.84546878770455e-06, "numpy_to_tensor": 1.2946240870854146e-05, "batch_individual_items": 1.2846617449892077e-05, "add_states_from_episodes_to_batch": 2.7727449104731062e-06, "add_time_dim_to_batch_and_zero_pad": 7.22917201340474e-06}}, "connector_pipeline_timer": 6.0976735446466185e-05}, "episode_return_max": 10.5, "env_step_timer": 1.4300400561387375e-05, "rlmodule_inference_timer": 3.353514902145857e-05, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -9.5, "agent_episode_returns_mean": {"default_agent": -2.2199999999999998}, "episode_return_mean": -2.2199999999999998, "episode_duration_sec_mean": 0.005425043210852893, "weights_seq_no": 4.0, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "num_episodes_lifetime": -92125.0, "sample": 0.005719562555471759, "num_env_steps_sampled_lifetime_throughput": 3213.366919944278}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15239510551062513, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008950919362447603, "add_observations_from_episodes_to_batch": 0.0009048510883694189, "add_columns_from_episodes_to_train_batch": 0.04151273925433406, "add_time_dim_to_batch_and_zero_pad": 0.08967209107561287, "add_states_from_episodes_to_batch": 0.0036419708407874206, "batch_individual_items": 0.0075012210279941025, "numpy_to_tensor": 5.922832825784688e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 29925, "weights_seq_no": 5.0, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained": 5985, "module_train_batch_size_mean": 998.6075885025957, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 786.3684958733288}, "default_policy": {"num_module_steps_trained_lifetime": 29925, "mean_kl_loss": 3.527348235365935e-05, "vf_loss": 0.32058095932006836, "weights_seq_no": 5.0, "policy_loss": -0.0006280387751758099, "module_train_batch_size_mean": 998.6075885025957, "use_intrinsic_rewards": 0.0, "entropy": 0.6909913420677185, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5985, "vf_explained_var": 0.0011598467826843262, "vf_loss_unclipped": 40.71552658081055, "total_loss": 0.24805495142936707, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.0050494978204369545, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 786.356737791622}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "policy_loss": -0.0006008862401358783, "use_intrinsic_rewards": 1.0, "entropy": 0.6909686326980591, "module_train_batch_size_mean": 997.7394089995611, "total_loss": 0.2482009381055832, "diff_num_grad_updates_vs_sampler_policy": 26.0, "vf_explained_var": -0.0019472837448120117, "num_module_steps_trained_lifetime": 179550, "mean_kl_loss": 3.241898593842052e-05, "vf_loss_unclipped": 40.87013626098633, "vf_loss": 0.32072713971138, "weights_seq_no": 30.0}, "__all_modules__": {"num_module_steps_trained_lifetime": 359100, "num_env_steps_trained_lifetime": 1080000, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 60592.09505113136}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 26.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 179550, "weights_seq_no": 30.0, "module_train_batch_size_mean": 997.7394089995611, "num_module_steps_trained": 35910}}}, "IntrinsicAttentionMask": [[[0.16766975820064545, 0.16560058295726776, 0.16784542798995972, 0.16577409207820892, 0.16586090624332428, 0.16724920272827148], [0.16293157637119293, 0.17065639793872833, 0.1622963696718216, 0.16999106109142303, 0.16965937614440918, 0.16446518898010254], [0.16807009279727936, 0.16517576575279236, 0.16831648349761963, 0.16541790962219238, 0.16553911566734314, 0.16748066246509552], [0.16333042085170746, 0.17022883892059326, 0.1627616286277771, 0.16963602602481842, 0.16934038698673248, 0.16470269858837128], [0.1635299026966095, 0.1700151413679123, 0.16299444437026978, 0.16945846378803253, 0.16918079555034637, 0.16482126712799072], [0.16671006381511688, 0.16662047803401947, 0.16671761870384216, 0.16662801802158356, 0.1666318029165268, 0.16669194400310516]], [[0.17492499947547913, 0.1669904887676239, 0.1621629148721695, 0.15480728447437286, 0.16324810683727264, 0.17786619067192078], [0.1713223159313202, 0.1668943464756012, 0.1641552895307541, 0.15991255640983582, 0.1647740602493286, 0.17294135689735413], [0.16904756426811218, 0.1667976975440979, 0.16539137065410614, 0.16319015622138977, 0.16571006178855896, 0.16986310482025146], [0.16545313596725464, 0.16658809781074524, 0.16730934381484985, 0.1684570461511612, 0.16714508831501007, 0.16504734754562378], [0.16956457495689392, 0.16682212054729462, 0.1651119440793991, 0.16244150698184967, 0.1654992252588272, 0.17056062817573547], [0.17621953785419464, 0.16700801253318787, 0.16143672168254852, 0.1529979407787323, 0.16268685460090637, 0.1796509027481079]], [[0.16808146238327026, 0.1630028933286667, 0.1711544692516327, 0.17080266773700714, 0.16199982166290283, 0.1649586707353592], [0.16701677441596985, 0.16577522456645966, 0.16775430738925934, 0.1676703840494156, 0.16552653908729553, 0.16625677049160004], [0.16869232058525085, 0.16136746108531952, 0.17317301034927368, 0.17265821993350983, 0.15993264317512512, 0.16417640447616577], [0.16862361133098602, 0.16155311465263367, 0.1729433834552765, 0.17244727909564972, 0.16016681492328644, 0.16426581144332886], [0.16679802536964417, 0.16633331775665283, 0.1670730710029602, 0.1670418083667755, 0.16623997688293457, 0.1665138155221939], [0.16743513941764832, 0.16469712555408478, 0.16907334327697754, 0.16888649761676788, 0.16415169835090637, 0.16575616598129272]], [[0.17207364737987518, 0.1580125242471695, 0.17283466458320618, 0.15871134400367737, 0.16438530385494232, 0.17398250102996826], [0.16211839020252228, 0.17398503422737122, 0.1615266501903534, 0.17334996163845062, 0.1683768779039383, 0.1606430560350418], [0.17258025705814362, 0.1572040170431137, 0.1734159290790558, 0.15796524286270142, 0.1641574501991272, 0.1746770441532135], [0.16264069080352783, 0.1731427162885666, 0.16211473941802979, 0.17258280515670776, 0.16819001734256744, 0.1613290011882782], [0.16677293181419373, 0.166496142745018, 0.1667872667312622, 0.1665104627609253, 0.16662447154521942, 0.16680878400802612], [0.1733383685350418, 0.15599487721920013, 0.174286887049675, 0.1568484902381897, 0.16381192207336426, 0.17571941018104553]], [[0.16802982985973358, 0.1714543104171753, 0.1711018979549408, 0.16228361427783966, 0.1703992336988449, 0.15673109889030457], [0.16864557564258575, 0.17381910979747772, 0.17328430712223053, 0.16008208692073822, 0.17221961915493011, 0.15194933116436005], [0.1685846894979477, 0.17357851564884186, 0.1730625182390213, 0.1603071391582489, 0.1720351278781891, 0.15243206918239594], [0.16687005758285522, 0.1673477590084076, 0.16729898750782013, 0.16604937613010406, 0.1672014594078064, 0.16523230075836182], [0.16846157610416412, 0.1730969101190567, 0.17261840403079987, 0.1607568860054016, 0.17166532576084137, 0.15340086817741394], [0.1655852496623993, 0.16320697963237762, 0.16344794631004333, 0.16976873576641083, 0.1639309674501419, 0.1740601509809494]], [[0.16754230856895447, 0.16686582565307617, 0.16587333381175995, 0.16674081981182098, 0.16574905812740326, 0.16722868382930756], [0.16491369903087616, 0.16625946760177612, 0.16826388239860535, 0.1665099561214447, 0.16851741075515747, 0.165535569190979], [0.16107115149497986, 0.16532664000988007, 0.1718074381351471, 0.16612720489501953, 0.1726393699645996, 0.16302810609340668], [0.16442875564098358, 0.16614480316638947, 0.16870787739753723, 0.1664646565914154, 0.16903266310691833, 0.16522124409675598], [0.16059130430221558, 0.16520623862743378, 0.17225410044193268, 0.16607557237148285, 0.17316052317619324, 0.16271226108074188], [0.166322723031044, 0.16658766567707062, 0.1669791042804718, 0.16663679480552673, 0.16702833771705627, 0.16644537448883057]]], "__all_modules__": {"num_env_steps_trained": 36000, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 59850, "num_env_steps_trained_lifetime": 180000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 4735.470750499351, "num_module_steps_trained_throughput": 28857693.281587247, "num_module_steps_trained_lifetime_throughput": 13375452.164029775}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4774155064862382e-05, "normalize_and_clip_actions": 7.907369372162479e-06, "remove_single_ts_time_rank_from_batch": 1.1768305280354254e-05, "listify_data_for_vector_env": 1.0344785412612407e-05, "get_actions": 3.557626140346539e-05, "un_batch_to_individual_items": 6.462480284774345e-06}}, "connector_pipeline_timer": 0.00011286844574198353}, "episode_duration_sec_mean": 0.005134437489323318, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.754278250799337e-06, "numpy_to_tensor": 1.1683160704631375e-05, "add_time_dim_to_batch_and_zero_pad": 6.756024409101886e-06, "batch_individual_items": 1.2294414437179346e-05, "add_states_from_episodes_to_batch": 2.6806265210330425e-06}}, "connector_pipeline_timer": 5.8055364255004976e-05}, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "num_episodes_lifetime": 100, "num_env_steps_sampled_lifetime": 25400, "env_to_module_sum_episodes_length_out": 10.368238387501162, "module_episode_returns_mean": {"default_policy": -2.35}, "episode_return_max": 14.5, "env_step_timer": 1.3631282736420756e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "rlmodule_inference_timer": 3.0787559269123466e-05, "env_to_module_sum_episodes_length_in": 10.368238387501162, "episode_return_mean": -2.35, "env_reset_timer": 0.00032054119709620945, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_min": -12.5, "agent_episode_returns_mean": {"default_agent": -2.35}, "weights_seq_no": 5.0, "sample": 0.11476584472651993, "episode_len_max": 20, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "time_between_sampling": 9.369768531500238}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "b483a_00000", "date": "2025-08-11_18-53-39", "timestamp": 1754931219, "time_this_iter_s": 9.941639184951782, "time_total_s": 47.67715096473694, "pid": 11892, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fcf98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 47.67715096473694, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 39.278571428571425, "ram_util_percent": 79.02857142857144}}
{"timers": {"training_iteration": 9.395209762015039, "restore_env_runners": 1.0934323309373959e-05, "training_step": 9.395061212132275, "env_runner_sampling_timer": 1.6102699954025246, "learner_update_timer": 7.594716545489832, "synch_weights": 0.0010965858081425476, "restore_eval_env_runners": 1.0398226552116686e-05, "evaluation_iteration": 0.12237853853055793, "synch_eval_env_connectors": 0.00014869481620854001, "synch_env_connectors": 4.411806009219726e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00011582334649894933, "timers": {"connectors": {"get_actions": 3.8299955222520644e-05, "un_batch_to_individual_items": 6.512320969930233e-06, "remove_single_ts_time_rank_from_batch": 1.1735807219903054e-05, "tensor_to_numpy": 1.4883795378827758e-05, "normalize_and_clip_actions": 7.89598612827115e-06, "listify_data_for_vector_env": 1.0183399958879218e-05}}}, "time_between_sampling": 0.03385069734783491, "num_env_steps_sampled_lifetime": -2460000.0, "module_episode_returns_mean": {"default_policy": -0.22}, "num_episodes": 250.0, "env_reset_timer": 3.9073834721882445e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7719322428566726e-06, "numpy_to_tensor": 1.2335897723013617e-05, "batch_individual_items": 1.2353838925377787e-05, "add_states_from_episodes_to_batch": 2.7016837812119736e-06, "add_time_dim_to_batch_and_zero_pad": 6.925953825343914e-06}}, "connector_pipeline_timer": 5.895629440905215e-05}, "episode_return_max": 10.5, "env_step_timer": 1.374648769580397e-05, "rlmodule_inference_timer": 3.1256100924364806e-05, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -9.5, "agent_episode_returns_mean": {"default_agent": -0.22}, "episode_return_mean": -0.22, "episode_duration_sec_mean": 0.005185628981795164, "weights_seq_no": 5.0, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "num_episodes_lifetime": -123000.0, "sample": 0.005619202014051934, "num_env_steps_sampled_lifetime_throughput": 3309.6687114897904}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15238567237537778, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008947822248222579, "add_observations_from_episodes_to_batch": 0.000903927157394051, "add_columns_from_episodes_to_train_batch": 0.04150578311180994, "add_time_dim_to_batch_and_zero_pad": 0.08967397682563259, "add_states_from_episodes_to_batch": 0.0036434261320684846, "batch_individual_items": 0.0074996154872582176, "numpy_to_tensor": 5.939520442289369e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 35910, "weights_seq_no": 6.0, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained": 5985, "module_train_batch_size_mean": 998.5423314844973, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 783.4558914006941}, "default_policy": {"num_module_steps_trained_lifetime": 35910, "mean_kl_loss": 2.3999658083084796e-07, "vf_loss": 0.3205115497112274, "weights_seq_no": 6.0, "policy_loss": -4.4405962398741394e-05, "module_train_batch_size_mean": 998.5423314844973, "use_intrinsic_rewards": 0.0, "entropy": 0.6907731890678406, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5985, "vf_explained_var": 0.0004956722259521484, "vf_loss_unclipped": 42.889461517333984, "total_loss": 0.24858449399471283, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.0025247489102184772, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 783.4446903291571}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "policy_loss": -4.287485353415832e-05, "use_intrinsic_rewards": 1.0, "entropy": 0.690774142742157, "module_train_batch_size_mean": 997.6644392492373, "total_loss": 0.24869254231452942, "diff_num_grad_updates_vs_sampler_policy": 31.0, "vf_explained_var": -0.0015170574188232422, "num_module_steps_trained_lifetime": 215460, "mean_kl_loss": 2.2234490870687296e-07, "vf_loss_unclipped": 42.8927116394043, "vf_loss": 0.3206482231616974, "weights_seq_no": 36.0}, "__all_modules__": {"num_module_steps_trained_lifetime": 430920, "num_env_steps_trained_lifetime": 1296000, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 59644.39253855756}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 31.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 215460, "weights_seq_no": 36.0, "module_train_batch_size_mean": 997.6644392492373, "num_module_steps_trained": 35910}}}, "IntrinsicAttentionMask": [[[0.16694879531860352, 0.167036235332489, 0.1649748831987381, 0.16721123456954956, 0.1672988086938858, 0.166530042886734], [0.16700467467308044, 0.16710959374904633, 0.16463905572891235, 0.16731961071491241, 0.16742472350597382, 0.16650235652923584], [0.16564376652240753, 0.16533783078193665, 0.17274834215641022, 0.16472762823104858, 0.1644233763217926, 0.16711916029453278], [0.16711603105068207, 0.1672559529542923, 0.163969025015831, 0.16753612458705902, 0.1676763892173767, 0.1664465367794037], [0.16717150807380676, 0.16732893884181976, 0.16363480687141418, 0.16764424741268158, 0.1678021252155304, 0.1664184033870697], [0.16667895019054413, 0.16668272018432617, 0.16659314930438995, 0.16669028997421265, 0.1666940599679947, 0.1666608303785324]], [[0.1672825664281845, 0.1681574285030365, 0.16561616957187653, 0.16648231446743011, 0.16549210250377655, 0.166969433426857], [0.16964313387870789, 0.17401613295078278, 0.16155549883842468, 0.16572003066539764, 0.16096581518650055, 0.1680993288755417], [0.16262927651405334, 0.1572524905204773, 0.1734694242477417, 0.16773423552513123, 0.1743094027042389, 0.16460517048835754], [0.16507293283939362, 0.16287802159786224, 0.16936881840229034, 0.16711680591106415, 0.16969487071037292, 0.16586853563785553], [0.16227492690086365, 0.15645432472229004, 0.17406000196933746, 0.16781668365001678, 0.1749759167432785, 0.16441811621189117], [0.16642357409000397, 0.16608239710330963, 0.1670803427696228, 0.16673782467842102, 0.16712960600852966, 0.1665462851524353]], [[0.1709805727005005, 0.16581441462039948, 0.1654735803604126, 0.16513346135616302, 0.16479402780532837, 0.16780391335487366], [0.16770824790000916, 0.1664615422487259, 0.16637827455997467, 0.16629503667354584, 0.16621184349060059, 0.16694508492946625], [0.16749046742916107, 0.16650445759296417, 0.16643854975700378, 0.1663726419210434, 0.16630679368972778, 0.1668870747089386], [0.1672729104757309, 0.16654732823371887, 0.16649878025054932, 0.16645024716854095, 0.1664017140865326, 0.16682901978492737], [0.16705556213855743, 0.1665901243686676, 0.16655896604061127, 0.16652779281139374, 0.1664966344833374, 0.16677092015743256], [0.16897474229335785, 0.1662115454673767, 0.16602785885334015, 0.1658443808555603, 0.16566109657287598, 0.16728031635284424]], [[0.17480729520320892, 0.15367470681667328, 0.17597711086273193, 0.1547030806541443, 0.17715473473072052, 0.1636831909418106], [0.16493235528469086, 0.16945376992225647, 0.16470162570476532, 0.16921670734882355, 0.16447120904922485, 0.16722439229488373], [0.17530961334705353, 0.15287764370441437, 0.1765565276145935, 0.15396499633789062, 0.17781229317188263, 0.16347895562648773], [0.16545067727565765, 0.16862009465694427, 0.16528823971748352, 0.16845455765724182, 0.1651259809732437, 0.16706053912639618], [0.17581099271774292, 0.1520826369524002, 0.1771354228258133, 0.15322832763195038, 0.17846985161304474, 0.16327273845672607], [0.16980622708797455, 0.16163882613182068, 0.17024007439613342, 0.16205179691314697, 0.17067502439022064, 0.16558803617954254]], [[0.16527900099754333, 0.1686474233865738, 0.1683007776737213, 0.16795483231544495, 0.16760961711406708, 0.16220827400684357], [0.1645813286304474, 0.16963018476963043, 0.16910827159881592, 0.16858795285224915, 0.1680692434310913, 0.1600230634212494], [0.16465269029140472, 0.16953004896640778, 0.16902607679367065, 0.1685236245393753, 0.16802266240119934, 0.1602448970079422], [0.16472399234771729, 0.16942988336086273, 0.168943852186203, 0.1684592366218567, 0.1679759919643402, 0.1604669690132141], [0.16479526460170746, 0.1693297177553177, 0.16886161267757416, 0.1683948040008545, 0.1679292917251587, 0.16068926453590393], [0.1659233570098877, 0.1677321195602417, 0.16754674911499023, 0.16736158728599548, 0.16717663407325745, 0.16425952315330505]], [[0.16541798412799835, 0.16369163990020752, 0.16566751897335052, 0.16702109575271606, 0.16903716325759888, 0.16916461288928986], [0.16781370341777802, 0.1694568246603012, 0.16757895052433014, 0.16631725430488586, 0.16447417438030243, 0.16435907781124115], [0.16506950557231903, 0.1628725826740265, 0.1653875857591629, 0.16711530089378357, 0.16969580948352814, 0.16985923051834106], [0.16317060589790344, 0.158491849899292, 0.16385409235954285, 0.1675935536623001, 0.17326372861862183, 0.17362622916698456], [0.16031859815120697, 0.15215927362442017, 0.16152633726596832, 0.16820494830608368, 0.1785597950220108, 0.17923110723495483], [0.16013748943805695, 0.1517665982246399, 0.16137756407260895, 0.16823959350585938, 0.17889374494552612, 0.1795850694179535]]], "__all_modules__": {"num_env_steps_trained": 36000, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 71820, "num_env_steps_trained_lifetime": 216000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 4717.775225966072, "num_module_steps_trained_throughput": 28075397.343575202, "num_module_steps_trained_lifetime_throughput": 13346089.279884977}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5124117692479475e-05, "normalize_and_clip_actions": 7.867475033422725e-06, "remove_single_ts_time_rank_from_batch": 1.1878139863395148e-05, "listify_data_for_vector_env": 1.0285185234747878e-05, "get_actions": 3.5434079837530535e-05, "un_batch_to_individual_items": 6.573116107093406e-06}}, "connector_pipeline_timer": 0.00011321741714951392}, "episode_duration_sec_mean": 0.005107613321160898, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7571379207102674e-06, "numpy_to_tensor": 1.1845636841049395e-05, "add_time_dim_to_batch_and_zero_pad": 6.748773591716943e-06, "batch_individual_items": 1.2322751525566814e-05, "add_states_from_episodes_to_batch": 2.6812836132681382e-06}}, "connector_pipeline_timer": 5.8339722064135756e-05}, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "num_episodes_lifetime": 120, "num_env_steps_sampled_lifetime": 30400, "env_to_module_sum_episodes_length_out": 10.368238394470474, "module_episode_returns_mean": {"default_policy": -2.15}, "episode_return_max": 14.5, "env_step_timer": 1.3590828578728328e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "rlmodule_inference_timer": 3.0157754301132368e-05, "env_to_module_sum_episodes_length_in": 10.368238394470474, "episode_return_mean": -2.15, "env_reset_timer": 0.00031803828523573947, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_min": -12.5, "agent_episode_returns_mean": {"default_agent": -2.15}, "weights_seq_no": 6.0, "sample": 0.11473101169924135, "episode_len_max": 20, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "time_between_sampling": 9.37195269951472}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "b483a_00000", "date": "2025-08-11_18-53-49", "timestamp": 1754931229, "time_this_iter_s": 9.684953212738037, "time_total_s": 57.362104177474976, "pid": 11892, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fcf98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 57.362104177474976, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 37.2, "ram_util_percent": 78.97142857142856}}
{"timers": {"training_iteration": 9.39355537772537, "restore_env_runners": 1.0879139976453763e-05, "training_step": 9.393406457511237, "env_runner_sampling_timer": 1.6092870079479353, "learner_update_timer": 7.5939420721147295, "synch_weights": 0.001094156609940732, "restore_eval_env_runners": 1.0354243579311903e-05, "evaluation_iteration": 0.12232133022481853, "synch_eval_env_connectors": 0.00014831620710282727, "synch_env_connectors": 4.408938554263685e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00011648557003446529, "timers": {"connectors": {"get_actions": 3.858446247425447e-05, "un_batch_to_individual_items": 6.530206624301435e-06, "remove_single_ts_time_rank_from_batch": 1.1771149337074714e-05, "tensor_to_numpy": 1.4983269481652712e-05, "normalize_and_clip_actions": 7.910638925758657e-06, "listify_data_for_vector_env": 1.0239272697280364e-05}}}, "time_between_sampling": 0.03329980775074366, "num_env_steps_sampled_lifetime": -3077500.0, "module_episode_returns_mean": {"default_policy": -1.0199999999999996}, "num_episodes": 250.0, "env_reset_timer": 3.5854212904688e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7900576883686732e-06, "numpy_to_tensor": 1.233240361152637e-05, "batch_individual_items": 1.2373926176081524e-05, "add_states_from_episodes_to_batch": 2.716976778684375e-06, "add_time_dim_to_batch_and_zero_pad": 6.988191825194701e-06}}, "connector_pipeline_timer": 5.913325705596216e-05}, "episode_return_max": 10.5, "env_step_timer": 1.3766502053808222e-05, "rlmodule_inference_timer": 3.155720917579399e-05, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -9.5, "agent_episode_returns_mean": {"default_agent": -1.0199999999999996}, "episode_return_mean": -1.0199999999999996, "episode_duration_sec_mean": 0.005215973336715248, "weights_seq_no": 6.0, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "num_episodes_lifetime": -153875.0, "sample": 0.005553877517130546, "num_env_steps_sampled_lifetime_throughput": 3299.950613951257}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15238315523110937, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00894346485549393, "add_observations_from_episodes_to_batch": 0.0009032303858976711, "add_columns_from_episodes_to_train_batch": 0.04150353944150076, "add_time_dim_to_batch_and_zero_pad": 0.08967420289657785, "add_states_from_episodes_to_batch": 0.0036460272913797897, "batch_individual_items": 0.007501366412696814, "numpy_to_tensor": 5.9779172514147896e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 41895, "weights_seq_no": 7.0, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained": 5985, "module_train_batch_size_mean": 998.4808932973482, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 780.6644696519821}, "default_policy": {"num_module_steps_trained_lifetime": 41895, "mean_kl_loss": 1.5169146536209155e-05, "vf_loss": 0.3205256164073944, "weights_seq_no": 7.0, "policy_loss": -0.00021266484691295773, "module_train_batch_size_mean": 998.4808932973482, "use_intrinsic_rewards": 0.0, "entropy": 0.6912374496459961, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5985, "vf_explained_var": 0.0002523064613342285, "vf_loss_unclipped": 41.48582077026367, "total_loss": 0.24842649698257446, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.0012623744551092386, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 780.653832198412}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "policy_loss": -0.000206102296942845, "use_intrinsic_rewards": 1.0, "entropy": 0.6912280321121216, "module_train_batch_size_mean": 997.6122293241576, "total_loss": 0.2485225945711136, "diff_num_grad_updates_vs_sampler_policy": 36.0, "vf_explained_var": -0.0016238689422607422, "num_module_steps_trained_lifetime": 251370, "mean_kl_loss": 1.4333874787553214e-05, "vf_loss_unclipped": 41.60260009765625, "vf_loss": 0.32063761353492737, "weights_seq_no": 42.0}, "__all_modules__": {"num_module_steps_trained_lifetime": 502740, "num_env_steps_trained_lifetime": 1512000, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 58666.477342165745}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 36.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 251370, "weights_seq_no": 42.0, "module_train_batch_size_mean": 997.6122293241576, "num_module_steps_trained": 35910}}}, "IntrinsicAttentionMask": [[[0.1680755913257599, 0.1715010106563568, 0.17114849388599396, 0.1623278260231018, 0.16199417412281036, 0.16495290398597717], [0.16874760389328003, 0.1739242672920227, 0.17338913679122925, 0.16017892956733704, 0.15968608856201172, 0.16407394409179688], [0.16867998242378235, 0.17367663979530334, 0.1731603443622589, 0.1603977531194687, 0.15992094576358795, 0.16416437923908234], [0.16687098145484924, 0.1673486977815628, 0.16729992628097534, 0.16605030000209808, 0.16600190103054047, 0.16642816364765167], [0.16679798066616058, 0.16710427403450012, 0.16707301139831543, 0.16627103090286255, 0.1662399172782898, 0.16651377081871033], [0.1674334704875946, 0.1692586988210678, 0.16907164454460144, 0.16433165967464447, 0.16415004432201385, 0.165754497051239]], [[0.16702382266521454, 0.1678973287343979, 0.1653600037097931, 0.16777154803276062, 0.16523613035678864, 0.16671118140220642], [0.1683533936738968, 0.1726931482553482, 0.1603272557258606, 0.17206279933452606, 0.15974204242229462, 0.16682133078575134], [0.16422559320926666, 0.158796027302742, 0.1751721352338791, 0.15956495702266693, 0.17602036893367767, 0.16622087359428406], [0.1681678742170334, 0.17200206220149994, 0.16104672849178314, 0.1714458465576172, 0.16052593290805817, 0.16681161522865295], [0.1640033721923828, 0.1581207662820816, 0.1759139746427536, 0.15895280241966248, 0.1768396496772766, 0.16616939008235931], [0.16652455925941467, 0.16618318855762482, 0.16718173027038574, 0.1662321835756302, 0.167231023311615, 0.16664734482765198]], [[0.16667278110980988, 0.16163676977157593, 0.16972003877162933, 0.16937118768692017, 0.1690230518579483, 0.1635761559009552], [0.1666734516620636, 0.16543443500995636, 0.16740946471691132, 0.1673257201910019, 0.16724200546741486, 0.16591499745845795], [0.16665706038475037, 0.15942057967185974, 0.17108368873596191, 0.1705751121044159, 0.17006804049015045, 0.1621956080198288], [0.1666593998670578, 0.15967126190662384, 0.17092885076999664, 0.17043852806091309, 0.16994962096214294, 0.16235235333442688], [0.16666162014007568, 0.15992221236228943, 0.17077401280403137, 0.17030192911624908, 0.16983112692832947, 0.16250911355018616], [0.1666771024465561, 0.16395147144794464, 0.16830787062644958, 0.16812187433242798, 0.1679360717535019, 0.16500571370124817]], [[0.17493322491645813, 0.16699831187725067, 0.16217052936553955, 0.15481451153755188, 0.17728234827518463, 0.16380110383033752], [0.17132484912872314, 0.16689680516719818, 0.1641577184200287, 0.15991491079330444, 0.17261888086795807, 0.1650867611169815], [0.1690482348203659, 0.16679835319519043, 0.16539201140403748, 0.1631907969713211, 0.16970035433769226, 0.1658702939748764], [0.16545327007770538, 0.16658824682235718, 0.1673094928264618, 0.16845719516277313, 0.16512855887413025, 0.1670631617307663], [0.17597109079360962, 0.16701513528823853, 0.1615920066833496, 0.15336786210536957, 0.17863237857818604, 0.1634214222431183], [0.1698242872953415, 0.16683492064476013, 0.16497299075126648, 0.16206903755664825, 0.17069317400455475, 0.16560564935207367]], [[0.16803276538848877, 0.17145730555057526, 0.16262072324752808, 0.17075318098068237, 0.17040221393108368, 0.15673382580280304], [0.16865217685699463, 0.17382590472698212, 0.16058242321014404, 0.17275789380073547, 0.17222635447978973, 0.1519552618265152], [0.16694220900535583, 0.1675916463136673, 0.16589371860027313, 0.16745898127555847, 0.16739268600940704, 0.16472075879573822], [0.16852907836437225, 0.17334367334842682, 0.1609993726015091, 0.17235060036182404, 0.17185620963573456, 0.15292108058929443], [0.16846689581871033, 0.17310237884521484, 0.16120761632919312, 0.17214663326740265, 0.17167074978351593, 0.15340569615364075], [0.16558672487735748, 0.16320842504501343, 0.16951994597911835, 0.1636907458305359, 0.1639324277639389, 0.17406171560287476]], [[0.1724904328584671, 0.15163791179656982, 0.15990595519542694, 0.16576826572418213, 0.17480675876140594, 0.17539067566394806], [0.16541144251823425, 0.16994599997997284, 0.1680627018213272, 0.16679736971855164, 0.1649489551782608, 0.16483353078365326], [0.16837455332279205, 0.1622278392314911, 0.1647329032421112, 0.1664537638425827, 0.16902408003807068, 0.16918684542179108], [0.17034761607646942, 0.15713253617286682, 0.16244877874851227, 0.16615615785121918, 0.17177771031856537, 0.17213711142539978], [0.17320093512535095, 0.1498248428106308, 0.1590481996536255, 0.16562435030937195, 0.17582033574581146, 0.17648135125637054], [0.1733778715133667, 0.14937399327754974, 0.15883344411849976, 0.16558729112148285, 0.17607347667217255, 0.1767539083957672]]], "__all_modules__": {"num_env_steps_trained": 36000, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 83790, "num_env_steps_trained_lifetime": 252000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 4700.802170989679, "num_module_steps_trained_throughput": 27321133.356924683, "num_module_steps_trained_lifetime_throughput": 13322303.7379097}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4770519954087718e-05, "normalize_and_clip_actions": 7.7795011656014e-06, "remove_single_ts_time_rank_from_batch": 1.1608482482305647e-05, "listify_data_for_vector_env": 1.0281983716023455e-05, "get_actions": 3.510554046144669e-05, "un_batch_to_individual_items": 6.4421941461628045e-06}}, "connector_pipeline_timer": 0.00011173242143896976}, "episode_duration_sec_mean": 0.005112864169059321, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7105751262650473e-06, "numpy_to_tensor": 1.181340551084402e-05, "add_time_dim_to_batch_and_zero_pad": 6.743845643493613e-06, "batch_individual_items": 1.2211231297400314e-05, "add_states_from_episodes_to_batch": 2.6440155453471357e-06}}, "connector_pipeline_timer": 5.77197670096971e-05}, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "num_episodes_lifetime": 140, "num_env_steps_sampled_lifetime": 35400, "env_to_module_sum_episodes_length_out": 10.368238394572801, "module_episode_returns_mean": {"default_policy": -1.35}, "episode_return_max": 14.5, "env_step_timer": 1.3506698697347853e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "rlmodule_inference_timer": 3.0055856255453256e-05, "env_to_module_sum_episodes_length_in": 10.368238394572801, "episode_return_mean": -1.35, "env_reset_timer": 0.0003156362319420526, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_min": -12.5, "agent_episode_returns_mean": {"default_agent": -1.35}, "weights_seq_no": 7.0, "sample": 0.11469565866267836, "episode_len_max": 20, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "time_between_sampling": 9.370746015018991}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "b483a_00000", "date": "2025-08-11_18-53-58", "timestamp": 1754931238, "time_this_iter_s": 9.349355697631836, "time_total_s": 66.71145987510681, "pid": 11892, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fcf98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 66.71145987510681, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 33.707692307692305, "ram_util_percent": 78.19230769230768}}
{"timers": {"training_iteration": 9.393067948537748, "restore_env_runners": 1.0827428173134189e-05, "training_step": 9.392918644186695, "env_runner_sampling_timer": 1.6082685603687852, "learner_update_timer": 7.5943964043135574, "synch_weights": 0.001092095464196451, "restore_eval_env_runners": 1.032654106907616e-05, "evaluation_iteration": 0.12226703526210594, "synch_eval_env_connectors": 0.00014882929538927785, "synch_env_connectors": 4.4073489102604075e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00011604000794010633, "timers": {"connectors": {"get_actions": 3.84280385062535e-05, "un_batch_to_individual_items": 6.5115165224265106e-06, "remove_single_ts_time_rank_from_batch": 1.1741246452521355e-05, "tensor_to_numpy": 1.4918248618260194e-05, "normalize_and_clip_actions": 7.90282194089048e-06, "listify_data_for_vector_env": 1.0187176257094727e-05}}}, "time_between_sampling": 0.031994875362541565, "num_env_steps_sampled_lifetime": -3695000.0, "module_episode_returns_mean": {"default_policy": -0.54}, "num_episodes": 250.0, "env_reset_timer": 3.574250865604035e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7804748152501645e-06, "numpy_to_tensor": 1.2306072044946576e-05, "batch_individual_items": 1.2332538985544233e-05, "add_states_from_episodes_to_batch": 2.7197224320895174e-06, "add_time_dim_to_batch_and_zero_pad": 6.962973033048431e-06}}, "connector_pipeline_timer": 5.898045044278112e-05}, "episode_return_max": 10.5, "env_step_timer": 1.37917036195528e-05, "rlmodule_inference_timer": 3.162671312366598e-05, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -9.5, "agent_episode_returns_mean": {"default_agent": -0.54}, "episode_return_mean": -0.54, "episode_duration_sec_mean": 0.00520289868535474, "weights_seq_no": 7.0, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "num_episodes_lifetime": -184750.0, "sample": 0.00554827085837401, "num_env_steps_sampled_lifetime_throughput": 3306.01278175042}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15235793451944296, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008939666457380886, "add_observations_from_episodes_to_batch": 0.0009024555826331762, "add_columns_from_episodes_to_train_batch": 0.04149007112807523, "add_time_dim_to_batch_and_zero_pad": 0.08966633586755805, "add_states_from_episodes_to_batch": 0.003648150357657965, "batch_individual_items": 0.007500026498145237, "numpy_to_tensor": 6.0053050988564556e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 47880, "weights_seq_no": 8.0, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained": 5985, "module_train_batch_size_mean": 998.4230504637324, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 777.8226174493578}, "default_policy": {"num_module_steps_trained_lifetime": 47880, "mean_kl_loss": 3.422098598093726e-05, "vf_loss": 0.3205098807811737, "weights_seq_no": 8.0, "policy_loss": -0.0005699828616343439, "module_train_batch_size_mean": 998.4230504637324, "use_intrinsic_rewards": 0.0, "entropy": 0.691669762134552, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5985, "vf_explained_var": 0.0001595020294189453, "vf_loss_unclipped": 42.23252487182617, "total_loss": 0.24805624783039093, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.0006311872275546193, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 777.8125430315031}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "policy_loss": -0.000547749106772244, "use_intrinsic_rewards": 1.0, "entropy": 0.691652238368988, "module_train_batch_size_mean": 997.5758696422192, "total_loss": 0.24815449118614197, "diff_num_grad_updates_vs_sampler_policy": 41.0, "vf_explained_var": -0.001431107521057129, "num_module_steps_trained_lifetime": 287280, "mean_kl_loss": 3.159320476697758e-05, "vf_loss_unclipped": 42.27982711791992, "vf_loss": 0.32060083746910095, "weights_seq_no": 48.0}, "__all_modules__": {"num_module_steps_trained_lifetime": 574560, "num_env_steps_trained_lifetime": 1728000, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 57680.36050803344}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 41.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 287280, "weights_seq_no": 48.0, "module_train_batch_size_mean": 997.5758696422192, "num_module_steps_trained": 35910}}}, "IntrinsicAttentionMask": [[[0.16667278110980988, 0.16163676977157593, 0.16972003877162933, 0.16937118768692017, 0.1690230518579483, 0.1635761559009552], [0.1666734516620636, 0.16543443500995636, 0.16740946471691132, 0.1673257201910019, 0.16724200546741486, 0.16591499745845795], [0.16665706038475037, 0.15942057967185974, 0.17108368873596191, 0.1705751121044159, 0.17006804049015045, 0.1621956080198288], [0.1666593998670578, 0.15967126190662384, 0.17092885076999664, 0.17043852806091309, 0.16994962096214294, 0.16235235333442688], [0.16666162014007568, 0.15992221236228943, 0.17077401280403137, 0.17030192911624908, 0.16983112692832947, 0.16250911355018616], [0.1666771024465561, 0.16395147144794464, 0.16830787062644958, 0.16812187433242798, 0.1679360717535019, 0.16500571370124817]], [[0.1749095469713211, 0.15376459062099457, 0.162148579955101, 0.16809310019016266, 0.1632336676120758, 0.17785046994686127], [0.16493666172027588, 0.16945819556713104, 0.16758030652999878, 0.1663185954093933, 0.16734585165977478, 0.1643604040145874], [0.1690463125705719, 0.16287507116794586, 0.16539011895656586, 0.16711784899234772, 0.16570882499217987, 0.16986183822155], [0.17183372378349304, 0.15850335359573364, 0.16386598348617554, 0.1676057130098343, 0.16455239057540894, 0.17363883554935455], [0.1695626974105835, 0.16205956041812897, 0.16511011123657227, 0.16721153259277344, 0.16549737751483917, 0.17055873572826385], [0.1761988401412964, 0.15180440247058868, 0.16141775250434875, 0.16828151047229767, 0.16266773641109467, 0.17962980270385742]], [[0.16623102128505707, 0.16631808876991272, 0.16640518605709076, 0.16649232804775238, 0.16657952964305878, 0.1679738312959671], [0.16614402830600739, 0.1662483960390091, 0.16635282337665558, 0.16645734012126923, 0.16656190156936646, 0.16823552548885345], [0.16605697572231293, 0.1661786437034607, 0.16630040109157562, 0.1664222627878189, 0.16654419898986816, 0.16849753260612488], [0.16596989333629608, 0.1661088466644287, 0.1662479192018509, 0.16638709604740143, 0.1665264070034027, 0.16875986754894257], [0.16588276624679565, 0.16603899002075195, 0.166195347905159, 0.16635185480117798, 0.1665085107088089, 0.16902251541614532], [0.16449055075645447, 0.1649194061756134, 0.16534939408302307, 0.16578049957752228, 0.16621272265911102, 0.17324747145175934]], [[0.165937602519989, 0.16729338467121124, 0.1693127453327179, 0.16445353627204895, 0.16643860936164856, 0.16656410694122314], [0.1648290902376175, 0.16821105778217316, 0.173324853181839, 0.16117419302463531, 0.16607405245304108, 0.16638676822185516], [0.16315624117851257, 0.1695195436477661, 0.17935796082019806, 0.15640796720981598, 0.1654854267835617, 0.16607289016246796], [0.1671365350484848, 0.16625265777111053, 0.16495786607265472, 0.16811783611774445, 0.16680851578712463, 0.16672661900520325], [0.16552938520908356, 0.16763615608215332, 0.17079167068004608, 0.1632341593503952, 0.16630680859088898, 0.1665017306804657], [0.16542688012123108, 0.16772136092185974, 0.17116279900074005, 0.16293014585971832, 0.16627326607704163, 0.16648554801940918]], [[0.1665908247232437, 0.1666780710220337, 0.16676536202430725, 0.1668526977300644, 0.16694007813930511, 0.16617296636104584], [0.16657565534114838, 0.16668030619621277, 0.16678501665592194, 0.16688978672027588, 0.1669946312904358, 0.16607463359832764], [0.16656047105789185, 0.16668251156806946, 0.16680464148521423, 0.16692686080932617, 0.16704916954040527, 0.16597633063793182], [0.16654527187347412, 0.16668471693992615, 0.16682426631450653, 0.16696393489837646, 0.16710372269153595, 0.1658780872821808], [0.1665300726890564, 0.16668690741062164, 0.16684387624263763, 0.16700100898742676, 0.16715827584266663, 0.16577987372875214], [0.16666339337825775, 0.1666671633720398, 0.16667094826698303, 0.16667473316192627, 0.1666785031557083, 0.16664527356624603]], [[0.17207366228103638, 0.1580125093460083, 0.17283467948436737, 0.15871134400367737, 0.16438531875610352, 0.17398251593112946], [0.16211839020252228, 0.1739850491285324, 0.1615266352891922, 0.17334997653961182, 0.1683768779039383, 0.160643070936203], [0.1725802719593048, 0.1572040170431137, 0.17341595888137817, 0.15796524286270142, 0.16415748000144958, 0.1746770739555359], [0.16264069080352783, 0.17314273118972778, 0.16211473941802979, 0.17258282005786896, 0.16819003224372864, 0.1613290011882782], [0.16677293181419373, 0.166496142745018, 0.1667872667312622, 0.1665104627609253, 0.16662445664405823, 0.16680878400802612], [0.173338383436203, 0.15599486231803894, 0.17428690195083618, 0.1568484753370285, 0.16381192207336426, 0.17571942508220673]]], "__all_modules__": {"num_env_steps_trained": 36000, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 95760, "num_env_steps_trained_lifetime": 288000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 4683.52530006246, "num_module_steps_trained_throughput": 26600399.02099082, "num_module_steps_trained_lifetime_throughput": 13303317.464486688}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4758431411054551e-05, "normalize_and_clip_actions": 7.760377289897392e-06, "remove_single_ts_time_rank_from_batch": 1.1667073106909607e-05, "listify_data_for_vector_env": 1.0290905812365705e-05, "get_actions": 3.484825914143024e-05, "un_batch_to_individual_items": 6.4370322898950115e-06}}, "connector_pipeline_timer": 0.00011145572802907142}, "episode_duration_sec_mean": 0.005124607079196721, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7274177793108566e-06, "numpy_to_tensor": 1.1677986724365193e-05, "add_time_dim_to_batch_and_zero_pad": 6.930210308295034e-06, "batch_individual_items": 1.2309146577240832e-05, "add_states_from_episodes_to_batch": 2.6358354267300448e-06}}, "connector_pipeline_timer": 5.8128803350816584e-05}, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "num_episodes_lifetime": 160, "num_env_steps_sampled_lifetime": 40400, "env_to_module_sum_episodes_length_out": 10.3682383945743, "module_episode_returns_mean": {"default_policy": -0.55}, "episode_return_max": 14.5, "env_step_timer": 1.3649146044991338e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "rlmodule_inference_timer": 3.018809839563092e-05, "env_to_module_sum_episodes_length_in": 10.3682383945743, "episode_return_mean": -0.55, "env_reset_timer": 0.00031324944940571407, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_min": -12.5, "agent_episode_returns_mean": {"default_agent": -0.55}, "weights_seq_no": 8.0, "sample": 0.11467053582656403, "episode_len_max": 20, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "time_between_sampling": 9.370690948619181}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "b483a_00000", "date": "2025-08-11_18-54-08", "timestamp": 1754931248, "time_this_iter_s": 9.464555025100708, "time_total_s": 76.17601490020752, "pid": 11892, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fcf98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 76.17601490020752, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 35.214285714285715, "ram_util_percent": 78.52142857142859}}
{"timers": {"training_iteration": 9.396726991132528, "restore_env_runners": 1.0772904009643562e-05, "training_step": 9.396577055655142, "env_runner_sampling_timer": 1.6082644076853163, "learner_update_timer": 7.597938195270918, "synch_weights": 0.0010906765993697008, "restore_eval_env_runners": 1.0308275141464115e-05, "evaluation_iteration": 0.12221524990893144, "synch_eval_env_connectors": 0.00014830767219416684, "synch_env_connectors": 4.405775162697162e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00011739285630220574, "timers": {"connectors": {"get_actions": 3.898071788265445e-05, "un_batch_to_individual_items": 6.568100445750883e-06, "remove_single_ts_time_rank_from_batch": 1.1845510365200494e-05, "tensor_to_numpy": 1.5114354304644694e-05, "normalize_and_clip_actions": 7.981685160962636e-06, "listify_data_for_vector_env": 1.0374996499502807e-05}}}, "time_between_sampling": 0.032628657865594435, "num_env_steps_sampled_lifetime": -4312500.0, "module_episode_returns_mean": {"default_policy": -0.14000000000000007}, "num_episodes": 250.0, "env_reset_timer": 3.63480790907125e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8223864108547574e-06, "numpy_to_tensor": 1.2504602659573042e-05, "batch_individual_items": 1.2508554172100856e-05, "add_states_from_episodes_to_batch": 2.7355811445792823e-06, "add_time_dim_to_batch_and_zero_pad": 7.06351631867543e-06}}, "connector_pipeline_timer": 5.96630060723045e-05}, "episode_return_max": 10.5, "env_step_timer": 1.3987753668495278e-05, "rlmodule_inference_timer": 3.16489291586805e-05, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -9.5, "agent_episode_returns_mean": {"default_agent": -0.14000000000000007}, "episode_return_mean": -0.14000000000000007, "episode_duration_sec_mean": 0.005253901303280145, "weights_seq_no": 8.0, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "num_episodes_lifetime": -215625.0, "sample": 0.005593213014586925, "num_env_steps_sampled_lifetime_throughput": 3264.6484925734844}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15237399392450365, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008939087292152245, "add_observations_from_episodes_to_batch": 0.0009016993563545627, "add_columns_from_episodes_to_train_batch": 0.04149389957607699, "add_time_dim_to_batch_and_zero_pad": 0.08967084959784534, "add_states_from_episodes_to_batch": 0.003649552184450753, "batch_individual_items": 0.00750744289331616, "numpy_to_tensor": 6.03871003539991e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 53865, "weights_seq_no": 9.0, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained": 5985, "module_train_batch_size_mean": 998.3685925840979, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 774.6139475510909}, "default_policy": {"num_module_steps_trained_lifetime": 53865, "mean_kl_loss": 9.43708982958924e-06, "vf_loss": 0.3205195963382721, "weights_seq_no": 9.0, "policy_loss": -0.00011167446064064279, "module_train_batch_size_mean": 998.3685925840979, "use_intrinsic_rewards": 0.0, "entropy": 0.6919270157814026, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5985, "vf_explained_var": 0.0001633167266845703, "vf_loss_unclipped": 41.61748504638672, "total_loss": 0.24852168560028076, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.00031559361377730966, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 774.6044289361165}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "policy_loss": -0.00010847743396880105, "use_intrinsic_rewards": 1.0, "entropy": 0.6919217109680176, "module_train_batch_size_mean": 997.5505482791133, "total_loss": 0.24857957661151886, "diff_num_grad_updates_vs_sampler_policy": 46.0, "vf_explained_var": -0.0014406442642211914, "num_module_steps_trained_lifetime": 323190, "mean_kl_loss": 8.961330422607716e-06, "vf_loss_unclipped": 41.69408416748047, "vf_loss": 0.3205878734588623, "weights_seq_no": 54.0}, "__all_modules__": {"num_module_steps_trained_lifetime": 646380, "num_env_steps_trained_lifetime": 1944000, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 56689.07688962477}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 46.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 323190, "weights_seq_no": 54.0, "module_train_batch_size_mean": 997.5505482791133, "num_module_steps_trained": 35910}}}, "IntrinsicAttentionMask": [[[0.16952012479305267, 0.16439808905124664, 0.16406017541885376, 0.17226463556289673, 0.16338643431663513, 0.16637060046195984], [0.16736188530921936, 0.16611777245998383, 0.16603465378284454, 0.16801685094833374, 0.16586856544017792, 0.166600301861763], [0.16721686720848083, 0.16623246669769287, 0.16616666316986084, 0.16773447394371033, 0.16603510081768036, 0.16661444306373596], [0.17064641416072845, 0.16349108517169952, 0.16302210092544556, 0.17451594769954681, 0.16208815574645996, 0.16623632609844208], [0.16692671179771423, 0.16646163165569305, 0.1664304882287979, 0.1671706736087799, 0.16636821627616882, 0.16664227843284607], [0.16820184886455536, 0.1654512882232666, 0.1652684509754181, 0.1696598380804062, 0.16490337252616882, 0.16651517152786255]], [[0.1750601828098297, 0.16711951792240143, 0.16228823363780975, 0.1682378649711609, 0.16337424516677856, 0.16391998529434204], [0.17136450111865997, 0.16693542897701263, 0.164195716381073, 0.16756469011306763, 0.16481465101242065, 0.16512498259544373], [0.16905848681926727, 0.16680847108364105, 0.16540203988552094, 0.16712988913059235, 0.16572076082229614, 0.16588035225868225], [0.171891987323761, 0.16696316003799438, 0.1639215499162674, 0.16766253113746643, 0.1646081805229187, 0.1649525761604309], [0.16958078742027283, 0.16683804988861084, 0.1651277244091034, 0.16722938418388367, 0.16551503539085388, 0.16570903360843658], [0.16984237730503082, 0.1668526977300644, 0.16499057412147522, 0.16727899014949799, 0.16541211307048798, 0.165623277425766]], [[0.16661912202835083, 0.1700148582458496, 0.1696653962135315, 0.16931666433811188, 0.16896863281726837, 0.15541525185108185], [0.16653572022914886, 0.17164452373981476, 0.1711164116859436, 0.17058990895748138, 0.1700650453567505, 0.15004834532737732], [0.16654600203037262, 0.17147943377494812, 0.17096967995166779, 0.17046143114566803, 0.16995471715927124, 0.15058869123458862], [0.16655589640140533, 0.17131412029266357, 0.17082269489765167, 0.17033268511295319, 0.16984406113624573, 0.15113064646720886], [0.16656535863876343, 0.17114850878715515, 0.1706753820180893, 0.1702035516500473, 0.16973304748535156, 0.15167415142059326], [0.16659808158874512, 0.16420525312423706, 0.16444769501686096, 0.1646905094385147, 0.1649336814880371, 0.17512482404708862]], [[0.17252930998802185, 0.16470344364643097, 0.17368386685848236, 0.15268707275390625, 0.17484615743160248, 0.16155017912387848], [0.16999667882919312, 0.16560295224189758, 0.17063747346401215, 0.1586751937866211, 0.17128068208694458, 0.1638069599866867], [0.17289015650749207, 0.16456876695156097, 0.17411985993385315, 0.15184010565280914, 0.17535829544067383, 0.16122277081012726], [0.1657879501581192, 0.16692522168159485, 0.16562519967556, 0.16879795491695404, 0.16546258330345154, 0.16740110516548157], [0.1732502430677414, 0.16443277895450592, 0.17455540597438812, 0.15099650621414185, 0.1758703887462616, 0.16089463233947754], [0.16893143951892853, 0.16595779359340668, 0.16936306655406952, 0.16121695935726166, 0.16979576647281647, 0.16473498940467834]], [[0.16952310502529144, 0.16440097987651825, 0.16406305134296417, 0.1637258380651474, 0.17191356420516968, 0.16637352108955383], [0.1673620641231537, 0.16611793637275696, 0.16603483259677887, 0.16595175862312317, 0.16793297231197357, 0.16660048067569733], [0.1672169715166092, 0.16623257100582123, 0.166166752576828, 0.16610097885131836, 0.1676681786775589, 0.1666145622730255], [0.1670718640089035, 0.16634716093540192, 0.16629865765571594, 0.16625018417835236, 0.1674036681652069, 0.16662850975990295], [0.17050768435001373, 0.1636127531528473, 0.16316045820713043, 0.16270941495895386, 0.17375034093856812, 0.16625934839248657], [0.1682027131319046, 0.16545215249061584, 0.16526930034160614, 0.16508665680885315, 0.16947321593761444, 0.1665160357952118]], [[0.16702373325824738, 0.16789723932743073, 0.16535991430282593, 0.16777145862579346, 0.16677355766296387, 0.16517412662506104], [0.16835114359855652, 0.17269083857536316, 0.16032510995864868, 0.17206048965454102, 0.16712437570095062, 0.15944810211658478], [0.16422155499458313, 0.15879212319850922, 0.17516782879829407, 0.15956102311611176, 0.1658158153295517, 0.17644168436527252], [0.16816608607769012, 0.1720002293586731, 0.16104501485824585, 0.17144401371479034, 0.16708020865917206, 0.16026444733142853], [0.16662530601024628, 0.16652561724185944, 0.1668168008327484, 0.16653993725776672, 0.16665396094322205, 0.16683831810951233], [0.1638864278793335, 0.15777850151062012, 0.176279678940773, 0.15864187479019165, 0.16568492352962494, 0.1777285784482956]]], "__all_modules__": {"num_env_steps_trained": 36000, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 107730, "num_env_steps_trained_lifetime": 324000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 4664.041345065881, "num_module_steps_trained_throughput": 25903210.210250646, "num_module_steps_trained_lifetime_throughput": 13281055.844806155}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4887942430001903e-05, "normalize_and_clip_actions": 7.905345568829157e-06, "remove_single_ts_time_rank_from_batch": 1.1662526755263961e-05, "listify_data_for_vector_env": 1.0419527488697132e-05, "get_actions": 3.52543018613652e-05, "un_batch_to_individual_items": 6.509229235471715e-06}}, "connector_pipeline_timer": 0.00011228625342764252}, "episode_duration_sec_mean": 0.005169456637231633, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7376748033087607e-06, "numpy_to_tensor": 1.1901486909091366e-05, "add_time_dim_to_batch_and_zero_pad": 6.779712849481648e-06, "batch_individual_items": 1.2271352706632442e-05, "add_states_from_episodes_to_batch": 2.66107305305823e-06}}, "connector_pipeline_timer": 5.805048906217504e-05}, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "num_episodes_lifetime": 180, "num_env_steps_sampled_lifetime": 45400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": -0.35}, "episode_return_max": 14.5, "env_step_timer": 1.3764967009479972e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "rlmodule_inference_timer": 3.0303976662525103e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_mean": -0.35, "env_reset_timer": 0.00031105404586546893, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_min": -12.5, "agent_episode_returns_mean": {"default_agent": -0.35}, "weights_seq_no": 9.0, "sample": 0.11467043254826915, "episode_len_max": 20, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "time_between_sampling": 9.374782577472546}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "b483a_00000", "date": "2025-08-11_18-54-18", "timestamp": 1754931258, "time_this_iter_s": 9.881708860397339, "time_total_s": 86.05772376060486, "pid": 11892, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fcf98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 86.05772376060486, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 40.57857142857143, "ram_util_percent": 78.83571428571427}}
{"timers": {"training_iteration": 9.3955336037211, "restore_env_runners": 1.0721005429588888e-05, "training_step": 9.39538356301933, "env_runner_sampling_timer": 1.6082420981980283, "learner_update_timer": 7.596650854147895, "synch_weights": 0.001087864833315207, "restore_eval_env_runners": 1.0371863042155878e-05, "evaluation_iteration": 0.12219327281974587, "synch_eval_env_connectors": 0.00014802084555887542, "synch_env_connectors": 4.414217228754483e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00011758260000023526, "timers": {"connectors": {"get_actions": 3.92141376562176e-05, "un_batch_to_individual_items": 6.586471887601772e-06, "remove_single_ts_time_rank_from_batch": 1.1812182095562263e-05, "tensor_to_numpy": 1.5091701593820058e-05, "normalize_and_clip_actions": 7.982917435987945e-06, "listify_data_for_vector_env": 1.0337543925516503e-05}}}, "time_between_sampling": 0.033867985043753164, "num_env_steps_sampled_lifetime": -4930000.0, "module_episode_returns_mean": {"default_policy": -0.4600000000000001}, "num_episodes": 250.0, "env_reset_timer": 3.536635070840434e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.796668371700133e-06, "numpy_to_tensor": 1.2389064166889898e-05, "batch_individual_items": 1.2470333372438198e-05, "add_states_from_episodes_to_batch": 2.7236995142284977e-06, "add_time_dim_to_batch_and_zero_pad": 7.008353129452985e-06}}, "connector_pipeline_timer": 5.934307936870647e-05}, "episode_return_max": 10.5, "env_step_timer": 1.389017750484709e-05, "rlmodule_inference_timer": 3.170565934767556e-05, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -9.5, "agent_episode_returns_mean": {"default_agent": -0.4600000000000001}, "episode_return_mean": -0.4600000000000001, "episode_duration_sec_mean": 0.005255147016607226, "weights_seq_no": 9.0, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "num_episodes_lifetime": -246500.0, "sample": 0.005575304129568204, "num_env_steps_sampled_lifetime_throughput": 3282.6090827946227}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15235515481442666, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008935387248667949, "add_observations_from_episodes_to_batch": 0.0009008073617945019, "add_columns_from_episodes_to_train_batch": 0.041484276419768894, "add_time_dim_to_batch_and_zero_pad": 0.08966323777171963, "add_states_from_episodes_to_batch": 0.0036511349921321337, "batch_individual_items": 0.007508928464107848, "numpy_to_tensor": 6.0657389673751124e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 59850, "weights_seq_no": 10.0, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained": 5985, "module_train_batch_size_mean": 998.3173215714437, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 771.7787608384906}, "default_policy": {"num_module_steps_trained_lifetime": 59850, "mean_kl_loss": 2.7683259759214707e-05, "vf_loss": 0.32051125168800354, "weights_seq_no": 10.0, "policy_loss": -0.0005132115911692381, "module_train_batch_size_mean": 998.3173215714437, "use_intrinsic_rewards": 0.0, "entropy": 0.6922572255134583, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5985, "vf_explained_var": 2.372264862060547e-05, "vf_loss_unclipped": 41.77225875854492, "total_loss": 0.24811317026615143, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.00015779680688865483, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 771.7697902608677}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "policy_loss": -0.000490801758132875, "use_intrinsic_rewards": 1.0, "entropy": 0.6922436356544495, "module_train_batch_size_mean": 997.532914147147, "total_loss": 0.24818582832813263, "diff_num_grad_updates_vs_sampler_policy": 51.0, "vf_explained_var": -0.001324295997619629, "num_module_steps_trained_lifetime": 359100, "mean_kl_loss": 2.5319513952126727e-05, "vf_loss_unclipped": 41.83576202392578, "vf_loss": 0.3205704689025879, "weights_seq_no": 60.0}, "__all_modules__": {"num_module_steps_trained_lifetime": 718200, "num_env_steps_trained_lifetime": 2160000, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 55713.02466031761}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 51.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 359100, "weights_seq_no": 60.0, "module_train_batch_size_mean": 997.532914147147, "num_module_steps_trained": 35910}}}, "IntrinsicAttentionMask": [[[0.16766996681690216, 0.1677577793598175, 0.16568753123283386, 0.16577430069446564, 0.165861114859581, 0.167249396443367], [0.1678701788187027, 0.16797563433647156, 0.16549231112003326, 0.16559627652168274, 0.165700301527977, 0.16736525297164917], [0.16313329339027405, 0.16283197700977325, 0.17013019323349, 0.16981595754623413, 0.16950231790542603, 0.16458632051944733], [0.1633324772119522, 0.16304782032966614, 0.16993430256843567, 0.16963814198970795, 0.1693425178527832, 0.16470475494861603], [0.16353170573711395, 0.16326375305652618, 0.16973844170570374, 0.16946032643318176, 0.1691826581954956, 0.16482308506965637], [0.16671009361743927, 0.1667138636112213, 0.1666242629289627, 0.16662803292274475, 0.166631817817688, 0.16669195890426636]], [[0.16676722466945648, 0.16763938963413239, 0.16664229333400726, 0.16751380264759064, 0.16498227417469025, 0.16645506024360657], [0.16711482405662537, 0.17142264544963837, 0.16650483012199402, 0.1707969307899475, 0.15856681764125824, 0.16559402644634247], [0.1667117327451706, 0.1670970916748047, 0.16665643453598022, 0.16704165935516357, 0.16591954231262207, 0.16657352447509766], [0.16706901788711548, 0.17087814211845398, 0.16652874648571014, 0.17032556235790253, 0.15947701036930084, 0.1657216101884842], [0.1658354550600052, 0.1598871499300003, 0.1667080968618393, 0.16072848439216614, 0.17881512641906738, 0.1680256724357605], [0.16662587225437164, 0.16628429293632507, 0.16667500138282776, 0.16633331775665283, 0.16733276844024658, 0.1667487472295761]], [[0.16666701436042786, 0.17006371915340424, 0.16971415281295776, 0.1609674096107483, 0.16901719570159912, 0.16357049345970154], [0.16664163768291473, 0.1717536896467209, 0.17122523486614227, 0.1581798940896988, 0.17017319798469543, 0.1620263010263443], [0.16664500534534454, 0.17158137261867523, 0.17107132077217102, 0.15846268832683563, 0.17005574703216553, 0.16218388080596924], [0.16667090356349945, 0.16714803874492645, 0.16709932684898376, 0.16585120558738708, 0.16700191795825958, 0.16622860729694366], [0.16665118932724, 0.17123670876026154, 0.17076334357261658, 0.1590293049812317, 0.16982051730155945, 0.16249896585941315], [0.16667540371418, 0.1684923768043518, 0.1683061718940735, 0.16358764469623566, 0.1679343730211258, 0.16500402987003326]], [[0.17238299548625946, 0.1515434831380844, 0.17353656888008118, 0.1525576114654541, 0.1746978759765625, 0.17528143525123596], [0.16540677845478058, 0.16994120180606842, 0.16517537832260132, 0.16970345377922058, 0.16494430601596832, 0.16482888162136078], [0.1727248579263687, 0.1506236344575882, 0.17395338416099548, 0.15169495344161987, 0.17519064247608185, 0.17581255733966827], [0.1657848209142685, 0.16896064579486847, 0.1656220704317093, 0.16879476606845856, 0.16545946896076202, 0.16537822782993317], [0.17306478321552277, 0.14970707893371582, 0.17436853051185608, 0.15083488821983337, 0.17568211257457733, 0.17634260654449463], [0.1732339859008789, 0.1492500603199005, 0.17457547783851624, 0.15040580928325653, 0.17592735588550568, 0.17660722136497498]], [[0.1694735735654831, 0.16435293853282928, 0.16401512920856476, 0.17221732437610626, 0.17186333239078522, 0.15807776153087616], [0.1673591434955597, 0.16611504554748535, 0.16603194177150726, 0.16801409423351288, 0.16793003678321838, 0.16454976797103882], [0.16721513867378235, 0.16623075306415558, 0.16616494953632355, 0.16773274540901184, 0.16766634583473206, 0.16499005258083344], [0.1705554872751236, 0.1634039580821991, 0.16293522715568542, 0.174422949552536, 0.173922598361969, 0.15475982427597046], [0.17041781544685364, 0.1635265201330185, 0.16307446360588074, 0.17414017021656036, 0.17365877330303192, 0.15518221259117126], [0.164589062333107, 0.1682501584291458, 0.16849857568740845, 0.1627044826745987, 0.1629447191953659, 0.17301295697689056]], [[0.17056304216384888, 0.16540414094924927, 0.17131738364696503, 0.15731805562973022, 0.16294220089912415, 0.17245513200759888], [0.16800571978092194, 0.16625447571277618, 0.16825884580612183, 0.1634356528520584, 0.16540604829788208, 0.16863925755023956], [0.17092731595039368, 0.1652761846780777, 0.17175498604774475, 0.1564522683620453, 0.16258518397808075, 0.17300401628017426], [0.1637532114982605, 0.16748672723770142, 0.16322365403175354, 0.17376333475112915, 0.16934050619602203, 0.16243255138397217], [0.16674339771270752, 0.1666436642408371, 0.166757732629776, 0.16648098826408386, 0.1665949821472168, 0.16677924990653992], [0.1714721918106079, 0.16508154571056366, 0.1724104881286621, 0.1551598459482193, 0.16204829514026642, 0.17382758855819702]]], "__all_modules__": {"num_env_steps_trained": 36000, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 119700, "num_env_steps_trained_lifetime": 360000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 4646.808575458445, "num_module_steps_trained_throughput": 25240234.995069277, "num_module_steps_trained_lifetime_throughput": 13262159.652507948}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5095812136010742e-05, "normalize_and_clip_actions": 7.842472890453294e-06, "remove_single_ts_time_rank_from_batch": 1.1851886247331909e-05, "listify_data_for_vector_env": 1.0335008058770255e-05, "get_actions": 3.51969327173019e-05, "un_batch_to_individual_items": 6.503932838375128e-06}}, "connector_pipeline_timer": 0.00011280147785953949}, "episode_duration_sec_mean": 0.005166141255758702, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7478160542004704e-06, "numpy_to_tensor": 1.1772781874725356e-05, "add_time_dim_to_batch_and_zero_pad": 6.767065021402874e-06, "batch_individual_items": 1.2270722000996217e-05, "add_states_from_episodes_to_batch": 2.6285045518525895e-06}}, "connector_pipeline_timer": 5.786341723287084e-05}, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "num_episodes_lifetime": 200, "num_env_steps_sampled_lifetime": 50400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 0.05}, "episode_return_max": 14.5, "env_step_timer": 1.3792851894359755e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "rlmodule_inference_timer": 3.0500323335429753e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_mean": 0.05, "env_reset_timer": 0.00030911517439826075, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_min": -12.5, "agent_episode_returns_mean": {"default_agent": 0.05}, "weights_seq_no": 10.0, "sample": 0.11463541822318454, "episode_len_max": 20, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "time_between_sampling": 9.374061427117935}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "b483a_00000", "date": "2025-08-11_18-54-27", "timestamp": 1754931267, "time_this_iter_s": 9.396927833557129, "time_total_s": 95.45465159416199, "pid": 11892, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fcf98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 95.45465159416199, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 34.59230769230769, "ram_util_percent": 78.93076923076923}}
{"timers": {"training_iteration": 9.395127964354268, "restore_env_runners": 1.0672965790917975e-05, "training_step": 9.394977424889461, "env_runner_sampling_timer": 1.607929978885884, "learner_update_timer": 7.596485414355694, "synch_weights": 0.0010855153453866327, "restore_eval_env_runners": 1.0328985387227512e-05, "evaluation_iteration": 0.12214042342069888, "synch_eval_env_connectors": 0.00014757938773688405, "synch_env_connectors": 4.410905402291299e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00011578398015447306, "timers": {"connectors": {"get_actions": 3.825435118616507e-05, "un_batch_to_individual_items": 6.5099756182746816e-06, "remove_single_ts_time_rank_from_batch": 1.1753327997657274e-05, "tensor_to_numpy": 1.487730689194e-05, "normalize_and_clip_actions": 7.886733848720019e-06, "listify_data_for_vector_env": 1.020939619213699e-05}}}, "time_between_sampling": 0.031884872455951986, "num_env_steps_sampled_lifetime": -5547500.0, "module_episode_returns_mean": {"default_policy": -0.4600000000000001}, "num_episodes": 250.0, "env_reset_timer": 3.367477697257511e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7662499293809756e-06, "numpy_to_tensor": 2.614994224194597e-05, "batch_individual_items": 1.2303291714514822e-05, "add_states_from_episodes_to_batch": 2.704324384979584e-06, "add_time_dim_to_batch_and_zero_pad": 6.952484934533261e-06}}, "connector_pipeline_timer": 7.271851890271933e-05}, "episode_return_max": 10.5, "env_step_timer": 1.3674275157579965e-05, "rlmodule_inference_timer": 3.111321054621494e-05, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -9.5, "agent_episode_returns_mean": {"default_agent": -0.4600000000000001}, "episode_return_mean": -0.4600000000000001, "episode_duration_sec_mean": 0.005499378342647107, "weights_seq_no": 10.0, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "num_episodes_lifetime": -277375.0, "sample": 0.005819705894117188, "num_env_steps_sampled_lifetime_throughput": 3308.846294019931}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15233671743700505, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008931978795449953, "add_observations_from_episodes_to_batch": 0.000899985539101621, "add_columns_from_episodes_to_train_batch": 0.041477663235487426, "add_time_dim_to_batch_and_zero_pad": 0.0896555891433213, "add_states_from_episodes_to_batch": 0.0036515190628459314, "batch_individual_items": 0.0075091200099636915, "numpy_to_tensor": 6.068789629740507e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 65835, "weights_seq_no": 11.0, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained": 5985, "module_train_batch_size_mean": 998.2690509307901, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 769.1255996921669}, "default_policy": {"num_module_steps_trained_lifetime": 65835, "mean_kl_loss": 1.4303598618425895e-05, "vf_loss": 0.32050931453704834, "weights_seq_no": 11.0, "policy_loss": -0.0002261978661408648, "module_train_batch_size_mean": 998.2690509307901, "use_intrinsic_rewards": 0.0, "entropy": 0.6924856305122375, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5985, "vf_explained_var": -2.300739288330078e-05, "vf_loss_unclipped": 41.192508697509766, "total_loss": 0.24839834868907928, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 7.889840344432741e-05, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 769.117158226128}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "policy_loss": -0.0002181861927965656, "use_intrinsic_rewards": 1.0, "entropy": 0.692478597164154, "module_train_batch_size_mean": 997.5206335045569, "total_loss": 0.2484491914510727, "diff_num_grad_updates_vs_sampler_policy": 56.0, "vf_explained_var": -0.001295328140258789, "num_module_steps_trained_lifetime": 395010, "mean_kl_loss": 1.3287905858305749e-05, "vf_loss_unclipped": 41.28689193725586, "vf_loss": 0.32056158781051636, "weights_seq_no": 66.0}, "__all_modules__": {"num_module_steps_trained_lifetime": 790020, "num_env_steps_trained_lifetime": 2376000, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 54759.05524747705}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 56.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 395010, "weights_seq_no": 66.0, "module_train_batch_size_mean": 997.5206335045569, "num_module_steps_trained": 35910}}}, "IntrinsicAttentionMask": [[[0.16694523394107819, 0.164885014295578, 0.16497136652469635, 0.16720767319202423, 0.16729524731636047, 0.16869553923606873], [0.16553562879562378, 0.1733839213848114, 0.17304560542106628, 0.16456852853298187, 0.16424742341041565, 0.1592189222574234], [0.1655997335910797, 0.17302200198173523, 0.17270243167877197, 0.16468384861946106, 0.16437967121601105, 0.1596122682094574], [0.16710691154003143, 0.16382291913032532, 0.1639600694179535, 0.1675269603729248, 0.1676672250032425, 0.16991598904132843], [0.16715994477272034, 0.16346953809261322, 0.16362348198890686, 0.16763263940811157, 0.1677905172109604, 0.17032386362552643], [0.16794787347316742, 0.15789024531841278, 0.15830188989639282, 0.16926494240760803, 0.16970625519752502, 0.1768888384103775]], [[0.16541875898838043, 0.1636924147605896, 0.16878333687782288, 0.16702187061309814, 0.16591820120811462, 0.16916538774967194], [0.16781440377235413, 0.16945751011371613, 0.16470526158809662, 0.1663179248571396, 0.16734518110752106, 0.16435973346233368], [0.1606970727443695, 0.1529625803232193, 0.17665457725524902, 0.16815203428268433, 0.16299115121364594, 0.1785426288843155], [0.1631765216588974, 0.15849760174751282, 0.17254723608493805, 0.1675996333360672, 0.1645464152097702, 0.17363253235816956], [0.16472187638282776, 0.16205772757530212, 0.1699584722518921, 0.16720964014530182, 0.16549549996852875, 0.17055678367614746], [0.1601574867963791, 0.15178558230400085, 0.17754124104976654, 0.1682606339454651, 0.162647545337677, 0.17960749566555023]], [[0.16808146238327026, 0.1630028933286667, 0.1711544692516327, 0.17080266773700714, 0.16199982166290283, 0.16495868563652039], [0.16701677441596985, 0.16577522456645966, 0.16775430738925934, 0.1676703840494156, 0.16552653908729553, 0.16625677049160004], [0.16869230568408966, 0.16136744618415833, 0.1731729954481125, 0.17265820503234863, 0.15993262827396393, 0.16417638957500458], [0.16862359642982483, 0.16155309975147247, 0.1729433685541153, 0.17244726419448853, 0.16016680002212524, 0.16426581144332886], [0.16679802536964417, 0.16633333265781403, 0.1670730710029602, 0.1670418083667755, 0.16623997688293457, 0.1665138155221939], [0.16743513941764832, 0.16469712555408478, 0.16907334327697754, 0.16888649761676788, 0.16415168344974518, 0.16575615108013153]], [[0.17367029190063477, 0.15947869420051575, 0.16518008708953857, 0.16018401086330414, 0.17520983517169952, 0.16627709567546844], [0.1609189659357071, 0.17269782721996307, 0.16774344444274902, 0.17206746339797974, 0.15974637866020203, 0.16682586073875427], [0.16614297032356262, 0.1672111600637436, 0.16677019000053406, 0.1671556979417801, 0.16603277623653412, 0.1666872352361679], [0.1615726500749588, 0.17200571298599243, 0.16762763261795044, 0.1714494675397873, 0.16052934527397156, 0.1668151617050171], [0.1750032603740692, 0.15812993049621582, 0.16487590968608856, 0.15896202623844147, 0.1768498718738556, 0.16617900133132935], [0.1671324372291565, 0.166183203458786, 0.1665736734867096, 0.16623221337795258, 0.167231023311615, 0.16664735972881317]], [[0.16666413843631744, 0.17006078362464905, 0.16971123218536377, 0.1693623960018158, 0.16063377261161804, 0.1635676771402359], [0.16663521528244019, 0.17174707353115082, 0.1712186485528946, 0.1706918329000473, 0.15768712759017944, 0.16202008724212646], [0.16663901507854462, 0.17157520353794098, 0.17106515169143677, 0.17055663466453552, 0.15798595547676086, 0.16217805445194244], [0.16664260625839233, 0.17140330374240875, 0.17091161012649536, 0.17042134702205658, 0.15828514099121094, 0.16233600676059723], [0.16666953265666962, 0.16697558760643005, 0.16694433987140656, 0.16691312193870544, 0.16611190140247345, 0.16638553142547607], [0.16667458415031433, 0.16849154233932495, 0.16830533742904663, 0.16811932623386383, 0.16340602934360504, 0.1650032252073288]], [[0.16491158306598663, 0.16625897586345673, 0.16826583445072174, 0.16650977730751038, 0.16851966083049774, 0.16553419828414917], [0.1623012274503708, 0.16563133895397186, 0.17066670954227448, 0.16625568270683289, 0.17131002247333527, 0.16383500397205353], [0.15848635137081146, 0.164667546749115, 0.17422433197498322, 0.16583876311779022, 0.1754635125398636, 0.1613195240497589], [0.1618196964263916, 0.16551275551319122, 0.171112522482872, 0.16620606184005737, 0.17182928323745728, 0.16351962089538574], [0.15801002085208893, 0.1645432561635971, 0.17467264831066132, 0.16578282415866852, 0.17598852515220642, 0.16100271046161652], [0.1637004166841507, 0.16597095131874084, 0.1693764477968216, 0.16639497876167297, 0.16980919241905212, 0.16474802792072296]]], "__all_modules__": {"num_env_steps_trained": 36000, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 131670, "num_env_steps_trained_lifetime": 396000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 4630.674792886538, "num_module_steps_trained_throughput": 24611371.636185274, "num_module_steps_trained_lifetime_throughput": 13245985.986160202}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4764366064343866e-05, "normalize_and_clip_actions": 7.809256435697361e-06, "remove_single_ts_time_rank_from_batch": 1.1685374065274606e-05, "listify_data_for_vector_env": 1.0260368828610555e-05, "get_actions": 3.488385973213131e-05, "un_batch_to_individual_items": 6.42009795271537e-06}}, "connector_pipeline_timer": 0.0001113636128245291}, "episode_duration_sec_mean": 0.00516294583096169, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.738441958727998e-06, "numpy_to_tensor": 1.1714718074856185e-05, "add_time_dim_to_batch_and_zero_pad": 6.923035134963256e-06, "batch_individual_items": 1.2294597876578233e-05, "add_states_from_episodes_to_batch": 2.668364105005638e-06}}, "connector_pipeline_timer": 5.8240714459658005e-05}, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "num_episodes_lifetime": 220, "num_env_steps_sampled_lifetime": 55400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 0.05}, "episode_return_max": 14.5, "env_step_timer": 1.3651268006531232e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "rlmodule_inference_timer": 3.021469220364206e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_mean": 0.05, "env_reset_timer": 0.0003068365224382113, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_min": -12.5, "agent_episode_returns_mean": {"default_agent": 0.05}, "weights_seq_no": 11.0, "sample": 0.11460266945174463, "episode_len_max": 20, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "time_between_sampling": 9.374094879096361}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "b483a_00000", "date": "2025-08-11_18-54-37", "timestamp": 1754931277, "time_this_iter_s": 9.474353313446045, "time_total_s": 104.92900490760803, "pid": 11892, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fcf98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 104.92900490760803, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 36.607142857142854, "ram_util_percent": 79.17857142857143}}
{"timers": {"training_iteration": 9.393922168051422, "restore_env_runners": 1.0618737114846306e-05, "training_step": 9.393771170220093, "env_runner_sampling_timer": 1.6077569761772441, "learner_update_timer": 7.595374946042832, "synch_weights": 0.0010840976910349714, "restore_eval_env_runners": 1.0300694940289021e-05, "evaluation_iteration": 0.12208533502658343, "synch_eval_env_connectors": 0.00014722984457730414, "synch_env_connectors": 4.410966649675961e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00011667043522054189, "timers": {"connectors": {"get_actions": 3.864652224459572e-05, "un_batch_to_individual_items": 6.523652034677054e-06, "remove_single_ts_time_rank_from_batch": 1.1792890740352596e-05, "tensor_to_numpy": 1.5031208375119943e-05, "normalize_and_clip_actions": 7.95264096588868e-06, "listify_data_for_vector_env": 1.0288134509626814e-05}}}, "time_between_sampling": 0.03236038376384032, "num_env_steps_sampled_lifetime": -6165000.0, "module_episode_returns_mean": {"default_policy": -0.9399999999999996}, "num_episodes": 250.0, "env_reset_timer": 3.366864491746302e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7852847497523036e-06, "numpy_to_tensor": 1.2336624883458414e-05, "batch_individual_items": 1.2423514428078551e-05, "add_states_from_episodes_to_batch": 2.7226314528598076e-06, "add_time_dim_to_batch_and_zero_pad": 6.9985247430996505e-06}}, "connector_pipeline_timer": 5.9161120121430535e-05}, "episode_return_max": 10.5, "env_step_timer": 1.3821451651285557e-05, "rlmodule_inference_timer": 3.154761791090224e-05, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -9.5, "agent_episode_returns_mean": {"default_agent": -0.9399999999999996}, "episode_return_mean": -0.9399999999999996, "episode_duration_sec_mean": 0.005216598325874655, "weights_seq_no": 11.0, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "num_episodes_lifetime": -308250.0, "sample": 0.005614013390773062, "num_env_steps_sampled_lifetime_throughput": 3291.8198719745137}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1523091227626918, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008927145677589064, "add_observations_from_episodes_to_batch": 0.0008988911036265193, "add_columns_from_episodes_to_train_batch": 0.04147118160263887, "add_time_dim_to_batch_and_zero_pad": 0.0896406057515265, "add_states_from_episodes_to_batch": 0.003652983041500534, "batch_individual_items": 0.00750761089052258, "numpy_to_tensor": 6.092726708431503e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 71820, "weights_seq_no": 12.0, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained": 5985, "module_train_batch_size_mean": 998.2236050808158, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 766.7344334516382}, "default_policy": {"num_module_steps_trained_lifetime": 71820, "mean_kl_loss": 1.644314033910632e-05, "vf_loss": 0.320509135723114, "weights_seq_no": 12.0, "policy_loss": -0.00023416023759637028, "module_train_batch_size_mean": 998.2236050808158, "use_intrinsic_rewards": 0.0, "entropy": 0.6926753520965576, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5985, "vf_explained_var": 7.790327072143555e-05, "vf_loss_unclipped": 41.194026947021484, "total_loss": 0.24838992953300476, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 3.944920172216371e-05, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 766.7265054482071}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "policy_loss": -0.00022638296650256962, "use_intrinsic_rewards": 1.0, "entropy": 0.6926701068878174, "module_train_batch_size_mean": 997.512081102731, "total_loss": 0.24843306839466095, "diff_num_grad_updates_vs_sampler_policy": 61.0, "vf_explained_var": -0.0012149810791015625, "num_module_steps_trained_lifetime": 430920, "mean_kl_loss": 1.5452851584996097e-05, "vf_loss_unclipped": 41.28375244140625, "vf_loss": 0.3205513060092926, "weights_seq_no": 72.0}, "__all_modules__": {"num_module_steps_trained_lifetime": 861840, "num_env_steps_trained_lifetime": 2592000, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 53842.586680978755}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 61.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 430920, "weights_seq_no": 72.0, "module_train_batch_size_mean": 997.512081102731, "num_module_steps_trained": 35910}}}, "IntrinsicAttentionMask": [[[0.16666701436042786, 0.17006371915340424, 0.16971415281295776, 0.1609674096107483, 0.16901719570159912, 0.16357050836086273], [0.16664165258407593, 0.17175370454788208, 0.17122524976730347, 0.1581798940896988, 0.17017321288585663, 0.1620263308286667], [0.16664500534534454, 0.17158137261867523, 0.17107130587100983, 0.15846268832683563, 0.17005574703216553, 0.16218389570713043], [0.16667090356349945, 0.16714803874492645, 0.16709932684898376, 0.16585120558738708, 0.16700191795825958, 0.16622860729694366], [0.16665118932724, 0.17123670876026154, 0.17076332867145538, 0.1590292900800705, 0.16982051730155945, 0.16249896585941315], [0.16667540371418, 0.1684923768043518, 0.1683061718940735, 0.16358762979507446, 0.1679343730211258, 0.16500402987003326]], [[0.16490431129932404, 0.163183331489563, 0.1682584136724472, 0.1665024310350418, 0.1685122400522232, 0.16863928735256195], [0.16829746961593628, 0.16994531452655792, 0.16517938673496246, 0.1667966991662979, 0.16494829952716827, 0.16483287513256073], [0.15833474695682526, 0.1507139503955841, 0.17405766248703003, 0.16568011045455933, 0.1752956509590149, 0.17591795325279236], [0.16176535189151764, 0.15712690353393555, 0.17105503380298615, 0.16615022718906403, 0.1717715561389923, 0.17213094234466553], [0.15784074366092682, 0.14980755746364594, 0.17448553442955017, 0.16560521721839905, 0.17579999566078186, 0.17646093666553497], [0.15759366750717163, 0.14935578405857086, 0.17469914257526398, 0.16556710004806519, 0.17605197429656982, 0.17673231661319733]], [[0.16661912202835083, 0.1700148582458496, 0.1696653962135315, 0.16931666433811188, 0.16896863281726837, 0.15541526675224304], [0.16653572022914886, 0.17164452373981476, 0.1711163967847824, 0.17058990895748138, 0.1700650453567505, 0.1500483602285385], [0.16654600203037262, 0.17147943377494812, 0.17096967995166779, 0.17046143114566803, 0.16995471715927124, 0.15058870613574982], [0.16655589640140533, 0.17131412029266357, 0.17082269489765167, 0.17033268511295319, 0.16984406113624573, 0.15113066136837006], [0.16656535863876343, 0.17114850878715515, 0.1706753820180893, 0.1702035516500473, 0.16973304748535156, 0.15167416632175446], [0.16659806668758392, 0.16420525312423706, 0.16444770991802216, 0.1646905094385147, 0.1649336814880371, 0.17512479424476624]], [[0.16702383756637573, 0.16789734363555908, 0.1653600037097931, 0.16777156293392181, 0.16523611545562744, 0.16671118140220642], [0.16835340857505798, 0.1726931482553482, 0.1603272706270218, 0.17206279933452606, 0.15974204242229462, 0.16682133078575134], [0.16422560811042786, 0.1587960422039032, 0.1751721352338791, 0.15956497192382812, 0.17602036893367767, 0.16622087359428406], [0.1681678742170334, 0.17200204730033875, 0.16104672849178314, 0.171445831656456, 0.16052593290805817, 0.16681161522865295], [0.1640033721923828, 0.158120796084404, 0.1759139746427536, 0.15895284712314606, 0.1768396496772766, 0.1661694049835205], [0.16652454435825348, 0.16618317365646362, 0.16718170046806335, 0.166232168674469, 0.1672309935092926, 0.16664732992649078]], [[0.16803570091724396, 0.1629585176706314, 0.17110787332057953, 0.17075616121292114, 0.17040517926216125, 0.1567365825176239], [0.16701406240463257, 0.16577252745628357, 0.16775158047676086, 0.16766765713691711, 0.16758377850055695, 0.1642104834318161], [0.1685969978570938, 0.16127626597881317, 0.17307515442371368, 0.1725606620311737, 0.1720476895570755, 0.15244320034980774], [0.16853481531143188, 0.1614680290222168, 0.1728523075580597, 0.1723564714193344, 0.17186205089092255, 0.15292631089687347], [0.16847223043441772, 0.1616596132516861, 0.17262931168079376, 0.1721520870923996, 0.17167618870735168, 0.15341056883335114], [0.16558821499347687, 0.1692715287208557, 0.16345086693763733, 0.16369220614433289, 0.1639339029788971, 0.17406325042247772]], [[0.1749340444803238, 0.15378613770008087, 0.17610469460487366, 0.16811665892601013, 0.16325652599334717, 0.1638018637895584], [0.16493766009807587, 0.16945920884609222, 0.16470690071582794, 0.1663195937871933, 0.16734686493873596, 0.1672297567129135], [0.17545314133167267, 0.1530028134584427, 0.17670105397701263, 0.16819626092910767, 0.16303400695323944, 0.16361278295516968], [0.17184311151504517, 0.15851201117038727, 0.17256294190883636, 0.1676148772239685, 0.16456137597560883, 0.16490568220615387], [0.1695655733346939, 0.16206234693527222, 0.1699633002281189, 0.16721439361572266, 0.165500208735466, 0.16569417715072632], [0.16982431709766388, 0.16165606677532196, 0.17025820910930634, 0.16726121306419373, 0.16539452970027924, 0.16560567915439606]]], "__all_modules__": {"num_env_steps_trained": 36000, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 143640, "num_env_steps_trained_lifetime": 432000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 4616.123466640348, "num_module_steps_trained_throughput": 24010694.970208157, "num_module_steps_trained_lifetime_throughput": 13226766.916518075}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4903451001089777e-05, "normalize_and_clip_actions": 7.800993075247606e-06, "remove_single_ts_time_rank_from_batch": 1.166978623916792e-05, "listify_data_for_vector_env": 1.0256957838858982e-05, "get_actions": 3.478818277926428e-05, "un_batch_to_individual_items": 6.425512158390663e-06}}, "connector_pipeline_timer": 0.00011171779606198992}, "episode_duration_sec_mean": 0.005156184560619294, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7092385847084664e-06, "numpy_to_tensor": 1.1729226764393825e-05, "add_time_dim_to_batch_and_zero_pad": 6.858353400460792e-06, "batch_individual_items": 1.2225436846320376e-05, "add_states_from_episodes_to_batch": 2.626488133860061e-06}}, "connector_pipeline_timer": 5.800835702802317e-05}, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "num_episodes_lifetime": 240, "num_env_steps_sampled_lifetime": 60400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 0.45}, "episode_return_max": 14.5, "env_step_timer": 1.3649551383467385e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "rlmodule_inference_timer": 2.9969041916253055e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_mean": 0.45, "env_reset_timer": 0.0003044781567993534, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_min": -12.5, "agent_episode_returns_mean": {"default_agent": 0.45}, "weights_seq_no": 12.0, "sample": 0.1145597890068884, "episode_len_max": 20, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "time_between_sampling": 9.373315589885866}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "b483a_00000", "date": "2025-08-11_18-54-46", "timestamp": 1754931286, "time_this_iter_s": 9.392991781234741, "time_total_s": 114.32199668884277, "pid": 11892, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fcf98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 114.32199668884277, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 35.37692307692308, "ram_util_percent": 79.15384615384616}}
{"timers": {"training_iteration": 9.388194358450306, "restore_env_runners": 1.0565879602626761e-05, "training_step": 9.388043261018097, "env_runner_sampling_timer": 1.6074351751655673, "learner_update_timer": 7.589910879501983, "synch_weights": 0.0010804400435596871, "restore_eval_env_runners": 1.0258517324847142e-05, "evaluation_iteration": 0.12202198709658704, "synch_eval_env_connectors": 0.00014682254609189402, "synch_env_connectors": 4.4047769459578895e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00011513522491926262, "timers": {"connectors": {"get_actions": 3.8126603872754434e-05, "un_batch_to_individual_items": 6.4305557885652946e-06, "remove_single_ts_time_rank_from_batch": 1.1642938219229026e-05, "tensor_to_numpy": 1.4881425770926428e-05, "normalize_and_clip_actions": 7.82429921905799e-06, "listify_data_for_vector_env": 1.0118315833433822e-05}}}, "time_between_sampling": 0.03204690109309448, "num_env_steps_sampled_lifetime": -6782500.0, "module_episode_returns_mean": {"default_policy": 0.4200000000000001}, "num_episodes": 250.0, "env_reset_timer": 3.310164631245698e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7551822341425447e-06, "numpy_to_tensor": 1.2135353678277783e-05, "batch_individual_items": 1.2196564481319492e-05, "add_states_from_episodes_to_batch": 2.6839839538843708e-06, "add_time_dim_to_batch_and_zero_pad": 6.9459695000187186e-06}}, "connector_pipeline_timer": 5.83199928194618e-05}, "episode_return_max": 10.5, "env_step_timer": 1.3596909616397892e-05, "rlmodule_inference_timer": 3.100300631601177e-05, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -9.5, "agent_episode_returns_mean": {"default_agent": 0.4200000000000001}, "episode_return_mean": 0.4200000000000001, "episode_duration_sec_mean": 0.005140872654505072, "weights_seq_no": 12.0, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "num_episodes_lifetime": -339125.0, "sample": 0.005506667340233825, "num_env_steps_sampled_lifetime_throughput": 3336.504565118875}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15228756445616676, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008924527140230419, "add_observations_from_episodes_to_batch": 0.0008979046924071934, "add_columns_from_episodes_to_train_batch": 0.04145962353626096, "add_time_dim_to_batch_and_zero_pad": 0.08963683386460679, "add_states_from_episodes_to_batch": 0.0036527782106135346, "batch_individual_items": 0.0075058206120573534, "numpy_to_tensor": 6.086424537146753e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 77805, "weights_seq_no": 13.0, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained": 5985, "module_train_batch_size_mean": 998.1808187151925, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 765.1444718050444}, "default_policy": {"num_module_steps_trained_lifetime": 77805, "mean_kl_loss": 3.1181949452729896e-05, "vf_loss": 0.32051125168800354, "weights_seq_no": 13.0, "policy_loss": -0.00045989887439645827, "module_train_batch_size_mean": 998.1808187151925, "use_intrinsic_rewards": 0.0, "entropy": 0.6928673386573792, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5985, "vf_explained_var": 8.26716423034668e-05, "vf_loss_unclipped": 42.07976531982422, "total_loss": 0.2481655329465866, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 1.9724600861081854e-05, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 765.1370324854221}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "policy_loss": -0.00044315424747765064, "use_intrinsic_rewards": 1.0, "entropy": 0.6928609013557434, "module_train_batch_size_mean": 997.5061250970534, "total_loss": 0.24820895493030548, "diff_num_grad_updates_vs_sampler_policy": 66.0, "vf_explained_var": -0.0010335445404052734, "num_module_steps_trained_lifetime": 466830, "mean_kl_loss": 2.901875450334046e-05, "vf_loss_unclipped": 42.11851119995117, "vf_loss": 0.3205394446849823, "weights_seq_no": 78.0}, "__all_modules__": {"num_module_steps_trained_lifetime": 933660, "num_env_steps_trained_lifetime": 2808000, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 52983.91466782231}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 66.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 466830, "weights_seq_no": 78.0, "module_train_batch_size_mean": 997.5061250970534, "num_module_steps_trained": 35910}}}, "IntrinsicAttentionMask": [[[0.17093321681022644, 0.16576847434043884, 0.16542774438858032, 0.1650877147912979, 0.17334355413913727, 0.15943926572799683], [0.1677054762840271, 0.16645881533622742, 0.166375532746315, 0.16629229485988617, 0.1682775616645813, 0.16489030420780182], [0.16748875379562378, 0.16650275886058807, 0.1664368361234665, 0.1663709431886673, 0.16794069111347198, 0.16526003181934357], [0.16727198660373688, 0.16654640436172485, 0.1664978563785553, 0.16644930839538574, 0.16760417819023132, 0.1656302809715271], [0.17240330576896667, 0.16543170809745789, 0.1649743765592575, 0.1645183116197586, 0.17568200826644897, 0.156990185379982], [0.16360042989253998, 0.16723954677581787, 0.16748647391796112, 0.16773377358913422, 0.1619659811258316, 0.17197374999523163]], [[0.1670253574848175, 0.16789887845516205, 0.16536152362823486, 0.1662263423204422, 0.1667751967906952, 0.1667127013206482], [0.16839013993740082, 0.17273083329200745, 0.16036224365234375, 0.16449600458145142, 0.16716310381889343, 0.1668577343225479], [0.16428880393505096, 0.15885715186595917, 0.17523956298828125, 0.16944585740566254, 0.16588371992111206, 0.16628484427928925], [0.16573350131511688, 0.16352982819080353, 0.1700465977191925, 0.16778557002544403, 0.16637222468852997, 0.16653229296207428], [0.16662533581256866, 0.16652564704418182, 0.1668168157339096, 0.1667170226573944, 0.16665399074554443, 0.16666114330291748], [0.16652479767799377, 0.16618341207504272, 0.16718195378780365, 0.16683922708034515, 0.16662301123142242, 0.16664758324623108]], [[0.16658765077590942, 0.1666748970746994, 0.16676218807697296, 0.16470420360565186, 0.16693690419197083, 0.1683342009782791], [0.16657106578350067, 0.16667571663856506, 0.16678042709827423, 0.16431476175785065, 0.16699004173278809, 0.1686679571866989], [0.166554257273674, 0.16667629778385162, 0.1667984277009964, 0.16392599046230316, 0.16704294085502625, 0.16900213062763214], [0.16688141226768494, 0.16659057140350342, 0.16630025207996368, 0.1733241081237793, 0.1657211184501648, 0.16118255257606506], [0.16651979088783264, 0.1666766107082367, 0.16683357954025269, 0.1631503701210022, 0.16714796423912048, 0.16967160999774933], [0.16620799899101257, 0.16664133965969086, 0.16707579791545868, 0.1570703685283661, 0.1679481416940689, 0.1750563383102417]], [[0.16491156816482544, 0.16625896096229553, 0.16826583445072174, 0.16650976240634918, 0.16851966083049774, 0.16553418338298798], [0.1623012274503708, 0.16563132405281067, 0.17066670954227448, 0.1662556678056717, 0.17131002247333527, 0.16383500397205353], [0.15848635137081146, 0.164667546749115, 0.1742243468761444, 0.16583874821662903, 0.17546352744102478, 0.16131950914859772], [0.1618197113275528, 0.16551275551319122, 0.1711125373840332, 0.16620606184005737, 0.17182929813861847, 0.16351963579654694], [0.15801002085208893, 0.1645432561635971, 0.1746726632118225, 0.16578280925750732, 0.17598854005336761, 0.16100271046161652], [0.1637004166841507, 0.16597092151641846, 0.1693764477968216, 0.16639497876167297, 0.16980919241905212, 0.16474801301956177]], [[0.166948601603508, 0.16488832235336304, 0.16712352633476257, 0.16721104085445404, 0.16729861497879028, 0.1665298491716385], [0.165582075715065, 0.17343255877494812, 0.16493652760982513, 0.1646146923303604, 0.16429349780082703, 0.1671406328678131], [0.16706004738807678, 0.164183109998703, 0.16730496287345886, 0.16742753982543945, 0.1675502210855484, 0.16647416353225708], [0.16711553931236267, 0.16383136808872223, 0.1673954874277115, 0.16753563284873962, 0.1676758974790573, 0.16644605994224548], [0.16717089712619781, 0.1634802371263504, 0.16748590767383575, 0.16764363646507263, 0.16780151426792145, 0.16641780734062195], [0.16667895019054413, 0.16658936440944672, 0.1666865050792694, 0.16669028997421265, 0.1666940599679947, 0.1666608303785324]], [[0.1706099808216095, 0.16544964909553528, 0.16226936876773834, 0.16618137061595917, 0.16298702359199524, 0.17250259220600128], [0.1680111587047577, 0.16625985503196716, 0.16516254842281342, 0.16651034355163574, 0.16541138291358948, 0.1686447113752365], [0.16637057065963745, 0.16675513982772827, 0.16699862480163574, 0.1666998267173767, 0.1669432371854782, 0.166232630610466], [0.1683843731880188, 0.1661454290151596, 0.16474591195583344, 0.16646528244018555, 0.16506308317184448, 0.16919593513011932], [0.1667434275150299, 0.1666436791419983, 0.1665806770324707, 0.16665801405906677, 0.166594997048378, 0.1667792797088623], [0.17154408991336823, 0.16515077650547028, 0.16123394668102264, 0.16605448722839355, 0.16211624443531036, 0.17390048503875732]]], "__all_modules__": {"num_env_steps_trained": 36000, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 155610, "num_env_steps_trained_lifetime": 468000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 4606.399050843118, "num_module_steps_trained_throughput": 23450109.01152168, "num_module_steps_trained_lifetime_throughput": 13213922.807972299}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.449128447489468e-05, "normalize_and_clip_actions": 7.600748292361047e-06, "remove_single_ts_time_rank_from_batch": 1.1456251641352146e-05, "listify_data_for_vector_env": 1.007240825821561e-05, "get_actions": 3.392379169581339e-05, "un_batch_to_individual_items": 6.354546058892539e-06}}, "connector_pipeline_timer": 0.00010903625396213618}, "episode_duration_sec_mean": 0.005114242052659392, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.6601002299929785e-06, "numpy_to_tensor": 1.145481177677358e-05, "add_time_dim_to_batch_and_zero_pad": 6.54347145858758e-06, "batch_individual_items": 1.1986070571552632e-05, "add_states_from_episodes_to_batch": 2.555787679496544e-06}}, "connector_pipeline_timer": 5.6454139544988403e-05}, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "num_episodes_lifetime": 260, "num_env_steps_sampled_lifetime": 65400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": -0.15}, "episode_return_max": 14.5, "env_step_timer": 1.3242324335258472e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "rlmodule_inference_timer": 2.9186240533164917e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_mean": -0.15, "env_reset_timer": 0.00030207045458759813, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_min": -12.5, "agent_episode_returns_mean": {"default_agent": -0.15}, "weights_seq_no": 13.0, "sample": 0.11448921486712842, "episode_len_max": 20, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "time_between_sampling": 9.36800836690708}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "b483a_00000", "date": "2025-08-11_18-54-55", "timestamp": 1754931295, "time_this_iter_s": 8.936173677444458, "time_total_s": 123.25817036628723, "pid": 11892, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fcf98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 123.25817036628723, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 25.12307692307692, "ram_util_percent": 76.36923076923075}}
{"timers": {"training_iteration": 9.384995741115514, "restore_env_runners": 1.050897088676874e-05, "training_step": 9.384844570908664, "env_runner_sampling_timer": 1.606782558823093, "learner_update_timer": 7.587336537377084, "synch_weights": 0.0010776564841749833, "restore_eval_env_runners": 1.0215092089844681e-05, "evaluation_iteration": 0.12192476222595376, "synch_eval_env_connectors": 0.00014628182012642175, "synch_env_connectors": 4.394899401760952e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00011249782169001581, "timers": {"connectors": {"get_actions": 3.686547372933391e-05, "un_batch_to_individual_items": 6.311399290026141e-06, "remove_single_ts_time_rank_from_batch": 1.1451360021717226e-05, "tensor_to_numpy": 1.4528161449935696e-05, "normalize_and_clip_actions": 7.723524706812813e-06, "listify_data_for_vector_env": 9.914699781133758e-06}}}, "time_between_sampling": 0.030390400214717814, "num_env_steps_sampled_lifetime": -7400000.0, "module_episode_returns_mean": {"default_policy": 1.4600000000000006}, "num_episodes": 250.0, "env_reset_timer": 3.036102616248577e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7120816928661703e-06, "numpy_to_tensor": 1.1854276247206402e-05, "batch_individual_items": 1.2050262364477432e-05, "add_states_from_episodes_to_batch": 2.6346130395769244e-06, "add_time_dim_to_batch_and_zero_pad": 6.779527765430719e-06}}, "connector_pipeline_timer": 5.7430505343588465e-05}, "episode_return_max": 10.5, "env_step_timer": 1.3316159626319273e-05, "rlmodule_inference_timer": 3.0407630667319294e-05, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -9.5, "agent_episode_returns_mean": {"default_agent": 1.4600000000000006}, "episode_return_mean": 1.4600000000000006, "episode_duration_sec_mean": 0.0050432283570989965, "weights_seq_no": 13.0, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "num_episodes_lifetime": -370000.0, "sample": 0.005380541178001287, "num_env_steps_sampled_lifetime_throughput": 3415.5101207118623}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15222877256163886, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008918211868162851, "add_observations_from_episodes_to_batch": 0.0008965598153708727, "add_columns_from_episodes_to_train_batch": 0.041437067709813265, "add_time_dim_to_batch_and_zero_pad": 0.08960906969635206, "add_states_from_episodes_to_batch": 0.00365590708902694, "batch_individual_items": 0.007502636156940075, "numpy_to_tensor": 6.076768365048586e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 83790, "weights_seq_no": 14.0, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained": 5985, "module_train_batch_size_mean": 998.1405362012929, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 763.7236264365725}, "default_policy": {"num_module_steps_trained_lifetime": 83790, "mean_kl_loss": 1.2551205145427957e-05, "vf_loss": 0.32050952315330505, "weights_seq_no": 14.0, "policy_loss": 6.454176764236763e-05, "module_train_batch_size_mean": 998.1405362012929, "use_intrinsic_rewards": 0.0, "entropy": 0.6929572224617004, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5985, "vf_explained_var": -7.915496826171875e-05, "vf_loss_unclipped": 43.01651382446289, "total_loss": 0.2486885040998459, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 9.862300430540927e-06, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 763.7166687649745}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "policy_loss": 6.996176671236753e-05, "use_intrinsic_rewards": 1.0, "entropy": 0.6929593682289124, "module_train_batch_size_mean": 997.501977255973, "total_loss": 0.24871234595775604, "diff_num_grad_updates_vs_sampler_policy": 71.0, "vf_explained_var": -0.0008720159530639648, "num_module_steps_trained_lifetime": 502740, "mean_kl_loss": 1.3117577509547118e-05, "vf_loss_unclipped": 42.99568176269531, "vf_loss": 0.3205304443836212, "weights_seq_no": 84.0}, "__all_modules__": {"num_module_steps_trained_lifetime": 1005480, "num_env_steps_trained_lifetime": 3024000, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 52176.92285496286}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 71.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 502740, "weights_seq_no": 84.0, "module_train_batch_size_mean": 997.501977255973, "num_module_steps_trained": 35910}}}, "IntrinsicAttentionMask": [[[0.16952310502529144, 0.16440097987651825, 0.16406305134296417, 0.1637258380651474, 0.17191356420516968, 0.16637353599071503], [0.1673620492219925, 0.16611793637275696, 0.16603481769561768, 0.16595175862312317, 0.16793295741081238, 0.16660046577453613], [0.1672169715166092, 0.16623258590698242, 0.1661667674779892, 0.16610097885131836, 0.1676681786775589, 0.1666145622730255], [0.1670718491077423, 0.16634714603424072, 0.16629865765571594, 0.16625018417835236, 0.16740365326404572, 0.16662849485874176], [0.17050768435001373, 0.1636127531528473, 0.16316044330596924, 0.16270940005779266, 0.17375034093856812, 0.16625936329364777], [0.1682027131319046, 0.16545215249061584, 0.16526928544044495, 0.16508664190769196, 0.16947321593761444, 0.1665160357952118]], [[0.17729228734970093, 0.15585929155349731, 0.17847873270511627, 0.15690229833126068, 0.1654573529958725, 0.1660100519657135], [0.16446030139923096, 0.16896876692771912, 0.16423021256923676, 0.1687323898077011, 0.16686253249645233, 0.16674576699733734], [0.17796333134174347, 0.1551917940378189, 0.17922911047935486, 0.15629559755325317, 0.165366530418396, 0.16595357656478882], [0.16511768102645874, 0.1682807207107544, 0.16495558619499207, 0.1681155115365982, 0.16680622100830078, 0.1667243242263794], [0.17037861049175262, 0.1628393977880478, 0.17077824473381042, 0.1632213294506073, 0.16629374027252197, 0.1664886474609375], [0.17071066796779633, 0.16249977052211761, 0.17114682495594025, 0.1629149466753006, 0.16625776886940002, 0.166470006108284]], [[0.16623102128505707, 0.16631807386875153, 0.16640517115592957, 0.16649232804775238, 0.16657952964305878, 0.1679738312959671], [0.1661440134048462, 0.1662483960390091, 0.16635282337665558, 0.16645734012126923, 0.16656190156936646, 0.16823552548885345], [0.16605696082115173, 0.1661786437034607, 0.16630040109157562, 0.16642224788665771, 0.16654419898986816, 0.16849753260612488], [0.16596989333629608, 0.1661088466644287, 0.1662479192018509, 0.16638709604740143, 0.1665264070034027, 0.16875986754894257], [0.16588276624679565, 0.16603897511959076, 0.166195347905159, 0.16635185480117798, 0.1665085107088089, 0.16902251541614532], [0.16449055075645447, 0.1649194061756134, 0.16534939408302307, 0.16578048467636108, 0.16621270775794983, 0.17324745655059814]], [[0.17207364737987518, 0.1580125093460083, 0.17283466458320618, 0.15871132910251617, 0.16438530385494232, 0.17398250102996826], [0.16211839020252228, 0.17398503422737122, 0.1615266501903534, 0.17334996163845062, 0.1683768779039383, 0.1606430560350418], [0.1725802719593048, 0.1572040319442749, 0.17341595888137817, 0.1579652577638626, 0.1641574651002884, 0.1746770739555359], [0.16264069080352783, 0.1731427162885666, 0.16211473941802979, 0.17258280515670776, 0.16819001734256744, 0.1613290011882782], [0.16677293181419373, 0.166496142745018, 0.1667872667312622, 0.1665104627609253, 0.16662447154521942, 0.16680878400802612], [0.173338383436203, 0.15599487721920013, 0.17428690195083618, 0.1568484902381897, 0.16381192207336426, 0.17571942508220673]], [[0.16808438301086426, 0.16300572454929352, 0.17115744948387146, 0.1623363196849823, 0.17045456171035767, 0.1649615466594696], [0.16701695322990417, 0.1657753884792328, 0.16775448620319366, 0.16560956835746765, 0.16758668422698975, 0.16625694930553436], [0.16869845986366272, 0.1613733321428299, 0.17317931354045868, 0.16041532158851624, 0.17215122282505035, 0.1641823798418045], [0.16687116026878357, 0.16614732146263123, 0.16730007529258728, 0.1660504788160324, 0.16720256209373474, 0.166428342461586], [0.16856004297733307, 0.1617438644170761, 0.17271928489208221, 0.16085083782672882, 0.17176565527915955, 0.16436025500297546], [0.16743598878383636, 0.16469794511795044, 0.1690741926431656, 0.16433413326740265, 0.1687006950378418, 0.16575700044631958]], [[0.1670253574848175, 0.16635096073150635, 0.16690021753311157, 0.1677730828523636, 0.1652376353740692, 0.1667127013206482], [0.16593772172927856, 0.16729184985160828, 0.16618773341178894, 0.16445542871952057, 0.16956382989883423, 0.16656345129013062], [0.1668257862329483, 0.16652728617191315, 0.16677045822143555, 0.16715595126152039, 0.1660330444574356, 0.1666874885559082], [0.16819678246974945, 0.16528134047985077, 0.16765286028385162, 0.17147529125213623, 0.16055351495742798, 0.16684028506278992], [0.1640775352716446, 0.16879266500473022, 0.16494092345237732, 0.1590247005224228, 0.176919624209404, 0.1662445366382599], [0.16652478277683258, 0.16679003834724426, 0.1665738970041275, 0.1662324219942093, 0.1672312468290329, 0.16664756834506989]]], "__all_modules__": {"num_env_steps_trained": 36000, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 167580, "num_env_steps_trained_lifetime": 504000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 4597.70024566234, "num_module_steps_trained_throughput": 22898884.959156316, "num_module_steps_trained_lifetime_throughput": 13187895.572821146}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4479340164954113e-05, "normalize_and_clip_actions": 7.68726887763701e-06, "remove_single_ts_time_rank_from_batch": 1.1546871321246536e-05, "listify_data_for_vector_env": 1.0089320202980058e-05, "get_actions": 3.3893280005119015e-05, "un_batch_to_individual_items": 6.326967831743459e-06}}, "connector_pipeline_timer": 0.00010926736017100467}, "episode_duration_sec_mean": 0.005054625446209684, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.6851752184369308e-06, "numpy_to_tensor": 1.15165344836185e-05, "add_time_dim_to_batch_and_zero_pad": 6.709559522816271e-06, "batch_individual_items": 1.2127928057367315e-05, "add_states_from_episodes_to_batch": 2.5895943833066117e-06}}, "connector_pipeline_timer": 5.7156903443609765e-05}, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "num_episodes_lifetime": 280, "num_env_steps_sampled_lifetime": 70400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": -0.75}, "episode_return_max": 14.5, "env_step_timer": 1.3259826564440975e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "rlmodule_inference_timer": 2.93530861892753e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_mean": -0.75, "env_reset_timer": 0.0002996864207801808, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_min": -12.5, "agent_episode_returns_mean": {"default_agent": -0.75}, "weights_seq_no": 14.0, "sample": 0.11442488646904081, "episode_len_max": 20, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "time_between_sampling": 9.365225489487656}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "b483a_00000", "date": "2025-08-11_18-55-04", "timestamp": 1754931304, "time_this_iter_s": 9.184003829956055, "time_total_s": 132.4421741962433, "pid": 11892, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fcf98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 132.4421741962433, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 26.638461538461534, "ram_util_percent": 77.26153846153846}}
{"timers": {"training_iteration": 9.384280054955397, "restore_env_runners": 1.0450131821109675e-05, "training_step": 9.384128653538625, "env_runner_sampling_timer": 1.605508985315472, "learner_update_timer": 7.586995010343998, "synch_weights": 0.0010749036684388658, "restore_eval_env_runners": 1.0172101107192245e-05, "evaluation_iteration": 0.12183495543308488, "synch_eval_env_connectors": 0.00014581650195361875, "synch_env_connectors": 4.3905304530112824e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00011444690192076759, "timers": {"connectors": {"get_actions": 3.766683708995984e-05, "un_batch_to_individual_items": 6.434460923680871e-06, "remove_single_ts_time_rank_from_batch": 1.162141180838001e-05, "tensor_to_numpy": 1.4815733078114135e-05, "normalize_and_clip_actions": 7.833603914150861e-06, "listify_data_for_vector_env": 1.0067722386063672e-05}}}, "time_between_sampling": 0.03117956896191323, "num_env_steps_sampled_lifetime": -8017500.0, "module_episode_returns_mean": {"default_policy": 2.0200000000000005}, "num_episodes": 250.0, "env_reset_timer": 3.146000802168103e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7494437196329862e-06, "numpy_to_tensor": 1.2108648562248894e-05, "batch_individual_items": 1.2172717317309155e-05, "add_states_from_episodes_to_batch": 2.6775526270077412e-06, "add_time_dim_to_batch_and_zero_pad": 6.866387477229617e-06}}, "connector_pipeline_timer": 5.810645613565242e-05}, "episode_return_max": 10.5, "env_step_timer": 1.354841399686428e-05, "rlmodule_inference_timer": 3.087646116506699e-05, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -9.5, "agent_episode_returns_mean": {"default_agent": 2.0200000000000005}, "episode_return_mean": 2.0200000000000005, "episode_duration_sec_mean": 0.005117633472196757, "weights_seq_no": 14.0, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "num_episodes_lifetime": -400875.0, "sample": 0.005436171375823622, "num_env_steps_sampled_lifetime_throughput": 3373.945704474434}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15304217400630854, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008914325579403182, "add_observations_from_episodes_to_batch": 0.000897830886548953, "add_columns_from_episodes_to_train_batch": 0.042243524533516666, "add_time_dim_to_batch_and_zero_pad": 0.08961044774928796, "add_states_from_episodes_to_batch": 0.0036603942689810444, "batch_individual_items": 0.007506474376089475, "numpy_to_tensor": 6.090666674850172e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 89775, "weights_seq_no": 15.0, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained": 5985, "module_train_batch_size_mean": 998.1026110140886, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 762.1761356408539}, "default_policy": {"num_module_steps_trained_lifetime": 89775, "mean_kl_loss": 2.5037830710061826e-05, "vf_loss": 0.3205088675022125, "weights_seq_no": 15.0, "policy_loss": -0.00019026908557862043, "module_train_batch_size_mean": 998.1026110140886, "use_intrinsic_rewards": 0.0, "entropy": 0.6930681467056274, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5985, "vf_explained_var": -0.00021576881408691406, "vf_loss_unclipped": 42.55768966674805, "total_loss": 0.24843300879001617, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 4.931150215270463e-06, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 762.1696408320456}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "policy_loss": -0.00018652732251212, "use_intrinsic_rewards": 1.0, "entropy": 0.6930667757987976, "module_train_batch_size_mean": 997.499088644618, "total_loss": 0.24845553934574127, "diff_num_grad_updates_vs_sampler_policy": 76.0, "vf_explained_var": -0.0008541345596313477, "num_module_steps_trained_lifetime": 538650, "mean_kl_loss": 2.4136072170222178e-05, "vf_loss_unclipped": 42.55698776245117, "vf_loss": 0.3205280005931854, "weights_seq_no": 90.0}, "__all_modules__": {"num_module_steps_trained_lifetime": 1077300, "num_env_steps_trained_lifetime": 3240000, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 51403.1713761397}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 76.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 538650, "weights_seq_no": 90.0, "module_train_batch_size_mean": 997.499088644618, "num_module_steps_trained": 35910}}}, "IntrinsicAttentionMask": [[[0.16808143258094788, 0.17150697112083435, 0.16266781091690063, 0.16233345866203308, 0.1704515665769577, 0.164958655834198], [0.16876080632209778, 0.1739378720521927, 0.16068585216999054, 0.16019144654273987, 0.17233727872371674, 0.16408678889274597], [0.16694402694702148, 0.16759346425533295, 0.16589553654193878, 0.1658298671245575, 0.1673944890499115, 0.1663426011800766], [0.1668711006641388, 0.16734880208969116, 0.16609883308410645, 0.16605041921138763, 0.16720250248908997, 0.16642828285694122], [0.16855470836162567, 0.1731926053762436, 0.16129164397716522, 0.16084575653076172, 0.17176023125648499, 0.1643550544977188], [0.1674351692199707, 0.1692604124546051, 0.16451512277126312, 0.164333313703537, 0.16869986057281494, 0.16575618088245392]], [[0.16592945158481598, 0.16419777274131775, 0.16617976129055023, 0.16444545984268188, 0.16955983638763428, 0.1696876734495163], [0.16732802987098694, 0.1689663827419281, 0.16709394752979279, 0.1687300056219101, 0.16399815678596497, 0.16388340294361115], [0.16572058200836182, 0.16351500153541565, 0.16603991389274597, 0.16383008658885956, 0.1703651398420334, 0.17052920162677765], [0.16713306307792664, 0.16827954351902008, 0.16696897149085999, 0.1681143343448639, 0.1647924929857254, 0.1647115796804428], [0.16274334490299225, 0.15446063876152039, 0.16396935284137726, 0.15562424063682556, 0.18126043677330017, 0.1819419115781784], [0.1626252681016922, 0.15412436425685883, 0.16388460993766785, 0.15531785786151886, 0.18167293071746826, 0.1823749989271164]], [[0.16766975820064545, 0.16560058295726776, 0.16784542798995972, 0.16577407717704773, 0.16586090624332428, 0.16724920272827148], [0.16293159127235413, 0.17065641283988953, 0.1622963845729828, 0.16999107599258423, 0.16965939104557037, 0.16446518898010254], [0.16807009279727936, 0.16517575085163116, 0.16831648349761963, 0.1654178947210312, 0.16553910076618195, 0.16748066246509552], [0.16333042085170746, 0.17022883892059326, 0.1627616286277771, 0.16963602602481842, 0.16934038698673248, 0.16470269858837128], [0.1635299026966095, 0.1700151413679123, 0.16299444437026978, 0.16945846378803253, 0.16918079555034637, 0.16482126712799072], [0.16671009361743927, 0.16662049293518066, 0.16671764850616455, 0.16662804782390594, 0.166631817817688, 0.16669195890426636]], [[0.16728247702121735, 0.16660703718662262, 0.1671571582555771, 0.16803134977817535, 0.1654919981956482, 0.1654299944639206], [0.165420264005661, 0.16677019000053406, 0.1656695008277893, 0.1639426052570343, 0.16903506219387054, 0.16916236281394958], [0.1669396460056305, 0.16664095222949982, 0.16688427329063416, 0.16727003455162048, 0.16614636778831482, 0.1661188155412674], [0.16930514574050903, 0.16637049615383148, 0.16875764727592468, 0.1726052612066269, 0.16161151230335236, 0.16134999692440033], [0.16226986050605774, 0.16693302989006042, 0.1631237417459488, 0.15727269649505615, 0.17497047781944275, 0.17543022334575653], [0.1620919555425644, 0.16693814098834991, 0.16297894716262817, 0.15690483152866364, 0.17530357837677002, 0.17578256130218506]], [[0.16658726334571838, 0.16453143954277039, 0.16676180064678192, 0.16684913635253906, 0.16693651676177979, 0.16833381354808807], [0.1668967306613922, 0.1748095452785492, 0.16624605655670166, 0.1659216731786728, 0.16559791564941406, 0.1605280637741089], [0.1665535271167755, 0.16368529200553894, 0.1667976826429367, 0.16691990196704865, 0.16704221069812775, 0.16900138556957245], [0.16653621196746826, 0.16326342523097992, 0.16681517660617828, 0.16695484519004822, 0.1670946180820465, 0.16933570802211761], [0.16651859879493713, 0.16284233331680298, 0.16683237254619598, 0.1669894903898239, 0.16714675724506378, 0.16967038810253143], [0.1661989837884903, 0.15624606609344482, 0.167066752910614, 0.16750232875347137, 0.16793905198574066, 0.1750468611717224]], [[0.1672825813293457, 0.1681574285030365, 0.16561616957187653, 0.16648231446743011, 0.16549210250377655, 0.166969433426857], [0.16964313387870789, 0.17401613295078278, 0.16155549883842468, 0.16572003066539764, 0.16096581518650055, 0.16809934377670288], [0.16262926161289215, 0.1572524756193161, 0.1734694242477417, 0.16773423552513123, 0.1743094027042389, 0.16460515558719635], [0.16507293283939362, 0.16287802159786224, 0.16936883330345154, 0.16711680591106415, 0.16969488561153412, 0.16586853563785553], [0.16227492690086365, 0.15645430982112885, 0.17406001687049866, 0.16781669855117798, 0.1749759316444397, 0.16441813111305237], [0.16642357409000397, 0.16608239710330963, 0.1670803427696228, 0.16673782467842102, 0.16712960600852966, 0.1665462851524353]]], "__all_modules__": {"num_env_steps_trained": 36000, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 179550, "num_env_steps_trained_lifetime": 540000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 4588.246211191542, "num_module_steps_trained_throughput": 22381259.165076982, "num_module_steps_trained_lifetime_throughput": 13169362.22378639}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4513550218953869e-05, "normalize_and_clip_actions": 7.68842939260884e-06, "remove_single_ts_time_rank_from_batch": 1.1376986386940359e-05, "listify_data_for_vector_env": 1.0212601307481136e-05, "get_actions": 3.362895034828763e-05, "un_batch_to_individual_items": 6.290377539316741e-06}}, "connector_pipeline_timer": 0.00010887423142126723}, "episode_duration_sec_mean": 0.005026019630022347, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7146043767181865e-06, "numpy_to_tensor": 1.1621642832086098e-05, "add_time_dim_to_batch_and_zero_pad": 6.640735110303967e-06, "batch_individual_items": 1.1980705519220865e-05, "add_states_from_episodes_to_batch": 2.5669403347835854e-06}}, "connector_pipeline_timer": 5.696059401422652e-05}, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "num_episodes_lifetime": 300, "num_env_steps_sampled_lifetime": 75400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": -1.35}, "episode_return_max": 14.5, "env_step_timer": 1.3282635576273524e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "rlmodule_inference_timer": 2.9104369254937524e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_mean": -1.35, "env_reset_timer": 0.00029734538578035066, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_min": -12.5, "agent_episode_returns_mean": {"default_agent": -1.35}, "weights_seq_no": 15.0, "sample": 0.11435779218345712, "episode_len_max": 20, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "time_between_sampling": 9.364922889173013}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "b483a_00000", "date": "2025-08-11_18-55-14", "timestamp": 1754931314, "time_this_iter_s": 9.429020166397095, "time_total_s": 141.87119436264038, "pid": 11892, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fcf98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 141.87119436264038, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 32.42307692307693, "ram_util_percent": 77.83076923076922}}
{"timers": {"training_iteration": 9.381099071485952, "restore_env_runners": 1.0393541228596454e-05, "training_step": 9.380947677423446, "env_runner_sampling_timer": 1.6045791021328084, "learner_update_timer": 7.58467359982995, "synch_weights": 0.0010715546322223736, "restore_eval_env_runners": 1.0178710373846377e-05, "evaluation_iteration": 0.12174511878955409, "synch_eval_env_connectors": 0.00014560999722146276, "synch_env_connectors": 4.384545111259858e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00011684260411203612, "timers": {"connectors": {"get_actions": 3.880639057232146e-05, "un_batch_to_individual_items": 6.534344480873494e-06, "remove_single_ts_time_rank_from_batch": 1.1749906901248664e-05, "tensor_to_numpy": 1.5091175144667709e-05, "normalize_and_clip_actions": 7.963936118674326e-06, "listify_data_for_vector_env": 1.0323459374020752e-05}}}, "time_between_sampling": 0.03222721370517951, "num_env_steps_sampled_lifetime": -8635000.0, "module_episode_returns_mean": {"default_policy": -0.4600000000000001}, "num_episodes": 250.0, "env_reset_timer": 3.322618702432376e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7724274562572888e-06, "numpy_to_tensor": 1.2503039733876776e-05, "batch_individual_items": 1.2409696194581815e-05, "add_states_from_episodes_to_batch": 2.7006767083241257e-06, "add_time_dim_to_batch_and_zero_pad": 6.982530549173977e-06}}, "connector_pipeline_timer": 5.922558815132041e-05}, "episode_return_max": 10.5, "env_step_timer": 1.3893114579250483e-05, "rlmodule_inference_timer": 3.163379778115881e-05, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -9.5, "agent_episode_returns_mean": {"default_agent": -0.4600000000000001}, "episode_return_mean": -0.4600000000000001, "episode_duration_sec_mean": 0.005227575363125653, "weights_seq_no": 15.0, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "num_episodes_lifetime": -431750.0, "sample": 0.005503318261223113, "num_env_steps_sampled_lifetime_throughput": 3311.450874757091}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1530154126855028, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00891226898323246, "add_observations_from_episodes_to_batch": 0.0008973934180372802, "add_columns_from_episodes_to_train_batch": 0.04222897303892194, "add_time_dim_to_batch_and_zero_pad": 0.08960136868257017, "add_states_from_episodes_to_batch": 0.0036624965756158387, "batch_individual_items": 0.007503812962451632, "numpy_to_tensor": 6.108842915279179e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 95760, "weights_seq_no": 16.0, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained": 5985, "module_train_batch_size_mean": 998.0669052031734, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 760.9102906199261}, "default_policy": {"num_module_steps_trained_lifetime": 95760, "mean_kl_loss": 5.650547336699674e-06, "vf_loss": 0.32050952315330505, "weights_seq_no": 16.0, "policy_loss": -8.624817564850673e-05, "module_train_batch_size_mean": 998.0669052031734, "use_intrinsic_rewards": 0.0, "entropy": 0.6931039690971375, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5985, "vf_explained_var": -0.00027108192443847656, "vf_loss_unclipped": 41.9380989074707, "total_loss": 0.24853749573230743, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 2.4655751076352317e-06, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 760.9042280748333}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "policy_loss": -8.36160106700845e-05, "use_intrinsic_rewards": 1.0, "entropy": 0.6931032538414001, "module_train_batch_size_mean": 997.4970769774884, "total_loss": 0.24855411052703857, "diff_num_grad_updates_vs_sampler_policy": 81.0, "vf_explained_var": -0.0008776187896728516, "num_module_steps_trained_lifetime": 574560, "mean_kl_loss": 5.329824489308521e-06, "vf_loss_unclipped": 41.965579986572266, "vf_loss": 0.3205263912677765, "weights_seq_no": 96.0}, "__all_modules__": {"num_module_steps_trained_lifetime": 1149120, "num_env_steps_trained_lifetime": 3456000, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 50666.87942293681}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 81.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 574560, "weights_seq_no": 96.0, "module_train_batch_size_mean": 997.4970769774884, "num_module_steps_trained": 35910}}}, "IntrinsicAttentionMask": [[[0.16694879531860352, 0.167036235332489, 0.1649748682975769, 0.16721123456954956, 0.1672988086938858, 0.166530042886734], [0.16700467467308044, 0.16710959374904633, 0.16463905572891235, 0.16731961071491241, 0.16742472350597382, 0.16650234162807465], [0.16564376652240753, 0.16533783078193665, 0.17274834215641022, 0.16472762823104858, 0.1644233763217926, 0.16711917519569397], [0.16711603105068207, 0.1672559529542923, 0.1639690101146698, 0.16753612458705902, 0.1676763892173767, 0.1664465367794037], [0.16717150807380676, 0.16732892394065857, 0.163634791970253, 0.16764424741268158, 0.1678021252155304, 0.1664184033870697], [0.16667895019054413, 0.16668272018432617, 0.16659314930438995, 0.16669028997421265, 0.1666940599679947, 0.1666608303785324]], [[0.16676875948905945, 0.16764092445373535, 0.16664381325244904, 0.16597096621990204, 0.16651897132396698, 0.16645658016204834], [0.16715098917484283, 0.17145974934101105, 0.16654087603092194, 0.1632855087518692, 0.16593298316001892, 0.16562986373901367], [0.16671203076839447, 0.16709738969802856, 0.1666567325592041, 0.16635854542255402, 0.16660144925117493, 0.16657382249832153], [0.16639810800552368, 0.16418558359146118, 0.16671843826770782, 0.16845838725566864, 0.16703937947750092, 0.16720010340213776], [0.16665485501289368, 0.16655516624450684, 0.16666918992996216, 0.1667465716600418, 0.16668352484703064, 0.16669069230556488], [0.16662611067295074, 0.16628453135490417, 0.16667523980140686, 0.16694074869155884, 0.16672439873218536, 0.16674897074699402]], [[0.1673085242509842, 0.16739614307880402, 0.16533033549785614, 0.1654169261455536, 0.16765928268432617, 0.16688886284828186], [0.1674361675977707, 0.16754135489463806, 0.16506443917751312, 0.1651681363582611, 0.1678573042154312, 0.16693255305290222], [0.16437777876853943, 0.16407416760921478, 0.17142805457115173, 0.17111141979694366, 0.16316671669483185, 0.16584189236164093], [0.16450798511505127, 0.16422128677368164, 0.1711573302745819, 0.17085903882980347, 0.16336418688297272, 0.1658901423215866], [0.16781851649284363, 0.16797655820846558, 0.1642681211233139, 0.16442282497882843, 0.16845157742500305, 0.16706250607967377], [0.1666945070028305, 0.16669827699661255, 0.16660869121551514, 0.16661246120929718, 0.16670961678028107, 0.1666763722896576]], [[0.17016738653182983, 0.16244864463806152, 0.17130613327026367, 0.15059678256511688, 0.17245250940322876, 0.17302857339382172], [0.16868162155151367, 0.1643218845129013, 0.16931745409965515, 0.1574477106332779, 0.16995568573474884, 0.1702757030725479], [0.1703757494688034, 0.16217538714408875, 0.17158755660057068, 0.1496318131685257, 0.1728079915046692, 0.1734214574098587], [0.16612347960472107, 0.16726304590702057, 0.1659603863954544, 0.169139564037323, 0.16579745709896088, 0.1657160520553589], [0.1705828607082367, 0.16190113127231598, 0.17186790704727173, 0.1486717313528061, 0.17316265404224396, 0.17381368577480316], [0.17068593204021454, 0.16176363825798035, 0.1720076948404312, 0.14819349348545074, 0.17333967983722687, 0.1740095466375351]], [[0.1694646179676056, 0.17291834950447083, 0.16400645673274994, 0.17220821976661682, 0.16333292424678802, 0.1580694168806076], [0.1708095818758011, 0.17604950070381165, 0.16263660788536072, 0.17496782541275024, 0.1616373360157013, 0.15389908850193024], [0.16721481084823608, 0.1678653061389923, 0.16616462171077728, 0.16773241758346558, 0.1660330891609192, 0.16498973965644836], [0.17053787410259247, 0.17540985345840454, 0.16291841864585876, 0.17440494894981384, 0.16198505461215973, 0.15474383533000946], [0.16692624986171722, 0.16723278164863586, 0.1664300411939621, 0.1671702116727829, 0.166367769241333, 0.1658729463815689], [0.16458465158939362, 0.16222074627876282, 0.1684940904378891, 0.16270014643669128, 0.16899201273918152, 0.17300836741924286]], [[0.17366674542427063, 0.1594754010438919, 0.16517668962478638, 0.1601807028055191, 0.16590721905231476, 0.1755932718515396], [0.16091682016849518, 0.17269553244113922, 0.16774119436740875, 0.17206516861915588, 0.16712892055511475, 0.1594524383544922], [0.16614295542240143, 0.16721111536026, 0.16677016019821167, 0.1671556532382965, 0.1667148470878601, 0.1660052388906479], [0.1615709364414215, 0.17200389504432678, 0.16762584447860718, 0.17144766449928284, 0.1670837700366974, 0.1602678745985031], [0.16680246591567993, 0.16652561724185944, 0.16663962602615356, 0.16653993725776672, 0.16665396094322205, 0.16683831810951233], [0.17533129453659058, 0.15778836607933044, 0.16479355096817017, 0.15865179896354675, 0.16569530963897705, 0.1777397245168686]]], "__all_modules__": {"num_env_steps_trained": 36000, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 191520, "num_env_steps_trained_lifetime": 576000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 4580.491932400947, "num_module_steps_trained_throughput": 21902970.992436253, "num_module_steps_trained_lifetime_throughput": 13164263.688189218}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4450316072185203e-05, "normalize_and_clip_actions": 7.622696355315072e-06, "remove_single_ts_time_rank_from_batch": 1.1404775188681827e-05, "listify_data_for_vector_env": 1.010075792871314e-05, "get_actions": 3.4001557624764874e-05, "un_batch_to_individual_items": 6.2957490833689286e-06}}, "connector_pipeline_timer": 0.00010890379861534041}, "episode_duration_sec_mean": 0.005004104672698304, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.699648902539242e-06, "numpy_to_tensor": 1.1479543905680951e-05, "add_time_dim_to_batch_and_zero_pad": 6.697746135149508e-06, "batch_individual_items": 1.1946918680443766e-05, "add_states_from_episodes_to_batch": 2.5852987016154896e-06}}, "connector_pipeline_timer": 5.663785253696856e-05}, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "num_episodes_lifetime": 320, "num_env_steps_sampled_lifetime": 80400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": -1.55}, "episode_return_max": 14.5, "env_step_timer": 1.3217735440008188e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "rlmodule_inference_timer": 2.957787846341116e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_mean": -1.55, "env_reset_timer": 0.0002950540116214376, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_min": -12.5, "agent_episode_returns_mean": {"default_agent": -1.55}, "weights_seq_no": 16.0, "sample": 0.11429821051214953, "episode_len_max": 20, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "time_between_sampling": 9.362147236941224}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "b483a_00000", "date": "2025-08-11_18-55-23", "timestamp": 1754931323, "time_this_iter_s": 9.182470798492432, "time_total_s": 151.0536651611328, "pid": 11892, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fcf98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 151.0536651611328, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 28.96153846153846, "ram_util_percent": 77.66923076923078}}
{"timers": {"training_iteration": 9.380186875771603, "restore_env_runners": 1.0334604994809472e-05, "training_step": 9.380035387729446, "env_runner_sampling_timer": 1.6035885623610582, "learner_update_timer": 7.5845795867518015, "synch_weights": 0.0010711453355056416, "restore_eval_env_runners": 1.0141093723805357e-05, "evaluation_iteration": 0.12166244760208815, "synch_eval_env_connectors": 0.00014522097755141207, "synch_env_connectors": 4.3761201859663225e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00011623960519943733, "timers": {"connectors": {"get_actions": 3.858500039858182e-05, "un_batch_to_individual_items": 6.514022018606238e-06, "remove_single_ts_time_rank_from_batch": 1.1735611260547922e-05, "tensor_to_numpy": 1.4976859830667915e-05, "normalize_and_clip_actions": 7.91481497940295e-06, "listify_data_for_vector_env": 1.024080384208355e-05}}}, "time_between_sampling": 0.03128802178980534, "num_env_steps_sampled_lifetime": -9252500.0, "module_episode_returns_mean": {"default_policy": 0.8199999999999998}, "num_episodes": 250.0, "env_reset_timer": 3.39105316213334e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.777971954035695e-06, "numpy_to_tensor": 1.2316293476104653e-05, "batch_individual_items": 1.2342955821957323e-05, "add_states_from_episodes_to_batch": 2.7079204820118503e-06, "add_time_dim_to_batch_and_zero_pad": 6.979170905256411e-06}}, "connector_pipeline_timer": 5.8887404644139634e-05}, "episode_return_max": 10.5, "env_step_timer": 1.3813099248375772e-05, "rlmodule_inference_timer": 3.134536392209564e-05, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -9.5, "agent_episode_returns_mean": {"default_agent": 0.8199999999999998}, "episode_return_mean": 0.8199999999999998, "episode_duration_sec_mean": 0.005205464345403017, "weights_seq_no": 16.0, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "num_episodes_lifetime": -462625.0, "sample": 0.005540724492514057, "num_env_steps_sampled_lifetime_throughput": 3322.3065549336497}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1530901518989113, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008917466293316613, "add_observations_from_episodes_to_batch": 0.0008968973935802041, "add_columns_from_episodes_to_train_batch": 0.04225513080935392, "add_time_dim_to_batch_and_zero_pad": 0.0896390333263652, "add_states_from_episodes_to_batch": 0.003664055360444402, "batch_individual_items": 0.007506306083253661, "numpy_to_tensor": 6.340004441363299e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 101745, "weights_seq_no": 17.0, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained": 5985, "module_train_batch_size_mean": 998.0332888909784, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 759.4931704796613}, "default_policy": {"num_module_steps_trained_lifetime": 101745, "mean_kl_loss": 2.9115477445884608e-05, "vf_loss": 0.3205097019672394, "weights_seq_no": 17.0, "policy_loss": -0.00033961469307541847, "module_train_batch_size_mean": 998.0332888909784, "use_intrinsic_rewards": 0.0, "entropy": 0.6931341886520386, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5985, "vf_explained_var": -0.00016808509826660156, "vf_loss_unclipped": 41.62519836425781, "total_loss": 0.24828419089317322, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 1.2327875538176158e-06, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 759.487513886989}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "policy_loss": -0.00032962526893243194, "use_intrinsic_rewards": 1.0, "entropy": 0.6931341886520386, "module_train_batch_size_mean": 997.4956760259092, "total_loss": 0.2483099400997162, "diff_num_grad_updates_vs_sampler_policy": 86.0, "vf_explained_var": -0.0008429288864135742, "num_module_steps_trained_lifetime": 610470, "mean_kl_loss": 2.7445212253951468e-05, "vf_loss_unclipped": 41.66475296020508, "vf_loss": 0.3205242156982422, "weights_seq_no": 102.0}, "__all_modules__": {"num_module_steps_trained_lifetime": 1220940, "num_env_steps_trained_lifetime": 3672000, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 49967.638544996706}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 86.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 610470, "weights_seq_no": 102.0, "module_train_batch_size_mean": 997.4956760259092, "num_module_steps_trained": 35910}}}, "IntrinsicAttentionMask": [[[0.16807852685451508, 0.17150400578975677, 0.1626650094985962, 0.17079968750476837, 0.161996990442276, 0.16495577991008759], [0.1687542200088501, 0.1739310771226883, 0.16067957878112793, 0.17286241054534912, 0.15969233214855194, 0.16408036649227142], [0.16694392263889313, 0.1675933599472046, 0.16589543223381042, 0.16746069490909576, 0.16576410830020905, 0.16634249687194824], [0.1686178594827652, 0.17343498766422272, 0.16108417510986328, 0.17244139313697815, 0.1601613461971283, 0.16426019370555878], [0.16679801046848297, 0.1671043038368225, 0.1663021743297577, 0.16704177856445312, 0.16623994708061218, 0.16651380062103271], [0.16743430495262146, 0.16925954818725586, 0.16451430320739746, 0.16888564825057983, 0.1641508787870407, 0.16575533151626587]], [[0.16541874408721924, 0.1636923849582672, 0.16878335177898407, 0.16702185571193695, 0.16591820120811462, 0.16916540265083313], [0.16781438887119293, 0.16945751011371613, 0.16470524668693542, 0.1663179248571396, 0.16734518110752106, 0.16435973346233368], [0.1606970727443695, 0.15296253561973572, 0.1766546070575714, 0.16815201938152313, 0.16299113631248474, 0.17854265868663788], [0.1631765216588974, 0.15849760174751282, 0.17254725098609924, 0.1675996333360672, 0.1645464301109314, 0.17363254725933075], [0.16472186148166656, 0.16205772757530212, 0.16995850205421448, 0.16720964014530182, 0.16549549996852875, 0.17055681347846985], [0.1601574867963791, 0.15178555250167847, 0.17754127085208893, 0.1682606190443039, 0.1626475602388382, 0.17960752546787262]], [[0.16666701436042786, 0.17006371915340424, 0.16971415281295776, 0.1609673947095871, 0.16901719570159912, 0.16357047855854034], [0.16664165258407593, 0.17175370454788208, 0.17122524976730347, 0.1581798940896988, 0.17017321288585663, 0.1620263010263443], [0.16664500534534454, 0.17158137261867523, 0.17107130587100983, 0.15846268832683563, 0.17005574703216553, 0.16218386590480804], [0.16667090356349945, 0.16714803874492645, 0.16709932684898376, 0.16585120558738708, 0.16700191795825958, 0.16622860729694366], [0.16665118932724, 0.17123670876026154, 0.17076332867145538, 0.1590292900800705, 0.16982051730155945, 0.16249893605709076], [0.16667540371418, 0.1684923768043518, 0.1683061718940735, 0.16358764469623566, 0.1679343730211258, 0.16500404477119446]], [[0.1690194308757782, 0.16390720009803772, 0.16976694762706757, 0.15589426457881927, 0.17051775753498077, 0.17089441418647766], [0.16748546063899994, 0.16573964059352875, 0.16773779690265656, 0.16292953491210938, 0.1679905205965042, 0.16811703145503998], [0.1692347377538681, 0.16363954544067383, 0.17005422711372375, 0.15490299463272095, 0.17087766528129578, 0.17129088938236237], [0.16484856605529785, 0.16860707104206085, 0.16431547701358795, 0.17492567002773285, 0.16378411650657654, 0.16351906955242157], [0.16944874823093414, 0.16337080299854279, 0.1703404039144516, 0.153916597366333, 0.17123675346374512, 0.17168669402599335], [0.16955526173114777, 0.16323603689670563, 0.1704830825328827, 0.15342523157596588, 0.17141598463058472, 0.17188434302806854]], [[0.16766996681690216, 0.1677577793598175, 0.16568753123283386, 0.16577430069446564, 0.165861114859581, 0.167249396443367], [0.1678701788187027, 0.16797563433647156, 0.16549231112003326, 0.16559626162052155, 0.165700301527977, 0.16736525297164917], [0.16313327848911285, 0.16283197700977325, 0.17013019323349, 0.16981595754623413, 0.16950231790542603, 0.16458632051944733], [0.16333246231079102, 0.16304782032966614, 0.16993430256843567, 0.16963814198970795, 0.1693425178527832, 0.16470474004745483], [0.16353172063827515, 0.16326376795768738, 0.16973845660686493, 0.16946034133434296, 0.1691826730966568, 0.16482308506965637], [0.16671009361743927, 0.1667138636112213, 0.1666242480278015, 0.16662803292274475, 0.1666318029165268, 0.16669195890426636]], [[0.16702380776405334, 0.1678973138332367, 0.16536001861095428, 0.16777153313159943, 0.16523613035678864, 0.16671116650104523], [0.1683533936738968, 0.1726931631565094, 0.1603272557258606, 0.17206281423568726, 0.15974202752113342, 0.16682131588459015], [0.16422557830810547, 0.15879599750041962, 0.17517215013504028, 0.15956492722034454, 0.17602038383483887, 0.16622087359428406], [0.1681678742170334, 0.17200206220149994, 0.16104671359062195, 0.171445831656456, 0.16052590310573578, 0.16681160032749176], [0.1640033721923828, 0.1581207513809204, 0.175914004445076, 0.15895280241966248, 0.176839679479599, 0.1661694049835205], [0.16652454435825348, 0.16618315875530243, 0.16718173027038574, 0.166232168674469, 0.167231023311615, 0.16664734482765198]]], "__all_modules__": {"num_env_steps_trained": 36000, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 203490, "num_env_steps_trained_lifetime": 612000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 4571.834582441218, "num_module_steps_trained_throughput": 21436639.576947484, "num_module_steps_trained_lifetime_throughput": 13155213.988568034}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.450095338253102e-05, "normalize_and_clip_actions": 7.636368082774997e-06, "remove_single_ts_time_rank_from_batch": 1.1442950602300916e-05, "listify_data_for_vector_env": 1.0150534793118709e-05, "get_actions": 3.449998080613571e-05, "un_batch_to_individual_items": 6.36392444893123e-06}}, "connector_pipeline_timer": 0.00010987224696652839}, "episode_duration_sec_mean": 0.005025830526137725, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.665550957124211e-06, "numpy_to_tensor": 1.1536748937065166e-05, "add_time_dim_to_batch_and_zero_pad": 6.716717169384138e-06, "batch_individual_items": 1.2022310639193445e-05, "add_states_from_episodes_to_batch": 2.6042985061938067e-06}}, "connector_pipeline_timer": 5.708504681736054e-05}, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "num_episodes_lifetime": 340, "num_env_steps_sampled_lifetime": 85400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": -1.55}, "episode_return_max": 14.5, "env_step_timer": 1.3362554776345968e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "rlmodule_inference_timer": 2.978246272568803e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_mean": -1.55, "env_reset_timer": 0.0002934255607340023, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_min": -12.5, "agent_episode_returns_mean": {"default_agent": -1.55}, "weights_seq_no": 17.0, "sample": 0.1142846267378413, "episode_len_max": 20, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "time_between_sampling": 9.361650459160872}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "b483a_00000", "date": "2025-08-11_18-55-32", "timestamp": 1754931332, "time_this_iter_s": 9.411992073059082, "time_total_s": 160.4656572341919, "pid": 11892, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fcf98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 160.4656572341919, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 31.178571428571423, "ram_util_percent": 77.63571428571429}}
{"timers": {"training_iteration": 9.382146707433131, "restore_env_runners": 1.028667845881709e-05, "training_step": 9.38199501635261, "env_runner_sampling_timer": 1.6030693746578406, "learner_update_timer": 7.586909935473954, "synch_weights": 0.0010686938821820265, "restore_eval_env_runners": 1.0197183403773399e-05, "evaluation_iteration": 0.12163665854634237, "synch_eval_env_connectors": 0.00014546959795609592, "synch_env_connectors": 4.370688728818177e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00011980051477883047, "timers": {"connectors": {"get_actions": 4.008169297017744e-05, "un_batch_to_individual_items": 6.71338083804772e-06, "remove_single_ts_time_rank_from_batch": 1.20106795955344e-05, "tensor_to_numpy": 1.5456097901631245e-05, "normalize_and_clip_actions": 8.140139188133451e-06, "listify_data_for_vector_env": 1.0508971604283567e-05}}}, "time_between_sampling": 0.03210222498581553, "num_env_steps_sampled_lifetime": -9870000.0, "module_episode_returns_mean": {"default_policy": 0.9800000000000004}, "num_episodes": 250.0, "env_reset_timer": 3.647734863238669e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.825380172635394e-06, "numpy_to_tensor": 1.2988902477211777e-05, "batch_individual_items": 1.2709062061313477e-05, "add_states_from_episodes_to_batch": 2.7724329331600874e-06, "add_time_dim_to_batch_and_zero_pad": 7.254181878413655e-06}}, "connector_pipeline_timer": 6.069778728775847e-05}, "episode_return_max": 10.5, "env_step_timer": 1.4327147163675314e-05, "rlmodule_inference_timer": 3.2477421138212174e-05, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -9.5, "agent_episode_returns_mean": {"default_agent": 0.9800000000000004}, "episode_return_mean": 0.9800000000000004, "episode_duration_sec_mean": 0.005360744493547827, "weights_seq_no": 17.0, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "num_episodes_lifetime": -493500.0, "sample": 0.005671364624855708, "num_env_steps_sampled_lifetime_throughput": 3229.238501018655}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1531315095496926, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008917659969778597, "add_observations_from_episodes_to_batch": 0.0008977909196544604, "add_columns_from_episodes_to_train_batch": 0.042266445332261114, "add_time_dim_to_batch_and_zero_pad": 0.0896671284120471, "add_states_from_episodes_to_batch": 0.0036654652176433653, "batch_individual_items": 0.007505639691354457, "numpy_to_tensor": 6.355229326251107e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 107730, "weights_seq_no": 18.0, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained": 5985, "module_train_batch_size_mean": 998.0016398003509, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 757.7318504232977}, "default_policy": {"num_module_steps_trained_lifetime": 107730, "mean_kl_loss": 1.3402861895883689e-06, "vf_loss": 0.32050901651382446, "weights_seq_no": 18.0, "policy_loss": -1.6587193385930732e-05, "module_train_batch_size_mean": 998.0016398003509, "use_intrinsic_rewards": 0.0, "entropy": 0.6931315660476685, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5985, "vf_explained_var": -0.00023639202117919922, "vf_loss_unclipped": 42.450862884521484, "total_loss": 0.24860674142837524, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 6.163937769088079e-07, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 757.7265783415243}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "policy_loss": -1.5775362044223584e-05, "use_intrinsic_rewards": 1.0, "entropy": 0.6931315660476685, "module_train_batch_size_mean": 997.4947003847115, "total_loss": 0.248616561293602, "diff_num_grad_updates_vs_sampler_policy": 91.0, "vf_explained_var": -0.0007179975509643555, "num_module_steps_trained_lifetime": 646380, "mean_kl_loss": 1.3650294476974523e-06, "vf_loss_unclipped": 42.45492172241211, "vf_loss": 0.3205203413963318, "weights_seq_no": 108.0}, "__all_modules__": {"num_module_steps_trained_lifetime": 1292760, "num_env_steps_trained_lifetime": 3888000, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 49287.37833880146}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 91.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 646380, "weights_seq_no": 108.0, "module_train_batch_size_mean": 997.4947003847115, "num_module_steps_trained": 35910}}}, "IntrinsicAttentionMask": [[[0.16947059333324432, 0.16435003280639648, 0.17256899178028107, 0.16367509961128235, 0.17186030745506287, 0.15807494521141052], [0.16735897958278656, 0.16611486673355103, 0.16809801757335663, 0.16594870388507843, 0.16792987287044525, 0.1645495891571045], [0.1706865280866623, 0.16327506303787231, 0.17522019147872925, 0.1623057723045349, 0.17417998611927032, 0.1543324887752533], [0.16707080602645874, 0.16634610295295715, 0.16750024259090424, 0.1662491261959076, 0.16740259528160095, 0.16543106734752655], [0.17041239142417908, 0.16352130472660065, 0.17461733520030975, 0.1626184582710266, 0.1736532300710678, 0.15517722070217133], [0.1645875722169876, 0.16824865341186523, 0.16246314346790314, 0.16874586045742035, 0.1629432588815689, 0.17301145195960999]], [[0.1675419956445694, 0.1668655276298523, 0.16741648316383362, 0.1667405217885971, 0.16574877500534058, 0.16568666696548462], [0.16491255164146423, 0.166258305311203, 0.16516102850437164, 0.16650880873203278, 0.16851624846458435, 0.16864314675331116], [0.1670539528131485, 0.1667550504207611, 0.16699853539466858, 0.16669975221157074, 0.16626013815402985, 0.16623257100582123], [0.16442687809467316, 0.16614291071891785, 0.16474342346191406, 0.1664627343416214, 0.16903072595596313, 0.1691933572292328], [0.16057758033275604, 0.16519209742546082, 0.16142255067825317, 0.16606135666370392, 0.17314574122428894, 0.1736007034778595], [0.16033679246902466, 0.16513048112392426, 0.1612141728401184, 0.16603408753871918, 0.17340536415576935, 0.17387916147708893]], [[0.16667278110980988, 0.16163676977157593, 0.16972003877162933, 0.16937118768692017, 0.1690230518579483, 0.163576140999794], [0.1666734516620636, 0.16543443500995636, 0.16740946471691132, 0.1673257201910019, 0.16724200546741486, 0.16591499745845795], [0.16665706038475037, 0.15942054986953735, 0.17108368873596191, 0.1705750972032547, 0.17006804049015045, 0.1621955931186676], [0.166659414768219, 0.15967126190662384, 0.17092886567115784, 0.17043854296207428, 0.16994963586330414, 0.16235233843326569], [0.16666162014007568, 0.15992219746112823, 0.17077401280403137, 0.1703019142150879, 0.16983112692832947, 0.16250909864902496], [0.1666770875453949, 0.16395147144794464, 0.1683078557252884, 0.16812185943126678, 0.1679360568523407, 0.16500569880008698]], [[0.16780099272727966, 0.167123481631279, 0.1661294400691986, 0.16699828207492828, 0.1660050004720688, 0.16594278812408447], [0.16440260410308838, 0.16574420034885406, 0.16774243116378784, 0.16599392890930176, 0.1679951548576355, 0.16812166571617126], [0.15947185456752777, 0.16368506848812103, 0.17010155320167542, 0.16447767615318298, 0.17092522978782654, 0.17133855819702148], [0.1637779027223587, 0.1654871553182602, 0.16804009675979614, 0.16580572724342346, 0.1683635711669922, 0.1685255616903305], [0.15885919332504272, 0.16342434287071228, 0.17039623856544495, 0.16428430378437042, 0.17129287123680115, 0.17174296081066132], [0.15855345129966736, 0.16329383850097656, 0.17054344713687897, 0.16418738663196564, 0.17147667706012726, 0.17194519937038422]], [[0.17241518199443817, 0.16720566153526306, 0.16686198115348816, 0.16651900112628937, 0.1661767214536667, 0.16082154214382172], [0.16805310547351837, 0.16680383682250977, 0.16672039031982422, 0.16663698852062225, 0.16655361652374268, 0.16523206233978271], [0.1677631437778473, 0.16677552461624146, 0.16670949757099152, 0.16664350032806396, 0.1665775328874588, 0.16553077101707458], [0.16747352480888367, 0.1667470633983612, 0.16669845581054688, 0.16664987802505493, 0.1666012853384018, 0.1658298373222351], [0.16718420386314392, 0.16671840846538544, 0.1666872203350067, 0.166656032204628, 0.16662484407424927, 0.16612926125526428], [0.16262218356132507, 0.16623954474925995, 0.166484996676445, 0.16673080623149872, 0.16697698831558228, 0.17094546556472778]], [[0.1649111807346344, 0.1662585586309433, 0.1682654470205307, 0.16650937497615814, 0.16540908813476562, 0.16864633560180664], [0.16229885816574097, 0.16562888026237488, 0.1706642061471939, 0.1662532240152359, 0.16352470219135284, 0.17163006961345673], [0.15847806632518768, 0.16465890407562256, 0.17421524226665497, 0.16583004593849182, 0.160740464925766, 0.1760772317647934], [0.1618167906999588, 0.16550973057746887, 0.1711094230413437, 0.16620302200317383, 0.16317526996135712, 0.17218567430973053], [0.1639413982629776, 0.1660279482603073, 0.16915321350097656, 0.16641739010810852, 0.1647113561630249, 0.1697486937046051], [0.1577623337507248, 0.1644706279039383, 0.17488613724708557, 0.16574425995349884, 0.16021513938903809, 0.17692148685455322]]], "__all_modules__": {"num_env_steps_trained": 36000, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 215460, "num_env_steps_trained_lifetime": 648000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 4561.110686633375, "num_module_steps_trained_throughput": 20994342.240590014, "num_module_steps_trained_lifetime_throughput": 13147117.506564334}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.445868999588934e-05, "normalize_and_clip_actions": 7.623322810099294e-06, "remove_single_ts_time_rank_from_batch": 1.1433859101743912e-05, "listify_data_for_vector_env": 1.0055125737023969e-05, "get_actions": 3.37366686823639e-05, "un_batch_to_individual_items": 6.332737867351643e-06}}, "connector_pipeline_timer": 0.00010871119428228909}, "episode_duration_sec_mean": 0.005024527616333216, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.682657971416301e-06, "numpy_to_tensor": 1.1422193816690783e-05, "add_time_dim_to_batch_and_zero_pad": 6.61572202546747e-06, "batch_individual_items": 1.1949587173253433e-05, "add_states_from_episodes_to_batch": 2.612261703312586e-06}}, "connector_pipeline_timer": 5.670836605968403e-05}, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "num_episodes_lifetime": 360, "num_env_steps_sampled_lifetime": 90400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": -1.55}, "episode_return_max": 14.5, "env_step_timer": 1.3235821207451745e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "rlmodule_inference_timer": 2.8950687018246125e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_mean": -1.55, "env_reset_timer": 0.00029115338583741605, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_min": -12.5, "agent_episode_returns_mean": {"default_agent": -1.55}, "weights_seq_no": 18.0, "sample": 0.11421524714023099, "episode_len_max": 20, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "time_between_sampling": 9.364025669978592}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "b483a_00000", "date": "2025-08-11_18-55-42", "timestamp": 1754931342, "time_this_iter_s": 9.691344976425171, "time_total_s": 170.15700221061707, "pid": 11892, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fcf98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 170.15700221061707, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 36.18461538461538, "ram_util_percent": 77.60769230769232}}
{"timers": {"training_iteration": 9.381292165779133, "restore_env_runners": 1.0230892358682167e-05, "training_step": 9.381140271188865, "env_runner_sampling_timer": 1.6018291579910673, "learner_update_timer": 7.587260705709346, "synch_weights": 0.001067086942650613, "restore_eval_env_runners": 1.0158541504809517e-05, "evaluation_iteration": 0.12154392238048528, "synch_eval_env_connectors": 0.0001449849023776742, "synch_env_connectors": 4.3665618867979345e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00011448675878828665, "timers": {"connectors": {"get_actions": 3.7801267236487536e-05, "un_batch_to_individual_items": 6.4229942379548496e-06, "remove_single_ts_time_rank_from_batch": 1.162672169764311e-05, "tensor_to_numpy": 1.4784383233461712e-05, "normalize_and_clip_actions": 7.756179637612826e-06, "listify_data_for_vector_env": 1.0148760316641935e-05}}}, "time_between_sampling": 0.033002920687227565, "num_env_steps_sampled_lifetime": -10487500.0, "module_episode_returns_mean": {"default_policy": 0.17999999999999997}, "num_episodes": 250.0, "env_reset_timer": 3.224869096518947e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7338915977841976e-06, "numpy_to_tensor": 1.2268329940410256e-05, "batch_individual_items": 1.2230692194637994e-05, "add_states_from_episodes_to_batch": 2.6806502832208196e-06, "add_time_dim_to_batch_and_zero_pad": 6.846171615232157e-06}}, "connector_pipeline_timer": 5.829494957247508e-05}, "episode_return_max": 10.5, "env_step_timer": 1.3641054955332245e-05, "rlmodule_inference_timer": 3.083490781570598e-05, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -9.5, "agent_episode_returns_mean": {"default_agent": 0.17999999999999997}, "episode_return_mean": 0.17999999999999997, "episode_duration_sec_mean": 0.005132904040627182, "weights_seq_no": 18.0, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "num_episodes_lifetime": -524375.0, "sample": 0.005522463614052992, "num_env_steps_sampled_lifetime_throughput": 3398.681046194804}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15308873320417735, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008913599210273696, "add_observations_from_episodes_to_batch": 0.0008968526001963891, "add_columns_from_episodes_to_train_batch": 0.042243069208001485, "add_time_dim_to_batch_and_zero_pad": 0.08965335212773992, "add_states_from_episodes_to_batch": 0.0036676405654427918, "batch_individual_items": 0.007503493294312539, "numpy_to_tensor": 6.347344045918512e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 113715, "weights_seq_no": 19.0, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained": 5985, "module_train_batch_size_mean": 997.9718428097785, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 756.1125192445204}, "default_policy": {"num_module_steps_trained_lifetime": 113715, "mean_kl_loss": 1.3298800695338286e-05, "vf_loss": 0.32050901651382446, "weights_seq_no": 19.0, "policy_loss": -4.8593628889648244e-05, "module_train_batch_size_mean": 997.9718428097785, "use_intrinsic_rewards": 0.0, "entropy": 0.6931111812591553, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5985, "vf_explained_var": -0.0002570152282714844, "vf_loss_unclipped": 42.250003814697266, "total_loss": 0.24857474863529205, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 3.0819688845440396e-07, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 756.1076251786286}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "policy_loss": -4.7804434871068224e-05, "use_intrinsic_rewards": 1.0, "entropy": 0.6931113600730896, "module_train_batch_size_mean": 997.4940209352853, "total_loss": 0.2485855221748352, "diff_num_grad_updates_vs_sampler_policy": 96.0, "vf_explained_var": -0.0007257461547851562, "num_module_steps_trained_lifetime": 682290, "mean_kl_loss": 1.3111708540236577e-05, "vf_loss_unclipped": 42.26077651977539, "vf_loss": 0.3205191195011139, "weights_seq_no": 114.0}, "__all_modules__": {"num_module_steps_trained_lifetime": 1364580, "num_env_steps_trained_lifetime": 4104000, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 48634.37901510781}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 96.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 682290, "weights_seq_no": 114.0, "module_train_batch_size_mean": 997.4940209352853, "num_module_steps_trained": 35910}}}, "IntrinsicAttentionMask": [[[0.16803239285945892, 0.16595874726772308, 0.1660456657409668, 0.1661326289176941, 0.16621963679790497, 0.16761092841625214], [0.16163413226604462, 0.16929744184017181, 0.1689671128988266, 0.16863740980625153, 0.1683083474636078, 0.16315551102161407], [0.16190071403980255, 0.16915719211101532, 0.16884475946426392, 0.16853289306163788, 0.1682216227054596, 0.16334275901317596], [0.16216759383678436, 0.16901691257953644, 0.16872234642505646, 0.16842830181121826, 0.16813477873802185, 0.16353008151054382], [0.16243474185466766, 0.1688765585422516, 0.16859984397888184, 0.1683236062526703, 0.16804780066013336, 0.16371743381023407], [0.16672565042972565, 0.16663603484630585, 0.1666398048400879, 0.16664358973503113, 0.16664735972881317, 0.16670753061771393]], [[0.16702516376972198, 0.16789866983890533, 0.16690002381801605, 0.16622614860534668, 0.16523747146129608, 0.16671250760555267], [0.1683855652809143, 0.17272616922855377, 0.16777093708515167, 0.16449154913425446, 0.15977256000041962, 0.16685320436954498], [0.16682575643062592, 0.1672113686800003, 0.16677041351795197, 0.16647203266620636, 0.16603302955627441, 0.16668745875358582], [0.1657322496175766, 0.16352857649326324, 0.16605129837989807, 0.16778427362442017, 0.17037265002727509, 0.1665310263633728], [0.16406840085983276, 0.15818342566490173, 0.16493172943592072, 0.16967140138149261, 0.17690978944301605, 0.1662352830171585], [0.1665247678756714, 0.16618338227272034, 0.16657386720180511, 0.16683921217918396, 0.1672312468290329, 0.1666475534439087]], [[0.166948601603508, 0.16488833725452423, 0.16712352633476257, 0.16721104085445404, 0.16729861497879028, 0.16652986407279968], [0.1655820906162262, 0.1734325885772705, 0.16493654251098633, 0.1646147072315216, 0.16429351270198822, 0.1671406328678131], [0.16706006228923798, 0.1641831248998642, 0.16730496287345886, 0.16742753982543945, 0.1675502210855484, 0.16647416353225708], [0.16711553931236267, 0.16383138298988342, 0.1673954874277115, 0.16753563284873962, 0.1676758974790573, 0.16644605994224548], [0.16717088222503662, 0.1634802371263504, 0.16748589277267456, 0.16764362156391144, 0.16780149936676025, 0.16641779243946075], [0.16667895019054413, 0.16658934950828552, 0.1666865050792694, 0.16669028997421265, 0.1666940599679947, 0.1666608303785324]], [[0.17207367718219757, 0.1580124944448471, 0.17283469438552856, 0.15871131420135498, 0.16438531875610352, 0.17398253083229065], [0.16211839020252228, 0.1739850640296936, 0.1615266352891922, 0.173349991440773, 0.1683768779039383, 0.1606430560350418], [0.1725802719593048, 0.15720397233963013, 0.17341595888137817, 0.15796521306037903, 0.1641574651002884, 0.1746770739555359], [0.16264069080352783, 0.17314274609088898, 0.16211473941802979, 0.17258283495903015, 0.16819003224372864, 0.1613290011882782], [0.16677294671535492, 0.1664961278438568, 0.1667872816324234, 0.1665104478597641, 0.16662445664405823, 0.16680879890918732], [0.1733383983373642, 0.15599484741687775, 0.17428691685199738, 0.1568484604358673, 0.16381192207336426, 0.17571943998336792]], [[0.17092715203762054, 0.16576260328292847, 0.1740521937608719, 0.16508185863494873, 0.16474254429340363, 0.15943358838558197], [0.16770513355731964, 0.16645844280719757, 0.16844570636749268, 0.16629193723201752, 0.16620875895023346, 0.16488993167877197], [0.1728220283985138, 0.1653178334236145, 0.17741240561008453, 0.1643364280462265, 0.1638478934764862, 0.15626338124275208], [0.16727186739444733, 0.1665462851524353, 0.1677018254995346, 0.16644920408725739, 0.16640068590641022, 0.16563016176223755], [0.1670551300048828, 0.16658969223499298, 0.16733059287071228, 0.1665273755788803, 0.16649621725082397, 0.16600100696086884], [0.16359752416610718, 0.1672365814447403, 0.16148588061332703, 0.16773079335689545, 0.1679784506559372, 0.17197072505950928]], [[0.1670253574848175, 0.16635097563266754, 0.16690023243427277, 0.1677730828523636, 0.1652376502752304, 0.1667127013206482], [0.16593772172927856, 0.16729184985160828, 0.16618773341178894, 0.16445544362068176, 0.16956382989883423, 0.1665634661912918], [0.1668257713317871, 0.16652730107307434, 0.16677044332027435, 0.1671559363603592, 0.1660330593585968, 0.166687473654747], [0.16819676756858826, 0.16528132557868958, 0.16765284538269043, 0.17147529125213623, 0.16055350005626678, 0.16684027016162872], [0.1640775352716446, 0.16879265010356903, 0.16494092345237732, 0.1590246856212616, 0.17691963911056519, 0.1662445366382599], [0.16652478277683258, 0.16679005324840546, 0.1665738821029663, 0.1662324070930481, 0.1672312617301941, 0.16664758324623108]]], "__all_modules__": {"num_env_steps_trained": 36000, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 227430, "num_env_steps_trained_lifetime": 684000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 4551.249438891297, "num_module_steps_trained_throughput": 20582639.84988723, "num_module_steps_trained_lifetime_throughput": 13145364.94798398}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5066198696523056e-05, "normalize_and_clip_actions": 7.789665198726845e-06, "remove_single_ts_time_rank_from_batch": 1.1677831585330887e-05, "listify_data_for_vector_env": 1.0296782779528918e-05, "get_actions": 3.7063127410660155e-05, "un_batch_to_individual_items": 6.521919448856766e-06}}, "connector_pipeline_timer": 0.00011411610162271757}, "episode_duration_sec_mean": 0.005029794233851134, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.74080848072875e-06, "numpy_to_tensor": 1.18919109482204e-05, "add_time_dim_to_batch_and_zero_pad": 6.787197959520731e-06, "batch_individual_items": 1.2442222284133082e-05, "add_states_from_episodes_to_batch": 2.61033828013669e-06}}, "connector_pipeline_timer": 5.9302604831614055e-05}, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "num_episodes_lifetime": 380, "num_env_steps_sampled_lifetime": 95400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": -0.35}, "episode_return_max": 14.5, "env_step_timer": 1.3816075995010787e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "rlmodule_inference_timer": 3.077550725373975e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_mean": -0.35, "env_reset_timer": 0.00028901144223950287, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_min": -12.5, "agent_episode_returns_mean": {"default_agent": -0.35}, "weights_seq_no": 19.0, "sample": 0.11416001299864871, "episode_len_max": 20, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "time_between_sampling": 9.36357299077858}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "b483a_00000", "date": "2025-08-11_18-55-52", "timestamp": 1754931352, "time_this_iter_s": 9.413250923156738, "time_total_s": 179.5702531337738, "pid": 11892, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fcf98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 179.5702531337738, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 33.66428571428571, "ram_util_percent": 77.88571428571427}}
{"timers": {"training_iteration": 9.373414267461039, "restore_env_runners": 1.0184832990295682e-05, "training_step": 9.373261708476416, "env_runner_sampling_timer": 1.6003616618312295, "learner_update_timer": 7.580723989902773, "synch_weights": 0.0010685052432739827, "restore_eval_env_runners": 1.013987639519231e-05, "evaluation_iteration": 0.1214657706558307, "synch_eval_env_connectors": 0.00014451380353062523, "synch_env_connectors": 4.37039604754178e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00011284699561220979, "timers": {"connectors": {"get_actions": 3.6998323693560624e-05, "un_batch_to_individual_items": 6.3445325432663326e-06, "remove_single_ts_time_rank_from_batch": 1.1447797140105544e-05, "tensor_to_numpy": 1.4594877678068723e-05, "normalize_and_clip_actions": 7.728481611502197e-06, "listify_data_for_vector_env": 1.0012427509468384e-05}}}, "time_between_sampling": 0.03230795666718073, "num_env_steps_sampled_lifetime": -11105000.0, "module_episode_returns_mean": {"default_policy": 1.3799999999999994}, "num_episodes": 250.0, "env_reset_timer": 3.0041379929968937e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.699180505526702e-06, "numpy_to_tensor": 1.1932562556326145e-05, "batch_individual_items": 1.207915786752238e-05, "add_states_from_episodes_to_batch": 2.632751598496756e-06, "add_time_dim_to_batch_and_zero_pad": 6.84270233864469e-06}}, "connector_pipeline_timer": 5.755067120347994e-05}, "episode_return_max": 10.5, "env_step_timer": 1.332918526050633e-05, "rlmodule_inference_timer": 3.032023154754435e-05, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -9.5, "agent_episode_returns_mean": {"default_agent": 1.3799999999999994}, "episode_return_mean": 1.3799999999999994, "episode_duration_sec_mean": 0.005047786675393581, "weights_seq_no": 19.0, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "num_episodes_lifetime": -555250.0, "sample": 0.005398824164194708, "num_env_steps_sampled_lifetime_throughput": 3428.4054778544782}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15313978296193084, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008913249058369356, "add_observations_from_episodes_to_batch": 0.0008971578235049485, "add_columns_from_episodes_to_train_batch": 0.04226206810649501, "add_time_dim_to_batch_and_zero_pad": 0.08968525527668204, "add_states_from_episodes_to_batch": 0.0036693233191592485, "batch_individual_items": 0.00750223127118763, "numpy_to_tensor": 6.364161670846755e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 119700, "weights_seq_no": 20.0, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained": 5985, "module_train_batch_size_mean": 997.9437895346426, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 755.3756946896923}, "default_policy": {"num_module_steps_trained_lifetime": 119700, "mean_kl_loss": 7.370007097051712e-06, "vf_loss": 0.32050925493240356, "weights_seq_no": 20.0, "policy_loss": -5.061213960289024e-05, "module_train_batch_size_mean": 997.9437895346426, "use_intrinsic_rewards": 0.0, "entropy": 0.6930786371231079, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5985, "vf_explained_var": -0.00023567676544189453, "vf_loss_unclipped": 42.29621505737305, "total_loss": 0.2485729306936264, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 1.5409844422720198e-07, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 755.3711657226963}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"num_module_steps_trained": 35910, "policy_loss": -4.95679269079119e-05, "use_intrinsic_rewards": 1.0, "entropy": 0.6930789351463318, "module_train_batch_size_mean": 997.4935477577241, "total_loss": 0.24858178198337555, "diff_num_grad_updates_vs_sampler_policy": 101.0, "vf_explained_var": -0.0006729364395141602, "num_module_steps_trained_lifetime": 718200, "mean_kl_loss": 7.2571783675812185e-06, "vf_loss_unclipped": 42.30370330810547, "vf_loss": 0.32051774859428406, "weights_seq_no": 120.0}, "__all_modules__": {"num_module_steps_trained_lifetime": 1436400, "num_env_steps_trained_lifetime": 4320000, "num_module_steps_trained": 71820, "num_env_steps_trained": 216000, "num_env_steps_trained_lifetime_throughput": 48041.01110396285}, "intrinsic_reward_module": {"diff_num_grad_updates_vs_sampler_policy": 101.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 718200, "weights_seq_no": 120.0, "module_train_batch_size_mean": 997.4935477577241, "num_module_steps_trained": 35910}}}, "IntrinsicAttentionMask": [[[0.16730888187885284, 0.16739650070667267, 0.16748416423797607, 0.16541728377342224, 0.16550390422344208, 0.1668892204761505], [0.16743673384189606, 0.16754192113876343, 0.16764716804027557, 0.16516868770122528, 0.16527244448661804, 0.1669331043958664], [0.1675644814968109, 0.16768725216388702, 0.1678101271390915, 0.16492027044296265, 0.16504110395908356, 0.16697682440280914], [0.16451211273670197, 0.16422541439533234, 0.1639392077922821, 0.1708633303642273, 0.17056556046009064, 0.1658942997455597], [0.16464176774024963, 0.16437199711799622, 0.1641026884317398, 0.17061063647270203, 0.17033109068870544, 0.16594190895557404], [0.1666945219039917, 0.16669830679893494, 0.16670207679271698, 0.16661247611045837, 0.16661624610424042, 0.1666763871908188]], [[0.1675420105457306, 0.1668655425310135, 0.1674164980649948, 0.1667405217885971, 0.16574877500534058, 0.16568666696548462], [0.16491253674030304, 0.166258305311203, 0.16516101360321045, 0.16650880873203278, 0.16851624846458435, 0.16864314675331116], [0.1670539677143097, 0.1667550653219223, 0.16699855029582977, 0.16669976711273193, 0.16626015305519104, 0.16623258590698242], [0.16442687809467316, 0.16614291071891785, 0.16474342346191406, 0.1664627343416214, 0.16903072595596313, 0.1691933572292328], [0.16057758033275604, 0.1651921272277832, 0.16142256557941437, 0.1660613715648651, 0.17314574122428894, 0.1736007034778595], [0.16033679246902466, 0.16513048112392426, 0.1612141728401184, 0.16603408753871918, 0.17340534925460815, 0.17387914657592773]], [[0.16730813682079315, 0.16524341702461243, 0.1653299629688263, 0.16757112741470337, 0.16765889525413513, 0.16688847541809082], [0.16424225270748138, 0.17202921211719513, 0.17169354856014252, 0.16328270733356476, 0.1629641056060791, 0.1657881885766983], [0.16437312960624695, 0.17174041271209717, 0.17142319679260254, 0.1634640246629715, 0.16316209733486176, 0.16583721339702606], [0.1676902174949646, 0.16439475119113922, 0.1645323932170868, 0.16811174154281616, 0.16825249791145325, 0.16701842844486237], [0.16781727969646454, 0.16411235928535461, 0.1642669141292572, 0.1682918518781662, 0.16845034062862396, 0.16706128418445587], [0.1666945219039917, 0.1666049212217331, 0.16660869121551514, 0.16670586168766022, 0.16670963168144226, 0.1666763871908188]], [[0.16541914641857147, 0.16369277238845825, 0.1687837541103363, 0.16702225804328918, 0.16903835535049438, 0.1660436987876892], [0.1678147166967392, 0.1694578379392624, 0.16470558941364288, 0.16631825268268585, 0.16447515785694122, 0.16722841560840607], [0.1607055813074112, 0.15297065675258636, 0.17666396498680115, 0.16816093027591705, 0.17792049050331116, 0.16357842087745667], [0.16317950189113617, 0.15850049257278442, 0.17255041003227234, 0.16760268807411194, 0.17327319085597992, 0.16489370167255402], [0.1603470742702484, 0.1521863043308258, 0.17725618183612823, 0.16823484003543854, 0.1785915195941925, 0.16338403522968292], [0.16454817354679108, 0.16165168583393097, 0.17025363445281982, 0.167256698012352, 0.17068861424922943, 0.1656012237071991]], [[0.16527900099754333, 0.1686474233865738, 0.1683007776737213, 0.16795483231544495, 0.16760961711406708, 0.16220828890800476], [0.1645813286304474, 0.16963018476963043, 0.16910827159881592, 0.16858795285224915, 0.1680692434310913, 0.16002307832241058], [0.16465267539024353, 0.16953003406524658, 0.16902606189250946, 0.1685236096382141, 0.16802264750003815, 0.1602448970079422], [0.16472399234771729, 0.16942988336086273, 0.168943852186203, 0.1684592366218567, 0.1679759919643402, 0.1604669690132141], [0.16479526460170746, 0.1693297177553177, 0.16886161267757416, 0.1683948040008545, 0.1679292917251587, 0.16068927943706512], [0.1659233570098877, 0.1677321195602417, 0.16754674911499023, 0.16736158728599548, 0.16717663407325745, 0.16425952315330505]], [[0.16645698249340057, 0.16471979022026062, 0.1667080968618393, 0.16807016730308533, 0.16695956885814667, 0.1670854538679123], [0.16685618460178375, 0.16848991811275482, 0.16662275791168213, 0.16536827385425568, 0.16638965904712677, 0.16627323627471924], [0.1663978546857834, 0.16418324410915375, 0.1667184829711914, 0.16846010088920593, 0.16703975200653076, 0.16720061004161835], [0.16607098281383514, 0.16130906343460083, 0.16676662862300873, 0.17057256400585175, 0.1674651801586151, 0.16781556606292725], [0.16633827984333038, 0.16364797949790955, 0.1667284220457077, 0.16885046660900116, 0.16711948812007904, 0.16731537878513336], [0.16630832850933075, 0.16338084638118744, 0.16673322021961212, 0.1690458208322525, 0.16715921461582184, 0.16737262904644012]]], "__all_modules__": {"num_env_steps_trained": 36000, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 239400, "num_env_steps_trained_lifetime": 720000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_env_steps_trained_lifetime_throughput": 4546.7016408190875, "num_module_steps_trained_throughput": 20203921.039108966, "num_module_steps_trained_lifetime_throughput": 13156258.262716018}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.6227828779359454e-05, "normalize_and_clip_actions": 8.220243579015303e-06, "remove_single_ts_time_rank_from_batch": 1.2324862071854138e-05, "listify_data_for_vector_env": 1.0825260602010707e-05, "get_actions": 3.834159424258236e-05, "un_batch_to_individual_items": 6.721025701251353e-06}}, "connector_pipeline_timer": 0.0001200744281800282}, "episode_duration_sec_mean": 0.005155195463448763, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.887194704830363e-06, "numpy_to_tensor": 1.299976178104262e-05, "add_time_dim_to_batch_and_zero_pad": 7.323892358559479e-06, "batch_individual_items": 1.3159345149145527e-05, "add_states_from_episodes_to_batch": 2.786668636642786e-06}}, "connector_pipeline_timer": 6.228111490545105e-05}, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "num_episodes_lifetime": 400, "num_env_steps_sampled_lifetime": 100400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 0.05}, "episode_return_max": 14.5, "env_step_timer": 1.491426778276101e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "rlmodule_inference_timer": 3.311603904035931e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_mean": 0.05, "env_reset_timer": 0.00028729548693228824, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_return_min": -12.5, "agent_episode_returns_mean": {"default_agent": 0.05}, "weights_seq_no": 20.0, "sample": 0.114241427039199, "episode_len_max": 20, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "time_between_sampling": 9.35612714629082}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "b483a_00000", "date": "2025-08-11_18-56-00", "timestamp": 1754931360, "time_this_iter_s": 8.726529121398926, "time_total_s": 188.29678225517273, "pid": 11892, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fcf98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 188.29678225517273, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 17.416666666666668, "ram_util_percent": 76.65833333333335}}
