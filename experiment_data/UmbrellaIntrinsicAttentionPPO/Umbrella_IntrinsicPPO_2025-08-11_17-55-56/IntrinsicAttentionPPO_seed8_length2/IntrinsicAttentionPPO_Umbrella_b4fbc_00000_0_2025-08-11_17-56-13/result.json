{"timers": {"training_iteration": 10.64075562497601, "restore_env_runners": 8.458970114588737e-06, "training_step": 10.640574541990645, "env_runner_sampling_timer": 1.6832966250367463, "learner_update_timer": 8.743529040948488, "synch_weights": 0.0017045000568032265}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.3189253436574251e-05, "add_states_from_episodes_to_batch": 2.894471827968113e-06, "add_observations_from_episodes_to_batch": 3.025591283610702e-06, "add_time_dim_to_batch_and_zero_pad": 7.5681067934726605e-06, "numpy_to_tensor": 1.3721883379359282e-05}}, "connector_pipeline_timer": 6.532671098911654e-05}, "episode_return_mean": -0.7800000000000001, "episode_return_min": -11.5, "env_step_timer": 1.5470687492137552e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.573746575708054e-05, "normalize_and_clip_actions": 1.047170952545949e-05, "un_batch_to_individual_items": 6.9416754837424516e-06, "listify_data_for_vector_env": 1.1010879191981504e-05, "remove_single_ts_time_rank_from_batch": 1.2449350296767534e-05, "tensor_to_numpy": 1.6024326554483806e-05}}, "connector_pipeline_timer": 0.00013043886808277477}, "sample": 0.006758499367229631, "rlmodule_inference_timer": 5.561380558743085e-05, "env_to_module_sum_episodes_length_out": 10.191744832559449, "env_reset_timer": 8.252212435043507e-05, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "env_to_module_sum_episodes_length_in": 10.191744832559449, "agent_episode_returns_mean": {"default_agent": -0.7800000000000001}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005842342343647032, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": 31375.0, "module_episode_returns_mean": {"default_policy": -0.7800000000000001}, "num_episodes": 250.0, "time_between_sampling": 0.0005206800992460449, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 627500.0, "episode_len_min": 20, "weights_seq_no": 0.0, "episode_return_max": 8.5, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 2956.530358852462}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000, "learner_connector": {"connector_pipeline_timer": 0.17495224997401237, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.010430834023281932, "add_observations_from_episodes_to_batch": 0.0008470419561490417, "add_columns_from_episodes_to_train_batch": 0.043355417088605464, "add_time_dim_to_batch_and_zero_pad": 0.10373137495480478, "add_states_from_episodes_to_batch": 0.003505582921206951, "batch_individual_items": 0.012789541040547192, "numpy_to_tensor": 9.295798372477293e-05}}}, "learner_connector_sum_episodes_length_out": 5250}, "learners": {"default_policy": {"use_intrinsic_rewards": 0.0, "curr_kl_coeff": 0.08079196512699127, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.00345766544342041, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_trainable_parameters": 16595, "vf_loss_unclipped": 39.12440872192383, "num_module_steps_trained_lifetime": 5994, "vf_loss": 0.263994961977005, "entropy": 0.6924600005149841, "mean_kl_loss": 7.057702532620169e-06, "policy_loss": 1.1386429832782596e-05, "module_train_batch_size_mean": 999.0, "weights_seq_no": 1.0, "total_loss": 0.20460952818393707, "num_module_steps_trained_lifetime_throughput": 717.1935230603144}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.20533569157123566, "weights_seq_no": 6.0, "diff_num_grad_updates_vs_sampler_policy": 6.0, "vf_explained_var": 0.0014372467994689941, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 38.8890380859375, "num_module_steps_trained_lifetime": 35964, "vf_loss": 0.26492443680763245, "entropy": 0.6924562454223633, "mean_kl_loss": 7.4420763667149e-06, "policy_loss": 1.3382025827013422e-05, "module_train_batch_size_mean": 999.0}, "__all_modules__": {"num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 71928, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 189000, "num_env_steps_trained_lifetime_throughput": 51372.578265932854}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "weights_seq_no": 6.0, "diff_num_grad_updates_vs_sampler_policy": 6.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 35964}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 11988, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 31500, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime_throughput": 3769.142683837676, "num_module_steps_trained_throughput": 27030812.116434682, "num_module_steps_trained_lifetime_throughput": 12553502.449281972}, "intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained_lifetime": 5994, "default_optimizer_learning_rate": 0.0002715581955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 999.0, "weights_seq_no": 1.0, "num_module_steps_trained_lifetime_throughput": 717.2030710021797}, "IntrinsicAttentionMask": [[[0.3336332440376282, 0.3322843909263611, 0.33408233523368835], [0.3339559733867645, 0.3311516344547272, 0.3348924219608307], [0.333525687456131, 0.3326609432697296, 0.333813339471817]], [[0.3320602774620056, 0.33712098002433777, 0.33081871271133423], [0.3327254056930542, 0.3351459801197052, 0.3321286141872406], [0.3318948447704315, 0.33761098980903625, 0.3304941952228546]], [[0.33023321628570557, 0.3372240364551544, 0.3325427174568176], [0.33430877327919006, 0.33211416006088257, 0.33357706665992737], [0.33158835768699646, 0.33552026748657227, 0.3328913152217865]], [[0.3320520520210266, 0.33777448534965515, 0.33017343282699585], [0.3323831558227539, 0.33663299679756165, 0.33098387718200684], [0.33194178342819214, 0.3381539583206177, 0.32990434765815735]], [[0.33324435353279114, 0.3311086893081665, 0.33564695715904236], [0.3331213593482971, 0.32838961482048035, 0.33848902583122253], [0.3333635628223419, 0.3341551125049591, 0.332481324672699]], [[0.3127443790435791, 0.378430038690567, 0.3088255524635315], [0.44210556149482727, 0.03291557356715202, 0.5249788761138916], [0.2914957106113434, 0.42415085434913635, 0.28435343503952026]]]}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "weights_seq_no": 1.0, "episode_return_max": 14.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.416190404775062e-06, "add_observations_from_episodes_to_batch": 2.8749738799922582e-06, "add_states_from_episodes_to_batch": 2.706361032575139e-06, "numpy_to_tensor": 1.2360932866638148e-05, "batch_individual_items": 1.2531592605117341e-05}}, "connector_pipeline_timer": 6.204980336633079e-05}, "episode_return_mean": 1.75, "env_step_timer": 1.4593654774966118e-05, "rlmodule_inference_timer": 3.442675580786463e-05, "env_reset_timer": 0.0004317089915275574, "num_episodes": 20, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.647505485960385e-06, "listify_data_for_vector_env": 1.0211388399477749e-05, "tensor_to_numpy": 1.583814469240665e-05, "remove_single_ts_time_rank_from_batch": 1.2502505157695252e-05, "get_actions": 4.133905577560203e-05, "un_batch_to_individual_items": 6.57407272810358e-06}}, "connector_pipeline_timer": 0.00012138655434221312}, "episode_return_min": -14.5, "env_to_module_sum_episodes_length_in": 10.216013141322508, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 1.75}, "num_episodes_lifetime": 20, "module_episode_returns_mean": {"default_policy": 1.75}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "sample": 0.11381650005932897, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "episode_duration_sec_mean": 0.005199504096526653, "num_env_steps_sampled_lifetime": 5400, "env_to_module_sum_episodes_length_out": 10.216013141322508}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "b4fbc_00000", "date": "2025-08-11_18-51-30", "timestamp": 1754931090, "time_this_iter_s": 10.765554904937744, "time_total_s": 10.765554904937744, "pid": 11863, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1551fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.765554904937744, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 36.73125, "ram_util_percent": 81.23124999999999}}
{"timers": {"training_iteration": 10.634692187895999, "restore_env_runners": 8.442300604656338e-06, "training_step": 10.634510591151193, "env_runner_sampling_timer": 1.6817433833668474, "learner_update_timer": 8.737643948458135, "synch_weights": 0.0016957504767924547, "restore_eval_env_runners": 5.8959005400538445e-05, "evaluation_iteration": 0.12267195899039507, "synch_eval_env_connectors": 0.00017766596283763647, "synch_env_connectors": 4.582921974360943e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2388001580884687e-05, "add_states_from_episodes_to_batch": 2.741687375708676e-06, "add_observations_from_episodes_to_batch": 2.7989334878978994e-06, "add_time_dim_to_batch_and_zero_pad": 7.116549901532468e-06, "numpy_to_tensor": 1.2459463215746615e-05}}, "connector_pipeline_timer": 5.941010156022435e-05}, "episode_return_mean": -0.7000000000000002, "episode_return_min": -11.5, "env_step_timer": 1.4022081362375976e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.9040143104117835e-05, "normalize_and_clip_actions": 7.97489957816714e-06, "un_batch_to_individual_items": 6.532858909720654e-06, "listify_data_for_vector_env": 1.0452585324924449e-05, "remove_single_ts_time_rank_from_batch": 1.180663215688994e-05, "tensor_to_numpy": 1.5158537120580871e-05}}, "connector_pipeline_timer": 0.00011720759567979313}, "sample": 0.005953743267795295, "rlmodule_inference_timer": 3.155706972276783e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 4.482246162802747e-05, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": -0.7000000000000002}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005245098164770748, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": 500.0, "module_episode_returns_mean": {"default_policy": -0.7000000000000002}, "num_episodes": 250.0, "time_between_sampling": 0.03400896015424709, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 10000.0, "episode_len_min": 20, "weights_seq_no": 1.0, "episode_return_max": 8.5, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3263.9681938709755}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1762268187245354, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.010414421512978151, "add_observations_from_episodes_to_batch": 0.0008468936267308891, "add_columns_from_episodes_to_train_batch": 0.04333729708800092, "add_time_dim_to_batch_and_zero_pad": 0.10372106662602164, "add_states_from_episodes_to_batch": 0.0035077633429318666, "batch_individual_items": 0.014108016050886362, "numpy_to_tensor": 9.274673415347934e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"use_intrinsic_rewards": 0.0, "curr_kl_coeff": 0.040395982563495636, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.004395961761474609, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_trainable_parameters": 16595, "vf_loss_unclipped": 38.66508102416992, "num_module_steps_trained_lifetime": 11988, "vf_loss": 0.2643081843852997, "entropy": 0.6924608945846558, "mean_kl_loss": 8.773446324994438e-07, "policy_loss": -4.945418186252937e-05, "module_train_batch_size_mean": 999.0, "weights_seq_no": 2.0, "total_loss": 0.2047916054725647, "num_module_steps_trained_lifetime_throughput": 716.650172145818}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.20494484901428223, "weights_seq_no": 12.0, "diff_num_grad_updates_vs_sampler_policy": 11.0, "vf_explained_var": 0.0011873841285705566, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 38.46562194824219, "num_module_steps_trained_lifetime": 71928, "vf_loss": 0.26450315117836, "entropy": 0.6924611926078796, "mean_kl_loss": 8.626901149000332e-07, "policy_loss": -4.817459193873219e-05, "module_train_batch_size_mean": 999.0}, "__all_modules__": {"num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 143856, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 378000, "num_env_steps_trained_lifetime_throughput": 51096.4616047414}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "weights_seq_no": 12.0, "diff_num_grad_updates_vs_sampler_policy": 11.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 71928}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 23976, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 63000, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime_throughput": 3766.285741038847, "num_module_steps_trained_throughput": 26698189.21411949, "num_module_steps_trained_lifetime_throughput": 12557417.596253417}, "intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained_lifetime": 11988, "default_optimizer_learning_rate": 0.0002715581955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 999.0, "weights_seq_no": 2.0, "num_module_steps_trained_lifetime_throughput": 716.6595789195358}, "IntrinsicAttentionMask": [[[0.33430925011634827, 0.3309314548969269, 0.33475926518440247], [0.33692535758018494, 0.32446303963661194, 0.3386116623878479], [0.3339594304561615, 0.3317931294441223, 0.3342474400997162]], [[0.3345242738723755, 0.3333319127559662, 0.3321438133716583], [0.33456459641456604, 0.333331823348999, 0.3321036100387573], [0.3346049189567566, 0.33333173394203186, 0.3320634067058563]], [[0.32039767503738403, 0.34022316336631775, 0.339379221200943], [0.3356321454048157, 0.3321114778518677, 0.33225637674331665], [0.3349948525428772, 0.33245015144348145, 0.33255502581596375]], [[0.32368743419647217, 0.3434911072254181, 0.33282148838043213], [0.32814881205558777, 0.33876803517341614, 0.3330830931663513], [0.3257756531238556, 0.34127503633499146, 0.33294931054115295]], [[0.3255191445350647, 0.33178505301475525, 0.34269586205482483], [0.3305402994155884, 0.33279716968536377, 0.33666256070137024], [0.33909448981285095, 0.334379106760025, 0.3265264332294464]], [[0.3462212383747101, 0.30982300639152527, 0.3439558148384094], [0.5448303818702698, 0.0148400217294693, 0.44032958149909973], [0.36908459663391113, 0.2686912417411804, 0.36222419142723083]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "weights_seq_no": 2.0, "episode_return_max": 14.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.081135811206027e-06, "add_observations_from_episodes_to_batch": 2.8686291076703365e-06, "add_states_from_episodes_to_batch": 2.7403954209070634e-06, "numpy_to_tensor": 1.2730778840961247e-05, "batch_individual_items": 1.2615487014855165e-05}}, "connector_pipeline_timer": 6.033936727755576e-05}, "episode_return_mean": 2.75, "env_step_timer": 1.4597740696687298e-05, "rlmodule_inference_timer": 3.242218738717169e-05, "env_reset_timer": 0.0004283631511498243, "num_episodes": 20, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.357798183943819e-06, "listify_data_for_vector_env": 1.0551982332947968e-05, "tensor_to_numpy": 1.528705658683356e-05, "remove_single_ts_time_rank_from_batch": 1.2092372038517119e-05, "get_actions": 3.9121319158425213e-05, "un_batch_to_individual_items": 6.622198951567765e-06}}, "connector_pipeline_timer": 0.000119038644352022}, "episode_return_min": -14.5, "env_to_module_sum_episodes_length_in": 10.366003441359926, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 2.75}, "num_episodes_lifetime": 40, "module_episode_returns_mean": {"default_policy": 2.75}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "sample": 0.11382998005836271, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "episode_duration_sec_mean": 0.005236208249698393, "num_env_steps_sampled_lifetime": 10400, "env_to_module_sum_episodes_length_out": 10.366003441359926, "time_between_sampling": 10.076396208023652}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "b4fbc_00000", "date": "2025-08-11_18-51-40", "timestamp": 1754931100, "time_this_iter_s": 10.157086372375488, "time_total_s": 20.922641277313232, "pid": 11863, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1551fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20.922641277313232, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 35.471428571428575, "ram_util_percent": 80.74285714285715}}
{"timers": {"training_iteration": 10.636908519766202, "restore_env_runners": 8.417048014234752e-06, "training_step": 10.636726421070145, "env_runner_sampling_timer": 1.6802349970330834, "learner_update_timer": 8.741327403133688, "synch_weights": 0.0016900517224799842, "restore_eval_env_runners": 5.8451915392652155e-05, "evaluation_iteration": 0.12264803773025051, "synch_eval_env_connectors": 0.00017691930290311575, "synch_env_connectors": 4.5837624929845334e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2410812696114967e-05, "add_states_from_episodes_to_batch": 2.7507386110216567e-06, "add_observations_from_episodes_to_batch": 2.795252399333719e-06, "add_time_dim_to_batch_and_zero_pad": 7.053954351686762e-06, "numpy_to_tensor": 1.2521305499704595e-05}}, "connector_pipeline_timer": 5.9516972123168304e-05}, "episode_return_mean": -1.3400000000000003, "episode_return_min": -11.5, "env_step_timer": 1.401063853841619e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.896577377646138e-05, "normalize_and_clip_actions": 7.993425778895888e-06, "un_batch_to_individual_items": 6.581242501363601e-06, "listify_data_for_vector_env": 1.0536490694484462e-05, "remove_single_ts_time_rank_from_batch": 1.1888101511604688e-05, "tensor_to_numpy": 1.5164646146840171e-05}}, "connector_pipeline_timer": 0.00011758559347972082}, "sample": 0.005667552180037913, "rlmodule_inference_timer": 3.162938172192592e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 4.198356294920368e-05, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": -1.3400000000000003}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005258232464082539, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -30375.0, "module_episode_returns_mean": {"default_policy": -1.3400000000000003}, "num_episodes": 250.0, "time_between_sampling": 0.034978060720983126, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -607500.0, "episode_len_min": 20, "weights_seq_no": 2.0, "episode_return_max": 8.5, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3254.308083560612}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17616918512713164, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.010401310208707583, "add_observations_from_episodes_to_batch": 0.0008467088594799861, "add_columns_from_episodes_to_train_batch": 0.04331789327741135, "add_time_dim_to_batch_and_zero_pad": 0.10371036511947168, "add_states_from_episodes_to_batch": 0.0035098682103212923, "batch_individual_items": 0.014092612560954875, "numpy_to_tensor": 9.2576347081922e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"use_intrinsic_rewards": 0.0, "curr_kl_coeff": 0.020197991281747818, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.002164006233215332, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_trainable_parameters": 16595, "vf_loss_unclipped": 38.92510986328125, "num_module_steps_trained_lifetime": 17982, "vf_loss": 0.26397445797920227, "entropy": 0.6922520399093628, "mean_kl_loss": 1.0800154996104538e-05, "policy_loss": -0.00016734978999011219, "module_train_batch_size_mean": 999.0, "weights_seq_no": 3.0, "total_loss": 0.20441441237926483, "num_module_steps_trained_lifetime_throughput": 714.8558633071931}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.20465722680091858, "weights_seq_no": 18.0, "diff_num_grad_updates_vs_sampler_policy": 16.0, "vf_explained_var": 0.0008214712142944336, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 38.77562713623047, "num_module_steps_trained_lifetime": 107892, "vf_loss": 0.26427730917930603, "entropy": 0.6922593116760254, "mean_kl_loss": 9.988028068619315e-06, "policy_loss": -0.00016167286958079785, "module_train_batch_size_mean": 999.0}, "__all_modules__": {"num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 215784, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 567000, "num_env_steps_trained_lifetime_throughput": 50596.56085611568}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "weights_seq_no": 18.0, "diff_num_grad_updates_vs_sampler_policy": 16.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 107892}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 35964, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 94500, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime_throughput": 3756.85369698226, "num_module_steps_trained_throughput": 26158559.909740143, "num_module_steps_trained_lifetime_throughput": 12528148.865997694}, "intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained_lifetime": 17982, "default_optimizer_learning_rate": 0.0002715581955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 999.0, "weights_seq_no": 3.0, "num_module_steps_trained_lifetime_throughput": 714.8650451075123}, "IntrinsicAttentionMask": [[[0.3331841826438904, 0.3346152603626251, 0.3322005569934845], [0.33360666036605835, 0.3309219181537628, 0.33547142148017883], [0.33287879824638367, 0.33717262744903564, 0.32994866371154785]], [[0.3366505205631256, 0.32836097478866577, 0.334988534450531], [0.3382796347141266, 0.32592904567718506, 0.33579131960868835], [0.33697399497032166, 0.3278774917125702, 0.3351484537124634]], [[0.3253253102302551, 0.3377562463283539, 0.3369184136390686], [0.33119580149650574, 0.3345124423503876, 0.3342917561531067], [0.33080536127090454, 0.3347279727458954, 0.33446672558784485]], [[0.3275095522403717, 0.3475470244884491, 0.3249434232711792], [0.3302345275878906, 0.34092122316360474, 0.328844279050827], [0.32714542746543884, 0.3484291732311249, 0.3244253695011139]], [[0.33524253964424133, 0.33494046330451965, 0.3298170268535614], [0.33549776673316956, 0.3351549506187439, 0.3293473720550537], [0.33983898162841797, 0.3387913107872009, 0.3213696777820587]], [[0.315197229385376, 0.37707939743995667, 0.30772340297698975], [0.4065572917461395, 0.04134274274110794, 0.5520999431610107], [0.2779202461242676, 0.4624751806259155, 0.2596046030521393]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "weights_seq_no": 3.0, "episode_return_max": 14.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.4620544455567775e-06, "add_observations_from_episodes_to_batch": 3.0576485800445266e-06, "add_states_from_episodes_to_batch": 2.8860567730651423e-06, "numpy_to_tensor": 1.4022977923922697e-05, "batch_individual_items": 1.358587863038714e-05}}, "connector_pipeline_timer": 6.531860661222024e-05}, "episode_return_mean": 2.75, "env_step_timer": 1.6836203016526675e-05, "rlmodule_inference_timer": 3.626841844009878e-05, "env_reset_timer": 0.0004257245193584822, "num_episodes": 20, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.202869380429086e-06, "listify_data_for_vector_env": 1.2291324199232533e-05, "tensor_to_numpy": 1.656967328752413e-05, "remove_single_ts_time_rank_from_batch": 1.3098245462374638e-05, "get_actions": 4.262945584066954e-05, "un_batch_to_individual_items": 7.421484447250315e-06}}, "connector_pipeline_timer": 0.00013001586000541764}, "episode_return_min": -14.5, "env_to_module_sum_episodes_length_in": 10.368205581254823, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 2.75}, "num_episodes_lifetime": 60, "module_episode_returns_mean": {"default_policy": 2.75}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "sample": 0.11404001733834158, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "episode_duration_sec_mean": 0.005553458314777041, "num_env_steps_sampled_lifetime": 15400, "env_to_module_sum_episodes_length_out": 10.368205581254823, "time_between_sampling": 10.084432769692503}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "b4fbc_00000", "date": "2025-08-11_18-51-51", "timestamp": 1754931111, "time_this_iter_s": 11.003010988235474, "time_total_s": 31.925652265548706, "pid": 11863, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1551fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 31.925652265548706, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 40.725, "ram_util_percent": 81.03125}}
{"timers": {"training_iteration": 10.63972510456811, "restore_env_runners": 8.429538339958527e-06, "training_step": 10.63954199977928, "env_runner_sampling_timer": 1.679910940812722, "learner_update_timer": 8.744343285771766, "synch_weights": 0.0016867182852779515, "restore_eval_env_runners": 5.812947623198852e-05, "evaluation_iteration": 0.12285436527228448, "synch_eval_env_connectors": 0.00018075718982145188, "synch_env_connectors": 4.5841743471100926e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.310524640916959e-05, "add_states_from_episodes_to_batch": 2.8750584716561757e-06, "add_observations_from_episodes_to_batch": 2.9741859930217566e-06, "add_time_dim_to_batch_and_zero_pad": 7.529042908109413e-06, "numpy_to_tensor": 1.3623559696957412e-05}}, "connector_pipeline_timer": 6.294816059993393e-05}, "episode_return_mean": -1.5, "episode_return_min": -11.5, "env_step_timer": 1.5049578114732246e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.335302817646844e-05, "normalize_and_clip_actions": 8.51488221986438e-06, "un_batch_to_individual_items": 6.936058474091796e-06, "listify_data_for_vector_env": 1.125729626891285e-05, "remove_single_ts_time_rank_from_batch": 1.2462566443921586e-05, "tensor_to_numpy": 1.6211540371642233e-05}}, "connector_pipeline_timer": 0.00012650229082502784}, "sample": 0.005842549432747909, "rlmodule_inference_timer": 3.436101009627454e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 4.627780410614913e-05, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": -1.5}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005639226324390622, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -61250.0, "module_episode_returns_mean": {"default_policy": -1.5}, "num_episodes": 250.0, "time_between_sampling": 0.038184196821428214, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -1225000.0, "episode_len_min": 20, "weights_seq_no": 3.0, "episode_return_max": 8.5, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3076.569729017371}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17617612160559745, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.01039689876724279, "add_observations_from_episodes_to_batch": 0.0008476796902467032, "add_columns_from_episodes_to_train_batch": 0.04331027059432096, "add_time_dim_to_batch_and_zero_pad": 0.1037375773081804, "add_states_from_episodes_to_batch": 0.003518072437689174, "batch_individual_items": 0.01407607893549255, "numpy_to_tensor": 9.231891349633225e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"use_intrinsic_rewards": 0.0, "curr_kl_coeff": 0.010098995640873909, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.00027251243591308594, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_trainable_parameters": 16595, "vf_loss_unclipped": 38.53803253173828, "num_module_steps_trained_lifetime": 23976, "vf_loss": 0.2639445960521698, "entropy": 0.6920530200004578, "mean_kl_loss": 1.3550023140851408e-05, "policy_loss": -0.00033447094028815627, "module_train_batch_size_mean": 999.0, "weights_seq_no": 4.0, "total_loss": 0.20422418415546417, "num_module_steps_trained_lifetime_throughput": 712.1585692696733}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.20439253747463226, "weights_seq_no": 24.0, "diff_num_grad_updates_vs_sampler_policy": 21.0, "vf_explained_var": 0.0006788969039916992, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 38.50640106201172, "num_module_steps_trained_lifetime": 143856, "vf_loss": 0.2641276717185974, "entropy": 0.6920709013938904, "mean_kl_loss": 1.162150965683395e-05, "policy_loss": -0.000310327741317451, "module_train_batch_size_mean": 999.0}, "__all_modules__": {"num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 287712, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 756000, "num_env_steps_trained_lifetime_throughput": 49933.09287201942}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "weights_seq_no": 24.0, "diff_num_grad_updates_vs_sampler_policy": 21.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 143856}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 47952, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 126000, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime_throughput": 3742.675598437, "num_module_steps_trained_throughput": 25567269.706324298, "num_module_steps_trained_lifetime_throughput": 12519838.378248265}, "intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained_lifetime": 23976, "default_optimizer_learning_rate": 0.0002715581955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 999.0, "weights_seq_no": 4.0, "num_module_steps_trained_lifetime_throughput": 712.1674652751204}, "IntrinsicAttentionMask": [[[0.3329521715641022, 0.33160609006881714, 0.3354417085647583], [0.3325319290161133, 0.3297395706176758, 0.3377285301685333], [0.33370324969291687, 0.335042804479599, 0.33125394582748413]], [[0.33018767833709717, 0.3352198004722595, 0.3345925211906433], [0.3318239748477936, 0.3342379629611969, 0.3339380621910095], [0.33162111043930054, 0.33435961604118347, 0.334019273519516]], [[0.3228396475315094, 0.34281620383262634, 0.33434417843818665], [0.3351903557777405, 0.33167433738708496, 0.3331352770328522], [0.33001983165740967, 0.3363076448440552, 0.33367252349853516]], [[0.32915255427360535, 0.3435571789741516, 0.32729029655456543], [0.3318520486354828, 0.33696770668029785, 0.33118027448654175], [0.3287917673587799, 0.34443458914756775, 0.32677367329597473]], [[0.33272355794906616, 0.332788348197937, 0.3344880938529968], [0.3331020772457123, 0.33312666416168213, 0.333771288394928], [0.34288379549980164, 0.34182673692703247, 0.3152894377708435]], [[0.2936027944087982, 0.41964954137802124, 0.28674763441085815], [0.4420110285282135, 0.03887300193309784, 0.5191159844398499], [0.27147483825683594, 0.46660324931144714, 0.2619219422340393]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "weights_seq_no": 4.0, "episode_return_max": 14.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 8.312573360530682e-06, "add_observations_from_episodes_to_batch": 3.3019550941504244e-06, "add_states_from_episodes_to_batch": 3.0788222512662944e-06, "numpy_to_tensor": 1.359826227408988e-05, "batch_individual_items": 1.4001112048090228e-05}}, "connector_pipeline_timer": 6.815779852862309e-05}, "episode_return_mean": 2.5, "env_step_timer": 1.6922548127510128e-05, "rlmodule_inference_timer": 3.5384590781316465e-05, "env_reset_timer": 0.0004250364445318701, "num_episodes": 20, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.479256202893384e-06, "listify_data_for_vector_env": 1.224697323970132e-05, "tensor_to_numpy": 1.709226200251897e-05, "remove_single_ts_time_rank_from_batch": 1.2943723932309897e-05, "get_actions": 4.5226355652824116e-05, "un_batch_to_individual_items": 7.21166893580469e-06}}, "connector_pipeline_timer": 0.00013310566212939448}, "episode_return_min": -14.5, "env_to_module_sum_episodes_length_in": 10.368237912813044, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 2.5}, "num_episodes_lifetime": 80, "module_episode_returns_mean": {"default_policy": 2.5}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "sample": 0.11418202175395925, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "episode_duration_sec_mean": 0.005624827604333404, "num_env_steps_sampled_lifetime": 20400, "env_to_module_sum_episodes_length_out": 10.368237912813044, "time_between_sampling": 10.093031950745404}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "b4fbc_00000", "date": "2025-08-11_18-52-02", "timestamp": 1754931122, "time_this_iter_s": 11.05855393409729, "time_total_s": 42.984206199645996, "pid": 11863, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1551fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 42.984206199645996, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 41.275, "ram_util_percent": 81.25625}}
{"timers": {"training_iteration": 10.638787176022237, "restore_env_runners": 8.421912923360942e-06, "training_step": 10.638602679781789, "env_runner_sampling_timer": 1.680706112234248, "learner_update_timer": 8.742563237504346, "synch_weights": 0.0016779923530075838, "restore_eval_env_runners": 5.772485103376676e-05, "evaluation_iteration": 0.12299757245000148, "synch_eval_env_connectors": 0.00018030419866833835, "synch_env_connectors": 4.591242203256115e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.3981281377873537e-05, "add_states_from_episodes_to_batch": 3.0140298689044755e-06, "add_observations_from_episodes_to_batch": 3.1328516825264335e-06, "add_time_dim_to_batch_and_zero_pad": 8.040000771193462e-06, "numpy_to_tensor": 1.4601425036642703e-05}}, "connector_pipeline_timer": 6.678176311041406e-05}, "episode_return_mean": 0.09999999999999998, "episode_return_min": -11.5, "env_step_timer": 1.6391237676196296e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.7334299319984384e-05, "normalize_and_clip_actions": 8.966362645056805e-06, "un_batch_to_individual_items": 7.3019233483047005e-06, "listify_data_for_vector_env": 1.1878166478598994e-05, "remove_single_ts_time_rank_from_batch": 1.30055699633337e-05, "tensor_to_numpy": 1.7351237417566113e-05}}, "connector_pipeline_timer": 0.00013497187171426772}, "sample": 0.006360232787849683, "rlmodule_inference_timer": 3.709066297071229e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 5.498220142028177e-05, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 0.09999999999999998}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.006022470214869825, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -92125.0, "module_episode_returns_mean": {"default_policy": 0.09999999999999998}, "num_episodes": 250.0, "time_between_sampling": 0.03827653551331126, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -1842500.0, "episode_len_min": 20, "weights_seq_no": 4.0, "episode_return_max": 8.5, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 2869.6092862899213}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17613323954884857, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.010383441028715855, "add_observations_from_episodes_to_batch": 0.0008474891427024431, "add_columns_from_episodes_to_train_batch": 0.04329381371864206, "add_time_dim_to_batch_and_zero_pad": 0.10373444653601792, "add_states_from_episodes_to_batch": 0.003522733793171509, "batch_individual_items": 0.014061524816094071, "numpy_to_tensor": 9.330572377105943e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"use_intrinsic_rewards": 0.0, "curr_kl_coeff": 0.0050494978204369545, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.0002536177635192871, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_trainable_parameters": 16595, "vf_loss_unclipped": 38.898284912109375, "num_module_steps_trained_lifetime": 29970, "vf_loss": 0.2639111578464508, "entropy": 0.6913740038871765, "mean_kl_loss": 7.029694097582251e-05, "policy_loss": -0.0007651907508261502, "module_train_batch_size_mean": 999.0, "weights_seq_no": 5.0, "total_loss": 0.20376892387866974, "num_module_steps_trained_lifetime_throughput": 709.3500783148886}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.2039075791835785, "weights_seq_no": 30.0, "diff_num_grad_updates_vs_sampler_policy": 26.0, "vf_explained_var": 0.0005027651786804199, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 38.88492965698242, "num_module_steps_trained_lifetime": 179820, "vf_loss": 0.2640429437160492, "entropy": 0.691398024559021, "mean_kl_loss": 6.559005851158872e-05, "policy_loss": -0.0007390158716589212, "module_train_batch_size_mean": 999.0}, "__all_modules__": {"num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 359640, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 945000, "num_env_steps_trained_lifetime_throughput": 49173.42324324854}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "weights_seq_no": 30.0, "diff_num_grad_updates_vs_sampler_policy": 26.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 179820}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 59940, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 157500, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime_throughput": 3727.9127557544807, "num_module_steps_trained_throughput": 24961551.64881728, "num_module_steps_trained_lifetime_throughput": 12521029.651606603}, "intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained_lifetime": 29970, "default_optimizer_learning_rate": 0.0002715581955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 999.0, "weights_seq_no": 5.0, "num_module_steps_trained_lifetime_throughput": 709.3586343902363}, "IntrinsicAttentionMask": [[[0.33430925011634827, 0.3309314548969269, 0.33475926518440247], [0.33692532777786255, 0.3244630694389343, 0.3386116325855255], [0.3339594304561615, 0.3317931294441223, 0.3342474400997162]], [[0.3309043049812317, 0.32972484827041626, 0.33937081694602966], [0.3308214843273163, 0.32960250973701477, 0.33957594633102417], [0.33148905634880066, 0.3305899202823639, 0.33792102336883545]], [[0.3299984931945801, 0.3339376747608185, 0.33606383204460144], [0.3377588093280792, 0.33250802755355835, 0.3297332227230072], [0.34194087982177734, 0.3317039906978607, 0.32635512948036194]], [[0.333962619304657, 0.33626189827919006, 0.32977551221847534], [0.3335631191730499, 0.3343912661075592, 0.33204564452171326], [0.3346753716468811, 0.3397056460380554, 0.32561901211738586]], [[0.33524253964424133, 0.33494046330451965, 0.3298170268535614], [0.33549776673316956, 0.3351549506187439, 0.3293473720550537], [0.3398389518260956, 0.33879128098487854, 0.3213696777820587]], [[0.34488049149513245, 0.31045839190483093, 0.3446611762046814], [0.4950476884841919, 0.019497346132993698, 0.48545488715171814], [0.3469139635562897, 0.3064323961734772, 0.34665364027023315]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "weights_seq_no": 5.0, "episode_return_max": 14.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.706806969890188e-06, "add_observations_from_episodes_to_batch": 2.7663584362655176e-06, "add_states_from_episodes_to_batch": 2.683266000180736e-06, "numpy_to_tensor": 1.1825550810129498e-05, "batch_individual_items": 1.232081371045169e-05}}, "connector_pipeline_timer": 5.8158379219643136e-05}, "episode_return_mean": 2.35, "env_step_timer": 1.377532353202223e-05, "rlmodule_inference_timer": 3.1878744180601164e-05, "env_reset_timer": 0.0004216994199864042, "num_episodes": 20, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.009415059386364e-06, "listify_data_for_vector_env": 1.0224783229786728e-05, "tensor_to_numpy": 1.460214396354421e-05, "remove_single_ts_time_rank_from_batch": 1.1852990709861654e-05, "get_actions": 3.5640825130657544e-05, "un_batch_to_individual_items": 6.533210267278984e-06}}, "connector_pipeline_timer": 0.00011301079617255347}, "episode_return_min": -14.5, "env_to_module_sum_episodes_length_in": 10.368238387501162, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 2.35}, "num_episodes_lifetime": 100, "module_episode_returns_mean": {"default_policy": 2.35}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "sample": 0.11416880569587726, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "episode_duration_sec_mean": 0.005535782945808023, "num_env_steps_sampled_lifetime": 25400, "env_to_module_sum_episodes_length_out": 10.368238387501162, "time_between_sampling": 10.097844147908093}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "b4fbc_00000", "date": "2025-08-11_18-52-13", "timestamp": 1754931133, "time_this_iter_s": 10.666757106781006, "time_total_s": 53.650963306427, "pid": 11863, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1551fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 53.650963306427, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 41.166666666666664, "ram_util_percent": 81.18000000000002}}
{"timers": {"training_iteration": 10.636616164261593, "restore_env_runners": 8.401023729201185e-06, "training_step": 10.636431188823826, "env_runner_sampling_timer": 1.679491633611281, "learner_update_timer": 8.741558399710364, "synch_weights": 0.0016752153486745904, "restore_eval_env_runners": 5.721426193670719e-05, "evaluation_iteration": 0.12294976672473026, "synch_eval_env_connectors": 0.00017968407604980282, "synch_env_connectors": 4.586990168292541e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2648704428513325e-05, "add_states_from_episodes_to_batch": 2.7891707658531477e-06, "add_observations_from_episodes_to_batch": 2.857946045515431e-06, "add_time_dim_to_batch_and_zero_pad": 7.213246462071752e-06, "numpy_to_tensor": 1.283018020728269e-05}}, "connector_pipeline_timer": 6.041367749059297e-05}, "episode_return_mean": -0.06, "episode_return_min": -11.5, "env_step_timer": 1.437462950595166e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.0313314089801116e-05, "normalize_and_clip_actions": 8.11532573354476e-06, "un_batch_to_individual_items": 6.636592828285038e-06, "listify_data_for_vector_env": 1.0734941867662103e-05, "remove_single_ts_time_rank_from_batch": 1.1980484561558427e-05, "tensor_to_numpy": 1.554889906669657e-05}}, "connector_pipeline_timer": 0.00012002186706142623}, "sample": 0.005906081007757778, "rlmodule_inference_timer": 3.259568056865849e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 4.361030508897181e-05, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": -0.06}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005370337171945721, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -123000.0, "module_episode_returns_mean": {"default_policy": -0.06}, "num_episodes": 250.0, "time_between_sampling": 0.036360873536192724, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -2460000.0, "episode_len_min": 20, "weights_seq_no": 5.0, "episode_return_max": 8.5, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3209.7181710498894}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17608416465339952, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.01036905370813245, "add_observations_from_episodes_to_batch": 0.0008472700917874112, "add_columns_from_episodes_to_train_batch": 0.04328198516165767, "add_time_dim_to_batch_and_zero_pad": 0.1037260737415517, "add_states_from_episodes_to_batch": 0.003524415205429262, "batch_individual_items": 0.014046622067654106, "numpy_to_tensor": 9.303933750024227e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"use_intrinsic_rewards": 0.0, "curr_kl_coeff": 0.0025247489102184772, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.0001404285430908203, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_trainable_parameters": 16595, "vf_loss_unclipped": 38.72917175292969, "num_module_steps_trained_lifetime": 35964, "vf_loss": 0.2638840973377228, "entropy": 0.6910197734832764, "mean_kl_loss": 1.9585586414905265e-05, "policy_loss": -9.029646025737748e-05, "module_train_batch_size_mean": 999.0, "weights_seq_no": 6.0, "total_loss": 0.20442266762256622, "num_module_steps_trained_lifetime_throughput": 706.3725587762191}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.20450524985790253, "weights_seq_no": 36.0, "diff_num_grad_updates_vs_sampler_policy": 31.0, "vf_explained_var": 0.00042361021041870117, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 38.700016021728516, "num_module_steps_trained_lifetime": 215784, "vf_loss": 0.2639838457107544, "entropy": 0.6910220980644226, "mean_kl_loss": 1.9336966943228617e-05, "policy_loss": -8.841518865665421e-05, "module_train_batch_size_mean": 999.0}, "__all_modules__": {"num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 431568, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 1134000, "num_env_steps_trained_lifetime_throughput": 48361.47460178239}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "weights_seq_no": 36.0, "diff_num_grad_updates_vs_sampler_policy": 31.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 215784}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 71928, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 189000, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime_throughput": 3712.2613916720265, "num_module_steps_trained_throughput": 24351139.185992617, "num_module_steps_trained_lifetime_throughput": 12517230.397485437}, "intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained_lifetime": 35964, "default_optimizer_learning_rate": 0.0002715581955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 999.0, "weights_seq_no": 6.0, "num_module_steps_trained_lifetime_throughput": 706.3807356329962}, "IntrinsicAttentionMask": [[[0.3336332142353058, 0.3322843909263611, 0.33408233523368835], [0.33395594358444214, 0.3311516344547272, 0.3348923921585083], [0.333525687456131, 0.3326609432697296, 0.333813339471817]], [[0.3345242738723755, 0.3333319127559662, 0.3321438133716583], [0.33456459641456604, 0.333331823348999, 0.3321036100387573], [0.3346049189567566, 0.33333173394203186, 0.3320634067058563]], [[0.33371421694755554, 0.33309119939804077, 0.3331945538520813], [0.33460816740989685, 0.33252328634262085, 0.3328685462474823], [0.33445966243743896, 0.3326176106929779, 0.3329227566719055]], [[0.3300476670265198, 0.34137699007987976, 0.32857540249824524], [0.33273306488990784, 0.33480775356292725, 0.3324592113494873], [0.3296887278556824, 0.3422517776489258, 0.32805952429771423]], [[0.3316408395767212, 0.33190497756004333, 0.3364541530609131], [0.331898033618927, 0.33212223649024963, 0.33597978949546814], [0.3362734019756317, 0.33580633997917175, 0.32792019844055176]], [[0.3462211787700653, 0.30982303619384766, 0.34395575523376465], [0.5448303818702698, 0.014840018935501575, 0.44032958149909973], [0.36908453702926636, 0.2686912715435028, 0.36222413182258606]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "weights_seq_no": 6.0, "episode_return_max": 14.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.15422876821649e-06, "add_observations_from_episodes_to_batch": 2.9327274266325016e-06, "add_states_from_episodes_to_batch": 2.812604524149056e-06, "numpy_to_tensor": 1.2966285565149302e-05, "batch_individual_items": 1.2921873499119033e-05}}, "connector_pipeline_timer": 6.143829017480189e-05}, "episode_return_mean": 1.75, "env_step_timer": 1.5227735032213682e-05, "rlmodule_inference_timer": 3.413703497713742e-05, "env_reset_timer": 0.00041887867623193587, "num_episodes": 20, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.47963249304198e-06, "listify_data_for_vector_env": 1.0856085257640609e-05, "tensor_to_numpy": 1.5804988819342728e-05, "remove_single_ts_time_rank_from_batch": 1.2388377820713125e-05, "get_actions": 3.9898606303638036e-05, "un_batch_to_individual_items": 6.833326246445512e-06}}, "connector_pipeline_timer": 0.00012156290127211386}, "episode_return_min": -14.5, "env_to_module_sum_episodes_length_in": 10.368238394470474, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 1.75}, "num_episodes_lifetime": 120, "module_episode_returns_mean": {"default_policy": 1.75}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "sample": 0.11429922763847272, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "episode_duration_sec_mean": 0.005661572152748704, "num_env_steps_sampled_lifetime": 30400, "env_to_module_sum_episodes_length_out": 10.368238394470474, "time_between_sampling": 10.101301040178292}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "b4fbc_00000", "date": "2025-08-11_18-52-23", "timestamp": 1754931143, "time_this_iter_s": 10.55823278427124, "time_total_s": 64.20919609069824, "pid": 11863, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1551fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 64.20919609069824, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 39.440000000000005, "ram_util_percent": 81.12666666666668}}
{"timers": {"training_iteration": 10.637216309279301, "restore_env_runners": 8.420353044788507e-06, "training_step": 10.637030905685668, "env_runner_sampling_timer": 1.6796959260253717, "learner_update_timer": 8.741898686134212, "synch_weights": 0.0016677906946166083, "restore_eval_env_runners": 5.703420961371289e-05, "evaluation_iteration": 0.12305851863748628, "synch_eval_env_connectors": 0.000179593485766887, "synch_env_connectors": 4.586119445108599e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2739240789534258e-05, "add_states_from_episodes_to_batch": 2.829557552429408e-06, "add_observations_from_episodes_to_batch": 2.8945840959945007e-06, "add_time_dim_to_batch_and_zero_pad": 7.300948964767571e-06, "numpy_to_tensor": 1.3114953600754434e-05}}, "connector_pipeline_timer": 6.130449364541223e-05}, "episode_return_mean": -1.0999999999999996, "episode_return_min": -11.5, "env_step_timer": 1.4584842953031875e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.14719400893973e-05, "normalize_and_clip_actions": 8.212061032339776e-06, "un_batch_to_individual_items": 6.738468497963595e-06, "listify_data_for_vector_env": 1.0806104241870789e-05, "remove_single_ts_time_rank_from_batch": 1.2141191028362834e-05, "tensor_to_numpy": 1.573118609938532e-05}}, "connector_pipeline_timer": 0.00012202869962728306}, "sample": 0.005878491027522071, "rlmodule_inference_timer": 3.312233294135743e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 4.326483418385665e-05, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": -1.0999999999999996}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005453001322224736, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -153875.0, "module_episode_returns_mean": {"default_policy": -1.0999999999999996}, "num_episodes": 250.0, "time_between_sampling": 0.03691771488904148, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -3077500.0, "episode_len_min": 20, "weights_seq_no": 6.0, "episode_return_max": 8.5, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3129.62431793223}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1760390767570426, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.010354050671734717, "add_observations_from_episodes_to_batch": 0.0008483786407752872, "add_columns_from_episodes_to_train_batch": 0.04326570614067004, "add_time_dim_to_batch_and_zero_pad": 0.10372011175444917, "add_states_from_episodes_to_batch": 0.003530606883437225, "batch_individual_items": 0.014032219597335863, "numpy_to_tensor": 9.29506140963632e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"use_intrinsic_rewards": 0.0, "curr_kl_coeff": 0.0012623744551092386, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.0002588033676147461, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_trainable_parameters": 16595, "vf_loss_unclipped": 39.04661178588867, "num_module_steps_trained_lifetime": 41958, "vf_loss": 0.2638849914073944, "entropy": 0.6903255581855774, "mean_kl_loss": 4.293188248993829e-05, "policy_loss": -0.0007045867969281971, "module_train_batch_size_mean": 999.0, "weights_seq_no": 7.0, "total_loss": 0.20381012558937073, "num_module_steps_trained_lifetime_throughput": 703.3049740102542}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.20389826595783234, "weights_seq_no": 42.0, "diff_num_grad_updates_vs_sampler_policy": 36.0, "vf_explained_var": 0.000299990177154541, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 39.01438522338867, "num_module_steps_trained_lifetime": 251748, "vf_loss": 0.26394903659820557, "entropy": 0.6903586983680725, "mean_kl_loss": 3.892607492161915e-05, "policy_loss": -0.0006724662380293012, "module_train_batch_size_mean": 999.0}, "__all_modules__": {"num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 503496, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 1323000, "num_env_steps_trained_lifetime_throughput": 47521.01422245342}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "weights_seq_no": 42.0, "diff_num_grad_updates_vs_sampler_policy": 36.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 251748}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 83916, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 220500, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime_throughput": 3696.1365861165013, "num_module_steps_trained_throughput": 23753205.177550327, "num_module_steps_trained_lifetime_throughput": 12512634.857695384}, "intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained_lifetime": 41958, "default_optimizer_learning_rate": 0.0002715581955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 999.0, "weights_seq_no": 7.0, "num_module_steps_trained_lifetime_throughput": 703.3127657717284}, "IntrinsicAttentionMask": [[[0.333609402179718, 0.3350422978401184, 0.33134832978248596], [0.3327946066856384, 0.3301163613796234, 0.33708903193473816], [0.33478739857673645, 0.3428879976272583, 0.32232466340065]], [[0.3320602774620056, 0.33712098002433777, 0.33081871271133423], [0.3327254056930542, 0.3351459503173828, 0.3321286141872406], [0.3318948447704315, 0.33761098980903625, 0.3304941952228546]], [[0.3292115330696106, 0.3355260491371155, 0.3352624475955963], [0.34465232491493225, 0.3273242115974426, 0.3280234634876251], [0.3440067768096924, 0.3276664614677429, 0.3283267617225647]], [[0.33279964327812195, 0.33857327699661255, 0.3286271095275879], [0.3336304724216461, 0.3302002549171448, 0.3361693322658539], [0.3321104943752289, 0.34476590156555176, 0.3231235444545746]], [[0.33524250984191895, 0.33494043350219727, 0.3298170268535614], [0.33549773693084717, 0.3351549208164215, 0.3293473422527313], [0.33983901143074036, 0.3387913405895233, 0.32136964797973633]], [[0.3462211787700653, 0.30982309579849243, 0.34395575523376465], [0.5448307991027832, 0.01483974326401949, 0.4403294622898102], [0.3690846562385559, 0.2686910927295685, 0.3622242510318756]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "weights_seq_no": 7.0, "episode_return_max": 14.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.708808927914746e-06, "add_observations_from_episodes_to_batch": 2.735722652131948e-06, "add_states_from_episodes_to_batch": 2.6634263817424037e-06, "numpy_to_tensor": 1.1707952390332996e-05, "batch_individual_items": 1.2088073156808744e-05}}, "connector_pipeline_timer": 5.738996816000568e-05}, "episode_return_mean": 1.55, "env_step_timer": 1.3608109183799855e-05, "rlmodule_inference_timer": 3.0253501880094602e-05, "env_reset_timer": 0.000415556969413035, "num_episodes": 20, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.909431166592618e-06, "listify_data_for_vector_env": 1.0262897365869376e-05, "tensor_to_numpy": 1.4632864909078238e-05, "remove_single_ts_time_rank_from_batch": 1.177444829118268e-05, "get_actions": 3.4757607328994556e-05, "un_batch_to_individual_items": 6.492287837623395e-06}}, "connector_pipeline_timer": 0.00011170321052111077}, "episode_return_min": -14.5, "env_to_module_sum_episodes_length_in": 10.368238394572801, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 1.55}, "num_episodes_lifetime": 140, "module_episode_returns_mean": {"default_policy": 1.55}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "sample": 0.1142647920219802, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "episode_duration_sec_mean": 0.00562531381030567, "num_env_steps_sampled_lifetime": 35400, "env_to_module_sum_episodes_length_out": 10.368238394572801, "time_between_sampling": 10.107495421856964}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "b4fbc_00000", "date": "2025-08-11_18-52-34", "timestamp": 1754931154, "time_this_iter_s": 10.815656900405884, "time_total_s": 75.02485299110413, "pid": 11863, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1551fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 75.02485299110413, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 38.96000000000001, "ram_util_percent": 81.17333333333333}}
{"timers": {"training_iteration": 10.634421661186288, "restore_env_runners": 8.45447986821161e-06, "training_step": 10.634235798719244, "env_runner_sampling_timer": 1.6796557388450886, "learner_update_timer": 8.739128333862844, "synch_weights": 0.001666395288205692, "restore_eval_env_runners": 5.654178662078097e-05, "evaluation_iteration": 0.12299008262152503, "synch_eval_env_connectors": 0.0001791046318747073, "synch_env_connectors": 4.636508110437586e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2703677842916523e-05, "add_states_from_episodes_to_batch": 2.8002531849790605e-06, "add_observations_from_episodes_to_batch": 2.872240112213675e-06, "add_time_dim_to_batch_and_zero_pad": 7.393064695490202e-06, "numpy_to_tensor": 1.3013742476955608e-05}}, "connector_pipeline_timer": 6.128360789028911e-05}, "episode_return_mean": 0.4200000000000001, "episode_return_min": -11.5, "env_step_timer": 1.462716344894549e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.085284964587436e-05, "normalize_and_clip_actions": 8.258360922071299e-06, "un_batch_to_individual_items": 6.690086241567281e-06, "listify_data_for_vector_env": 1.0850511987104835e-05, "remove_single_ts_time_rank_from_batch": 1.212397511178956e-05, "tensor_to_numpy": 1.572189137661633e-05}}, "connector_pipeline_timer": 0.00012156539403355668}, "sample": 0.006000724160514206, "rlmodule_inference_timer": 5.225624510029253e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 4.324101037253295e-05, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 0.4200000000000001}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.0058138096658512965, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -184750.0, "module_episode_returns_mean": {"default_policy": 0.4200000000000001}, "num_episodes": 250.0, "time_between_sampling": 0.03706708694843911, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -3695000.0, "episode_len_min": 20, "weights_seq_no": 7.0, "episode_return_max": 8.5, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3160.7960405637173}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1759581338985908, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.010336420575870472, "add_observations_from_episodes_to_batch": 0.0008481077748786757, "add_columns_from_episodes_to_train_batch": 0.043237399909039714, "add_time_dim_to_batch_and_zero_pad": 0.1036994006365063, "add_states_from_episodes_to_batch": 0.0035322049838494066, "batch_individual_items": 0.014018071571653556, "numpy_to_tensor": 9.255860797365348e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"use_intrinsic_rewards": 0.0, "curr_kl_coeff": 0.0006311872275546193, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -4.267692565917969e-05, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_trainable_parameters": 16595, "vf_loss_unclipped": 38.83957290649414, "num_module_steps_trained_lifetime": 47952, "vf_loss": 0.2638677954673767, "entropy": 0.689629077911377, "mean_kl_loss": 4.253831139067188e-05, "policy_loss": -0.00035322000621818006, "module_train_batch_size_mean": 999.0, "weights_seq_no": 8.0, "total_loss": 0.20414911210536957, "num_module_steps_trained_lifetime_throughput": 700.3598758106423}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.20421059429645538, "weights_seq_no": 48.0, "diff_num_grad_updates_vs_sampler_policy": 41.0, "vf_explained_var": 0.00027817487716674805, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 38.839195251464844, "num_module_steps_trained_lifetime": 287712, "vf_loss": 0.26392728090286255, "entropy": 0.6896471977233887, "mean_kl_loss": 4.055703539052047e-05, "policy_loss": -0.00034457026049494743, "module_train_batch_size_mean": 999.0}, "__all_modules__": {"num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 575424, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 1512000, "num_env_steps_trained_lifetime_throughput": 46682.94950319489}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "weights_seq_no": 48.0, "diff_num_grad_updates_vs_sampler_policy": 41.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 287712}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 95904, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 252000, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime_throughput": 3680.655447365173, "num_module_steps_trained_throughput": 23184375.93655429, "num_module_steps_trained_lifetime_throughput": 12511118.971803723}, "intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained_lifetime": 47952, "default_optimizer_learning_rate": 0.0002715581955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 999.0, "weights_seq_no": 8.0, "num_module_steps_trained_lifetime_throughput": 700.3672832384482}, "IntrinsicAttentionMask": [[[0.33361250162124634, 0.33375993371009827, 0.3326275944709778], [0.333529531955719, 0.33363306522369385, 0.33283743262290955], [0.334166556596756, 0.3346083462238312, 0.33122509717941284]], [[0.3341585099697113, 0.3333326578140259, 0.3325088322162628], [0.33419880270957947, 0.3333325684070587, 0.33246859908103943], [0.33423912525177, 0.33333253860473633, 0.3324283957481384]], [[0.3340270221233368, 0.3324660360813141, 0.33350688219070435], [0.33810821175575256, 0.32738837599754333, 0.3345034420490265], [0.3353841304779053, 0.33077287673950195, 0.333842933177948]], [[0.33486226201057434, 0.3406330943107605, 0.3245045840740204], [0.334482342004776, 0.33875900506973267, 0.32675865292549133], [0.33553898334503174, 0.3440827429294586, 0.32037830352783203]], [[0.3329200744628906, 0.33298489451408386, 0.3340950012207031], [0.33317655324935913, 0.33320116996765137, 0.3336222767829895], [0.33754006028175354, 0.336868554353714, 0.32559144496917725]], [[0.28919723629951477, 0.4222668409347534, 0.2885358929634094], [0.480644553899765, 0.030641591176390648, 0.4887138903141022], [0.28689056634902954, 0.4269077777862549, 0.28620174527168274]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "weights_seq_no": 8.0, "episode_return_max": 14.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.945845802754565e-06, "add_observations_from_episodes_to_batch": 2.8503716332567795e-06, "add_states_from_episodes_to_batch": 2.776924260249032e-06, "numpy_to_tensor": 1.2427825381042569e-05, "batch_individual_items": 1.2623237005824969e-05}}, "connector_pipeline_timer": 6.020394501876362e-05}, "episode_return_mean": 0.75, "env_step_timer": 1.4430002304345114e-05, "rlmodule_inference_timer": 3.182746263270258e-05, "env_reset_timer": 0.0004144213994316103, "num_episodes": 20, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.194650775615864e-06, "listify_data_for_vector_env": 1.0782189006362235e-05, "tensor_to_numpy": 1.5043812983403867e-05, "remove_single_ts_time_rank_from_batch": 1.1944606479512455e-05, "get_actions": 3.665747106054377e-05, "un_batch_to_individual_items": 6.6006773886968115e-06}}, "connector_pipeline_timer": 0.00011612345414651323}, "episode_return_min": -14.5, "env_to_module_sum_episodes_length_in": 10.3682383945743, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 0.75}, "num_episodes_lifetime": 160, "module_episode_returns_mean": {"default_policy": 0.75}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "sample": 0.11432364160205709, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "episode_duration_sec_mean": 0.005485277189873159, "num_env_steps_sampled_lifetime": 40400, "env_to_module_sum_episodes_length_out": 10.3682383945743, "time_between_sampling": 10.110239757227696}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "b4fbc_00000", "date": "2025-08-11_18-52-45", "timestamp": 1754931165, "time_this_iter_s": 10.489017009735107, "time_total_s": 85.51387000083923, "pid": 11863, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1551fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 85.51387000083923, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 38.26, "ram_util_percent": 80.12666666666665}}
{"timers": {"training_iteration": 10.634645432904923, "restore_env_runners": 8.428275443909844e-06, "training_step": 10.63445875448223, "env_runner_sampling_timer": 1.6782681918667135, "learner_update_timer": 8.73956788468361, "synch_weights": 0.0016652738355103466, "restore_eval_env_runners": 5.644802892341465e-05, "evaluation_iteration": 0.12304530679501362, "synch_eval_env_connectors": 0.00017912858540642705, "synch_env_connectors": 4.638474014342881e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2473551551354472e-05, "add_states_from_episodes_to_batch": 2.7491982489597377e-06, "add_observations_from_episodes_to_batch": 2.8491179836221826e-06, "add_time_dim_to_batch_and_zero_pad": 7.2230708453745965e-06, "numpy_to_tensor": 1.2950815461207506e-05}}, "connector_pipeline_timer": 6.0292050543759714e-05}, "episode_return_mean": -0.7800000000000001, "episode_return_min": -11.5, "env_step_timer": 1.4315027545059457e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.9496805296240664e-05, "normalize_and_clip_actions": 8.133418551103917e-06, "un_batch_to_individual_items": 6.638081384743175e-06, "listify_data_for_vector_env": 1.062353196761541e-05, "remove_single_ts_time_rank_from_batch": 1.1964333044357488e-05, "tensor_to_numpy": 1.5456086670209254e-05}}, "connector_pipeline_timer": 0.00011879835769979103}, "sample": 0.005909828454289926, "rlmodule_inference_timer": 3.174489481367075e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 3.9238692456495816e-05, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": -0.7800000000000001}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005314306167420001, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -215625.0, "module_episode_returns_mean": {"default_policy": -0.7800000000000001}, "num_episodes": 250.0, "time_between_sampling": 0.03591968592951183, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -4312500.0, "episode_len_min": 20, "weights_seq_no": 8.0, "episode_return_max": 8.5, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3275.900984172854}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1770406675592624, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.010317608039536167, "add_observations_from_episodes_to_batch": 0.000848960037115349, "add_columns_from_episodes_to_train_batch": 0.0432179900695721, "add_time_dim_to_batch_and_zero_pad": 0.10372336497067246, "add_states_from_episodes_to_batch": 0.0035344083547865497, "batch_individual_items": 0.015112497105427773, "numpy_to_tensor": 9.246594208945177e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"use_intrinsic_rewards": 0.0, "curr_kl_coeff": 0.00031559361377730966, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.00010192394256591797, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_trainable_parameters": 16595, "vf_loss_unclipped": 38.92085647583008, "num_module_steps_trained_lifetime": 53946, "vf_loss": 0.26386895775794983, "entropy": 0.6891315579414368, "mean_kl_loss": 1.5538475054199807e-05, "policy_loss": -8.995374810183421e-05, "module_train_batch_size_mean": 999.0, "weights_seq_no": 9.0, "total_loss": 0.20441403985023499, "num_module_steps_trained_lifetime_throughput": 697.5771176300425}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.2044520527124405, "weights_seq_no": 54.0, "diff_num_grad_updates_vs_sampler_policy": 46.0, "vf_explained_var": 0.00024521350860595703, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 38.93272399902344, "num_module_steps_trained_lifetime": 323676, "vf_loss": 0.2639121115207672, "entropy": 0.6891385316848755, "mean_kl_loss": 1.5098340554686729e-05, "policy_loss": -8.794511813903227e-05, "module_train_batch_size_mean": 999.0}, "__all_modules__": {"num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 647352, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 1701000, "num_env_steps_trained_lifetime_throughput": 45851.75681926409}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "weights_seq_no": 54.0, "diff_num_grad_updates_vs_sampler_policy": 46.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 323676}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 107892, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 283500, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime_throughput": 3666.0274982095284, "num_module_steps_trained_throughput": 22629732.738772012, "num_module_steps_trained_lifetime_throughput": 12508470.854065796}, "intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained_lifetime": 53946, "default_optimizer_learning_rate": 0.0002715581955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 999.0, "weights_seq_no": 9.0, "num_module_steps_trained_lifetime_throughput": 697.5839838947774}, "IntrinsicAttentionMask": [[[0.333609402179718, 0.3350422978401184, 0.3313482999801636], [0.3327946364879608, 0.3301163613796234, 0.33708906173706055], [0.33478736877441406, 0.3428879976272583, 0.32232460379600525]], [[0.3345242738723755, 0.3333319127559662, 0.3321438133716583], [0.33456459641456604, 0.333331823348999, 0.3321036100387573], [0.3346048891544342, 0.33333173394203186, 0.33206337690353394]], [[0.33371421694755554, 0.33309119939804077, 0.3331945538520813], [0.33460816740989685, 0.33252328634262085, 0.3328685462474823], [0.33445969223976135, 0.3326176106929779, 0.3329227566719055]], [[0.32775458693504333, 0.3459528386592865, 0.3262925446033478], [0.33501294255256653, 0.3295151889324188, 0.33547189831733704], [0.3271433115005493, 0.3473300337791443, 0.3255266845226288]], [[0.33324435353279114, 0.3311086595058441, 0.33564695715904236], [0.3331213593482971, 0.32838961482048035, 0.33848902583122253], [0.3333635628223419, 0.3341551125049591, 0.332481324672699]], [[0.3462211787700653, 0.30982309579849243, 0.34395575523376465], [0.5448306798934937, 0.014839796349406242, 0.4403294622898102], [0.3690846264362335, 0.26869112253189087, 0.3622242212295532]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "weights_seq_no": 9.0, "episode_return_max": 14.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.647587880898719e-06, "add_observations_from_episodes_to_batch": 2.7642073852393594e-06, "add_states_from_episodes_to_batch": 2.651484891848062e-06, "numpy_to_tensor": 1.1734497743879431e-05, "batch_individual_items": 1.2181903968428316e-05}}, "connector_pipeline_timer": 5.778229957438541e-05}, "episode_return_mean": 0.75, "env_step_timer": 1.377266540661067e-05, "rlmodule_inference_timer": 3.0603424851514813e-05, "env_reset_timer": 0.0004136709353765719, "num_episodes": 20, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.972475228758795e-06, "listify_data_for_vector_env": 1.0289246386328534e-05, "tensor_to_numpy": 1.4621436595746753e-05, "remove_single_ts_time_rank_from_batch": 1.181567545935003e-05, "get_actions": 3.513763750202424e-05, "un_batch_to_individual_items": 6.541809392525815e-06}}, "connector_pipeline_timer": 0.00011244899998545816}, "episode_return_min": -14.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 0.75}, "num_episodes_lifetime": 180, "module_episode_returns_mean": {"default_policy": 0.75}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "sample": 0.11432040060568965, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "episode_duration_sec_mean": 0.005356839682208374, "num_env_steps_sampled_lifetime": 45400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "time_between_sampling": 10.11599844923518}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "b4fbc_00000", "date": "2025-08-11_18-52-56", "timestamp": 1754931176, "time_this_iter_s": 10.782113790512085, "time_total_s": 96.29598379135132, "pid": 11863, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1551fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 96.29598379135132, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 42.68666666666666, "ram_util_percent": 79.77333333333334}}
{"timers": {"training_iteration": 10.627702926905728, "restore_env_runners": 8.404822023431757e-06, "training_step": 10.62751587651797, "env_runner_sampling_timer": 1.676644844948254, "learner_update_timer": 8.734205758337426, "synch_weights": 0.0016571060965716391, "restore_eval_env_runners": 5.63881287277282e-05, "evaluation_iteration": 0.12303969706752368, "synch_eval_env_connectors": 0.00017909230011011325, "synch_env_connectors": 4.63041901891097e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2438968179798166e-05, "add_states_from_episodes_to_batch": 2.736665674965274e-06, "add_observations_from_episodes_to_batch": 2.7930143425834163e-06, "add_time_dim_to_batch_and_zero_pad": 7.0620215735247874e-06, "numpy_to_tensor": 1.2321182066159198e-05}}, "connector_pipeline_timer": 5.908685003186924e-05}, "episode_return_mean": -0.54, "episode_return_min": -11.5, "env_step_timer": 1.3819690424266959e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.848375502166202e-05, "normalize_and_clip_actions": 7.987521124099078e-06, "un_batch_to_individual_items": 6.540890735694879e-06, "listify_data_for_vector_env": 1.0455697530975831e-05, "remove_single_ts_time_rank_from_batch": 1.17726782684413e-05, "tensor_to_numpy": 1.5098317780952723e-05}}, "connector_pipeline_timer": 0.00011642133348386042}, "sample": 0.005595356794265486, "rlmodule_inference_timer": 3.152994826783743e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 3.843877418922513e-05, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": -0.54}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005213048349134623, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -246500.0, "module_episode_returns_mean": {"default_policy": -0.54}, "num_episodes": 250.0, "time_between_sampling": 0.03738888557344449, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -4930000.0, "episode_len_min": 20, "weights_seq_no": 9.0, "episode_return_max": 8.5, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3294.4660463912605}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17698359713348322, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.010304557368328554, "add_observations_from_episodes_to_batch": 0.0008491150171195987, "add_columns_from_episodes_to_train_batch": 0.04320509683880682, "add_time_dim_to_batch_and_zero_pad": 0.10371168382030657, "add_states_from_episodes_to_batch": 0.0035366184407780465, "batch_individual_items": 0.015091889634593363, "numpy_to_tensor": 9.216586251169093e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"use_intrinsic_rewards": 0.0, "curr_kl_coeff": 0.00015779680688865483, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.00036978721618652344, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_trainable_parameters": 16595, "vf_loss_unclipped": 38.32298278808594, "num_module_steps_trained_lifetime": 59940, "vf_loss": 0.2638678252696991, "entropy": 0.6885851621627808, "mean_kl_loss": 2.6626068574842066e-05, "policy_loss": -0.00028763056616298854, "module_train_batch_size_mean": 999.0, "weights_seq_no": 10.0, "total_loss": 0.20421631634235382, "num_module_steps_trained_lifetime_throughput": 695.3728789776953}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.20425857603549957, "weights_seq_no": 60.0, "diff_num_grad_updates_vs_sampler_policy": 51.0, "vf_explained_var": 0.00034940242767333984, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 38.300804138183594, "num_module_steps_trained_lifetime": 359640, "vf_loss": 0.2639051079750061, "entropy": 0.6886073350906372, "mean_kl_loss": 2.4954639229690656e-05, "policy_loss": -0.0002784031967166811, "module_train_batch_size_mean": 999.0}, "__all_modules__": {"num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 719280, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 1890000, "num_env_steps_trained_lifetime_throughput": 45050.14498982191}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "weights_seq_no": 60.0, "diff_num_grad_updates_vs_sampler_policy": 51.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 359640}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 119880, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 315000, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime_throughput": 3654.4398744621362, "num_module_steps_trained_throughput": 22111974.990468916, "num_module_steps_trained_lifetime_throughput": 12512442.171235658}, "intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained_lifetime": 59940, "default_optimizer_learning_rate": 0.0002715581955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 999.0, "weights_seq_no": 10.0, "num_module_steps_trained_lifetime_throughput": 695.3792524456608}, "IntrinsicAttentionMask": [[[0.333625465631485, 0.33025458455085754, 0.33612003922462463], [0.33433136343955994, 0.32196497917175293, 0.3437036871910095], [0.3330276310443878, 0.3363890051841736, 0.3305833041667938]], [[0.33018767833709717, 0.3352198302745819, 0.3345925509929657], [0.3318239450454712, 0.3342379629611969, 0.3339380621910095], [0.33162111043930054, 0.33435961604118347, 0.334019273519516]], [[0.33078858256340027, 0.33473721146583557, 0.33447423577308655], [0.33670827746391296, 0.33147376775741577, 0.3318179249763489], [0.3363145887851715, 0.33169054985046387, 0.33199483156204224]], [[0.332052081823349, 0.33777445554733276, 0.33017340302467346], [0.3323831856250763, 0.33663299679756165, 0.33098387718200684], [0.33194178342819214, 0.3381539285182953, 0.32990431785583496]], [[0.33252790570259094, 0.333180695772171, 0.3342914581298828], [0.3375692665576935, 0.3341100811958313, 0.32832059264183044], [0.3461533784866333, 0.33555087447166443, 0.31829580664634705]], [[0.32439303398132324, 0.3497668504714966, 0.3258401155471802], [0.5405507683753967, 0.017739830538630486, 0.4417094886302948], [0.3485007584095001, 0.3056877851486206, 0.3458114266395569]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "weights_seq_no": 10.0, "episode_return_max": 14.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.748750122231915e-06, "add_observations_from_episodes_to_batch": 2.728677757084251e-06, "add_states_from_episodes_to_batch": 2.6700774521671624e-06, "numpy_to_tensor": 1.1828871207711817e-05, "batch_individual_items": 1.2234329754728831e-05}}, "connector_pipeline_timer": 5.781792081212452e-05}, "episode_return_mean": 0.35, "env_step_timer": 1.3603082967260442e-05, "rlmodule_inference_timer": 3.033189134272759e-05, "env_reset_timer": 0.0004104608954770082, "num_episodes": 20, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.877324778595425e-06, "listify_data_for_vector_env": 1.026715357992786e-05, "tensor_to_numpy": 1.463383855286973e-05, "remove_single_ts_time_rank_from_batch": 1.1831383476217427e-05, "get_actions": 3.528514574630823e-05, "un_batch_to_individual_items": 6.4990769084432615e-06}}, "connector_pipeline_timer": 0.00011227752552713751}, "episode_return_min": -14.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 0.35}, "num_episodes_lifetime": 200, "module_episode_returns_mean": {"default_policy": 0.35}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "sample": 0.11428775410013857, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "episode_duration_sec_mean": 0.005343150895787403, "num_env_steps_sampled_lifetime": 50400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "time_between_sampling": 10.114503031412209}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "b4fbc_00000", "date": "2025-08-11_18-53-06", "timestamp": 1754931186, "time_this_iter_s": 10.059489965438843, "time_total_s": 106.35547375679016, "pid": 11863, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1551fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 106.35547375679016, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 36.17333333333333, "ram_util_percent": 78.46666666666667}}
{"timers": {"training_iteration": 10.61979370638657, "restore_env_runners": 8.377443617709573e-06, "training_step": 10.619606676502572, "env_runner_sampling_timer": 1.675015974419458, "learner_update_timer": 8.727903207833455, "synch_weights": 0.0016483454547984605, "restore_eval_env_runners": 5.589257741359724e-05, "evaluation_iteration": 0.1229733255167058, "synch_eval_env_connectors": 0.00017830221709305653, "synch_env_connectors": 4.623274614678005e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2302505187015537e-05, "add_states_from_episodes_to_batch": 2.7323165710188615e-06, "add_observations_from_episodes_to_batch": 2.777313405036402e-06, "add_time_dim_to_batch_and_zero_pad": 7.037470547602984e-06, "numpy_to_tensor": 1.2424902609625407e-05}}, "connector_pipeline_timer": 5.9102178097401983e-05}, "episode_return_mean": -1.0199999999999996, "episode_return_min": -11.5, "env_step_timer": 1.3886558205707129e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.8568400918696564e-05, "normalize_and_clip_actions": 7.953587559323366e-06, "un_batch_to_individual_items": 6.535512821753653e-06, "listify_data_for_vector_env": 1.0450827999552197e-05, "remove_single_ts_time_rank_from_batch": 1.1796425448266198e-05, "tensor_to_numpy": 1.5041178671554894e-05}}, "connector_pipeline_timer": 0.00011653078454601756}, "sample": 0.005575077765639035, "rlmodule_inference_timer": 3.138472257645284e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 3.821843722475038e-05, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": -1.0199999999999996}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.0052172106415964625, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -277375.0, "module_episode_returns_mean": {"default_policy": -1.0199999999999996}, "num_episodes": 250.0, "time_between_sampling": 0.03492893789238665, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -5547500.0, "episode_len_min": 20, "weights_seq_no": 10.0, "episode_return_max": 8.5, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3291.1169344004647}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17692480325246748, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.01028914513479911, "add_observations_from_episodes_to_batch": 0.0008488242867822864, "add_columns_from_episodes_to_train_batch": 0.04319097920059143, "add_time_dim_to_batch_and_zero_pad": 0.10370730948264151, "add_states_from_episodes_to_batch": 0.0035399155961713985, "batch_individual_items": 0.015065152407918518, "numpy_to_tensor": 9.186587451081525e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"use_intrinsic_rewards": 0.0, "curr_kl_coeff": 7.889840344432741e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.0004563331604003906, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_trainable_parameters": 16595, "vf_loss_unclipped": 38.75516891479492, "num_module_steps_trained_lifetime": 65934, "vf_loss": 0.26386916637420654, "entropy": 0.687889814376831, "mean_kl_loss": 1.8519715013098903e-05, "policy_loss": -0.00011925642320420593, "module_train_batch_size_mean": 999.0, "weights_seq_no": 11.0, "total_loss": 0.20438678562641144, "num_module_steps_trained_lifetime_throughput": 693.6237243674212}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.2044140249490738, "weights_seq_no": 66.0, "diff_num_grad_updates_vs_sampler_policy": 56.0, "vf_explained_var": 0.0002154707908630371, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 38.751522064208984, "num_module_steps_trained_lifetime": 395604, "vf_loss": 0.2638971209526062, "entropy": 0.6878970265388489, "mean_kl_loss": 1.806421460059937e-05, "policy_loss": -0.00011668822116916999, "module_train_batch_size_mean": 999.0}, "__all_modules__": {"num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 791208, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 2079000, "num_env_steps_trained_lifetime_throughput": 44284.97541825845}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "weights_seq_no": 66.0, "diff_num_grad_updates_vs_sampler_policy": 56.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 395604}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 131868, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 346500, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime_throughput": 3645.24392126832, "num_module_steps_trained_throughput": 21620127.772343386, "num_module_steps_trained_lifetime_throughput": 12517749.26003395}, "intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained_lifetime": 65934, "default_optimizer_learning_rate": 0.0002715581955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 999.0, "weights_seq_no": 11.0, "num_module_steps_trained_lifetime_throughput": 693.6296443359049}, "IntrinsicAttentionMask": [[[0.3331841826438904, 0.3346152603626251, 0.3322005569934845], [0.33360666036605835, 0.33092185854911804, 0.33547142148017883], [0.3328787684440613, 0.33717262744903564, 0.32994866371154785]], [[0.33206382393836975, 0.3314424455165863, 0.33649373054504395], [0.3319815993309021, 0.3313203454017639, 0.3366980254650116], [0.33264434337615967, 0.33230575919151306, 0.33504989743232727]], [[0.33023324608802795, 0.3372240364551544, 0.33254274725914], [0.33430877327919006, 0.3321141302585602, 0.333577036857605], [0.33158838748931885, 0.33552026748657227, 0.3328913450241089]], [[0.3234248757362366, 0.35568445920944214, 0.32089072465896606], [0.33082228899002075, 0.3390251696109772, 0.33015260100364685], [0.32280242443084717, 0.3570791184902191, 0.3201184868812561]], [[0.3316408693790436, 0.3319050073623657, 0.33645421266555786], [0.3318979740142822, 0.33212220668792725, 0.33597978949546814], [0.3362734317779541, 0.33580636978149414, 0.32792016863822937]], [[0.31519725918769836, 0.3770793080329895, 0.3077234625816345], [0.40655717253685, 0.04134169593453407, 0.5521011352539062], [0.2779200077056885, 0.4624756872653961, 0.2596043348312378]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "weights_seq_no": 11.0, "episode_return_max": 14.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.75478543761545e-06, "add_observations_from_episodes_to_batch": 2.7293242665561004e-06, "add_states_from_episodes_to_batch": 2.6923735986497175e-06, "numpy_to_tensor": 1.1944996810792479e-05, "batch_individual_items": 1.2278326540099758e-05}}, "connector_pipeline_timer": 5.824781858665193e-05}, "episode_return_mean": 0.75, "env_step_timer": 1.371242416039634e-05, "rlmodule_inference_timer": 3.0543458123663864e-05, "env_reset_timer": 0.00040713545659953226, "num_episodes": 20, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.957469477237664e-06, "listify_data_for_vector_env": 1.02514875435543e-05, "tensor_to_numpy": 1.4700396090195165e-05, "remove_single_ts_time_rank_from_batch": 1.187999802918405e-05, "get_actions": 3.4864953480819984e-05, "un_batch_to_individual_items": 6.4700702868891424e-06}}, "connector_pipeline_timer": 0.00011217231627153508}, "episode_return_min": -14.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 0.75}, "num_episodes_lifetime": 220, "module_episode_returns_mean": {"default_policy": 0.75}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "sample": 0.1142611598890394, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "episode_duration_sec_mean": 0.005204014630289748, "num_env_steps_sampled_lifetime": 55400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "time_between_sampling": 10.111936110268863}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "b4fbc_00000", "date": "2025-08-11_18-53-16", "timestamp": 1754931196, "time_this_iter_s": 9.956326961517334, "time_total_s": 116.3118007183075, "pid": 11863, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1551fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 116.3118007183075, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 34.02857142857143, "ram_util_percent": 78.17857142857143}}
{"timers": {"training_iteration": 10.611971347242354, "restore_env_runners": 8.350759255356406e-06, "training_step": 10.61178410473796, "env_runner_sampling_timer": 1.6733990217559163, "learner_update_timer": 8.721667461175285, "synch_weights": 0.0016410840809487127, "restore_eval_env_runners": 5.5401151571362964e-05, "evaluation_iteration": 0.12291186018168636, "synch_eval_env_connectors": 0.00017750711513375405, "synch_env_connectors": 4.622451993116257e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2299017512298175e-05, "add_states_from_episodes_to_batch": 2.7154565813442037e-06, "add_observations_from_episodes_to_batch": 2.784212706983373e-06, "add_time_dim_to_batch_and_zero_pad": 7.0359042516316275e-06, "numpy_to_tensor": 1.2514727730160872e-05}}, "connector_pipeline_timer": 5.9104133378595036e-05}, "episode_return_mean": -0.22, "episode_return_min": -11.5, "env_step_timer": 1.3863785230762241e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.8609633051196705e-05, "normalize_and_clip_actions": 7.924693716535829e-06, "un_batch_to_individual_items": 6.535201531975105e-06, "listify_data_for_vector_env": 1.0430555815962352e-05, "remove_single_ts_time_rank_from_batch": 1.1782717654855888e-05, "tensor_to_numpy": 1.508872635998144e-05}}, "connector_pipeline_timer": 0.00011657277649723929}, "sample": 0.0055590052959737036, "rlmodule_inference_timer": 3.131651675405868e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 3.729856012478815e-05, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": -0.22}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.00521709515759721, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -308250.0, "module_episode_returns_mean": {"default_policy": -0.22}, "num_episodes": 250.0, "time_between_sampling": 0.034357997163405804, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -6165000.0, "episode_len_min": 20, "weights_seq_no": 11.0, "episode_return_max": 8.5, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3295.594593612026}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17686781396911863, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.01027353493361317, "add_observations_from_episodes_to_batch": 0.0008484835436713511, "add_columns_from_episodes_to_train_batch": 0.043171904408901195, "add_time_dim_to_batch_and_zero_pad": 0.10370765679708101, "add_states_from_episodes_to_batch": 0.003543847690800888, "batch_individual_items": 0.01504012630373543, "numpy_to_tensor": 9.153971620275816e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"use_intrinsic_rewards": 0.0, "curr_kl_coeff": 3.944920172216371e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.00023984909057617188, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_trainable_parameters": 16595, "vf_loss_unclipped": 38.54233169555664, "num_module_steps_trained_lifetime": 71928, "vf_loss": 0.26386743783950806, "entropy": 0.6869497895240784, "mean_kl_loss": 4.319550862419419e-05, "policy_loss": -0.000405090453568846, "module_train_batch_size_mean": 999.0, "weights_seq_no": 12.0, "total_loss": 0.20410102605819702, "num_module_steps_trained_lifetime_throughput": 692.1687906348419}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.20413951575756073, "weights_seq_no": 72.0, "diff_num_grad_updates_vs_sampler_policy": 61.0, "vf_explained_var": 0.0002664923667907715, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 38.53720474243164, "num_module_steps_trained_lifetime": 431568, "vf_loss": 0.26389479637145996, "entropy": 0.6869744658470154, "mean_kl_loss": 4.114164403290488e-05, "policy_loss": -0.0003945634525734931, "module_train_batch_size_mean": 999.0}, "__all_modules__": {"num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 863136, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 2268000, "num_env_steps_trained_lifetime_throughput": 43557.79505304939}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "weights_seq_no": 72.0, "diff_num_grad_updates_vs_sampler_policy": 61.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 431568}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 143856, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 378000, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime_throughput": 3637.5942783936603, "num_module_steps_trained_throughput": 21154110.67032177, "num_module_steps_trained_lifetime_throughput": 12522771.282885745}, "intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained_lifetime": 71928, "default_optimizer_learning_rate": 0.0002715581955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 999.0, "weights_seq_no": 12.0, "num_module_steps_trained_lifetime_throughput": 692.1743126144029}, "IntrinsicAttentionMask": [[[0.33295220136642456, 0.33160609006881714, 0.3354417085647583], [0.3325318992137909, 0.329739511013031, 0.3377285599708557], [0.33370324969291687, 0.3350428342819214, 0.3312539756298065]], [[0.33664432168006897, 0.3358123302459717, 0.3275434076786041], [0.33680546283721924, 0.3359324634075165, 0.32726210355758667], [0.33842650055885315, 0.3371387720108032, 0.324434757232666]], [[0.32532528042793274, 0.33775627613067627, 0.336918443441391], [0.3311958312988281, 0.3345124423503876, 0.3342917561531067], [0.33080536127090454, 0.334727942943573, 0.33446672558784485]], [[0.32915252447128296, 0.3435572385787964, 0.32729026675224304], [0.3318520486354828, 0.33696767687797546, 0.33118024468421936], [0.3287917375564575, 0.3444346487522125, 0.32677358388900757]], [[0.33524250984191895, 0.33494043350219727, 0.3298170268535614], [0.33549773693084717, 0.3351549208164215, 0.3293473422527313], [0.33983901143074036, 0.3387913405895233, 0.32136961817741394]], [[0.315197229385376, 0.3770793378353119, 0.30772343277931213], [0.4065571427345276, 0.04134136065840721, 0.5521014928817749], [0.2779198884963989, 0.46247589588165283, 0.25960418581962585]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "weights_seq_no": 12.0, "episode_return_max": 14.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.713054961787225e-06, "add_observations_from_episodes_to_batch": 2.751763267640726e-06, "add_states_from_episodes_to_batch": 2.702136581927652e-06, "numpy_to_tensor": 1.1806760240412903e-05, "batch_individual_items": 1.2195092078572195e-05}}, "connector_pipeline_timer": 5.7848081023717316e-05}, "episode_return_mean": 0.75, "env_step_timer": 1.3751693971880056e-05, "rlmodule_inference_timer": 3.038932473024786e-05, "env_reset_timer": 0.0004040828513506912, "num_episodes": 20, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.058878694973492e-06, "listify_data_for_vector_env": 1.0256717682426728e-05, "tensor_to_numpy": 1.4600165449880617e-05, "remove_single_ts_time_rank_from_batch": 1.1997605476690577e-05, "get_actions": 3.490762352702497e-05, "un_batch_to_individual_items": 6.579167003402353e-06}}, "connector_pipeline_timer": 0.00011241958899962683}, "episode_return_min": -14.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 0.75}, "num_episodes_lifetime": 240, "module_episode_returns_mean": {"default_policy": 0.75}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "sample": 0.1142323862102783, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "episode_duration_sec_mean": 0.005210567573085427, "num_env_steps_sampled_lifetime": 60400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "time_between_sampling": 10.109413832915656}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "b4fbc_00000", "date": "2025-08-11_18-53-26", "timestamp": 1754931206, "time_this_iter_s": 9.956813097000122, "time_total_s": 126.26861381530762, "pid": 11863, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1551fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 126.26861381530762, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 31.892857142857142, "ram_util_percent": 78.12857142857145}}
{"timers": {"training_iteration": 10.608845176269538, "restore_env_runners": 8.324331259247805e-06, "training_step": 10.608657547861002, "env_runner_sampling_timer": 1.6719721223784267, "learner_update_timer": 8.719905036563716, "synch_weights": 0.0016396032397365964, "restore_eval_env_runners": 5.493381009859627e-05, "evaluation_iteration": 0.12284786449003939, "synch_eval_env_connectors": 0.000176915793391809, "synch_env_connectors": 4.618727214724453e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.239589794430244e-05, "add_states_from_episodes_to_batch": 2.746072470167003e-06, "add_observations_from_episodes_to_batch": 2.8119644146928435e-06, "add_time_dim_to_batch_and_zero_pad": 7.100098840774532e-06, "numpy_to_tensor": 1.2730875569451326e-05}}, "connector_pipeline_timer": 5.962391963997877e-05}, "episode_return_mean": -0.14000000000000007, "episode_return_min": -11.5, "env_step_timer": 1.4062446622647657e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.906199497478444e-05, "normalize_and_clip_actions": 7.995261577971274e-06, "un_batch_to_individual_items": 6.603145542751877e-06, "listify_data_for_vector_env": 1.0607856497908518e-05, "remove_single_ts_time_rank_from_batch": 1.1849256368293491e-05, "tensor_to_numpy": 1.5201280955871373e-05}}, "connector_pipeline_timer": 0.00011768194708337878}, "sample": 0.00558666752161682, "rlmodule_inference_timer": 3.1658195336793386e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 3.9363871361406954e-05, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": -0.14000000000000007}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005266719355713574, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -339125.0, "module_episode_returns_mean": {"default_policy": -0.14000000000000007}, "num_episodes": 250.0, "time_between_sampling": 0.034315326317497605, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -6782500.0, "episode_len_min": 20, "weights_seq_no": 12.0, "episode_return_max": 8.5, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3269.4559686718753}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17684594332944897, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.010257253753636095, "add_observations_from_episodes_to_batch": 0.000848136628174692, "add_columns_from_episodes_to_train_batch": 0.04315142869410248, "add_time_dim_to_batch_and_zero_pad": 0.10374069439954416, "add_states_from_episodes_to_batch": 0.003552504622995617, "batch_individual_items": 0.015014516291262235, "numpy_to_tensor": 9.147348848688602e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"use_intrinsic_rewards": 0.0, "curr_kl_coeff": 1.9724600861081854e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.00011610984802246094, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_trainable_parameters": 16595, "vf_loss_unclipped": 38.64045715332031, "num_module_steps_trained_lifetime": 77922, "vf_loss": 0.2638697326183319, "entropy": 0.6859127283096313, "mean_kl_loss": 3.897349597536959e-05, "policy_loss": -0.00029097095830366015, "module_train_batch_size_mean": 999.0, "weights_seq_no": 13.0, "total_loss": 0.20421858131885529, "num_module_steps_trained_lifetime_throughput": 690.4944388326355}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.20424611866474152, "weights_seq_no": 78.0, "diff_num_grad_updates_vs_sampler_policy": 66.0, "vf_explained_var": 0.00024247169494628906, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 38.64699172973633, "num_module_steps_trained_lifetime": 467532, "vf_loss": 0.26388972997665405, "entropy": 0.6859336495399475, "mean_kl_loss": 3.7451129173859954e-05, "policy_loss": -0.00028500723419710994, "module_train_batch_size_mean": 999.0}, "__all_modules__": {"num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 935064, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 2457000, "num_env_steps_trained_lifetime_throughput": 42855.840637652196}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "weights_seq_no": 78.0, "diff_num_grad_updates_vs_sampler_policy": 66.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 467532}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 155844, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 409500, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime_throughput": 3628.791688057267, "num_module_steps_trained_throughput": 20699978.474920165, "num_module_steps_trained_lifetime_throughput": 12519117.730689032}, "intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained_lifetime": 77922, "default_optimizer_learning_rate": 0.0002715581955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 999.0, "weights_seq_no": 13.0, "num_module_steps_trained_lifetime_throughput": 690.4995865005856}, "IntrinsicAttentionMask": [[[0.33295220136642456, 0.33160609006881714, 0.3354417085647583], [0.3325319290161133, 0.329739511013031, 0.3377285897731781], [0.33370324969291687, 0.3350428342819214, 0.33125394582748413]], [[0.32734930515289307, 0.33692580461502075, 0.3357248902320862], [0.328978568315506, 0.33594611287117004, 0.33507534861564636], [0.32877659797668457, 0.3360674977302551, 0.3351559340953827]], [[0.33402714133262634, 0.3334035575389862, 0.33256933093070984], [0.3356555104255676, 0.33356404304504395, 0.33078041672706604], [0.33784186840057373, 0.33377015590667725, 0.32838794589042664]], [[0.32915249466896057, 0.34355729818344116, 0.32729026675224304], [0.3318520486354828, 0.33696767687797546, 0.33118024468421936], [0.32879170775413513, 0.3444347083568573, 0.32677358388900757]], [[0.3324461281299591, 0.3327109217643738, 0.3348430097103119], [0.3325807750225067, 0.33280545473098755, 0.33461374044418335], [0.3336603343486786, 0.33356234431266785, 0.3327772915363312]], [[0.2891971170902252, 0.4222671091556549, 0.2885357439517975], [0.48064476251602173, 0.030640698969364166, 0.4887144863605499], [0.28689029812812805, 0.4269081950187683, 0.2862014174461365]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "weights_seq_no": 13.0, "episode_return_max": 14.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.6713911484012936e-06, "add_observations_from_episodes_to_batch": 2.7493863642272246e-06, "add_states_from_episodes_to_batch": 2.6838553712870047e-06, "numpy_to_tensor": 1.1787244802247036e-05, "batch_individual_items": 1.211858784371502e-05}}, "connector_pipeline_timer": 5.786518896362852e-05}, "episode_return_mean": 0.35, "env_step_timer": 1.3588775150000134e-05, "rlmodule_inference_timer": 3.0437276207724193e-05, "env_reset_timer": 0.00040308452213913944, "num_episodes": 20, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.9008383509433e-06, "listify_data_for_vector_env": 1.0246196975642341e-05, "tensor_to_numpy": 1.4587068373739407e-05, "remove_single_ts_time_rank_from_batch": 1.1697117610940569e-05, "get_actions": 3.53104025120126e-05, "un_batch_to_individual_items": 6.460255345054537e-06}}, "connector_pipeline_timer": 0.00011226274688521398}, "episode_return_min": -14.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 0.35}, "num_episodes_lifetime": 260, "module_episode_returns_mean": {"default_policy": 0.35}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "sample": 0.114222191927958, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "episode_duration_sec_mean": 0.005147586654638872, "num_env_steps_sampled_lifetime": 65400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "time_between_sampling": 10.11154814624617}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "b4fbc_00000", "date": "2025-08-11_18-53-36", "timestamp": 1754931216, "time_this_iter_s": 10.423940896987915, "time_total_s": 136.69255471229553, "pid": 11863, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1551fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 136.69255471229553, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 33.720000000000006, "ram_util_percent": 78.7}}
{"timers": {"training_iteration": 10.603898434926748, "restore_env_runners": 8.479418050112302e-06, "training_step": 10.60371020405234, "env_runner_sampling_timer": 1.6717374124039575, "learner_update_timer": 8.71514704577722, "synch_weights": 0.001631301787019122, "restore_eval_env_runners": 5.482489211483953e-05, "evaluation_iteration": 0.1228366066758701, "synch_eval_env_connectors": 0.00017660247657822338, "synch_env_connectors": 4.613790547713364e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2379345303912382e-05, "add_states_from_episodes_to_batch": 2.7338125843062493e-06, "add_observations_from_episodes_to_batch": 2.795660392243474e-06, "add_time_dim_to_batch_and_zero_pad": 7.0746484986129244e-06, "numpy_to_tensor": 1.2408348093240134e-05}}, "connector_pipeline_timer": 5.9286839160590335e-05}, "episode_return_mean": -0.14000000000000007, "episode_return_min": -11.5, "env_step_timer": 1.3934085346467417e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.867920496697578e-05, "normalize_and_clip_actions": 7.99019292945362e-06, "un_batch_to_individual_items": 6.582167175210165e-06, "listify_data_for_vector_env": 1.0584208546710351e-05, "remove_single_ts_time_rank_from_batch": 1.1856259193348574e-05, "tensor_to_numpy": 1.50856435425335e-05}}, "connector_pipeline_timer": 0.00011709675532160201}, "sample": 0.006010763527489781, "rlmodule_inference_timer": 5.853805945222497e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 4.0839313451528554e-05, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": -0.14000000000000007}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005731787180528044, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -370000.0, "module_episode_returns_mean": {"default_policy": -0.14000000000000007}, "num_episodes": 250.0, "time_between_sampling": 0.03599324182242766, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -7400000.0, "episode_len_min": 20, "weights_seq_no": 13.0, "episode_return_max": 8.5, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3260.7077867641265}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1768126501457184, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.010243182056456308, "add_observations_from_episodes_to_batch": 0.0008478431822137242, "add_columns_from_episodes_to_train_batch": 0.04314585149676485, "add_time_dim_to_batch_and_zero_pad": 0.10374531662633381, "add_states_from_episodes_to_batch": 0.0035570862465324894, "batch_individual_items": 0.014992866957762327, "numpy_to_tensor": 9.131625296715318e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"use_intrinsic_rewards": 0.0, "curr_kl_coeff": 9.862300430540927e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -4.76837158203125e-05, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_trainable_parameters": 16595, "vf_loss_unclipped": 38.63935470581055, "num_module_steps_trained_lifetime": 83916, "vf_loss": 0.26386719942092896, "entropy": 0.6851595044136047, "mean_kl_loss": 1.8586952137411572e-05, "policy_loss": -0.00028586413827724755, "module_train_batch_size_mean": 999.0, "weights_seq_no": 14.0, "total_loss": 0.20422284305095673, "num_module_steps_trained_lifetime_throughput": 688.9766505378423}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.20425540208816528, "weights_seq_no": 84.0, "diff_num_grad_updates_vs_sampler_policy": 71.0, "vf_explained_var": 0.0002391338348388672, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 38.64918899536133, "num_module_steps_trained_lifetime": 503496, "vf_loss": 0.2638907730579376, "entropy": 0.6851908564567566, "mean_kl_loss": 1.7105407096096314e-05, "policy_loss": -0.0002743889344856143, "module_train_batch_size_mean": 999.0}, "__all_modules__": {"num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 1006992, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 2646000, "num_env_steps_trained_lifetime_throughput": 42183.55739001849}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "weights_seq_no": 84.0, "diff_num_grad_updates_vs_sampler_policy": 71.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 503496}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 167832, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 441000, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime_throughput": 3620.8119555201024, "num_module_steps_trained_throughput": 20266237.834961038, "num_module_steps_trained_lifetime_throughput": 12513216.570493102}, "intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained_lifetime": 83916, "default_optimizer_learning_rate": 0.0002715581955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 999.0, "weights_seq_no": 14.0, "num_module_steps_trained_lifetime_throughput": 688.9814660946113}, "IntrinsicAttentionMask": [[[0.33361250162124634, 0.33375993371009827, 0.3326275944709778], [0.333529531955719, 0.33363306522369385, 0.33283743262290955], [0.334166556596756, 0.33460837602615356, 0.33122506737709045]], [[0.33917367458343506, 0.3308219909667969, 0.33000436425209045], [0.3420639932155609, 0.32957521080970764, 0.32836082577705383], [0.342351496219635, 0.3294510245323181, 0.3281974494457245]], [[0.3228456377983093, 0.33518195152282715, 0.34197235107421875], [0.3305320739746094, 0.33384203910827637, 0.33562594652175903], [0.33467593789100647, 0.3330857455730438, 0.3322383463382721]], [[0.3300475776195526, 0.3413770794868469, 0.32857534289360046], [0.33273306488990784, 0.33480772376060486, 0.3324592411518097], [0.3296886384487152, 0.34225186705589294, 0.32805946469306946]], [[0.33524250984191895, 0.33494043350219727, 0.3298170268535614], [0.33549773693084717, 0.3351549208164215, 0.3293473422527313], [0.33983904123306274, 0.3387913703918457, 0.32136955857276917]], [[0.3151971995830536, 0.3770793676376343, 0.30772340297698975], [0.4065570831298828, 0.041340600699186325, 0.5521023869514465], [0.2779196500778198, 0.46247637271881104, 0.25960397720336914]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "weights_seq_no": 14.0, "episode_return_max": 14.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.376418009600114e-06, "add_observations_from_episodes_to_batch": 2.9753450298615328e-06, "add_states_from_episodes_to_batch": 2.9336022253136623e-06, "numpy_to_tensor": 1.357138178832257e-05, "batch_individual_items": 1.3795022243250242e-05}}, "connector_pipeline_timer": 6.4420561846341e-05}, "episode_return_mean": 0.35, "env_step_timer": 1.5651408136979626e-05, "rlmodule_inference_timer": 3.5427710400977754e-05, "env_reset_timer": 0.00039993784663041075, "num_episodes": 20, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.839020414148295e-06, "listify_data_for_vector_env": 1.1631290758064014e-05, "tensor_to_numpy": 1.6397043026875322e-05, "remove_single_ts_time_rank_from_batch": 1.3064801018632894e-05, "get_actions": 4.2290932390438515e-05, "un_batch_to_individual_items": 7.323072893392156e-06}}, "connector_pipeline_timer": 0.00012831907200416004}, "episode_return_min": -14.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 0.35}, "num_episodes_lifetime": 280, "module_episode_returns_mean": {"default_policy": 0.35}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "sample": 0.1142809216689632, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "episode_duration_sec_mean": 0.0052046258503105495, "num_env_steps_sampled_lifetime": 70400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "time_between_sampling": 10.1118502797841}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "b4fbc_00000", "date": "2025-08-11_18-53-46", "timestamp": 1754931226, "time_this_iter_s": 10.242682933807373, "time_total_s": 146.9352376461029, "pid": 11863, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1551fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 146.9352376461029, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 36.49285714285715, "ram_util_percent": 78.97857142857143}}
{"timers": {"training_iteration": 10.597052929736629, "restore_env_runners": 8.459204105241453e-06, "training_step": 10.59686428785199, "env_runner_sampling_timer": 1.6717715566097562, "learner_update_timer": 8.708163176148602, "synch_weights": 0.0016228895999728587, "restore_eval_env_runners": 5.435372294242596e-05, "evaluation_iteration": 0.12286551269824443, "synch_eval_env_connectors": 0.00017603770193716387, "synch_env_connectors": 4.610991738245961e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2797665296837232e-05, "add_states_from_episodes_to_batch": 2.8073312103025137e-06, "add_observations_from_episodes_to_batch": 2.8995066286158707e-06, "add_time_dim_to_batch_and_zero_pad": 7.374077613734104e-06, "numpy_to_tensor": 1.315150395533083e-05}}, "connector_pipeline_timer": 6.149164139937239e-05}, "episode_return_mean": 0.09999999999999998, "episode_return_min": -11.5, "env_step_timer": 1.4545550317412354e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.14078744537627e-05, "normalize_and_clip_actions": 8.208630586498764e-06, "un_batch_to_individual_items": 6.714234986449324e-06, "listify_data_for_vector_env": 1.0805905855626901e-05, "remove_single_ts_time_rank_from_batch": 1.2131677430470228e-05, "tensor_to_numpy": 1.5715704191587425e-05}}, "connector_pipeline_timer": 0.00012204432910623427}, "sample": 0.005970037209659017, "rlmodule_inference_timer": 4.942402088591723e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 4.287844176938001e-05, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 0.09999999999999998}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.0058066852944903095, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -400875.0, "module_episode_returns_mean": {"default_policy": 0.09999999999999998}, "num_episodes": 250.0, "time_between_sampling": 0.035024461128061554, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -8017500.0, "episode_len_min": 20, "weights_seq_no": 14.0, "episode_return_max": 8.5, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3153.7343769227955}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17683905489416807, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.010226386066074329, "add_observations_from_episodes_to_batch": 0.0008475572504911267, "add_columns_from_episodes_to_train_batch": 0.04312861506252338, "add_time_dim_to_batch_and_zero_pad": 0.10379116011970585, "add_states_from_episodes_to_batch": 0.0035623616345527936, "batch_individual_items": 0.01500247703732446, "numpy_to_tensor": 9.194475060475851e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"use_intrinsic_rewards": 0.0, "curr_kl_coeff": 4.931150215270463e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -8.821487426757812e-06, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_trainable_parameters": 16595, "vf_loss_unclipped": 39.025245666503906, "num_module_steps_trained_lifetime": 89910, "vf_loss": 0.26386702060699463, "entropy": 0.6841073036193848, "mean_kl_loss": 2.632293399074115e-05, "policy_loss": -9.987407247535884e-05, "module_train_batch_size_mean": 999.0, "weights_seq_no": 15.0, "total_loss": 0.20441031455993652, "num_module_steps_trained_lifetime_throughput": 687.8051541003778}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.20443250238895416, "weights_seq_no": 90.0, "diff_num_grad_updates_vs_sampler_policy": 76.0, "vf_explained_var": 0.00017762184143066406, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 39.07248306274414, "num_module_steps_trained_lifetime": 539460, "vf_loss": 0.26388832926750183, "entropy": 0.6841134428977966, "mean_kl_loss": 2.5993978852056898e-05, "policy_loss": -9.846812463365495e-05, "module_train_batch_size_mean": 999.0}, "__all_modules__": {"num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 1078920, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 2835000, "num_env_steps_trained_lifetime_throughput": 41545.536631719464}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "weights_seq_no": 90.0, "diff_num_grad_updates_vs_sampler_policy": 76.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 539460}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 179820, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 472500, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime_throughput": 3614.652237402954, "num_module_steps_trained_throughput": 19870325.384984262, "num_module_steps_trained_lifetime_throughput": 12521421.543960078}, "intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained_lifetime": 89910, "default_optimizer_learning_rate": 0.0002715581955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 999.0, "weights_seq_no": 15.0, "num_module_steps_trained_lifetime_throughput": 687.8096613265993}, "IntrinsicAttentionMask": [[[0.33361250162124634, 0.33375993371009827, 0.3326275944709778], [0.333529531955719, 0.33363306522369385, 0.33283743262290955], [0.334166556596756, 0.33460837602615356, 0.33122506737709045]], [[0.3320602774620056, 0.33712098002433777, 0.33081871271133423], [0.3327254056930542, 0.3351459801197052, 0.3321286141872406], [0.3318948447704315, 0.33761098980903625, 0.3304941654205322]], [[0.3203975260257721, 0.34022316336631775, 0.339379221200943], [0.33563223481178284, 0.3321114480495453, 0.33225634694099426], [0.334994912147522, 0.33245009183883667, 0.33255499601364136]], [[0.3320520520210266, 0.3377745449542999, 0.33017340302467346], [0.3323831558227539, 0.33663302659988403, 0.33098384737968445], [0.33194175362586975, 0.33815401792526245, 0.3299042880535126]], [[0.3274296522140503, 0.33373236656188965, 0.33883795142173767], [0.3312216103076935, 0.3334832191467285, 0.335295170545578], [0.334253191947937, 0.3332655727863312, 0.3324812054634094]], [[0.3235124945640564, 0.3502229154109955, 0.32626456022262573], [0.5919726490974426, 0.01330231036990881, 0.3947250247001648], [0.373039186000824, 0.26700669527053833, 0.3599540889263153]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "weights_seq_no": 15.0, "episode_return_max": 14.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.760230811159895e-06, "add_observations_from_episodes_to_batch": 2.7657370660490322e-06, "add_states_from_episodes_to_batch": 2.677479822320047e-06, "numpy_to_tensor": 1.1864640659076136e-05, "batch_individual_items": 1.2175455514203e-05}}, "connector_pipeline_timer": 5.795273050404429e-05}, "episode_return_mean": 0.75, "env_step_timer": 1.3653396883911379e-05, "rlmodule_inference_timer": 3.0787293138329076e-05, "env_reset_timer": 0.0003967038884277398, "num_episodes": 20, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.972849723640464e-06, "listify_data_for_vector_env": 1.026847215624959e-05, "tensor_to_numpy": 1.4630516394689175e-05, "remove_single_ts_time_rank_from_batch": 1.1885867284006917e-05, "get_actions": 3.5338648419089546e-05, "un_batch_to_individual_items": 6.4757409356875515e-06}}, "connector_pipeline_timer": 0.00011254404972810369}, "episode_return_min": -14.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 0.75}, "num_episodes_lifetime": 300, "module_episode_returns_mean": {"default_policy": 0.75}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "sample": 0.11425090287199367, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "episode_duration_sec_mean": 0.005206026284722612, "num_env_steps_sampled_lifetime": 75400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "time_between_sampling": 10.110141534897021}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "b4fbc_00000", "date": "2025-08-11_18-53-56", "timestamp": 1754931236, "time_this_iter_s": 10.038815021514893, "time_total_s": 156.9740526676178, "pid": 11863, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1551fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 156.9740526676178, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 33.31333333333333, "ram_util_percent": 78.55333333333334}}
{"timers": {"training_iteration": 10.590074962939324, "restore_env_runners": 8.431271401322207e-06, "training_step": 10.58988588122299, "env_runner_sampling_timer": 1.6701233185435869, "learner_update_timer": 8.702850437717707, "synch_weights": 0.0016161994541373408, "restore_eval_env_runners": 5.3874764784478754e-05, "evaluation_iteration": 0.12280269216089049, "synch_eval_env_connectors": 0.00017554441489192737, "synch_env_connectors": 4.614461942276375e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2286787177764846e-05, "add_states_from_episodes_to_batch": 2.7114549505260236e-06, "add_observations_from_episodes_to_batch": 2.7786323526209615e-06, "add_time_dim_to_batch_and_zero_pad": 7.041265735176469e-06, "numpy_to_tensor": 1.2490382627660544e-05}}, "connector_pipeline_timer": 5.8966788847600466e-05}, "episode_return_mean": -0.06, "episode_return_min": -11.5, "env_step_timer": 1.3803592948839109e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.869758124125816e-05, "normalize_and_clip_actions": 7.918919694933486e-06, "un_batch_to_individual_items": 6.4795003164675455e-06, "listify_data_for_vector_env": 1.0380162111757182e-05, "remove_single_ts_time_rank_from_batch": 1.17379982078526e-05, "tensor_to_numpy": 1.5000789508744594e-05}}, "connector_pipeline_timer": 0.00011616523389477423}, "sample": 0.005861930816802979, "rlmodule_inference_timer": 3.128878483586162e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 3.965215625498719e-05, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": -0.06}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005191650671884417, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -431750.0, "module_episode_returns_mean": {"default_policy": -0.06}, "num_episodes": 250.0, "time_between_sampling": 0.03407958565889223, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -8635000.0, "episode_len_min": 20, "weights_seq_no": 15.0, "episode_return_max": 8.5, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3303.253233501276}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17675066267529982, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.01020959429511771, "add_observations_from_episodes_to_batch": 0.0008470675071290691, "add_columns_from_episodes_to_train_batch": 0.04310606600091741, "add_time_dim_to_batch_and_zero_pad": 0.103765205187899, "add_states_from_episodes_to_batch": 0.0035638109279703487, "batch_individual_items": 0.0149797301860425, "numpy_to_tensor": 9.15998930384989e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"use_intrinsic_rewards": 0.0, "curr_kl_coeff": 2.4655751076352317e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -7.081031799316406e-05, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_trainable_parameters": 16595, "vf_loss_unclipped": 38.94451904296875, "num_module_steps_trained_lifetime": 95904, "vf_loss": 0.26386722922325134, "entropy": 0.6825547814369202, "mean_kl_loss": 6.436332478187978e-05, "policy_loss": -0.0009633820154704154, "module_train_batch_size_mean": 999.0, "weights_seq_no": 16.0, "total_loss": 0.20354939997196198, "num_module_steps_trained_lifetime_throughput": 686.7009556350041}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.20361967384815216, "weights_seq_no": 96.0, "diff_num_grad_updates_vs_sampler_policy": 81.0, "vf_explained_var": 0.00019127130508422852, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 38.98809814453125, "num_module_steps_trained_lifetime": 575424, "vf_loss": 0.26388904452323914, "entropy": 0.6826289892196655, "mean_kl_loss": 5.865894127055071e-05, "policy_loss": -0.0009194628801196814, "module_train_batch_size_mean": 999.0}, "__all_modules__": {"num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 1150848, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 3024000, "num_env_steps_trained_lifetime_throughput": 40939.81498917898}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "weights_seq_no": 96.0, "diff_num_grad_updates_vs_sampler_policy": 81.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 575424}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 191808, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 504000, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime_throughput": 3608.846336512267, "num_module_steps_trained_throughput": 19490648.146217875, "num_module_steps_trained_lifetime_throughput": 12522801.866473021}, "intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained_lifetime": 95904, "default_optimizer_learning_rate": 0.0002715581955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 999.0, "weights_seq_no": 16.0, "num_module_steps_trained_lifetime_throughput": 686.7051772192316}, "IntrinsicAttentionMask": [[[0.3336094319820404, 0.3350423574447632, 0.3313482999801636], [0.3327946364879608, 0.330116331577301, 0.33708909153938293], [0.3347873389720917, 0.34288808703422546, 0.32232457399368286]], [[0.3309043347835541, 0.32972487807273865, 0.33937084674835205], [0.3308214843273163, 0.32960250973701477, 0.33957597613334656], [0.33148905634880066, 0.3305899202823639, 0.33792105317115784]], [[0.32999780774116516, 0.3363274931907654, 0.33367472887039185], [0.34245574474334717, 0.3252379596233368, 0.3323063254356384], [0.33724164962768555, 0.32984840869903564, 0.3329099416732788]], [[0.33486226201057434, 0.34063318371772766, 0.3245045840740204], [0.334482342004776, 0.33875906467437744, 0.32675865292549133], [0.33553892374038696, 0.3440828025341034, 0.32037821412086487]], [[0.3324461281299591, 0.3327109217643738, 0.3348430097103119], [0.3325807750225067, 0.33280545473098755, 0.33461374044418335], [0.3336603343486786, 0.33356234431266785, 0.3327772915363312]], [[0.28919708728790283, 0.4222671389579773, 0.2885357439517975], [0.4806448221206665, 0.030640624463558197, 0.4887145757675171], [0.28689029812812805, 0.4269082844257355, 0.28620144724845886]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "weights_seq_no": 16.0, "episode_return_max": 14.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.241408098074081e-06, "add_observations_from_episodes_to_batch": 2.8675322596126516e-06, "add_states_from_episodes_to_batch": 2.828628681131798e-06, "numpy_to_tensor": 1.2974059693333943e-05, "batch_individual_items": 1.3047761135088283e-05}}, "connector_pipeline_timer": 6.168453239923761e-05}, "episode_return_mean": 1.35, "env_step_timer": 1.4993034147242854e-05, "rlmodule_inference_timer": 3.308348348495969e-05, "env_reset_timer": 0.00039367351907380936, "num_episodes": 20, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.315098019556211e-06, "listify_data_for_vector_env": 1.153254745146554e-05, "tensor_to_numpy": 1.5912754228228595e-05, "remove_single_ts_time_rank_from_batch": 1.2449180396693701e-05, "get_actions": 3.939924211016099e-05, "un_batch_to_individual_items": 6.865364479447172e-06}}, "connector_pipeline_timer": 0.00012188142714287686}, "episode_return_min": -14.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 1.35}, "num_episodes_lifetime": 320, "module_episode_returns_mean": {"default_policy": 1.35}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "sample": 0.11425399759317478, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "episode_duration_sec_mean": 0.0052359637583140285, "num_env_steps_sampled_lifetime": 80400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "time_between_sampling": 10.108247961218192}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "b4fbc_00000", "date": "2025-08-11_18-54-06", "timestamp": 1754931246, "time_this_iter_s": 10.022398233413696, "time_total_s": 166.9964509010315, "pid": 11863, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1551fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 166.9964509010315, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 34.050000000000004, "ram_util_percent": 78.36428571428571}}
{"timers": {"training_iteration": 10.587503527479171, "restore_env_runners": 8.410288622382837e-06, "training_step": 10.587314309490061, "env_runner_sampling_timer": 1.6695110782788551, "learner_update_timer": 8.700767495009831, "synch_weights": 0.001611440379950125, "restore_eval_env_runners": 5.3415186540395594e-05, "evaluation_iteration": 0.12277717523972094, "synch_eval_env_connectors": 0.00017509147076558336, "synch_env_connectors": 4.614987061220811e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.304697918817299e-05, "add_states_from_episodes_to_batch": 2.8768310735786634e-06, "add_observations_from_episodes_to_batch": 2.9312606929724615e-06, "add_time_dim_to_batch_and_zero_pad": 7.4556738022059705e-06, "numpy_to_tensor": 1.3360638844016703e-05}}, "connector_pipeline_timer": 6.229100647921279e-05}, "episode_return_mean": 1.8600000000000003, "episode_return_min": -11.5, "env_step_timer": 1.4799918678605726e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.1871529799121565e-05, "normalize_and_clip_actions": 8.342475959331549e-06, "un_batch_to_individual_items": 6.83267472180179e-06, "listify_data_for_vector_env": 1.1088675861914182e-05, "remove_single_ts_time_rank_from_batch": 1.2264732264471612e-05, "tensor_to_numpy": 1.5944280370804235e-05}}, "connector_pipeline_timer": 0.00012368927099338478}, "sample": 0.005849008869793834, "rlmodule_inference_timer": 3.361661858725634e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 4.1499940991903535e-05, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 1.8600000000000003}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005537835889495908, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -462625.0, "module_episode_returns_mean": {"default_policy": 1.8600000000000003}, "num_episodes": 250.0, "time_between_sampling": 0.03458690556452551, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -9252500.0, "episode_len_min": 20, "weights_seq_no": 16.0, "episode_return_max": 8.5, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3140.702572528869}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17679126104791024, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.010197859191552073, "add_observations_from_episodes_to_batch": 0.0008556747525505169, "add_columns_from_episodes_to_train_batch": 0.04312702242071419, "add_time_dim_to_batch_and_zero_pad": 0.10380242313544923, "add_states_from_episodes_to_batch": 0.0035687303184327806, "batch_individual_items": 0.014960894133997373, "numpy_to_tensor": 9.137431380066005e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"use_intrinsic_rewards": 0.0, "curr_kl_coeff": 1.2327875538176158e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.0003876686096191406, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_trainable_parameters": 16595, "vf_loss_unclipped": 39.46406555175781, "num_module_steps_trained_lifetime": 101898, "vf_loss": 0.2638690173625946, "entropy": 0.6811255812644958, "mean_kl_loss": 3.4742301068035886e-05, "policy_loss": -0.00040356768295168877, "module_train_batch_size_mean": 999.0, "weights_seq_no": 17.0, "total_loss": 0.20411279797554016, "num_module_steps_trained_lifetime_throughput": 685.3111986856092}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.20414535701274872, "weights_seq_no": 102.0, "diff_num_grad_updates_vs_sampler_policy": 86.0, "vf_explained_var": 4.8279762268066406e-05, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 39.55811309814453, "num_module_steps_trained_lifetime": 611388, "vf_loss": 0.26388636231422424, "entropy": 0.6811712384223938, "mean_kl_loss": 3.231164373573847e-05, "policy_loss": -0.0003896677226293832, "module_train_batch_size_mean": 999.0}, "__all_modules__": {"num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 1222776, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 3213000, "num_env_steps_trained_lifetime_throughput": 40358.750658538556}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "weights_seq_no": 102.0, "diff_num_grad_updates_vs_sampler_policy": 86.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 611388}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 203796, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 535500, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime_throughput": 3601.5399194726247, "num_module_steps_trained_throughput": 19125483.84567074, "num_module_steps_trained_lifetime_throughput": 12524600.103056526}, "intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained_lifetime": 101898, "default_optimizer_learning_rate": 0.0002715581955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 999.0, "weights_seq_no": 17.0, "num_module_steps_trained_lifetime_throughput": 685.315144845943}, "IntrinsicAttentionMask": [[[0.33295220136642456, 0.33160609006881714, 0.3354417085647583], [0.3325319290161133, 0.3297394812107086, 0.3377285897731781], [0.33370324969291687, 0.3350428342819214, 0.33125391602516174]], [[0.3335922956466675, 0.33333325386047363, 0.3330744206905365], [0.33363258838653564, 0.33333325386047363, 0.3330341875553131], [0.3336728513240814, 0.33333322405815125, 0.33299392461776733]], [[0.32999783754348755, 0.3363274931907654, 0.33367472887039185], [0.3424557149410248, 0.3252379596233368, 0.3323063552379608], [0.33724164962768555, 0.32984843850135803, 0.3329099416732788]], [[0.33486226201057434, 0.3406331539154053, 0.324504554271698], [0.334482342004776, 0.33875903487205505, 0.32675862312316895], [0.33553895354270935, 0.3440828025341034, 0.32037824392318726]], [[0.3332443833351135, 0.3311086893081665, 0.33564698696136475], [0.33312132954597473, 0.32838958501815796, 0.3384890556335449], [0.3333635628223419, 0.3341551423072815, 0.33248135447502136]], [[0.2891971170902252, 0.4222671091556549, 0.2885357737541199], [0.48064467310905457, 0.030641067773103714, 0.4887142479419708], [0.2868903875350952, 0.42690813541412354, 0.28620150685310364]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "weights_seq_no": 17.0, "episode_return_max": 14.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.72065641384452e-06, "add_observations_from_episodes_to_batch": 2.747892942251614e-06, "add_states_from_episodes_to_batch": 2.6544203429834686e-06, "numpy_to_tensor": 1.1945155331727342e-05, "batch_individual_items": 1.225919499412473e-05}}, "connector_pipeline_timer": 5.816360566842644e-05}, "episode_return_mean": 1.75, "env_step_timer": 1.3664038100587038e-05, "rlmodule_inference_timer": 3.178264053419532e-05, "env_reset_timer": 0.0003911422043633673, "num_episodes": 20, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.977278687593068e-06, "listify_data_for_vector_env": 1.0341521421519134e-05, "tensor_to_numpy": 1.4778088838979999e-05, "remove_single_ts_time_rank_from_batch": 1.1965212729394485e-05, "get_actions": 3.532695455891633e-05, "un_batch_to_individual_items": 6.561722819254753e-06}}, "connector_pipeline_timer": 0.00011329101872083605}, "episode_return_min": -14.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 1.75}, "num_episodes_lifetime": 340, "module_episode_returns_mean": {"default_policy": 1.75}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "sample": 0.1142358351170432, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "episode_duration_sec_mean": 0.0052432791562750936, "num_env_steps_sampled_lifetime": 85400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "time_between_sampling": 10.11073318410616}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "b4fbc_00000", "date": "2025-08-11_18-54-17", "timestamp": 1754931257, "time_this_iter_s": 10.4544837474823, "time_total_s": 177.4509346485138, "pid": 11863, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1551fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 177.4509346485138, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 37.88, "ram_util_percent": 78.87999999999998}}
{"timers": {"training_iteration": 10.579953323454736, "restore_env_runners": 8.432025890151185e-06, "training_step": 10.579762794724738, "env_runner_sampling_timer": 1.6686607483255689, "learner_update_timer": 8.694094546729557, "synch_weights": 0.001603397226200021, "restore_eval_env_runners": 5.306145514075902e-05, "evaluation_iteration": 0.12273561181765137, "synch_eval_env_connectors": 0.00017444555515871697, "synch_env_connectors": 4.618416147868257e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2900602949232141e-05, "add_states_from_episodes_to_batch": 2.827456449875699e-06, "add_observations_from_episodes_to_batch": 2.8879859532500046e-06, "add_time_dim_to_batch_and_zero_pad": 7.355777141906063e-06, "numpy_to_tensor": 1.2983416505979634e-05}}, "connector_pipeline_timer": 6.147105244452027e-05}, "episode_return_mean": 0.17999999999999997, "episode_return_min": -11.5, "env_step_timer": 1.4689179193847392e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.086533597121989e-05, "normalize_and_clip_actions": 8.301412450567927e-06, "un_batch_to_individual_items": 6.7441671739924e-06, "listify_data_for_vector_env": 1.0902423125226288e-05, "remove_single_ts_time_rank_from_batch": 1.2155890253673661e-05, "tensor_to_numpy": 1.5723699641773107e-05}}, "connector_pipeline_timer": 0.00012173838086365141}, "sample": 0.005849468807468859, "rlmodule_inference_timer": 3.313557504111644e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 4.038374982216887e-05, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 0.17999999999999997}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.00545709152240306, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -493500.0, "module_episode_returns_mean": {"default_policy": 0.17999999999999997}, "num_episodes": 250.0, "time_between_sampling": 0.035836441495287676, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -9870000.0, "episode_len_min": 20, "weights_seq_no": 17.0, "episode_return_max": 8.5, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3162.135724902534}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17670744676729186, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.0101827235193364, "add_observations_from_episodes_to_batch": 0.0008551171648863677, "add_columns_from_episodes_to_train_batch": 0.043107140537378824, "add_time_dim_to_batch_and_zero_pad": 0.10377813431461927, "add_states_from_episodes_to_batch": 0.0035699863547583423, "batch_individual_items": 0.014937214362247053, "numpy_to_tensor": 9.094932060073913e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"use_intrinsic_rewards": 0.0, "curr_kl_coeff": 6.163937769088079e-07, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.0002906322479248047, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_trainable_parameters": 16595, "vf_loss_unclipped": 39.235416412353516, "num_module_steps_trained_lifetime": 107892, "vf_loss": 0.26386749744415283, "entropy": 0.6796666383743286, "mean_kl_loss": 4.8067660827655345e-05, "policy_loss": -0.00038203783333301544, "module_train_batch_size_mean": 999.0, "weights_seq_no": 18.0, "total_loss": 0.20413538813591003, "num_module_steps_trained_lifetime_throughput": 684.2800171296245}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.20416612923145294, "weights_seq_no": 108.0, "diff_num_grad_updates_vs_sampler_policy": 91.0, "vf_explained_var": 0.00014406442642211914, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 39.32288360595703, "num_module_steps_trained_lifetime": 647352, "vf_loss": 0.26388511061668396, "entropy": 0.6797031760215759, "mean_kl_loss": 4.590073513099924e-05, "policy_loss": -0.00037238927325233817, "module_train_batch_size_mean": 999.0}, "__all_modules__": {"num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 1294704, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 3402000, "num_env_steps_trained_lifetime_throughput": 39803.50373806553}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "weights_seq_no": 108.0, "diff_num_grad_updates_vs_sampler_policy": 91.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 647352}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 215784, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 567000, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime_throughput": 3596.1179958086664, "num_module_steps_trained_throughput": 18777371.606296096, "num_module_steps_trained_lifetime_throughput": 12519895.486018337}, "intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained_lifetime": 107892, "default_optimizer_learning_rate": 0.0002715581955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 999.0, "weights_seq_no": 18.0, "num_module_steps_trained_lifetime_throughput": 684.2836939951833}, "IntrinsicAttentionMask": [[[0.3336332440376282, 0.3322843909263611, 0.33408233523368835], [0.3339559733867645, 0.3311515748500824, 0.3348924219608307], [0.333525687456131, 0.3326609432697296, 0.333813339471817]], [[0.330891489982605, 0.3405715823173523, 0.32853686809539795], [0.331564724445343, 0.33858704566955566, 0.32984814047813416], [0.3307240605354309, 0.3410639464855194, 0.32821202278137207]], [[0.3228456676006317, 0.33518195152282715, 0.34197232127189636], [0.3305320143699646, 0.333842009305954, 0.33562594652175903], [0.3346759080886841, 0.3330857455730438, 0.3322383761405945]], [[0.32750949263572693, 0.34754711389541626, 0.3249433636665344], [0.33023449778556824, 0.34092122316360474, 0.32884424924850464], [0.32714539766311646, 0.34842926263809204, 0.3244253695011139]], [[0.33252790570259094, 0.333180695772171, 0.3342914283275604], [0.33756929636001587, 0.3341101109981537, 0.32832062244415283], [0.3461533784866333, 0.33555087447166443, 0.31829577684402466]], [[0.3235127627849579, 0.35022246837615967, 0.32626473903656006], [0.5919715166091919, 0.013302888721227646, 0.3947256803512573], [0.37303900718688965, 0.2670069932937622, 0.35995393991470337]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "weights_seq_no": 18.0, "episode_return_max": 14.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.553301316618528e-06, "add_observations_from_episodes_to_batch": 2.72323396754347e-06, "add_states_from_episodes_to_batch": 2.638608017976807e-06, "numpy_to_tensor": 1.1789926509723638e-05, "batch_individual_items": 1.2128740454465254e-05}}, "connector_pipeline_timer": 5.736404646834598e-05}, "episode_return_mean": 2.95, "env_step_timer": 1.3515771531791995e-05, "rlmodule_inference_timer": 3.0445375923602598e-05, "env_reset_timer": 0.00038811619301972703, "num_episodes": 20, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.927109149961392e-06, "listify_data_for_vector_env": 1.0230989345124393e-05, "tensor_to_numpy": 1.4657517587107828e-05, "remove_single_ts_time_rank_from_batch": 1.1762724407458461e-05, "get_actions": 3.552521513782136e-05, "un_batch_to_individual_items": 6.544307975921726e-06}}, "connector_pipeline_timer": 0.00011258543374549977}, "episode_return_min": -14.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 2.95}, "num_episodes_lifetime": 360, "module_episode_returns_mean": {"default_policy": 2.95}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "sample": 0.11421244217673303, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "episode_duration_sec_mean": 0.0052368654252495615, "num_env_steps_sampled_lifetime": 90400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "time_between_sampling": 10.108180139354598}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "b4fbc_00000", "date": "2025-08-11_18-54-27", "timestamp": 1754931267, "time_this_iter_s": 9.95241117477417, "time_total_s": 187.40334582328796, "pid": 11863, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1551fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 187.40334582328796, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 32.95, "ram_util_percent": 78.99285714285715}}
{"timers": {"training_iteration": 10.573701523139643, "restore_env_runners": 8.398955148377544e-06, "training_step": 10.573511274697378, "env_runner_sampling_timer": 1.6679843304318918, "learner_update_timer": 8.68852983959253, "synch_weights": 0.001595041173867868, "restore_eval_env_runners": 5.25991798757235e-05, "evaluation_iteration": 0.12267856485984524, "synch_eval_env_connectors": 0.00017386859976590167, "synch_env_connectors": 4.617642110974606e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2265586654375026e-05, "add_states_from_episodes_to_batch": 2.7156006001423138e-06, "add_observations_from_episodes_to_batch": 2.7639811548903724e-06, "add_time_dim_to_batch_and_zero_pad": 7.025168349108904e-06, "numpy_to_tensor": 1.2164246522134172e-05}}, "connector_pipeline_timer": 5.8618993780039814e-05}, "episode_return_mean": 0.8199999999999998, "episode_return_min": -11.5, "env_step_timer": 1.376237404856789e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.7912820155571325e-05, "normalize_and_clip_actions": 7.864860328085238e-06, "un_batch_to_individual_items": 6.462372878437449e-06, "listify_data_for_vector_env": 1.0448391465299623e-05, "remove_single_ts_time_rank_from_batch": 1.1713068132046814e-05, "tensor_to_numpy": 1.4924672493470312e-05}}, "connector_pipeline_timer": 0.00011531847152576687}, "sample": 0.005939077420628589, "rlmodule_inference_timer": 5.484801339004028e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 3.3389006419242825e-05, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 0.8199999999999998}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.0056001385012641545, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -524375.0, "module_episode_returns_mean": {"default_policy": 0.8199999999999998}, "num_episodes": 250.0, "time_between_sampling": 0.03414040839848629, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -10487500.0, "episode_len_min": 20, "weights_seq_no": 18.0, "episode_return_max": 8.5, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3331.5240516082426}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1766370514691639, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.010167511703856817, "add_observations_from_episodes_to_batch": 0.0008548468234624799, "add_columns_from_episodes_to_train_batch": 0.04309122705105616, "add_time_dim_to_batch_and_zero_pad": 0.10376126713048976, "add_states_from_episodes_to_batch": 0.0035716889913763854, "batch_individual_items": 0.014913251798693246, "numpy_to_tensor": 9.196982695671209e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"use_intrinsic_rewards": 0.0, "curr_kl_coeff": 3.0819688845440396e-07, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -3.039836883544922e-05, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_trainable_parameters": 16595, "vf_loss_unclipped": 39.04433822631836, "num_module_steps_trained_lifetime": 113886, "vf_loss": 0.2638675272464752, "entropy": 0.6782785058021545, "mean_kl_loss": 3.815479431068525e-05, "policy_loss": -0.00021121530153322965, "module_train_batch_size_mean": 999.0, "weights_seq_no": 19.0, "total_loss": 0.2043083757162094, "num_module_steps_trained_lifetime_throughput": 683.3903868418147}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.2043362557888031, "weights_seq_no": 114.0, "diff_num_grad_updates_vs_sampler_policy": 96.0, "vf_explained_var": 0.00016510486602783203, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 39.12337112426758, "num_module_steps_trained_lifetime": 683316, "vf_loss": 0.26388978958129883, "entropy": 0.6782979965209961, "mean_kl_loss": 3.714489139383659e-05, "policy_loss": -0.00020666804630309343, "module_train_batch_size_mean": 999.0}, "__all_modules__": {"num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 1366632, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 3591000, "num_env_steps_trained_lifetime_throughput": 39276.006602608366}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "weights_seq_no": 114.0, "diff_num_grad_updates_vs_sampler_policy": 96.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 683316}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 227772, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 598500, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime_throughput": 3591.4401129549765, "num_module_steps_trained_throughput": 18460870.464486856, "num_module_steps_trained_lifetime_throughput": 12530288.14479281}, "intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained_lifetime": 113886, "default_optimizer_learning_rate": 0.0002715581955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 999.0, "weights_seq_no": 19.0, "num_module_steps_trained_lifetime_throughput": 683.3937992471016}, "IntrinsicAttentionMask": [[[0.333609402179718, 0.3350422978401184, 0.3313482999801636], [0.3327946066856384, 0.3301163613796234, 0.33708900213241577], [0.33478739857673645, 0.3428879976272583, 0.32232460379600525]], [[0.3341585099697113, 0.3333326578140259, 0.3325088322162628], [0.33419880270957947, 0.3333325684070587, 0.33246859908103943], [0.33423912525177, 0.33333253860473633, 0.3324283957481384]], [[0.3288475573062897, 0.33580902218818665, 0.3353434205055237], [0.3347499668598175, 0.3325524926185608, 0.3326975703239441], [0.3343574106693268, 0.3327687978744507, 0.33287379145622253]], [[0.3300476372241974, 0.34137699007987976, 0.32857537269592285], [0.33273306488990784, 0.33480775356292725, 0.3324592113494873], [0.3296887278556824, 0.34225180745124817, 0.3280595541000366]], [[0.3332443833351135, 0.3311086893081665, 0.33564692735671997], [0.3331213593482971, 0.32838964462280273, 0.33848899602890015], [0.33336353302001953, 0.3341550827026367, 0.332481324672699]], [[0.3151971697807312, 0.37707939743995667, 0.30772334337234497], [0.4065573513507843, 0.0413428358733654, 0.552099883556366], [0.27792027592658997, 0.4624751806259155, 0.2596046030521393]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "weights_seq_no": 19.0, "episode_return_max": 14.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.448852771917918e-06, "add_observations_from_episodes_to_batch": 2.8736756955387165e-06, "add_states_from_episodes_to_batch": 2.8640857073684807e-06, "numpy_to_tensor": 1.3160402856977806e-05, "batch_individual_items": 1.2839192793575907e-05}}, "connector_pipeline_timer": 6.167047012053409e-05}, "episode_return_mean": 2.75, "env_step_timer": 1.511491404026349e-05, "rlmodule_inference_timer": 3.4104944329865306e-05, "env_reset_timer": 0.00038489836093668673, "num_episodes": 20, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.525104845688576e-06, "listify_data_for_vector_env": 1.0677632978672548e-05, "tensor_to_numpy": 1.5459108507385794e-05, "remove_single_ts_time_rank_from_batch": 1.2147260598297083e-05, "get_actions": 3.9797944742842854e-05, "un_batch_to_individual_items": 6.676232443918184e-06}}, "connector_pipeline_timer": 0.00012077347580767656}, "episode_return_min": -14.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 2.75}, "num_episodes_lifetime": 380, "module_episode_returns_mean": {"default_policy": 2.75}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "sample": 0.11425252150416043, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "episode_duration_sec_mean": 0.00523231914266944, "num_env_steps_sampled_lifetime": 95400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "time_between_sampling": 10.106844282961374}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "b4fbc_00000", "date": "2025-08-11_18-54-37", "timestamp": 1754931277, "time_this_iter_s": 10.081009864807129, "time_total_s": 197.4843556880951, "pid": 11863, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1551fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 197.4843556880951, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 35.82142857142858, "ram_util_percent": 79.14285714285714}}
{"timers": {"training_iteration": 10.566102769988277, "restore_env_runners": 8.366635373333435e-06, "training_step": 10.56591286403951, "env_runner_sampling_timer": 1.6670501779580904, "learner_update_timer": 8.681884549946139, "synch_weights": 0.0015863024328743533, "restore_eval_env_runners": 5.213401857508049e-05, "evaluation_iteration": 0.1226856550512178, "synch_eval_env_connectors": 0.0001730028342683572, "synch_env_connectors": 4.6097954345763785e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2209773579624804e-05, "add_states_from_episodes_to_batch": 2.7309379119086634e-06, "add_observations_from_episodes_to_batch": 2.7581894087667755e-06, "add_time_dim_to_batch_and_zero_pad": 6.974181121921519e-06, "numpy_to_tensor": 1.2211087788564855e-05}}, "connector_pipeline_timer": 5.860498349400409e-05}, "episode_return_mean": 1.2200000000000002, "episode_return_min": -11.5, "env_step_timer": 1.3706199845466585e-05, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.763042353354579e-05, "normalize_and_clip_actions": 7.869566957855354e-06, "un_batch_to_individual_items": 6.4684652238077574e-06, "listify_data_for_vector_env": 1.0415028132357967e-05, "remove_single_ts_time_rank_from_batch": 1.1697395298020576e-05, "tensor_to_numpy": 1.4902514504850925e-05}}, "connector_pipeline_timer": 0.00011504157173155283}, "sample": 0.005554588970749303, "rlmodule_inference_timer": 3.0656792626516186e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 3.2307699436433075e-05, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 1.2200000000000002}, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005152205649763347, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -555250.0, "module_episode_returns_mean": {"default_policy": 1.2200000000000002}, "num_episodes": 250.0, "time_between_sampling": 0.03465350421500866, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -11105000.0, "episode_len_min": 20, "weights_seq_no": 19.0, "episode_return_max": 8.5, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime_throughput": 3336.9806965345306}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1765545338750138, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.010149983247338012, "add_observations_from_episodes_to_batch": 0.0008545208543916764, "add_columns_from_episodes_to_train_batch": 0.043072451030488304, "add_time_dim_to_batch_and_zero_pad": 0.10374030403974549, "add_states_from_episodes_to_batch": 0.003572743771446485, "batch_individual_items": 0.014888490111305532, "numpy_to_tensor": 9.164720773880348e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"use_intrinsic_rewards": 0.0, "curr_kl_coeff": 1.5409844422720198e-07, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.0001537799835205078, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_trainable_parameters": 16595, "vf_loss_unclipped": 38.63269805908203, "num_module_steps_trained_lifetime": 119880, "vf_loss": 0.26386740803718567, "entropy": 0.6768792271614075, "mean_kl_loss": 4.150289169047028e-05, "policy_loss": -0.0005752932629548013, "module_train_batch_size_mean": 999.0, "weights_seq_no": 20.0, "total_loss": 0.20394635200500488, "num_module_steps_trained_lifetime_throughput": 682.7596273331485}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.20399577915668488, "weights_seq_no": 120.0, "diff_num_grad_updates_vs_sampler_policy": 101.0, "vf_explained_var": 0.00024241209030151367, "use_intrinsic_rewards": 1.0, "num_module_steps_trained": 35964, "vf_loss_unclipped": 38.66686248779297, "num_module_steps_trained_lifetime": 719280, "vf_loss": 0.2638930678367615, "entropy": 0.6769461035728455, "mean_kl_loss": 3.816885509877466e-05, "policy_loss": -0.000551902165170759, "module_train_batch_size_mean": 999.0}, "__all_modules__": {"num_module_steps_trained": 71928, "num_module_steps_trained_lifetime": 1438560, "num_env_steps_trained": 189000, "num_env_steps_trained_lifetime": 3780000, "num_env_steps_trained_lifetime_throughput": 38776.9774032468}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "weights_seq_no": 120.0, "diff_num_grad_updates_vs_sampler_policy": 101.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 719280}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 239760, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 630000, "num_module_steps_trained": 11988, "num_env_steps_trained_lifetime_throughput": 3588.1227951107835, "num_module_steps_trained_throughput": 18166178.985043485, "num_module_steps_trained_lifetime_throughput": 12547484.478632707}, "intrinsic_reward_module": {"total_loss": 0.0, "num_module_steps_trained_lifetime": 119880, "default_optimizer_learning_rate": 0.0002715581955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_trainable_parameters": 8266, "gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 999.0, "weights_seq_no": 20.0, "num_module_steps_trained_lifetime_throughput": 682.7627820807276}, "IntrinsicAttentionMask": [[[0.33318421244621277, 0.3346152603626251, 0.3322005569934845], [0.33360666036605835, 0.33092188835144043, 0.33547139167785645], [0.3328787684440613, 0.33717259764671326, 0.32994866371154785]], [[0.335161417722702, 0.3325484097003937, 0.3322901725769043], [0.3380351662635803, 0.3313123881816864, 0.33065247535705566], [0.3383210301399231, 0.33118927478790283, 0.3304896950721741]], [[0.3228397071361542, 0.34281620383262634, 0.33434417843818665], [0.3351903259754181, 0.33167433738708496, 0.3331352770328522], [0.3300198018550873, 0.3363076448440552, 0.33367249369621277]], [[0.3328219950199127, 0.33511340618133545, 0.33206456899642944], [0.3331490159034729, 0.3339761197566986, 0.3328748047351837], [0.3327130377292633, 0.33549147844314575, 0.33179551362991333]], [[0.3334216773509979, 0.33585792779922485, 0.330720454454422], [0.3333255350589752, 0.3331267833709717, 0.3335477113723755], [0.3335108160972595, 0.33891740441322327, 0.3275717794895172]], [[0.315197229385376, 0.37707948684692383, 0.30772337317466736], [0.4065574109554291, 0.04134388640522957, 0.5520986318588257], [0.27792057394981384, 0.4624745845794678, 0.25960490107536316]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "weights_seq_no": 20.0, "episode_return_max": 14.5, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.628784649552233e-06, "add_observations_from_episodes_to_batch": 2.7322278905263895e-06, "add_states_from_episodes_to_batch": 2.626465613699708e-06, "numpy_to_tensor": 1.175330184135735e-05, "batch_individual_items": 1.2121273527336251e-05}}, "connector_pipeline_timer": 5.7321126226239986e-05}, "episode_return_mean": 2.55, "env_step_timer": 1.3473355437530148e-05, "rlmodule_inference_timer": 3.0220535607730943e-05, "env_reset_timer": 0.0003817072880412458, "num_episodes": 20, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.898568003366353e-06, "listify_data_for_vector_env": 1.017031381772762e-05, "tensor_to_numpy": 1.4401729240928473e-05, "remove_single_ts_time_rank_from_batch": 1.1719882249416309e-05, "get_actions": 3.421898649324866e-05, "un_batch_to_individual_items": 6.459599726497235e-06}}, "connector_pipeline_timer": 0.00011064738560780141}, "episode_return_min": -14.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 2.55}, "num_episodes_lifetime": 400, "module_episode_returns_mean": {"default_policy": 2.55}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "sample": 0.11420213253876352, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "episode_duration_sec_mean": 0.005217119540320709, "num_env_steps_sampled_lifetime": 100400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "time_between_sampling": 10.104119599712508}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "b4fbc_00000", "date": "2025-08-11_18-54-47", "timestamp": 1754931287, "time_this_iter_s": 9.930721044540405, "time_total_s": 207.4150767326355, "pid": 11863, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1551fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 207.4150767326355, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 32.75714285714286, "ram_util_percent": 79.07142857142857}}
