{"timers": {"training_iteration": 12.053745625074953, "restore_env_runners": 8.375034667551517e-06, "training_step": 12.053521708003245, "env_runner_sampling_timer": 2.2755516660399735, "learner_update_timer": 9.580205249949358, "synch_weights": 0.001944500021636486}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.2541880171883193e-06, "add_observations_from_episodes_to_batch": 3.4944924000355933e-06, "batch_individual_items": 1.899436238003072e-05, "numpy_to_tensor": 1.737653434730796e-05, "add_time_dim_to_batch_and_zero_pad": 9.118407934552108e-06}}, "connector_pipeline_timer": 8.302582951339168e-05}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.3624225250120355e-05, "listify_data_for_vector_env": 1.247716809457627e-05, "remove_single_ts_time_rank_from_batch": 1.5562448131994066e-05, "un_batch_to_individual_items": 7.897125142761746e-06, "get_actions": 8.226091228709296e-05, "tensor_to_numpy": 2.0699381257598496e-05}}, "connector_pipeline_timer": 0.00018454845974070585}, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "num_episodes": 250.0, "episode_len_max": 20, "rlmodule_inference_timer": 5.20744276845445e-05, "episode_len_min": 20, "time_between_sampling": 0.0008121883670105437, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 10.191744832559449, "env_reset_timer": 0.00013330298754806475, "agent_episode_returns_mean": {"default_agent": -1.2200000000000002}, "num_episodes_lifetime": 31375.0, "episode_return_mean": -1.2200000000000002, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.00842356774500189, "env_step_timer": 2.0874921284103056e-05, "episode_len_mean": 20.0, "episode_return_max": 9.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.007440941308625044, "module_episode_returns_mean": {"default_policy": -1.2200000000000002}, "num_env_steps_sampled_lifetime": 627500.0, "weights_seq_no": 0.0, "episode_return_min": -10.5, "env_to_module_sum_episodes_length_in": 10.191744832559449, "num_env_steps_sampled_lifetime_throughput": 2713.6377655539145}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000, "learner_connector": {"connector_pipeline_timer": 0.15549762500450015, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.010893625090830028, "add_observations_from_episodes_to_batch": 0.0008783329976722598, "add_columns_from_episodes_to_train_batch": 0.04193754098378122, "add_time_dim_to_batch_and_zero_pad": 0.09051312494557351, "add_states_from_episodes_to_batch": 0.0035600829869508743, "batch_individual_items": 0.007473875069990754, "numpy_to_tensor": 7.025001104921103e-05}}}, "learner_connector_sum_episodes_length_out": 5250}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_env_steps_trained_lifetime": 216000, "num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 71820, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 58133.124441978645}, "intrinsic_reward_module": {"weights_seq_no": 6.0, "num_module_steps_trained_lifetime": 35910, "module_train_batch_size_mean": 998.5423314844973, "num_module_steps_trained": 35910, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}, "default_policy": {"policy_loss": -6.548010424012318e-05, "num_module_steps_trained_lifetime": 35910, "module_train_batch_size_mean": 998.5423314844973, "vf_loss_unclipped": 42.119686126708984, "num_module_steps_trained": 35910, "total_loss": 0.24965256452560425, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 5.657982455886668e-07, "vf_explained_var": 0.00047206878662109375, "diff_num_grad_updates_vs_sampler_policy": 6.0, "entropy": 0.6929036974906921, "weights_seq_no": 6.0, "vf_loss": 0.3219137191772461}}}, "IntrinsicAttentionMask": [[[0.16665661334991455, 0.1664312481880188, 0.16653642058372498, 0.16680097579956055, 0.16682051122188568, 0.16675420105457306], [0.166642427444458, 0.1661033183336258, 0.16635477542877197, 0.16698826849460602, 0.1670350879430771, 0.16687613725662231], [0.16664908826351166, 0.1662563681602478, 0.16643959283828735, 0.1669008582830429, 0.16693492233753204, 0.1668192446231842], [0.16666558384895325, 0.16664128005504608, 0.1666526347398758, 0.16668114066123962, 0.16668324172496796, 0.1666761040687561], [0.16666679084300995, 0.16666969656944275, 0.1666683405637741, 0.1666649430990219, 0.16666468977928162, 0.16666553914546967], [0.16666269302368164, 0.16657322645187378, 0.16661499440670013, 0.1667199730873108, 0.1667277216911316, 0.16670142114162445]], [[0.16667111217975616, 0.16673368215560913, 0.16665364801883698, 0.16664491593837738, 0.16659781336784363, 0.16669873893260956], [0.16666249930858612, 0.16660428047180176, 0.1666787564754486, 0.16668687760829926, 0.16673074662685394, 0.16663677990436554], [0.16667352616786957, 0.1667698323726654, 0.16664665937423706, 0.1666332185268402, 0.16656072437763214, 0.16671603918075562], [0.16667471826076508, 0.16678789258003235, 0.16664312779903412, 0.16662734746932983, 0.1665421575307846, 0.16672468185424805], [0.1666812002658844, 0.16688545048236847, 0.16662420332431793, 0.1665957272052765, 0.16644209623336792, 0.16677136719226837], [0.16666732728481293, 0.16667655110359192, 0.16666476428508759, 0.16666346788406372, 0.1666565239429474, 0.16667141020298004]], [[0.16596174240112305, 0.16682645678520203, 0.1670917421579361, 0.1665240079164505, 0.16657304763793945, 0.16702304780483246], [0.1665583848953247, 0.16669124364852905, 0.16673187911510468, 0.16664482653141022, 0.1666523665189743, 0.16672135889530182], [0.16674108803272247, 0.16664978861808777, 0.1666218787431717, 0.1666816622018814, 0.16667649149894714, 0.1666291058063507], [0.166349858045578, 0.16673851013183594, 0.16685751080513, 0.16660268604755402, 0.16662470996379852, 0.16682671010494232], [0.16638368368148804, 0.1667308360338211, 0.16683712601661682, 0.166609525680542, 0.16662921011447906, 0.16680961847305298], [0.1666937917470932, 0.16666051745414734, 0.16665033996105194, 0.16667212545871735, 0.16667024791240692, 0.16665297746658325]], [[0.1665906012058258, 0.16679175198078156, 0.16661299765110016, 0.16662420332431793, 0.16668462753295898, 0.16669583320617676], [0.1668776422739029, 0.16632011532783508, 0.16681545972824097, 0.1667843610048294, 0.16661670804023743, 0.16658566892147064], [0.1666225790977478, 0.16673918068408966, 0.16663555800914764, 0.16664205491542816, 0.1666771024465561, 0.16668358445167542], [0.1666385531425476, 0.1667128950357437, 0.1666468381881714, 0.16665098071098328, 0.16667331755161285, 0.16667744517326355], [0.1667248010635376, 0.16657108068466187, 0.16670766472816467, 0.1666991114616394, 0.16665290296077728, 0.16664434969425201], [0.1667407900094986, 0.1665448248386383, 0.1667189598083496, 0.16670803725719452, 0.16664913296699524, 0.16663821041584015]], [[0.1660640984773636, 0.16692933440208435, 0.16657763719558716, 0.16724401712417603, 0.16667576134204865, 0.16650916635990143], [0.1665741205215454, 0.16670699417591095, 0.16665305197238922, 0.16675516963005066, 0.1666681170463562, 0.16664253175258636], [0.16636700928211212, 0.16679726541042328, 0.16662251949310303, 0.1669534593820572, 0.1666712760925293, 0.16658847033977509], [0.166759192943573, 0.16662633419036865, 0.166680246591568, 0.16657821834087372, 0.1666651964187622, 0.16669075191020966], [0.16642481088638306, 0.16677206754684448, 0.1666310429573059, 0.16689808666706085, 0.16667041182518005, 0.16660356521606445], [0.166326642036438, 0.16681484878063202, 0.1666165441274643, 0.16699212789535522, 0.16667188704013824, 0.16657790541648865]], [[0.16656717658042908, 0.16676829755306244, 0.16673023998737335, 0.16660076379776, 0.16666118800640106, 0.16667239367961884], [0.16694276034832, 0.16638502478599548, 0.166490375995636, 0.16684944927692413, 0.16668172180652618, 0.1666506677865982], [0.16687168180942535, 0.16645747423171997, 0.16653575003147125, 0.16680240631103516, 0.16667786240577698, 0.1666547954082489], [0.16662989556789398, 0.1667042225599289, 0.1666901558637619, 0.16664230823516846, 0.16666464507579803, 0.16666877269744873], [0.166742742061615, 0.16658900678157806, 0.16661807894706726, 0.1667170524597168, 0.16667082905769348, 0.1666622757911682], [0.16676366329193115, 0.16656766831874847, 0.16660472750663757, 0.16673089563846588, 0.1666719913482666, 0.1666610687971115]]], "default_policy": {"num_module_steps_trained_lifetime": 5985, "module_train_batch_size_mean": 998.9117791197002, "vf_loss_unclipped": 42.190799713134766, "num_module_steps_trained": 5985, "num_trainable_parameters": 16595, "total_loss": 0.2486439347267151, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 8.630543106846744e-07, "weights_seq_no": 1.0, "vf_loss": 0.3206344544887543, "curr_kl_coeff": 0.08079196512699127, "vf_explained_var": -0.0007107257843017578, "policy_loss": -7.754992111586034e-05, "entropy": 0.6929090619087219, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 655.5444464641994}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 5985, "module_train_batch_size_mean": 998.9117791197002, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5985, "num_trainable_parameters": 8266, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 1.0, "num_module_steps_trained_lifetime_throughput": 655.5572499535342}, "__all_modules__": {"num_env_steps_trained_lifetime": 36000, "num_env_steps_trained": 36000, "num_module_steps_trained_lifetime": 11970, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3948.024163539051, "num_module_steps_trained_throughput": 29940647.139946595, "num_module_steps_trained_lifetime_throughput": 13016734.054686612}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 2.45, "sample": 0.12328587507363409, "env_step_timer": 1.615114274390766e-05, "episode_return_max": 12.5, "episode_return_min": -11.5, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.559432645567684e-06, "numpy_to_tensor": 1.3092953054920945e-05, "add_time_dim_to_batch_and_zero_pad": 8.581467766064828e-06, "add_states_from_episodes_to_batch": 2.7722504499443463e-06, "batch_individual_items": 1.2861767324037164e-05}}, "connector_pipeline_timer": 6.577397064279495e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.216013141322508, "num_episodes_lifetime": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 5400, "episode_duration_sec_mean": 0.005546901910565794, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.742525556242416e-06, "get_actions": 4.788776328094705e-05, "tensor_to_numpy": 1.8071189081494897e-05, "normalize_and_clip_actions": 9.529176209864803e-06, "remove_single_ts_time_rank_from_batch": 1.3232378035751123e-05, "listify_data_for_vector_env": 1.0562674234079495e-05}}, "connector_pipeline_timer": 0.00013262526520824202}, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "episode_len_max": 20, "weights_seq_no": 1.0, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "num_episodes": 20, "rlmodule_inference_timer": 3.811215252221638e-05, "num_env_steps_sampled": 400, "env_reset_timer": 0.0005720419576391578, "module_episode_returns_mean": {"default_policy": 2.45}, "env_to_module_sum_episodes_length_in": 10.216013141322508, "agent_episode_returns_mean": {"default_agent": 2.45}}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "b1762_00000", "date": "2025-08-11_18-23-56", "timestamp": 1754929436, "time_this_iter_s": 12.192831039428711, "time_total_s": 12.192831039428711, "pid": 10959, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12.192831039428711, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 49.74444444444444, "ram_util_percent": 81.13888888888889}}
{"timers": {"training_iteration": 12.035234812984708, "restore_env_runners": 8.386704139411448e-06, "training_step": 12.035009565502405, "env_runner_sampling_timer": 2.2702597227087242, "learner_update_timer": 9.566857302868739, "synch_weights": 0.0019412400212604553, "restore_eval_env_runners": 6.337498780339956e-05, "evaluation_iteration": 0.1360912909731269, "synch_eval_env_connectors": 0.00021624995861202478, "synch_env_connectors": 7.541966624557972e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7719495688368447e-06, "add_observations_from_episodes_to_batch": 2.9035096847275503e-06, "batch_individual_items": 1.288320941626639e-05, "numpy_to_tensor": 1.3087005007099651e-05, "add_time_dim_to_batch_and_zero_pad": 7.469047353244538e-06}}, "connector_pipeline_timer": 6.223430812736561e-05}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.185576017057601e-06, "listify_data_for_vector_env": 1.0615038067380012e-05, "remove_single_ts_time_rank_from_batch": 1.2006475986713613e-05, "un_batch_to_individual_items": 6.735368467429099e-06, "get_actions": 4.197335754663323e-05, "tensor_to_numpy": 1.588938779378176e-05}}, "connector_pipeline_timer": 0.0001228408602697175}, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "num_episodes": 250.0, "episode_len_max": 20, "rlmodule_inference_timer": 4.754261635011269e-05, "episode_len_min": 20, "time_between_sampling": 0.037553617958838915, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 5.795081711869722e-05, "agent_episode_returns_mean": {"default_agent": -0.17999999999999997}, "num_episodes_lifetime": 500.0, "episode_return_mean": -0.17999999999999997, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.006244442626974916, "env_step_timer": 1.4466283846281721e-05, "episode_len_mean": 20.0, "episode_return_max": 9.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.006057088154833764, "module_episode_returns_mean": {"default_policy": -0.17999999999999997}, "num_env_steps_sampled_lifetime": 10000.0, "weights_seq_no": 1.0, "episode_return_min": -10.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3119.6948365183343}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1555228737543803, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.010879143009660766, "add_observations_from_episodes_to_batch": 0.0008787638379726559, "add_columns_from_episodes_to_train_batch": 0.04195445641409606, "add_time_dim_to_batch_and_zero_pad": 0.09053086285712197, "add_states_from_episodes_to_batch": 0.003563157987082377, "batch_individual_items": 0.007475087159546092, "numpy_to_tensor": 7.080501061864196e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_env_steps_trained_lifetime": 432000, "num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 143640, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 57818.21423086521}, "intrinsic_reward_module": {"weights_seq_no": 12.0, "num_module_steps_trained_lifetime": 71820, "module_train_batch_size_mean": 998.2236050808158, "num_module_steps_trained": 35910, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 11.0}, "default_policy": {"policy_loss": -0.0003006775223184377, "num_module_steps_trained_lifetime": 71820, "module_train_batch_size_mean": 998.2236050808158, "vf_loss_unclipped": 42.31924819946289, "num_module_steps_trained": 35910, "total_loss": 0.24921315908432007, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 3.432069570408203e-05, "vf_explained_var": 0.0005176663398742676, "diff_num_grad_updates_vs_sampler_policy": 11.0, "entropy": 0.6927226185798645, "weights_seq_no": 12.0, "vf_loss": 0.3216441869735718}}}, "IntrinsicAttentionMask": [[[0.16606393456459045, 0.166313037276268, 0.16657748818397522, 0.16662654280662537, 0.16729311645030975, 0.1671259105205536], [0.16621100902557373, 0.16639941930770874, 0.16659937798976898, 0.16663645207881927, 0.16714005172252655, 0.1670137643814087], [0.16636696457862854, 0.16649094223976135, 0.16662247478961945, 0.16664685308933258, 0.16697785258293152, 0.16689488291740417], [0.1663958728313446, 0.16650791466236115, 0.16662675142288208, 0.1666487753391266, 0.16694781184196472, 0.16687285900115967], [0.16678813099861145, 0.16673780977725983, 0.16668447852134705, 0.16667459905147552, 0.1665406972169876, 0.16657422482967377], [0.16668984293937683, 0.166680246591568, 0.1666700690984726, 0.16666817665100098, 0.16664262115955353, 0.16664902865886688]], [[0.16643807291984558, 0.1668119728565216, 0.1664796769618988, 0.16676202416419983, 0.16687452793121338, 0.16663362085819244], [0.16690205037593842, 0.16651709377765656, 0.16685912013053894, 0.16656841337680817, 0.16645285487174988, 0.16670049726963043], [0.16648973524570465, 0.16677916049957275, 0.16652195155620575, 0.1667405068874359, 0.16682755947113037, 0.16664113104343414], [0.1668400913476944, 0.1665564626455307, 0.16680847108364105, 0.16659428179264069, 0.16650910675525665, 0.1666916012763977], [0.1669796258211136, 0.1664678007364273, 0.16692253947257996, 0.16653601825237274, 0.16638244688510895, 0.16671159863471985], [0.16668079793453217, 0.1666576862335205, 0.16667822003364563, 0.16666077077388763, 0.1666538268327713, 0.16666871309280396]], [[0.16665665805339813, 0.16667616367340088, 0.1667814999818802, 0.16680102050304413, 0.16657544672489166, 0.1665092259645462], [0.16665786504745483, 0.16667501628398895, 0.1667676419019699, 0.16678480803966522, 0.16658645868301392, 0.16652821004390717], [0.16666439175605774, 0.1666688472032547, 0.16669289767742157, 0.16669735312461853, 0.1666458398103714, 0.16663071513175964], [0.16666559875011444, 0.16666768491268158, 0.1666790395975113, 0.16668114066123962, 0.16665683686733246, 0.1666496992111206], [0.16665160655975342, 0.16668091714382172, 0.16683916747570038, 0.16686850786209106, 0.16652962565422058, 0.16643019020557404], [0.16664746403694153, 0.16668476164340973, 0.16688621044158936, 0.16692356765270233, 0.16649223864078522, 0.16636572778224945]], [[0.1664816439151764, 0.16685564815998077, 0.16652324795722961, 0.1668056845664978, 0.16665641963481903, 0.16667725145816803], [0.16685713827610016, 0.16647228598594666, 0.16681422293186188, 0.16652359068393707, 0.1666770726442337, 0.16665562987327576], [0.16652347147464752, 0.1668129414319992, 0.16655568778514862, 0.16677427291870117, 0.16665875911712646, 0.1666748821735382], [0.16680701076984406, 0.16652342677116394, 0.1667754054069519, 0.16656124591827393, 0.16667434573173523, 0.16665855050086975], [0.1666571944952011, 0.1666763424873352, 0.16665932536125183, 0.16667379438877106, 0.1666661500930786, 0.16666720807552338], [0.16667811572551727, 0.16665500402450562, 0.16667553782463074, 0.16665808856487274, 0.16666731238365173, 0.16666603088378906]], [[0.1660638451576233, 0.16631294786930084, 0.16657741367816925, 0.16724377870559692, 0.1672930270433426, 0.16650892794132233], [0.16621094942092896, 0.16639935970306396, 0.1665993183851242, 0.16710279881954193, 0.16713999211788177, 0.16654755175113678], [0.16636694967746735, 0.16649092733860016, 0.16662245988845825, 0.16695339977741241, 0.16697783768177032, 0.1665884107351303], [0.166759192943573, 0.16672086715698242, 0.166680246591568, 0.16657821834087372, 0.16657069325447083, 0.16669075191020966], [0.16678813099861145, 0.16673780977725983, 0.16668447852134705, 0.16655056178569794, 0.1665406972169876, 0.16669827699661255], [0.1663265824317932, 0.16646724939346313, 0.16661648452281952, 0.16699206829071045, 0.1670197993516922, 0.16657784581184387]], [[0.16667112708091736, 0.1666240096092224, 0.16665366291999817, 0.16675463318824768, 0.16659781336784363, 0.16669875383377075], [0.1666775792837143, 0.16656194627285004, 0.1666347235441208, 0.16688261926174164, 0.16649770736694336, 0.1667453944683075], [0.16667352616786957, 0.1666010171175003, 0.16664664447307587, 0.1668020635843277, 0.16656072437763214, 0.1667160540819168], [0.16665960848331451, 0.16673392057418823, 0.16668714582920074, 0.16652804613113403, 0.16677524149417877, 0.1666160672903061], [0.166681170463562, 0.16652745008468628, 0.16662418842315674, 0.16695381700992584, 0.16644208133220673, 0.16677133738994598], [0.16666732728481293, 0.1666603833436966, 0.1666647493839264, 0.16667962074279785, 0.1666565090417862, 0.16667138040065765]]], "default_policy": {"num_module_steps_trained_lifetime": 11970, "module_train_batch_size_mean": 998.828720912135, "vf_loss_unclipped": 42.36626434326172, "num_module_steps_trained": 5985, "num_trainable_parameters": 16595, "total_loss": 0.2483626902103424, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 3.659690264612436e-05, "weights_seq_no": 2.0, "vf_loss": 0.32056936621665955, "curr_kl_coeff": 0.040395982563495636, "vf_explained_var": -8.285045623779297e-05, "policy_loss": -0.0003112147096544504, "entropy": 0.6927151083946228, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 655.6989070658373}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 11970, "module_train_batch_size_mean": 998.828720912135, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5985, "num_trainable_parameters": 8266, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 2.0, "num_module_steps_trained_lifetime_throughput": 655.7115047377337}, "__all_modules__": {"num_env_steps_trained_lifetime": 72000, "num_env_steps_trained": 36000, "num_module_steps_trained_lifetime": 23940, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3948.897938789646, "num_module_steps_trained_throughput": 29519240.523308814, "num_module_steps_trained_lifetime_throughput": 12993277.40811275}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 2.95, "sample": 0.1232066884136293, "env_step_timer": 1.4209117912026984e-05, "episode_return_max": 13.5, "episode_return_min": -14.5, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8814001436679078e-06, "numpy_to_tensor": 1.2023536255527859e-05, "add_time_dim_to_batch_and_zero_pad": 6.999124498863991e-06, "add_states_from_episodes_to_batch": 2.7143600315307993e-06, "batch_individual_items": 1.2590612113037908e-05}}, "connector_pipeline_timer": 5.949049883288174e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.366003441359926, "num_episodes_lifetime": 40, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 10400, "episode_duration_sec_mean": 0.005404196731979028, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.608508216135936e-06, "get_actions": 3.679069938473739e-05, "tensor_to_numpy": 1.507032222934925e-05, "normalize_and_clip_actions": 7.911036497483346e-06, "remove_single_ts_time_rank_from_batch": 1.1978101698089567e-05, "listify_data_for_vector_env": 1.0275100118212444e-05}}, "connector_pipeline_timer": 0.00011491595050029843}, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "episode_len_max": 20, "weights_seq_no": 2.0, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "num_episodes": 20, "rlmodule_inference_timer": 3.11585437265615e-05, "num_env_steps_sampled": 400, "env_reset_timer": 0.0005696402885951101, "module_episode_returns_mean": {"default_policy": 2.95}, "env_to_module_sum_episodes_length_in": 10.366003441359926, "agent_episode_returns_mean": {"default_agent": 2.95}, "time_between_sampling": 10.278077500057407}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "b1762_00000", "date": "2025-08-11_18-24-06", "timestamp": 1754929446, "time_this_iter_s": 10.329731941223145, "time_total_s": 22.522562980651855, "pid": 10959, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 22.522562980651855, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 40.60666666666666, "ram_util_percent": 80.52666666666667}}
{"timers": {"training_iteration": 12.027282196105341, "restore_env_runners": 8.36617751047015e-06, "training_step": 12.027057139847008, "env_runner_sampling_timer": 2.263649341731891, "learner_update_timer": 9.565480515680228, "synch_weights": 0.0019311997005599553, "restore_eval_env_runners": 6.324290880002081e-05, "evaluation_iteration": 0.13597193139255978, "synch_eval_env_connectors": 0.00021582203917205333, "synch_env_connectors": 7.573626935482025e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.808457477949336e-06, "add_observations_from_episodes_to_batch": 2.9189661545799103e-06, "batch_individual_items": 1.2932329976961488e-05, "numpy_to_tensor": 1.3209541625030369e-05, "add_time_dim_to_batch_and_zero_pad": 7.453217264556602e-06}}, "connector_pipeline_timer": 6.252468258071244e-05}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.160306026049108e-06, "listify_data_for_vector_env": 1.069026224139187e-05, "remove_single_ts_time_rank_from_batch": 1.2069317112790583e-05, "un_batch_to_individual_items": 6.843099264156493e-06, "get_actions": 4.223087695650398e-05, "tensor_to_numpy": 1.622199172121881e-05}}, "connector_pipeline_timer": 0.00012387677046919854}, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "num_episodes": 250.0, "episode_len_max": 20, "rlmodule_inference_timer": 5.085745261264954e-05, "episode_len_min": 20, "time_between_sampling": 0.035135210358461386, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 4.665582547567905e-05, "agent_episode_returns_mean": {"default_agent": 0.54}, "num_episodes_lifetime": -30375.0, "episode_return_mean": 0.54, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.006478213713862074, "env_step_timer": 1.4600879978974226e-05, "episode_len_mean": 20.0, "episode_return_max": 9.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.005516927336808295, "module_episode_returns_mean": {"default_policy": 0.54}, "num_env_steps_sampled_lifetime": -607500.0, "weights_seq_no": 2.0, "episode_return_min": -10.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3089.971184881312}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1554860308462405, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.010859068660216872, "add_observations_from_episodes_to_batch": 0.00087958202942973, "add_columns_from_episodes_to_train_batch": 0.04194742018072865, "add_time_dim_to_batch_and_zero_pad": 0.09051495714869816, "add_states_from_episodes_to_batch": 0.0035647247370216065, "batch_individual_items": 0.007479198368068318, "numpy_to_tensor": 7.09002902614884e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_env_steps_trained_lifetime": 648000, "num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 215460, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 57252.734476638514}, "intrinsic_reward_module": {"weights_seq_no": 18.0, "num_module_steps_trained_lifetime": 107730, "module_train_batch_size_mean": 998.0016398003509, "num_module_steps_trained": 35910, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 16.0}, "default_policy": {"policy_loss": 7.61209157644771e-05, "num_module_steps_trained_lifetime": 107730, "module_train_batch_size_mean": 998.0016398003509, "vf_loss_unclipped": 40.57605743408203, "num_module_steps_trained": 35910, "total_loss": 0.2494068741798401, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 3.8814898289274424e-05, "vf_explained_var": 0.0004717707633972168, "diff_num_grad_updates_vs_sampler_policy": 16.0, "entropy": 0.6925235390663147, "weights_seq_no": 18.0, "vf_loss": 0.32140788435935974}}}, "IntrinsicAttentionMask": [[[0.16596165299415588, 0.16682636737823486, 0.16709165275096893, 0.16714085638523102, 0.1665729582309723, 0.16640646755695343], [0.1665583699941635, 0.16669122874736786, 0.16673186421394348, 0.16673940420150757, 0.1666523516178131, 0.16662678122520447], [0.16674108803272247, 0.16664978861808777, 0.1666218787431717, 0.16661670804023743, 0.16667649149894714, 0.1666940599679947], [0.1667749583721161, 0.16664209961891174, 0.1666014939546585, 0.16659396886825562, 0.1666809469461441, 0.16670651733875275], [0.16638366878032684, 0.1667308360338211, 0.16683712601661682, 0.1668568253517151, 0.16662921011447906, 0.16656237840652466], [0.16626881062984467, 0.16675685346126556, 0.16690634191036224, 0.1669340580701828, 0.16661392152309418, 0.16651998460292816]], [[0.16671448945999146, 0.16661541163921356, 0.16667775809764862, 0.1666593998670578, 0.16679096221923828, 0.16654199361801147], [0.1667475402355194, 0.16657991707324982, 0.16668540239334106, 0.1666543334722519, 0.16687697172164917, 0.16645577549934387], [0.1667267382144928, 0.1666022539138794, 0.16668058931827545, 0.16665752232074738, 0.16682283580303192, 0.16651004552841187], [0.16673284769058228, 0.1665956676006317, 0.16668199002742767, 0.16665656864643097, 0.16683876514434814, 0.16649405658245087], [0.1666889637708664, 0.16664277017116547, 0.16667184233665466, 0.1666632890701294, 0.16672462224960327, 0.166608527302742], [0.1667720377445221, 0.16655361652374268, 0.16669104993343353, 0.16665057837963104, 0.16694074869155884, 0.16639190912246704]], [[0.1667383760213852, 0.16675789654254913, 0.16661812365055084, 0.1666376143693924, 0.16665713489055634, 0.1665908843278885], [0.16672971844673157, 0.16674688458442688, 0.16662396490573883, 0.16664113104343414, 0.16665828227996826, 0.16660001873970032], [0.16679169237613678, 0.16682574152946472, 0.16658201813697815, 0.16661600768566132, 0.16665001213550568, 0.16653454303741455], [0.16678303480148315, 0.16681472957134247, 0.16658785939216614, 0.16661952435970306, 0.1666511744260788, 0.16654367744922638], [0.16677439212799072, 0.16680371761322021, 0.16659371554851532, 0.16662301123142242, 0.16665232181549072, 0.1665528118610382], [0.1668037623167038, 0.16684110462665558, 0.16657382249832153, 0.16661110520362854, 0.16664840281009674, 0.16652177274227142]], [[0.1666894108057022, 0.16664227843284607, 0.16667194664478302, 0.16677291691303253, 0.16661608219146729, 0.16660736501216888], [0.16672244668006897, 0.16660678386688232, 0.16667957603931427, 0.1669275462627411, 0.16654253005981445, 0.1665211170911789], [0.16670167446136475, 0.1666291356086731, 0.16667477786540985, 0.16683022677898407, 0.16658884286880493, 0.16657540202140808], [0.1666307896375656, 0.16670508682727814, 0.16665831208229065, 0.16649925708770752, 0.16674639284610748, 0.1667601764202118], [0.1667408049106598, 0.16658702492713928, 0.16668379306793213, 0.16701354086399078, 0.16650161147117615, 0.1664731502532959], [0.16674692928791046, 0.1665804535150528, 0.16668520867824554, 0.16704222559928894, 0.16648799180984497, 0.1664571762084961]], [[0.1666974574327469, 0.16647204756736755, 0.16657723486423492, 0.16659674048423767, 0.1668614000082016, 0.16679507493972778], [0.166740283370018, 0.16620086133480072, 0.16645246744155884, 0.16649912297725677, 0.1671331822872162, 0.16697414219379425], [0.16672033071517944, 0.16632743179798126, 0.16651073098182678, 0.16654472053050995, 0.16700628399848938, 0.16689056158065796], [0.16671662032604218, 0.16635088622570038, 0.16652151942253113, 0.16655315458774567, 0.1669827699661255, 0.16687506437301636], [0.16666628420352936, 0.16666918992996216, 0.16666783392429352, 0.16666758060455322, 0.16666418313980103, 0.16666503250598907], [0.16667890548706055, 0.1665894240140915, 0.16663119196891785, 0.16663892567157745, 0.1667439341545105, 0.16671763360500336]], [[0.1664816439151764, 0.16659396886825562, 0.1667848378419876, 0.16654406487941742, 0.16665643453598022, 0.16693907976150513], [0.1665944755077362, 0.1666383147239685, 0.16671279072761536, 0.16661883890628815, 0.16666269302368164, 0.16677293181419373], [0.1667860746383667, 0.16671352088451385, 0.1665903776884079, 0.16674573719501495, 0.1666731983423233, 0.16649103164672852], [0.1665443629026413, 0.16661861538887024, 0.16674479842185974, 0.16658563911914825, 0.16665992140769958, 0.16684670746326447], [0.1666571944952011, 0.16666294634342194, 0.1666727215051651, 0.1666603833436966, 0.16666613519191742, 0.16668060421943665], [0.1669408231973648, 0.16677416861057281, 0.1664915531873703, 0.16684815287590027, 0.16668158769607544, 0.16626378893852234]]], "default_policy": {"num_module_steps_trained_lifetime": 17955, "module_train_batch_size_mean": 998.7505232584676, "vf_loss_unclipped": 40.434452056884766, "num_module_steps_trained": 5985, "num_trainable_parameters": 16595, "total_loss": 0.24871987104415894, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 3.747321534319781e-05, "weights_seq_no": 3.0, "vf_loss": 0.32053929567337036, "curr_kl_coeff": 0.020197991281747818, "vf_explained_var": -9.298324584960938e-06, "policy_loss": 7.057894254103303e-05, "entropy": 0.6925290822982788, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 655.4369183750508}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 17955, "module_train_batch_size_mean": 998.7505232584676, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5985, "num_trainable_parameters": 8266, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 3.0, "num_module_steps_trained_lifetime_throughput": 655.4490755617152}, "__all_modules__": {"num_env_steps_trained_lifetime": 108000, "num_env_steps_trained": 36000, "num_module_steps_trained_lifetime": 35910, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3947.227306520906, "num_module_steps_trained_throughput": 28873595.820047297, "num_module_steps_trained_lifetime_throughput": 12952467.555785496}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 2.783333333333333, "sample": 0.12319549444973235, "env_step_timer": 1.5106536360190658e-05, "episode_return_max": 13.5, "episode_return_min": -14.5, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9430819447360153e-06, "numpy_to_tensor": 1.2630624603684264e-05, "add_time_dim_to_batch_and_zero_pad": 7.183808006212548e-06, "add_states_from_episodes_to_batch": 2.7652999895549636e-06, "batch_individual_items": 1.278935575394896e-05}}, "connector_pipeline_timer": 6.079704456104694e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368205581254823, "num_episodes_lifetime": 60, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 15400, "episode_duration_sec_mean": 0.005445759640618538, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.746535691546598e-06, "get_actions": 3.956675945155337e-05, "tensor_to_numpy": 1.5662196565052436e-05, "normalize_and_clip_actions": 8.33681895219278e-06, "remove_single_ts_time_rank_from_batch": 1.2804098135858719e-05, "listify_data_for_vector_env": 1.0792105656184647e-05}}, "connector_pipeline_timer": 0.0001212445337195566}, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "episode_len_max": 20, "weights_seq_no": 3.0, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "num_episodes": 20, "rlmodule_inference_timer": 3.2900444104133256e-05, "num_env_steps_sampled": 400, "env_reset_timer": 0.0005669072156073525, "module_episode_returns_mean": {"default_policy": 2.783333333333333}, "env_to_module_sum_episodes_length_in": 10.368205581254823, "agent_episode_returns_mean": {"default_agent": 2.783333333333333}, "time_between_sampling": 10.287967159226536}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "b1762_00000", "date": "2025-08-11_18-24-17", "timestamp": 1754929457, "time_this_iter_s": 11.374245882034302, "time_total_s": 33.89680886268616, "pid": 10959, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 33.89680886268616, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 42.21875, "ram_util_percent": 78.875}}
{"timers": {"training_iteration": 12.013406190815182, "restore_env_runners": 8.352096009068189e-06, "training_step": 12.013180860108356, "env_runner_sampling_timer": 2.257102077904133, "learner_update_timer": 9.5580858480239, "synch_weights": 0.0019267372846115615, "restore_eval_env_runners": 6.287297880044205e-05, "evaluation_iteration": 0.1359227733290638, "synch_eval_env_connectors": 0.0002172842281870544, "synch_env_connectors": 7.549560442566871e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.8109064553743897e-06, "add_observations_from_episodes_to_batch": 2.9063502178981344e-06, "batch_individual_items": 1.3123317372878018e-05, "numpy_to_tensor": 1.3296754175586744e-05, "add_time_dim_to_batch_and_zero_pad": 7.349532871651961e-06}}, "connector_pipeline_timer": 6.268818346182105e-05}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.196484042422595e-06, "listify_data_for_vector_env": 1.0868713193164688e-05, "remove_single_ts_time_rank_from_batch": 1.204128692770251e-05, "un_batch_to_individual_items": 6.767113857768149e-06, "get_actions": 4.200710042537443e-05, "tensor_to_numpy": 1.601709980380892e-05}}, "connector_pipeline_timer": 0.0001234978755819923}, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "num_episodes": 250.0, "episode_len_max": 20, "rlmodule_inference_timer": 3.347689951502698e-05, "episode_len_min": 20, "time_between_sampling": 0.039283875314805865, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 4.490178029322499e-05, "agent_episode_returns_mean": {"default_agent": -0.58}, "num_episodes_lifetime": -61250.0, "episode_return_mean": -0.58, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.00594599674623212, "env_step_timer": 1.4641071328638545e-05, "episode_len_mean": 20.0, "episode_return_max": 9.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.005525502626318484, "module_episode_returns_mean": {"default_policy": -0.58}, "num_env_steps_sampled_lifetime": -1225000.0, "weights_seq_no": 3.0, "episode_return_min": -10.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3109.782086024848}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1554583213768796, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.010840315472577581, "add_observations_from_episodes_to_batch": 0.0008790412091288016, "add_columns_from_episodes_to_train_batch": 0.041945115559390275, "add_time_dim_to_batch_and_zero_pad": 0.0905066063266655, "add_states_from_episodes_to_batch": 0.0035656420695834097, "batch_individual_items": 0.007481115974308573, "numpy_to_tensor": 7.087503645347896e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_env_steps_trained_lifetime": 864000, "num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 287280, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 56522.16020124759}, "intrinsic_reward_module": {"weights_seq_no": 24.0, "num_module_steps_trained_lifetime": 143640, "module_train_batch_size_mean": 997.847060245087, "num_module_steps_trained": 35910, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 21.0}, "default_policy": {"policy_loss": -0.00028507670504041016, "num_module_steps_trained_lifetime": 143640, "module_train_batch_size_mean": 997.847060245087, "vf_loss_unclipped": 41.735267639160156, "num_module_steps_trained": 35910, "total_loss": 0.24892550706863403, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 7.13106055627577e-05, "vf_explained_var": 0.0005940794944763184, "diff_num_grad_updates_vs_sampler_policy": 21.0, "entropy": 0.6920000910758972, "weights_seq_no": 24.0, "vf_loss": 0.32124581933021545}}}, "IntrinsicAttentionMask": [[[0.1667383760213852, 0.16675789654254913, 0.16661812365055084, 0.1666376143693924, 0.16665713489055634, 0.1665908843278885], [0.16672971844673157, 0.16674688458442688, 0.16662396490573883, 0.16664113104343414, 0.16665828227996826, 0.16660001873970032], [0.16679169237613678, 0.16682574152946472, 0.16658201813697815, 0.16661600768566132, 0.16665001213550568, 0.16653454303741455], [0.16678303480148315, 0.16681472957134247, 0.16658785939216614, 0.16661952435970306, 0.1666511744260788, 0.16654367744922638], [0.16677439212799072, 0.16680371761322021, 0.16659371554851532, 0.16662301123142242, 0.16665232181549072, 0.1665528118610382], [0.1668037623167038, 0.16684110462665558, 0.16657382249832153, 0.16661110520362854, 0.16664840281009674, 0.16652177274227142]], [[0.16643808782100677, 0.1665503829717636, 0.16674120724201202, 0.16676203906536102, 0.16661283373832703, 0.16689540445804596], [0.16657747328281403, 0.16662129759788513, 0.16669578850269318, 0.16670390963554382, 0.16664569079875946, 0.16675591468811035], [0.16681425273418427, 0.16674168407917023, 0.16661851108074188, 0.16660508513450623, 0.16670134663581848, 0.1665191650390625], [0.1668400913476944, 0.1667547971010208, 0.16661006212234497, 0.16659428179264069, 0.16670739650726318, 0.16649332642555237], [0.16665495932102203, 0.16666071116924286, 0.16667048633098602, 0.1666715443134308, 0.16666390001773834, 0.16667836904525757], [0.1670055091381073, 0.16683878004550934, 0.16655606031417847, 0.1665252447128296, 0.16674616932868958, 0.16632820665836334]], [[0.16606411337852478, 0.16692936420440674, 0.16719481348991394, 0.1666267216205597, 0.16667579114437103, 0.16650919616222382], [0.1665741205215454, 0.16670699417591095, 0.16674762964248657, 0.16666057705879211, 0.166668102145195, 0.16664253175258636], [0.16673026978969574, 0.16663897037506104, 0.16661106050014496, 0.16667084395885468, 0.1666656732559204, 0.16668324172496796], [0.16639591753482819, 0.16678467392921448, 0.16690371930599213, 0.16664882004261017, 0.16667085886001587, 0.16659604012966156], [0.16642482578754425, 0.16677208244800568, 0.16687838733196259, 0.16665074229240417, 0.16667042672634125, 0.16660358011722565], [0.16632667183876038, 0.1668148785829544, 0.16696442663669586, 0.16664423048496246, 0.16667191684246063, 0.16657793521881104]], [[0.16652029752731323, 0.16672135889530182, 0.16668331623077393, 0.1666945219039917, 0.16675497591495514, 0.1666254848241806], [0.16707304120063782, 0.16651487350463867, 0.16662029922008514, 0.16658926010131836, 0.1664218008518219, 0.1667807251214981], [0.16696839034557343, 0.16655394434928894, 0.1666322648525238, 0.16660919785499573, 0.1664848029613495, 0.16675138473510742], [0.1669992059469223, 0.16654245555400848, 0.16662874817848206, 0.16660334169864655, 0.16646626591682434, 0.16676002740859985], [0.16716551780700684, 0.16648034751415253, 0.1666097342967987, 0.16657161712646484, 0.16636614501476288, 0.16680662333965302], [0.16680939495563507, 0.16661334037780762, 0.1666504144668579, 0.166639506816864, 0.16658061742782593, 0.16670677065849304]], [[0.16596168279647827, 0.16682641208171844, 0.16647492349147797, 0.16652394831180573, 0.16719010472297668, 0.16702300310134888], [0.1665583848953247, 0.16669124364852905, 0.16663730144500732, 0.16664482653141022, 0.16674694418907166, 0.16672135889530182], [0.16631604731082916, 0.16674616932868958, 0.1665714681148529, 0.16659584641456604, 0.16692674160003662, 0.16684380173683167], [0.166349858045578, 0.16673851013183594, 0.1665806621313095, 0.16660268604755402, 0.166901633143425, 0.16682671010494232], [0.1668088287115097, 0.16663439571857452, 0.1667051613330841, 0.16669528186321259, 0.16656136512756348, 0.16659489274024963], [0.1666937917470932, 0.16666051745414734, 0.16667401790618896, 0.16667212545871735, 0.1666465699672699, 0.16665297746658325]], [[0.16652525961399078, 0.16663758456707, 0.16682852804660797, 0.166587695479393, 0.166700080037117, 0.166720911860466], [0.1666114777326584, 0.16665533185005188, 0.16672982275485992, 0.16663585603237152, 0.16667971014976501, 0.16668784618377686], [0.1667579561471939, 0.16668540239334106, 0.1665622889995575, 0.16671761870384216, 0.1666450947523117, 0.16663165390491486], [0.166573166847229, 0.16664743423461914, 0.16677363216876984, 0.16661445796489716, 0.1666887402534485, 0.1667025238275528], [0.1666594296693802, 0.166665181517601, 0.16667495667934418, 0.16666263341903687, 0.1666683852672577, 0.16666945815086365], [0.16667540371418, 0.16666845977306366, 0.16665667295455933, 0.1666715443134308, 0.16666460037231445, 0.16666331887245178]]], "default_policy": {"num_module_steps_trained_lifetime": 23940, "module_train_batch_size_mean": 998.6769017198101, "vf_loss_unclipped": 41.72026824951172, "num_module_steps_trained": 5985, "num_trainable_parameters": 16595, "total_loss": 0.24834950268268585, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 7.340065349126235e-05, "weights_seq_no": 4.0, "vf_loss": 0.320527046918869, "curr_kl_coeff": 0.010098995640873909, "vf_explained_var": 4.6193599700927734e-05, "policy_loss": -0.00029106985311955214, "entropy": 0.6919918656349182, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 654.9168390087513}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 23940, "module_train_batch_size_mean": 998.6769017198101, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5985, "num_trainable_parameters": 8266, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 4.0, "num_module_steps_trained_lifetime_throughput": 654.9283392562897}, "__all_modules__": {"num_env_steps_trained_lifetime": 144000, "num_env_steps_trained": 36000, "num_module_steps_trained_lifetime": 47880, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3943.9747835267162, "num_module_steps_trained_throughput": 28119887.303850822, "num_module_steps_trained_lifetime_throughput": 12882364.21606487}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 2.95, "sample": 0.1230828182549189, "env_step_timer": 1.39429423329216e-05, "episode_return_max": 13.5, "episode_return_min": -14.5, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8141567015772543e-06, "numpy_to_tensor": 1.1828976314919137e-05, "add_time_dim_to_batch_and_zero_pad": 6.737813989777912e-06, "add_states_from_episodes_to_batch": 2.677395768561948e-06, "batch_individual_items": 1.229056167363512e-05}}, "connector_pipeline_timer": 5.828747426060823e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368237912813044, "num_episodes_lifetime": 80, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 20400, "episode_duration_sec_mean": 0.005367163989285472, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.41419243723169e-06, "get_actions": 3.523803105837316e-05, "tensor_to_numpy": 1.468172631153042e-05, "normalize_and_clip_actions": 7.898515319785704e-06, "remove_single_ts_time_rank_from_batch": 1.1926454008678175e-05, "listify_data_for_vector_env": 1.0342017114537305e-05}}, "connector_pipeline_timer": 0.00011245842268980518}, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "episode_len_max": 20, "weights_seq_no": 4.0, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "num_episodes": 20, "rlmodule_inference_timer": 3.0206027836978004e-05, "num_env_steps_sampled": 400, "env_reset_timer": 0.0005626148128395433, "module_episode_returns_mean": {"default_policy": 2.95}, "env_to_module_sum_episodes_length_in": 10.368237912813044, "agent_episode_returns_mean": {"default_agent": 2.95}, "time_between_sampling": 10.291761266383807}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "b1762_00000", "date": "2025-08-11_18-24-28", "timestamp": 1754929468, "time_this_iter_s": 10.761495113372803, "time_total_s": 44.65830397605896, "pid": 10959, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 44.65830397605896, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 41.35333333333334, "ram_util_percent": 78.37333333333332}}
{"timers": {"training_iteration": 11.998845398906617, "restore_env_runners": 8.322325167218222e-06, "training_step": 11.998619765666676, "env_runner_sampling_timer": 2.250266586715257, "learner_update_timer": 9.550279600373898, "synch_weights": 0.0019246557515898244, "restore_eval_env_runners": 6.282383899029808e-05, "evaluation_iteration": 0.13575223809635512, "synch_eval_env_connectors": 0.00021692263601813465, "synch_env_connectors": 7.582815375179052e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7571415851113e-06, "add_observations_from_episodes_to_batch": 2.8453458505027363e-06, "batch_individual_items": 1.270457106119716e-05, "numpy_to_tensor": 1.2785604441762438e-05, "add_time_dim_to_batch_and_zero_pad": 7.296812662896474e-06}}, "connector_pipeline_timer": 6.133797811784717e-05}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.988411873515322e-06, "listify_data_for_vector_env": 1.0446929002658387e-05, "remove_single_ts_time_rank_from_batch": 1.1843656961716929e-05, "un_batch_to_individual_items": 6.677544444843961e-06, "get_actions": 4.0959428011143494e-05, "tensor_to_numpy": 1.562576161230291e-05}}, "connector_pipeline_timer": 0.00012073712062270447}, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "num_episodes": 250.0, "episode_len_max": 20, "rlmodule_inference_timer": 3.251752924795774e-05, "episode_len_min": 20, "time_between_sampling": 0.037347872414569376, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 4.200515996067011e-05, "agent_episode_returns_mean": {"default_agent": -0.4200000000000001}, "num_episodes_lifetime": -92125.0, "episode_return_mean": -0.4200000000000001, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.005775084425464053, "env_step_timer": 1.4075635763503535e-05, "episode_len_mean": 20.0, "episode_return_max": 9.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.005399212357588112, "module_episode_returns_mean": {"default_policy": -0.4200000000000001}, "num_env_steps_sampled_lifetime": -1842500.0, "weights_seq_no": 4.0, "episode_return_min": -10.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3184.8914611621444}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15543838774266372, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.010820187317140647, "add_observations_from_episodes_to_batch": 0.0008788862178553955, "add_columns_from_episodes_to_train_batch": 0.041952165233431565, "add_time_dim_to_batch_and_zero_pad": 0.09049820942280937, "add_states_from_episodes_to_batch": 0.003566063148277224, "batch_individual_items": 0.007483036483816363, "numpy_to_tensor": 7.081336668548056e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_env_steps_trained_lifetime": 1080000, "num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 359100, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 55689.04349816637}, "intrinsic_reward_module": {"weights_seq_no": 30.0, "num_module_steps_trained_lifetime": 179550, "module_train_batch_size_mean": 997.7394089995611, "num_module_steps_trained": 35910, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 26.0}, "default_policy": {"policy_loss": -0.00036411042674444616, "num_module_steps_trained_lifetime": 179550, "module_train_batch_size_mean": 997.7394089995611, "vf_loss_unclipped": 43.20748519897461, "num_module_steps_trained": 35910, "total_loss": 0.24874216318130493, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 1.800050631572958e-05, "vf_explained_var": 0.0007210373878479004, "diff_num_grad_updates_vs_sampler_policy": 26.0, "entropy": 0.6916189789772034, "weights_seq_no": 30.0, "vf_loss": 0.32112225890159607}}}, "IntrinsicAttentionMask": [[[0.16606393456459045, 0.1663130223751068, 0.16719461977481842, 0.1672438532114029, 0.1666755974292755, 0.1665090024471283], [0.16621099412441254, 0.16639940440654755, 0.16706566512584686, 0.1671028435230255, 0.16667352616786957, 0.16654758155345917], [0.16673025488853455, 0.16670392453670502, 0.16661104559898376, 0.1666058748960495, 0.16666565835475922, 0.16668322682380676], [0.166759192943573, 0.16672086715698242, 0.1665857434272766, 0.16657821834087372, 0.1666651964187622, 0.16669075191020966], [0.16642479598522186, 0.16652487218379974, 0.1668783575296402, 0.16689807176589966, 0.16667039692401886, 0.16660355031490326], [0.1663265973329544, 0.16646726429462433, 0.1669643521308899, 0.16699208319187164, 0.16667184233665466, 0.16657786071300507]], [[0.16667112708091736, 0.1666240096092224, 0.16665366291999817, 0.16675463318824768, 0.16670748591423035, 0.16658909618854523], [0.1666775792837143, 0.16656194627285004, 0.1666347235441208, 0.16688261926174164, 0.16676685214042664, 0.1664762943983078], [0.16667352616786957, 0.1666010171175003, 0.16664664447307587, 0.1668020635843277, 0.16672949492931366, 0.1665472835302353], [0.16665960848331451, 0.16673390567302704, 0.16668713092803955, 0.16652803122997284, 0.16660228371620178, 0.1667890101671219], [0.16666610538959503, 0.16667187213897705, 0.16666825115680695, 0.16665591299533844, 0.16666166484355927, 0.1666761338710785], [0.16668234765529633, 0.16651594638824463, 0.1666206568479538, 0.16697753965854645, 0.16681084036827087, 0.1663927286863327]], [[0.1660638451576233, 0.16631294786930084, 0.16657741367816925, 0.16724377870559692, 0.1672930270433426, 0.16650892794132233], [0.16621094942092896, 0.16639935970306396, 0.1665993183851242, 0.16710279881954193, 0.16713999211788177, 0.16654755175113678], [0.16636694967746735, 0.16649092733860016, 0.16662245988845825, 0.16695339977741241, 0.16697783768177032, 0.1665884107351303], [0.166759192943573, 0.16672086715698242, 0.166680246591568, 0.16657821834087372, 0.16657069325447083, 0.16669075191020966], [0.16678813099861145, 0.16673780977725983, 0.16668447852134705, 0.16655056178569794, 0.1665406972169876, 0.16669827699661255], [0.1663265824317932, 0.16646724939346313, 0.16661648452281952, 0.16699206829071045, 0.1670197993516922, 0.16657784581184387]], [[0.16652525961399078, 0.16663758456707, 0.16682852804660797, 0.166587695479393, 0.166700080037117, 0.166720911860466], [0.1666114777326584, 0.16665533185005188, 0.16672982275485992, 0.16663585603237152, 0.16667971014976501, 0.16668784618377686], [0.1667579561471939, 0.16668540239334106, 0.1665622889995575, 0.16671761870384216, 0.1666450947523117, 0.16663165390491486], [0.166573166847229, 0.16664743423461914, 0.16677363216876984, 0.16661445796489716, 0.1666887402534485, 0.1667025238275528], [0.1666594296693802, 0.166665181517601, 0.16667495667934418, 0.16666263341903687, 0.1666683852672577, 0.16666945815086365], [0.16667540371418, 0.16666845977306366, 0.16665667295455933, 0.1666715443134308, 0.16666460037231445, 0.16666331887245178]], [[0.16596142947673798, 0.1662103682756424, 0.16709142923355103, 0.1671406328678131, 0.1671898514032364, 0.16640624403953552], [0.16613347828388214, 0.16632179915905, 0.16698776185512543, 0.1670249104499817, 0.16706208884716034, 0.16646993160247803], [0.16674108803272247, 0.16671475768089294, 0.1666218787431717, 0.16661670804023743, 0.16661153733730316, 0.1666940599679947], [0.1667749583721161, 0.1667366325855255, 0.1666014939546585, 0.16659396886825562, 0.16658644378185272, 0.16670651733875275], [0.1668088287115097, 0.1667584925889969, 0.16658110916614532, 0.1665712296962738, 0.16656136512756348, 0.1667189747095108], [0.1662687361240387, 0.16640935838222504, 0.16690626740455627, 0.16693398356437683, 0.16696171462535858, 0.1665199249982834]], [[0.1665688306093216, 0.1666812002658844, 0.1666104644536972, 0.166631281375885, 0.1667436957359314, 0.1667645424604416], [0.16662847995758057, 0.16667233407497406, 0.16664473712444305, 0.1666528582572937, 0.1666967272758484, 0.16670484840869904], [0.16659092903137207, 0.16667790710926056, 0.16662316024303436, 0.1666392832994461, 0.16672629117965698, 0.16674241423606873], [0.1666020005941391, 0.16667626798152924, 0.16662950813770294, 0.16664329171180725, 0.16671758890151978, 0.1667313575744629], [0.16666164994239807, 0.1666674166917801, 0.16666379570960999, 0.16666485369205475, 0.16667062044143677, 0.16667167842388153], [0.1666727066040039, 0.16666576266288757, 0.16667012870311737, 0.1666688472032547, 0.16666190326213837, 0.1666606217622757]]], "default_policy": {"num_module_steps_trained_lifetime": 29925, "module_train_batch_size_mean": 998.6075885025957, "vf_loss_unclipped": 43.33749008178711, "num_module_steps_trained": 5985, "num_trainable_parameters": 16595, "total_loss": 0.24824121594429016, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 2.089373447233811e-05, "weights_seq_no": 5.0, "vf_loss": 0.3205212354660034, "curr_kl_coeff": 0.0050494978204369545, "vf_explained_var": -0.0004898309707641602, "policy_loss": -0.00039421633118763566, "entropy": 0.6915934681892395, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 654.1853047609048}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 29925, "module_train_batch_size_mean": 998.6075885025957, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5985, "num_trainable_parameters": 8266, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 5.0, "num_module_steps_trained_lifetime_throughput": 654.1961942800226}, "__all_modules__": {"num_env_steps_trained_lifetime": 180000, "num_env_steps_trained": 36000, "num_module_steps_trained_lifetime": 59850, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3939.432610502113, "num_module_steps_trained_throughput": 27355911.49760473, "num_module_steps_trained_lifetime_throughput": 12823548.04753572}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 2.45, "sample": 0.12298781091192379, "env_step_timer": 1.3947496089702577e-05, "episode_return_max": 13.5, "episode_return_min": -14.5, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.841032496920432e-06, "numpy_to_tensor": 1.1857113988524977e-05, "add_time_dim_to_batch_and_zero_pad": 6.957328704016534e-06, "add_states_from_episodes_to_batch": 2.6703008301835244e-06, "batch_individual_items": 1.2375443415716204e-05}}, "connector_pipeline_timer": 5.885140186357681e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238387501162, "num_episodes_lifetime": 100, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 25400, "episode_duration_sec_mean": 0.0053286420309450475, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.457969846007359e-06, "get_actions": 3.55122370372569e-05, "tensor_to_numpy": 1.4813884278377585e-05, "normalize_and_clip_actions": 7.909869875684755e-06, "remove_single_ts_time_rank_from_batch": 1.1960778508176867e-05, "listify_data_for_vector_env": 1.023031734893462e-05}}, "connector_pipeline_timer": 0.00011288421899346721}, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "episode_len_max": 20, "weights_seq_no": 5.0, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "num_episodes": 20, "rlmodule_inference_timer": 3.088291091236905e-05, "num_env_steps_sampled": 400, "env_reset_timer": 0.0005604874142857943, "module_episode_returns_mean": {"default_policy": 2.45}, "env_to_module_sum_episodes_length_in": 10.368238387501162, "agent_episode_returns_mean": {"default_agent": 2.45}, "time_between_sampling": 10.294691649969764}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "b1762_00000", "date": "2025-08-11_18-24-39", "timestamp": 1754929479, "time_this_iter_s": 10.683617115020752, "time_total_s": 55.34192109107971, "pid": 10959, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 55.34192109107971, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 40.58666666666667, "ram_util_percent": 78.28}}
{"timers": {"training_iteration": 11.988313568667126, "restore_env_runners": 8.32868234153865e-06, "training_step": 11.988080545510348, "env_runner_sampling_timer": 2.251484708348601, "learner_update_timer": 9.538464331460236, "synch_weights": 0.0019145237838489072, "restore_eval_env_runners": 6.262019056216229e-05, "evaluation_iteration": 0.13562649446605332, "synch_eval_env_connectors": 0.0002168954899966251, "synch_env_connectors": 7.596987906731665e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.0208018664129196e-06, "add_observations_from_episodes_to_batch": 4.269742412413264e-06, "batch_individual_items": 1.8076071411444454e-05, "numpy_to_tensor": 2.0194586097802815e-05, "add_time_dim_to_batch_and_zero_pad": 1.0318329819295945e-05}}, "connector_pipeline_timer": 8.890125637775188e-05}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.2424196644668155e-05, "listify_data_for_vector_env": 1.4228082633003432e-05, "remove_single_ts_time_rank_from_batch": 1.4648113970716385e-05, "un_batch_to_individual_items": 8.497347091834913e-06, "get_actions": 6.711117519533058e-05, "tensor_to_numpy": 2.1852013046944276e-05}}, "connector_pipeline_timer": 0.00018005447584160133}, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "num_episodes": 250.0, "episode_len_max": 20, "rlmodule_inference_timer": 5.211935667405486e-05, "episode_len_min": 20, "time_between_sampling": 0.03739096100270599, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 0.00010598584116690231, "agent_episode_returns_mean": {"default_agent": 0.3}, "num_episodes_lifetime": -123000.0, "episode_return_mean": 0.3, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.008413371076865676, "env_step_timer": 2.2673178585256234e-05, "episode_len_mean": 20.0, "episode_return_max": 9.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.008160360510926695, "module_episode_returns_mean": {"default_policy": 0.3}, "num_env_steps_sampled_lifetime": -2460000.0, "weights_seq_no": 5.0, "episode_return_min": -10.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 2698.9498029129363}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15541579594573257, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.010804300443752652, "add_observations_from_episodes_to_batch": 0.0008790098554380504, "add_columns_from_episodes_to_train_batch": 0.04194637233210658, "add_time_dim_to_batch_and_zero_pad": 0.09049114316803171, "add_states_from_episodes_to_batch": 0.00356789001760731, "batch_individual_items": 0.007487754028532294, "numpy_to_tensor": 7.090440324820974e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_env_steps_trained_lifetime": 1296000, "num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 430920, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 54798.44218840301}, "intrinsic_reward_module": {"weights_seq_no": 36.0, "num_module_steps_trained_lifetime": 215460, "module_train_batch_size_mean": 997.6644392492373, "num_module_steps_trained": 35910, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 31.0}, "default_policy": {"policy_loss": -0.00023078062804415822, "num_module_steps_trained_lifetime": 215460, "module_train_batch_size_mean": 997.6644392492373, "vf_loss_unclipped": 41.822505950927734, "num_module_steps_trained": 35910, "total_loss": 0.2487829327583313, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 5.110569327371195e-05, "vf_explained_var": 0.0007191896438598633, "diff_num_grad_updates_vs_sampler_policy": 31.0, "entropy": 0.6910682916641235, "weights_seq_no": 36.0, "vf_loss": 0.3209954798221588}}}, "IntrinsicAttentionMask": [[[0.166615828871727, 0.16663531959056854, 0.16674062609672546, 0.1667601466178894, 0.1665346324443817, 0.16671337187290192], [0.16662196815013885, 0.16663911938667297, 0.16673171520233154, 0.16674888134002686, 0.16655056178569794, 0.16670775413513184], [0.1666550636291504, 0.16665951907634735, 0.16668356955051422, 0.16668802499771118, 0.16663651168346405, 0.1666773408651352], [0.16666118800640106, 0.1666632741689682, 0.1666746288537979, 0.16667672991752625, 0.16665242612361908, 0.16667169332504272], [0.16659028828144073, 0.16661958396434784, 0.16677778959274292, 0.1668071150779724, 0.16646835207939148, 0.16673682630062103], [0.16664648056030273, 0.16665422916412354, 0.16669602692127228, 0.16670376062393188, 0.16661426424980164, 0.16668519377708435]], [[0.16643807291984558, 0.1668119728565216, 0.1664796769618988, 0.16676202416419983, 0.16687452793121338, 0.16663362085819244], [0.16690205037593842, 0.16651709377765656, 0.16685912013053894, 0.16656841337680817, 0.16645285487174988, 0.16670049726963043], [0.16648973524570465, 0.16677916049957275, 0.16652195155620575, 0.1667405068874359, 0.16682755947113037, 0.16664113104343414], [0.1668400913476944, 0.1665564626455307, 0.16680847108364105, 0.16659428179264069, 0.16650910675525665, 0.1666916012763977], [0.1669796258211136, 0.1664678007364273, 0.16692253947257996, 0.16653601825237274, 0.16638244688510895, 0.16671159863471985], [0.16668079793453217, 0.1666576862335205, 0.16667822003364563, 0.16666077077388763, 0.1666538268327713, 0.16666871309280396]], [[0.1660640388727188, 0.16692930459976196, 0.16657759249210358, 0.16662664711475372, 0.1672932207584381, 0.16650912165641785], [0.1665741205215454, 0.16670697927474976, 0.16665305197238922, 0.16666057705879211, 0.16676269471645355, 0.16664253175258636], [0.16636699438095093, 0.16679725050926208, 0.16662250459194183, 0.16664688289165497, 0.1669778823852539, 0.1665884554386139], [0.166395902633667, 0.16678467392921448, 0.16662678122520447, 0.16664880514144897, 0.1669478416442871, 0.16659602522850037], [0.16678813099861145, 0.16661371290683746, 0.16668447852134705, 0.16667459905147552, 0.1665406972169876, 0.16669827699661255], [0.1663266271352768, 0.16681483387947083, 0.1666165292263031, 0.16664420068264008, 0.16701984405517578, 0.16657789051532745]], [[0.1666528433561325, 0.16660572588443756, 0.16663537919521332, 0.16673633456230164, 0.1666892021894455, 0.1666804552078247], [0.166632741689682, 0.16651713848114014, 0.1665898859500885, 0.16683772206306458, 0.16672198474407196, 0.166700541973114], [0.16664540767669678, 0.16657289862632751, 0.16661852598190308, 0.16677391529083252, 0.16670136153697968, 0.16668792068958282], [0.16668842732906342, 0.16676275432109833, 0.16671597957611084, 0.16655685007572174, 0.16663111746311188, 0.1666448712348938], [0.1666683554649353, 0.16667410731315613, 0.16667048633098602, 0.16665814816951752, 0.16666391491889954, 0.1666649729013443], [0.16666464507579803, 0.1666577011346817, 0.1666620671749115, 0.16667693853378296, 0.16666999459266663, 0.16666869819164276]], [[0.1666158139705658, 0.16663531959056854, 0.16674062609672546, 0.1667601466178894, 0.16677966713905334, 0.16646842658519745], [0.16662196815013885, 0.16663911938667297, 0.16673171520233154, 0.16674888134002686, 0.16676604747772217, 0.16649234294891357], [0.1666550487279892, 0.16665950417518616, 0.16668355464935303, 0.16668801009655, 0.16669246554374695, 0.1666213721036911], [0.16666118800640106, 0.1666633039712906, 0.1666746437549591, 0.16667674481868744, 0.16667884588241577, 0.16664530336856842], [0.16666731238365173, 0.16666705906391144, 0.1666657030582428, 0.1666654497385025, 0.1666651964187622, 0.16666920483112335], [0.16656938195228577, 0.16660666465759277, 0.16680802404880524, 0.16684535145759583, 0.1668827086687088, 0.16628777980804443]], [[0.16654373705387115, 0.16674482822418213, 0.16670677065849304, 0.16671797633171082, 0.16663773357868195, 0.16664893925189972], [0.1670079082250595, 0.16644994914531708, 0.16655534505844116, 0.16652430593967438, 0.16674678027629852, 0.16671571135520935], [0.1669200360774994, 0.16650570929050446, 0.16658399999141693, 0.16656094789505005, 0.16672617197036743, 0.16670309007167816], [0.1669459044933319, 0.16648928821086884, 0.1665755659341812, 0.1665501594543457, 0.16673223674297333, 0.16670680046081543], [0.16676068305969238, 0.16660693287849426, 0.16663600504398346, 0.1666274517774582, 0.16668877005577087, 0.1666802167892456], [0.1667865365743637, 0.16659051179885864, 0.16662757098674774, 0.16661666333675385, 0.16669484972953796, 0.16668392717838287]]], "default_policy": {"num_module_steps_trained_lifetime": 35910, "module_train_batch_size_mean": 998.5423314844973, "vf_loss_unclipped": 41.86195373535156, "num_module_steps_trained": 5985, "num_trainable_parameters": 16595, "total_loss": 0.24840006232261658, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 5.28922064404469e-05, "weights_seq_no": 6.0, "vf_loss": 0.32051926851272583, "curr_kl_coeff": 0.0025247489102184772, "vf_explained_var": -0.0008232593536376953, "policy_loss": -0.00023467782011721283, "entropy": 0.6910573840141296, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 653.5465019561611}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 35910, "module_train_batch_size_mean": 998.5423314844973, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5985, "num_trainable_parameters": 8266, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 6.0, "num_module_steps_trained_lifetime_throughput": 653.5568083180466}, "__all_modules__": {"num_env_steps_trained_lifetime": 216000, "num_env_steps_trained": 36000, "num_module_steps_trained_lifetime": 71820, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3935.4446055843378, "num_module_steps_trained_throughput": 26607370.59799812, "num_module_steps_trained_lifetime_throughput": 12775395.108672587}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.45, "sample": 0.1229046336332362, "env_step_timer": 1.3785883262421329e-05, "episode_return_max": 13.5, "episode_return_min": -14.5, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.816592295952665e-06, "numpy_to_tensor": 1.1815392835957233e-05, "add_time_dim_to_batch_and_zero_pad": 6.844887151173096e-06, "add_states_from_episodes_to_batch": 2.675197910635113e-06, "batch_individual_items": 1.2292145641868349e-05}}, "connector_pipeline_timer": 5.8506378494424555e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394470474, "num_episodes_lifetime": 120, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 30400, "episode_duration_sec_mean": 0.005262932070763782, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.400923457626569e-06, "get_actions": 3.532452412538837e-05, "tensor_to_numpy": 1.4935737321550693e-05, "normalize_and_clip_actions": 7.782066945144472e-06, "remove_single_ts_time_rank_from_batch": 1.1775979530550902e-05, "listify_data_for_vector_env": 1.0056440392116266e-05}}, "connector_pipeline_timer": 0.00011195413249541905}, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "episode_len_max": 20, "weights_seq_no": 6.0, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "num_episodes": 20, "rlmodule_inference_timer": 3.011549475936671e-05, "num_env_steps_sampled": 400, "env_reset_timer": 0.0005579650397494712, "module_episode_returns_mean": {"default_policy": 1.45}, "env_to_module_sum_episodes_length_in": 10.368238394470474, "agent_episode_returns_mean": {"default_agent": 1.45}, "time_between_sampling": 10.301948808060066}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "b1762_00000", "date": "2025-08-11_18-24-50", "timestamp": 1754929490, "time_this_iter_s": 11.071326971054077, "time_total_s": 66.41324806213379, "pid": 10959, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 66.41324806213379, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 40.44375, "ram_util_percent": 79.1}}
{"timers": {"training_iteration": 11.976350715479855, "restore_env_runners": 8.299555418296807e-06, "training_step": 11.976117795055726, "env_runner_sampling_timer": 2.244331549185637, "learner_update_timer": 9.533628735235514, "synch_weights": 0.001905731886777742, "restore_eval_env_runners": 6.207523840210335e-05, "evaluation_iteration": 0.13549802077137765, "synch_eval_env_connectors": 0.00021575528565411127, "synch_env_connectors": 7.568517807276174e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.738100128900785e-06, "add_observations_from_episodes_to_batch": 2.805586403249829e-06, "batch_individual_items": 1.2496630287207724e-05, "numpy_to_tensor": 1.2449200649240714e-05, "add_time_dim_to_batch_and_zero_pad": 7.142283544015638e-06}}, "connector_pipeline_timer": 6.030335004790251e-05}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.894484501921502e-06, "listify_data_for_vector_env": 1.0339772697254255e-05, "remove_single_ts_time_rank_from_batch": 1.1746957557642444e-05, "un_batch_to_individual_items": 6.588130079686642e-06, "get_actions": 3.9509676102443465e-05, "tensor_to_numpy": 1.539278419331057e-05}}, "connector_pipeline_timer": 0.00011835324305203997}, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "num_episodes": 250.0, "episode_len_max": 20, "rlmodule_inference_timer": 3.2066569523764555e-05, "episode_len_min": 20, "time_between_sampling": 0.035529991748483286, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 4.7751164263739774e-05, "agent_episode_returns_mean": {"default_agent": 0.14000000000000007}, "num_episodes_lifetime": -153875.0, "episode_return_mean": 0.14000000000000007, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.006064728747312089, "env_step_timer": 1.3866461337944531e-05, "episode_len_mean": 20.0, "episode_return_max": 9.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.005296362822409722, "module_episode_returns_mean": {"default_policy": 0.14000000000000007}, "num_env_steps_sampled_lifetime": -3077500.0, "weights_seq_no": 6.0, "episode_return_min": -10.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3239.850185568094}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15537465131609782, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.010781892849238394, "add_observations_from_episodes_to_batch": 0.0008783426662321279, "add_columns_from_episodes_to_train_batch": 0.04194351610930512, "add_time_dim_to_batch_and_zero_pad": 0.09047452756657882, "add_states_from_episodes_to_batch": 0.003569895287960483, "batch_individual_items": 0.0074880668977992774, "numpy_to_tensor": 7.071576946473737e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_env_steps_trained_lifetime": 1512000, "num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 502740, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 53873.377689250905}, "intrinsic_reward_module": {"weights_seq_no": 42.0, "num_module_steps_trained_lifetime": 251370, "module_train_batch_size_mean": 997.6122293241576, "num_module_steps_trained": 35910, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}, "default_policy": {"policy_loss": -0.0007600582903251052, "num_module_steps_trained_lifetime": 251370, "module_train_batch_size_mean": 997.6122293241576, "vf_loss_unclipped": 43.312660217285156, "num_module_steps_trained": 35910, "total_loss": 0.24820618331432343, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 0.00013398831652011722, "vf_explained_var": 0.0008858442306518555, "diff_num_grad_updates_vs_sampler_policy": 36.0, "entropy": 0.6897920370101929, "weights_seq_no": 42.0, "vf_loss": 0.3209148049354553}}}, "IntrinsicAttentionMask": [[[0.1659616231918335, 0.16682635247707367, 0.16709162294864655, 0.16652388870716095, 0.1671900451183319, 0.16640643775463104], [0.1665583699941635, 0.16669122874736786, 0.16673186421394348, 0.16664481163024902, 0.16674692928791046, 0.16662678122520447], [0.16674108803272247, 0.16664978861808777, 0.1666218787431717, 0.1666816622018814, 0.16661153733730316, 0.1666940599679947], [0.166349858045578, 0.16673851013183594, 0.1668574959039688, 0.16660268604755402, 0.166901633143425, 0.1665499061346054], [0.1668088287115097, 0.16663439571857452, 0.16658110916614532, 0.16669528186321259, 0.16656136512756348, 0.1667189747095108], [0.16626879572868347, 0.16675683856010437, 0.16690632700920105, 0.1665862500667572, 0.16696177423000336, 0.16651998460292816]], [[0.16652029752731323, 0.1665807068347931, 0.16668331623077393, 0.1666945070028305, 0.16675497591495514, 0.1667661815881729], [0.1666862666606903, 0.16667817533016205, 0.16666442155838013, 0.16666291654109955, 0.1666548252105713, 0.1666533201932907], [0.16696836054325104, 0.1668436974287033, 0.16663223505020142, 0.16660916805267334, 0.1664847731590271, 0.1664617359638214], [0.16699916124343872, 0.16686175763607025, 0.16662870347499847, 0.16660329699516296, 0.16646622121334076, 0.16644082963466644], [0.16716544330120087, 0.1669592261314392, 0.16660965979099274, 0.16657154262065887, 0.1663660705089569, 0.16632802784442902], [0.16719627380371094, 0.16697730123996735, 0.1666061282157898, 0.1665656715631485, 0.16634751856327057, 0.16630712151527405]], [[0.166615828871727, 0.16663531959056854, 0.16674062609672546, 0.1667601466178894, 0.1665346324443817, 0.16671337187290192], [0.16662196815013885, 0.16663911938667297, 0.16673171520233154, 0.16674888134002686, 0.16655056178569794, 0.16670775413513184], [0.1666550636291504, 0.16665951907634735, 0.16668356955051422, 0.16668802499771118, 0.16663651168346405, 0.1666773408651352], [0.16666118800640106, 0.1666632741689682, 0.1666746288537979, 0.16667672991752625, 0.16665242612361908, 0.16667169332504272], [0.16659028828144073, 0.16661958396434784, 0.16677778959274292, 0.1668071150779724, 0.16646835207939148, 0.16673682630062103], [0.16664648056030273, 0.16665422916412354, 0.16669602692127228, 0.16670376062393188, 0.16661426424980164, 0.16668519377708435]], [[0.16639456152915955, 0.1667683720588684, 0.16669760644435883, 0.16671843826770782, 0.16656926274299622, 0.16685175895690918], [0.16694699227809906, 0.16656193137168884, 0.1666346937417984, 0.16661326587200165, 0.16676682233810425, 0.1664762645959854], [0.16684240102767944, 0.1666010022163391, 0.16664662957191467, 0.16663320362567902, 0.16672948002815247, 0.1665472686290741], [0.16687320172786713, 0.16658951342105865, 0.16664312779903412, 0.16662733256816864, 0.16674049198627472, 0.16652637720108032], [0.16665273904800415, 0.16667188704013824, 0.16666826605796814, 0.1666693240404129, 0.16666167974472046, 0.16667614877223969], [0.16707023978233337, 0.16651590168476105, 0.16662061214447021, 0.16658978164196014, 0.1668107956647873, 0.16639266908168793]], [[0.16585931181907654, 0.16672350466251373, 0.16698861122131348, 0.16703778505325317, 0.16708697378635406, 0.1663038432598114], [0.16654261946678162, 0.16667546331882477, 0.1667160987854004, 0.16672362387180328, 0.16673116385936737, 0.16661103069782257], [0.1667519360780716, 0.1666606217622757, 0.16663271188735962, 0.16662754118442535, 0.16662238538265228, 0.1667049080133438], [0.16679073870182037, 0.16665786504745483, 0.1666172593832016, 0.1666097342967987, 0.1666022092103958, 0.16672229766845703], [0.16682952642440796, 0.16665507853031158, 0.1666017770767212, 0.16659189760684967, 0.16658201813697815, 0.16673965752124786], [0.16621097922325134, 0.1666988581418991, 0.1668483018875122, 0.16687600314617157, 0.16690371930599213, 0.16646207869052887]], [[0.16659915447235107, 0.16673068702220917, 0.1667930781841278, 0.1667747050523758, 0.16667558252811432, 0.16642679274082184], [0.16666115820407867, 0.16667190194129944, 0.16667699813842773, 0.16667549312114716, 0.1666674017906189, 0.1666470617055893], [0.16669052839279175, 0.16664402186870575, 0.16662196815013885, 0.16662845015525818, 0.1666634976863861, 0.16675156354904175], [0.16668187081813812, 0.16665221750736237, 0.16663816571235657, 0.16664230823516846, 0.16666463017463684, 0.16672077775001526], [0.166635200381279, 0.16669651865959167, 0.16672560572624207, 0.1667170375585556, 0.16667082905769348, 0.1665547788143158], [0.16651774942874908, 0.16680769622325897, 0.16694533824920654, 0.16690479218959808, 0.16668620705604553, 0.1661382019519806]]], "default_policy": {"num_module_steps_trained_lifetime": 41895, "module_train_batch_size_mean": 998.4808932973482, "vf_loss_unclipped": 43.452884674072266, "num_module_steps_trained": 5985, "num_trainable_parameters": 16595, "total_loss": 0.2478569597005844, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.00013989234867040068, "weights_seq_no": 7.0, "vf_loss": 0.32051464915275574, "curr_kl_coeff": 0.0012623744551092386, "vf_explained_var": -0.0005431175231933594, "policy_loss": -0.0007762641180306673, "entropy": 0.6897630095481873, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 652.494508387867}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 41895, "module_train_batch_size_mean": 998.4808932973482, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5985, "num_trainable_parameters": 8266, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 7.0, "num_module_steps_trained_lifetime_throughput": 652.5042558351719}, "__all_modules__": {"num_env_steps_trained_lifetime": 252000, "num_env_steps_trained": 36000, "num_module_steps_trained_lifetime": 83790, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3928.9637372721286, "num_module_steps_trained_throughput": 25881947.10161506, "num_module_steps_trained_lifetime_throughput": 12726378.667402906}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 0.85, "sample": 0.12280678438646603, "env_step_timer": 1.396873792661865e-05, "episode_return_max": 13.5, "episode_return_min": -14.5, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.807739914614729e-06, "numpy_to_tensor": 1.1895034076186612e-05, "add_time_dim_to_batch_and_zero_pad": 6.981937384539173e-06, "add_states_from_episodes_to_batch": 2.6721898352005788e-06, "batch_individual_items": 1.2449329682403565e-05}}, "connector_pipeline_timer": 5.87817489299762e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394572801, "num_episodes_lifetime": 140, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 35400, "episode_duration_sec_mean": 0.005239723748527467, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.399628870633324e-06, "get_actions": 3.566505833315972e-05, "tensor_to_numpy": 1.479877509058781e-05, "normalize_and_clip_actions": 7.75483497365304e-06, "remove_single_ts_time_rank_from_batch": 1.180127870665771e-05, "listify_data_for_vector_env": 1.0230980746140438e-05}}, "connector_pipeline_timer": 0.00011248489882513035}, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "episode_len_max": 20, "weights_seq_no": 7.0, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "num_episodes": 20, "rlmodule_inference_timer": 3.03917674444711e-05, "num_env_steps_sampled": 400, "env_reset_timer": 0.0005563899786339528, "module_episode_returns_mean": {"default_policy": 0.85}, "env_to_module_sum_episodes_length_in": 10.368238394572801, "agent_episode_returns_mean": {"default_agent": 0.85}, "time_between_sampling": 10.307120653309934}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "b1762_00000", "date": "2025-08-11_18-25-01", "timestamp": 1754929501, "time_this_iter_s": 10.916230916976929, "time_total_s": 77.32947897911072, "pid": 10959, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 77.32947897911072, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 43.693749999999994, "ram_util_percent": 78.475}}
{"timers": {"training_iteration": 11.962843510824735, "restore_env_runners": 8.277809457386645e-06, "training_step": 11.962610475025114, "env_runner_sampling_timer": 2.237185617024543, "learner_update_timer": 9.527180415803322, "synch_weights": 0.001902040398532578, "restore_eval_env_runners": 6.15503156185506e-05, "evaluation_iteration": 0.13535695931337258, "synch_eval_env_connectors": 0.00021470856314182989, "synch_env_connectors": 7.543673528551671e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.737699217155644e-06, "add_observations_from_episodes_to_batch": 2.814312179742178e-06, "batch_individual_items": 1.2513536729152044e-05, "numpy_to_tensor": 1.2381339543396404e-05, "add_time_dim_to_batch_and_zero_pad": 7.173504272647897e-06}}, "connector_pipeline_timer": 6.0339967784028e-05}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.86530107173879e-06, "listify_data_for_vector_env": 1.0321105587499383e-05, "remove_single_ts_time_rank_from_batch": 1.1689050647096906e-05, "un_batch_to_individual_items": 6.555922472712293e-06, "get_actions": 3.9390563782761104e-05, "tensor_to_numpy": 1.53101722557956e-05}}, "connector_pipeline_timer": 0.00011801589326127815}, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "num_episodes": 250.0, "episode_len_max": 20, "rlmodule_inference_timer": 3.1956798918833545e-05, "episode_len_min": 20, "time_between_sampling": 0.03786658773987249, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 3.5356786153750976e-05, "agent_episode_returns_mean": {"default_agent": 0.7800000000000001}, "num_episodes_lifetime": -184750.0, "episode_return_mean": 0.7800000000000001, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.005663202058992553, "env_step_timer": 1.3849255745097043e-05, "episode_len_mean": 20.0, "episode_return_max": 9.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.005286735496018082, "module_episode_returns_mean": {"default_policy": 0.7800000000000001}, "num_env_steps_sampled_lifetime": -3695000.0, "weights_seq_no": 7.0, "episode_return_min": -10.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3259.9150241075827}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15538173397298508, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.01076324433081099, "add_observations_from_episodes_to_batch": 0.000877923409195372, "add_columns_from_episodes_to_train_batch": 0.041941113028216064, "add_time_dim_to_batch_and_zero_pad": 0.09049925312034586, "add_states_from_episodes_to_batch": 0.0035724100847298814, "batch_individual_items": 0.007489485809799514, "numpy_to_tensor": 7.092277239796175e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_env_steps_trained_lifetime": 1728000, "num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 574560, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 52937.88457410981}, "intrinsic_reward_module": {"weights_seq_no": 48.0, "num_module_steps_trained_lifetime": 287280, "module_train_batch_size_mean": 997.5758696422192, "num_module_steps_trained": 35910, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 41.0}, "default_policy": {"policy_loss": -0.0011069367174059153, "num_module_steps_trained_lifetime": 287280, "module_train_batch_size_mean": 997.5758696422192, "vf_loss_unclipped": 40.918060302734375, "num_module_steps_trained": 35910, "total_loss": 0.24778850376605988, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 0.00013467262033373117, "vf_explained_var": 0.0007644891738891602, "diff_num_grad_updates_vs_sampler_policy": 41.0, "entropy": 0.6884377002716064, "weights_seq_no": 48.0, "vf_loss": 0.3208211362361908}}}, "IntrinsicAttentionMask": [[[0.16616667807102203, 0.16703246533870697, 0.16668054461479187, 0.1667296290397644, 0.16677872836589813, 0.16661202907562256], [0.1665898710489273, 0.16672275960445404, 0.1666688174009323, 0.1666763424873352, 0.1666838675737381, 0.16665831208229065], [0.16641801595687866, 0.16684840619564056, 0.16667360067367554, 0.16669799387454987, 0.1667223870754242, 0.1666395366191864], [0.16644200682640076, 0.1668308675289154, 0.166672945022583, 0.16669496893882751, 0.1667170226573944, 0.1666421741247177], [0.16646598279476166, 0.16681331396102905, 0.1666722595691681, 0.16669194400310516, 0.16671162843704224, 0.16664478182792664], [0.1663845330476761, 0.16687291860580444, 0.16667453944683075, 0.16670222580432892, 0.1667298972606659, 0.1666359007358551]], [[0.1664380431175232, 0.1668119579553604, 0.16647964715957642, 0.16650044918060303, 0.166874498128891, 0.16689535975456238], [0.16690200567245483, 0.16651704907417297, 0.16685907542705536, 0.1668376326560974, 0.1664528101682663, 0.16643141210079193], [0.16648970544338226, 0.16677913069725037, 0.16652192175388336, 0.1665380299091339, 0.16682752966880798, 0.16684366762638092], [0.1665155440568924, 0.16676270961761475, 0.16654305160045624, 0.16655680537223816, 0.16680404543876648, 0.1668178290128708], [0.16697955131530762, 0.16646772623062134, 0.166922464966774, 0.16689392924308777, 0.16638237237930298, 0.16635392606258392], [0.16700540482997894, 0.16645129024982452, 0.16694359481334686, 0.16691270470619202, 0.16635888814926147, 0.16632810235023499]], [[0.1666974574327469, 0.16647204756736755, 0.16657723486423492, 0.16659674048423767, 0.1668614000082016, 0.16679507493972778], [0.166740283370018, 0.16620086133480072, 0.16645246744155884, 0.16649912297725677, 0.1671331822872162, 0.16697414219379425], [0.16672033071517944, 0.16632743179798126, 0.16651073098182678, 0.16654472053050995, 0.16700628399848938, 0.16689056158065796], [0.16671662032604218, 0.16635088622570038, 0.16652151942253113, 0.16655315458774567, 0.1669827699661255, 0.16687506437301636], [0.16666628420352936, 0.16666918992996216, 0.16666783392429352, 0.16666758060455322, 0.16666418313980103, 0.16666503250598907], [0.16667890548706055, 0.1665894240140915, 0.16663119196891785, 0.16663892567157745, 0.1667439341545105, 0.16671763360500336]], [[0.16648165881633759, 0.16685566306114197, 0.1667848527431488, 0.1665440797805786, 0.16665643453598022, 0.16667726635932922], [0.16685713827610016, 0.16647228598594666, 0.16654500365257263, 0.16679278016090393, 0.1666770726442337, 0.16665562987327576], [0.1667860895395279, 0.16654476523399353, 0.1665903925895691, 0.16674575209617615, 0.1666732132434845, 0.16665977239608765], [0.1665443778038025, 0.16679158806800842, 0.16674479842185974, 0.16658565402030945, 0.16665992140769958, 0.1666736900806427], [0.1666571944952011, 0.1666763424873352, 0.1666727215051651, 0.1666603833436966, 0.1666661500930786, 0.16666720807552338], [0.16667811572551727, 0.16665500402450562, 0.1666593849658966, 0.16667425632476807, 0.16666731238365173, 0.16666603088378906]], [[0.16585931181907654, 0.16672350466251373, 0.16698861122131348, 0.16703778505325317, 0.16708697378635406, 0.1663038432598114], [0.16654261946678162, 0.16667546331882477, 0.1667160987854004, 0.16672362387180328, 0.16673116385936737, 0.16661103069782257], [0.1667519360780716, 0.1666606217622757, 0.16663271188735962, 0.16662754118442535, 0.16662238538265228, 0.1667049080133438], [0.16679073870182037, 0.16665786504745483, 0.1666172593832016, 0.1666097342967987, 0.1666022092103958, 0.16672229766845703], [0.16682952642440796, 0.16665507853031158, 0.1666017770767212, 0.16659189760684967, 0.16658201813697815, 0.16673965752124786], [0.16621097922325134, 0.1666988581418991, 0.1668483018875122, 0.16687600314617157, 0.16690371930599213, 0.16646207869052887]], [[0.16652029752731323, 0.1665807068347931, 0.16668331623077393, 0.1666945070028305, 0.16675497591495514, 0.1667661815881729], [0.1666862666606903, 0.16667817533016205, 0.16666442155838013, 0.16666291654109955, 0.1666548252105713, 0.1666533201932907], [0.16696836054325104, 0.1668436974287033, 0.16663223505020142, 0.16660916805267334, 0.1664847731590271, 0.1664617359638214], [0.16699916124343872, 0.16686175763607025, 0.16662870347499847, 0.16660329699516296, 0.16646622121334076, 0.16644082963466644], [0.16716544330120087, 0.1669592261314392, 0.16660965979099274, 0.16657154262065887, 0.1663660705089569, 0.16632802784442902], [0.16719627380371094, 0.16697730123996735, 0.1666061282157898, 0.1665656715631485, 0.16634751856327057, 0.16630712151527405]]], "default_policy": {"num_module_steps_trained_lifetime": 47880, "module_train_batch_size_mean": 998.4230504637324, "vf_loss_unclipped": 40.88594436645508, "num_module_steps_trained": 5985, "num_trainable_parameters": 16595, "total_loss": 0.2474895417690277, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.00014395186735782772, "weights_seq_no": 8.0, "vf_loss": 0.32051292061805725, "curr_kl_coeff": 0.0006311872275546193, "vf_explained_var": -0.00036644935607910156, "policy_loss": -0.0011442864779382944, "entropy": 0.6883840560913086, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 651.3466047130909}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 47880, "module_train_batch_size_mean": 998.4230504637324, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5985, "num_trainable_parameters": 8266, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 8.0, "num_module_steps_trained_lifetime_throughput": 651.3557790224139}, "__all_modules__": {"num_env_steps_trained_lifetime": 288000, "num_env_steps_trained": 36000, "num_module_steps_trained_lifetime": 95760, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3921.9096282885466, "num_module_steps_trained_throughput": 25157390.655850008, "num_module_steps_trained_lifetime_throughput": 12658354.608766787}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 0.65, "sample": 0.12269582863317967, "env_step_timer": 1.3740352403614683e-05, "episode_return_max": 13.5, "episode_return_min": -14.5, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.785306010568023e-06, "numpy_to_tensor": 1.1876521010509e-05, "add_time_dim_to_batch_and_zero_pad": 6.887391460816198e-06, "add_states_from_episodes_to_batch": 2.662566459975218e-06, "batch_individual_items": 1.2301565284057898e-05}}, "connector_pipeline_timer": 5.823870489544309e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.3682383945743, "num_episodes_lifetime": 160, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 40400, "episode_duration_sec_mean": 0.005161113745998591, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.392794970787838e-06, "get_actions": 3.5143206327055876e-05, "tensor_to_numpy": 1.4776510678305989e-05, "normalize_and_clip_actions": 7.74599627076484e-06, "remove_single_ts_time_rank_from_batch": 1.1877812295368059e-05, "listify_data_for_vector_env": 1.0118555424256669e-05}}, "connector_pipeline_timer": 0.00011156645997054221}, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "episode_len_max": 20, "weights_seq_no": 8.0, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "num_episodes": 20, "rlmodule_inference_timer": 3.0051742034587188e-05, "num_env_steps_sampled": 400, "env_reset_timer": 0.0005520406585266852, "module_episode_returns_mean": {"default_policy": 0.65}, "env_to_module_sum_episodes_length_in": 10.3682383945743, "agent_episode_returns_mean": {"default_agent": 0.65}, "time_between_sampling": 10.31057942761653}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "b1762_00000", "date": "2025-08-11_18-25-12", "timestamp": 1754929512, "time_this_iter_s": 10.74713397026062, "time_total_s": 88.07661294937134, "pid": 10959, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 88.07661294937134, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 41.49333333333333, "ram_util_percent": 78.30666666666667}}
{"timers": {"training_iteration": 11.944168803216069, "restore_env_runners": 8.252950313728116e-06, "training_step": 11.943935836944657, "env_runner_sampling_timer": 2.23148500835406, "learner_update_timer": 9.514158025394957, "synch_weights": 0.0018933204140734268, "restore_eval_env_runners": 6.131815181899613e-05, "evaluation_iteration": 0.13518779431040595, "synch_eval_env_connectors": 0.00021434522799604043, "synch_env_connectors": 7.579486767263627e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7623337822864235e-06, "add_observations_from_episodes_to_batch": 2.81559649643745e-06, "batch_individual_items": 1.2611930705174889e-05, "numpy_to_tensor": 1.253834676951375e-05, "add_time_dim_to_batch_and_zero_pad": 7.2848129211419685e-06}}, "connector_pipeline_timer": 6.0775119783757254e-05}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.877792786504087e-06, "listify_data_for_vector_env": 1.0410556855630087e-05, "remove_single_ts_time_rank_from_batch": 1.1724353847525279e-05, "un_batch_to_individual_items": 6.609822085491303e-06, "get_actions": 3.9798529770418087e-05, "tensor_to_numpy": 1.5402231989639307e-05}}, "connector_pipeline_timer": 0.00011876936794093349}, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "num_episodes": 250.0, "episode_len_max": 20, "rlmodule_inference_timer": 3.1919520247060015e-05, "episode_len_min": 20, "time_between_sampling": 0.037893584821618545, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 3.658847378432127e-05, "agent_episode_returns_mean": {"default_agent": 0.7000000000000002}, "num_episodes_lifetime": -215625.0, "episode_return_mean": 0.7000000000000002, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.0056578485499662, "env_step_timer": 1.3912322838372854e-05, "episode_len_mean": 20.0, "episode_return_max": 9.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.005314298828132454, "module_episode_returns_mean": {"default_policy": 0.7000000000000002}, "num_env_steps_sampled_lifetime": -4312500.0, "weights_seq_no": 8.0, "episode_return_min": -10.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3223.6587116746146}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15536124413405678, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.010744765218275994, "add_observations_from_episodes_to_batch": 0.0008775562554546815, "add_columns_from_episodes_to_train_batch": 0.04194106772795488, "add_time_dim_to_batch_and_zero_pad": 0.09048525933867048, "add_states_from_episodes_to_batch": 0.003579664323943964, "batch_individual_items": 0.007494510532304537, "numpy_to_tensor": 7.116729466034757e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_env_steps_trained_lifetime": 1944000, "num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 646380, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 52009.027175910436}, "intrinsic_reward_module": {"weights_seq_no": 54.0, "num_module_steps_trained_lifetime": 323190, "module_train_batch_size_mean": 997.5505482791133, "num_module_steps_trained": 35910, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}, "default_policy": {"policy_loss": -0.000580123218242079, "num_module_steps_trained_lifetime": 323190, "module_train_batch_size_mean": 997.5505482791133, "vf_loss_unclipped": 41.11466598510742, "num_module_steps_trained": 35910, "total_loss": 0.24826939404010773, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 0.00011105478915851563, "vf_explained_var": 0.0008093118667602539, "diff_num_grad_updates_vs_sampler_policy": 46.0, "entropy": 0.6868256330490112, "weights_seq_no": 54.0, "vf_loss": 0.32076385617256165}}}, "IntrinsicAttentionMask": [[[0.16665667295455933, 0.16667617857456207, 0.16653646528720856, 0.16680103540420532, 0.16657546162605286, 0.16675424575805664], [0.16665787994861603, 0.16667503118515015, 0.16655217111110687, 0.16678482294082642, 0.1665864735841751, 0.1667436808347702], [0.16664917767047882, 0.16668319702148438, 0.16643968224525452, 0.16690094769001007, 0.16650763154029846, 0.16681933403015137], [0.16666558384895325, 0.16666767001152039, 0.1666526198387146, 0.16668112576007843, 0.16665682196617126, 0.1666760891675949], [0.1666516214609146, 0.1666809320449829, 0.16647107899188995, 0.16686852276325226, 0.16652964055538177, 0.16679821908473969], [0.16666270792484283, 0.16667045652866364, 0.16661499440670013, 0.16671998798847198, 0.16663047671318054, 0.16670142114162445]], [[0.16667601466178894, 0.16657695174217224, 0.1666392982006073, 0.16685163974761963, 0.16675247251987457, 0.16650356352329254], [0.16668245196342468, 0.16651490330696106, 0.16662032902240753, 0.16697968542575836, 0.16681183874607086, 0.1663908064365387], [0.16667839884757996, 0.16655395925045013, 0.1666322648525238, 0.16689908504486084, 0.16677448153495789, 0.1664617657661438], [0.16666454076766968, 0.16668687760829926, 0.16667282581329346, 0.1666249781847, 0.1666473150253296, 0.16670344769954681], [0.1666710525751114, 0.16662485897541046, 0.16665393114089966, 0.1667529195547104, 0.16670669615268707, 0.166590616106987], [0.16668719053268433, 0.16646888852119446, 0.16660624742507935, 0.16707463562488556, 0.1668558120727539, 0.1663072556257248]], [[0.16596154868602753, 0.16621048748493195, 0.16709153354167938, 0.16714073717594147, 0.16657283902168274, 0.16702283918857574], [0.1661335527896881, 0.16632187366485596, 0.1669878214597702, 0.16702498495578766, 0.16659586131572723, 0.16693593561649323], [0.16674108803272247, 0.16671475768089294, 0.1666218787431717, 0.16661670804023743, 0.16667649149894714, 0.1666291058063507], [0.1667749583721161, 0.1667366325855255, 0.1666014939546585, 0.16659396886825562, 0.1666809469461441, 0.16661199927330017], [0.16638363897800446, 0.16648368537425995, 0.16683709621429443, 0.1668567955493927, 0.16662918031215668, 0.1668095886707306], [0.1666937917470932, 0.16668419539928436, 0.16665033996105194, 0.16664846241474152, 0.16667024791240692, 0.16665297746658325]], [[0.1664816439151764, 0.16659395396709442, 0.1667848378419876, 0.16654406487941742, 0.16691821813583374, 0.16667725145816803], [0.166594460606575, 0.1666383147239685, 0.16671279072761536, 0.16661883890628815, 0.16676479578018188, 0.1666708141565323], [0.1667860895395279, 0.16671353578567505, 0.1665903925895691, 0.16674575209617615, 0.16650448739528656, 0.16665977239608765], [0.1665443629026413, 0.16661863029003143, 0.16674479842185974, 0.16658563911914825, 0.16683292388916016, 0.1666736900806427], [0.16691990196704865, 0.1667659729719162, 0.16650491952896118, 0.16683430969715118, 0.16632293164730072, 0.16665196418762207], [0.16667810082435608, 0.16667115688323975, 0.1666593700647354, 0.16667424142360687, 0.16665112972259521, 0.16666601598262787]], [[0.1658591777086258, 0.16610796749591827, 0.16698847711086273, 0.16703765094280243, 0.16708683967590332, 0.16691982746124268], [0.16605612635612488, 0.16624435782432556, 0.16690999269485474, 0.166947141289711, 0.16698428988456726, 0.16685812175273895], [0.1667519211769104, 0.16672557592391968, 0.16663269698619843, 0.16662752628326416, 0.1666223704814911, 0.16663992404937744], [0.16679072380065918, 0.1667523831129074, 0.1666172444820404, 0.1666097193956375, 0.16660219430923462, 0.16662774980068207], [0.16682952642440796, 0.16677919030189514, 0.1666017770767212, 0.16659189760684967, 0.16658201813697815, 0.1666155606508255], [0.16669772565364838, 0.16668812930583954, 0.16665427386760712, 0.1666523814201355, 0.16665050387382507, 0.16665691137313843]], [[0.1666528433561325, 0.16671541333198547, 0.16674508154392242, 0.16662666201591492, 0.1666892021894455, 0.16657082736492157], [0.1666795164346695, 0.16662129759788513, 0.16659371554851532, 0.16670390963554382, 0.16664569079875946, 0.16675591468811035], [0.16669213771820068, 0.16657668352127075, 0.16652196645736694, 0.1667405217885971, 0.1666250228881836, 0.1668437123298645], [0.16664165258407593, 0.166754812002182, 0.16680848598480225, 0.16659429669380188, 0.16670741140842438, 0.16649334132671356], [0.1666683405637741, 0.16666071116924286, 0.16665707528591156, 0.1666715443134308, 0.16666390001773834, 0.16667836904525757], [0.1666177362203598, 0.16683880984783173, 0.1669437140226364, 0.1665252447128296, 0.16674618422985077, 0.16632822155952454]]], "default_policy": {"num_module_steps_trained_lifetime": 53865, "module_train_batch_size_mean": 998.3685925840979, "vf_loss_unclipped": 41.09163284301758, "num_module_steps_trained": 5985, "num_trainable_parameters": 16595, "total_loss": 0.24804359674453735, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.00011559561971807852, "weights_seq_no": 9.0, "vf_loss": 0.32051143050193787, "curr_kl_coeff": 0.00031559361377730966, "vf_explained_var": -0.0001246929168701172, "policy_loss": -0.0005914340144954622, "entropy": 0.6867921948432922, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 650.6859784553277}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 53865, "module_train_batch_size_mean": 998.3685925840979, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5985, "num_trainable_parameters": 8266, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 9.0, "num_module_steps_trained_lifetime_throughput": 650.6946282224002}, "__all_modules__": {"num_env_steps_trained_lifetime": 324000, "num_env_steps_trained": 36000, "num_module_steps_trained_lifetime": 107730, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3917.787427464834, "num_module_steps_trained_throughput": 24479891.881201003, "num_module_steps_trained_lifetime_throughput": 12617236.075714866}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": -0.35, "sample": 0.12260987617698867, "env_step_timer": 1.462496237273149e-05, "episode_return_max": 13.5, "episode_return_min": -14.5, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.879371138213533e-06, "numpy_to_tensor": 1.2563540104019116e-05, "add_time_dim_to_batch_and_zero_pad": 7.070988883523744e-06, "add_states_from_episodes_to_batch": 2.7127549308680824e-06, "batch_individual_items": 1.2799181461909774e-05}}, "connector_pipeline_timer": 6.043902029724422e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes_lifetime": 180, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 45400, "episode_duration_sec_mean": 0.00517916583456099, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.633308951524761e-06, "get_actions": 3.781421749428531e-05, "tensor_to_numpy": 1.5445163497717323e-05, "normalize_and_clip_actions": 8.027003128836018e-06, "remove_single_ts_time_rank_from_batch": 1.219530632600266e-05, "listify_data_for_vector_env": 1.055785803989531e-05}}, "connector_pipeline_timer": 0.00011709915323116506}, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "episode_len_max": 20, "weights_seq_no": 9.0, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "num_episodes": 20, "rlmodule_inference_timer": 3.262557703745998e-05, "num_env_steps_sampled": 400, "env_reset_timer": 0.0005473902515811083, "module_episode_returns_mean": {"default_policy": -0.35}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": -0.35}, "time_between_sampling": 10.308676040420345}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "b1762_00000", "date": "2025-08-11_18-25-22", "timestamp": 1754929522, "time_this_iter_s": 10.217255353927612, "time_total_s": 98.29386830329895, "pid": 10959, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 98.29386830329895, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 38.27142857142858, "ram_util_percent": 78.05}}
{"timers": {"training_iteration": 11.934025377273631, "restore_env_runners": 8.230010321374386e-06, "training_step": 11.933792222745879, "env_runner_sampling_timer": 2.2254953924301137, "learner_update_timer": 9.509928818890314, "synch_weights": 0.001893126380560361, "restore_eval_env_runners": 6.076497075767578e-05, "evaluation_iteration": 0.13502669511776247, "synch_eval_env_connectors": 0.0002131684454748618, "synch_env_connectors": 7.542441903614305e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7488172811904725e-06, "add_observations_from_episodes_to_batch": 2.816042005566105e-06, "batch_individual_items": 1.251617168570172e-05, "numpy_to_tensor": 1.2443954783771926e-05, "add_time_dim_to_batch_and_zero_pad": 7.1671935919179575e-06}}, "connector_pipeline_timer": 6.035864053355898e-05}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.90038570284056e-06, "listify_data_for_vector_env": 1.0420742996911505e-05, "remove_single_ts_time_rank_from_batch": 1.174590799935186e-05, "un_batch_to_individual_items": 6.593026705733037e-06, "get_actions": 3.972843697833282e-05, "tensor_to_numpy": 1.5479609084867797e-05}}, "connector_pipeline_timer": 0.00011882708843349911}, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "num_episodes": 250.0, "episode_len_max": 20, "rlmodule_inference_timer": 3.2366969051518806e-05, "episode_len_min": 20, "time_between_sampling": 0.035322396384107384, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 4.0218917825839114e-05, "agent_episode_returns_mean": {"default_agent": -0.09999999999999998}, "num_episodes_lifetime": -246500.0, "episode_return_mean": -0.09999999999999998, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.005686724827912964, "env_step_timer": 1.393426716554829e-05, "episode_len_mean": 20.0, "episode_return_max": 9.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.005316920292098076, "module_episode_returns_mean": {"default_policy": -0.09999999999999998}, "num_env_steps_sampled_lifetime": -4930000.0, "weights_seq_no": 9.0, "episode_return_min": -10.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3211.6689195146096}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15535607460314158, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.010724364654984503, "add_observations_from_episodes_to_batch": 0.0008771656927192346, "add_columns_from_episodes_to_train_batch": 0.041936397470621944, "add_time_dim_to_batch_and_zero_pad": 0.09050382341569559, "add_states_from_episodes_to_batch": 0.0035813210101279663, "batch_individual_items": 0.007495172927020532, "numpy_to_tensor": 7.110229136419445e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_env_steps_trained_lifetime": 2160000, "num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 718200, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 51090.73792532306}, "intrinsic_reward_module": {"weights_seq_no": 60.0, "num_module_steps_trained_lifetime": 359100, "module_train_batch_size_mean": 997.532914147147, "num_module_steps_trained": 35910, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 51.0}, "default_policy": {"policy_loss": -7.531487062806264e-05, "num_module_steps_trained_lifetime": 359100, "module_train_batch_size_mean": 997.532914147147, "vf_loss_unclipped": 43.331573486328125, "num_module_steps_trained": 35910, "total_loss": 0.24874107539653778, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 5.264734136289917e-05, "vf_explained_var": 0.0010831952095031738, "diff_num_grad_updates_vs_sampler_policy": 51.0, "entropy": 0.685519814491272, "weights_seq_no": 60.0, "vf_loss": 0.32073089480400085}}}, "IntrinsicAttentionMask": [[[0.1661664992570877, 0.1664157509803772, 0.16729788482189178, 0.16672945022583008, 0.1667785495519638, 0.16661185026168823], [0.1662885546684265, 0.1664770394563675, 0.16714361310005188, 0.16671419143676758, 0.16675129532814026, 0.16662530601024628], [0.16671942174434662, 0.1666930913925171, 0.16660022735595703, 0.16666001081466675, 0.1666548252105713, 0.16667239367961884], [0.16644197702407837, 0.1665540486574173, 0.16694991290569305, 0.16669495403766632, 0.16671699285507202, 0.16664214432239532], [0.16646598279476166, 0.16656607389450073, 0.16691964864730835, 0.16669194400310516, 0.16671162843704224, 0.16664476692676544], [0.1663844734430313, 0.16652518510818481, 0.1670224517583847, 0.16670215129852295, 0.16672983765602112, 0.16663582623004913]], [[0.1666894108057022, 0.16664227843284607, 0.16667194664478302, 0.16677291691303253, 0.16661608219146729, 0.16660736501216888], [0.16672244668006897, 0.16660678386688232, 0.16667957603931427, 0.1669275462627411, 0.16654253005981445, 0.1665211170911789], [0.16670167446136475, 0.1666291356086731, 0.16667477786540985, 0.16683022677898407, 0.16658884286880493, 0.16657540202140808], [0.1666307896375656, 0.16670508682727814, 0.16665831208229065, 0.16649925708770752, 0.16674639284610748, 0.1667601764202118], [0.1667408049106598, 0.16658702492713928, 0.16668379306793213, 0.16701354086399078, 0.16650161147117615, 0.1664731502532959], [0.16674692928791046, 0.1665804535150528, 0.16668520867824554, 0.16704222559928894, 0.16648799180984497, 0.1664571762084961]], [[0.1658594161272049, 0.1667235940694809, 0.16698871552944183, 0.16703788936138153, 0.16647033393383026, 0.16692006587982178], [0.1665426343679428, 0.16667547821998596, 0.1667160987854004, 0.16672363877296448, 0.1666366010904312, 0.16670559346675873], [0.1667519360780716, 0.1666606217622757, 0.16663271188735962, 0.16662754118442535, 0.16668732464313507, 0.16663993895053864], [0.16679072380065918, 0.16665785014629364, 0.1666172444820404, 0.1666097193956375, 0.1666967123746872, 0.16662774980068207], [0.16634254157543182, 0.16668961942195892, 0.16679587960243225, 0.16681557893753052, 0.16658800840377808, 0.1667683869600296], [0.16669774055480957, 0.1666644662618637, 0.1666542887687683, 0.1666523963212967, 0.1666741967201233, 0.16665692627429962]], [[0.16656717658042908, 0.16676829755306244, 0.16658955812454224, 0.16674144566059113, 0.16666118800640106, 0.16667239367961884], [0.16694273054599762, 0.1663849949836731, 0.1668805181980133, 0.166459321975708, 0.1666816920042038, 0.16665063798427582], [0.16660897433757782, 0.16672557592391968, 0.16662196815013885, 0.1667100191116333, 0.1666634976863861, 0.16666997969150543], [0.16689260303974152, 0.16643613576889038, 0.16684170067310333, 0.16649699211120605, 0.1666790097951889, 0.1666535884141922], [0.166742742061615, 0.16658900678157806, 0.16672560572624207, 0.166609525680542, 0.16667082905769348, 0.1666622757911682], [0.16676364839076996, 0.16656765341758728, 0.16674180328845978, 0.16659380495548248, 0.1666719764471054, 0.16666105389595032]], [[0.1666158139705658, 0.16663531959056854, 0.16674062609672546, 0.1667601466178894, 0.16677966713905334, 0.16646842658519745], [0.16662196815013885, 0.16663911938667297, 0.16673171520233154, 0.16674888134002686, 0.16676604747772217, 0.16649234294891357], [0.1666550487279892, 0.16665950417518616, 0.16668355464935303, 0.16668801009655, 0.16669246554374695, 0.1666213721036911], [0.16666118800640106, 0.1666633039712906, 0.1666746437549591, 0.16667674481868744, 0.16667884588241577, 0.16664530336856842], [0.16666731238365173, 0.16666705906391144, 0.1666657030582428, 0.1666654497385025, 0.1666651964187622, 0.16666920483112335], [0.16656938195228577, 0.16660666465759277, 0.16680802404880524, 0.16684535145759583, 0.1668827086687088, 0.16628777980804443]], [[0.16659916937351227, 0.16650016605854034, 0.166793093085289, 0.166774719953537, 0.1666755974292755, 0.1666572391986847], [0.16655246913433075, 0.16638503968715668, 0.1668805629014969, 0.16684946417808533, 0.16668175160884857, 0.1666506826877594], [0.16669052839279175, 0.16672557592391968, 0.16662196815013885, 0.16662845015525818, 0.1666634976863861, 0.16666997969150543], [0.16668187081813812, 0.1667042225599289, 0.16663816571235657, 0.16664230823516846, 0.16666464507579803, 0.16666877269744873], [0.16663521528244019, 0.16658902168273926, 0.16672562062740326, 0.1667170524597168, 0.16667084395885468, 0.1666622906923294], [0.16662657260894775, 0.16656768321990967, 0.16674183309078217, 0.16673091053962708, 0.1666719913482666, 0.1666610836982727]]], "default_policy": {"num_module_steps_trained_lifetime": 59850, "module_train_batch_size_mean": 998.3173215714437, "vf_loss_unclipped": 43.43719482421875, "num_module_steps_trained": 5985, "num_trainable_parameters": 16595, "total_loss": 0.2485598921775818, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 5.281122139422223e-05, "weights_seq_no": 10.0, "vf_loss": 0.32051077485084534, "curr_kl_coeff": 0.00015779680688865483, "vf_explained_var": 0.00011307001113891602, "policy_loss": -7.649439066881314e-05, "entropy": 0.6855180859565735, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 650.147974395983}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 59850, "module_train_batch_size_mean": 998.3173215714437, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5985, "num_trainable_parameters": 8266, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 10.0, "num_module_steps_trained_lifetime_throughput": 650.156110347303}, "__all_modules__": {"num_env_steps_trained_lifetime": 360000, "num_env_steps_trained": 36000, "num_module_steps_trained_lifetime": 119700, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3914.4055433231006, "num_module_steps_trained_throughput": 23846175.014445923, "num_module_steps_trained_lifetime_throughput": 12589729.649067711}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 0.05, "sample": 0.12263699032559712, "env_step_timer": 1.678379736639141e-05, "episode_return_max": 13.5, "episode_return_min": -14.5, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.2195440865595668e-06, "numpy_to_tensor": 1.3747097117956888e-05, "add_time_dim_to_batch_and_zero_pad": 8.097806209833594e-06, "add_states_from_episodes_to_batch": 2.9749306030878918e-06, "batch_individual_items": 1.3774472575021657e-05}}, "connector_pipeline_timer": 6.618259743107065e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes_lifetime": 200, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 50400, "episode_duration_sec_mean": 0.005284835420316086, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.802447971951981e-06, "get_actions": 4.270068868044902e-05, "tensor_to_numpy": 1.7276354056110543e-05, "normalize_and_clip_actions": 8.921541446684835e-06, "remove_single_ts_time_rank_from_batch": 1.3430802203804974e-05, "listify_data_for_vector_env": 1.1174458772990509e-05}}, "connector_pipeline_timer": 0.0001290590713416083}, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "episode_len_max": 20, "weights_seq_no": 10.0, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "num_episodes": 20, "rlmodule_inference_timer": 3.729988632474485e-05, "num_env_steps_sampled": 400, "env_reset_timer": 0.0005448825986597621, "module_episode_returns_mean": {"default_policy": 0.05}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": 0.05}, "time_between_sampling": 10.315123872926346}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "b1762_00000", "date": "2025-08-11_18-25-33", "timestamp": 1754929533, "time_this_iter_s": 11.06685996055603, "time_total_s": 109.36072826385498, "pid": 10959, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 109.36072826385498, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 45.86875, "ram_util_percent": 78.625}}
{"timers": {"training_iteration": 11.934684872670113, "restore_env_runners": 8.22521022620727e-06, "training_step": 11.934451300928641, "env_runner_sampling_timer": 2.221123816835965, "learner_update_timer": 9.514837353202186, "synch_weights": 0.0018899446965159345, "restore_eval_env_runners": 6.053148105860401e-05, "evaluation_iteration": 0.13501639524744244, "synch_eval_env_connectors": 0.0002123721704900157, "synch_env_connectors": 7.507847830402523e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.875187324134146e-06, "add_observations_from_episodes_to_batch": 2.9637690528680096e-06, "batch_individual_items": 1.3181631105861682e-05, "numpy_to_tensor": 3.885318024309815e-05, "add_time_dim_to_batch_and_zero_pad": 7.607460463046031e-06}}, "connector_pipeline_timer": 8.900584203209247e-05}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.304320665981467e-06, "listify_data_for_vector_env": 1.093654470682564e-05, "remove_single_ts_time_rank_from_batch": 1.2226811228428207e-05, "un_batch_to_individual_items": 6.9277955484680165e-06, "get_actions": 4.285109686668501e-05, "tensor_to_numpy": 1.6333448275429297e-05}}, "connector_pipeline_timer": 0.00012565910130462622}, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "num_episodes": 250.0, "episode_len_max": 20, "rlmodule_inference_timer": 3.4530339781056776e-05, "episode_len_min": 20, "time_between_sampling": 0.038107876930375574, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 4.429018738410108e-05, "agent_episode_returns_mean": {"default_agent": 2.2199999999999998}, "num_episodes_lifetime": -277375.0, "episode_return_mean": 2.2199999999999998, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.006408429566970159, "env_step_timer": 1.4853172943905138e-05, "episode_len_mean": 20.0, "episode_return_max": 9.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.00621815229766071, "module_episode_returns_mean": {"default_policy": 2.2199999999999998}, "num_env_steps_sampled_lifetime": -5547500.0, "weights_seq_no": 10.0, "episode_return_min": -10.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3051.4194136025103}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1554018196868419, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.010707120168698346, "add_observations_from_episodes_to_batch": 0.0008767057055999234, "add_columns_from_episodes_to_train_batch": 0.04197254808547315, "add_time_dim_to_batch_and_zero_pad": 0.09052530643205109, "add_states_from_episodes_to_batch": 0.003582244879525976, "batch_individual_items": 0.007500503697298375, "numpy_to_tensor": 7.107251927235154e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_env_steps_trained_lifetime": 2376000, "num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 790020, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 50172.59226749183}, "intrinsic_reward_module": {"weights_seq_no": 66.0, "num_module_steps_trained_lifetime": 395010, "module_train_batch_size_mean": 997.5206335045569, "num_module_steps_trained": 35910, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 56.0}, "default_policy": {"policy_loss": -0.00023810470884200186, "num_module_steps_trained_lifetime": 395010, "module_train_batch_size_mean": 997.5206335045569, "vf_loss_unclipped": 40.49491500854492, "num_module_steps_trained": 35910, "total_loss": 0.2485329657793045, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 3.867553095915355e-05, "vf_explained_var": 0.0008341073989868164, "diff_num_grad_updates_vs_sampler_policy": 56.0, "entropy": 0.6844587922096252, "weights_seq_no": 66.0, "vf_loss": 0.32067349553108215}}}, "IntrinsicAttentionMask": [[[0.16657502949237823, 0.16659453511238098, 0.16669979691505432, 0.16671931743621826, 0.1667388379573822, 0.16667255759239197], [0.16658607125282288, 0.166603222489357, 0.16669578850269318, 0.1667129546403885, 0.1667301207780838, 0.16667184233665466], [0.16664573550224304, 0.16665019094944, 0.16667424142360687, 0.16667869687080383, 0.1666831523180008, 0.16666802763938904], [0.16665677726268768, 0.1666588932275772, 0.16667023301124573, 0.16667233407497406, 0.1666744351387024, 0.16666729748249054], [0.1666678637266159, 0.1666676104068756, 0.16666625440120697, 0.16666600108146667, 0.16666576266288757, 0.16666661202907562], [0.16663029789924622, 0.16663804650306702, 0.16667981445789337, 0.16668757796287537, 0.16669531166553497, 0.16666901111602783]], [[0.1666894108057022, 0.16675198078155518, 0.16667194664478302, 0.16666319966316223, 0.16661609709262848, 0.16660736501216888], [0.16664548218250275, 0.16658727824687958, 0.16666173934936523, 0.16666987538337708, 0.16671372950077057, 0.1667218655347824], [0.16670165956020355, 0.16679798066616058, 0.16667477786540985, 0.166661337018013, 0.16658882796764374, 0.16657540202140808], [0.16670779883861542, 0.16682098805904388, 0.16667619347572327, 0.1666603982448578, 0.16657519340515137, 0.16655941307544708], [0.16674084961414337, 0.1669451743364334, 0.1666838377714157, 0.16665534675121307, 0.16650165617465973, 0.16647319495677948], [0.16674695909023285, 0.1669681817293167, 0.16668523848056793, 0.16665439307689667, 0.16648802161216736, 0.16645720601081848]], [[0.1667383313179016, 0.1665128469467163, 0.16661807894706726, 0.16663758456707, 0.1669023036956787, 0.1665908396244049], [0.16683818399906158, 0.16629844903945923, 0.1665501892566681, 0.16659687459468842, 0.16723130643367767, 0.1664850115776062], [0.16679157316684723, 0.1663985252380371, 0.1665818989276886, 0.16661590337753296, 0.1670776605606079, 0.166534423828125], [0.166782945394516, 0.16641706228256226, 0.16658776998519897, 0.1666194200515747, 0.16704919934272766, 0.16654357314109802], [0.16666574776172638, 0.16666865348815918, 0.16666729748249054, 0.16666704416275024, 0.16666364669799805, 0.1666676551103592], [0.16680362820625305, 0.166372612118721, 0.1665736883878708, 0.1666109710931778, 0.1671174019575119, 0.16652163863182068]], [[0.16639453172683716, 0.16676834225654602, 0.16643613576889038, 0.16671840846538544, 0.1668308675289154, 0.1668517291545868], [0.16694696247577667, 0.16656190156936646, 0.166904017329216, 0.16661323606967926, 0.16649764776229858, 0.16647623479366302], [0.16645599901676178, 0.1667453646659851, 0.16648820042610168, 0.16670671105384827, 0.16679374873638153, 0.16680988669395447], [0.16687318682670593, 0.16658949851989746, 0.1668415665626526, 0.16662731766700745, 0.1665421426296234, 0.16652636229991913], [0.16703934967517853, 0.16652734577655792, 0.1669822335243225, 0.16659559309482574, 0.16644194722175598, 0.16641350090503693], [0.1670701652765274, 0.16651582717895508, 0.16700834035873413, 0.16658970713615417, 0.16642341017723083, 0.16639260947704315]], [[0.16596169769763947, 0.16682641208171844, 0.16647493839263916, 0.1671409010887146, 0.16657300293445587, 0.16702300310134888], [0.1665583699941635, 0.16669122874736786, 0.16663730144500732, 0.16673940420150757, 0.1666523516178131, 0.16672135889530182], [0.16631603240966797, 0.16674615442752838, 0.1665714532136917, 0.1669023036956787, 0.16662020981311798, 0.16684378683567047], [0.1667749583721161, 0.16664209961891174, 0.1666959971189499, 0.16659396886825562, 0.1666809469461441, 0.16661199927330017], [0.16638366878032684, 0.1667308360338211, 0.1665898561477661, 0.1668568253517151, 0.16662921011447906, 0.16680961847305298], [0.1666937917470932, 0.16666051745414734, 0.16667401790618896, 0.16664846241474152, 0.16667024791240692, 0.16665297746658325]], [[0.16667112708091736, 0.1666240096092224, 0.16665366291999817, 0.16675463318824768, 0.16670748591423035, 0.16658909618854523], [0.1666775792837143, 0.16656194627285004, 0.1666347235441208, 0.16688261926174164, 0.16676685214042664, 0.1664762943983078], [0.16667352616786957, 0.1666010171175003, 0.16664664447307587, 0.1668020635843277, 0.16672949492931366, 0.1665472835302353], [0.16665960848331451, 0.16673390567302704, 0.16668713092803955, 0.16652803122997284, 0.16660228371620178, 0.1667890101671219], [0.16666610538959503, 0.16667187213897705, 0.16666825115680695, 0.16665591299533844, 0.16666166484355927, 0.1666761338710785], [0.16668234765529633, 0.16651594638824463, 0.1666206568479538, 0.16697753965854645, 0.16681084036827087, 0.1663927286863327]]], "default_policy": {"num_module_steps_trained_lifetime": 65835, "module_train_batch_size_mean": 998.2690509307901, "vf_loss_unclipped": 40.462459564208984, "num_module_steps_trained": 5985, "num_trainable_parameters": 16595, "total_loss": 0.24839335680007935, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 4.0023016481427476e-05, "weights_seq_no": 11.0, "vf_loss": 0.3205108642578125, "curr_kl_coeff": 7.889840344432741e-05, "vf_explained_var": -0.00045287609100341797, "policy_loss": -0.0002447935112286359, "entropy": 0.6844395995140076, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 648.8758384055562}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 65835, "module_train_batch_size_mean": 998.2690509307901, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5985, "num_trainable_parameters": 8266, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 11.0, "num_module_steps_trained_lifetime_throughput": 648.8834640037593}, "__all_modules__": {"num_env_steps_trained_lifetime": 396000, "num_env_steps_trained": 36000, "num_module_steps_trained_lifetime": 131670, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3906.605876028494, "num_module_steps_trained_throughput": 23239678.58587203, "num_module_steps_trained_lifetime_throughput": 12568455.63385336}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 0.25, "sample": 0.12255118208262718, "env_step_timer": 1.4036533050550325e-05, "episode_return_max": 13.5, "episode_return_min": -14.5, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.844384432111127e-06, "numpy_to_tensor": 1.1980483885599736e-05, "add_time_dim_to_batch_and_zero_pad": 6.958675662035492e-06, "add_states_from_episodes_to_batch": 2.6691818757835616e-06, "batch_individual_items": 1.2485244355023076e-05}}, "connector_pipeline_timer": 5.899891626842371e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes_lifetime": 220, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 55400, "episode_duration_sec_mean": 0.005279058746527881, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.4808327070492906e-06, "get_actions": 3.5268183610795176e-05, "tensor_to_numpy": 1.48608400970333e-05, "normalize_and_clip_actions": 7.825406616644278e-06, "remove_single_ts_time_rank_from_batch": 1.19174262910524e-05, "listify_data_for_vector_env": 1.0310530764486144e-05}}, "connector_pipeline_timer": 0.00011320093567286132}, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "episode_len_max": 20, "weights_seq_no": 11.0, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "num_episodes": 20, "rlmodule_inference_timer": 3.074617095550091e-05, "num_env_steps_sampled": 400, "env_reset_timer": 0.0005429591825206624, "module_episode_returns_mean": {"default_policy": 0.25}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": 0.25}, "time_between_sampling": 10.332283689616816}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "b1762_00000", "date": "2025-08-11_18-25-45", "timestamp": 1754929545, "time_this_iter_s": 12.125893115997314, "time_total_s": 121.4866213798523, "pid": 10959, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 121.4866213798523, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 48.7235294117647, "ram_util_percent": 79.01764705882353}}
{"timers": {"training_iteration": 11.919576603943067, "restore_env_runners": 8.201288020946584e-06, "training_step": 11.919342768749045, "env_runner_sampling_timer": 2.2162778599177004, "learner_update_timer": 9.504518342590883, "synch_weights": 0.0018903656585972613, "restore_eval_env_runners": 6.036324640966398e-05, "evaluation_iteration": 0.13489334546529208, "synch_eval_env_connectors": 0.0002118926184640271, "synch_env_connectors": 7.476099134882483e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.784968112487479e-06, "add_observations_from_episodes_to_batch": 2.868173125267655e-06, "batch_individual_items": 1.278955591987602e-05, "numpy_to_tensor": 1.2937649225936078e-05, "add_time_dim_to_batch_and_zero_pad": 7.383066966095002e-06}}, "connector_pipeline_timer": 6.178416260430677e-05}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.06059541369553e-06, "listify_data_for_vector_env": 1.0552629899087185e-05, "remove_single_ts_time_rank_from_batch": 1.1862627382802779e-05, "un_batch_to_individual_items": 6.668845252152185e-06, "get_actions": 4.161964052926495e-05, "tensor_to_numpy": 1.577349081343152e-05}}, "connector_pipeline_timer": 0.0001217673190862288}, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "num_episodes": 250.0, "episode_len_max": 20, "rlmodule_inference_timer": 3.324811728984675e-05, "episode_len_min": 20, "time_between_sampling": 0.04211888533604687, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 4.5281033706500856e-05, "agent_episode_returns_mean": {"default_agent": 0.7800000000000001}, "num_episodes_lifetime": -308250.0, "episode_return_mean": 0.7800000000000001, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.005974296390006701, "env_step_timer": 1.4337664461900693e-05, "episode_len_mean": 20.0, "episode_return_max": 9.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.005448870147112753, "module_episode_returns_mean": {"default_policy": 0.7800000000000001}, "num_env_steps_sampled_lifetime": -6165000.0, "weights_seq_no": 11.0, "episode_return_min": -10.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3132.0743341347693}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.155370255660018, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.010689386466823608, "add_observations_from_episodes_to_batch": 0.0008770978184022457, "add_columns_from_episodes_to_train_batch": 0.04197071427440402, "add_time_dim_to_batch_and_zero_pad": 0.09050950211826188, "add_states_from_episodes_to_batch": 0.0035863686813482204, "batch_individual_items": 0.007500214500489963, "numpy_to_tensor": 7.116346374617164e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_env_steps_trained_lifetime": 2592000, "num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 861840, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 49276.09905993642}, "intrinsic_reward_module": {"weights_seq_no": 72.0, "num_module_steps_trained_lifetime": 430920, "module_train_batch_size_mean": 997.512081102731, "num_module_steps_trained": 35910, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 61.0}, "default_policy": {"policy_loss": -0.0005034998175688088, "num_module_steps_trained_lifetime": 430920, "module_train_batch_size_mean": 997.512081102731, "vf_loss_unclipped": 40.59041976928711, "num_module_steps_trained": 35910, "total_loss": 0.24824641644954681, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 4.631829870049842e-05, "vf_explained_var": 0.0009286999702453613, "diff_num_grad_updates_vs_sampler_policy": 61.0, "entropy": 0.6831429600715637, "weights_seq_no": 72.0, "vf_loss": 0.3206422030925751}}}, "IntrinsicAttentionMask": [[[0.16585934162139893, 0.16672353446483612, 0.16637226939201355, 0.16703781485557556, 0.16708700358867645, 0.1669199913740158], [0.16654261946678162, 0.16667546331882477, 0.16662153601646423, 0.16672362387180328, 0.16673116385936737, 0.16670557856559753], [0.1662650853395462, 0.16669507324695587, 0.16652043163776398, 0.16685117781162262, 0.16687560081481934, 0.16679269075393677], [0.16679073870182037, 0.16665786504745483, 0.16671177744865417, 0.1666097342967987, 0.1666022092103958, 0.16662776470184326], [0.16682952642440796, 0.16665507853031158, 0.16672585904598236, 0.16659189760684967, 0.16658201813697815, 0.1666155606508255], [0.16669774055480957, 0.1666644662618637, 0.16667796671390533, 0.1666523963212967, 0.16665051877498627, 0.16665692627429962]], [[0.1666375994682312, 0.1667691469192505, 0.16660088300704956, 0.1668131798505783, 0.166483536362648, 0.16669566929340363], [0.16666428744792938, 0.16667504608631134, 0.16666129231452942, 0.16667863726615906, 0.16665169596672058, 0.16666904091835022], [0.1666301190853119, 0.16679541766643524, 0.16658401489257812, 0.166850745677948, 0.1664365977048874, 0.16670310497283936], [0.1666732132434845, 0.16664355993270874, 0.16668149828910828, 0.16663363575935364, 0.16670797765254974, 0.1666601300239563], [0.16660621762275696, 0.16687941551208496, 0.16653001308441162, 0.16697092354297638, 0.16628654301166534, 0.16672681272029877], [0.16664938628673553, 0.16672758758068085, 0.16662757098674774, 0.16675375401973724, 0.16655777394771576, 0.16668391227722168]], [[0.16606415808200836, 0.16692940890789032, 0.16657771170139313, 0.16662676632404327, 0.16667583584785461, 0.1671261191368103], [0.1665741205215454, 0.16670699417591095, 0.16665305197238922, 0.1666605919599533, 0.1666681170463562, 0.1667371243238449], [0.16636700928211212, 0.16679726541042328, 0.16662251949310303, 0.16664689779281616, 0.1666712760925293, 0.16689492762088776], [0.16639593243598938, 0.16678468883037567, 0.16662681102752686, 0.16664883494377136, 0.16667087376117706, 0.16687291860580444], [0.16642482578754425, 0.16677208244800568, 0.1666310578584671, 0.16665074229240417, 0.16667042672634125, 0.16685087978839874], [0.16668984293937683, 0.16665656864643097, 0.1666700690984726, 0.16666817665100098, 0.16666629910469055, 0.16664902865886688]], [[0.16671447455883026, 0.16661539673805237, 0.16667775809764862, 0.1666593998670578, 0.1665603369474411, 0.16677258908748627], [0.1667475700378418, 0.1665799468755722, 0.16668541729450226, 0.16665436327457428, 0.16648682951927185, 0.16684590280056], [0.1667267382144928, 0.1666022539138794, 0.16668060421943665, 0.16665752232074738, 0.16653309762477875, 0.16679975390434265], [0.16673287749290466, 0.1665956974029541, 0.16668201982975006, 0.16665659844875336, 0.16651947796344757, 0.16681334376335144], [0.16676592826843262, 0.16656021773815155, 0.1666896641254425, 0.16665154695510864, 0.16644595563411713, 0.16688664257526398], [0.16669508814811707, 0.16663619875907898, 0.16667325794696808, 0.166662335395813, 0.1666034609079361, 0.1667296290397644]], [[0.16606387495994568, 0.16631297767162323, 0.16719457507133484, 0.1666264832019806, 0.16729305684566498, 0.16650895774364471], [0.16621097922325134, 0.16639938950538635, 0.16706565022468567, 0.1666364222764969, 0.16714002192020416, 0.16654758155345917], [0.16673025488853455, 0.16670392453670502, 0.16661104559898376, 0.16667082905769348, 0.16660071909427643, 0.16668322682380676], [0.1663958728313446, 0.16650791466236115, 0.16690367460250854, 0.1666487753391266, 0.16694781184196472, 0.16659599542617798], [0.16678813099861145, 0.16673780977725983, 0.16656044125556946, 0.16667459905147552, 0.1665406972169876, 0.16669827699661255], [0.1663265824317932, 0.16646724939346313, 0.1669643372297287, 0.1666441559791565, 0.1670197993516922, 0.16657784581184387]], [[0.16659916937351227, 0.16650016605854034, 0.166793093085289, 0.166774719953537, 0.1666755974292755, 0.1666572391986847], [0.16655246913433075, 0.16638503968715668, 0.1668805629014969, 0.16684946417808533, 0.16668175160884857, 0.1666506826877594], [0.16669052839279175, 0.16672557592391968, 0.16662196815013885, 0.16662845015525818, 0.1666634976863861, 0.16666997969150543], [0.16668187081813812, 0.1667042225599289, 0.16663816571235657, 0.16664230823516846, 0.16666464507579803, 0.16666877269744873], [0.16663521528244019, 0.16658902168273926, 0.16672562062740326, 0.1667170524597168, 0.16667084395885468, 0.1666622906923294], [0.16662657260894775, 0.16656768321990967, 0.16674183309078217, 0.16673091053962708, 0.1666719913482666, 0.1666610836982727]]], "default_policy": {"num_module_steps_trained_lifetime": 71820, "module_train_batch_size_mean": 998.2236050808158, "vf_loss_unclipped": 40.568092346191406, "num_module_steps_trained": 5985, "num_trainable_parameters": 16595, "total_loss": 0.24811622500419617, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 4.984444967703894e-05, "weights_seq_no": 12.0, "vf_loss": 0.3205104470252991, "curr_kl_coeff": 3.944920172216371e-05, "vf_explained_var": -0.00030410289764404297, "policy_loss": -0.0005236708093434572, "entropy": 0.6830929517745972, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 647.9646957473578}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 71820, "module_train_batch_size_mean": 998.2236050808158, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5985, "num_trainable_parameters": 8266, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 12.0, "num_module_steps_trained_lifetime_throughput": 647.9718336514105}, "__all_modules__": {"num_env_steps_trained_lifetime": 432000, "num_env_steps_trained": 36000, "num_module_steps_trained_lifetime": 143640, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3900.984046292391, "num_module_steps_trained_throughput": 22676180.616603076, "num_module_steps_trained_lifetime_throughput": 12558585.681586204}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 0.45, "sample": 0.12255058901145, "env_step_timer": 1.4662648036287875e-05, "episode_return_max": 13.5, "episode_return_min": -14.5, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8682855371687295e-06, "numpy_to_tensor": 1.2332122314722978e-05, "add_time_dim_to_batch_and_zero_pad": 7.159896995661883e-06, "add_states_from_episodes_to_batch": 2.706228472635517e-06, "batch_individual_items": 1.282413969894644e-05}}, "connector_pipeline_timer": 6.0361163869776615e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes_lifetime": 240, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 60400, "episode_duration_sec_mean": 0.0053658766602166, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.654849075665476e-06, "get_actions": 3.7167269863425075e-05, "tensor_to_numpy": 1.5367613686362822e-05, "normalize_and_clip_actions": 8.035758413674998e-06, "remove_single_ts_time_rank_from_batch": 1.2126826950603659e-05, "listify_data_for_vector_env": 1.04292672696093e-05}}, "connector_pipeline_timer": 0.0001161651843033397}, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "episode_len_max": 20, "weights_seq_no": 12.0, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "num_episodes": 20, "rlmodule_inference_timer": 3.126704643317137e-05, "num_env_steps_sampled": 400, "env_reset_timer": 0.0005411620909975024, "module_episode_returns_mean": {"default_policy": 0.45}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": 0.45}, "time_between_sampling": 10.333575711881148}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "b1762_00000", "date": "2025-08-11_18-25-56", "timestamp": 1754929556, "time_this_iter_s": 10.559043884277344, "time_total_s": 132.04566526412964, "pid": 10959, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 132.04566526412964, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 40.30666666666666, "ram_util_percent": 77.47999999999999}}
{"timers": {"training_iteration": 11.916217794153187, "restore_env_runners": 8.17510560077888e-06, "training_step": 11.915983802311898, "env_runner_sampling_timer": 2.221899042148944, "learner_update_timer": 9.4935123866653, "synch_weights": 0.0018908957518509522, "restore_eval_env_runners": 6.02096138796297e-05, "evaluation_iteration": 0.13486163535021356, "synch_eval_env_connectors": 0.00021183619226821095, "synch_env_connectors": 7.515498500576804e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.7895274752585243e-06, "add_observations_from_episodes_to_batch": 4.540556053646084e-06, "batch_individual_items": 1.9849787894506632e-05, "numpy_to_tensor": 2.3662294370937865e-05, "add_time_dim_to_batch_and_zero_pad": 1.143908505961816e-05}}, "connector_pipeline_timer": 9.562702990335869e-05}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.1995151702078374e-05, "listify_data_for_vector_env": 1.650674046184998e-05, "remove_single_ts_time_rank_from_batch": 1.595885667140086e-05, "un_batch_to_individual_items": 9.44469900709784e-06, "get_actions": 7.563170798871147e-05, "tensor_to_numpy": 2.6469255843151047e-05}}, "connector_pipeline_timer": 0.00020322315937954788}, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "num_episodes": 250.0, "episode_len_max": 20, "rlmodule_inference_timer": 6.0521099298502586e-05, "episode_len_min": 20, "time_between_sampling": 0.03682943721621111, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 5.404565014184035e-05, "agent_episode_returns_mean": {"default_agent": 0.38000000000000006}, "num_episodes_lifetime": -339125.0, "episode_return_mean": 0.38000000000000006, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.007143271038739829, "env_step_timer": 2.5921798590274765e-05, "episode_len_mean": 20.0, "episode_return_max": 9.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.009165771208703518, "module_episode_returns_mean": {"default_policy": 0.38000000000000006}, "num_env_steps_sampled_lifetime": -6782500.0, "weights_seq_no": 12.0, "episode_return_min": -10.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 2661.076858534194}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15689821477342092, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.010829595511643975, "add_observations_from_episodes_to_batch": 0.0008917422606554548, "add_columns_from_episodes_to_train_batch": 0.04231866213175058, "add_time_dim_to_batch_and_zero_pad": 0.09152347876793372, "add_states_from_episodes_to_batch": 0.0035882304156691206, "batch_individual_items": 0.00750858193558256, "numpy_to_tensor": 7.156266876619542e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_env_steps_trained_lifetime": 2808000, "num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 933660, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 48422.68590036605}, "intrinsic_reward_module": {"weights_seq_no": 78.0, "num_module_steps_trained_lifetime": 466830, "module_train_batch_size_mean": 997.5061250970534, "num_module_steps_trained": 35910, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 66.0}, "default_policy": {"policy_loss": -0.00010595542698865756, "num_module_steps_trained_lifetime": 466830, "module_train_batch_size_mean": 997.5061250970534, "vf_loss_unclipped": 42.42156982421875, "num_module_steps_trained": 35910, "total_loss": 0.248627170920372, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 1.078891637007473e-05, "vf_explained_var": 0.0011286735534667969, "diff_num_grad_updates_vs_sampler_policy": 66.0, "entropy": 0.6824996471405029, "weights_seq_no": 78.0, "vf_loss": 0.3206266760826111}}}, "IntrinsicAttentionMask": [[[0.16596165299415588, 0.16682636737823486, 0.16709165275096893, 0.16714085638523102, 0.1665729582309723, 0.16640646755695343], [0.1665583699941635, 0.16669122874736786, 0.16673186421394348, 0.16673940420150757, 0.1666523516178131, 0.16662678122520447], [0.16674108803272247, 0.16664978861808777, 0.1666218787431717, 0.16661670804023743, 0.16667649149894714, 0.1666940599679947], [0.1667749583721161, 0.16664209961891174, 0.1666014939546585, 0.16659396886825562, 0.1666809469461441, 0.16670651733875275], [0.16638366878032684, 0.1667308360338211, 0.16683712601661682, 0.1668568253517151, 0.16662921011447906, 0.16656237840652466], [0.16626881062984467, 0.16675685346126556, 0.16690634191036224, 0.1669340580701828, 0.16661392152309418, 0.16651998460292816]], [[0.16663755476474762, 0.1667691171169281, 0.16683152318000793, 0.16681315004825592, 0.16648349165916443, 0.166465163230896], [0.16666430234909058, 0.16667504608631134, 0.16668014228343964, 0.16667863726615906, 0.16665169596672058, 0.1666502058506012], [0.16667692363262177, 0.16663043200969696, 0.16660837829113007, 0.1666148602962494, 0.16673146188259125, 0.16673795878887177], [0.1666731983423233, 0.16664354503154755, 0.16662949323654175, 0.16663363575935364, 0.16670796275138855, 0.16671210527420044], [0.1666060835123062, 0.1668792963027954, 0.16700899600982666, 0.16697080433368683, 0.1662864238023758, 0.1662483960390091], [0.16660232841968536, 0.166892409324646, 0.16703012585639954, 0.16698956489562988, 0.16626295447349548, 0.16622258722782135]], [[0.1658594161272049, 0.1667235940694809, 0.16698871552944183, 0.16703788936138153, 0.16647033393383026, 0.16692006587982178], [0.1665426343679428, 0.16667547821998596, 0.1667160987854004, 0.16672363877296448, 0.1666366010904312, 0.16670559346675873], [0.1667519360780716, 0.1666606217622757, 0.16663271188735962, 0.16662754118442535, 0.16668732464313507, 0.16663993895053864], [0.16679072380065918, 0.16665785014629364, 0.1666172444820404, 0.1666097193956375, 0.1666967123746872, 0.16662774980068207], [0.16634254157543182, 0.16668961942195892, 0.16679587960243225, 0.16681557893753052, 0.16658800840377808, 0.1667683869600296], [0.16669774055480957, 0.1666644662618637, 0.1666542887687683, 0.1666523963212967, 0.1666741967201233, 0.16665692627429962]], [[0.16670767962932587, 0.16666054725646973, 0.16669021546840668, 0.16668148338794708, 0.16663435101509094, 0.16662561893463135], [0.16676737368106842, 0.1666516810655594, 0.16672448813915253, 0.16670304536819458, 0.16658739745616913, 0.16656598448753357], [0.16672982275485992, 0.16665728390216827, 0.16670292615890503, 0.16668950021266937, 0.16661697626113892, 0.16660353541374207], [0.16674087941646576, 0.16665562987327576, 0.1667092889547348, 0.16669347882270813, 0.1666082739830017, 0.16659247875213623], [0.16680055856704712, 0.16664673388004303, 0.16674353182315826, 0.16671502590179443, 0.1665612906217575, 0.16653281450271606], [0.16681161522865295, 0.1666450798511505, 0.16674987971782684, 0.16671901941299438, 0.1665525734424591, 0.16652175784111023]], [[0.16606387495994568, 0.16631297767162323, 0.16719457507133484, 0.1666264832019806, 0.16729305684566498, 0.16650895774364471], [0.16621097922325134, 0.16639938950538635, 0.16706565022468567, 0.1666364222764969, 0.16714002192020416, 0.16654758155345917], [0.16673025488853455, 0.16670392453670502, 0.16661104559898376, 0.16667082905769348, 0.16660071909427643, 0.16668322682380676], [0.1663958728313446, 0.16650791466236115, 0.16690367460250854, 0.1666487753391266, 0.16694781184196472, 0.16659599542617798], [0.16678813099861145, 0.16673780977725983, 0.16656044125556946, 0.16667459905147552, 0.1665406972169876, 0.16669827699661255], [0.1663265824317932, 0.16646724939346313, 0.1669643372297287, 0.1666441559791565, 0.1670197993516922, 0.16657784581184387]], [[0.16652029752731323, 0.16672135889530182, 0.16668331623077393, 0.1666945219039917, 0.16675497591495514, 0.1666254848241806], [0.16707304120063782, 0.16651487350463867, 0.16662029922008514, 0.16658926010131836, 0.1664218008518219, 0.1667807251214981], [0.16696839034557343, 0.16655394434928894, 0.1666322648525238, 0.16660919785499573, 0.1664848029613495, 0.16675138473510742], [0.1669992059469223, 0.16654245555400848, 0.16662874817848206, 0.16660334169864655, 0.16646626591682434, 0.16676002740859985], [0.16716551780700684, 0.16648034751415253, 0.1666097342967987, 0.16657161712646484, 0.16636614501476288, 0.16680662333965302], [0.16680939495563507, 0.16661334037780762, 0.1666504144668579, 0.166639506816864, 0.16658061742782593, 0.16670677065849304]]], "default_policy": {"num_module_steps_trained_lifetime": 77805, "module_train_batch_size_mean": 998.1808187151925, "vf_loss_unclipped": 42.47852325439453, "num_module_steps_trained": 5985, "num_trainable_parameters": 16595, "total_loss": 0.2485317885875702, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 1.1368878404027782e-05, "weights_seq_no": 13.0, "vf_loss": 0.3205106258392334, "curr_kl_coeff": 1.9724600861081854e-05, "vf_explained_var": 0.00017195940017700195, "policy_loss": -0.00010917709732893854, "entropy": 0.6824817657470703, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 647.324621594112}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 77805, "module_train_batch_size_mean": 998.1808187151925, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5985, "num_trainable_parameters": 8266, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 13.0, "num_module_steps_trained_lifetime_throughput": 647.3313145524104}, "__all_modules__": {"num_env_steps_trained_lifetime": 468000, "num_env_steps_trained": 36000, "num_module_steps_trained_lifetime": 155610, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3897.0011041509542, "num_module_steps_trained_throughput": 22136597.134617414, "num_module_steps_trained_lifetime_throughput": 12540626.868713014}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 0.65, "sample": 0.12278711104197837, "env_step_timer": 2.18438438617508e-05, "episode_return_max": 13.5, "episode_return_min": -14.5, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.5531536614988436e-06, "numpy_to_tensor": 1.7097376683913972e-05, "add_time_dim_to_batch_and_zero_pad": 9.212888301280244e-06, "add_states_from_episodes_to_batch": 3.431040845188306e-06, "batch_individual_items": 1.5249346005833473e-05}}, "connector_pipeline_timer": 7.448253007967992e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes_lifetime": 260, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 65400, "episode_duration_sec_mean": 0.005669746231287718, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 7.5802644318393575e-06, "get_actions": 5.072355252028276e-05, "tensor_to_numpy": 2.0802731956085025e-05, "normalize_and_clip_actions": 1.0362930045306995e-05, "remove_single_ts_time_rank_from_batch": 1.4219262006439248e-05, "listify_data_for_vector_env": 1.3105845840388286e-05}}, "connector_pipeline_timer": 0.00014826017173107358}, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "episode_len_max": 20, "weights_seq_no": 13.0, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "num_episodes": 20, "rlmodule_inference_timer": 4.334045686585364e-05, "num_env_steps_sampled": 400, "env_reset_timer": 0.0005394175503967694, "module_episode_returns_mean": {"default_policy": 0.65}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": 0.65}, "time_between_sampling": 10.346399402262586}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "b1762_00000", "date": "2025-08-11_18-26-07", "timestamp": 1754929567, "time_this_iter_s": 11.748163223266602, "time_total_s": 143.79382848739624, "pid": 10959, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 143.79382848739624, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 46.21764705882353, "ram_util_percent": 78.84705882352942}}
{"timers": {"training_iteration": 11.907069846211742, "restore_env_runners": 8.164183954877034e-06, "training_step": 11.906835123458732, "env_runner_sampling_timer": 2.217675209647977, "learner_update_timer": 9.488557051139507, "synch_weights": 0.0018886130443312506, "restore_eval_env_runners": 5.997834710698092e-05, "evaluation_iteration": 0.1351173373372532, "synch_eval_env_connectors": 0.00021137740992059064, "synch_env_connectors": 7.514514045413413e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.8586770323144758e-06, "add_observations_from_episodes_to_batch": 2.999702382088783e-06, "batch_individual_items": 1.3157089732769246e-05, "numpy_to_tensor": 1.3624347975791682e-05, "add_time_dim_to_batch_and_zero_pad": 7.585026608231586e-06}}, "connector_pipeline_timer": 6.370632574422329e-05}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.363819729785362e-06, "listify_data_for_vector_env": 1.0932214178712146e-05, "remove_single_ts_time_rank_from_batch": 1.2212837788455807e-05, "un_batch_to_individual_items": 6.893543364366058e-06, "get_actions": 4.435802397373395e-05, "tensor_to_numpy": 1.657987486609166e-05}}, "connector_pipeline_timer": 0.00012753961464288805}, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "num_episodes": 250.0, "episode_len_max": 20, "rlmodule_inference_timer": 3.4947475146476474e-05, "episode_len_min": 20, "time_between_sampling": 0.03719104385296705, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 6.017776054322345e-05, "agent_episode_returns_mean": {"default_agent": 0.9399999999999996}, "num_episodes_lifetime": -370000.0, "episode_return_mean": 0.9399999999999996, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.008424957445078277, "env_step_timer": 1.5134728606791785e-05, "episode_len_mean": 20.0, "episode_return_max": 9.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.005596235496457668, "module_episode_returns_mean": {"default_policy": 0.9399999999999996}, "num_env_steps_sampled_lifetime": -7400000.0, "weights_seq_no": 13.0, "episode_return_min": -10.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 2939.9433652349117}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15685462803465794, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.010811901226617644, "add_observations_from_episodes_to_batch": 0.0008921502478226375, "add_columns_from_episodes_to_train_batch": 0.04231214175994484, "add_time_dim_to_batch_and_zero_pad": 0.09150415355995797, "add_states_from_episodes_to_batch": 0.0035895443609806816, "batch_individual_items": 0.007507604455840038, "numpy_to_tensor": 7.14924614284274e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_env_steps_trained_lifetime": 3024000, "num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 1005480, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 47601.140928318266}, "intrinsic_reward_module": {"weights_seq_no": 84.0, "num_module_steps_trained_lifetime": 502740, "module_train_batch_size_mean": 997.501977255973, "num_module_steps_trained": 35910, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 71.0}, "default_policy": {"policy_loss": -0.0009952698601409793, "num_module_steps_trained_lifetime": 502740, "module_train_batch_size_mean": 997.501977255973, "vf_loss_unclipped": 41.09380340576172, "num_module_steps_trained": 35910, "total_loss": 0.24773380160331726, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 9.998375753639266e-05, "vf_explained_var": 0.0010151863098144531, "diff_num_grad_updates_vs_sampler_policy": 71.0, "entropy": 0.6802639365196228, "weights_seq_no": 84.0, "vf_loss": 0.3205985426902771}}}, "IntrinsicAttentionMask": [[[0.16665664315223694, 0.16643126308918, 0.166781485080719, 0.16680100560188293, 0.16657543182373047, 0.16675421595573425], [0.1666424721479416, 0.16610337793827057, 0.16694152355194092, 0.1669883280992508, 0.16644811630249023, 0.1668761968612671], [0.16666439175605774, 0.1666128933429718, 0.16669289767742157, 0.16669735312461853, 0.1666458398103714, 0.16668666899204254], [0.16666559875011444, 0.16664129495620728, 0.1666790395975113, 0.16668114066123962, 0.16665683686733246, 0.1666761040687561], [0.16665156185626984, 0.16631311178207397, 0.1668391227722168, 0.16686846315860748, 0.166529580950737, 0.1667981594800949], [0.16666270792484283, 0.16657324135303497, 0.16671225428581238, 0.16671998798847198, 0.16663047671318054, 0.16670142114162445]], [[0.1666375994682312, 0.1665385663509369, 0.16683156788349152, 0.16658253967761993, 0.16671405732631683, 0.16669568419456482], [0.16661745309829712, 0.16644996404647827, 0.166945680975914, 0.16652432084083557, 0.16674678027629852, 0.16671571135520935], [0.16667692363262177, 0.1667119711637497, 0.16660836338996887, 0.16669641435146332, 0.16664989292621613, 0.16665638983249664], [0.16662642359733582, 0.16648933291435242, 0.16689501702785492, 0.16655020415782928, 0.16673226654529572, 0.16670683026313782], [0.166653111577034, 0.16660691797733307, 0.16674353182315826, 0.1666274219751358, 0.16668875515460968, 0.16668018698692322], [0.16664940118789673, 0.16659051179885864, 0.16676469147205353, 0.16661666333675385, 0.16669484972953796, 0.16668392717838287]], [[0.16606396436691284, 0.1663130521774292, 0.1665775030851364, 0.16724388301372528, 0.1666756272315979, 0.16712592542171478], [0.16621102392673492, 0.16639943420886993, 0.16659939289093018, 0.1671028733253479, 0.16667355597019196, 0.16701377928256989], [0.16636696457862854, 0.16649094223976135, 0.16662247478961945, 0.1669534146785736, 0.16667123138904572, 0.16689488291740417], [0.166759192943573, 0.16672086715698242, 0.166680246591568, 0.16657821834087372, 0.1666651964187622, 0.16659624874591827], [0.16642479598522186, 0.16652487218379974, 0.16663102805614471, 0.16689807176589966, 0.16667039692401886, 0.16685084998607635], [0.16668984293937683, 0.166680246591568, 0.1666700690984726, 0.16664451360702515, 0.16666629910469055, 0.16664902865886688]], [[0.1666894108057022, 0.16664229333400726, 0.16678166389465332, 0.16666321456432343, 0.16661609709262848, 0.16660736501216888], [0.16672244668006897, 0.16660678386688232, 0.16694900393486023, 0.16665813326835632, 0.16654251515865326, 0.1665211021900177], [0.16662463545799255, 0.16671162843704224, 0.1664545238018036, 0.1666729897260666, 0.16676001250743866, 0.1667761504650116], [0.16670775413513184, 0.16662253439426422, 0.16687466204166412, 0.1666603833436966, 0.16657517850399017, 0.1665593981742859], [0.1667407900094986, 0.16658702492713928, 0.1670420914888382, 0.1666552871465683, 0.16650161147117615, 0.1664731502532959], [0.16674691438674927, 0.1665804535150528, 0.16707314550876617, 0.16665436327457428, 0.16648799180984497, 0.1664571762084961]], [[0.16669748723506927, 0.16647206246852875, 0.16682235896587372, 0.16659677028656006, 0.1666162610054016, 0.16679508984088898], [0.1667403280735016, 0.1662009209394455, 0.16703955829143524, 0.16649918258190155, 0.16654585301876068, 0.16697418689727783], [0.1666737198829651, 0.16662220656871796, 0.16670222580432892, 0.1666507124900818, 0.16665516793727875, 0.16669601202011108], [0.16671663522720337, 0.16635090112686157, 0.16691935062408447, 0.16655316948890686, 0.1665848195552826, 0.16687507927417755], [0.1667129248380661, 0.1663743555545807, 0.16690056025981903, 0.16656160354614258, 0.16659091413021088, 0.16685956716537476], [0.16667889058589935, 0.1665894240140915, 0.1667284369468689, 0.16663892567157745, 0.16664667427539825, 0.16671761870384216]], [[0.1664380580186844, 0.16655035316944122, 0.1664796620607376, 0.16676200926303864, 0.16687451303005219, 0.16689537465572357], [0.16657745838165283, 0.16662129759788513, 0.16659371554851532, 0.16670390963554382, 0.1667477786540985, 0.16675591468811035], [0.16648972034454346, 0.16657665371894836, 0.16652193665504456, 0.16674049198627472, 0.16682754456996918, 0.16684368252754211], [0.1668400913476944, 0.1667547971010208, 0.16680847108364105, 0.16659428179264069, 0.16650910675525665, 0.16649332642555237], [0.16697958111763, 0.16682560741901398, 0.16692249476909637, 0.16653597354888916, 0.16638240218162537, 0.1663539558649063], [0.16700543463230133, 0.16683870553970337, 0.16694362461566925, 0.16652517020702362, 0.16635891795158386, 0.16632813215255737]]], "default_policy": {"num_module_steps_trained_lifetime": 83790, "module_train_batch_size_mean": 998.1405362012929, "vf_loss_unclipped": 41.09101486206055, "num_module_steps_trained": 5985, "num_trainable_parameters": 16595, "total_loss": 0.2476092278957367, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.0001084161049220711, "weights_seq_no": 14.0, "vf_loss": 0.3205108940601349, "curr_kl_coeff": 9.862300430540927e-06, "vf_explained_var": 1.1563301086425781e-05, "policy_loss": -0.0010355273261666298, "entropy": 0.6801707744598389, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 646.4694714216109}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 83790, "module_train_batch_size_mean": 998.1405362012929, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5985, "num_trainable_parameters": 8266, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 14.0, "num_module_steps_trained_lifetime_throughput": 646.4757269935446}, "__all_modules__": {"num_env_steps_trained_lifetime": 504000, "num_env_steps_trained": 36000, "num_module_steps_trained_lifetime": 167580, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3891.7342611557997, "num_module_steps_trained_throughput": 21609041.528038394, "num_module_steps_trained_lifetime_throughput": 12510180.557702871}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 0.85, "sample": 0.12273733410231336, "env_step_timer": 1.4355811077192112e-05, "episode_return_max": 13.5, "episode_return_min": -14.5, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9261504980404296e-06, "numpy_to_tensor": 1.2402185016573118e-05, "add_time_dim_to_batch_and_zero_pad": 7.057805194005788e-06, "add_states_from_episodes_to_batch": 2.808511536966049e-06, "batch_individual_items": 1.267680895113047e-05}}, "connector_pipeline_timer": 6.050322856084161e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes_lifetime": 280, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 70400, "episode_duration_sec_mean": 0.0056979762145783755, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.5818421096484135e-06, "get_actions": 3.665767567203037e-05, "tensor_to_numpy": 1.539964495923015e-05, "normalize_and_clip_actions": 7.967623675388825e-06, "remove_single_ts_time_rank_from_batch": 1.2330387900027503e-05, "listify_data_for_vector_env": 1.0456677877622436e-05}}, "connector_pipeline_timer": 0.00011607894909769357}, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "episode_len_max": 20, "weights_seq_no": 14.0, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "num_episodes": 20, "rlmodule_inference_timer": 3.172941589388397e-05, "num_env_steps_sampled": 400, "env_reset_timer": 0.0005372883741427517, "module_episode_returns_mean": {"default_policy": 0.85}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": 0.85}, "time_between_sampling": 10.353395899489065}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "b1762_00000", "date": "2025-08-11_18-26-19", "timestamp": 1754929579, "time_this_iter_s": 11.130990028381348, "time_total_s": 154.9248185157776, "pid": 10959, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 154.9248185157776, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 47.65625, "ram_util_percent": 80.125}}
{"timers": {"training_iteration": 11.900619947329515, "restore_env_runners": 8.20087246919925e-06, "training_step": 11.900384413474981, "env_runner_sampling_timer": 2.215654393381468, "learner_update_timer": 9.48218219312854, "synch_weights": 0.0018902573239988887, "restore_eval_env_runners": 5.976481337558782e-05, "evaluation_iteration": 0.13503013813314987, "synch_eval_env_connectors": 0.00021097738577399903, "synch_env_connectors": 7.477288867737966e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.230770231568429e-06, "add_observations_from_episodes_to_batch": 3.324745005039989e-06, "batch_individual_items": 1.5875437657774262e-05, "numpy_to_tensor": 1.67242654065783e-05, "add_time_dim_to_batch_and_zero_pad": 9.047832810130392e-06}}, "connector_pipeline_timer": 7.650917483872624e-05}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.0470730945113896e-05, "listify_data_for_vector_env": 1.294392494621971e-05, "remove_single_ts_time_rank_from_batch": 1.3810496381870933e-05, "un_batch_to_individual_items": 7.835642624829637e-06, "get_actions": 5.55152692584623e-05, "tensor_to_numpy": 1.9409759962581956e-05}}, "connector_pipeline_timer": 0.00015326184822421037}, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "num_episodes": 250.0, "episode_len_max": 20, "rlmodule_inference_timer": 4.695224060365252e-05, "episode_len_min": 20, "time_between_sampling": 0.03822969973011374, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 5.3953893545743077e-05, "agent_episode_returns_mean": {"default_agent": 0.7800000000000001}, "num_episodes_lifetime": -400875.0, "episode_return_mean": 0.7800000000000001, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.00716522003284559, "env_step_timer": 1.8800254592519863e-05, "episode_len_mean": 20.0, "episode_return_max": 9.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.00692712036659941, "module_episode_returns_mean": {"default_policy": 0.7800000000000001}, "num_env_steps_sampled_lifetime": -8017500.0, "weights_seq_no": 14.0, "episode_return_min": -10.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 2759.8624284025623}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15868140717357154, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.010810714714263104, "add_observations_from_episodes_to_batch": 0.0008937245749731916, "add_columns_from_episodes_to_train_batch": 0.04412696367172808, "add_time_dim_to_batch_and_zero_pad": 0.09150182827452655, "add_states_from_episodes_to_batch": 0.0035969435066389188, "batch_individual_items": 0.007513951741402379, "numpy_to_tensor": 7.188128677852935e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_env_steps_trained_lifetime": 3240000, "num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 1077300, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 46821.489313235565}, "intrinsic_reward_module": {"weights_seq_no": 90.0, "num_module_steps_trained_lifetime": 538650, "module_train_batch_size_mean": 997.499088644618, "num_module_steps_trained": 35910, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 76.0}, "default_policy": {"policy_loss": -0.0005750776617787778, "num_module_steps_trained_lifetime": 538650, "module_train_batch_size_mean": 997.499088644618, "vf_loss_unclipped": 40.78431701660156, "num_module_steps_trained": 35910, "total_loss": 0.24813564121723175, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 5.3123916586628184e-05, "vf_explained_var": 0.0010299086570739746, "diff_num_grad_updates_vs_sampler_policy": 76.0, "entropy": 0.6784487962722778, "weights_seq_no": 90.0, "vf_loss": 0.3205811679363251}}}, "IntrinsicAttentionMask": [[[0.16665665805339813, 0.16667617857456207, 0.1667814999818802, 0.1665559560060501, 0.16657544672489166, 0.16675424575805664], [0.16665786504745483, 0.16667503118515015, 0.1667676419019699, 0.1665693074464798, 0.16658645868301392, 0.166743665933609], [0.16666439175605774, 0.1666688472032547, 0.16669289767742157, 0.16664138436317444, 0.1666458398103714, 0.16668668389320374], [0.1666504144668579, 0.16668209433555603, 0.16685305535793304, 0.16648702323436737, 0.1665186583995819, 0.16680879890918732], [0.1666516363620758, 0.1666809469461441, 0.16683919727802277, 0.16650037467479706, 0.16652965545654297, 0.16679821908473969], [0.16666269302368164, 0.16667044162750244, 0.16671222448349, 0.16662272810935974, 0.16663046181201935, 0.16670140624046326]], [[0.1664816439151764, 0.16659396886825562, 0.1667848378419876, 0.16654406487941742, 0.16665643453598022, 0.16693907976150513], [0.166594460606575, 0.1666383147239685, 0.16671279072761536, 0.16661883890628815, 0.16666269302368164, 0.16677293181419373], [0.1667860746383667, 0.16671352088451385, 0.1665903776884079, 0.16674573719501495, 0.1666731983423233, 0.16649103164672852], [0.1665443629026413, 0.16661861538887024, 0.16674478352069855, 0.16658562421798706, 0.1666599065065384, 0.16684669256210327], [0.1666571944952011, 0.16666294634342194, 0.1666727215051651, 0.1666603833436966, 0.16666613519191742, 0.16668060421943665], [0.1669408231973648, 0.16677416861057281, 0.1664915531873703, 0.16684815287590027, 0.16668158769607544, 0.16626378893852234]], [[0.16665665805339813, 0.16667616367340088, 0.16653646528720856, 0.16680102050304413, 0.16657544672489166, 0.16675423085689545], [0.16665786504745483, 0.16667503118515015, 0.16655215620994568, 0.16678480803966522, 0.16658645868301392, 0.166743665933609], [0.16664917767047882, 0.16668319702148438, 0.16643968224525452, 0.16690094769001007, 0.16650763154029846, 0.16681933403015137], [0.16666558384895325, 0.16666767001152039, 0.1666526198387146, 0.16668112576007843, 0.16665682196617126, 0.1666760891675949], [0.1666516214609146, 0.1666809320449829, 0.16647107899188995, 0.16686852276325226, 0.16652964055538177, 0.16679821908473969], [0.16666270792484283, 0.16667045652866364, 0.16661499440670013, 0.16671998798847198, 0.16663047671318054, 0.16670142114162445]], [[0.16659915447235107, 0.16673068702220917, 0.1667930781841278, 0.1667747050523758, 0.16667558252811432, 0.16642679274082184], [0.16666115820407867, 0.16667190194129944, 0.16667699813842773, 0.16667549312114716, 0.1666674017906189, 0.1666470617055893], [0.16669052839279175, 0.16664402186870575, 0.16662196815013885, 0.16662845015525818, 0.1666634976863861, 0.16675156354904175], [0.16668187081813812, 0.16665221750736237, 0.16663816571235657, 0.16664230823516846, 0.16666463017463684, 0.16672077775001526], [0.166635200381279, 0.16669651865959167, 0.16672560572624207, 0.1667170375585556, 0.16667082905769348, 0.1665547788143158], [0.16651774942874908, 0.16680769622325897, 0.16694533824920654, 0.16690479218959808, 0.16668620705604553, 0.1661382019519806]], [[0.16606393456459045, 0.1663130223751068, 0.16719461977481842, 0.1672438532114029, 0.1666755974292755, 0.1665090024471283], [0.16621099412441254, 0.16639940440654755, 0.16706566512584686, 0.1671028435230255, 0.16667352616786957, 0.16654758155345917], [0.16673025488853455, 0.16670392453670502, 0.16661104559898376, 0.1666058748960495, 0.16666565835475922, 0.16668322682380676], [0.166759192943573, 0.16672086715698242, 0.1665857434272766, 0.16657821834087372, 0.1666651964187622, 0.16669075191020966], [0.16642479598522186, 0.16652487218379974, 0.1668783575296402, 0.16689807176589966, 0.16667039692401886, 0.16660355031490326], [0.1663265973329544, 0.16646726429462433, 0.1669643521308899, 0.16699208319187164, 0.16667184233665466, 0.16657786071300507]], [[0.1666528433561325, 0.16660574078559875, 0.16674508154392242, 0.16673634946346283, 0.16657954454421997, 0.1666804850101471], [0.16663269698619843, 0.16651709377765656, 0.16685913503170013, 0.166837677359581, 0.16645286977291107, 0.16670049726963043], [0.1666921228170395, 0.16677916049957275, 0.16652195155620575, 0.1665380597114563, 0.16682755947113037, 0.16664113104343414], [0.16668842732906342, 0.16676273941993713, 0.16654308140277863, 0.16655683517456055, 0.16680407524108887, 0.1666448712348938], [0.16662147641181946, 0.1664678305387497, 0.16692256927490234, 0.16689403355121613, 0.16638247668743134, 0.16671162843704224], [0.16666463017463684, 0.1666576862335205, 0.16667822003364563, 0.16667692363262177, 0.1666538268327713, 0.16666869819164276]]], "default_policy": {"num_module_steps_trained_lifetime": 89775, "module_train_batch_size_mean": 998.1026110140886, "vf_loss_unclipped": 40.77823257446289, "num_module_steps_trained": 5985, "num_trainable_parameters": 16595, "total_loss": 0.2480485588312149, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 5.792814772576094e-05, "weights_seq_no": 15.0, "vf_loss": 0.32051143050193787, "curr_kl_coeff": 4.931150215270463e-06, "vf_explained_var": -0.00024127960205078125, "policy_loss": -0.0005993953673169017, "entropy": 0.6783711910247803, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 645.3881453194617}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 89775, "module_train_batch_size_mean": 998.1026110140886, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5985, "num_trainable_parameters": 8266, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 15.0, "num_module_steps_trained_lifetime_throughput": 645.393997560127}, "__all_modules__": {"num_env_steps_trained_lifetime": 540000, "num_env_steps_trained": 36000, "num_module_steps_trained_lifetime": 179550, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3885.115609561236, "num_module_steps_trained_throughput": 21110082.57819217, "num_module_steps_trained_lifetime_throughput": 12493970.688610235}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 0.45, "sample": 0.12264517992222328, "env_step_timer": 1.3703443328257611e-05, "episode_return_max": 13.5, "episode_return_min": -14.5, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7972407214745954e-06, "numpy_to_tensor": 1.181481934014248e-05, "add_time_dim_to_batch_and_zero_pad": 6.980385101739686e-06, "add_states_from_episodes_to_batch": 2.6689781327098675e-06, "batch_individual_items": 1.2427087367277407e-05}}, "connector_pipeline_timer": 5.86802174920999e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes_lifetime": 300, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 75400, "episode_duration_sec_mean": 0.0055899145372677594, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.306796143071365e-06, "get_actions": 3.505425865232845e-05, "tensor_to_numpy": 1.4750315552795844e-05, "normalize_and_clip_actions": 7.729943395601967e-06, "remove_single_ts_time_rank_from_batch": 1.1806463869155652e-05, "listify_data_for_vector_env": 1.0087220174645014e-05}}, "connector_pipeline_timer": 0.00011127781171587266}, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "episode_len_max": 20, "weights_seq_no": 15.0, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "num_episodes": 20, "rlmodule_inference_timer": 3.0015194182262538e-05, "num_env_steps_sampled": 400, "env_reset_timer": 0.0005354559108404186, "module_episode_returns_mean": {"default_policy": 0.45}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": 0.45}, "time_between_sampling": 10.362772923824977}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "b1762_00000", "date": "2025-08-11_18-26-30", "timestamp": 1754929590, "time_this_iter_s": 11.387934923171997, "time_total_s": 166.31275343894958, "pid": 10959, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 166.31275343894958, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 48.74375, "ram_util_percent": 80.5875}}
{"timers": {"training_iteration": 11.887423273265933, "restore_env_runners": 8.252194212595646e-06, "training_step": 11.88718771643032, "env_runner_sampling_timer": 2.2089583323579287, "learner_update_timer": 9.4755669691166, "synch_weights": 0.0018864443301511242, "restore_eval_env_runners": 5.9596325669134065e-05, "evaluation_iteration": 0.13490500550104279, "synch_eval_env_connectors": 0.00021056011258018028, "synch_env_connectors": 7.4437665841967426e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7518824414862613e-06, "add_observations_from_episodes_to_batch": 2.8190324508264706e-06, "batch_individual_items": 1.2562372804942644e-05, "numpy_to_tensor": 1.2578666299462263e-05, "add_time_dim_to_batch_and_zero_pad": 7.244916763243867e-06}}, "connector_pipeline_timer": 6.068393517973733e-05}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.904797796787611e-06, "listify_data_for_vector_env": 1.0421271576997057e-05, "remove_single_ts_time_rank_from_batch": 1.1694285437864143e-05, "un_batch_to_individual_items": 6.550989426136191e-06, "get_actions": 4.018465094599741e-05, "tensor_to_numpy": 1.541729098812059e-05}}, "connector_pipeline_timer": 0.00011904135897789877}, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "num_episodes": 250.0, "episode_len_max": 20, "rlmodule_inference_timer": 3.227541045917019e-05, "episode_len_min": 20, "time_between_sampling": 0.03811480415510232, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 4.449146409253224e-05, "agent_episode_returns_mean": {"default_agent": 1.0199999999999996}, "num_episodes_lifetime": -431750.0, "episode_return_mean": 1.0199999999999996, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.006207501018317421, "env_step_timer": 1.3917516686475195e-05, "episode_len_mean": 20.0, "episode_return_max": 9.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.005327455453574655, "module_episode_returns_mean": {"default_policy": 1.0199999999999996}, "num_env_steps_sampled_lifetime": -8635000.0, "weights_seq_no": 15.0, "episode_return_min": -10.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3219.1069678628014}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15863155601215828, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.010794744648203384, "add_observations_from_episodes_to_batch": 0.0008934206592221615, "add_columns_from_episodes_to_train_batch": 0.0441032065354366, "add_time_dim_to_batch_and_zero_pad": 0.09149334541141677, "add_states_from_episodes_to_batch": 0.003599170320506203, "batch_individual_items": 0.007510880133629547, "numpy_to_tensor": 7.182288406162964e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_env_steps_trained_lifetime": 3456000, "num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 1149120, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 46072.83235197383}, "intrinsic_reward_module": {"weights_seq_no": 96.0, "num_module_steps_trained_lifetime": 574560, "module_train_batch_size_mean": 997.4970769774884, "num_module_steps_trained": 35910, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 81.0}, "default_policy": {"policy_loss": 5.841154415975325e-05, "num_module_steps_trained_lifetime": 574560, "module_train_batch_size_mean": 997.4970769774884, "vf_loss_unclipped": 42.317230224609375, "num_module_steps_trained": 35910, "total_loss": 0.24876122176647186, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 2.314110861334484e-05, "vf_explained_var": 0.0012071728706359863, "diff_num_grad_updates_vs_sampler_policy": 81.0, "entropy": 0.6773402094841003, "weights_seq_no": 96.0, "vf_loss": 0.3205750584602356}}}, "IntrinsicAttentionMask": [[[0.16596148908138275, 0.16621041297912598, 0.16647471487522125, 0.1671406775712967, 0.16718989610671997, 0.16702279448509216], [0.16613350808620453, 0.16632182896137238, 0.16652169823646545, 0.16702494025230408, 0.16706211864948273, 0.16693589091300964], [0.1663159877061844, 0.16643992066383362, 0.16657140851020813, 0.16690225899219513, 0.16692668199539185, 0.1668437421321869], [0.1667749583721161, 0.1667366325855255, 0.1666959971189499, 0.16659396886825562, 0.16658645868301392, 0.16661199927330017], [0.1668088287115097, 0.1667584925889969, 0.1667051613330841, 0.1665712296962738, 0.16656136512756348, 0.16659489274024963], [0.1666937917470932, 0.16668419539928436, 0.16667401790618896, 0.16664846241474152, 0.1666465699672699, 0.16665297746658325]], [[0.16654372215270996, 0.166604146361351, 0.16656611859798431, 0.16671797633171082, 0.16677844524383545, 0.16678965091705322], [0.1666831374168396, 0.16667504608631134, 0.16668014228343964, 0.16665978729724884, 0.16665169596672058, 0.16665019094944], [0.16659539937973022, 0.16663043200969696, 0.16660837829113007, 0.16669641435146332, 0.16673146188259125, 0.16673795878887177], [0.16694581508636475, 0.16680845618247986, 0.16689489781856537, 0.16655007004737854, 0.16641303896903992, 0.1663876622915268], [0.16708536446094513, 0.16687925159931183, 0.16700895130634308, 0.16649176180362701, 0.1662863790988922, 0.1662483513355255], [0.16711123287677765, 0.16689236462116241, 0.16703008115291595, 0.16648094356060028, 0.1662629097700119, 0.16622254252433777]], [[0.16606415808200836, 0.16692940890789032, 0.16657771170139313, 0.16662676632404327, 0.16667582094669342, 0.1671261191368103], [0.1665741205215454, 0.16670699417591095, 0.16665305197238922, 0.1666605919599533, 0.1666681170463562, 0.1667371243238449], [0.16636700928211212, 0.16679726541042328, 0.16662250459194183, 0.16664689779281616, 0.1666712760925293, 0.16689492762088776], [0.16639593243598938, 0.16678468883037567, 0.16662681102752686, 0.16664883494377136, 0.16667087376117706, 0.16687291860580444], [0.16642482578754425, 0.16677208244800568, 0.1666310578584671, 0.16665074229240417, 0.16667042672634125, 0.16685087978839874], [0.16668984293937683, 0.16665656864643097, 0.1666700690984726, 0.16666817665100098, 0.16666629910469055, 0.16664902865886688]], [[0.1663510501384735, 0.16672475636005402, 0.16665400564670563, 0.16667482256889343, 0.1667872667312622, 0.1668081134557724], [0.1669919490814209, 0.16660678386688232, 0.16667956113815308, 0.16665813326835632, 0.16654251515865326, 0.1665211021900177], [0.166870579123497, 0.1666291356086731, 0.16667477786540985, 0.166661337018013, 0.16658882796764374, 0.1665753871202469], [0.16690629720687866, 0.16662254929542542, 0.16667617857456207, 0.1666603833436966, 0.16657517850399017, 0.1665593981742859], [0.1670992076396942, 0.16658702492713928, 0.16668377816677094, 0.1666552871465683, 0.16650161147117615, 0.1664731353521347], [0.16713497042655945, 0.1665804237127304, 0.16668517887592316, 0.1666543334722519, 0.16648796200752258, 0.1664571464061737]], [[0.1659616082906723, 0.16682632267475128, 0.1664748340845108, 0.16714079678058624, 0.16719001531600952, 0.16640640795230865], [0.1665583699941635, 0.16669122874736786, 0.16663728654384613, 0.16673938930034637, 0.16674692928791046, 0.16662678122520447], [0.16631601750850677, 0.1667461395263672, 0.16657143831253052, 0.16690228879451752, 0.16692671179771423, 0.16653740406036377], [0.1667749583721161, 0.16664209961891174, 0.1666959971189499, 0.16659396886825562, 0.16658645868301392, 0.16670651733875275], [0.1668088287115097, 0.16663439571857452, 0.1667051613330841, 0.1665712296962738, 0.16656136512756348, 0.1667189747095108], [0.16626879572868347, 0.16675683856010437, 0.16655860841274261, 0.1669340431690216, 0.16696177423000336, 0.16651998460292816]], [[0.16643810272216797, 0.1665503829717636, 0.16674122214317322, 0.16676205396652222, 0.16687455773353577, 0.16663366556167603], [0.16657744348049164, 0.16662129759788513, 0.1666957587003708, 0.16670389473438263, 0.16674776375293732, 0.1666537970304489], [0.16681425273418427, 0.16674168407917023, 0.16661851108074188, 0.16660508513450623, 0.16653260588645935, 0.16668790578842163], [0.1668400913476944, 0.1667547971010208, 0.16661006212234497, 0.16659428179264069, 0.16650910675525665, 0.1666916012763977], [0.16697965562343597, 0.16682568192481995, 0.16656452417373657, 0.16653604805469513, 0.16638247668743134, 0.16671162843704224], [0.16668078303337097, 0.16667383909225464, 0.1666620522737503, 0.16666075587272644, 0.1666538268327713, 0.16666869819164276]]], "default_policy": {"num_module_steps_trained_lifetime": 95760, "module_train_batch_size_mean": 998.0669052031734, "vf_loss_unclipped": 42.37762451171875, "num_module_steps_trained": 5985, "num_trainable_parameters": 16595, "total_loss": 0.24870482087135315, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 2.2350079234456643e-05, "weights_seq_no": 16.0, "vf_loss": 0.32051149010658264, "curr_kl_coeff": 2.4655751076352317e-06, "vf_explained_var": -8.90493392944336e-05, "policy_loss": 5.528192559722811e-05, "entropy": 0.6773614883422852, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 644.4359712002076}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 95760, "module_train_batch_size_mean": 998.0669052031734, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5985, "num_trainable_parameters": 8266, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 16.0, "num_module_steps_trained_lifetime_throughput": 644.4414448798}, "__all_modules__": {"num_env_steps_trained_lifetime": 576000, "num_env_steps_trained": 36000, "num_module_steps_trained_lifetime": 191520, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3879.2791690288946, "num_module_steps_trained_throughput": 20616419.28493762, "num_module_steps_trained_lifetime_throughput": 12462169.598271344}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.25, "sample": 0.12266667853230726, "env_step_timer": 1.911195903529225e-05, "episode_return_max": 13.5, "episode_return_min": -14.5, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.245807408299577e-06, "numpy_to_tensor": 1.618201496385611e-05, "add_time_dim_to_batch_and_zero_pad": 9.477612196131719e-06, "add_states_from_episodes_to_batch": 3.0366234576901384e-06, "batch_individual_items": 1.7597716127259128e-05}}, "connector_pipeline_timer": 7.67584868125025e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes_lifetime": 320, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 80400, "episode_duration_sec_mean": 0.0056955837202258405, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 7.646672055742257e-06, "get_actions": 5.3643864827397014e-05, "tensor_to_numpy": 1.7568750600108356e-05, "normalize_and_clip_actions": 9.073517742056919e-06, "remove_single_ts_time_rank_from_batch": 1.2926857089222482e-05, "listify_data_for_vector_env": 1.4299205654329542e-05}}, "connector_pipeline_timer": 0.00014732729760587557}, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "episode_len_max": 20, "weights_seq_no": 16.0, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "num_episodes": 20, "rlmodule_inference_timer": 3.990007739236136e-05, "num_env_steps_sampled": 400, "env_reset_timer": 0.0005329605108719308, "module_episode_returns_mean": {"default_policy": 1.25}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": 1.25}, "time_between_sampling": 10.36526976208681}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "b1762_00000", "date": "2025-08-11_18-26-41", "timestamp": 1754929601, "time_this_iter_s": 10.718110084533691, "time_total_s": 177.03086352348328, "pid": 10959, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 177.03086352348328, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 38.96, "ram_util_percent": 80.14666666666668}}
{"timers": {"training_iteration": 11.881441242612802, "restore_env_runners": 8.271752209566856e-06, "training_step": 11.881205861766668, "env_runner_sampling_timer": 2.2021436598645434, "learner_update_timer": 9.47641615650605, "synch_weights": 0.0018793540568292299, "restore_eval_env_runners": 5.936911260094241e-05, "evaluation_iteration": 0.13489502086577518, "synch_eval_env_connectors": 0.00020991784157236407, "synch_env_connectors": 7.418909039767649e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.735487419864253e-06, "add_observations_from_episodes_to_batch": 2.79660959303222e-06, "batch_individual_items": 1.2513776894965391e-05, "numpy_to_tensor": 1.244708693793817e-05, "add_time_dim_to_batch_and_zero_pad": 7.1919790734073235e-06}}, "connector_pipeline_timer": 6.0318316103039815e-05}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.873089272137445e-06, "listify_data_for_vector_env": 1.0353467993093597e-05, "remove_single_ts_time_rank_from_batch": 1.1684433299767357e-05, "un_batch_to_individual_items": 6.5644037307867005e-06, "get_actions": 3.94519033708541e-05, "tensor_to_numpy": 1.5323572242608475e-05}}, "connector_pipeline_timer": 0.00011804319573592983}, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "num_episodes": 250.0, "episode_len_max": 20, "rlmodule_inference_timer": 3.191039418581265e-05, "episode_len_min": 20, "time_between_sampling": 0.03731984806631311, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 3.530472978343293e-05, "agent_episode_returns_mean": {"default_agent": 1.6599999999999997}, "num_episodes_lifetime": -462625.0, "episode_return_mean": 1.6599999999999997, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.005688884610470233, "env_step_timer": 1.3842860188144212e-05, "episode_len_mean": 20.0, "episode_return_max": 9.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.005280647187959403, "module_episode_returns_mean": {"default_policy": 1.6599999999999997}, "num_env_steps_sampled_lifetime": -9252500.0, "weights_seq_no": 16.0, "episode_return_min": -10.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3260.991238103095}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1585650450326395, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.010774773031095395, "add_observations_from_episodes_to_batch": 0.0008926360315644751, "add_columns_from_episodes_to_train_batch": 0.04407904405990832, "add_time_dim_to_batch_and_zero_pad": 0.09146956612827023, "add_states_from_episodes_to_batch": 0.003600117367719044, "batch_individual_items": 0.007513015082276859, "numpy_to_tensor": 7.163257542243413e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_env_steps_trained_lifetime": 3672000, "num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 1220940, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 45334.95773532653}, "intrinsic_reward_module": {"weights_seq_no": 102.0, "num_module_steps_trained_lifetime": 610470, "module_train_batch_size_mean": 997.4956760259092, "num_module_steps_trained": 35910, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 86.0}, "default_policy": {"policy_loss": -0.0005447663133963943, "num_module_steps_trained_lifetime": 610470, "module_train_batch_size_mean": 997.4956760259092, "vf_loss_unclipped": 39.86106491088867, "num_module_steps_trained": 35910, "total_loss": 0.24815529584884644, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 7.834128336980939e-05, "vf_explained_var": 0.0009542703628540039, "diff_num_grad_updates_vs_sampler_policy": 86.0, "entropy": 0.6747955679893494, "weights_seq_no": 102.0, "vf_loss": 0.3205550014972687}}}, "IntrinsicAttentionMask": [[[0.16606393456459045, 0.1663130223751068, 0.16719461977481842, 0.1672438532114029, 0.1666755974292755, 0.1665090024471283], [0.16621099412441254, 0.16639940440654755, 0.16706566512584686, 0.1671028435230255, 0.16667352616786957, 0.16654758155345917], [0.16673025488853455, 0.16670392453670502, 0.16661106050014496, 0.1666058748960495, 0.16666565835475922, 0.16668322682380676], [0.166759192943573, 0.16672086715698242, 0.1665857434272766, 0.16657821834087372, 0.1666651964187622, 0.16669075191020966], [0.16642479598522186, 0.16652487218379974, 0.1668783575296402, 0.16689807176589966, 0.16667039692401886, 0.16660355031490326], [0.1663265973329544, 0.16646726429462433, 0.1669643521308899, 0.16699208319187164, 0.16667184233665466, 0.16657786071300507]], [[0.16667112708091736, 0.1666240096092224, 0.16676336526870728, 0.16664493083953857, 0.16670748591423035, 0.16658909618854523], [0.1666775792837143, 0.16656194627285004, 0.16690407693386078, 0.16661328077316284, 0.16676683723926544, 0.1664762943983078], [0.16665837168693542, 0.1667453944683075, 0.16648823022842407, 0.16670674085617065, 0.16659127175807953, 0.16680991649627686], [0.16667471826076508, 0.16658951342105865, 0.16684158146381378, 0.16662734746932983, 0.16674049198627472, 0.16652637720108032], [0.16666612029075623, 0.16667187213897705, 0.16665485501289368, 0.1666693240404129, 0.16666167974472046, 0.16667614877223969], [0.16668233275413513, 0.16651593148708344, 0.1670084297657013, 0.16658981144428253, 0.16681084036827087, 0.16639269888401031]], [[0.16596144437789917, 0.1662103682756424, 0.16709142923355103, 0.1671406328678131, 0.1671898514032364, 0.16640624403953552], [0.16613347828388214, 0.16632179915905, 0.16698776185512543, 0.1670249104499817, 0.16706208884716034, 0.16646993160247803], [0.16674108803272247, 0.16671475768089294, 0.1666218787431717, 0.16661670804023743, 0.16661153733730316, 0.1666940599679947], [0.1667749583721161, 0.1667366325855255, 0.1666014939546585, 0.16659396886825562, 0.16658645868301392, 0.16670651733875275], [0.1668088287115097, 0.1667584925889969, 0.16658110916614532, 0.1665712296962738, 0.16656136512756348, 0.1667189747095108], [0.1662687361240387, 0.16640935838222504, 0.16690626740455627, 0.16693398356437683, 0.16696171462535858, 0.1665199249982834]], [[0.16667601466178894, 0.16657696664333344, 0.16687002778053284, 0.16662093997001648, 0.16675248742103577, 0.16650357842445374], [0.1666824370622635, 0.16651487350463867, 0.16701078414916992, 0.16658926010131836, 0.16681180894374847, 0.1663907915353775], [0.16666333377361298, 0.1666983813047409, 0.16659477353096008, 0.16668280959129333, 0.16663630306720734, 0.16672435402870178], [0.16667957603931427, 0.1665424406528473, 0.16694825887680054, 0.16660332679748535, 0.16678546369075775, 0.16644085943698883], [0.1666710376739502, 0.16662484407424927, 0.16676147282123566, 0.1666453629732132, 0.16670668125152588, 0.1665906012058258], [0.16668717563152313, 0.16646887362003326, 0.1671151965856552, 0.16656577587127686, 0.1668558120727539, 0.1663072407245636]], [[0.16665665805339813, 0.16667616367340088, 0.166781485080719, 0.1665559560060501, 0.16682054102420807, 0.1665092259645462], [0.16665787994861603, 0.16667503118515015, 0.1667676419019699, 0.1665693074464798, 0.16680198907852173, 0.16652822494506836], [0.16666437685489655, 0.1666688323020935, 0.16669288277626038, 0.16664136946201324, 0.1667017936706543, 0.16663068532943726], [0.16665036976337433, 0.16668203473091125, 0.16685301065444946, 0.1664869785308838, 0.16691641509532928, 0.16641119122505188], [0.16666680574417114, 0.16666655242443085, 0.1666651964187622, 0.1666680872440338, 0.16666468977928162, 0.16666869819164276], [0.16664743423461914, 0.16668474674224854, 0.16688619554042816, 0.1664549559354782, 0.1669609099626541, 0.16636569797992706]], [[0.1664816439151764, 0.16659395396709442, 0.1667848378419876, 0.16654404997825623, 0.16665641963481903, 0.16693906486034393], [0.166594460606575, 0.1666383147239685, 0.16671279072761536, 0.16661883890628815, 0.16666269302368164, 0.16677293181419373], [0.1667860746383667, 0.16671352088451385, 0.1665903776884079, 0.16674573719501495, 0.1666731983423233, 0.16649103164672852], [0.1665443629026413, 0.16661861538887024, 0.16674478352069855, 0.16658562421798706, 0.1666599065065384, 0.16684669256210327], [0.1666571944952011, 0.16666294634342194, 0.1666727215051651, 0.1666603833436966, 0.16666613519191742, 0.16668060421943665], [0.1669408231973648, 0.16677416861057281, 0.1664915531873703, 0.16684815287590027, 0.16668158769607544, 0.16626378893852234]]], "default_policy": {"num_module_steps_trained_lifetime": 101745, "module_train_batch_size_mean": 998.0332888909784, "vf_loss_unclipped": 39.81949234008789, "num_module_steps_trained": 5985, "num_trainable_parameters": 16595, "total_loss": 0.24809353053569794, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 8.284076466225088e-05, "weights_seq_no": 17.0, "vf_loss": 0.32051071524620056, "curr_kl_coeff": 1.2327875538176158e-06, "vf_explained_var": -0.0004400014877319336, "policy_loss": -0.0005594808608293533, "entropy": 0.6747282147407532, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 643.5122599343616}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 101745, "module_train_batch_size_mean": 998.0332888909784, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5985, "num_trainable_parameters": 8266, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 17.0, "num_module_steps_trained_lifetime_throughput": 643.5173575247311}, "__all_modules__": {"num_env_steps_trained_lifetime": 612000, "num_env_steps_trained": 36000, "num_module_steps_trained_lifetime": 203490, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3873.620799169616, "num_module_steps_trained_throughput": 20157144.484921295, "num_module_steps_trained_lifetime_throughput": 12440343.523432566}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.05, "sample": 0.12266449757715522, "env_step_timer": 1.4034737535979422e-05, "episode_return_max": 13.5, "episode_return_min": -14.5, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8471821741102993e-06, "numpy_to_tensor": 1.2077749136759389e-05, "add_time_dim_to_batch_and_zero_pad": 6.909161084018926e-06, "add_states_from_episodes_to_batch": 2.6969568157363676e-06, "batch_individual_items": 1.2498616598288146e-05}}, "connector_pipeline_timer": 5.908722142313335e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes_lifetime": 340, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 85400, "episode_duration_sec_mean": 0.005696095008170232, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.45414410820953e-06, "get_actions": 3.629105814623603e-05, "tensor_to_numpy": 1.494514504816712e-05, "normalize_and_clip_actions": 7.811733872014184e-06, "remove_single_ts_time_rank_from_batch": 1.1937539720796619e-05, "listify_data_for_vector_env": 1.0348024514069799e-05}}, "connector_pipeline_timer": 0.00011355450958443746}, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "episode_len_max": 20, "weights_seq_no": 17.0, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "num_episodes": 20, "rlmodule_inference_timer": 3.12544007625832e-05, "num_env_steps_sampled": 400, "env_reset_timer": 0.000530889235579374, "module_episode_returns_mean": {"default_policy": 1.05}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": 1.05}, "time_between_sampling": 10.374837119885893}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "b1762_00000", "date": "2025-08-11_18-26-52", "timestamp": 1754929612, "time_this_iter_s": 11.423977375030518, "time_total_s": 188.4548408985138, "pid": 10959, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 188.4548408985138, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 48.317647058823525, "ram_util_percent": 80.32941176470588}}
{"timers": {"training_iteration": 11.887170022686224, "restore_env_runners": 8.244035106268322e-06, "training_step": 11.886934622729434, "env_runner_sampling_timer": 2.197431321596923, "learner_update_timer": 9.485681444940786, "synch_weights": 0.0018772813467238104, "restore_eval_env_runners": 5.8902512081771456e-05, "evaluation_iteration": 0.13485850815815492, "synch_eval_env_connectors": 0.00020889116259203543, "synch_env_connectors": 7.380140475189036e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.0062712853803583e-06, "add_observations_from_episodes_to_batch": 3.1172923965149123e-06, "batch_individual_items": 1.3964046235123867e-05, "numpy_to_tensor": 1.4506689497150568e-05, "add_time_dim_to_batch_and_zero_pad": 7.988176748496143e-06}}, "connector_pipeline_timer": 6.894590867900087e-05}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.651478342884954e-06, "listify_data_for_vector_env": 1.1343737270458944e-05, "remove_single_ts_time_rank_from_batch": 1.2672900447726034e-05, "un_batch_to_individual_items": 7.1859529704364225e-06, "get_actions": 4.675508951403801e-05, "tensor_to_numpy": 1.7486106775154173e-05}}, "connector_pipeline_timer": 0.0001333737433924123}, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "num_episodes": 250.0, "episode_len_max": 20, "rlmodule_inference_timer": 3.7014511099173084e-05, "episode_len_min": 20, "time_between_sampling": 0.03993450550848818, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 3.956757902355941e-05, "agent_episode_returns_mean": {"default_agent": 1.74}, "num_episodes_lifetime": -493500.0, "episode_return_mean": 1.74, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.0063083933263204375, "env_step_timer": 1.5610764734977618e-05, "episode_len_mean": 20.0, "episode_return_max": 9.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.005992785468231886, "module_episode_returns_mean": {"default_policy": 1.74}, "num_env_steps_sampled_lifetime": -9870000.0, "weights_seq_no": 17.0, "episode_return_min": -10.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3090.9860619627802}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15967397375309705, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.01075563238059956, "add_observations_from_episodes_to_batch": 0.0008932609209261458, "add_columns_from_episodes_to_train_batch": 0.04407463611906553, "add_time_dim_to_batch_and_zero_pad": 0.09246159421727705, "add_states_from_episodes_to_batch": 0.003677840364993026, "batch_individual_items": 0.007574616180967195, "numpy_to_tensor": 7.169041970743142e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_env_steps_trained_lifetime": 3888000, "num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 1292760, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 44600.79751237369}, "intrinsic_reward_module": {"weights_seq_no": 108.0, "num_module_steps_trained_lifetime": 646380, "module_train_batch_size_mean": 997.4947003847115, "num_module_steps_trained": 35910, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 91.0}, "default_policy": {"policy_loss": -0.0005728343385271728, "num_module_steps_trained_lifetime": 646380, "module_train_batch_size_mean": 997.4947003847115, "vf_loss_unclipped": 40.577823638916016, "num_module_steps_trained": 35910, "total_loss": 0.24812375009059906, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 5.746384340454824e-05, "vf_explained_var": 0.0011494159698486328, "diff_num_grad_updates_vs_sampler_policy": 91.0, "entropy": 0.6727433800697327, "weights_seq_no": 108.0, "vf_loss": 0.3205507695674896}}}, "IntrinsicAttentionMask": [[[0.1661664992570877, 0.1664157509803772, 0.16729788482189178, 0.16672945022583008, 0.1667785495519638, 0.16661185026168823], [0.1662885546684265, 0.1664770543575287, 0.16714361310005188, 0.16671419143676758, 0.16675129532814026, 0.16662530601024628], [0.16671942174434662, 0.1666930913925171, 0.16660022735595703, 0.16666001081466675, 0.1666548252105713, 0.16667239367961884], [0.16644197702407837, 0.1665540486574173, 0.16694991290569305, 0.16669495403766632, 0.16671699285507202, 0.16664214432239532], [0.16646598279476166, 0.16656607389450073, 0.16691964864730835, 0.16669194400310516, 0.16671162843704224, 0.16664476692676544], [0.1663844734430313, 0.16652518510818481, 0.1670224517583847, 0.16670215129852295, 0.16672983765602112, 0.16663582623004913]], [[0.16667112708091736, 0.1666240096092224, 0.16665366291999817, 0.16675463318824768, 0.16670748591423035, 0.16658909618854523], [0.1666775792837143, 0.16656194627285004, 0.1666347235441208, 0.16688261926174164, 0.16676685214042664, 0.1664762943983078], [0.16667352616786957, 0.1666010171175003, 0.16664664447307587, 0.1668020635843277, 0.16672949492931366, 0.1665472835302353], [0.16665960848331451, 0.16673390567302704, 0.16668714582920074, 0.16652803122997284, 0.16660228371620178, 0.1667890101671219], [0.16666610538959503, 0.16667185723781586, 0.16666825115680695, 0.16665591299533844, 0.16666166484355927, 0.1666761338710785], [0.16668233275413513, 0.16651594638824463, 0.1666206419467926, 0.16697752475738525, 0.16681082546710968, 0.1663927137851715]], [[0.16616646945476532, 0.1664157211780548, 0.16668033599853516, 0.16734711825847626, 0.16677851974964142, 0.16661182045936584], [0.16628852486610413, 0.1664770245552063, 0.1666770726442337, 0.16718079149723053, 0.16675126552581787, 0.1666252762079239], [0.16641797125339508, 0.16654199361801147, 0.16667355597019196, 0.16700460016727448, 0.1667223423719406, 0.16663949191570282], [0.1667434424161911, 0.16670511662960052, 0.1666644960641861, 0.16656248271465302, 0.1666494458913803, 0.16667501628398895], [0.16646595299243927, 0.16656605899333954, 0.1666722446680069, 0.16693934798240662, 0.16671161353588104, 0.16664475202560425], [0.1663844883441925, 0.166525200009346, 0.16667447984218597, 0.16705019772052765, 0.16672983765602112, 0.16663584113121033]], [[0.16671447455883026, 0.16661539673805237, 0.16667774319648743, 0.1666593849658966, 0.1665603369474411, 0.16677258908748627], [0.1667475700378418, 0.1665799468755722, 0.16668541729450226, 0.16665436327457428, 0.16648682951927185, 0.16684590280056], [0.1667267382144928, 0.1666022539138794, 0.16668058931827545, 0.16665752232074738, 0.16653309762477875, 0.16679975390434265], [0.16673287749290466, 0.1665956974029541, 0.16668201982975006, 0.16665659844875336, 0.16651947796344757, 0.16681334376335144], [0.16676592826843262, 0.16656021773815155, 0.1666896641254425, 0.16665153205394745, 0.16644595563411713, 0.16688664257526398], [0.16669508814811707, 0.16663619875907898, 0.16667325794696808, 0.166662335395813, 0.1666034609079361, 0.1667296290397644]], [[0.16665665805339813, 0.16667616367340088, 0.16653646528720856, 0.16680102050304413, 0.16657544672489166, 0.16675423085689545], [0.16665786504745483, 0.16667503118515015, 0.16655215620994568, 0.16678480803966522, 0.16658645868301392, 0.166743665933609], [0.16664917767047882, 0.16668319702148438, 0.16643968224525452, 0.16690094769001007, 0.16650763154029846, 0.16681933403015137], [0.16666558384895325, 0.16666767001152039, 0.1666526198387146, 0.16668112576007843, 0.16665682196617126, 0.1666760891675949], [0.1666516214609146, 0.1666809320449829, 0.16647107899188995, 0.16686852276325226, 0.16652964055538177, 0.16679821908473969], [0.16666270792484283, 0.16667045652866364, 0.16661499440670013, 0.16671998798847198, 0.16663047671318054, 0.16670142114162445]], [[0.16654372215270996, 0.16674482822418213, 0.16656611859798431, 0.16671797633171082, 0.16663773357868195, 0.16678965091705322], [0.16700781881809235, 0.16644985973834991, 0.16694557666778564, 0.16652421653270721, 0.16674669086933136, 0.16632583737373352], [0.16659539937973022, 0.1667119860649109, 0.16660837829113007, 0.16669641435146332, 0.16664989292621613, 0.16673795878887177], [0.16694584488868713, 0.16648922860622406, 0.16689492762088776, 0.16655009984970093, 0.16673217713832855, 0.16638769209384918], [0.1667606681585312, 0.16660691797733307, 0.16674353182315826, 0.166627436876297, 0.16668875515460968, 0.166572704911232], [0.16711127758026123, 0.16638413071632385, 0.16703012585639954, 0.16648098826408386, 0.16677087545394897, 0.16622258722782135]]], "default_policy": {"num_module_steps_trained_lifetime": 107730, "module_train_batch_size_mean": 998.0016398003509, "vf_loss_unclipped": 40.561866760253906, "num_module_steps_trained": 5985, "num_trainable_parameters": 16595, "total_loss": 0.24806252121925354, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 6.20679566054605e-05, "weights_seq_no": 18.0, "vf_loss": 0.3205109238624573, "curr_kl_coeff": 6.163937769088079e-07, "vf_explained_var": -0.000125885009765625, "policy_loss": -0.0005938433459959924, "entropy": 0.6726590394973755, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 641.3704672940119}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 107730, "module_train_batch_size_mean": 998.0016398003509, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5985, "num_trainable_parameters": 8266, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 18.0, "num_module_steps_trained_lifetime_throughput": 641.3752424011024}, "__all_modules__": {"num_env_steps_trained_lifetime": 648000, "num_env_steps_trained": 36000, "num_module_steps_trained_lifetime": 215460, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3860.636352650143, "num_module_steps_trained_throughput": 19707577.35378031, "num_module_steps_trained_lifetime_throughput": 12406983.386539163}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.05, "sample": 0.12269899218213078, "env_step_timer": 1.5085566559849212e-05, "episode_return_max": 13.5, "episode_return_min": -14.5, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.949121734516658e-06, "numpy_to_tensor": 1.3531521250381875e-05, "add_time_dim_to_batch_and_zero_pad": 7.603703393130102e-06, "add_states_from_episodes_to_batch": 2.8138610392563093e-06, "batch_individual_items": 1.3099889911474743e-05}}, "connector_pipeline_timer": 6.340442299798318e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes_lifetime": 360, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 90400, "episode_duration_sec_mean": 0.005512822893215343, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.8231314881770475e-06, "get_actions": 4.389164442807511e-05, "tensor_to_numpy": 1.6709890581442348e-05, "normalize_and_clip_actions": 8.621517957333805e-06, "remove_single_ts_time_rank_from_batch": 1.2714660371439425e-05, "listify_data_for_vector_env": 1.0674048309959164e-05}}, "connector_pipeline_timer": 0.00012720431857182998}, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "episode_len_max": 20, "weights_seq_no": 18.0, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "num_episodes": 20, "rlmodule_inference_timer": 3.475799817309901e-05, "num_env_steps_sampled": 400, "env_reset_timer": 0.0005287157524297323, "module_episode_returns_mean": {"default_policy": 1.05}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": 1.05}, "time_between_sampling": 10.39591404326711}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "b1762_00000", "date": "2025-08-11_18-27-05", "timestamp": 1754929625, "time_this_iter_s": 12.593243837356567, "time_total_s": 201.04808473587036, "pid": 10959, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 201.04808473587036, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 56.41111111111112, "ram_util_percent": 81.2}}
{"timers": {"training_iteration": 11.883072164959652, "restore_env_runners": 8.282435023415214e-06, "training_step": 11.882832865251668, "env_runner_sampling_timer": 2.1934385204606675, "learner_update_timer": 9.485098436321541, "synch_weights": 0.0018708018631846427, "restore_eval_env_runners": 5.869931644131866e-05, "evaluation_iteration": 0.13486619890559426, "synch_eval_env_connectors": 0.00020852850159598714, "synch_env_connectors": 7.39549807296474e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.0627887439232046e-06, "add_observations_from_episodes_to_batch": 3.1288803182519904e-06, "batch_individual_items": 1.4254702621928197e-05, "numpy_to_tensor": 1.5486368468073484e-05, "add_time_dim_to_batch_and_zero_pad": 9.128315476456104e-06}}, "connector_pipeline_timer": 7.000160420270025e-05}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.99885712862787e-06, "listify_data_for_vector_env": 1.1696616729762208e-05, "remove_single_ts_time_rank_from_batch": 1.3080748869186164e-05, "un_batch_to_individual_items": 7.389255823622141e-06, "get_actions": 4.8468085677854416e-05, "tensor_to_numpy": 1.782224437858e-05}}, "connector_pipeline_timer": 0.00013781391338791305}, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "num_episodes": 250.0, "episode_len_max": 20, "rlmodule_inference_timer": 3.819935235121247e-05, "episode_len_min": 20, "time_between_sampling": 0.044001412349424104, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 5.0282184966765846e-05, "agent_episode_returns_mean": {"default_agent": 1.3400000000000003}, "num_episodes_lifetime": -524375.0, "episode_return_mean": 1.3400000000000003, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.006549775721856338, "env_step_timer": 1.6573130736046265e-05, "episode_len_mean": 20.0, "episode_return_max": 9.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.006197266328148544, "module_episode_returns_mean": {"default_policy": 1.3400000000000003}, "num_env_steps_sampled_lifetime": -10487500.0, "weights_seq_no": 18.0, "episode_return_min": -10.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 2946.1082660855072}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1600812560957845, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.010737047307018422, "add_observations_from_episodes_to_batch": 0.0008927674714361577, "add_columns_from_episodes_to_train_batch": 0.044095689757341044, "add_time_dim_to_batch_and_zero_pad": 0.09279851411498044, "add_states_from_episodes_to_batch": 0.0036933719615168436, "batch_individual_items": 0.0076276695982637945, "numpy_to_tensor": 7.177892560119102e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_env_steps_trained_lifetime": 4104000, "num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 1364580, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 43875.21282927175}, "intrinsic_reward_module": {"weights_seq_no": 114.0, "num_module_steps_trained_lifetime": 682290, "module_train_batch_size_mean": 997.4940209352853, "num_module_steps_trained": 35910, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 96.0}, "default_policy": {"policy_loss": -0.00011296815500827506, "num_module_steps_trained_lifetime": 682290, "module_train_batch_size_mean": 997.4940209352853, "vf_loss_unclipped": 40.171451568603516, "num_module_steps_trained": 35910, "total_loss": 0.24857883155345917, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 4.4546650315169245e-05, "vf_explained_var": 0.0010644793510437012, "diff_num_grad_updates_vs_sampler_policy": 96.0, "entropy": 0.6706644296646118, "weights_seq_no": 114.0, "vf_loss": 0.3205432593822479}}}, "IntrinsicAttentionMask": [[[0.16665665805339813, 0.16667616367340088, 0.16653645038604736, 0.16680100560188293, 0.16682054102420807, 0.1665092259645462], [0.16665786504745483, 0.16667501628398895, 0.16655215620994568, 0.16678480803966522, 0.16680197417736053, 0.16652821004390717], [0.16664913296699524, 0.1666831523180008, 0.16643962264060974, 0.1669009029865265, 0.16693496704101562, 0.16639219224452972], [0.16666558384895325, 0.16666769981384277, 0.1666526347398758, 0.16668114066123962, 0.16668324172496796, 0.1666496843099594], [0.16666679084300995, 0.16666653752326965, 0.1666683405637741, 0.16666492819786072, 0.16666467487812042, 0.16666868329048157], [0.16664743423461914, 0.16668474674224854, 0.1664177030324936, 0.16692353785037994, 0.1669609099626541, 0.16636569797992706]], [[0.16667601466178894, 0.16657695174217224, 0.1666392982006073, 0.16685163974761963, 0.16675247251987457, 0.16650356352329254], [0.16668245196342468, 0.16651490330696106, 0.16662032902240753, 0.16697968542575836, 0.16681183874607086, 0.1663908064365387], [0.16667839884757996, 0.16655395925045013, 0.1666322648525238, 0.16689908504486084, 0.16677448153495789, 0.1664617657661438], [0.16666454076766968, 0.16668687760829926, 0.16667282581329346, 0.1666249781847, 0.1666473150253296, 0.16670344769954681], [0.1666710525751114, 0.16662485897541046, 0.16665393114089966, 0.1667529195547104, 0.16670669615268707, 0.166590616106987], [0.16668717563152313, 0.16646887362003326, 0.16660623252391815, 0.16707462072372437, 0.1668557971715927, 0.1663072407245636]], [[0.16596169769763947, 0.16682641208171844, 0.16647492349147797, 0.16652394831180573, 0.16719010472297668, 0.16702300310134888], [0.1665583848953247, 0.16669124364852905, 0.16663730144500732, 0.16664482653141022, 0.16674694418907166, 0.16672135889530182], [0.16631604731082916, 0.16674616932868958, 0.1665714681148529, 0.16659584641456604, 0.16692674160003662, 0.16684380173683167], [0.166349858045578, 0.16673851013183594, 0.1665806621313095, 0.16660268604755402, 0.166901633143425, 0.16682671010494232], [0.1668088287115097, 0.16663439571857452, 0.1667051613330841, 0.16669528186321259, 0.16656136512756348, 0.16659489274024963], [0.1666937917470932, 0.16666051745414734, 0.16667401790618896, 0.16667212545871735, 0.1666465699672699, 0.16665297746658325]], [[0.1666894108057022, 0.16664229333400726, 0.16678166389465332, 0.16666321456432343, 0.16661609709262848, 0.16660736501216888], [0.16672244668006897, 0.16660678386688232, 0.16694900393486023, 0.16665813326835632, 0.16654251515865326, 0.1665211021900177], [0.16662463545799255, 0.16671162843704224, 0.1664545238018036, 0.1666729897260666, 0.16676001250743866, 0.1667761504650116], [0.16670775413513184, 0.16662253439426422, 0.16687466204166412, 0.1666603833436966, 0.16657517850399017, 0.1665593981742859], [0.1667407900094986, 0.16658702492713928, 0.1670420914888382, 0.1666552871465683, 0.16650161147117615, 0.1664731502532959], [0.16674691438674927, 0.1665804535150528, 0.16707314550876617, 0.16665436327457428, 0.16648799180984497, 0.1664571762084961]], [[0.16606396436691284, 0.1663130521774292, 0.1665775030851364, 0.16724388301372528, 0.1666756272315979, 0.16712592542171478], [0.16621102392673492, 0.16639943420886993, 0.16659939289093018, 0.1671028733253479, 0.16667355597019196, 0.16701377928256989], [0.16636696457862854, 0.16649094223976135, 0.16662247478961945, 0.1669534146785736, 0.16667123138904572, 0.16689488291740417], [0.166759192943573, 0.16672086715698242, 0.166680246591568, 0.16657821834087372, 0.1666651964187622, 0.16659624874591827], [0.16642479598522186, 0.16652487218379974, 0.16663102805614471, 0.16689807176589966, 0.16667039692401886, 0.16685084998607635], [0.16668984293937683, 0.166680246591568, 0.1666700690984726, 0.16664451360702515, 0.16666629910469055, 0.16664902865886688]], [[0.1665252149105072, 0.16689932346343994, 0.1665668487548828, 0.16658766567707062, 0.16670005023479462, 0.16672088205814362], [0.1668122410774231, 0.16642747819423676, 0.166769340634346, 0.16674789786338806, 0.16663222014904022, 0.16661079227924347], [0.1665571928024292, 0.16684672236442566, 0.1665894091129303, 0.16660551726818085, 0.16669251024723053, 0.16670863330364227], [0.1665731817483902, 0.1668204367160797, 0.16660070419311523, 0.16661445796489716, 0.16668875515460968, 0.1667025238275528], [0.16665944457054138, 0.16667859256267548, 0.1666615754365921, 0.16666263341903687, 0.16666840016841888, 0.16666945815086365], [0.16667540371418, 0.16665229201316833, 0.16667282581329346, 0.1666715443134308, 0.16666460037231445, 0.16666331887245178]]], "default_policy": {"num_module_steps_trained_lifetime": 113715, "module_train_batch_size_mean": 997.9718428097785, "vf_loss_unclipped": 40.130126953125, "num_module_steps_trained": 5985, "num_trainable_parameters": 16595, "total_loss": 0.24854189157485962, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 4.4545748096425086e-05, "weights_seq_no": 19.0, "vf_loss": 0.3205108940601349, "curr_kl_coeff": 3.0819688845440396e-07, "vf_explained_var": -9.322166442871094e-05, "policy_loss": -0.00011755544983316213, "entropy": 0.6706655025482178, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 639.6818408359412}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 113715, "module_train_batch_size_mean": 997.9718428097785, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5985, "num_trainable_parameters": 8266, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 19.0, "num_module_steps_trained_lifetime_throughput": 639.686191588906}, "__all_modules__": {"num_env_steps_trained_lifetime": 684000, "num_env_steps_trained": 36000, "num_module_steps_trained_lifetime": 227430, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3850.381564316387, "num_module_steps_trained_throughput": 19239662.044411678, "num_module_steps_trained_lifetime_throughput": 12339951.287646612}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.25, "sample": 0.12290673101033718, "env_step_timer": 1.8105433369715155e-05, "episode_return_max": 13.5, "episode_return_min": -14.5, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.323844413166796e-06, "numpy_to_tensor": 1.577758114808027e-05, "add_time_dim_to_batch_and_zero_pad": 8.562581709823549e-06, "add_states_from_episodes_to_batch": 3.3670547564579015e-06, "batch_individual_items": 1.5581848746825147e-05}}, "connector_pipeline_timer": 7.461491525343763e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes_lifetime": 380, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 95400, "episode_duration_sec_mean": 0.0057476608362048865, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 7.555156118984776e-06, "get_actions": 4.591183748816824e-05, "tensor_to_numpy": 1.8293746342383558e-05, "normalize_and_clip_actions": 9.29225377844584e-06, "remove_single_ts_time_rank_from_batch": 1.4396728376563393e-05, "listify_data_for_vector_env": 1.3204583590383767e-05}}, "connector_pipeline_timer": 0.00013951978711493104}, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "episode_len_max": 20, "weights_seq_no": 19.0, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "num_episodes": 20, "rlmodule_inference_timer": 3.675684430552034e-05, "num_env_steps_sampled": 400, "env_reset_timer": 0.0005278577648359527, "module_episode_returns_mean": {"default_policy": 1.25}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": 1.25}, "time_between_sampling": 10.407758969494788}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "b1762_00000", "date": "2025-08-11_18-27-16", "timestamp": 1754929636, "time_this_iter_s": 11.634788036346436, "time_total_s": 212.6828727722168, "pid": 10959, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 212.6828727722168, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 47.5625, "ram_util_percent": 82.4625}}
{"timers": {"training_iteration": 11.876809274559964, "restore_env_runners": 8.267110605082756e-06, "training_step": 11.876569804519878, "env_runner_sampling_timer": 2.1900996015054504, "learner_update_timer": 9.482208575288146, "synch_weights": 0.0018640542639133447, "restore_eval_env_runners": 5.823941388374394e-05, "evaluation_iteration": 0.13505552857625408, "synch_eval_env_connectors": 0.00020786196661467247, "synch_env_connectors": 7.368212830602293e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.1917927522010565e-06, "add_observations_from_episodes_to_batch": 3.2738426508296444e-06, "batch_individual_items": 1.463488635467193e-05, "numpy_to_tensor": 1.553612396314359e-05, "add_time_dim_to_batch_and_zero_pad": 8.521762144849047e-06}}, "connector_pipeline_timer": 7.115705739475672e-05}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.265400394191313e-06, "listify_data_for_vector_env": 1.2072039719953027e-05, "remove_single_ts_time_rank_from_batch": 1.3347779604378119e-05, "un_batch_to_individual_items": 7.57424750369565e-06, "get_actions": 5.0981020424620774e-05, "tensor_to_numpy": 1.854443763685914e-05}}, "connector_pipeline_timer": 0.00014271032928787772}, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "num_episodes": 250.0, "episode_len_max": 20, "rlmodule_inference_timer": 3.9891657432837636e-05, "episode_len_min": 20, "time_between_sampling": 0.0403279639840444, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 5.235097779580731e-05, "agent_episode_returns_mean": {"default_agent": 1.5800000000000005}, "num_episodes_lifetime": -555250.0, "episode_return_mean": 1.5800000000000005, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.006524961868788355, "env_step_timer": 1.7496226559119843e-05, "episode_len_mean": 20.0, "episode_return_max": 9.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.006387438346631824, "module_episode_returns_mean": {"default_policy": 1.5800000000000005}, "num_env_steps_sampled_lifetime": -11105000.0, "weights_seq_no": 19.0, "episode_return_min": -10.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 2867.787400918106}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.15999369978500882, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.010716868923943607, "add_observations_from_episodes_to_batch": 0.0008938822957741568, "add_columns_from_episodes_to_train_batch": 0.04406692953042652, "add_time_dim_to_batch_and_zero_pad": 0.09275901730377763, "add_states_from_episodes_to_batch": 0.003693804081718305, "batch_individual_items": 0.007627557072449497, "numpy_to_tensor": 7.171196667923155e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_env_steps_trained_lifetime": 4320000, "num_env_steps_trained": 216000, "num_module_steps_trained_lifetime": 1436400, "num_module_steps_trained": 71820, "num_env_steps_trained_lifetime_throughput": 43190.406692687764}, "intrinsic_reward_module": {"weights_seq_no": 120.0, "num_module_steps_trained_lifetime": 718200, "module_train_batch_size_mean": 997.4935477577241, "num_module_steps_trained": 35910, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 101.0}, "default_policy": {"policy_loss": -0.0017855368787422776, "num_module_steps_trained_lifetime": 718200, "module_train_batch_size_mean": 997.4935477577241, "vf_loss_unclipped": 40.781028747558594, "num_module_steps_trained": 35910, "total_loss": 0.24692848324775696, "use_intrinsic_rewards": 1.0, "mean_kl_loss": 0.00015779606474097818, "vf_explained_var": 0.0011757612228393555, "diff_num_grad_updates_vs_sampler_policy": 101.0, "entropy": 0.6669396162033081, "weights_seq_no": 120.0, "vf_loss": 0.3205408751964569}}}, "IntrinsicAttentionMask": [[[0.16669748723506927, 0.16647204756736755, 0.16657724976539612, 0.16684187948703766, 0.1666162610054016, 0.16679507493972778], [0.1667403131723404, 0.1662008911371231, 0.16645248234272003, 0.16708636283874512, 0.1665458381175995, 0.16697415709495544], [0.16672034561634064, 0.16632744669914246, 0.16651074588298798, 0.16697221994400024, 0.1665787398815155, 0.16689057648181915], [0.16666999459266663, 0.16664567589759827, 0.16665701568126678, 0.1666855365037918, 0.16666123270988464, 0.1666804999113083], [0.1667129248380661, 0.1663743555545807, 0.16653233766555786, 0.1669299155473709, 0.16659089922904968, 0.16685958206653595], [0.16667890548706055, 0.1665894240140915, 0.16663119196891785, 0.1667361855506897, 0.16664667427539825, 0.16671761870384216]], [[0.16643808782100677, 0.1668119877576828, 0.16674120724201202, 0.1665004938840866, 0.16687454283237457, 0.16663365066051483], [0.16690205037593842, 0.16651709377765656, 0.16658984124660492, 0.166837677359581, 0.16645285487174988, 0.16670049726963043], [0.16681425273418427, 0.16657288372516632, 0.16661851108074188, 0.16677390038967133, 0.16653260588645935, 0.16668790578842163], [0.1665155589580536, 0.16676272451877594, 0.16671594977378845, 0.16655682027339935, 0.16680406033992767, 0.1666448563337326], [0.16697964072227478, 0.1664678156375885, 0.16656450927257538, 0.16689401865005493, 0.16638246178627014, 0.16671161353588104], [0.16668078303337097, 0.16665767133235931, 0.1666620522737503, 0.16667692363262177, 0.1666538268327713, 0.16666869819164276]], [[0.166615828871727, 0.16663531959056854, 0.16674062609672546, 0.16651514172554016, 0.16677966713905334, 0.16671337187290192], [0.16662196815013885, 0.16663911938667297, 0.16673171520233154, 0.166533425450325, 0.16676604747772217, 0.16670775413513184], [0.1666550487279892, 0.16665950417518616, 0.16668355464935303, 0.1666320413351059, 0.16669246554374695, 0.1666773408651352], [0.16658413410186768, 0.1666157841682434, 0.16678670048713684, 0.1664208024740219, 0.16685007512569427, 0.1667424440383911], [0.16666731238365173, 0.16666705906391144, 0.1666657030582428, 0.1666686087846756, 0.1666651964187622, 0.16666606068611145], [0.16664649546146393, 0.16665422916412354, 0.16669601202011108, 0.16660653054714203, 0.16671150922775269, 0.16668520867824554]], [[0.16639457643032074, 0.1667683720588684, 0.16669760644435883, 0.16671843826770782, 0.16656926274299622, 0.16685175895690918], [0.16694699227809906, 0.16656193137168884, 0.1666346937417984, 0.16661326587200165, 0.16676682233810425, 0.1664762645959854], [0.16684240102767944, 0.1666010022163391, 0.16664662957191467, 0.16663320362567902, 0.16672948002815247, 0.1665472686290741], [0.16687320172786713, 0.16658951342105865, 0.16664312779903412, 0.16662733256816864, 0.16674049198627472, 0.16652637720108032], [0.16665273904800415, 0.16667187213897705, 0.16666826605796814, 0.1666693240404129, 0.16666167974472046, 0.16667614877223969], [0.16707023978233337, 0.16651590168476105, 0.16662061214447021, 0.16658978164196014, 0.1668108105659485, 0.16639266908168793]], [[0.166615828871727, 0.16663531959056854, 0.16674062609672546, 0.1667601466178894, 0.16677966713905334, 0.16646842658519745], [0.16662196815013885, 0.16663911938667297, 0.16673171520233154, 0.16674888134002686, 0.16676604747772217, 0.16649234294891357], [0.1666550487279892, 0.16665950417518616, 0.16668355464935303, 0.16668801009655, 0.16669246554374695, 0.1666213721036911], [0.16666118800640106, 0.1666633039712906, 0.1666746437549591, 0.16667674481868744, 0.16667884588241577, 0.16664530336856842], [0.16666731238365173, 0.16666705906391144, 0.1666657030582428, 0.1666654497385025, 0.1666651964187622, 0.16666920483112335], [0.16656938195228577, 0.16660666465759277, 0.16680802404880524, 0.16684535145759583, 0.1668827086687088, 0.16628777980804443]], [[0.16639456152915955, 0.1665068119764328, 0.16669759154319763, 0.16671842336654663, 0.1668308824300766, 0.16685174405574799], [0.16656044125556946, 0.16660428047180176, 0.1666787564754486, 0.16668687760829926, 0.16673074662685394, 0.16673888266086578], [0.16684240102767944, 0.1667698174715042, 0.16664662957191467, 0.16663320362567902, 0.16656069457530975, 0.1665472686290741], [0.16687318682670593, 0.16678787767887115, 0.16664311289787292, 0.16662731766700745, 0.1665421426296234, 0.16652636229991913], [0.16703937947750092, 0.1668853461742401, 0.16662409901618958, 0.16659562289714813, 0.16644199192523956, 0.16641353070735931], [0.1670701950788498, 0.16690340638160706, 0.16662056744098663, 0.16658973693847656, 0.16642342507839203, 0.16639263927936554]]], "default_policy": {"num_module_steps_trained_lifetime": 119700, "module_train_batch_size_mean": 997.9437895346426, "vf_loss_unclipped": 40.776161193847656, "num_module_steps_trained": 5985, "num_trainable_parameters": 16595, "total_loss": 0.24679149687290192, "use_intrinsic_rewards": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.00017356517491862178, "weights_seq_no": 20.0, "vf_loss": 0.320511132478714, "curr_kl_coeff": 1.5409844422720198e-07, "vf_explained_var": -0.0002359151840209961, "policy_loss": -0.001874128938652575, "entropy": 0.6667439937591553, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 638.0390668893721}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 119700, "module_train_batch_size_mean": 997.9437895346426, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5985, "num_trainable_parameters": 8266, "total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002715581955, "weights_seq_no": 20.0, "num_module_steps_trained_lifetime_throughput": 638.0428593871183}, "__all_modules__": {"num_env_steps_trained_lifetime": 720000, "num_env_steps_trained": 36000, "num_module_steps_trained_lifetime": 239400, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3840.404775086397, "num_module_steps_trained_throughput": 18759135.403298087, "num_module_steps_trained_lifetime_throughput": 12248928.448201165}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.45, "sample": 0.1230558199496452, "env_step_timer": 1.671607723456326e-05, "episode_return_max": 13.5, "episode_return_min": -14.5, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.2126245493380703e-06, "numpy_to_tensor": 1.6508313278440094e-05, "add_time_dim_to_batch_and_zero_pad": 8.457838103943543e-06, "add_states_from_episodes_to_batch": 2.9593462464304266e-06, "batch_individual_items": 1.4746839939565672e-05}}, "connector_pipeline_timer": 7.146093077618089e-05}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes_lifetime": 400, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 100400, "episode_duration_sec_mean": 0.005967534997034818, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 7.639423213124114e-06, "get_actions": 4.474521286832001e-05, "tensor_to_numpy": 1.7606708956690016e-05, "normalize_and_clip_actions": 9.212223771647622e-06, "remove_single_ts_time_rank_from_batch": 1.3267098242366916e-05, "listify_data_for_vector_env": 1.1773933763202989e-05}}, "connector_pipeline_timer": 0.00013491449684367534}, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "episode_len_max": 20, "weights_seq_no": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "num_episodes": 20, "rlmodule_inference_timer": 3.674386646973889e-05, "num_env_steps_sampled": 400, "env_reset_timer": 0.0005264954370309074, "module_episode_returns_mean": {"default_policy": 1.45}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": 1.45}, "time_between_sampling": 10.41661485022038}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "b1762_00000", "date": "2025-08-11_18-27-28", "timestamp": 1754929648, "time_this_iter_s": 11.408599138259888, "time_total_s": 224.09147191047668, "pid": 10959, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14a3b18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 6, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 6}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 224.09147191047668, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 46.462500000000006, "ram_util_percent": 82.05624999999999}}
