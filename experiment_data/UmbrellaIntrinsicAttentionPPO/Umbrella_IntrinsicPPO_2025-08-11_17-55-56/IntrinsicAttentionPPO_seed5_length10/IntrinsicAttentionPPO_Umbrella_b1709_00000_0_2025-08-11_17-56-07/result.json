{"timers": {"training_iteration": 9.033200166071765, "restore_env_runners": 1.2791948392987251e-05, "training_step": 9.033071583951823, "env_runner_sampling_timer": 1.6181290419772267, "learner_update_timer": 7.2435618749586865, "synch_weights": 0.0007861660560593009}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00012618457921490555, "timers": {"connectors": {"un_batch_to_individual_items": 6.8775542062684825e-06, "tensor_to_numpy": 1.5495801696334328e-05, "remove_single_ts_time_rank_from_batch": 1.2091783295103553e-05, "normalize_and_clip_actions": 9.957091648690388e-06, "get_actions": 4.406445041691259e-05, "listify_data_for_vector_env": 1.0646241576384054e-05}}}, "time_between_sampling": 0.000654673456098683, "episode_duration_sec_mean": 0.005248846005648372, "env_to_module_sum_episodes_length_in": 10.191744832559449, "num_env_steps_sampled_lifetime": 627500.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.925333355505478e-06, "add_time_dim_to_batch_and_zero_pad": 7.0710921521529024e-06, "numpy_to_tensor": 1.3163047026207446e-05, "add_states_from_episodes_to_batch": 2.685915293812362e-06, "batch_individual_items": 1.2623816802815013e-05}}, "connector_pipeline_timer": 6.215976905015606e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "agent_episode_returns_mean": {"default_agent": -3.5}, "weights_seq_no": 0.0, "module_episode_returns_mean": {"default_policy": -3.5}, "episode_return_min": -13.5, "num_env_steps_sampled": 5000.0, "num_episodes_lifetime": 31375.0, "rlmodule_inference_timer": 3.5165496261970875e-05, "episode_len_mean": 20.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "num_episodes": 250.0, "env_to_module_sum_episodes_length_out": 10.191744832559449, "env_step_timer": 1.4971511323064067e-05, "episode_return_mean": -3.5, "env_reset_timer": 8.088123308820064e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "sample": 0.006360188753605924, "episode_return_max": 6.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3058.202652596725}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000, "learner_connector": {"connector_pipeline_timer": 0.13451650005299598, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009373667067848146, "add_observations_from_episodes_to_batch": 0.0008356251055374742, "add_columns_from_episodes_to_train_batch": 0.0411105410894379, "add_time_dim_to_batch_and_zero_pad": 0.0751109579578042, "add_states_from_episodes_to_batch": 0.003684749943204224, "batch_individual_items": 0.004162832978181541, "numpy_to_tensor": 7.387495134025812e-05}}}, "learner_connector_sum_episodes_length_out": 5250}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "policy_loss": 7.309677312150598e-05, "use_intrinsic_rewards": 0.0, "weights_seq_no": 1.0, "vf_explained_var": 0.000460207462310791, "num_trainable_parameters": 16595, "vf_loss": 0.358365535736084, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.08079196512699127, "num_module_steps_trained": 5985, "total_loss": 0.2781939208507538, "module_train_batch_size_mean": 997.9705930399, "num_module_steps_trained_lifetime": 5985, "entropy": 0.6909081935882568, "vf_loss_unclipped": 46.65642547607422, "mean_kl_loss": 1.1895735042344313e-05, "num_module_steps_trained_lifetime_throughput": 828.1368344992676}, "IntrinsicAttentionMask": [[[0.09044273942708969, 0.09122677147388458, 0.09044764190912247, 0.09149538725614548, 0.0911816880106926, 0.09069901704788208, 0.09145016968250275, 0.09066913276910782, 0.09065419435501099, 0.09034337848424911, 0.09138991683721542], [0.091706283390522, 0.09036476910114288, 0.0916978046298027, 0.0899123102426529, 0.09044107049703598, 0.09126433730125427, 0.08998821675777435, 0.09131570160388947, 0.09134139120578766, 0.09187855571508408, 0.09008953720331192], [0.09045065939426422, 0.09122137725353241, 0.09045547246932983, 0.0914854034781456, 0.0911770612001419, 0.090702585875988, 0.09144096076488495, 0.09067321568727493, 0.0906585305929184, 0.09035297483205795, 0.09138173609972], [0.09213738888502121, 0.09006977081298828, 0.09212427586317062, 0.08937612175941467, 0.09018692374229431, 0.091454416513443, 0.08949236571788788, 0.09153369814157486, 0.09157336503267288, 0.09240409731864929, 0.08964759856462479], [0.09163384139537811, 0.09041430801153183, 0.0916261374950409, 0.09000261127948761, 0.09048371016979218, 0.09123225510120392, 0.09007170051336288, 0.09127893298864365, 0.0913022831082344, 0.0917903333902359, 0.09016389399766922], [0.09085659682750702, 0.09094486385583878, 0.09085714817047119, 0.09097494930028915, 0.09093980491161346, 0.09088551998138428, 0.09096989035606384, 0.09088215231895447, 0.09088046848773956, 0.09084536135196686, 0.09096314758062363], [0.09206489473581314, 0.09011942148208618, 0.09205254912376404, 0.0894661620259285, 0.09022971987724304, 0.09142255038022995, 0.08957566320896149, 0.09149713069200516, 0.09153444319963455, 0.09231565147638321, 0.08972186595201492], [0.09080839157104492, 0.0909777358174324, 0.09080944955348969, 0.09103550016880035, 0.09096803516149521, 0.09086386859416962, 0.09102578461170197, 0.09085740894079208, 0.09085417538881302, 0.09078684449195862, 0.09101283550262451], [0.09078428149223328, 0.09099416434764862, 0.09078559279441833, 0.09106577187776566, 0.09098213165998459, 0.09085302799940109, 0.09105372428894043, 0.0908450186252594, 0.09084101021289825, 0.0907575786113739, 0.09103767573833466], [0.09028205275535583, 0.09133610129356384, 0.09028863161802292, 0.09169794619083405, 0.0912754014134407, 0.09062623977661133, 0.0916370078921318, 0.0905860885977745, 0.09056602418422699, 0.0901486948132515, 0.09155582636594772], [0.09196823090314865, 0.09018558263778687, 0.09195693582296371, 0.0895862802863121, 0.0902867317199707, 0.09138000011444092, 0.08968675881624222, 0.09144831448793411, 0.0914824903011322, 0.09219777584075928, 0.08982090651988983]], [[0.09122491627931595, 0.09109261631965637, 0.09121222048997879, 0.09120586514472961, 0.09107359498739243, 0.09119316190481186, 0.09138520807027817, 0.0911804661154747, 0.08802461624145508, 0.09120386093854904, 0.09120338410139084], [0.09199345111846924, 0.09152079373598099, 0.09194798767566681, 0.09192527085542679, 0.09145297110080719, 0.09187984466552734, 0.09256840497255325, 0.09183444082736969, 0.08104236423969269, 0.09191808849573135, 0.09191637486219406], [0.09130092710256577, 0.0911361575126648, 0.0912851095199585, 0.09127719700336456, 0.09111246466636658, 0.0912613794207573, 0.09150063246488571, 0.09124556183815002, 0.08733177930116653, 0.091274693608284, 0.09127409756183624], [0.09133875370025635, 0.09115772694349289, 0.09132136404514313, 0.09131266921758652, 0.09113170206546783, 0.09129529446363449, 0.09155818819999695, 0.09127791225910187, 0.0869872123003006, 0.09130992740392685, 0.09130927175283432], [0.0920998603105545, 0.09157788753509521, 0.09204964339733124, 0.0920245498418808, 0.09150300174951553, 0.09197437763214111, 0.09273519366979599, 0.09192423522472382, 0.08007996529340744, 0.09201662242412567, 0.09201472997665405], [0.09141401201486588, 0.09120045602321625, 0.09139350056648254, 0.09138324856758118, 0.09116975963115692, 0.09136273711919785, 0.09167298674583435, 0.09134224057197571, 0.08630175143480301, 0.09138000756502151, 0.09137923270463943], [0.09022405743598938, 0.09049727767705917, 0.09025023877620697, 0.09026332944631577, 0.0905366763472557, 0.09028952568769455, 0.08989468216896057, 0.09031572192907333, 0.09719262272119522, 0.09026747196912766, 0.09026845544576645], [0.09148881584405899, 0.09124268591403961, 0.09146517515182495, 0.09145335108041763, 0.09120731800794601, 0.09142971783876419, 0.09178740531206131, 0.09140608459711075, 0.08562120795249939, 0.09144961088895798, 0.09144871681928635], [0.10072275251150131, 0.09182518720626831, 0.09983288496732712, 0.0993908941745758, 0.09061098843812943, 0.09851279109716415, 0.11264458298683167, 0.0976424440741539, 0.01034737378358841, 0.09925162047147751, 0.09921841323375702], [0.09135066717863083, 0.09116450697183609, 0.09133279323577881, 0.0913238525390625, 0.09113774448633194, 0.09130597859621048, 0.09157635271549225, 0.09128811210393906, 0.08687856793403625, 0.09132102876901627, 0.09132035821676254], [0.09135351330041885, 0.09116613119840622, 0.09133552014827728, 0.0913265272974968, 0.09113918989896774, 0.09130853414535522, 0.09158068895339966, 0.09129054844379425, 0.08685266226530075, 0.09132368117570877, 0.09132300317287445]], [[0.0903891995549202, 0.0914713591337204, 0.09069014340639114, 0.09114272147417068, 0.09142615646123886, 0.09064532071352005, 0.09109768271446228, 0.09061545133590698, 0.09060052782297134, 0.09058559685945511, 0.09133581072092056], [0.09233725816011429, 0.08938239514827728, 0.09150230139493942, 0.0902659147977829, 0.0895032212138176, 0.09162599593400955, 0.09038793295621872, 0.09170854836702347, 0.09174985438585281, 0.09179117530584335, 0.08974536508321762], [0.0909312441945076, 0.0908852145075798, 0.09091838449239731, 0.09089913219213486, 0.09088712930679321, 0.09092029929161072, 0.09090104699134827, 0.09092157334089279, 0.09092220664024353, 0.09092284739017487, 0.09089094400405884], [0.09174598753452301, 0.09001129865646362, 0.09125816822052002, 0.09053242951631546, 0.09008269011974335, 0.09133055061101913, 0.09060423076152802, 0.0913788378238678, 0.09140299260616302, 0.09142715483903885, 0.09022564440965652], [0.09225594252347946, 0.08946861326694489, 0.09146884828805923, 0.09030257910490036, 0.08958269655704498, 0.09158547222614288, 0.09041772037744522, 0.09166330844163895, 0.09170225262641907, 0.09174121171236038, 0.0898112878203392], [0.09085053205490112, 0.09097225219011307, 0.09088451415300369, 0.09093542397022247, 0.09096719324588776, 0.09087946265935898, 0.09093036502599716, 0.09087608754634857, 0.09087440371513367, 0.09087271988391876, 0.09095707535743713], [0.09166492521762848, 0.09009785950183868, 0.0912245362997055, 0.09056893736124039, 0.09016241133213043, 0.09128990024328232, 0.0906338319182396, 0.09133349359035492, 0.09135530889034271, 0.09137711673974991, 0.09029165655374527], [0.09079673886299133, 0.0910302996635437, 0.09086190909147263, 0.09095960110425949, 0.09102058410644531, 0.09085221588611603, 0.0909498929977417, 0.0908457562327385, 0.09084252268075943, 0.09083929657936096, 0.09100116044282913], [0.09076985716819763, 0.09105933457612991, 0.09085061401128769, 0.0909716933965683, 0.09104729443788528, 0.09083859622478485, 0.09095966070890427, 0.09083058685064316, 0.09082658588886261, 0.09082257747650146, 0.09102321416139603], [0.09074296802282333, 0.09108836948871613, 0.09083930402994156, 0.09098377078771591, 0.09107399731874466, 0.09082496911287308, 0.09096941351890564, 0.09081541746854782, 0.09081064164638519, 0.09080585837364197, 0.09104526042938232], [0.09209342300891876, 0.08964121341705322, 0.09140187501907349, 0.0903758555650711, 0.08974175155162811, 0.09150438755750656, 0.09047722816467285, 0.09157279133796692, 0.09160701930522919, 0.09164125472307205, 0.08994317054748535]], [[0.08824602514505386, 0.08820831775665283, 0.08892164379358292, 0.08813294023275375, 0.0880952849984169, 0.08880769461393356, 0.09072820842266083, 0.08798238635063171, 0.1115337386727333, 0.08962862938642502, 0.08971499651670456], [0.08818937093019485, 0.08815094083547592, 0.08887806534767151, 0.08807411044836044, 0.08803572505712509, 0.08876190334558487, 0.09072008728981018, 0.0879206657409668, 0.11198343336582184, 0.08959884196519852, 0.08968690037727356], [0.0892329066991806, 0.08920832723379135, 0.08967261016368866, 0.08915919065475464, 0.08913462609052658, 0.08959853649139404, 0.09084256738424301, 0.08906099945306778, 0.1037713810801506, 0.09013146162033081, 0.0901874229311943], [0.08807560056447983, 0.0880357176065445, 0.08879037946462631, 0.08795599639415741, 0.08791615813970566, 0.0886697992682457, 0.09070324897766113, 0.08779677748680115, 0.11288751661777496, 0.08953869342803955, 0.0896301344037056], [0.088018499314785, 0.08797789365053177, 0.08874630182981491, 0.08789671957492828, 0.08785616606473923, 0.0886235162615776, 0.09069455415010452, 0.08773461729288101, 0.11334194988012314, 0.08950836211442947, 0.08960149437189102], [0.089070163667202, 0.08904335647821426, 0.08954988420009613, 0.08898976445198059, 0.08896297961473465, 0.0894690454006195, 0.09082736074924469, 0.088882677257061, 0.10504225641489029, 0.09005071967840195, 0.09011182188987732], [0.09162537008523941, 0.09163684397935867, 0.09142085164785385, 0.0916597992181778, 0.09167128056287766, 0.09145520627498627, 0.09088370203971863, 0.09170572459697723, 0.08554904907941818, 0.09120897203683853, 0.09118323773145676], [0.08784627914428711, 0.08780350536108017, 0.08861304074525833, 0.08771802484989166, 0.0876753106713295, 0.08848366141319275, 0.09066730737686157, 0.08754729479551315, 0.11471476405858994, 0.0894162729382515, 0.08951446413993835], [0.10532847046852112, 0.1057758554816246, 0.09765614569187164, 0.10667633265256882, 0.10712944716215134, 0.09890582412481308, 0.07999840378761292, 0.10850036144256592, 0.01032619271427393, 0.09028057754039764, 0.08942243456840515], [0.09021023660898209, 0.09019962698221207, 0.09039989858865738, 0.09017839282751083, 0.09016777575016022, 0.09036798775196075, 0.09090196341276169, 0.09013594686985016, 0.09621967375278473, 0.0905972495675087, 0.09062128514051437], [0.09032591432332993, 0.0903170183300972, 0.09048482775688171, 0.09029922634363174, 0.09029032289981842, 0.09045809507369995, 0.09090524166822433, 0.09026364982128143, 0.09533542394638062, 0.09065013378858566, 0.09067025780677795]], [[0.0904427245259285, 0.09122674912214279, 0.09074383974075317, 0.09149536490440369, 0.09148029237985611, 0.09040292352437973, 0.09115162491798401, 0.09066911041736603, 0.0906541720032692, 0.09034335613250732, 0.09138989448547363], [0.09170622378587723, 0.0903647169470787, 0.09118729084730148, 0.08991225063800812, 0.08993754535913467, 0.09177516400814056, 0.09049190580844879, 0.09131564199924469, 0.09134133160114288, 0.0918784961104393, 0.09008947759866714], [0.09092893451452255, 0.09089554846286774, 0.09091607481241226, 0.09088417887687683, 0.09088481962680817, 0.09093064069747925, 0.09089873731136322, 0.09091926366090775, 0.09091990441083908, 0.0909331887960434, 0.09088864177465439], [0.09213723987340927, 0.09006962180137634, 0.09133546054363251, 0.08937597274780273, 0.08941470086574554, 0.09224393963813782, 0.0902649536728859, 0.09153354167938232, 0.09157320857048035, 0.09240394085645676, 0.08964744210243225], [0.09211307764053345, 0.09008617699146271, 0.09132719784975052, 0.08940598368644714, 0.08944395929574966, 0.09221764653921127, 0.09027770161628723, 0.09152135998010635, 0.0915602445602417, 0.09237445890903473, 0.08967220783233643], [0.09037835896015167, 0.09127052873373032, 0.09072088450193405, 0.09157643467187881, 0.0915592610836029, 0.09033309668302536, 0.09118499606847763, 0.09063586592674255, 0.09061887115240097, 0.09026537090539932, 0.09145630896091461], [0.09158550202846527, 0.09044726192951202, 0.09114549309015274, 0.09006278216838837, 0.09008429199457169, 0.09164392203092575, 0.09055529534816742, 0.0912543535232544, 0.0912761464715004, 0.0917314812541008, 0.09021341800689697], [0.09080839157104492, 0.0909777358174324, 0.09087356925010681, 0.09103550016880035, 0.09103225916624069, 0.09079976379871368, 0.09096156060695648, 0.09085740894079208, 0.09085417538881302, 0.09078684449195862, 0.09101283550262451], [0.09078428149223328, 0.09099417179822922, 0.09086505323648453, 0.09106577932834625, 0.09106176346540451, 0.09077358990907669, 0.0909741148352623, 0.09084502607584, 0.09084101766347885, 0.0907575860619545, 0.09103768318891525], [0.09028201550245285, 0.09133606404066086, 0.09068647027015686, 0.09169790893793106, 0.09167759120464325, 0.0902285948395729, 0.09123492985963821, 0.09058605134487152, 0.090565986931324, 0.09014865756034851, 0.09155578911304474], [0.0919681191444397, 0.09018547832965851, 0.09127750992774963, 0.08958616852760315, 0.08961965143680573, 0.09205996245145798, 0.09035412222146988, 0.09144820272922516, 0.09148237854242325, 0.09219766408205032, 0.08982080221176147]], [[0.08824750036001205, 0.08820979297161102, 0.0889231339097023, 0.08813441544771194, 0.08884714543819427, 0.08805910497903824, 0.08996343612670898, 0.08873329311609268, 0.11153559386730194, 0.0896301344037056, 0.08971649408340454], [0.08819089084863663, 0.0881524533033371, 0.08887958526611328, 0.08807563036680222, 0.08880212903022766, 0.08799886703491211, 0.08994022011756897, 0.08868607133626938, 0.11198534071445465, 0.08960037678480148, 0.08968843519687653], [0.08923351019620895, 0.0892089381814003, 0.08967322111129761, 0.08915980160236359, 0.0896238312125206, 0.08911069482564926, 0.09034795314073563, 0.08954980224370956, 0.10377208888530731, 0.09013208001852036, 0.09018804877996445], [0.08807723224163055, 0.08803734928369522, 0.08879203349351883, 0.08795762807130814, 0.08871161937713623, 0.08787797391414642, 0.08989326655864716, 0.08859115093946457, 0.1128896027803421, 0.08954036235809326, 0.08963179588317871], [0.08912524580955505, 0.08909918367862701, 0.08959164470434189, 0.08904707431793213, 0.08953925222158432, 0.08899498730897903, 0.09030760824680328, 0.08946070820093155, 0.10461792349815369, 0.09007851034402847, 0.09013789892196655], [0.08796300739049911, 0.08792167156934738, 0.08870381861925125, 0.08783906698226929, 0.08862047642469406, 0.08775652945041656, 0.08984559774398804, 0.08849560469388962, 0.11380022764205933, 0.08947964012622833, 0.08957445621490479], [0.09065229445695877, 0.09064832329750061, 0.09072308987379074, 0.09064039587974548, 0.09071515500545502, 0.09063246101140976, 0.09083116054534912, 0.09070324897766113, 0.0928516611456871, 0.09079665690660477, 0.09080561250448227], [0.08896178752183914, 0.08893349021673203, 0.0894680991768837, 0.08887694031000137, 0.08941120654344559, 0.08882042020559311, 0.0902457907795906, 0.0893259346485138, 0.10589806735515594, 0.08999687433242798, 0.09006139636039734], [0.10550743341445923, 0.105955570936203, 0.09782207012176514, 0.10685758292675018, 0.0986548364162445, 0.10776727646589279, 0.08716586977243423, 0.09991730749607086, 0.010343768633902073, 0.0904339849948883, 0.08957438170909882], [0.09021034836769104, 0.09019973129034042, 0.09040001034736633, 0.09017849713563919, 0.09037873148918152, 0.09015727043151855, 0.0906900018453598, 0.0903468206524849, 0.09621979296207428, 0.09059736132621765, 0.09062138944864273], [0.0903259813785553, 0.09031708538532257, 0.09048490226268768, 0.09029928594827652, 0.09046707302331924, 0.09028150141239166, 0.0907277837395668, 0.09044034034013748, 0.09533549845218658, 0.09065020084381104, 0.09067032486200333]]], "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"use_intrinsic_rewards": 1.0, "weights_seq_no": 6.0, "vf_loss": 0.35866132378578186, "policy_loss": 7.650649058632553e-05, "vf_explained_var": 0.001262664794921875, "total_loss": 0.2784278690814972, "diff_num_grad_updates_vs_sampler_policy": 6.0, "num_module_steps_trained": 35910, "entropy": 0.6909001469612122, "vf_loss_unclipped": 46.52370834350586, "module_train_batch_size_mean": 997.8474438281662, "num_module_steps_trained_lifetime": 35910, "mean_kl_loss": 1.2491907909861766e-05}, "intrinsic_reward_module": {"total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 6.0, "module_train_batch_size_mean": 997.8474438281662, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 35910, "weights_seq_no": 6.0}, "__all_modules__": {"num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 198000, "num_module_steps_trained_lifetime": 71820, "num_env_steps_trained_lifetime_throughput": 60010.09662940862}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 11970, "num_env_steps_trained_lifetime": 33000, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime_throughput": 4568.128279855428, "num_module_steps_trained_throughput": 29550779.088034682, "num_module_steps_trained_lifetime_throughput": 15210985.59839918}, "intrinsic_reward_module": {"total_loss": 0.0, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "default_optimizer_learning_rate": 0.0002715581955, "module_train_batch_size_mean": 997.9705930399, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 5985, "weights_seq_no": 1.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 828.1513407574608}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.374321831080219e-05, "module_to_env_connector": {"connector_pipeline_timer": 0.00012060599669283371, "timers": {"connectors": {"tensor_to_numpy": 1.6050628556253406e-05, "normalize_and_clip_actions": 8.323414616722194e-06, "listify_data_for_vector_env": 1.044063386948633e-05, "un_batch_to_individual_items": 6.676428047522848e-06, "remove_single_ts_time_rank_from_batch": 1.2557976709953386e-05, "get_actions": 4.015534882907845e-05}}}, "agent_episode_returns_mean": {"default_agent": -0.3}, "env_step_timer": 1.4431633135334351e-05, "env_reset_timer": 0.00016687496099621058, "env_to_module_connector": {"connector_pipeline_timer": 6.275267117191226e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.489310404859369e-06, "add_observations_from_episodes_to_batch": 3.0661144237833086e-06, "add_states_from_episodes_to_batch": 2.7723914863036365e-06, "numpy_to_tensor": 1.2382636206909536e-05, "batch_individual_items": 1.2657849414598403e-05}}}, "sample": 0.11552808294072747, "episode_return_max": 12.5, "episode_len_mean": 20.0, "episode_len_max": 20, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "episode_duration_sec_mean": 0.005285193806048483, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": -0.3}, "env_to_module_sum_episodes_length_out": 10.216013141322508, "num_env_steps_sampled_lifetime": 5400, "env_to_module_sum_episodes_length_in": 10.216013141322508, "weights_seq_no": 1.0, "episode_return_min": -15.5, "num_env_steps_sampled": 400, "num_episodes_lifetime": 20, "num_episodes": 20, "episode_return_mean": -0.3, "num_module_steps_sampled_lifetime": {"default_policy": 400}}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "b1709_00000", "date": "2025-08-11_18-32-43", "timestamp": 1754929963, "time_this_iter_s": 9.157968282699585, "time_total_s": 9.157968282699585, "pid": 11351, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3845f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9.157968282699585, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 32.0, "ram_util_percent": 78.52857142857145}}
{"timers": {"training_iteration": 9.035668314001523, "restore_env_runners": 1.2736528879031539e-05, "training_step": 9.035538821442751, "env_runner_sampling_timer": 1.6204211561370176, "learner_update_timer": 7.2435743149591145, "synch_weights": 0.0007870931446086615, "restore_eval_env_runners": 7.541966624557972e-06, "evaluation_iteration": 0.12257320794742554, "synch_eval_env_connectors": 0.00013391696847975254, "synch_env_connectors": 4.292000085115433e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00013210744419663833, "timers": {"connectors": {"un_batch_to_individual_items": 7.187234786048222e-06, "tensor_to_numpy": 1.7260137346976986e-05, "remove_single_ts_time_rank_from_batch": 1.27540483417769e-05, "normalize_and_clip_actions": 8.731574593402472e-06, "get_actions": 4.6065456376710234e-05, "listify_data_for_vector_env": 1.1537216070208935e-05}}}, "time_between_sampling": 0.028626661854955337, "episode_duration_sec_mean": 0.005971029824111609, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": 10000.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.085537107816284e-06, "add_time_dim_to_batch_and_zero_pad": 7.684419200931195e-06, "numpy_to_tensor": 1.4779235271363308e-05, "add_states_from_episodes_to_batch": 2.8751631981459194e-06, "batch_individual_items": 1.5770337727715053e-05}}, "connector_pipeline_timer": 6.791734764263231e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "agent_episode_returns_mean": {"default_agent": -2.6999999999999993}, "weights_seq_no": 1.0, "module_episode_returns_mean": {"default_policy": -2.6999999999999993}, "episode_return_min": -13.5, "num_env_steps_sampled": 5000.0, "num_episodes_lifetime": 500.0, "rlmodule_inference_timer": 3.6509481326816795e-05, "episode_len_mean": 20.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "num_episodes": 250.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.641997263908069e-05, "episode_return_mean": -2.6999999999999993, "env_reset_timer": 5.210417943348829e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "sample": 0.006340367052145651, "episode_return_max": 6.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3025.826128443923}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13451372505165635, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009367761646863072, "add_observations_from_episodes_to_batch": 0.000836388855241239, "add_columns_from_episodes_to_train_batch": 0.041111208598595114, "add_time_dim_to_batch_and_zero_pad": 0.07511199045809917, "add_states_from_episodes_to_batch": 0.0036851216037757694, "batch_individual_items": 0.004163237148895859, "numpy_to_tensor": 7.398787187412381e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "policy_loss": -0.00040418229764327407, "use_intrinsic_rewards": 0.0, "weights_seq_no": 2.0, "vf_explained_var": 0.0006952881813049316, "num_trainable_parameters": 16595, "vf_loss": 0.3583126962184906, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.040395982563495636, "num_module_steps_trained": 5985, "total_loss": 0.27767613530158997, "module_train_batch_size_mean": 997.9429069707118, "num_module_steps_trained_lifetime": 11970, "entropy": 0.6904649138450623, "vf_loss_unclipped": 49.40400314331055, "mean_kl_loss": 2.3723641788819805e-05, "num_module_steps_trained_lifetime_throughput": 827.116233402252}, "IntrinsicAttentionMask": [[[0.0904424637556076, 0.09152526408433914, 0.09074358642101288, 0.0914951041340828, 0.09118141233921051, 0.0906987413764, 0.09144989401102066, 0.09037288278341293, 0.09035798907279968, 0.09034310281276703, 0.09138964116573334], [0.09218360483646393, 0.08923365920782089, 0.09135004132986069, 0.0893140584230423, 0.09015629440546036, 0.0914735272526741, 0.08943479508161545, 0.09237770736217499, 0.09241931885480881, 0.09246094524860382, 0.08959602564573288], [0.09092894196510315, 0.09088291227817535, 0.09091608226299286, 0.09088418632745743, 0.09089747071266174, 0.09091799706220627, 0.09088610112667084, 0.09093192219734192, 0.09093255549669266, 0.09093319624662399, 0.09088864922523499], [0.09213542938232422, 0.08929680287837982, 0.09133366495370865, 0.08937421441078186, 0.09018499404191971, 0.091452457010746, 0.08949045836925507, 0.09232208877801895, 0.09236209839582443, 0.09240212291479111, 0.08964568376541138], [0.09163317084312439, 0.08995591849088669, 0.09116160869598389, 0.09000194817781448, 0.09048304706811905, 0.0912315845489502, 0.09007102996110916, 0.09174271672964096, 0.09176617860794067, 0.09178965538740158, 0.0901632308959961], [0.09085660427808762, 0.09097833186388016, 0.09089058637619019, 0.09097495675086975, 0.09093981236219406, 0.09088553488254547, 0.09096989780664444, 0.09084873646497726, 0.09084705263376236, 0.09084536880254745, 0.09096315503120422], [0.09206315129995346, 0.0893915444612503, 0.0913090631365776, 0.0894644632935524, 0.09022800624370575, 0.09142081439495087, 0.08957396447658539, 0.0922386571764946, 0.09227626770734787, 0.09231390058994293, 0.08972016721963882], [0.09032978862524033, 0.09167425334453583, 0.09070328623056412, 0.09163675457239151, 0.09124688804149628, 0.09064764529466629, 0.09158053994178772, 0.09024351835250854, 0.09022506326436996, 0.09020660072565079, 0.09150563925504684], [0.09030567109584808, 0.09170616418123245, 0.09069464355707169, 0.09166709333658218, 0.0912608951330185, 0.09063669294118881, 0.09160851687192917, 0.09021583199501038, 0.09019661694765091, 0.09017739444971085, 0.09153047949075699], [0.09028154611587524, 0.09173807501792908, 0.09068599343299866, 0.09169743210077286, 0.09127488732337952, 0.09062573313713074, 0.09163649380207062, 0.09018814563751221, 0.09016816318035126, 0.0901481881737709, 0.09155530482530594], [0.09196676313877106, 0.08951792865991592, 0.09127616137266159, 0.0895848497748375, 0.0902852937579155, 0.09137853980064392, 0.08968532830476761, 0.09212742745876312, 0.09216185659170151, 0.09219630062580109, 0.08981947600841522]], [[0.08980053663253784, 0.08931808173656464, 0.08929500728845596, 0.08973094075918198, 0.08970774710178375, 0.08922579884529114, 0.09038756787776947, 0.08917968720197678, 0.10293222963809967, 0.09018494188785553, 0.09023747593164444], [0.08895694464445114, 0.08815228193998337, 0.08811385929584503, 0.08884067088365555, 0.08880195021629333, 0.08799869567155838, 0.08994004875421524, 0.08792200684547424, 0.11198511719703674, 0.08960020542144775, 0.0896882638335228], [0.08891470730304718, 0.0880947858095169, 0.08805564045906067, 0.0887962281703949, 0.08875676989555359, 0.08793830871582031, 0.0899166464805603, 0.08786017447710037, 0.1124364361166954, 0.08957026898860931, 0.08966001868247986], [0.08968336135149002, 0.08915405720472336, 0.08912873268127441, 0.08960698544979095, 0.08958154171705246, 0.08905283361673355, 0.09032778441905975, 0.08900226652622223, 0.10419415682554245, 0.09010529518127441, 0.0901629775762558], [0.08964399248361588, 0.08909910172224045, 0.08907303959131241, 0.08956536650657654, 0.08953917026519775, 0.08899490535259247, 0.09030752629041672, 0.08894286304712296, 0.10461782664060593, 0.09007842093706131, 0.09013781696557999], [0.0887870341539383, 0.08792146295309067, 0.08788014948368073, 0.08866193145513535, 0.08862026780843735, 0.08775632083415985, 0.08984538167715073, 0.08767387270927429, 0.11379994451999664, 0.08947942405939102, 0.08957424759864807], [0.09073101729154587, 0.09064831584692001, 0.09064434468746185, 0.09071911126375198, 0.09071514010429382, 0.09063245356082916, 0.09083114564418793, 0.09062452614307404, 0.0928516611456871, 0.09079664945602417, 0.09080559760332108], [0.08870109170675278, 0.08780518174171448, 0.08776242285966873, 0.08857157826423645, 0.08852845430374146, 0.08763428777456284, 0.08979696780443192, 0.08754896372556686, 0.11471692472696304, 0.08941797912120819, 0.08951617032289505], [0.09697499871253967, 0.10593226552009583, 0.10638221353292465, 0.09821595996618271, 0.09863314032554626, 0.10774356871843338, 0.08714671432971954, 0.10866079479455948, 0.010341515764594078, 0.09041409939527512, 0.08955468237400055], [0.09042128175497055, 0.09019972383975983, 0.09018909931182861, 0.09038935601711273, 0.09037871658802032, 0.09015727043151855, 0.0906900018453598, 0.09013604372739792, 0.09621979296207428, 0.09059735387563705, 0.09062138199806213], [0.09050271660089493, 0.09031707793474197, 0.09030818194150925, 0.09047597646713257, 0.09046706557273865, 0.09028149396181107, 0.09072776883840561, 0.09026370942592621, 0.09533549100160599, 0.09065019339323044, 0.09067031741142273]], [[0.09008238464593887, 0.0915999561548233, 0.09002227336168289, 0.0921471044421196, 0.0921163558959961, 0.08993218094110489, 0.09144722670316696, 0.0904693678021431, 0.08984217792749405, 0.09040898829698563, 0.09193207323551178], [0.09113799035549164, 0.09071699529886246, 0.09115485846996307, 0.09056738018989563, 0.09057575464248657, 0.09118016064167023, 0.09075895696878433, 0.09102978557348251, 0.09120546281337738, 0.09104662388563156, 0.09062604606151581], [0.09004014730453491, 0.09163510799407959, 0.08997700363397598, 0.09221047908067703, 0.09217813611030579, 0.08988236635923386, 0.09147452563047409, 0.09044673293828964, 0.08978782594203949, 0.09038330614566803, 0.0919843316078186], [0.09151379019021988, 0.09040084481239319, 0.0915585458278656, 0.09000737965106964, 0.09002938121557236, 0.09162571281194687, 0.09051139652729034, 0.09122692048549652, 0.09169293195009232, 0.0912715271115303, 0.0901615247130394], [0.09149274975061417, 0.09041858464479446, 0.09153593331575394, 0.0900387242436409, 0.09005997329950333, 0.09160074591636658, 0.0905253142118454, 0.09121591597795486, 0.0916656032204628, 0.09125896543264389, 0.09018755704164505], [0.08997681736946106, 0.09168782085180283, 0.08990911394357681, 0.09230559319257736, 0.0922708585858345, 0.0898076668381691, 0.09151545912027359, 0.09041277319192886, 0.08970633894205093, 0.09034474939107895, 0.09206274896860123], [0.09103263914585114, 0.09080544859170914, 0.09104172885417938, 0.09072459489107132, 0.09072912484407425, 0.09105537086725235, 0.09082811325788498, 0.09097428619861603, 0.09106900542974472, 0.09098337590694427, 0.09075630456209183], [0.09035341441631317, 0.09137393534183502, 0.09031287580728531, 0.09174051880836487, 0.09171994030475616, 0.0902521014213562, 0.09127148985862732, 0.0906141847372055, 0.09019137173891068, 0.09057352691888809, 0.09159653633832932], [0.08991347998380661, 0.09174051880836487, 0.08984123915433884, 0.09240075945854187, 0.0923636332154274, 0.08973298966884613, 0.0915563553571701, 0.0903787836432457, 0.08962486684322357, 0.09030617028474808, 0.09214118123054504], [0.09031122177839279, 0.09140916913747787, 0.09026762843132019, 0.09180378168821335, 0.0917816236615181, 0.09020227938890457, 0.0912989005446434, 0.0905916839838028, 0.09013696759939194, 0.09054794907569885, 0.09164877235889435], [0.09136641025543213, 0.09052495658397675, 0.09140019118785858, 0.09022687375545502, 0.09024355560541153, 0.09145089238882065, 0.09060865640640259, 0.09114975482225418, 0.0915016159415245, 0.09118346124887466, 0.09034369140863419]], [[0.09124790132045746, 0.09124154597520828, 0.09110921621322632, 0.09110287576913834, 0.09122248739004135, 0.09109018743038177, 0.09140823036432266, 0.09107750654220581, 0.08804678916931152, 0.09122683852910995, 0.09122636169195175], [0.09128879755735397, 0.09128166735172272, 0.09113310277462006, 0.0911259725689888, 0.09126026928424835, 0.09111173450946808, 0.09146883338689804, 0.09109749644994736, 0.08770237118005753, 0.09126514196395874, 0.09126460552215576], [0.09211469441652298, 0.0920911431312561, 0.09160173684358597, 0.09157831966876984, 0.09202054888010025, 0.09153150767087936, 0.09271030873060226, 0.09148471802473068, 0.0807955414056778, 0.09203663468360901, 0.09203486144542694], [0.09215307235717773, 0.09212873131036758, 0.09162285923957825, 0.09159865975379944, 0.09205575287342072, 0.09155028313398361, 0.09276885539293289, 0.09150192141532898, 0.08047696202993393, 0.09207239001989365, 0.0920705497264862], [0.09141075611114502, 0.09140127897262573, 0.09120393544435501, 0.09119447320699692, 0.09137284755706787, 0.09117557108402252, 0.09165003895759583, 0.09115666151046753, 0.08667640388011932, 0.0913793295621872, 0.0913786068558693], [0.09222950041294098, 0.09220356494188309, 0.09166473895311356, 0.0916389673948288, 0.09212581813335419, 0.09158743917942047, 0.09288566559553146, 0.09153594821691513, 0.07984323054552078, 0.09214353561401367, 0.09214159101247787], [0.09017711877822876, 0.09019019454717636, 0.0904633104801178, 0.09047643840312958, 0.09022945165634155, 0.09050268679857254, 0.08984791487455368, 0.0905289500951767, 0.09714201092720032, 0.09022050350904465, 0.09022149443626404], [0.09230548143386841, 0.09227795898914337, 0.09170613437891006, 0.09167878329753876, 0.09219543635845184, 0.09162412583827972, 0.09300211817026138, 0.09156949073076248, 0.07921405136585236, 0.09221424907445908, 0.09221217036247253], [0.10241591930389404, 0.10196249932050705, 0.09295542538166046, 0.09254389256238937, 0.10061424970626831, 0.09172628074884415, 0.11453811079263687, 0.09091588854789734, 0.010521368123590946, 0.10092004388570786, 0.1008862853050232], [0.09138305485248566, 0.09137410670518875, 0.09118790179491043, 0.09117897599935532, 0.09134728461503983, 0.09116113185882568, 0.09160881489515305, 0.09114328771829605, 0.08690935373306274, 0.0913534015417099, 0.09135272353887558], [0.09138611704111099, 0.09137711673974991, 0.0911896750330925, 0.09118068963289261, 0.09135011583566666, 0.09116272628307343, 0.09161336719989777, 0.09114477038383484, 0.08688364923000336, 0.09135627001523972, 0.0913555920124054]], [[0.09049677103757858, 0.09128127247095108, 0.09050167351961136, 0.09155004471540451, 0.0912361592054367, 0.09045694768428802, 0.09120609611272812, 0.09072329103946686, 0.09070834517478943, 0.090693399310112, 0.09114600718021393], [0.09161398559808731, 0.09027382731437683, 0.09160551428794861, 0.08982182294130325, 0.09035005420446396, 0.09168285876512527, 0.09040089696645737, 0.09122379124164581, 0.09124945849180222, 0.09127513319253922, 0.09050267189741135], [0.0905037671327591, 0.0912749394774437, 0.0905085876584053, 0.09153912216424942, 0.0912306010723114, 0.09046461433172226, 0.0912010446190834, 0.09072645753622055, 0.09071176499128342, 0.09069706499576569, 0.09114197641611099], [0.09199520945549011, 0.08993078768253326, 0.09198211133480072, 0.08923820406198502, 0.09004775434732437, 0.09210174530744553, 0.09012582153081894, 0.09139244258403778, 0.09143204987049103, 0.09147167950868607, 0.0902821496129036], [0.09154992550611496, 0.09033150970935822, 0.09154222905635834, 0.08992019295692444, 0.09040084481239319, 0.09161249548196793, 0.09044710546731949, 0.09119534492492676, 0.09121867269277573, 0.0912420004606247, 0.09053968638181686], [0.09043987840414047, 0.09133265167474747, 0.09044545143842697, 0.09163876622915268, 0.09128127992153168, 0.09039458632469177, 0.09124705940485, 0.09069755673408508, 0.0906805470585823, 0.09066354483366013, 0.09117864072322845], [0.09150721877813339, 0.09036996215581894, 0.09150003641843796, 0.08998581022024155, 0.09043470770120621, 0.09156559407711029, 0.09047789871692657, 0.0911763608455658, 0.09119813144207001, 0.09121990948915482, 0.09056434035301208], [0.0908200591802597, 0.09098942577838898, 0.09082111716270447, 0.09104719758033752, 0.09097971767187119, 0.09081143140792847, 0.09097325056791306, 0.09086908400058746, 0.0908658504486084, 0.09086261689662933, 0.0909603089094162], [0.09079873561859131, 0.09100866317749023, 0.09080005437135696, 0.09108027815818787, 0.0909966230392456, 0.09078804403543472, 0.09098859876394272, 0.09085948765277863, 0.09085547924041748, 0.09085147827863693, 0.09097255766391754], [0.09077741950750351, 0.0910278931260109, 0.09077898412942886, 0.0911133661866188, 0.09101352840662003, 0.09076466411352158, 0.09100395441055298, 0.09084989130496979, 0.09084511548280716, 0.09084033221006393, 0.09098480641841888], [0.09142183512449265, 0.09044688194990158, 0.09141568094491959, 0.09011716395616531, 0.09050243347883224, 0.091471828520298, 0.09053949266672134, 0.09113837033510208, 0.09115702658891678, 0.09117568284273148, 0.09061364084482193]], [[0.08972447365522385, 0.08970127999782562, 0.08967810124158859, 0.08965492993593216, 0.08963176608085632, 0.08960860222578049, 0.09031100571155548, 0.0895622968673706, 0.10231893509626389, 0.08964760601520538, 0.0901610404253006], [0.08968336135149002, 0.0896594226360321, 0.08963549137115479, 0.08961156755685806, 0.08958764374256134, 0.08956373482942581, 0.09028901159763336, 0.08951592445373535, 0.10271564871072769, 0.08960400521755219, 0.0901341438293457], [0.08964213728904724, 0.08961743861436844, 0.08959275484085083, 0.08956807851791382, 0.0895434096455574, 0.08951874822378159, 0.0902668833732605, 0.08946944028139114, 0.10311374068260193, 0.08956028521060944, 0.09010712057352066], [0.08960076421499252, 0.08957532048225403, 0.08954988420009613, 0.08952445536851883, 0.08949903398752213, 0.08947362005710602, 0.0902445912361145, 0.0894228145480156, 0.10351318120956421, 0.08951641619205475, 0.09007994085550308], [0.08955925703048706, 0.08953306078910828, 0.08950687199831009, 0.0894806981086731, 0.0894545242190361, 0.0894283652305603, 0.09022215753793716, 0.0893760621547699, 0.10391400009393692, 0.08947242796421051, 0.09005260467529297], [0.08951760083436966, 0.08949065953493118, 0.0894637256860733, 0.08943679928779602, 0.08940988034009933, 0.08938296884298325, 0.0901995524764061, 0.08932917565107346, 0.10431617498397827, 0.08942829072475433, 0.09002512693405151], [0.0907169058918953, 0.09071293473243713, 0.09070896357297897, 0.09070499241352081, 0.09070102870464325, 0.09069705754518509, 0.09081701934337616, 0.09068912267684937, 0.09275667369365692, 0.09070374071598053, 0.0907914787530899], [0.08943390846252441, 0.08940546959638596, 0.08937704563140869, 0.08934862166643143, 0.08932020515203476, 0.08929180353879929, 0.09015393257141113, 0.08923501521348953, 0.10512468218803406, 0.08933963626623154, 0.08996973186731339], [0.09941058605909348, 0.0998159646987915, 0.10022299736738205, 0.10063168406486511, 0.10104204714298248, 0.10145407915115356, 0.08971689641475677, 0.10228319466114044, 0.012565668672323227, 0.10076121240854263, 0.09209573268890381], [0.08958765864372253, 0.08956197649240494, 0.08953630179166794, 0.08951064199209213, 0.08948498219251633, 0.08945932984352112, 0.09023752063512802, 0.08940805494785309, 0.10363972932100296, 0.08950252830982208, 0.09007131308317184], [0.09047164767980576, 0.09046273678541183, 0.09045382589101791, 0.0904449075460434, 0.09043600410223007, 0.09042709320783615, 0.09069662541151047, 0.0904092788696289, 0.09511663764715195, 0.09044209867715836, 0.09063918888568878]]], "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"use_intrinsic_rewards": 1.0, "weights_seq_no": 12.0, "vf_loss": 0.3586404323577881, "policy_loss": -0.00038426893297582865, "vf_explained_var": 0.0012342333793640137, "total_loss": 0.2779528498649597, "diff_num_grad_updates_vs_sampler_policy": 11.0, "num_module_steps_trained": 35910, "entropy": 0.6904906034469604, "vf_loss_unclipped": 49.109283447265625, "module_train_batch_size_mean": 997.7412016936058, "num_module_steps_trained_lifetime": 71820, "mean_kl_loss": 2.1381380065577105e-05}, "intrinsic_reward_module": {"total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 11.0, "module_train_batch_size_mean": 997.7412016936058, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 71820, "weights_seq_no": 12.0}, "__all_modules__": {"num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 396000, "num_module_steps_trained_lifetime": 143640, "num_env_steps_trained_lifetime_throughput": 59700.74029690983}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 23940, "num_env_steps_trained_lifetime": 66000, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime_throughput": 4562.4785714289665, "num_module_steps_trained_throughput": 29134908.653993748, "num_module_steps_trained_lifetime_throughput": 15121762.68355406}, "intrinsic_reward_module": {"total_loss": 0.0, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "default_optimizer_learning_rate": 0.0002715581955, "module_train_batch_size_mean": 997.9429069707118, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 11970, "weights_seq_no": 2.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 827.1305062737442}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.165165476675129e-05, "module_to_env_connector": {"connector_pipeline_timer": 0.00011587115198451769, "timers": {"connectors": {"tensor_to_numpy": 1.526026223396627e-05, "normalize_and_clip_actions": 7.95804744698187e-06, "listify_data_for_vector_env": 1.0495312536740254e-05, "un_batch_to_individual_items": 6.521629243363739e-06, "remove_single_ts_time_rank_from_batch": 1.194453505939247e-05, "get_actions": 3.6945739073412414e-05}}}, "agent_episode_returns_mean": {"default_agent": -0.8}, "env_step_timer": 1.4096822513463079e-05, "env_reset_timer": 0.00016883246134966612, "env_to_module_connector": {"connector_pipeline_timer": 5.997907038186587e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.332759490215037e-06, "add_observations_from_episodes_to_batch": 2.8221335422183706e-06, "add_states_from_episodes_to_batch": 2.773760202074158e-06, "numpy_to_tensor": 1.207654795385303e-05, "batch_individual_items": 1.2497353592603836e-05}}}, "sample": 0.1155624654411804, "episode_return_max": 12.5, "episode_len_mean": 20.0, "episode_len_max": 20, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "episode_duration_sec_mean": 0.005348372904700227, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": -0.8}, "env_to_module_sum_episodes_length_out": 10.366003441359926, "num_env_steps_sampled_lifetime": 10400, "env_to_module_sum_episodes_length_in": 10.366003441359926, "weights_seq_no": 2.0, "episode_return_min": -15.5, "num_env_steps_sampled": 400, "num_episodes_lifetime": 40, "num_episodes": 20, "episode_return_mean": -0.8, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "time_between_sampling": 9.332267125020735}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "b1709_00000", "date": "2025-08-11_18-32-53", "timestamp": 1754929973, "time_this_iter_s": 9.410379886627197, "time_total_s": 18.568348169326782, "pid": 11351, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3845f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18.568348169326782, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 39.98461538461538, "ram_util_percent": 78.25384615384615}}
{"timers": {"training_iteration": 9.038627688361704, "restore_env_runners": 1.2677493563387542e-05, "training_step": 9.038497269477613, "env_runner_sampling_timer": 1.6198489874849213, "learner_update_timer": 7.246958693888981, "synch_weights": 0.0007883563828305341, "restore_eval_env_runners": 7.555707124993205e-06, "evaluation_iteration": 0.1226229312887881, "synch_eval_env_connectors": 0.00013393946923315523, "synch_env_connectors": 4.341999301686883e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00011981471004627646, "timers": {"connectors": {"un_batch_to_individual_items": 6.694183006141217e-06, "tensor_to_numpy": 1.536687965176785e-05, "remove_single_ts_time_rank_from_batch": 1.1976514625061949e-05, "normalize_and_clip_actions": 8.00873610756774e-06, "get_actions": 4.0768762311533213e-05, "listify_data_for_vector_env": 1.0554786402937142e-05}}}, "time_between_sampling": 0.030669651584842864, "episode_duration_sec_mean": 0.0053443795507773775, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -607500.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8417302989652934e-06, "add_time_dim_to_batch_and_zero_pad": 6.917683039210167e-06, "numpy_to_tensor": 1.3072799114157617e-05, "add_states_from_episodes_to_batch": 2.6683101217123108e-06, "batch_individual_items": 1.2455692637439296e-05}}, "connector_pipeline_timer": 6.008232814100919e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "agent_episode_returns_mean": {"default_agent": -3.339999999999999}, "weights_seq_no": 2.0, "module_episode_returns_mean": {"default_policy": -3.339999999999999}, "episode_return_min": -13.5, "num_env_steps_sampled": 5000.0, "num_episodes_lifetime": -30375.0, "rlmodule_inference_timer": 3.2361309855531164e-05, "episode_len_mean": 20.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "num_episodes": 250.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.4239092032083986e-05, "episode_return_mean": -3.339999999999999, "env_reset_timer": 4.644034025172743e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "sample": 0.006161905538612648, "episode_return_max": 6.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3190.9757942819897}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1345273423801176, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009365130689903162, "add_observations_from_episodes_to_batch": 0.0008367587165441364, "add_columns_from_episodes_to_train_batch": 0.041113731513195674, "add_time_dim_to_batch_and_zero_pad": 0.07512147597373696, "add_states_from_episodes_to_batch": 0.0036897216381737963, "batch_individual_items": 0.004162583527155221, "numpy_to_tensor": 7.411549335811287e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "policy_loss": -0.00022900394105818123, "use_intrinsic_rewards": 0.0, "weights_seq_no": 3.0, "vf_explained_var": -2.205371856689453e-05, "num_trainable_parameters": 16595, "vf_loss": 0.3583177328109741, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.020197991281747818, "num_module_steps_trained": 5985, "total_loss": 0.27785515785217285, "module_train_batch_size_mean": 997.9168410861561, "num_module_steps_trained_lifetime": 17955, "entropy": 0.6898574233055115, "vf_loss_unclipped": 43.46027374267578, "mean_kl_loss": 2.219064481323585e-05, "num_module_steps_trained_lifetime_throughput": 825.1148057380944}, "IntrinsicAttentionMask": [[[0.09019099920988083, 0.0917104035615921, 0.09013081341981888, 0.09164920449256897, 0.09222742170095444, 0.09004061669111252, 0.09216587990522385, 0.08998052775859833, 0.09054821729660034, 0.08992049098014832, 0.09143533557653427], [0.09110759198665619, 0.09068673104047775, 0.09112444519996643, 0.09070350974798203, 0.09054554253816605, 0.09114973992109299, 0.09056229889392853, 0.09116660058498383, 0.09100783616304398, 0.09118346869945526, 0.09076225757598877], [0.09015428274869919, 0.09175125509500504, 0.09009105712175369, 0.0916869044303894, 0.09229497611522675, 0.08999629318714142, 0.09223024547100067, 0.08993317931890488, 0.09052961319684982, 0.08987011015415192, 0.09146204590797424], [0.09107105433940887, 0.09072767198085785, 0.0910848006606102, 0.090741366147995, 0.09061241149902344, 0.09110542386770248, 0.09062609076499939, 0.0911191776394844, 0.09098968654870987, 0.09113293141126633, 0.0907893180847168], [0.0914149358868599, 0.09034169465303421, 0.09145808219909668, 0.0903843343257904, 0.08998338133096695, 0.09152284264564514, 0.09002585709095001, 0.09156603366136551, 0.09115985035896301, 0.09160925447940826, 0.09053372591733932], [0.09009920060634613, 0.09181252866983414, 0.09003141522407532, 0.09174345433712006, 0.09239636361598969, 0.08992982655763626, 0.09232684224843979, 0.089862160384655, 0.09050168842077255, 0.08979455381631851, 0.09150208532810211], [0.09137847274541855, 0.09038267284631729, 0.09141848981380463, 0.09042225778102875, 0.09005003422498703, 0.09147854149341583, 0.09008947014808655, 0.09151860326528549, 0.09114187210798264, 0.09155867993831635, 0.0905609205365181], [0.0900624543428421, 0.09185335040092468, 0.08999162912368774, 0.0917811170220375, 0.09246397018432617, 0.08988548815250397, 0.0923912525177002, 0.08981480449438095, 0.09048302471637726, 0.08974416553974152, 0.09152873605489731], [0.0904083102941513, 0.0914684385061264, 0.09036620706319809, 0.09142584353685379, 0.09182795882225037, 0.09030309319496155, 0.09178519248962402, 0.09026103466749191, 0.090658038854599, 0.09021900594234467, 0.09127691388130188], [0.09002570807933807, 0.09189418703317642, 0.08995184302330017, 0.09181879460811615, 0.09253161400556564, 0.08984116464853287, 0.09245569258928299, 0.0897674560546875, 0.09046435356140137, 0.08969379961490631, 0.0915553942322731], [0.09094314277172089, 0.09087097644805908, 0.0909460261464119, 0.09087385982275009, 0.0908467099070549, 0.09095035493373871, 0.09084959328174591, 0.09095323830842972, 0.09092605859041214, 0.09095612168312073, 0.09088394790887833]], [[0.08817978948354721, 0.0888928771018982, 0.08810443431138992, 0.08881692588329315, 0.08877897262573242, 0.08799153566360474, 0.09066010266542435, 0.08791634440422058, 0.11144997924566269, 0.0895613506436348, 0.08964765816926956], [0.0892445519566536, 0.08969463407993317, 0.08919692039489746, 0.08964675664901733, 0.08962282538414001, 0.08912551403045654, 0.09080423414707184, 0.08907793462276459, 0.10330178588628769, 0.09011531621217728, 0.09016954153776169], [0.08806383609771729, 0.08880449086427689, 0.08798559010028839, 0.08872558176517487, 0.08868616074323654, 0.0878683477640152, 0.09064102172851562, 0.08779027312994003, 0.11234696209430695, 0.08949901163578033, 0.08958868682384491], [0.08913388848304749, 0.08961216360330582, 0.08908327668905258, 0.08956127613782883, 0.08953585475683212, 0.0890074148774147, 0.09079192578792572, 0.08895687758922577, 0.104141004383564, 0.09005934000015259, 0.09011699259281158], [0.08907834440469742, 0.08957069367170334, 0.08902624994516373, 0.08951830863952637, 0.08949212729930878, 0.08894816040992737, 0.09078551083803177, 0.08889613300561905, 0.10456285625696182, 0.09003110229969025, 0.09009046107530594], [0.08788883686065674, 0.08867069333791733, 0.08780626207590103, 0.08858738839626312, 0.08854576200246811, 0.08768253773450851, 0.09061101824045181, 0.08760014921426773, 0.11370424181222916, 0.08940419554710388, 0.08949892967939377], [0.09164619445800781, 0.0914301797747612, 0.09166915714740753, 0.09145308285951614, 0.09146454185247421, 0.09170360118150711, 0.0909043699502945, 0.09172657132148743, 0.08556857705116272, 0.09122971445322037, 0.091203972697258], [0.0877714529633522, 0.08858069777488708, 0.08768599480390549, 0.08849445730447769, 0.08845136314630508, 0.08755797892808914, 0.09059006720781326, 0.08747272938489914, 0.1146169975399971, 0.08934011310338974, 0.08943821489810944], [0.10623487085103989, 0.09807994216680527, 0.10713925212621689, 0.09891490638256073, 0.09933504462242126, 0.10851029306650162, 0.08068692684173584, 0.10943404585123062, 0.010415169410407543, 0.09105753898620605, 0.09019199758768082], [0.09019120782613754, 0.09039146453142166, 0.09016997367143631, 0.09037018567323685, 0.09035955369472504, 0.09013814479112625, 0.0908827856183052, 0.09011692553758621, 0.0961994007229805, 0.09057813882827759, 0.09060215950012207], [0.09030994027853012, 0.09047774970531464, 0.09029215574264526, 0.0904599204659462, 0.09045100957155228, 0.09026547521352768, 0.09088917821645737, 0.09024769067764282, 0.09531857818365097, 0.09063410758972168, 0.09065423160791397]], [[0.09049675613641739, 0.09128125756978989, 0.09079805761575699, 0.0912511795759201, 0.09123615175485611, 0.09075319021940231, 0.09120608121156693, 0.09042713046073914, 0.09041222929954529, 0.0906933918595314, 0.09144449979066849], [0.09161397069692612, 0.09027381241321564, 0.09109555184841156, 0.09032461792230606, 0.09035003185272217, 0.0911724641919136, 0.09040088206529617, 0.09173443913459778, 0.09176024794578552, 0.09127511084079742, 0.08999885618686676], [0.0909266397356987, 0.09089325368404388, 0.09091378003358841, 0.09089452773332596, 0.0908951684832573, 0.09091569483280182, 0.09089643508195877, 0.09092961251735687, 0.09093025326728821, 0.09091824293136597, 0.09088634699583054], [0.09157127141952515, 0.09031227976083755, 0.09108438342809677, 0.09036002308130264, 0.09038390964269638, 0.09115663170814514, 0.09043169766664505, 0.09168439358472824, 0.09170862287282944, 0.09125304222106934, 0.09005383402109146], [0.09154991060495377, 0.09033149480819702, 0.09107878059148788, 0.09037771821022034, 0.09040083736181259, 0.09114868938922882, 0.0904470905661583, 0.09165935218334198, 0.0916827991604805, 0.0912419855594635, 0.09008131176233292], [0.09086267650127411, 0.09095095098018646, 0.09089665859937668, 0.09094757586717606, 0.09094589203596115, 0.09089160710573196, 0.09094251692295074, 0.09085480868816376, 0.09085312485694885, 0.09088486433029175, 0.09096923470497131], [0.0915072113275528, 0.09036995470523834, 0.09106758236885071, 0.09041311591863632, 0.09043470025062561, 0.09113282710313797, 0.09047789126634598, 0.09160931408405304, 0.09163118898868561, 0.09121990203857422, 0.09013631194829941], [0.09039729088544846, 0.09137112647294998, 0.09077107161283493, 0.09133375436067581, 0.09131506830453873, 0.09071537852287292, 0.09127772599458694, 0.0903109610080719, 0.09029248356819153, 0.09064119309186935, 0.09157402068376541], [0.09037598222494125, 0.09139034897089005, 0.09076526015996933, 0.09135141223669052, 0.09133195132017136, 0.09070726484060287, 0.09129303693771362, 0.09028608351945877, 0.09026684612035751, 0.09062999486923218, 0.09160174429416656], [0.09077741205692291, 0.0910278856754303, 0.09087379276752472, 0.09101831912994385, 0.09101352840662003, 0.09085945039987564, 0.09100395441055298, 0.09075511246919632, 0.09075033664703369, 0.09084033221006393, 0.09107982367277145], [0.09184559434652328, 0.09006533771753311, 0.09115590900182724, 0.09013266861438751, 0.0901663526892662, 0.09125815331935883, 0.09023375809192657, 0.09200605005025864, 0.09204043447971344, 0.09139464795589447, 0.08970114588737488]], [[0.08833115547895432, 0.08904547244310379, 0.0890074223279953, 0.08821795880794525, 0.0889313668012619, 0.088893361389637, 0.09004870802164078, 0.08806726336479187, 0.110698401927948, 0.08895736932754517, 0.08980154246091843], [0.08933640271425247, 0.08978694677352905, 0.08976297825574875, 0.0892648845911026, 0.08971507102251053, 0.08969111740589142, 0.09041743725538254, 0.08916961401700974, 0.10286176949739456, 0.08973144739866257, 0.09026234596967697], [0.08928421139717102, 0.08974888920783997, 0.08972417563199997, 0.08921045809984207, 0.08967475593090057, 0.08965005725622177, 0.09039928764104843, 0.08911220729351044, 0.10326501727104187, 0.0896916463971138, 0.09023929387331009], [0.08816678822040558, 0.08892257511615753, 0.08888231217861176, 0.08804705739021301, 0.08880181610584259, 0.08876160532236099, 0.08998466283082962, 0.08788766711950302, 0.11199316382408142, 0.08882933109998703, 0.08972293138504028], [0.08917944878339767, 0.08967235684394836, 0.08964613080024719, 0.08910122513771057, 0.08959370106458664, 0.08956749737262726, 0.09036252647638321, 0.08899703621864319, 0.10407570004463196, 0.08961162716150284, 0.09019271284341812], [0.08912687748670578, 0.08963388204574585, 0.08960690349340439, 0.0890464261174202, 0.08955296874046326, 0.08952601999044418, 0.0903439074754715, 0.08893927186727524, 0.10448314994573593, 0.08957140147686005, 0.09016919881105423], [0.09065959602594376, 0.09073437005281448, 0.09073039889335632, 0.09064769744873047, 0.09072245657444, 0.09071849286556244, 0.0908384844660759, 0.09063183516263962, 0.09277860820293427, 0.09072517603635788, 0.09081292897462845], [0.08794578164815903, 0.08875663578510284, 0.08871341496706009, 0.08781737834215164, 0.08862704038619995, 0.08858388662338257, 0.08989696949720383, 0.08764646202325821, 0.11374008655548096, 0.08865656703710556, 0.0896158516407013], [0.1050991415977478, 0.09734086692333221, 0.09773781150579453, 0.10639012604951859, 0.09853655099868774, 0.09893836081027985, 0.0874922126531601, 0.1081361398100853, 0.01225407887250185, 0.09826267510652542, 0.08981206268072128], [0.08921533077955246, 0.08969859778881073, 0.08967288583517075, 0.08913863450288773, 0.08962148427963257, 0.08959579467773438, 0.09037517011165619, 0.0890364721417427, 0.10379784554243088, 0.08963905274868011, 0.09020870923995972], [0.09034282714128494, 0.09051068872213364, 0.09050177037715912, 0.09031613171100616, 0.09048394113779068, 0.09047502279281616, 0.09074470400810242, 0.09028054773807526, 0.09516707062721252, 0.09049003571271896, 0.09068723767995834]], [[0.09019181877374649, 0.09232065826654434, 0.09073055535554886, 0.09165004640817642, 0.09161946177482605, 0.09004143625497818, 0.09155832231044769, 0.08998134732246399, 0.08995132893323898, 0.09051883220672607, 0.09143617749214172], [0.09147012233734131, 0.0898134782910347, 0.0910443365573883, 0.09032794088125229, 0.09035155922174454, 0.0915897935628891, 0.09039882570505142, 0.09163770824670792, 0.09166166931390762, 0.09121113270521164, 0.09049342572689056], [0.0905185341835022, 0.09167617559432983, 0.09081265330314636, 0.09131282567977905, 0.0912962257862091, 0.09043628722429276, 0.09126303344964981, 0.09040340781211853, 0.09038697183132172, 0.09069716185331345, 0.0911966934800148], [0.09107109904289246, 0.09059195220470428, 0.09094854444265366, 0.09074141830205917, 0.09074825793504715, 0.09110546857118607, 0.09076195955276489, 0.09111922234296799, 0.09112609922885895, 0.09099660068750381, 0.09078936278820038], [0.0910528153181076, 0.09062769263982773, 0.09094410389661789, 0.09076033532619476, 0.09076640754938126, 0.09108330309391022, 0.09077856689691544, 0.09109550714492798, 0.09110160171985626, 0.09098673611879349, 0.0908028855919838], [0.0901002362370491, 0.09250180423259735, 0.09070731699466705, 0.09174451231956482, 0.09170998632907867, 0.08993085473775864, 0.09164098650217056, 0.08986318856477737, 0.08982938528060913, 0.09046866744756699, 0.09150313585996628], [0.0910162627696991, 0.0906992182135582, 0.09093523025512695, 0.09079817682504654, 0.09080271422863007, 0.09103898704051971, 0.09081178158521652, 0.09104807674884796, 0.09105262160301208, 0.09096700698137283, 0.09082991629838943], [0.09006358683109283, 0.09257432073354721, 0.09069797396659851, 0.09178227931261063, 0.09174618124961853, 0.0898866206407547, 0.09167402982711792, 0.08981592953205109, 0.08978060632944107, 0.09044857323169708, 0.09152989834547043], [0.0900452584028244, 0.09261059015989304, 0.09069330245256424, 0.09180115908384323, 0.09176427125930786, 0.08986449986696243, 0.0916905477643013, 0.08979229629039764, 0.08975622057914734, 0.09043851494789124, 0.0915432721376419], [0.0903903990983963, 0.0919286459684372, 0.09078061580657959, 0.09144514799118042, 0.09142307192087173, 0.09028135985136032, 0.09137894213199615, 0.09023777395486832, 0.09021599590778351, 0.09062733501195908, 0.09129074215888977], [0.09094314277172089, 0.09084238111972809, 0.09091740101575851, 0.09087385982275009, 0.0908752977848053, 0.09095034748315811, 0.09087818115949631, 0.09095323085784912, 0.09095467627048492, 0.09092749655246735, 0.09088394790887833]], [[0.09123674780130386, 0.0911044180393219, 0.09109808504581451, 0.09109173715114594, 0.09108539670705795, 0.09107905626296997, 0.0915234312415123, 0.09106636792421341, 0.08815772086381912, 0.09134180843830109, 0.09121520817279816], [0.09203881025314331, 0.09156592190265656, 0.0915433019399643, 0.09152068197727203, 0.09149806201457977, 0.0914754569530487, 0.09306934475898743, 0.09143025428056717, 0.08148092031478882, 0.09241551160812378, 0.09196170419454575], [0.0920761227607727, 0.09158679097890854, 0.091563381254673, 0.09153997153043747, 0.09151657670736313, 0.09149318188428879, 0.0931428074836731, 0.0914464145898819, 0.08117243647575378, 0.09246598929166794, 0.09199632704257965], [0.09211333096027374, 0.09160754084587097, 0.09158334136009216, 0.09155914932489395, 0.09153497219085693, 0.09151079505681992, 0.09321620315313339, 0.09146245568990707, 0.08086501806974411, 0.09251637756824493, 0.0920308455824852], [0.09215043485164642, 0.09162817150354385, 0.09160318225622177, 0.09157821536064148, 0.09155324846506119, 0.09152828902006149, 0.09328953176736832, 0.0914783775806427, 0.0805586501955986, 0.09256666153669357, 0.0920652523636818], [0.09218742698431015, 0.09164868295192719, 0.09162291884422302, 0.09159716218709946, 0.09157140552997589, 0.09154566377401352, 0.09336280077695847, 0.09149419516324997, 0.08025334775447845, 0.09261685609817505, 0.09209955483675003], [0.08933543413877487, 0.08992213010787964, 0.08995037525892258, 0.08997862786054611, 0.09000688791275024, 0.09003515541553497, 0.08808029443025589, 0.09009172767400742, 0.1042957454919815, 0.08887293934822083, 0.08943063020706177], [0.09226111322641373, 0.09168938547372818, 0.09166204929351807, 0.09163471311330795, 0.09160739183425903, 0.09158007800579071, 0.09350915253162384, 0.09152547270059586, 0.07964590191841125, 0.09271698445081711, 0.09216783940792084], [0.10183263570070267, 0.09316462278366089, 0.09276783466339111, 0.09237273782491684, 0.09197932481765747, 0.09158758074045181, 0.12342461198568344, 0.09080910682678223, 0.01241687498986721, 0.10927549004554749, 0.10036922991275787], [0.09056667238473892, 0.09070101380348206, 0.09070746600627899, 0.09071391820907593, 0.09072037041187286, 0.0907268226146698, 0.09027696400880814, 0.09073972702026367, 0.09379829466342926, 0.09046029299497604, 0.0905885174870491], [0.09137046337127686, 0.09118303656578064, 0.09117405861616135, 0.09116508066654205, 0.09115609526634216, 0.09114711731672287, 0.09177691489458084, 0.09112916141748428, 0.08703873306512833, 0.09151935577392578, 0.09133994579315186]]], "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"use_intrinsic_rewards": 1.0, "weights_seq_no": 18.0, "vf_loss": 0.35860130190849304, "policy_loss": -0.00022218702360987663, "vf_explained_var": 0.0013912320137023926, "total_loss": 0.278085321187973, "diff_num_grad_updates_vs_sampler_policy": 16.0, "num_module_steps_trained": 35910, "entropy": 0.6898742318153381, "vf_loss_unclipped": 43.364234924316406, "module_train_batch_size_mean": 997.6672132667843, "num_module_steps_trained_lifetime": 107730, "mean_kl_loss": 2.0821878933929838e-05}, "intrinsic_reward_module": {"total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 16.0, "module_train_batch_size_mean": 997.6672132667843, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 107730, "weights_seq_no": 18.0}, "__all_modules__": {"num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 594000, "num_module_steps_trained_lifetime": 215460, "num_env_steps_trained_lifetime_throughput": 59142.57537175738}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 35910, "num_env_steps_trained_lifetime": 99000, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime_throughput": 4551.404927570509, "num_module_steps_trained_throughput": 28535916.805626072, "num_module_steps_trained_lifetime_throughput": 15023607.373533426}, "intrinsic_reward_module": {"total_loss": 0.0, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "default_optimizer_learning_rate": 0.0002715581955, "module_train_batch_size_mean": 997.9168410861561, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 17955, "weights_seq_no": 3.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 825.1286907507108}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.2217598155129296e-05, "module_to_env_connector": {"connector_pipeline_timer": 0.000116018790909342, "timers": {"connectors": {"tensor_to_numpy": 1.5298120523119606e-05, "normalize_and_clip_actions": 7.991037229042579e-06, "listify_data_for_vector_env": 1.051872724562879e-05, "un_batch_to_individual_items": 6.646852618362056e-06, "remove_single_ts_time_rank_from_batch": 1.1953673630886405e-05, "get_actions": 3.7044473911239285e-05}}}, "agent_episode_returns_mean": {"default_agent": -0.9666666666666667}, "env_step_timer": 1.4270329977409851e-05, "env_reset_timer": 0.0001679749672766775, "env_to_module_connector": {"connector_pipeline_timer": 6.094153810420386e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.279903784314963e-06, "add_observations_from_episodes_to_batch": 2.864551152876968e-06, "add_states_from_episodes_to_batch": 2.771296354152866e-06, "numpy_to_tensor": 1.2432442141339792e-05, "batch_individual_items": 1.2953481974966578e-05}}}, "sample": 0.11555189953717636, "episode_return_max": 12.5, "episode_len_mean": 20.0, "episode_len_max": 20, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "episode_duration_sec_mean": 0.005315427082435539, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": -0.9666666666666667}, "env_to_module_sum_episodes_length_out": 10.368205581254823, "num_env_steps_sampled_lifetime": 15400, "env_to_module_sum_episodes_length_in": 10.368205581254823, "weights_seq_no": 3.0, "episode_return_min": -15.5, "num_env_steps_sampled": 400, "num_episodes_lifetime": 60, "num_episodes": 20, "episode_return_mean": -0.9666666666666667, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "time_between_sampling": 9.332528430850942}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "b1709_00000", "date": "2025-08-11_18-33-02", "timestamp": 1754929982, "time_this_iter_s": 9.453975677490234, "time_total_s": 28.022323846817017, "pid": 11351, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3845f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 28.022323846817017, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 40.69230769230769, "ram_util_percent": 78.45384615384617}}
{"timers": {"training_iteration": 9.0386164939779, "restore_env_runners": 1.263112785469275e-05, "training_step": 9.038485320533562, "env_runner_sampling_timer": 1.619000195939882, "learner_update_timer": 7.247692930700464, "synch_weights": 0.0007900894894337981, "restore_eval_env_runners": 7.608489796984941e-06, "evaluation_iteration": 0.12259333238675027, "synch_eval_env_connectors": 0.00013389965486712753, "synch_env_connectors": 4.347739170771092e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00011775513700156762, "timers": {"connectors": {"un_batch_to_individual_items": 6.622193982514183e-06, "tensor_to_numpy": 1.513653431271407e-05, "remove_single_ts_time_rank_from_batch": 1.1792896090604127e-05, "normalize_and_clip_actions": 7.861469245710232e-06, "get_actions": 3.978551613544616e-05, "listify_data_for_vector_env": 1.0393267767670711e-05}}}, "time_between_sampling": 0.032023279490320716, "episode_duration_sec_mean": 0.005258776016533375, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -1225000.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.808215192345173e-06, "add_time_dim_to_batch_and_zero_pad": 6.87635805405219e-06, "numpy_to_tensor": 1.259939684762307e-05, "add_states_from_episodes_to_batch": 2.6417155812062395e-06, "batch_individual_items": 1.2274181932534714e-05}}, "connector_pipeline_timer": 5.9119420507693324e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "agent_episode_returns_mean": {"default_agent": -3.8199999999999994}, "weights_seq_no": 3.0, "module_episode_returns_mean": {"default_policy": -3.8199999999999994}, "episode_return_min": -13.5, "num_env_steps_sampled": 5000.0, "num_episodes_lifetime": -61250.0, "rlmodule_inference_timer": 3.188570370345767e-05, "episode_len_mean": 20.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "num_episodes": 250.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.398418032667564e-05, "episode_return_mean": -3.8199999999999994, "env_reset_timer": 4.4398446911781214e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "sample": 0.0057152034016837, "episode_return_max": 6.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3242.893982192448}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13451686020614484, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00935934022314404, "add_observations_from_episodes_to_batch": 0.0008366798793380148, "add_columns_from_episodes_to_train_batch": 0.0411128412881035, "add_time_dim_to_batch_and_zero_pad": 0.07512015537454408, "add_states_from_episodes_to_batch": 0.0036886044218267778, "batch_individual_items": 0.004161846862370148, "numpy_to_tensor": 7.417474847729318e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "policy_loss": 1.07527029058474e-07, "use_intrinsic_rewards": 0.0, "weights_seq_no": 4.0, "vf_explained_var": -0.0006071329116821289, "num_trainable_parameters": 16595, "vf_loss": 0.3583051860332489, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.010098995640873909, "num_module_steps_trained": 5985, "total_loss": 0.2780739665031433, "module_train_batch_size_mean": 997.8923005732703, "num_module_steps_trained_lifetime": 23940, "entropy": 0.689680278301239, "vf_loss_unclipped": 48.514957427978516, "mean_kl_loss": 5.763961780758109e-06, "num_module_steps_trained_lifetime_throughput": 822.7048036360221}, "IntrinsicAttentionMask": [[[0.09002760052680969, 0.09215256571769714, 0.0899675264954567, 0.09148317575454712, 0.09206034243106842, 0.09047471731901169, 0.09199891239404678, 0.08981751650571823, 0.0897875428199768, 0.09035401791334152, 0.09187617152929306], [0.091598741710186, 0.08993976563215256, 0.09164666384458542, 0.09045495092868805, 0.09001034498214722, 0.09124390780925751, 0.09005743265151978, 0.09176655858755112, 0.09179055690765381, 0.09133938699960709, 0.09015167504549026], [0.08998258411884308, 0.09221620112657547, 0.08991947770118713, 0.0915122926235199, 0.09211920946836472, 0.09045234322547913, 0.09205460548400879, 0.08976190537214279, 0.08973041921854019, 0.09032551944255829, 0.09192552417516708], [0.09110823273658752, 0.09062888473272324, 0.09112198650836945, 0.0907784104347229, 0.09064940363168716, 0.09100622683763504, 0.09066309034824371, 0.09115637838840485, 0.0911632552742958, 0.0910337045788765, 0.09069046378135681], [0.0915314108133316, 0.09003428369760513, 0.09157461673021317, 0.09049949795007706, 0.09009803086519241, 0.09121141582727432, 0.09014055877923965, 0.09168270230293274, 0.0917043387889862, 0.09129753708839417, 0.09022566676139832], [0.09036160260438919, 0.09168080985546112, 0.09032413363456726, 0.09126649796962738, 0.09162379801273346, 0.09064015001058578, 0.09158580750226974, 0.0902305394411087, 0.09021183103322983, 0.09056500345468521, 0.0915098786354065], [0.09148652106523514, 0.09009731560945511, 0.0915265828371048, 0.09052916616201401, 0.09015650302171707, 0.09118973463773727, 0.09019599109888077, 0.09162681549787521, 0.09164687246084213, 0.0912696123123169, 0.09027499705553055], [0.08987002074718475, 0.09237536042928696, 0.08979934453964233, 0.09158501774072647, 0.09226641058921814, 0.09039630740880966, 0.0921938568353653, 0.08962289988994598, 0.08958765119314194, 0.09025418758392334, 0.09204890578985214], [0.08984750509262085, 0.09240720421075821, 0.08977531641721725, 0.09159955382347107, 0.09229586273431778, 0.0903850868344307, 0.0922217071056366, 0.08959510177373886, 0.08955910056829453, 0.09023990482091904, 0.09207358211278915], [0.09027160704135895, 0.09180783480405807, 0.09022803604602814, 0.09132497012615204, 0.09174136817455292, 0.09059567749500275, 0.0916970819234848, 0.09011919051408768, 0.09009743481874466, 0.09050823748111725, 0.09160857647657394], [0.09139670431613922, 0.09022343158721924, 0.09143050014972687, 0.09058845788240433, 0.09027347713708878, 0.09114627540111542, 0.09030686318874359, 0.09151503443717957, 0.09153195470571518, 0.09121369570493698, 0.09037365764379501]], [[0.09124790877103806, 0.0911155715584755, 0.0912352055311203, 0.09122885018587112, 0.09109653532505035, 0.09109019488096237, 0.09140823781490326, 0.09107751399278641, 0.08804675936698914, 0.09122683852910995, 0.09122636169195175], [0.09207619726657867, 0.091603122651577, 0.09203069657087326, 0.09200795739889145, 0.09153523296117783, 0.09151261299848557, 0.09265167266130447, 0.09146739542484283, 0.0811152458190918, 0.09200077503919601, 0.09199905395507812], [0.09132957458496094, 0.09116474539041519, 0.09131374955177307, 0.09130582958459854, 0.09114105254411697, 0.09113314747810364, 0.09152933955192566, 0.09111735969781876, 0.08735914528369904, 0.09130333364009857, 0.09130273759365082], [0.09137022495269775, 0.09118913859128952, 0.09135283529758453, 0.09134414047002792, 0.09116309881210327, 0.09115442633628845, 0.09158974140882492, 0.09113707393407822, 0.08701715618371964, 0.09134139120578766, 0.09134073555469513], [0.09219134598970413, 0.09166885167360306, 0.09214108437299728, 0.09211596101522446, 0.091593898832798, 0.09156892448663712, 0.09282731264829636, 0.09151899814605713, 0.0801595002412796, 0.09210802614688873, 0.09210613369941711], [0.09222950041294098, 0.09169051796197891, 0.09217765182256699, 0.09215173125267029, 0.09161320328712463, 0.09158744663000107, 0.09288567304611206, 0.09153594821691513, 0.0798432007431984, 0.09214354306459427, 0.09214159101247787], [0.09017710387706757, 0.09045018255710602, 0.09020327031612396, 0.09021636098623276, 0.09048955142498016, 0.09050267934799194, 0.08984790742397308, 0.0905289351940155, 0.09714199602603912, 0.09022049605846405, 0.09022147953510284], [0.092305488884449, 0.09173349291086197, 0.09225045144557953, 0.09222294390201569, 0.09165145456790924, 0.09162412583827972, 0.09300212562084198, 0.09156949818134308, 0.07921402901411057, 0.09221425652503967, 0.09221217781305313], [0.10241594910621643, 0.09336883574724197, 0.10151111334562302, 0.10106170177459717, 0.09213421493768692, 0.09172631055116653, 0.11453818529844284, 0.09091591835021973, 0.010521337389945984, 0.10092008858919144, 0.10088633000850677], [0.09138304740190506, 0.09119681268930435, 0.09136515855789185, 0.09135621786117554, 0.0911700427532196, 0.09116112440824509, 0.09160880744457245, 0.09114328026771545, 0.08690932393074036, 0.0913533940911293, 0.09135271608829498], [0.09138611704111099, 0.09119866043329239, 0.09136810898780823, 0.09135910868644714, 0.09117171168327332, 0.09116272628307343, 0.09161336719989777, 0.09114477038383484, 0.08688362687826157, 0.09135627001523972, 0.0913555845618248]], [[0.09002651274204254, 0.0921514481306076, 0.09056425839662552, 0.09208995848894119, 0.09205922484397888, 0.08987639844417572, 0.09199779480695724, 0.08981642872095108, 0.08978645503520966, 0.08975648880004883, 0.09187506139278412], [0.09159807115793228, 0.08993910253047943, 0.09117168188095093, 0.089986152946949, 0.09000968188047409, 0.09171789884567261, 0.09005676954984665, 0.0917658805847168, 0.09178987890481949, 0.09181388467550278, 0.09015101194381714], [0.09042875468730927, 0.09158524870872498, 0.09072258323431015, 0.09155195206403732, 0.0915353074669838, 0.09034658223390579, 0.09150203317403793, 0.09031374007463455, 0.09029732644557953, 0.09028090536594391, 0.0914355143904686], [0.09155326336622238, 0.09000218659639359, 0.0911547839641571, 0.09004620462656021, 0.09006821364164352, 0.09166523069143295, 0.09011226147413254, 0.09171006083488464, 0.09173247963190079, 0.09175490587949753, 0.09020041674375534], [0.09153085201978683, 0.09003373980522156, 0.091146320104599, 0.09007623046636581, 0.09009748697280884, 0.09163889288902283, 0.09014000743627548, 0.09168214350938797, 0.09170377999544144, 0.0917254164814949, 0.09022511541843414], [0.08991367369890213, 0.09231027215719223, 0.0905194878578186, 0.0922408178448677, 0.09220611304044724, 0.08974464237689972, 0.09213673323392868, 0.0896771252155304, 0.08964337408542633, 0.08960965275764465, 0.0919981449842453], [0.09148603677749634, 0.0900968462228775, 0.09112938493490219, 0.09013629704713821, 0.09015603363513947, 0.09158622473478317, 0.09019551426172256, 0.09162632375955582, 0.09164638817310333, 0.09166645258665085, 0.09027452766895294], [0.08986852318048477, 0.09237382560968399, 0.09050153940916061, 0.09230118244886398, 0.09226488322019577, 0.08969194442033768, 0.09219231456518173, 0.089621402323246, 0.08958616107702255, 0.0895509272813797, 0.09204737842082977], [0.0898459404706955, 0.09240559488534927, 0.09049253910779953, 0.09233135730028152, 0.09229425340890884, 0.08966558426618576, 0.09222010523080826, 0.0895935446023941, 0.08955754339694977, 0.08952155709266663, 0.09207197278738022], [0.08982335776090622, 0.09243737906217575, 0.09048355370759964, 0.09236153960227966, 0.09232364594936371, 0.08963923156261444, 0.09224789589643478, 0.0895656868815422, 0.08952893316745758, 0.08949220180511475, 0.09209658205509186], [0.09139636158943176, 0.09022309631109238, 0.09109541028738022, 0.0902564525604248, 0.09027314186096191, 0.09148086607456207, 0.09030652046203613, 0.0915146917104721, 0.09153161197900772, 0.09154853224754333, 0.09037331491708755]], [[0.08824606239795685, 0.0889596939086914, 0.08817065507173538, 0.08813297748565674, 0.08809531480073929, 0.08805766701698303, 0.09072825312614441, 0.08873184025287628, 0.11153382807970047, 0.089628666639328, 0.08971503376960754], [0.08928687125444412, 0.08973716199398041, 0.0892392098903656, 0.08921539038419724, 0.08919157832860947, 0.0891677737236023, 0.09084729105234146, 0.08959353715181351, 0.10335084795951843, 0.09015804529190063, 0.09021230041980743], [0.0881325826048851, 0.08887381851673126, 0.08805427700281143, 0.08801514655351639, 0.08797603100538254, 0.08793694525957108, 0.09071178734302521, 0.08863712847232819, 0.1124347597360611, 0.08956887573003769, 0.08965863287448883], [0.08807561546564102, 0.08883063495159149, 0.08799586445093155, 0.0879560187458992, 0.08791618794202805, 0.08787636458873749, 0.09070327132940292, 0.08858953416347504, 0.11288759112358093, 0.08953871577978134, 0.08963015675544739], [0.0880185216665268, 0.08878728747367859, 0.08793731778860092, 0.08789674937725067, 0.08785618841648102, 0.08781565725803375, 0.09069458395242691, 0.08854178339242935, 0.11334202438592911, 0.08950839191675186, 0.08960151672363281], [0.08796126395463943, 0.08874376863241196, 0.08787861466407776, 0.0878373309969902, 0.08779604732990265, 0.08775479346513748, 0.09068568795919418, 0.08849385380744934, 0.11379802972078323, 0.08947786688804626, 0.08957268297672272], [0.09162536263465881, 0.09140940010547638, 0.09164831787347794, 0.0916597917675972, 0.09167127311229706, 0.09168275445699692, 0.09088370203971863, 0.09147810935974121, 0.08554910868406296, 0.09120897203683853, 0.09118323773145676], [0.08896096795797348, 0.08949574828147888, 0.08890440315008163, 0.08887612819671631, 0.08884786814451218, 0.08881961554288864, 0.09081634879112244, 0.08932512253522873, 0.10589717328548431, 0.08999605476856232, 0.09006058424711227], [0.10533242672681808, 0.09724677354097366, 0.10622913390398026, 0.10668034851551056, 0.10713347047567368, 0.1075885221362114, 0.08000144362449646, 0.09975159168243408, 0.010326606221497059, 0.09028398990631104, 0.08942579478025436], [0.09021022915840149, 0.09041053056716919, 0.09018899500370026, 0.09017838537693024, 0.09016776829957962, 0.090157151222229, 0.09090195596218109, 0.09034670144319534, 0.09621972590684891, 0.0905972421169281, 0.09062127768993378], [0.09032589942216873, 0.09049373120069504, 0.09030810743570328, 0.09029921144247055, 0.09029031544923782, 0.0902814269065857, 0.09090523421764374, 0.09044025838375092, 0.0953354462981224, 0.09065012633800507, 0.09067025035619736]], [[0.09052356332540512, 0.09130830317735672, 0.0905284658074379, 0.09157715737819672, 0.09126317501068115, 0.09078007191419601, 0.09123310446739197, 0.09045391529798508, 0.09043901413679123, 0.09072025865316391, 0.09117299318313599], [0.09156718850135803, 0.09022770822048187, 0.09155871719121933, 0.0897759348154068, 0.09030389040708542, 0.09112590551376343, 0.09035471081733704, 0.09168759733438492, 0.09171339124441147, 0.09122850000858307, 0.09045644104480743], [0.09053011983633041, 0.09130151569843292, 0.09053494036197662, 0.09156578034162521, 0.09125716984272003, 0.0907822772860527, 0.09122760593891144, 0.09046164900064468, 0.09044699370861053, 0.09072347730398178, 0.09116852283477783], [0.0919225811958313, 0.08985977619886398, 0.0919094830751419, 0.08916774392127991, 0.08997664600610733, 0.09124118834733963, 0.09005465358495712, 0.09210880845785141, 0.09214872121810913, 0.09139945358037949, 0.09021086245775223], [0.0915074348449707, 0.09028957784175873, 0.09149973839521408, 0.08987845480442047, 0.09035889059305191, 0.09110639989376068, 0.09040512144565582, 0.09161682426929474, 0.09164026379585266, 0.09119965881109238, 0.09049765765666962], [0.09086571633815765, 0.0909539982676506, 0.09086626768112183, 0.09098409116268158, 0.09094894677400589, 0.09089464694261551, 0.09094557166099548, 0.0908578485250473, 0.0908561646938324, 0.09088790416717529, 0.09093882143497467], [0.09146759659051895, 0.0903308317065239, 0.09146041423082352, 0.08994685113430023, 0.09039554744958878, 0.09109337627887726, 0.09043871611356735, 0.09156965464353561, 0.09159152209758759, 0.09118041396141052, 0.09052512794733047], [0.09043048322200775, 0.09140468388795853, 0.09043656289577484, 0.09173891693353653, 0.09134861081838608, 0.09074869751930237, 0.0913112461566925, 0.09034411609172821, 0.09032563865184784, 0.09067447483539581, 0.09123656898736954], [0.09041055291891098, 0.091425321996212, 0.09041688591241837, 0.09177356958389282, 0.09136689454317093, 0.09074196964502335, 0.091327965259552, 0.09032062441110611, 0.09030137956142426, 0.09066466242074966, 0.09125016629695892], [0.09078602492809296, 0.09103652089834213, 0.09078758955001831, 0.09112200886011124, 0.09102216362953186, 0.09086806327104568, 0.09101258218288422, 0.09076371788978577, 0.09075894206762314, 0.09084894508123398, 0.09099343419075012], [0.09138791263103485, 0.09041332453489304, 0.09138176590204239, 0.09008372575044632, 0.09046885371208191, 0.09106727689504623, 0.09050589799880981, 0.09147533029317856, 0.09149405360221863, 0.09114185720682144, 0.09058001637458801]], [[0.08980681747198105, 0.08978360891342163, 0.08976041525602341, 0.08927817642688751, 0.08925510197877884, 0.08969084173440933, 0.09039390087127686, 0.08964449167251587, 0.10241293907165527, 0.08972988277673721, 0.09024379402399063], [0.08976835012435913, 0.08974438905715942, 0.08972042798995972, 0.08922257274389267, 0.0891987532377243, 0.08964860439300537, 0.09037457406520844, 0.08960074931383133, 0.10281307995319366, 0.08968891203403473, 0.09021956473588943], [0.08972973376512527, 0.08970502763986588, 0.08968031406402588, 0.08916684985160828, 0.08914228528738022, 0.08960622549057007, 0.09035509824752808, 0.08955687284469604, 0.10321460664272308, 0.0896478071808815, 0.0901951789855957], [0.08889219164848328, 0.0888519361615181, 0.08881170302629471, 0.08797711133956909, 0.08793726563453674, 0.0886910930275917, 0.08991318941116333, 0.08861077576875687, 0.11190427839756012, 0.08875876665115356, 0.08965165168046951], [0.08885041624307632, 0.08880942314863205, 0.08876844495534897, 0.08791866153478622, 0.08787809312343597, 0.08864563703536987, 0.08989022672176361, 0.08856385201215744, 0.11233682930469513, 0.08871455490589142, 0.08962385356426239], [0.08961305022239685, 0.08958607912063599, 0.08955911546945572, 0.0889989361166954, 0.08897214382886887, 0.0894782692193985, 0.09029573947191238, 0.08942440897226334, 0.10442750155925751, 0.08952364325523376, 0.09012111276388168], [0.0907311961054802, 0.09072722494602203, 0.09072325378656387, 0.09064055979251862, 0.09063659608364105, 0.09071134775876999, 0.09083133190870285, 0.09070340543985367, 0.09277128428220749, 0.09071803092956543, 0.0908057764172554], [0.08953454345464706, 0.08950606733560562, 0.08947760611772537, 0.08888637274503708, 0.08885811269283295, 0.0893922746181488, 0.09025537967681885, 0.08933542668819427, 0.10524307191371918, 0.08944015949964523, 0.09007097035646439], [0.09775254130363464, 0.09815116226673126, 0.09855140745639801, 0.10727576166391373, 0.10771321505308151, 0.099761962890625, 0.08822046220302582, 0.10057725012302399, 0.012355972081422806, 0.09908061474561691, 0.09055964648723602], [0.08967870473861694, 0.08965300023555756, 0.08962730318307877, 0.08909332752227783, 0.08906778693199158, 0.08955024927854538, 0.09032923728227615, 0.08949892222881317, 0.10374511778354645, 0.08959349244832993, 0.09016286581754684], [0.09050361067056656, 0.09049469232559204, 0.09048578143119812, 0.09030017256736755, 0.09029127657413483, 0.09045904129743576, 0.09072867035865784, 0.09044122695922852, 0.09515027701854706, 0.09047404676675797, 0.09067121148109436]]], "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"use_intrinsic_rewards": 1.0, "weights_seq_no": 24.0, "vf_loss": 0.3585902154445648, "policy_loss": 1.7179202131956117e-06, "vf_explained_var": 0.0013266205787658691, "total_loss": 0.2782985270023346, "diff_num_grad_updates_vs_sampler_policy": 21.0, "num_module_steps_trained": 35910, "entropy": 0.6896743178367615, "vf_loss_unclipped": 48.275291442871094, "module_train_batch_size_mean": 997.6156867483631, "num_module_steps_trained_lifetime": 143640, "mean_kl_loss": 5.996523213980254e-06}, "intrinsic_reward_module": {"total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 21.0, "module_train_batch_size_mean": 997.6156867483631, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 143640, "weights_seq_no": 24.0}, "__all_modules__": {"num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 792000, "num_module_steps_trained_lifetime": 287280, "num_env_steps_trained_lifetime_throughput": 58412.66083738192}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 47880, "num_env_steps_trained_lifetime": 132000, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime_throughput": 4538.068627648001, "num_module_steps_trained_throughput": 27859719.81157285, "num_module_steps_trained_lifetime_throughput": 14925532.811693639}, "intrinsic_reward_module": {"total_loss": 0.0, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "default_optimizer_learning_rate": 0.0002715581955, "module_train_batch_size_mean": 997.8923005732703, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 23940, "weights_seq_no": 4.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 822.7181925103883}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.231715680743276e-05, "module_to_env_connector": {"connector_pipeline_timer": 0.00011665988325191259, "timers": {"connectors": {"tensor_to_numpy": 1.5418304787817015e-05, "normalize_and_clip_actions": 8.028438298057121e-06, "listify_data_for_vector_env": 1.050320922947948e-05, "un_batch_to_individual_items": 6.567387925270251e-06, "remove_single_ts_time_rank_from_batch": 1.2018621203792732e-05, "get_actions": 3.766718665830016e-05}}}, "agent_episode_returns_mean": {"default_agent": -0.3}, "env_step_timer": 1.4247063253693906e-05, "env_reset_timer": 0.00016709812709363178, "env_to_module_connector": {"connector_pipeline_timer": 6.035690650039774e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.163017111285414e-06, "add_observations_from_episodes_to_batch": 2.819217964746595e-06, "add_states_from_episodes_to_batch": 2.7688475157424334e-06, "numpy_to_tensor": 1.2554117112565189e-05, "batch_individual_items": 1.2539550298063316e-05}}}, "sample": 0.11555454138150008, "episode_return_max": 12.5, "episode_len_mean": 20.0, "episode_len_max": 20, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "episode_duration_sec_mean": 0.005313426550128497, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": -0.3}, "env_to_module_sum_episodes_length_out": 10.368237912813044, "num_env_steps_sampled_lifetime": 20400, "env_to_module_sum_episodes_length_in": 10.368237912813044, "weights_seq_no": 4.0, "episode_return_min": -15.5, "num_env_steps_sampled": 400, "num_episodes_lifetime": 80, "num_episodes": 20, "episode_return_mean": -0.3, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "time_between_sampling": 9.32981784195291}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "b1709_00000", "date": "2025-08-11_18-33-11", "timestamp": 1754929991, "time_this_iter_s": 9.161191940307617, "time_total_s": 37.183515787124634, "pid": 11351, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3845f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 37.183515787124634, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 34.215384615384615, "ram_util_percent": 78.37692307692308}}
{"timers": {"training_iteration": 9.043942255287908, "restore_env_runners": 1.2562316431902581e-05, "training_step": 9.043809929828171, "env_runner_sampling_timer": 1.6184317389797866, "learner_update_timer": 7.253475812233705, "synch_weights": 0.0007991360949471558, "restore_eval_env_runners": 7.646574569283986e-06, "evaluation_iteration": 0.12257741073278304, "synch_eval_env_connectors": 0.0001336952385525219, "synch_env_connectors": 4.348011821159161e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00011943348362343215, "timers": {"connectors": {"un_batch_to_individual_items": 6.697013891475116e-06, "tensor_to_numpy": 1.538277480308851e-05, "remove_single_ts_time_rank_from_batch": 1.189301273060776e-05, "normalize_and_clip_actions": 7.994792337031174e-06, "get_actions": 4.040388279159146e-05, "listify_data_for_vector_env": 1.0618425386475189e-05}}}, "time_between_sampling": 0.031154946434491706, "episode_duration_sec_mean": 0.005347135142423215, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -1842500.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.843139803852708e-06, "add_time_dim_to_batch_and_zero_pad": 6.960569863179282e-06, "numpy_to_tensor": 1.2900048560674603e-05, "add_states_from_episodes_to_batch": 2.681631478193887e-06, "batch_individual_items": 1.2610203240060648e-05}}, "connector_pipeline_timer": 6.012510630241245e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "agent_episode_returns_mean": {"default_agent": -3.4200000000000017}, "weights_seq_no": 4.0, "module_episode_returns_mean": {"default_policy": -3.4200000000000017}, "episode_return_min": -13.5, "num_env_steps_sampled": 5000.0, "num_episodes_lifetime": -92125.0, "rlmodule_inference_timer": 3.238242815713546e-05, "episode_len_mean": 20.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "num_episodes": 250.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.4320691331641793e-05, "episode_return_mean": -3.4200000000000017, "env_reset_timer": 4.32488778596508e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "sample": 0.005676563108540563, "episode_return_max": 6.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3203.3315166490593}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1345047870132923, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009351623072017819, "add_observations_from_episodes_to_batch": 0.0008365380803095688, "add_columns_from_episodes_to_train_batch": 0.0411179907958169, "add_time_dim_to_batch_and_zero_pad": 0.0751130167413653, "add_states_from_episodes_to_batch": 0.003687290877809452, "batch_individual_items": 0.004161354644035826, "numpy_to_tensor": 7.422966130776564e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "policy_loss": -0.00025985564570873976, "use_intrinsic_rewards": 0.0, "weights_seq_no": 5.0, "vf_explained_var": -0.0012447834014892578, "num_trainable_parameters": 16595, "vf_loss": 0.3583231270313263, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.0050494978204369545, "num_module_steps_trained": 5985, "total_loss": 0.27782899141311646, "module_train_batch_size_mean": 997.8691961675322, "num_module_steps_trained_lifetime": 29925, "entropy": 0.6890779137611389, "vf_loss_unclipped": 45.846717834472656, "mean_kl_loss": 1.9778261048486456e-05, "num_module_steps_trained_lifetime_throughput": 819.4454469450675}, "IntrinsicAttentionMask": [[[0.09057746827602386, 0.09136267751455307, 0.09058237820863724, 0.0913325771689415, 0.09131752699613571, 0.09053761512041092, 0.09128743410110474, 0.09080419689416885, 0.0904928669333458, 0.09047796577215195, 0.09122728556394577], [0.09147453308105469, 0.09013641625642776, 0.09146607667207718, 0.09018713980913162, 0.09021250903606415, 0.0915433019399643, 0.09026328474283218, 0.09108492732048035, 0.09162058681249619, 0.09164636582136154, 0.09036491066217422], [0.09058310091495514, 0.09135495871305466, 0.09058792889118195, 0.09132537245750427, 0.09131058305501938, 0.09054391831159592, 0.09128100425004959, 0.09080599248409271, 0.09049993753433228, 0.09048527479171753, 0.091221883893013], [0.09144032001495361, 0.09018312394618988, 0.09143237769603729, 0.09023080766201019, 0.09025465697050095, 0.09150490164756775, 0.09030237048864365, 0.0910743996500969, 0.09157747775316238, 0.09160168468952179, 0.09039788693189621], [0.09142322093248367, 0.09020648896694183, 0.09141553193330765, 0.09025264531373978, 0.09027572721242905, 0.09148570895195007, 0.09032192081212997, 0.09106913208961487, 0.09155592322349548, 0.09157934784889221, 0.0904143750667572], [0.09053166210651398, 0.0914253517985344, 0.09053725004196167, 0.09139107167720795, 0.09137392789125443, 0.09048633277416229, 0.09133967012166977, 0.09078960865736008, 0.0904354378581047, 0.09041848033666611, 0.09127118438482285], [0.0913890078663826, 0.09025321900844574, 0.09138183295726776, 0.09029632061719894, 0.09031788259744644, 0.09144730120897293, 0.09036101400852203, 0.09105857461690903, 0.09151282161474228, 0.09153467416763306, 0.09044734388589859], [0.0908375233411789, 0.09100694209337234, 0.09083858877420425, 0.09100046753883362, 0.09099723398685455, 0.09082889556884766, 0.09099075198173523, 0.09088656306266785, 0.09081920981407166, 0.09081597626209259, 0.09097781032323837], [0.09048021584749222, 0.09149575978517532, 0.0904865562915802, 0.09145677834749222, 0.09143729507923126, 0.09042873233556747, 0.09139833599328995, 0.09077319502830505, 0.09037095308303833, 0.09035170078277588, 0.0913204774260521], [0.0904630646109581, 0.09151922911405563, 0.09046965092420578, 0.09147868305444717, 0.09145841002464294, 0.0904095321893692, 0.09141788631677628, 0.09076771140098572, 0.09034945070743561, 0.09032943844795227, 0.09133689850568771], [0.09132057428359985, 0.09034670144319534, 0.09131442755460739, 0.09038368612527847, 0.09040219336748123, 0.09137051552534103, 0.09043920785188675, 0.09103742986917496, 0.09142663329839706, 0.09144534915685654, 0.09051327407360077]], [[0.08831359446048737, 0.0890277698636055, 0.0889897271990776, 0.08820042014122009, 0.08816272765398026, 0.08812505006790161, 0.09003081917762756, 0.0880497545003891, 0.11161920428276062, 0.08969725668430328, 0.0897836908698082], [0.08932968974113464, 0.08978019654750824, 0.08975623548030853, 0.08925817161798477, 0.0892343521118164, 0.08921053260564804, 0.09041064232587814, 0.0891629084944725, 0.10340043157339096, 0.09020128101110458, 0.09025556594133377], [0.08927705138921738, 0.08974168449640274, 0.08971697092056274, 0.08920329809188843, 0.08917872607707977, 0.08915416151285172, 0.09039203822612762, 0.08910505473613739, 0.10382280498743057, 0.090176060795784, 0.09023205190896988], [0.08814700692892075, 0.08890262991189957, 0.08886236697435379, 0.08802730590105057, 0.08798743784427643, 0.08794759958982468, 0.08996448665857315, 0.08786795288324356, 0.11297911405563354, 0.08961129188537598, 0.08970280736684799], [0.088091179728508, 0.08886058628559113, 0.08881958574056625, 0.08796930313110352, 0.08792871236801147, 0.08788814395666122, 0.08994200825691223, 0.0878070667386055, 0.11343561112880707, 0.08958227932453156, 0.08967547863721848], [0.0880352109670639, 0.08881837129592896, 0.08877663314342499, 0.08791117370128632, 0.08786986023187637, 0.08782856911420822, 0.08991935104131699, 0.0877460464835167, 0.11389372497797012, 0.0895530954003334, 0.08964799344539642], [0.09065941721200943, 0.09073419123888016, 0.090730220079422, 0.09064751863479614, 0.09064355492591858, 0.09063959121704102, 0.09083830565214157, 0.09063165634870529, 0.09285899996757507, 0.09080379456281662, 0.09081275016069412], [0.08792281150817871, 0.08873344957828522, 0.08869024366140366, 0.08779444545507431, 0.08775169402360916, 0.0877089649438858, 0.08987349271774292, 0.08762357383966446, 0.11481477320194244, 0.08949417620897293, 0.08959244936704636], [0.10457909852266312, 0.09655126929283142, 0.0969613716006279, 0.10591737180948257, 0.10636726021766663, 0.10681905597448349, 0.0863989070057869, 0.10772842168807983, 0.010252732783555984, 0.08963827788829803, 0.08878621459007263], [0.09022935479879379, 0.09042970091104507, 0.09041905403137207, 0.09019749611616135, 0.09018687903881073, 0.09017626941204071, 0.09070912003517151, 0.09015504270792007, 0.09624014049768448, 0.09061645716428757, 0.09064049273729324], [0.09034193307161331, 0.090509794652462, 0.09050087630748749, 0.09031523764133453, 0.0903063416481018, 0.09029744565486908, 0.09074380993843079, 0.09027965366840363, 0.09535237401723862, 0.09066621214151382, 0.09068634361028671]], [[0.09008420258760452, 0.09160181879997253, 0.09002409130334854, 0.09214897453784943, 0.09151014685630798, 0.0905316025018692, 0.0914490818977356, 0.09047118574380875, 0.09044100344181061, 0.09041082113981247, 0.09132707864046097], [0.09113813936710358, 0.0907171368598938, 0.09115500003099442, 0.09056752175092697, 0.0907423123717308, 0.09101308882236481, 0.09075909852981567, 0.09102992713451385, 0.09103834629058838, 0.0910467728972435, 0.0907926857471466], [0.09004217386245728, 0.09163717180490494, 0.08997903019189835, 0.09221255779266357, 0.09154078364372253, 0.0905122458934784, 0.09147658944129944, 0.0904487669467926, 0.0904170423746109, 0.0903853327035904, 0.0913483202457428], [0.09151479601860046, 0.09040183573961258, 0.09155954420566559, 0.09000837057828903, 0.0904681533575058, 0.09118332713842392, 0.09051239490509033, 0.09122791886329651, 0.0912502184510231, 0.09127253293991089, 0.09060093760490417], [0.0910748615860939, 0.09077014774084091, 0.09108705818653107, 0.09066177159547806, 0.09078837931156158, 0.09098438918590546, 0.09080054610967636, 0.09099657833576202, 0.09100267291069031, 0.091008760035038, 0.09082485735416412], [0.09039632976055145, 0.09133944660425186, 0.09035884588956833, 0.09167802333831787, 0.09128265082836151, 0.090674988925457, 0.09124480187892914, 0.09063739329576492, 0.09061860293149948, 0.09059981256723404, 0.09116915613412857], [0.09103268384933472, 0.09080549329519272, 0.09104177355766296, 0.0907246395945549, 0.0908190906047821, 0.09096525609493256, 0.09082815796136856, 0.09097433090209961, 0.09097887575626373, 0.09098341315984726, 0.09084630012512207], [0.09035424888134003, 0.09137479215860367, 0.09031371027231216, 0.09174137562513351, 0.09131330996751785, 0.09065569192171097, 0.09127233177423477, 0.09061501920223236, 0.09059468656778336, 0.09057436138391495, 0.09119044989347458], [0.09033321589231491, 0.09139247238636017, 0.09029115736484528, 0.09177307039499283, 0.09132864326238632, 0.09064605087041855, 0.09128610789775848, 0.09060383588075638, 0.09058273583650589, 0.090561643242836, 0.09120110422372818], [0.0903121829032898, 0.09141014516353607, 0.0902685895562172, 0.09180476516485214, 0.0913439691066742, 0.09063639491796494, 0.0912998765707016, 0.0905926451086998, 0.09057077765464783, 0.09054891020059586, 0.09121175110340118], [0.09094834327697754, 0.09087617695331573, 0.09095122665166855, 0.09085046499967575, 0.09088049829006195, 0.09092693775892258, 0.09088338166475296, 0.09092982113361359, 0.09093125909566879, 0.0909327045083046, 0.09088914096355438]], [[0.0884641781449318, 0.0884263664484024, 0.08914145827293396, 0.088350810110569, 0.08831305056810379, 0.08827531337738037, 0.09018432348966599, 0.08895114809274673, 0.11086518317461014, 0.08909133821725845, 0.08993677794933319], [0.08841201663017273, 0.08837348967790604, 0.08910244703292847, 0.08829646557569504, 0.08825798332691193, 0.08821950852870941, 0.09016574174165726, 0.08890843391418457, 0.11129920929670334, 0.08905134350061417, 0.08991332352161407], [0.08937163650989532, 0.08934702724218369, 0.0898120328783989, 0.089297816157341, 0.08927321434020996, 0.08924862742424011, 0.09048781543970108, 0.08968841284513474, 0.10336621105670929, 0.08977948129177094, 0.0903276577591896], [0.08830729126930237, 0.08826729655265808, 0.08902394771575928, 0.08818736672401428, 0.08814743161201477, 0.08810750395059586, 0.09012807160615921, 0.08882254362106323, 0.1121717095375061, 0.08897089213132858, 0.08986591547727585], [0.08825471997261047, 0.08821399509906769, 0.08898446708917618, 0.08813261985778809, 0.08809195458889008, 0.08805131167173386, 0.09010898321866989, 0.08877938240766525, 0.11261020600795746, 0.08893044292926788, 0.08984196186065674], [0.08820199966430664, 0.08816055208444595, 0.08894482254981995, 0.08807771652936935, 0.08803632855415344, 0.08799496293067932, 0.09008970856666565, 0.08873604983091354, 0.113050177693367, 0.08888982981443405, 0.0898178294301033], [0.09067386388778687, 0.0906699001789093, 0.09074468165636063, 0.09066196531057358, 0.09065799415111542, 0.09065403044223785, 0.0908527821302414, 0.09072483330965042, 0.09279320389032364, 0.09073945879936218, 0.09082721918821335], [0.0891217514872551, 0.0890934020280838, 0.08962897956371307, 0.08903674781322479, 0.08900843560695648, 0.08898013830184937, 0.09040806442499161, 0.08948655426502228, 0.10542111843824387, 0.08959147334098816, 0.09022334963083267], [0.10340270400047302, 0.10382436960935593, 0.09616018831729889, 0.1046728566288948, 0.10509969294071198, 0.10552827268838882, 0.0860799178481102, 0.09813687950372696, 0.012056184001266956, 0.0966765508055687, 0.08836233615875244], [0.08930619806051254, 0.08928059786558151, 0.08976421505212784, 0.08922942727804184, 0.0892038494348526, 0.08917827904224396, 0.09046721458435059, 0.08963564038276672, 0.10390359908342361, 0.08973035961389542, 0.09030058979988098], [0.09037476778030396, 0.09036586433649063, 0.0905337706208229, 0.09034806489944458, 0.09033916145563126, 0.09033025801181793, 0.09077678620815277, 0.09048918634653091, 0.09520073980093002, 0.09052203595638275, 0.0907192975282669]], [[0.09055038541555405, 0.09163448214530945, 0.09055528789758682, 0.09130525588989258, 0.09129021316766739, 0.0905105322599411, 0.09126013517379761, 0.09077704697847366, 0.09046580642461777, 0.09045089781284332, 0.09120000153779984], [0.09188701957464218, 0.08894657343626022, 0.0918734148144722, 0.08982577174901962, 0.08986622840166092, 0.09199760854244232, 0.08994720131158829, 0.0912613794207573, 0.09212197363376617, 0.09216346591711044, 0.09010936319828033], [0.09055647999048233, 0.09162212163209915, 0.09056130051612854, 0.09129852056503296, 0.09128373861312866, 0.0905173048377037, 0.09125417470932007, 0.09077929705381393, 0.09047333151102066, 0.09045868366956711, 0.09119506925344467], [0.091483473777771, 0.08975375443696976, 0.09147552400827408, 0.09027338773012161, 0.09029725193977356, 0.09154808521270752, 0.09034498780965805, 0.09111738204956055, 0.09162069857120514, 0.09164491295814514, 0.0904405489563942], [0.09146498888731003, 0.08979082107543945, 0.0914572924375534, 0.09029387682676315, 0.09031696617603302, 0.09152749925851822, 0.09036318957805634, 0.09111073613166809, 0.09159775078296661, 0.09162118285894394, 0.09045568108558655], [0.09050082415342331, 0.09173492342233658, 0.0905064046382904, 0.0913599357008934, 0.09134280681610107, 0.09045550227165222, 0.09130855649709702, 0.09075867384672165, 0.09040462970733643, 0.09038767963647842, 0.09124009311199188], [0.0914280042052269, 0.08986499160528183, 0.09142082184553146, 0.09033484756946564, 0.09035641700029373, 0.09148631989955902, 0.09039957076311111, 0.09109742939472198, 0.09155187010765076, 0.09157373011112213, 0.09048593789339066], [0.0908316969871521, 0.09106535464525223, 0.09083276242017746, 0.09099462628364563, 0.09099138528108597, 0.09082306921482086, 0.09098491817712784, 0.09088072925806046, 0.09081338346004486, 0.0908101424574852, 0.09097196906805038], [0.0904451534152031, 0.09184781461954117, 0.09045148640871048, 0.09142132848501205, 0.0914018526673317, 0.09039369225502014, 0.09136290848255157, 0.09073801338672638, 0.09033592790365219, 0.09031668305397034, 0.09128507971763611], [0.09042660146951675, 0.09188547730445862, 0.09043318778276443, 0.091441810131073, 0.09142155200242996, 0.09037309885025024, 0.09138104319572449, 0.09073112905025482, 0.09031303972005844, 0.0902930349111557, 0.09130008518695831], [0.09135402739048004, 0.09001346677541733, 0.09134787321090698, 0.0904168039560318, 0.09043531119823456, 0.09140398353338242, 0.09047233313322067, 0.09107077866792679, 0.09146013110876083, 0.0914788469672203, 0.09054643660783768]], [[0.08838019520044327, 0.08834242075681686, 0.08830466866493225, 0.08826693147420883, 0.0882292166352272, 0.08819150924682617, 0.09009870886802673, 0.0888667106628418, 0.11170336604118347, 0.08976490050554276, 0.08985140174627304], [0.08832605928182602, 0.08828755468130112, 0.0882490798830986, 0.08821061998605728, 0.08817216753959656, 0.08813373744487762, 0.09007807821035385, 0.08882199972867966, 0.11215704679489136, 0.08973770588636398, 0.08982590585947037], [0.08827178180217743, 0.08823256194591522, 0.08819335699081421, 0.08815416693687439, 0.08811499178409576, 0.08807583898305893, 0.09005727618932724, 0.08877712488174438, 0.11261235922574997, 0.08971035480499268, 0.08980024605989456], [0.0882173478603363, 0.088177390396595, 0.08813746273517609, 0.08809754252433777, 0.08805764466524124, 0.0880177691578865, 0.09003626555204391, 0.08873207867145538, 0.11306925117969513, 0.08968279510736465, 0.08977437764406204], [0.08816277235746384, 0.08812209963798523, 0.08808143436908722, 0.088040791451931, 0.08800017088651657, 0.08795957267284393, 0.09001510590314865, 0.08868689090013504, 0.11352778226137161, 0.0896550789475441, 0.08974836021661758], [0.08810802549123764, 0.08806663006544113, 0.08802524209022522, 0.0879838839173317, 0.08794254064559937, 0.08790121972560883, 0.08999373018741608, 0.08864150941371918, 0.11398791521787643, 0.08962716907262802, 0.08972214162349701], [0.09066654741764069, 0.09066258370876312, 0.09065861999988556, 0.0906546488404274, 0.09065068513154984, 0.09064672142267227, 0.09084545075893402, 0.09071751683950424, 0.09286630898714066, 0.09081094712018967, 0.09081989526748657], [0.08906200528144836, 0.08903368562459946, 0.08900537341833115, 0.08897707611322403, 0.08894877880811691, 0.0889204889535904, 0.09034746885299683, 0.08942656964063644, 0.10601746290922165, 0.09009826928377151, 0.09016287326812744], [0.10371927917003632, 0.10415983200073242, 0.10460225492715836, 0.10504655539989471, 0.10549274832010269, 0.10594082623720169, 0.08568857610225677, 0.09822392463684082, 0.010168456472456455, 0.08890131860971451, 0.08805625885725021], [0.09024839848279953, 0.09023777395486832, 0.0902271568775177, 0.09021653234958649, 0.09020591527223587, 0.09019529819488525, 0.090728260576725, 0.09038493037223816, 0.0962604507803917, 0.09063557535409927, 0.09065961837768555], [0.09035790711641312, 0.09034901112318039, 0.09034010767936707, 0.09033121168613434, 0.09032230824232101, 0.09031341224908829, 0.09075985848903656, 0.09047231078147888, 0.09536923468112946, 0.0906822457909584, 0.09070237725973129]]], "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"use_intrinsic_rewards": 1.0, "weights_seq_no": 30.0, "vf_loss": 0.3585636615753174, "policy_loss": -0.0002505193988326937, "vf_explained_var": 0.0014215707778930664, "total_loss": 0.2780284881591797, "diff_num_grad_updates_vs_sampler_policy": 26.0, "num_module_steps_trained": 35910, "entropy": 0.689099907875061, "vf_loss_unclipped": 45.681060791015625, "module_train_batch_size_mean": 997.5798029998547, "num_module_steps_trained_lifetime": 179550, "mean_kl_loss": 1.8283713870914653e-05}, "intrinsic_reward_module": {"total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 26.0, "module_train_batch_size_mean": 997.5798029998547, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 179550, "weights_seq_no": 30.0}, "__all_modules__": {"num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 990000, "num_module_steps_trained_lifetime": 359100, "num_env_steps_trained_lifetime_throughput": 57574.36813185664}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 59850, "num_env_steps_trained_lifetime": 165000, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime_throughput": 4520.041438611423, "num_module_steps_trained_throughput": 27141911.181070536, "num_module_steps_trained_lifetime_throughput": 14813324.11867697}, "intrinsic_reward_module": {"total_loss": 0.0, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "default_optimizer_learning_rate": 0.0002715581955, "module_train_batch_size_mean": 997.8691961675322, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 29925, "weights_seq_no": 5.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 819.4582748542591}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.185164488552301e-05, "module_to_env_connector": {"connector_pipeline_timer": 0.00011431758357955284, "timers": {"connectors": {"tensor_to_numpy": 1.5053413948290558e-05, "normalize_and_clip_actions": 7.981275380662362e-06, "listify_data_for_vector_env": 1.0573016097766788e-05, "un_batch_to_individual_items": 6.4985016892683275e-06, "remove_single_ts_time_rank_from_batch": 1.1929801774729656e-05, "get_actions": 3.590613618776445e-05}}}, "agent_episode_returns_mean": {"default_agent": 0.5}, "env_step_timer": 1.3938978807635549e-05, "env_reset_timer": 0.00016869297627804337, "env_to_module_connector": {"connector_pipeline_timer": 5.958153150185651e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.2120492964754386e-06, "add_observations_from_episodes_to_batch": 2.8119250772303705e-06, "add_states_from_episodes_to_batch": 2.7442026385288107e-06, "numpy_to_tensor": 1.1875707860824293e-05, "batch_individual_items": 1.238712844882143e-05}}}, "sample": 0.11556165846796783, "episode_return_max": 13.5, "episode_len_mean": 20.0, "episode_len_max": 20, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "episode_duration_sec_mean": 0.005308663728646934, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": 0.5}, "env_to_module_sum_episodes_length_out": 10.368238387501162, "num_env_steps_sampled_lifetime": 25400, "env_to_module_sum_episodes_length_in": 10.368238387501162, "weights_seq_no": 5.0, "episode_return_min": -15.5, "num_env_steps_sampled": 400, "num_episodes_lifetime": 100, "num_episodes": 20, "episode_return_mean": 0.5, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "time_between_sampling": 9.332507308113108}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "b1709_00000", "date": "2025-08-11_18-33-21", "timestamp": 1754930001, "time_this_iter_s": 9.699556112289429, "time_total_s": 46.88307189941406, "pid": 11351, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3845f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 46.88307189941406, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 40.45714285714286, "ram_util_percent": 77.90714285714286}}
{"timers": {"training_iteration": 9.060597376484727, "restore_env_runners": 1.2496693724453157e-05, "training_step": 9.060463379280066, "env_runner_sampling_timer": 1.618044431169826, "learner_update_timer": 7.270397947021316, "synch_weights": 0.0008076943140296901, "restore_eval_env_runners": 7.963858038299952e-06, "evaluation_iteration": 0.1226036662159967, "synch_eval_env_connectors": 0.0001345270360917458, "synch_env_connectors": 4.367451856088591e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00012077866072562328, "timers": {"connectors": {"un_batch_to_individual_items": 6.781634556958101e-06, "tensor_to_numpy": 1.5523216684236773e-05, "remove_single_ts_time_rank_from_batch": 1.2088987640085698e-05, "normalize_and_clip_actions": 8.068794993566865e-06, "get_actions": 4.087304754253085e-05, "listify_data_for_vector_env": 1.0688718635071212e-05}}}, "time_between_sampling": 0.03300215235288795, "episode_duration_sec_mean": 0.005400733475107701, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -2460000.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9020966954197846e-06, "add_time_dim_to_batch_and_zero_pad": 6.99719547049899e-06, "numpy_to_tensor": 1.304469692248541e-05, "add_states_from_episodes_to_batch": 2.7104948234571887e-06, "batch_individual_items": 1.2666246613636873e-05}}, "connector_pipeline_timer": 6.073993177829453e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "agent_episode_returns_mean": {"default_agent": -3.339999999999999}, "weights_seq_no": 5.0, "module_episode_returns_mean": {"default_policy": -3.339999999999999}, "episode_return_min": -13.5, "num_env_steps_sampled": 5000.0, "num_episodes_lifetime": -123000.0, "rlmodule_inference_timer": 3.2657861655085216e-05, "episode_len_mean": 20.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "num_episodes": 250.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.4421177617740089e-05, "episode_return_mean": -3.339999999999999, "env_reset_timer": 4.716737057181965e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "sample": 0.005770550461093876, "episode_return_max": 6.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3169.399772791322}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1344955395624881, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00935208726121281, "add_observations_from_episodes_to_batch": 0.0008365435397299792, "add_columns_from_episodes_to_train_batch": 0.04111192755815805, "add_time_dim_to_batch_and_zero_pad": 0.0751098015739079, "add_states_from_episodes_to_batch": 0.003686723388666385, "batch_individual_items": 0.004161792347943336, "numpy_to_tensor": 7.431278541519072e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "policy_loss": -0.0011885957792401314, "use_intrinsic_rewards": 0.0, "weights_seq_no": 6.0, "vf_explained_var": -0.0015590190887451172, "num_trainable_parameters": 16595, "vf_loss": 0.3583196699619293, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.0025247489102184772, "num_module_steps_trained": 5985, "total_loss": 0.2768996059894562, "module_train_batch_size_mean": 997.8474438281662, "num_module_steps_trained_lifetime": 35910, "entropy": 0.6879115700721741, "vf_loss_unclipped": 48.51519775390625, "mean_kl_loss": 8.3819919382222e-05, "num_module_steps_trained_lifetime_throughput": 814.6071924472136}, "IntrinsicAttentionMask": [[[0.09057748317718506, 0.09136269241571426, 0.09058239310979843, 0.09133259207010269, 0.0913175418972969, 0.09053763002157211, 0.09128744900226593, 0.09050779789686203, 0.09049288928508759, 0.0907742977142334, 0.09122730046510696], [0.09147454798221588, 0.09013643115758896, 0.09146608412265778, 0.09018715471029282, 0.09021253138780594, 0.09154330939054489, 0.09026329964399338, 0.09159483015537262, 0.09162060171365738, 0.09113620966672897, 0.09036492556333542], [0.09058311581611633, 0.09135497361421585, 0.09058794379234314, 0.09132538735866547, 0.09131059795618057, 0.09054393321275711, 0.09128101915121078, 0.09051460772752762, 0.09049995243549347, 0.09077659249305725, 0.0912218987941742], [0.0914403423666954, 0.09018315374851227, 0.09143240004777908, 0.09023083001375198, 0.09025467932224274, 0.09150491654872894, 0.09030240029096603, 0.09155330061912537, 0.09157750010490417, 0.0911225751042366, 0.090397909283638], [0.09142323583364487, 0.09020651131868362, 0.09141554683446884, 0.09025266766548157, 0.09027574956417084, 0.09148572385311127, 0.09032194316387177, 0.09153252840042114, 0.09155594557523727, 0.09111574292182922, 0.09041439741849899], [0.09053167700767517, 0.09142536669969559, 0.09053726494312286, 0.09139108657836914, 0.09137394279241562, 0.09048634767532349, 0.09133968502283096, 0.0904524177312851, 0.0904354527592659, 0.09075558185577393, 0.09127119928598404], [0.09138903021812439, 0.09025324136018753, 0.09138186275959015, 0.09029635041952133, 0.09031791239976883, 0.09144733101129532, 0.09036104381084442, 0.09149100631475449, 0.09151285141706467, 0.09110209345817566, 0.09044737368822098], [0.09049738943576813, 0.09147230535745621, 0.09050347656011581, 0.09143489599227905, 0.09141619503498077, 0.09044794738292694, 0.09137880057096481, 0.09041095525026321, 0.09039246290922165, 0.09074155241250992, 0.09130406379699707], [0.09048022329807281, 0.09149576723575592, 0.0904865637421608, 0.09145678579807281, 0.09143730252981186, 0.09042873978614807, 0.09139834344387054, 0.09039022028446198, 0.09037096053361893, 0.09073453396558762, 0.09132048487663269], [0.09080325812101364, 0.091053806245327, 0.09080483019351959, 0.09104422479867935, 0.09103944152593613, 0.09079049527645111, 0.09102986007928848, 0.09078094363212585, 0.09077617526054382, 0.09086620062589645, 0.09101071208715439], [0.09132058918476105, 0.09034671634435654, 0.09131444245576859, 0.09038370102643967, 0.09040220826864243, 0.09137053042650223, 0.09043921530246735, 0.09140793979167938, 0.09142664819955826, 0.09107472002506256, 0.09051328897476196]], [[0.08988931775093079, 0.08940638601779938, 0.08984286338090897, 0.08981963992118835, 0.08933708816766739, 0.08931399881839752, 0.09047693014144897, 0.08926784992218018, 0.10250699520111084, 0.08981230854988098, 0.09032668173313141], [0.08911161124706268, 0.08830554783344269, 0.08903394639492035, 0.08899514377117157, 0.08819013833999634, 0.08815169334411621, 0.09009642899036407, 0.08807487040758133, 0.11121361702680588, 0.08898288756608963, 0.08984420448541641], [0.08981748670339584, 0.08930324018001556, 0.08976802229881287, 0.08974329382181168, 0.08922947198152542, 0.08920489251613617, 0.09044346958398819, 0.08915575593709946, 0.10331553220748901, 0.0897354781627655, 0.09028339385986328], [0.08978135883808136, 0.08925147354602814, 0.08973038196563721, 0.08970490097999573, 0.08917546272277832, 0.08915014564990997, 0.0904264971613884, 0.08909951895475388, 0.10372190922498703, 0.08969684690237045, 0.09026150405406952], [0.08899424970149994, 0.08814230561256409, 0.08891214430332184, 0.08887112140655518, 0.08802036195993423, 0.0879797413945198, 0.09003574401140213, 0.08789858222007751, 0.11251864582300186, 0.08885816484689713, 0.08976893872022629], [0.08895481377840042, 0.08808761090040207, 0.08887124061584473, 0.08882948011159897, 0.08796349167823792, 0.08792216330766678, 0.09001517295837402, 0.08783955127000809, 0.11295661330223083, 0.08881629258394241, 0.08974352478981018], [0.0907454788684845, 0.09066276252269745, 0.09073753654956818, 0.09073356539011002, 0.09065086394548416, 0.090646892786026, 0.09084562957286835, 0.09063896536827087, 0.09278590232133865, 0.09073231369256973, 0.0908200740814209], [0.08887550979852676, 0.087977834045887, 0.08878897875547409, 0.08874574303627014, 0.08784938603639603, 0.08780660480260849, 0.08997353911399841, 0.08772111684083939, 0.11383701860904694, 0.08873208612203598, 0.08969219028949738], [0.09613912552595139, 0.10464991629123688, 0.0969248041510582, 0.09732004255056381, 0.10593537241220474, 0.10636736452579498, 0.086764395236969, 0.10723663121461868, 0.012152086943387985, 0.0974452793598175, 0.08906495571136475], [0.08976992219686508, 0.0892350897192955, 0.08971846103668213, 0.08969274163246155, 0.08915837854146957, 0.08913282305002213, 0.09042110294103622, 0.08908172696828842, 0.10385062545537949, 0.0896846204996109, 0.09025456756353378], [0.09053559601306915, 0.09034988284111023, 0.09051775932312012, 0.0905088484287262, 0.09032319486141205, 0.09031429141759872, 0.0907607451081276, 0.09029649943113327, 0.09518390893936157, 0.09050603210926056, 0.09070325642824173]], [[0.09049651026725769, 0.09128101170063019, 0.09079781174659729, 0.091250941157341, 0.09153470396995544, 0.09075293689966202, 0.09120584279298782, 0.09042688459157944, 0.09041198343038559, 0.09039708971977234, 0.09144425392150879], [0.09161324054002762, 0.09027308970689774, 0.09109482914209366, 0.09032390266656876, 0.08984636515378952, 0.0911717414855957, 0.09040015935897827, 0.09173370897769928, 0.09175951778888702, 0.09178533405065536, 0.08999814093112946], [0.0909266397356987, 0.09089325368404388, 0.09091378003358841, 0.09089452773332596, 0.09088252484798431, 0.09091568738222122, 0.09089644253253937, 0.09092961251735687, 0.09093024581670761, 0.09093088656663895, 0.09088634699583054], [0.09157061576843262, 0.09031163156032562, 0.09108373522758484, 0.09035937488079071, 0.08991050720214844, 0.09115597605705261, 0.09043104946613312, 0.09168373048305511, 0.09170796722173691, 0.0917322039604187, 0.09005318582057953], [0.09197212755680084, 0.08994833379983902, 0.09118745476007462, 0.09002477675676346, 0.08930711448192596, 0.09130372107028961, 0.09013956785202026, 0.09215478599071503, 0.09219393879175186, 0.09223310649394989, 0.08953499794006348], [0.09086267650127411, 0.09095095843076706, 0.09089666604995728, 0.09094758331775665, 0.09097936004400253, 0.09089160710573196, 0.09094253182411194, 0.09085480868816376, 0.09085312485694885, 0.09085144102573395, 0.09096924215555191], [0.09150668978691101, 0.09036944061517715, 0.09106706827878952, 0.09041259437799454, 0.09000677615404129, 0.09113230556249619, 0.09047737717628479, 0.09160879254341125, 0.09163065999746323, 0.09165254235267639, 0.09013579785823822], [0.09039690345525742, 0.09137073159217834, 0.0907706767320633, 0.09133335947990417, 0.09168608486652374, 0.09071499109268188, 0.09127733111381531, 0.09031056612730026, 0.09029209613800049, 0.09027362614870071, 0.09157362580299377], [0.09037557989358902, 0.09138994663953781, 0.0907648578286171, 0.09135100990533829, 0.09171851724386215, 0.09070686250925064, 0.09129263460636139, 0.09028568118810654, 0.09026643633842468, 0.09024721384048462, 0.09160134196281433], [0.09035424888134003, 0.09140914678573608, 0.0907590240240097, 0.09136863797903061, 0.09175094217061996, 0.0906987190246582, 0.09130792319774628, 0.09026077389717102, 0.09024077653884888, 0.09022077918052673, 0.0916290432214737], [0.09184429049491882, 0.09006405621767044, 0.09115461260080338, 0.09013137966394424, 0.08949898928403854, 0.09125685691833496, 0.0902324765920639, 0.09200473874807358, 0.09203912317752838, 0.09207352250814438, 0.0896998718380928]], [[0.08817987143993378, 0.08814218640327454, 0.08885498344898224, 0.08806686848402023, 0.08877905458211899, 0.08874111622571945, 0.09066019207239151, 0.08791642636060715, 0.11145010590553284, 0.08956144005060196, 0.08964774012565613], [0.08812197297811508, 0.08808356523513794, 0.08881013840436935, 0.08800679445266724, 0.08873272687196732, 0.08869405835866928, 0.09065074473619461, 0.08785346895456314, 0.11189781874418259, 0.08953035622835159, 0.08961834758520126], [0.0891893208026886, 0.08916475623846054, 0.08962880820035934, 0.08911564201116562, 0.08957944065332413, 0.08955477178096771, 0.09079819917678833, 0.08901749551296234, 0.10372072458267212, 0.09008743613958359, 0.09014338254928589], [0.08800574392080307, 0.08796589076519012, 0.08871994912624359, 0.08788622915744781, 0.08863960951566696, 0.08859947323799133, 0.09063130617141724, 0.0877271294593811, 0.11279795318841934, 0.08946766704320908, 0.08955903351306915], [0.0890783742070198, 0.08905231952667236, 0.08954452723264694, 0.08900024741888046, 0.08949215710163116, 0.08946599066257477, 0.09078554809093475, 0.08889617025852203, 0.10456293821334839, 0.09003113210201263, 0.09009049832820892], [0.08902270346879959, 0.08899591118097305, 0.08950216323137283, 0.08894234895706177, 0.08944829553365707, 0.08942137658596039, 0.09077896922826767, 0.08883531391620636, 0.10498631000518799, 0.09000273793935776, 0.09006381034851074], [0.09164619445800781, 0.09165767580270767, 0.09144163876771927, 0.09168063849210739, 0.09146454185247421, 0.09147600084543228, 0.09090437740087509, 0.09172657132148743, 0.0855686143040657, 0.09122971445322037, 0.09120398014783859], [0.08777155727148056, 0.0877288207411766, 0.08853765577077866, 0.08764340728521347, 0.08845146000385284, 0.08840838819742203, 0.09059017151594162, 0.0874728262424469, 0.11461714655160904, 0.0893402099609375, 0.08943831920623779], [0.10624659806489944, 0.10669788718223572, 0.09850744158029556, 0.10760620981454849, 0.09934604167938232, 0.0997680127620697, 0.08069585263729095, 0.10944613069295883, 0.010416322387754917, 0.09106761962175369, 0.0902019590139389], [0.09019120782613754, 0.09018059074878693, 0.09038082510232925, 0.09015936404466629, 0.09035955369472504, 0.09034892171621323, 0.0908827930688858, 0.09011692553758621, 0.09619944542646408, 0.09057814627885818, 0.09060216695070267], [0.09030994772911072, 0.09030105173587799, 0.09046883881092072, 0.09028325974941254, 0.09045101702213287, 0.09044210612773895, 0.09088918566703796, 0.09024769812822342, 0.09531860798597336, 0.09063411504030228, 0.09065423905849457]], [[0.08986558765172958, 0.09198672324419022, 0.09040237218141556, 0.09192534536123276, 0.09189466387033463, 0.09031189978122711, 0.09183334559202194, 0.09025163948535919, 0.09022151678800583, 0.08959605544805527, 0.09171082824468613], [0.09172873944044113, 0.09006741642951965, 0.09130175411701202, 0.0901145339012146, 0.09013810008764267, 0.09137340635061264, 0.09018524736166, 0.09142119437456131, 0.09144511073827744, 0.0919448658823967, 0.09027962386608124], [0.09034028649330139, 0.09149564802646637, 0.090633824467659, 0.0914623886346817, 0.09144575893878937, 0.0905844122171402, 0.0914125144481659, 0.0905514806509018, 0.09053502231836319, 0.09019258618354797, 0.09134606271982193], [0.0916753038764, 0.09012217074632645, 0.09127629548311234, 0.09016624093055725, 0.09018828719854355, 0.09134326130151749, 0.09023238718509674, 0.09138792753219604, 0.09141026437282562, 0.09187721461057663, 0.0903206616640091], [0.09164857864379883, 0.09014953672885895, 0.0912635549902916, 0.09019208699464798, 0.0902133658528328, 0.09132817387580872, 0.09025594592094421, 0.09137127548456192, 0.09139283001422882, 0.0918433889746666, 0.09034116566181183], [0.09026043862104416, 0.0915781632065773, 0.09059500694274902, 0.09154019504785538, 0.09152121841907501, 0.09053867310285568, 0.09148326516151428, 0.09050113707780838, 0.09048236906528473, 0.09009215235710144, 0.0914074182510376], [0.09159515798091888, 0.09020432084798813, 0.09123808145523071, 0.09024382382631302, 0.09026357531547546, 0.09129801392555237, 0.09030310064554214, 0.09133800119161606, 0.0913579910993576, 0.0917757898569107, 0.09038221091032028], [0.09020720422267914, 0.09163317829370499, 0.09056910127401352, 0.09159206598997116, 0.09157151728868484, 0.09050815552473068, 0.09153043478727341, 0.09046754240989685, 0.09044724702835083, 0.09002521634101868, 0.09144831448793411], [0.09018059074878693, 0.09166068583726883, 0.09055613726377487, 0.09161800146102905, 0.09159666299819946, 0.09049288928508759, 0.09155400842428207, 0.09045074135065079, 0.09042968600988388, 0.08999175578355789, 0.09146875888109207], [0.08962640911340714, 0.09223469346761703, 0.09028515219688416, 0.09215901792049408, 0.09212120622396469, 0.09017406404018402, 0.0920456275343895, 0.09010007977485657, 0.09006310999393463, 0.08929598331451416, 0.09189464151859283], [0.0914883092045784, 0.0903138741850853, 0.09118705987930298, 0.09034726768732071, 0.09036397188901901, 0.0912376418709755, 0.09039738029241562, 0.09127137809991837, 0.0912882462143898, 0.09164063632488251, 0.09046424180269241]], [[0.08971763402223587, 0.08969445526599884, 0.089212566614151, 0.08964809775352478, 0.08962493389844894, 0.08914342522621155, 0.09076844900846481, 0.08909736573696136, 0.1028372198343277, 0.0901016816496849, 0.09015417098999023], [0.08967607468366623, 0.08965213596820831, 0.08915466070175171, 0.08960428088903427, 0.08958036452531815, 0.08908327668905258, 0.0907612070441246, 0.08903573453426361, 0.10325285792350769, 0.0900726169347763, 0.09012681990861893], [0.08877471834421158, 0.08873526751995087, 0.08791700005531311, 0.08865642547607422, 0.08861702680587769, 0.08779985457658768, 0.090570367872715, 0.08772184699773788, 0.11225936561822891, 0.08942924439907074, 0.08951885998249054], [0.08959247916936874, 0.08956704288721085, 0.0890384241938591, 0.08951618522405624, 0.08949077129364014, 0.0889625996351242, 0.09074621647596359, 0.08891208469867706, 0.10408858209848404, 0.09001398831605911, 0.09007161855697632], [0.08955047279596329, 0.0895242765545845, 0.08898012340068817, 0.08947192132472992, 0.08944575488567352, 0.0889020711183548, 0.09073847532272339, 0.08885007351636887, 0.10450869053602219, 0.08998444676399231, 0.09004378318786621], [0.08863938599824905, 0.08859773725271225, 0.08773401379585266, 0.08851449191570282, 0.0884728953242302, 0.0876103937625885, 0.0905364602804184, 0.08752807974815369, 0.1136106550693512, 0.08933062851428986, 0.08942528814077377], [0.09143953025341034, 0.09145098179578781, 0.09169000387191772, 0.09147389233112335, 0.09148534387350082, 0.0917244553565979, 0.09092505276203156, 0.09174743294715881, 0.08558809012174606, 0.0912504643201828, 0.09122472256422043], [0.08854836225509644, 0.08850523829460144, 0.08761131018400192, 0.08841907232999802, 0.08837602287530899, 0.08748339861631393, 0.09051290154457092, 0.0873982161283493, 0.11451934278011322, 0.08926401287317276, 0.08936203271150589], [0.0985092967748642, 0.09892772138118744, 0.10806529968976974, 0.09976989775896072, 0.10019367933273315, 0.10944818705320358, 0.08138439804315567, 0.11037992686033249, 0.01050525438040495, 0.09184464067220688, 0.09097159653902054], [0.09038303792476654, 0.09037240594625473, 0.09015095978975296, 0.09035113453865051, 0.0903404951095581, 0.0901191309094429, 0.09086362272500992, 0.09009791910648346, 0.09617915004491806, 0.09055904299020767, 0.09058305621147156], [0.09047066420316696, 0.09046175330877304, 0.09027619659900665, 0.0904439315199852, 0.09043502062559128, 0.09024951606988907, 0.0908731073141098, 0.09023173898458481, 0.09530174732208252, 0.0906180888414383, 0.09063820540904999]]], "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"use_intrinsic_rewards": 1.0, "weights_seq_no": 36.0, "vf_loss": 0.35855111479759216, "policy_loss": -0.0011374729219824076, "vf_explained_var": 0.001395881175994873, "total_loss": 0.27714288234710693, "diff_num_grad_updates_vs_sampler_policy": 31.0, "num_module_steps_trained": 35910, "entropy": 0.6879697442054749, "vf_loss_unclipped": 48.28772735595703, "module_train_batch_size_mean": 997.5548130830801, "num_module_steps_trained_lifetime": 215460, "mean_kl_loss": 7.657252717763186e-05}, "intrinsic_reward_module": {"total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 31.0, "module_train_batch_size_mean": 997.5548130830801, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 215460, "weights_seq_no": 36.0}, "__all_modules__": {"num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 1188000, "num_module_steps_trained_lifetime": 430920, "num_env_steps_trained_lifetime_throughput": 56633.95280227283}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 71820, "num_env_steps_trained_lifetime": 198000, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime_throughput": 4493.30596747279, "num_module_steps_trained_throughput": 26369497.06962818, "num_module_steps_trained_lifetime_throughput": 14696022.638885517}, "intrinsic_reward_module": {"total_loss": 0.0, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "default_optimizer_learning_rate": 0.0002715581955, "module_train_batch_size_mean": 997.8474438281662, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 35910, "weights_seq_no": 6.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 814.6194932021133}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.97117109430447e-05, "module_to_env_connector": {"connector_pipeline_timer": 0.00016419557499925623, "timers": {"connectors": {"tensor_to_numpy": 1.819132036934424e-05, "normalize_and_clip_actions": 9.343980780973511e-06, "listify_data_for_vector_env": 2.042542393073227e-05, "un_batch_to_individual_items": 1.16554286779546e-05, "remove_single_ts_time_rank_from_batch": 1.4250487705186456e-05, "get_actions": 5.244454430356401e-05}}}, "agent_episode_returns_mean": {"default_agent": 0.9}, "env_step_timer": 2.2007959369315826e-05, "env_reset_timer": 0.00017091854662106118, "env_to_module_connector": {"connector_pipeline_timer": 7.375006499822539e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 9.828453626243095e-06, "add_observations_from_episodes_to_batch": 3.631175084331925e-06, "add_states_from_episodes_to_batch": 3.3952984619593806e-06, "numpy_to_tensor": 1.468852853740333e-05, "batch_individual_items": 1.4860932830875222e-05}}}, "sample": 0.11577903729247135, "episode_return_max": 13.5, "episode_len_mean": 20.0, "episode_len_max": 20, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "episode_duration_sec_mean": 0.005502264954848215, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": 0.9}, "env_to_module_sum_episodes_length_out": 10.368238394470474, "num_env_steps_sampled_lifetime": 30400, "env_to_module_sum_episodes_length_in": 10.368238394470474, "weights_seq_no": 6.0, "episode_return_min": -15.5, "num_env_steps_sampled": 400, "num_episodes_lifetime": 120, "num_episodes": 20, "episode_return_mean": 0.9, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "time_between_sampling": 9.346627998372197}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "b1709_00000", "date": "2025-08-11_18-33-32", "timestamp": 1754930012, "time_this_iter_s": 10.860751867294312, "time_total_s": 57.743823766708374, "pid": 11351, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3845f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 57.743823766708374, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 50.0125, "ram_util_percent": 80.725}}
{"timers": {"training_iteration": 9.063937552719855, "restore_env_runners": 1.2442977620779583e-05, "training_step": 9.063801973816565, "env_runner_sampling_timer": 1.6196489843576758, "learner_update_timer": 7.271762467551388, "synch_weights": 0.0008098244509388335, "restore_eval_env_runners": 8.306719764657355e-06, "evaluation_iteration": 0.12285710497403794, "synch_eval_env_connectors": 0.00013532718602508336, "synch_env_connectors": 4.405447342402173e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.0001334735475465326, "timers": {"connectors": {"un_batch_to_individual_items": 7.164279315366478e-06, "tensor_to_numpy": 1.6636263602024284e-05, "remove_single_ts_time_rank_from_batch": 1.2844269968214905e-05, "normalize_and_clip_actions": 8.735652368616222e-06, "get_actions": 4.7604986248268424e-05, "listify_data_for_vector_env": 1.1661282954549518e-05}}}, "time_between_sampling": 0.03746774919458779, "episode_duration_sec_mean": 0.006061573141254482, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -3077500.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.0901001721195037e-06, "add_time_dim_to_batch_and_zero_pad": 7.557931653575153e-06, "numpy_to_tensor": 1.7513764347157697e-05, "add_states_from_episodes_to_batch": 3.0007998984223903e-06, "batch_individual_items": 1.3606680691269153e-05}}, "connector_pipeline_timer": 6.912691183808551e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "agent_episode_returns_mean": {"default_agent": -1.6599999999999997}, "weights_seq_no": 6.0, "module_episode_returns_mean": {"default_policy": -1.6599999999999997}, "episode_return_min": -13.5, "num_env_steps_sampled": 5000.0, "num_episodes_lifetime": -153875.0, "rlmodule_inference_timer": 3.89006631494081e-05, "episode_len_mean": 20.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "num_episodes": 250.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.5904981967681727e-05, "episode_return_mean": -1.6599999999999997, "env_reset_timer": 5.782933157162317e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "sample": 0.006463051792016344, "episode_return_max": 6.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3024.0907453682075}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13456345958634583, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009358800967895603, "add_observations_from_episodes_to_batch": 0.0008370501940073757, "add_columns_from_episodes_to_train_batch": 0.041140177033243665, "add_time_dim_to_batch_and_zero_pad": 0.07513594814815883, "add_states_from_episodes_to_batch": 0.003691796155153591, "batch_individual_items": 0.004162782754723002, "numpy_to_tensor": 7.454382795900592e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "policy_loss": -0.00021060273866169155, "use_intrinsic_rewards": 0.0, "weights_seq_no": 7.0, "vf_explained_var": -0.0009927749633789062, "num_trainable_parameters": 16595, "vf_loss": 0.3583081066608429, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.0012623744551092386, "num_module_steps_trained": 5985, "total_loss": 0.2778699994087219, "module_train_batch_size_mean": 997.82696443245, "num_module_steps_trained_lifetime": 41895, "entropy": 0.6867611408233643, "vf_loss_unclipped": 39.922935485839844, "mean_kl_loss": 3.1121267966227606e-05, "num_module_steps_trained_lifetime_throughput": 810.202217089438}, "IntrinsicAttentionMask": [[[0.0904424712061882, 0.09152527153491974, 0.09074358642101288, 0.09149511158466339, 0.09118141978979111, 0.09040267020463943, 0.09144990146160126, 0.09037289023399353, 0.0906539261341095, 0.09034311026334763, 0.09138964861631393], [0.09218370169401169, 0.08923376351594925, 0.09135013073682785, 0.08931416273117065, 0.09015639871358871, 0.09229464083909988, 0.0894348993897438, 0.09237779676914215, 0.09159727394580841, 0.09246103465557098, 0.08959613740444183], [0.09092893451452255, 0.09088291227817535, 0.09091607481241226, 0.09088418632745743, 0.09089746326208115, 0.09093064069747925, 0.09088609367609024, 0.09093191474676132, 0.09091990441083908, 0.0909331887960434, 0.09088864922523499], [0.09213551878929138, 0.08929690718650818, 0.09133375436067581, 0.08937431126832962, 0.09018509089946747, 0.09224220365285873, 0.08949055522680283, 0.09232217073440552, 0.09157149493694305, 0.09240220487117767, 0.08964578062295914], [0.09163318574428558, 0.08995595574378967, 0.09116163104772568, 0.09000197798013687, 0.09048306941986084, 0.09169581532478333, 0.09007106721401215, 0.09174273163080215, 0.09130163490772247, 0.09178967028856277, 0.09016326069831848], [0.0903780460357666, 0.09161046892404556, 0.09072057157754898, 0.09157611429691315, 0.09121888130903244, 0.09033279120922089, 0.09152461588382721, 0.09029892086982727, 0.0906185656785965, 0.09026506543159485, 0.09145598858594894], [0.09206322580575943, 0.08939163386821747, 0.09130914509296417, 0.08946456015110016, 0.09022809565067291, 0.09216354787349701, 0.08957405388355255, 0.09223873168230057, 0.09153278917074203, 0.0923139750957489, 0.08972025662660599], [0.09032980352640152, 0.09167426824569702, 0.09070330858230591, 0.0916367694735527, 0.09124690294265747, 0.09028046578168869, 0.09158055484294891, 0.09024353325366974, 0.09059205651283264, 0.09020662307739258, 0.09150565415620804], [0.09078425168991089, 0.09107378125190735, 0.09086502343416214, 0.09106574952602386, 0.0909821093082428, 0.0907735601067543, 0.09105370938777924, 0.0907655581831932, 0.09084099531173706, 0.09075755625963211, 0.09103765338659286], [0.09028156846761703, 0.09173809736967087, 0.09068602323532104, 0.09169745445251465, 0.09127490967512131, 0.09022815525531769, 0.09163651615381241, 0.090188167989254, 0.09056553244590759, 0.09014821797609329, 0.09155532717704773], [0.09196683764457703, 0.08951801806688309, 0.09127624332904816, 0.08958493918180466, 0.09028537571430206, 0.0920586809515953, 0.08968541771173477, 0.09212750196456909, 0.09148110449314117, 0.09219637513160706, 0.08981955796480179]], [[0.08988932520151138, 0.08940639346837997, 0.08984287828207016, 0.08936019241809845, 0.08979644626379013, 0.08931401371955872, 0.09047693759202957, 0.08926785737276077, 0.10250691324472427, 0.08981231600046158, 0.090326689183712], [0.08911164104938507, 0.08830558508634567, 0.08903397619724274, 0.08822862058877945, 0.08895638585090637, 0.0881517305970192, 0.09009645134210587, 0.08807490766048431, 0.11121350526809692, 0.08898290991783142, 0.0898442268371582], [0.08981750160455704, 0.08930325508117676, 0.08976803719997406, 0.08925407379865646, 0.08971859514713287, 0.08920490741729736, 0.09044347703456879, 0.08915577828884125, 0.10331545025110245, 0.0897354930639267, 0.09028340131044388], [0.0890335738658905, 0.08819690346717834, 0.08895295113325119, 0.08811704069375992, 0.08887240290641785, 0.08803724497556686, 0.09005618095397949, 0.08795752376317978, 0.11208206415176392, 0.08889993280172348, 0.08979424089193344], [0.08974511176347733, 0.08919959515333176, 0.089692622423172, 0.08914743363857269, 0.08964017033576965, 0.08909529447555542, 0.09040938317775726, 0.08904319256544113, 0.1041296198964119, 0.08965809643268585, 0.09023948013782501], [0.0889548733830452, 0.08808767050504684, 0.0888713002204895, 0.08800490945577621, 0.08878779411315918, 0.08792222291231155, 0.0900152176618576, 0.08783961087465286, 0.11295652389526367, 0.08881634473800659, 0.08974357694387436], [0.0907454788684845, 0.09066275507211685, 0.09073753654956818, 0.09065482765436172, 0.09072960168123245, 0.090646892786026, 0.09084562957286835, 0.09063895791769028, 0.09278593957424164, 0.09073231369256973, 0.0908200740814209], [0.08887556195259094, 0.08797789365053177, 0.08878903836011887, 0.08789223432540894, 0.08870258927345276, 0.08780666440725327, 0.089973583817482, 0.08772118389606476, 0.11383692175149918, 0.08873213827610016, 0.08969224244356155], [0.09614231437444687, 0.10465334355831146, 0.09692801535129547, 0.10550859570503235, 0.09772013872861862, 0.10637083649635315, 0.08676738291978836, 0.10724013298749924, 0.01215270720422268, 0.09744854271411896, 0.0890679806470871], [0.08976992964744568, 0.0892351046204567, 0.08971847593784332, 0.08918395638465881, 0.08966705203056335, 0.08913283795118332, 0.09042111784219742, 0.08908174932003021, 0.1038505807518959, 0.0896846354007721, 0.09025458246469498], [0.09053559601306915, 0.09034989029169083, 0.09051776677370071, 0.09033208340406418, 0.09049992263317108, 0.09031429141759872, 0.0907607302069664, 0.09029649198055267, 0.09518388658761978, 0.09050602465867996, 0.09070325642824173]], [[0.0901910811662674, 0.09171047806739807, 0.09013089537620544, 0.0922582820057869, 0.09161869436502457, 0.09004069864749908, 0.0915575623512268, 0.08998061716556549, 0.08995058387517929, 0.09051808714866638, 0.09204299002885818], [0.09110759198665619, 0.09068673849105835, 0.09112444519996643, 0.0905371829867363, 0.09071190655231476, 0.09114973992109299, 0.09072868525981903, 0.09116660058498383, 0.09117503464221954, 0.0910162553191185, 0.09059581905603409], [0.09015436470508575, 0.0917513370513916, 0.09009113907814026, 0.09232743829488754, 0.09165482968091965, 0.08999638259410858, 0.09159055352210999, 0.08993326872587204, 0.08990172296762466, 0.0904979482293129, 0.09210100769996643], [0.09143320471048355, 0.09032125025987625, 0.09147791564464569, 0.08992813527584076, 0.0903875082731247, 0.09154502302408218, 0.09043170511722565, 0.0915897861123085, 0.09161218255758286, 0.09119115769863129, 0.09008214622735977], [0.09105278551578522, 0.09074816107749939, 0.09106498211622238, 0.09063980728387833, 0.09076639264822006, 0.09108328074216843, 0.09077854454517365, 0.09109547734260559, 0.09110157191753387, 0.0909867063164711, 0.09068229794502258], [0.0900992825627327, 0.0918126106262207, 0.09003149718046188, 0.0924312174320221, 0.09170901030302048, 0.08992990106344223, 0.09164000302553177, 0.08986224234104156, 0.08982843160629272, 0.09046771377325058, 0.0921880379319191], [0.0910162404179573, 0.09078910201787949, 0.09102533012628555, 0.09070826321840286, 0.09080269187688828, 0.09103896468877792, 0.09081176668405533, 0.09104805439710617, 0.0910525992512703, 0.09096698462963104, 0.09073996543884277], [0.09006255865097046, 0.09185345470905304, 0.0899917334318161, 0.09250044822692871, 0.09174512326717377, 0.08988559246063232, 0.09167297184467316, 0.08981490135192871, 0.08977958559989929, 0.09044753760099411, 0.09224609285593033], [0.09004419296979904, 0.09187387675046921, 0.08997184038162231, 0.09253507107496262, 0.09176317602396011, 0.08986343443393707, 0.09168944507837296, 0.08979123830795288, 0.08975515514612198, 0.09043744206428528, 0.09227512031793594], [0.09039001166820526, 0.09148891270160675, 0.09034638106822968, 0.09188386797904968, 0.0914226770401001, 0.09028097242116928, 0.09137853980064392, 0.09023738652467728, 0.09021560847759247, 0.09062694758176804, 0.09172872453927994], [0.09130553156137466, 0.09046465158462524, 0.09133929759263992, 0.09016677737236023, 0.09051483124494553, 0.09138995409011841, 0.09054829925298691, 0.09142374992370605, 0.09144064784049988, 0.09112270921468735, 0.09028351306915283]], [[0.0912482738494873, 0.09111592918634415, 0.09110958874225616, 0.09110324084758759, 0.0910969004034996, 0.09109055995941162, 0.09140859544277191, 0.09107787162065506, 0.0881689041852951, 0.09135333448648453, 0.091226726770401], [0.09208071976900101, 0.09160762280225754, 0.09158498793840408, 0.09156236052513123, 0.09153973311185837, 0.09151711314916611, 0.0926562175154686, 0.09147189557552338, 0.08151811361312866, 0.09245758503675461, 0.09200357645750046], [0.09211952984333038, 0.09162997454404831, 0.09160654991865158, 0.09158313274383545, 0.09155972301959991, 0.09153632074594498, 0.09271517395973206, 0.0914895310997963, 0.08121079951524734, 0.09250957518815994, 0.09203969687223434], [0.0921582281589508, 0.09165219217538834, 0.09162799268960953, 0.09160378575325012, 0.09157959371805191, 0.0915554016828537, 0.09277404099702835, 0.09150704741477966, 0.0809045284986496, 0.09256146848201752, 0.09207570552825928], [0.09219683706760406, 0.0916743129491806, 0.09164932370185852, 0.09162433445453644, 0.09159936010837555, 0.09157437831163406, 0.09283283352851868, 0.09152445197105408, 0.08059932291507721, 0.09261327236890793, 0.09211161732673645], [0.09223533421754837, 0.09169632196426392, 0.09167053550481796, 0.0916447639465332, 0.09161899983882904, 0.09159324318170547, 0.09289153665304184, 0.09154174476861954, 0.0802951455116272, 0.09266498684883118, 0.09214740991592407], [0.09017878025770187, 0.09045185893774033, 0.09046497941017151, 0.09047809988260269, 0.09049122780561447, 0.09050436317920685, 0.0898495763540268, 0.09053061902523041, 0.09686446934938431, 0.08996283262968063, 0.09022315591573715], [0.0923120304942131, 0.09173998981714249, 0.09171263873577118, 0.09168528765439987, 0.09165795147418976, 0.09163062274456024, 0.09300870448350906, 0.0915759801864624, 0.07968995720148087, 0.09276814758777618, 0.09221871197223663], [0.1028636023402214, 0.09410788863897324, 0.09370707720518112, 0.0933079794049263, 0.09291058778762817, 0.09251488745212555, 0.11454956978559494, 0.09172852337360382, 0.01254284754395485, 0.11038170009851456, 0.10138532519340515], [0.09055512398481369, 0.09068945050239563, 0.09069590270519257, 0.0907023549079895, 0.09070879966020584, 0.09071525186300278, 0.09039292484521866, 0.09072815626859665, 0.09378629922866821, 0.090448759496212, 0.09057696908712387], [0.09138684719800949, 0.09119939059019089, 0.0911904126405716, 0.0911814272403717, 0.09117244184017181, 0.09116346389055252, 0.09161410480737686, 0.09114550054073334, 0.08705434948205948, 0.0915357694029808, 0.0913563221693039]], [[0.0901351347565651, 0.0922626182436943, 0.09007498621940613, 0.09220105409622192, 0.09217028319835663, 0.08998484164476395, 0.09150076657533646, 0.08992479741573334, 0.08989479392766953, 0.08986479789018631, 0.09198589622974396], [0.09151177853345871, 0.089854396879673, 0.09155964851379395, 0.089901402592659, 0.08992490917444229, 0.09163150191307068, 0.09044000506401062, 0.09167943149805069, 0.09170340746641159, 0.09172739088535309, 0.090066097676754], [0.09009551256895065, 0.0923319086432457, 0.09003231674432755, 0.09226715564727783, 0.09223479777574539, 0.08993761986494064, 0.09153074771165848, 0.08987455070018768, 0.0898430272936821, 0.08981151878833771, 0.09204087406396866], [0.09147263318300247, 0.0899229422211647, 0.0915173590183258, 0.08996691554784775, 0.08998891711235046, 0.09158450365066528, 0.09047070890665054, 0.09162928909063339, 0.09165168553590775, 0.09167409688234329, 0.09012099355459213], [0.09145304560661316, 0.08995722234249115, 0.09149621427059174, 0.08999968320131302, 0.09002091735601425, 0.09156099706888199, 0.09048604965209961, 0.09160421043634415, 0.09162582457065582, 0.0916474461555481, 0.0901484414935112], [0.09003603458404541, 0.09243587404489517, 0.08996829390525818, 0.09236632287502289, 0.09233157336711884, 0.08986677974462509, 0.09157566726207733, 0.08979915827512741, 0.08976536989212036, 0.0897315964102745, 0.09212332218885422], [0.09102439880371094, 0.09070733934640884, 0.09103348106145859, 0.0907163992524147, 0.09072092175483704, 0.09104711562395096, 0.09081990271806717, 0.0910562127828598, 0.09106075763702393, 0.09106530249118805, 0.09074810147285461], [0.08999636024236679, 0.09250520914793015, 0.08992558717727661, 0.09243246167898178, 0.09239611029624939, 0.08981953561306, 0.09160559624433517, 0.08974889665842056, 0.08971359580755234, 0.0896783173084259, 0.09217829257249832], [0.08997653424739838, 0.09253989160060883, 0.08990424871444702, 0.09246554225683212, 0.09242838621139526, 0.08979591727256775, 0.0916205570101738, 0.08972377330064774, 0.08968771994113922, 0.0896516814827919, 0.09220578521490097], [0.08995668590068817, 0.09257456660270691, 0.08988288044929504, 0.09249861538410187, 0.09246066212654114, 0.0897722840309143, 0.09163549542427063, 0.08969863504171371, 0.08966182917356491, 0.0896250456571579, 0.09223327040672302], [0.09133546054363251, 0.09016299992799759, 0.09136923402547836, 0.09019633382558823, 0.09021301567554474, 0.09141991287469864, 0.09057798981666565, 0.09145371615886688, 0.0914706215262413, 0.09148753434419632, 0.09031311422586441]], [[0.09125940501689911, 0.09112704545259476, 0.09112070500850677, 0.0911143571138382, 0.091233991086483, 0.09110166877508163, 0.0914197489619255, 0.09108898788690567, 0.08805792033672333, 0.09123833477497101, 0.0912378579378128], [0.09211766719818115, 0.09164438396692276, 0.09162174165248871, 0.09159909933805466, 0.09202665835618973, 0.09155383706092834, 0.09269339591264725, 0.09150859713554382, 0.08115190267562866, 0.09204220771789551, 0.09204048663377762], [0.09215761721134186, 0.09166785329580307, 0.09164442867040634, 0.09162100404500961, 0.09206342697143555, 0.09157416969537735, 0.09275350719690323, 0.09152735769748688, 0.08083328604698181, 0.0920795202255249, 0.09207774698734283], [0.0921974703669548, 0.09169121831655502, 0.09166699647903442, 0.09164278209209442, 0.0921000987291336, 0.0915943831205368, 0.09281353652477264, 0.09154600650072098, 0.08051582425832748, 0.09211673587560654, 0.0921149030327797], [0.09142793715000153, 0.09123054146766663, 0.09122107923030853, 0.09121162444353104, 0.09139002114534378, 0.09119270741939545, 0.09166726469993591, 0.09117379784584045, 0.08669274300336838, 0.0913965031504631, 0.0913957878947258], [0.09227683395147324, 0.09173757582902908, 0.09171178191900253, 0.09168599545955658, 0.09217309951782227, 0.09163444489240646, 0.09293332695960999, 0.09158293157815933, 0.07988430559635162, 0.09219083189964294, 0.09218887239694595], [0.09015367180109024, 0.09042667597532272, 0.0904397964477539, 0.09045290946960449, 0.09020599722862244, 0.09047916531562805, 0.08982456475496292, 0.09050541371107101, 0.0971166342496872, 0.09019705653190613, 0.09019804000854492], [0.09235575795173645, 0.09178344905376434, 0.09175607562065125, 0.09172871708869934, 0.09224565327167511, 0.09167402237653732, 0.09305275976657867, 0.09161936491727829, 0.0792572945356369, 0.09226446598768234, 0.0922623872756958], [0.10330364108085632, 0.09417817741632462, 0.09376122802495956, 0.09334612637758255, 0.10148636251688004, 0.09252143651247025, 0.11553070694208145, 0.09170401841402054, 0.010612843558192253, 0.1017947569489479, 0.10176069289445877], [0.09139925241470337, 0.09121299535036087, 0.09120406955480576, 0.09119513630867004, 0.09136348217725754, 0.09117729216814041, 0.09162505716085434, 0.09115944802761078, 0.08692476898431778, 0.09136959165334702, 0.09136892110109329], [0.09140241891145706, 0.09121493250131607, 0.09120594710111618, 0.09119696170091629, 0.09136641025543213, 0.09117899090051651, 0.09162971377372742, 0.09116102755069733, 0.08689914643764496, 0.09137256443500519, 0.09137188643217087]]], "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"use_intrinsic_rewards": 1.0, "weights_seq_no": 42.0, "vf_loss": 0.3585134744644165, "policy_loss": -0.00020598058472387493, "vf_explained_var": 0.0016384720802307129, "total_loss": 0.2780393660068512, "diff_num_grad_updates_vs_sampler_policy": 36.0, "num_module_steps_trained": 35910, "entropy": 0.6867790222167969, "vf_loss_unclipped": 39.8957633972168, "module_train_batch_size_mean": 997.5374097747205, "num_module_steps_trained_lifetime": 251370, "mean_kl_loss": 2.987994594150223e-05}, "intrinsic_reward_module": {"total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 36.0, "module_train_batch_size_mean": 997.5374097747205, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 251370, "weights_seq_no": 42.0}, "__all_modules__": {"num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 1386000, "num_module_steps_trained_lifetime": 502740, "num_env_steps_trained_lifetime_throughput": 55653.443822501526}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 83790, "num_env_steps_trained_lifetime": 231000, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime_throughput": 4468.957112707332, "num_module_steps_trained_throughput": 25646734.177659158, "num_module_steps_trained_lifetime_throughput": 14585552.221340176}, "intrinsic_reward_module": {"total_loss": 0.0, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "default_optimizer_learning_rate": 0.0002715581955, "module_train_batch_size_mean": 997.82696443245, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 41895, "weights_seq_no": 7.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 810.2139516454512}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.107389373529579e-05, "module_to_env_connector": {"connector_pipeline_timer": 0.0001146881598173745, "timers": {"connectors": {"tensor_to_numpy": 1.5050843093526797e-05, "normalize_and_clip_actions": 7.82900847328824e-06, "listify_data_for_vector_env": 1.0581075588888607e-05, "un_batch_to_individual_items": 6.5517002839629525e-06, "remove_single_ts_time_rank_from_batch": 1.1799565461513639e-05, "get_actions": 3.66796518554765e-05}}}, "agent_episode_returns_mean": {"default_agent": 0.5}, "env_step_timer": 1.3919653132463378e-05, "env_reset_timer": 0.00017086145056810603, "env_to_module_connector": {"connector_pipeline_timer": 5.970063998345349e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.234348597460932e-06, "add_observations_from_episodes_to_batch": 2.8281958138168593e-06, "add_states_from_episodes_to_batch": 2.748868860342828e-06, "numpy_to_tensor": 1.199124233707962e-05, "batch_individual_items": 1.2430739929855259e-05}}}, "sample": 0.11576489483848997, "episode_return_max": 13.5, "episode_len_mean": 20.0, "episode_len_max": 20, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "episode_duration_sec_mean": 0.005468069962225854, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": 0.5}, "env_to_module_sum_episodes_length_out": 10.368238394572801, "num_env_steps_sampled_lifetime": 35400, "env_to_module_sum_episodes_length_in": 10.368238394572801, "weights_seq_no": 7.0, "episode_return_min": -15.5, "num_env_steps_sampled": 400, "num_episodes_lifetime": 140, "num_episodes": 20, "episode_return_mean": 0.5, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "time_between_sampling": 9.34759391880889}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "b1709_00000", "date": "2025-08-11_18-33-42", "timestamp": 1754930022, "time_this_iter_s": 9.519087791442871, "time_total_s": 67.26291155815125, "pid": 11351, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3845f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 67.26291155815125, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 42.47692307692307, "ram_util_percent": 80.22307692307692}}
{"timers": {"training_iteration": 9.071120630112448, "restore_env_runners": 1.2374387617839295e-05, "training_step": 9.070983976998313, "env_runner_sampling_timer": 1.6192646915937483, "learner_update_timer": 7.278839615796305, "synch_weights": 0.0008171724567563767, "restore_eval_env_runners": 8.369902807515523e-06, "evaluation_iteration": 0.1228428101749822, "synch_eval_env_connectors": 0.000136090994313142, "synch_env_connectors": 4.40389261051751e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00012090148957337933, "timers": {"connectors": {"un_batch_to_individual_items": 6.725482625959475e-06, "tensor_to_numpy": 1.5444380504857792e-05, "remove_single_ts_time_rank_from_batch": 1.2363242222813227e-05, "normalize_and_clip_actions": 8.053845004492028e-06, "get_actions": 4.0674582573467884e-05, "listify_data_for_vector_env": 1.0669669515424262e-05}}}, "time_between_sampling": 0.032019304913926565, "episode_duration_sec_mean": 0.005426198502071201, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -3695000.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8886766185642633e-06, "add_time_dim_to_batch_and_zero_pad": 7.064811699828639e-06, "numpy_to_tensor": 1.3321459072808556e-05, "add_states_from_episodes_to_batch": 2.7006395382061366e-06, "batch_individual_items": 1.3209486982060404e-05}}, "connector_pipeline_timer": 6.156227411314218e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "agent_episode_returns_mean": {"default_agent": -2.7799999999999994}, "weights_seq_no": 7.0, "module_episode_returns_mean": {"default_policy": -2.7799999999999994}, "episode_return_min": -13.5, "num_env_steps_sampled": 5000.0, "num_episodes_lifetime": -184750.0, "rlmodule_inference_timer": 3.3153354081872423e-05, "episode_len_mean": 20.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "num_episodes": 250.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.4415224695075609e-05, "episode_return_mean": -2.7799999999999994, "env_reset_timer": 4.4587363579254206e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "sample": 0.005822706688361994, "episode_return_max": 6.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3225.5346738663366}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1349386687410002, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009353661288278158, "add_observations_from_episodes_to_batch": 0.0008368967720978922, "add_columns_from_episodes_to_train_batch": 0.04113990901395155, "add_time_dim_to_batch_and_zero_pad": 0.07551691991621419, "add_states_from_episodes_to_batch": 0.0036921173630711586, "batch_individual_items": 0.004162494087118935, "numpy_to_tensor": 7.461381032377366e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "policy_loss": -9.332994522992522e-05, "use_intrinsic_rewards": 0.0, "weights_seq_no": 8.0, "vf_explained_var": -0.00017201900482177734, "num_trainable_parameters": 16595, "vf_loss": 0.3583044707775116, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.0006311872275546193, "num_module_steps_trained": 5985, "total_loss": 0.2779846787452698, "module_train_batch_size_mean": 997.8076834879114, "num_module_steps_trained_lifetime": 47880, "entropy": 0.6865492463111877, "vf_loss_unclipped": 44.34480285644531, "mean_kl_loss": 5.988038992654765e-06, "num_module_steps_trained_lifetime_throughput": 805.5934944596389}, "IntrinsicAttentionMask": [[[0.09049674868583679, 0.09158019721508026, 0.09050165861845016, 0.09125117212533951, 0.09123613685369492, 0.09075318276882172, 0.09120607376098633, 0.09072327613830566, 0.09070833027362823, 0.09039733558893204, 0.09114598482847214], [0.09203775972127914, 0.08909250795841217, 0.09202412515878677, 0.08997315168380737, 0.09001367539167404, 0.09132879972457886, 0.09009477496147156, 0.09141109138727188, 0.09145225584506989, 0.09231465309858322, 0.0902572050690651], [0.0905037596821785, 0.09156876057386398, 0.09050857275724411, 0.09124535322189331, 0.09123057872056961, 0.09075584262609482, 0.09120102971792221, 0.09072644263505936, 0.09071175009012222, 0.09040601551532745, 0.0911419615149498], [0.09157120436429977, 0.08983983844518661, 0.09156324714422226, 0.09035997092723846, 0.0903838574886322, 0.09115656465291977, 0.09043164551258087, 0.09120475500822067, 0.09122886508703232, 0.09173279255628586, 0.09052728861570358], [0.09154985100030899, 0.08987415581941605, 0.09154215455055237, 0.09037767350673676, 0.09040079265832901, 0.09114863723516464, 0.09044704586267471, 0.09119527786970139, 0.09121859818696976, 0.09170619398355484, 0.09053962677717209], [0.0908626839518547, 0.09098441898822784, 0.09086324274539948, 0.09094758331775665, 0.09094589948654175, 0.09089161455631256, 0.09094253182411194, 0.09088824689388275, 0.09088655561208725, 0.09085144847631454, 0.09093578159809113], [0.09150715917348862, 0.0899428129196167, 0.09149996936321259, 0.09041307866573334, 0.09043466299772263, 0.09113278239965439, 0.0904778465628624, 0.09117630124092102, 0.09119807183742523, 0.091653011739254, 0.0905642956495285], [0.09082005172967911, 0.09105366468429565, 0.09082111716270447, 0.09098295122385025, 0.09097971022129059, 0.0908755362033844, 0.09097324311733246, 0.09086907655000687, 0.0908658429980278, 0.0907985046505928, 0.0909603014588356], [0.0907987430691719, 0.09108830988407135, 0.09080006182193756, 0.09100063890218735, 0.0909966230392456, 0.09086750447750092, 0.09098860621452332, 0.09085949510335922, 0.09085548669099808, 0.09077204018831253, 0.09097256511449814], [0.09035466611385345, 0.09181235730648041, 0.09036124497652054, 0.09136904776096344, 0.0913488045334816, 0.09069912880659103, 0.09130832552909851, 0.09065894037485123, 0.09063885360956192, 0.09022119641304016, 0.09122743457555771], [0.09142178297042847, 0.09008024632930756, 0.09141562879085541, 0.09048387408256531, 0.09050239622592926, 0.0911010205745697, 0.09053944796323776, 0.0911383181810379, 0.0911569744348526, 0.0915466919541359, 0.09061360359191895]], [[0.08980685472488403, 0.08932437002658844, 0.0897604376077652, 0.08973724395036697, 0.08971405774354935, 0.08923207223415375, 0.09039391577243805, 0.08964452892541885, 0.10241279006004333, 0.0897299125790596, 0.09024382382631302], [0.08897536247968674, 0.08817053586244583, 0.08889781683683395, 0.08885907381772995, 0.08882034569978714, 0.08801692724227905, 0.08995866030454636, 0.08870425820350647, 0.11104331165552139, 0.0888468325138092, 0.08970683068037033], [0.08972977101802826, 0.08921602368354797, 0.08968034386634827, 0.08965563774108887, 0.08963095396757126, 0.08911777287721634, 0.09035512059926987, 0.08955690264701843, 0.10321445018053055, 0.08964783698320389, 0.09019520878791809], [0.08969100564718246, 0.08916164934635162, 0.0896400734782219, 0.0896146222949028, 0.0895891785621643, 0.08906042575836182, 0.09033548086881638, 0.08951287716627121, 0.1036173403263092, 0.08960657566785812, 0.09017065912485123], [0.08965211361646652, 0.08910717070102692, 0.08959967643022537, 0.08957347273826599, 0.08954727649688721, 0.08900297433137894, 0.09031569957733154, 0.08946873247623444, 0.10402163863182068, 0.08956519514322281, 0.09014597535133362], [0.0888085588812828, 0.08794278651475906, 0.08872511982917786, 0.08868341892957687, 0.08864175528287888, 0.08777760714292526, 0.08986715227365494, 0.08851685374975204, 0.11277060210704803, 0.08867024630308151, 0.08959595113992691], [0.0907311886548996, 0.09064847975969315, 0.09072325378656387, 0.09071928262710571, 0.09071531146764755, 0.0906326174736023, 0.09083132445812225, 0.09070340543985367, 0.09277136623859406, 0.09071802347898483, 0.0908057764172554], [0.08953457325696945, 0.08894297480583191, 0.08947763592004776, 0.08944918215274811, 0.08942074328660965, 0.0888298898935318, 0.09025540202856064, 0.08933545649051666, 0.10524289309978485, 0.08944018930196762, 0.09007100015878677], [0.09775575250387192, 0.10640957206487656, 0.09855464100837708, 0.09895652532577515, 0.09936004877090454, 0.10815589129924774, 0.08822357654571533, 0.10058052837848663, 0.01235683262348175, 0.09908393025398254, 0.09056275337934494], [0.08967873454093933, 0.08914445340633392, 0.08962732553482056, 0.08960164338350296, 0.08957595378160477, 0.0890422835946083, 0.09032925218343735, 0.08949895203113556, 0.10374503582715988, 0.08959351480007172, 0.09016288816928864], [0.09050361812114716, 0.09031796455383301, 0.09048578143119812, 0.0904768705368042, 0.09046795964241028, 0.0902823880314827, 0.09072867035865784, 0.09044122695922852, 0.09515024721622467, 0.09047404676675797, 0.09067121893167496]], [[0.09019097685813904, 0.09171036630868912, 0.09013079106807709, 0.09225817024707794, 0.09161859005689621, 0.09004059433937073, 0.09216584265232086, 0.09057842195034027, 0.08995048701763153, 0.08992046862840652, 0.09143530577421188], [0.091107577085495, 0.09068672358989716, 0.09112443774938583, 0.0905371755361557, 0.09071189165115356, 0.0911497250199318, 0.09056229889392853, 0.09099940210580826, 0.09117501974105835, 0.09118345379829407, 0.09076225012540817], [0.0901542454957962, 0.09175120294094086, 0.09009101986885071, 0.0923273041844368, 0.0916547030210495, 0.08999625593423843, 0.09223019331693649, 0.09056134521961212, 0.08990159630775452, 0.08987007290124893, 0.09146199375391006], [0.09143313765525818, 0.09032119065523148, 0.09147784858942032, 0.08992808312177658, 0.09038745611906052, 0.09154496341943741, 0.08999405801296234, 0.09114652872085571, 0.09161212295293808, 0.09163451939821243, 0.09052012115716934], [0.09105278551578522, 0.09074816107749939, 0.09106497466564178, 0.09063981473445892, 0.09076638519763947, 0.09108327329158783, 0.0906580239534378, 0.09097452461719513, 0.09110156446695328, 0.09110766649246216, 0.09080285578966141], [0.09009914845228195, 0.09181246906518936, 0.09003136307001114, 0.09243107587099075, 0.09170886874198914, 0.08992977440357208, 0.09232677519321442, 0.09053570032119751, 0.08982830494642258, 0.08979450166225433, 0.09150202572345734], [0.09137844294309616, 0.0903826653957367, 0.09141846001148224, 0.09003031998872757, 0.09044204652309418, 0.09147851169109344, 0.09008946269750595, 0.09112189710140228, 0.09153860807418823, 0.09155865013599396, 0.0905609130859375], [0.09042663127183914, 0.09144797176122665, 0.0903860554099083, 0.09181484580039978, 0.09138643741607666, 0.0903252363204956, 0.09175305813550949, 0.09068760275840759, 0.0902644470334053, 0.09024420380592346, 0.09126348793506622], [0.0900440439581871, 0.09187372028827667, 0.08997169882059097, 0.09253491461277008, 0.09176301956176758, 0.08986329287290573, 0.09242341667413712, 0.09051001816987991, 0.08975501358509064, 0.08971894532442093, 0.09154202044010162], [0.0900256559252739, 0.09189412742853165, 0.08995179831981659, 0.09256953001022339, 0.09178104996681213, 0.08984111994504929, 0.09245563298463821, 0.09050143510103226, 0.08973057568073273, 0.08969376236200333, 0.09155533462762833], [0.09094313532114029, 0.09087098389863968, 0.0909460186958313, 0.0908452719449997, 0.0908753052353859, 0.09095034748315811, 0.09084959328174591, 0.09092461317777634, 0.09095466881990433, 0.09095611423254013, 0.09088394790887833]], [[0.09144769608974457, 0.09142588078975677, 0.09183788299560547, 0.09181597828865051, 0.09179407358169556, 0.0917721688747406, 0.09287484735250473, 0.09129507839679718, 0.08168421685695648, 0.09224479645490646, 0.09180740267038345], [0.09146514534950256, 0.0914425477385521, 0.09186936914920807, 0.09184666723012924, 0.09182398021221161, 0.09180128574371338, 0.09294392168521881, 0.09130705893039703, 0.0813712626695633, 0.0922909751534462, 0.09183778613805771], [0.09111598134040833, 0.09110808372497559, 0.0912569910287857, 0.09124908596277237, 0.09124117344617844, 0.0912332683801651, 0.09162988513708115, 0.09106072783470154, 0.08745520561933517, 0.09140363335609436, 0.09124598652124405], [0.09113559871912003, 0.0911269262433052, 0.09129051119089127, 0.09128181636333466, 0.09127313643693924, 0.09126444905996323, 0.09170027822256088, 0.09107489883899689, 0.08712227642536163, 0.09145163744688034, 0.09127841889858246], [0.09115510433912277, 0.09114564955234528, 0.09132391959428787, 0.09131445735692978, 0.09130498766899109, 0.0912955179810524, 0.09177060425281525, 0.09108895808458328, 0.08679049462080002, 0.09149953722953796, 0.09131074696779251], [0.09117448329925537, 0.0911642536520958, 0.09135721623897552, 0.09134696424007416, 0.09133671224117279, 0.09132646769285202, 0.09184085577726364, 0.09110289812088013, 0.08645986020565033, 0.09154734015464783, 0.09134294837713242], [0.09004499763250351, 0.09007328003644943, 0.08954182267189026, 0.08956994861364365, 0.08959808200597763, 0.08962622284889221, 0.08822836726903915, 0.09024316072463989, 0.10447082668542862, 0.08902234584093094, 0.0895809680223465], [0.09156737476587296, 0.09154007583856583, 0.09205593913793564, 0.09202849119901657, 0.0920010507106781, 0.09197361767292023, 0.09335685521364212, 0.0913764238357544, 0.07951634377241135, 0.09256599098443985, 0.0920177474617958], [0.09134187549352646, 0.09095285087823868, 0.09856999665498734, 0.09815019369125366, 0.09773217141628265, 0.09731593728065491, 0.12049397081136703, 0.08865326642990112, 0.012122471816837788, 0.10668099671602249, 0.09798627346754074], [0.09072937816381454, 0.09073583036661148, 0.09061432629823685, 0.09062076359987259, 0.09062721580266953, 0.09063366055488586, 0.09031162410974503, 0.09077455848455429, 0.09383425116539001, 0.09049501270055771, 0.09062329679727554], [0.09114325791597366, 0.09113427996635437, 0.09130360931158066, 0.09129461646080017, 0.09128562361001968, 0.0912766307592392, 0.0917278304696083, 0.0910804271697998, 0.08699219673871994, 0.09147040545940399, 0.09129109233617783]], [[0.09013808518648148, 0.09165658056735992, 0.09007792919874191, 0.09159541875123978, 0.0915648564696312, 0.09058574587106705, 0.09211178869009018, 0.0905253067612648, 0.08989772945642471, 0.09046489000320435, 0.09138167649507523], [0.09112289547920227, 0.09070197492837906, 0.09113974869251251, 0.09071875363588333, 0.09072714298963547, 0.0909978598356247, 0.09057752043008804, 0.09101469814777374, 0.09119034558534622, 0.09103154391050339, 0.09077750891447067], [0.09009876102209091, 0.09169473499059677, 0.0900355726480484, 0.09163042902946472, 0.09159828722476959, 0.09056912362575531, 0.09217342734336853, 0.09050559997558594, 0.08984626829624176, 0.09044212847948074, 0.09140569716691971], [0.09108351916074753, 0.09074010699987411, 0.09109726548194885, 0.09075380116701126, 0.09076065570116043, 0.09098154306411743, 0.09063851833343506, 0.09099527448415756, 0.09113852679729462, 0.09100901335477829, 0.09080176055431366], [0.09106383472681046, 0.09075917303562164, 0.09107603132724762, 0.09077132493257523, 0.09077740460634232, 0.0909733846783638, 0.09066902101039886, 0.09098556637763977, 0.09111262112855911, 0.09099774807691574, 0.09081387519836426], [0.09042999893426895, 0.09137345850467682, 0.09039250761270523, 0.09133557230234146, 0.09131663292646408, 0.09070875495672226, 0.09165512025356293, 0.09067115187644958, 0.09028012305498123, 0.09063355624675751, 0.09120309352874756], [0.09141514450311661, 0.0904189720749855, 0.09145517647266388, 0.09045856446027756, 0.09047836810350418, 0.09111859649419785, 0.09012565016746521, 0.09115849435329437, 0.09157537668943405, 0.09119841456413269, 0.09059728682041168], [0.09039067476987839, 0.09141161292791367, 0.09035012125968933, 0.0913706049323082, 0.09135010093450546, 0.09069223701953888, 0.09171658009290695, 0.09065154194831848, 0.09022856503725052, 0.09061087667942047, 0.09122719615697861], [0.08998078852891922, 0.09180918335914612, 0.08990850299596786, 0.09173541516065598, 0.091698557138443, 0.09051916003227234, 0.09235849231481552, 0.09044643491506577, 0.08969196677207947, 0.09037376940250397, 0.09147771447896957], [0.09035133570432663, 0.09144975244998932, 0.09030772000551224, 0.09140561521053314, 0.09138354659080505, 0.09067568182945251, 0.09177804738283157, 0.09063190966844559, 0.0901770070195198, 0.09058816730976105, 0.09125127643346786], [0.09094574302434921, 0.090873584151268, 0.09094862639904022, 0.09087646752595901, 0.09087790548801422, 0.09092433750629425, 0.09085220098495483, 0.09092722088098526, 0.09095727652311325, 0.09093010425567627, 0.09088655561208725]], [[0.09164222329854965, 0.09162034839391708, 0.0915984958410263, 0.09157664328813553, 0.09198932349681854, 0.09153295308351517, 0.09307239949703217, 0.0914892703294754, 0.08147129416465759, 0.09200433641672134, 0.09200268238782883], [0.0916665717959404, 0.09164392203092575, 0.0916212722659111, 0.09159863740205765, 0.09202618896961212, 0.09155336767435074, 0.0931485965847969, 0.09150813519954681, 0.08115152269601822, 0.0920417383313179, 0.09204002469778061], [0.0916908010840416, 0.09166736900806427, 0.09164392948150635, 0.09162050485610962, 0.09206292778253555, 0.09157367795705795, 0.09322472661733627, 0.09152686595916748, 0.08083289116621017, 0.0920790284872055, 0.09207724779844284], [0.09171491116285324, 0.09169068932533264, 0.09166646748781204, 0.09164226055145264, 0.09209956973791122, 0.09159385412931442, 0.09330078959465027, 0.0915454775094986, 0.08051539957523346, 0.09211619943380356, 0.09211436659097672], [0.09123991429805756, 0.09123045206069946, 0.09122098982334137, 0.09121153503656387, 0.09138993918895721, 0.09119261801242828, 0.091855987906456, 0.09117370843887329, 0.0866926833987236, 0.09139641374349594, 0.09139569848775864], [0.09176277369260788, 0.09173697233200073, 0.09171117842197418, 0.09168539941310883, 0.09217249602079391, 0.09163384884595871, 0.09345271438360214, 0.09158232808113098, 0.07988382130861282, 0.092190220952034, 0.092188261449337], [0.08978556096553802, 0.08981376141309738, 0.08984196186065674, 0.08987018465995789, 0.08933992683887482, 0.08992664515972137, 0.0879741683602333, 0.08998315036296844, 0.10482099652290344, 0.08932074904441833, 0.08932286500930786], [0.09181015193462372, 0.09178277105093002, 0.09175540506839752, 0.09172804653644562, 0.09224497526884079, 0.0916733518242836, 0.09360437095165253, 0.09161869436502457, 0.07925675809383392, 0.09226378798484802, 0.09226170927286148], [0.09441506862640381, 0.09399708360433578, 0.0935809314250946, 0.09316662698984146, 0.10129119455814362, 0.0923435166478157, 0.1259213536977768, 0.09152767807245255, 0.010592533275485039, 0.10159897804260254, 0.10156498104333878], [0.09122184664011002, 0.0912129133939743, 0.09120398759841919, 0.09119506180286407, 0.09136340022087097, 0.09117721766233444, 0.09180309623479843, 0.09115937352180481, 0.08692470192909241, 0.09136951714754105, 0.09136884659528732], [0.09122385084629059, 0.0912148654460907, 0.09120588004589081, 0.09119689464569092, 0.09136634320020676, 0.09117893129587173, 0.09180894494056702, 0.09116096794605255, 0.08689908683300018, 0.09137249737977982, 0.0913718193769455]]], "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"use_intrinsic_rewards": 1.0, "weights_seq_no": 48.0, "vf_loss": 0.3585074245929718, "policy_loss": -8.930220064939931e-05, "vf_explained_var": 0.0014979839324951172, "total_loss": 0.27814772725105286, "diff_num_grad_updates_vs_sampler_policy": 41.0, "num_module_steps_trained": 35910, "entropy": 0.6865639686584473, "vf_loss_unclipped": 44.244876861572266, "module_train_batch_size_mean": 997.5252898807411, "num_module_steps_trained_lifetime": 287280, "mean_kl_loss": 5.542553026316455e-06}, "intrinsic_reward_module": {"total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 41.0, "module_train_batch_size_mean": 997.5252898807411, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 287280, "weights_seq_no": 48.0}, "__all_modules__": {"num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 1584000, "num_module_steps_trained_lifetime": 574560, "num_env_steps_trained_lifetime_throughput": 54664.71895502956}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 95760, "num_env_steps_trained_lifetime": 264000, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime_throughput": 4443.483742080893, "num_module_steps_trained_throughput": 24932138.774131514, "num_module_steps_trained_lifetime_throughput": 14476453.924100837}, "intrinsic_reward_module": {"total_loss": 0.0, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "default_optimizer_learning_rate": 0.0002715581955, "module_train_batch_size_mean": 997.8076834879114, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 47880, "weights_seq_no": 8.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 805.6046545440403}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.717205406769029e-05, "module_to_env_connector": {"connector_pipeline_timer": 0.00014015254909278233, "timers": {"connectors": {"tensor_to_numpy": 1.700079362286727e-05, "normalize_and_clip_actions": 9.969282248030915e-06, "listify_data_for_vector_env": 1.3194812346728423e-05, "un_batch_to_individual_items": 7.384756962152662e-06, "remove_single_ts_time_rank_from_batch": 1.4713401018612934e-05, "get_actions": 4.6237728023413105e-05}}}, "agent_episode_returns_mean": {"default_agent": 0.3}, "env_step_timer": 1.6809759766599407e-05, "env_reset_timer": 0.00017228824526857692, "env_to_module_connector": {"connector_pipeline_timer": 6.941370547891622e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 8.520883185742059e-06, "add_observations_from_episodes_to_batch": 3.3184792619725706e-06, "add_states_from_episodes_to_batch": 3.261534444359783e-06, "numpy_to_tensor": 1.4762438178261496e-05, "batch_individual_items": 1.3981697168307155e-05}}}, "sample": 0.11587684755042002, "episode_return_max": 13.5, "episode_len_mean": 20.0, "episode_len_max": 20, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "episode_duration_sec_mean": 0.005572149524232373, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": 0.3}, "env_to_module_sum_episodes_length_out": 10.3682383945743, "num_env_steps_sampled_lifetime": 40400, "env_to_module_sum_episodes_length_in": 10.3682383945743, "weights_seq_no": 8.0, "episode_return_min": -15.5, "num_env_steps_sampled": 400, "num_episodes_lifetime": 160, "num_episodes": 20, "episode_return_mean": 0.3, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "time_between_sampling": 9.35221800753077}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "b1709_00000", "date": "2025-08-11_18-33-52", "timestamp": 1754930032, "time_this_iter_s": 9.921915769577026, "time_total_s": 77.18482732772827, "pid": 11351, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3845f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 77.18482732772827, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 47.271428571428565, "ram_util_percent": 79.86428571428571}}
{"timers": {"training_iteration": 9.076826784221884, "restore_env_runners": 1.2306063255616615e-05, "training_step": 9.076689235558801, "env_runner_sampling_timer": 1.6188128105173931, "learner_update_timer": 7.2848780208878665, "synch_weights": 0.0008198407332391958, "restore_eval_env_runners": 8.774534622367465e-06, "evaluation_iteration": 0.12297776832310059, "synch_eval_env_connectors": 0.00013660175403498956, "synch_env_connectors": 4.419854141281938e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00012030092379824631, "timers": {"connectors": {"un_batch_to_individual_items": 6.766616710575664e-06, "tensor_to_numpy": 1.547562637270246e-05, "remove_single_ts_time_rank_from_batch": 1.1964491715459089e-05, "normalize_and_clip_actions": 8.006194629511563e-06, "get_actions": 4.0776151247404856e-05, "listify_data_for_vector_env": 1.0621786423382597e-05}}}, "time_between_sampling": 0.033824006710308566, "episode_duration_sec_mean": 0.005380216965451838, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -4312500.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8583867940265356e-06, "add_time_dim_to_batch_and_zero_pad": 7.002781870805872e-06, "numpy_to_tensor": 1.3013180463600674e-05, "add_states_from_episodes_to_batch": 2.696710529331862e-06, "batch_individual_items": 1.2613564010649382e-05}}, "connector_pipeline_timer": 6.0485647987793476e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "agent_episode_returns_mean": {"default_agent": -1.2600000000000002}, "weights_seq_no": 8.0, "module_episode_returns_mean": {"default_policy": -1.2600000000000002}, "episode_return_min": -13.5, "num_env_steps_sampled": 5000.0, "num_episodes_lifetime": -215625.0, "rlmodule_inference_timer": 3.245130297304552e-05, "episode_len_mean": 20.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "num_episodes": 250.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.4427656023706011e-05, "episode_return_mean": -1.2600000000000002, "env_reset_timer": 4.728309911031722e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "sample": 0.005814208525725362, "episode_return_max": 6.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3182.041826830017}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1349401874726847, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009346595095169209, "add_observations_from_episodes_to_batch": 0.0008368444649096412, "add_columns_from_episodes_to_train_batch": 0.04114212492424626, "add_time_dim_to_batch_and_zero_pad": 0.07552072863710185, "add_states_from_episodes_to_batch": 0.0036935353603005736, "batch_individual_items": 0.004163904975687505, "numpy_to_tensor": 7.47326729863066e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "policy_loss": -6.84711048961617e-05, "use_intrinsic_rewards": 0.0, "weights_seq_no": 9.0, "vf_explained_var": 0.000597834587097168, "num_trainable_parameters": 16595, "vf_loss": 0.35830608010292053, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.00031559361377730966, "num_module_steps_trained": 5985, "total_loss": 0.27801141142845154, "module_train_batch_size_mean": 997.7895308613665, "num_module_steps_trained_lifetime": 53865, "entropy": 0.6861404776573181, "vf_loss_unclipped": 46.09166717529297, "mean_kl_loss": 8.760776836425066e-06, "num_module_steps_trained_lifetime_throughput": 800.8260157739935}, "IntrinsicAttentionMask": [[[0.09013795852661133, 0.09165645390748978, 0.09067636728286743, 0.09159529209136963, 0.09156472980976105, 0.0905856192111969, 0.09211166203022003, 0.09052518010139465, 0.08989761024713516, 0.08986761420965195, 0.09138154983520508], [0.09112288057804108, 0.09070196747779846, 0.09097260981798172, 0.09071874618530273, 0.09072713553905487, 0.0909978598356247, 0.09057752043008804, 0.09101469069719315, 0.09119033813476562, 0.09119877219200134, 0.09077750146389008], [0.0904889851808548, 0.09131620824337006, 0.0907830074429512, 0.09128300845623016, 0.09126640856266022, 0.09073351323604584, 0.09156296402215958, 0.09070052206516266, 0.0903574675321579, 0.09034103900194168, 0.0911669135093689], [0.09108351171016693, 0.09074009954929352, 0.09096094220876694, 0.09075379371643066, 0.09076064079999924, 0.09098153561353683, 0.09063851088285446, 0.09099526703357697, 0.09113851934671402, 0.09114539623260498, 0.09080175310373306], [0.09106383472681046, 0.09075917303562164, 0.09095510840415955, 0.09077132493257523, 0.09077740460634232, 0.0909733846783638, 0.09066902101039886, 0.09098556637763977, 0.09111262112855911, 0.091118723154068, 0.09081387519836426], [0.09042996168136597, 0.09137341380119324, 0.09076515585184097, 0.09133552759885788, 0.0913165882229805, 0.09070871025323868, 0.09165507555007935, 0.090671107172966, 0.09028007835149765, 0.09026136249303818, 0.09120304882526398], [0.09141508489847183, 0.09041890501976013, 0.09105870872735977, 0.09045850485563278, 0.0904783084988594, 0.09111852943897247, 0.09012559056282043, 0.091158427298069, 0.09157530963420868, 0.091595359146595, 0.09059721976518631], [0.09039061516523361, 0.0914115458726883, 0.09075324237346649, 0.09137053787708282, 0.09135003387928009, 0.09069216996431351, 0.09171651303768158, 0.0906514823436737, 0.09022850543260574, 0.0902082547545433, 0.09122712910175323], [0.0899806097149849, 0.0918089970946312, 0.09062818437814713, 0.09173522889614105, 0.09169837087392807, 0.09051898121833801, 0.0923583060503006, 0.09044625610113144, 0.08969178795814514, 0.08965574204921722, 0.09147752821445465], [0.08996094018220901, 0.09182806313037872, 0.09062214195728302, 0.09175272285938263, 0.09171507507562637, 0.09051063656806946, 0.09238916635513306, 0.09043638408184052, 0.08966607600450516, 0.08962928503751755, 0.0914895161986351], [0.09094573557376862, 0.09087357670068741, 0.09092000126838684, 0.09087646752595901, 0.09087790548801422, 0.09092433005571365, 0.09085219353437424, 0.09092721343040466, 0.09095726907253265, 0.09095871448516846, 0.09088655561208725]], [[0.09144773334264755, 0.09142591804265976, 0.09183792024850845, 0.09138229489326477, 0.09179410338401794, 0.09177219867706299, 0.09287487715482712, 0.09172841906547546, 0.08168426901102066, 0.09224482625722885, 0.09180743247270584], [0.09146518260240555, 0.09144257754087448, 0.09186939895153046, 0.09139739722013474, 0.091824010014534, 0.09180131554603577, 0.0929439514875412, 0.0917559564113617, 0.08137130737304688, 0.09229101240634918, 0.0918378159403801], [0.09111598879098892, 0.09110809117555618, 0.0912569984793663, 0.0910923033952713, 0.09124118089675903, 0.0912332758307457, 0.09162989258766174, 0.09121746569871902, 0.08745522052049637, 0.09140364080667496, 0.09124599397182465], [0.09149974584579468, 0.09147557616233826, 0.09193205088376999, 0.0914272591471672, 0.09188349545001984, 0.09185922890901566, 0.09308189898729324, 0.09181071072816849, 0.08074868470430374, 0.09238308668136597, 0.09189826250076294], [0.09115511178970337, 0.09114565700292587, 0.09132392704486847, 0.09112676233053207, 0.09130499511957169, 0.091295525431633, 0.09177061170339584, 0.09127659350633621, 0.08679051697254181, 0.09149954468011856, 0.09131075441837311], [0.09117449074983597, 0.09116426110267639, 0.09135722368955612, 0.09114380180835724, 0.09133671969175339, 0.09132647514343262, 0.09184086322784424, 0.09130598604679108, 0.08645988255739212, 0.09154734760522842, 0.09134295582771301], [0.09004505723714828, 0.09007333964109421, 0.08954188227653503, 0.09012993425130844, 0.089598149061203, 0.08962628245353699, 0.08822843432426453, 0.08968259394168854, 0.1044708713889122, 0.08902240544557571, 0.08958102762699127], [0.09121287614107132, 0.09120108932256699, 0.09142346680164337, 0.09117751568555832, 0.09139984101057053, 0.0913880318403244, 0.09198114275932312, 0.09136441349983215, 0.08580201864242554, 0.09164264053106308, 0.09140702337026596], [0.09135419875383377, 0.09096512943506241, 0.09858329594135284, 0.09019193798303604, 0.09774535894393921, 0.09732906520366669, 0.12051017582416534, 0.09650178998708725, 0.012124160304665565, 0.10669536888599396, 0.09799947589635849], [0.09072938561439514, 0.09073583781719208, 0.09061432629823685, 0.09074874222278595, 0.09062721580266953, 0.09063366800546646, 0.09031162410974503, 0.09064655750989914, 0.09383425116539001, 0.0904950201511383, 0.09062330424785614], [0.09114327281713486, 0.09113429486751556, 0.09130362421274185, 0.09111633896827698, 0.09128563851118088, 0.09127664566040039, 0.0917278453707695, 0.09125866740942001, 0.08699221909046173, 0.09147042036056519, 0.09129110723733902]], [[0.09008333086967468, 0.09160090237855911, 0.0900232195854187, 0.09153978526592255, 0.0921173021197319, 0.0899331271648407, 0.09205583482980728, 0.0904703140258789, 0.09044012427330017, 0.09040994197130203, 0.09132616966962814], [0.09113806486129761, 0.09071706980466843, 0.09115491807460785, 0.0907338559627533, 0.09057584404945374, 0.091180220246315, 0.09059260040521622, 0.09102985262870789, 0.09103827178478241, 0.09104669094085693, 0.09079262614250183], [0.09004120528697968, 0.09163615852594376, 0.08997806161642075, 0.09157188981771469, 0.09217919409275055, 0.08988341689109802, 0.09211454540491104, 0.0904477909207344, 0.0904160663485527, 0.0903843566775322, 0.09134731441736221], [0.09109589457511902, 0.09075243026018143, 0.09110964089632034, 0.09076613187789917, 0.09063714742660522, 0.09113027155399323, 0.09065082669258118, 0.09100763499736786, 0.09101451188325882, 0.09102137386798859, 0.09081409126520157], [0.09149320423603058, 0.09041906148195267, 0.09153638780117035, 0.09046173840761185, 0.09006045758724213, 0.09160120040178299, 0.09010296314954758, 0.09121637791395187, 0.09123790264129639, 0.0912594273686409, 0.09061126410961151], [0.08997803926467896, 0.09168904274702072, 0.08991033583879471, 0.0916200503706932, 0.092272087931633, 0.0898088812828064, 0.09220266342163086, 0.09041399508714676, 0.0903799757361412, 0.09034597128629684, 0.09137901663780212], [0.09145103394985199, 0.09045446664094925, 0.09149108082056046, 0.0904940813779831, 0.0901215672492981, 0.09155118465423584, 0.09016103297472, 0.0911942794919014, 0.09121424704790115, 0.09123421460390091, 0.0906328558921814], [0.09035386145114899, 0.09137438982725143, 0.09031332284212112, 0.09133338928222656, 0.09172037988901138, 0.09025255590677261, 0.09167923033237457, 0.09061463177204132, 0.09059429913759232, 0.09057397395372391, 0.09119004756212234], [0.09033279865980148, 0.09139203280210495, 0.09029072523117065, 0.09134946763515472, 0.09175124764442444, 0.09022766351699829, 0.09170851856470108, 0.09060341119766235, 0.09058231115341187, 0.09056121110916138, 0.09120066463947296], [0.09031172096729279, 0.09140966087579727, 0.09026812762022018, 0.09136553853750229, 0.0917821153998375, 0.09020277112722397, 0.09173780679702759, 0.09059218317270279, 0.09057031571865082, 0.09054845571517944, 0.09121126681566238], [0.09094834327697754, 0.09087619185447693, 0.09095122665166855, 0.09087906777858734, 0.09085191786289215, 0.09095555543899536, 0.09085480123758316, 0.09092982858419418, 0.09093126654624939, 0.09093271195888519, 0.09088916331529617]], [[0.08824609965085983, 0.0882083848118782, 0.08817069232463837, 0.08888371288776398, 0.08809535205364227, 0.08880776166915894, 0.090728260576725, 0.08798246085643768, 0.1115335077047348, 0.0896286889910698, 0.08971505612134933], [0.08818943053483963, 0.0881509929895401, 0.08811257779598236, 0.08883937448263168, 0.08803578466176987, 0.08876195549964905, 0.09072011709213257, 0.08792072534561157, 0.11198318004608154, 0.0895988792181015, 0.08968694508075714], [0.08813261985778809, 0.08809345960617065, 0.08805431425571442, 0.08879488706588745, 0.08797607570886612, 0.08871599286794662, 0.0907118022441864, 0.08785884827375412, 0.11243443191051483, 0.08956890553236008, 0.08965866267681122], [0.08917882293462753, 0.08915349841117859, 0.08912818878889084, 0.08960642665624619, 0.08907757699489594, 0.08955554664134979, 0.09083767980337143, 0.08900172263383865, 0.10419333726167679, 0.09010472893714905, 0.09016241133213043], [0.08801856637001038, 0.08797795325517654, 0.0879373624920845, 0.08870541304349899, 0.0878562331199646, 0.08862357586622238, 0.09069459140300751, 0.08773468434810638, 0.11334168165922165, 0.08950840681791306, 0.0896015465259552], [0.08907019346952438, 0.08904338628053665, 0.08901658654212952, 0.08952295035123825, 0.08896300941705704, 0.0894690752029419, 0.09082736819982529, 0.08888270705938339, 0.10504209250211716, 0.09005073457956314, 0.09011184424161911], [0.09162534028291702, 0.09163681417703629, 0.09164828807115555, 0.09143227338790894, 0.09167125076055527, 0.09145517647266388, 0.09088370203971863, 0.09170569479465485, 0.08554928749799728, 0.09120896458625793, 0.09118323028087616], [0.08784636110067368, 0.08780359476804733, 0.08776083588600159, 0.08856996893882751, 0.08767539262771606, 0.08848374336957932, 0.09066735953092575, 0.08754738420248032, 0.11471450328826904, 0.08941634744405746, 0.08951453119516373], [0.10533212870359421, 0.10577952116727829, 0.10622882097959518, 0.09807445108890533, 0.10713314265012741, 0.09890935570001602, 0.08000162243843079, 0.10850409418344498, 0.010327065363526344, 0.09028398990631104, 0.08942577987909317], [0.09021023660898209, 0.09019961208105087, 0.09018899500370026, 0.09038925915956497, 0.09016776829957962, 0.09036798030138016, 0.09090196341276169, 0.09013593196868896, 0.09621970355510712, 0.0905972495675087, 0.09062127768993378], [0.09032590687274933, 0.0903170183300972, 0.09030811488628387, 0.0904759094119072, 0.09029032289981842, 0.09045808762311935, 0.09090524166822433, 0.09026364237070084, 0.09533541649580002, 0.09065013378858566, 0.09067025780677795]], [[0.0905236154794693, 0.09130833297967911, 0.09052852541208267, 0.09127824753522873, 0.09126321226358414, 0.09048378467559814, 0.09123314917087555, 0.09045396745204926, 0.09073525667190552, 0.09072030335664749, 0.09147162735462189], [0.09156730026006699, 0.09022784978151321, 0.09155883640050888, 0.09027863293886185, 0.09030402451753616, 0.09163613617420197, 0.09035485237836838, 0.09168770909309387, 0.09120295941829681, 0.09122862666845322, 0.08995303511619568], [0.09053017199039459, 0.09130155295133591, 0.0905349925160408, 0.09127198159694672, 0.09125719964504242, 0.09049101173877716, 0.09122764319181442, 0.09046170115470886, 0.0907382220029831, 0.09072352200746536, 0.09146205335855484], [0.09152745455503464, 0.09026908129453659, 0.09151950478553772, 0.09031680971384048, 0.09034068137407303, 0.09159209579229355, 0.09038844704627991, 0.09164051711559296, 0.09118527919054031, 0.09120938926935196, 0.09001076221466064], [0.09150753170251846, 0.09028969705104828, 0.09149983525276184, 0.0903358981013298, 0.09035900235176086, 0.09157006442546844, 0.09040523320436478, 0.0916169211268425, 0.09117643535137177, 0.09119975566864014, 0.09003963321447372], [0.09047039598226547, 0.09136345982551575, 0.09047597646713257, 0.09132920205593109, 0.09131208062171936, 0.09042509645223618, 0.0912778377532959, 0.09039118885993958, 0.09071115404367447, 0.09069414436817169, 0.09154942631721497], [0.09146767854690552, 0.09033093601465225, 0.09146050363779068, 0.09037407487630844, 0.09039565175771713, 0.09152602404356003, 0.09043882042169571, 0.09156973659992218, 0.09115872532129288, 0.09118048846721649, 0.09009739011526108], [0.09043055772781372, 0.0914047360420227, 0.09043663740158081, 0.09136734902858734, 0.09134866297245026, 0.09038116037845612, 0.09131129831075668, 0.09034419059753418, 0.09069309383630753, 0.09067454189062119, 0.0916077047586441], [0.09080594778060913, 0.09101588279008865, 0.09080726653337479, 0.09100785851478577, 0.09100384265184402, 0.09079525619745255, 0.09099582582712173, 0.09078725427389145, 0.0908626988530159, 0.09085869789123535, 0.09105940163135529], [0.09078603982925415, 0.09103652834892273, 0.0907876044511795, 0.09102695435285568, 0.09102216362953186, 0.09077328443527222, 0.09101258963346481, 0.09076373279094696, 0.0908537432551384, 0.09084896743297577, 0.09108846634626389], [0.09178338199853897, 0.0900043398141861, 0.09177210181951523, 0.09007163345813751, 0.09010528773069382, 0.09187503159046173, 0.0901726558804512, 0.09194371849298477, 0.09129861742258072, 0.09133274108171463, 0.08964040130376816]], [[0.09156310558319092, 0.09197573363780975, 0.09151942282915115, 0.09193184971809387, 0.09190991520881653, 0.0914539322257042, 0.0925527811050415, 0.09184414893388748, 0.08140099048614502, 0.09192491322755814, 0.09192325919866562], [0.0911344587802887, 0.09126875549554825, 0.09112021327018738, 0.09125449508428574, 0.09124736487865448, 0.091098852455616, 0.09145589172840118, 0.09122597426176071, 0.08769004791975021, 0.09125223755836487, 0.09125170111656189], [0.09160597622394562, 0.09204833209514618, 0.09155914932489395, 0.0920012816786766, 0.09197776019573212, 0.09148895740509033, 0.09266719222068787, 0.09190724790096283, 0.08075813204050064, 0.09199383854866028, 0.09199206531047821], [0.09118210524320602, 0.09134578704833984, 0.09116475284099579, 0.09132840484380722, 0.09131971001625061, 0.09113872796297073, 0.09157395362854004, 0.09129364043474197, 0.08700227737426758, 0.09132565557956696, 0.09132499992847443], [0.09120573848485947, 0.09138412773609161, 0.09118682146072388, 0.09136517345905304, 0.09135570377111435, 0.09115846455097198, 0.09163283556699753, 0.09132728725671768, 0.0866602212190628, 0.09136217832565308, 0.09136146306991577], [0.09166937321424484, 0.09215638786554337, 0.09161783754825592, 0.09210457652807236, 0.09207868576049805, 0.09154058247804642, 0.09283812344074249, 0.0920010432600975, 0.07980253547430038, 0.09209638833999634, 0.09209442883729935], [0.0904606282711029, 0.09021369367837906, 0.09048687666654587, 0.09023987501859665, 0.09025295823812485, 0.09052626043558121, 0.08987133204936981, 0.09029224514961243, 0.09716712683439255, 0.09024401009082794, 0.09024500101804733], [0.09127585589885712, 0.09149841219186783, 0.09125225991010666, 0.09147476404905319, 0.09146293997764587, 0.09121689200401306, 0.09180889278650284, 0.09142749011516571, 0.08564135432243347, 0.09147102385759354, 0.0914701372385025], [0.09301633387804031, 0.10112778842449188, 0.0921945571899414, 0.10023434460163116, 0.09979058802127838, 0.09097547829151154, 0.11360011994838715, 0.09847106039524078, 0.010435658507049084, 0.1000937893986702, 0.10006029903888702], [0.09118959307670593, 0.09135793149471283, 0.0911717489361763, 0.09134004265069962, 0.0913311094045639, 0.09114497900009155, 0.09159258753061295, 0.09130429476499557, 0.0868939757347107, 0.09133721888065338, 0.09133654087781906], [0.0911913812160492, 0.09136081486940384, 0.09117341041564941, 0.09134281426668167, 0.09133382141590118, 0.09114647656679153, 0.09159702807664871, 0.09130683541297913, 0.08686815947294235, 0.09133997559547424, 0.09133929759263992]]], "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"use_intrinsic_rewards": 1.0, "weights_seq_no": 54.0, "vf_loss": 0.358497679233551, "policy_loss": -6.719635712215677e-05, "vf_explained_var": 0.0014775395393371582, "total_loss": 0.27816328406333923, "diff_num_grad_updates_vs_sampler_policy": 46.0, "num_module_steps_trained": 35910, "entropy": 0.6861509084701538, "vf_loss_unclipped": 45.98481369018555, "module_train_batch_size_mean": 997.5168494263723, "num_module_steps_trained_lifetime": 323190, "mean_kl_loss": 8.413809155172203e-06}, "intrinsic_reward_module": {"total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 46.0, "module_train_batch_size_mean": 997.5168494263723, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 323190, "weights_seq_no": 54.0}, "__all_modules__": {"num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 1782000, "num_module_steps_trained_lifetime": 646380, "num_env_steps_trained_lifetime_throughput": 53678.981865027825}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 107730, "num_env_steps_trained_lifetime": 297000, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime_throughput": 4417.13571212873, "num_module_steps_trained_throughput": 24243079.121576864, "num_module_steps_trained_lifetime_throughput": 14353271.627240261}, "intrinsic_reward_module": {"total_loss": 0.0, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "default_optimizer_learning_rate": 0.0002715581955, "module_train_batch_size_mean": 997.7895308613665, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 53865, "weights_seq_no": 9.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 800.8365088765427}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.139313872763986e-05, "module_to_env_connector": {"connector_pipeline_timer": 0.00011578929059012266, "timers": {"connectors": {"tensor_to_numpy": 1.5244296769528064e-05, "normalize_and_clip_actions": 8.015449711184646e-06, "listify_data_for_vector_env": 1.05347619550591e-05, "un_batch_to_individual_items": 6.631755038247486e-06, "remove_single_ts_time_rank_from_batch": 1.2111579804786834e-05, "get_actions": 3.6586776307534205e-05}}}, "agent_episode_returns_mean": {"default_agent": 0.3}, "env_step_timer": 1.4258515026676473e-05, "env_reset_timer": 0.00017387203293028916, "env_to_module_connector": {"connector_pipeline_timer": 6.001447257039974e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.2229564447807155e-06, "add_observations_from_episodes_to_batch": 2.866249136981921e-06, "add_states_from_episodes_to_batch": 2.77277779650009e-06, "numpy_to_tensor": 1.2069378840589144e-05, "batch_individual_items": 1.2559479809347696e-05}}}, "sample": 0.11588186866527084, "episode_return_max": 13.5, "episode_len_mean": 20.0, "episode_len_max": 20, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "episode_duration_sec_mean": 0.005570440834853798, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": 0.3}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled_lifetime": 45400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 9.0, "episode_return_min": -15.5, "num_env_steps_sampled": 400, "num_episodes_lifetime": 180, "num_episodes": 20, "episode_return_mean": 0.3, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "time_between_sampling": 9.355480176206415}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "b1709_00000", "date": "2025-08-11_18-34-01", "timestamp": 1754930041, "time_this_iter_s": 9.769928932189941, "time_total_s": 86.95475625991821, "pid": 11351, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3845f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 86.95475625991821, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 43.61428571428572, "ram_util_percent": 80.38571428571429}}
{"timers": {"training_iteration": 9.085049631379764, "restore_env_runners": 1.2241341833287581e-05, "training_step": 9.084911265703496, "env_runner_sampling_timer": 1.6181269557524631, "learner_update_timer": 7.293679369849145, "synch_weights": 0.0008212819161869344, "restore_eval_env_runners": 8.7559597679137e-06, "evaluation_iteration": 0.12300095188942597, "synch_eval_env_connectors": 0.0001363344864209534, "synch_env_connectors": 4.418575600720273e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00011837764008641322, "timers": {"connectors": {"un_batch_to_individual_items": 6.6555040788775116e-06, "tensor_to_numpy": 1.5215895526406293e-05, "remove_single_ts_time_rank_from_batch": 1.1866247913550895e-05, "normalize_and_clip_actions": 7.95922205591985e-06, "get_actions": 3.9774644069820896e-05, "listify_data_for_vector_env": 1.0581069324281664e-05}}}, "time_between_sampling": 0.03341191872777032, "episode_duration_sec_mean": 0.005299597478006034, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -4930000.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.834873897696403e-06, "add_time_dim_to_batch_and_zero_pad": 6.905264149832193e-06, "numpy_to_tensor": 1.2603896286294953e-05, "add_states_from_episodes_to_batch": 2.6715293471890535e-06, "batch_individual_items": 1.2498128749021845e-05}}, "connector_pipeline_timer": 5.959542115467032e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "agent_episode_returns_mean": {"default_agent": -1.9}, "weights_seq_no": 9.0, "module_episode_returns_mean": {"default_policy": -1.9}, "episode_return_min": -13.5, "num_env_steps_sampled": 5000.0, "num_episodes_lifetime": -246500.0, "rlmodule_inference_timer": 3.2103865668530796e-05, "episode_len_mean": 20.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "num_episodes": 250.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.4207313587996016e-05, "episode_return_mean": -1.9, "env_reset_timer": 4.3971161795883104e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "sample": 0.005676968763150683, "episode_return_max": 6.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3227.4349938875357}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13492847767779062, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009343115394022014, "add_observations_from_episodes_to_batch": 0.0008368081104800276, "add_columns_from_episodes_to_train_batch": 0.04114408867485084, "add_time_dim_to_batch_and_zero_pad": 0.0755131480108897, "add_states_from_episodes_to_batch": 0.0036923741766529705, "batch_individual_items": 0.004162941756026636, "numpy_to_tensor": 7.470742625991372e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "policy_loss": -0.000822687812615186, "use_intrinsic_rewards": 0.0, "weights_seq_no": 10.0, "vf_explained_var": 0.0011390447616577148, "num_trainable_parameters": 16595, "vf_loss": 0.35831037163734436, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.00015779680688865483, "num_module_steps_trained": 5985, "total_loss": 0.2772626280784607, "module_train_batch_size_mean": 997.772440523815, "num_module_steps_trained_lifetime": 59850, "entropy": 0.6848143339157104, "vf_loss_unclipped": 43.4007682800293, "mean_kl_loss": 4.757627539220266e-05, "num_module_steps_trained_lifetime_throughput": 795.9244207115102}, "IntrinsicAttentionMask": [[[0.0901380255818367, 0.09165652096271515, 0.09007787704467773, 0.0915953665971756, 0.09217323362827301, 0.09058569371700287, 0.09150369465351105, 0.09052524715662003, 0.0904950350522995, 0.08986768126487732, 0.09138162434101105], [0.09112288802862167, 0.09070197492837906, 0.09113974869251251, 0.09071875363588333, 0.09056077152490616, 0.09099786728620529, 0.09074393659830093, 0.09101469814777374, 0.09102311730384827, 0.09119877964258194, 0.09077750891447067], [0.09009870141744614, 0.0916946679353714, 0.09003551304340363, 0.09163036197423935, 0.09223805367946625, 0.09056906402111053, 0.09153398871421814, 0.09050554037094116, 0.09047380089759827, 0.08981470763683319, 0.09140563756227493], [0.09108351916074753, 0.09074010699987411, 0.09109727293252945, 0.09075380116701126, 0.0906248390674591, 0.09098155051469803, 0.09077434986829758, 0.09099527448415756, 0.09100214391946793, 0.09114540368318558, 0.09080176055431366], [0.09145449846982956, 0.09038081765174866, 0.09149766713380814, 0.09042347222566605, 0.09002235531806946, 0.09113477915525436, 0.09048749506473541, 0.0911777913570404, 0.09119930118322372, 0.0916488990187645, 0.09057293087244034], [0.09042998403310776, 0.09137343615293503, 0.09039249271154404, 0.09133554995059967, 0.09169311821460724, 0.09070874750614166, 0.09127875417470932, 0.0906711295247078, 0.09065233916044235, 0.09026138484477997, 0.09120307862758636], [0.09102446585893631, 0.0907973125576973, 0.09103355556726456, 0.09080637991428375, 0.0907210037112236, 0.09095704555511475, 0.09081996977329254, 0.0909661278128624, 0.09097066521644592, 0.09106536954641342, 0.09083811193704605], [0.090390644967556, 0.09141158312559128, 0.09035009145736694, 0.09137056767940521, 0.09175771474838257, 0.09069220721721649, 0.0913090854883194, 0.09065151959657669, 0.09063117951154709, 0.09020829200744629, 0.09122716635465622], [0.09037097543478012, 0.0914306491613388, 0.0903288871049881, 0.09138806909322739, 0.09179002046585083, 0.09068392962217331, 0.09132423996925354, 0.09064169973134995, 0.09062059223651886, 0.09018174558877945, 0.09123920649290085], [0.08996105194091797, 0.09182815998792648, 0.08988723903894424, 0.09175281971693039, 0.09246513247489929, 0.09051074832677841, 0.0916399285197258, 0.09043648838996887, 0.0903993770480156, 0.0896293893456459, 0.09148962050676346], [0.09094573557376862, 0.090873584151268, 0.09094861894845963, 0.09087646752595901, 0.09084931761026382, 0.09092433005571365, 0.09088078886270523, 0.09092721343040466, 0.09092865884304047, 0.09095871448516846, 0.09088655561208725]], [[0.09124790132045746, 0.0911155641078949, 0.09110922366380692, 0.09122884273529053, 0.09109653532505035, 0.09121613204479218, 0.09140822291374207, 0.09107750654220581, 0.08804686367511749, 0.09122683107852936, 0.09122635424137115], [0.09207621216773987, 0.09160314500331879, 0.09158051013946533, 0.09200797230005264, 0.09153525531291962, 0.09196250885725021, 0.09265167266130447, 0.09146741777658463, 0.08111543953418732, 0.09200078248977661, 0.09199906885623932], [0.09211470931768417, 0.09162518382072449, 0.09160175919532776, 0.09204409271478653, 0.09155493974685669, 0.09199704974889755, 0.09271031618118286, 0.09148474782705307, 0.08079572021961212, 0.0920366495847702, 0.09203487634658813], [0.09137021750211716, 0.09118913114070892, 0.0911804586648941, 0.09134413301944733, 0.09116310626268387, 0.0913267508149147, 0.09158972650766373, 0.09113707393407822, 0.08701726794242859, 0.09134138375520706, 0.09134072810411453], [0.09219136089086533, 0.09166887402534485, 0.09164388477802277, 0.09211598336696625, 0.0915939211845398, 0.09206575900316238, 0.09282731264829636, 0.09151902049779892, 0.08015970885753632, 0.09210803359746933, 0.09210614114999771], [0.09145118296146393, 0.09123753756284714, 0.09122730791568756, 0.09142040461301804, 0.09120683372020721, 0.09139988571405411, 0.09171025454998016, 0.09117613732814789, 0.08633694052696228, 0.09141715615987778, 0.0914163812994957], [0.09017714112997055, 0.09045020490884781, 0.09046333283185959, 0.09021639078855515, 0.09048958122730255, 0.09024257212877274, 0.08984795212745667, 0.09052897244691849, 0.09714183211326599, 0.09022053331136703, 0.09022151678800583], [0.09230551868677139, 0.09173351526260376, 0.09170616418123245, 0.09222296625375748, 0.09165148437023163, 0.09216798096895218, 0.09300213307142258, 0.09156952053308487, 0.07921425998210907, 0.09221427142620087, 0.09221220016479492], [0.10242748260498047, 0.09337945282459259, 0.09296604245901108, 0.10107310861349106, 0.09214470535516739, 0.10018014162778854, 0.11455069482326508, 0.09092628210783005, 0.010523010976612568, 0.10093136876821518, 0.10089758783578873], [0.09138305485248566, 0.09119682759046555, 0.09118790179491043, 0.09135622531175613, 0.0911700502038002, 0.09133835136890411, 0.09160881489515305, 0.09114328771829605, 0.08690936863422394, 0.0913534015417099, 0.09135272353887558], [0.09138611704111099, 0.09119866043329239, 0.0911896750330925, 0.09135910868644714, 0.09117171168327332, 0.09134111553430557, 0.09161336719989777, 0.09114477038383484, 0.08688365668058395, 0.09135627001523972, 0.0913555920124054]], [[0.09052353352308273, 0.09160728752613068, 0.0908249169588089, 0.09127816557884216, 0.09126312285661697, 0.09078003466129303, 0.09123305231332779, 0.09045387804508209, 0.09043898433446884, 0.090424083173275, 0.09117294102907181], [0.09196209162473679, 0.0890192836523056, 0.09113053977489471, 0.0898992046713829, 0.08993969112634659, 0.09125372022390366, 0.09002073109149933, 0.09215572476387024, 0.0921972393989563, 0.09223876148462296, 0.09018301218748093], [0.09092549234628677, 0.09087946265935898, 0.09091263264417648, 0.09089338034391403, 0.09089402109384537, 0.09091454744338989, 0.09089529514312744, 0.09092847257852554, 0.09092910587787628, 0.09092974662780762, 0.09089784324169159], [0.09152724593877792, 0.08979672193527222, 0.09104059636592865, 0.09031660109758377, 0.09034047275781631, 0.09111280739307404, 0.0903882384300232, 0.09164030104875565, 0.09166452288627625, 0.09168875217437744, 0.09048383682966232], [0.09150731563568115, 0.08983241021633148, 0.09103640913963318, 0.09033568948507309, 0.09035880118608475, 0.09110628813505173, 0.09040503203868866, 0.09161670506000519, 0.09164014458656311, 0.09166358411312103, 0.09049756824970245], [0.09086572378873825, 0.09098745137453079, 0.09089970588684082, 0.0909506157040596, 0.0909489318728447, 0.09089464694261551, 0.09094556421041489, 0.0908578485250473, 0.090856172144413, 0.09085448086261749, 0.09093882143497467], [0.09146749973297119, 0.08990383893251419, 0.09102806448936462, 0.09037389606237411, 0.0903954729437828, 0.0910932794213295, 0.09043864160776138, 0.09156955033540726, 0.09159141778945923, 0.0916132852435112, 0.09052504599094391], [0.09043042361736298, 0.09177637100219727, 0.09080434590578079, 0.0913672223687172, 0.09134853631258011, 0.090748630464077, 0.09131116420030594, 0.09034406393766403, 0.09032558649778366, 0.09030711650848389, 0.09123648703098297], [0.0904105082154274, 0.0918126031756401, 0.09079992771148682, 0.09138628840446472, 0.09136682003736496, 0.09074191004037857, 0.09132789075374603, 0.09032056480646133, 0.09030132740736008, 0.09028209000825882, 0.09125009179115295], [0.09039057046175003, 0.09184883534908295, 0.09079550206661224, 0.09140534698963165, 0.09138509631156921, 0.09073516726493835, 0.09134460985660553, 0.09029705822467804, 0.0902770534157753, 0.09025704860687256, 0.09126368165016174], [0.09138783812522888, 0.09004680812358856, 0.09101130068302155, 0.09045028686523438, 0.09046880155801773, 0.09106720238924026, 0.09050583839416504, 0.09147524833679199, 0.09149397909641266, 0.09151270240545273, 0.09057997167110443]], [[0.08963550627231598, 0.08961234241724014, 0.08913090825080872, 0.08956603705883026, 0.08954289555549622, 0.08951975405216217, 0.09068533778190613, 0.08947349339723587, 0.10274286568164825, 0.09001919627189636, 0.09007164090871811], [0.08959133177995682, 0.08956741541624069, 0.0890704020857811, 0.08951960504055023, 0.0894957110285759, 0.08947182446718216, 0.09067542850971222, 0.08942406624555588, 0.10315506905317307, 0.08998749405145645, 0.0900416448712349], [0.08863692730665207, 0.08859754353761673, 0.08778055012226105, 0.08851881325244904, 0.08847948163747787, 0.08844016492366791, 0.09042976796627045, 0.08836159110069275, 0.11208479106426239, 0.08929042518138885, 0.08937989920377731], [0.08950253576040268, 0.08947712928056717, 0.08894903212785721, 0.08942631632089615, 0.08940092474222183, 0.08937554061412811, 0.09065508842468262, 0.08932478725910187, 0.10398385673761368, 0.08992361277341843, 0.08998117595911026], [0.0894579216837883, 0.0894317552447319, 0.08888816088438034, 0.0893794521689415, 0.08935331553220749, 0.08932718634605408, 0.09064467996358871, 0.08927494287490845, 0.10440044850111008, 0.08989144116640091, 0.08995071798563004], [0.08941314369440079, 0.0893862396478653, 0.08882714807987213, 0.08933243900537491, 0.08930555731058121, 0.0892786756157875, 0.09063407778739929, 0.08922494202852249, 0.10481850057840347, 0.08985909819602966, 0.08992007374763489], [0.09148116409778595, 0.09149262309074402, 0.09173174947500229, 0.09151554107666016, 0.09152700006961823, 0.09153846651315689, 0.09096647053956985, 0.09156139194965363, 0.0856272354722023, 0.09129202365875244, 0.09126626700162888], [0.08932319283485413, 0.08929479122161865, 0.08870477229356766, 0.0892380103468895, 0.08920963108539581, 0.08918125927448273, 0.09061239659786224, 0.08912454545497894, 0.10565906763076782, 0.08979396522045135, 0.08985835313796997], [0.10028761625289917, 0.1007135882973671, 0.11001603305339813, 0.1015709638595581, 0.10200238227844238, 0.1024356335401535, 0.08285389840602875, 0.10330766439437866, 0.01069535594433546, 0.09350280463695526, 0.09261399507522583], [0.09034498035907745, 0.09033434092998505, 0.09011299163103104, 0.09031308442354202, 0.09030245244503021, 0.090291827917099, 0.09082535654306412, 0.09027057141065598, 0.0961386188864708, 0.09052090346813202, 0.09054490923881531], [0.09043873101472855, 0.09042982757091522, 0.09024433046579361, 0.09041200578212738, 0.09040310233831406, 0.09039419144392014, 0.09084103256464005, 0.09037638455629349, 0.09526807069778442, 0.0905861034989357, 0.0906062126159668]], [[0.09019196778535843, 0.0917113721370697, 0.09013178944587708, 0.09165017306804657, 0.0916195884346962, 0.09063990414142609, 0.09216684848070145, 0.08998150378465652, 0.08995147794485092, 0.09051898121833801, 0.09143630415201187], [0.09110765904188156, 0.09068681299686432, 0.0911245197057724, 0.09070359915494919, 0.09071198105812073, 0.09098265320062637, 0.09056238830089569, 0.0911666676402092, 0.09117510169744492, 0.09101632237434387, 0.09076234698295593], [0.09015536308288574, 0.09175232797861099, 0.09009213000535965, 0.09168798476457596, 0.09165582060813904, 0.09062602370977402, 0.09223132580518723, 0.08993425965309143, 0.08990271389484406, 0.09049894660711288, 0.0914631187915802], [0.09107109904289246, 0.09072773903608322, 0.09108484536409378, 0.09074143320322037, 0.09074828028678894, 0.09096914529800415, 0.09062616527080536, 0.09111922234296799, 0.09112609922885895, 0.09099660813808441, 0.09078938513994217], [0.0910528227686882, 0.09074819833040237, 0.09106501191854477, 0.09076035022735596, 0.09076642990112305, 0.09096238017082214, 0.09065806120634079, 0.09109550714492798, 0.09110160171985626, 0.09098674356937408, 0.09080290049314499], [0.09046369045972824, 0.09140748530626297, 0.09042618423700333, 0.09136959165334702, 0.09135064482688904, 0.0907425507903099, 0.09168925881385803, 0.09033247828483582, 0.09031375497579575, 0.09066732227802277, 0.09123706817626953], [0.09137886762619019, 0.09038309752941132, 0.09141888469457626, 0.09042267501354218, 0.0904424712061882, 0.09108243137598038, 0.09008989483118057, 0.09151899814605713, 0.09153903275728226, 0.09116221964359283, 0.09056133776903152], [0.09006380289793015, 0.09185470640659332, 0.08999297022819519, 0.09178246557712555, 0.09174636751413345, 0.09059121459722519, 0.09239260852336884, 0.0898161455988884, 0.08978082239627838, 0.0904487892985344, 0.09153008460998535], [0.09004548192024231, 0.09187518060207367, 0.08997313678264618, 0.09180136770009995, 0.09176447987556458, 0.09058424085378647, 0.09242488443851471, 0.08979252725839615, 0.08975644409656525, 0.09043874591588974, 0.09154347330331802], [0.09039048850536346, 0.09148937463760376, 0.09034685045480728, 0.09144521504640579, 0.0914231389760971, 0.09071497619152069, 0.09181781113147736, 0.09023786336183548, 0.09021607786417007, 0.09062741696834564, 0.09129080921411514], [0.09094313532114029, 0.09087098389863968, 0.0909460186958313, 0.09087386727333069, 0.09087531268596649, 0.09092173725366592, 0.09084960073232651, 0.09095322340726852, 0.09095466881990433, 0.09092749655246735, 0.09088395535945892]], [[0.09121380001306534, 0.09120744466781616, 0.09120109677314758, 0.09106883406639099, 0.09106248617172241, 0.09118205308914185, 0.09137406200170517, 0.09104347229003906, 0.08813567459583282, 0.09131883084774017, 0.09119226038455963], [0.09125053882598877, 0.09124340862035751, 0.09123628586530685, 0.09108778834342957, 0.0910806730389595, 0.09121489524841309, 0.09143049269914627, 0.09105932712554932, 0.08780176937580109, 0.09136846661567688, 0.09122636169195175], [0.09128717333078384, 0.09127926081418991, 0.09127134829759598, 0.09110663086175919, 0.09109873324632645, 0.09124762564897537, 0.09148683398962021, 0.09107505530118942, 0.08746901154518127, 0.09141801297664642, 0.09126034379005432], [0.09202530235052109, 0.09200099110603333, 0.09197669476270676, 0.09147164970636368, 0.09144749492406845, 0.09190382808446884, 0.09264020621776581, 0.09137505292892456, 0.08078794181346893, 0.09242794662714005, 0.09194288402795792], [0.09205951541662216, 0.09203441441059113, 0.09200932830572128, 0.09148786962032318, 0.09146292507648468, 0.09193408489227295, 0.09269455075263977, 0.09138813614845276, 0.08047939091920853, 0.09247533231973648, 0.0919744148850441], [0.09139637649059296, 0.09138611704111099, 0.09137586504220963, 0.09116239845752716, 0.09115217626094818, 0.09134511649608612, 0.09165529161691666, 0.09112149477005005, 0.08647755533456802, 0.09156603366136551, 0.09136159718036652], [0.090249203145504, 0.09026229381561279, 0.09027538448572159, 0.09054875373840332, 0.0905618891119957, 0.09031467884778976, 0.08991975337266922, 0.09060131013393402, 0.09693996608257294, 0.09003309160470963, 0.09029360860586166], [0.09216154366731644, 0.09213406592607498, 0.09210658818483353, 0.09153582900762558, 0.09150853008031845, 0.09202422201633453, 0.09285707026720047, 0.09142670035362244, 0.07956017553806305, 0.09261691570281982, 0.09206836670637131], [0.10037660598754883, 0.09994910657405853, 0.09952342510223389, 0.09105207771062851, 0.09066429734230042, 0.09825723618268967, 0.11177976429462433, 0.08951082080602646, 0.012239961884915829, 0.10771279036998749, 0.09893400967121124], [0.09058988839387894, 0.09059633314609528, 0.09060277789831161, 0.09073717147111893, 0.09074362367391586, 0.09062210470438004, 0.09042762964963913, 0.09076298028230667, 0.09382226318120956, 0.09048347920179367, 0.09061174094676971], [0.09133794903755188, 0.0913289487361908, 0.09131995588541031, 0.09113263338804245, 0.09112365543842316, 0.09129296988248825, 0.0915650799870491, 0.09109672904014587, 0.0870077908039093, 0.09148678183555603, 0.09130743891000748]]], "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"use_intrinsic_rewards": 1.0, "weights_seq_no": 60.0, "vf_loss": 0.358479768037796, "policy_loss": -0.0007767602219246328, "vf_explained_var": 0.001573026180267334, "total_loss": 0.2774472236633301, "diff_num_grad_updates_vs_sampler_policy": 51.0, "num_module_steps_trained": 35910, "entropy": 0.6848839521408081, "vf_loss_unclipped": 43.370277404785156, "module_train_batch_size_mean": 997.5109713823833, "num_module_steps_trained_lifetime": 359100, "mean_kl_loss": 4.242767681716941e-05}, "intrinsic_reward_module": {"total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 51.0, "module_train_batch_size_mean": 997.5109713823833, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 359100, "weights_seq_no": 60.0}, "__all_modules__": {"num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 1980000, "num_module_steps_trained_lifetime": 718200, "num_env_steps_trained_lifetime_throughput": 52701.36498404372}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 119700, "num_env_steps_trained_lifetime": 330000, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime_throughput": 4390.047886318772, "num_module_steps_trained_throughput": 23572216.569241557, "num_module_steps_trained_lifetime_throughput": 14215021.203188999}, "intrinsic_reward_module": {"total_loss": 0.0, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "default_optimizer_learning_rate": 0.0002715581955, "module_train_batch_size_mean": 997.772440523815, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 59850, "weights_seq_no": 10.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 795.9342410418459}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.171558211077129e-05, "module_to_env_connector": {"connector_pipeline_timer": 0.0001163673861092232, "timers": {"connectors": {"tensor_to_numpy": 1.5241761411667764e-05, "normalize_and_clip_actions": 8.085141602638516e-06, "listify_data_for_vector_env": 1.0515099879185314e-05, "un_batch_to_individual_items": 6.655811584454101e-06, "remove_single_ts_time_rank_from_batch": 1.2147053470269264e-05, "get_actions": 3.701427834243388e-05}}}, "agent_episode_returns_mean": {"default_agent": 0.3}, "env_step_timer": 1.4091706543827657e-05, "env_reset_timer": 0.000175192482577027, "env_to_module_connector": {"connector_pipeline_timer": 5.975676646661734e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.15061144206979e-06, "add_observations_from_episodes_to_batch": 2.8192416853162e-06, "add_states_from_episodes_to_batch": 2.783191264395559e-06, "numpy_to_tensor": 1.207729732395382e-05, "batch_individual_items": 1.2417137594186922e-05}}}, "sample": 0.11590693455784078, "episode_return_max": 12.5, "episode_len_mean": 20.0, "episode_len_max": 20, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "episode_duration_sec_mean": 0.005588185006054118, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": 0.3}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled_lifetime": 50400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 10.0, "episode_return_min": -15.5, "num_env_steps_sampled": 400, "num_episodes_lifetime": 200, "num_episodes": 20, "episode_return_mean": 0.3, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "time_between_sampling": 9.361226697775079}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "b1709_00000", "date": "2025-08-11_18-34-11", "timestamp": 1754930051, "time_this_iter_s": 10.028944969177246, "time_total_s": 96.98370122909546, "pid": 11351, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3845f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 96.98370122909546, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 44.864285714285714, "ram_util_percent": 79.84285714285714}}
{"timers": {"training_iteration": 9.098458235065873, "restore_env_runners": 1.2185598305611773e-05, "training_step": 9.098318842216605, "env_runner_sampling_timer": 1.62289868744452, "learner_update_timer": 7.302041516149614, "synch_weights": 0.000828083267228423, "restore_eval_env_runners": 8.776320666027787e-06, "evaluation_iteration": 0.12303962904017754, "synch_eval_env_connectors": 0.00013639364249305833, "synch_env_connectors": 4.422719665569522e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00015642903270557943, "timers": {"connectors": {"un_batch_to_individual_items": 8.035607240184655e-06, "tensor_to_numpy": 2.0361850655183843e-05, "remove_single_ts_time_rank_from_batch": 1.427628809805929e-05, "normalize_and_clip_actions": 9.998957704424421e-06, "get_actions": 5.784135503739125e-05, "listify_data_for_vector_env": 1.3088516206262088e-05}}}, "time_between_sampling": 0.03449152975214508, "episode_duration_sec_mean": 0.0072457953854464, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -5547500.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.58373476572455e-06, "add_time_dim_to_batch_and_zero_pad": 9.070664862349408e-06, "numpy_to_tensor": 1.7715033348138804e-05, "add_states_from_episodes_to_batch": 3.5168341131254082e-06, "batch_individual_items": 1.727785431653446e-05}}, "connector_pipeline_timer": 7.85592989010026e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "agent_episode_returns_mean": {"default_agent": -1.8199999999999996}, "weights_seq_no": 10.0, "module_episode_returns_mean": {"default_policy": -1.8199999999999996}, "episode_return_min": -13.5, "num_env_steps_sampled": 5000.0, "num_episodes_lifetime": -277375.0, "rlmodule_inference_timer": 5.003593209324164e-05, "episode_len_mean": 20.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "num_episodes": 250.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 2.031451000893456e-05, "episode_return_mean": -1.8199999999999996, "env_reset_timer": 5.5180786104225887e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "sample": 0.006859892927337116, "episode_return_max": 6.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 2789.350306272023}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13503068749115918, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009377893400256968, "add_observations_from_episodes_to_batch": 0.0008366183594017943, "add_columns_from_episodes_to_train_batch": 0.04114889319738984, "add_time_dim_to_batch_and_zero_pad": 0.07556576945086263, "add_states_from_episodes_to_batch": 0.0036944604339046033, "batch_individual_items": 0.004171382337881798, "numpy_to_tensor": 7.463910221800079e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "policy_loss": -0.0006491324165835977, "use_intrinsic_rewards": 0.0, "weights_seq_no": 11.0, "vf_explained_var": 0.0011568665504455566, "num_trainable_parameters": 16595, "vf_loss": 0.35831254720687866, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 7.889840344432741e-05, "num_module_steps_trained": 5985, "total_loss": 0.27744004130363464, "module_train_batch_size_mean": 997.7563503102639, "num_module_steps_trained_lifetime": 65835, "entropy": 0.6834161281585693, "vf_loss_unclipped": 48.41398239135742, "mean_kl_loss": 7.793784607201815e-05, "num_module_steps_trained_lifetime_throughput": 791.7090958376992}, "IntrinsicAttentionMask": [[[0.0901918038725853, 0.09232060611248016, 0.09073053300380707, 0.09165000170469284, 0.09161941707134247, 0.09004141390323639, 0.09155827760696411, 0.09057924896478653, 0.08995130658149719, 0.08992128819227219, 0.09143613278865814], [0.09147008508443832, 0.0898134857416153, 0.09104430675506592, 0.09032793343067169, 0.09035155922174454, 0.09158975630998611, 0.09039881825447083, 0.09116341918706894, 0.09166163206100464, 0.09168560057878494, 0.09049341827630997], [0.0905185341835022, 0.09167615324258804, 0.09081265330314636, 0.09131281077861786, 0.09129621088504791, 0.09043628722429276, 0.09126301854848862, 0.09073013812303543, 0.09038697183132172, 0.0903705433011055, 0.09119667857885361], [0.09107109159231186, 0.09059197455644608, 0.09094854444265366, 0.09074142575263977, 0.09074828028678894, 0.09110546112060547, 0.09076197445392609, 0.09098286926746368, 0.09112609177827835, 0.09113296866416931, 0.09078937768936157], [0.09105280786752701, 0.09062771499156952, 0.09094410389661789, 0.09076035022735596, 0.09076641499996185, 0.09108329564332962, 0.09077857434749603, 0.09097455441951752, 0.09110158681869507, 0.09110768884420395, 0.0908028855919838], [0.09010019898414612, 0.09250173717737198, 0.09070727229118347, 0.09174444526433945, 0.0917099267244339, 0.08993082493543625, 0.09164092689752579, 0.09053675830364227, 0.08982934802770615, 0.0897955521941185, 0.0915030762553215], [0.0910162553191185, 0.09069924056529999, 0.09093522280454636, 0.09079819172620773, 0.09080272912979126, 0.09103897958993912, 0.09081178903579712, 0.09095792472362518, 0.09105261415243149, 0.09105715900659561, 0.09082993119955063], [0.09042701125144958, 0.09185643494129181, 0.0907897874712944, 0.09140732139348984, 0.0913868099451065, 0.09032561630010605, 0.09134580940008163, 0.09068798273801804, 0.09026483446359634, 0.09024457633495331, 0.09126386046409607], [0.09004522860050201, 0.09261052310466766, 0.09069325774908066, 0.09180109202861786, 0.09176421165466309, 0.08986447751522064, 0.09169048815965652, 0.09051120281219482, 0.08975619077682495, 0.08972012996673584, 0.09154321253299713], [0.09002690017223358, 0.09264680743217468, 0.09068858623504639, 0.09181997925043106, 0.09178230911493301, 0.08984235674142838, 0.0917070060968399, 0.09050268679857254, 0.08973181247711182, 0.08969499915838242, 0.09155658632516861], [0.09094313532114029, 0.09084240347146988, 0.09091740846633911, 0.09087387472391129, 0.09087531268596649, 0.09095034748315811, 0.0908781960606575, 0.09092462062835693, 0.09095466881990433, 0.09095611423254013, 0.09088396281003952]], [[0.0898481234908104, 0.0893654152750969, 0.08934232592582703, 0.08977849036455154, 0.08975528925657272, 0.08927308768033981, 0.0904354527592659, 0.08968572318553925, 0.10245971381664276, 0.08977115154266357, 0.0902852863073349], [0.08904357254505157, 0.08823812752962112, 0.0881996676325798, 0.08892718702554703, 0.08888843655586243, 0.0880843997001648, 0.09002760052680969, 0.0887722596526146, 0.11112821847200394, 0.08891493082046509, 0.08977559208869934], [0.08900334686040878, 0.08818261325359344, 0.08814343065023422, 0.08888475596904755, 0.08884525299072266, 0.08802597969770432, 0.0900062546133995, 0.08872687071561813, 0.11155980080366135, 0.08887225389480591, 0.08974939584732056], [0.08973623067140579, 0.08920661360025406, 0.08918128162622452, 0.08965981006622314, 0.08963435143232346, 0.08910533785820007, 0.09038101881742477, 0.08955802023410797, 0.10366944223642349, 0.08965175598859787, 0.09021612256765366], [0.08969864249229431, 0.08915343135595322, 0.08912734687328339, 0.08961997181177139, 0.08959375321865082, 0.08904917538166046, 0.0903625562787056, 0.08951517194509506, 0.10407547652721405, 0.08961167186498642, 0.0901927575469017], [0.08888179808855057, 0.08801530301570892, 0.0879739448428154, 0.08875655382871628, 0.0887148454785347, 0.08784998953342438, 0.08994124084711075, 0.0885898545384407, 0.11286336183547974, 0.08874335885047913, 0.08966983109712601], [0.09073832631111145, 0.0906556099653244, 0.09065163880586624, 0.09072642028331757, 0.0907224491238594, 0.09063974767923355, 0.0908384770154953, 0.09071054309606552, 0.0927787497639656, 0.09072516113519669, 0.09081292152404785], [0.08958502858877182, 0.08899310231208801, 0.0889648050069809, 0.08949960023164749, 0.08947113156318665, 0.08887995034456253, 0.09030625224113464, 0.08938580751419067, 0.10530203580856323, 0.08949059247970581, 0.09012175351381302], [0.09695207327604294, 0.10553468763828278, 0.1059650406241417, 0.09814296662807465, 0.09854316711425781, 0.1072666347026825, 0.08749846369028091, 0.09975360333919525, 0.01225560624152422, 0.09826939553022385, 0.08981829881668091], [0.0897243544459343, 0.0891897976398468, 0.08916423469781876, 0.08964721858501434, 0.08962152153253555, 0.0890875831246376, 0.09037519991397858, 0.08954447507858276, 0.10379774123430252, 0.0896390900015831, 0.0902087464928627], [0.09051961451768875, 0.09033393114805222, 0.09032502770423889, 0.0904928594827652, 0.09048394858837128, 0.09029833972454071, 0.09074470400810242, 0.09045720845460892, 0.09516704082489014, 0.09049004316329956, 0.09068724513053894]], [[0.08997491002082825, 0.09149064868688583, 0.09051234275102615, 0.09142959862947464, 0.09200642257928848, 0.08982488512992859, 0.09194502979516983, 0.09036142379045486, 0.09033127129077911, 0.09030112624168396, 0.09182236343622208], [0.09116847813129425, 0.09074735641479492, 0.09101812541484833, 0.09076415002346039, 0.09060608595609665, 0.09121064841747284, 0.09062284231185913, 0.09106023609638214, 0.09106865525245667, 0.09107708185911179, 0.09065638482570648], [0.09039988368749619, 0.09122627973556519, 0.09069362282752991, 0.09119311720132828, 0.09150606393814087, 0.0903177410364151, 0.0914727970957756, 0.09061121195554733, 0.09059473872184753, 0.09057827293872833, 0.09140630066394806], [0.09112069010734558, 0.09077714383602142, 0.09099806845188141, 0.09079084545373917, 0.09066183120012283, 0.09115507453680038, 0.09067551046609879, 0.09103241562843323, 0.091039277613163, 0.09104615449905396, 0.09070289134979248], [0.09157110750675201, 0.09049607068300247, 0.09118641167879105, 0.09053877741098404, 0.09013715386390686, 0.09167919307947159, 0.0901796966791153, 0.0912940502166748, 0.09131558984518051, 0.09133713692426682, 0.09026484191417694], [0.08985592424869537, 0.0915645956993103, 0.0904613509774208, 0.09149570763111115, 0.0921468511223793, 0.08968700468540192, 0.09207752346992493, 0.09029129147529602, 0.09025731682777405, 0.09022335708141327, 0.09193901717662811], [0.09152326732873917, 0.09052593261003494, 0.09116648137569427, 0.09056557714939117, 0.0901927724480629, 0.09162349998950958, 0.09023226797580719, 0.09126631915569305, 0.091286301612854, 0.09130628407001495, 0.09031131118535995], [0.09028074145317078, 0.09130042791366577, 0.09064292907714844, 0.09125946462154388, 0.09164614230394363, 0.09017951041460037, 0.09160502254962921, 0.0905412957072258, 0.09052097797393799, 0.09050066769123077, 0.09152284264564514], [0.09025691449642181, 0.09131524711847305, 0.09063278138637543, 0.09127271920442581, 0.09167416393756866, 0.09015187621116638, 0.09163147211074829, 0.09052729606628418, 0.09050621837377548, 0.09048514068126678, 0.09154614806175232], [0.09023308753967285, 0.09133006632328033, 0.09062261879444122, 0.09128597378730774, 0.09170219302177429, 0.0901242345571518, 0.09165792167186737, 0.09051330387592316, 0.09049145877361298, 0.0904696136713028, 0.0915694609284401], [0.09142762422561646, 0.09058564156293869, 0.09112657606601715, 0.09061913192272186, 0.09030405431985855, 0.09151215851306915, 0.09033744782209396, 0.09121083468198776, 0.0912276953458786, 0.09124455600976944, 0.09040426462888718]], [[0.091236412525177, 0.09123006463050842, 0.09109774976968765, 0.09121736139059067, 0.09121100604534149, 0.0910787284374237, 0.09139671176671982, 0.09106604009866714, 0.08803582191467285, 0.0912153497338295, 0.0912148654460907], [0.09127587825059891, 0.09126874059438705, 0.09112020581960678, 0.09125448018312454, 0.09124734997749329, 0.0910988450050354, 0.09145587682723999, 0.09108460694551468, 0.0876900851726532, 0.09125222265720367, 0.0912516862154007], [0.09207179397344589, 0.09204825758934021, 0.09155908226966858, 0.09200120717287064, 0.09197769314050674, 0.09148888289928436, 0.0926671102643013, 0.09144212305545807, 0.08075814694166183, 0.09199376404285431, 0.09199199080467224], [0.09135446697473526, 0.09134577214717865, 0.091164730489254, 0.09132838249206543, 0.09131969511508942, 0.09113870561122894, 0.09157393127679825, 0.0911213606595993, 0.08700231462717056, 0.09132563322782516, 0.09132497757673264], [0.09139358252286911, 0.09138410538434982, 0.09118680655956268, 0.09136515855789185, 0.09135568141937256, 0.0911584421992302, 0.09163281321525574, 0.0911395400762558, 0.08666026592254639, 0.09136215597391129, 0.09136144816875458], [0.0921822115778923, 0.0921562910079956, 0.09161774069070816, 0.0921044796705246, 0.09207858890295029, 0.09154049307107925, 0.09283801913261414, 0.0914890244603157, 0.07980253547430038, 0.09209628403186798, 0.09209433197975159], [0.09020059555768967, 0.09021367877721786, 0.09048686176538467, 0.09023986011743546, 0.09025295078754425, 0.09052624553442001, 0.08987132459878922, 0.09055251628160477, 0.0971670001745224, 0.09024400264024734, 0.09024498611688614], [0.09225527197122574, 0.0922277569770813, 0.09165625274181366, 0.092172771692276, 0.09214528650045395, 0.0915742814540863, 0.09295149892568588, 0.09151968359947205, 0.07917121052742004, 0.0921640694141388, 0.09216199815273285], [0.10155089944601059, 0.10110131651163101, 0.09217045456171036, 0.1002081111073494, 0.09976447373628616, 0.09095171093940735, 0.1135701835155487, 0.09014817327260971, 0.010433156974613667, 0.10006753355264664, 0.10003406554460526], [0.09136686474084854, 0.09135792404413223, 0.0911717414855957, 0.09134004265069962, 0.0913311019539833, 0.09114497154951096, 0.09159258008003235, 0.09112713485956192, 0.0868939682841301, 0.09133721143007278, 0.09133653342723846], [0.09136980026960373, 0.09136079251766205, 0.09117339551448822, 0.09134279936552048, 0.0913337990641594, 0.09114645421504974, 0.09159700572490692, 0.09112849831581116, 0.08686815202236176, 0.09133995324373245, 0.09133927524089813]], [[0.09030094742774963, 0.09182217717170715, 0.09024069458246231, 0.09176090359687805, 0.0917302817106247, 0.0901503786444664, 0.09166907519102097, 0.09009023010730743, 0.09006015956401825, 0.09062834829092026, 0.09154677391052246], [0.0910772755742073, 0.0906565859913826, 0.09109412878751755, 0.09067335724830627, 0.09068173915147781, 0.09111940860748291, 0.09069851785898209, 0.09113626182079315, 0.09114469587802887, 0.0909859761595726, 0.09073208272457123], [0.09026985615491867, 0.09186884760856628, 0.09020654857158661, 0.09180442243814468, 0.09177222102880478, 0.09011167287826538, 0.09170785546302795, 0.09004846960306168, 0.09001689404249191, 0.09061387926340103, 0.09157927334308624], [0.09104631096124649, 0.09070305526256561, 0.09106005728244781, 0.09071674197912216, 0.09072358906269073, 0.0910806730389595, 0.09073728322982788, 0.09109441936016083, 0.09110129624605179, 0.09097184240818024, 0.09076467901468277], [0.09103084355592728, 0.09072630107402802, 0.09104302525520325, 0.090738445520401, 0.09074452519416809, 0.0910613164305687, 0.09075667709112167, 0.09107351303100586, 0.09107960760593414, 0.09096477925777435, 0.09078098088502884], [0.09022322297096252, 0.09193888306617737, 0.09015534818172455, 0.09186971187591553, 0.0918351411819458, 0.09005361795425415, 0.09176605194807053, 0.08998586237430573, 0.0899520069360733, 0.0905921682715416, 0.09162801504135132], [0.09099987149238586, 0.09077278524637222, 0.09100895375013351, 0.09078184515237808, 0.09078637510538101, 0.09102258831262589, 0.09079544246196747, 0.09103167057037354, 0.09103621542453766, 0.0909506306052208, 0.09081357717514038], [0.09019213169813156, 0.09198557585477829, 0.09012120217084885, 0.09191323816776276, 0.09187708795070648, 0.09001491218805313, 0.09180483967065811, 0.08994412422180176, 0.08990874886512756, 0.09057766199111938, 0.0916604995727539], [0.09017656743526459, 0.09200891852378845, 0.0901041179895401, 0.09193499386310577, 0.09189805388450623, 0.08999555557966232, 0.09182422608137131, 0.08992324024438858, 0.0898871123790741, 0.09057040512561798, 0.0916767343878746], [0.09046940505504608, 0.09156924486160278, 0.09042572975158691, 0.09152504056692123, 0.09150294959545135, 0.09036026149988174, 0.09145878255367279, 0.09031664580106735, 0.09029484540224075, 0.09070654213428497, 0.09137050807476044], [0.09093792736530304, 0.09086579084396362, 0.09094081073999405, 0.09086867421865463, 0.09087011218070984, 0.09094513207674026, 0.09087299555540085, 0.09094801545143127, 0.09094946086406708, 0.0909222960472107, 0.09087875485420227]], [[0.08826364576816559, 0.08897741138935089, 0.08818822354078293, 0.08815053850412369, 0.08886339515447617, 0.08882542699575424, 0.09074628353118896, 0.08874952048063278, 0.11061331629753113, 0.08888936042785645, 0.08973289281129837], [0.08929359912872314, 0.08974393457174301, 0.08924594521522522, 0.08922212570905685, 0.08967208862304688, 0.08964814990758896, 0.09085411578416824, 0.08960029482841492, 0.10281219333410263, 0.08968845009803772, 0.09021908789873123], [0.08815163373947144, 0.08889302611351013, 0.08807331323623657, 0.08803417533636093, 0.08877457678318024, 0.08873512595891953, 0.09073135256767273, 0.08865628391504288, 0.11147099733352661, 0.0888015553355217, 0.08967799693346024], [0.08809544146060944, 0.08885060995817184, 0.08801566809415817, 0.08797580748796463, 0.08872994780540466, 0.08868977427482605, 0.09072364121675491, 0.08860945701599121, 0.11190201342105865, 0.08875743299722672, 0.08965031057596207], [0.08913266658782959, 0.08962531387805939, 0.08908054232597351, 0.08905448764562607, 0.08954670280218124, 0.08952051401138306, 0.09084084630012512, 0.08946815133094788, 0.10402078181505203, 0.08956460654735565, 0.09014539420604706], [0.08907876908779144, 0.08958549052476883, 0.08902515470981598, 0.08899836242198944, 0.08950462937355042, 0.08947768807411194, 0.09083610773086548, 0.08942383527755737, 0.10442642122507095, 0.08952304720878601, 0.09012051671743393], [0.09162671864032745, 0.09141075611114502, 0.09164966642856598, 0.09166114777326584, 0.09144511073827744, 0.09145656228065491, 0.09088508784770966, 0.09147946536540985, 0.08576358109712601, 0.09143728017807007, 0.09118460863828659], [0.08897058665752411, 0.08950541168451309, 0.08891400694847107, 0.08888573199510574, 0.08942005038261414, 0.08939161896705627, 0.0908261239528656, 0.08933477103710175, 0.10524187982082367, 0.0894394963979721, 0.09007029980421066], [0.10583514720201492, 0.09802267700433731, 0.10670004785060883, 0.10713514685630798, 0.09922672063112259, 0.09963133931159973, 0.08127034455537796, 0.10044554620981216, 0.012340737506747246, 0.0989510640501976, 0.09044136106967926], [0.08916943520307541, 0.08965244889259338, 0.08911832422018051, 0.08909278362989426, 0.0895753800868988, 0.0895497053861618, 0.09084399789571762, 0.089498370885849, 0.10374429076910019, 0.08959294110536575, 0.09016230702400208], [0.09032679349184036, 0.09049463272094727, 0.09030900150537491, 0.09030009806156158, 0.0904678925871849, 0.09045897424221039, 0.09090613573789597, 0.09044115245342255, 0.09515015035867691, 0.09047397971153259, 0.09067114442586899]]], "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"use_intrinsic_rewards": 1.0, "weights_seq_no": 66.0, "vf_loss": 0.35848090052604675, "policy_loss": -0.0006325739668682218, "vf_explained_var": 0.0015135407447814941, "total_loss": 0.277599573135376, "diff_num_grad_updates_vs_sampler_policy": 56.0, "num_module_steps_trained": 35910, "entropy": 0.6834602952003479, "vf_loss_unclipped": 48.29725646972656, "module_train_batch_size_mean": 997.5068778348534, "num_module_steps_trained_lifetime": 395010, "mean_kl_loss": 7.39993411116302e-05}, "intrinsic_reward_module": {"total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 56.0, "module_train_batch_size_mean": 997.5068778348534, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 395010, "weights_seq_no": 66.0}, "__all_modules__": {"num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 2178000, "num_module_steps_trained_lifetime": 790020, "num_env_steps_trained_lifetime_throughput": 51754.09058693587}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 131670, "num_env_steps_trained_lifetime": 363000, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime_throughput": 4366.746489091707, "num_module_steps_trained_throughput": 22957886.039041825, "num_module_steps_trained_lifetime_throughput": 14100711.626820555}, "intrinsic_reward_module": {"total_loss": 0.0, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "default_optimizer_learning_rate": 0.0002715581955, "module_train_batch_size_mean": 997.7563503102639, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 65835, "weights_seq_no": 11.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 791.7182562277413}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.0490943449027457e-05, "module_to_env_connector": {"connector_pipeline_timer": 0.0001132890543644823, "timers": {"connectors": {"tensor_to_numpy": 1.5000873827841087e-05, "normalize_and_clip_actions": 7.869595467724138e-06, "listify_data_for_vector_env": 1.0337983613479306e-05, "un_batch_to_individual_items": 6.490370286391161e-06, "remove_single_ts_time_rank_from_batch": 1.1874452156744441e-05, "get_actions": 3.557886332829078e-05}}}, "agent_episode_returns_mean": {"default_agent": -1.1}, "env_step_timer": 1.3831393425650297e-05, "env_reset_timer": 0.0001769168089008068, "env_to_module_connector": {"connector_pipeline_timer": 5.925624942209068e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.15241961332255e-06, "add_observations_from_episodes_to_batch": 2.7969994246387205e-06, "add_states_from_episodes_to_batch": 2.7515166512136507e-06, "numpy_to_tensor": 1.1874043445828139e-05, "batch_individual_items": 1.2330366376833852e-05}}}, "sample": 0.11589624730229446, "episode_return_max": 12.5, "episode_len_mean": 20.0, "episode_len_max": 20, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "episode_duration_sec_mean": 0.005384787939256057, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": -1.1}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled_lifetime": 55400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 11.0, "episode_return_min": -15.5, "num_env_steps_sampled": 400, "num_episodes_lifetime": 220, "num_episodes": 20, "episode_return_mean": -1.1, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "time_between_sampling": 9.37218597329738}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "b1709_00000", "date": "2025-08-11_18-34-22", "timestamp": 1754930062, "time_this_iter_s": 10.552052974700928, "time_total_s": 107.53575420379639, "pid": 11351, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3845f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 107.53575420379639, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 47.849999999999994, "ram_util_percent": 80.18125}}
{"timers": {"training_iteration": 9.102557968545824, "restore_env_runners": 1.2121242178312414e-05, "training_step": 9.102417036294213, "env_runner_sampling_timer": 1.6254079159797596, "learner_update_timer": 7.303502546817269, "synch_weights": 0.0008395753546151789, "restore_eval_env_runners": 9.07980840126991e-06, "evaluation_iteration": 0.12304034734054911, "synch_eval_env_connectors": 0.00013694512693935573, "synch_env_connectors": 4.451822480132613e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.0001303794728322987, "timers": {"connectors": {"un_batch_to_individual_items": 7.217564113640666e-06, "tensor_to_numpy": 1.6678239502188083e-05, "remove_single_ts_time_rank_from_batch": 1.3396352166624333e-05, "normalize_and_clip_actions": 8.75708168809041e-06, "get_actions": 4.469242368528541e-05, "listify_data_for_vector_env": 1.14529316301837e-05}}}, "time_between_sampling": 0.03449631001788744, "episode_duration_sec_mean": 0.006520246682222935, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -6165000.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.086789143368419e-06, "add_time_dim_to_batch_and_zero_pad": 7.71340008403986e-06, "numpy_to_tensor": 1.4340225203510567e-05, "add_states_from_episodes_to_batch": 2.8491917406222226e-06, "batch_individual_items": 1.3504271373606253e-05}}, "connector_pipeline_timer": 6.498610641044845e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "agent_episode_returns_mean": {"default_agent": -1.1800000000000002}, "weights_seq_no": 11.0, "module_episode_returns_mean": {"default_policy": -1.1800000000000002}, "episode_return_min": -13.5, "num_env_steps_sampled": 5000.0, "num_episodes_lifetime": -308250.0, "rlmodule_inference_timer": 7.036157503460613e-05, "episode_len_mean": 20.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "num_episodes": 250.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.6686568287559442e-05, "episode_return_mean": -1.1800000000000002, "env_reset_timer": 5.6380871214265876e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "sample": 0.0074674947876628515, "episode_return_max": 6.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3002.3391895925365}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13500641645715009, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009373274466461301, "add_observations_from_episodes_to_batch": 0.0008363292547723376, "add_columns_from_episodes_to_train_batch": 0.041143386345098815, "add_time_dim_to_batch_and_zero_pad": 0.07555414050669539, "add_states_from_episodes_to_batch": 0.003693397909539374, "batch_individual_items": 0.004170963933717273, "numpy_to_tensor": 7.449729205081783e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "policy_loss": -5.989858618704602e-05, "use_intrinsic_rewards": 0.0, "weights_seq_no": 12.0, "vf_explained_var": 0.0006660223007202148, "num_trainable_parameters": 16595, "vf_loss": 0.35830846428871155, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 3.944920172216371e-05, "num_module_steps_trained": 5985, "total_loss": 0.27802738547325134, "module_train_batch_size_mean": 997.7412016936058, "num_module_steps_trained_lifetime": 71820, "entropy": 0.6825523376464844, "vf_loss_unclipped": 46.65763473510742, "mean_kl_loss": 1.415663518855581e-05, "num_module_steps_trained_lifetime_throughput": 787.9467241027098}, "IntrinsicAttentionMask": [[[0.09013627469539642, 0.09165472537279129, 0.09007612615823746, 0.09159357100725174, 0.09217143058776855, 0.08998598158359528, 0.09210992604494095, 0.08992593735456467, 0.08989592641592026, 0.0904630795121193, 0.09198704361915588], [0.09112274646759033, 0.09070184081792831, 0.09113960713148117, 0.09071862697601318, 0.09056064486503601, 0.09116489440202713, 0.09057740122079849, 0.09118176251649857, 0.09119019657373428, 0.09103139489889145, 0.09061092138290405], [0.09009676426649094, 0.09169268608093262, 0.09003357589244843, 0.09162838011980057, 0.09223605692386627, 0.08993887901306152, 0.09217137098312378, 0.08987580239772797, 0.08984427899122238, 0.09044012427330017, 0.09204213321208954], [0.09108342230319977, 0.09074001759290695, 0.0910971611738205, 0.0907537117600441, 0.09062475711107254, 0.09111779183149338, 0.09063843637704849, 0.0911315456032753, 0.09113842248916626, 0.09100891649723053, 0.0906657949090004], [0.09145359694957733, 0.09037994593381882, 0.09149675816297531, 0.0904226005077362, 0.09002149850130081, 0.09156154096126556, 0.09006398171186447, 0.09160476177930832, 0.09162637591362, 0.0912199318408966, 0.09014901518821716], [0.09003747999668121, 0.09174960106611252, 0.08996973931789398, 0.09168057143688202, 0.09233303368091583, 0.0898682177066803, 0.09226356446743011, 0.08980060368776321, 0.08976681530475616, 0.0904056578874588, 0.09212478250265121], [0.09141433984041214, 0.09041818976402283, 0.09145436435937881, 0.09045778959989548, 0.09008543193340302, 0.09151444584131241, 0.09012488275766373, 0.09155452251434326, 0.09157456457614899, 0.09119760990142822, 0.09020382910966873], [0.08999794721603394, 0.09178753197193146, 0.08992717415094376, 0.09171534329652786, 0.09239770472049713, 0.08982110768556595, 0.09232503920793533, 0.08975047618150711, 0.08971516788005829, 0.0903826504945755, 0.09217988699674606], [0.0899781733751297, 0.09180648624897003, 0.08990588039159775, 0.09173273295164108, 0.09243004769086838, 0.08979754894971848, 0.09235578775405884, 0.08972540497779846, 0.08968935906887054, 0.09037113934755325, 0.09220743924379349], [0.09035037457942963, 0.09144877642393112, 0.09030675888061523, 0.09140463173389435, 0.09182138741016388, 0.09024138003587723, 0.09177706390619278, 0.09019782394170761, 0.0901760533452034, 0.09058720618486404, 0.09168848395347595], [0.09133581072092056, 0.09049468487501144, 0.09136958420276642, 0.09052814543247223, 0.09021338820457458, 0.0914202630519867, 0.09024674445390701, 0.09145406633615494, 0.09147097170352936, 0.09115293622016907, 0.09031349420547485]], [[0.08984760195016861, 0.0893649011850357, 0.08934181183576584, 0.08931872248649597, 0.08975476771593094, 0.08927256613969803, 0.09089990705251694, 0.08968520164489746, 0.10245908051729202, 0.08977062255144119, 0.09028476476669312], [0.08904214203357697, 0.08823671191930771, 0.08819825202226639, 0.08815981447696686, 0.08888700604438782, 0.08808297663927078, 0.09080831706523895, 0.08877082914113998, 0.11112634837627411, 0.08891350030899048, 0.08977414667606354], [0.08900186419487, 0.08818114548921585, 0.08814196288585663, 0.0881028026342392, 0.08884377032518387, 0.08802451193332672, 0.09080207347869873, 0.08872539550065994, 0.11155785620212555, 0.08887077122926712, 0.08974789083003998], [0.08896143734455109, 0.08812545239925385, 0.08808553963899612, 0.0880456492304802, 0.08880039304494858, 0.08796592056751251, 0.09079565852880478, 0.08867980539798737, 0.11199082434177399, 0.08882789313793182, 0.08972147852182388], [0.08969798684120178, 0.08915276825428009, 0.08912669867277145, 0.08910062909126282, 0.08959309756755829, 0.08904851973056793, 0.09088791906833649, 0.08951451629400253, 0.10407466441392899, 0.08961101621389389, 0.09019210189580917], [0.08888012170791626, 0.0880136489868164, 0.08797229081392288, 0.08793095499277115, 0.08871318399906158, 0.08784833550453186, 0.0907822996377945, 0.0885881781578064, 0.11286114901304245, 0.08874168992042542, 0.0896681398153305], [0.09137850999832153, 0.09161733835935593, 0.09162881225347519, 0.09164028614759445, 0.09142430126667023, 0.09166324138641357, 0.09086441248655319, 0.09145864844322205, 0.08574409782886505, 0.09141647815704346, 0.09116385877132416], [0.08958426117897034, 0.08899233490228653, 0.08896403014659882, 0.0889357402920723, 0.08947036415338516, 0.08887919038534164, 0.0908772200345993, 0.0893850326538086, 0.10530107468366623, 0.08948981761932373, 0.09012097865343094], [0.09681013226509094, 0.10538014024496078, 0.10580985993146896, 0.10624132305383682, 0.09839888662099838, 0.10710954666137695, 0.08059237152338028, 0.09960754215717316, 0.012237847782671452, 0.09812554717063904, 0.08968684077262878], [0.08972372859716415, 0.08918917924165726, 0.08916360884904861, 0.08913805335760117, 0.08962089568376541, 0.08908695727586746, 0.09089016169309616, 0.08954385668039322, 0.10379700362682343, 0.08963846415281296, 0.09020812064409256], [0.09051954001188278, 0.09033386409282684, 0.09032496064901352, 0.0903160572052002, 0.09048387408256531, 0.09029826521873474, 0.09092219173908234, 0.09045714139938354, 0.09516696631908417, 0.09048996865749359, 0.09068716317415237]], [[0.09055064618587494, 0.09133560210466385, 0.09055556356906891, 0.09130550920963287, 0.09129046648740768, 0.09051080793142319, 0.0912603884935379, 0.09077731519937515, 0.09046607464551926, 0.0907474011182785, 0.09120025485754013], [0.09152120351791382, 0.09018244594335556, 0.09151273220777512, 0.0902331992983818, 0.09025858342647552, 0.09158999472856522, 0.09030938148498535, 0.09113140404224396, 0.09166732430458069, 0.09118269383907318, 0.09041105210781097], [0.09055674076080322, 0.09132834523916245, 0.09056156873703003, 0.09129876643419266, 0.09128397703170776, 0.0905175730586052, 0.09125441312789917, 0.09077955782413483, 0.09047359973192215, 0.09075015783309937, 0.09119530767202377], [0.09148412942886353, 0.09022638201713562, 0.09147617965936661, 0.09027408063411713, 0.09029794484376907, 0.09154873341321945, 0.09034568071365356, 0.09111803770065308, 0.09162134677171707, 0.09116621315479279, 0.09044123440980911], [0.09146560728549957, 0.09024836122989655, 0.09145791083574295, 0.09029453247785568, 0.09031762927770615, 0.09152811020612717, 0.09036383777856827, 0.09111136198043823, 0.09159836918115616, 0.09115797281265259, 0.09045633673667908], [0.09050116688013077, 0.09139452874660492, 0.09050675481557846, 0.09136025607585907, 0.09134313464164734, 0.09045585244894028, 0.09130887687206268, 0.0907590240240097, 0.09040497988462448, 0.09072499722242355, 0.09124042093753815], [0.09142854064702988, 0.0902923047542572, 0.09142136573791504, 0.0903354287147522, 0.0903569906949997, 0.0914868637919426, 0.09040014445781708, 0.09109797328710556, 0.09155240654945374, 0.091141477227211, 0.09048651158809662], [0.0908317118883133, 0.09100110083818436, 0.09083277732133865, 0.09099462628364563, 0.09099139273166656, 0.09082308411598206, 0.09098491817712784, 0.09088074415922165, 0.09081339836120605, 0.09087427705526352, 0.09097197651863098], [0.0904456079006195, 0.09146072715520859, 0.09045194089412689, 0.09142176061868668, 0.09140228480100632, 0.09039414674043655, 0.0913633406162262, 0.09073846787214279, 0.0903363823890686, 0.09069980680942535, 0.09128551185131073], [0.09079466015100479, 0.09104517102241516, 0.09079623222351074, 0.09103558957576752, 0.09103080630302429, 0.09078190475702286, 0.09102122485637665, 0.09086714684963226, 0.09076758474111557, 0.09085758775472641, 0.09100208431482315], [0.09135441482067108, 0.0903802216053009, 0.09134826809167862, 0.09041722118854523, 0.09043573588132858, 0.09140437096357346, 0.0904727578163147, 0.09107117354869843, 0.09146051108837128, 0.09110845625400543, 0.0905468538403511]], [[0.08988937735557556, 0.08940645307302475, 0.08938334882259369, 0.08981971442699432, 0.08933716267347336, 0.08977329730987549, 0.09047696739435196, 0.08926791697740555, 0.10250671207904816, 0.08981236815452576, 0.09032674133777618], [0.08911174535751343, 0.08830568194389343, 0.08826719969511032, 0.08899527788162231, 0.08819027245044708, 0.08891772478818893, 0.09009652584791183, 0.08807501196861267, 0.11121319979429245, 0.08898300677537918, 0.08984432369470596], [0.08907278627157211, 0.08825141936540604, 0.08821219950914383, 0.08895410597324371, 0.08813382685184479, 0.08887506276369095, 0.09007647633552551, 0.08801639080047607, 0.11164673417806625, 0.08894159644842148, 0.08981940895318985], [0.08978144079446793, 0.0892515555024147, 0.08922621607780457, 0.0897049829363823, 0.08917555212974548, 0.08965404331684113, 0.09042654931545258, 0.08909960836172104, 0.10372161120176315, 0.08969692140817642, 0.09026157855987549], [0.08899440616369247, 0.08814246207475662, 0.08810179680585861, 0.08887128531932831, 0.08802051842212677, 0.08878929167985916, 0.09003585577011108, 0.08789873868227005, 0.11251822113990784, 0.08885830640792847, 0.08976908028125763], [0.08970874547958374, 0.08914763480424881, 0.08912079781293869, 0.08962776511907578, 0.08906716853380203, 0.08957382291555405, 0.09039213508367538, 0.08898676931858063, 0.10453858971595764, 0.0896192267537117, 0.09021734446287155], [0.0907454565167427, 0.09066273272037506, 0.0906587615609169, 0.09073355048894882, 0.09065083414316177, 0.0907256081700325, 0.09084562212228775, 0.09063893556594849, 0.09278612583875656, 0.09073229134082794, 0.0908200666308403], [0.0888756811618805, 0.08797801285982132, 0.0879351794719696, 0.08874592185020447, 0.08784956485033035, 0.08865951746702194, 0.08997367322444916, 0.08772130310535431, 0.11383658647537231, 0.08873224258422852, 0.08969234675168991], [0.09614866226911545, 0.10466011613607407, 0.10508689284324646, 0.09732967615127563, 0.10594567656517029, 0.09812507033348083, 0.08677349984645844, 0.10724703222513199, 0.01215427927672863, 0.09745509922504425, 0.08907405287027359], [0.08976997435092926, 0.08923514187335968, 0.08920957148075104, 0.08969279378652573, 0.08915842324495316, 0.08964138478040695, 0.09042114019393921, 0.0890817791223526, 0.10385049879550934, 0.08968465775251389, 0.09025461226701736], [0.09053561091423035, 0.09034989774227142, 0.0903409942984581, 0.0905088558793068, 0.09032319486141205, 0.09049102663993835, 0.0907607451081276, 0.09029650688171387, 0.09518386423587799, 0.09050603210926056, 0.09070327132940292]], [[0.08991920948028564, 0.09204157441854477, 0.09045631438493729, 0.09198015928268433, 0.091949462890625, 0.08976928144693375, 0.09188810735940933, 0.09030549228191376, 0.0902753546833992, 0.08964952081441879, 0.09176551550626755], [0.09168513864278793, 0.0900246649980545, 0.09125835448503494, 0.09007174521684647, 0.09009531140327454, 0.09180508553981781, 0.09014243632555008, 0.09137774258852005, 0.09140164405107498, 0.09190115332603455, 0.09023676812648773], [0.09036977589130402, 0.09152549505233765, 0.09066341072320938, 0.09149222075939178, 0.09147559106349945, 0.09028766304254532, 0.09144233167171478, 0.09058103710412979, 0.09056457132101059, 0.09022203087806702, 0.09137585759162903], [0.09163457900285721, 0.09008219093084335, 0.09123575687408447, 0.09012623876333237, 0.09014827013015747, 0.09174664318561554, 0.09019235521554947, 0.091347336769104, 0.09136966615915298, 0.09183639287948608, 0.09028058499097824], [0.09160929173231125, 0.09011095762252808, 0.09122443944215775, 0.09015348553657532, 0.09017475694417953, 0.091717429459095, 0.09021732211112976, 0.09133212268352509, 0.09135366976261139, 0.09180402010679245, 0.0903024971485138], [0.08979299664497375, 0.0921863317489624, 0.09039799869060516, 0.09211697429418564, 0.09208231419324875, 0.08962418884038925, 0.09201303124427795, 0.09022805839776993, 0.09019411355257034, 0.08948937803506851, 0.0918746292591095], [0.09155873209238052, 0.09016849845647812, 0.09120181202888489, 0.09020798653364182, 0.09022773802280426, 0.09165899455547333, 0.09026724100112915, 0.09130168706178665, 0.0913216695189476, 0.09173928946256638, 0.0903463140130043], [0.09024350345134735, 0.09167002141475677, 0.09060554206371307, 0.09162889420986176, 0.09160833060741425, 0.09014231711626053, 0.09156723320484161, 0.09050394594669342, 0.0904836431145668, 0.09006144106388092, 0.09148509055376053], [0.09021825343370438, 0.09169893711805344, 0.09059394896030426, 0.09165623039007187, 0.09163489192724228, 0.09011325240135193, 0.0915922224521637, 0.09048851579427719, 0.09046744555234909, 0.09002934396266937, 0.09150692820549011], [0.08969203382730484, 0.09230218082666397, 0.09035125374794006, 0.09222645312547684, 0.09218861162662506, 0.08950817584991455, 0.09211297333240509, 0.09016603976488113, 0.09012904763221741, 0.08936136215925217, 0.09196189045906067], [0.09145762771368027, 0.09028363227844238, 0.0911564901471138, 0.0903170183300972, 0.09033370763063431, 0.09154219180345535, 0.09036710858345032, 0.0912407711148262, 0.09125763177871704, 0.0916098952293396, 0.09043394774198532]], [[0.08831368386745453, 0.08902786672115326, 0.08823822438716888, 0.08895179629325867, 0.08816283196210861, 0.08812515437602997, 0.09003086388111115, 0.08804985135793686, 0.11161867529153824, 0.08969733119010925, 0.08978377282619476], [0.08932974189519882, 0.08978024870157242, 0.08928205817937851, 0.08973231911659241, 0.08923440426588058, 0.08921058475971222, 0.09041065722703934, 0.08916296809911728, 0.10340007394552231, 0.09020131826400757, 0.09025559574365616], [0.08820278197526932, 0.08894459903240204, 0.08812441676855087, 0.08886557072401047, 0.0880461111664772, 0.08800698816776276, 0.08998682349920273, 0.08792878687381744, 0.11252366006374359, 0.08964019268751144, 0.08973003178834915], [0.08922433853149414, 0.08970309048891068, 0.08917367458343506, 0.0896521583199501, 0.08912303298711777, 0.08909773081541061, 0.09037330001592636, 0.0890471413731575, 0.1042463406920433, 0.09015070647001266, 0.09020841866731644], [0.08809129148721695, 0.08886068314313889, 0.0880100205540657, 0.08877869695425034, 0.08792882412672043, 0.08788825571537018, 0.08994206041097641, 0.08780717849731445, 0.1134350448846817, 0.08958235383033752, 0.08967556804418564], [0.08803531527519226, 0.08881846815347672, 0.08795259147882462, 0.08873502165079117, 0.08786995708942413, 0.08782867342233658, 0.08991941064596176, 0.08774615079164505, 0.11389314383268356, 0.08955316990613937, 0.08964807540178299], [0.09065938740968704, 0.09073416888713837, 0.09065144509077072, 0.09072622656822205, 0.0906435176730156, 0.09063954651355743, 0.09083829075098038, 0.09063161909580231, 0.09285925328731537, 0.09080378711223602, 0.09081274271011353], [0.08792291581630707, 0.08873354643583298, 0.08783731609582901, 0.08864716440439224, 0.08775179833173752, 0.08770906925201416, 0.0898735448718071, 0.08762367814779282, 0.11481416970491409, 0.0894942581653595, 0.08959253877401352], [0.10458259284496307, 0.09655466675758362, 0.10547289252281189, 0.09737662971019745, 0.10637077689170837, 0.10682258754968643, 0.0864025130867958, 0.10773195326328278, 0.010254054330289364, 0.08964177221059799, 0.08878962695598602], [0.09022936224937439, 0.09042970836162567, 0.09020812064409256, 0.09040842205286026, 0.09018688648939133, 0.09017626941204071, 0.09070912003517151, 0.09015504270792007, 0.09624014049768448, 0.09061645716428757, 0.09064049273729324], [0.09034194052219391, 0.0905098021030426, 0.09032414108514786, 0.09049197286367416, 0.0903063490986824, 0.09029745310544968, 0.09074381738901138, 0.09027966111898422, 0.09535232931375504, 0.09066621959209442, 0.09068635106086731]]], "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"use_intrinsic_rewards": 1.0, "weights_seq_no": 72.0, "vf_loss": 0.3584669232368469, "policy_loss": -5.939109905739315e-05, "vf_explained_var": 0.0015465617179870605, "total_loss": 0.27815359830856323, "diff_num_grad_updates_vs_sampler_policy": 61.0, "num_module_steps_trained": 35910, "entropy": 0.6825605034828186, "vf_loss_unclipped": 46.553382873535156, "module_train_batch_size_mean": 997.504027034245, "num_module_steps_trained_lifetime": 430920, "mean_kl_loss": 1.3885092812415678e-05}, "intrinsic_reward_module": {"total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 61.0, "module_train_batch_size_mean": 997.504027034245, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 430920, "weights_seq_no": 72.0}, "__all_modules__": {"num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 2376000, "num_module_steps_trained_lifetime": 861840, "num_env_steps_trained_lifetime_throughput": 50855.5191927812}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 143640, "num_env_steps_trained_lifetime": 396000, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime_throughput": 4345.945502168279, "num_module_steps_trained_throughput": 22396227.440671522, "num_module_steps_trained_lifetime_throughput": 14005958.76397996}, "intrinsic_reward_module": {"total_loss": 0.0, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "default_optimizer_learning_rate": 0.0002715581955, "module_train_batch_size_mean": 997.7412016936058, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 71820, "weights_seq_no": 12.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 787.9552723561253}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.184676544045565e-05, "module_to_env_connector": {"connector_pipeline_timer": 0.0001167239376833677, "timers": {"connectors": {"tensor_to_numpy": 1.5478045408722284e-05, "normalize_and_clip_actions": 8.058415441642975e-06, "listify_data_for_vector_env": 1.060793226617604e-05, "un_batch_to_individual_items": 6.7078802116705546e-06, "remove_single_ts_time_rank_from_batch": 1.2059957663581344e-05, "get_actions": 3.694709228378784e-05}}}, "agent_episode_returns_mean": {"default_agent": -0.5}, "env_step_timer": 1.4454093882452545e-05, "env_reset_timer": 0.0001785493116495736, "env_to_module_connector": {"connector_pipeline_timer": 6.0843904055763194e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.27082208129934e-06, "add_observations_from_episodes_to_batch": 2.878085335114757e-06, "add_states_from_episodes_to_batch": 2.8241921918909873e-06, "numpy_to_tensor": 1.239982902810889e-05, "batch_individual_items": 1.263160232367394e-05}}}, "sample": 0.11597658941954331, "episode_return_max": 12.5, "episode_len_mean": 20.0, "episode_len_max": 20, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "episode_duration_sec_mean": 0.005464625019812957, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": -0.5}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled_lifetime": 60400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 12.0, "episode_return_min": -15.5, "num_env_steps_sampled": 400, "num_episodes_lifetime": 240, "num_episodes": 20, "episode_return_mean": -0.5, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "time_between_sampling": 9.373871782734934}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "b1709_00000", "date": "2025-08-11_18-34-32", "timestamp": 1754930072, "time_this_iter_s": 9.644886016845703, "time_total_s": 117.18064022064209, "pid": 11351, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3845f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 117.18064022064209, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 35.83076923076923, "ram_util_percent": 79.78461538461539}}
{"timers": {"training_iteration": 9.106512673019903, "restore_env_runners": 1.20591896947753e-05, "training_step": 9.10637063552102, "env_runner_sampling_timer": 1.6272092051500588, "learner_update_timer": 7.305461140099109, "synch_weights": 0.0008469650111379562, "restore_eval_env_runners": 9.42150953598933e-06, "evaluation_iteration": 0.12313908136728631, "synch_eval_env_connectors": 0.00013739359638085367, "synch_env_connectors": 4.486054563934335e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.000124056920411578, "timers": {"connectors": {"un_batch_to_individual_items": 6.812029731801633e-06, "tensor_to_numpy": 1.5853660237488575e-05, "remove_single_ts_time_rank_from_batch": 1.2683105588118148e-05, "normalize_and_clip_actions": 8.19925230231197e-06, "get_actions": 4.2247773793583886e-05, "listify_data_for_vector_env": 1.0942028785280836e-05}}}, "time_between_sampling": 0.031957001074301085, "episode_duration_sec_mean": 0.005528011825867, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -6782500.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.938737459171772e-06, "add_time_dim_to_batch_and_zero_pad": 7.297831585742291e-06, "numpy_to_tensor": 1.400916432856617e-05, "add_states_from_episodes_to_batch": 2.747294172628865e-06, "batch_individual_items": 1.2798726851395236e-05}}, "connector_pipeline_timer": 6.242892327047925e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "agent_episode_returns_mean": {"default_agent": -1.9}, "weights_seq_no": 12.0, "module_episode_returns_mean": {"default_policy": -1.9}, "episode_return_min": -13.5, "num_env_steps_sampled": 5000.0, "num_episodes_lifetime": -339125.0, "rlmodule_inference_timer": 3.323851480081773e-05, "episode_len_mean": 20.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "num_episodes": 250.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.478423076305737e-05, "episode_return_mean": -1.9, "env_reset_timer": 5.0468746844720255e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "sample": 0.00670208270186295, "episode_return_max": 6.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3083.146687825436}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13506961645308874, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009368503381727334, "add_observations_from_episodes_to_batch": 0.0008370034617734815, "add_columns_from_episodes_to_train_batch": 0.041137445811392614, "add_time_dim_to_batch_and_zero_pad": 0.0756247849315659, "add_states_from_episodes_to_batch": 0.0036943914311147563, "batch_individual_items": 0.0041731063733413095, "numpy_to_tensor": 7.438731814474685e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "policy_loss": 3.774098149733618e-05, "use_intrinsic_rewards": 0.0, "weights_seq_no": 13.0, "vf_explained_var": 5.3763389587402344e-05, "num_trainable_parameters": 16595, "vf_loss": 0.35830676555633545, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 1.9724600861081854e-05, "num_module_steps_trained": 5985, "total_loss": 0.27812424302101135, "module_train_batch_size_mean": 997.7269395717314, "num_module_steps_trained_lifetime": 77805, "entropy": 0.6822095513343811, "vf_loss_unclipped": 44.90297317504883, "mean_kl_loss": 1.2581691635205061e-06, "num_module_steps_trained_lifetime_throughput": 784.7587622192859}, "IntrinsicAttentionMask": [[[0.09008228778839111, 0.09159982949495316, 0.09062036871910095, 0.09214697033166885, 0.09211622178554535, 0.08993209153413773, 0.09144710004329681, 0.0898720771074295, 0.0904390811920166, 0.08981210738420486, 0.09193193912506104], [0.09113796800374985, 0.09071700274944305, 0.0909876748919487, 0.09056740999221802, 0.09057578444480896, 0.09118012338876724, 0.09075896441936493, 0.09119699895381927, 0.09103818237781525, 0.09121386706829071, 0.0906260684132576], [0.09045888483524323, 0.0912858173251152, 0.09075281023979187, 0.09158243238925934, 0.09156578034162521, 0.09037669003009796, 0.09120287746191025, 0.09034383296966553, 0.09065386652946472, 0.09031099081039429, 0.09146595746278763], [0.09151370823383331, 0.0904008150100708, 0.09111541509628296, 0.09000737220048904, 0.09002937376499176, 0.0916256308555603, 0.09051137417554855, 0.0916704311966896, 0.09124915301799774, 0.0917152613401413, 0.0901615098118782], [0.091492660343647, 0.09041855484247208, 0.0911082997918129, 0.0900387093424797, 0.09005995094776154, 0.09160064905881882, 0.09052527695894241, 0.09164387732744217, 0.09123735874891281, 0.09168713539838791, 0.09018752723932266], [0.0899767056107521, 0.09168767184019089, 0.0905829444527626, 0.09230543673038483, 0.09227070212364197, 0.08980756253004074, 0.09151531010866165, 0.08973998576402664, 0.09037864208221436, 0.08967246860265732, 0.09206259250640869], [0.09103261679410934, 0.09080546349287033, 0.09095156937837601, 0.09072461724281311, 0.09072914719581604, 0.09105534106492996, 0.09082812070846558, 0.09106443077325821, 0.09097881615161896, 0.09107352048158646, 0.09075631946325302], [0.08993446826934814, 0.09172278642654419, 0.0905679389834404, 0.09236885607242584, 0.09233252704143524, 0.0897577553987503, 0.0915425568819046, 0.08968716859817505, 0.09035443514585495, 0.08961663395166397, 0.09211486577987671], [0.0903322845697403, 0.09139149636030197, 0.09070846438407898, 0.09177208691835403, 0.09175071865320206, 0.0902271568775177, 0.09128513187170029, 0.09018514305353165, 0.09058179706335068, 0.09014314413070679, 0.09162259846925735], [0.08989222347736359, 0.0917578935623169, 0.090552918612957, 0.09243229776620865, 0.0923943743109703, 0.08970795571804047, 0.09156980365514755, 0.08963435143232346, 0.09033021330833435, 0.08956081420183182, 0.09216713905334473], [0.09136633574962616, 0.09052493423223495, 0.09106549620628357, 0.09022686630487442, 0.09024354815483093, 0.09145081788301468, 0.0906086415052414, 0.09148462861776352, 0.09116654843091965, 0.09151845425367355, 0.09034368395805359]], [[0.08839771896600723, 0.08835994452238083, 0.08907448500394821, 0.08903642743825912, 0.08824671059846878, 0.08820899575948715, 0.09011652320623398, 0.08888433128595352, 0.11078125983476639, 0.0890243798494339, 0.0898691937327385], [0.08834431320428848, 0.08830581605434418, 0.08903421461582184, 0.08899540454149246, 0.08819039911031723, 0.0881519615650177, 0.09009664505720139, 0.08884035795927048, 0.1112133339047432, 0.08898313343524933, 0.08984445780515671], [0.08932797610759735, 0.08930336683988571, 0.08976814150810242, 0.08974342048168182, 0.08922959119081497, 0.08920501172542572, 0.09044356644153595, 0.08964458107948303, 0.10331527888774872, 0.08973559737205505, 0.09028350561857224], [0.08927694708108902, 0.08925160020589828, 0.08973050117492676, 0.08970502763986588, 0.08917558938264847, 0.08915026485919952, 0.09042658656835556, 0.08960317820310593, 0.10372164100408554, 0.0896969586610794, 0.09026161581277847], [0.08818329125642776, 0.08814259618520737, 0.08891244232654572, 0.08887141942977905, 0.08802065253257751, 0.08798004686832428, 0.09003599733114243, 0.08870751410722733, 0.11251837015151978, 0.08885844051837921, 0.08976922929286957], [0.08812934160232544, 0.08808793127536774, 0.0888715609908104, 0.08882979303598404, 0.08796381205320358, 0.08792247623205185, 0.09001544862985611, 0.08866295218467712, 0.11295634508132935, 0.0888165831565857, 0.08974382281303406], [0.09066669642925262, 0.09066273272037506, 0.09073752164840698, 0.09073355048894882, 0.09065082669258118, 0.09064686298370361, 0.09084562212228775, 0.09071766585111618, 0.09278615564107895, 0.09073229134082794, 0.0908200591802597], [0.08907158672809601, 0.0890432596206665, 0.08957851678133011, 0.08955003321170807, 0.08895833790302277, 0.08893004804849625, 0.09035713970661163, 0.08943618088960648, 0.10536129772663116, 0.08954102545976639, 0.09017254412174225], [0.10424897074699402, 0.10467406362295151, 0.0969473347067833, 0.09734266251325607, 0.10595979541540146, 0.10639187693595886, 0.08678512275218964, 0.0989401564002037, 0.012155978009104729, 0.09746811538934708, 0.08908594399690628], [0.0892607793211937, 0.08923519402742386, 0.08971857279539108, 0.0896928533911705, 0.08915847539901733, 0.08913292735815048, 0.09042119234800339, 0.08959005773067474, 0.10385055840015411, 0.08968470990657806, 0.09025466442108154], [0.09035880118608475, 0.09034990519285202, 0.09051777422428131, 0.0905088558793068, 0.09032320231199265, 0.09031429886817932, 0.0907607451081276, 0.09047320485115051, 0.09518387168645859, 0.09050603955984116, 0.09070327132940292]], [[0.09044291824102402, 0.09152570366859436, 0.09074404090642929, 0.09119687974452972, 0.09148047119379044, 0.09069918841123581, 0.09115180373191833, 0.09066930413246155, 0.09065436571836472, 0.09034355729818344, 0.09109174460172653], [0.09218701720237732, 0.08923704922199249, 0.09135342389345169, 0.09011910855770111, 0.08935767412185669, 0.0914769172668457, 0.09024093300104141, 0.09155934303998947, 0.09160057455301285, 0.09246435761451721, 0.09040361642837524], [0.09092894196510315, 0.09088290482759476, 0.09091608226299286, 0.09089682996273041, 0.09088481962680817, 0.09091798961162567, 0.09089873731136322, 0.09091927111148834, 0.09091990441083908, 0.09093319624662399, 0.09090128540992737], [0.09165841341018677, 0.08992543816566467, 0.09117107093334198, 0.09044606238603592, 0.08999676257371902, 0.09124338626861572, 0.0905178040266037, 0.09129162132740021, 0.09131575375795364, 0.09182015061378479, 0.09061353653669357], [0.09211435914039612, 0.08933139592409134, 0.09132847934961319, 0.09016405791044235, 0.08944529294967651, 0.09144492447376251, 0.09027902036905289, 0.09152264147996902, 0.09156152606010437, 0.0923757329583168, 0.0904325395822525], [0.09085661172866821, 0.09097833186388016, 0.09089059382677078, 0.09094150364398956, 0.09097327291965485, 0.09088553488254547, 0.09093644469976425, 0.09088216722011566, 0.09088048338890076, 0.09084538370370865, 0.09092970937490463], [0.09158588945865631, 0.09002023935317993, 0.09114588797092438, 0.0904908999800682, 0.0900847315788269, 0.09121118485927582, 0.09055572748184204, 0.09125474840402603, 0.09127654135227203, 0.09173186123371124, 0.09064224362373352], [0.09080840647220612, 0.09104198217391968, 0.090873584151268, 0.09097128361463547, 0.09103226661682129, 0.09086389094591141, 0.09096157550811768, 0.09085742384195328, 0.09085419028997421, 0.09078686684370041, 0.09094862639904022], [0.09078428894281387, 0.09107380360364914, 0.09086506068706512, 0.09098614752292633, 0.09106175601482391, 0.09085304290056229, 0.0909741148352623, 0.0908450335264206, 0.09084102511405945, 0.09075760096311569, 0.09095807373523712], [0.0902823805809021, 0.09173889458179474, 0.09068683534860611, 0.09129593521356583, 0.09167793393135071, 0.09062657505273819, 0.09123527258634567, 0.09058641642332077, 0.09056635200977325, 0.09014903008937836, 0.09115444123744965], [0.09148922562599182, 0.0901467353105545, 0.09111227840185165, 0.09055065363645554, 0.09020210057497025, 0.09116823971271515, 0.09060627222061157, 0.09120555967092514, 0.09122423082590103, 0.09161422401666641, 0.09068048000335693]], [[0.0912022739648819, 0.09119592607021332, 0.09106366336345673, 0.09118323028087616, 0.09105098992586136, 0.091170534491539, 0.09148883819580078, 0.09103196859359741, 0.08812457323074341, 0.09130728989839554, 0.09118074178695679], [0.09123759716749191, 0.09123046696186066, 0.09108199179172516, 0.09121620655059814, 0.09106775373220444, 0.09120195358991623, 0.09155938774347305, 0.09104640781879425, 0.08778934925794601, 0.09135550260543823, 0.0912134125828743], [0.09194767475128174, 0.09192417562007904, 0.09143565595149994, 0.09187719225883484, 0.09138891845941544, 0.09183022379875183, 0.09301283955574036, 0.09131885319948196, 0.08105950057506561, 0.0923369899392128, 0.09186799079179764], [0.0913078784942627, 0.09129919111728668, 0.09111825376749039, 0.09128181636333466, 0.09110090881586075, 0.09126444160938263, 0.09170026332139969, 0.09107489883899689, 0.0871223583817482, 0.09145162254571915, 0.09127841144800186], [0.09201324731111526, 0.09198816120624542, 0.09146682173013687, 0.09193800389766693, 0.09141695499420166, 0.09188788384199142, 0.09315061569213867, 0.09134220331907272, 0.08043903112411499, 0.09242884069681168, 0.09192818403244019], [0.09137771278619766, 0.0913674607872963, 0.09115400910377502, 0.09134694933891296, 0.09113355726003647, 0.09132645279169083, 0.09184083342552185, 0.09110288321971893, 0.0864599421620369, 0.09154731780290604, 0.09134294092655182], [0.08948555588722229, 0.08951366692781448, 0.09010151773691177, 0.08956990391016006, 0.0901581272482872, 0.08962617814540863, 0.08822835981845856, 0.09024310857057571, 0.10447037220001221, 0.08902231603860855, 0.08958093076944351], [0.09211079031229019, 0.09208332002162933, 0.09151270985603333, 0.0920284166932106, 0.09145814180374146, 0.09197355061769485, 0.09335675835609436, 0.09137635678052902, 0.0795164555311203, 0.09256590157747269, 0.09201766550540924], [0.09939800202846527, 0.09897466748952866, 0.09055008739233017, 0.09813341498374939, 0.08978044241666794, 0.09729931503534317, 0.12047277390956879, 0.08863822370767593, 0.012121004052460194, 0.10666251927614212, 0.0979694351553917], [0.09060145169496536, 0.0906078964471817, 0.09074229747056961, 0.09062078595161438, 0.09075520187616348, 0.09063367545604706, 0.09031164646148682, 0.09077456593513489, 0.09383415430784225, 0.0904950425028801, 0.09062331169843674], [0.09132159501314163, 0.09131260216236115, 0.09112529456615448, 0.09129460901021957, 0.0911073386669159, 0.0912766233086586, 0.09172782301902771, 0.09108041971921921, 0.08699220418930054, 0.0914703980088234, 0.09129108488559723]], [[0.09013788402080536, 0.09226540476083755, 0.09067629277706146, 0.09159519523382187, 0.09156463295221329, 0.09058554470539093, 0.09150353074073792, 0.09052509814500809, 0.0898975282907486, 0.08986753225326538, 0.09138145297765732], [0.09151344746351242, 0.0898560881614685, 0.0910874754190445, 0.090370774269104, 0.09039440751075745, 0.09115894883871078, 0.09044169634580612, 0.0912066400051117, 0.0917050763964653, 0.0917290598154068, 0.09053633362054825], [0.09048895537853241, 0.09164619445800781, 0.09078297764062881, 0.09128297120332718, 0.09126637130975723, 0.09073348343372345, 0.09123319387435913, 0.09070049226284027, 0.09035743772983551, 0.09034101665019989, 0.09116687625646591], [0.09108350425958633, 0.09060434252023697, 0.09096094220876694, 0.09075380861759186, 0.09076065570116043, 0.09098152816295624, 0.09077435731887817, 0.09099526703357697, 0.09113850444555283, 0.09114538133144379, 0.09080176055431366], [0.09106381237506866, 0.09063868969678879, 0.09095509350299835, 0.09077132493257523, 0.09077740460634232, 0.09097336232662201, 0.0907895565032959, 0.09098554402589798, 0.09111259132623672, 0.0911186933517456, 0.09081387519836426], [0.09042993187904358, 0.09175010770559311, 0.09076512604951859, 0.0913354828953743, 0.09131654351949692, 0.09070868790149689, 0.09127868711948395, 0.09067107737064362, 0.09028004854917526, 0.09026133269071579, 0.09120301157236099], [0.09102445840835571, 0.09070742875337601, 0.09094341844320297, 0.09080637991428375, 0.09081091731786728, 0.09095703810453415, 0.09081998467445374, 0.0909661203622818, 0.0910608097910881, 0.09106535464525223, 0.09083811938762665], [0.09039057791233063, 0.09181942045688629, 0.09075320512056351, 0.09137048572301865, 0.09134998917579651, 0.09069213271141052, 0.09130899608135223, 0.09065144509077072, 0.09022846072912216, 0.09020821750164032, 0.09122708439826965], [0.08998049050569534, 0.09254392981529236, 0.09062805771827698, 0.09173508733510971, 0.09169822931289673, 0.09051886200904846, 0.09162455052137375, 0.09044612944126129, 0.089691661298275, 0.08965563029050827, 0.09147738665342331], [0.08996081352233887, 0.09257878363132477, 0.09062201529741287, 0.0917525663971901, 0.09171491861343384, 0.09051050990819931, 0.09163966774940491, 0.09043624997138977, 0.08966594189405441, 0.0896291509270668, 0.09148935973644257], [0.09094572067260742, 0.0908450037240982, 0.09092000126838684, 0.09087646752595901, 0.09087790548801422, 0.09092432260513306, 0.09088078886270523, 0.09092720597982407, 0.09095724672079086, 0.09095869213342667, 0.09088655561208725]], [[0.08818135410547256, 0.08889446407556534, 0.08810601383447647, 0.0888185054063797, 0.08803072571754456, 0.08874261379241943, 0.08989596366882324, 0.08866678178310394, 0.1114514097571373, 0.08956292271614075, 0.08964923769235611], [0.08924519270658493, 0.0896952748298645, 0.0891975611448288, 0.08964739739894867, 0.08914994448423386, 0.08959954231977463, 0.09032508730888367, 0.08955171704292297, 0.10330220311880112, 0.09011594206094742, 0.09017018228769302], [0.08806552737951279, 0.08880619704723358, 0.08798728138208389, 0.08872728794813156, 0.08790910989046097, 0.08864845335483551, 0.08984679728746414, 0.08856969326734543, 0.1123485416173935, 0.08950070291757584, 0.0895903930068016], [0.0891345962882042, 0.08961287885904312, 0.08908398449420929, 0.08956199139356613, 0.08903340250253677, 0.08951114118099213, 0.09028241038322449, 0.08946031332015991, 0.1041414886713028, 0.0900600403547287, 0.0901176929473877], [0.08794912695884705, 0.08871728926897049, 0.08786799013614655, 0.08863543719053268, 0.08778693526983261, 0.08855367451906204, 0.08979692310094833, 0.08847197145223618, 0.11325196921825409, 0.08943779766559601, 0.08953085541725159], [0.08902346342802048, 0.08952987194061279, 0.088969886302948, 0.08947598934173584, 0.0889163389801979, 0.08942214399576187, 0.09023905545473099, 0.0893683210015297, 0.10498679429292679, 0.09000349044799805, 0.09006457030773163], [0.09064509719610214, 0.09071987122297287, 0.09063716232776642, 0.09071192890405655, 0.09062923491001129, 0.09070399403572083, 0.09082397818565369, 0.0906960591673851, 0.0928446501493454, 0.09078947454690933, 0.09079843014478683], [0.08891179412603378, 0.08944626897573471, 0.08885525166988373, 0.0893893912434578, 0.08879874646663666, 0.08933254331350327, 0.09019504487514496, 0.08927574008703232, 0.10583815723657608, 0.08994628489017487, 0.09001077711582184], [0.1064244955778122, 0.09825519472360611, 0.10733047872781754, 0.09909162670373917, 0.10824417322874069, 0.09993518888950348, 0.08792427182197571, 0.10078593343496323, 0.010434702970087528, 0.09122056514024734, 0.09035340696573257], [0.0901913195848465, 0.09039159119129181, 0.09017009288072586, 0.090370312333107, 0.09014887362718582, 0.09034904092550278, 0.0906708836555481, 0.09032776951789856, 0.09619958698749542, 0.09057825803756714, 0.09060229361057281], [0.09031002223491669, 0.0904778316617012, 0.09029223769903183, 0.09046000242233276, 0.09027444571256638, 0.09044218063354492, 0.09071175009012222, 0.09042435884475708, 0.09531864523887634, 0.09063418954610825, 0.09065431356430054]]], "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"use_intrinsic_rewards": 1.0, "weights_seq_no": 78.0, "vf_loss": 0.3584531247615814, "policy_loss": 5.0932638259837404e-05, "vf_explained_var": 0.0015831589698791504, "total_loss": 0.2782518267631531, "diff_num_grad_updates_vs_sampler_policy": 66.0, "num_module_steps_trained": 35910, "entropy": 0.6821677684783936, "vf_loss_unclipped": 44.81155776977539, "module_train_batch_size_mean": 997.5020416990191, "num_module_steps_trained_lifetime": 466830, "mean_kl_loss": 1.7256975297641475e-06}, "intrinsic_reward_module": {"total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 66.0, "module_train_batch_size_mean": 997.5020416990191, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 466830, "weights_seq_no": 78.0}, "__all_modules__": {"num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 2574000, "num_module_steps_trained_lifetime": 933660, "num_env_steps_trained_lifetime_throughput": 50004.427106358205}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 155610, "num_env_steps_trained_lifetime": 429000, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime_throughput": 4328.314138088402, "num_module_steps_trained_throughput": 21834488.042266496, "num_module_steps_trained_lifetime_throughput": 13881504.316269962}, "intrinsic_reward_module": {"total_loss": 0.0, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "default_optimizer_learning_rate": 0.0002715581955, "module_train_batch_size_mean": 997.7269395717314, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 77805, "weights_seq_no": 13.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 784.7667149406257}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.096888948908051e-05, "module_to_env_connector": {"connector_pipeline_timer": 0.0001150129155524191, "timers": {"connectors": {"tensor_to_numpy": 1.525375212155453e-05, "normalize_and_clip_actions": 7.908325880505813e-06, "listify_data_for_vector_env": 1.0394664375499311e-05, "un_batch_to_individual_items": 6.646192757712058e-06, "remove_single_ts_time_rank_from_batch": 1.2027077418444848e-05, "get_actions": 3.6079618046393535e-05}}}, "agent_episode_returns_mean": {"default_agent": -1.1}, "env_step_timer": 1.3772209265500393e-05, "env_reset_timer": 0.00017993548878367246, "env_to_module_connector": {"connector_pipeline_timer": 5.9449833125859485e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.030351727704236e-06, "add_observations_from_episodes_to_batch": 2.857240103358432e-06, "add_states_from_episodes_to_batch": 2.767079153964965e-06, "numpy_to_tensor": 1.1901021495273838e-05, "batch_individual_items": 1.237622323892008e-05}}}, "sample": 0.1159738889457594, "episode_return_max": 13.5, "episode_len_mean": 20.0, "episode_len_max": 20, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "episode_duration_sec_mean": 0.0053660050325561315, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": -1.1}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled_lifetime": 65400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 13.0, "episode_return_min": -15.5, "num_env_steps_sampled": 400, "num_episodes_lifetime": 260, "num_episodes": 20, "episode_return_mean": -1.1, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "time_between_sampling": 9.375474397407686}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "b1709_00000", "date": "2025-08-11_18-34-41", "timestamp": 1754930081, "time_this_iter_s": 9.625779151916504, "time_total_s": 126.8064193725586, "pid": 11351, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3845f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 126.8064193725586, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 41.75, "ram_util_percent": 80.15714285714286}}
{"timers": {"training_iteration": 9.122161045449955, "restore_env_runners": 1.1999437609167522e-05, "training_step": 9.122017904586238, "env_runner_sampling_timer": 1.6270290576785245, "learner_update_timer": 7.321185998697836, "synch_weights": 0.0008541628610009466, "restore_eval_env_runners": 9.69687467037375e-06, "evaluation_iteration": 0.12315436805450775, "synch_eval_env_connectors": 0.00013787633113195992, "synch_env_connectors": 4.539533533101858e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00011604375367789607, "timers": {"connectors": {"un_batch_to_individual_items": 6.571356270742378e-06, "tensor_to_numpy": 1.4941409945168042e-05, "remove_single_ts_time_rank_from_batch": 1.178898970863259e-05, "normalize_and_clip_actions": 7.844952064482883e-06, "get_actions": 3.850913737108589e-05, "listify_data_for_vector_env": 1.031655326596543e-05}}}, "time_between_sampling": 0.03188159884154575, "episode_duration_sec_mean": 0.005567366022150962, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -7400000.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.840282255463406e-06, "add_time_dim_to_batch_and_zero_pad": 6.782920671483785e-06, "numpy_to_tensor": 1.2517006236257068e-05, "add_states_from_episodes_to_batch": 2.6406798480394672e-06, "batch_individual_items": 1.2243997319718876e-05}}, "connector_pipeline_timer": 5.885469097755441e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "agent_episode_returns_mean": {"default_agent": -2.2199999999999998}, "weights_seq_no": 13.0, "module_episode_returns_mean": {"default_policy": -2.2199999999999998}, "episode_return_min": -13.5, "num_env_steps_sampled": 5000.0, "num_episodes_lifetime": -370000.0, "rlmodule_inference_timer": 5.2657902226871156e-05, "episode_len_mean": 20.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "num_episodes": 250.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.3827691460165882e-05, "episode_return_mean": -2.2199999999999998, "env_reset_timer": 4.480786915916035e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "sample": 0.006016400862025216, "episode_return_max": 6.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3271.9093636663274}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13505980112841046, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009364739598383768, "add_observations_from_episodes_to_batch": 0.0008370363363079565, "add_columns_from_episodes_to_train_batch": 0.04113679343296551, "add_time_dim_to_batch_and_zero_pad": 0.07562263541217615, "add_states_from_episodes_to_batch": 0.00369236043689491, "batch_individual_items": 0.004172653639052945, "numpy_to_tensor": 7.423719570090687e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "policy_loss": -0.00048653618432581425, "use_intrinsic_rewards": 0.0, "weights_seq_no": 14.0, "vf_explained_var": -0.00018274784088134766, "num_trainable_parameters": 16595, "vf_loss": 0.35830700397491455, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 9.862300430540927e-06, "num_module_steps_trained": 5985, "total_loss": 0.2776029109954834, "module_train_batch_size_mean": 997.7135120670981, "num_module_steps_trained_lifetime": 83790, "entropy": 0.6804404854774475, "vf_loss_unclipped": 44.019561767578125, "mean_kl_loss": 6.253264291444793e-05, "num_module_steps_trained_lifetime_throughput": 780.4549150835911}, "IntrinsicAttentionMask": [[[0.0901918038725853, 0.09171119332313538, 0.09073054045438766, 0.0922589972615242, 0.09161940962076187, 0.09063974022865295, 0.09155827015638351, 0.08998133987188339, 0.08995130658149719, 0.08992129564285278, 0.09143612533807755], [0.09110763669013977, 0.09068681299686432, 0.0909573957324028, 0.09053726494312286, 0.09071198105812073, 0.09098263829946518, 0.090728759765625, 0.09116663783788681, 0.09117507189512253, 0.09118350595235825, 0.09076233208179474], [0.0905185416340828, 0.09134601801633835, 0.09081266075372696, 0.0916428342461586, 0.09129621833562851, 0.0907631441950798, 0.09126302599906921, 0.09040341526269913, 0.09038698673248291, 0.0903705507516861, 0.09119667857885361], [0.0914335623383522, 0.09032164514064789, 0.0910356193780899, 0.089928537607193, 0.09038790315389633, 0.09110240638256073, 0.09043210744857788, 0.09159015119075775, 0.09161254018545151, 0.09163493663072586, 0.09052057564258575], [0.09105280041694641, 0.09074819833040237, 0.09094409644603729, 0.0906398594379425, 0.09076642245054245, 0.09096235781908035, 0.09077858179807663, 0.09109547734260559, 0.09110157191753387, 0.09110767394304276, 0.09080289304256439], [0.09046361595392227, 0.091407410800457, 0.09079894423484802, 0.09174623340368271, 0.09135056287050247, 0.09074247628450394, 0.09131269156932831, 0.09033241122961044, 0.09031368046998978, 0.09029495716094971, 0.09123699367046356], [0.0910162478685379, 0.09078913182020187, 0.09093522280454636, 0.09070830792188644, 0.09080273658037186, 0.09094884246587753, 0.09081179648637772, 0.09104805439710617, 0.0910525992512703, 0.09105714410543442, 0.09082993119955063], [0.09006355702877045, 0.09185443818569183, 0.09069794416427612, 0.0925014391541481, 0.09174610674381256, 0.09059097617864609, 0.09167395532131195, 0.0898158997297287, 0.08978057652711868, 0.08974526822566986, 0.09152982383966446], [0.09004523605108261, 0.09187491238117218, 0.09069327265024185, 0.09253611415624619, 0.09176421165466309, 0.09058399498462677, 0.09169048070907593, 0.08979228138923645, 0.08975619822740555, 0.08972013741731644, 0.09154320508241653], [0.09002690017223358, 0.09189536422491074, 0.09068858623504639, 0.09257078170776367, 0.09178229421377182, 0.09057699888944626, 0.09170699119567871, 0.08976864069700241, 0.08973181247711182, 0.08969499170780182, 0.09155657142400742], [0.09094312787055969, 0.09087099134922028, 0.09091740846633911, 0.09084529429674149, 0.09087531268596649, 0.09092172980308533, 0.0908781960606575, 0.09095321595668793, 0.09095465391874313, 0.09095609933137894, 0.09088396281003952]], [[0.09164264053106308, 0.09205562621355057, 0.09159892052412033, 0.0920116975903511, 0.09155520796775818, 0.0915333703160286, 0.09263315796852112, 0.09148970246315002, 0.08147181570529938, 0.09200475364923477, 0.09200309962034225], [0.09116023033857346, 0.09129456430673599, 0.09114598482847214, 0.09128030389547348, 0.09113173931837082, 0.09112461656332016, 0.0914817526936531, 0.09111037850379944, 0.08771491050720215, 0.09127804636955261, 0.09127750247716904], [0.0916912853717804, 0.09213405102491379, 0.09164442121982574, 0.09208695590496063, 0.09159757941961288, 0.09157416224479675, 0.09275347739458084, 0.09152735024690628, 0.08083346486091614, 0.0920795127749443, 0.09207773208618164], [0.09121353179216385, 0.09137726575136185, 0.09119617193937302, 0.09135987609624863, 0.09117881208658218, 0.09117013216018677, 0.09160550683736801, 0.09115277975797653, 0.08703232556581497, 0.09135712683200836, 0.09135647118091583], [0.0917394608259201, 0.09221205115318298, 0.09168944507837296, 0.09216177463531494, 0.0916394516825676, 0.09161446988582611, 0.09287344664335251, 0.09156452119350433, 0.08019968867301941, 0.09215381741523743, 0.09215192496776581], [0.09176336228847504, 0.09225086867809296, 0.09171176701784134, 0.09219900518655777, 0.09166020154953003, 0.09163443744182587, 0.092933289706707, 0.09158291667699814, 0.07988448441028595, 0.09219080209732056, 0.09218885004520416], [0.09041359275579453, 0.09016678482294083, 0.0904398262500763, 0.09019295126199722, 0.09046606719493866, 0.09047918766736984, 0.0898246243596077, 0.0905054360628128, 0.09711634367704391, 0.09019709378480911, 0.0901980772614479], [0.09181082248687744, 0.09232821315526962, 0.09175607562065125, 0.09227316081523895, 0.09170135855674744, 0.09167402237653732, 0.09305272996425629, 0.09161935746669769, 0.07925749570131302, 0.09226445108652115, 0.0922623798251152], [0.09459709376096725, 0.10284630209207535, 0.09376134723424911, 0.1019376814365387, 0.09293299168348312, 0.09252157062292099, 0.11553018540143967, 0.09170416742563248, 0.01061346847563982, 0.10179463028907776, 0.10176060348749161], [0.09122192114591599, 0.09139031171798706, 0.09120406955480576, 0.09137242287397385, 0.09118621796369553, 0.09117729216814041, 0.09162505716085434, 0.09115944802761078, 0.08692474663257599, 0.09136959165334702, 0.09136892110109329], [0.09122391790151596, 0.09139341861009598, 0.09120594710111618, 0.09137541800737381, 0.0911879763007164, 0.0911789983510971, 0.09162971377372742, 0.09116103500127792, 0.08689916133880615, 0.09137256443500519, 0.09137188643217087]], [[0.09019195288419724, 0.09171134233474731, 0.09013176709413528, 0.09165014326572418, 0.09161955863237381, 0.09063988924026489, 0.09216681867837906, 0.09057940542697906, 0.08995146304368973, 0.08992144465446472, 0.09143627434968948], [0.09110765159130096, 0.09068682789802551, 0.0911245048046112, 0.09070360660552979, 0.09071199595928192, 0.09098265320062637, 0.09056240320205688, 0.09099948406219482, 0.09117508679628372, 0.09118352085351944, 0.09076234698295593], [0.09015532582998276, 0.09175227582454681, 0.09009209275245667, 0.09168793261051178, 0.09165576845407486, 0.09062597900629044, 0.09223127365112305, 0.09056242555379868, 0.08990267664194107, 0.08987114578485489, 0.09146306663751602], [0.09107109159231186, 0.09072774648666382, 0.09108483046293259, 0.09074144065380096, 0.09074829518795013, 0.09096913039684296, 0.09062618017196655, 0.09098286926746368, 0.09112608432769775, 0.09113296121358871, 0.09078938513994217], [0.09105280786752701, 0.09074820578098297, 0.09106499701738358, 0.09076035767793655, 0.09076642990112305, 0.09096236526966095, 0.09065807610750198, 0.09097454696893692, 0.09110157936811447, 0.09110768139362335, 0.09080290049314499], [0.09046367555856705, 0.09140746295452118, 0.09042616933584213, 0.09136956930160522, 0.09135062247514725, 0.09074253588914871, 0.09168923646211624, 0.09070491045713425, 0.09031373262405396, 0.09029500931501389, 0.09123704582452774], [0.09137885272502899, 0.09038310497999191, 0.09141886234283447, 0.09042268246412277, 0.0904424786567688, 0.09108242392539978, 0.09008990973234177, 0.09112230688333511, 0.09153901040554047, 0.09155905246734619, 0.09056133776903152], [0.09042707830667496, 0.09144841879606247, 0.09038650989532471, 0.09140738844871521, 0.09138687700033188, 0.090728759765625, 0.0917535051703453, 0.09068804979324341, 0.09026490151882172, 0.09024465084075928, 0.09126392751932144], [0.09004544466733932, 0.09187512844800949, 0.0899730995297432, 0.09180130809545517, 0.0917644277215004, 0.09058420360088348, 0.09242483228445053, 0.09051142632961273, 0.08975641429424286, 0.08972034603357315, 0.09154342114925385], [0.09002713114023209, 0.09189560264348984, 0.08995326608419418, 0.09182020276784897, 0.09178253263235092, 0.09057722985744476, 0.092457115650177, 0.09050291776657104, 0.08973204344511032, 0.08969522267580032, 0.09155680239200592], [0.09094313532114029, 0.09087099879980087, 0.0909460186958313, 0.09087388217449188, 0.09087532013654709, 0.09092173725366592, 0.0908496230840683, 0.09092462062835693, 0.09095466136932373, 0.09095610678195953, 0.09088397026062012]], [[0.08971771597862244, 0.08923570811748505, 0.08967135101556778, 0.08964817970991135, 0.0891665443778038, 0.08914350718259811, 0.0907684937119484, 0.08955555409193039, 0.1028369888663292, 0.09010174125432968, 0.0901542380452156], [0.08881968259811401, 0.08801626414060593, 0.08874227851629257, 0.08870360255241394, 0.08790122717618942, 0.08786291629076004, 0.09058144688606262, 0.08854905515909195, 0.11181175708770752, 0.08946193009614944, 0.08954986184835434], [0.08963443338871002, 0.08912122994661331, 0.08958505839109421, 0.08956038951873779, 0.08904761075973511, 0.08902308344841003, 0.09075385332107544, 0.08946175873279572, 0.10366973280906677, 0.09004345536231995, 0.09009937196969986], [0.0895925760269165, 0.08906380832195282, 0.08954169601202011, 0.08951627463102341, 0.08898795396089554, 0.08896268904209137, 0.09074628353118896, 0.08941464871168137, 0.10408834367990494, 0.09001407027244568, 0.09007170051336288], [0.08868484199047089, 0.08783585578203201, 0.08860302716493607, 0.08856214582920074, 0.08771434426307678, 0.0876738652586937, 0.0905480831861496, 0.08839881420135498, 0.11315833777189255, 0.08936383575201035, 0.08945682644844055], [0.08863957971334457, 0.08777545392513275, 0.08855629712343216, 0.08851468563079834, 0.08765177428722382, 0.08761058002710342, 0.09053660929203033, 0.08834843337535858, 0.11361033469438553, 0.08933080732822418, 0.0894254744052887], [0.09143950790166855, 0.09167848527431488, 0.09146241098642349, 0.09147386252880096, 0.09171292930841446, 0.09172441810369492, 0.09092506766319275, 0.09151969105005264, 0.08558846265077591, 0.0912504568696022, 0.09122470766305923], [0.08942358940839767, 0.08883272856473923, 0.08936672657728195, 0.08933830261230469, 0.0887480080127716, 0.08871978521347046, 0.090714231133461, 0.08922471851110458, 0.10577768832445145, 0.08989488333463669, 0.08995934575796127], [0.09852389246225357, 0.10762400925159454, 0.09936262667179108, 0.09978465735912323, 0.10900121182203293, 0.10946419090032578, 0.08139705657958984, 0.1014908030629158, 0.010507666505873203, 0.09185854345560074, 0.09098532050848007], [0.09038305282592773, 0.09016157686710358, 0.09036177396774292, 0.09035114198923111, 0.09012974798679352, 0.0901191383600235, 0.09086363762617111, 0.09030861407518387, 0.09617918729782104, 0.09055904299020767, 0.09058307111263275], [0.09047067910432816, 0.09028510004281998, 0.09045284986495972, 0.09044394642114639, 0.09025841951370239, 0.09024952352046967, 0.0908731147646904, 0.0904083102941513, 0.09530172497034073, 0.09061809629201889, 0.09063821285963058]], [[0.09052335470914841, 0.09160710871219635, 0.09052826464176178, 0.09127798676490784, 0.09126294404268265, 0.09048352390527725, 0.09123287349939346, 0.09045371413230896, 0.09043881297111511, 0.0907200500369072, 0.0914713591337204], [0.09196076542139053, 0.08901803195476532, 0.09194714576005936, 0.08989793062210083, 0.08993842452764511, 0.09207143634557724, 0.09001945704221725, 0.09215439110994339, 0.09219589829444885, 0.09141691774129868, 0.08937951922416687], [0.0905299186706543, 0.09159521758556366, 0.0905347391963005, 0.09127172082662582, 0.09125693887472153, 0.09049075841903687, 0.09122738242149353, 0.09046145528554916, 0.09044679999351501, 0.09072328358888626, 0.09146179258823395], [0.09152677655220032, 0.0897962898015976, 0.0915188193321228, 0.09031616896390915, 0.0903400331735611, 0.09159141033887863, 0.09038779884576797, 0.09163983166217804, 0.09166405349969864, 0.09120870381593704, 0.0900101289153099], [0.09150688350200653, 0.08983201533555984, 0.09149918705224991, 0.09033528715372086, 0.09035839140415192, 0.09156941622495651, 0.09040462225675583, 0.09161627292633057, 0.09163970500230789, 0.0911991149187088, 0.09003902971744537], [0.0904700756072998, 0.09170372039079666, 0.0904756560921669, 0.09132886677980423, 0.0913117378950119, 0.09042476862668991, 0.09127750247716904, 0.09039086103439331, 0.0903739184141159, 0.09069381654262543, 0.0915490910410881], [0.09146711975336075, 0.08990350365638733, 0.09145993739366531, 0.09037354588508606, 0.09039513021707535, 0.09152546525001526, 0.09043829143047333, 0.09156917035579681, 0.09159103780984879, 0.09117993712425232, 0.09009687602519989], [0.09043017029762268, 0.09177610278129578, 0.09043625742197037, 0.0913669541478157, 0.09134826809167862, 0.09038077294826508, 0.09131090342998505, 0.09034381061792374, 0.09032532572746277, 0.09067416191101074, 0.09160730242729187], [0.09041021764278412, 0.09181230515241623, 0.0904165506362915, 0.09138599038124084, 0.09136652201414108, 0.09035877883434296, 0.09132759273052216, 0.09032028168439865, 0.0903010442852974, 0.0906643271446228, 0.09163641184568405], [0.09078601747751236, 0.09113156795501709, 0.09078758209943771, 0.0910269245505333, 0.09102214127779007, 0.09077326208353043, 0.09101255983114243, 0.09076371043920517, 0.09075893461704254, 0.09084893763065338, 0.0910884365439415], [0.09178202599287033, 0.08933818340301514, 0.09177074581384659, 0.09007033705711365, 0.09010399132966995, 0.09187367558479309, 0.09017135202884674, 0.09194235503673553, 0.09197671711444855, 0.09133139252662659, 0.08963911980390549]], [[0.08839630335569382, 0.08911114931106567, 0.0883207693696022, 0.08828302472829819, 0.08824530243873596, 0.08820758759975433, 0.09088267385959625, 0.0888829156756401, 0.11077950894832611, 0.08902296423912048, 0.08986776322126389], [0.08937828987836838, 0.08982904255390167, 0.08933058381080627, 0.08930674195289612, 0.08928290009498596, 0.0892590656876564, 0.09094027429819107, 0.08968526870012283, 0.10290967673063278, 0.0897735133767128, 0.0903046578168869], [0.08828926086425781, 0.08903180807828903, 0.0882108137011528, 0.08817160874605179, 0.08813243359327316, 0.08809327334165573, 0.09087300300598145, 0.08879470080137253, 0.11164496839046478, 0.08894018828868866, 0.08981800079345703], [0.0882355272769928, 0.08899190276861191, 0.08815561980009079, 0.08811569958925247, 0.08807579427957535, 0.08803590387105942, 0.09086789190769196, 0.08875036239624023, 0.11207989603281021, 0.08889856934547424, 0.08979286253452301], [0.08818164467811584, 0.08895183354616165, 0.08810029178857803, 0.08805964142084122, 0.08801901340484619, 0.08797840029001236, 0.09086260944604874, 0.0887058675289154, 0.11251629143953323, 0.0888567864894867, 0.08976756036281586], [0.08812764286994934, 0.08891162276268005, 0.08804484456777573, 0.08800347149372101, 0.08796211332082748, 0.08792078495025635, 0.09085717052221298, 0.08866123855113983, 0.11295419186353683, 0.0888148695230484, 0.08974209427833557], [0.09158503264188766, 0.09136917442083359, 0.0916079729795456, 0.09161944687366486, 0.09163092076778412, 0.09164239466190338, 0.09084375202655792, 0.09143785387277603, 0.08572468161582947, 0.09139568358659744, 0.09114313125610352], [0.08907079696655273, 0.08960622549057007, 0.08901415020227432, 0.08898584544658661, 0.08895754814147949, 0.08892925828695297, 0.09092842042446136, 0.0894353836774826, 0.10536038130521774, 0.08954022824764252, 0.09017175436019897], [0.10409414768218994, 0.09641022235155106, 0.10494481772184372, 0.10537275671958923, 0.10580243915319443, 0.1062338724732399, 0.07993359118700027, 0.09879322350025177, 0.012137935496866703, 0.09732337296009064, 0.0889536440372467], [0.08926013112068176, 0.08974364399909973, 0.08920896798372269, 0.08918340504169464, 0.0891578420996666, 0.08913227915763855, 0.09093640744686127, 0.08958940953016281, 0.10384982824325562, 0.08968406170606613, 0.09025401622056961], [0.09035872668027878, 0.09052661806344986, 0.09034092724323273, 0.0903320237994194, 0.09032312780618668, 0.09031423181295395, 0.0909382700920105, 0.09047312289476395, 0.09518379718065262, 0.09050596505403519, 0.09070319682359695]]], "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"use_intrinsic_rewards": 1.0, "weights_seq_no": 84.0, "vf_loss": 0.35844317078590393, "policy_loss": -0.00047407663078047335, "vf_explained_var": 0.0016286373138427734, "total_loss": 0.2777310013771057, "diff_num_grad_updates_vs_sampler_policy": 71.0, "num_module_steps_trained": 35910, "entropy": 0.6804822087287903, "vf_loss_unclipped": 43.93838882446289, "module_train_batch_size_mean": 997.5006590853257, "num_module_steps_trained_lifetime": 502740, "mean_kl_loss": 5.962377326795831e-05}, "intrinsic_reward_module": {"total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 71.0, "module_train_batch_size_mean": 997.5006590853257, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 502740, "weights_seq_no": 84.0}, "__all_modules__": {"num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 2772000, "num_module_steps_trained_lifetime": 1005480, "num_env_steps_trained_lifetime_throughput": 49158.15362748361}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 167580, "num_env_steps_trained_lifetime": 462000, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime_throughput": 4304.5325553373605, "num_module_steps_trained_throughput": 21295590.40131678, "num_module_steps_trained_lifetime_throughput": 13769711.728897642}, "intrinsic_reward_module": {"total_loss": 0.0, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "default_optimizer_learning_rate": 0.0002715581955, "module_train_batch_size_mean": 997.7135120670981, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 83790, "weights_seq_no": 14.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 780.4622983178624}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.111157619354121e-05, "module_to_env_connector": {"connector_pipeline_timer": 0.00011530343775194837, "timers": {"connectors": {"tensor_to_numpy": 1.5325661946689915e-05, "normalize_and_clip_actions": 8.062144526992577e-06, "listify_data_for_vector_env": 1.0497331421443376e-05, "un_batch_to_individual_items": 6.634747010156732e-06, "remove_single_ts_time_rank_from_batch": 1.2046935741795125e-05, "get_actions": 3.602516238669339e-05}}}, "agent_episode_returns_mean": {"default_agent": -1.5}, "env_step_timer": 1.4115052203517003e-05, "env_reset_timer": 0.0001811898835744922, "env_to_module_connector": {"connector_pipeline_timer": 6.006187585923483e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.15273396525747e-06, "add_observations_from_episodes_to_batch": 2.812429461229023e-06, "add_states_from_episodes_to_batch": 2.7881024744528584e-06, "numpy_to_tensor": 1.20846870644303e-05, "batch_individual_items": 1.2547830813457373e-05}}}, "sample": 0.11598590588659347, "episode_return_max": 13.5, "episode_len_mean": 20.0, "episode_len_max": 20, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "episode_duration_sec_mean": 0.005371445383643731, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": -1.5}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled_lifetime": 70400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 14.0, "episode_return_min": -15.5, "num_env_steps_sampled": 400, "num_episodes_lifetime": 280, "num_episodes": 20, "episode_return_mean": -1.5, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "time_between_sampling": 9.388744920102834}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "b1709_00000", "date": "2025-08-11_18-34-52", "timestamp": 1754930092, "time_this_iter_s": 10.800434827804565, "time_total_s": 137.60685420036316, "pid": 11351, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3845f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 137.60685420036316, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 51.60666666666666, "ram_util_percent": 81.36}}
{"timers": {"training_iteration": 9.128894644585019, "restore_env_runners": 1.1941522867593277e-05, "training_step": 9.128750192630593, "env_runner_sampling_timer": 1.62642112419178, "learner_update_timer": 7.328444720791165, "synch_weights": 0.0008609291522117078, "restore_eval_env_runners": 9.971996067752916e-06, "evaluation_iteration": 0.12318157562336915, "synch_eval_env_connectors": 0.00013836589869418932, "synch_env_connectors": 4.592888658663755e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00011930190167986925, "timers": {"connectors": {"un_batch_to_individual_items": 6.676066037105891e-06, "tensor_to_numpy": 1.5337920645493196e-05, "remove_single_ts_time_rank_from_batch": 1.1969555935165023e-05, "normalize_and_clip_actions": 8.03368685706855e-06, "get_actions": 4.012629624778641e-05, "listify_data_for_vector_env": 1.0500418166756018e-05}}}, "time_between_sampling": 0.036935607611956515, "episode_duration_sec_mean": 0.00533400183264166, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -8017500.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.857331569576261e-06, "add_time_dim_to_batch_and_zero_pad": 6.910322260673432e-06, "numpy_to_tensor": 1.275524885460643e-05, "add_states_from_episodes_to_batch": 2.698284005297106e-06, "batch_individual_items": 1.2507906196362367e-05}}, "connector_pipeline_timer": 5.9959972632845595e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "agent_episode_returns_mean": {"default_agent": -2.7799999999999994}, "weights_seq_no": 14.0, "module_episode_returns_mean": {"default_policy": -2.7799999999999994}, "episode_return_min": -13.5, "num_env_steps_sampled": 5000.0, "num_episodes_lifetime": -400875.0, "rlmodule_inference_timer": 3.216988545358992e-05, "episode_len_mean": 20.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "num_episodes": 250.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.4177953988243316e-05, "episode_return_mean": -2.7799999999999994, "env_reset_timer": 4.361926425665207e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "sample": 0.005927193448543232, "episode_return_max": 6.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3210.356242558931}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13503808144649468, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009362003033167756, "add_observations_from_episodes_to_batch": 0.0008374547220548306, "add_columns_from_episodes_to_train_batch": 0.04113214216947683, "add_time_dim_to_batch_and_zero_pad": 0.07560821197771042, "add_states_from_episodes_to_batch": 0.003693616832209013, "batch_individual_items": 0.0041715633527131535, "numpy_to_tensor": 7.418649373700035e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "policy_loss": -5.276361480355263e-05, "use_intrinsic_rewards": 0.0, "weights_seq_no": 15.0, "vf_explained_var": -0.0008745193481445312, "num_trainable_parameters": 16595, "vf_loss": 0.3583086431026459, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 4.931150215270463e-06, "num_module_steps_trained": 5985, "total_loss": 0.27803874015808105, "module_train_batch_size_mean": 997.7008703380301, "num_module_steps_trained_lifetime": 89775, "entropy": 0.6799132227897644, "vf_loss_unclipped": 46.11508560180664, "mean_kl_loss": 9.550030881655402e-06, "num_module_steps_trained_lifetime_throughput": 776.2120849224538}, "IntrinsicAttentionMask": [[[0.09002742916345596, 0.09215234965085983, 0.09056518226861954, 0.09209086000919342, 0.09206012636423111, 0.08987732231616974, 0.09199869632720947, 0.0898173451423645, 0.08978737890720367, 0.0903538390994072, 0.09126948565244675], [0.09159860014915466, 0.08993969857692719, 0.0911722332239151, 0.08998674154281616, 0.09001027792692184, 0.09171843528747559, 0.0900573581457138, 0.09176640957593918, 0.09179040789604187, 0.09133925288915634, 0.09062057733535767], [0.09042903035879135, 0.09158550947904587, 0.09072286635637283, 0.09155221283435822, 0.09153556823730469, 0.09034687280654907, 0.09150229394435883, 0.09031402319669724, 0.09029760956764221, 0.09060748666524887, 0.09110650420188904], [0.09155373275279999, 0.09000272303819656, 0.0911552682518959, 0.09004674106836319, 0.0900687500834465, 0.09166570007801056, 0.09011279791593552, 0.09171052277088165, 0.0917329490184784, 0.09131138026714325, 0.09063954651355743], [0.09153129160404205, 0.09003423154354095, 0.09114676713943481, 0.09007672965526581, 0.09009798616170883, 0.09163933247327805, 0.09014050662517548, 0.09168257564306259, 0.09170421212911606, 0.09129742532968521, 0.09064900875091553], [0.08991484344005585, 0.09231142699718475, 0.09052066504955292, 0.09224197268486023, 0.09220726788043976, 0.08974581211805344, 0.0921378955245018, 0.08967828750610352, 0.08964454382658005, 0.09028251469135284, 0.09131482243537903], [0.09148639440536499, 0.09009727090597153, 0.09112975746393204, 0.09013672173023224, 0.0901564508676529, 0.09158658236265182, 0.09019593894481659, 0.09162668883800507, 0.09164674580097198, 0.09126950055360794, 0.09066792577505112], [0.08986979722976685, 0.09237508475780487, 0.09050282090902328, 0.09230244159698486, 0.09226613491773605, 0.08969321101903915, 0.09219358116388321, 0.08962267637252808, 0.08958742767572403, 0.09025395661592484, 0.09133291244506836], [0.08984726667404175, 0.09240691363811493, 0.09049388021230698, 0.09233267605304718, 0.0922955721616745, 0.08966691046953201, 0.09222141653299332, 0.08959486335515976, 0.08955886214971542, 0.09023965895175934, 0.09134194254875183], [0.09027152508497238, 0.09180772304534912, 0.09066122770309448, 0.09176340699195862, 0.09174125641584396, 0.09016262739896774, 0.09169697016477585, 0.09011910855770111, 0.0900973528623581, 0.09050814807415009, 0.09117066115140915], [0.09095092117786407, 0.09085020422935486, 0.0909252017736435, 0.09085308760404587, 0.09085452556610107, 0.0909581258893013, 0.09085740894079208, 0.09096100926399231, 0.09096245467662811, 0.09093528240919113, 0.0908917561173439]], [[0.08980634063482285, 0.08932385593652725, 0.08930078148841858, 0.08973673731088638, 0.08971354365348816, 0.08969036489725113, 0.09085816144943237, 0.08918546140193939, 0.10241202265024185, 0.08972939848899841, 0.09024330228567123], [0.08897392451763153, 0.08816911280155182, 0.08813069015741348, 0.08885763585567474, 0.08881891518831253, 0.08878020197153091, 0.09073875099420547, 0.08793879300355911, 0.11104119569063187, 0.0888453796505928, 0.08970537781715393], [0.08893238753080368, 0.08811230957508087, 0.08807314932346344, 0.0888138860464096, 0.0887744203209877, 0.08873496949672699, 0.0907311886548996, 0.08787764608860016, 0.11147074401378632, 0.08880139142274857, 0.0896778404712677], [0.08969040215015411, 0.08916105329990387, 0.08913572877645493, 0.08961401879787445, 0.08958856761455536, 0.08956313878297806, 0.09084536880254745, 0.08900925517082214, 0.10361643880605698, 0.08960596472024918, 0.09017004817724228], [0.08965147286653519, 0.08910654485225677, 0.08908048272132874, 0.08957283943891525, 0.08954664319753647, 0.08952045440673828, 0.09084079414606094, 0.08895029127597809, 0.10402069240808487, 0.08956454694271088, 0.09014533460140228], [0.08961240202188492, 0.08905188739299774, 0.0890250876545906, 0.08953151106834412, 0.08950456231832504, 0.08947762101888657, 0.09083603322505951, 0.08889119327068329, 0.1044263169169426, 0.08952298015356064, 0.09012044966220856], [0.09139929711818695, 0.09163817018270493, 0.09164965152740479, 0.09143363684415817, 0.09144508838653564, 0.09145653992891312, 0.09088508784770966, 0.09170705080032349, 0.08576368540525436, 0.09143726527690887, 0.091184601187706], [0.08872246742248535, 0.08782634139060974, 0.087783582508564, 0.08859293162822723, 0.08854979276657104, 0.08850667625665665, 0.09069083631038666, 0.08757007867097855, 0.11364033818244934, 0.08857927471399307, 0.08953773230314255], [0.09760797768831253, 0.10624859482049942, 0.10668185353279114, 0.09880691766738892, 0.09920982271432877, 0.09961437433958054, 0.08125664293766022, 0.10887477546930313, 0.012338843196630478, 0.09893426299095154, 0.0904259905219078], [0.089678093791008, 0.08914381265640259, 0.08911826461553574, 0.08960100263357162, 0.08957532048225403, 0.08954963833093643, 0.09084393829107285, 0.08899060636758804, 0.10374423861503601, 0.08959287405014038, 0.0901622474193573], [0.09050352871417999, 0.09031788259744644, 0.09030898660421371, 0.09047678858041763, 0.09046787023544312, 0.0904589593410492, 0.09090612083673477, 0.09026451408863068, 0.09515015035867691, 0.0904739648103714, 0.0906711295247078]], [[0.09008222073316574, 0.09220843762159348, 0.09062030166387558, 0.09153864532709122, 0.09211616218090057, 0.08993202447891235, 0.09144703298807144, 0.09046920388936996, 0.08984202146530151, 0.08981204032897949, 0.09193187952041626], [0.09155575931072235, 0.08989763259887695, 0.09112958610057831, 0.09041255712509155, 0.08996817469596863, 0.0916755348443985, 0.09048350900411606, 0.09124880284070969, 0.0917474776506424, 0.09177146852016449, 0.0901094377040863], [0.09045886993408203, 0.09161572903394699, 0.09075279533863068, 0.09125261753797531, 0.09156577289104462, 0.09037668257951736, 0.09120286256074905, 0.09067033976316452, 0.09032739698886871, 0.0903109759092331, 0.09146595001220703], [0.09109582751989365, 0.09061659872531891, 0.09097325056791306, 0.09076608717441559, 0.09063711762428284, 0.09113020449876785, 0.0907866358757019, 0.09100757539272308, 0.09115083515644073, 0.0911577120423317, 0.0906781554222107], [0.09149263054132462, 0.08999621123075485, 0.09110826998949051, 0.09046120196580887, 0.09005992859601974, 0.09160061925649643, 0.09052525460720062, 0.09121580421924591, 0.09166547656059265, 0.09168710559606552, 0.09018750488758087], [0.08997663855552673, 0.09237487614154816, 0.09058288484811783, 0.0916186198592186, 0.09227064251899719, 0.08980749547481537, 0.09151524305343628, 0.09041259437799454, 0.08970616012811661, 0.08967240899801254, 0.09206253290176392], [0.09103260934352875, 0.09071555733680725, 0.09095156937837601, 0.09081452339887619, 0.09072914719581604, 0.09105533361434937, 0.09082812070846558, 0.09097427129745483, 0.09106896817684174, 0.09107351303100586, 0.09075631946325302], [0.0903533548116684, 0.0917816162109375, 0.09071584045886993, 0.09133286774158478, 0.091719850897789, 0.09025204181671143, 0.09127140790224075, 0.09061412513256073, 0.0901913121342659, 0.09017107635736465, 0.09159645438194275], [0.0899132564663887, 0.0924747884273529, 0.09056034684181213, 0.09166654944419861, 0.09236336499452591, 0.08973277360200882, 0.09155610203742981, 0.09037856012582779, 0.08962465077638626, 0.08958864212036133, 0.09214092046022415], [0.08989214152097702, 0.09250811487436295, 0.09055283665657043, 0.09168253093957901, 0.09239429235458374, 0.0897078737616539, 0.09156972169876099, 0.09036721289157867, 0.08959749341011047, 0.08956073224544525, 0.09216706454753876], [0.09136632084846497, 0.09019351005554199, 0.09106548130512238, 0.09055839478969574, 0.09024353325366974, 0.09145080298185349, 0.0906086266040802, 0.09114968031644821, 0.09150152653455734, 0.09151843935251236, 0.0903436690568924]], [[0.08980002254247665, 0.08931757509708405, 0.08975362032651901, 0.0892714262008667, 0.08924835175275803, 0.08922528475522995, 0.09085176885128021, 0.08917918056249619, 0.10293134301900864, 0.09018441289663315, 0.09023695439100266], [0.08895549923181534, 0.08815085142850876, 0.08887797594070435, 0.08807402849197388, 0.08803564310073853, 0.08799727261066437, 0.09071995317935944, 0.08792058378458023, 0.11198274046182632, 0.08959873020648956, 0.0896867960691452], [0.08972200006246567, 0.08920829743146896, 0.08967258036136627, 0.08915916085243225, 0.08913460373878479, 0.08911005407571793, 0.09084250777959824, 0.08906096965074539, 0.10377101600170135, 0.09013141691684723, 0.09018738567829132], [0.08887075632810593, 0.08803561329841614, 0.08879027515649796, 0.08795589208602905, 0.0879160612821579, 0.08787625283002853, 0.0907030999660492, 0.08779668062925339, 0.11288678646087646, 0.08953857421875, 0.08963002264499664], [0.08882813900709152, 0.08797778189182281, 0.08874618262052536, 0.08789661526679993, 0.08785606175661087, 0.08781552314758301, 0.09069439768791199, 0.08773451298475266, 0.11334118992090225, 0.08950822800397873, 0.08960136026144028], [0.08878535032272339, 0.08791980147361755, 0.08870194107294083, 0.08783719688653946, 0.0877959206700325, 0.08775466680526733, 0.09068550169467926, 0.08767221122980118, 0.11379718780517578, 0.08947771042585373, 0.08957254141569138], [0.09139788895845413, 0.09163675457239151, 0.09142078459262848, 0.09165970981121063, 0.09167119115591049, 0.09168267250061035, 0.09088368713855743, 0.09170563519001007, 0.08554951846599579, 0.09120892733335495, 0.09118319302797318], [0.08869928121566772, 0.08780339360237122, 0.08861292153596878, 0.08771790564060211, 0.08767519891262054, 0.08763250708580017, 0.09066713601350784, 0.0875471904873848, 0.11471395194530487, 0.08941613137722015, 0.08951433002948761], [0.09681408107280731, 0.10575626790523529, 0.09763825684785843, 0.10665656626224518, 0.10710958391427994, 0.1075645238161087, 0.07998447865247726, 0.10848020762205124, 0.010325322858989239, 0.09026440232992172, 0.0894063264131546], [0.0904211550951004, 0.09019958972930908, 0.09039986878633499, 0.09017835557460785, 0.09016773849725723, 0.09015712887048721, 0.0909019410610199, 0.09013590961694717, 0.0962197408080101, 0.0905972272157669, 0.09062126278877258], [0.09050264209508896, 0.09031699597835541, 0.09048481285572052, 0.09029920399188995, 0.09029030799865723, 0.0902814120054245, 0.09090522676706314, 0.09026362746953964, 0.09533540159463882, 0.09065011888742447, 0.09067024290561676]], [[0.0902458131313324, 0.09237588942050934, 0.09018559753894806, 0.09170488268136978, 0.09167427569627762, 0.09069401770830154, 0.09161310642957687, 0.09003522247076035, 0.09000518172979355, 0.08997514098882675, 0.09149087965488434], [0.09142675250768661, 0.08977095782756805, 0.09147457033395767, 0.09028515964746475, 0.0903087705373764, 0.09107258915901184, 0.0903560072183609, 0.09159424901008606, 0.09161819517612457, 0.09164215624332428, 0.09045056253671646], [0.0902118980884552, 0.09245116263628006, 0.09014862775802612, 0.09174546599388123, 0.09171328693628311, 0.09068284928798676, 0.09164896607398987, 0.08999065309762955, 0.08995909243822098, 0.089927539229393, 0.09152046591043472], [0.09105867147445679, 0.09057963639497757, 0.09107241034507751, 0.09072906523942947, 0.09073591977357864, 0.09095672518014908, 0.09074960649013519, 0.09110677987337112, 0.09111365675926208, 0.09112053364515305, 0.09077700972557068], [0.09104179590940475, 0.09061677008867264, 0.09105398505926132, 0.09074937552213669, 0.09075545519590378, 0.09095136821269989, 0.09076760709285736, 0.09108446538448334, 0.09109056740999222, 0.0910966619849205, 0.09079191833734512], [0.09049734473228455, 0.09181851148605347, 0.09045982360839844, 0.09140358120203018, 0.09138462692499161, 0.09077631682157516, 0.09134674072265625, 0.09036608785390854, 0.09034735709428787, 0.09032861888408661, 0.09127100557088852], [0.09100804477930069, 0.09069108217954636, 0.09101712703704834, 0.09079001098871231, 0.09079454839229584, 0.09094063937664032, 0.0908036082983017, 0.09103984385728836, 0.09104438871145248, 0.09104893356561661, 0.09082174301147461], [0.09012705832719803, 0.09263952076435089, 0.09005618095397949, 0.09184692054986954, 0.09181080013513565, 0.09065485000610352, 0.09173859655857086, 0.08987922966480255, 0.08984388411045074, 0.08980854600667953, 0.09159436821937561], [0.09011009335517883, 0.09267722815275192, 0.09003769606351852, 0.09186721593141556, 0.0918303057551384, 0.09064923971891403, 0.09175653010606766, 0.08985695242881775, 0.08982084691524506, 0.08978476375341415, 0.09160914272069931], [0.09009312093257904, 0.09271494299173355, 0.09001920372247696, 0.09188751131296158, 0.09184980392456055, 0.09064362198114395, 0.09177444875240326, 0.08983467519283295, 0.08979781717061996, 0.08976096659898758, 0.09162391722202301], [0.09094052761793137, 0.09083981812000275, 0.09094341099262238, 0.09087128192186356, 0.09087271988391876, 0.090919129550457, 0.09087560325860977, 0.0909506157040596, 0.09095205366611481, 0.09095349907875061, 0.0908813625574112]], [[0.09127089381217957, 0.09113852679729462, 0.09113217890262604, 0.09112583100795746, 0.09111949056386948, 0.0911131501197815, 0.09143125265836716, 0.09110046178102493, 0.08806908875703812, 0.09124982357025146, 0.09124933928251266], [0.09215915203094482, 0.09168566018342972, 0.09166300296783447, 0.09164034575223923, 0.09161771088838577, 0.09159506857395172, 0.09273511916399002, 0.09154980629682541, 0.0811886116862297, 0.0920836478471756, 0.0920819342136383], [0.09220055490732193, 0.09171056747436523, 0.09168712049722672, 0.09166368097066879, 0.09164025634527206, 0.09161683171987534, 0.0927966982126236, 0.09157000482082367, 0.08087112009525299, 0.09212241321802139, 0.09212063997983932], [0.09224186837673187, 0.09173537790775299, 0.0917111486196518, 0.0916869267821312, 0.09166271239519119, 0.09163849800825119, 0.0928582176566124, 0.09159009158611298, 0.0805547833442688, 0.09216109663248062, 0.09215926378965378], [0.09228307753801346, 0.0917600616812706, 0.09173504263162613, 0.09171003848314285, 0.09168503433465958, 0.0916600376367569, 0.09291964024305344, 0.09161006659269333, 0.08023956418037415, 0.0921996533870697, 0.09219776093959808], [0.0923241600394249, 0.09178462624549866, 0.09175882488489151, 0.09173302352428436, 0.09170722961425781, 0.09168145060539246, 0.09298097342252731, 0.09162990748882294, 0.07992546260356903, 0.09223810583353043, 0.09223614633083344], [0.0901302769780159, 0.09040319174528122, 0.0904163047671318, 0.09042942523956299, 0.09044254571199417, 0.09045566618442535, 0.08980127424001694, 0.09048190712928772, 0.09709107875823975, 0.0901736468076706, 0.09017463028430939], [0.09240604192018509, 0.09183342009782791, 0.09180603921413422, 0.09177866578102112, 0.09175129979848862, 0.09172394126653671, 0.09310340136289597, 0.0916692465543747, 0.0793006494641304, 0.0923146903514862, 0.09231261909008026], [0.10419481247663498, 0.09499073028564453, 0.09457018971443176, 0.09415151178836823, 0.09373469650745392, 0.09331971406936646, 0.11652681976556778, 0.09249526262283325, 0.010705030523240566, 0.1026727706193924, 0.10263846069574356], [0.09141546487808228, 0.0912291631102562, 0.09122022986412048, 0.09121130406856537, 0.09120237827301025, 0.09119345247745514, 0.09164129942655563, 0.0911756083369255, 0.08694014698266983, 0.09138578921556473, 0.091385118663311], [0.09141873568296432, 0.09123121201992035, 0.09122222661972046, 0.09121324121952057, 0.09120425581932068, 0.09119527041912079, 0.09164606779813766, 0.0911773070693016, 0.08691466599702835, 0.09138887375593185, 0.09138819575309753]]], "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"use_intrinsic_rewards": 1.0, "weights_seq_no": 90.0, "vf_loss": 0.35843774676322937, "policy_loss": -5.268573295325041e-05, "vf_explained_var": 0.0015507936477661133, "total_loss": 0.2781409025192261, "diff_num_grad_updates_vs_sampler_policy": 76.0, "num_module_steps_trained": 35910, "entropy": 0.6799209713935852, "vf_loss_unclipped": 45.9726676940918, "module_train_batch_size_mean": 997.4996962148737, "num_module_steps_trained_lifetime": 538650, "mean_kl_loss": 9.34633681026753e-06}, "intrinsic_reward_module": {"total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 76.0, "module_train_batch_size_mean": 997.4996962148737, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 538650, "weights_seq_no": 90.0}, "__all_modules__": {"num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 2970000, "num_module_steps_trained_lifetime": 1077300, "num_env_steps_trained_lifetime_throughput": 48339.33883047673}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 179550, "num_env_steps_trained_lifetime": 495000, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime_throughput": 4281.089958836778, "num_module_steps_trained_throughput": 20806411.925145324, "num_module_steps_trained_lifetime_throughput": 13686684.716785716}, "intrinsic_reward_module": {"total_loss": 0.0, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "default_optimizer_learning_rate": 0.0002715581955, "module_train_batch_size_mean": 997.7008703380301, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 89775, "weights_seq_no": 15.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 776.2189489473698}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.088415273080847e-05, "module_to_env_connector": {"connector_pipeline_timer": 0.00011437399293486009, "timers": {"connectors": {"tensor_to_numpy": 1.5046818290870081e-05, "normalize_and_clip_actions": 7.98692169846777e-06, "listify_data_for_vector_env": 1.0395047356428032e-05, "un_batch_to_individual_items": 6.572191519366939e-06, "remove_single_ts_time_rank_from_batch": 1.1844314045056594e-05, "get_actions": 3.597826061582491e-05}}}, "agent_episode_returns_mean": {"default_agent": -1.7}, "env_step_timer": 1.3839146551251112e-05, "env_reset_timer": 0.00018320298476035395, "env_to_module_connector": {"connector_pipeline_timer": 5.9937637123976094e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.256483232687427e-06, "add_observations_from_episodes_to_batch": 2.841316559993236e-06, "add_states_from_episodes_to_batch": 2.8017273856219385e-06, "numpy_to_tensor": 1.1991305933368278e-05, "batch_individual_items": 1.2435403581673772e-05}}}, "sample": 0.1159859539077278, "episode_return_max": 13.5, "episode_len_mean": 20.0, "episode_len_max": 20, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "episode_duration_sec_mean": 0.005352284555556253, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": -1.7}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled_lifetime": 75400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 15.0, "episode_return_min": -15.5, "num_env_steps_sampled": 400, "num_episodes_lifetime": 300, "num_episodes": 20, "episode_return_mean": -1.7, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "time_between_sampling": 9.393141085071145}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "b1709_00000", "date": "2025-08-11_18-35-02", "timestamp": 1754930102, "time_this_iter_s": 9.923680067062378, "time_total_s": 147.53053426742554, "pid": 11351, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3845f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 147.53053426742554, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 47.27857142857142, "ram_util_percent": 80.60000000000001}}
{"timers": {"training_iteration": 9.132833416478471, "restore_env_runners": 1.189710704585113e-05, "training_step": 9.132687832374376, "env_runner_sampling_timer": 1.6269131833694357, "learner_update_timer": 7.3302417727533, "synch_weights": 0.0008606890210400028, "restore_eval_env_runners": 1.0217696665080959e-05, "evaluation_iteration": 0.12319905861732551, "synch_eval_env_connectors": 0.00013889973975612322, "synch_env_connectors": 4.634039596956883e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00012739809827971128, "timers": {"connectors": {"un_batch_to_individual_items": 7.042994694069476e-06, "tensor_to_numpy": 1.6345339308704987e-05, "remove_single_ts_time_rank_from_batch": 1.2577851224615046e-05, "normalize_and_clip_actions": 8.45282261925077e-06, "get_actions": 4.3788881724871773e-05, "listify_data_for_vector_env": 1.1105853112791213e-05}}}, "time_between_sampling": 0.03429693116729283, "episode_duration_sec_mean": 0.005728450523223725, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -8635000.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.029544447030538e-06, "add_time_dim_to_batch_and_zero_pad": 7.455115702792241e-06, "numpy_to_tensor": 1.3946483874530674e-05, "add_states_from_episodes_to_batch": 2.8748819004442016e-06, "batch_individual_items": 1.3339262024037408e-05}}, "connector_pipeline_timer": 6.401536121416309e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "agent_episode_returns_mean": {"default_agent": -0.9399999999999996}, "weights_seq_no": 15.0, "module_episode_returns_mean": {"default_policy": -0.9399999999999996}, "episode_return_min": -13.5, "num_env_steps_sampled": 5000.0, "num_episodes_lifetime": -431750.0, "rlmodule_inference_timer": 3.466294397261287e-05, "episode_len_mean": 20.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "num_episodes": 250.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.5356382273204658e-05, "episode_return_mean": -0.9399999999999996, "env_reset_timer": 4.8448457091171765e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "sample": 0.006081421341379111, "episode_return_max": 6.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3028.5458748415244}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13502118271123761, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009359373003007666, "add_observations_from_episodes_to_batch": 0.0008370139244187634, "add_columns_from_episodes_to_train_batch": 0.04112751615769282, "add_time_dim_to_batch_and_zero_pad": 0.07559505235770919, "add_states_from_episodes_to_batch": 0.0036945502444426298, "batch_individual_items": 0.0041751081290105725, "numpy_to_tensor": 7.414087857149357e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "policy_loss": -0.000176181027200073, "use_intrinsic_rewards": 0.0, "weights_seq_no": 16.0, "vf_explained_var": -0.0007576942443847656, "num_trainable_parameters": 16595, "vf_loss": 0.35831066966056824, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 2.4655751076352317e-06, "num_module_steps_trained": 5985, "total_loss": 0.2779185175895691, "module_train_batch_size_mean": 997.6889684010584, "num_module_steps_trained_lifetime": 95760, "entropy": 0.6788925528526306, "vf_loss_unclipped": 44.029815673828125, "mean_kl_loss": 1.3040964404353872e-05, "num_module_steps_trained_lifetime_throughput": 772.5366807603382}, "IntrinsicAttentionMask": [[[0.09046971797943115, 0.09125395864248276, 0.09077092260122299, 0.09152265638113022, 0.09150757640600204, 0.09042990207672119, 0.09117881208658218, 0.09069617092609406, 0.09068122506141663, 0.09037031978368759, 0.09111873805522919], [0.09165997058153152, 0.0903192013502121, 0.09114130586385727, 0.08986696600914001, 0.08989225327968597, 0.09172886610031128, 0.09044632315635681, 0.0912695899605751, 0.0912952646613121, 0.09183214604854584, 0.09054815769195557], [0.09092779457569122, 0.09089440852403641, 0.09091493487358093, 0.0908830389380455, 0.09088367223739624, 0.09092949330806732, 0.09089759737253189, 0.09091812372207642, 0.09091875702142715, 0.09093204885721207, 0.09090013802051544], [0.09206593036651611, 0.08999998867511749, 0.09126478433609009, 0.08930689096450806, 0.08934558928012848, 0.0921725407242775, 0.09019516408443451, 0.09146270900964737, 0.09150233864784241, 0.09233241528272629, 0.09035161137580872], [0.0920431837439537, 0.0900178924202919, 0.09125790745019913, 0.08933823555707932, 0.08937618136405945, 0.09214766323566437, 0.09020926803350449, 0.09145192056894302, 0.09149077534675598, 0.09230435639619827, 0.09036266058683395], [0.09040908515453339, 0.09130153059959412, 0.09075172245502472, 0.09160754084587097, 0.09159035980701447, 0.09036381542682648, 0.09121596813201904, 0.09066667407751083, 0.09064967930316925, 0.09029605984687805, 0.09114757925271988], [0.09154625982046127, 0.0904085710644722, 0.09110645204782486, 0.09002427011728287, 0.09004576504230499, 0.09160465747117996, 0.09051655232906342, 0.09121526777744293, 0.09123704582452774, 0.09169217199087143, 0.09060302376747131], [0.09081422537565231, 0.09098358452320099, 0.0908794030547142, 0.09104134142398834, 0.09103810042142868, 0.09080559760332108, 0.09096740186214447, 0.09086324274539948, 0.09086001664400101, 0.09079267829656601, 0.09095446020364761], [0.09079150855541229, 0.09100140631198883, 0.09087228029966354, 0.09107301384210587, 0.09106899797916412, 0.0907808169722557, 0.09098134934902191, 0.09085225313901901, 0.09084824472665787, 0.09076481312513351, 0.09096530824899673], [0.09031829982995987, 0.09137274324893951, 0.09072291851043701, 0.09173472970724106, 0.09171440452337265, 0.09026485681533813, 0.09127156436443329, 0.09062245488166809, 0.09060237556695938, 0.09018489718437195, 0.09119071066379547], [0.09145530313253403, 0.09048004448413849, 0.0910784974694252, 0.09015021473169327, 0.09016866236925125, 0.09150531888008118, 0.09057267755270004, 0.0911717489361763, 0.091190405189991, 0.09158025681972504, 0.09064686298370361]], [[0.08832991868257523, 0.0890442356467247, 0.08825444430112839, 0.08821672946214676, 0.08893012255430222, 0.08814134448766708, 0.09081441164016724, 0.08881616592407227, 0.11069630086421967, 0.08895610272884369, 0.08980027586221695], [0.08933591842651367, 0.08978646248579025, 0.08928824216127396, 0.0892644003033638, 0.08971457928419113, 0.08921675384044647, 0.09089717268943787, 0.08964275568723679, 0.10286088287830353, 0.08973095566034317, 0.09026184678077698], [0.08822038024663925, 0.08896235376596451, 0.08814200013875961, 0.08810282498598099, 0.08884380757808685, 0.0880245491862297, 0.09080210328102112, 0.08872542530298233, 0.11155785620212555, 0.08887080103158951, 0.08974793553352356], [0.08816540241241455, 0.08892118185758591, 0.08808556199073792, 0.08804567158222198, 0.08880042284727097, 0.0879659429192543, 0.09079568088054657, 0.08867983520030975, 0.11199080944061279, 0.08882792294025421, 0.08972150832414627], [0.08917887508869171, 0.0896717756986618, 0.08912671357393265, 0.08910065144300461, 0.08959311991930008, 0.08904854208230972, 0.09088794142007828, 0.08951453864574432, 0.10407466441392899, 0.08961103111505508, 0.09019212424755096], [0.08805505931377411, 0.08883839845657349, 0.08797233551740646, 0.08793099224567413, 0.08871322125196457, 0.08784837275743484, 0.09078233689069748, 0.08858822286128998, 0.11286114901304245, 0.0887417271733284, 0.08966819196939468], [0.09160585701465607, 0.09138994663953781, 0.091628797352314, 0.09164027124643326, 0.09142428636550903, 0.09166322648525238, 0.09086441248655319, 0.09145864099264145, 0.08574418723583221, 0.09141646325588226, 0.09116385132074356], [0.08902066946029663, 0.08955579251050949, 0.0889640524983406, 0.08893576264381409, 0.08947038650512695, 0.08887920528650284, 0.0908772423863411, 0.08938505500555038, 0.10530106723308563, 0.08948983252048492, 0.09012100100517273], [0.10495559871196747, 0.09720809012651443, 0.10581330955028534, 0.10624478757381439, 0.09840211272239685, 0.10711303353309631, 0.08059512078762054, 0.09961080551147461, 0.012238424271345139, 0.0981288030743599, 0.08968981355428696], [0.0892147645354271, 0.08969802409410477, 0.08916362375020981, 0.08913806825876236, 0.0896209105849266, 0.08908697217702866, 0.09089018404483795, 0.08954387158155441, 0.10379704087972641, 0.08963847905397415, 0.09020813554525375], [0.09034275263547897, 0.09051062166690826, 0.09032495319843292, 0.0903160572052002, 0.09048387408256531, 0.09029826521873474, 0.09092219918966293, 0.09045713394880295, 0.09516697376966476, 0.09048996865749359, 0.09068716317415237]], [[0.09057725220918655, 0.09136242419481277, 0.09058215469121933, 0.0913323238492012, 0.09131727367639542, 0.09053738415241241, 0.0915861576795578, 0.09050755947828293, 0.09049264341592789, 0.09047773480415344, 0.09122703969478607], [0.09147382527589798, 0.09013577550649643, 0.09146536886692047, 0.09018649905920029, 0.09021187573671341, 0.09154258668422699, 0.0897601842880249, 0.09159410744905472, 0.09161987155675888, 0.09164565056562424, 0.09036426991224289], [0.09058289229869843, 0.09135472029447556, 0.09058772027492523, 0.09132513403892517, 0.09131033718585968, 0.0905437171459198, 0.09157462418079376, 0.09051438421010971, 0.09049972891807556, 0.09048507362604141, 0.0912216454744339], [0.09143970906734467, 0.09018257260322571, 0.09143175929784775, 0.09023025631904602, 0.09025410562753677, 0.09150427579879761, 0.08982949703931808, 0.09155265986919403, 0.09157685190439224, 0.09160105884075165, 0.09039732813835144], [0.09142263233661652, 0.09020596742630005, 0.09141494333744049, 0.0902521163225174, 0.09027520567178726, 0.09148511290550232, 0.08986415714025497, 0.0915319174528122, 0.09155533462762833, 0.09157875180244446, 0.09041384607553482], [0.0905313789844513, 0.09142503142356873, 0.09053695946931839, 0.09139075130224228, 0.09137361496686935, 0.09048604965209961, 0.09167986363172531, 0.09045211970806122, 0.09043515473604202, 0.09041819721460342, 0.09127086400985718], [0.09172683209180832, 0.08978857845067978, 0.0917145311832428, 0.08986181765794754, 0.08989845961332321, 0.09182678163051605, 0.08924682438373566, 0.09190168976783752, 0.09193916618824005, 0.09197665750980377, 0.0901186540722847], [0.09049702435731888, 0.09147191047668457, 0.09050311148166656, 0.09143449366092682, 0.09141579270362854, 0.09044758975505829, 0.09175006300210953, 0.09041059762239456, 0.090392105281353, 0.09037361294031143, 0.09130366891622543], [0.09047984331846237, 0.09149535000324249, 0.09048618376255035, 0.09145636856555939, 0.09143688529729843, 0.09042836725711823, 0.09178517758846283, 0.09038984030485153, 0.09037058055400848, 0.09035132825374603, 0.09132006764411926], [0.09046266227960587, 0.09151878207921982, 0.09046924859285355, 0.09147823601961136, 0.09145797044038773, 0.09040912985801697, 0.09182029217481613, 0.0903690755367279, 0.09034904837608337, 0.09032902866601944, 0.0913364589214325], [0.09132019430398941, 0.09034637361764908, 0.09131404757499695, 0.0903833657503128, 0.09040186554193497, 0.09137012809515, 0.09007231891155243, 0.09140753746032715, 0.09142625331878662, 0.0914449617266655, 0.0905129462480545]], [[0.08839622884988785, 0.08911106735467911, 0.08832069486379623, 0.08828295022249222, 0.08899687975645065, 0.08820751309394836, 0.09088258445262909, 0.08813214302062988, 0.11077938973903656, 0.08902288228273392, 0.08986768126487732], [0.08937826007604599, 0.08982901275157928, 0.08933054655790329, 0.08930670469999313, 0.08975709974765778, 0.08925904333591461, 0.09094025194644928, 0.08921139687299728, 0.1029096245765686, 0.08977347612380981, 0.09030462801456451], [0.08828916400671005, 0.08903171122074127, 0.08821072429418564, 0.08817152678966522, 0.08891308307647705, 0.08809318393468857, 0.09087289869785309, 0.08801490813493729, 0.11164482682943344, 0.0889400914311409, 0.08981791138648987], [0.08823543041944504, 0.08899180591106415, 0.08815553039312363, 0.08811560273170471, 0.08887095004320145, 0.08803581446409225, 0.0908677950501442, 0.08795609325170517, 0.11207974702119827, 0.08889847248792648, 0.08979276567697525], [0.08922509849071503, 0.08971825987100601, 0.08917292207479477, 0.08914684504270554, 0.0896395668387413, 0.08909469842910767, 0.09093505144119263, 0.08904259651899338, 0.10412860661745071, 0.0896574929356575, 0.09023886919021606], [0.08812754601240158, 0.0889115259051323, 0.08804474025964737, 0.08800337463617325, 0.08878625184297562, 0.08792068809270859, 0.09085706621408463, 0.0878380760550499, 0.1129540354013443, 0.08881476521492004, 0.08974199742078781], [0.09158501029014587, 0.0913691595196724, 0.0916079506278038, 0.09161942452192307, 0.09140348434448242, 0.09164237231016159, 0.09084373712539673, 0.09166532754898071, 0.08572468161582947, 0.09139566123485565, 0.09114311635494232], [0.08801908791065216, 0.0888306125998497, 0.08793339878320694, 0.08789058029651642, 0.08870091289281845, 0.08780501037836075, 0.09084560722112656, 0.08771952241659164, 0.11383423954248428, 0.08873044699430466, 0.08969053626060486], [0.10408364236354828, 0.09640050679445267, 0.10493423044681549, 0.10536212474107742, 0.09758460521697998, 0.10622315853834152, 0.07992555946111679, 0.10709122568368912, 0.012136763893067837, 0.09731357544660568, 0.0889446884393692], [0.08926009386777878, 0.08974359929561615, 0.0892089307308197, 0.08918336033821106, 0.089666448533535, 0.08913223445415497, 0.09093635529279709, 0.08908114582300186, 0.10384977608919144, 0.08968402445316315, 0.09025397151708603], [0.09035872668027878, 0.09052661806344986, 0.09034092724323273, 0.0903320237994194, 0.0904998704791069, 0.09031423181295395, 0.0909382700920105, 0.0902964323759079, 0.09518379718065262, 0.09050596505403519, 0.09070319682359695]], [[0.09046977013349533, 0.09125401824712753, 0.0904746800661087, 0.091522715985775, 0.09120891988277435, 0.09042996168136597, 0.09117887169122696, 0.09069623053073883, 0.0906812846660614, 0.09066634625196457, 0.09141721576452255], [0.09166014194488525, 0.09031936526298523, 0.09165166318416595, 0.08986713737249374, 0.09039562195539474, 0.0917290449142456, 0.09044649451971054, 0.09126976132392883, 0.09129543602466583, 0.09132112562656403, 0.09004427492618561], [0.09047722816467285, 0.09124815464019775, 0.09048204869031906, 0.09151225537061691, 0.09120382368564606, 0.09043809026479721, 0.09117428213357925, 0.09069985151290894, 0.0906851589679718, 0.09067047387361526, 0.09140855818986893], [0.09206633269786835, 0.09000038355588913, 0.09205321967601776, 0.0893072783946991, 0.0901174396276474, 0.09217294305562973, 0.09019555896520615, 0.0914631113409996, 0.09150274097919464, 0.09154240041971207, 0.0895785391330719], [0.09159188717603683, 0.0903729647397995, 0.09158418327569962, 0.0899614691734314, 0.09044233709573746, 0.09165447950363159, 0.09048860520124435, 0.0912371501326561, 0.09126048535108566, 0.09128382802009583, 0.09012266993522644], [0.09040915966033936, 0.09130160510540009, 0.09041474014520645, 0.09160761535167694, 0.09125025570392609, 0.09036388993263245, 0.09121604263782501, 0.0906667560338974, 0.09064975380897522, 0.09063275158405304, 0.09148744493722916], [0.09154637157917023, 0.09040868282318115, 0.09153918921947479, 0.09002438187599182, 0.09047345072031021, 0.09160476922988892, 0.09051666408777237, 0.09121538698673248, 0.0912371575832367, 0.0912589430809021, 0.09017494320869446], [0.09081422537565231, 0.09098358452320099, 0.09081529080867767, 0.09104134142398834, 0.0909738764166832, 0.09080559760332108, 0.09096740186214447, 0.09086325019598007, 0.09086001664400101, 0.09085678309202194, 0.0910186767578125], [0.09079151600599289, 0.09100141376256943, 0.09079282730817795, 0.09107302129268646, 0.0909893736243248, 0.0907808244228363, 0.09098135679960251, 0.09085226058959961, 0.09084825217723846, 0.09084425121545792, 0.09104492515325546], [0.09076880663633347, 0.09101924300193787, 0.09077037870883942, 0.09110470861196518, 0.0910048857331276, 0.09075605124235153, 0.09099531173706055, 0.09084127098321915, 0.09083649516105652, 0.09083171933889389, 0.09107117354869843], [0.09190694987773895, 0.09012556076049805, 0.09189565479755402, 0.08952666819095612, 0.09022664278745651, 0.09199872612953186, 0.09029409289360046, 0.09138738363981247, 0.09142153710126877, 0.09145570546388626, 0.08976113796234131]], [[0.08811391144990921, 0.08882647752761841, 0.0880386158823967, 0.08800099790096283, 0.0887126475572586, 0.08867473900318146, 0.09059233218431473, 0.08859896659851074, 0.1113661602139473, 0.08949442207813263, 0.08958066999912262], [0.0892024114727974, 0.08965227007865906, 0.08915479481220245, 0.08913099020719528, 0.08958049863576889, 0.08955658972263336, 0.09076131880283356, 0.0895087867975235, 0.10325267165899277, 0.09007274359464645, 0.09012694656848907], [0.08799552917480469, 0.08873561024665833, 0.08791734278202057, 0.0878782719373703, 0.08861736953258514, 0.0885779932141304, 0.09057066589593887, 0.0884992852807045, 0.11225923150777817, 0.08942956477403641, 0.0895191878080368], [0.08793612569570541, 0.08868993073701859, 0.0878564864397049, 0.08781670778989792, 0.08856949210166931, 0.08852937817573547, 0.09055955708026886, 0.08844920992851257, 0.11270809918642044, 0.0893968716263771, 0.08948817849159241], [0.08903233706951141, 0.08952443301677704, 0.08898026496171951, 0.08895424753427505, 0.08944590389728546, 0.08941974490880966, 0.09073859453201294, 0.08936744928359985, 0.10450848937034607, 0.08998458832502365, 0.09004391729831696], [0.08897538483142853, 0.08948152512311935, 0.08892183750867844, 0.08889507502317429, 0.0894007533788681, 0.08937384188175201, 0.090730682015419, 0.08932005614042282, 0.1049300879240036, 0.08995488286018372, 0.09001592546701431], [0.09166701138019562, 0.09145095944404602, 0.09168997406959534, 0.0917014554142952, 0.09148532897233963, 0.0914967805147171, 0.09092507511377335, 0.09151969850063324, 0.0855884924530983, 0.0912504643201828, 0.09122472256422043], [0.08886106312274933, 0.08939523994922638, 0.08880455791950226, 0.08877632021903992, 0.08930997550487518, 0.08928157389163971, 0.09071431308984756, 0.08922480791807175, 0.10577776283025742, 0.08989496529102325, 0.08995942026376724], [0.10718868672847748, 0.09896072000265121, 0.10810116678476334, 0.10856032371520996, 0.10022707283496857, 0.100652776658535, 0.08141219615936279, 0.10150963068008423, 0.010509674437344074, 0.0918755978345871, 0.0910022109746933], [0.0901721939444542, 0.09037242084741592, 0.09015096724033356, 0.09014036506414413, 0.0903405100107193, 0.09032987803220749, 0.09086363762617111, 0.09030862152576447, 0.09617919474840164, 0.09055905044078827, 0.09058307856321335], [0.0902939960360527, 0.09046176820993423, 0.09027621150016785, 0.09026731550693512, 0.09043503552675247, 0.09042613208293915, 0.090873122215271, 0.0904083177447319, 0.09530173242092133, 0.09061810374259949, 0.09063822031021118]]], "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"use_intrinsic_rewards": 1.0, "weights_seq_no": 96.0, "vf_loss": 0.3584268093109131, "policy_loss": -0.0001690093777142465, "vf_explained_var": 0.0016458630561828613, "total_loss": 0.2780180275440216, "diff_num_grad_updates_vs_sampler_policy": 81.0, "num_module_steps_trained": 35910, "entropy": 0.678929328918457, "vf_loss_unclipped": 43.93275833129883, "module_train_batch_size_mean": 997.4990256591639, "num_module_steps_trained_lifetime": 574560, "mean_kl_loss": 1.195864115288714e-05}, "intrinsic_reward_module": {"total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 81.0, "module_train_batch_size_mean": 997.4990256591639, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 574560, "weights_seq_no": 96.0}, "__all_modules__": {"num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 3168000, "num_module_steps_trained_lifetime": 1149120, "num_env_steps_trained_lifetime_throughput": 47552.2820357819}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 191520, "num_env_steps_trained_lifetime": 528000, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime_throughput": 4260.7782631751, "num_module_steps_trained_throughput": 20353889.371045507, "num_module_steps_trained_lifetime_throughput": 13613091.159659287}, "intrinsic_reward_module": {"total_loss": 0.0, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "default_optimizer_learning_rate": 0.0002715581955, "module_train_batch_size_mean": 997.6889684010584, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 95760, "weights_seq_no": 16.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 772.5430629713684}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.616005805212107e-05, "module_to_env_connector": {"connector_pipeline_timer": 0.00012808256628228724, "timers": {"connectors": {"tensor_to_numpy": 1.7645552098700827e-05, "normalize_and_clip_actions": 8.359516775330125e-06, "listify_data_for_vector_env": 1.1814459869013064e-05, "un_batch_to_individual_items": 7.0092075031402555e-06, "remove_single_ts_time_rank_from_batch": 1.2338734658468238e-05, "get_actions": 4.239715429476133e-05}}}, "agent_episode_returns_mean": {"default_agent": -0.1}, "env_step_timer": 1.5549797941552107e-05, "env_reset_timer": 0.00018216470600910335, "env_to_module_connector": {"connector_pipeline_timer": 6.444365526158235e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.726482587172182e-06, "add_observations_from_episodes_to_batch": 3.0168564622592142e-06, "add_states_from_episodes_to_batch": 2.9176979028529053e-06, "numpy_to_tensor": 1.3845475907238553e-05, "batch_individual_items": 1.3190228231923995e-05}}}, "sample": 0.11600552977895451, "episode_return_max": 13.5, "episode_len_mean": 20.0, "episode_len_max": 20, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "episode_duration_sec_mean": 0.00538417246309109, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": -0.1}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled_lifetime": 80400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 16.0, "episode_return_min": -15.5, "num_env_steps_sampled": 400, "num_episodes_lifetime": 320, "num_episodes": 20, "episode_return_mean": -0.1, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "time_between_sampling": 9.394743950470252}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "b1709_00000", "date": "2025-08-11_18-35-12", "timestamp": 1754930112, "time_this_iter_s": 9.649202823638916, "time_total_s": 157.17973709106445, "pid": 11351, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3845f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 157.17973709106445, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 44.38571428571428, "ram_util_percent": 80.15714285714287}}
{"timers": {"training_iteration": 9.137940772733433, "restore_env_runners": 1.1853975900949993e-05, "training_step": 9.13779406738091, "env_runner_sampling_timer": 1.6257691240352456, "learner_update_timer": 7.336429240025114, "synch_weights": 0.0008706867113754007, "restore_eval_env_runners": 1.0291349908057897e-05, "evaluation_iteration": 0.1232006105309832, "synch_eval_env_connectors": 0.00013875032222799622, "synch_env_connectors": 4.633118638798093e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00011626313336161709, "timers": {"connectors": {"un_batch_to_individual_items": 6.5565439524999434e-06, "tensor_to_numpy": 1.5048895854102043e-05, "remove_single_ts_time_rank_from_batch": 1.1750253783594902e-05, "normalize_and_clip_actions": 7.840752879180463e-06, "get_actions": 3.85548018016436e-05, "listify_data_for_vector_env": 1.032151257357175e-05}}}, "time_between_sampling": 0.03261533194429246, "episode_duration_sec_mean": 0.005196919010486454, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -9252500.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7965295162428195e-06, "add_time_dim_to_batch_and_zero_pad": 6.743752481627622e-06, "numpy_to_tensor": 1.250112488954247e-05, "add_states_from_episodes_to_batch": 2.638792887705949e-06, "batch_individual_items": 1.221154056310814e-05}}, "connector_pipeline_timer": 5.880268234218888e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "agent_episode_returns_mean": {"default_agent": -2.379999999999999}, "weights_seq_no": 16.0, "module_episode_returns_mean": {"default_policy": -2.379999999999999}, "episode_return_min": -13.5, "num_env_steps_sampled": 5000.0, "num_episodes_lifetime": -462625.0, "rlmodule_inference_timer": 3.109484255606766e-05, "episode_len_mean": 20.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "num_episodes": 250.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.3797903521442609e-05, "episode_return_mean": -2.379999999999999, "env_reset_timer": 4.1074890681746436e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "sample": 0.005684519539320377, "episode_return_max": 6.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3291.6675124035473}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13499713297395177, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009351055102747259, "add_observations_from_episodes_to_batch": 0.0008367342053350183, "add_columns_from_episodes_to_train_batch": 0.04112104224608564, "add_time_dim_to_batch_and_zero_pad": 0.07558364599468442, "add_states_from_episodes_to_batch": 0.003695309741556831, "batch_individual_items": 0.0041774137172965594, "numpy_to_tensor": 7.400280034021924e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "policy_loss": -0.0002710083208512515, "use_intrinsic_rewards": 0.0, "weights_seq_no": 17.0, "vf_explained_var": -0.0007822513580322266, "num_trainable_parameters": 16595, "vf_loss": 0.35831406712532043, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 1.2327875538176158e-06, "num_module_steps_trained": 5985, "total_loss": 0.2778279483318329, "module_train_batch_size_mean": 997.6777629636601, "num_module_steps_trained_lifetime": 101745, "entropy": 0.677830696105957, "vf_loss_unclipped": 42.553138732910156, "mean_kl_loss": 1.4980832929722965e-05, "num_module_steps_trained_lifetime_throughput": 769.2009594441435}, "IntrinsicAttentionMask": [[[0.09044275432825089, 0.09122676402330399, 0.09044765681028366, 0.09149537980556488, 0.091181680560112, 0.09069902449846268, 0.09145016223192215, 0.09066914767026901, 0.09035827964544296, 0.09063927084207535, 0.09138990938663483], [0.0917062759399414, 0.09036482125520706, 0.0916977971792221, 0.08991236984729767, 0.09044111520051956, 0.09126433730125427, 0.08998827636241913, 0.09131569415330887, 0.09185269474983215, 0.09136708825826645, 0.0900895968079567], [0.09045066684484482, 0.09122136235237122, 0.09045548737049103, 0.0914853885769844, 0.09117704629898071, 0.0907026007771492, 0.09144094586372375, 0.09067322313785553, 0.0903676226735115, 0.09064385294914246, 0.09138172119855881], [0.09213738143444061, 0.09006983786821365, 0.09212425351142883, 0.08937619626522064, 0.09018698334693909, 0.0914544090628624, 0.08949244767427444, 0.09153369069099426, 0.09236405044794083, 0.0916130393743515, 0.08964767307043076], [0.09163381904363632, 0.09041434526443481, 0.0916261151432991, 0.09000265598297119, 0.09048373997211456, 0.09123224020004272, 0.09007173776626587, 0.09127891808748245, 0.0917668268084526, 0.09132561832666397, 0.0901639387011528], [0.09085660427808762, 0.09094486385583878, 0.09085716307163239, 0.09097494930028915, 0.09093980491161346, 0.09088553488254547, 0.09096989035606384, 0.09088215976953506, 0.09084705263376236, 0.09087879210710526, 0.09096314758062363], [0.09206487983465195, 0.09011948108673096, 0.09205253422260284, 0.08946623653173447, 0.09022977948188782, 0.09142254292964935, 0.08957573026418686, 0.09149712324142456, 0.09227799624204636, 0.09157176315784454, 0.0897219330072403], [0.09080839157104492, 0.0909777358174324, 0.09080945700407028, 0.09103549271821976, 0.09096802771091461, 0.09086387604475021, 0.09102577716112137, 0.09085740894079208, 0.09079007804393768, 0.09085094928741455, 0.09101283550262451], [0.09030615538358688, 0.09131971001625061, 0.09031248092651367, 0.0916675552725792, 0.0912613570690155, 0.09063717722892761, 0.09160898625850677, 0.09059856832027435, 0.09019710123538971, 0.09055996686220169, 0.091530941426754], [0.09076017886400223, 0.09101059287786484, 0.09076175093650818, 0.09109605103731155, 0.09099623560905457, 0.09084219485521317, 0.09108167886734009, 0.09083264321088791, 0.0907331109046936, 0.09082308411598206, 0.0910625159740448], [0.09196821600198746, 0.09018563479185104, 0.09195691347122192, 0.08958634734153748, 0.09028678387403488, 0.09137999266386032, 0.08968682587146759, 0.09144829958677292, 0.09216330200433731, 0.09151666611433029, 0.0898209661245346]], [[0.09156312793493271, 0.09154128283262253, 0.09151944518089294, 0.09193187206983566, 0.09190993756055832, 0.09188801050186157, 0.0925527885556221, 0.09184417128562927, 0.08140113204717636, 0.09192492812871933, 0.09192327409982681], [0.09158463776111603, 0.09156200289726257, 0.09153938293457031, 0.0919666513800621, 0.09194393455982208, 0.09192121773958206, 0.09261005371809006, 0.09187579154968262, 0.0810791403055191, 0.09195946156978607, 0.09195774793624878], [0.091606006026268, 0.09158258885145187, 0.09155917912721634, 0.0920013040304184, 0.0919777899980545, 0.09195428341627121, 0.09266720712184906, 0.09190727770328522, 0.08075828850269318, 0.09199386835098267, 0.0919920951128006], [0.09118209779262543, 0.09117342531681061, 0.09116474539041519, 0.09132839739322662, 0.09131970256567001, 0.0913110077381134, 0.09157393872737885, 0.09129363298416138, 0.08700234442949295, 0.09132564067840576, 0.09132499247789383], [0.09120573103427887, 0.09119627624750137, 0.09118682146072388, 0.09136516600847244, 0.09135568886995316, 0.09134621918201447, 0.09163282066583633, 0.09132727980613708, 0.08666029572486877, 0.09136217087507248, 0.09136145561933517], [0.09122925251722336, 0.09121901541948318, 0.09120877832174301, 0.0914018303155899, 0.09139157831668854, 0.09138132631778717, 0.09169162064790726, 0.09136082231998444, 0.08631947636604309, 0.09139858186244965, 0.09139781445264816], [0.09046065807342529, 0.09047378599643707, 0.09048690646886826, 0.09023991227149963, 0.09025300294160843, 0.09026609361171722, 0.08987139910459518, 0.09029228985309601, 0.09716687351465225, 0.09024405479431152, 0.09024503827095032], [0.09127585589885712, 0.09126406162977219, 0.09125226736068726, 0.09147476404905319, 0.09146294742822647, 0.09145112335681915, 0.09180888533592224, 0.09142749011516571, 0.08564144372940063, 0.09147102385759354, 0.0914701297879219], [0.09303034096956253, 0.09261848777532578, 0.09220845252275467, 0.10024937242269516, 0.099805548787117, 0.09936369955539703, 0.1136166974902153, 0.09848584979772568, 0.010437730699777603, 0.10010866820812225, 0.10007521510124207], [0.09118960052728653, 0.09118067473173141, 0.0911717489361763, 0.09134005010128021, 0.0913311168551445, 0.09132217615842819, 0.09159259498119354, 0.09130430221557617, 0.08689393848180771, 0.09133722633123398, 0.09133654832839966], [0.09119138866662979, 0.0911824032664299, 0.09117341786623001, 0.09134282916784286, 0.09133383631706238, 0.0913248360157013, 0.09159703552722931, 0.09130684286355972, 0.08686816692352295, 0.09133998304605484, 0.09133930504322052]], [[0.09019008278846741, 0.0917094424366951, 0.09012990444898605, 0.09225723892450333, 0.09222645312547684, 0.0900397077202797, 0.09155652672052383, 0.0899796262383461, 0.0899496003985405, 0.08991958200931549, 0.09204194694757462], [0.09110750257968903, 0.09068667888641357, 0.09112435579299927, 0.09053713083267212, 0.09054551273584366, 0.09114964306354523, 0.09072862565517426, 0.09116650372743607, 0.09117493778467178, 0.0911833718419075, 0.0905957743525505], [0.09015326201915741, 0.09175017476081848, 0.09009002894163132, 0.09232626855373383, 0.0922938883304596, 0.08999527245759964, 0.09158939123153687, 0.0899321585893631, 0.08990062028169632, 0.08986908197402954, 0.09209983795881271], [0.09143262356519699, 0.09032072871923447, 0.09147733449935913, 0.08992762118577957, 0.0899496078491211, 0.09154444932937622, 0.09043118357658386, 0.09158921241760254, 0.0916116014122963, 0.09163399785757065, 0.09008163213729858], [0.0914144292473793, 0.0903412476181984, 0.09145756810903549, 0.08996172994375229, 0.08998295664787292, 0.09152232855558395, 0.09044788777828217, 0.09156551957130432, 0.0915871262550354, 0.09160874038934708, 0.0901104211807251], [0.09009800851345062, 0.09181127697229385, 0.09003021568059921, 0.09242987632751465, 0.09239509701728821, 0.08992863446474075, 0.09163867682218552, 0.08986097574234009, 0.08982715755701065, 0.089793361723423, 0.09218670427799225], [0.09101620316505432, 0.09078909456729889, 0.09102529287338257, 0.09070827066898346, 0.09071279317140579, 0.09103891998529434, 0.09081175178289413, 0.09104800969362259, 0.09105255454778671, 0.09105709940195084, 0.09073997288942337], [0.09006116539239883, 0.09185199439525604, 0.08999034017324448, 0.09249898046255112, 0.09246260672807693, 0.0898841992020607, 0.09167151898145676, 0.08981351554393768, 0.08977819234132767, 0.08974288403987885, 0.09224463254213333], [0.09004273265600204, 0.09187234938144684, 0.08997038751840591, 0.09253353625535965, 0.092496357858181, 0.08986198157072067, 0.09168792515993118, 0.08978977799415588, 0.08975370228290558, 0.08971764147281647, 0.09227358549833298], [0.09002429246902466, 0.09189270436763763, 0.08995043486356735, 0.09256809949874878, 0.09253011643886566, 0.08983975648880005, 0.0917043387889862, 0.08976604789495468, 0.08972921222448349, 0.08969239890575409, 0.09230255335569382], [0.0913052037358284, 0.09046436846256256, 0.09133896231651306, 0.09016650170087814, 0.09018317610025406, 0.09138962626457214, 0.09054801613092422, 0.0914234146475792, 0.09144031256437302, 0.09145721793174744, 0.09028323739767075]], [[0.08838017284870148, 0.08834240585565567, 0.08830465376377106, 0.08826691657304764, 0.08898071944713593, 0.08819149434566498, 0.09009864181280136, 0.0881161317229271, 0.11170267313718796, 0.08976485580205917, 0.08985136449337006], [0.08832604438066483, 0.08828753978013992, 0.08824906498193741, 0.08821059763431549, 0.08893820643424988, 0.08813372254371643, 0.09007801115512848, 0.08805691450834274, 0.11215633898973465, 0.0897376611828804, 0.08982586115598679], [0.08827175945043564, 0.08823253959417343, 0.08819332718849182, 0.088154137134552, 0.08889555186033249, 0.08807581663131714, 0.09005719423294067, 0.08799755573272705, 0.11261162161827087, 0.0897102952003479, 0.08980020135641098], [0.08821733295917511, 0.0881773829460144, 0.08813745528459549, 0.08809753507375717, 0.08885272592306137, 0.08801776170730591, 0.09003620594739914, 0.08793805539608002, 0.11306852102279663, 0.08968275785446167, 0.08977435529232025], [0.08921773731708527, 0.08919164538383484, 0.08916555345058441, 0.08913947641849518, 0.08963216096162796, 0.0890873447060585, 0.09040128439664841, 0.08903524279594421, 0.10472610592842102, 0.09017196297645569, 0.09023142606019974], [0.08810800313949585, 0.08806660026311874, 0.08802522718906403, 0.0879838615655899, 0.08876655995845795, 0.08790118992328644, 0.08999364823102951, 0.08781860768795013, 0.11398714035749435, 0.08962710946798325, 0.08972209692001343], [0.0906665176153183, 0.09066254645586014, 0.09065858274698257, 0.09065461903810501, 0.09072940051555634, 0.09064668416976929, 0.09084544330835342, 0.09063874930143356, 0.09286662191152573, 0.09081093221902847, 0.09081988781690598], [0.08799804747104645, 0.08795519918203354, 0.08791238069534302, 0.0878695696592331, 0.0886797159910202, 0.08778402209281921, 0.08995033800601959, 0.0876985564827919, 0.1149122342467308, 0.08957073092460632, 0.08966909348964691], [0.1037076935172081, 0.10414818674325943, 0.10459054261445999, 0.10503479093313217, 0.09697216004133224, 0.1059289425611496, 0.0856797844171524, 0.10683070123195648, 0.010168375447392464, 0.0888919085264206, 0.08804688602685928], [0.09024839103221893, 0.09023777395486832, 0.0902271494269371, 0.09021653234958649, 0.09041685611009598, 0.09019529819488525, 0.090728260576725, 0.09017406404018402, 0.09626046568155289, 0.09063557535409927, 0.09065961837768555], [0.09035790711641312, 0.09034900367259979, 0.09034010022878647, 0.09033120423555374, 0.09049904346466064, 0.09031340479850769, 0.09075984358787537, 0.09029561281204224, 0.09536918252706528, 0.0906822457909584, 0.09070237725973129]], [[0.0901370570063591, 0.0922645553946495, 0.09007690846920013, 0.09159435331821442, 0.09217222034931183, 0.08998676389455795, 0.09150268882513046, 0.09052426367998123, 0.08989670127630234, 0.09046386182308197, 0.09138061851263046], [0.09151294082403183, 0.08985559642314911, 0.09156081080436707, 0.0903702825307846, 0.0899261087179184, 0.0916326642036438, 0.09044119715690613, 0.0912061259150505, 0.09170456975698471, 0.0912538394331932, 0.09053583443164825], [0.09009762108325958, 0.09233404695987701, 0.09003443270921707, 0.09162924438714981, 0.09223692864179611, 0.08993973582983017, 0.0915328711271286, 0.09050446003675461, 0.08984513580799103, 0.09044098109006882, 0.09140452742576599], [0.09108345210552216, 0.09060429036617279, 0.09109719842672348, 0.09075376391410828, 0.09062480181455612, 0.09111782163381577, 0.09077431261539459, 0.09099521487951279, 0.09113845229148865, 0.09100895375013351, 0.09080170840024948], [0.09145399183034897, 0.08995821326971054, 0.09149716049432755, 0.09042300283908844, 0.09002190083265305, 0.0915619432926178, 0.0904870331287384, 0.09117729216814041, 0.09162677079439163, 0.09122032672166824, 0.09057246148586273], [0.09003846347332001, 0.09243834018707275, 0.08997072279453278, 0.09168156236410141, 0.09233403205871582, 0.08986920118331909, 0.09157811850309372, 0.09047471731901169, 0.08976779878139496, 0.09040664881467819, 0.0914403647184372], [0.09102442860603333, 0.09070740640163422, 0.09103351086378098, 0.09080635756254196, 0.090720996260643, 0.09104714542627335, 0.09081996232271194, 0.09096609055995941, 0.09106077998876572, 0.09097517281770706, 0.09083809703588486], [0.09039020538330078, 0.09181904047727585, 0.09034965187311172, 0.0913701057434082, 0.09175725281238556, 0.09028884768486023, 0.09130862355232239, 0.09065107256174088, 0.09022808820009232, 0.09061039984226227, 0.09122671186923981], [0.08997929096221924, 0.09254270046949387, 0.08990700542926788, 0.09173386543989182, 0.0924311950802803, 0.08979867398738861, 0.09162333607673645, 0.09044493734836578, 0.08969046920537949, 0.09037227183580399, 0.09147616475820541], [0.09035079181194305, 0.09188833087682724, 0.09030717611312866, 0.09140504896640778, 0.09182180464267731, 0.09024179726839066, 0.0913388729095459, 0.09063137322664261, 0.09017646312713623, 0.09058762341737747, 0.0912507101893425], [0.09094572067260742, 0.0908450111746788, 0.09094860404729843, 0.09087647497653961, 0.09084933251142502, 0.09095292538404465, 0.09088079631328583, 0.09092720597982407, 0.09095725417137146, 0.09093008935451508, 0.09088655561208725]], [[0.09148784726858139, 0.09190013259649277, 0.09144419431686401, 0.09142237901687622, 0.09183436632156372, 0.09181245416402817, 0.09247668832540512, 0.09176865220069885, 0.08172022551298141, 0.09228527545928955, 0.09184769541025162], [0.09110915660858154, 0.09124342352151871, 0.09109491854906082, 0.09108780324459076, 0.09122203290462494, 0.09121490269899368, 0.09143050014972687, 0.09120064973831177, 0.08780182152986526, 0.09136847406625748, 0.09122636914253235], [0.09152558445930481, 0.09196755290031433, 0.09147880226373672, 0.09145541489124298, 0.09189704805612564, 0.09187355637550354, 0.09258585423231125, 0.09182658791542053, 0.08109775185585022, 0.09238055348396301, 0.09191133081912994], [0.0915442705154419, 0.09200108796358109, 0.09149591624736786, 0.09147174656391144, 0.09192820638418198, 0.0919039249420166, 0.09264028817415237, 0.09185538440942764, 0.08078812062740326, 0.09242802858352661, 0.09194297343492508], [0.09117230772972107, 0.09135062247514725, 0.09115340560674667, 0.09114395081996918, 0.09132221341133118, 0.09131274372339249, 0.091599240899086, 0.0912938117980957, 0.08680696785449982, 0.09151680022478104, 0.0913279727101326], [0.09119310975074768, 0.09138613194227219, 0.09117265045642853, 0.09116241335868835, 0.09135537594556808, 0.09134512394666672, 0.09165529906749725, 0.09132462739944458, 0.0864776223897934, 0.0915660411119461, 0.09136161208152771], [0.09050939977169037, 0.09026233851909637, 0.09053566306829453, 0.0905487909913063, 0.09030162543058395, 0.09031473100185394, 0.089919812977314, 0.09034093469381332, 0.09693978726863861, 0.0900331512093544, 0.09029366075992584], [0.09123436361551285, 0.0914568156003952, 0.09121078252792358, 0.09119899570941925, 0.09142136573791504, 0.09140954911708832, 0.09176714718341827, 0.09138593077659607, 0.08582232147455215, 0.09166421741247177, 0.09142854809761047], [0.0922539159655571, 0.099979929625988, 0.09146979451179504, 0.09108023345470428, 0.09870795160531998, 0.09828756004571915, 0.11181392520666122, 0.09745214879512787, 0.012244172394275665, 0.10774584114551544, 0.09896448254585266], [0.09071782976388931, 0.09059635549783707, 0.09073073416948318, 0.09073718637228012, 0.09061568230390549, 0.09062212705612183, 0.09042765200138092, 0.0906350165605545, 0.093822181224823, 0.09048350900411606, 0.0906117632985115], [0.09115958958864212, 0.09132896363735199, 0.09114162623882294, 0.09113264828920364, 0.09130198508501053, 0.09129299223423004, 0.0915650948882103, 0.09127499908208847, 0.0870077982544899, 0.09148679673671722, 0.09130745381116867]]], "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"use_intrinsic_rewards": 1.0, "weights_seq_no": 102.0, "vf_loss": 0.3584163784980774, "policy_loss": -0.0002559540153015405, "vf_explained_var": 0.0016650557518005371, "total_loss": 0.2779247760772705, "diff_num_grad_updates_vs_sampler_policy": 86.0, "num_module_steps_trained": 35910, "entropy": 0.6778863668441772, "vf_loss_unclipped": 42.483890533447266, "module_train_batch_size_mean": 997.498558675304, "num_module_steps_trained_lifetime": 610470, "mean_kl_loss": 1.329073347733356e-05}, "intrinsic_reward_module": {"total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 86.0, "module_train_batch_size_mean": 997.498558675304, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 610470, "weights_seq_no": 102.0}, "__all_modules__": {"num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 3366000, "num_module_steps_trained_lifetime": 1220940, "num_env_steps_trained_lifetime_throughput": 46800.1060298179}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 203490, "num_env_steps_trained_lifetime": 561000, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime_throughput": 4242.341101863618, "num_module_steps_trained_throughput": 19896375.77908759, "num_module_steps_trained_lifetime_throughput": 13518226.10935609}, "intrinsic_reward_module": {"total_loss": 0.0, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "default_optimizer_learning_rate": 0.0002715581955, "module_train_batch_size_mean": 997.6777629636601, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 101745, "weights_seq_no": 17.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 769.2068866407828}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.2508073902566454e-05, "module_to_env_connector": {"connector_pipeline_timer": 0.00011881489742824161, "timers": {"connectors": {"tensor_to_numpy": 1.6213553905307596e-05, "normalize_and_clip_actions": 8.038110500341645e-06, "listify_data_for_vector_env": 1.0729662338935246e-05, "un_batch_to_individual_items": 6.78314566931133e-06, "remove_single_ts_time_rank_from_batch": 1.2125462883126551e-05, "get_actions": 3.8155191118206286e-05}}}, "agent_episode_returns_mean": {"default_agent": 0.1}, "env_step_timer": 1.4687403722808609e-05, "env_reset_timer": 0.0001836534683235474, "env_to_module_connector": {"connector_pipeline_timer": 6.126882237291736e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.359057346299802e-06, "add_observations_from_episodes_to_batch": 2.908941637011976e-06, "add_states_from_episodes_to_batch": 2.9395458046171454e-06, "numpy_to_tensor": 1.2563844173538779e-05, "batch_individual_items": 1.2788454487830051e-05}}}, "sample": 0.11605823323135406, "episode_return_max": 13.5, "episode_len_mean": 20.0, "episode_len_max": 20, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "episode_duration_sec_mean": 0.005361797894584015, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": 0.1}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled_lifetime": 85400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 17.0, "episode_return_min": -15.5, "num_env_steps_sampled": 400, "num_episodes_lifetime": 340, "num_episodes": 20, "episode_return_mean": 0.1, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "time_between_sampling": 9.397525247635306}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "b1709_00000", "date": "2025-08-11_18-35-22", "timestamp": 1754930122, "time_this_iter_s": 9.777939081192017, "time_total_s": 166.95767617225647, "pid": 11351, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3845f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 166.95767617225647, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 46.22857142857142, "ram_util_percent": 80.42142857142858}}
{"timers": {"training_iteration": 9.143869551675932, "restore_env_runners": 1.1786686823221582e-05, "training_step": 9.143721719207006, "env_runner_sampling_timer": 1.6258052190444823, "learner_update_timer": 7.3422038184648235, "synch_weights": 0.0008780573438654993, "restore_eval_env_runners": 1.0585516266043592e-05, "evaluation_iteration": 0.12327559484565351, "synch_eval_env_connectors": 0.00013921156998628715, "synch_env_connectors": 4.667197843502412e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.0001243985452128254, "timers": {"connectors": {"un_batch_to_individual_items": 6.94216384480142e-06, "tensor_to_numpy": 1.602351546107815e-05, "remove_single_ts_time_rank_from_batch": 1.2263448886805078e-05, "normalize_and_clip_actions": 8.201658404406456e-06, "get_actions": 4.259806314432823e-05, "listify_data_for_vector_env": 1.0955261002583462e-05}}}, "time_between_sampling": 0.033585551253779426, "episode_duration_sec_mean": 0.005570343003608286, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -9870000.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.953533859907767e-06, "add_time_dim_to_batch_and_zero_pad": 7.292025814027553e-06, "numpy_to_tensor": 1.3649312591321838e-05, "add_states_from_episodes_to_batch": 2.756485972100237e-06, "batch_individual_items": 1.3009127493786318e-05}}, "connector_pipeline_timer": 6.252386451375777e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "agent_episode_returns_mean": {"default_agent": -1.2600000000000002}, "weights_seq_no": 17.0, "module_episode_returns_mean": {"default_policy": -1.2600000000000002}, "episode_return_min": -13.5, "num_env_steps_sampled": 5000.0, "num_episodes_lifetime": -493500.0, "rlmodule_inference_timer": 3.371031691274321e-05, "episode_len_mean": 20.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "num_episodes": 250.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.5065226390150301e-05, "episode_return_mean": -1.2600000000000002, "env_reset_timer": 4.3677482971195e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "sample": 0.005820048143868178, "episode_return_max": 6.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3096.882562198705}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.135029044983703, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009345843302062586, "add_observations_from_episodes_to_batch": 0.0008365243631147006, "add_columns_from_episodes_to_train_batch": 0.041121900573635586, "add_time_dim_to_batch_and_zero_pad": 0.07562155620497998, "add_states_from_episodes_to_batch": 0.003694064144206008, "batch_individual_items": 0.004177895829704127, "numpy_to_tensor": 7.386985262877372e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "policy_loss": -5.3575091442326084e-05, "use_intrinsic_rewards": 0.0, "weights_seq_no": 18.0, "vf_explained_var": -0.0010193586349487305, "num_trainable_parameters": 16595, "vf_loss": 0.3583120107650757, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 6.163937769088079e-07, "num_module_steps_trained": 5985, "total_loss": 0.2780439555644989, "module_train_batch_size_mean": 997.6672132667843, "num_module_steps_trained_lifetime": 107730, "entropy": 0.6777381896972656, "vf_loss_unclipped": 46.09835433959961, "mean_kl_loss": 3.131127186861704e-06, "num_module_steps_trained_lifetime_throughput": 765.7944913830016}, "IntrinsicAttentionMask": [[[0.09046977013349533, 0.09125401824712753, 0.0904746800661087, 0.091522715985775, 0.09120891988277435, 0.09042996168136597, 0.09117887169122696, 0.09069623798131943, 0.0906812846660614, 0.09066635370254517, 0.09141721576452255], [0.09166014194488525, 0.09031936526298523, 0.09165166318416595, 0.08986713737249374, 0.09039562195539474, 0.0917290449142456, 0.09044649451971054, 0.09126976132392883, 0.09129544347524643, 0.09132112562656403, 0.09004427492618561], [0.09047722816467285, 0.09124815464019775, 0.09048204869031906, 0.09151225537061691, 0.09120382368564606, 0.09043809026479721, 0.09117428213357925, 0.09069985151290894, 0.0906851589679718, 0.09067047387361526, 0.09140855818986893], [0.09206633269786835, 0.09000038355588913, 0.09205321967601776, 0.0893072783946991, 0.0901174396276474, 0.09217294305562973, 0.09019555896520615, 0.0914631113409996, 0.09150274097919464, 0.09154240041971207, 0.0895785391330719], [0.09159187972545624, 0.0903729572892189, 0.09158417582511902, 0.0899614617228508, 0.09044232964515686, 0.091654472053051, 0.09048859775066376, 0.0912371426820755, 0.09126047790050507, 0.09128382056951523, 0.09012266993522644], [0.09040916711091995, 0.09130160510540009, 0.09041474014520645, 0.09160761535167694, 0.09125025570392609, 0.09036388993263245, 0.09121604263782501, 0.0906667560338974, 0.09064975380897522, 0.09063275158405304, 0.09148744493722916], [0.09154637157917023, 0.09040868282318115, 0.09153918921947479, 0.09002438187599182, 0.09047345072031021, 0.09160476922988892, 0.09051666408777237, 0.09121538698673248, 0.0912371575832367, 0.0912589430809021, 0.09017494320869446], [0.09081421792507172, 0.09098357707262039, 0.09081528335809708, 0.09104133397340775, 0.0909738689661026, 0.09080559015274048, 0.09096739441156387, 0.09086324274539948, 0.09086000919342041, 0.09085677564144135, 0.0910186693072319], [0.09079151600599289, 0.09100141376256943, 0.09079282730817795, 0.09107302129268646, 0.0909893736243248, 0.0907808244228363, 0.09098135679960251, 0.09085226058959961, 0.09084825217723846, 0.09084425121545792, 0.09104492515325546], [0.09076880663633347, 0.09101924300193787, 0.09077037870883942, 0.09110470861196518, 0.0910048857331276, 0.09075605124235153, 0.09099531173706055, 0.09084127843379974, 0.09083649516105652, 0.09083171933889389, 0.09107117354869843], [0.09190694987773895, 0.09012556076049805, 0.09189565479755402, 0.08952666819095612, 0.09022664278745651, 0.09199872612953186, 0.09029409289360046, 0.09138738363981247, 0.09142153710126877, 0.09145570546388626, 0.08976113796234131]], [[0.08993072807788849, 0.08944757282733917, 0.08942446112632751, 0.08940135687589645, 0.0893782526254654, 0.08935515582561493, 0.09051858633756638, 0.0897681787610054, 0.1025538444519043, 0.0898536741733551, 0.09036829322576523], [0.08918017148971558, 0.08837348967790604, 0.08833497017621994, 0.08829647302627563, 0.08825799077749252, 0.0882195234298706, 0.09016569703817368, 0.08890844881534576, 0.1112985610961914, 0.08905132859945297, 0.08991331607103348], [0.08914248645305634, 0.08832047134637833, 0.08828122913837433, 0.08824200183153152, 0.08820278942584991, 0.0881635919213295, 0.09014695882797241, 0.08886557817459106, 0.1117340624332428, 0.08901118487119675, 0.08988969773054123], [0.08910464495420456, 0.08826731145381927, 0.08822733163833618, 0.08818738162517548, 0.08814743906259537, 0.08810751885175705, 0.09012803435325623, 0.08882255107164383, 0.11217103898525238, 0.08897087723016739, 0.08986590057611465], [0.08906663954257965, 0.08821399509906769, 0.08817330002784729, 0.08813261985778809, 0.08809196203947067, 0.08805131167173386, 0.09010893106460571, 0.08877938240766525, 0.11260950565338135, 0.08893042057752609, 0.08984194695949554], [0.0890284851193428, 0.08816055953502655, 0.08811913430690765, 0.08807772397994995, 0.08803633600473404, 0.08799497038125992, 0.09008966386318207, 0.08873605728149414, 0.1130494698882103, 0.08888981491327286, 0.08981781452894211], [0.09075260162353516, 0.09066986292600632, 0.09066589921712875, 0.09066193550825119, 0.09065796434879303, 0.09065399318933487, 0.0908527746796608, 0.09072481095790863, 0.09279350191354752, 0.09073943644762039, 0.09082721173763275], [0.08968602120876312, 0.08909342437982559, 0.08906509727239609, 0.08903677016496658, 0.08900845795869827, 0.08898014575242996, 0.09040804952383041, 0.08948656916618347, 0.10542064905166626, 0.08959146589040756, 0.09022334218025208], [0.09537436813116074, 0.10381725430488586, 0.10424059629440308, 0.10466565936803818, 0.10509245842695236, 0.10552100092172623, 0.08607478439807892, 0.09813027828931808, 0.012056543491780758, 0.09667031466960907, 0.08835674822330475], [0.08981569856405258, 0.08928059041500092, 0.08925500512123108, 0.08922941982746124, 0.089203841984272, 0.08917827159166336, 0.09046719968318939, 0.08963564038276672, 0.10390341281890869, 0.08973034471273422, 0.09030058979988098], [0.09055162221193314, 0.09036587923765182, 0.0903569757938385, 0.09034807235002518, 0.09033917635679245, 0.09033028036355972, 0.09077679365873337, 0.09048920124769211, 0.09520070999860764, 0.09052204340696335, 0.0907193124294281]], [[0.09013796597719193, 0.09226549416780472, 0.09067637473344803, 0.09159528464078903, 0.09156472235918045, 0.08998767286539078, 0.09150362014770508, 0.08992762863636017, 0.09049497544765472, 0.09046477824449539, 0.09138154238462448], [0.09151351451873779, 0.08985615521669388, 0.09108754247426987, 0.09037084132432938, 0.09039447456598282, 0.09163323789834976, 0.0904417559504509, 0.09168116748332977, 0.09123055636882782, 0.09125440567731857, 0.09053640812635422], [0.0904889851808548, 0.0916462317109108, 0.0907830148935318, 0.09128300845623016, 0.09126640856266022, 0.09040676802396774, 0.09123323112726212, 0.09037390351295471, 0.09068404138088226, 0.09066756069660187, 0.0911669135093689], [0.09108350425958633, 0.09060434252023697, 0.09096094220876694, 0.09075381606817245, 0.09076065570116043, 0.09111787378787994, 0.09077435731887817, 0.09113162755966187, 0.09100212901830673, 0.09100900590419769, 0.09080176055431366], [0.09106381982564926, 0.09063869714736938, 0.09095510840415955, 0.09077133983373642, 0.09077741950750351, 0.09109430760145187, 0.09078957140445709, 0.09110650420188904, 0.09099164605140686, 0.09099774062633514, 0.09081389009952545], [0.09003962576389313, 0.09243953227996826, 0.09064628928899765, 0.09168274700641632, 0.09164825081825256, 0.08987035602331161, 0.09157929569482803, 0.08980274200439453, 0.09044183790683746, 0.09040780365467072, 0.09144154191017151], [0.09102445840835571, 0.0907074362039566, 0.09094341844320297, 0.09080638736486435, 0.09081091731786728, 0.09104717522859573, 0.09081999212503433, 0.09105626493692398, 0.09097065776586533, 0.09097520262002945, 0.09083811938762665], [0.09000028669834137, 0.0925092101097107, 0.09063422679901123, 0.09171772748231888, 0.09168165922164917, 0.08982344716787338, 0.09160955250263214, 0.08975280821323395, 0.09042056649923325, 0.09038500487804413, 0.091465525329113], [0.09037093818187714, 0.09185413271188736, 0.09074728190898895, 0.0913880243897438, 0.09136674553155899, 0.09026576578617096, 0.09132419526576996, 0.09022372961044312, 0.09062056243419647, 0.09059946238994598, 0.09123916178941727], [0.09035126864910126, 0.09188881516456604, 0.09074131399393082, 0.09140553325414658, 0.09138346463441849, 0.09024226665496826, 0.0913393497467041, 0.09019871056079865, 0.09060996770858765, 0.09058810025453568, 0.0912511944770813], [0.09094572812318802, 0.0908450186252594, 0.09092000871896744, 0.09087648242712021, 0.09087791293859482, 0.09095293283462524, 0.09088080376386642, 0.09095581620931625, 0.09092865139245987, 0.09093008935451508, 0.09088656306266785]], [[0.08984758704900742, 0.08936488628387451, 0.08980116248130798, 0.08931870758533478, 0.08929562568664551, 0.08927255123853683, 0.09089989215135574, 0.08968519419431686, 0.10245904326438904, 0.08977060765028, 0.09028474986553192], [0.08904208242893219, 0.08823665231466293, 0.08896448463201523, 0.08815975487232208, 0.08812133222818375, 0.08808291703462601, 0.09080825746059418, 0.0887707769870758, 0.11112622916698456, 0.0889134407043457, 0.08977409452199936], [0.08977306634187698, 0.089259073138237, 0.0897236242890358, 0.0892099067568779, 0.08918534219264984, 0.08916077762842178, 0.09089422225952148, 0.08960012346506119, 0.10326404124498367, 0.08969108760356903, 0.09023872762918472], [0.08896137773990631, 0.08812538534402847, 0.08888081461191177, 0.08804558217525482, 0.08800571411848068, 0.08796585351228714, 0.0907955914735794, 0.08867974579334259, 0.11199069023132324, 0.08882782608270645, 0.08972141891717911], [0.08892078697681427, 0.08806955069303513, 0.08883874863386154, 0.08798830211162567, 0.08794770389795303, 0.08790712058544159, 0.09078899025917053, 0.08863399922847748, 0.11242511123418808, 0.08878479152917862, 0.08969482779502869], [0.08888006210327148, 0.08801358938217163, 0.08879655599594116, 0.08793088793754578, 0.08788957446813583, 0.08784827589988708, 0.09078223258256912, 0.08858812600374222, 0.1128610149025917, 0.08874163031578064, 0.08966808766126633], [0.09137850254774094, 0.09161732345819473, 0.09140139073133469, 0.09164027124643326, 0.09165174514055252, 0.09166322648525238, 0.09086441248655319, 0.09145864099264145, 0.08574418723583221, 0.09141646325588226, 0.09116385132074356], [0.08958422392606735, 0.08899230509996414, 0.08952726423740387, 0.08893571048974991, 0.08890742808580399, 0.08887915313243866, 0.09087719023227692, 0.0893850028514862, 0.10530100017786026, 0.08948978036642075, 0.09012094140052795], [0.09680360555648804, 0.10537301748991013, 0.09759468585252762, 0.10623413324356079, 0.10666733235120773, 0.10710228979587555, 0.08058705180883408, 0.09960081428289413, 0.012237210758030415, 0.09811896830797195, 0.08968082070350647], [0.08972369879484177, 0.08918914198875427, 0.0896722674369812, 0.08913801610469818, 0.08911246806383133, 0.08908692002296448, 0.09089013189077377, 0.08954381942749023, 0.10379698127508163, 0.08963842689990997, 0.09020809084177017], [0.09051953256130219, 0.09033385664224625, 0.09050170332193375, 0.0903160572052002, 0.09030716121196747, 0.09029826521873474, 0.09092219918966293, 0.09045713394880295, 0.09516697376966476, 0.09048996865749359, 0.09068716317415237]], [[0.09019200503826141, 0.09171139448881149, 0.09013181924819946, 0.09165018796920776, 0.09222841262817383, 0.0900416150689125, 0.09155847132205963, 0.08998153358697891, 0.09054922312498093, 0.0905190035700798, 0.09143631905317307], [0.09110765159130096, 0.09068683534860611, 0.0911245122551918, 0.09070361405611038, 0.0905456617474556, 0.09114979952573776, 0.09072878211736679, 0.0911666601896286, 0.09100791066884995, 0.09101632237434387, 0.09076235443353653], [0.09015538543462753, 0.09175235033035278, 0.09009215980768204, 0.09168799966573715, 0.0922960713505745, 0.08999739587306976, 0.09159155935049057, 0.08993428200483322, 0.09053072333335876, 0.09049897640943527, 0.0914631336927414], [0.09107108414173126, 0.09072774648666382, 0.09108483046293259, 0.09074144810438156, 0.0906125083565712, 0.09110545367002487, 0.09076198935508728, 0.0911192074418068, 0.09098973125219345, 0.09099660068750381, 0.09078938513994217], [0.0914154052734375, 0.0903422087430954, 0.09145855158567429, 0.09038485586643219, 0.08998391032218933, 0.09152330458164215, 0.09044884890317917, 0.09156650304794312, 0.09116032719612122, 0.09118182957172394, 0.09053424745798111], [0.09010045975446701, 0.09181377291679382, 0.0900326669216156, 0.09174469113349915, 0.09239761531352997, 0.08993107825517654, 0.09164117276668549, 0.08986341953277588, 0.09050294756889343, 0.0904688909649849, 0.0915033295750618], [0.0910162478685379, 0.09078913927078247, 0.09102533012628555, 0.09079819917678833, 0.09071283787488937, 0.09103896468877792, 0.09081180393695831, 0.09104805439710617, 0.09096245467662811, 0.09096699953079224, 0.09082993119955063], [0.09006382524967194, 0.09185472130775452, 0.08999300003051758, 0.09178248047828674, 0.092465341091156, 0.0898868590593338, 0.09167423099279404, 0.08981617540121078, 0.09048440307378769, 0.09044881910085678, 0.09153009951114655], [0.0904087945818901, 0.09146890044212341, 0.09036669135093689, 0.0914263054728508, 0.09182842820882797, 0.09030357748270035, 0.09136244654655457, 0.09026152640581131, 0.0906585231423378, 0.09063740819692612, 0.09127737581729889], [0.09039049595594406, 0.09148938208818436, 0.09034685790538788, 0.09144521504640579, 0.09186215698719025, 0.09028144925832748, 0.09137900918722153, 0.09023787081241608, 0.0906493067741394, 0.09062743186950684, 0.09129081666469574], [0.09094312787055969, 0.09087099879980087, 0.0909460037946701, 0.09087388217449188, 0.09084673970937729, 0.09095033258199692, 0.0908782035112381, 0.09095321595668793, 0.09092605859041214, 0.09092748910188675, 0.09088396281003952]], [[0.09164267033338547, 0.09205566346645355, 0.09159895032644272, 0.09157709777355194, 0.09155524522066116, 0.09153340756893158, 0.0926331952214241, 0.09192395955324173, 0.08147183805704117, 0.09200478345155716, 0.09200313687324524], [0.09116023033857346, 0.09129456430673599, 0.09114598482847214, 0.09113886207342148, 0.09113173931837082, 0.09112461656332016, 0.0914817526936531, 0.09125177562236786, 0.08771489560604095, 0.09127804636955261, 0.09127750247716904], [0.09169133007526398, 0.09213409572839737, 0.09164446592330933, 0.091621033847332, 0.09159761667251587, 0.09157419949769974, 0.09275352209806442, 0.09199288487434387, 0.08083348721265793, 0.09207955002784729, 0.09207777678966522], [0.0917154848575592, 0.09217315167188644, 0.091667041182518, 0.091642826795578, 0.0916186273097992, 0.09159442037343979, 0.09281355887651443, 0.09202718734741211, 0.0805160403251648, 0.09211677312850952, 0.09211494028568268], [0.09173950552940369, 0.09221209585666656, 0.09168948233127594, 0.09166449308395386, 0.09163949638605118, 0.09161451458930969, 0.09287349134683609, 0.092061348259449, 0.0801997110247612, 0.09215386211872101, 0.09215196967124939], [0.09176341444253922, 0.09225092083215714, 0.09171181917190552, 0.09168603271245956, 0.09166025370359421, 0.09163448214530945, 0.09293334186077118, 0.09209541231393814, 0.07988452166318893, 0.09219085425138474, 0.09218890219926834], [0.09041360765695572, 0.09016681462526321, 0.09043984115123749, 0.09045296162366867, 0.09046608954668045, 0.09047921001911163, 0.08982464671134949, 0.090245321393013, 0.09711634367704391, 0.0901971161365509, 0.0901980996131897], [0.09131862968206406, 0.09154129773378372, 0.0912950336933136, 0.09128323197364807, 0.09127143770456314, 0.09125963598489761, 0.09185191243886948, 0.09147033840417862, 0.08568155765533447, 0.09151389449834824, 0.0915130004286766], [0.09461137652397156, 0.10286184400320053, 0.09377551823854446, 0.09336035698652267, 0.09294702857732773, 0.09253554046154022, 0.11554762721061707, 0.10015960037708282, 0.01061508059501648, 0.10181000083684921, 0.10177598893642426], [0.09122193604707718, 0.09139032661914825, 0.09120407700538635, 0.09119515120983124, 0.09118623286485672, 0.0911773070693016, 0.09162507206201553, 0.0913366749882698, 0.08692474663257599, 0.09136960655450821, 0.09136893600225449], [0.09122391790151596, 0.09139341861009598, 0.09120594710111618, 0.09119696170091629, 0.0911879763007164, 0.0911789983510971, 0.09162971377372742, 0.09133941680192947, 0.08689915388822556, 0.09137256443500519, 0.09137188643217087]]], "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"use_intrinsic_rewards": 1.0, "weights_seq_no": 108.0, "vf_loss": 0.3584159016609192, "policy_loss": -5.161498484085314e-05, "vf_explained_var": 0.0015978813171386719, "total_loss": 0.2781272530555725, "diff_num_grad_updates_vs_sampler_policy": 91.0, "num_module_steps_trained": 35910, "entropy": 0.6777560114860535, "vf_loss_unclipped": 45.96640396118164, "module_train_batch_size_mean": 997.4982334615715, "num_module_steps_trained_lifetime": 646380, "mean_kl_loss": 2.874502797567402e-06}, "intrinsic_reward_module": {"total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 91.0, "module_train_batch_size_mean": 997.4982334615715, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 646380, "weights_seq_no": 108.0}, "__all_modules__": {"num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 3564000, "num_module_steps_trained_lifetime": 1292760, "num_env_steps_trained_lifetime_throughput": 46089.12040697309}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 215460, "num_env_steps_trained_lifetime": 594000, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime_throughput": 4223.514703648805, "num_module_steps_trained_throughput": 19462202.429317497, "num_module_steps_trained_lifetime_throughput": 13431419.148680005}, "intrinsic_reward_module": {"total_loss": 0.0, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "default_optimizer_learning_rate": 0.0002715581955, "module_train_batch_size_mean": 997.6672132667843, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 107730, "weights_seq_no": 18.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 765.8000230036955}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.310747048845911e-05, "module_to_env_connector": {"connector_pipeline_timer": 0.0001194185351884133, "timers": {"connectors": {"tensor_to_numpy": 1.576667478265483e-05, "normalize_and_clip_actions": 8.411107823089856e-06, "listify_data_for_vector_env": 1.087272962200357e-05, "un_batch_to_individual_items": 6.688485440275018e-06, "remove_single_ts_time_rank_from_batch": 1.2213483316091655e-05, "get_actions": 3.8308633182249044e-05}}}, "agent_episode_returns_mean": {"default_agent": 1.3}, "env_step_timer": 1.4967108136090454e-05, "env_reset_timer": 0.00018580151345677255, "env_to_module_connector": {"connector_pipeline_timer": 6.215429510060005e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.530639612581879e-06, "add_observations_from_episodes_to_batch": 2.995090379321184e-06, "add_states_from_episodes_to_batch": 2.8256090857547626e-06, "numpy_to_tensor": 1.270959456573661e-05, "batch_individual_items": 1.2984934894458372e-05}}}, "sample": 0.11615500839860271, "episode_return_max": 13.5, "episode_len_mean": 20.0, "episode_len_max": 20, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "episode_duration_sec_mean": 0.005445725379977375, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": 1.3}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled_lifetime": 90400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 18.0, "episode_return_min": -15.5, "num_env_steps_sampled": 400, "num_episodes_lifetime": 360, "num_episodes": 20, "episode_return_mean": 1.3, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "time_between_sampling": 9.401205254329522}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "b1709_00000", "date": "2025-08-11_18-35-31", "timestamp": 1754930131, "time_this_iter_s": 9.873293161392212, "time_total_s": 176.83096933364868, "pid": 11351, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3845f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 176.83096933364868, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 52.9857142857143, "ram_util_percent": 80.32142857142857}}
{"timers": {"training_iteration": 9.150455957829237, "restore_env_runners": 1.1729240671170763e-05, "training_step": 9.150307469515083, "env_runner_sampling_timer": 1.627188186443538, "learner_update_timer": 7.347074911109873, "synch_weights": 0.0008792271803030271, "restore_eval_env_runners": 1.0852580124557468e-05, "evaluation_iteration": 0.12343148472706268, "synch_eval_env_connectors": 0.0001398427840119133, "synch_env_connectors": 4.706355389390732e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.0001358235839686503, "timers": {"connectors": {"un_batch_to_individual_items": 7.263509098733899e-06, "tensor_to_numpy": 1.7407525406876973e-05, "remove_single_ts_time_rank_from_batch": 1.3100491757867432e-05, "normalize_and_clip_actions": 8.917900353018604e-06, "get_actions": 4.816678569580098e-05, "listify_data_for_vector_env": 1.1721733078675194e-05}}}, "time_between_sampling": 0.03369313904987593, "episode_duration_sec_mean": 0.0060252023055218165, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -10487500.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.2147135671425257e-06, "add_time_dim_to_batch_and_zero_pad": 7.880415474633785e-06, "numpy_to_tensor": 1.470266907582991e-05, "add_states_from_episodes_to_batch": 2.983560063864454e-06, "batch_individual_items": 1.4024580223160877e-05}}, "connector_pipeline_timer": 6.660371671204533e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "agent_episode_returns_mean": {"default_agent": -1.8199999999999996}, "weights_seq_no": 18.0, "module_episode_returns_mean": {"default_policy": -1.8199999999999996}, "episode_return_min": -13.5, "num_env_steps_sampled": 5000.0, "num_episodes_lifetime": -524375.0, "rlmodule_inference_timer": 3.6681881403479665e-05, "episode_len_mean": 20.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "num_episodes": 250.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.6341422606570684e-05, "episode_return_mean": -1.8199999999999996, "env_reset_timer": 5.3213841811755476e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "sample": 0.0063958387914829565, "episode_return_max": 6.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 2952.4782166854166}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13523514869342698, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009347158618630018, "add_observations_from_episodes_to_batch": 0.0008378191196979067, "add_columns_from_episodes_to_train_batch": 0.041187654067063054, "add_time_dim_to_batch_and_zero_pad": 0.07575308148290141, "add_states_from_episodes_to_batch": 0.0036967697534254105, "batch_individual_items": 0.004181608952378684, "numpy_to_tensor": 7.384156346994301e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "policy_loss": -1.414080907125026e-05, "use_intrinsic_rewards": 0.0, "weights_seq_no": 19.0, "vf_explained_var": -0.0007216930389404297, "num_trainable_parameters": 16595, "vf_loss": 0.35831010341644287, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 3.0819688845440396e-07, "num_module_steps_trained": 5985, "total_loss": 0.27808237075805664, "module_train_batch_size_mean": 997.6572809365935, "num_module_steps_trained_lifetime": 113715, "entropy": 0.6774076819419861, "vf_loss_unclipped": 47.5533447265625, "mean_kl_loss": 3.688599690576666e-06, "num_module_steps_trained_lifetime_throughput": 762.7534310133032}, "IntrinsicAttentionMask": [[[0.0901380181312561, 0.09165649861097336, 0.09067642688751221, 0.09159533679485321, 0.09217321127653122, 0.08998772501945496, 0.09150367230176926, 0.08992767333984375, 0.0904950276017189, 0.09046483039855957, 0.09138159453868866], [0.09112287312746048, 0.09070198237895966, 0.09097260981798172, 0.09071876108646393, 0.09056078642606735, 0.09116502851247787, 0.09074393659830093, 0.09118188917636871, 0.09102310985326767, 0.0910315290093422, 0.09077751636505127], [0.09048900753259659, 0.09131621569395065, 0.090783029794693, 0.09128301590681076, 0.09159627556800842, 0.09040678292512894, 0.09123323857784271, 0.0903739184141159, 0.09068405628204346, 0.09066756814718246, 0.0911669209599495], [0.09108350425958633, 0.09074011445045471, 0.09096094220876694, 0.09075381606817245, 0.0906248539686203, 0.09111787378787994, 0.09077435731887817, 0.09113162755966187, 0.09100212901830673, 0.09100900590419769, 0.09080176055431366], [0.09145446866750717, 0.09038081765174866, 0.0910702720284462, 0.09042347967624664, 0.09002237021923065, 0.091562420129776, 0.09048750251531601, 0.09160563349723816, 0.09119927883148193, 0.09122079610824585, 0.09057293087244034], [0.0900396928191185, 0.09175185114145279, 0.09064635634422302, 0.09168282151222229, 0.0923352986574173, 0.08987042307853699, 0.0915793627500534, 0.0898028090596199, 0.09044190496206284, 0.09040787816047668, 0.09144160896539688], [0.09102445095777512, 0.0907973200082779, 0.09094341099262238, 0.09080637991428375, 0.0907210111618042, 0.09104716777801514, 0.09081998467445374, 0.09105625748634338, 0.09097065031528473, 0.09097519516944885, 0.09083811193704605], [0.09000036120414734, 0.09178999811410904, 0.0906343087553978, 0.09171780943870544, 0.09240018576383591, 0.08982352167367935, 0.09160963445901871, 0.08975288271903992, 0.09042064100503922, 0.0903850793838501, 0.09146560728549957], [0.09037096053361893, 0.09143062680959702, 0.09074730426073074, 0.09138805419206619, 0.09179000556468964, 0.09026579558849335, 0.09132422506809235, 0.0902237594127655, 0.09062058478593826, 0.09059947729110718, 0.09123918414115906], [0.09035129100084305, 0.09144970029592514, 0.09074133634567261, 0.09140555560588837, 0.0918223187327385, 0.09024229645729065, 0.09133938699960709, 0.09019874036312103, 0.09060999751091003, 0.09058813005685806, 0.09125122427940369], [0.09094573557376862, 0.0908736065030098, 0.09092000871896744, 0.0908764898777008, 0.09084933996200562, 0.09095294028520584, 0.09088081121444702, 0.09095582365989685, 0.09092865884304047, 0.09093009680509567, 0.09088657051324844]], [[0.08839774131774902, 0.08835996687412262, 0.0890745148062706, 0.0882844626903534, 0.08899840712547302, 0.08820902556180954, 0.09011655300855637, 0.08888436108827591, 0.11078131198883057, 0.08902440965175629, 0.08986922353506088], [0.08834433555603027, 0.08830583840608597, 0.08903423696756363, 0.08822888135910034, 0.08895664662122726, 0.08815198391675949, 0.09009667485952377, 0.08884038031101227, 0.11121337860822678, 0.08898315578699112, 0.0898444876074791], [0.08932798355817795, 0.08930337429046631, 0.08976815640926361, 0.08925418555736542, 0.08971870690584183, 0.08920502662658691, 0.09044357389211655, 0.08964458853006363, 0.10331530123949051, 0.08973560482263565, 0.09028351306915283], [0.08823712915182114, 0.08819717168807983, 0.08895321190357208, 0.08811730146408081, 0.08887266367673874, 0.08803750574588776, 0.090056411921978, 0.08875197917222977, 0.11208193004131317, 0.08890017867088318, 0.08979450166225433], [0.08922582119703293, 0.0891997218132019, 0.08969274163246155, 0.08914756029844284, 0.0896402895450592, 0.08909542113542557, 0.09040948748588562, 0.08956166356801987, 0.10412946343421936, 0.0896582081913948, 0.09023959934711456], [0.08812936395406723, 0.08808795362710953, 0.08887157589197159, 0.0880051851272583, 0.08878807723522186, 0.08792249858379364, 0.0900154709815979, 0.08866297453641891, 0.11295638978481293, 0.08881660550832748, 0.08974384516477585], [0.09066669642925262, 0.09066272526979446, 0.09073751419782639, 0.09065479040145874, 0.09072957932949066, 0.09064686298370361, 0.09084562212228775, 0.09071766585111618, 0.09278619289398193, 0.09073229134082794, 0.0908200666308403], [0.0890716016292572, 0.0890432819724083, 0.0895785465836525, 0.08898665010929108, 0.08952157944440842, 0.08893007040023804, 0.09035716205835342, 0.08943620324134827, 0.10536133497953415, 0.08954104781150818, 0.09017256647348404], [0.10425243526697159, 0.10467755049467087, 0.09695056825876236, 0.10553298890590668, 0.09774285554885864, 0.1063954159617424, 0.08678803592920303, 0.09894344955682755, 0.012156419456005096, 0.09747137129306793, 0.08908891677856445], [0.08926079422235489, 0.08923520892858505, 0.08971858769655228, 0.08918405324220657, 0.08966715633869171, 0.08913294225931168, 0.09042120724916458, 0.08959007263183594, 0.1038506031036377, 0.08968472480773926, 0.09025468677282333], [0.09035880118608475, 0.09034989774227142, 0.09051778167486191, 0.09033209830522537, 0.09049994498491287, 0.09031429886817932, 0.0907607451081276, 0.09047320485115051, 0.09518387913703918, 0.09050603210926056, 0.09070327132940292]], [[0.09052333980798721, 0.09130805730819702, 0.09052824974060059, 0.09157691150903702, 0.09126293659210205, 0.09048350900411606, 0.0915316566824913, 0.09045369923114777, 0.09043879806995392, 0.090720035135746, 0.09117275476455688], [0.09156651794910431, 0.09022711217403412, 0.0915580466389656, 0.08977534621953964, 0.09030328691005707, 0.09163534641265869, 0.08985114097595215, 0.0916869193315506, 0.09171271324157715, 0.09122784435749054, 0.09045583009719849], [0.0905299112200737, 0.09130128473043442, 0.09053473174571991, 0.09156554192304611, 0.09125693142414093, 0.09049075096845627, 0.09152106195688248, 0.09046144038438797, 0.09044678509235382, 0.09072326868772507, 0.09116829186677933], [0.09192100167274475, 0.08985830843448639, 0.09190790355205536, 0.0891662985086441, 0.08997518569231033, 0.0920274406671524, 0.08928227424621582, 0.09210722148418427, 0.09214713424444199, 0.09139788895845413, 0.09020937979221344], [0.09150686860084534, 0.09028907865285873, 0.09149917215108871, 0.08987796306610107, 0.09035838395357132, 0.09156940132379532, 0.08994695544242859, 0.09161625802516937, 0.0916396901011467, 0.09119910001754761, 0.09049715101718903], [0.09047005325555801, 0.09136310964822769, 0.09047563374042511, 0.09166932106018066, 0.09131172299385071, 0.09042475372552872, 0.09161777049303055, 0.09039084613323212, 0.09037389606237411, 0.09069380164146423, 0.0912090465426445], [0.09186142683029175, 0.08992032706737518, 0.09184911102056503, 0.0892685279250145, 0.09003037959337234, 0.09196152538061142, 0.08937777578830719, 0.09203653782606125, 0.09207407385110855, 0.0913693979382515, 0.0902508869767189], [0.09043014794588089, 0.09140431880950928, 0.09043623507022858, 0.09173854440450668, 0.09134823828935623, 0.09038075059652328, 0.09168227016925812, 0.09034378826618195, 0.09032531082630157, 0.09067413955926895, 0.09123620390892029], [0.09041020274162292, 0.09142492711544037, 0.09041653573513031, 0.09177317470312119, 0.09136650711297989, 0.09035876393318176, 0.0917145311832428, 0.09032026678323746, 0.0903010293841362, 0.09066430479288101, 0.09124977886676788], [0.09078600257635117, 0.09103649109601974, 0.09078757464885712, 0.09112197160720825, 0.09102212637662888, 0.09077324718236923, 0.09110759198665619, 0.09076370298862457, 0.09075892716646194, 0.09084893018007278, 0.09099340438842773], [0.091387540102005, 0.09041300415992737, 0.09138138592243195, 0.09008342027664185, 0.09046853333711624, 0.09143751114606857, 0.0901387482881546, 0.09147495031356812, 0.09149367362260818, 0.09114149212837219, 0.09057969599962234]], [[0.0912252813577652, 0.09109298139810562, 0.09121257811784744, 0.09120623022317886, 0.09107395261526108, 0.0910676121711731, 0.09138555824756622, 0.09105493128299713, 0.08814678341150284, 0.09133031964302063, 0.0912037342786789], [0.09199788421392441, 0.09152521193027496, 0.09195242077112198, 0.09192969650030136, 0.09145738184452057, 0.0914347842335701, 0.09257283806800842, 0.09138960391283035, 0.08144495636224747, 0.09237439930438995, 0.09192080050706863], [0.09130147844552994, 0.09113671630620956, 0.09128566086292267, 0.09127775579690933, 0.09111302345991135, 0.09110512584447861, 0.09150117635726929, 0.09108933806419373, 0.0874827578663826, 0.0914323478937149, 0.09127464890480042], [0.09133941680192947, 0.09115839004516602, 0.09132202714681625, 0.09131333976984024, 0.09113236516714096, 0.09112369269132614, 0.09155884385108948, 0.0911063477396965, 0.08715242892503738, 0.0914832055568695, 0.09130993485450745], [0.09210523217916489, 0.09158322960138321, 0.09205501526594162, 0.09202991425991058, 0.09150834381580353, 0.09148339927196503, 0.09274057298898697, 0.09143351763486862, 0.0805194303393364, 0.09252124279737473, 0.09202008694410324], [0.0921408012509346, 0.09160234034061432, 0.09208899736404419, 0.09206310659646988, 0.09152510017156601, 0.09149936586618423, 0.09279631078243256, 0.09144792705774307, 0.08021305501461029, 0.09257000684738159, 0.09205296635627747], [0.09022574126720428, 0.09049896150827408, 0.09025192260742188, 0.09026502072811127, 0.09053834527730942, 0.0905514806509018, 0.08989639580249786, 0.09057775884866714, 0.09691455960273743, 0.09000970423221588, 0.09027014672756195], [0.09221163392066956, 0.09164021909236908, 0.09215664863586426, 0.0921291708946228, 0.09155826270580292, 0.09153096377849579, 0.09290752559900284, 0.09147638827562332, 0.07960349321365356, 0.09266724437475204, 0.09211840480566025], [0.1011909693479538, 0.0925777330994606, 0.1003308817744255, 0.09990357607603073, 0.09139992296695709, 0.09101065993309021, 0.11268637329339981, 0.0902371034026146, 0.012339642271399498, 0.10858653485774994, 0.09973663836717606], [0.09057831764221191, 0.09071267396211624, 0.090591199696064, 0.09059764444828033, 0.09073203057050705, 0.09073848277330399, 0.0904160812497139, 0.09075138717889786, 0.09381017833948135, 0.09047193080186844, 0.09060017019510269], [0.09135424345731735, 0.09116685390472412, 0.09133624285459518, 0.0913272500038147, 0.09113990515470505, 0.09113093465566635, 0.09158141165971756, 0.09111297875642776, 0.0870233029127121, 0.0915030986070633, 0.09132372587919235]], [[0.09052358567714691, 0.09130830317735672, 0.09052848815917969, 0.09157715737819672, 0.09126317501068115, 0.09048375487327576, 0.09123310446739197, 0.09045393764972687, 0.09073522686958313, 0.0907202810049057, 0.09117300063371658], [0.09156720340251923, 0.09022779017686844, 0.09155873209238052, 0.08977601677179337, 0.09030396491289139, 0.0916360393166542, 0.090354785323143, 0.09168760478496552, 0.09120287001132965, 0.09122852981090546, 0.0904565081000328], [0.09053013473749161, 0.09130150824785233, 0.09053494781255722, 0.09156576544046402, 0.09125715494155884, 0.09049097448587418, 0.09122759848833084, 0.09046166390180588, 0.09073818475008011, 0.09072348475456238, 0.09116851538419724], [0.09192264825105667, 0.08985991030931473, 0.09190955013036728, 0.08916789293289185, 0.08997678756713867, 0.09202909469604492, 0.09005478769540787, 0.09210886806249619, 0.0913599357008934, 0.09139952808618546, 0.09021099656820297], [0.0915074422955513, 0.0902896374464035, 0.09149973839521408, 0.08987852185964584, 0.09035894274711609, 0.09156996756792068, 0.09040517359972, 0.09161682426929474, 0.091176338493824, 0.09119966626167297, 0.0904977098107338], [0.09047037363052368, 0.09136342257261276, 0.09047595411539078, 0.09166964143514633, 0.09131204336881638, 0.09042507410049438, 0.09127780795097351, 0.09039115905761719, 0.09071113169193268, 0.0906941220164299, 0.09120936691761017], [0.09146760404109955, 0.09033088386058807, 0.09146042168140411, 0.08994691073894501, 0.09039559960365295, 0.09152594953775406, 0.09043877571821213, 0.09156965464353561, 0.09115865081548691, 0.09118041396141052, 0.09052517265081406], [0.09043052047491074, 0.09140468388795853, 0.09043660014867783, 0.09173891693353653, 0.09134861081838608, 0.09038112312555313, 0.0913112461566925, 0.0903441533446312, 0.09069305658340454, 0.0906745046377182, 0.09123656898736954], [0.09080594778060913, 0.09101588279008865, 0.09080726653337479, 0.09108750522136688, 0.09100384265184402, 0.09079526364803314, 0.09099582582712173, 0.09078725427389145, 0.0908626988530159, 0.09085869789123535, 0.09097978472709656], [0.09078602492809296, 0.09103651344776154, 0.09078759700059891, 0.09112199395895004, 0.09102214872837067, 0.09077326953411102, 0.09101257473230362, 0.09076372534036636, 0.0908537283539772, 0.09084895253181458, 0.09099342674016953], [0.09138792008161545, 0.09041338413953781, 0.09138176590204239, 0.09008379280567169, 0.09046890586614609, 0.09143789112567902, 0.09050595015287399, 0.09147533029317856, 0.09112322330474854, 0.09114187210798264, 0.09058007597923279]], [[0.08838009089231491, 0.08909480273723602, 0.0883045643568039, 0.08826682716608047, 0.08822911232709885, 0.08819141238927841, 0.0900985598564148, 0.08811605721712112, 0.11170262843370438, 0.08976477384567261, 0.08985128253698349], [0.08937211334705353, 0.08982284367084503, 0.08932441473007202, 0.08930057287216187, 0.08927673101425171, 0.08925289660692215, 0.09045355021953583, 0.08920525759458542, 0.10344914346933365, 0.0902441143989563, 0.09029841423034668], [0.08827167004346848, 0.08901406079530716, 0.08819323033094406, 0.08815404772758484, 0.08811487257480621, 0.08807571232318878, 0.09005710482597351, 0.08799746632575989, 0.1126115620136261, 0.08971019834280014, 0.08980010449886322], [0.08821722120046616, 0.08897344768047333, 0.08813734352588654, 0.08809742331504822, 0.08805752545595169, 0.08801764994859695, 0.09003610163927078, 0.08793795108795166, 0.11306844651699066, 0.08968264609575272, 0.0897742435336113], [0.0881626307964325, 0.08893266320228577, 0.08808129280805588, 0.08804066479206085, 0.08800004422664642, 0.08795943856239319, 0.09001491963863373, 0.08787829428911209, 0.11352694779634476, 0.08965491503477097, 0.08974820375442505], [0.08810789883136749, 0.08889170736074448, 0.08802510797977448, 0.08798374980688095, 0.08794241398572922, 0.08790108561515808, 0.08999355137348175, 0.08781849592924118, 0.11398707330226898, 0.08962700515985489, 0.08972199261188507], [0.0906665176153183, 0.09074130654335022, 0.09065857529640198, 0.09065461158752441, 0.09065064787864685, 0.09064667671918869, 0.09084544330835342, 0.09063874185085297, 0.09286660701036453, 0.09081093221902847, 0.09081988781690598], [0.0879979357123375, 0.08880926668643951, 0.08791226893663406, 0.08786945790052414, 0.087826669216156, 0.08778391033411026, 0.08995023369789124, 0.08769844472408295, 0.11491215974092484, 0.08957061916589737, 0.08966898918151855], [0.10369656980037689, 0.09573666006326675, 0.10457933694124222, 0.10502352565526962, 0.10546960681676865, 0.10591758787631989, 0.08567054569721222, 0.10681924968957901, 0.010167215950787067, 0.08888234198093414, 0.0880374014377594], [0.09024838358163834, 0.0904487743973732, 0.0902271494269371, 0.09021652489900589, 0.09020590782165527, 0.09019529074430466, 0.09072825312614441, 0.09017406404018402, 0.09626046568155289, 0.09063556790351868, 0.09065961837768555], [0.09035789966583252, 0.0905257984995842, 0.09034010022878647, 0.09033119678497314, 0.09032230079174042, 0.09031340479850769, 0.09075984358787537, 0.09029561281204224, 0.09536918252706528, 0.09068223834037781, 0.0907023698091507]]], "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"use_intrinsic_rewards": 1.0, "weights_seq_no": 114.0, "vf_loss": 0.35841259360313416, "policy_loss": -1.2019411769870203e-05, "vf_explained_var": 0.0016103386878967285, "total_loss": 0.2781650125980377, "diff_num_grad_updates_vs_sampler_policy": 96.0, "num_module_steps_trained": 35910, "entropy": 0.6773979067802429, "vf_loss_unclipped": 47.4112663269043, "module_train_batch_size_mean": 997.4980069784294, "num_module_steps_trained_lifetime": 682290, "mean_kl_loss": 3.8196340028662235e-06}, "intrinsic_reward_module": {"total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 96.0, "module_train_batch_size_mean": 997.4980069784294, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 682290, "weights_seq_no": 114.0}, "__all_modules__": {"num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 3762000, "num_module_steps_trained_lifetime": 1364580, "num_env_steps_trained_lifetime_throughput": 45400.31350695503}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 227430, "num_env_steps_trained_lifetime": 627000, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime_throughput": 4206.704836149085, "num_module_steps_trained_throughput": 19033996.04079491, "num_module_steps_trained_lifetime_throughput": 13332253.865042323}, "intrinsic_reward_module": {"total_loss": 0.0, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "default_optimizer_learning_rate": 0.0002715581955, "module_train_batch_size_mean": 997.6572809365935, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 113715, "weights_seq_no": 19.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 762.7585778090464}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.168580867710392e-05, "module_to_env_connector": {"connector_pipeline_timer": 0.00011738481363840361, "timers": {"connectors": {"tensor_to_numpy": 1.5541611776840364e-05, "normalize_and_clip_actions": 8.130097952071538e-06, "listify_data_for_vector_env": 1.0615375634266387e-05, "un_batch_to_individual_items": 6.784955351100418e-06, "remove_single_ts_time_rank_from_batch": 1.2267542348590948e-05, "get_actions": 3.698294362995348e-05}}}, "agent_episode_returns_mean": {"default_agent": 1.1}, "env_step_timer": 1.432152259007289e-05, "env_reset_timer": 0.00018717682794800508, "env_to_module_connector": {"connector_pipeline_timer": 6.127843791208301e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.3839898738255886e-06, "add_observations_from_episodes_to_batch": 2.870752989073113e-06, "add_states_from_episodes_to_batch": 2.85265353603188e-06, "numpy_to_tensor": 1.2219256167405711e-05, "batch_individual_items": 1.2678716134113139e-05}}}, "sample": 0.11616830331511283, "episode_return_max": 13.5, "episode_len_mean": 20.0, "episode_len_max": 20, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "episode_duration_sec_mean": 0.005450515409465879, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": 1.1}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled_lifetime": 95400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 19.0, "episode_return_min": -15.5, "num_env_steps_sampled": 400, "num_episodes_lifetime": 380, "num_episodes": 20, "episode_return_mean": 1.1, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "time_between_sampling": 9.405758159705524}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "b1709_00000", "date": "2025-08-11_18-35-41", "timestamp": 1754930141, "time_this_iter_s": 9.93268084526062, "time_total_s": 186.7636501789093, "pid": 11351, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3845f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 186.7636501789093, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 61.635714285714286, "ram_util_percent": 81.95714285714284}}
{"timers": {"training_iteration": 9.158027073249984, "restore_env_runners": 1.167194755717544e-05, "training_step": 9.157877533989417, "env_runner_sampling_timer": 1.6263382554090164, "learner_update_timer": 7.355410780749335, "synch_weights": 0.0008848840790577788, "restore_eval_env_runners": 1.0819464676331727e-05, "evaluation_iteration": 0.12346661238057145, "synch_eval_env_connectors": 0.00013964894625210012, "synch_env_connectors": 4.703871918837232e-06}, "env_runners": {"episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00011824740124938015, "timers": {"connectors": {"un_batch_to_individual_items": 6.7003068881332786e-06, "tensor_to_numpy": 1.5229777436665096e-05, "remove_single_ts_time_rank_from_batch": 1.1919397723045872e-05, "normalize_and_clip_actions": 7.978623123870125e-06, "get_actions": 3.9372717621891085e-05, "listify_data_for_vector_env": 1.0520861856197862e-05}}}, "time_between_sampling": 0.033305989494272825, "episode_duration_sec_mean": 0.0052834715028293455, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -11105000.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.859737232877736e-06, "add_time_dim_to_batch_and_zero_pad": 6.928797827116226e-06, "numpy_to_tensor": 1.2636125164815406e-05, "add_states_from_episodes_to_batch": 2.67118953223861e-06, "batch_individual_items": 1.2454769059557687e-05}}, "connector_pipeline_timer": 5.972486032869875e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "agent_episode_returns_mean": {"default_agent": -1.5}, "weights_seq_no": 19.0, "module_episode_returns_mean": {"default_policy": -1.5}, "episode_return_min": -13.5, "num_env_steps_sampled": 5000.0, "num_episodes_lifetime": -555250.0, "rlmodule_inference_timer": 3.188036607340647e-05, "episode_len_mean": 20.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "num_episodes": 250.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.407294497066928e-05, "episode_return_mean": -1.5, "env_reset_timer": 4.447132239403393e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "sample": 0.005829506909544883, "episode_return_max": 6.5, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3229.984996194708}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.135233535126058, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009343088282450349, "add_observations_from_episodes_to_batch": 0.0008384325976658981, "add_columns_from_episodes_to_train_batch": 0.04118031877671071, "add_time_dim_to_batch_and_zero_pad": 0.075760473577511, "add_states_from_episodes_to_batch": 0.0036961983050885798, "batch_individual_items": 0.004184629532549529, "numpy_to_tensor": 7.366147688287878e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "policy_loss": -0.00037631296436302364, "use_intrinsic_rewards": 0.0, "weights_seq_no": 20.0, "vf_explained_var": -0.0005820989608764648, "num_trainable_parameters": 16595, "vf_loss": 0.35831117630004883, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 1.5409844422720198e-07, "num_module_steps_trained": 5985, "total_loss": 0.2777235507965088, "module_train_batch_size_mean": 997.6479298448816, "num_module_steps_trained_lifetime": 119700, "entropy": 0.6757646799087524, "vf_loss_unclipped": 45.76925277709961, "mean_kl_loss": 3.26411536661908e-05, "num_module_steps_trained_lifetime_throughput": 759.5420609543996}, "IntrinsicAttentionMask": [[[0.09008321166038513, 0.09160076826810837, 0.09062129259109497, 0.09214791655540466, 0.09150909632444382, 0.09053060412406921, 0.09144803881645203, 0.09047018736600876, 0.08984300494194031, 0.08981302380561829, 0.09193288534879684], [0.09113802760839462, 0.09071706235408783, 0.09098774194717407, 0.09056746959686279, 0.09074224531650543, 0.09101299196481705, 0.0907590314745903, 0.0910298302769661, 0.09120548516511917, 0.09121392667293549, 0.09062612801790237], [0.09045916050672531, 0.09128610789775848, 0.09075309336185455, 0.09158272296190262, 0.09123633056879044, 0.09070361405611038, 0.09120316803455353, 0.0906706377863884, 0.09032769501209259, 0.09031127393245697, 0.09146624058485031], [0.0915142074227333, 0.0904013141989708, 0.09111591428518295, 0.09000785648822784, 0.09046763181686401, 0.09118275344371796, 0.09051187336444855, 0.09122734516859055, 0.09169334173202515, 0.09171576052904129, 0.0901620015501976], [0.09107480198144913, 0.09077013283967972, 0.09096606820821762, 0.09066176414489746, 0.0907883569598198, 0.09098434448242188, 0.09080051630735397, 0.09099652618169785, 0.09112358838319778, 0.09112969040870667, 0.09070426225662231], [0.09039594978094101, 0.09133903682231903, 0.09073102474212646, 0.09167760610580444, 0.09128223359584808, 0.09067460149526596, 0.09124438464641571, 0.09063700586557388, 0.09024611860513687, 0.090227410197258, 0.09154463559389114], [0.09103263169527054, 0.09080547839403152, 0.0909515917301178, 0.0907246395945549, 0.09081907570362091, 0.09096521139144897, 0.09082814306020737, 0.09097429364919662, 0.09106899052858353, 0.09107353538274765, 0.09075634181499481], [0.09035380184650421, 0.09137431532144547, 0.09071628749370575, 0.09174089133739471, 0.09131282567977905, 0.09065524488687515, 0.09127185493707657, 0.09061457216739655, 0.09019175916910172, 0.09017152339220047, 0.09159690886735916], [0.08991467952728271, 0.09174170345067978, 0.09056177735328674, 0.09240195155143738, 0.09163116663694382, 0.0904526561498642, 0.09155754745006561, 0.0903799831867218, 0.08962605893611908, 0.08959005028009415, 0.09214237332344055], [0.08989361673593521, 0.09175931662321091, 0.09055431932210922, 0.09243373572826385, 0.09164641797542572, 0.09044290333986282, 0.09157121926546097, 0.09036869555711746, 0.08959896862506866, 0.08956220000982285, 0.09216857701539993], [0.09136662632226944, 0.09052522480487823, 0.09106578677892685, 0.0902271568775177, 0.0905754417181015, 0.0911162942647934, 0.09060892462730408, 0.09114998579025269, 0.09150183200836182, 0.09151874482631683, 0.09034397453069687]], [[0.08853079378604889, 0.0884929671883583, 0.08845514804124832, 0.08841735124588013, 0.08913236856460571, 0.08834179490804672, 0.09025219827890396, 0.08826631307601929, 0.1109480932354927, 0.08915840834379196, 0.09000449627637863], [0.0884798914194107, 0.08844133466482162, 0.08840278536081314, 0.08836425840854645, 0.08909314125776291, 0.08828724175691605, 0.0902349203824997, 0.08821030706167221, 0.11138405650854111, 0.08911968767642975, 0.08998233824968338], [0.08842885494232178, 0.088389553129673, 0.08835028111934662, 0.08831102401018143, 0.08905375003814697, 0.08823255449533463, 0.0902174711227417, 0.08815415948629379, 0.11182151734828949, 0.089080810546875, 0.0899600088596344], [0.08837766200304031, 0.08833764493465424, 0.08829763531684875, 0.08825764805078506, 0.0890142098069191, 0.08817772567272186, 0.09019984304904938, 0.08809787780046463, 0.11226048320531845, 0.08904177695512772, 0.08993751555681229], [0.08931848406791687, 0.08929236233234406, 0.08926624059677124, 0.08924013376235962, 0.08973337709903717, 0.08918794989585876, 0.09050337970256805, 0.0891357883810997, 0.1042376235127449, 0.08975131809711456, 0.09033332020044327], [0.08827484399080276, 0.08823336660861969, 0.08819190412759781, 0.08815045654773712, 0.08893464505672455, 0.08806763589382172, 0.09016406536102295, 0.08798488974571228, 0.11314289271831512, 0.08896321803331375, 0.08989199250936508], [0.09068097174167633, 0.09067700803279877, 0.0906730368733406, 0.09066907316446304, 0.09074386954307556, 0.09066113084554672, 0.09085992723703384, 0.0906532034277916, 0.0928007960319519, 0.09074657410383224, 0.0908343717455864], [0.08817145973443985, 0.08812853693962097, 0.08808562159538269, 0.0880427286028862, 0.08885447680950165, 0.08795700967311859, 0.0901276096701622, 0.08787138015031815, 0.1140313670039177, 0.08888405561447144, 0.08984580636024475], [0.10256270319223404, 0.10298093408346176, 0.10340086370706558, 0.1038225069642067, 0.09615862369537354, 0.10467095673084259, 0.08538134396076202, 0.10552634298801422, 0.011959337629377842, 0.09589153528213501, 0.08764492720365524], [0.08935166895389557, 0.08932606130838394, 0.08930046111345291, 0.08927485346794128, 0.08975844830274582, 0.08922369033098221, 0.09051326662302017, 0.08917254209518433, 0.10395634919404984, 0.08977603912353516, 0.0903465747833252], [0.09039075672626495, 0.09038184583187103, 0.0903729498386383, 0.09036404639482498, 0.09053194522857666, 0.09034623950719833, 0.09079284220933914, 0.09032844752073288, 0.09521754086017609, 0.09053803980350494, 0.09073534607887268]], [[0.0904965028166771, 0.0912809893488884, 0.0907978042960167, 0.09154976159334183, 0.09153468161821365, 0.09045668691396713, 0.09120581299066544, 0.09042687714099884, 0.09041197597980499, 0.09069313853979111, 0.09114572405815125], [0.09161318093538284, 0.09027308225631714, 0.09109477698802948, 0.08982109278440475, 0.08984635770320892, 0.09168204665184021, 0.09040014445781708, 0.09173364192247391, 0.09175945073366165, 0.09127433598041534, 0.09050192683935165], [0.0909266546368599, 0.09089326858520508, 0.0909137949347496, 0.09088189899921417, 0.09088253229856491, 0.09092835336923599, 0.09089644998311996, 0.09092962741851807, 0.0909302681684494, 0.09091825783252716, 0.09089899808168411], [0.09199332445859909, 0.0899290069937706, 0.0911928117275238, 0.08923645317554474, 0.08927512168884277, 0.09209985285997391, 0.09012402594089508, 0.09217969328165054, 0.09221963584423065, 0.09146980196237564, 0.09028034657239914], [0.09197201579809189, 0.08994828909635544, 0.09118735045194626, 0.08926914632320404, 0.08930706977844238, 0.09207642078399658, 0.09013951569795609, 0.09215467423200607, 0.09219381958246231, 0.09145887196063995, 0.090292789041996], [0.09043955057859421, 0.09133229404687881, 0.09078230708837509, 0.09163840860128403, 0.09162122756242752, 0.09039425849914551, 0.09124670922756195, 0.0903603658080101, 0.0903434231877327, 0.09066321700811386, 0.0911782905459404], [0.09150663763284683, 0.09036943316459656, 0.09106701612472534, 0.08998529613018036, 0.09000678360462189, 0.09156500548124313, 0.0904773697257042, 0.09160873293876648, 0.09163060784339905, 0.09121933579444885, 0.0905638113617897], [0.09039688110351562, 0.09137069433927536, 0.0907706618309021, 0.09170480072498322, 0.09168604761362076, 0.09034750610589981, 0.09127729386091232, 0.09031055122613907, 0.0902920812368393, 0.09064078330993652, 0.09120263904333115], [0.09037556499242783, 0.09138990193605423, 0.0907648429274559, 0.0917380154132843, 0.09171847254037857, 0.09032414108514786, 0.09129258990287781, 0.09028565883636475, 0.09026642888784409, 0.09062957018613815, 0.09121482074260712], [0.09077739715576172, 0.09102786332368851, 0.09087377041578293, 0.09111333638429642, 0.0911085456609726, 0.09076464921236038, 0.09100392460823059, 0.09075509756803513, 0.0907503291964531, 0.09084031730890274, 0.0909847766160965], [0.09142138808965683, 0.09044648706912994, 0.09104471653699875, 0.09011677652597427, 0.09013522416353226, 0.09147138148546219, 0.09053909033536911, 0.09150882810354233, 0.091527558863163, 0.09117525070905685, 0.0906132385134697]], [[0.08817984163761139, 0.08889292925596237, 0.08885494619607925, 0.08806683868169785, 0.08802920579910278, 0.08874107897281647, 0.09066011756658554, 0.08791639655828476, 0.11144957691431046, 0.08956138789653778, 0.08964769542217255], [0.08924457430839539, 0.08969466388225555, 0.08967071771621704, 0.08917313814163208, 0.08914933353662491, 0.08959893137216568, 0.09080423414707184, 0.08907796442508698, 0.10330154746770859, 0.09011533111333847, 0.09016956388950348], [0.0891893208026886, 0.08965349942445755, 0.08962880820035934, 0.08911563456058502, 0.08909109234809875, 0.08955476433038712, 0.09079816937446594, 0.08901749551296234, 0.10372039675712585, 0.0900874212384224, 0.0901433676481247], [0.08800570666790009, 0.08876010775566101, 0.0887199193239212, 0.08788619190454483, 0.08784639090299606, 0.08859942853450775, 0.09063122421503067, 0.08772709220647812, 0.11279738694429398, 0.0894676148891449, 0.08955898880958557], [0.08794736117124557, 0.08871550858020782, 0.08867457509040833, 0.08782568573951721, 0.08778516948223114, 0.08855189383029938, 0.0906212106347084, 0.08766371756792068, 0.11324979364871979, 0.08943600207567215, 0.08952906727790833], [0.089022696018219, 0.08952910453081131, 0.08950216323137283, 0.08894234150648117, 0.08891557157039642, 0.08942137658596039, 0.09077893197536469, 0.08883531391620636, 0.10498595237731934, 0.09000272303819656, 0.09006379544734955], [0.09164614975452423, 0.09143014997243881, 0.09144160151481628, 0.09168058633804321, 0.09169206768274307, 0.0914759561419487, 0.09090437740087509, 0.09172651916742325, 0.08556897193193436, 0.09122969210147858, 0.0912039503455162], [0.08777150511741638, 0.08858074247837067, 0.08853761106729507, 0.08764335513114929, 0.08760067820549011, 0.08840834349393845, 0.09059008210897446, 0.08747278153896332, 0.1146165207028389, 0.08934014290571213, 0.08943825215101242], [0.106234610080719, 0.0980798602104187, 0.0984964519739151, 0.10759404301643372, 0.10805105417966843, 0.09975685924291611, 0.08068744838237762, 0.10943372547626495, 0.010416003875434399, 0.09105775505304337, 0.09019213914871216], [0.09019119292497635, 0.09039146453142166, 0.09038081765174866, 0.0901593491435051, 0.09014874696731567, 0.09034890681505203, 0.0908827856183052, 0.09011691808700562, 0.09619946777820587, 0.09057813882827759, 0.09060215950012207], [0.09030994772911072, 0.09047775715589523, 0.09046883881092072, 0.09028325974941254, 0.0902743712067604, 0.09044211357831955, 0.09088918566703796, 0.09024769812822342, 0.09531857818365097, 0.09063411504030228, 0.09065423905849457]], [[0.0904424637556076, 0.09152524918317795, 0.09074357897043228, 0.0914950892329216, 0.09148001670837402, 0.09040266275405884, 0.09144987910985947, 0.09037287533283234, 0.09035798907279968, 0.09063897281885147, 0.09109129756689072], [0.09218351542949677, 0.0892336443066597, 0.09134995192289352, 0.0893140435218811, 0.0893542692065239, 0.09229444712400436, 0.08943477272987366, 0.09237761050462723, 0.09241921454668045, 0.09163834154605865, 0.09040017426013947], [0.09092894196510315, 0.09088290482759476, 0.09091608226299286, 0.09088417887687683, 0.09088481962680817, 0.09093064069747925, 0.09088609367609024, 0.09093191474676132, 0.09093255549669266, 0.09092054516077042, 0.09090128540992737], [0.09213533252477646, 0.08929678797721863, 0.09133358299732208, 0.08937419950962067, 0.08941292762756348, 0.09224202483892441, 0.08949044346809387, 0.0923219844698906, 0.09236199408769608, 0.09161100536584854, 0.0904197171330452], [0.0921112447977066, 0.08932837098836899, 0.09132539480924606, 0.08940428495407104, 0.08944226801395416, 0.09221581369638443, 0.08951827883720398, 0.09229418635368347, 0.09233339130878448, 0.09159733355045319, 0.09042947739362717], [0.09037803113460541, 0.09161043167114258, 0.09072055667638779, 0.09157607704401016, 0.09155891090631485, 0.09033277630805969, 0.09152457863092422, 0.09029889851808548, 0.09028197079896927, 0.09060154855251312, 0.0911162719130516], [0.09206307679414749, 0.0893915444612503, 0.09130899608135223, 0.089464470744133, 0.08950094878673553, 0.09216339141130447, 0.08957395702600479, 0.09223856776952744, 0.0922761857509613, 0.09156996011734009, 0.09044899046421051], [0.09032978862524033, 0.09167423099279404, 0.09070328623056412, 0.09163673222064972, 0.09161799401044846, 0.0902804508805275, 0.09158051759004593, 0.09024351835250854, 0.09022506326436996, 0.0905735045671463, 0.0911349430680275], [0.09030567109584808, 0.09170614182949066, 0.09069465100765228, 0.0916670709848404, 0.09164754301309586, 0.0902542844414711, 0.09160849452018738, 0.09021583944559097, 0.09019661694765091, 0.0905594751238823, 0.09114427864551544], [0.09076014906167984, 0.09110561013221741, 0.09085650742053986, 0.09109602868556976, 0.09109123796224594, 0.0907474011182785, 0.0910816490650177, 0.09073784947395325, 0.09073308855295181, 0.09082306176424026, 0.09096749871969223], [0.09148850291967392, 0.0901460275053978, 0.09111156314611435, 0.09018293768167496, 0.09020139276981354, 0.09153853356838226, 0.09023832529783249, 0.09157600998878479, 0.09159475564956665, 0.09124217927455902, 0.09067976474761963]], [[0.08853087574243546, 0.08849304169416428, 0.08845522999763489, 0.0884174257516861, 0.0883796438574791, 0.08834187686443329, 0.09025228768587112, 0.08901821821928024, 0.11094825714826584, 0.08915849030017853, 0.0900045782327652], [0.08847997337579727, 0.0884414091706276, 0.08840286731719971, 0.08836434036493301, 0.08832582086324692, 0.08828732371330261, 0.09023500978946686, 0.08897677063941956, 0.11138422787189484, 0.08911976963281631, 0.08998242765665054], [0.08842893689870834, 0.08838964253664017, 0.08835036307573318, 0.088311105966568, 0.088271863758564, 0.08823264390230179, 0.09021756052970886, 0.08893517404794693, 0.11182169616222382, 0.08908089995384216, 0.08996009826660156], [0.08837775141000748, 0.0883377268910408, 0.08829771727323532, 0.08825773000717163, 0.08821776509284973, 0.08817781507968903, 0.09019993990659714, 0.08889342099428177, 0.11226066201925278, 0.08904186636209488, 0.08993761241436005], [0.08832642436027527, 0.0882856696844101, 0.08824492990970612, 0.08820421993732452, 0.08816352486610413, 0.08812284469604492, 0.09018214792013168, 0.08885150402784348, 0.11270112544298172, 0.08900267630815506, 0.08991494029760361], [0.08827494084835052, 0.08823346346616745, 0.08819200098514557, 0.08815056085586548, 0.08810913562774658, 0.08806774020195007, 0.0901641771197319, 0.08880943804979324, 0.11314309388399124, 0.08896332234144211, 0.08989209681749344], [0.09068097919225693, 0.09067700803279877, 0.0906730368733406, 0.09066907316446304, 0.09066510945558548, 0.09066113829612732, 0.09085993468761444, 0.09073195606470108, 0.09280078113079071, 0.09074658155441284, 0.0908343642950058], [0.08917207270860672, 0.08914371579885483, 0.08911536633968353, 0.08908702433109283, 0.08905869722366333, 0.08903037756681442, 0.09045908600091934, 0.08953708410263062, 0.10548024624586105, 0.08964204788208008, 0.09027428925037384], [0.10257291793823242, 0.10299117863178253, 0.10341115295886993, 0.10383284091949463, 0.10425624251365662, 0.10468138009309769, 0.08538977056741714, 0.09734943509101868, 0.01196043100208044, 0.09590104967355728, 0.08765360713005066], [0.08935171365737915, 0.08932609856128693, 0.0893004983663559, 0.08927489817142487, 0.08924931287765503, 0.08922372758388519, 0.09051331877708435, 0.08968131989240646, 0.1039564236998558, 0.08977608382701874, 0.09034661948680878], [0.09039075672626495, 0.09038185328245163, 0.0903729498386383, 0.09036404639482498, 0.09035514295101166, 0.09034624695777893, 0.09079284965991974, 0.0905051976442337, 0.09521754831075668, 0.09053804725408554, 0.09073534607887268]]], "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"use_intrinsic_rewards": 1.0, "weights_seq_no": 120.0, "vf_loss": 0.3584039807319641, "policy_loss": -0.00036364333936944604, "vf_explained_var": 0.00164872407913208, "total_loss": 0.2778133451938629, "diff_num_grad_updates_vs_sampler_policy": 101.0, "num_module_steps_trained": 35910, "entropy": 0.6758191585540771, "vf_loss_unclipped": 45.66586685180664, "module_train_batch_size_mean": 997.4978492525759, "num_module_steps_trained_lifetime": 718200, "mean_kl_loss": 3.0296794648165815e-05}, "intrinsic_reward_module": {"total_loss": 0.0, "diff_num_grad_updates_vs_sampler_policy": 101.0, "module_train_batch_size_mean": 997.4978492525759, "num_module_steps_trained": 35910, "num_module_steps_trained_lifetime": 718200, "weights_seq_no": 120.0}, "__all_modules__": {"num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 3960000, "num_module_steps_trained_lifetime": 1436400, "num_env_steps_trained_lifetime_throughput": 44743.70605651031}}}, "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_module_steps_trained_lifetime": 239400, "num_env_steps_trained_lifetime": 660000, "num_env_steps_trained": 33000, "num_env_steps_trained_lifetime_throughput": 4188.956687999536, "num_module_steps_trained_throughput": 18641195.48687765, "num_module_steps_trained_lifetime_throughput": 13253884.200371124}, "intrinsic_reward_module": {"total_loss": 0.0, "num_trainable_parameters": 8266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5985, "default_optimizer_learning_rate": 0.0002715581955, "module_train_batch_size_mean": 997.6479298448816, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime": 119700, "weights_seq_no": 20.0, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained_lifetime_throughput": 759.5468618399489}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.1022723893684506e-05, "module_to_env_connector": {"connector_pipeline_timer": 0.00011455709099298555, "timers": {"connectors": {"tensor_to_numpy": 1.5180022612729554e-05, "normalize_and_clip_actions": 7.902255680924263e-06, "listify_data_for_vector_env": 1.0395024354567899e-05, "un_batch_to_individual_items": 6.508781888308302e-06, "remove_single_ts_time_rank_from_batch": 1.1951016116860284e-05, "get_actions": 3.6186198187371674e-05}}}, "agent_episode_returns_mean": {"default_agent": 1.3}, "env_step_timer": 1.3881759884927932e-05, "env_reset_timer": 0.0001886696498979916, "env_to_module_connector": {"connector_pipeline_timer": 5.973323899733116e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.234320621127018e-06, "add_observations_from_episodes_to_batch": 2.8444683319795407e-06, "add_states_from_episodes_to_batch": 2.7783179031819698e-06, "numpy_to_tensor": 1.1938603303081388e-05, "batch_individual_items": 1.2403929387483119e-05}}}, "sample": 0.11617118153244159, "episode_return_max": 13.5, "episode_len_mean": 20.0, "episode_len_max": 20, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "episode_duration_sec_mean": 0.005454014147398993, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": 1.3}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled_lifetime": 100400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "weights_seq_no": 20.0, "episode_return_min": -15.5, "num_env_steps_sampled": 400, "num_episodes_lifetime": 400, "num_episodes": 20, "episode_return_mean": 1.3, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "time_between_sampling": 9.411087020187443}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "b1709_00000", "date": "2025-08-11_18-35-51", "timestamp": 1754930151, "time_this_iter_s": 10.036188125610352, "time_total_s": 196.79983830451965, "pid": 11351, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3845f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 196.79983830451965, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 49.457142857142856, "ram_util_percent": 80.95714285714287}}
