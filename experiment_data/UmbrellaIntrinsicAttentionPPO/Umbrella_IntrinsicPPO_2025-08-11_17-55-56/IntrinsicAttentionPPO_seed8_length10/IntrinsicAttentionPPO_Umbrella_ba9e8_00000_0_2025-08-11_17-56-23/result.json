{"timers": {"training_iteration": 9.4035031250678, "restore_env_runners": 1.9916915334761143e-05, "training_step": 9.403278167010285, "env_runner_sampling_timer": 1.7744464999996126, "learner_update_timer": 7.444056624895893, "synch_weights": 0.001452874974347651}, "env_runners": {"env_to_module_sum_episodes_length_out": 10.191744832559449, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": -0.7800000000000001}, "rlmodule_inference_timer": 4.5576213417640716e-05, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.7463272068605955e-05, "get_actions": 7.746177810408161e-05, "listify_data_for_vector_env": 1.1709879258951017e-05, "un_batch_to_individual_items": 7.368590715110318e-06, "remove_single_ts_time_rank_from_batch": 1.2992910509419246e-05, "normalize_and_clip_actions": 1.4631019346436231e-05}}, "connector_pipeline_timer": 0.00017265916750915943}, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.3810978063391102e-05, "add_states_from_episodes_to_batch": 2.940446867759514e-06, "add_time_dim_to_batch_and_zero_pad": 8.057659421603723e-06, "add_observations_from_episodes_to_batch": 3.2545557578981557e-06, "numpy_to_tensor": 1.4503753957783316e-05}}, "connector_pipeline_timer": 6.809408307455533e-05}, "sample": 0.008183185966777341, "episode_duration_sec_mean": 0.005767414132133124, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "agent_episode_returns_mean": {"default_agent": -0.7800000000000001}, "weights_seq_no": 0.0, "episode_return_mean": -0.7800000000000001, "env_step_timer": 1.692734291534078e-05, "episode_return_max": 8.5, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": 627500.0, "env_reset_timer": 0.00012766700850496887, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "time_between_sampling": 0.0007043747475793726, "env_to_module_sum_episodes_length_in": 10.191744832559449, "episode_len_mean": 20.0, "episode_return_min": -11.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": 31375.0, "num_env_steps_sampled_lifetime_throughput": 2808.1541451537896}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000, "learner_connector": {"connector_pipeline_timer": 0.14288887497968972, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.010008333018049598, "add_observations_from_episodes_to_batch": 0.0010489170672371984, "add_columns_from_episodes_to_train_batch": 0.0449868330033496, "add_time_dim_to_batch_and_zero_pad": 0.07842866703867912, "add_states_from_episodes_to_batch": 0.0037946669617667794, "batch_individual_items": 0.004320250009186566, "numpy_to_tensor": 9.145797230303288e-05}}}, "learner_connector_sum_episodes_length_out": 5250}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.35832369327545166, "module_train_batch_size_mean": 997.9705930399, "num_module_steps_trained": 5985, "policy_loss": 6.037793355062604e-05, "use_intrinsic_rewards": 0.0, "num_module_steps_trained_lifetime": 5985, "total_loss": 0.2781454920768738, "weights_seq_no": 1.0, "entropy": 0.6924538016319275, "mean_kl_loss": 7.525547516706865e-06, "vf_loss_unclipped": 42.722625732421875, "num_trainable_parameters": 16595, "curr_kl_coeff": 0.08079196512699127, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.002650618553161621, "num_module_steps_trained_lifetime_throughput": 813.330455567251}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 71820, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 198000, "num_env_steps_trained_lifetime_throughput": 59258.029949136115}, "default_policy": {"num_module_steps_trained_lifetime": 35910, "weights_seq_no": 6.0, "diff_num_grad_updates_vs_sampler_policy": 6.0, "entropy": 0.6924472451210022, "mean_kl_loss": 8.198620889743324e-06, "vf_loss_unclipped": 42.50938034057617, "vf_explained_var": 0.0019053220748901367, "num_module_steps_trained": 35910, "use_intrinsic_rewards": 1.0, "vf_loss": 0.3585600256919861, "module_train_batch_size_mean": 997.8474438281662, "total_loss": 0.27833473682403564, "policy_loss": 6.53935203445144e-05}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.8474438281662, "num_module_steps_trained_lifetime": 35910, "total_loss": 0.0, "weights_seq_no": 6.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}}}, "intrinsic_reward_module": {"weights_seq_no": 1.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.9705930399, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5985, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 5985, "num_module_steps_trained_lifetime_throughput": 813.3486795352248}, "__all_modules__": {"num_env_steps_trained": 33000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 11970, "num_env_steps_trained_lifetime": 33000, "num_env_steps_trained_lifetime_throughput": 4486.44560428346, "num_module_steps_trained_throughput": 27996149.468390346, "num_module_steps_trained_lifetime_throughput": 14923441.773542644}, "IntrinsicAttentionMask": [[[0.09073533117771149, 0.09036849439144135, 0.09085746854543686, 0.09147527068853378, 0.09055102616548538, 0.09061195701360703, 0.09067291766405106, 0.09018176794052124, 0.09178341925144196, 0.09184517711400986, 0.0909171923995018], [0.09054429084062576, 0.08978395909070969, 0.09079819172620773, 0.09208811074495316, 0.09016186743974686, 0.0902881920337677, 0.09041468799114227, 0.08939819037914276, 0.09273502975702286, 0.09286496043205261, 0.09092246741056442], [0.09079805016517639, 0.09056263417005539, 0.09087635576725006, 0.09127186238765717, 0.09067981690168381, 0.09071891009807587, 0.09075801819562912, 0.09044266492128372, 0.09146878123283386, 0.09150821715593338, 0.09091462939977646], [0.09110864996910095, 0.09154096245765686, 0.09096555411815643, 0.09024807810783386, 0.09132537990808487, 0.09125363081693649, 0.09118194133043289, 0.0917624905705452, 0.0898941308259964, 0.08982350677251816, 0.09089573472738266], [0.09063985198736191, 0.09007509052753448, 0.09082816541194916, 0.0917828157544136, 0.09035594761371613, 0.09044976532459259, 0.09054367989301682, 0.08978807926177979, 0.09226028621196747, 0.09235607832670212, 0.09092030674219131], [0.09067153185606003, 0.09017214924097061, 0.09083796292543411, 0.09168107807636261, 0.09042053669691086, 0.09050348401069641, 0.09058651328086853, 0.08991822600364685, 0.09210237860679626, 0.09218686819076538, 0.0909193828701973], [0.09070310741662979, 0.09026919305324554, 0.09084764868021011, 0.09157932549715042, 0.09048505872488022, 0.09055712819099426, 0.09062925726175308, 0.09004843980073929, 0.091944620013237, 0.09201785176992416, 0.09091833978891373], [0.09044551849365234, 0.08948557823896408, 0.0907665491104126, 0.09240119904279709, 0.089962437748909, 0.09012195467948914, 0.09028174728155136, 0.08899936825037003, 0.09322330355644226, 0.09338860213756561, 0.09092377871274948], [0.0912594348192215, 0.09202659875154495, 0.09100611507892609, 0.08974058926105499, 0.09164368361234665, 0.0915163978934288, 0.09138929098844528, 0.092420794069767, 0.08911911398172379, 0.08899534493684769, 0.09088262170553207], [0.09128932654857635, 0.09212373197078705, 0.09101393073797226, 0.08963914960622787, 0.09170717746019363, 0.09156873822212219, 0.09143051505088806, 0.09255272150039673, 0.08896463364362717, 0.08883033692836761, 0.09087970852851868], [0.09082856774330139, 0.09065748006105423, 0.09088544547557831, 0.09117253869771957, 0.09074265509843826, 0.09077106416225433, 0.0907994881272316, 0.09057025611400604, 0.09131534397602081, 0.09134393185377121, 0.09091324359178543]], [[0.09199058264493942, 0.09138453006744385, 0.09186995774507523, 0.09126470983028412, 0.09174949675798416, 0.09266281127929688, 0.09108526259660721, 0.09199196845293045, 0.08277330547571182, 0.09193321317434311, 0.09129415452480316], [0.09383096545934677, 0.0920768603682518, 0.09348013252019882, 0.09173258394002914, 0.09313061088323593, 0.09580188989639282, 0.09121857583522797, 0.0938350185751915, 0.06941216439008713, 0.0936640202999115, 0.09181711822748184], [0.09237257391214371, 0.09154094010591507, 0.09220688790082932, 0.09137674421072006, 0.0920415073633194, 0.09329739958047867, 0.09113101661205292, 0.09237448126077652, 0.07994766533374786, 0.09229377657175064, 0.091417096555233], [0.09417232871055603, 0.09218718856573105, 0.09377490729093552, 0.09179814159870148, 0.09337914735078812, 0.09640855342149734, 0.09121763706207275, 0.09417691826820374, 0.06700828671455383, 0.09398318827152252, 0.09189365804195404], [0.09274610131978989, 0.09168767184019089, 0.09253503382205963, 0.09147901087999344, 0.09232444316148758, 0.09392615407705307, 0.0911669060587883, 0.09274853765964508, 0.07721012085676193, 0.09264570474624634, 0.09153027832508087], [0.08970873057842255, 0.09032954275608063, 0.0898316279053688, 0.09045328944921494, 0.0899546891450882, 0.08902982622385025, 0.09063921868801117, 0.08970732241868973, 0.10015571117401123, 0.08976713567972183, 0.0904228463768959], [0.094670370221138, 0.09233700484037399, 0.09420254826545715, 0.09188070893287659, 0.09373702853918076, 0.09730897098779678, 0.09120048582553864, 0.09467577189207077, 0.06354668736457825, 0.09444767981767654, 0.09199269860982895], [0.09198612719774246, 0.09138267487287521, 0.09186602383852005, 0.09126335382461548, 0.09174607694149017, 0.09265546500682831, 0.09108467400074005, 0.0919875055551529, 0.08280635625123978, 0.09192901104688644, 0.09129267930984497], [0.10768429934978485, 0.08794763684272766, 0.10344234853982925, 0.08448316156864166, 0.09936748445034027, 0.13458868861198425, 0.07954064011573792, 0.10773414373397827, 0.004242961760610342, 0.10564643889665604, 0.08532220870256424], [0.09217324107885361, 0.09146010875701904, 0.09203124046325684, 0.09131920337677002, 0.09188945591449738, 0.09296522289514542, 0.09110825508832932, 0.09217487275600433, 0.08141887933015823, 0.09210570901632309, 0.09135383367538452], [0.0940890982747078, 0.09216085076332092, 0.09370315074920654, 0.0917828157544136, 0.09331879019737244, 0.09625986218452454, 0.09121866524219513, 0.09409355372190475, 0.06759215891361237, 0.09390542656183243, 0.09187563508749008]], [[0.09100095927715302, 0.09139181673526764, 0.09073229879140854, 0.0906938761472702, 0.09127575159072876, 0.09088704735040665, 0.09119845926761627, 0.09081008285284042, 0.09050200134515762, 0.09046366810798645, 0.09104407578706741], [0.09073363244533539, 0.09000343084335327, 0.09124080836772919, 0.09131369739770889, 0.09021931886672974, 0.09094814211130142, 0.0903635248541832, 0.0910935252904892, 0.09167902916669846, 0.09175227582454681, 0.09065263718366623], [0.09118127822875977, 0.09235744178295135, 0.09037866443395615, 0.09026426076889038, 0.09200715273618698, 0.0908403992652893, 0.0917743593454361, 0.0906105637550354, 0.08969439566135406, 0.08958085626363754, 0.0913105458021164], [0.091206856071949, 0.09249632060527802, 0.09032782912254333, 0.09020259231328964, 0.09211211651563644, 0.09083342552185059, 0.09185687452554703, 0.09058172255754471, 0.08957900106906891, 0.08945479989051819, 0.09134849160909653], [0.09081361442804337, 0.0904136523604393, 0.09109054505825043, 0.09113029390573502, 0.09053205698728561, 0.09093083441257477, 0.09061107039451599, 0.0910101979970932, 0.09132927656173706, 0.09136912226676941, 0.09076932072639465], [0.09107775241136551, 0.09180010855197906, 0.09058276563882828, 0.09051207453012466, 0.09158534556627274, 0.09086773544549942, 0.09144244343042374, 0.09072595834732056, 0.09015943109989166, 0.09008906781673431, 0.09115731716156006], [0.09086660295724869, 0.0906878188252449, 0.09099014848470688, 0.09100785851478577, 0.09074079245328903, 0.09091892093420029, 0.09077611565589905, 0.09095432609319687, 0.09109647572040558, 0.09111420810222626, 0.09084682911634445], [0.091129370033741, 0.09207691997289658, 0.09048140048980713, 0.0903889462351799, 0.09179496020078659, 0.09085430204868317, 0.091607466340065, 0.09066873043775558, 0.08992809802293777, 0.08983621746301651, 0.09123362600803375], [0.09133363515138626, 0.09319263696670532, 0.0900728851556778, 0.08989369869232178, 0.0926375463604927, 0.09079739451408386, 0.09226933121681213, 0.09043648838996887, 0.0890030786395073, 0.0888260081410408, 0.09153727442026138], [0.09135878086090088, 0.09333229064941406, 0.0900217592716217, 0.08983181416988373, 0.09274275600910187, 0.09078995883464813, 0.09235180914402008, 0.09040723741054535, 0.08888811618089676, 0.0887005627155304, 0.09157484024763107], [0.09097175300121307, 0.09123769402503967, 0.09078874439001083, 0.09076256304979324, 0.09115876257419586, 0.0908941775560379, 0.09110618382692337, 0.09084174782037735, 0.09063173085451126, 0.09060558676719666, 0.09100110828876495]], [[0.08432483673095703, 0.08403442054986954, 0.08374501764774323, 0.0834565982222557, 0.08581434190273285, 0.08761613070964813, 0.08522427082061768, 0.08701368421316147, 0.14697013795375824, 0.08404870331287384, 0.08775189518928528], [0.08405280858278275, 0.08375322073698044, 0.0834546908736229, 0.08315723389387131, 0.08558996021747589, 0.08745063841342926, 0.08498091250658035, 0.08682834357023239, 0.14937333762645721, 0.08376793563365936, 0.08759088814258575], [0.0837777778506279, 0.08346907794475555, 0.08316151797771454, 0.08285509794950485, 0.08536221086978912, 0.08728141337633133, 0.08473430573940277, 0.0866393893957138, 0.15180881321430206, 0.08348425477743149, 0.08742614090442657], [0.0834997147321701, 0.08318199217319489, 0.08286548405885696, 0.08255018293857574, 0.08513107150793076, 0.08710841834545135, 0.08448444306850433, 0.08644677698612213, 0.15427672863006592, 0.08319760113954544, 0.08725757896900177], [0.08565966784954071, 0.0854170024394989, 0.0851750299334526, 0.08493374288082123, 0.0869019404053688, 0.08839955925941467, 0.0864102691411972, 0.08789941668510437, 0.13526226580142975, 0.08542892336845398, 0.08851217478513718], [0.08714699745178223, 0.08696337044239044, 0.0867801234126091, 0.0865972489118576, 0.08808500319719315, 0.08921125531196594, 0.08771418035030365, 0.0888356864452362, 0.1223980188369751, 0.08697239309549332, 0.08929574489593506], [0.08514273166656494, 0.08488103002309799, 0.08462012559175491, 0.0843600258231163, 0.08648347109556198, 0.08810198307037354, 0.08595263957977295, 0.0875612199306488, 0.13977916538715363, 0.08489388972520828, 0.08822378516197205], [0.08666450530290604, 0.08646100759506226, 0.08625797927379608, 0.08605542778968811, 0.08770478516817093, 0.08895552158355713, 0.08729337155818939, 0.08853822946548462, 0.12654873728752136, 0.08647101372480392, 0.08904942125082016], [0.1042071059346199, 0.10588788986206055, 0.10759580135345459, 0.10933125019073486, 0.09607899188995361, 0.08725177496671677, 0.09920337051153183, 0.0900891050696373, 0.007922733202576637, 0.10580453276634216, 0.08662748336791992], [0.08406627178192139, 0.0837671309709549, 0.08346904814243317, 0.0831720381975174, 0.08560109883546829, 0.08745887130498886, 0.08499296754598618, 0.08683755993843079, 0.14925430715084076, 0.08378183096647263, 0.08759891241788864], [0.08725371956825256, 0.08707458525896072, 0.08689581602811813, 0.08671741187572479, 0.08816861361265182, 0.08926679193973541, 0.08780696243047714, 0.088900625705719, 0.12148284167051315, 0.08708339184522629, 0.089349165558815]], [[0.09093672782182693, 0.09056907147169113, 0.0916166678071022, 0.0911203995347023, 0.09019973874092102, 0.09026043117046356, 0.09087417274713516, 0.0903819277882576, 0.09142735600471497, 0.09204903244972229, 0.09056448191404343], [0.09096261858940125, 0.09019876271486282, 0.09238413721323013, 0.09134549647569656, 0.08943477272987366, 0.08956007659435272, 0.09083241969347, 0.08981122076511383, 0.09198720008134842, 0.09329401701688766, 0.09018924832344055], [0.09087830036878586, 0.09124311059713364, 0.09021127223968506, 0.09069713205099106, 0.09161257743835449, 0.09155166149139404, 0.09094016253948212, 0.0914299488067627, 0.09039599448442459, 0.08979222178459167, 0.09124768525362015], [0.0909222811460495, 0.09075254201889038, 0.09123522788286209, 0.09100694209337234, 0.09058164805173874, 0.09060975164175034, 0.09089342504739761, 0.09066599607467651, 0.09114822000265121, 0.0914335772395134, 0.09075041860342026], [0.0909845232963562, 0.08982260525226593, 0.0931604653596878, 0.09156884998083115, 0.08866561949253082, 0.08885502815246582, 0.09078610688447952, 0.08923505991697311, 0.0925510823726654, 0.09456248581409454, 0.0898081511259079], [0.09098121523857117, 0.08988470584154129, 0.09303253889083862, 0.09153234958648682, 0.08879205584526062, 0.08897098898887634, 0.09079401940107346, 0.08932992815971375, 0.0924583375453949, 0.0943528264760971, 0.08987106382846832], [0.0909414142370224, 0.09050635993480682, 0.09174687415361404, 0.09115888923406601, 0.09006963670253754, 0.09014137089252472, 0.09086737036705017, 0.09028502553701401, 0.09152249991893768, 0.09225962311029434, 0.09050092846155167], [0.09097424149513245, 0.0900086835026741, 0.09277685731649399, 0.09145902842283249, 0.08904512226581573, 0.08920300751924515, 0.09080950915813446, 0.08951962739229202, 0.09227275848388672, 0.09393453598022461, 0.08999666571617126], [0.09089591354131699, 0.09105684608221054, 0.09060073643922806, 0.09081586450338364, 0.091219462454319, 0.09119267016649246, 0.0909232348203659, 0.09113913029432297, 0.09068261086940765, 0.09041467308998108, 0.09105885773897171], [0.09083418548107147, 0.09166443347930908, 0.08932707458734512, 0.09042346477508545, 0.09250959008932114, 0.09236995130777359, 0.09097468107938766, 0.09209128469228745, 0.08974304795265198, 0.08838745206594467, 0.09167487919330597], [0.09096291661262512, 0.09019411355257034, 0.09239375591278076, 0.09134829044342041, 0.0894252136349678, 0.08955132216215134, 0.09083186835050583, 0.08980406820774078, 0.09199419617652893, 0.0933096781373024, 0.0901845321059227]], [[0.08778735995292664, 0.08572998642921448, 0.0855284333229065, 0.08532736450433731, 0.08696471899747849, 0.09011083841323853, 0.0847269594669342, 0.08968763798475266, 0.1282459795475006, 0.08759112656116486, 0.08829960227012634], [0.08566659688949585, 0.0826394185423851, 0.08234485238790512, 0.0820513591170311, 0.08445173501968384, 0.08912968635559082, 0.08117710053920746, 0.08849544078111649, 0.1522415280342102, 0.08537626266479492, 0.08642605692148209], [0.08543553203344345, 0.08231627941131592, 0.08201297372579575, 0.08171077817678452, 0.08418326079845428, 0.08900851756334305, 0.08081086724996567, 0.08835379034280777, 0.1548130214214325, 0.08513621240854263, 0.0862186849117279], [0.08520066738128662, 0.08199014514684677, 0.08167817443609238, 0.0813673809170723, 0.08391128480434418, 0.08888290077447891, 0.08044210076332092, 0.08820778876543045, 0.15741975605487823, 0.08489241451025009, 0.08600734174251556], [0.08698972314596176, 0.0845385193824768, 0.08429902791976929, 0.08406022936105728, 0.08600818365812302, 0.08977217227220535, 0.083347849547863, 0.08926427364349365, 0.13736273348331451, 0.0867554098367691, 0.08760187029838562], [0.0897129625082016, 0.0888018012046814, 0.08871186524629593, 0.08862203359603882, 0.08935011178255081, 0.09072748571634293, 0.08835306763648987, 0.09054381400346756, 0.1056123673915863, 0.08962658792734146, 0.08993793278932571], [0.0844729021191597, 0.08099356293678284, 0.08065614849328995, 0.08032014220952988, 0.08307403326034546, 0.08847878873348236, 0.07932049036026001, 0.0877431333065033, 0.16545334458351135, 0.08413828909397125, 0.08534909039735794], [0.08939589560031891, 0.0882728323340416, 0.0881621390581131, 0.08805158734321594, 0.0889483317732811, 0.09064953774213791, 0.08772075921297073, 0.09042233228683472, 0.10941370576620102, 0.08928930759429932, 0.08967359364032745], [0.093349888920784, 0.11089818924665451, 0.11281049251556396, 0.1147557869553566, 0.09995721280574799, 0.07721588760614395, 0.12079524993896484, 0.07990185171365738, 0.00594870513305068, 0.09487969428300858, 0.08948703855276108], [0.08760292083024979, 0.08545094728469849, 0.08524026721715927, 0.08503010123968124, 0.08674216270446777, 0.09003620594739914, 0.08440271019935608, 0.08959277719259262, 0.13036520779132843, 0.08739756047725677, 0.088139109313488], [0.08825208246707916, 0.0864434540271759, 0.08626598119735718, 0.0860888808965683, 0.08752955496311188, 0.0902881845831871, 0.08555971831083298, 0.08991783112287521, 0.12287294864654541, 0.08807981014251709, 0.08870154619216919]]]}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"episode_duration_sec_mean": 0.005806200084043667, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.317698499451454e-06, "listify_data_for_vector_env": 1.1024290628734406e-05, "un_batch_to_individual_items": 6.954968771350636e-06, "tensor_to_numpy": 1.846284331582929e-05, "remove_single_ts_time_rank_from_batch": 1.3272620041708924e-05, "get_actions": 5.2496242238704105e-05}}, "connector_pipeline_timer": 0.00013929344800719918}, "env_to_module_connector": {"connector_pipeline_timer": 6.744261711429732e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 8.327729635601957e-06, "numpy_to_tensor": 1.3849784389066162e-05, "add_states_from_episodes_to_batch": 2.9112796932004058e-06, "add_observations_from_episodes_to_batch": 3.607279363382599e-06, "batch_individual_items": 1.3298845903623473e-05}}}, "env_step_timer": 1.6664398795374573e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": -0.25, "episode_return_max": 12.5, "module_episode_returns_mean": {"default_policy": -0.25}, "env_to_module_sum_episodes_length_in": 10.216013141322508, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": -0.25}, "num_env_steps_sampled": 400, "episode_len_max": 20, "weights_seq_no": 1.0, "num_episodes": 20, "num_env_steps_sampled_lifetime": 5400, "env_reset_timer": 0.000659208046272397, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -14.5, "episode_len_mean": 20.0, "num_episodes_lifetime": 20, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "env_to_module_sum_episodes_length_out": 10.216013141322508, "rlmodule_inference_timer": 4.0075171756984034e-05, "sample": 0.1295229169772938, "num_agent_steps_sampled_lifetime": {"default_agent": 400}}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "ba9e8_00000", "date": "2025-08-11_18-08-02", "timestamp": 1754928482, "time_this_iter_s": 9.548573017120361, "time_total_s": 9.548573017120361, "pid": 10327, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3858fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9.548573017120361, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 33.26428571428571, "ram_util_percent": 81.45}}
{"timers": {"training_iteration": 9.408265814656625, "restore_env_runners": 1.9801085582002997e-05, "training_step": 9.40803962825914, "env_runner_sampling_timer": 1.7746394704189152, "learner_update_timer": 7.4484837636468, "synch_weights": 0.0014556691446341574, "restore_eval_env_runners": 5.641602911055088e-05, "evaluation_iteration": 0.1426255840342492, "synch_eval_env_connectors": 0.00019299995619803667, "synch_env_connectors": 7.041962817311287e-06}, "env_runners": {"env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": -0.7000000000000002}, "rlmodule_inference_timer": 3.369542294827036e-05, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.6449191459376644e-05, "get_actions": 4.286357611889505e-05, "listify_data_for_vector_env": 1.1013470212610042e-05, "un_batch_to_individual_items": 6.932965381718894e-06, "remove_single_ts_time_rank_from_batch": 1.24469782369586e-05, "normalize_and_clip_actions": 8.394825193399814e-06}}, "connector_pipeline_timer": 0.00012583362599601544}, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.309661336957508e-05, "add_states_from_episodes_to_batch": 2.8946441388107177e-06, "add_time_dim_to_batch_and_zero_pad": 7.4841782431279115e-06, "add_observations_from_episodes_to_batch": 2.9954542385391193e-06, "numpy_to_tensor": 1.3723610868210644e-05}}, "connector_pipeline_timer": 6.311470383169847e-05}, "sample": 0.0063519769647652075, "episode_duration_sec_mean": 0.0056101624816656094, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "agent_episode_returns_mean": {"default_agent": -0.7000000000000002}, "weights_seq_no": 1.0, "episode_return_mean": -0.7000000000000002, "env_step_timer": 1.5020949882406283e-05, "episode_return_max": 8.5, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": 10000.0, "env_reset_timer": 5.7274847542371674e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "time_between_sampling": 0.029472120135350516, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "episode_return_min": -11.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": 500.0, "num_env_steps_sampled_lifetime_throughput": 3059.5456430397103}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.14284724205965174, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.01002764843753539, "add_observations_from_episodes_to_batch": 0.001047539146384224, "add_columns_from_episodes_to_train_batch": 0.04496257884311489, "add_time_dim_to_batch_and_zero_pad": 0.07839733161847107, "add_states_from_episodes_to_batch": 0.00379333904129453, "batch_individual_items": 0.004318493759492412, "numpy_to_tensor": 9.13563126232475e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.3583470582962036, "module_train_batch_size_mean": 997.9429069707118, "num_module_steps_trained": 5985, "policy_loss": -3.773997741518542e-05, "use_intrinsic_rewards": 0.0, "num_module_steps_trained_lifetime": 11970, "total_loss": 0.2780643403530121, "weights_seq_no": 2.0, "entropy": 0.6924827694892883, "mean_kl_loss": 2.8810163144044054e-07, "vf_loss_unclipped": 44.90470886230469, "num_trainable_parameters": 16595, "curr_kl_coeff": 0.040395982563495636, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.0035588741302490234, "num_module_steps_trained_lifetime_throughput": 811.6807513974525}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 143640, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 396000, "num_env_steps_trained_lifetime_throughput": 58938.544215519585}, "default_policy": {"num_module_steps_trained_lifetime": 71820, "weights_seq_no": 12.0, "diff_num_grad_updates_vs_sampler_policy": 11.0, "entropy": 0.692481517791748, "mean_kl_loss": 3.0318776111926127e-07, "vf_loss_unclipped": 44.795902252197266, "vf_explained_var": 0.0020583271980285645, "num_module_steps_trained": 35910, "use_intrinsic_rewards": 1.0, "vf_loss": 0.3585306704044342, "module_train_batch_size_mean": 997.7412016936058, "total_loss": 0.27820879220962524, "policy_loss": -3.640694558271207e-05}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.7412016936058, "num_module_steps_trained_lifetime": 71820, "total_loss": 0.0, "weights_seq_no": 12.0, "diff_num_grad_updates_vs_sampler_policy": 11.0}}}, "intrinsic_reward_module": {"weights_seq_no": 2.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.9429069707118, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5985, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 11970, "num_module_steps_trained_lifetime_throughput": 811.6987250966503}, "__all_modules__": {"num_env_steps_trained": 33000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 23940, "num_env_steps_trained_lifetime": 66000, "num_env_steps_trained_lifetime_throughput": 4477.3269443987, "num_module_steps_trained_throughput": 27630254.717041727, "num_module_steps_trained_lifetime_throughput": 14857325.946123295}, "IntrinsicAttentionMask": [[[0.09088677912950516, 0.0899684801697731, 0.09100912511348724, 0.09162795543670654, 0.09015019983053207, 0.09076319634914398, 0.09082426130771637, 0.09088537096977234, 0.0913771390914917, 0.09143862128257751, 0.09106894582509995], [0.0908135399222374, 0.08745447546243668, 0.09126807004213333, 0.09359265863895416, 0.08811186254024506, 0.09035606682300568, 0.09058190137147903, 0.09080830216407776, 0.09264533966779709, 0.09287689626216888, 0.09149090200662613], [0.09089507907629013, 0.09030547738075256, 0.09097347408533096, 0.09136940538883209, 0.09042232483625412, 0.09081585705280304, 0.09085500985383987, 0.0908941775560379, 0.0912090465426445, 0.09124837070703506, 0.09101178497076035], [0.09093194454908371, 0.09201741963624954, 0.09078912436962128, 0.09007303416728973, 0.09180071204900742, 0.09107664227485657, 0.09100509434938431, 0.09093359857797623, 0.09036200493574142, 0.09029100835323334, 0.09071944653987885], [0.09082956612110138, 0.08794976770877838, 0.09121803939342499, 0.09320047497749329, 0.08851461112499237, 0.09043829143047333, 0.09063148498535156, 0.09082508832216263, 0.09239346534013748, 0.09259083122015, 0.0914083942770958], [0.09087804704904556, 0.08962853252887726, 0.09104485809803009, 0.0918898954987526, 0.08987542986869812, 0.0907096117734909, 0.09079282730817795, 0.09087611734867096, 0.09154714643955231, 0.09163112938404083, 0.091126449406147], [0.09088239818811417, 0.08979644626379013, 0.09102723747491837, 0.09176036715507507, 0.09001118689775467, 0.09073613584041595, 0.09080839902162552, 0.09088072925806046, 0.0914631113409996, 0.09153596311807632, 0.09109805524349213], [0.0908866822719574, 0.08996459096670151, 0.09100952744483948, 0.09163094311952591, 0.09014705568552017, 0.09076258540153503, 0.09082389622926712, 0.09088525921106339, 0.0913790836930275, 0.09144081920385361, 0.09106959402561188], [0.09091804176568985, 0.09132209420204163, 0.09086465835571289, 0.09059618413448334, 0.09124167263507843, 0.09097208082675934, 0.09094536304473877, 0.0909186601638794, 0.09070467948913574, 0.09067804366350174, 0.09083858877420425], [0.0909215658903122, 0.09149233996868134, 0.0908462330698967, 0.09046764671802521, 0.09137865155935287, 0.0909978449344635, 0.09096013754606247, 0.09092243760824203, 0.09062059223651886, 0.09058304131031036, 0.09080945700407028], [0.0908990278840065, 0.09047042578458786, 0.090955950319767, 0.09124326705932617, 0.09055542200803757, 0.09084147214889526, 0.09086991846561432, 0.09089836478233337, 0.0911269411444664, 0.09115546941757202, 0.09098377078771591]], [[0.08407869189977646, 0.08378911763429642, 0.08350055664777756, 0.08321297913789749, 0.08556384593248367, 0.09013887494802475, 0.08235618472099304, 0.08951906859874725, 0.146541565656662, 0.08380337059497833, 0.08749575167894363], [0.0837988331913948, 0.08350013941526413, 0.08320251852273941, 0.08290595561265945, 0.08533133566379547, 0.09005802124738693, 0.08202259987592697, 0.08941716700792313, 0.14892244338989258, 0.08351483196020126, 0.08732622861862183], [0.08351600915193558, 0.08320828527212143, 0.08290168642997742, 0.08259622007608414, 0.08509550243616104, 0.08997305482625961, 0.08168655633926392, 0.08931123465299606, 0.1513349711894989, 0.08322341740131378, 0.08715298026800156], [0.08323027193546295, 0.08291357755661011, 0.08259809017181396, 0.08228380233049393, 0.08485635370016098, 0.0898839682340622, 0.08134809136390686, 0.08920125663280487, 0.15377938747406006, 0.08292914927005768, 0.08697601407766342], [0.08545440435409546, 0.0852123275399208, 0.08497092127799988, 0.08473021537065506, 0.08669370412826538, 0.09048770368099213, 0.08401215821504593, 0.0899757519364357, 0.13493849337100983, 0.0852242261171341, 0.08830008655786514], [0.08912426978349686, 0.08903400599956512, 0.08894384652376175, 0.08885376900434494, 0.08958375453948975, 0.09096473455429077, 0.08858410269021988, 0.0907805860042572, 0.10491932183504105, 0.08903845399618149, 0.09017311781644821], [0.08235521614551544, 0.0820121318101883, 0.08167046308517456, 0.08133023232221603, 0.08411876112222672, 0.08959149569272995, 0.08031801134347916, 0.0888465866446495, 0.1613057553768158, 0.08202899247407913, 0.08642243593931198], [0.0886729285120964, 0.08856174349784851, 0.08845068514347076, 0.08833976835012436, 0.0892394408583641, 0.09094621241092682, 0.088007852435112, 0.09071826934814453, 0.10852885246276855, 0.08856721222400665, 0.08996707946062088], [0.10509689152240753, 0.10679203271865845, 0.10851453244686127, 0.11026481539011002, 0.09689932316541672, 0.07610280811786652, 0.11568686366081238, 0.07857760041952133, 0.007990176789462566, 0.10670790076255798, 0.08736703544855118], [0.08381267637014389, 0.08351443707942963, 0.08321726322174072, 0.08292113989591599, 0.08534286916255951, 0.09006209671497345, 0.08203908056020737, 0.08942227810621262, 0.1488044112920761, 0.08352909982204437, 0.08733465522527695], [0.08710286766290665, 0.08692404627799988, 0.08674558252096176, 0.0865674838423729, 0.08801618218421936, 0.09079015254974365, 0.08603539317846298, 0.09041774272918701, 0.1212729886174202, 0.08693283796310425, 0.08919469267129898]], [[0.09112807363271713, 0.0911683514714241, 0.09085904806852341, 0.09047210216522217, 0.09140326827764511, 0.09136456251144409, 0.09097546339035034, 0.09093694388866425, 0.0902806967496872, 0.09059003740549088, 0.09082145243883133], [0.0910630151629448, 0.09109129011631012, 0.09087405353784561, 0.09060199558734894, 0.09125612676143646, 0.09122897684574127, 0.09095584601163864, 0.09092878550291061, 0.09046728163957596, 0.09068495035171509, 0.09084764122962952], [0.0915617048740387, 0.09168276935815811, 0.09075574576854706, 0.08960485458374023, 0.09239103645086288, 0.09227407723665237, 0.0911039412021637, 0.09098862111568451, 0.0890391543507576, 0.08995459973812103, 0.0906435176730156], [0.09218230843544006, 0.09242143481969833, 0.09059802442789078, 0.08835906535387039, 0.09382656216621399, 0.09359382092952728, 0.09128082543611526, 0.09105440229177475, 0.08726859092712402, 0.08903654664754868, 0.09037848562002182], [0.09068278968334198, 0.09064153581857681, 0.090959332883358, 0.09135999530553818, 0.09040163457393646, 0.09044107049703598, 0.0908394530415535, 0.09087909013032913, 0.09155948460102081, 0.09123750776052475, 0.0909980982542038], [0.09074553847312927, 0.0907156765460968, 0.09094555675983429, 0.09123506397008896, 0.09054199606180191, 0.09057056158781052, 0.09085886925458908, 0.09088753908872604, 0.0913790762424469, 0.09114659577608109, 0.09097358584403992], [0.09137425571680069, 0.0914602279663086, 0.09080108255147934, 0.08998005837202072, 0.0919625386595726, 0.09187967330217361, 0.09104888886213303, 0.0909668430685997, 0.0895753726363182, 0.09022987633943558, 0.09072115272283554], [0.09143631905317307, 0.09153387695550919, 0.09078618139028549, 0.0898558720946312, 0.09210415929555893, 0.09201004356145859, 0.09106719493865967, 0.09097414463758469, 0.08939774334430695, 0.09013882279396057, 0.09069555997848511], [0.0924878939986229, 0.09278624504804611, 0.09051598608493805, 0.08774352073669434, 0.09454317390918732, 0.09425171464681625, 0.09136483073234558, 0.09108316898345947, 0.08639935404062271, 0.0885806605219841, 0.0902433916926384], [0.091993547976017, 0.09219645708799362, 0.09064724296331406, 0.08873856067657471, 0.093387171626091, 0.09319013357162476, 0.09122790396213531, 0.09103542566299438, 0.087806336581707, 0.08931686729192734, 0.0904603973031044], [0.09162215143442154, 0.09175458550453186, 0.09074088931083679, 0.08948376029729843, 0.09252971410751343, 0.09240167587995529, 0.09112153202295303, 0.09099544584751129, 0.08886636793613434, 0.08986562490463257, 0.09061823785305023]], [[0.0839301198720932, 0.08364105969667435, 0.08335300534963608, 0.0830659419298172, 0.08277986198663712, 0.08720603585243225, 0.08482534438371658, 0.08660639822483063, 0.15093523263931274, 0.08631591498851776, 0.08734114468097687], [0.0836387649178505, 0.08334065228700638, 0.08304359763860703, 0.08274760097265244, 0.08245266228914261, 0.0870198979973793, 0.08456230163574219, 0.08640066534280777, 0.15353374183177948, 0.086100734770298, 0.08715943247079849], [0.083344005048275, 0.08303689956665039, 0.08273093402385712, 0.08242610841989517, 0.08212239295244217, 0.0868295356631279, 0.08429557830095291, 0.0861908346414566, 0.15616868436336517, 0.08588153123855591, 0.08697348088026047], [0.08304580301046371, 0.08272982388734818, 0.08241502195596695, 0.08210143446922302, 0.081789031624794, 0.08663492649793625, 0.08402518928050995, 0.08597688376903534, 0.15884029865264893, 0.08565828204154968, 0.0867832601070404], [0.08274416625499725, 0.08241936564445496, 0.08209583908319473, 0.08177359402179718, 0.08145260065793991, 0.08643604815006256, 0.08375108987092972, 0.08575879782438278, 0.16154880821704865, 0.08543094247579575, 0.08658872544765472], [0.08694037795066833, 0.08675718307495117, 0.08657436817884445, 0.08639194816350937, 0.08620990812778473, 0.08899975568056107, 0.08750621229410172, 0.08862508088350296, 0.12446800619363785, 0.08844319730997086, 0.08908403664827347], [0.08480492234230042, 0.08454425632953644, 0.08428439497947693, 0.0840253233909607, 0.08376705646514893, 0.08775247633457184, 0.08561162650585175, 0.08721385151147842, 0.14316964149475098, 0.08695276826620102, 0.08787377923727036], [0.0864274799823761, 0.08622453361749649, 0.08602206408977509, 0.08582005649805069, 0.08561854064464569, 0.08871223032474518, 0.08705462515354156, 0.08829609304666519, 0.12892431020736694, 0.08809416741132736, 0.08880586177110672], [0.10467872768640518, 0.1064838096499443, 0.10832000523805618, 0.11018787324428558, 0.11208794265985489, 0.08658658713102341, 0.09931693971157074, 0.08959851413965225, 0.005711797624826431, 0.09110284596681595, 0.08592484891414642], [0.08617312461137772, 0.08596065640449524, 0.08574870973825455, 0.08553729951381683, 0.08532640337944031, 0.08856669068336487, 0.08682981878519058, 0.08813050389289856, 0.1311429888010025, 0.08791888505220413, 0.08866485208272934], [0.08705371618270874, 0.08687499165534973, 0.08669663220643997, 0.08651863783597946, 0.0863410085439682, 0.08906218409538269, 0.08760568499565125, 0.08869685977697372, 0.1234864741563797, 0.08851951360702515, 0.08914435654878616]], [[0.09088698029518127, 0.09051953256130219, 0.09100932627916336, 0.09107055515050888, 0.0907023623585701, 0.0907633975148201, 0.09027175605297089, 0.09088556468486786, 0.09193681925535202, 0.09143882244825363, 0.09051494300365448], [0.09086064249277115, 0.09009763598442078, 0.09111542999744415, 0.09124309569597244, 0.0904768705368042, 0.09060363471508026, 0.08958500623703003, 0.09085769951343536, 0.09305905550718307, 0.09201281517744064, 0.0900881290435791], [0.0908951610326767, 0.0906594917178154, 0.09097355604171753, 0.09101276844739914, 0.09077680110931396, 0.0908159390091896, 0.09050038456916809, 0.09089425951242447, 0.09156660735607147, 0.09124844521284103, 0.09065654873847961], [0.09089915454387665, 0.09072946012020111, 0.09095557779073715, 0.0909838005900383, 0.09081394225358963, 0.09084212779998779, 0.09061482548713684, 0.09089850634336472, 0.0913819670677185, 0.09115331619977951, 0.09072733670473099], [0.0908740758895874, 0.09030783921480179, 0.09106288105249405, 0.09115742892026901, 0.09058942645788193, 0.0906834825873375, 0.08992671221494675, 0.0908718928694725, 0.09249871224164963, 0.09172679483890533, 0.0903007760643959], [0.09087841212749481, 0.09037787467241287, 0.09104523062705994, 0.09112875163555145, 0.09062683582305908, 0.09070997685194016, 0.09004076570272446, 0.09087648242712021, 0.0923125371336937, 0.09163150191307068, 0.09037162363529205], [0.0908413901925087, 0.08981186896562576, 0.09118585288524628, 0.09135857224464417, 0.09032318741083145, 0.09049426764249802, 0.08912189304828644, 0.09083741903305054, 0.09382466226816177, 0.09240178018808365, 0.08979905396699905], [0.09088687598705292, 0.09051790833473206, 0.0910097286105156, 0.091071218252182, 0.09070149809122086, 0.09076277166604996, 0.09026909619569778, 0.0908854603767395, 0.09194110333919525, 0.09144102036952972, 0.09051329642534256], [0.09094802290201187, 0.0917125791311264, 0.09069555997848511, 0.09056959301233292, 0.09133096784353256, 0.09120411425828934, 0.09223353862762451, 0.09095095098018646, 0.08881499618291855, 0.08981745690107346, 0.09172219038009644], [0.09092165529727936, 0.09114891290664673, 0.09084631502628326, 0.09080866724252701, 0.09103564918041229, 0.09099792689085007, 0.0913030132651329, 0.0909225270152092, 0.0902804359793663, 0.09058311581611633, 0.09115176647901535], [0.0908602923154831, 0.09009234607219696, 0.09111673384904861, 0.09124522656202316, 0.09047403186559677, 0.0906016156077385, 0.08957641571760178, 0.09085732698440552, 0.09307316690683365, 0.09202000498771667, 0.09008277207612991]], [[0.09242355078458786, 0.09374063462018967, 0.09357652068138123, 0.09193897992372513, 0.09324915707111359, 0.0942385196685791, 0.09292294085025787, 0.09390884637832642, 0.06971284747123718, 0.09226971119642258, 0.0920182541012764], [0.09164757281541824, 0.09222430735826492, 0.0921526849269867, 0.09143423289060593, 0.09200962632894516, 0.0924411490559578, 0.09186678379774094, 0.09229763597249985, 0.08087699115276337, 0.09157990664243698, 0.0914691761136055], [0.09175247699022293, 0.09241997450590134, 0.09233704954385757, 0.09150572866201401, 0.09217143058776855, 0.09267111122608185, 0.09200611710548401, 0.09250489622354507, 0.07941081374883652, 0.09167420864105225, 0.09154614061117172], [0.09267231076955795, 0.09426838904619217, 0.09406925737857819, 0.09208628535270691, 0.0936722680926323, 0.09487295150756836, 0.09327694773674011, 0.09447256475687027, 0.065940722823143, 0.0924861952662468, 0.09218210726976395], [0.09195465594530106, 0.09280449151992798, 0.0926988273859024, 0.09164093434810638, 0.0924878641963005, 0.09312465786933899, 0.09227738529443741, 0.09291272610425949, 0.07655107229948044, 0.09185512363910675, 0.09169229120016098], [0.0913144201040268, 0.09161849319934845, 0.09158078581094742, 0.09120170772075653, 0.09150540828704834, 0.09173259139060974, 0.09143009781837463, 0.09165709465742111, 0.08546049147844315, 0.09127867966890335, 0.0912201777100563], [0.0921468511223793, 0.09318005293607712, 0.0930514857172966, 0.09176594018936157, 0.09279488027095795, 0.09356983006000519, 0.0925389751791954, 0.09331178665161133, 0.07378595322370529, 0.09202596545219421, 0.09182828664779663], [0.09153752028942108, 0.09202168136835098, 0.09196159243583679, 0.09135830402374268, 0.09184151887893677, 0.09220359474420547, 0.09172160178422928, 0.09208320826292038, 0.08240258693695068, 0.09148068726062775, 0.09138766676187515], [0.09168579429388046, 0.1087980642914772, 0.1065167710185051, 0.08603845536708832, 0.10209669917821884, 0.11599618941545486, 0.09786004573106766, 0.11118274927139282, 0.0030281778890639544, 0.08985709398984909, 0.08693992346525192], [0.0925045982003212, 0.09390988200902939, 0.09373471140861511, 0.09198791533708572, 0.09338534623384476, 0.09444145113229752, 0.09303728491067886, 0.09408945590257645, 0.06849633157253265, 0.09234054386615753, 0.09207242727279663], [0.09263292700052261, 0.09418312460184097, 0.09398975968360901, 0.0920635536313057, 0.09360422194004059, 0.09477011859416962, 0.09322027117013931, 0.09438137710094452, 0.06654591858386993, 0.09245210886001587, 0.09215666353702545]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_duration_sec_mean": 0.005542156295268797, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.90255709553138e-06, "listify_data_for_vector_env": 1.0411364511457899e-05, "un_batch_to_individual_items": 6.797855856947995e-06, "tensor_to_numpy": 1.5223311013401183e-05, "remove_single_ts_time_rank_from_batch": 1.196715207016942e-05, "get_actions": 3.674078671820055e-05}}, "connector_pipeline_timer": 0.00011581394311124428}, "env_to_module_connector": {"connector_pipeline_timer": 5.900261311357533e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.778930120320815e-06, "numpy_to_tensor": 1.2032197753555828e-05, "add_states_from_episodes_to_batch": 2.6961745065075775e-06, "add_observations_from_episodes_to_batch": 2.8160436910751996e-06, "batch_individual_items": 1.2532316442980956e-05}}}, "env_step_timer": 1.4036903616458747e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": -1.25, "episode_return_max": 12.5, "module_episode_returns_mean": {"default_policy": -1.25}, "env_to_module_sum_episodes_length_in": 10.366003441359926, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": -1.25}, "num_env_steps_sampled": 400, "episode_len_max": 20, "weights_seq_no": 2.0, "num_episodes": 20, "num_env_steps_sampled_lifetime": 10400, "env_reset_timer": 0.0006558101356495172, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -14.5, "episode_len_mean": 20.0, "num_episodes_lifetime": 40, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "env_to_module_sum_episodes_length_out": 10.366003441359926, "rlmodule_inference_timer": 3.126634483455695e-05, "sample": 0.12938714488758707, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "time_between_sampling": 9.9314045420615}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "ba9e8_00000", "date": "2025-08-11_18-08-12", "timestamp": 1754928492, "time_this_iter_s": 10.007467031478882, "time_total_s": 19.556040048599243, "pid": 10327, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3858fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.556040048599243, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 38.38571428571429, "ram_util_percent": 81.04285714285713}}
{"timers": {"training_iteration": 9.408652816510235, "restore_env_runners": 1.9668905262369663e-05, "training_step": 9.408421942806234, "env_runner_sampling_timer": 1.7725543794649654, "learner_update_timer": 7.450906231840724, "synch_weights": 0.0014933491233503446, "restore_eval_env_runners": 5.628020968288183e-05, "evaluation_iteration": 0.142447169033112, "synch_eval_env_connectors": 0.00019277245621196926, "synch_env_connectors": 7.032793946564197e-06}, "env_runners": {"env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": -1.3400000000000003}, "rlmodule_inference_timer": 3.186250690010344e-05, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.572357742017189e-05, "get_actions": 4.0036615210555514e-05, "listify_data_for_vector_env": 1.0695719947358516e-05, "un_batch_to_individual_items": 6.689242524235426e-06, "remove_single_ts_time_rank_from_batch": 1.2114270009182659e-05, "normalize_and_clip_actions": 8.217061498305501e-06}}, "connector_pipeline_timer": 0.00012047198158991114}, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.259818813966293e-05, "add_states_from_episodes_to_batch": 2.7651464727344225e-06, "add_time_dim_to_batch_and_zero_pad": 7.214288182725069e-06, "add_observations_from_episodes_to_batch": 2.897308244844164e-06, "numpy_to_tensor": 1.2976154249176478e-05}}, "connector_pipeline_timer": 6.0792502677962654e-05}, "sample": 0.006320568883702099, "episode_duration_sec_mean": 0.005353443611413239, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "agent_episode_returns_mean": {"default_agent": -1.3400000000000003}, "weights_seq_no": 2.0, "episode_return_mean": -1.3400000000000003, "env_step_timer": 1.4269925437047205e-05, "episode_return_max": 8.5, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -607500.0, "env_reset_timer": 4.685185226278053e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "time_between_sampling": 0.033148674731177434, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "episode_return_min": -11.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -30375.0, "num_env_steps_sampled_lifetime_throughput": 3164.901990833557}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.142760563388071, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.010014434453111608, "add_observations_from_episodes_to_batch": 0.001045493755082134, "add_columns_from_episodes_to_train_batch": 0.04492633930483134, "add_time_dim_to_batch_and_zero_pad": 0.07836520163133973, "add_states_from_episodes_to_batch": 0.003792506900790613, "batch_individual_items": 0.004317691321566235, "numpy_to_tensor": 9.097732981899753e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.35831379890441895, "module_train_batch_size_mean": 997.9168410861561, "num_module_steps_trained": 5985, "policy_loss": -8.218683069571853e-05, "use_intrinsic_rewards": 0.0, "num_module_steps_trained_lifetime": 17955, "total_loss": 0.2779942750930786, "weights_seq_no": 3.0, "entropy": 0.6923556327819824, "mean_kl_loss": 3.3525266189826652e-06, "vf_loss_unclipped": 43.52001953125, "num_trainable_parameters": 16595, "curr_kl_coeff": 0.020197991281747818, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.0014903545379638672, "num_module_steps_trained_lifetime_throughput": 809.2892574571729}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 215460, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 594000, "num_env_steps_trained_lifetime_throughput": 58382.52995502035}, "default_policy": {"num_module_steps_trained_lifetime": 107730, "weights_seq_no": 18.0, "diff_num_grad_updates_vs_sampler_policy": 16.0, "entropy": 0.6923625469207764, "mean_kl_loss": 2.914403694376233e-06, "vf_loss_unclipped": 43.38224411010742, "vf_explained_var": 0.0018146634101867676, "num_module_steps_trained": 35910, "use_intrinsic_rewards": 1.0, "vf_loss": 0.35852083563804626, "module_train_batch_size_mean": 997.6672132667843, "total_loss": 0.2781608998775482, "policy_loss": -7.716622349107638e-05}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.6672132667843, "num_module_steps_trained_lifetime": 107730, "total_loss": 0.0, "weights_seq_no": 18.0, "diff_num_grad_updates_vs_sampler_policy": 16.0}}}, "intrinsic_reward_module": {"weights_seq_no": 3.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.9168410861561, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5985, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 17955, "num_module_steps_trained_lifetime_throughput": 809.3068203051544}, "__all_modules__": {"num_env_steps_trained": 33000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 35910, "num_env_steps_trained_lifetime": 99000, "num_env_steps_trained_lifetime_throughput": 4464.102470691639, "num_module_steps_trained_throughput": 27066638.612884272, "num_module_steps_trained_lifetime_throughput": 14750469.040810902}, "IntrinsicAttentionMask": [[[0.09103265404701233, 0.09142366051673889, 0.09076390415430069, 0.09037736058235168, 0.09095722436904907, 0.09126888960599899, 0.09088020771741867, 0.0911916047334671, 0.09053350985050201, 0.09049517661333084, 0.09107579290866852], [0.09067350625991821, 0.0899437665939331, 0.09118034690618515, 0.09191695600748062, 0.09081531316041946, 0.09023153781890869, 0.09096048027276993, 0.09037577360868454, 0.09161829203367233, 0.09169148653745651, 0.09059254825115204], [0.09127569943666458, 0.09245309233665466, 0.09047224372625351, 0.089324951171875, 0.09104973077774048, 0.09198584407567978, 0.0908193588256836, 0.09175311028957367, 0.08978725969791412, 0.08967360109090805, 0.09140510857105255], [0.09161966294050217, 0.09395131468772888, 0.09004504978656769, 0.08781975507736206, 0.09117546677589417, 0.09302257001399994, 0.09072369337081909, 0.09256165474653244, 0.0887131616473198, 0.08849310874938965, 0.09187454730272293], [0.09110117703676224, 0.09171155840158463, 0.0906824916601181, 0.09008152037858963, 0.09098360687494278, 0.09146977961063385, 0.09086359292268753, 0.09134912490844727, 0.09032412618398666, 0.09026453644037247, 0.09116844832897186], [0.0908164530992508, 0.09052703529596329, 0.09101662784814835, 0.09130636602640152, 0.09087252616882324, 0.0906413346529007, 0.09092987328767776, 0.09069854021072388, 0.09118906408548355, 0.09121783077716827, 0.09078441560268402], [0.09117090702056885, 0.0920063778758049, 0.09059900790452957, 0.0897798091173172, 0.0910102128982544, 0.09167519211769104, 0.09084626287221909, 0.09151004999876022, 0.09011027216911316, 0.09002906829118729, 0.09126289188861847], [0.09088744223117828, 0.09081953018903732, 0.09093432128429413, 0.09100203216075897, 0.09090058505535126, 0.09084636718034744, 0.09091401100158691, 0.0908597931265831, 0.09097464382648468, 0.0909813642501831, 0.09087993204593658], [0.09148149937391281, 0.09334354847669601, 0.09021872282028198, 0.0884266048669815, 0.09112571179866791, 0.09260296821594238, 0.09076349437236786, 0.09223488718271255, 0.0891471728682518, 0.08896981924772263, 0.09168550372123718], [0.09151554107666016, 0.09349247068166733, 0.09017622470855713, 0.08827745914459229, 0.0911380723118782, 0.09270591288805008, 0.09075387567281723, 0.09231511503458023, 0.08904062956571579, 0.08885275572538376, 0.09173201024532318], [0.09099334478378296, 0.09125934541225433, 0.09081030637025833, 0.09054674208164215, 0.09094199538230896, 0.09115409851074219, 0.09088953584432602, 0.09110152721405029, 0.09065325558185577, 0.09062711149454117, 0.09102271497249603]], [[0.08730518072843552, 0.08709991723299026, 0.08505865186452866, 0.08669086545705795, 0.0864870548248291, 0.08961591869592667, 0.0860808789730072, 0.08919504284858704, 0.12754188477993011, 0.0871100202202797, 0.08781461417675018], [0.08708920329809189, 0.08687397092580795, 0.08473481982946396, 0.08644508570432663, 0.08623144030570984, 0.08951414376497269, 0.0858057290315628, 0.08907222747802734, 0.12972524762153625, 0.08688456565141678, 0.08762354403734207], [0.08472872525453568, 0.08441653102636337, 0.08133447170257568, 0.08379558473825455, 0.08348681777715683, 0.08827219158411026, 0.08287270367145538, 0.08762287348508835, 0.15353281795978546, 0.08443188667297363, 0.085505411028862], [0.08664754778146744, 0.08641253411769867, 0.08407983928918839, 0.08594439178705215, 0.08571126312017441, 0.08929929882287979, 0.08524692803621292, 0.08881551772356033, 0.1341872215270996, 0.0864240974187851, 0.08723124861717224], [0.08642182499170303, 0.08617700636386871, 0.0837486982345581, 0.08568944782018661, 0.08544669300317764, 0.08918614685535431, 0.08496326208114624, 0.08868155628442764, 0.136466383934021, 0.08618905395269394, 0.08702999353408813], [0.08949325233697891, 0.08940262347459793, 0.08849461376667023, 0.08922164142131805, 0.08913128823041916, 0.09050528705120087, 0.08895085752010345, 0.09032206982374191, 0.1053536906838417, 0.08940708637237549, 0.08971767127513885], [0.08596040308475494, 0.08569617569446564, 0.08307896554470062, 0.08517017960548401, 0.0849083885550499, 0.08894811570644379, 0.08438722044229507, 0.0884021446108818, 0.14112219214439392, 0.08570918440818787, 0.08661701530218124], [0.08912636339664459, 0.08901460468769073, 0.08789633959531784, 0.08879150450229645, 0.08868015557527542, 0.09037623554468155, 0.08845788985490799, 0.09014971554279327, 0.10908382385969162, 0.08902011066675186, 0.08940323442220688], [0.0982416421175003, 0.09993571788072586, 0.11872216314077377, 0.10341200977563858, 0.10519523918628693, 0.08126197755336761, 0.10885448753833771, 0.08408869802951813, 0.006260246969759464, 0.09985154867172241, 0.0941762924194336], [0.08709992468357086, 0.08688517659902573, 0.08475082367658615, 0.086457259953022, 0.08624409884214401, 0.08951924741268158, 0.08581935614347458, 0.08907836675643921, 0.1296169012784958, 0.08689574897289276, 0.08763302862644196], [0.08782531321048737, 0.08764500170946121, 0.08584882318973541, 0.08728548884391785, 0.08710628747940063, 0.08985158801078796, 0.08674898743629456, 0.08948303014039993, 0.12227896600961685, 0.08765388280153275, 0.08827261626720428]], [[0.09119165688753128, 0.09123196452856064, 0.09057357907295227, 0.0905352234840393, 0.09111610054969788, 0.09107751399278641, 0.09138958901166916, 0.09100038558244705, 0.09034367650747299, 0.09030541777610779, 0.09123487770557404], [0.09110767394304276, 0.09113596379756927, 0.09067340940237045, 0.09064643830060959, 0.09105464071035385, 0.09102754294872284, 0.09124656021595001, 0.0909733846783638, 0.09051165729761124, 0.09048472344875336, 0.09113800525665283], [0.09247665107250214, 0.09270486980676651, 0.08903411775827408, 0.08882398903369904, 0.09205005317926407, 0.09183280169963837, 0.09360188990831375, 0.09139985591173172, 0.08778078109025955, 0.08757361024618149, 0.09272138774394989], [0.09255620837211609, 0.09279631823301315, 0.08893807232379913, 0.08871745318174362, 0.09210746735334396, 0.0918789878487587, 0.09374035149812698, 0.09142373502254486, 0.08762255311012268, 0.08740520477294922, 0.09281369298696518], [0.0913490355014801, 0.09141194820404053, 0.09038623422384262, 0.09032660722732544, 0.09123114496469498, 0.09117095917463303, 0.09165813028812408, 0.09105069935321808, 0.0900290459394455, 0.08996964991092682, 0.09141649305820465], [0.09142938256263733, 0.09150388091802597, 0.09029047936201096, 0.09022001177072525, 0.09128981083631516, 0.09121856093406677, 0.09179548919200897, 0.09107623994350433, 0.08986850827932358, 0.08979837596416473, 0.09150926768779755], [0.09077901393175125, 0.09076058119535446, 0.09106317907571793, 0.09108090400695801, 0.09081360697746277, 0.09083128720521927, 0.09068860858678818, 0.09086665511131287, 0.09116959571838379, 0.09118735045194626, 0.09075925499200821], [0.09158990532159805, 0.0916876271367073, 0.09009886533021927, 0.09000680595636368, 0.09140685945749283, 0.09131346642971039, 0.09207042306661606, 0.0911269560456276, 0.08954790234565735, 0.08945640921592712, 0.09169469773769379], [0.09295310080051422, 0.09325297176837921, 0.08845756947994232, 0.08818487077951431, 0.0923931822180748, 0.092108353972435, 0.09443379193544388, 0.09154132753610611, 0.08683393895626068, 0.0865662470459938, 0.09327468276023865], [0.09303230047225952, 0.09334418922662735, 0.08836141973733902, 0.08807837218046188, 0.09245005249977112, 0.09215392172336578, 0.09457270801067352, 0.09156448394060135, 0.0866767093539238, 0.08639907836914062, 0.09336677193641663], [0.09110161662101746, 0.09112903475761414, 0.09068063646554947, 0.09065448492765427, 0.09105020016431808, 0.09102393686771393, 0.09123623371124268, 0.0909714326262474, 0.09052381664514542, 0.0904977023601532, 0.09113101661205292]], [[0.08779164403676987, 0.08758524805307388, 0.08553259819746017, 0.08717390894889832, 0.08513090759515762, 0.08821070939302444, 0.0847310945391655, 0.08969203382730484, 0.12825258076190948, 0.08759541064500809, 0.08830391615629196], [0.08759799599647522, 0.08738149702548981, 0.08522985130548477, 0.08695011585950851, 0.0848090872168541, 0.0880376473069191, 0.08439039438962936, 0.08959261327981949, 0.13048316538333893, 0.08739215135574341, 0.08813545852899551], [0.08544555306434631, 0.0851307213306427, 0.08202258497476578, 0.08450451493263245, 0.08141924440860748, 0.08608610183000565, 0.08082033693790436, 0.08836418390274048, 0.15483179688453674, 0.08514620363712311, 0.08622881025075912], [0.08720012754201889, 0.08696360141038895, 0.0846160352230072, 0.08649247884750366, 0.08415763825178146, 0.0876806229352951, 0.0837017148733139, 0.08938192576169968, 0.13504301011562347, 0.08697524666786194, 0.08778754621744156], [0.08497319370508194, 0.08463964611291885, 0.08135119825601578, 0.08397647738456726, 0.08071379363536835, 0.08565205335617065, 0.08008137345314026, 0.08806905150413513, 0.16008378565311432, 0.08465605974197388, 0.08580333739519119], [0.08817276358604431, 0.08798696845769882, 0.08613672852516174, 0.08761656284332275, 0.08577410876750946, 0.08854985982179642, 0.08541301637887955, 0.08988133817911148, 0.12383884936571121, 0.08799611777067184, 0.0886337012052536], [0.08448543399572372, 0.08413347601890564, 0.08066810667514801, 0.08343394100666046, 0.07999739050865173, 0.08520202338695526, 0.07933225482702255, 0.08775617927312851, 0.1654786318540573, 0.0841507837176323, 0.0853617712855339], [0.08939715474843979, 0.08928505331277847, 0.08816339075565338, 0.08906126767396927, 0.08794242143630981, 0.08962439000606537, 0.08772199600934982, 0.09042360633611679, 0.10941524803638458, 0.0892905741930008, 0.08967486023902893], [0.09360205382108688, 0.09521611779928207, 0.11311537772417068, 0.09852824360132217, 0.11705011874437332, 0.09041968733072281, 0.12112175673246384, 0.08011748641729355, 0.005964574869722128, 0.09513592720031738, 0.0897286906838417], [0.08760762214660645, 0.08739162236452103, 0.08524484187364578, 0.08696122467517853, 0.08482500910758972, 0.08804626017808914, 0.08440724015235901, 0.08959759771823883, 0.13037246465682983, 0.08740225434303284, 0.08814384043216705], [0.0882553830742836, 0.08807418495416641, 0.08626921474933624, 0.08771291375160217, 0.08591534197330475, 0.08862310647964478, 0.08556292206048965, 0.08992121368646622, 0.12287776917219162, 0.08808310329914093, 0.08870487660169601]], [[0.09115980565547943, 0.09155136346817017, 0.09054194390773773, 0.09085218608379364, 0.09108427911996841, 0.09104570001363754, 0.09100714325904846, 0.09096860885620117, 0.09031212329864502, 0.09027387946844101, 0.0912030041217804], [0.09043416380882263, 0.08970634639263153, 0.09160115569829941, 0.09101232141256332, 0.09057559818029404, 0.09064795821905136, 0.09072037786245346, 0.09079285711050034, 0.09204111248254776, 0.0921146497130394, 0.09035342186689377], [0.0922967717051506, 0.09453006088733673, 0.08886093646287918, 0.0905727669596672, 0.09187100827693939, 0.09165418893098831, 0.09143787622451782, 0.09122207760810852, 0.08761003613471985, 0.08740327507257462, 0.09254103899002075], [0.09172715991735458, 0.09302400797605515, 0.0897064134478569, 0.09071715921163559, 0.09147845208644867, 0.09135162085294724, 0.09122496098279953, 0.09109847992658615, 0.08896273374557495, 0.08883938193321228, 0.09186962246894836], [0.09129934012889862, 0.09191104769706726, 0.09033706784248352, 0.09081978350877762, 0.09118150919675827, 0.0911213606595993, 0.09106124192476273, 0.09100116044282913, 0.08998006582260132, 0.08992070704698563, 0.09136676043272018], [0.09137053787708282, 0.09209521114826202, 0.09023236483335495, 0.09080304950475693, 0.09123105555772781, 0.09115985780954361, 0.09108871221542358, 0.09101762622594833, 0.08981066942214966, 0.0897405743598938, 0.09145036339759827], [0.09144167602062225, 0.09227962791919708, 0.09012766182422638, 0.09078619629144669, 0.0912805050611496, 0.09119825065135956, 0.09111607074737549, 0.09103396534919739, 0.08964147418737411, 0.08956069499254227, 0.09153392910957336], [0.09151273965835571, 0.09246428310871124, 0.09002295881509781, 0.0907692238688469, 0.09132985025644302, 0.09123653918504715, 0.09114331007003784, 0.09105018526315689, 0.0894724652171135, 0.08938104659318924, 0.09161745011806488], [0.0927169919013977, 0.09565935283899307, 0.08823287487030029, 0.09046046435832977, 0.0921584963798523, 0.0918743908405304, 0.09159115701913834, 0.09130880236625671, 0.08661337196826935, 0.08634635806083679, 0.09303775429725647], [0.0927867740392685, 0.09584842622280121, 0.08812820911407471, 0.09044133871793747, 0.09220606833696365, 0.0919107124209404, 0.09161630272865295, 0.09132283926010132, 0.08644795417785645, 0.08617104589939117, 0.09312035888433456], [0.09107993543148041, 0.09134618192911148, 0.09065905213356018, 0.09087049961090088, 0.09102852642536163, 0.09100227802991867, 0.09097602963447571, 0.09094978123903275, 0.09050226956605911, 0.09047616273164749, 0.09110932052135468]], [[0.08409050107002258, 0.08380089700222015, 0.08616836369037628, 0.08322466909885406, 0.0829380452632904, 0.08737269788980484, 0.08498743921518326, 0.08953166753053665, 0.14656254649162292, 0.08381513506174088, 0.08750805258750916], [0.08381139487028122, 0.08351266384124756, 0.08595579862594604, 0.08291839063167572, 0.08262284100055695, 0.08719952404499054, 0.08473683893680573, 0.08943060785531998, 0.14894519746303558, 0.08352737128734589, 0.08733933418989182], [0.08598323911428452, 0.08576036244630814, 0.0875767171382904, 0.08531636744737625, 0.08509523421525955, 0.08849593251943588, 0.08667226135730743, 0.09013599157333374, 0.13059347867965698, 0.085771344602108, 0.08859904855489731], [0.0832444429397583, 0.08292769640684128, 0.08552038669586182, 0.08229780942201614, 0.08198466151952744, 0.08684216439723969, 0.08422616869211197, 0.08921647071838379, 0.15380603075027466, 0.08294327557086945, 0.0869908481836319], [0.08295655995607376, 0.08263092488050461, 0.08529749512672424, 0.08198348432779312, 0.08166167885065079, 0.08665793389081955, 0.08396607637405396, 0.0891033187508583, 0.1562846153974533, 0.08264695107936859, 0.08681100606918335], [0.08699699491262436, 0.08681368082761765, 0.08830513060092926, 0.08644820749759674, 0.08626604825258255, 0.08905771374702454, 0.08756318688392639, 0.09039683640003204, 0.12218748778104782, 0.08682270348072052, 0.08914203941822052], [0.08493070304393768, 0.08466964960098267, 0.08680089563131332, 0.08414994925260544, 0.08389128744602203, 0.0878826230764389, 0.08573859930038452, 0.0898178219795227, 0.13943180441856384, 0.08468249440193176, 0.08800410479307175], [0.0886746346950531, 0.08856344223022461, 0.08946539461612701, 0.08834146708250046, 0.0882306843996048, 0.08991817384958267, 0.08901748806238174, 0.09072001278400421, 0.10853094607591629, 0.08856892585754395, 0.08996881544589996], [0.10544130951166153, 0.10714202374219894, 0.09415499866008759, 0.11062619090080261, 0.11241055279970169, 0.08828481286764145, 0.10037826001644135, 0.0788349136710167, 0.008016173727810383, 0.10705756396055222, 0.08765324205160141], [0.08382523059844971, 0.08352693915367126, 0.08596636354923248, 0.08293355256319046, 0.0826384425163269, 0.08720814436674118, 0.0847492665052414, 0.08943568915128708, 0.14882703125476837, 0.0835416242480278, 0.08734774589538574], [0.08710732311010361, 0.08692849427461624, 0.08838322013616562, 0.08657191693782806, 0.08639418333768845, 0.08911703526973724, 0.08765962719917297, 0.0904223695397377, 0.12127934396266937, 0.08693729341030121, 0.0891992524266243]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_duration_sec_mean": 0.008528653499282276, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.521904519280832e-05, "listify_data_for_vector_env": 2.3246566443921916e-05, "un_batch_to_individual_items": 1.1249808833983584e-05, "tensor_to_numpy": 3.469777518772782e-05, "remove_single_ts_time_rank_from_batch": 2.053133463452885e-05, "get_actions": 0.00010719720908013692}}, "connector_pipeline_timer": 0.0002646276043656242}, "env_to_module_connector": {"connector_pipeline_timer": 0.00012708126384623793, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.4876921179820958e-05, "numpy_to_tensor": 3.473368127676954e-05, "add_states_from_episodes_to_batch": 4.8156879270996046e-06, "add_observations_from_episodes_to_batch": 5.95127848237669e-06, "batch_individual_items": 2.693972484443673e-05}}}, "env_step_timer": 3.787423321430993e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": -1.5833333333333333, "episode_return_max": 12.5, "module_episode_returns_mean": {"default_policy": -1.5833333333333333}, "env_to_module_sum_episodes_length_in": 10.368205581254823, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": -1.5833333333333333}, "num_env_steps_sampled": 400, "episode_len_max": 20, "weights_seq_no": 3.0, "num_episodes": 20, "num_env_steps_sampled_lifetime": 15400, "env_reset_timer": 0.0006574662039405666, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -14.5, "episode_len_mean": 20.0, "num_episodes_lifetime": 60, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "env_to_module_sum_episodes_length_out": 10.368205581254823, "rlmodule_inference_timer": 8.744109946844497e-05, "sample": 0.13138912510868395, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "time_between_sampling": 9.927084136641351}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "ba9e8_00000", "date": "2025-08-11_18-08-22", "timestamp": 1754928502, "time_this_iter_s": 9.812612295150757, "time_total_s": 29.36865234375, "pid": 10327, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3858fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 29.36865234375, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 40.82857142857143, "ram_util_percent": 81.23571428571428}}
{"timers": {"training_iteration": 9.410216691685248, "restore_env_runners": 1.956180594896432e-05, "training_step": 9.409985203798474, "env_runner_sampling_timer": 1.7723217290108475, "learner_update_timer": 7.45262992452139, "synch_weights": 0.0014873481320303399, "restore_eval_env_runners": 5.647907694801688e-05, "evaluation_iteration": 0.1446077194230049, "synch_eval_env_connectors": 0.0001971430718083866, "synch_env_connectors": 7.0612164679914715e-06}, "env_runners": {"env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": -1.5}, "rlmodule_inference_timer": 3.6042698861801774e-05, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.73368862941745e-05, "get_actions": 4.6029963074323194e-05, "listify_data_for_vector_env": 1.1605225052196888e-05, "un_batch_to_individual_items": 7.233316212092385e-06, "remove_single_ts_time_rank_from_batch": 1.3072829780941559e-05, "normalize_and_clip_actions": 8.839364386515051e-06}}, "connector_pipeline_timer": 0.00013320167934679228}, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.3959096984636288e-05, "add_states_from_episodes_to_batch": 3.0012663521145014e-06, "add_time_dim_to_batch_and_zero_pad": 7.97608824263168e-06, "add_observations_from_episodes_to_batch": 3.2191758982300313e-06, "numpy_to_tensor": 1.4581738239242779e-05}}, "connector_pipeline_timer": 6.69413962438637e-05}, "sample": 0.00614101418977971, "episode_duration_sec_mean": 0.0059652869948185975, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "agent_episode_returns_mean": {"default_agent": -1.5}, "weights_seq_no": 3.0, "episode_return_mean": -1.5, "env_step_timer": 1.5963390024067035e-05, "episode_return_max": 8.5, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -1225000.0, "env_reset_timer": 5.209684988114018e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "time_between_sampling": 0.03370373122619994, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "episode_return_min": -11.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -61250.0, "num_env_steps_sampled_lifetime_throughput": 2956.497857809558}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.14271062900456527, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.010023526778539993, "add_observations_from_episodes_to_batch": 0.001044458396823029, "add_columns_from_episodes_to_train_batch": 0.04490241883155366, "add_time_dim_to_batch_and_zero_pad": 0.07833448544483153, "add_states_from_episodes_to_batch": 0.003791982671865844, "batch_individual_items": 0.004315790238358662, "numpy_to_tensor": 9.0795056821662e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.35831454396247864, "module_train_batch_size_mean": 997.8923005732703, "num_module_steps_trained": 5985, "policy_loss": -0.0007937122718431056, "use_intrinsic_rewards": 0.0, "num_module_steps_trained_lifetime": 23940, "total_loss": 0.27728471159935, "weights_seq_no": 4.0, "entropy": 0.6919724941253662, "mean_kl_loss": 4.4043837988283485e-05, "vf_loss_unclipped": 44.688140869140625, "num_trainable_parameters": 16595, "curr_kl_coeff": 0.010098995640873909, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.00020503997802734375, "num_module_steps_trained_lifetime_throughput": 806.3420008973908}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 287280, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 792000, "num_env_steps_trained_lifetime_throughput": 57660.58432503893}, "default_policy": {"num_module_steps_trained_lifetime": 143640, "weights_seq_no": 24.0, "diff_num_grad_updates_vs_sampler_policy": 21.0, "entropy": 0.6919981837272644, "mean_kl_loss": 3.917759386240505e-05, "vf_loss_unclipped": 44.6672477722168, "vf_explained_var": 0.0019012689590454102, "num_module_steps_trained": 35910, "use_intrinsic_rewards": 1.0, "vf_loss": 0.3585038483142853, "module_train_batch_size_mean": 997.6156867483631, "total_loss": 0.2774828374385834, "policy_loss": -0.0007484097150154412}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.6156867483631, "num_module_steps_trained_lifetime": 143640, "total_loss": 0.0, "weights_seq_no": 24.0, "diff_num_grad_updates_vs_sampler_policy": 21.0}}}, "intrinsic_reward_module": {"weights_seq_no": 4.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.8923005732703, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5985, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 23940, "num_module_steps_trained_lifetime_throughput": 806.35903144271}, "__all_modules__": {"num_env_steps_trained": 33000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 47880, "num_env_steps_trained_lifetime": 132000, "num_env_steps_trained_lifetime_throughput": 4447.804617091845, "num_module_steps_trained_throughput": 26431366.055940326, "num_module_steps_trained_lifetime_throughput": 14639587.610872468}, "IntrinsicAttentionMask": [[[0.09078565984964371, 0.09041861444711685, 0.09146446734666824, 0.09152600169181824, 0.09004989266395569, 0.09066220372915268, 0.0907232016324997, 0.09078424423933029, 0.09127546846866608, 0.09189610928297043, 0.09041403234004974], [0.09064880758523941, 0.0898875743150711, 0.09206543862819672, 0.09219443053007126, 0.08912622183561325, 0.09039239585399628, 0.09051904082298279, 0.09064587205648422, 0.09166986495256424, 0.09297218173742294, 0.08987808972597122], [0.09102822840213776, 0.09139364957809448, 0.09036009758710861, 0.09030000865459442, 0.09176372736692429, 0.09115081280469894, 0.09109019488096237, 0.09102962911128998, 0.09054512530565262, 0.08994034677743912, 0.09139823168516159], [0.09104954451322556, 0.09148158133029938, 0.09026043117046356, 0.09018951654434204, 0.0919194445014, 0.09119443595409393, 0.09112279117107391, 0.09105120599269867, 0.09047885984182358, 0.08976521342992783, 0.09148700535297394], [0.09050726890563965, 0.08935141563415527, 0.09267180413007736, 0.09286976605653763, 0.08820050209760666, 0.09011736512184143, 0.09030986577272415, 0.0905027911067009, 0.09206561744213104, 0.09406647831201553, 0.08933704346418381], [0.09074007719755173, 0.09024029970169067, 0.09166630357503891, 0.09175040572881699, 0.08973897993564606, 0.09057189524173737, 0.09065498411655426, 0.09073814749717712, 0.09140817075967789, 0.0922565832734108, 0.09023406356573105], [0.090762659907341, 0.09032844752073288, 0.0915665477514267, 0.09163947403430939, 0.08989257365465164, 0.09061657637357712, 0.09068875014781952, 0.0907609835267067, 0.09134261310100555, 0.09207829087972641, 0.09032302349805832], [0.09078514575958252, 0.09041658043861389, 0.09146679192781448, 0.09152858704328537, 0.09004633873701096, 0.0906611829996109, 0.09072243422269821, 0.0907837301492691, 0.09127699583768845, 0.09190024435520172, 0.09041198343038559], [0.09096205234527588, 0.09112310409545898, 0.09066665172576904, 0.09064003080129623, 0.091285839676857, 0.09101611375808716, 0.09098938852548599, 0.09096267074346542, 0.09074858576059341, 0.09048044681549072, 0.09112512320280075], [0.09117543697357178, 0.09200882166624069, 0.08966265618801117, 0.08952730894088745, 0.09285715222358704, 0.09145452082157135, 0.09131646901369095, 0.09117862582206726, 0.09008018672466278, 0.08871950209140778, 0.09201930463314056], [0.09064708650112152, 0.08988093584775925, 0.0920729711651802, 0.0922028124332428, 0.0891147032380104, 0.09038901329040527, 0.09051648527383804, 0.09064412862062454, 0.0916748046875, 0.09298571944236755, 0.08987139165401459]], [[0.09241990745067596, 0.09225810319185257, 0.09357283264398575, 0.09340901672840118, 0.0932454839348793, 0.09574532508850098, 0.09145334362983704, 0.09390514343976974, 0.06971005350351334, 0.09226606786251068, 0.0920146256685257], [0.0925045758485794, 0.09233147650957108, 0.09373863786458969, 0.09356322884559631, 0.0933881476521492, 0.09606684744358063, 0.09147082269191742, 0.09409452974796295, 0.06843069940805435, 0.09233999997377396, 0.09207102656364441], [0.09175155311822891, 0.0916692242026329, 0.09233612567186356, 0.09225327521562576, 0.09217050671577454, 0.09342817962169647, 0.09125872701406479, 0.09250396490097046, 0.07940998673439026, 0.09167328476905823, 0.0915452167391777], [0.09185363352298737, 0.09176013618707657, 0.09251789003610611, 0.09242371469736099, 0.09232963621616364, 0.09376031905412674, 0.09129408001899719, 0.09270870685577393, 0.07796790450811386, 0.09176474064588547, 0.09161931276321411], [0.09195315092802048, 0.0918484553694725, 0.09269730746746063, 0.0925917699933052, 0.09248635172843933, 0.09409089386463165, 0.0913267731666565, 0.09291120618581772, 0.07654977589845657, 0.09185361862182617, 0.091690793633461], [0.09016112238168716, 0.09022285044193268, 0.08972551673650742, 0.08978695422410965, 0.08984842896461487, 0.08892463892698288, 0.09053216874599457, 0.08960134536027908, 0.10066106915473938, 0.09021981060504913, 0.090316042304039], [0.09289369732141495, 0.09266389906406403, 0.09453604370355606, 0.09430217742919922, 0.09406888484954834, 0.09765351563692093, 0.09152335673570633, 0.09501098841428757, 0.06235382705926895, 0.09267520904541016, 0.09231838583946228], [0.09153704345226288, 0.09147725999355316, 0.0919611006975174, 0.09190105646848679, 0.09184103459119797, 0.09275136142969131, 0.09117896854877472, 0.09208272397518158, 0.08240216970443726, 0.09148021042346954, 0.09138718992471695], [0.09107677638530731, 0.08916708081960678, 0.10580926388502121, 0.10359064489603043, 0.10141853988170624, 0.13966000080108643, 0.08020263910293579, 0.1104443147778511, 0.003008033847436309, 0.08926025778055191, 0.08636243641376495], [0.0925004631280899, 0.09232792258262634, 0.09373051673173904, 0.09355568140745163, 0.09338117390871048, 0.09605103731155396, 0.09147001802921295, 0.09408524632453918, 0.06849324703216553, 0.09233641624450684, 0.09206831455230713], [0.0926278829574585, 0.09243771433830261, 0.09398464858531952, 0.09379168599843979, 0.09359912574291229, 0.09654906392097473, 0.09149269759654999, 0.09437624365091324, 0.06654226034879684, 0.09244707971811295, 0.09215164929628372]], [[0.0911598652601242, 0.09120015799999237, 0.09054200351238251, 0.09050366282463074, 0.09143515676259995, 0.09104575961828232, 0.09135773032903671, 0.09096866101026535, 0.0903121829032898, 0.09062163531780243, 0.09085313975811005], [0.09108535200357437, 0.0911136269569397, 0.09065119177103043, 0.09062422066926956, 0.09127850830554962, 0.09100523591041565, 0.09122420102357864, 0.0909510925412178, 0.0904894769191742, 0.0907071977853775, 0.09086992591619492], [0.09229885041713715, 0.0925266295671463, 0.08886294066905975, 0.08865321427583694, 0.09386445581912994, 0.09165624529123306, 0.09342192858457565, 0.09122412651777267, 0.08761200308799744, 0.089299775660038, 0.09057977050542831], [0.09236928820610046, 0.09260891377925873, 0.0887584537267685, 0.0885382816195488, 0.09401688724756241, 0.0916934385895729, 0.09355103969573975, 0.09123910218477249, 0.08744560182094574, 0.08921714872121811, 0.09056180715560913], [0.09065009653568268, 0.09060885012149811, 0.09128723293542862, 0.09132706373929977, 0.09036903083324432, 0.09076710045337677, 0.09044791013002396, 0.09084632247686386, 0.09152647852897644, 0.09120462089776993, 0.09096529334783554], [0.09137076884508133, 0.09144521504640579, 0.09023259580135345, 0.09016217291355133, 0.09187999367713928, 0.09116008132696152, 0.09173663705587387, 0.09101785719394684, 0.08981090039014816, 0.09037891775369644, 0.09080492705106735], [0.09079360961914062, 0.09077517688274384, 0.09107781946659088, 0.09109555184841156, 0.09066788107156754, 0.09084588289260864, 0.09070318937301636, 0.09088126569986343, 0.09118425846099854, 0.09104102849960327, 0.09093435108661652], [0.09151313453912735, 0.09161078184843063, 0.09002334624528885, 0.08993136137723923, 0.09218153357505798, 0.09123692661523819, 0.09199324995279312, 0.09105058014392853, 0.08947285264730453, 0.0902145504951477, 0.09077176451683044], [0.09272054582834244, 0.09301966428756714, 0.0882362574338913, 0.0879642441868782, 0.09478101134300232, 0.09187790751457214, 0.09419753402471542, 0.09131230413913727, 0.08661669492721558, 0.0888034850358963, 0.09047041088342667], [0.09215248376131058, 0.09235575050115585, 0.08907981961965561, 0.08889186382293701, 0.09354852139949799, 0.09157875180244446, 0.093154177069664, 0.09119270741939545, 0.08795803040266037, 0.08947116881608963, 0.09061668813228607], [0.09172623604536057, 0.09185882657766342, 0.08970955014228821, 0.08958541601896286, 0.09263483434915543, 0.0913514569401741, 0.0923786535859108, 0.0910988301038742, 0.08896733075380325, 0.08996772021055222, 0.09072118997573853]], [[0.08325924724340439, 0.08297250419855118, 0.08531657606363297, 0.08240197598934174, 0.08472993224859238, 0.08926038444042206, 0.08414731919765472, 0.08591414988040924, 0.1497289538383484, 0.08562598377466202, 0.08664301782846451], [0.08294886350631714, 0.08265320956707001, 0.08507119119167328, 0.08206504583358765, 0.08446582406759262, 0.08914458751678467, 0.08386477082967758, 0.08568798005580902, 0.1522674858570099, 0.08539053052663803, 0.08644049614667892], [0.08536895364522934, 0.0851476863026619, 0.08695106208324432, 0.0847068578004837, 0.08650089800357819, 0.08995776623487473, 0.08605306595563889, 0.08740881830453873, 0.13275064527988434, 0.08718816936016083, 0.08796608448028564], [0.08231887966394424, 0.08200566470623016, 0.0845695212483406, 0.08138277381658554, 0.08392717689275742, 0.08889975398778915, 0.08328969776630402, 0.08522432297468185, 0.1574501395225525, 0.08490849286317825, 0.08602362871170044], [0.0847877711057663, 0.08454758673906326, 0.08650683611631393, 0.08406923711299896, 0.08601740002632141, 0.08978182822465897, 0.08553074300289154, 0.08700477331876755, 0.13737784326076508, 0.08676472306251526, 0.08761126548051834], [0.0888930931687355, 0.08880306780338287, 0.08953262865543365, 0.0886233001947403, 0.08935139328241348, 0.0907287746667862, 0.08917050808668137, 0.0897163525223732, 0.1056138351559639, 0.08962786942720413, 0.08993921428918839], [0.08419469743967056, 0.08393590897321701, 0.08604869246482849, 0.08342070132493973, 0.08552052080631256, 0.08958937227725983, 0.08499559760093689, 0.08658628910779953, 0.14213959872722626, 0.08632709830999374, 0.08724147081375122], [0.08594493567943573, 0.08574312180280685, 0.08738648891448975, 0.08534090965986252, 0.08697657287120819, 0.09011933207511902, 0.08656857907772064, 0.08780312538146973, 0.12820453941822052, 0.08760232478380203, 0.08831004053354263], [0.109510637819767, 0.11139903217554092, 0.09703324735164642, 0.1152740865945816, 0.10040857642889023, 0.07756433635950089, 0.10390132665634155, 0.0937342494726181, 0.00597537774592638, 0.09530803561210632, 0.08989103138446808], [0.08566916733980179, 0.085457943379879, 0.08717861771583557, 0.08503706753253937, 0.08674927055835724, 0.09004359692335129, 0.08632203191518784, 0.08761510998010635, 0.13037611544132233, 0.08740472793579102, 0.08814632892608643], [0.08662625402212143, 0.08644840121269226, 0.08789510279893875, 0.08609379827976227, 0.08753456175327301, 0.09029336273670197, 0.08717550337314606, 0.08826132863759995, 0.12288017570972443, 0.08808483928442001, 0.08870662748813629]], [[0.09103260189294815, 0.09142360836267471, 0.09076385200023651, 0.09072540700435638, 0.0909571722149849, 0.0909186601638794, 0.09123018383979797, 0.09119155257940292, 0.09018610417842865, 0.09049512445926666, 0.09107574075460434], [0.09067331999540329, 0.08994357287883759, 0.09118016064167023, 0.09125300496816635, 0.09081511944532394, 0.09088767319917679, 0.09030342847108841, 0.09037557244300842, 0.09228451550006866, 0.09169129282236099, 0.09059235453605652], [0.09127522259950638, 0.09245261549949646, 0.0904717817902565, 0.09035725891590118, 0.09104926139116287, 0.09093400090932846, 0.09186892956495285, 0.09175263345241547, 0.08876056224107742, 0.08967313915491104, 0.09140463918447495], [0.09130962193012238, 0.09260056167840958, 0.09042960405349731, 0.09030422568321228, 0.0910620465874672, 0.09093579649925232, 0.09196038544178009, 0.09183288365602493, 0.08855777978897095, 0.08955558389425278, 0.09145143628120422], [0.09110104292631149, 0.09171142429113388, 0.09068235754966736, 0.09062253683805466, 0.09098347276449203, 0.09092345088720322, 0.09140930324792862, 0.09134899824857712, 0.089784637093544, 0.09026440978050232, 0.09116832166910172], [0.0911358967423439, 0.09185870736837387, 0.0906405970454216, 0.0905698612332344, 0.09099676460027695, 0.09092574566602707, 0.09150081872940063, 0.09142941236495972, 0.08958002924919128, 0.09014658629894257, 0.09121552109718323], [0.09085197001695633, 0.09067319333553314, 0.09097550064325333, 0.09099320322275162, 0.09088657796382904, 0.09090427309274673, 0.09076149016618729, 0.09077915549278259, 0.09124286472797394, 0.09109954535961151, 0.0908321887254715], [0.09088744968175888, 0.09081953018903732, 0.09093432128429413, 0.09094104170799255, 0.09090058505535126, 0.09090729802846909, 0.09085308015346527, 0.0908597931265831, 0.09103565663099289, 0.0909813642501831, 0.09087993949651718], [0.09178458154201508, 0.09469734877347946, 0.08982767164707184, 0.08955074846744537, 0.09123170375823975, 0.09095045179128647, 0.09324665367603302, 0.0929591953754425, 0.08574234694242477, 0.08790706098079681, 0.09210211783647537], [0.0915142372250557, 0.09349113702774048, 0.09017493575811386, 0.08998467773199081, 0.09113676846027374, 0.09094447642564774, 0.09250897914171219, 0.09231379628181458, 0.0873488336801529, 0.08885148912668228, 0.09173069894313812], [0.09099332988262177, 0.09125932306051254, 0.09081028401851654, 0.09078409522771835, 0.09094197303056717, 0.090915746986866, 0.09112778306007385, 0.0911015048623085, 0.09041621536016464, 0.09062708914279938, 0.09102269262075424]], [[0.08803138881921768, 0.08782443404197693, 0.08576618880033493, 0.08741196990013123, 0.08536339551210403, 0.0903613492846489, 0.08679690957069397, 0.0880361869931221, 0.1258847862482071, 0.08597826957702637, 0.088545061647892], [0.08785383403301239, 0.08763670921325684, 0.085478775203228, 0.08720406144857407, 0.08505677431821823, 0.0903000608086586, 0.08655908703804016, 0.08785887062549591, 0.12795805931091309, 0.08570100367069244, 0.08839285373687744], [0.08588627725839615, 0.0855698212981224, 0.0824456512928009, 0.08494038134813309, 0.0818391963839531, 0.08947814255952835, 0.08400490880012512, 0.08589362353086472, 0.1505027711391449, 0.0827656164765358, 0.08667357265949249], [0.0874892920255661, 0.08725199103355408, 0.08489664644002914, 0.08677930384874344, 0.08443671464920044, 0.09016679227352142, 0.0860750749707222, 0.08749480545520782, 0.1321917623281479, 0.08513893932104111, 0.08807865530252457], [0.08545580506324768, 0.08512036502361298, 0.08181323856115341, 0.08445342630147934, 0.08117221295833588, 0.08926867693662643, 0.08346280455589294, 0.08546359091997147, 0.15534770488739014, 0.08215156942605972, 0.08629065752029419], [0.08980082720518112, 0.08970988541841507, 0.08879875391721725, 0.08952827751636505, 0.08861899375915527, 0.09081633388996124, 0.08925656229257584, 0.08980292826890945, 0.10474813729524612, 0.08889320492744446, 0.09002600610256195], [0.08691863715648651, 0.08665147423744202, 0.08400508761405945, 0.08611960709095001, 0.08348946273326874, 0.0899396538734436, 0.08532792329788208, 0.08692483603954315, 0.13876381516456604, 0.08427687734365463, 0.08758256584405899], [0.0880354717373848, 0.08782874792814255, 0.0857728123664856, 0.08741675317287445, 0.08537047356367111, 0.09036273509263992, 0.0868023931980133, 0.08804026991128922, 0.12583710253238678, 0.08598466962575912, 0.08854856342077255], [0.09387271106243134, 0.09538682550191879, 0.11207349598407745, 0.09848872572183609, 0.11571803689002991, 0.07859861105680466, 0.10333172976970673, 0.0938379168510437, 0.008252090774476528, 0.11020757257938385, 0.09023232758045197], [0.08610673993825912, 0.08580033481121063, 0.08277337998151779, 0.0851907953619957, 0.08218535035848618, 0.08958172053098679, 0.08428459614515305, 0.08611384779214859, 0.14801090955734253, 0.08308357000350952, 0.08686883002519608], [0.08845711499452591, 0.08827550709247589, 0.08646640181541443, 0.0879134014248848, 0.08611172437667847, 0.09049796313047409, 0.0873730406165123, 0.08846132457256317, 0.1208827868103981, 0.08665306866168976, 0.0889076292514801]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_duration_sec_mean": 0.00776642762357369, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.131436830887901e-06, "listify_data_for_vector_env": 1.0789094063432214e-05, "un_batch_to_individual_items": 6.75485903807733e-06, "tensor_to_numpy": 1.5700209207081094e-05, "remove_single_ts_time_rank_from_batch": 1.2221591809158473e-05, "get_actions": 3.9036646113328384e-05}}, "connector_pipeline_timer": 0.00012061191685420288}, "env_to_module_connector": {"connector_pipeline_timer": 6.164511104611619e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.136628761527906e-06, "numpy_to_tensor": 1.291762109592409e-05, "add_states_from_episodes_to_batch": 2.8096120837283493e-06, "add_observations_from_episodes_to_batch": 2.895610245630436e-06, "batch_individual_items": 1.3002490182376953e-05}}}, "env_step_timer": 1.5167398869413229e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": -1.5, "episode_return_max": 14.5, "module_episode_returns_mean": {"default_policy": -1.5}, "env_to_module_sum_episodes_length_in": 10.368237912813044, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": -1.5}, "num_env_steps_sampled": 400, "episode_len_max": 20, "weights_seq_no": 4.0, "num_episodes": 20, "num_env_steps_sampled_lifetime": 20400, "env_reset_timer": 0.0006540590421549277, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -14.5, "episode_len_mean": 20.0, "num_episodes_lifetime": 80, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "env_to_module_sum_episodes_length_out": 10.368237912813044, "rlmodule_inference_timer": 3.2956274595463685e-05, "sample": 0.13128454343716883, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "time_between_sampling": 9.92419721777431}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "ba9e8_00000", "date": "2025-08-11_18-08-32", "timestamp": 1754928512, "time_this_iter_s": 9.698528051376343, "time_total_s": 39.06718039512634, "pid": 10327, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3858fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 39.06718039512634, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 40.949999999999996, "ram_util_percent": 81.46428571428571}}
{"timers": {"training_iteration": 9.42579612476887, "restore_env_runners": 1.943660868180101e-05, "training_step": 9.425564589680116, "env_runner_sampling_timer": 1.7724447183906675, "learner_update_timer": 7.468076565685965, "synch_weights": 0.0014906950606938057, "restore_eval_env_runners": 5.605553638096899e-05, "evaluation_iteration": 0.14446906097914106, "synch_eval_env_connectors": 0.00019647914115095047, "synch_env_connectors": 7.041433561127634e-06}, "env_runners": {"env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 0.17999999999999997}, "rlmodule_inference_timer": 3.6802760352676327e-05, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.7691813186196803e-05, "get_actions": 4.706159952891084e-05, "listify_data_for_vector_env": 1.1978721848636735e-05, "un_batch_to_individual_items": 7.360272480572709e-06, "remove_single_ts_time_rank_from_batch": 1.3026201234486201e-05, "normalize_and_clip_actions": 9.069524355399545e-06}}, "connector_pipeline_timer": 0.00013580103591249993}, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.4190609388692036e-05, "add_states_from_episodes_to_batch": 3.0731986333693014e-06, "add_time_dim_to_batch_and_zero_pad": 8.215626189083745e-06, "add_observations_from_episodes_to_batch": 3.1926089058565e-06, "numpy_to_tensor": 1.480103496669297e-05}}, "connector_pipeline_timer": 6.785357822867513e-05}, "sample": 0.006576592689925047, "episode_duration_sec_mean": 0.006070992174092681, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "agent_episode_returns_mean": {"default_agent": 0.17999999999999997}, "weights_seq_no": 4.0, "episode_return_mean": 0.17999999999999997, "env_step_timer": 1.663029183020025e-05, "episode_return_max": 8.5, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -1842500.0, "env_reset_timer": 6.051856672610502e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "time_between_sampling": 0.03260832443516867, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "episode_return_min": -11.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -92125.0, "num_env_steps_sampled_lifetime_throughput": 2851.58586079012}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1426288085541536, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.010012318180493406, "add_observations_from_episodes_to_batch": 0.0010433250630329418, "add_columns_from_episodes_to_train_batch": 0.04487079506364868, "add_time_dim_to_batch_and_zero_pad": 0.07830066767013492, "add_states_from_episodes_to_batch": 0.00379073367501513, "batch_individual_items": 0.004314193165824989, "numpy_to_tensor": 9.055752579370164e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.3583179712295532, "module_train_batch_size_mean": 997.8691961675322, "num_module_steps_trained": 5985, "policy_loss": -0.0004257166001480073, "use_intrinsic_rewards": 0.0, "num_module_steps_trained_lifetime": 29925, "total_loss": 0.27765578031539917, "weights_seq_no": 5.0, "entropy": 0.69142085313797, "mean_kl_loss": 4.4779240852221847e-05, "vf_loss_unclipped": 43.131683349609375, "num_trainable_parameters": 16595, "curr_kl_coeff": 0.0050494978204369545, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.0006891489028930664, "num_module_steps_trained_lifetime_throughput": 801.6864080018644}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 359100, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 990000, "num_env_steps_trained_lifetime_throughput": 56811.622096085805}, "default_policy": {"num_module_steps_trained_lifetime": 179550, "weights_seq_no": 30.0, "diff_num_grad_updates_vs_sampler_policy": 26.0, "entropy": 0.6914374828338623, "mean_kl_loss": 4.213014472043142e-05, "vf_loss_unclipped": 43.07603073120117, "vf_explained_var": 0.0018525123596191406, "num_module_steps_trained": 35910, "use_intrinsic_rewards": 1.0, "vf_loss": 0.3584996163845062, "module_train_batch_size_mean": 997.5798029998547, "total_loss": 0.2778162658214569, "policy_loss": -0.00041301583405584097}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.5798029998547, "num_module_steps_trained_lifetime": 179550, "total_loss": 0.0, "weights_seq_no": 30.0, "diff_num_grad_updates_vs_sampler_policy": 26.0}}}, "intrinsic_reward_module": {"weights_seq_no": 5.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.8691961675322, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5985, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 29925, "num_module_steps_trained_lifetime_throughput": 801.7028070095495}, "__all_modules__": {"num_env_steps_trained": 33000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 59850, "num_env_steps_trained_lifetime": 165000, "num_env_steps_trained_lifetime_throughput": 4422.081216971734, "num_module_steps_trained_throughput": 25762753.78562048, "num_module_steps_trained_lifetime_throughput": 14523675.758070713}, "IntrinsicAttentionMask": [[[0.09093700349330902, 0.09001819044351578, 0.09105941653251648, 0.09167858958244324, 0.0902000144124031, 0.09026069939136505, 0.09087444841861725, 0.0909355878829956, 0.09142763167619705, 0.09148914366960526, 0.09111925959587097], [0.09099773317575455, 0.08763182908296585, 0.0914531722664833, 0.09378249198198318, 0.08829055726528168, 0.08851122856140137, 0.09076561033725739, 0.09099247306585312, 0.0928332507610321, 0.09306526929140091, 0.09167645871639252], [0.09092731773853302, 0.09033749997615814, 0.09100573509931564, 0.09140180796384811, 0.09045439213514328, 0.09049338847398758, 0.09088722616434097, 0.0909264087677002, 0.09124138951301575, 0.0912807285785675, 0.09104406088590622], [0.09087269008159637, 0.0919574648141861, 0.0907299667596817, 0.09001433849334717, 0.09174089878797531, 0.09166882187128067, 0.09094579517841339, 0.09087434411048889, 0.09030312299728394, 0.09023217856884003, 0.09066033363342285], [0.09098740667104721, 0.08810257911682129, 0.09137655049562454, 0.09336243569850922, 0.08866840600967407, 0.08885782212018967, 0.09078896045684814, 0.09098290652036667, 0.0925540179014206, 0.09275173395872116, 0.09156722575426102], [0.09098376333713531, 0.08825986832380295, 0.09135082364082336, 0.09322263300418854, 0.0887945145368576, 0.08897345513105392, 0.09079654514789581, 0.09097951650619507, 0.09246093034744263, 0.0926472544670105, 0.09153064340353012], [0.09094181656837463, 0.0898551344871521, 0.091086745262146, 0.0918203592300415, 0.09007001668214798, 0.09014175087213516, 0.09086775779724121, 0.09094014018774033, 0.09152290970087051, 0.09159580618143082, 0.09115760773420334], [0.09093712270259857, 0.0900145024061203, 0.09106003493070602, 0.09168180078268051, 0.09019707143306732, 0.09025801718235016, 0.09087429940700531, 0.09093569219112396, 0.09142979234457016, 0.09149156510829926, 0.09112013876438141], [0.09089597314596176, 0.09129992872476578, 0.0908425971865654, 0.09057418256998062, 0.09121952205896378, 0.09119273722171783, 0.09092328697443008, 0.0908965915441513, 0.09068266302347183, 0.09065603464841843, 0.09081654250621796], [0.09089040756225586, 0.09146098047494888, 0.09081508964300156, 0.09043663740158081, 0.09134732931852341, 0.09130947291851044, 0.09092895686626434, 0.0908912792801857, 0.09058952331542969, 0.09055198729038239, 0.09077832847833633], [0.09092245995998383, 0.09049373865127563, 0.09097939729690552, 0.09126679599285126, 0.09057875722646713, 0.09060712158679962, 0.09089334309101105, 0.0909217968583107, 0.0911504328250885, 0.09117897599935532, 0.09100722521543503]], [[0.08369727432727814, 0.08340903371572495, 0.08312177658081055, 0.0854700580239296, 0.08255022019147873, 0.08696411550045013, 0.08198259025812149, 0.08911299705505371, 0.1505165845155716, 0.08607646077871323, 0.08709884434938431], [0.08339901268482208, 0.08310174942016602, 0.08280554413795471, 0.08522798866033554, 0.0822163000702858, 0.0867704525589943, 0.08163125067949295, 0.08899055421352386, 0.15309369564056396, 0.08585391938686371, 0.08690957725048065], [0.0830974206328392, 0.08279122412204742, 0.08248616009950638, 0.08498212695121765, 0.08187940716743469, 0.08657263964414597, 0.08127711713314056, 0.08886359632015228, 0.15570670366287231, 0.08562742918729782, 0.08671616017818451], [0.0854392722249031, 0.08520752936601639, 0.08497641980648041, 0.08686084300279617, 0.08451605588197708, 0.08805403113365173, 0.08405818790197372, 0.08976257592439651, 0.13561800122261047, 0.087345652282238, 0.0881614163517952], [0.08248423784971237, 0.08216045796871185, 0.08183795213699341, 0.08447892963886261, 0.08119673281908035, 0.08616451919078827, 0.08056052774190903, 0.08859598636627197, 0.16104140877723694, 0.08516256511211395, 0.08631671965122223], [0.08679080009460449, 0.0866079181432724, 0.08642542362213135, 0.08791020512580872, 0.08606157451868057, 0.08884663134813309, 0.08569926768541336, 0.0901825800538063, 0.12425384670495987, 0.08829104155302048, 0.08893076330423355], [0.08185763657093048, 0.08151661604642868, 0.08117702603340149, 0.08396030962467194, 0.08050207793712616, 0.08573953062295914, 0.07983274757862091, 0.08830980211496353, 0.16652236878871918, 0.08468165993690491, 0.08590028434991837], [0.08856412023305893, 0.08845305442810059, 0.08834213763475418, 0.08924183994531631, 0.0881207212805748, 0.08980609476566315, 0.08789985626935959, 0.0906069427728653, 0.109637051820755, 0.08947160840034485, 0.08985666930675507], [0.10595487803220749, 0.10778195410966873, 0.10964054614305496, 0.09550153464078903, 0.1134544238448143, 0.0876421183347702, 0.11740096658468246, 0.07765638083219528, 0.005781388375908136, 0.0922134518623352, 0.08697233349084854], [0.08600018173456192, 0.08578814566135406, 0.085576631128788, 0.08729968965053558, 0.08515516668558121, 0.08838894963264465, 0.08473578095436096, 0.08994632959365845, 0.13087980449199677, 0.08774244040250778, 0.0884869173169136], [0.08690770715475082, 0.08672928810119629, 0.0865512266755104, 0.08799964189529419, 0.08619619905948639, 0.08891280740499496, 0.08584263175725937, 0.09021516144275665, 0.1232793852686882, 0.08837105333805084, 0.08899484574794769]], [[0.09078572690486908, 0.09041868895292282, 0.09146454185247421, 0.0915260761976242, 0.09060131013393402, 0.09011054784059525, 0.09072327613830566, 0.09078431129455566, 0.09183439612388611, 0.09133695065975189, 0.09041409939527512], [0.09064910560846329, 0.08988787233829498, 0.0920657366514206, 0.09219473600387573, 0.09026622772216797, 0.08925139158964157, 0.09051934629678726, 0.0906461700797081, 0.09284240752458572, 0.09179860353469849, 0.0898783877491951], [0.09102828055620193, 0.09139370918273926, 0.09036015719175339, 0.0903000682592392, 0.09121152013540268, 0.09170276671648026, 0.09109025448560715, 0.09102968871593475, 0.09000025689601898, 0.09048498421907425, 0.09139829128980637], [0.09104963392019272, 0.09148167073726654, 0.09026052057743073, 0.0901896134018898, 0.09126622974872589, 0.09184731543064117, 0.09112287312746048, 0.09105129539966583, 0.08983588963747025, 0.09040787070989609, 0.0914870947599411], [0.09071756899356842, 0.090152308344841, 0.09176624566316605, 0.0918615311384201, 0.09043341130018234, 0.08967872709035873, 0.09062130004167557, 0.09071539342403412, 0.0923394113779068, 0.09156881272792816, 0.09014525264501572], [0.09053142368793488, 0.08944031596183777, 0.09257260710000992, 0.0927591547369957, 0.08998211473226547, 0.08853111416101456, 0.09034514427185059, 0.09052719920873642, 0.09369756281375885, 0.09218664467334747, 0.08942673355340958], [0.09076275676488876, 0.09032855182886124, 0.09156664460897446, 0.09163957834243774, 0.09054455906152725, 0.08996427804231644, 0.09068885445594788, 0.09076108783483505, 0.09200511127710342, 0.09141546487808228, 0.09032312780618668], [0.09078521281480789, 0.09041665494441986, 0.09146685153245926, 0.09152865409851074, 0.09060003608465195, 0.09010724723339081, 0.09072250127792358, 0.09078378975391388, 0.09183826297521591, 0.09133873134851456, 0.09041205048561096], [0.09115497767925262, 0.09192127734422684, 0.08976254612207413, 0.0896378681063652, 0.09153880178928375, 0.09257199615240097, 0.09128469973802567, 0.09115791320800781, 0.0890171080827713, 0.09002184122800827, 0.09193091094493866], [0.09098368883132935, 0.09121111035346985, 0.09056698530912399, 0.09052945673465729, 0.09109776467084885, 0.09140318632125854, 0.09102228283882141, 0.09098456054925919, 0.09034204483032227, 0.09064492583274841, 0.09121395647525787], [0.0906473845243454, 0.08988124132156372, 0.09207327663898468, 0.09220311790704727, 0.0902620330452919, 0.0892406702041626, 0.09051678329706192, 0.09064443409442902, 0.09285508096218109, 0.0918043851852417, 0.08987168967723846]], [[0.0920359194278717, 0.09197555482387543, 0.09136960655450821, 0.09185495227575302, 0.0917947068810463, 0.09215815365314484, 0.09113014489412308, 0.0925869271159172, 0.0823223888874054, 0.09143251925706863, 0.09133915603160858], [0.0922355055809021, 0.09216388314962387, 0.09144533425569534, 0.09202080219984055, 0.09194934368133545, 0.0923805832862854, 0.09116163104772568, 0.09288974106311798, 0.08082403987646103, 0.09151990711688995, 0.09140925109386444], [0.09411869943141937, 0.09393123537302017, 0.09206313639879227, 0.09355741739273071, 0.09337106347084045, 0.0944991186261177, 0.0913318321108818, 0.0958416536450386, 0.06706000864505768, 0.09225594252347946, 0.09196990728378296], [0.09262759238481522, 0.09253330528736115, 0.09158869832754135, 0.09234502911567688, 0.09225103259086609, 0.09281864017248154, 0.09121635556221008, 0.093489870429039, 0.07790159434080124, 0.09168661385774612, 0.09154130518436432], [0.09282013773918152, 0.09271445125341415, 0.09165637940168381, 0.09250345081090927, 0.09239813685417175, 0.0930343046784401, 0.09123966842889786, 0.09378721565008163, 0.07647683471441269, 0.09176600724458694, 0.0916033387184143], [0.09162472188472748, 0.09158701449632645, 0.09120791405439377, 0.09151163697242737, 0.09147396683692932, 0.09170106798410416, 0.09105783700942993, 0.09196856617927551, 0.08543114364147186, 0.0912473127245903, 0.09118883311748505], [0.09480583667755127, 0.0945712998509407, 0.0922403633594513, 0.09410396218299866, 0.09387116134166718, 0.09528212249279022, 0.09133098274469376, 0.0969666913151741, 0.06222284212708473, 0.09248041361570358, 0.0921243354678154], [0.09010590612888336, 0.09014583379030228, 0.09054902195930481, 0.0902257189154625, 0.09026569128036499, 0.09002520143985748, 0.09070958942174911, 0.08974351733922958, 0.09715314209461212, 0.09050694108009338, 0.090569406747818], [0.10836412012577057, 0.1060919389128685, 0.0856952965259552, 0.10168949514627457, 0.09955725818872452, 0.11311100423336029, 0.0787307471036911, 0.13140769302845, 0.0029528646264225245, 0.08762209862470627, 0.08477745950222015], [0.09393297880887985, 0.09375777095556259, 0.09201054275035858, 0.09340831637382507, 0.09323407709598541, 0.09428846836090088, 0.09132594615221024, 0.0955423042178154, 0.06838541477918625, 0.09219096601009369, 0.091923289000988], [0.09420780837535858, 0.09401439130306244, 0.09208768606185913, 0.09362875670194626, 0.09343653172254562, 0.09460033476352692, 0.09133376181125641, 0.09598598629236221, 0.06642671674489975, 0.09228648245334625, 0.09199156612157822]], [[0.09119170904159546, 0.09158340096473694, 0.09057363867759705, 0.09088398516178131, 0.09111615270376205, 0.09107756614685059, 0.09103899449110031, 0.09100044518709183, 0.09034374356269836, 0.09030547738075256, 0.09088487923145294], [0.09037476778030396, 0.08964742720127106, 0.09154099225997925, 0.0909525454044342, 0.0905161127448082, 0.09058842808008194, 0.09066079556941986, 0.09073323011398315, 0.09198066592216492, 0.09205415099859238, 0.0909508615732193], [0.09247832745313644, 0.09471599757671356, 0.08903574198484421, 0.09075094014406204, 0.09205172210931778, 0.09183447062969208, 0.09161774069070816, 0.09140151739120483, 0.0877823755145073, 0.08757520467042923, 0.0907559022307396], [0.0918327271938324, 0.09313105791807175, 0.08980966359376907, 0.09082157164812088, 0.0915837287902832, 0.09145674854516983, 0.09132994711399078, 0.09120331704616547, 0.08906512707471848, 0.08894163370132446, 0.09082448482513428], [0.09134918451309204, 0.09196121990680695, 0.09038638323545456, 0.09086936712265015, 0.09123128652572632, 0.09117110073566437, 0.0911109447479248, 0.09105084091424942, 0.09002919495105743, 0.08996979892253876, 0.09087075293064117], [0.09142957627773285, 0.09215471148490906, 0.09029065817594528, 0.0908617153763771, 0.09128999710083008, 0.09121875464916229, 0.09114755690097809, 0.09107642620801926, 0.0898686945438385, 0.08979856222867966, 0.09086336195468903], [0.09150992333889008, 0.09234849363565445, 0.09019492566585541, 0.09085395187139511, 0.09134862571954727, 0.09126631170511246, 0.09118407219648361, 0.09110189974308014, 0.0897083654999733, 0.08962753415107727, 0.09085584431886673], [0.09159023314714432, 0.09254257380962372, 0.09009918570518494, 0.09084607660770416, 0.09140718728303909, 0.09131378680467606, 0.09122048318386078, 0.09112727642059326, 0.08954822272062302, 0.08945672959089279, 0.09084822982549667], [0.09295596927404404, 0.09590590000152588, 0.0884602963924408, 0.0906936302781105, 0.09239602833986282, 0.09211118519306183, 0.09182722866535187, 0.09154413640499115, 0.08683662116527557, 0.0865689218044281, 0.09070011228322983], [0.09303539991378784, 0.09610524028539658, 0.08836435526609421, 0.09068367630243301, 0.09245312958955765, 0.09215697646141052, 0.0918617844581604, 0.09156753122806549, 0.086679607629776, 0.08640194684267044, 0.09069041162729263], [0.09183087199926376, 0.09312654286623001, 0.08981188386678696, 0.0908217579126358, 0.09158238768577576, 0.09145566076040268, 0.09132911264896393, 0.0912027433514595, 0.08906881511211395, 0.08894557505846024, 0.0908246785402298]], [[0.091990627348423, 0.09138458222150803, 0.09132464975118637, 0.09180975705385208, 0.09174954146146774, 0.09266287088394165, 0.09108530730009079, 0.09199202805757523, 0.08277325332164764, 0.09193327277898788, 0.09129420667886734], [0.09383125603199005, 0.09207714349031448, 0.09190484136343002, 0.09330549836158752, 0.09313090145587921, 0.09580221027135849, 0.09121885895729065, 0.09383533149957657, 0.0694122165441513, 0.09366431832313538, 0.09181740880012512], [0.09400292485952377, 0.09213340282440186, 0.09194989502429962, 0.09344233572483063, 0.09325621277093887, 0.09610623121261597, 0.09121949225664139, 0.09400726109743118, 0.0682004988193512, 0.09382490813732147, 0.09185678511857986], [0.09256047010421753, 0.09161558002233505, 0.09152232110500336, 0.09227810800075531, 0.09218417853116989, 0.09361259639263153, 0.09115025401115417, 0.09256265312433243, 0.07856796681880951, 0.09247089177370071, 0.0914749726653099], [0.09274621307849884, 0.09168777614831924, 0.09158338606357574, 0.09242978692054749, 0.09232455492019653, 0.09392628073692322, 0.09116701781749725, 0.09274865686893463, 0.07721008360385895, 0.09264581650495529, 0.09153039008378983], [0.08970874547958374, 0.09032956510782242, 0.09039141982793808, 0.0898931473493576, 0.08995470404624939, 0.08902981132268906, 0.09063924849033356, 0.08970732241868973, 0.10015599429607391, 0.08976714313030243, 0.0904228687286377], [0.09467087686061859, 0.09233748912811279, 0.0921090617775917, 0.09397000074386597, 0.09373752772808075, 0.09730952233076096, 0.09120097011327744, 0.09467630833387375, 0.06354682892560959, 0.09444820135831833, 0.09199319779872894], [0.09198614954948425, 0.0913827121257782, 0.09132303297519684, 0.09180605411529541, 0.09174610674381256, 0.0926554873585701, 0.09108471870422363, 0.09198754280805588, 0.08280647546052933, 0.09192904084920883, 0.09129272401332855], [0.1077212393283844, 0.08797769248485565, 0.0862274318933487, 0.10141918063163757, 0.09940151870250702, 0.13463538885116577, 0.07956776022911072, 0.1077713593840599, 0.0042442274279892445, 0.10568279027938843, 0.08535141497850418], [0.092173270881176, 0.09146013855934143, 0.09138966351747513, 0.0919603556394577, 0.09188949316740036, 0.0929652601480484, 0.0911082923412323, 0.09217491745948792, 0.08141890913248062, 0.09210574626922607, 0.0913538709282875], [0.09408944100141525, 0.09216119349002838, 0.0919719785451889, 0.09351111948490143, 0.0933191329240799, 0.09626023471355438, 0.09121900796890259, 0.094093918800354, 0.06759228557348251, 0.09390578418970108, 0.09187597781419754]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_duration_sec_mean": 0.007270621680654585, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.986364567568377e-06, "listify_data_for_vector_env": 1.0576643886883385e-05, "un_batch_to_individual_items": 6.595534605652476e-06, "tensor_to_numpy": 1.542873033535862e-05, "remove_single_ts_time_rank_from_batch": 1.2160769075265317e-05, "get_actions": 3.683931861673027e-05}}, "connector_pipeline_timer": 0.00011675442897440918}, "env_to_module_connector": {"connector_pipeline_timer": 5.988663828798015e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.871179801212732e-06, "numpy_to_tensor": 1.2242501767770416e-05, "add_states_from_episodes_to_batch": 2.727021919109554e-06, "add_observations_from_episodes_to_batch": 2.8120509646752027e-06, "batch_individual_items": 1.2561604325990206e-05}}}, "env_step_timer": 1.4147320834434649e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": -1.25, "episode_return_max": 14.5, "module_episode_returns_mean": {"default_policy": -1.25}, "env_to_module_sum_episodes_length_in": 10.368238387501162, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": -1.25}, "num_env_steps_sampled": 400, "episode_len_max": 20, "weights_seq_no": 5.0, "num_episodes": 20, "num_env_steps_sampled_lifetime": 25400, "env_reset_timer": 0.0006505609521994867, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -14.5, "episode_len_mean": 20.0, "num_episodes_lifetime": 100, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "env_to_module_sum_episodes_length_out": 10.368238387501162, "rlmodule_inference_timer": 3.3090766673556804e-05, "sample": 0.13112998050232472, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "time_between_sampling": 9.934995388096642}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "ba9e8_00000", "date": "2025-08-11_18-08-43", "timestamp": 1754928523, "time_this_iter_s": 11.095902919769287, "time_total_s": 50.16308331489563, "pid": 10327, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3858fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 50.16308331489563, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 48.1375, "ram_util_percent": 82.19375}}
{"timers": {"training_iteration": 9.436085887270602, "restore_env_runners": 1.930557253005685e-05, "training_step": 9.435853931703987, "env_runner_sampling_timer": 1.7754429828762748, "learner_update_timer": 7.4752519850301935, "synch_weights": 0.0014965206090474371, "restore_eval_env_runners": 5.5948731852890925e-05, "evaluation_iteration": 0.14427235786974155, "synch_eval_env_connectors": 0.00019637351989131537, "synch_env_connectors": 7.018928787061014e-06}, "env_runners": {"env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": -0.06}, "rlmodule_inference_timer": 4.3179198429382146e-05, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.0436711096392807e-05, "get_actions": 5.690372163471426e-05, "listify_data_for_vector_env": 1.3688814522829303e-05, "un_batch_to_individual_items": 8.225162611013268e-06, "remove_single_ts_time_rank_from_batch": 1.5024202962993335e-05, "normalize_and_clip_actions": 1.001219079173251e-05}}, "connector_pipeline_timer": 0.00016115727329883914}, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.6439954689580614e-05, "add_states_from_episodes_to_batch": 3.5068328444572713e-06, "add_time_dim_to_batch_and_zero_pad": 9.354907747467872e-06, "add_observations_from_episodes_to_batch": 3.7105308460075396e-06, "numpy_to_tensor": 1.7475854834952466e-05}}, "connector_pipeline_timer": 7.732758935088237e-05}, "sample": 0.006911843448868403, "episode_duration_sec_mean": 0.007106536518782375, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "agent_episode_returns_mean": {"default_agent": -0.06}, "weights_seq_no": 5.0, "episode_return_mean": -0.06, "env_step_timer": 2.0520513315894968e-05, "episode_return_max": 8.5, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -2460000.0, "env_reset_timer": 5.890212952118979e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "time_between_sampling": 0.037531817001329654, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "episode_return_min": -11.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -123000.0, "num_env_steps_sampled_lifetime_throughput": 2696.589329338457}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.14261148254863437, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.010014661249225435, "add_observations_from_episodes_to_batch": 0.001041523482318825, "add_columns_from_episodes_to_train_batch": 0.044864057112822875, "add_time_dim_to_batch_and_zero_pad": 0.0782916893342538, "add_states_from_episodes_to_batch": 0.0037901646679769072, "batch_individual_items": 0.00431348165387441, "numpy_to_tensor": 9.037569993494979e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.3583044409751892, "module_train_batch_size_mean": 997.8474438281662, "num_module_steps_trained": 5985, "policy_loss": -0.0002229176025139168, "use_intrinsic_rewards": 0.0, "num_module_steps_trained_lifetime": 35910, "total_loss": 0.27784812450408936, "weights_seq_no": 6.0, "entropy": 0.6911007165908813, "mean_kl_loss": 1.722866545605939e-05, "vf_loss_unclipped": 43.995914459228516, "num_trainable_parameters": 16595, "curr_kl_coeff": 0.0025247489102184772, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.0002117156982421875, "num_module_steps_trained_lifetime_throughput": 796.8250614131724}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 430920, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 1188000, "num_env_steps_trained_lifetime_throughput": 55877.327639315285}, "default_policy": {"num_module_steps_trained_lifetime": 215460, "weights_seq_no": 36.0, "diff_num_grad_updates_vs_sampler_policy": 31.0, "entropy": 0.691112756729126, "mean_kl_loss": 1.6122456145239994e-05, "vf_loss_unclipped": 43.93095016479492, "vf_explained_var": 0.0018872618675231934, "num_module_steps_trained": 35910, "use_intrinsic_rewards": 1.0, "vf_loss": 0.35848385095596313, "module_train_batch_size_mean": 997.5548130830801, "total_loss": 0.27799704670906067, "policy_loss": -0.0002162745367968455}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.5548130830801, "num_module_steps_trained_lifetime": 215460, "total_loss": 0.0, "weights_seq_no": 36.0, "diff_num_grad_updates_vs_sampler_policy": 31.0}}}, "intrinsic_reward_module": {"weights_seq_no": 6.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.8474438281662, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5985, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 35910, "num_module_steps_trained_lifetime_throughput": 796.8407943779363}, "__all_modules__": {"num_env_steps_trained": 33000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 71820, "num_env_steps_trained_lifetime": 198000, "num_env_steps_trained_lifetime_throughput": 4395.218134122284, "num_module_steps_trained_throughput": 25089947.53472467, "num_module_steps_trained_lifetime_throughput": 14409111.250995427}, "IntrinsicAttentionMask": [[[0.09083660691976547, 0.0904693529009819, 0.09095887839794159, 0.09102007746696472, 0.09065208584070206, 0.0901610478758812, 0.09077411144971848, 0.09083519130945206, 0.09188586473464966, 0.09138814359903336, 0.0910186618566513], [0.09075594693422318, 0.08999381959438324, 0.0910104364156723, 0.09113795310258865, 0.09037261456251144, 0.08935657888650894, 0.09062603116035461, 0.09075300395488739, 0.09295182675123215, 0.09190679341554642, 0.09113499522209167], [0.09086287021636963, 0.0906272903084755, 0.09094123542308807, 0.09098044037818909, 0.09074455499649048, 0.09042924642562866, 0.09082280844449997, 0.0908619686961174, 0.0915340855717659, 0.09121603518724442, 0.09097953885793686], [0.09087590128183365, 0.0907062515616417, 0.09093230962753296, 0.09096052497625351, 0.09079071134328842, 0.09056354314088821, 0.09084706753492355, 0.09087525308132172, 0.09135859459638596, 0.09112999588251114, 0.09095986932516098], [0.09079641103744507, 0.09023065119981766, 0.09098505228757858, 0.09107952564954758, 0.0905120000243187, 0.08975666016340256, 0.09070006012916565, 0.09079423546791077, 0.09241966158151627, 0.0916483998298645, 0.09107733517885208], [0.09068616479635239, 0.08959319442510605, 0.09105202555656433, 0.09123551845550537, 0.09013592451810837, 0.08868243545293808, 0.09049956500530243, 0.09068194031715393, 0.09385772049427032, 0.09234421700239182, 0.09123126417398453], [0.09082307666540146, 0.09038858115673065, 0.0909678116440773, 0.09104026854038239, 0.09060472995042801, 0.09002406150102615, 0.0907491147518158, 0.09082140028476715, 0.09206625074148178, 0.09147621691226959, 0.09103859215974808], [0.0908363088965416, 0.09046753495931625, 0.0909590870141983, 0.09102054685354233, 0.0906510204076767, 0.09015795588493347, 0.0907735601067543, 0.09083488583564758, 0.09188994765281677, 0.09139014035463333, 0.09101912379264832], [0.09105256199836731, 0.09181799739599228, 0.09079980850219727, 0.09067369997501373, 0.09143594652414322, 0.09246797859668732, 0.09118212759494781, 0.0910554826259613, 0.0889170840382576, 0.08992069214582443, 0.09067661315202713], [0.09095276892185211, 0.09118010848760605, 0.09087739884853363, 0.09083974361419678, 0.09106680005788803, 0.09137211740016937, 0.09099134057760239, 0.09095363318920135, 0.09031133353710175, 0.09061411768198013, 0.09084060788154602], [0.09087559580802917, 0.09070441126823425, 0.09093250334262848, 0.09096097201108932, 0.09078963100910187, 0.0905604138970375, 0.09084649384021759, 0.09087493270635605, 0.09136264026165009, 0.09113197773694992, 0.0909603163599968]], [[0.08828508853912354, 0.0862160474061966, 0.08601335436105728, 0.08581113815307617, 0.08560939878225327, 0.08870649337768555, 0.08520734310150146, 0.08828989416360855, 0.12897323071956635, 0.08808774501085281, 0.08880023658275604], [0.0863884910941124, 0.08333578705787659, 0.08303875476121902, 0.08274278044700623, 0.082447849214077, 0.0870148241519928, 0.08186115324497223, 0.08639562875032425, 0.153524711728096, 0.08609570562839508, 0.0871543437242508], [0.08617812395095825, 0.08303175121545792, 0.08272580057382584, 0.08242098242044449, 0.08211728930473328, 0.08682413399219513, 0.08151324838399887, 0.08618548512458801, 0.1561589241027832, 0.08587620407342911, 0.0869680717587471], [0.08596362918615341, 0.08272435516119003, 0.0824095830321312, 0.08209601044654846, 0.08178363740444183, 0.08662920445203781, 0.08116244524717331, 0.08597121387720108, 0.15882974863052368, 0.08565261960029602, 0.08677752315998077], [0.08574497699737549, 0.08241359144449234, 0.08209008723497391, 0.08176785707473755, 0.08144688606262207, 0.08642998337745667, 0.08080872893333435, 0.08575277775526047, 0.16153740882873535, 0.08542495220899582, 0.08658264577388763], [0.08861887454986572, 0.08675535023212433, 0.0865725427865982, 0.08639011532068253, 0.08620808273553848, 0.08899787068367004, 0.08584516495466232, 0.08862319588661194, 0.12446531653404236, 0.08844133466482162, 0.08908214420080185], [0.08529512584209442, 0.08178191632032394, 0.08144121617078781, 0.08110194653272629, 0.08076407760381699, 0.08601856231689453, 0.08009255677461624, 0.08530336618423462, 0.16706416010856628, 0.08495725691318512, 0.08617985248565674], [0.08828899264335632, 0.08622229099273682, 0.08601982146501541, 0.0858178362250328, 0.08561631292104721, 0.08870992064476013, 0.08521470427513123, 0.08829379826784134, 0.12892089784145355, 0.08809187263250351, 0.08880355209112167], [0.08948852121829987, 0.10631103068590164, 0.10814425349235535, 0.1100090891122818, 0.11190608143806458, 0.08644608408212662, 0.11579876393079758, 0.08945313096046448, 0.005702519789338112, 0.09095501154661179, 0.08578544110059738], [0.08812294900417328, 0.08595820516347885, 0.08574627339839935, 0.08553486317396164, 0.08532397449016571, 0.08856417238712311, 0.08490375429391861, 0.0881279855966568, 0.13113917410373688, 0.08791637420654297, 0.08866231888532639], [0.0886908546090126, 0.08687324821949005, 0.08669488877058029, 0.08651689440011978, 0.08633927255868912, 0.08906039595603943, 0.08598511666059494, 0.08869507908821106, 0.12348395586013794, 0.08851772546768188, 0.0891425684094429]], [[0.090937040746212, 0.09001822769641876, 0.09105944633483887, 0.09112071990966797, 0.09075232595205307, 0.09081338346004486, 0.09032146632671356, 0.09093562513589859, 0.09142766892910004, 0.09204935282468796, 0.0905647948384285], [0.0909980833530426, 0.08763216435909271, 0.09145352989435196, 0.09168211370706558, 0.09031393378973007, 0.09053967148065567, 0.08873279392719269, 0.09099282324314117, 0.09283360093832016, 0.09519807994365692, 0.08962324261665344], [0.09092733263969421, 0.09033750742673874, 0.09100575000047684, 0.09104498475790024, 0.0908089280128479, 0.09084808081388474, 0.09053240716457367, 0.09092642366886139, 0.09124141186475754, 0.09163851290941238, 0.09068863838911057], [0.09092234075069427, 0.0904974415898323, 0.09097877889871597, 0.09100700914859772, 0.09083710610866547, 0.09086529165506363, 0.0906379297375679, 0.09092169255018234, 0.09114828705787659, 0.09143364429473877, 0.09075047820806503], [0.09095098078250885, 0.08953702449798584, 0.09113994985818863, 0.09123457968235016, 0.09066609293222427, 0.0907602310180664, 0.09000281989574432, 0.09094880521297455, 0.091709204018116, 0.09267312288284302, 0.09037719666957855], [0.09094645828008652, 0.0896959975361824, 0.09111340343952179, 0.09119699150323868, 0.09069469571113586, 0.09077789634466171, 0.09010818600654602, 0.09094453603029251, 0.09161607176065445, 0.09246641397476196, 0.09043929725885391], [0.09098025411367416, 0.08841756731271744, 0.09132523834705353, 0.0914982259273529, 0.09046125411987305, 0.0906326025724411, 0.0892581194639206, 0.09097626805305481, 0.09236806631088257, 0.09414608031511307, 0.08993632346391678], [0.09093714505434036, 0.09001452475786209, 0.09106006473302841, 0.09112158417701721, 0.09075165539979935, 0.09081296622753143, 0.09031902253627777, 0.09093572199344635, 0.09142981469631195, 0.0920541062951088, 0.0905633494257927], [0.09089597314596176, 0.09129992872476578, 0.090842604637146, 0.09081592410802841, 0.09097671508789062, 0.09094999730587006, 0.09116595983505249, 0.0908965989947319, 0.09068266302347183, 0.09041473269462585, 0.09105892479419708], [0.09083572030067444, 0.09293137490749359, 0.09056169539690018, 0.09042499214410782, 0.09125151485204697, 0.09111376851797104, 0.09223208576440811, 0.09083889424800873, 0.08974456042051315, 0.08838894963264465, 0.09167644381523132], [0.09096428751945496, 0.08904927968978882, 0.09122102707624435, 0.09134966135025024, 0.09057758003473282, 0.09070531278848648, 0.08967894315719604, 0.09096131473779678, 0.09199559688568115, 0.09331110119819641, 0.09018587321043015]], [[0.09209136664867401, 0.09203096479177475, 0.09142465889453888, 0.09136469662189484, 0.09130477905273438, 0.09221367537975311, 0.0911850556731224, 0.09209275990724564, 0.08286391943693161, 0.09203394502401352, 0.09139418601989746], [0.09230248630046844, 0.09223081171512604, 0.09151175618171692, 0.09144068509340286, 0.09136968106031418, 0.0924476683139801, 0.09122783690690994, 0.09230414777994156, 0.08145501464605331, 0.09223434329032898, 0.09147563576698303], [0.0943225771188736, 0.09413470327854156, 0.09226256608963013, 0.092078797519207, 0.09189539402723312, 0.09470381587743759, 0.09152968227863312, 0.0943269282579422, 0.06843242049217224, 0.09414394944906235, 0.0921691358089447], [0.0945129320025444, 0.09431328624486923, 0.09232516586780548, 0.092130146920681, 0.09193553775548935, 0.0949181318283081, 0.09154754877090454, 0.0945175513625145, 0.06725047528743744, 0.09432311356067657, 0.09222601354122162], [0.09470155090093613, 0.09449010342359543, 0.09238575398921967, 0.09217946976423264, 0.09197364747524261, 0.0951308086514473, 0.09156337380409241, 0.0947064533829689, 0.06608745455741882, 0.09450050443410873, 0.09228087216615677], [0.0916580781340599, 0.09162035584449768, 0.09124111384153366, 0.09120356291532516, 0.09116601943969727, 0.09173445403575897, 0.09109099209308624, 0.09165895730257034, 0.08578215539455414, 0.09162221848964691, 0.09122202545404434], [0.0950736328959465, 0.09483843296766281, 0.09250091761350632, 0.0922720804810524, 0.09204381704330444, 0.0955512598156929, 0.09158896654844284, 0.09507907927036285, 0.06381719559431076, 0.09485001116991043, 0.09238456189632416], [0.09208645671606064, 0.09202631562948227, 0.09142260998487473, 0.09136290848255157, 0.09130324423313141, 0.09220823645591736, 0.09118403494358063, 0.09208784252405167, 0.08289677649736404, 0.09202928096055984, 0.09139226377010345], [0.11201384663581848, 0.10978540778160095, 0.0896635353565216, 0.0878797397017479, 0.08613143116235733, 0.11666155606508255, 0.0827384814620018, 0.11206593364477158, 0.004413365386426449, 0.10989415645599365, 0.08875259011983871], [0.09229212254285812, 0.09222100675106049, 0.09150750190019608, 0.09143698960542679, 0.09136652946472168, 0.09243617206811905, 0.0912257730960846, 0.09229376167058945, 0.08152391016483307, 0.09222450107336044, 0.09147166460752487], [0.09441953152418137, 0.0942256823182106, 0.09229464083909988, 0.09210515767335892, 0.0919160544872284, 0.09481293708086014, 0.09153902530670166, 0.09442402422428131, 0.0678294226527214, 0.09423521906137466, 0.09219830483198166]], [[0.09078560024499893, 0.08986831456422806, 0.09146440774202347, 0.09152594953775406, 0.09060118347406387, 0.0906621441245079, 0.09072314202785492, 0.09078418463468552, 0.09183426946401596, 0.09133682399988174, 0.09041396528482437], [0.0904352068901062, 0.08709011226892471, 0.09297037869691849, 0.09320275485515594, 0.08975528925657272, 0.0899796262383461, 0.09020452201366425, 0.09042997658252716, 0.09437334537506104, 0.09248996526002884, 0.08906886726617813], [0.09102816134691238, 0.09194694459438324, 0.09036003053188324, 0.09029994904994965, 0.09121138602495193, 0.09115073829889297, 0.091090127825737, 0.0910295620560646, 0.09000013023614883, 0.0904848575592041, 0.09139815717935562], [0.0910494476556778, 0.09213632345199585, 0.0902603417634964, 0.09018943458795547, 0.09126604348421097, 0.09119433909654617, 0.09112269431352615, 0.09105110168457031, 0.08983571082353592, 0.09040769189596176, 0.09148690104484558], [0.09071725606918335, 0.08930692821741104, 0.09176592528820038, 0.09186121076345444, 0.09043309837579727, 0.0905269905924797, 0.0906209871172905, 0.09071508049964905, 0.09233909100294113, 0.09156849980354309, 0.09014493972063065], [0.09073996543884277, 0.08949234336614609, 0.09166619181632996, 0.09175028651952744, 0.09048876911401749, 0.09057178348302841, 0.0906548723578453, 0.09073803573846817, 0.09217190742492676, 0.09149190783500671, 0.0902339518070221], [0.09076257050037384, 0.08967803418636322, 0.09156645089387894, 0.09163938462734222, 0.09054436534643173, 0.09061648696660995, 0.09068866819143295, 0.09076089411973953, 0.0920049175620079, 0.09141527861356735, 0.09032294154167175], [0.09078508615493774, 0.08986400812864304, 0.09146671742200851, 0.09152851998806, 0.0905999019742012, 0.09066111594438553, 0.09072236716747284, 0.09078366309404373, 0.09183812886476517, 0.09133859723806381, 0.09041191637516022], [0.09115439653396606, 0.09308747947216034, 0.08976197242736816, 0.08963730186223984, 0.091538205742836, 0.09141106903553009, 0.09128411114215851, 0.09115733206272125, 0.08901654183864594, 0.09002126753330231, 0.0919303148984909], [0.09098364412784576, 0.09155479818582535, 0.09056694805622101, 0.0905294194817543, 0.09109771996736526, 0.09105996787548065, 0.09102223813533783, 0.0909845158457756, 0.09034200012683868, 0.09064488112926483, 0.09121391177177429], [0.09064678847789764, 0.08873846381902695, 0.09207267314195633, 0.09220250695943832, 0.09026143699884415, 0.090388722717762, 0.09051619470119476, 0.09064383804798126, 0.09285447001457214, 0.09180378168821335, 0.08987109363079071]], [[0.09218718111515045, 0.09157983958721161, 0.09151977300643921, 0.09145975112915039, 0.091945581138134, 0.0923096165060997, 0.09127993136644363, 0.09218857437372208, 0.08245773613452911, 0.09158279746770859, 0.0914892703294754], [0.09439156949520111, 0.09262697398662567, 0.09245364367961884, 0.09228064119815826, 0.0936870202422142, 0.09474992752075195, 0.09176356345415115, 0.09439565986394882, 0.06864982098340988, 0.09263552725315094, 0.09236568957567215], [0.09459931403398514, 0.09271793812513351, 0.09253326058387756, 0.09234894812107086, 0.0938478633761406, 0.09498167037963867, 0.09179822355508804, 0.09460368007421494, 0.06740249693393707, 0.09272704273462296, 0.09243955463171005], [0.09480517357587814, 0.09280668944120407, 0.09261064976453781, 0.09241502732038498, 0.09400666505098343, 0.09521162509918213, 0.09183061867952347, 0.09480980783700943, 0.06617619842290878, 0.09281636029481888, 0.09251119196414948], [0.09308726340532303, 0.09202492982149124, 0.0919201597571373, 0.09181550145149231, 0.09266405552625656, 0.09330204874277115, 0.09150225669145584, 0.09308971464633942, 0.07669697701931, 0.0920301005244255, 0.09186696261167526], [0.09171880036592484, 0.09133915603160858, 0.0913015604019165, 0.09126398712396622, 0.09156789630651474, 0.09179522842168808, 0.09115134179592133, 0.09171967953443527, 0.08551888167858124, 0.09134101122617722, 0.09128246456384659], [0.09541163593530655, 0.09305999428033829, 0.09282977879047394, 0.09260012954473495, 0.09447099268436432, 0.09589096158742905, 0.0919145867228508, 0.09541710466146469, 0.06262049078941345, 0.093071348965168, 0.09271300584077835], [0.09218186885118484, 0.09157714247703552, 0.09151733666658401, 0.09145756810903549, 0.09194131195545197, 0.09230377525091171, 0.09127850830554962, 0.09218326210975647, 0.0824921578168869, 0.09158008545637131, 0.09148696064949036], [0.11520043760538101, 0.09305267035961151, 0.09110154211521149, 0.08919131755828857, 0.10583799332380295, 0.12024673074483871, 0.08369762450456619, 0.11525692045688629, 0.0031391731463372707, 0.09314986318349838, 0.09012577682733536], [0.09438127279281616, 0.09262242913246155, 0.09244965761899948, 0.09227721393108368, 0.0936790332198143, 0.09473845362663269, 0.09176179766654968, 0.09438534826040268, 0.06871181726455688, 0.09263094514608383, 0.09236197918653488], [0.09470415860414505, 0.09276331216096878, 0.09257286041975021, 0.09238280355930328, 0.09392881393432617, 0.09509874880313873, 0.09181496500968933, 0.09470865875482559, 0.06677672266960144, 0.0927727073431015, 0.09247623383998871]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_duration_sec_mean": 0.007177230403758585, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.836570056555216e-06, "listify_data_for_vector_env": 1.040404013770918e-05, "un_batch_to_individual_items": 6.587915663744753e-06, "tensor_to_numpy": 1.5153968686042208e-05, "remove_single_ts_time_rank_from_batch": 1.1879740554291622e-05, "get_actions": 3.617695554839396e-05}}, "connector_pipeline_timer": 0.00011486852167037919}, "env_to_module_connector": {"connector_pipeline_timer": 5.941549855737548e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.746950630728574e-06, "numpy_to_tensor": 1.2081666231714799e-05, "add_states_from_episodes_to_batch": 2.7296033879502424e-06, "add_observations_from_episodes_to_batch": 2.810428130078851e-06, "batch_individual_items": 1.2575825477222246e-05}}}, "env_step_timer": 1.3912208387071045e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": -1.25, "episode_return_max": 14.5, "module_episode_returns_mean": {"default_policy": -1.25}, "env_to_module_sum_episodes_length_in": 10.368238394470474, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": -1.25}, "num_env_steps_sampled": 400, "episode_len_max": 20, "weights_seq_no": 6.0, "num_episodes": 20, "num_env_steps_sampled_lifetime": 30400, "env_reset_timer": 0.000647422421866539, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -14.5, "episode_len_mean": 20.0, "num_episodes_lifetime": 120, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "env_to_module_sum_episodes_length_out": 10.368238394470474, "rlmodule_inference_timer": 3.1742607191152516e-05, "sample": 0.13099511986709578, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "time_between_sampling": 9.940552080055475}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "ba9e8_00000", "date": "2025-08-11_18-08-53", "timestamp": 1754928533, "time_this_iter_s": 10.585124969482422, "time_total_s": 60.74820828437805, "pid": 10327, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3858fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 60.74820828437805, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 52.406666666666666, "ram_util_percent": 81.81333333333333}}
{"timers": {"training_iteration": 9.441895225478484, "restore_env_runners": 1.9172927043558718e-05, "training_step": 9.441663351545953, "env_runner_sampling_timer": 1.775238310127199, "learner_update_timer": 7.481287436839921, "synch_weights": 0.001490038323195711, "restore_eval_env_runners": 5.575049524782961e-05, "evaluation_iteration": 0.14410242304081902, "synch_eval_env_connectors": 0.00019760686375113877, "synch_env_connectors": 7.00499021854396e-06}, "env_runners": {"env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": -1.0999999999999996}, "rlmodule_inference_timer": 3.684961668652152e-05, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.7458290324222123e-05, "get_actions": 4.591326159239652e-05, "listify_data_for_vector_env": 1.1824446277910221e-05, "un_batch_to_individual_items": 7.243182456539777e-06, "remove_single_ts_time_rank_from_batch": 1.2961309155862206e-05, "normalize_and_clip_actions": 8.942563540686936e-06}}, "connector_pipeline_timer": 0.00013362295989500852}, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.4127256998782707e-05, "add_states_from_episodes_to_batch": 3.0131253160397453e-06, "add_time_dim_to_batch_and_zero_pad": 8.07272152065511e-06, "add_observations_from_episodes_to_batch": 3.2189603586623954e-06, "numpy_to_tensor": 1.481392624522375e-05}}, "connector_pipeline_timer": 6.760446477020599e-05}, "sample": 0.007059965848417825, "episode_duration_sec_mean": 0.006001976339146493, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "agent_episode_returns_mean": {"default_agent": -1.0999999999999996}, "weights_seq_no": 6.0, "episode_return_mean": -1.0999999999999996, "env_step_timer": 1.633742515728845e-05, "episode_return_max": 8.5, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -3077500.0, "env_reset_timer": 5.9817162018183503e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "time_between_sampling": 0.034989657515643084, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "episode_return_min": -11.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -153875.0, "num_env_steps_sampled_lifetime_throughput": 2902.7859735514135}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.14251912105354822, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.010004313807115502, "add_observations_from_episodes_to_batch": 0.0010394853275803929, "add_columns_from_episodes_to_train_batch": 0.04482958237170147, "add_time_dim_to_batch_and_zero_pad": 0.07825114952093455, "add_states_from_episodes_to_batch": 0.003789637181316819, "batch_individual_items": 0.0043102580876866635, "numpy_to_tensor": 9.006360285402775e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.358305424451828, "module_train_batch_size_mean": 997.82696443245, "num_module_steps_trained": 5985, "policy_loss": -0.0004406658699735999, "use_intrinsic_rewards": 0.0, "num_module_steps_trained_lifetime": 41895, "total_loss": 0.27763187885284424, "weights_seq_no": 7.0, "entropy": 0.6906187534332275, "mean_kl_loss": 2.0672114260378294e-05, "vf_loss_unclipped": 42.797393798828125, "num_trainable_parameters": 16595, "curr_kl_coeff": 0.0012623744551092386, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.000775456428527832, "num_module_steps_trained_lifetime_throughput": 791.8710935118618}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 502740, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 1386000, "num_env_steps_trained_lifetime_throughput": 54914.84316298106}, "default_policy": {"num_module_steps_trained_lifetime": 251370, "weights_seq_no": 42.0, "diff_num_grad_updates_vs_sampler_policy": 36.0, "entropy": 0.6906477212905884, "mean_kl_loss": 1.813010203477461e-05, "vf_loss_unclipped": 42.65524673461914, "vf_explained_var": 0.0017691850662231445, "num_module_steps_trained": 35910, "use_intrinsic_rewards": 1.0, "vf_loss": 0.3584776818752289, "module_train_batch_size_mean": 997.5374097747205, "total_loss": 0.2777945399284363, "policy_loss": -0.00041505182161927223}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.5374097747205, "num_module_steps_trained_lifetime": 251370, "total_loss": 0.0, "weights_seq_no": 42.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}}}, "intrinsic_reward_module": {"weights_seq_no": 7.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.82696443245, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5985, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 41895, "num_module_steps_trained_lifetime_throughput": 791.8861130532003}, "__all_modules__": {"num_env_steps_trained": 33000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 83790, "num_env_steps_trained_lifetime": 231000, "num_env_steps_trained_lifetime_throughput": 4367.841051609032, "num_module_steps_trained_throughput": 24443337.50897787, "num_module_steps_trained_lifetime_throughput": 14302441.683712548}, "IntrinsicAttentionMask": [[[0.0910644456744194, 0.09145558625459671, 0.09044723957777023, 0.09075715392827988, 0.09133944660425186, 0.09130076318979263, 0.09091194719076157, 0.09087344259023666, 0.09056514501571655, 0.09052678942680359, 0.09075804054737091], [0.09061369299888611, 0.0898844376206398, 0.09178300201892853, 0.09119300544261932, 0.09010003507137299, 0.09017202258110046, 0.0909004881978035, 0.09097310155630112, 0.09155786037445068, 0.09163100272417068, 0.09119132161140442], [0.09176380932331085, 0.09398417919874191, 0.08834781497716904, 0.09004975855350494, 0.0933203250169754, 0.09310008585453033, 0.09090986102819443, 0.09069530665874481, 0.0889921560883522, 0.08878212422132492, 0.09005468338727951], [0.09141451120376587, 0.09270692616701126, 0.08940066397190094, 0.09040796011686325, 0.09232185035943985, 0.0921938493847847, 0.09091401845216751, 0.09078796952962875, 0.0897829458117485, 0.0896584689617157, 0.09041085839271545], [0.0907481387257576, 0.09034845232963562, 0.09138596057891846, 0.09106459468603134, 0.09046676754951477, 0.09050624072551727, 0.09090491384267807, 0.09094458073377609, 0.09126344323158264, 0.0913032591342926, 0.09106367826461792], [0.09079280495643616, 0.09050346165895462, 0.09125380218029022, 0.09102163463830948, 0.09058915078639984, 0.09061773121356964, 0.09090619534254074, 0.0909348800778389, 0.09116531908512115, 0.09119407832622528, 0.09102097153663635], [0.09123863279819489, 0.09207472205162048, 0.089927539229393, 0.09058460593223572, 0.09182604402303696, 0.09174329042434692, 0.09091375023126602, 0.09083182364702225, 0.09017721563577652, 0.09009595215320587, 0.09058649837970734], [0.09128245711326599, 0.09223160147666931, 0.08979642391204834, 0.0905408039689064, 0.09194917231798172, 0.09185522049665451, 0.09091395139694214, 0.09082105755805969, 0.09007918834686279, 0.08998715132474899, 0.09054294973611832], [0.09163137525320053, 0.09349645674228668, 0.0887480303645134, 0.09018674492835999, 0.09293955564498901, 0.09275466948747635, 0.09091218560934067, 0.09073132276535034, 0.0892932191491127, 0.08911558240652084, 0.09019089490175247], [0.09167451411485672, 0.09365486353635788, 0.08861779421567917, 0.09014227241277695, 0.09306329488754272, 0.0928669348359108, 0.09091152250766754, 0.09071969985961914, 0.08919530361890793, 0.08900710940361023, 0.09014667570590973], [0.09141350537538528, 0.09270328283309937, 0.08940368890762329, 0.09040898084640503, 0.09231898933649063, 0.09219124913215637, 0.09091402590274811, 0.09078822284936905, 0.08978521078824997, 0.08966097980737686, 0.09041187167167664]], [[0.09213639050722122, 0.09152938425540924, 0.0920155793428421, 0.09140937030315399, 0.09134942293167114, 0.0922587588429451, 0.0912296399474144, 0.09268800169229507, 0.08241232484579086, 0.09153234213590622, 0.09143886715173721], [0.09423849731683731, 0.09247677028179169, 0.09388613700866699, 0.09213099628686905, 0.09195859730243683, 0.09459627419710159, 0.09161476045846939, 0.09585823863744736, 0.06853851675987244, 0.09248530119657516, 0.09221590310335159], [0.09257117658853531, 0.09173775464296341, 0.09240514039993286, 0.09157320857048035, 0.09149105101823807, 0.09273944050073624, 0.09132695198059082, 0.09333030134439468, 0.0794694721698761, 0.09174180775880814, 0.09161364287137985], [0.09463061392307281, 0.09263581037521362, 0.0942312479019165, 0.09224487096071243, 0.09205001592636108, 0.09503632038831711, 0.09166154265403748, 0.09646889567375183, 0.06605437397956848, 0.09264546632766724, 0.0923408567905426], [0.09482372552156448, 0.09271194785833359, 0.09440073370933533, 0.09229838848114014, 0.09209229797124863, 0.09525352716445923, 0.09168149530887604, 0.09677204489707947, 0.06484383344650269, 0.09272216260433197, 0.09239991754293442], [0.09168730676174164, 0.09130778908729553, 0.091611847281456, 0.09123263508081436, 0.09119509160518646, 0.0917636975646019, 0.09112003445625305, 0.09203138202428818, 0.08548950403928757, 0.09130963683128357, 0.09125111252069473], [0.09520412236452103, 0.09285759925842285, 0.09473366290330887, 0.0923987329006195, 0.09217014908790588, 0.09568240493535995, 0.09171468019485474, 0.09737405180931091, 0.062484316527843475, 0.09286893159151077, 0.0925113633275032], [0.09004046767950058, 0.0904431864619255, 0.09012026339769363, 0.09052333980798721, 0.09056344628334045, 0.08995982259511948, 0.09064371138811111, 0.0896783322095871, 0.09708257764577866, 0.09044121205806732, 0.09050362557172775], [0.11236409097909927, 0.09076163172721863, 0.107701376080513, 0.08699534833431244, 0.08517122268676758, 0.11728611588478088, 0.08163691312074661, 0.13625814020633698, 0.0030618933960795403, 0.09085642546415329, 0.08790678530931473], [0.09422872960567474, 0.09247272461652756, 0.09387752413749695, 0.09212806820869446, 0.09195622056722641, 0.09458532929420471, 0.09161348640918732, 0.0958431139588356, 0.06860076636075974, 0.09248123317956924, 0.09221270680427551], [0.09453492611646652, 0.09259754419326782, 0.09414715319871902, 0.09221772104501724, 0.09202839434146881, 0.0949288159608841, 0.09165090322494507, 0.0963192731142044, 0.0666574090719223, 0.09260692447423935, 0.09231097996234894]], [[0.09088567644357681, 0.08996737748384476, 0.09156523644924164, 0.0916268453001976, 0.09014909714460373, 0.09020975232124329, 0.09027044475078583, 0.0908842608332634, 0.09137602895498276, 0.09199736267328262, 0.091067835688591], [0.09079843759536743, 0.08743991702795029, 0.09334380179643631, 0.09357710182666779, 0.08809719979763031, 0.0883173868060112, 0.08853813260793686, 0.09079320728778839, 0.09262993931770325, 0.09498922526836395, 0.09147569537162781], [0.0909275934100151, 0.09184536337852478, 0.09026020765304565, 0.09020019322633743, 0.09166227281093597, 0.09160132706165314, 0.09154041856527328, 0.09092899411916733, 0.09044503420591354, 0.08984093368053436, 0.09074772894382477], [0.09093044698238373, 0.09201589971780777, 0.0901423767209053, 0.09007155150175095, 0.09179919958114624, 0.09172708541154861, 0.09165501594543457, 0.09093210101127625, 0.09036051481962204, 0.0896478071808815, 0.09071795642375946], [0.09081854671239853, 0.08793908357620239, 0.09299052506685257, 0.09318917244672775, 0.08850385248661041, 0.08869291841983795, 0.08888238668441772, 0.09081406146287918, 0.09238225966691971, 0.09438999742269516, 0.09139730781316757], [0.09082493185997009, 0.08810579776763916, 0.0928727462887764, 0.09305988997220993, 0.0886395201086998, 0.08881814032793045, 0.08899712562561035, 0.09082070738077164, 0.09229952096939087, 0.09419076889753342, 0.09137087315320969], [0.09083116799592972, 0.08827269077301025, 0.09275495260953903, 0.09293064475059509, 0.08877523988485336, 0.08894339948892593, 0.08911187201738358, 0.09082719683647156, 0.09221671521663666, 0.09399180859327316, 0.09134429693222046], [0.09088557213544846, 0.08996348083019257, 0.09156796336174011, 0.09162982553243637, 0.09014595299959183, 0.09020685404539108, 0.09026779979467392, 0.09088415652513504, 0.09137796610593796, 0.09200190007686615, 0.09106848388910294], [0.09091782569885254, 0.09132187068462372, 0.09062257409095764, 0.09059596806764603, 0.09124144911766052, 0.09121465682983398, 0.09118787199258804, 0.09091844409704208, 0.09070446342229843, 0.09043646603822708, 0.09083837270736694], [0.09094443172216415, 0.09304258227348328, 0.08943548798561096, 0.0893004834651947, 0.09262187778949738, 0.0924820601940155, 0.09234245866537094, 0.09094760566949844, 0.08985196053981781, 0.08849472552537918, 0.09053636342287064], [0.0908987820148468, 0.09047017246484756, 0.09121447056531906, 0.09124302864074707, 0.09055517613887787, 0.09058352559804916, 0.09061188995838165, 0.09089811891317368, 0.0911267027258873, 0.09141456335783005, 0.09098352491855621]], [[0.09204480051994324, 0.09335648268461227, 0.09319304674863815, 0.09302989393472672, 0.09286703169345856, 0.09535670280456543, 0.09108217060565948, 0.09352400153875351, 0.07054014503955841, 0.09336454421281815, 0.09164116531610489], [0.09147597849369049, 0.09205163270235062, 0.09198015183210373, 0.09190872311592102, 0.09183735400438309, 0.09292085468769073, 0.09105060249567032, 0.0921248197555542, 0.08129680901765823, 0.09205514937639236, 0.09129791706800461], [0.09155477583408356, 0.09222082793712616, 0.09213808923959732, 0.09205541759729385, 0.09197282791137695, 0.09322778880596161, 0.0910630151629448, 0.09230555593967438, 0.07988795638084412, 0.09222490340471268, 0.09134887903928757], [0.09163113683462143, 0.09238781780004501, 0.09229377657175064, 0.09219983220100403, 0.09210598468780518, 0.09353318065404892, 0.0910729393362999, 0.09248413145542145, 0.0785013884305954, 0.0923924520611763, 0.09139737486839294], [0.09170510619878769, 0.09255263209342957, 0.09244725853204727, 0.09234200417995453, 0.09223686903715134, 0.09383706748485565, 0.0910804271697998, 0.0926605612039566, 0.0771368145942688, 0.09255782514810562, 0.09144345670938492], [0.09031835943460464, 0.089820496737957, 0.0898820012807846, 0.0899435430765152, 0.09000512957572937, 0.08907973021268845, 0.09069006145000458, 0.08975761383771896, 0.10021210461854935, 0.08981746435165405, 0.09047355502843857], [0.0923735499382019, 0.09423982352018356, 0.09400669485330582, 0.09377413243055344, 0.09354214370250702, 0.0971066802740097, 0.09101087599992752, 0.09447894990444183, 0.06341444700956345, 0.09425132721662521, 0.09180144965648651], [0.09139282256364822, 0.09187622368335724, 0.09181622415781021, 0.09175626188516617, 0.0916963443160057, 0.09260523319244385, 0.09103531390428543, 0.09193764626979828, 0.08276156336069107, 0.09187917411327362, 0.0912432000041008], [0.08827231079339981, 0.10382431000471115, 0.10175879299640656, 0.09973438829183578, 0.0977502390742302, 0.13239863514900208, 0.07824599742889404, 0.10598094761371613, 0.004173771012574434, 0.1039271131157875, 0.08393353223800659], [0.09147202968597412, 0.09204323589801788, 0.09197230637073517, 0.09190143644809723, 0.09183061867952347, 0.092905692756176, 0.091049924492836, 0.0921158567070961, 0.08136677742004395, 0.09204673022031784, 0.09129533916711807], [0.09219148755073547, 0.09373430162668228, 0.09354185312986374, 0.09334980696439743, 0.09315815567970276, 0.09609417617321014, 0.09106165170669556, 0.09393159300088882, 0.06747572869062424, 0.09374378621578217, 0.09171748906373978]], [[0.09112802147865295, 0.09151943027973175, 0.09085898846387863, 0.09082051366567612, 0.09105251729488373, 0.09101395308971405, 0.09097541123628616, 0.09093688428401947, 0.09028064459562302, 0.0902424156665802, 0.09117119759321213], [0.09049402177333832, 0.08976572751998901, 0.09099985659122467, 0.09107255935668945, 0.09063556045293808, 0.09070796519517899, 0.09078042954206467, 0.09085296094417572, 0.0921020358800888, 0.09217561781406403, 0.09041322767734528], [0.0915612280368805, 0.09274229407310486, 0.09075526893138885, 0.09064038842916489, 0.09133455157279968, 0.09121893346309662, 0.0911034643650055, 0.09098813682794571, 0.08903869986534119, 0.08892598748207092, 0.0916910395026207], [0.09162301570177078, 0.09291837364435196, 0.09073998034000397, 0.09061416983604431, 0.09137458354234695, 0.09124789386987686, 0.0911213830113411, 0.09099504351615906, 0.08886174112558365, 0.08873853832483292, 0.09176531434059143], [0.09124981611967087, 0.09186118841171265, 0.09083044528961182, 0.09077052026987076, 0.09113204479217529, 0.09107191860675812, 0.09101183712482452, 0.09095180034637451, 0.08993125706911087, 0.08987192809581757, 0.09131719917058945], [0.09131194651126862, 0.09203615039587021, 0.09081569314002991, 0.09074481576681137, 0.09117254614830017, 0.09110139310359955, 0.0910302922129631, 0.09095925092697144, 0.08975306898355484, 0.08968302607536316, 0.09139171987771988], [0.09137402474880219, 0.09221135079860687, 0.09080085158348083, 0.09071902930736542, 0.09121296554803848, 0.09113077074289322, 0.09104865044355392, 0.0909666121006012, 0.0895751491189003, 0.08949442952871323, 0.09146620333194733], [0.09143601357936859, 0.09238675236701965, 0.09078587591648102, 0.09069311618804932, 0.09125327318906784, 0.09116003662347794, 0.0910668894648552, 0.09097383916378021, 0.08939744532108307, 0.08930610120296478, 0.09154062718153], [0.09248510748147964, 0.09542008489370346, 0.09051326662302017, 0.09023423492908478, 0.09192799776792526, 0.09164460003376007, 0.09136207401752472, 0.0910804271697998, 0.08639676868915558, 0.08613042533397675, 0.09280505031347275], [0.09254581481218338, 0.09559947997331619, 0.09049634635448456, 0.09020646661520004, 0.09196658432483673, 0.09167200326919556, 0.091378353536129, 0.09108565002679825, 0.08622347563505173, 0.08594727516174316, 0.09287851303815842], [0.09105828404426575, 0.09132447093725204, 0.09087511897087097, 0.0908489003777504, 0.09100689738988876, 0.0909806415438652, 0.09095440059900284, 0.09092816710472107, 0.0904807597398758, 0.09045466035604477, 0.09108766913414001]], [[0.09255653619766235, 0.09239450097084045, 0.09223274886608124, 0.09354710578918457, 0.09338333457708359, 0.09588684886693954, 0.09158855676651001, 0.09404395520687103, 0.06981328874826431, 0.09240247309207916, 0.09215065091848373], [0.09265094995498657, 0.09247758239507675, 0.092304527759552, 0.09371127188205719, 0.09353591501712799, 0.09621883183717728, 0.09161556512117386, 0.09424339979887009, 0.06853915750980377, 0.09248610585927963, 0.09221671521663666], [0.09274307638406754, 0.092558354139328, 0.09237398952245712, 0.09387330710887909, 0.09368633478879929, 0.09654948115348816, 0.09164021909236908, 0.09444084018468857, 0.06728654354810715, 0.09256743639707565, 0.09228044748306274], [0.09193185716867447, 0.0918382853269577, 0.0917448028922081, 0.0925024226307869, 0.09240826219320297, 0.09384014457464218, 0.09137182682752609, 0.09278765320777893, 0.07803446799516678, 0.0918428897857666, 0.0916973277926445], [0.09204088151454926, 0.09193608909845352, 0.09183141589164734, 0.09268010407686234, 0.0925745889544487, 0.0941806435585022, 0.09141391515731812, 0.09299983829259872, 0.07662297785282135, 0.09194124490022659, 0.09177827090024948], [0.09011074900627136, 0.09017245471477509, 0.0902341976761818, 0.08973679691553116, 0.08979824185371399, 0.08887496590614319, 0.09048159420490265, 0.08955129235982895, 0.10060476511716843, 0.09016940742731094, 0.09026558697223663], [0.09308930486440659, 0.09285901486873627, 0.09262929111719131, 0.09450074285268784, 0.09426695853471756, 0.09785910695791245, 0.09171607345342636, 0.09521102160215378, 0.062485311180353165, 0.09287033975124359, 0.09251277148723602], [0.09158681333065033, 0.09152700006961823, 0.0914672315120697, 0.09195102006196976, 0.09189097583293915, 0.09280179440975189, 0.09122854471206665, 0.09213279187679291, 0.08244699239730835, 0.0915299504995346, 0.09143687039613724], [0.09279466420412064, 0.09084894508123398, 0.08894401788711548, 0.10554451495409012, 0.10333144664764404, 0.1422937661409378, 0.08171546459197998, 0.11252722144126892, 0.003064866643399, 0.09094380587339401, 0.08799134194850922], [0.09264635294675827, 0.09247353672981262, 0.09230104088783264, 0.09370323270559311, 0.09352844953536987, 0.09620250761508942, 0.09161428362131119, 0.09423361718654633, 0.06860139966011047, 0.09248203784227371, 0.09221350401639938], [0.09278902411460876, 0.09259852766990662, 0.09240841120481491, 0.09395485371351242, 0.09376195818185806, 0.09671700745820999, 0.09165186434984207, 0.09454040974378586, 0.0666581466794014, 0.09260790050029755, 0.09231195598840714]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_duration_sec_mean": 0.0071662016306072475, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.026496707071045e-06, "listify_data_for_vector_env": 1.0560205143112633e-05, "un_batch_to_individual_items": 6.6367573816700005e-06, "tensor_to_numpy": 1.5289222784626e-05, "remove_single_ts_time_rank_from_batch": 1.2064456189476985e-05, "get_actions": 3.655401320247822e-05}}, "connector_pipeline_timer": 0.0001164658815846559}, "env_to_module_connector": {"connector_pipeline_timer": 5.920912625916054e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.755214758665023e-06, "numpy_to_tensor": 1.224684002027968e-05, "add_states_from_episodes_to_batch": 2.713070830297842e-06, "add_observations_from_episodes_to_batch": 2.801407839168313e-06, "batch_individual_items": 1.2570825437693464e-05}}}, "env_step_timer": 1.4182413433156727e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": -0.65, "episode_return_max": 14.5, "module_episode_returns_mean": {"default_policy": -0.65}, "env_to_module_sum_episodes_length_in": 10.368238394572801, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": -0.65}, "num_env_steps_sampled": 400, "episode_len_max": 20, "weights_seq_no": 7.0, "num_episodes": 20, "num_env_steps_sampled_lifetime": 35400, "env_reset_timer": 0.0006444356968458186, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -14.5, "episode_len_mean": 20.0, "num_episodes_lifetime": 140, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "env_to_module_sum_episodes_length_out": 10.368238394572801, "rlmodule_inference_timer": 3.197461068450502e-05, "sample": 0.13083696908832723, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "time_between_sampling": 9.941656120924234}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "ba9e8_00000", "date": "2025-08-11_18-09-03", "timestamp": 1754928543, "time_this_iter_s": 10.143374919891357, "time_total_s": 70.89158320426941, "pid": 10327, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3858fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 70.89158320426941, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 47.464285714285715, "ram_util_percent": 81.00714285714285}}
{"timers": {"training_iteration": 9.441329731564446, "restore_env_runners": 1.905160692391728e-05, "training_step": 9.441096275120346, "env_runner_sampling_timer": 1.7747069745258424, "learner_update_timer": 7.481270164140987, "synch_weights": 0.0014849425198587435, "restore_eval_env_runners": 5.5253820793465544e-05, "evaluation_iteration": 0.14389731089056654, "synch_eval_env_connectors": 0.00019668871469411678, "synch_env_connectors": 6.985770738327815e-06}, "env_runners": {"env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 0.4200000000000001}, "rlmodule_inference_timer": 3.564120461468331e-05, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.78285506017966e-05, "get_actions": 4.552758208752063e-05, "listify_data_for_vector_env": 1.2758548000511714e-05, "un_batch_to_individual_items": 7.000742030927986e-06, "remove_single_ts_time_rank_from_batch": 1.2612994117738913e-05, "normalize_and_clip_actions": 8.625987133163177e-06}}, "connector_pipeline_timer": 0.00013363551185895293}, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.3462686037810066e-05, "add_states_from_episodes_to_batch": 2.881931476907687e-06, "add_time_dim_to_batch_and_zero_pad": 7.961888105296082e-06, "add_observations_from_episodes_to_batch": 3.1056685493885513e-06, "numpy_to_tensor": 1.473064722657012e-05}}, "connector_pipeline_timer": 6.566718579980955e-05}, "sample": 0.006220241135186432, "episode_duration_sec_mean": 0.005933492358773947, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "agent_episode_returns_mean": {"default_agent": 0.4200000000000001}, "weights_seq_no": 7.0, "episode_return_mean": 0.4200000000000001, "env_step_timer": 1.5893969338677138e-05, "episode_return_max": 8.5, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -3695000.0, "env_reset_timer": 4.9060199268612964e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "time_between_sampling": 0.03425679490998927, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "episode_return_min": -11.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -184750.0, "num_env_steps_sampled_lifetime_throughput": 3113.7575039830126}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.14244174067276952, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009992997759086433, "add_observations_from_episodes_to_batch": 0.0010376625535458647, "add_columns_from_episodes_to_train_batch": 0.04479612654843321, "add_time_dim_to_batch_and_zero_pad": 0.07820556385585846, "add_states_from_episodes_to_batch": 0.00378848831050255, "batch_individual_items": 0.004327309255882722, "numpy_to_tensor": 8.985504776467607e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.358306884765625, "module_train_batch_size_mean": 997.8076834879114, "num_module_steps_trained": 5985, "policy_loss": -0.0003379785630386323, "use_intrinsic_rewards": 0.0, "num_module_steps_trained_lifetime": 47880, "total_loss": 0.27773669362068176, "weights_seq_no": 8.0, "entropy": 0.6899899840354919, "mean_kl_loss": 3.843426384264603e-05, "vf_loss_unclipped": 43.50038146972656, "num_trainable_parameters": 16595, "curr_kl_coeff": 0.0006311872275546193, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.0005632638931274414, "num_module_steps_trained_lifetime_throughput": 787.5215175710366}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 574560, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 1584000, "num_env_steps_trained_lifetime_throughput": 53957.12503809618}, "default_policy": {"num_module_steps_trained_lifetime": 287280, "weights_seq_no": 48.0, "diff_num_grad_updates_vs_sampler_policy": 41.0, "entropy": 0.6900070309638977, "mean_kl_loss": 3.6564051697496325e-05, "vf_loss_unclipped": 43.3848762512207, "vf_explained_var": 0.0017279386520385742, "num_module_steps_trained": 35910, "use_intrinsic_rewards": 1.0, "vf_loss": 0.3584648668766022, "module_train_batch_size_mean": 997.5252898807411, "total_loss": 0.2778734862804413, "policy_loss": -0.0003300547250546515}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.5252898807411, "num_module_steps_trained_lifetime": 287280, "total_loss": 0.0, "weights_seq_no": 48.0, "diff_num_grad_updates_vs_sampler_policy": 41.0}}}, "intrinsic_reward_module": {"weights_seq_no": 8.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.8076834879114, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5985, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 47880, "num_module_steps_trained_lifetime_throughput": 787.535806390706}, "__all_modules__": {"num_env_steps_trained": 33000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 95760, "num_env_steps_trained_lifetime": 264000, "num_env_steps_trained_lifetime_throughput": 4343.796278562095, "num_module_steps_trained_throughput": 23832959.630569525, "num_module_steps_trained_lifetime_throughput": 14209754.44334292}, "IntrinsicAttentionMask": [[[0.0910647064447403, 0.09110495448112488, 0.09079586714506149, 0.09075741469860077, 0.09098925441503525, 0.09130102396011353, 0.09126235544681549, 0.09087370336055756, 0.09056540578603745, 0.09052705019712448, 0.0907583013176918], [0.09101845324039459, 0.09104671329259872, 0.09082958847284317, 0.09080256521701813, 0.09096546471118927, 0.0911843329668045, 0.09115719795227051, 0.09088429063558578, 0.09066755324602127, 0.0906405821442604, 0.09080319106578827], [0.09137322753667831, 0.09149403125047684, 0.0905689224600792, 0.09045428037643433, 0.09114701300859451, 0.0920841246843338, 0.09196756035089493, 0.09080131351947784, 0.0898832157254219, 0.08976943045854568, 0.09045692533254623], [0.09141729027032852, 0.09154968708753586, 0.09053623676300049, 0.09041070938110352, 0.09116941690444946, 0.09219664335250854, 0.09206881374120712, 0.09079072624444962, 0.08978568017482758, 0.08966119587421417, 0.09041361510753632], [0.09115136414766312, 0.0912141352891922, 0.09073244780302048, 0.09067258983850479, 0.09103372693061829, 0.09152016788721085, 0.09145978838205338, 0.09085367619991302, 0.09037388861179352, 0.09031426906585693, 0.09067397564649582], [0.0907929390668869, 0.09076307713985443, 0.09099307656288147, 0.09102178364992142, 0.09084900468587875, 0.09061788022518158, 0.09064646065235138, 0.09093502163887024, 0.0911654531955719, 0.09119421988725662, 0.09102112054824829], [0.09083744883537292, 0.09081900864839554, 0.09096095710992813, 0.09097866714000702, 0.09087205678224564, 0.09072931855916977, 0.09074698388576508, 0.09092513471841812, 0.09106725454330444, 0.09108498692512512, 0.09097825735807419], [0.09128396958112717, 0.09138135612010956, 0.09063491225242615, 0.09054230153560638, 0.09110153466463089, 0.09185673296451569, 0.09176287055015564, 0.09082256257534027, 0.09008067101240158, 0.08998863399028778, 0.0905444398522377], [0.09163711220026016, 0.09182765334844589, 0.09037218242883682, 0.09019239246845245, 0.09128069877624512, 0.09276046603918076, 0.09257592260837555, 0.0907370001077652, 0.0892988070845604, 0.08912115544080734, 0.09019654244184494], [0.09168098121881485, 0.09188318997621536, 0.09033924341201782, 0.09014863520860672, 0.09130281209945679, 0.0928734838962555, 0.0926775261759758, 0.0907260999083519, 0.08920160681009293, 0.08901339024305344, 0.0901530385017395], [0.09141627699136734, 0.09154840558767319, 0.09053700417280197, 0.0904117226600647, 0.09116890281438828, 0.09219405055046082, 0.09206648170948029, 0.09079097956418991, 0.08978794515132904, 0.08966369926929474, 0.0904146209359169]], [[0.0876290574669838, 0.08742304891347885, 0.08721752464771271, 0.08701246976852417, 0.08497326821088791, 0.08994835615158081, 0.08457419276237488, 0.08763382583856583, 0.1280146688222885, 0.08743318170309067, 0.08814037591218948], [0.08742794394493103, 0.08721186965703964, 0.08699633181095123, 0.0867813229560852, 0.08464445173740387, 0.08986229449510574, 0.0842265859246254, 0.08743294328451157, 0.1302294284105301, 0.08722250163555145, 0.08796434849500656], [0.08722339570522308, 0.08699732273817062, 0.08677182346582413, 0.08654692023992538, 0.08431316167116165, 0.0897723138332367, 0.08387665450572968, 0.08722862601280212, 0.1324765980243683, 0.08700843900442123, 0.08778474479913712], [0.08701539039611816, 0.08677937835454941, 0.0865439921617508, 0.08630924671888351, 0.08397936075925827, 0.08967836946249008, 0.08352440595626831, 0.08702085167169571, 0.1347564458847046, 0.08679097890853882, 0.08760155737400055], [0.08472074568271637, 0.08438818901777267, 0.08405694365501404, 0.08372697979211807, 0.08047400414943695, 0.08850079774856567, 0.07984346896409988, 0.08472844213247299, 0.15960748493671417, 0.08440454304218292, 0.08554840832948685], [0.08964019268751144, 0.08954941481351852, 0.08945872634649277, 0.08936813473701477, 0.08846047520637512, 0.09065388143062592, 0.08828140050172806, 0.08964228630065918, 0.10552659630775452, 0.08955387771129608, 0.08986496925354004], [0.08422086387872696, 0.08387001603841782, 0.08352060616016388, 0.08317267149686813, 0.07974688708782196, 0.08821480721235275, 0.07908383756875992, 0.0842289924621582, 0.16495966911315918, 0.0838872566819191, 0.08509443700313568], [0.08763366937637329, 0.08742789179086685, 0.08722259104251862, 0.08701778203248978, 0.08498083055019379, 0.08995030075311661, 0.08458219468593597, 0.08763842284679413, 0.12796390056610107, 0.08743800967931747, 0.08814440667629242], [0.09510518610477448, 0.09674516320228577, 0.09841343760490417, 0.10011046379804611, 0.1189296767115593, 0.0786677747964859, 0.12306666374206543, 0.09506763517856598, 0.006060527637600899, 0.09666374325752258, 0.09116972237825394], [0.08743792772293091, 0.08722234517335892, 0.0870072990655899, 0.08679278194904327, 0.08466070145368576, 0.08986662328243256, 0.08424375206232071, 0.08744291961193085, 0.13011959195137024, 0.08723295480012894, 0.08797309547662735], [0.08811170607805252, 0.08793080598115921, 0.08775027841329575, 0.08757012337446213, 0.0857754722237587, 0.0901445671916008, 0.08542363345623016, 0.0881158858537674, 0.12267748266458511, 0.08793970942497253, 0.08856044709682465]], [[0.09093648195266724, 0.09001766890287399, 0.0916164293885231, 0.0911201536655426, 0.09019949287176132, 0.09081282466650009, 0.09032091498374939, 0.0903816819190979, 0.09198690205812454, 0.09148862957954407, 0.09111874550580978], [0.0909905731678009, 0.08762495219707489, 0.09354131668806076, 0.09167454391717911, 0.08828362077474594, 0.09053220599889755, 0.0887254849076271, 0.08894725143909454, 0.09495289623737335, 0.09305795282125473, 0.09166926145553589], [0.09087806195020676, 0.09179532527923584, 0.09021104127168655, 0.09069690108299255, 0.0916123315691948, 0.09100043028593063, 0.09149054437875748, 0.0914297103881836, 0.0898517295718193, 0.0903356596827507, 0.09069829434156418], [0.09092222899198532, 0.09049732238054276, 0.09123518317937851, 0.09100688993930817, 0.09058158844709396, 0.09086517989635468, 0.09063781797885895, 0.09066593647003174, 0.09140516817569733, 0.09117645025253296, 0.09100623428821564], [0.09098217636346817, 0.08809753507375717, 0.09315807372331619, 0.09156649559736252, 0.08866332471370697, 0.09059024602174759, 0.0890425369143486, 0.08923275023698807, 0.09435849636793137, 0.09274640679359436, 0.09156198799610138], [0.09094545245170593, 0.08969501405954361, 0.09187377244234085, 0.0911959782242775, 0.0899420902132988, 0.09077689051628113, 0.09010718762874603, 0.0901898518204689, 0.09238063544034958, 0.09169909358024597, 0.0911940485239029], [0.09097593277692795, 0.08841338008642197, 0.0929027870297432, 0.0914938822388649, 0.08891673386096954, 0.09062831103801727, 0.08925389498472214, 0.08942295610904694, 0.093963623046875, 0.09253863245248795, 0.09148988127708435], [0.09097261726856232, 0.08857153356075287, 0.09277520328760147, 0.09145739674568176, 0.0890435203909874, 0.0906471461057663, 0.0893595740199089, 0.08951801806688309, 0.09376660734415054, 0.09243471920490265, 0.0914536565542221], [0.09083979576826096, 0.09276619553565979, 0.08945216983556747, 0.09046182036399841, 0.09238020330667496, 0.09109558165073395, 0.09212376922369003, 0.09199581295251846, 0.08870931714773178, 0.08971057087182999, 0.09046471863985062], [0.09089020639657974, 0.09146077185869217, 0.09047393500804901, 0.09077726304531097, 0.0913471207022667, 0.09096645563840866, 0.09127143025398254, 0.09123361110687256, 0.09024922549724579, 0.09055179357528687, 0.09077813476324081], [0.09092233330011368, 0.09049362689256668, 0.0912381112575531, 0.091007761657238, 0.09057864546775818, 0.09086477011442184, 0.09063536673784256, 0.09066374599933624, 0.09140963107347488, 0.09117884933948517, 0.09100709855556488]], [[0.08386705815792084, 0.0835782140493393, 0.08593939989805222, 0.08564342558383942, 0.0853484719991684, 0.08714049309492111, 0.08214888721704483, 0.08929372578859329, 0.146172434091568, 0.08359241485595703, 0.08727550506591797], [0.0835815891623497, 0.0832836776971817, 0.08572010695934296, 0.0854145810008049, 0.0851101279258728, 0.08696039021015167, 0.08180996775627136, 0.08918535709381104, 0.1485361009836197, 0.08329832553863525, 0.0870998278260231], [0.0858079046010971, 0.08558549731969833, 0.08739814162254333, 0.08717160671949387, 0.08694566786289215, 0.0883154571056366, 0.08448206633329391, 0.08995216339826584, 0.13032668828964233, 0.08559643477201462, 0.0884183719754219], [0.08554187417030334, 0.08530984818935394, 0.08720166981220245, 0.0869651511311531, 0.0867292582988739, 0.08815975487232208, 0.08415913581848145, 0.08987034857273102, 0.13247445225715637, 0.08532126247882843, 0.08826727420091629], [0.0852731466293335, 0.08503156900405884, 0.08700204640626907, 0.08675558120012283, 0.0865098088979721, 0.08800068497657776, 0.0838339626789093, 0.0897848904132843, 0.1346520334482193, 0.08504346013069153, 0.08811277896165848], [0.08685128390789032, 0.08666828274726868, 0.08815723657608032, 0.08797147125005722, 0.08778610080480576, 0.08890853822231293, 0.0857589989900589, 0.09024541825056076, 0.1219826489686966, 0.08667728304862976, 0.08899272978305817], [0.08211193233728409, 0.08176984637975693, 0.08457344770431519, 0.08422113209962845, 0.08387026935815811, 0.08600585162639618, 0.08008074760437012, 0.08858411014080048, 0.16082890331745148, 0.08178666234016418, 0.0861671194434166], [0.0885847955942154, 0.08847371488809586, 0.08937475085258484, 0.08926268666982651, 0.08915074914693832, 0.08982706069946289, 0.08792039006948471, 0.09062810242176056, 0.10842089354991913, 0.088479183614254, 0.0898776575922966], [0.10698807239532471, 0.10871372371912003, 0.0955362617969513, 0.09707720577716827, 0.09864300489425659, 0.08958014100790024, 0.11776859313249588, 0.0799916461110115, 0.008134029805660248, 0.10862810164690018, 0.08893923461437225], [0.08359570801258087, 0.08329824358224869, 0.08573097735643387, 0.08542591333389282, 0.08512193709611893, 0.08696933835744858, 0.08182670921087265, 0.089190773665905, 0.14841896295547485, 0.08331286907196045, 0.0871085673570633], [0.08696501702070236, 0.08678648620843887, 0.08823884278535843, 0.08805768191814423, 0.08787688612937927, 0.08897142857313156, 0.0858992338180542, 0.0902746394276619, 0.12108094245195389, 0.08679526299238205, 0.08905352652072906]], [[0.09109646826982498, 0.09113672375679016, 0.0904790461063385, 0.0907890647649765, 0.09102098643779755, 0.09098244458436966, 0.09129418432712555, 0.09125552326440811, 0.0905969887971878, 0.09055861830711365, 0.09078995138406754], [0.09104078263044357, 0.0910690501332283, 0.09060683846473694, 0.09082484245300293, 0.09098778665065765, 0.09096071124076843, 0.09117956459522247, 0.09115243703126907, 0.09068980067968369, 0.09066281467676163, 0.09082546830177307], [0.09194886684417725, 0.09217576682567596, 0.08852599561214447, 0.09023136645555496, 0.09152468293905258, 0.09130867570638657, 0.09306766092777252, 0.09284801781177521, 0.0891716256737709, 0.0889611765742302, 0.09023628383874893], [0.0915212631225586, 0.09165380895137787, 0.08950506150722504, 0.09051353484392166, 0.09127310663461685, 0.0911465585231781, 0.09217352420091629, 0.09204573184251785, 0.08988779783248901, 0.08976317197084427, 0.09051644057035446], [0.09120084345340729, 0.09126364439725876, 0.09023960679769516, 0.09072180837392807, 0.09108313173055649, 0.0910230427980423, 0.09150943160057068, 0.0914490595459938, 0.09042293578386307, 0.0903632864356041, 0.0907231867313385], [0.09125412255525589, 0.09132847189903259, 0.09011739492416382, 0.0906873568892479, 0.09111481159925461, 0.09104370325803757, 0.09161952137947083, 0.09154801815748215, 0.09033403545618057, 0.09026353806257248, 0.09068898856639862], [0.09082283824682236, 0.09080440551042557, 0.09110713750123978, 0.09096403419971466, 0.09085743874311447, 0.09087513387203217, 0.0907323881983757, 0.09075005352497101, 0.09105261415243149, 0.09107033908367157, 0.09096362441778183], [0.09087637066841125, 0.09086935967206955, 0.09098421782255173, 0.09092995524406433, 0.09088950604200363, 0.09089621901512146, 0.09084200859069824, 0.09084872156381607, 0.09096354991197586, 0.09097027033567429, 0.09092980623245239], [0.09178629517555237, 0.09197714924812317, 0.08889808505773544, 0.09033922851085663, 0.09142930060625076, 0.09124740958213806, 0.09272664040327072, 0.09254217147827148, 0.08944419026374817, 0.08926625549793243, 0.09034337848424911], [0.09183919429779053, 0.0920417457818985, 0.08877698332071304, 0.09030420333147049, 0.09146036952733994, 0.09126739203929901, 0.09283745288848877, 0.09264156967401505, 0.08935552835464478, 0.08916699886322021, 0.09030860662460327], [0.0915200263261795, 0.09165231138467789, 0.08950787037611008, 0.09051433205604553, 0.09127237647771835, 0.0911460816860199, 0.09217096865177155, 0.0920434296131134, 0.08988983929157257, 0.08976545929908752, 0.09051723033189774]], [[0.08325854688882828, 0.08561070263385773, 0.08268605172634125, 0.08240128308534622, 0.08472921699285507, 0.08925959467887878, 0.08414661139249802, 0.08591340482234955, 0.14972703158855438, 0.08562523871660233, 0.08664226531982422], [0.08565478026866913, 0.08738360553979874, 0.08523191511631012, 0.08502126485109329, 0.08673731237649918, 0.09003924578428268, 0.08630910515785217, 0.08760511130094528, 0.13048580288887024, 0.08739425241947174, 0.08813756704330444], [0.08263462781906128, 0.0851350724697113, 0.08202678710222244, 0.08172454684972763, 0.08419745415449142, 0.08902350813150406, 0.08357810974121094, 0.0854572057723999, 0.1548389494419098, 0.08515053987503052, 0.08623319864273071], [0.08231805264949799, 0.0848916694521904, 0.08169279247522354, 0.08138195425271988, 0.08392631262540817, 0.08889880776405334, 0.08328885585069656, 0.08522342890501022, 0.15744778513908386, 0.08490761369466782, 0.08602273464202881], [0.08478730171918869, 0.08675210922956467, 0.08430759608745575, 0.08406876772642136, 0.08601692318916321, 0.08978129178285599, 0.08553027361631393, 0.08700425922870636, 0.1373765468597412, 0.08676423132419586, 0.08761076629161835], [0.08889301121234894, 0.08962331712245941, 0.08871306478977203, 0.08862322568893433, 0.08935131132602692, 0.09072869271039963, 0.0891704335808754, 0.08971626311540604, 0.10561368614435196, 0.08962778747081757, 0.08993913233280182], [0.08419414609670639, 0.08631341904401779, 0.08367736637592316, 0.08342015743255615, 0.08551996201276779, 0.08958873897790909, 0.08499503880739212, 0.08658569306135178, 0.1421380639076233, 0.08632650226354599, 0.08724086731672287], [0.08594458550214767, 0.08759181946516037, 0.08554143458604813, 0.08534056693315506, 0.08697621524333954, 0.09011894464492798, 0.08656822890043259, 0.08780275285243988, 0.12820379436016083, 0.08760195970535278, 0.08830967545509338], [0.10948029905557632, 0.09536202251911163, 0.11328858137130737, 0.1152421161532402, 0.10038082301616669, 0.07754311710596085, 0.10387256741523743, 0.09370850026607513, 0.005973920226097107, 0.09528177976608276, 0.08986630290746689], [0.08566879481077194, 0.08739370852708817, 0.08524687588214874, 0.08503669500350952, 0.0867488905787468, 0.09004317969083786, 0.08632165938615799, 0.08761471509933472, 0.1303751915693283, 0.08740434050559998, 0.08814594149589539], [0.08662598580121994, 0.088075652718544, 0.08627065271139145, 0.08609353005886078, 0.08753428608179092, 0.09029306471347809, 0.08717524260282516, 0.08826103806495667, 0.1228795275092125, 0.08808457106351852, 0.08870634436607361]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_duration_sec_mean": 0.005320954998023808, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.916289782454704e-06, "listify_data_for_vector_env": 1.048714558864581e-05, "un_batch_to_individual_items": 6.587413479559725e-06, "tensor_to_numpy": 1.5025997780968147e-05, "remove_single_ts_time_rank_from_batch": 1.2076338470440288e-05, "get_actions": 3.566968973279187e-05}}, "connector_pipeline_timer": 0.00011455247714364733}, "env_to_module_connector": {"connector_pipeline_timer": 5.8907424628770856e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.667699852332903e-06, "numpy_to_tensor": 1.2172125973261272e-05, "add_states_from_episodes_to_batch": 2.6837537924399715e-06, "add_observations_from_episodes_to_batch": 2.795489597261472e-06, "batch_individual_items": 1.2321138850431557e-05}}}, "env_step_timer": 1.3806004340539126e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": -0.45, "episode_return_max": 14.5, "module_episode_returns_mean": {"default_policy": -0.45}, "env_to_module_sum_episodes_length_in": 10.3682383945743, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": -0.45}, "num_env_steps_sampled": 400, "episode_len_max": 20, "weights_seq_no": 8.0, "num_episodes": 20, "num_env_steps_sampled_lifetime": 40400, "env_reset_timer": 0.0006412192492057764, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -14.5, "episode_len_mean": 20.0, "num_episodes_lifetime": 160, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "env_to_module_sum_episodes_length_out": 10.3682383945743, "rlmodule_inference_timer": 3.06022291463869e-05, "sample": 0.1306917239780787, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "time_between_sampling": 9.936435485555169}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "ba9e8_00000", "date": "2025-08-11_18-09-13", "timestamp": 1754928553, "time_this_iter_s": 9.513456106185913, "time_total_s": 80.40503931045532, "pid": 10327, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3858fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 80.40503931045532, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 41.59285714285714, "ram_util_percent": 79.90714285714286}}
{"timers": {"training_iteration": 9.44773076216889, "restore_env_runners": 1.8916920150566652e-05, "training_step": 9.44749730319926, "env_runner_sampling_timer": 1.7730394564512844, "learner_update_timer": 7.489358478748667, "synch_weights": 0.0014815864243173976, "restore_eval_env_runners": 5.4796282144754536e-05, "evaluation_iteration": 0.14371117319091098, "synch_eval_env_connectors": 0.00019586307721502873, "synch_env_connectors": 6.963003028623532e-06}, "env_runners": {"env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": -0.7800000000000001}, "rlmodule_inference_timer": 3.296641461916193e-05, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.6063713295652512e-05, "get_actions": 4.123259303013372e-05, "listify_data_for_vector_env": 1.0847669920724298e-05, "un_batch_to_individual_items": 6.793611895209576e-06, "remove_single_ts_time_rank_from_batch": 1.2283294513962001e-05, "normalize_and_clip_actions": 8.28573293614988e-06}}, "connector_pipeline_timer": 0.00012285526781010837}, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2883689864741684e-05, "add_states_from_episodes_to_batch": 2.805296167152408e-06, "add_time_dim_to_batch_and_zero_pad": 7.357035415355486e-06, "add_observations_from_episodes_to_batch": 2.9489369516330277e-06, "numpy_to_tensor": 1.3268559136292136e-05}}, "connector_pipeline_timer": 6.199037661860246e-05}, "sample": 0.006257680147044818, "episode_duration_sec_mean": 0.005491787545382974, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "agent_episode_returns_mean": {"default_agent": -0.7800000000000001}, "weights_seq_no": 8.0, "episode_return_mean": -0.7800000000000001, "env_step_timer": 1.4642998460723436e-05, "episode_return_max": 8.5, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -4312500.0, "env_reset_timer": 4.8515870918608667e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "time_between_sampling": 0.032002623603461386, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "episode_return_min": -11.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -215625.0, "num_env_steps_sampled_lifetime_throughput": 3115.2607095656595}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.14235532951590363, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009982246951813515, "add_observations_from_episodes_to_batch": 0.0010358221781080832, "add_columns_from_episodes_to_train_batch": 0.04476510069283377, "add_time_dim_to_batch_and_zero_pad": 0.07816776237680814, "add_states_from_episodes_to_batch": 0.003788507177014341, "batch_individual_items": 0.004323267413153649, "numpy_to_tensor": 8.97789971471074e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.3583081364631653, "module_train_batch_size_mean": 997.7895308613665, "num_module_steps_trained": 5985, "policy_loss": -0.00012843249714933336, "use_intrinsic_rewards": 0.0, "num_module_steps_trained_lifetime": 53865, "total_loss": 0.27794766426086426, "weights_seq_no": 9.0, "entropy": 0.6896487474441528, "mean_kl_loss": 8.460025128442794e-06, "vf_loss_unclipped": 43.19168472290039, "num_trainable_parameters": 16595, "curr_kl_coeff": 0.00031559361377730966, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.0002931356430053711, "num_module_steps_trained_lifetime_throughput": 783.4713797176371}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 646380, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 1782000, "num_env_steps_trained_lifetime_throughput": 52994.6896608018}, "default_policy": {"num_module_steps_trained_lifetime": 323190, "weights_seq_no": 54.0, "diff_num_grad_updates_vs_sampler_policy": 46.0, "entropy": 0.6896635890007019, "mean_kl_loss": 7.736919542367104e-06, "vf_loss_unclipped": 43.08278274536133, "vf_explained_var": 0.0017502903938293457, "num_module_steps_trained": 35910, "use_intrinsic_rewards": 1.0, "vf_loss": 0.35845616459846497, "module_train_batch_size_mean": 997.5168494263723, "total_loss": 0.27806946635246277, "policy_loss": -0.00012316266656853259}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.5168494263723, "num_module_steps_trained_lifetime": 323190, "total_loss": 0.0, "weights_seq_no": 54.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}}}, "intrinsic_reward_module": {"weights_seq_no": 9.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.7895308613665, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5985, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 53865, "num_module_steps_trained_lifetime_throughput": 783.4849498220111}, "__all_modules__": {"num_env_steps_trained": 33000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 107730, "num_env_steps_trained_lifetime": 297000, "num_env_steps_trained_lifetime_throughput": 4321.403808240162, "num_module_steps_trained_throughput": 23247183.558136046, "num_module_steps_trained_lifetime_throughput": 14118947.226498919}, "IntrinsicAttentionMask": [[[0.09119171649217606, 0.09158339351415634, 0.09057364612817764, 0.09088399261236191, 0.09111615270376205, 0.09107756614685059, 0.09103900194168091, 0.09100044518709183, 0.09034375101327896, 0.09030549228191376, 0.09088487923145294], [0.09037477523088455, 0.08964744955301285, 0.09154099225997925, 0.0909525528550148, 0.0905161201953888, 0.09058843553066254, 0.09066081047058105, 0.09073323756456375, 0.09198066592216492, 0.09205415099859238, 0.0909508764743805], [0.09247834235429764, 0.09471598267555237, 0.0890357494354248, 0.09075094759464264, 0.09205171465873718, 0.09183446317911148, 0.09161773324012756, 0.09140150994062424, 0.08778239786624908, 0.08757521957159042, 0.090755894780159], [0.0918327271938324, 0.09313104301691055, 0.08980967104434967, 0.09082157909870148, 0.0915837213397026, 0.09145674109458923, 0.09132993966341019, 0.09120330959558487, 0.08906513452529907, 0.08894164860248566, 0.09082447737455368], [0.09134918451309204, 0.09196121990680695, 0.09038638323545456, 0.09086936712265015, 0.09123128652572632, 0.09117109328508377, 0.0911109447479248, 0.09105084091424942, 0.09002918750047684, 0.08996979147195816, 0.09087075293064117], [0.09142958372831345, 0.09215471893548965, 0.09029066562652588, 0.0908617228269577, 0.09128999710083008, 0.09121875464916229, 0.09114756435155869, 0.09107642620801926, 0.0898687019944191, 0.08979856222867966, 0.09086336195468903], [0.09150992333889008, 0.09234849363565445, 0.09019492566585541, 0.09085395187139511, 0.09134861826896667, 0.09126630425453186, 0.09118406474590302, 0.09110189229249954, 0.0897083654999733, 0.08962753415107727, 0.09085584431886673], [0.09159024059772491, 0.09254258126020432, 0.09009919315576553, 0.09084608405828476, 0.09140719473361969, 0.09131379425525665, 0.09122049063444138, 0.09112728387117386, 0.08954823017120361, 0.08945673704147339, 0.09084822982549667], [0.09295596927404404, 0.09590587764978409, 0.08846030384302139, 0.0906936377286911, 0.09239600598812103, 0.09211117029190063, 0.09182721376419067, 0.09154412895441055, 0.08683663606643677, 0.0865689367055893, 0.09070009738206863], [0.09303539991378784, 0.09610521793365479, 0.0883643701672554, 0.09068368375301361, 0.09245311468839645, 0.09215696156024933, 0.0918617695569992, 0.0915675163269043, 0.0866796225309372, 0.08640196919441223, 0.09069039672613144], [0.09183087199926376, 0.09312654286623001, 0.08981188386678696, 0.0908217653632164, 0.09158238023519516, 0.09145566076040268, 0.09132910519838333, 0.0912027359008789, 0.08906882256269455, 0.08894557505846024, 0.0908246710896492]], [[0.08346723765134811, 0.0831797793507576, 0.08289331197738647, 0.08260782808065414, 0.08494158834218979, 0.08948332071304321, 0.08175726979970932, 0.08886802941560745, 0.15010227262973785, 0.08583986014127731, 0.08685943484306335], [0.08316220343112946, 0.08286578208208084, 0.08257041871547699, 0.0822761207818985, 0.08468306809663773, 0.08937381953001022, 0.08139946311712265, 0.08873783051967621, 0.1526583582162857, 0.08561012893915176, 0.08666279166936874], [0.08285394310951233, 0.08254866302013397, 0.08224449306726456, 0.08194144815206528, 0.08442091941833496, 0.08925978094339371, 0.08103899657726288, 0.08860320597887039, 0.15524984896183014, 0.0853765457868576, 0.08646206557750702], [0.08254249393939972, 0.08222842961549759, 0.08191554993391037, 0.08160385489463806, 0.08415514975786209, 0.08914119005203247, 0.0806758776307106, 0.08846411854028702, 0.15787701308727264, 0.08513911813497543, 0.08625727146863937], [0.08496656268835068, 0.08472586423158646, 0.08448585122823715, 0.08424650877714157, 0.08619879186153412, 0.08997111022472382, 0.08353257179260254, 0.08946208655834198, 0.13766694068908691, 0.08694767206907272, 0.08779599517583847], [0.08896487951278687, 0.08887478709220886, 0.08878478407859802, 0.08869487792253494, 0.08942355215549469, 0.09080204367637634, 0.08842568844556808, 0.09061823040246964, 0.10569906234741211, 0.08970024436712265, 0.0900118499994278], [0.08158864825963974, 0.08124875277280807, 0.08091028034687042, 0.08057320863008499, 0.08333578705787659, 0.08875755220651627, 0.07957041263580322, 0.08801958709955215, 0.16597440838813782, 0.0844033882021904, 0.08561799675226212], [0.08847322314977646, 0.08836227655410767, 0.08825147151947021, 0.0881408080458641, 0.08903846144676208, 0.09074138104915619, 0.08780964463949203, 0.09051394462585449, 0.10952445864677429, 0.08937977999448776, 0.08976444602012634], [0.10733648389577866, 0.10918738692998886, 0.1110701933503151, 0.11298548430204391, 0.09841518849134445, 0.07602471113204956, 0.11893177032470703, 0.0786692351102829, 0.005856954026967287, 0.0934160128235817, 0.08810658752918243], [0.0858287438750267, 0.08561712503433228, 0.08540603518486023, 0.08519546687602997, 0.08691085129976273, 0.09021129459142685, 0.08456685394048691, 0.08976700156927109, 0.13061857223510742, 0.0875675156712532, 0.08831050246953964], [0.08676279336214066, 0.0865846574306488, 0.0864068940281868, 0.08622949570417404, 0.08767253905534744, 0.09043566137552261, 0.08569948375225067, 0.09006470441818237, 0.12307357043027878, 0.08822368085384369, 0.08884643018245697]], [[0.090886190533638, 0.08996789157390594, 0.09100853651762009, 0.0910697728395462, 0.09070158004760742, 0.09076260775327682, 0.09082367271184921, 0.09033169597387314, 0.09193602949380875, 0.091997891664505, 0.0905141532421112], [0.09080537408590317, 0.08744660764932632, 0.09125986695289612, 0.09148795902729034, 0.09012270718812943, 0.09034795314073563, 0.09057377278804779, 0.08876622468233109, 0.09475964307785034, 0.09499648213386536, 0.08943347632884979], [0.09089484065771103, 0.09030522406101227, 0.09097323566675186, 0.09101245552301407, 0.0907764807343483, 0.09081561863422394, 0.09085476398468018, 0.09053907543420792, 0.091566301882267, 0.0916057750582695, 0.09065622836351395], [0.09089898318052292, 0.0904741883277893, 0.09095540642738342, 0.09098362922668457, 0.0908137708902359, 0.09084194898605347, 0.09087013453245163, 0.09064275771379471, 0.09138180315494537, 0.09141016006469727, 0.09072716534137726], [0.09087219834327698, 0.08945947885513306, 0.09106100350618362, 0.09115555137395859, 0.0905875638127327, 0.09068162739276886, 0.09077578037977219, 0.09001823514699936, 0.09249680489301682, 0.09259284287691116, 0.09029892086982727], [0.09087695181369781, 0.0896274521946907, 0.09104376286268234, 0.09112729132175446, 0.09062539041042328, 0.09070852398872375, 0.0907917395234108, 0.09012192487716675, 0.09231105446815491, 0.09239573776721954, 0.09037017822265625], [0.0908815786242485, 0.08979563415050507, 0.0910264104604721, 0.09109891951084137, 0.09066310524940491, 0.09073531627655029, 0.09080758690834045, 0.09022561460733414, 0.0921255573630333, 0.0921989306807518, 0.09044138342142105], [0.09084077179431915, 0.08844317495822906, 0.09116320312023163, 0.09132485091686249, 0.09035556018352509, 0.09051577746868134, 0.09067627787590027, 0.08938828110694885, 0.09363070875406265, 0.0937967300415039, 0.08986461907625198], [0.09094469249248505, 0.09287331253290176, 0.09069224447011948, 0.09056627750396729, 0.09132761508226395, 0.09120076894760132, 0.09107410162687302, 0.09210205078125, 0.08881176263093948, 0.08868841081857681, 0.09171881526708603], [0.09094703942537308, 0.09304524213075638, 0.09067267924547195, 0.09053581207990646, 0.091363325715065, 0.09122541546821594, 0.091087706387043, 0.09220569580793381, 0.08863106369972229, 0.08849728107452393, 0.09178877621889114], [0.09085685014724731, 0.08894411474466324, 0.09111328423023224, 0.09124176949262619, 0.09047060459852219, 0.09059818834066391, 0.09072595089673996, 0.08969935029745102, 0.0930696353316307, 0.09320088475942612, 0.09007936716079712]], [[0.09245186299085617, 0.09376934170722961, 0.0921284407377243, 0.0919671505689621, 0.09180615097284317, 0.09577839821577072, 0.09148497879505157, 0.09393759071826935, 0.07085220515727997, 0.09377743303775787, 0.09204643964767456], [0.0916535034775734, 0.09223027527332306, 0.09151121228933334, 0.09144015610218048, 0.0913691520690918, 0.09310117363929749, 0.09122730791568756, 0.09230360388755798, 0.08145464956760406, 0.0922337993979454, 0.09147509187459946], [0.09262769669294357, 0.09413113445043564, 0.09225907176733017, 0.09207531064748764, 0.09189191460609436, 0.09642935544252396, 0.09152621775865555, 0.09432333707809448, 0.06842998415231705, 0.09414037317037582, 0.09216563403606415], [0.09271249920129776, 0.0943092554807663, 0.0923212319612503, 0.09212622046470642, 0.09193161875009537, 0.09675311297178268, 0.09154364466667175, 0.09451349824666977, 0.06724775582551956, 0.09431908279657364, 0.09222207963466644], [0.09279527515172958, 0.0944855734705925, 0.09238133579492569, 0.09217505902051926, 0.09196924418210983, 0.09707575291395187, 0.09155900031328201, 0.09470190107822418, 0.06608445197343826, 0.0944959744811058, 0.09227645397186279], [0.09016675502061844, 0.08966972678899765, 0.09029027819633484, 0.09035210311412811, 0.09041397273540497, 0.08893020451068878, 0.09053783118724823, 0.08960695564746857, 0.10004383325576782, 0.0896667093038559, 0.09032168984413147], [0.09295481443405151, 0.09483283758163452, 0.09249546378850937, 0.09226664155721664, 0.09203838557004929, 0.09771770983934402, 0.09158356487751007, 0.09507345408201218, 0.06381358951330185, 0.09484440088272095, 0.09237910807132721], [0.09154176712036133, 0.09202595800161362, 0.09142225235700607, 0.09136254340410233, 0.09130287915468216, 0.09275615215301514, 0.09118366986513138, 0.09208747744560242, 0.08289644122123718, 0.0920289158821106, 0.0913918986916542], [0.09290707111358643, 0.10927557945251465, 0.0892472192645073, 0.08747171610593796, 0.08573153614997864, 0.13934996724128723, 0.0823543444275856, 0.11154533177614212, 0.004392992705106735, 0.10938373953104019, 0.08834045380353928], [0.09164819121360779, 0.0922204926609993, 0.09150700271129608, 0.0914364904165268, 0.09136603027582169, 0.09308461099863052, 0.0912252739071846, 0.09229325503110886, 0.08152351528406143, 0.09222399443387985, 0.09147115796804428], [0.09267104417085648, 0.09422187507152557, 0.09229091554880142, 0.09210143238306046, 0.09191234409809113, 0.09659402072429657, 0.09153532981872559, 0.09442019462585449, 0.06782679259777069, 0.09423141181468964, 0.0921945720911026]], [[0.09093714505434036, 0.09001833200454712, 0.09161709994077682, 0.09112082421779633, 0.09075243026018143, 0.09026084095239639, 0.09087459743022919, 0.09038233757019043, 0.09142778813838959, 0.09148930013179779, 0.09111941605806351], [0.09099957346916199, 0.08763362467288971, 0.09355057030916214, 0.09168361127376556, 0.09031543880701065, 0.08851304650306702, 0.09076747298240662, 0.08895605802536011, 0.09283512085676193, 0.09306716173887253, 0.09167833626270294], [0.0908786877989769, 0.09179595112800598, 0.0902116596698761, 0.0906975194811821, 0.09106160700321198, 0.09155204147100449, 0.09094054996967316, 0.09143033623695374, 0.09039638936519623, 0.09033628553152084, 0.09069892019033432], [0.09092236310243607, 0.0904974564909935, 0.09123531728982925, 0.09100703150033951, 0.09083712846040726, 0.0906098261475563, 0.09089350700378418, 0.09066607058048248, 0.09114830940961838, 0.0911765918135643, 0.09100637584924698], [0.09095123410224915, 0.08953727781772614, 0.09200260788202286, 0.09123482555150986, 0.09066635370254517, 0.08990972489118576, 0.09085472673177719, 0.09009651839733124, 0.0917094498872757, 0.09180466830730438, 0.09123264998197556], [0.09098496288061142, 0.08826104551553726, 0.09303637593984604, 0.09153611958026886, 0.09043291956186295, 0.08897464722394943, 0.09079776704311371, 0.08933360874652863, 0.09246215224266052, 0.0926484763622284, 0.09153187274932861], [0.09094200283288956, 0.08985533565282822, 0.0917474702000618, 0.09115947782993317, 0.09072337299585342, 0.09014195203781128, 0.09086795151233673, 0.09028559923171997, 0.09152309596538544, 0.09159599244594574, 0.09115780144929886], [0.09097714722156525, 0.08857595175504684, 0.09277982264757156, 0.09146195650100708, 0.09049121290445328, 0.08920586109161377, 0.09081240743398666, 0.08952248096466064, 0.0922757014632225, 0.09243932366371155, 0.09145821630954742], [0.09089600294828415, 0.09129994362592697, 0.09060082584619522, 0.0908159539103508, 0.09097673743963242, 0.09119275212287903, 0.09092331677675247, 0.09113920480012894, 0.09068269282579422, 0.09065607190132141, 0.09081656485795975], [0.09089045226573944, 0.09146101027727127, 0.0904741883277893, 0.09077750891447067, 0.0910044014453888, 0.09130951017141342, 0.09092900156974792, 0.09123384952545166, 0.09058958292007446, 0.09055204689502716, 0.09077837318181992], [0.09092247486114502, 0.09049376100301743, 0.09123824536800385, 0.09100789576768875, 0.09083647280931473, 0.09060713648796082, 0.09089335799217224, 0.09066388756036758, 0.0911504477262497, 0.09117899090051651, 0.09100724011659622]], [[0.09269627928733826, 0.09253399819135666, 0.09385264664888382, 0.09368833899497986, 0.09204884618520737, 0.0945165753364563, 0.09172683954238892, 0.09418592602014542, 0.06991878896951675, 0.09254197776317596, 0.09228977560997009], [0.09280089288949966, 0.09262724220752716, 0.09403890371322632, 0.09386293590068817, 0.09210822731256485, 0.09475018084049225, 0.09176383167505264, 0.09439591318368912, 0.06865018606185913, 0.09263578057289124, 0.09236595779657364], [0.09188990294933319, 0.09180745482444763, 0.09247534722089767, 0.09239237755537033, 0.09156057238578796, 0.09280989319086075, 0.09139634668827057, 0.09264342486858368, 0.07952997088432312, 0.09181151539087296, 0.09168325364589691], [0.09201113134622574, 0.0919174775481224, 0.09267652034759521, 0.09258218854665756, 0.09163707494735718, 0.09305699914693832, 0.09145062416791916, 0.0928676575422287, 0.07810184359550476, 0.0919220894575119, 0.09177640080451965], [0.09310154616832733, 0.09289366006851196, 0.09458574652671814, 0.09437455236911774, 0.0922727882862091, 0.09544019401073456, 0.09186118096113205, 0.09501446038484573, 0.06497107446193695, 0.09290388226509094, 0.09258100390434265], [0.09137678146362305, 0.09133917093276978, 0.0916433334350586, 0.09160561114549637, 0.09122643619775772, 0.09179524332284927, 0.09115134924650192, 0.09171969443559647, 0.08551887422800064, 0.09134101867675781, 0.09128247946500778], [0.0932912603020668, 0.09306047111749649, 0.09494062513113022, 0.09470575302839279, 0.09237151592969894, 0.09589142352342606, 0.0919150561094284, 0.0954175591468811, 0.06262097507715225, 0.0930718183517456, 0.09271346777677536], [0.0916370153427124, 0.09157717972993851, 0.09206154942512512, 0.09200143069028854, 0.09139788150787354, 0.0923038125038147, 0.0912785455584526, 0.09218329936265945, 0.08249218761920929, 0.09158012270927429, 0.09148699790239334], [0.09508746862411499, 0.09309367835521698, 0.11046861112117767, 0.10815230756998062, 0.08735964447259903, 0.12029939889907837, 0.08373454213142395, 0.11530741304159164, 0.0031406499911099672, 0.09319083392620087, 0.09016542136669159], [0.09279580414295197, 0.09262271225452423, 0.09402978420257568, 0.0938543900847435, 0.09210536628961563, 0.09473872929811478, 0.09176207333803177, 0.09438562393188477, 0.06871213018894196, 0.09263122081756592, 0.09236226230859756], [0.09295447915792465, 0.09276363998651505, 0.0943160280585289, 0.09412238746881485, 0.09219346195459366, 0.0950990691781044, 0.0918152928352356, 0.09470897912979126, 0.0667770728468895, 0.09277302026748657, 0.09247655421495438]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_duration_sec_mean": 0.005273699569515884, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.829865164462902e-06, "listify_data_for_vector_env": 1.0448316816962071e-05, "un_batch_to_individual_items": 6.5226885888275435e-06, "tensor_to_numpy": 1.515571084751335e-05, "remove_single_ts_time_rank_from_batch": 1.1907101285571618e-05, "get_actions": 3.570766458105045e-05}}, "connector_pipeline_timer": 0.00011434596158916355}, "env_to_module_connector": {"connector_pipeline_timer": 5.887274731086261e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.747659813534362e-06, "numpy_to_tensor": 1.2021640697436105e-05, "add_states_from_episodes_to_batch": 2.693277255774533e-06, "add_observations_from_episodes_to_batch": 2.760780806454182e-06, "batch_individual_items": 1.2348585987946207e-05}}}, "env_step_timer": 1.3939632788983234e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 0.15, "episode_return_max": 14.5, "module_episode_returns_mean": {"default_policy": 0.15}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 0.15}, "num_env_steps_sampled": 400, "episode_len_max": 20, "weights_seq_no": 9.0, "num_episodes": 20, "num_env_steps_sampled_lifetime": 45400, "env_reset_timer": 0.0006382024772128646, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -14.5, "episode_len_mean": 20.0, "num_episodes_lifetime": 180, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 3.083330524313242e-05, "sample": 0.13053927215870237, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "time_between_sampling": 9.938223064449987}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "ba9e8_00000", "date": "2025-08-11_18-09-23", "timestamp": 1754928563, "time_this_iter_s": 10.208458185195923, "time_total_s": 90.61349749565125, "pid": 10327, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3858fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 90.61349749565125, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 48.035714285714285, "ram_util_percent": 80.69285714285715}}
{"timers": {"training_iteration": 9.469165454127186, "restore_env_runners": 1.8789000542333792e-05, "training_step": 9.46893236891742, "env_runner_sampling_timer": 1.7707211010568131, "learner_update_timer": 7.513064806051174, "synch_weights": 0.0014780055606398717, "restore_eval_env_runners": 5.439748926008315e-05, "evaluation_iteration": 0.14351417061884586, "synch_eval_env_connectors": 0.0001948498564355882, "synch_env_connectors": 6.945452556709794e-06}, "env_runners": {"env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": -0.6199999999999999}, "rlmodule_inference_timer": 3.159585024336197e-05, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5398602743027223e-05, "get_actions": 3.8851878871539636e-05, "listify_data_for_vector_env": 1.0583546696433085e-05, "un_batch_to_individual_items": 6.654366399726589e-06, "remove_single_ts_time_rank_from_batch": 1.1992951340315591e-05, "normalize_and_clip_actions": 8.023941135978577e-06}}, "connector_pipeline_timer": 0.000118121922169505}, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2577209158274576e-05, "add_states_from_episodes_to_batch": 2.770752567331553e-06, "add_time_dim_to_batch_and_zero_pad": 7.0819389430946155e-06, "add_observations_from_episodes_to_batch": 2.865656179294287e-06, "numpy_to_tensor": 1.2490208089614607e-05}}, "connector_pipeline_timer": 5.994272536706196e-05}, "sample": 0.005755976955458616, "episode_duration_sec_mean": 0.005283778831362726, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "agent_episode_returns_mean": {"default_agent": -0.6199999999999999}, "weights_seq_no": 9.0, "episode_return_mean": -0.6199999999999999, "env_step_timer": 1.3976280899765743e-05, "episode_return_max": 8.5, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -4930000.0, "env_reset_timer": 4.400792609175055e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "time_between_sampling": 0.034759524867216514, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "episode_return_min": -11.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -246500.0, "num_env_steps_sampled_lifetime_throughput": 3234.7313267623695}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.14234222955077153, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009971294481458233, "add_observations_from_episodes_to_batch": 0.0010347835371855756, "add_columns_from_episodes_to_train_batch": 0.04473842634658546, "add_time_dim_to_batch_and_zero_pad": 0.0781851785024142, "add_states_from_episodes_to_batch": 0.0037938158555604748, "batch_individual_items": 0.004326698488985157, "numpy_to_tensor": 8.97012075987548e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.3583047688007355, "module_train_batch_size_mean": 997.772440523815, "num_module_steps_trained": 5985, "policy_loss": -0.00013473437866196036, "use_intrinsic_rewards": 0.0, "num_module_steps_trained_lifetime": 59850, "total_loss": 0.277939110994339, "weights_seq_no": 10.0, "entropy": 0.6894194483757019, "mean_kl_loss": 8.900117791199591e-06, "vf_loss_unclipped": 45.667476654052734, "num_trainable_parameters": 16595, "curr_kl_coeff": 0.00015779680688865483, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.0001150369644165039, "num_module_steps_trained_lifetime_throughput": 777.6330620555937}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 718200, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 1980000, "num_env_steps_trained_lifetime_throughput": 52013.51564065723}, "default_policy": {"num_module_steps_trained_lifetime": 359100, "weights_seq_no": 60.0, "diff_num_grad_updates_vs_sampler_policy": 51.0, "entropy": 0.6894352436065674, "mean_kl_loss": 8.131943104672246e-06, "vf_loss_unclipped": 45.59676742553711, "vf_explained_var": 0.001941382884979248, "num_module_steps_trained": 35910, "use_intrinsic_rewards": 1.0, "vf_loss": 0.35843878984451294, "module_train_batch_size_mean": 997.5109713823833, "total_loss": 0.2780514061450958, "policy_loss": -0.00012816116213798523}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.5109713823833, "num_module_steps_trained_lifetime": 359100, "total_loss": 0.0, "weights_seq_no": 60.0, "diff_num_grad_updates_vs_sampler_policy": 51.0}}}, "intrinsic_reward_module": {"weights_seq_no": 10.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.772440523815, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5985, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 59850, "num_module_steps_trained_lifetime_throughput": 777.6459214011851}, "__all_modules__": {"num_env_steps_trained": 33000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 119700, "num_env_steps_trained_lifetime": 330000, "num_env_steps_trained_lifetime_throughput": 4289.1503615885495, "num_module_steps_trained_throughput": 22671535.468901686, "num_module_steps_trained_lifetime_throughput": 14025772.260471785}, "IntrinsicAttentionMask": [[[0.09088598936796188, 0.08996768295764923, 0.0915655568242073, 0.09162716567516327, 0.09070137143135071, 0.09076239913702011, 0.0902707576751709, 0.09033148735761642, 0.09193582832813263, 0.09143783152103424, 0.09051394462585449], [0.09080258756875992, 0.08744393289089203, 0.09334806352853775, 0.09358137845993042, 0.09011994302272797, 0.09034518152475357, 0.08854220062494278, 0.08876349776983261, 0.09475672990083694, 0.0928657054901123, 0.08943073451519012], [0.09092788398265839, 0.09184564650058746, 0.09026050567626953, 0.09020049124956131, 0.09111090749502182, 0.09105031937360764, 0.09154070168733597, 0.0914798378944397, 0.08990100771188736, 0.09038519114255905, 0.09129747003316879], [0.09093087166547775, 0.0920163169503212, 0.09014280140399933, 0.09007198363542557, 0.09114716947078705, 0.09107556194067001, 0.091655433177948, 0.09158343076705933, 0.08971872180700302, 0.09028995037078857, 0.09136774390935898], [0.09087172150611877, 0.08945900201797485, 0.09192217886447906, 0.09201762080192566, 0.0905870869755745, 0.09068114310503006, 0.0899243876338005, 0.09001775830984116, 0.09249631315469742, 0.09172441065311432, 0.09029843658208847], [0.09087656438350677, 0.08962707966566086, 0.09180418401956558, 0.09188840538263321, 0.09062500298023224, 0.09070813655853271, 0.09003894031047821, 0.0901215448975563, 0.09231065958738327, 0.09162963926792145, 0.0903697982430458], [0.09083356708288193, 0.08827503025531769, 0.09275739639997482, 0.09293308854103088, 0.09031542390584946, 0.09048648923635483, 0.0891142264008522, 0.08928302675485611, 0.09381657838821411, 0.09239381551742554, 0.08979132771492004], [0.09083936363458633, 0.08844181150197983, 0.09263931214809418, 0.09280356764793396, 0.09035417437553406, 0.09051438421010971, 0.08922868967056274, 0.08938691020011902, 0.09362926334142685, 0.09229932725429535, 0.08986323326826096], [0.09094379097223282, 0.09287238866090775, 0.08955458551645279, 0.08943021297454834, 0.09132670611143112, 0.09119986742734909, 0.09222922474145889, 0.09210113435983658, 0.08881088346242905, 0.08981328457593918, 0.0917179062962532], [0.09092128276824951, 0.09149203449487686, 0.09050487726926804, 0.09046737104654312, 0.09103526920080185, 0.09099755436182022, 0.09130262583494186, 0.09126479178667068, 0.09028008580207825, 0.09058275818824768, 0.09115138649940491], [0.09085594862699509, 0.0889432355761528, 0.09228511154651642, 0.09241525828838348, 0.09046971797943115, 0.09059729427099228, 0.08957214653491974, 0.08969846367835999, 0.09306871891021729, 0.09201560169458389, 0.09007847309112549]], [[0.09199102967977524, 0.09138499200344086, 0.09187041223049164, 0.09181015938520432, 0.09174995124340057, 0.0921132043004036, 0.09108571708202362, 0.09199242293834686, 0.08277378231287003, 0.09193367511034012, 0.09129461646080017], [0.09383491426706314, 0.0920807346701622, 0.0934840738773346, 0.09330913424491882, 0.09313453733921051, 0.09419114887714386, 0.09122242033481598, 0.09383896738290787, 0.06941511482000351, 0.09366796165704727, 0.09182099252939224], [0.09237343817949295, 0.09154179692268372, 0.09220775961875916, 0.09212502092123032, 0.09204236418008804, 0.09254132956266403, 0.09113187342882156, 0.09237534552812576, 0.07994846999645233, 0.09229463338851929, 0.09141795337200165], [0.0925615131855011, 0.09161662310361862, 0.09237317740917206, 0.09227915108203888, 0.09218522161245346, 0.09275241196155548, 0.09115129709243774, 0.0925636887550354, 0.07856903225183487, 0.09247193485498428, 0.09147600829601288], [0.0927475243806839, 0.0916890799999237, 0.09253644943237305, 0.09243109822273254, 0.09232586622238159, 0.09296151995658875, 0.09116831421852112, 0.09274996072053909, 0.07721135765314102, 0.09264712780714035, 0.09153168648481369], [0.09159558266401291, 0.09121644496917725, 0.09152019768953323, 0.09148252755403519, 0.09144487231969833, 0.0916718989610672, 0.09102886915206909, 0.09159645438194275, 0.0857236459851265, 0.09155973792076111, 0.09115982055664062], [0.0946773961186409, 0.09234385937452316, 0.09420953691005707, 0.0939764752984047, 0.09374399483203888, 0.09515301138162613, 0.09120725840330124, 0.09468279778957367, 0.06355142593383789, 0.09445469826459885, 0.09199953079223633], [0.09198658168315887, 0.09138312935829163, 0.09186647832393646, 0.09180648624897003, 0.09174653142690659, 0.09210822731256485, 0.09108513593673706, 0.0919879674911499, 0.08280686289072037, 0.09192946553230286, 0.09129314124584198], [0.10828368365764618, 0.08843713253736496, 0.10401811450719833, 0.10194875299930573, 0.09992057085037231, 0.11277639865875244, 0.07998333871364594, 0.10833384096622467, 0.004266543313860893, 0.10623449832201004, 0.08579708635807037], [0.09217387437820435, 0.09146074205636978, 0.09203187376260757, 0.09196095168590546, 0.09189008921384811, 0.09231773018836975, 0.09110888838768005, 0.09217551350593567, 0.08141952753067017, 0.09210633486509323, 0.09135445952415466], [0.09409387409687042, 0.09216552972793579, 0.09370790421962738, 0.09351552277803421, 0.09332352876663208, 0.09448590129613876, 0.09122329950332642, 0.09409832954406738, 0.06759560853242874, 0.09391018748283386, 0.09188029170036316]], [[0.09073501825332642, 0.09036818146705627, 0.0914134606719017, 0.09147496521472931, 0.09055071324110031, 0.09061163663864136, 0.09012080729007721, 0.0907336100935936, 0.09178311377763748, 0.09184487164020538, 0.09036359935998917], [0.09054295718669891, 0.08978263288736343, 0.0919579267501831, 0.09208676218986511, 0.0901605412364006, 0.09028685837984085, 0.08927179872989655, 0.09054004400968552, 0.09273368865251541, 0.09286361187696457, 0.08977315574884415], [0.09107792377471924, 0.09144353121519089, 0.09040944278240204, 0.09034932404756546, 0.09126124531030655, 0.0912005603313446, 0.0916917473077774, 0.09107932448387146, 0.09004934877157211, 0.08998946845531464, 0.09144812077283859], [0.09110822528600693, 0.09154052287340164, 0.09031860530376434, 0.09024765342473984, 0.09132494777441025, 0.09125319868326187, 0.09183419495820999, 0.09110987186431885, 0.08989370614290237, 0.08982308954000473, 0.0915459468960762], [0.09063911437988281, 0.09007435292005539, 0.09168688207864761, 0.09178207814693451, 0.09035521000623703, 0.0904490277171135, 0.08969420939683914, 0.09063694626092911, 0.09225954860448837, 0.09235534071922302, 0.0900673046708107], [0.09067094326019287, 0.09017155319452286, 0.09159646928310394, 0.09168048948049545, 0.0904199481010437, 0.09050290286540985, 0.08983521908521652, 0.09066902846097946, 0.0921017974615097, 0.09218628704547882, 0.09016532450914383], [0.09041079133749008, 0.08938616514205933, 0.09232567250728607, 0.09250055253505707, 0.08989506214857101, 0.09006533771753311, 0.08869946748018265, 0.09040684998035431, 0.0933799296617508, 0.09355679899454117, 0.08937341719865799], [0.09073429554700851, 0.0903659462928772, 0.09141554683446884, 0.09147731214761734, 0.09054923057556152, 0.09061039984226227, 0.09011755883693695, 0.0907328799366951, 0.09178674966096878, 0.09184876084327698, 0.0903613492846489], [0.09125810116529465, 0.09202525019645691, 0.0898641049861908, 0.08973929286003113, 0.0916423425078392, 0.09151506423950195, 0.09254798293113708, 0.09126102924346924, 0.08911782503128052, 0.08899405598640442, 0.09203489869832993], [0.091287761926651, 0.0921221524477005, 0.08977312594652176, 0.08963761478662491, 0.09170560538768768, 0.09156717360019684, 0.09269104897975922, 0.09129093587398529, 0.0889631137251854, 0.08882882446050644, 0.09213264286518097], [0.09054053574800491, 0.08977530151605606, 0.0919647365808487, 0.09209442883729935, 0.09015564620494843, 0.09028278291225433, 0.08926119655370712, 0.09053760021924973, 0.09274562448263168, 0.09287641197443008, 0.089765764772892]], [[0.08282526582479477, 0.08516518026590347, 0.08487187325954437, 0.08457957208156586, 0.08428828418254852, 0.08605802804231644, 0.08370871841907501, 0.08818451315164566, 0.1489475816488266, 0.0851796418428421, 0.08619137108325958], [0.0853257104754448, 0.08704790472984314, 0.08683276921510696, 0.08661816269159317, 0.08640408515930176, 0.08770151436328888, 0.08597753196954727, 0.08925053477287292, 0.1299843043088913, 0.08705851435661316, 0.08779895305633545], [0.08502575010061264, 0.08682653307914734, 0.08660148084163666, 0.08637701719999313, 0.08615312725305557, 0.08751042932271957, 0.08570710569620132, 0.08913221210241318, 0.13221624493598938, 0.08683762699365616, 0.08761240541934967], [0.084723100066185, 0.08660189807415009, 0.08636699616909027, 0.08613273501396179, 0.08589910715818405, 0.08731590211391449, 0.08543375134468079, 0.08901011943817139, 0.1344805508852005, 0.0866134762763977, 0.08742239326238632], [0.08441771566867828, 0.0863739550113678, 0.08612927049398422, 0.08588527888059616, 0.08564198017120361, 0.08711788058280945, 0.08515744656324387, 0.08888418227434158, 0.13677749037742615, 0.08638601750135422, 0.08722886443138123], [0.0862162634730339, 0.08769745379686356, 0.08751266449689865, 0.08732826262712479, 0.08714424818754196, 0.08825846761465073, 0.08677738159894943, 0.0895855724811554, 0.12343109399080276, 0.0877065658569336, 0.08834204822778702], [0.08379872143268585, 0.08590804040431976, 0.08564398437738419, 0.08538074046373367, 0.08511830866336823, 0.08671125769615173, 0.08459585160017014, 0.08862066268920898, 0.14147025346755981, 0.08592106401920319, 0.08683113753795624], [0.08820770680904388, 0.08910603821277618, 0.08899430185556412, 0.08888270705938339, 0.08877124637365341, 0.08944468200206757, 0.08854875713586807, 0.09024230390787125, 0.10919573158025742, 0.08911153674125671, 0.08949506282806396], [0.11325125396251678, 0.09864670783281326, 0.10034776479005814, 0.10207813233137131, 0.10383836179971695, 0.09367772936820984, 0.10745038092136383, 0.08300438523292542, 0.006179765332490206, 0.09856373816728592, 0.09296175092458725], [0.08534041047096252, 0.08705872297286987, 0.0868440717458725, 0.0866299569606781, 0.08641636371612549, 0.08771083503961563, 0.08599076420068741, 0.08925625681877136, 0.1298752874135971, 0.08706929534673691, 0.0878080502152443], [0.08634639531373978, 0.08779139816761017, 0.08761115372180939, 0.08743128180503845, 0.08725178241729736, 0.08833853155374527, 0.08689387887716293, 0.08963245898485184, 0.12248282879590988, 0.0878002718091011, 0.08842004090547562]], [[0.09112809598445892, 0.0911683663725853, 0.0908590704202652, 0.09047213941812515, 0.0910525918006897, 0.09136456996202469, 0.09132587909698486, 0.09093695878982544, 0.09028073400259018, 0.09059006720781326, 0.09082147479057312], [0.09106303751468658, 0.09109130501747131, 0.0908740758895874, 0.09060201048851013, 0.09101001918315887, 0.09122899174690247, 0.09120184928178787, 0.09092880040407181, 0.09046729654073715, 0.09068497270345688, 0.09084765613079071], [0.0915619507431984, 0.09168299287557602, 0.09075599163770676, 0.08960511535406113, 0.09133526682853699, 0.09227430820465088, 0.09215749800205231, 0.09098885208368301, 0.0890394076704979, 0.08995484560728073, 0.0906437486410141], [0.09218325465917587, 0.09242236614227295, 0.09059896320104599, 0.08835998922586441, 0.09173630177974701, 0.0935947597026825, 0.09336259216070175, 0.09105531871318817, 0.08726950734853745, 0.08903747797012329, 0.09037940204143524], [0.09125000983476639, 0.09131284803152084, 0.09083063900470734, 0.09022868424654007, 0.09113223850727081, 0.09161920845508575, 0.09155876934528351, 0.09095198661088943, 0.08993145078420639, 0.09041200578212738, 0.0907720997929573], [0.09074554592370987, 0.090715691447258, 0.09094557166099548, 0.09123507887125015, 0.09080158174037933, 0.09057057648897171, 0.09059914946556091, 0.09088754653930664, 0.0913790911436081, 0.09114661067724228, 0.09097360074520111], [0.09080822020769119, 0.0907897800207138, 0.09093168377876282, 0.09111019968986511, 0.09084281325340271, 0.09070012718439102, 0.09071778506040573, 0.0908958837389946, 0.09119892120361328, 0.09105567634105682, 0.09094897657632828], [0.09143649786710739, 0.09153404831886292, 0.09078635275363922, 0.08985604345798492, 0.09125375002622604, 0.09201021492481232, 0.09191619604825974, 0.09097430855035782, 0.08939791470766068, 0.0901389941573143, 0.09069572389125824], [0.09248939901590347, 0.0927877351641655, 0.09051746129989624, 0.08774496614933014, 0.09193223714828491, 0.09425321966409683, 0.0939626544713974, 0.09108462929725647, 0.08640078455209732, 0.0885821133852005, 0.0902448371052742], [0.09199423342943192, 0.09219712764024734, 0.09064792096614838, 0.08873923867940903, 0.09161476790904999, 0.09319080412387848, 0.09299417585134506, 0.09103608876466751, 0.08780701458454132, 0.08931754529476166, 0.09046106785535812], [0.09162244945764542, 0.09175487607717514, 0.09074119478464127, 0.08948405086994171, 0.09137451648712158, 0.09240197390317917, 0.09227411448955536, 0.09099573642015457, 0.08886666595935822, 0.08986591547727585, 0.09061852097511292]], [[0.09204284846782684, 0.09335450828075409, 0.09172085672616959, 0.09156028926372528, 0.09286505728960037, 0.09535466134548187, 0.0925401896238327, 0.0950210839509964, 0.07053880393505096, 0.09336255490779877, 0.09163922071456909], [0.09147559106349945, 0.09205123782157898, 0.09133358299732208, 0.09126266092061996, 0.09183696657419205, 0.0929204449057579, 0.09169439226388931, 0.09277618676424026, 0.08129658550024033, 0.09205475449562073, 0.09129752963781357], [0.09216031432151794, 0.09365615993738174, 0.09179355204105377, 0.09161071479320526, 0.09309764206409454, 0.09594278037548065, 0.09272715449333191, 0.0955609679222107, 0.06808475404977798, 0.09366535395383835, 0.09170058369636536], [0.09221579134464264, 0.09380399435758591, 0.09182661771774292, 0.0916326567530632, 0.09321080893278122, 0.0962347462773323, 0.09281744062900543, 0.09582861512899399, 0.06688753515481949, 0.09381376206874847, 0.09172799438238144], [0.09170428663492203, 0.09255179017782211, 0.0914955884218216, 0.0913914144039154, 0.09223603457212448, 0.09383620321750641, 0.09202612936496735, 0.09362265467643738, 0.07713625580072403, 0.09255698323249817, 0.09144262969493866], [0.09031807631254196, 0.08982021361589432, 0.09044180810451508, 0.09050372987985611, 0.09000484645366669, 0.08907945454120636, 0.09012814611196518, 0.08920148015022278, 0.10021170228719711, 0.08981718122959137, 0.09047327190637589], [0.09184478968381882, 0.09287460148334503, 0.09159150719642639, 0.09146513044834137, 0.09249068051576614, 0.09443909674882889, 0.09223562479019165, 0.09417866170406342, 0.07447171211242676, 0.09288091212511063, 0.09152726083993912], [0.09053689986467361, 0.09021364152431488, 0.09061713516712189, 0.09065727889537811, 0.09033359587192535, 0.08973150700330734, 0.0904136523604393, 0.08981103450059891, 0.09683609753847122, 0.09021167457103729, 0.09063752740621567], [0.0879850685596466, 0.10348638892173767, 0.08451911807060242, 0.08283767849206924, 0.09743212163448334, 0.13196738064289093, 0.0935940220952034, 0.12676885724067688, 0.004160303622484207, 0.10358878970146179, 0.08366036415100098], [0.09147166460752487, 0.09204286336898804, 0.09133074432611465, 0.09126036614179611, 0.09183025360107422, 0.09290531277656555, 0.09168878197669983, 0.09276218712329865, 0.08136651664972305, 0.092046357691288, 0.09129497408866882], [0.09218878298997879, 0.09373154491186142, 0.09181062877178192, 0.09162213653326035, 0.09315542131662369, 0.09609133750200272, 0.09277330338954926, 0.09569717943668365, 0.06747385114431381, 0.0937410295009613, 0.0917147845029831]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_duration_sec_mean": 0.005255398735171184, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.894548757295571e-06, "listify_data_for_vector_env": 1.032933827490872e-05, "un_batch_to_individual_items": 6.489454641861027e-06, "tensor_to_numpy": 1.489249518726869e-05, "remove_single_ts_time_rank_from_batch": 1.1849189830573447e-05, "get_actions": 3.528871649875827e-05}}, "connector_pipeline_timer": 0.0001132801698140032}, "env_to_module_connector": {"connector_pipeline_timer": 5.818865261004794e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.7217295050090685e-06, "numpy_to_tensor": 1.1839234478669194e-05, "add_states_from_episodes_to_batch": 2.6627787940866367e-06, "add_observations_from_episodes_to_batch": 2.7761356303803337e-06, "batch_individual_items": 1.2148564777420418e-05}}}, "env_step_timer": 1.3627523931455619e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 0.75, "episode_return_max": 14.5, "module_episode_returns_mean": {"default_policy": 0.75}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 0.75}, "num_env_steps_sampled": 400, "episode_len_max": 20, "weights_seq_no": 10.0, "num_episodes": 20, "num_env_steps_sampled_lifetime": 50400, "env_reset_timer": 0.0006355492026025626, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -14.5, "episode_len_mean": 20.0, "num_episodes_lifetime": 200, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 3.066211962952264e-05, "sample": 0.13037700026706264, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "time_between_sampling": 9.95508351338537}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "ba9e8_00000", "date": "2025-08-11_18-09-35", "timestamp": 1754928575, "time_this_iter_s": 11.71717619895935, "time_total_s": 102.3306736946106, "pid": 10327, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3858fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 102.3306736946106, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 45.05882352941177, "ram_util_percent": 81.69411764705882}}
{"timers": {"training_iteration": 9.46638138041607, "restore_env_runners": 1.865778035142259e-05, "training_step": 9.466148199388003, "env_runner_sampling_timer": 1.7695971308863634, "learner_update_timer": 7.5112943346614935, "synch_weights": 0.001477770914973656, "restore_eval_env_runners": 5.3996013706317795e-05, "evaluation_iteration": 0.14331044016226704, "synch_eval_env_connectors": 0.00019403135832653728, "synch_env_connectors": 6.918918031993851e-06}, "env_runners": {"env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": -1.1800000000000002}, "rlmodule_inference_timer": 3.416494912301629e-05, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.625291157637621e-05, "get_actions": 4.2788186129282286e-05, "listify_data_for_vector_env": 1.1152174497884293e-05, "un_batch_to_individual_items": 6.913861073300825e-06, "remove_single_ts_time_rank_from_batch": 1.2602112982147757e-05, "normalize_and_clip_actions": 8.436986309227505e-06}}, "connector_pipeline_timer": 0.0001258344252427039}, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.3267025835479715e-05, "add_states_from_episodes_to_batch": 2.828012151498292e-06, "add_time_dim_to_batch_and_zero_pad": 7.742433870137088e-06, "add_observations_from_episodes_to_batch": 3.0386381994266642e-06, "numpy_to_tensor": 1.3584696973535568e-05}}, "connector_pipeline_timer": 6.36210682486593e-05}, "sample": 0.005822906428073083, "episode_duration_sec_mean": 0.00566706965211779, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "agent_episode_returns_mean": {"default_agent": -1.1800000000000002}, "weights_seq_no": 10.0, "episode_return_mean": -1.1800000000000002, "env_step_timer": 1.5100115066688416e-05, "episode_return_max": 8.5, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -5547500.0, "env_reset_timer": 4.594730983993307e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "time_between_sampling": 0.04078788403343469, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "episode_return_min": -11.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -277375.0, "num_env_steps_sampled_lifetime_throughput": 3098.991807635094}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.14233289267464672, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00997037111657716, "add_observations_from_episodes_to_batch": 0.0010337048713454824, "add_columns_from_episodes_to_train_batch": 0.04473644083313607, "add_time_dim_to_batch_and_zero_pad": 0.07817425963766718, "add_states_from_episodes_to_batch": 0.003795486867058024, "batch_individual_items": 0.004330560674365943, "numpy_to_tensor": 8.968544553915852e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.358304500579834, "module_train_batch_size_mean": 997.7563503102639, "num_module_steps_trained": 5985, "policy_loss": -0.00013668394240085036, "use_intrinsic_rewards": 0.0, "num_module_steps_trained_lifetime": 65835, "total_loss": 0.2779380679130554, "weights_seq_no": 11.0, "entropy": 0.6886908411979675, "mean_kl_loss": 2.3811962819308974e-05, "vf_loss_unclipped": 43.91696548461914, "num_trainable_parameters": 16595, "curr_kl_coeff": 7.889840344432741e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.00028967857360839844, "num_module_steps_trained_lifetime_throughput": 773.153790567599}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 790020, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 2178000, "num_env_steps_trained_lifetime_throughput": 51053.776666555284}, "default_policy": {"num_module_steps_trained_lifetime": 395010, "weights_seq_no": 66.0, "diff_num_grad_updates_vs_sampler_policy": 56.0, "entropy": 0.6886971592903137, "mean_kl_loss": 2.3315638827625662e-05, "vf_loss_unclipped": 43.803428649902344, "vf_explained_var": 0.0016777515411376953, "num_module_steps_trained": 35910, "use_intrinsic_rewards": 1.0, "vf_loss": 0.3584365248680115, "module_train_batch_size_mean": 997.5068778348534, "total_loss": 0.27804625034332275, "policy_loss": -0.00013507957919500768}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.5068778348534, "num_module_steps_trained_lifetime": 395010, "total_loss": 0.0, "weights_seq_no": 66.0, "diff_num_grad_updates_vs_sampler_policy": 56.0}}}, "intrinsic_reward_module": {"weights_seq_no": 11.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.7563503102639, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5985, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 65835, "num_module_steps_trained_lifetime_throughput": 773.1659641454825}, "__all_modules__": {"num_env_steps_trained": 33000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 131670, "num_env_steps_trained_lifetime": 363000, "num_env_steps_trained_lifetime_throughput": 4264.393222909787, "num_module_steps_trained_throughput": 22131815.134264436, "num_module_steps_trained_lifetime_throughput": 13938498.689297717}, "IntrinsicAttentionMask": [[[0.09109585732221603, 0.09148712456226349, 0.09082692861557007, 0.09044013172388077, 0.09137094020843506, 0.09098183363676071, 0.0912935733795166, 0.09125491231679916, 0.09024879336357117, 0.09021057933568954, 0.09078934788703918], [0.09055252373218536, 0.08982376009225845, 0.09105868637561798, 0.09179431200027466, 0.0900392234325409, 0.09076660871505737, 0.09018314629793167, 0.09025519341230392, 0.09216157346963882, 0.09223520010709763, 0.09112975746393204], [0.09146270155906677, 0.09264248609542847, 0.09065761417150497, 0.08950798213481903, 0.09229111671447754, 0.09112077206373215, 0.09205760806798935, 0.09194107353687286, 0.08894290030002594, 0.08883030712604523, 0.09054549783468246], [0.09198060631752014, 0.09432139992713928, 0.09039979428052902, 0.08816574513912201, 0.09362123906612396, 0.09130757302045822, 0.09315735101699829, 0.0929262712597847, 0.08707765489816666, 0.08686166256666183, 0.09018070995807648], [0.09071502834558487, 0.09031549841165543, 0.09099167585372925, 0.09139247983694077, 0.090433768928051, 0.09083212167024612, 0.0905127078294754, 0.0905522033572197, 0.09159203618764877, 0.09163200110197067, 0.09103045612573624], [0.09125205874443054, 0.09197578579187393, 0.0907561331987381, 0.0900450274348259, 0.09176061302423477, 0.09104163944721222, 0.09161744266748428, 0.0915459468960762, 0.08969420194625854, 0.08962420374155045, 0.09068693220615387], [0.0908227190375328, 0.0906440019607544, 0.09094620496034622, 0.0911247506737709, 0.09069695323705673, 0.09087501466274261, 0.09073226898908615, 0.09074993431568146, 0.09121347963809967, 0.09123124182224274, 0.09096349775791168], [0.09087634831666946, 0.0908084437251091, 0.09092321991920471, 0.09099091589450836, 0.09082856774330139, 0.09089619666337967, 0.09084199368953705, 0.09084869921207428, 0.09102454036474228, 0.0910312607884407, 0.0909297838807106], [0.09223248064517975, 0.09515941143035889, 0.09026602655649185, 0.08750122785568237, 0.09428205341100693, 0.09139424562454224, 0.09370164573192596, 0.09341277927160263, 0.08616077899932861, 0.08589515835046768, 0.0899941548705101], [0.09228245168924332, 0.09532740712165833, 0.09023882448673248, 0.08736846596002579, 0.09441428631544113, 0.09141111373901367, 0.09381039440631866, 0.09350990504026413, 0.08597811311483383, 0.08570270985364914, 0.08995641767978668], [0.09151351451873779, 0.09280470013618469, 0.09063330292701721, 0.08937764912843704, 0.09241998940706253, 0.09113958477973938, 0.09216440469026566, 0.09203687310218811, 0.08876100182533264, 0.08863818645477295, 0.0905107781291008]], [[0.09204073250293732, 0.09143436700105667, 0.09137440472841263, 0.09185976535081863, 0.0912545919418335, 0.09271332621574402, 0.0911349356174469, 0.09204212576150894, 0.08281852304935455, 0.09198334068059921, 0.0913439393043518], [0.09397875517606735, 0.09222189337015152, 0.09204932302236557, 0.09345217049121857, 0.09170514345169067, 0.09595277905464172, 0.09136226028203964, 0.09398281574249268, 0.06952155381441116, 0.09381154924631119, 0.09196174144744873], [0.09416037052869797, 0.09228772670030594, 0.09210391342639923, 0.0935988500714302, 0.09173736721277237, 0.09626717120409012, 0.0913722887635231, 0.09416469931602478, 0.06831496208906174, 0.09398204833269119, 0.09201063215732574], [0.0926390141248703, 0.09169332683086395, 0.09159999340772629, 0.09235641360282898, 0.09141361713409424, 0.09369201213121414, 0.09122761338949203, 0.0926411896944046, 0.0786348357796669, 0.09254935383796692, 0.09155260026454926], [0.09451806545257568, 0.09241310507059097, 0.09220676124095917, 0.09388633072376251, 0.09179544448852539, 0.09689228981733322, 0.09138596802949905, 0.09452292323112488, 0.065959632396698, 0.09431739151477814, 0.0921020656824112], [0.08965850621461868, 0.0902789831161499, 0.09034079313278198, 0.08984281122684479, 0.09046455472707748, 0.08897995948791504, 0.09058848023414612, 0.08965709060430527, 0.10009977966547012, 0.08971687406301498, 0.090372234582901], [0.09486853331327438, 0.09253028780221939, 0.0923013761639595, 0.09416620433330536, 0.09184525907039642, 0.09751265496015549, 0.09139139205217361, 0.09487394988536835, 0.0636797547340393, 0.09464538097381592, 0.09218525886535645], [0.09203606098890305, 0.09143228083848953, 0.09137257933616638, 0.09185586869716644, 0.09125327318906784, 0.09270575642585754, 0.09113413095474243, 0.09203744679689407, 0.08285140246152878, 0.09197891503572464, 0.0913422480225563], [0.10953634977340698, 0.08946023881435394, 0.08768049627542496, 0.10312815010547638, 0.08422653377056122, 0.13690350949764252, 0.0809086412191391, 0.10958707332611084, 0.004315923899412155, 0.10746344923973083, 0.08678962290287018], [0.0922323614358902, 0.09151877462863922, 0.09144825488328934, 0.09201930463314056, 0.09130736440420151, 0.093024842441082, 0.09116670489311218, 0.09223399311304092, 0.08147120475769043, 0.0921647846698761, 0.09141243249177933], [0.09425195306539536, 0.09232037514448166, 0.09213083237409592, 0.09367263317108154, 0.09175292402505875, 0.09642647206783295, 0.09137655794620514, 0.09425641596317291, 0.06770919263362885, 0.09406796842813492, 0.09203465282917023]], [[0.0910646840929985, 0.09110492467880249, 0.0907958522439003, 0.09075739979743958, 0.09133967757225037, 0.09095069766044617, 0.0912623330950737, 0.09087368845939636, 0.09056539088487625, 0.09052703529596329, 0.09075828641653061], [0.09101846069097519, 0.09104671329259872, 0.09082959592342377, 0.09080256521701813, 0.0912114754319191, 0.09093839675188065, 0.09115719795227051, 0.09088429063558578, 0.09066756069660187, 0.0906405821442604, 0.09080319106578827], [0.09137310087680817, 0.09149389714002609, 0.09056880325078964, 0.09045415371656418, 0.09220070391893387, 0.0910315066576004, 0.09196742624044418, 0.0908011868596077, 0.08988308906555176, 0.08976931869983673, 0.09045679867267609], [0.09141714870929718, 0.09154953062534332, 0.09053610265254974, 0.09041057527065277, 0.09232449531555176, 0.09104286134243011, 0.09206866472959518, 0.09079058468341827, 0.08978554606437683, 0.08966106176376343, 0.09041346609592438], [0.09074839949607849, 0.09070711582899094, 0.09102513641119003, 0.09106485545635223, 0.09046703577041626, 0.09086553007364273, 0.09054599702358246, 0.09094484150409698, 0.09126369655132294, 0.0913035199046135, 0.09106393903493881], [0.09119556099176407, 0.091269850730896, 0.0906999334692955, 0.09062915295362473, 0.09170379489660263, 0.0909852683544159, 0.0915607139468193, 0.0908433049917221, 0.09027605503797531, 0.0902056023478508, 0.09063077718019485], [0.09083743393421173, 0.09081899374723434, 0.09096094220876694, 0.09097865223884583, 0.09071165323257446, 0.09088973701000214, 0.09074697643518448, 0.09092512726783752, 0.09106723964214325, 0.09108497202396393, 0.090978242456913], [0.0912838876247406, 0.09138127416372299, 0.09063483029603958, 0.09054221957921982, 0.09195060282945633, 0.09100835770368576, 0.09176278859376907, 0.09082247316837311, 0.09008059650659561, 0.08998855203390121, 0.09054435044527054], [0.09163680672645569, 0.09182734042406082, 0.09037189185619354, 0.09019210189580917, 0.09294505417346954, 0.09109880030155182, 0.09257560968399048, 0.09073669463396072, 0.08929852396249771, 0.08912087976932526, 0.09019623696804047], [0.09168063849210739, 0.09188283234834671, 0.09033891558647156, 0.09014829993247986, 0.09306949377059937, 0.09110981971025467, 0.09267716854810715, 0.09072575718164444, 0.08920127898454666, 0.08901306241750717, 0.09015268832445145], [0.0914161279797554, 0.09154824912548065, 0.09053684771060944, 0.09041156619787216, 0.09232163429260254, 0.09104260057210922, 0.09206631779670715, 0.09079081565141678, 0.08978778123855591, 0.0896635428071022, 0.09041444957256317]], [[0.0881885215640068, 0.0879811942577362, 0.08591928333044052, 0.08571729063987732, 0.08551577478647232, 0.09052260220050812, 0.08511415868997574, 0.09009747207164764, 0.12610888481140137, 0.0861317366361618, 0.08870309591293335], [0.08801789581775665, 0.08780036866664886, 0.08563841134309769, 0.08542676270008087, 0.08521562814712524, 0.09046865254640579, 0.08479493856430054, 0.09002203494310379, 0.12819638848304749, 0.08586104214191437, 0.0885579064488411], [0.08611369878053665, 0.08579640835523605, 0.08266397565603256, 0.08235938847064972, 0.08205591887235641, 0.08971502631902695, 0.08145233988761902, 0.08905509859323502, 0.15090034902095795, 0.08298476785421371, 0.08690305799245834], [0.0859057679772377, 0.08557888865470886, 0.08235412836074829, 0.08204076439142227, 0.08172859996557236, 0.08961844444274902, 0.08110782504081726, 0.08893775194883347, 0.15332448482513428, 0.08268419653177261, 0.0867190882563591], [0.085694320499897, 0.08535794913768768, 0.08204159885644913, 0.08171956986188889, 0.08139879256486893, 0.08951778709888458, 0.08076100796461105, 0.08881639689207077, 0.15578027069568634, 0.08238085359334946, 0.08653148263692856], [0.08987335860729218, 0.08978234231472015, 0.08887047320604324, 0.088780477643013, 0.08869057148694992, 0.09088967740535736, 0.08851103484630585, 0.09070568531751633, 0.10483264923095703, 0.08896499872207642, 0.09009871631860733], [0.0852607935667038, 0.08490560203790665, 0.08140844851732254, 0.08106931298971176, 0.0807315781712532, 0.08930402249097824, 0.08006034046411514, 0.08856151252985, 0.1607874631881714, 0.0817658081650734, 0.08614514023065567], [0.08959714323282242, 0.0894847884774208, 0.08836062252521515, 0.0882498249411583, 0.08813915401697159, 0.09085360914468765, 0.0879182443022728, 0.09062588959932327, 0.10841820389032364, 0.08847703039646149, 0.0898754745721817], [0.09213516861200333, 0.09362124651670456, 0.1099989041686058, 0.11177311092615128, 0.11357595026493073, 0.07714404165744781, 0.11726931482553482, 0.07965268194675446, 0.008099682629108429, 0.10816764086484909, 0.08856230974197388], [0.08632811158895493, 0.08602091670036316, 0.08298619836568832, 0.08269089460372925, 0.08239664882421494, 0.08981198817491531, 0.08181127905845642, 0.08917395770549774, 0.14839069545269012, 0.08329716324806213, 0.08709214627742767], [0.08859657496213913, 0.08841468393802643, 0.08660273253917694, 0.08642493188381195, 0.08624749630689621, 0.09064062684774399, 0.08589371293783188, 0.0902688130736351, 0.12107300758361816, 0.08678967505693436, 0.08904779702425003]], [[0.0907856673002243, 0.08986837416887283, 0.09090787172317505, 0.0909690409898758, 0.09060125797986984, 0.09066221863031387, 0.09072321653366089, 0.09078425914049149, 0.09183435142040253, 0.09189613908529282, 0.09096763283014297], [0.09043610095977783, 0.08709100633859634, 0.09088874608278275, 0.09111590683460236, 0.08975621312856674, 0.08998054265975952, 0.09020543843507767, 0.09043090045452118, 0.09437428414821625, 0.09461016207933426, 0.09111066907644272], [0.09083032608032227, 0.09024113416671753, 0.09090866148471832, 0.09094785898923874, 0.0907120481133461, 0.09075115621089935, 0.0907902866601944, 0.09082942456007004, 0.09150131046772003, 0.09154076129198074, 0.09094695001840591], [0.0908525288105011, 0.0904279425740242, 0.09090891480445862, 0.09093712270259857, 0.09076735377311707, 0.09079551696777344, 0.090823695063591, 0.09085188060998917, 0.09133510291576385, 0.09136344492435455, 0.09093647450208664], [0.09071741253137589, 0.08930709958076477, 0.09090588986873627, 0.0910002738237381, 0.090433269739151, 0.09052716195583344, 0.09062115103006363, 0.09071524441242218, 0.09233924746513367, 0.09243512153625488, 0.0909980982542038], [0.09074008464813232, 0.08949247002601624, 0.09090664982795715, 0.09099004417657852, 0.09048890322446823, 0.09057191014289856, 0.09065499901771545, 0.09073816984891891, 0.09217202663421631, 0.0922565832734108, 0.09098812192678452], [0.0907626673579216, 0.08967813849449158, 0.09090730547904968, 0.09097971767187119, 0.09054446965456009, 0.09061659127473831, 0.09068877249956131, 0.09076099842786789, 0.09200501441955566, 0.09207829087972641, 0.09097804874181747], [0.09078514575958252, 0.089864082634449, 0.09090786427259445, 0.0909692794084549, 0.09059997648000717, 0.0906611829996109, 0.09072244167327881, 0.0907837301492691, 0.09183818846940994, 0.09190023690462112, 0.09096786379814148], [0.09115471690893173, 0.09308778494596481, 0.0909016877412796, 0.09077543020248413, 0.09153851866722107, 0.09141138195991516, 0.09128441661596298, 0.09115763753652573, 0.0890168622136116, 0.08889322727918625, 0.09077833592891693], [0.09117545932531357, 0.0932789221405983, 0.09090040624141693, 0.09076318889856339, 0.09159278124570847, 0.09145452827215195, 0.09131647646427155, 0.09117863327264786, 0.08885367214679718, 0.08871954679489136, 0.09076634794473648], [0.09085201472043991, 0.09042363613843918, 0.09090890735387802, 0.09093737602233887, 0.09076607972383499, 0.09079449623823166, 0.09082292765378952, 0.09085135906934738, 0.09133893251419067, 0.09136752784252167, 0.09093672037124634]], [[0.08363831043243408, 0.08335026353597641, 0.08306321501731873, 0.08540984243154526, 0.0851156935095787, 0.08966672420501709, 0.08453043550252914, 0.08905016630887985, 0.14577347040176392, 0.08336442708969116, 0.08703745901584625], [0.08334612846374512, 0.08304905891418457, 0.08275305479764938, 0.08517395704984665, 0.0848703607916832, 0.08957147598266602, 0.08426643162965775, 0.08893409371376038, 0.14811734855175018, 0.08306365460157394, 0.08685445785522461], [0.08305123448371887, 0.08274521678686142, 0.0824403315782547, 0.08493489027023315, 0.08462193608283997, 0.08947230875492096, 0.08399947732686996, 0.08881416916847229, 0.15049216151237488, 0.08276025950908661, 0.08666794747114182], [0.08535607159137726, 0.08512454479932785, 0.08489365875720978, 0.0867762416601181, 0.08654087036848068, 0.09016357362270355, 0.08607204258441925, 0.08967511355876923, 0.13218645751476288, 0.08513592183589935, 0.08807552605867386], [0.08508002758026123, 0.08483901619911194, 0.08459867537021637, 0.08655910938978195, 0.086313895881176, 0.09009125828742981, 0.08582556247711182, 0.08958154171705246, 0.1343468427658081, 0.08485085517168045, 0.08791323006153107], [0.08897843211889267, 0.08888833224773407, 0.08879831433296204, 0.08952783793210983, 0.08943717926740646, 0.09081587940454483, 0.08925612270832062, 0.09063203632831573, 0.10474753379821777, 0.08889276534318924, 0.09002555906772614], [0.08452008664608002, 0.08426029235124588, 0.08400131016969681, 0.08611572533845901, 0.0858510285615921, 0.0899355560541153, 0.08532407879829407, 0.08938352763652802, 0.13875682651996613, 0.08427306264638901, 0.08757860213518143], [0.088494211435318, 0.08838324248790741, 0.08827240765094757, 0.089171402156353, 0.08905958384275436, 0.0907629057765007, 0.08883637189865112, 0.09053541719913483, 0.10830998420715332, 0.08838870376348495, 0.08978574723005295], [0.10840758681297302, 0.11015612632036209, 0.11193287372589111, 0.09836523979902267, 0.09995180368423462, 0.07850033789873123, 0.10320213437080383, 0.08105307817459106, 0.008242064155638218, 0.1100694015622139, 0.0901193618774414], [0.08336058259010315, 0.08306395262479782, 0.08276838064193726, 0.08518564701080322, 0.08488252013921738, 0.08957626670598984, 0.08427949994802475, 0.08893989771604538, 0.1480012685060501, 0.083078533411026, 0.08686354756355286], [0.08682077378034592, 0.08664251863956451, 0.08646464347839355, 0.08791161328554153, 0.08773112297058105, 0.09049609303474426, 0.08737125992774963, 0.09012489020824432, 0.12087998539209366, 0.08665129542350769, 0.08890579640865326]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_duration_sec_mean": 0.005268489976879209, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.048348060411356e-06, "listify_data_for_vector_env": 1.0510840531724211e-05, "un_batch_to_individual_items": 6.567103477601626e-06, "tensor_to_numpy": 1.5151866275014239e-05, "remove_single_ts_time_rank_from_batch": 1.1987614167701053e-05, "get_actions": 3.645644593308766e-05}}, "connector_pipeline_timer": 0.00011535554589985141}, "env_to_module_connector": {"connector_pipeline_timer": 5.9588947475219924e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.835097823517824e-06, "numpy_to_tensor": 1.2237549627988648e-05, "add_states_from_episodes_to_batch": 2.753455456883948e-06, "add_observations_from_episodes_to_batch": 2.7924030305025403e-06, "batch_individual_items": 1.2609912252945858e-05}}}, "env_step_timer": 1.4127145203013452e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.15, "episode_return_max": 14.5, "module_episode_returns_mean": {"default_policy": 1.15}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 1.15}, "num_env_steps_sampled": 400, "episode_len_max": 20, "weights_seq_no": 11.0, "num_episodes": 20, "num_env_steps_sampled_lifetime": 55400, "env_reset_timer": 0.0006304895400011715, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -14.5, "episode_len_mean": 20.0, "num_episodes_lifetime": 220, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 3.149907004031361e-05, "sample": 0.1302538898551467, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "time_between_sampling": 9.947766646161803}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "ba9e8_00000", "date": "2025-08-11_18-09-44", "timestamp": 1754928584, "time_this_iter_s": 9.318540096282959, "time_total_s": 111.64921379089355, "pid": 10327, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3858fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 111.64921379089355, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 41.70769230769231, "ram_util_percent": 80.35384615384616}}
{"timers": {"training_iteration": 9.471903364941676, "restore_env_runners": 1.853578161938542e-05, "training_step": 9.47166968447416, "env_runner_sampling_timer": 1.770073866246929, "learner_update_timer": 7.516292483815034, "synch_weights": 0.0014786202957117768, "restore_eval_env_runners": 5.388813369282815e-05, "evaluation_iteration": 0.14312495242119275, "synch_eval_env_connectors": 0.00019347313559307382, "synch_env_connectors": 6.89555923557074e-06}, "env_runners": {"env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": -0.3}, "rlmodule_inference_timer": 6.488846391503432e-05, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.6782475029508885e-05, "get_actions": 4.397339645496899e-05, "listify_data_for_vector_env": 1.1515865315154451e-05, "un_batch_to_individual_items": 7.002138359051237e-06, "remove_single_ts_time_rank_from_batch": 1.2655292108930721e-05, "normalize_and_clip_actions": 8.645016415784086e-06}}, "connector_pipeline_timer": 0.00012895768600268022}, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.3426517987922825e-05, "add_states_from_episodes_to_batch": 2.928869080634138e-06, "add_time_dim_to_batch_and_zero_pad": 7.662011816265572e-06, "add_observations_from_episodes_to_batch": 3.0603610256085706e-06, "numpy_to_tensor": 1.3786137630564541e-05}}, "connector_pipeline_timer": 6.426616253863255e-05}, "sample": 0.006680980827157027, "episode_duration_sec_mean": 0.0062768294769339275, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "agent_episode_returns_mean": {"default_agent": -0.3}, "weights_seq_no": 11.0, "episode_return_mean": -0.3, "env_step_timer": 1.5394895541418737e-05, "episode_return_max": 8.5, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -6165000.0, "env_reset_timer": 5.3671948732913155e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "time_between_sampling": 0.03207019234342015, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "episode_return_min": -11.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -308250.0, "num_env_steps_sampled_lifetime_throughput": 2957.6340137887782}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.14231001874801208, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009969791155526202, "add_observations_from_episodes_to_batch": 0.00103554323198816, "add_columns_from_episodes_to_train_batch": 0.04471431767441817, "add_time_dim_to_batch_and_zero_pad": 0.0781725491204917, "add_states_from_episodes_to_batch": 0.0037966128384572446, "batch_individual_items": 0.004329915067657823, "numpy_to_tensor": 8.945651002291036e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.35830560326576233, "module_train_batch_size_mean": 997.7412016936058, "num_module_steps_trained": 5985, "policy_loss": -0.0004714753886219114, "use_intrinsic_rewards": 0.0, "num_module_steps_trained_lifetime": 71820, "total_loss": 0.2776053845882416, "weights_seq_no": 12.0, "entropy": 0.6878936886787415, "mean_kl_loss": 3.742024637176655e-05, "vf_loss_unclipped": 44.72172164916992, "num_trainable_parameters": 16595, "curr_kl_coeff": 3.944920172216371e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.00041961669921875, "num_module_steps_trained_lifetime_throughput": 768.9234944064478}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 861840, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 2376000, "num_env_steps_trained_lifetime_throughput": 50133.62965983448}, "default_policy": {"num_module_steps_trained_lifetime": 430920, "weights_seq_no": 72.0, "diff_num_grad_updates_vs_sampler_policy": 61.0, "entropy": 0.6879245638847351, "mean_kl_loss": 3.484134140308015e-05, "vf_loss_unclipped": 44.634525299072266, "vf_explained_var": 0.001754462718963623, "num_module_steps_trained": 35910, "use_intrinsic_rewards": 1.0, "vf_loss": 0.3584274351596832, "module_train_batch_size_mean": 997.504027034245, "total_loss": 0.27772361040115356, "policy_loss": -0.00045375703484751284}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.504027034245, "num_module_steps_trained_lifetime": 430920, "total_loss": 0.0, "weights_seq_no": 72.0, "diff_num_grad_updates_vs_sampler_policy": 61.0}}}, "intrinsic_reward_module": {"weights_seq_no": 12.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.7412016936058, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5985, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 71820, "num_module_steps_trained_lifetime_throughput": 768.9350080804546}, "__all_modules__": {"num_env_steps_trained": 33000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 143640, "num_env_steps_trained_lifetime": 396000, "num_env_steps_trained_lifetime_throughput": 4241.010432025567, "num_module_steps_trained_throughput": 21602472.92995285, "num_module_steps_trained_lifetime_throughput": 13838385.08279004}, "IntrinsicAttentionMask": [[[0.09073614329099655, 0.09036929905414581, 0.09141458570957184, 0.09147609770298004, 0.09055183082818985, 0.09061276167631149, 0.09067372977733612, 0.09073473513126373, 0.09122569113969803, 0.09128707647323608, 0.09091800451278687], [0.0905478373169899, 0.08978746831417084, 0.09196288138628006, 0.09209172427654266, 0.0901653915643692, 0.09029172360897064, 0.09041823446750641, 0.0905449166893959, 0.0915677472949028, 0.09169604629278183, 0.09092602878808975], [0.09107902646064758, 0.09144464135169983, 0.09041053801774979, 0.09035041928291321, 0.0912623479962349, 0.09120167046785355, 0.09114102274179459, 0.0910804271697998, 0.09059567004442215, 0.09053542464971542, 0.09089885652065277], [0.0911097601056099, 0.0915420725941658, 0.09032014012336731, 0.09024918079376221, 0.09132649004459381, 0.09125474095344543, 0.09118305146694183, 0.09111141413450241, 0.09053871035575867, 0.09046758711338043, 0.0908968448638916], [0.09064178913831711, 0.09007701277732849, 0.0916895940899849, 0.09178479015827179, 0.09035787731409073, 0.0904516950249672, 0.09054560959339142, 0.090639628469944, 0.09139742702245712, 0.09149232506752014, 0.09092224389314651], [0.0906730368733406, 0.0901736319065094, 0.09159857779741287, 0.09168260544538498, 0.09042203426361084, 0.09050498902797699, 0.09058801084756851, 0.0906711220741272, 0.09134063124656677, 0.09142442792654037, 0.09092088788747787], [0.09070424735546112, 0.09027032554149628, 0.09150761365890503, 0.09158049523830414, 0.09048619121313095, 0.09055826812982559, 0.09063039720058441, 0.090702585875988, 0.09128382802009583, 0.09135653078556061, 0.09091948717832565], [0.09073542058467865, 0.09036707133054733, 0.09141669422388077, 0.09147845208644867, 0.09055035561323166, 0.0906115397810936, 0.09067275375127792, 0.09073401242494583, 0.09122700989246368, 0.09128864109516144, 0.09091804176568985], [0.09098424762487411, 0.09114532917737961, 0.0906887874007225, 0.0906621590256691, 0.09106506407260895, 0.09103832393884659, 0.09101158380508423, 0.09098486602306366, 0.09077073633670807, 0.09074408560991287, 0.09090473502874374], [0.09101510792970657, 0.09124259650707245, 0.09059827029705048, 0.09056072682142258, 0.09112921357154846, 0.09109145402908325, 0.09105370938777924, 0.09101597219705582, 0.09071382135152817, 0.09067623317241669, 0.09090287983417511], [0.09082873910665512, 0.09065764397382736, 0.09114418178796768, 0.0911727175116539, 0.09074282646179199, 0.09077123552560806, 0.09079965204000473, 0.09082808345556259, 0.09105648100376129, 0.09108498692512512, 0.09091342240571976]], [[0.08802522718906403, 0.08781827986240387, 0.08761182427406311, 0.08555856347084045, 0.0853574275970459, 0.09035499393939972, 0.08495654165744781, 0.08993063867092133, 0.12587542831897736, 0.08597223460674286, 0.08853884041309357], [0.0878470316529274, 0.08762992173433304, 0.08741334825754166, 0.08526092022657394, 0.08505020290613174, 0.0902930349111557, 0.0846303254365921, 0.08984728157520294, 0.127947598695755, 0.08569436520338058, 0.08838599920272827], [0.08766568452119827, 0.08743845671415329, 0.08721182495355606, 0.08496090769767761, 0.08474069088697433, 0.09022750705480576, 0.08430197089910507, 0.08976039290428162, 0.13004866242408752, 0.08541396260261536, 0.08822987973690033], [0.08565743267536163, 0.0853314995765686, 0.08500681817531586, 0.08180360496044159, 0.0814923420548439, 0.08935938030481339, 0.08087336272001266, 0.08868064731359482, 0.15288135409355164, 0.0824451744556427, 0.0864684134721756], [0.08543959259986877, 0.08510421216487885, 0.08477015048265457, 0.08147663623094559, 0.08115681260824203, 0.08925169706344604, 0.08052092790603638, 0.08855238556861877, 0.15531732141971588, 0.08213596791028976, 0.08627426624298096], [0.08979964256286621, 0.08970870822668076, 0.08961786329746246, 0.08870766311883926, 0.08861783146858215, 0.09081513434648514, 0.08843843638896942, 0.09063129127025604, 0.10474667698144913, 0.08889203518629074, 0.09002482146024704], [0.08499360829591751, 0.0846395343542099, 0.08428693562746048, 0.08081525564193726, 0.08047859370708466, 0.08902417123317719, 0.07980944961309433, 0.08828398585319519, 0.16028372943401337, 0.08150957524776459, 0.08587519079446793], [0.08950657397508621, 0.08939433097839355, 0.08928223699331284, 0.08816060423851013, 0.08805005997419357, 0.09076175838708878, 0.08782936632633209, 0.0905342698097229, 0.10830861330032349, 0.08838758617639542, 0.08978461474180222], [0.09352567046880722, 0.0950341746211052, 0.09656701982021332, 0.113460011780262, 0.11529006063938141, 0.07830826193094254, 0.11903916299343109, 0.08085476607084274, 0.00822188425809145, 0.10980010777711868, 0.08989886939525604], [0.08609318733215332, 0.085786834359169, 0.08548156917095184, 0.08246586471796036, 0.08217241615056992, 0.08956758677959442, 0.08158865571022034, 0.08893128484487534, 0.14798694849014282, 0.08307047933340073, 0.08685513585805893], [0.08845235407352448, 0.08827076107263565, 0.08808954060077667, 0.08628424257040024, 0.08610710501670837, 0.09049307554960251, 0.08575389534235, 0.09012188017368317, 0.12087596207857132, 0.08664839714765549, 0.08890283852815628]], [[0.09112793207168579, 0.09151934087276459, 0.0905103087425232, 0.09047198295593262, 0.09105242788791656, 0.09101387113332748, 0.09132572263479233, 0.09093679487705231, 0.09028057008981705, 0.09058991074562073, 0.09117111563682556], [0.09049373865127563, 0.08976545184850693, 0.0916614904999733, 0.09173472225666046, 0.0906352698802948, 0.0907076820731163, 0.09012459963560104, 0.09085267782211304, 0.09210174530744553, 0.09150969982147217, 0.09041295200586319], [0.09211670607328415, 0.0943455919623375, 0.08868758380413055, 0.08847828209400177, 0.09169173985719681, 0.09147534519433975, 0.09323753416538239, 0.09104407578706741, 0.08743912726640701, 0.08912356197834015, 0.0923604667186737], [0.09217755496501923, 0.0945233702659607, 0.08857423812150955, 0.08835452049970627, 0.09173062443733215, 0.0915030837059021, 0.09335682541131973, 0.0910496935248375, 0.08726411312818527, 0.08903197199106216, 0.09243395924568176], [0.09124961495399475, 0.09186098724603653, 0.09028786420822144, 0.09022830426692963, 0.09113184362649918, 0.0910717248916626, 0.09155836701393127, 0.0909515991806984, 0.08993106335401535, 0.09041161090135574, 0.09131699800491333], [0.09131167829036713, 0.09203588217496872, 0.09017423540353775, 0.0901038646697998, 0.09117227792739868, 0.09110112488269806, 0.09167730808258057, 0.09095898270606995, 0.08975280821323395, 0.09032046794891357, 0.09139144420623779], [0.09080817550420761, 0.09062949568033218, 0.09109243005514145, 0.09111016243696213, 0.09084277600049973, 0.09086046367883682, 0.09071774035692215, 0.09089584648609161, 0.0911988839507103, 0.09105563908815384, 0.09078840911388397], [0.09143553674221039, 0.09238626807928085, 0.08994700759649277, 0.08985510468482971, 0.09125279635190964, 0.09115955233573914, 0.09191524237394333, 0.09097336232662201, 0.08939697593450546, 0.09013804793357849, 0.0915401428937912], [0.09248054027557373, 0.09541535377502441, 0.08800787478685379, 0.08773656189441681, 0.09192343801259995, 0.09164005517959595, 0.09395366162061691, 0.09107591211795807, 0.08639250695705414, 0.0885736346244812, 0.09280045330524445], [0.09199012815952301, 0.09397727996110916, 0.0889228954911232, 0.08873527497053146, 0.09161068499088287, 0.09141738712787628, 0.09299002587795258, 0.09103202819824219, 0.08780308812856674, 0.0893135517835617, 0.09220770001411438], [0.09105824679136276, 0.09132443368434906, 0.09063746780157089, 0.09061132371425629, 0.09100686013698578, 0.09098060429096222, 0.0911928042769432, 0.09092812240123749, 0.09048071503639221, 0.09069175273180008, 0.09108763188123703]], [[0.08762708306312561, 0.0855734720826149, 0.08537229150533676, 0.08517158031463623, 0.08680595457553864, 0.08994631469249725, 0.08639828115701675, 0.08952388912439346, 0.12801159918308258, 0.08743119984865189, 0.0881383866071701], [0.08543818444013596, 0.08241907507181168, 0.08212530612945557, 0.08183258771896362, 0.08422655612230301, 0.08889202773571014, 0.08362720906734467, 0.08825946599245071, 0.15183530747890472, 0.08514861762523651, 0.08619560301303864], [0.08520099520683289, 0.08209031075239182, 0.0817878395318985, 0.08148647099733353, 0.0839521735906601, 0.08876416087150574, 0.08333463966846466, 0.08811122924089432, 0.1543877124786377, 0.08490248769521713, 0.08598198741674423], [0.08496011048555374, 0.08175865560770035, 0.08144756406545639, 0.08113765716552734, 0.08367437869310379, 0.08863192796707153, 0.0830388218164444, 0.08795872330665588, 0.15697497129440308, 0.08465272188186646, 0.08576449006795883], [0.08680106699466705, 0.0843551754951477, 0.08411621302366257, 0.08387792110443115, 0.08582165837287903, 0.08957746624946594, 0.0853361040353775, 0.08907067030668259, 0.13706456124782562, 0.08656726032495499, 0.08741187304258347], [0.089639812707901, 0.0887293890118599, 0.08863953500986099, 0.08854977041482925, 0.0892772525548935, 0.09065349400043488, 0.08909653127193451, 0.09046997874975204, 0.10552612692117691, 0.08955350518226624, 0.0898645892739296], [0.08636705577373505, 0.08372935652732849, 0.08347199857234955, 0.08321543782949448, 0.08531007170677185, 0.08936885744333267, 0.08478643745183945, 0.08882030844688416, 0.14178907871246338, 0.08611463010311127, 0.08702675253152847], [0.08930618315935135, 0.08818425238132477, 0.08807367086410522, 0.08796323090791702, 0.08885907381772995, 0.09055855870246887, 0.0886363536119461, 0.09033158421516418, 0.10930377244949341, 0.08919970691204071, 0.08958359807729721], [0.09499916434288025, 0.11285748332738876, 0.11480358242988586, 0.11678323894739151, 0.10172320902347565, 0.07858014851808548, 0.1052616536617279, 0.08131356537342072, 0.006053846329450607, 0.09655600786209106, 0.09106812626123428], [0.0874357521533966, 0.08528787642717361, 0.08507759869098663, 0.08486784249544144, 0.08657663315534592, 0.08986437320709229, 0.08615023642778397, 0.08942179381847382, 0.13011620938777924, 0.08723077178001404, 0.08797089755535126], [0.08811017125844955, 0.08630445599555969, 0.08612727373838425, 0.08595044910907745, 0.08738881349563599, 0.09014299511909485, 0.08703035116195679, 0.08977323025465012, 0.12267523258924484, 0.08793816715478897, 0.08855890482664108]], [[0.09115952998399734, 0.09155107289552689, 0.09054169058799744, 0.09050334244966507, 0.09143480658531189, 0.09139608591794968, 0.09100686758756638, 0.09096832573413849, 0.09031186997890472, 0.09027362614870071, 0.09085280448198318], [0.09043321013450623, 0.08970540761947632, 0.09160018712282181, 0.0916733667254448, 0.08992058038711548, 0.08999241888523102, 0.09071943163871765, 0.09079190343618393, 0.09204014390707016, 0.0921136736869812, 0.09100968390703201], [0.09228818863630295, 0.09452123194932938, 0.08885268121957779, 0.08864299207925797, 0.09385358542203903, 0.09363208711147308, 0.09142935276031494, 0.09121356904506683, 0.0876019075512886, 0.08739516139030457, 0.09056928753852844], [0.09235749393701553, 0.09470789134502411, 0.08874714374542236, 0.08852700144052505, 0.09400486201047897, 0.09377167373895645, 0.09145428985357285, 0.09122743457555771, 0.08743445575237274, 0.08721756935119629, 0.09055023640394211], [0.09064973890781403, 0.09025049209594727, 0.09128687530755997, 0.09132670611143112, 0.09036868065595627, 0.09040811657905579, 0.09080635011196136, 0.0908459722995758, 0.09152612090110779, 0.0915660560131073, 0.09096494317054749], [0.09072169661521912, 0.09043258428573608, 0.09118233621120453, 0.09121109545230865, 0.09051820635795593, 0.09054676443338394, 0.09083499759435654, 0.0908636599779129, 0.09135507792234421, 0.09138389676809311, 0.09094969183206558], [0.09144044667482376, 0.0922783762216568, 0.09012643992900848, 0.09004522860050201, 0.0920291393995285, 0.09194621443748474, 0.0911148339509964, 0.0910327285528183, 0.08964025974273682, 0.08955948054790497, 0.09078685939311981], [0.09151116013526917, 0.09246267378330231, 0.09002139419317245, 0.08992941677570343, 0.09217953681945801, 0.0920853465795517, 0.0911417230963707, 0.09104859828948975, 0.08947090804576874, 0.08937948942184448, 0.09076978266239166], [0.0927022248506546, 0.09564407914876938, 0.08821883797645569, 0.08794687688350677, 0.09476225078105927, 0.09447012096643448, 0.09157654643058777, 0.09129423648118973, 0.08659959584474564, 0.08633263409137726, 0.09045251458883286], [0.09277082234621048, 0.09583190083503723, 0.08811307698488235, 0.08783083409070969, 0.09491394460201263, 0.09460991621017456, 0.09160051494836807, 0.09130710363388062, 0.08643311262130737, 0.08615625649690628, 0.09043248742818832], [0.09172260016202927, 0.09301673620939255, 0.08970598876476288, 0.08958186209201813, 0.09263114631175995, 0.09250297397375107, 0.09122142195701599, 0.0910952016711235, 0.08896379917860031, 0.08884070068597794, 0.09071757644414902]], [[0.08385526388883591, 0.08356647193431854, 0.085927315056324, 0.08563138544559479, 0.0827060341835022, 0.08989932388067245, 0.0821373388171196, 0.08928116410970688, 0.14615175127983093, 0.08358066529035568, 0.08726322650909424], [0.08356904983520508, 0.08327118307352066, 0.08570723980665207, 0.085401751101017, 0.08238393068313599, 0.0898110494017601, 0.08179768919944763, 0.08917196094989777, 0.14851367473602295, 0.08328581601381302, 0.0870867595076561], [0.08580098301172256, 0.08557858318090439, 0.08739108592271805, 0.08716457337141037, 0.08491486310958862, 0.09041297435760498, 0.08447524905204773, 0.08994488418102264, 0.13031604886054993, 0.08558952063322067, 0.08841122686862946], [0.08553432673215866, 0.08530232310295105, 0.08719396591186523, 0.08695746958255768, 0.08461007475852966, 0.0903518795967102, 0.08415170758962631, 0.0898624062538147, 0.13246263563632965, 0.08531372994184494, 0.08825947344303131], [0.08269335329532623, 0.08236874639987946, 0.08502685278654099, 0.08469310402870178, 0.08140258491039276, 0.08952198922634125, 0.0807647705078125, 0.08882055431604385, 0.15578781068325043, 0.08238469809293747, 0.08653552830219269], [0.08905104547739029, 0.08896087110042572, 0.08969172835350037, 0.08960089087486267, 0.0886908695101738, 0.09088999032974243, 0.08851133286952972, 0.0907059982419014, 0.10483300685882568, 0.08896530419588089, 0.0900990292429924], [0.08209528774023056, 0.08175327628850937, 0.08455631881952286, 0.0842040628194809, 0.08073580265045166, 0.0893087163567543, 0.08006452023983002, 0.08856616169214249, 0.1607961654663086, 0.08177009224891663, 0.0861496552824974], [0.0885830894112587, 0.08847200870513916, 0.08937302976846695, 0.08926095813512802, 0.0881396010518074, 0.09085406363010406, 0.08791869133710861, 0.09062634408473969, 0.10841876268386841, 0.0884774774312973, 0.08987592160701752], [0.10663522779941559, 0.10835519433021545, 0.09522119164466858, 0.09675704687833786, 0.11368332803249359, 0.07721684873104095, 0.11738018691539764, 0.07972785830497742, 0.008107240311801434, 0.10826986283063889, 0.08864595741033554], [0.08358319848775864, 0.08328577876091003, 0.08571815490722656, 0.0854131281375885, 0.08239984512329102, 0.08981548249721527, 0.08181446045637131, 0.08917742222547531, 0.14839664101600647, 0.0833004042506218, 0.08709552884101868], [0.08696058392524719, 0.0867820531129837, 0.08823433518409729, 0.08805318176746368, 0.08624863624572754, 0.09064183384180069, 0.0858948603272438, 0.0902700275182724, 0.12107469886541367, 0.08679082989692688, 0.08904898166656494]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_duration_sec_mean": 0.005280424547381699, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.09373897653624e-06, "listify_data_for_vector_env": 1.0577916011068667e-05, "un_batch_to_individual_items": 6.630060238630921e-06, "tensor_to_numpy": 1.5490769515782186e-05, "remove_single_ts_time_rank_from_batch": 1.2171216221213134e-05, "get_actions": 3.7347376588097186e-05}}, "connector_pipeline_timer": 0.00011714937088481446}, "env_to_module_connector": {"connector_pipeline_timer": 6.0195354760810886e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.937435120406954e-06, "numpy_to_tensor": 1.2166847968074672e-05, "add_states_from_episodes_to_batch": 2.7886533662247057e-06, "add_observations_from_episodes_to_batch": 2.8679166916562085e-06, "batch_individual_items": 1.2714147893146264e-05}}}, "env_step_timer": 1.425226498682622e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 0.75, "episode_return_max": 14.5, "module_episode_returns_mean": {"default_policy": 0.75}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 0.75}, "num_env_steps_sampled": 400, "episode_len_max": 20, "weights_seq_no": 12.0, "num_episodes": 20, "num_env_steps_sampled_lifetime": 60400, "env_reset_timer": 0.0006273783941816921, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -14.5, "episode_len_mean": 20.0, "num_episodes_lifetime": 240, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 3.17573127847864e-05, "sample": 0.13011255178684247, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "time_between_sampling": 9.94880958261073}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "ba9e8_00000", "date": "2025-08-11_18-09-54", "timestamp": 1754928594, "time_this_iter_s": 10.14612102508545, "time_total_s": 121.795334815979, "pid": 10327, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3858fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 121.795334815979, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 49.09285714285714, "ram_util_percent": 80.52142857142857}}
{"timers": {"training_iteration": 9.473913592542262, "restore_env_runners": 1.841292369702079e-05, "training_step": 9.473679077219646, "env_runner_sampling_timer": 1.7695001655047504, "learner_update_timer": 7.518858841056846, "synch_weights": 0.0015022057632801801, "restore_eval_env_runners": 5.372216206384844e-05, "evaluation_iteration": 0.14293915247700018, "synch_eval_env_connectors": 0.00019342173406075623, "synch_env_connectors": 6.866603947794767e-06}, "env_runners": {"env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": -0.14000000000000007}, "rlmodule_inference_timer": 3.225146462776425e-05, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5746050668823376e-05, "get_actions": 4.002135503383002e-05, "listify_data_for_vector_env": 1.0746418778499945e-05, "un_batch_to_individual_items": 6.726009441131482e-06, "remove_single_ts_time_rank_from_batch": 1.2128588442495043e-05, "normalize_and_clip_actions": 8.235891522567467e-06}}, "connector_pipeline_timer": 0.00012063783664932597}, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2773760741235004e-05, "add_states_from_episodes_to_batch": 2.808150993400681e-06, "add_time_dim_to_batch_and_zero_pad": 7.281124236209954e-06, "add_observations_from_episodes_to_batch": 2.918229292817512e-06, "numpy_to_tensor": 1.2906439385957563e-05}}, "connector_pipeline_timer": 6.115011816999356e-05}, "sample": 0.006368489874679302, "episode_duration_sec_mean": 0.005393714515026661, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "agent_episode_returns_mean": {"default_agent": -0.14000000000000007}, "weights_seq_no": 12.0, "episode_return_mean": -0.14000000000000007, "env_step_timer": 1.438393327656221e-05, "episode_return_max": 8.5, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -6782500.0, "env_reset_timer": 4.8242684817633654e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "time_between_sampling": 0.03378476144784102, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "episode_return_min": -11.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -339125.0, "num_env_steps_sampled_lifetime_throughput": 3150.947817773289}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1422304193912307, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009962639074382775, "add_observations_from_episodes_to_batch": 0.0010345952997062018, "add_columns_from_episodes_to_train_batch": 0.04467658615760389, "add_time_dim_to_batch_and_zero_pad": 0.07813791821903798, "add_states_from_episodes_to_batch": 0.00379531838045924, "batch_individual_items": 0.004333292586716706, "numpy_to_tensor": 8.919236532251101e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.35830530524253845, "module_train_batch_size_mean": 997.7269395717314, "num_module_steps_trained": 5985, "policy_loss": -2.0205032342346385e-05, "use_intrinsic_rewards": 0.0, "num_module_steps_trained_lifetime": 77805, "total_loss": 0.278057336807251, "weights_seq_no": 13.0, "entropy": 0.6873008608818054, "mean_kl_loss": 1.4812612789683044e-05, "vf_loss_unclipped": 44.30290603637695, "num_trainable_parameters": 16595, "curr_kl_coeff": 1.9724600861081854e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.0005898475646972656, "num_module_steps_trained_lifetime_throughput": 765.0463549454488}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 933660, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 2574000, "num_env_steps_trained_lifetime_throughput": 49263.29437308749}, "default_policy": {"num_module_steps_trained_lifetime": 466830, "weights_seq_no": 78.0, "diff_num_grad_updates_vs_sampler_policy": 66.0, "entropy": 0.6872988343238831, "mean_kl_loss": 1.4890832062519621e-05, "vf_loss_unclipped": 44.21989440917969, "vf_explained_var": 0.0016925930976867676, "num_module_steps_trained": 35910, "use_intrinsic_rewards": 1.0, "vf_loss": 0.3584214746952057, "module_train_batch_size_mean": 997.5020416990191, "total_loss": 0.27815115451812744, "policy_loss": -1.927648190758191e-05}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.5020416990191, "num_module_steps_trained_lifetime": 466830, "total_loss": 0.0, "weights_seq_no": 78.0, "diff_num_grad_updates_vs_sampler_policy": 66.0}}}, "intrinsic_reward_module": {"weights_seq_no": 13.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.7269395717314, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5985, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 77805, "num_module_steps_trained_lifetime_throughput": 765.0573189631006}, "__all_modules__": {"num_env_steps_trained": 33000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 155610, "num_env_steps_trained_lifetime": 429000, "num_env_steps_trained_lifetime_throughput": 4219.574469056407, "num_module_steps_trained_throughput": 21077958.355713744, "num_module_steps_trained_lifetime_throughput": 13716621.467444586}, "IntrinsicAttentionMask": [[[0.0908857136964798, 0.09051826596260071, 0.09156528115272522, 0.0910692885518074, 0.09014913439750671, 0.09020978957414627, 0.09027048945426941, 0.09033121913671494, 0.09193554520606995, 0.0919974073767662, 0.09106787294149399], [0.090855173766613, 0.09009221941232681, 0.09227502346038818, 0.09123759716749191, 0.08932913094758987, 0.0894542783498764, 0.08957961946725845, 0.08970512449741364, 0.09305346012115479, 0.09318383038043976, 0.09123464673757553], [0.0909276232123375, 0.09129262715578079, 0.09026024490594864, 0.09074635803699493, 0.09166229516267776, 0.09160134196281433, 0.09154044091701508, 0.09147956967353821, 0.08990073949098587, 0.08984096348285675, 0.09074775129556656], [0.09089888632297516, 0.09072919189929962, 0.09121175855398178, 0.09098353236913681, 0.09055833518505096, 0.09058643877506256, 0.09061454236507416, 0.09064266085624695, 0.09138170629739761, 0.0914100632071495, 0.09098287671804428], [0.09081880003213882, 0.08965899795293808, 0.09299079328775406, 0.091402068734169, 0.0885041207075119, 0.08869317919015884, 0.08888264745473862, 0.08907251805067062, 0.09418906271457672, 0.09439026564359665, 0.09139756858348846], [0.0908251702785492, 0.08973053842782974, 0.0928729847073555, 0.09137535840272903, 0.0886397585272789, 0.08881837874650955, 0.08899736404418945, 0.089176706969738, 0.09400158375501633, 0.09419101476669312, 0.09137111157178879], [0.09083137661218643, 0.08980198204517365, 0.09275516867637634, 0.09134850651025772, 0.08877545595169067, 0.08894360810518265, 0.08911208063364029, 0.0892808735370636, 0.09381432831287384, 0.09399202466011047, 0.09134452044963837], [0.09083745628595352, 0.08987334370613098, 0.09263736754655838, 0.09132151305675507, 0.08891122043132782, 0.08906887471675873, 0.08922680467367172, 0.0893850177526474, 0.09362729638814926, 0.09379331022500992, 0.09131778031587601], [0.09094265103340149, 0.09170714765787125, 0.08955346047878265, 0.09056425094604492, 0.09248480200767517, 0.09235634654760361, 0.09222807735204697, 0.09209998697042465, 0.08880976587533951, 0.08868642151355743, 0.09056714922189713], [0.09094461798667908, 0.09177587926387787, 0.08943568170070648, 0.09053339809179306, 0.0926220566034317, 0.09248224645853043, 0.09234264492988586, 0.09220325201749802, 0.08862870931625366, 0.0884949192404747, 0.09053655713796616], [0.090898796916008, 0.09072757512331009, 0.09121448546648026, 0.09098419547080994, 0.09055519104003906, 0.09058354049921036, 0.09061190485954285, 0.09064027667045593, 0.09138596802949905, 0.09141457825899124, 0.09098353981971741]], [[0.08386705815792084, 0.08357822895050049, 0.08593940734863281, 0.08564343303442001, 0.08534848690032959, 0.08714050054550171, 0.08214889466762543, 0.08929373323917389, 0.1461724191904068, 0.08359242975711823, 0.08727550506591797], [0.0835815891623497, 0.0832836776971817, 0.08572009950876236, 0.08541456609964371, 0.0851101279258728, 0.08696038275957108, 0.08180996775627136, 0.08918535709381104, 0.1485360711812973, 0.08329832553863525, 0.0870998278260231], [0.0858079120516777, 0.08558550477027893, 0.08739814162254333, 0.08717162162065506, 0.08694566786289215, 0.0883154571056366, 0.08448207378387451, 0.08995217084884644, 0.13032665848731995, 0.08559644222259521, 0.0884183794260025], [0.08554188162088394, 0.08530985563993454, 0.08720167726278305, 0.08696514368057251, 0.0867292657494545, 0.08815976232290268, 0.08415914326906204, 0.08987035602331161, 0.13247442245483398, 0.08532126247882843, 0.08826727420091629], [0.0852731466293335, 0.08503158390522003, 0.08700205385684967, 0.08675558865070343, 0.0865098163485527, 0.08800069242715836, 0.0838339701294899, 0.0897848904132843, 0.1346520036458969, 0.08504346013069153, 0.08811278641223907], [0.08685129135847092, 0.08666828274726868, 0.08815724402666092, 0.08797147870063782, 0.08778610825538635, 0.08890853822231293, 0.0857590064406395, 0.09024542570114136, 0.1219826340675354, 0.08667728304862976, 0.08899273723363876], [0.08211193233728409, 0.08176984637975693, 0.08457344770431519, 0.08422113209962845, 0.08387026935815811, 0.08600585162639618, 0.08008074760437012, 0.08858411014080048, 0.16082890331745148, 0.08178666234016418, 0.0861671194434166], [0.08858480304479599, 0.08847372233867645, 0.08937475830316544, 0.08926268666982651, 0.08915074914693832, 0.08982706069946289, 0.08792039006948471, 0.09062810242176056, 0.10842086374759674, 0.0884791910648346, 0.0898776575922966], [0.1069880798459053, 0.10871372371912003, 0.0955362543463707, 0.09707720577716827, 0.098642997443676, 0.08958013355731964, 0.11776860803365707, 0.07999163120985031, 0.008134021423757076, 0.10862810909748077, 0.08893924206495285], [0.08359571546316147, 0.08329824358224869, 0.08573098480701447, 0.08542591333389282, 0.08512193709611893, 0.08696933835744858, 0.08182670921087265, 0.0891907811164856, 0.14841894805431366, 0.08331286907196045, 0.0871085673570633], [0.08696503937244415, 0.08678649365901947, 0.08823885023593903, 0.08805768936872482, 0.08787689357995987, 0.08897144347429276, 0.08589925616979599, 0.09027464687824249, 0.12108093500137329, 0.08679527044296265, 0.08905353397130966]], [[0.09093662351369858, 0.09001780301332474, 0.09161657094955444, 0.09112030267715454, 0.09075190871953964, 0.09026031941175461, 0.09087406098842621, 0.09038181602954865, 0.09142725169658661, 0.09204893559217453, 0.09056437760591507], [0.09099239856004715, 0.08762671053409576, 0.09354320168495178, 0.09167638421058655, 0.0903083086013794, 0.0885060504078865, 0.09076030552387238, 0.08894903212785721, 0.09282781183719635, 0.09519214183092117, 0.08961766213178635], [0.0908781886100769, 0.09179545193910599, 0.0902111679315567, 0.0906970202922821, 0.09106110781431198, 0.09155154973268509, 0.09094005078077316, 0.09142983704805374, 0.09039589017629623, 0.08979211002588272, 0.0912475734949112], [0.09092225879430771, 0.09049735218286514, 0.0912352055311203, 0.09100691974163055, 0.0908370167016983, 0.09060972929000854, 0.09089339524507523, 0.09066596627235413, 0.09114820510149002, 0.0914335623383522, 0.09075038880109787], [0.09095001220703125, 0.08953606337308884, 0.09200137108564377, 0.09123359620571136, 0.09066512435674667, 0.08990850299596786, 0.0908534973859787, 0.09009530395269394, 0.0917082205414772, 0.09267212450504303, 0.09037622809410095], [0.09098031371831894, 0.08825653046369553, 0.0930316299200058, 0.09153144806623459, 0.09042829275131226, 0.08897008746862411, 0.09079311788082123, 0.08932903409004211, 0.09245742857456207, 0.09435191005468369, 0.0898701623082161], [0.09094126522541046, 0.08985460549592972, 0.0917467400431633, 0.09115874767303467, 0.09072264283895493, 0.09014121443033218, 0.09086722135543823, 0.09028486907482147, 0.09152236580848694, 0.0922594889998436, 0.09050077199935913], [0.09097354114055634, 0.0885724276304245, 0.09277614206075668, 0.09145832806825638, 0.09048762172460556, 0.08920230716466904, 0.09080880135297775, 0.08951892703771591, 0.09227205067873001, 0.0939338281750679, 0.08999595791101456], [0.09089589864015579, 0.09129984676837921, 0.09060072898864746, 0.09081585705280304, 0.09097664058208466, 0.09119265526533127, 0.09092321991920471, 0.09113910794258118, 0.09068259596824646, 0.09041466563940048, 0.09105885028839111], [0.09083366394042969, 0.09292925894260406, 0.08932656794786453, 0.09042295068502426, 0.09124944359064102, 0.09236942231655121, 0.09097416698932648, 0.09209076315164566, 0.08974253386259079, 0.08838695287704468, 0.09167435765266418], [0.0909624844789505, 0.08904751390218735, 0.09239333122968674, 0.09134785085916519, 0.09057579189538956, 0.08955088257789612, 0.09083142876625061, 0.08980362862348557, 0.0919937714934349, 0.09330925345420837, 0.09018409252166748]], [[0.08386848121881485, 0.0835796445608139, 0.08329179883003235, 0.08564489334821701, 0.0853499323129654, 0.089913509786129, 0.0847630500793457, 0.08654278516769409, 0.14617502689361572, 0.08359383791685104, 0.08727698773145676], [0.08358311653137207, 0.08328519761562347, 0.08298834413290024, 0.08541613817214966, 0.08511168509721756, 0.08982618898153305, 0.08450602740049362, 0.08634316176176071, 0.14853891730308533, 0.08329984545707703, 0.08710142970085144], [0.08329493552446365, 0.08298802375793457, 0.08268223702907562, 0.08518411964178085, 0.08487024158239365, 0.08973488211631775, 0.0842459574341774, 0.08614008128643036, 0.15093418955802917, 0.08300311863422394, 0.08692227303981781], [0.08554282039403915, 0.08531078696250916, 0.08507939428091049, 0.08696609735488892, 0.08673021197319031, 0.0903608649969101, 0.0862603485584259, 0.08768311887979507, 0.13247595727443695, 0.08532220125198364, 0.08826824277639389], [0.08527415990829468, 0.08503259718418121, 0.08479171246290207, 0.0867566168308258, 0.08651084452867508, 0.09029683470726013, 0.08602139353752136, 0.08750385791063309, 0.134653702378273, 0.08504447340965271, 0.08811384439468384], [0.08905230462551117, 0.088962122797966, 0.0888720378279686, 0.08960216492414474, 0.08951142430305481, 0.0908912792801857, 0.08933022618293762, 0.08987703919410706, 0.10483449697494507, 0.08896657079458237, 0.09010030329227448], [0.08472870290279388, 0.08446826785802841, 0.08420863747596741, 0.08632827550172806, 0.08606292307376862, 0.09015755355358124, 0.08553467690944672, 0.0871354416012764, 0.13909964263439178, 0.08448107540607452, 0.08779477328062057], [0.08633865416049957, 0.08613591641187668, 0.08593365550041199, 0.08758068084716797, 0.08737502247095108, 0.09053216129541397, 0.0869651660323143, 0.08820534497499466, 0.12607289850711823, 0.08614589273929596, 0.0887145921587944], [0.10705160349607468, 0.10877828299999237, 0.11053282022476196, 0.09713482856750488, 0.09870155900716782, 0.07751825451850891, 0.10191123932600021, 0.09254807233810425, 0.008138795383274555, 0.10869259387254715, 0.08899201452732086], [0.08359722793102264, 0.08329975605010986, 0.08300334215164185, 0.08542747050523758, 0.08512347936630249, 0.08983056247234344, 0.08451875299215317, 0.08635306358337402, 0.1484217345714569, 0.08331438153982162, 0.08711014688014984], [0.08696559071540833, 0.08678704500198364, 0.08660886436700821, 0.08805824816226959, 0.08787745982408524, 0.09064705669879913, 0.08751700073480606, 0.088607057929039, 0.12108175456523895, 0.08679582923650742, 0.08905410021543503]], [[0.0908869057893753, 0.09051945805549622, 0.09100925177335739, 0.09162808954715729, 0.09015031903982162, 0.09021097421646118, 0.09082438796758652, 0.09088549762964249, 0.09137727320194244, 0.09143874794244766, 0.0910690650343895], [0.09086036682128906, 0.09009736031293869, 0.09111514687538147, 0.09240958839654922, 0.08933422714471817, 0.0894593894481659, 0.09073030203580856, 0.09085742384195328, 0.09188380092382431, 0.09201253205537796, 0.09123985469341278], [0.0908951461315155, 0.09065946936607361, 0.09097353368997574, 0.09136947244405746, 0.0904223695397377, 0.0904613584280014, 0.09085506945848465, 0.09089423716068268, 0.09120911359786987, 0.09124843776226044, 0.09101184457540512], [0.09093213081359863, 0.09136360883712769, 0.0907893106341362, 0.09007322043180466, 0.09180089831352234, 0.09172877669334412, 0.09100528061389923, 0.09093378484249115, 0.09036219120025635, 0.09029120206832886, 0.09071963280439377], [0.09083090722560883, 0.08967093378305435, 0.09121938794851303, 0.09320186078548431, 0.08851590007543564, 0.08870498836040497, 0.09063281863927841, 0.09082642942667007, 0.09239482879638672, 0.09259220957756042, 0.09140974283218384], [0.09083593636751175, 0.08974117040634155, 0.09120240807533264, 0.09307117760181427, 0.08865026384592056, 0.08882889896631241, 0.09064903855323792, 0.0908317118883133, 0.09231070429086685, 0.09249673038721085, 0.09138194471597672], [0.09088258445262909, 0.0904478058218956, 0.09102742373943329, 0.0917605608701706, 0.0900113582611084, 0.090083047747612, 0.09080858528614044, 0.09088091552257538, 0.09146330505609512, 0.09153615683317184, 0.09109824150800705], [0.09088680893182755, 0.09051784127950668, 0.09100966155529022, 0.09163108468055725, 0.09014718234539032, 0.09020809084177017, 0.09082403779029846, 0.09088539332151413, 0.09137921780347824, 0.09144095331430435, 0.09106973558664322], [0.09091806411743164, 0.09107902646064758, 0.09086467325687408, 0.09059620648622513, 0.09124168008565903, 0.09121488779783249, 0.09094538539648056, 0.09091867506504059, 0.09070470184087753, 0.09067806601524353, 0.09083860367536545], [0.09092162549495697, 0.09114889055490494, 0.09084629267454147, 0.09046770632266998, 0.09137869626283646, 0.09134083241224289, 0.09096018970012665, 0.09092249721288681, 0.09062065184116364, 0.09058310091495514, 0.09080951660871506], [0.09089905023574829, 0.09072782844305038, 0.09095598012208939, 0.09124330431222916, 0.09055544435977936, 0.09058379381895065, 0.09086994081735611, 0.09089839458465576, 0.09112697094678879, 0.091155506670475, 0.0909838005900383]], [[0.08348521590232849, 0.0858437716960907, 0.08554812520742416, 0.0826256200671196, 0.08495988696813583, 0.08674376457929611, 0.08177486807107925, 0.08614730834960938, 0.15013493597507477, 0.08585835993289948, 0.08687815070152283], [0.08582472801208496, 0.08755699545145035, 0.08734060078859329, 0.08518996089696884, 0.08690941333770752, 0.0882144421339035, 0.08455988764762878, 0.08777894824743271, 0.13074487447738647, 0.08756767213344574, 0.08831244707107544], [0.08554589003324509, 0.08735769987106323, 0.08713126182556152, 0.08488242328166962, 0.08668017387390137, 0.08804579079151154, 0.08422410488128662, 0.08758997172117233, 0.13302546739578247, 0.08736886084079742, 0.08814838528633118], [0.08256402611732483, 0.08514534682035446, 0.08482136577367783, 0.08162513375282288, 0.08417709916830063, 0.08613231033086777, 0.08069692552089691, 0.08547809720039368, 0.15791857242584229, 0.08516133576631546, 0.08627977967262268], [0.0849790871143341, 0.08694833517074585, 0.08670202642679214, 0.08425892889499664, 0.08621148765087128, 0.08769723027944565, 0.08354487270116806, 0.0872010737657547, 0.13768748939037323, 0.08696049451828003, 0.08780893683433533], [0.08664949238300323, 0.08813812583684921, 0.08795240521430969, 0.08610289543867111, 0.08758214116096497, 0.08870197087526321, 0.08555974811315536, 0.0883285403251648, 0.12405143678188324, 0.08814728260040283, 0.08878596872091293], [0.08161395788192749, 0.08441221714019775, 0.08406056463718414, 0.08059821277856827, 0.08336164802312851, 0.08548428863286972, 0.07959510385990143, 0.08477353304624557, 0.16602632403373718, 0.08442957699298859, 0.08564457297325134], [0.08610690385103226, 0.08775724470615387, 0.08755117654800415, 0.08550173789262772, 0.08714048564434052, 0.08838317543268204, 0.08490083366632462, 0.08796858042478561, 0.12844598293304443, 0.08776739984750748, 0.08847645670175552], [0.10795093327760696, 0.09402983635663986, 0.0956512838602066, 0.11363227665424347, 0.09897852689027786, 0.08929325640201569, 0.11961263418197632, 0.09239935129880905, 0.005890363361686468, 0.09395067393779755, 0.08861085027456284], [0.08583839237689972, 0.08756671845912933, 0.08735082298517227, 0.08520504087209702, 0.08692062646150589, 0.08822266012430191, 0.08457636833190918, 0.0877881646156311, 0.1306333988904953, 0.08757737278938293, 0.08832044154405594], [0.08676960319280624, 0.08822167664766312, 0.0880405530333519, 0.08623626828193665, 0.0876794159412384, 0.08877149969339371, 0.0857062116265297, 0.08840736746788025, 0.12308333814144135, 0.08823060989379883, 0.08885340392589569]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_duration_sec_mean": 0.005553767447127029, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.501633647014314e-06, "listify_data_for_vector_env": 1.3312314384355008e-05, "un_batch_to_individual_items": 8.073466681469899e-06, "tensor_to_numpy": 1.9616914953770063e-05, "remove_single_ts_time_rank_from_batch": 1.3983020713408329e-05, "get_actions": 5.2325868255388774e-05}}, "connector_pipeline_timer": 0.00014954305533248978}, "env_to_module_connector": {"connector_pipeline_timer": 7.62651508034183e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 8.734459250267443e-06, "numpy_to_tensor": 1.7362258152490725e-05, "add_states_from_episodes_to_batch": 3.097905622385509e-06, "add_observations_from_episodes_to_batch": 3.441912367327478e-06, "batch_individual_items": 1.6200999498725356e-05}}}, "env_step_timer": 1.7917378069764712e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.55, "episode_return_max": 14.5, "module_episode_returns_mean": {"default_policy": 1.55}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 1.55}, "num_env_steps_sampled": 400, "episode_len_max": 20, "weights_seq_no": 13.0, "num_episodes": 20, "num_env_steps_sampled_lifetime": 65400, "env_reset_timer": 0.0006255141898000358, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -14.5, "episode_len_mean": 20.0, "num_episodes_lifetime": 260, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 3.989359797647257e-05, "sample": 0.1302723716889412, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "time_between_sampling": 9.946485996374406}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "ba9e8_00000", "date": "2025-08-11_18-10-04", "timestamp": 1754928604, "time_this_iter_s": 9.844682931900024, "time_total_s": 131.64001774787903, "pid": 10327, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3858fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 131.64001774787903, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 44.607142857142854, "ram_util_percent": 80.76428571428572}}
{"timers": {"training_iteration": 9.477229620367963, "restore_env_runners": 1.8316714803553938e-05, "training_step": 9.476994458947624, "env_runner_sampling_timer": 1.7723468809291711, "learner_update_timer": 7.51916712848675, "synch_weights": 0.0015047312059671572, "restore_eval_env_runners": 5.380369020702655e-05, "evaluation_iteration": 0.14318902012184412, "synch_eval_env_connectors": 0.0001982000160276172, "synch_env_connectors": 6.854598409603207e-06}, "env_runners": {"env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": -0.38000000000000006}, "rlmodule_inference_timer": 9.15514909023615e-05, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.7698674216656865e-05, "get_actions": 4.8074300869112875e-05, "listify_data_for_vector_env": 1.2022579491036704e-05, "un_batch_to_individual_items": 7.418911018154989e-06, "remove_single_ts_time_rank_from_batch": 1.3187565232516609e-05, "normalize_and_clip_actions": 9.190570654701915e-06}}, "connector_pipeline_timer": 0.0001373960850998399}, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.412285276269305e-05, "add_states_from_episodes_to_batch": 3.0414702765033643e-06, "add_time_dim_to_batch_and_zero_pad": 8.100384042957655e-06, "add_observations_from_episodes_to_batch": 3.259029498424093e-06, "numpy_to_tensor": 1.523598655673522e-05}}, "connector_pipeline_timer": 6.81749053170601e-05}, "sample": 0.006604318748260614, "episode_duration_sec_mean": 0.0071407268778420985, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "agent_episode_returns_mean": {"default_agent": -0.38000000000000006}, "weights_seq_no": 13.0, "episode_return_mean": -0.38000000000000006, "env_step_timer": 1.672148156920882e-05, "episode_return_max": 8.5, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -7400000.0, "env_reset_timer": 5.197811312687908e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "time_between_sampling": 0.03330826178129155, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "episode_return_min": -11.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -370000.0, "num_env_steps_sampled_lifetime_throughput": 2918.1742810084784}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1422748481176987, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009958925594403983, "add_observations_from_episodes_to_batch": 0.0010328918467427419, "add_columns_from_episodes_to_train_batch": 0.04469547112574723, "add_time_dim_to_batch_and_zero_pad": 0.0781689119571838, "add_states_from_episodes_to_batch": 0.003794029357088804, "batch_individual_items": 0.0043354192409915905, "numpy_to_tensor": 8.905294216050268e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.3583046793937683, "module_train_batch_size_mean": 997.7135120670981, "num_module_steps_trained": 5985, "policy_loss": -0.0004283510206732899, "use_intrinsic_rewards": 0.0, "num_module_steps_trained_lifetime": 83790, "total_loss": 0.27764996886253357, "weights_seq_no": 14.0, "entropy": 0.6864895820617676, "mean_kl_loss": 2.7707970730261877e-05, "vf_loss_unclipped": 44.41508865356445, "num_trainable_parameters": 16595, "curr_kl_coeff": 9.862300430540927e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.0006543993949890137, "num_module_steps_trained_lifetime_throughput": 761.8916510776487}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1005480, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 2772000, "num_env_steps_trained_lifetime_throughput": 48435.99114279646}, "default_policy": {"num_module_steps_trained_lifetime": 502740, "weights_seq_no": 84.0, "diff_num_grad_updates_vs_sampler_policy": 71.0, "entropy": 0.6865297555923462, "mean_kl_loss": 2.5166958948830143e-05, "vf_loss_unclipped": 44.33624267578125, "vf_explained_var": 0.0017974376678466797, "num_module_steps_trained": 35910, "use_intrinsic_rewards": 1.0, "vf_loss": 0.35841527581214905, "module_train_batch_size_mean": 997.5006590853257, "total_loss": 0.2777619957923889, "policy_loss": -0.0004064632230438292}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.5006590853257, "num_module_steps_trained_lifetime": 502740, "total_loss": 0.0, "weights_seq_no": 84.0, "diff_num_grad_updates_vs_sampler_policy": 71.0}}}, "intrinsic_reward_module": {"weights_seq_no": 14.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.7135120670981, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5985, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 83790, "num_module_steps_trained_lifetime_throughput": 761.9020391775239}, "__all_modules__": {"num_env_steps_trained": 33000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 167580, "num_env_steps_trained_lifetime": 462000, "num_env_steps_trained_lifetime_throughput": 4202.126167447037, "num_module_steps_trained_throughput": 20584279.06107059, "num_module_steps_trained_lifetime_throughput": 13602400.97544255}, "IntrinsicAttentionMask": [[[0.09112785011529922, 0.0911681205034256, 0.0908588245511055, 0.09047188609838486, 0.0914030373096466, 0.09101378172636032, 0.09132563322782516, 0.09128696471452713, 0.09028048068284988, 0.09024224430322647, 0.09082122892141342], [0.09106289595365524, 0.09109117090702057, 0.09087394177913666, 0.09060188382863998, 0.09125600755214691, 0.09098280221223831, 0.09120171517133713, 0.09117457270622253, 0.0904671773314476, 0.09044025838375092, 0.09084752947092056], [0.09155963361263275, 0.09168069064617157, 0.0907536968588829, 0.08960284292697906, 0.09238894283771515, 0.09121735394001007, 0.09215518832206726, 0.09203853458166122, 0.08903715014457703, 0.08892444521188736, 0.09064146876335144], [0.09217437356710434, 0.09241347759962082, 0.0905902311205864, 0.08835146576166153, 0.09381848573684692, 0.0914999395608902, 0.09335362166166306, 0.09312205016613007, 0.08726108819246292, 0.08704463392496109, 0.09037070721387863], [0.09068255126476288, 0.09064128994941711, 0.0909590944647789, 0.09135976433753967, 0.09040138870477676, 0.09079959988594055, 0.09048029035329819, 0.09051977097988129, 0.09155925363302231, 0.09159920364618301, 0.0909978598356247], [0.09131135791540146, 0.09138575196266174, 0.09081511199474335, 0.09010354429483414, 0.09182024747133255, 0.09110081195831299, 0.0916769877076149, 0.09160543978214264, 0.08975250273942947, 0.08968245983123779, 0.09074587374925613], [0.09080816060304642, 0.09078972041606903, 0.09093163162469864, 0.09111015498638153, 0.09068240970373154, 0.09086044132709503, 0.09071772545576096, 0.09073538333177567, 0.0911988765001297, 0.09121663123369217, 0.0909489244222641], [0.09087081998586655, 0.09086380898952484, 0.0909176915884018, 0.09098539501428604, 0.09082303941249847, 0.09089066833257675, 0.09083646535873413, 0.09084317088127136, 0.09101901203393936, 0.09102573245763779, 0.09092425554990768], [0.09247563034296036, 0.0927739366889, 0.0905039831995964, 0.08773189038038254, 0.0945306345820427, 0.09163520485162735, 0.09394869208335876, 0.09365907311439514, 0.08638790994882584, 0.0861215889453888, 0.09023142606019974], [0.0925355777144432, 0.09284578263759613, 0.09048634022474289, 0.08760810643434525, 0.0946732833981514, 0.09166187047958374, 0.09406773746013641, 0.09376642107963562, 0.08621393144130707, 0.08593777567148209, 0.0902031809091568], [0.09161968529224396, 0.09175211191177368, 0.0907384529709816, 0.08948134630918503, 0.09252721816301346, 0.09124533087015152, 0.0922713354229927, 0.09214365482330322, 0.08886399120092392, 0.08874102681875229, 0.09061580151319504]], [[0.08818849176168442, 0.08798116445541382, 0.08591924607753754, 0.08571725338697433, 0.08551573008298874, 0.09052258729934692, 0.08511411398649216, 0.09009745717048645, 0.12610922753810883, 0.08613170683383942, 0.08870306611061096], [0.08801785856485367, 0.08780032396316528, 0.08563835918903351, 0.08542671799659729, 0.08521558344364166, 0.0904686376452446, 0.08479488641023636, 0.0900220051407814, 0.12819674611091614, 0.08586100488901138, 0.08855787664651871], [0.08611363172531128, 0.08579633384943008, 0.08266390115022659, 0.08235931396484375, 0.08205584436655045, 0.08971498161554337, 0.08145225793123245, 0.08905506879091263, 0.15090090036392212, 0.08298471570014954, 0.08690299838781357], [0.08590570092201233, 0.08557884395122528, 0.08235406875610352, 0.0820407047867775, 0.08172853291034698, 0.08961842209100723, 0.08110776543617249, 0.08893772959709167, 0.15332508087158203, 0.08268414437770844, 0.08671905100345612], [0.08569425344467163, 0.08535787463188171, 0.08204153180122375, 0.08171948790550232, 0.08139871060848236, 0.0895177572965622, 0.08076092600822449, 0.08881635218858719, 0.1557808816432953, 0.08238079398870468, 0.08653143048286438], [0.08987334370613098, 0.08978233486413956, 0.08887046575546265, 0.0887804701924324, 0.08869056403636932, 0.09088966995477676, 0.08851102739572525, 0.09070567786693573, 0.10483264923095703, 0.08896499872207642, 0.09009870886802673], [0.08526072651147842, 0.08490553498268127, 0.08140838146209717, 0.0810692310333252, 0.08073151111602783, 0.08930399268865585, 0.08006025850772858, 0.08856146782636642, 0.1607881337404251, 0.08176574856042862, 0.08614508807659149], [0.08959715068340302, 0.0894847959280014, 0.08836062997579575, 0.0882498249411583, 0.08813916146755219, 0.09085360914468765, 0.0879182517528534, 0.09062589704990387, 0.10841824114322662, 0.08847703784704208, 0.0898754745721817], [0.09213517606258392, 0.09362126141786575, 0.10999906063079834, 0.1117732897400856, 0.11357612907886505, 0.0771438330411911, 0.11726952344179153, 0.07965248078107834, 0.008099417202174664, 0.10816769301891327, 0.08856222033500671], [0.08632806688547134, 0.08602087944746017, 0.08298614621162415, 0.08269084244966507, 0.08239660412073135, 0.08981197327375412, 0.08181124925613403, 0.08917393535375595, 0.14839114248752594, 0.08329712599515915, 0.08709210902452469], [0.08859655261039734, 0.08841465413570404, 0.08660271018743515, 0.08642490953207016, 0.08624747395515442, 0.0906406119465828, 0.08589369058609009, 0.0902688130736351, 0.12107321619987488, 0.08678966015577316, 0.08904777467250824]], [[0.09106428176164627, 0.09145542234182358, 0.09079543501138687, 0.09040877968072891, 0.09098882973194122, 0.0913005992770195, 0.09091178327798843, 0.09122328460216522, 0.09021750092506409, 0.09052662551403046, 0.09110743552446365], [0.09061311930418015, 0.08988386392593384, 0.09111962467432022, 0.09185574948787689, 0.09075483679771423, 0.0901714414358139, 0.09089989960193634, 0.09031558036804199, 0.09222325682640076, 0.09163042157888412, 0.09053221344947815], [0.09136945754289627, 0.09254805743694305, 0.09056518971920013, 0.08941672742366791, 0.09114325791597366, 0.09208033978939056, 0.09091265499591827, 0.09184736013412476, 0.08885221183300018, 0.08976572751998901, 0.09149900078773499], [0.09180118143558502, 0.09413743764162064, 0.09022344648838043, 0.08799374848604202, 0.09135609120130539, 0.09320686012506485, 0.09090342372655869, 0.09274502098560333, 0.0869077816605568, 0.08866843581199646, 0.09205655753612518], [0.09115033596754074, 0.0917610451579094, 0.0907314270734787, 0.09013014286756516, 0.09103270620107651, 0.09151913225650787, 0.09091262519359589, 0.09139841794967651, 0.08983322978019714, 0.09031325578689575, 0.09121764451265335], [0.0907927080988884, 0.09050337225198746, 0.09099283814430237, 0.09128250926733017, 0.09084877371788025, 0.09061764180660248, 0.09090610593557358, 0.09067482501268387, 0.09142659604549408, 0.09119398891925812, 0.09076067805290222], [0.09123789519071579, 0.09207397699356079, 0.09066557884216309, 0.08984577655792236, 0.09107708185911179, 0.09174254536628723, 0.09091301262378693, 0.09157728403806686, 0.0894417092204094, 0.09009522944688797, 0.09132994711399078], [0.09088188409805298, 0.09081397950649261, 0.09092876315116882, 0.09099648147821426, 0.09089502692222595, 0.09084081649780273, 0.0909084603190422, 0.09085424244403839, 0.09103009849786758, 0.0909757986664772, 0.09087437391281128], [0.09201153367757797, 0.09493149816989899, 0.09004979580640793, 0.08729161322116852, 0.09145728498697281, 0.09376628696918488, 0.09089426696300507, 0.0931890457868576, 0.08595436811447144, 0.08812443912029266, 0.09232985228300095], [0.09167050570249557, 0.09365077316761017, 0.09032892435789108, 0.08842694759368896, 0.09129238873720169, 0.09286288172006607, 0.09090755879878998, 0.09247142821550369, 0.0874980017542839, 0.08900322020053864, 0.09188733249902725], [0.09101492166519165, 0.0912809818983078, 0.09083184599876404, 0.09056822210550308, 0.09096356481313705, 0.09117571264505386, 0.09091109037399292, 0.09112312644720078, 0.09043768793344498, 0.0906486064195633, 0.09104429930448532]], [[0.09297136962413788, 0.09280860424041748, 0.09264612942934036, 0.09248393028974533, 0.09232201427221298, 0.09479708969593048, 0.09199904650449753, 0.0944654569029808, 0.07012612372636795, 0.09281661361455917, 0.0925636738538742], [0.09309574216604233, 0.09292153269052505, 0.09274765104055405, 0.0925740972161293, 0.09240086376667023, 0.09505123645067215, 0.09205538034439087, 0.09469583630561829, 0.06886813044548035, 0.09293010830879211, 0.09265941381454468], [0.09321798384189606, 0.09303231537342072, 0.09284701198339462, 0.09266208112239838, 0.09247751533985138, 0.0953037291765213, 0.09210948646068573, 0.0949244573712349, 0.06763103604316711, 0.09304145723581314, 0.09275299310684204], [0.09333812445402145, 0.09314095973968506, 0.09294421225786209, 0.09274788200855255, 0.09255196899175644, 0.09555456042289734, 0.0921613797545433, 0.09515129774808884, 0.06641454249620438, 0.09315066039562225, 0.0928443893790245], [0.0934562012553215, 0.09324751794338226, 0.09303931146860123, 0.0928315669298172, 0.09262428432703018, 0.09580378234386444, 0.09221111238002777, 0.09537642449140549, 0.06521838903427124, 0.09325779229402542, 0.09293368458747864], [0.09143926203250885, 0.09140162914991379, 0.09136400371789932, 0.09132640063762665, 0.09128881245851517, 0.09185800701379776, 0.09121368080377579, 0.09178240597248077, 0.08557739108800888, 0.09140348434448242, 0.09134489297866821], [0.09368621557950974, 0.09345444291830063, 0.09322325140237808, 0.0929926261305809, 0.09276258200407028, 0.09629741311073303, 0.09230417758226395, 0.09582154452800751, 0.06288591027259827, 0.09346584975719452, 0.0931059867143631], [0.0917368233203888, 0.09167691320180893, 0.09161704778671265, 0.09155721962451935, 0.09149742871522903, 0.09240434318780899, 0.09137796610593796, 0.092283695936203, 0.08258205652236938, 0.09167987108230591, 0.0915866419672966], [0.09886900335550308, 0.09679590910673141, 0.0947662889957428, 0.09277921915054321, 0.09083382040262222, 0.12508396804332733, 0.08706453442573547, 0.11989342421293259, 0.0032654390670359135, 0.09689702093601227, 0.09375128895044327], [0.09308965504169464, 0.09291601181030273, 0.09274269640445709, 0.09256970137357712, 0.09239703416824341, 0.0950387492775917, 0.0920526534318924, 0.09468452632427216, 0.06892961263656616, 0.092924565076828, 0.092654749751091], [0.09327930212020874, 0.09308779239654541, 0.09289667010307312, 0.09270595014095306, 0.09251561760902405, 0.09543139487504959, 0.09213612973690033, 0.09503994137048721, 0.0670103132724762, 0.09309721738100052, 0.09279970824718475]], [[0.09112808108329773, 0.0911683514714241, 0.09085904806852341, 0.09082057327032089, 0.0910525768995285, 0.09136456251144409, 0.09097547084093094, 0.09093694388866425, 0.09028070420026779, 0.09024246782064438, 0.0911712646484375], [0.09106302261352539, 0.09109129011631012, 0.0908740684390068, 0.09084702283143997, 0.09101000428199768, 0.09122897684574127, 0.09095585346221924, 0.09092879295349121, 0.09046730399131775, 0.09044037759304047, 0.09109333157539368], [0.09156171977519989, 0.09168277680873871, 0.09075576066970825, 0.09064088016748428, 0.09133504331111908, 0.09227409213781357, 0.09110395610332489, 0.0909886285662651, 0.08903916925191879, 0.08892646431922913, 0.09169153869152069], [0.09162359684705734, 0.09175629913806915, 0.09074056148529053, 0.09061474353075027, 0.09137517213821411, 0.09240471571683884, 0.09112196415662766, 0.09099562466144562, 0.08886230736970901, 0.08873909711837769, 0.09176590293645859], [0.09124995023012161, 0.09131278842687607, 0.09083057940006256, 0.0907706543803215, 0.09113217890262604, 0.09161914885044098, 0.09101197868585587, 0.09095193445682526, 0.08993139117956161, 0.08987206965684891, 0.0913173258304596], [0.09074552357196808, 0.0907156690955162, 0.09094555675983429, 0.09097424149513245, 0.09080155938863754, 0.09057054668664932, 0.09085886180400848, 0.09088753163814545, 0.0913790762424469, 0.091407909989357, 0.0907135084271431], [0.09137427061796188, 0.0914602279663086, 0.09080109000205994, 0.09071927517652512, 0.09121321141719818, 0.09187967330217361, 0.09104890376329422, 0.0909668505191803, 0.0895753875374794, 0.08949466794729233, 0.09146644920110703], [0.09143632650375366, 0.09153388440608978, 0.09078618884086609, 0.09069342166185379, 0.09125358611345291, 0.09201005101203918, 0.09106720238924026, 0.09097415208816528, 0.08939775824546814, 0.08930641412734985, 0.09154094010591507], [0.09248810261487961, 0.09278646111488342, 0.09051619470119476, 0.09023714810609818, 0.09193097800016403, 0.09425193071365356, 0.0913650393486023, 0.09108337759971619, 0.08639955520629883, 0.0861332044005394, 0.0928080603480339], [0.09254904091358185, 0.09285930544137955, 0.09049951285123825, 0.09020962566137314, 0.0919698178768158, 0.09438376873731613, 0.09138156473636627, 0.09108884632587433, 0.08622648566961288, 0.08595027774572372, 0.09288176894187927], [0.09105830639600754, 0.09108570963144302, 0.09087514132261276, 0.09084893018007278, 0.09100691974163055, 0.09121917188167572, 0.09095443040132523, 0.09092818945646286, 0.09048078954219818, 0.09045469015836716, 0.0910876914858818]], [[0.09203561395406723, 0.09142926335334778, 0.09136930853128433, 0.09130938351154327, 0.09179440885782242, 0.09270817786455154, 0.09167404472827911, 0.09258661419153214, 0.08232218027114868, 0.09143222123384476, 0.09133885055780411], [0.09393917769193649, 0.09218303859233856, 0.09201054275035858, 0.09183835983276367, 0.09323801100254059, 0.0959123894572258, 0.09288939088582993, 0.09555377066135406, 0.06832080334424973, 0.09219154715538025, 0.09192300587892532], [0.09411575645208359, 0.09224399924278259, 0.09206026792526245, 0.09187690168619156, 0.09336815774440765, 0.09622158855199814, 0.09299658238887787, 0.09583866596221924, 0.06705795228481293, 0.09225305914878845, 0.09196703881025314], [0.09429024904966354, 0.09230262041091919, 0.09210764616727829, 0.09191308170557022, 0.09349607676267624, 0.09652929753065109, 0.09310150146484375, 0.09612192213535309, 0.06581676006317139, 0.09231223165988922, 0.09200872480869293], [0.0928192064166069, 0.09175993502140045, 0.09165547043085098, 0.09155111759901047, 0.09239721298217773, 0.0940001979470253, 0.09218693524599075, 0.09378627687692642, 0.07647612690925598, 0.09176509082317352, 0.09160242229700089], [0.08965254575014114, 0.09027298539876938, 0.09033479541540146, 0.09039665013551712, 0.08989835530519485, 0.08897403627634048, 0.09002150595188141, 0.08909592032432556, 0.10071703046560287, 0.09026993811130524, 0.09036622196435928], [0.09319701790809631, 0.09190946817398071, 0.09178265184164047, 0.09165601432323456, 0.09268371015787125, 0.0946362093091011, 0.09242811799049377, 0.09437523037195206, 0.07369764894247055, 0.09191571921110153, 0.09171827137470245], [0.09010577201843262, 0.09050878882408142, 0.09054888784885406, 0.0905890017747879, 0.09026554971933365, 0.08966390788555145, 0.09034555405378342, 0.08974337577819824, 0.09715305268764496, 0.09050680696964264, 0.09056926518678665], [0.10789709538221359, 0.08715340495109558, 0.08532595634460449, 0.08353684097528458, 0.09912818670272827, 0.1365058422088623, 0.09501472115516663, 0.13084132969379425, 0.0029401457868516445, 0.0872444435954094, 0.08441206812858582], [0.09393040835857391, 0.09217996895313263, 0.09200802445411682, 0.09183640033006668, 0.09323152899742126, 0.09589710831642151, 0.09288404136896133, 0.09553968906402588, 0.06838357448577881, 0.09218844771385193, 0.09192077070474625], [0.09420468658208847, 0.09227407723665237, 0.09208463132381439, 0.09189557284116745, 0.0934334322810173, 0.0963781327009201, 0.09305017441511154, 0.09598279744386673, 0.06642454862594604, 0.09228341281414032, 0.09198851138353348]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_duration_sec_mean": 0.0055607387085910885, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.127362679622773e-06, "listify_data_for_vector_env": 1.0652791762745667e-05, "un_batch_to_individual_items": 6.6263810989891215e-06, "tensor_to_numpy": 1.5632490105654525e-05, "remove_single_ts_time_rank_from_batch": 1.2332558255781917e-05, "get_actions": 3.8545169512035543e-05}}, "connector_pipeline_timer": 0.00011915250064123932}, "env_to_module_connector": {"connector_pipeline_timer": 5.9995723827211504e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.844488944754492e-06, "numpy_to_tensor": 1.256160806982052e-05, "add_states_from_episodes_to_batch": 2.7717823754134258e-06, "add_observations_from_episodes_to_batch": 2.914701965808882e-06, "batch_individual_items": 1.2587550424024525e-05}}}, "env_step_timer": 1.4348803597630583e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.55, "episode_return_max": 14.5, "module_episode_returns_mean": {"default_policy": 1.55}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 1.55}, "num_env_steps_sampled": 400, "episode_len_max": 20, "weights_seq_no": 14.0, "num_episodes": 20, "num_env_steps_sampled_lifetime": 70400, "env_reset_timer": 0.0006224990481257764, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -14.5, "episode_len_mean": 20.0, "num_episodes_lifetime": 280, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 3.22128166548148e-05, "sample": 0.13012604047232196, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "time_between_sampling": 9.94565774099076}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "ba9e8_00000", "date": "2025-08-11_18-10-14", "timestamp": 1754928614, "time_this_iter_s": 9.932806015014648, "time_total_s": 141.57282376289368, "pid": 10327, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3858fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 141.57282376289368, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 48.67857142857143, "ram_util_percent": 82.19285714285714}}
{"timers": {"training_iteration": 9.485036116664128, "restore_env_runners": 1.8190628416116582e-05, "training_step": 9.484800701027906, "env_runner_sampling_timer": 1.772278623780192, "learner_update_timer": 7.526966200531165, "synch_weights": 0.00150603805452366, "restore_eval_env_runners": 5.36514827853212e-05, "evaluation_iteration": 0.14299848908998777, "synch_eval_env_connectors": 0.00019794717688025875, "synch_env_connectors": 6.831471863317954e-06}, "env_runners": {"env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 0.09999999999999998}, "rlmodule_inference_timer": 3.697730895307515e-05, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.757584060831673e-05, "get_actions": 4.6594766425521336e-05, "listify_data_for_vector_env": 1.1873379492741715e-05, "un_batch_to_individual_items": 7.485247798505012e-06, "remove_single_ts_time_rank_from_batch": 1.332549325120191e-05, "normalize_and_clip_actions": 8.940562615032381e-06}}, "connector_pipeline_timer": 0.0001353045671315413}, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.4053746609284206e-05, "add_states_from_episodes_to_batch": 3.039119801075461e-06, "add_time_dim_to_batch_and_zero_pad": 8.13867240171828e-06, "add_observations_from_episodes_to_batch": 3.2133603094676252e-06, "numpy_to_tensor": 1.4803274193758844e-05}}, "connector_pipeline_timer": 6.770054840136518e-05}, "sample": 0.007374088924206438, "episode_duration_sec_mean": 0.00603254836425185, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "agent_episode_returns_mean": {"default_agent": 0.09999999999999998}, "weights_seq_no": 14.0, "episode_return_mean": 0.09999999999999998, "env_step_timer": 1.6531991484656432e-05, "episode_return_max": 8.5, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -8017500.0, "env_reset_timer": 5.962558235566404e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "time_between_sampling": 0.03231042153007407, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "episode_return_min": -11.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -400875.0, "num_env_steps_sampled_lifetime_throughput": 2847.0327516712455}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.14223057963577895, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009955558838311082, "add_observations_from_episodes_to_batch": 0.0010316041775616978, "add_columns_from_episodes_to_train_batch": 0.04466439183492975, "add_time_dim_to_batch_and_zero_pad": 0.07815873825708583, "add_states_from_episodes_to_batch": 0.0037951440640428833, "batch_individual_items": 0.004336471718494534, "numpy_to_tensor": 8.903075229609832e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.3583046793937683, "module_train_batch_size_mean": 997.7008703380301, "num_module_steps_trained": 5985, "policy_loss": 3.783896318054758e-05, "use_intrinsic_rewards": 0.0, "num_module_steps_trained_lifetime": 89775, "total_loss": 0.2781173288822174, "weights_seq_no": 15.0, "entropy": 0.6857059001922607, "mean_kl_loss": 1.593341221450828e-05, "vf_loss_unclipped": 42.79482650756836, "num_trainable_parameters": 16595, "curr_kl_coeff": 4.931150215270463e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -8.630752563476562e-05, "num_module_steps_trained_lifetime_throughput": 758.5502630717712}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1077300, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 2970000, "num_env_steps_trained_lifetime_throughput": 47649.49878941465}, "default_policy": {"num_module_steps_trained_lifetime": 538650, "weights_seq_no": 90.0, "diff_num_grad_updates_vs_sampler_policy": 76.0, "entropy": 0.6856977343559265, "mean_kl_loss": 1.62993383128196e-05, "vf_loss_unclipped": 42.67626953125, "vf_explained_var": 0.001628100872039795, "num_module_steps_trained": 35910, "use_intrinsic_rewards": 1.0, "vf_loss": 0.3584132492542267, "module_train_batch_size_mean": 997.4996962148737, "total_loss": 0.27820640802383423, "policy_loss": 3.964129791711457e-05}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.4996962148737, "num_module_steps_trained_lifetime": 538650, "total_loss": 0.0, "weights_seq_no": 90.0, "diff_num_grad_updates_vs_sampler_policy": 76.0}}}, "intrinsic_reward_module": {"weights_seq_no": 15.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.7008703380301, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5985, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 89775, "num_module_steps_trained_lifetime_throughput": 758.5600143924805}, "__all_modules__": {"num_env_steps_trained": 33000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 179550, "num_env_steps_trained_lifetime": 495000, "num_env_steps_trained_lifetime_throughput": 4183.65080823332, "num_module_steps_trained_throughput": 20101066.54614592, "num_module_steps_trained_lifetime_throughput": 13479801.362123033}, "IntrinsicAttentionMask": [[[0.09119182080030441, 0.09123212099075317, 0.09092259407043457, 0.09053539484739304, 0.09111626446247101, 0.09107767045497894, 0.09103909879922867, 0.09100054949522018, 0.09034384787082672, 0.09030559659004211, 0.09123503416776657], [0.09110776335000992, 0.09113605320453644, 0.09091871976852417, 0.09064652770757675, 0.09105472266674042, 0.09102763235569, 0.09100054204463959, 0.09097346663475037, 0.0905117467045784, 0.09048482030630112, 0.09113809466362], [0.09175354242324829, 0.0918748527765274, 0.09094589203596115, 0.08979260176420212, 0.09152638912200928, 0.09141053259372711, 0.09129481762647629, 0.0911792516708374, 0.08922570943832397, 0.0891127660870552, 0.09188362956047058], [0.09256192296743393, 0.09280204027891159, 0.09097112715244293, 0.08872294425964355, 0.09211315214633942, 0.09188466519117355, 0.09165673702955246, 0.09142937511205673, 0.08762797713279724, 0.08741061389446259, 0.09281942248344421], [0.09134943038225174, 0.09141233563423157, 0.09092960506677628, 0.09032700210809708, 0.09123153984546661, 0.09117135405540466, 0.0911111980676651, 0.09105109423398972, 0.09002944082021713, 0.08997005224227905, 0.09141688793897629], [0.0914299339056015, 0.09150442481040955, 0.09093303978443146, 0.09022055566310883, 0.09129035472869873, 0.09121910482645035, 0.09114792197942734, 0.09107678383588791, 0.08986905217170715, 0.08979891240596771, 0.09150981158018112], [0.09151041507720947, 0.09159651398658752, 0.09093638509511948, 0.09011413902044296, 0.09134911745786667, 0.09126680344343185, 0.09118455648422241, 0.09110239148139954, 0.0897088572382927, 0.08962801843881607, 0.09160273522138596], [0.09159086644649506, 0.0916885957121849, 0.09093963354825974, 0.09000775218009949, 0.09140782803297043, 0.09131442755460739, 0.09122111648321152, 0.0911279171705246, 0.08954885601997375, 0.08945735543966293, 0.09169565886259079], [0.09296198934316635, 0.09326187521219254, 0.09097998589277267, 0.08819330483675003, 0.09240201115608215, 0.09211715310811996, 0.09183317422866821, 0.0915500745177269, 0.08684225380420685, 0.08657453209161758, 0.09328359365463257], [0.09304191917181015, 0.09335383027791977, 0.09098146855831146, 0.08808748424053192, 0.09245960414409637, 0.09216343611478806, 0.09186821430921555, 0.09157394617795944, 0.08668568730354309, 0.08640800416469574, 0.09337641298770905], [0.09110168367624283, 0.09112910181283951, 0.09091842919588089, 0.09065455198287964, 0.09105026721954346, 0.0910240039229393, 0.09099775552749634, 0.09097150713205338, 0.09052389115095139, 0.09049777686595917, 0.09113108366727829]], [[0.09208565950393677, 0.09147898107767105, 0.09196491539478302, 0.09135903418064117, 0.09129911661148071, 0.09275858849287033, 0.09117940813302994, 0.09263695776462555, 0.082366943359375, 0.09148193895816803, 0.0913885161280632], [0.0940859243273735, 0.0923270508646965, 0.09373413771390915, 0.09198183566331863, 0.0918097123503685, 0.09606222063302994, 0.09146643429994583, 0.09570304304361343, 0.06842753291130066, 0.09233556687831879, 0.09206660836935043], [0.09250102192163467, 0.09166822582483292, 0.09233510494232178, 0.09150380641222, 0.0914217084646225, 0.0934271365404129, 0.0912577286362648, 0.09325956553220749, 0.07940924167633057, 0.09167227894067764, 0.09154421091079712], [0.09445668756961823, 0.09246554970741272, 0.09405805915594101, 0.09207532554864883, 0.09188082814216614, 0.09669968485832214, 0.09149307012557983, 0.09629158675670624, 0.06593294441699982, 0.09247518330812454, 0.09217113256454468], [0.09463896602392197, 0.09253130853176117, 0.09421680867671967, 0.09211854636669159, 0.09191285818815231, 0.09701626002788544, 0.09150286018848419, 0.09658349305391312, 0.06471747159957886, 0.09254150092601776, 0.09221988171339035], [0.08960221707820892, 0.0902223065495491, 0.08972496539354324, 0.09034589678049088, 0.09040776640176773, 0.08892408013343811, 0.0905316174030304, 0.08904590457677841, 0.10066048800945282, 0.09021925926208496, 0.09031549096107483], [0.09499748051166534, 0.09265605360269547, 0.09452804177999496, 0.09219817817211151, 0.09197009354829788, 0.09764523059129715, 0.09151561558246613, 0.09716270118951797, 0.06234867870807648, 0.0926673635840416, 0.09231057018041611], [0.09007297456264496, 0.09047584235668182, 0.090152807533741, 0.09055602550506592, 0.09059614688158035, 0.08963127434253693, 0.0906764343380928, 0.08971070498228073, 0.09711769223213196, 0.09047386795282364, 0.09053630381822586], [0.1096373051404953, 0.08855905383825302, 0.10508774220943451, 0.0848841667175293, 0.08310431241989136, 0.1387074589729309, 0.07965576648712158, 0.13295158743858337, 0.002987569198012352, 0.08865156024694443, 0.08577350527048111], [0.09407667070627213, 0.09232350438833237, 0.0937260314822197, 0.09197939932346344, 0.09180783480405807, 0.09604643285274506, 0.09146565198898315, 0.09568845480680466, 0.06849006563425064, 0.09233199805021286, 0.09206390380859375], [0.09436628222465515, 0.09243235737085342, 0.09397919476032257, 0.09205320477485657, 0.091864213347435, 0.09654345363378525, 0.09148740023374557, 0.09614744037389755, 0.0665384978055954, 0.09244171530008316, 0.09214629977941513]], [[0.09115983545780182, 0.09120012819766998, 0.09054198861122131, 0.09050364792346954, 0.09143512696027756, 0.09139640629291534, 0.09100718051195145, 0.09096863865852356, 0.09066001325845718, 0.09027392417192459, 0.09085311740636826], [0.09108533710241318, 0.0911136120557785, 0.09065118432044983, 0.09062421321868896, 0.09127849340438843, 0.09125133603811264, 0.09097814559936523, 0.09095107764005661, 0.09073418378829956, 0.09046255052089691, 0.09086991846561432], [0.0922980010509491, 0.09252577275037766, 0.08886212855577469, 0.08865240961313248, 0.0938635841012001, 0.09364206343889236, 0.09143908321857452, 0.09122328460216522, 0.08951021730899811, 0.08740444481372833, 0.09057893604040146], [0.09236834943294525, 0.09260796010494232, 0.08875756710767746, 0.08853740245103836, 0.0940159261226654, 0.09378271549940109, 0.0914650559425354, 0.09123817086219788, 0.08943811058998108, 0.08722781389951706, 0.09056089073419571], [0.0906500592827797, 0.09060882031917572, 0.09128720313310623, 0.09132703393697739, 0.09036900103092194, 0.09040842950344086, 0.09080667048692703, 0.09084630012512207, 0.09116481244564056, 0.09156639128923416, 0.09096526354551315], [0.09072186052799225, 0.09069201350212097, 0.09118250757455826, 0.09121127426624298, 0.09051837027072906, 0.09054692834615707, 0.09083517640829086, 0.09086383134126663, 0.09109408408403397, 0.09138407558202744, 0.09094985574483871], [0.09144185483455658, 0.09152787923812866, 0.0901278406381607, 0.09004662185907364, 0.09203056246042252, 0.09194763004779816, 0.09111624211072922, 0.09103413671255112, 0.09037806838750839, 0.08956087380647659, 0.09078826755285263], [0.09151297062635422, 0.0916106104850769, 0.09002318233251572, 0.08993120491504669, 0.09218136221170425, 0.09208717197179794, 0.09114353358745575, 0.0910504087805748, 0.09030666202306747, 0.08938127011060715, 0.09077159315347672], [0.09208127111196518, 0.09227274358272552, 0.08918377757072449, 0.08900635689496994, 0.09339588135480881, 0.09321007877588272, 0.09135855734348297, 0.09117680788040161, 0.08973164111375809, 0.08794920891523361, 0.09063372761011124], [0.09278904646635056, 0.09310010075569153, 0.08813036978244781, 0.08784807473421097, 0.09493260830640793, 0.09462852030992508, 0.09161853045225143, 0.0913250595331192, 0.0890042632818222, 0.0861731618642807, 0.09045026451349258], [0.09172594547271729, 0.09185852855443954, 0.08970926702022552, 0.08958514034748077, 0.09263453632593155, 0.09250635653734207, 0.09122476726770401, 0.09109853208065033, 0.09009210020303726, 0.0888439491391182, 0.09072089940309525]], [[0.08410155028104782, 0.08381190896034241, 0.08352325856685638, 0.08588289469480515, 0.08558710664510727, 0.08738415688276291, 0.08499860763549805, 0.08678329735994339, 0.14658142626285553, 0.08382616192102432, 0.08751954138278961], [0.08382318168878555, 0.08352441340684891, 0.08322669565677643, 0.08566146343946457, 0.08535613864660263, 0.08721175789833069, 0.08474874496459961, 0.08659116178750992, 0.1489657312631607, 0.08353909850120544, 0.08735159784555435], [0.08354189991950989, 0.08323406428098679, 0.08292738348245621, 0.08543667942285538, 0.08512187004089355, 0.08703570067882538, 0.08449573814868927, 0.08639547973871231, 0.15138188004493713, 0.08324921131134033, 0.0871799886226654], [0.08573141694068909, 0.0854988843202591, 0.08526697754859924, 0.08715784549713135, 0.08692143857479095, 0.08835510909557343, 0.08645054697990417, 0.08787645399570465, 0.1327681839466095, 0.08551032841205597, 0.08846285939216614], [0.0854703038930893, 0.08522817492485046, 0.08498673886060715, 0.08695617318153381, 0.08670983463525772, 0.08820416778326035, 0.08621925115585327, 0.08770513534545898, 0.13496357202529907, 0.08524008840322495, 0.08831651508808136], [0.08700137585401535, 0.08681804686784744, 0.08663510531187057, 0.08812350034713745, 0.08793780952692032, 0.08906218409538269, 0.08756760507822037, 0.08868724852800369, 0.12219348549842834, 0.08682707697153091, 0.08914652466773987], [0.08493967354297638, 0.08467859029769897, 0.08441831171512604, 0.08654323220252991, 0.08627721667289734, 0.08789189159870148, 0.08574765175580978, 0.08735240995883942, 0.13944615423679352, 0.08469144254922867, 0.08801338821649551], [0.08650398254394531, 0.08630084991455078, 0.08609820157289505, 0.08774837851524353, 0.087542325258255, 0.08879073709249496, 0.08713167160749435, 0.08837424218654633, 0.12631434202194214, 0.08631084859371185, 0.08888445794582367], [0.10577023029327393, 0.10747624933719635, 0.10920978337526321, 0.09597213566303253, 0.0975201204419136, 0.0885603204369545, 0.10069138556718826, 0.09144021570682526, 0.008041291497647762, 0.10739155858755112, 0.08792676031589508], [0.08383696526288986, 0.08353863656520844, 0.08324138075113297, 0.08567244559526443, 0.0853675901889801, 0.08722034096717834, 0.0847611278295517, 0.08660070598125458, 0.1488475203514099, 0.08355330675840378, 0.0873599648475647], [0.08711149543523788, 0.08693265169858932, 0.08675416558980942, 0.088205985724926, 0.08802489936351776, 0.08912128955125809, 0.08766382187604904, 0.08875571936368942, 0.12128496915102005, 0.08694145083427429, 0.08920351415872574]], [[0.09093740582466125, 0.09056974947452545, 0.09161736071109772, 0.09112108498811722, 0.09075269103050232, 0.09026110172271729, 0.09032183140516281, 0.09093599021434784, 0.09142804145812988, 0.09148956090211868, 0.09056515991687775], [0.09096559882164001, 0.09020170569419861, 0.09238717705011368, 0.09134849160909653, 0.09058137983083725, 0.08956299722194672, 0.08968847990036011, 0.09096265584230423, 0.09199021756649017, 0.09211911261081696, 0.09019218385219574], [0.09087894856929779, 0.09124376624822617, 0.09021192044019699, 0.09069778025150299, 0.09106187522411346, 0.09155231714248657, 0.09149143844842911, 0.09088034182786942, 0.09039664268493652, 0.09033653885126114, 0.09124834090471268], [0.09092242270708084, 0.09075267612934113, 0.09123537689447403, 0.09100709110498428, 0.09083718806505203, 0.09060989320278168, 0.09063800424337387, 0.09092176705598831, 0.09114836901426315, 0.09117665141820908, 0.0907505601644516], [0.09095188230276108, 0.09038516134023666, 0.09200327098369598, 0.09123548120260239, 0.0906669870018959, 0.0899103507399559, 0.09000370651483536, 0.09094969928264618, 0.09171011298894882, 0.09180533140897751, 0.09037808328866959], [0.09098738431930542, 0.08989077806472778, 0.09303885698318481, 0.09153855592012405, 0.09043531119823456, 0.08897699415683746, 0.08915629982948303, 0.09098314493894577, 0.09246461093425751, 0.09265094250440598, 0.08987713605165482], [0.09098322689533234, 0.08995209634304047, 0.09291023761034012, 0.09150122106075287, 0.09046421200037003, 0.08909228444099426, 0.08926104009151459, 0.09097924828529358, 0.09237109124660492, 0.09254605323076248, 0.08993925899267197], [0.0909375324845314, 0.09056834876537323, 0.0916203185915947, 0.09112197905778885, 0.09075204282999039, 0.09025841951370239, 0.09031940251588821, 0.09093610942363739, 0.09143020957708359, 0.09149198234081268, 0.09056373685598373], [0.09089604765176773, 0.09105697274208069, 0.0906008705496788, 0.09081599861383438, 0.0909767895936966, 0.0911928042769432, 0.09116602689027786, 0.09089666604995728, 0.0906827375292778, 0.0906561091542244, 0.09105899184942245], [0.0908905640244484, 0.0911177396774292, 0.09047428518533707, 0.09077761322259903, 0.09100451320409775, 0.09130962193012238, 0.0912717878818512, 0.09089143574237823, 0.09058968722820282, 0.09055215120315552, 0.09112059324979782], [0.09096594154834747, 0.09019709378480911, 0.09239684045314789, 0.09135132282972336, 0.09057922661304474, 0.08955427259206772, 0.08968056738376617, 0.0909629687666893, 0.09199726581573486, 0.0921270027756691, 0.09018751233816147]], [[0.09208618849515915, 0.09202579408884048, 0.091419517993927, 0.09135956317186356, 0.0912996456027031, 0.09220848232507706, 0.09172441810369492, 0.09263749420642853, 0.0823674276471138, 0.09148246794939041, 0.09138904511928558], [0.09229525178670883, 0.09222357720136642, 0.09150457382202148, 0.09143352508544922, 0.09136252105236053, 0.0924404188990593, 0.09186606854200363, 0.09294990450143814, 0.08087646216154099, 0.09157919138669968, 0.0914684608578682], [0.09427748620510101, 0.09408970922231674, 0.09221846610307693, 0.09203477948904037, 0.09185146540403366, 0.09465854614973068, 0.09315638244152069, 0.09600334614515305, 0.06717319786548615, 0.0924115851521492, 0.09212508052587509], [0.09446248412132263, 0.09426295012235641, 0.09227589517831802, 0.0920809730887413, 0.09188646823167801, 0.09486746788024902, 0.09327156841754913, 0.0962975025177002, 0.06593700498342514, 0.0924808606505394, 0.09217679500579834], [0.09464547783136368, 0.09443414956331253, 0.09233105182647705, 0.09212488681077957, 0.0919191837310791, 0.09507447481155396, 0.09338454902172089, 0.09659013897180557, 0.06472192704677582, 0.09254787117242813, 0.09222622960805893], [0.09165602177381516, 0.09161829203367233, 0.0912390723824501, 0.09120151400566101, 0.09116397798061371, 0.09173239022493362, 0.09142990410327911, 0.09199997782707214, 0.0854603722691536, 0.09127848595380783, 0.09121998399496078], [0.0933065339922905, 0.09317778795957565, 0.09189049899578094, 0.09176371246576309, 0.09163708984851837, 0.09356754273176193, 0.09253672510385513, 0.09448612481355667, 0.0737842544913292, 0.09202373027801514, 0.09182605147361755], [0.09007319808006287, 0.09011310338973999, 0.09051614999771118, 0.09055625647306442, 0.09059637039899826, 0.08999251574277878, 0.0903128907084465, 0.08971093595027924, 0.09711793810129166, 0.09047409892082214, 0.09053652733564377], [0.11040820926427841, 0.10809317231178284, 0.08731178939342499, 0.08548102527856827, 0.0836886465549469, 0.11524460464715958, 0.09722602367401123, 0.1338864266872406, 0.003008575877174735, 0.08927491307258606, 0.0863766148686409], [0.09408116340637207, 0.09390567988157272, 0.09215569496154785, 0.09198379516601562, 0.09181221574544907, 0.09443721175193787, 0.09303312003612518, 0.09569302201271057, 0.06849333643913269, 0.09233640879392624, 0.09206829965114594], [0.0943717509508133, 0.09417800605297089, 0.09224794059991837, 0.09205854684114456, 0.0918695479631424, 0.09476496279239655, 0.09321519732475281, 0.09615302085876465, 0.0665423572063446, 0.09244707971811295, 0.09215164929628372]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_duration_sec_mean": 0.005625820403220132, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.097581328309545e-06, "listify_data_for_vector_env": 1.0620607418258148e-05, "un_batch_to_individual_items": 6.946806270442457e-06, "tensor_to_numpy": 1.621889046889695e-05, "remove_single_ts_time_rank_from_batch": 1.2665277387163147e-05, "get_actions": 3.7975048945155486e-05}}, "connector_pipeline_timer": 0.00011992106272190955}, "env_to_module_connector": {"connector_pipeline_timer": 6.017340266397354e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.843399766912695e-06, "numpy_to_tensor": 1.2519743643460602e-05, "add_states_from_episodes_to_batch": 2.795157762333521e-06, "add_observations_from_episodes_to_batch": 2.820374953507507e-06, "batch_individual_items": 1.264767718642062e-05}}}, "env_step_timer": 1.452462301324636e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.35, "episode_return_max": 14.5, "module_episode_returns_mean": {"default_policy": 1.35}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 1.35}, "num_env_steps_sampled": 400, "episode_len_max": 20, "weights_seq_no": 15.0, "num_episodes": 20, "num_env_steps_sampled_lifetime": 75400, "env_reset_timer": 0.0006205436373028034, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -14.5, "episode_len_mean": 20.0, "num_episodes_lifetime": 300, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 3.206112492458948e-05, "sample": 0.13004569589736154, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "time_between_sampling": 9.94912674650012}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "ba9e8_00000", "date": "2025-08-11_18-10-25", "timestamp": 1754928625, "time_this_iter_s": 10.39239501953125, "time_total_s": 151.96521878242493, "pid": 10327, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3858fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 151.96521878242493, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 49.086666666666666, "ram_util_percent": 82.34}}
{"timers": {"training_iteration": 9.494599840497077, "restore_env_runners": 1.8123721843468936e-05, "training_step": 9.494364169018297, "env_runner_sampling_timer": 1.7722962808726481, "learner_update_timer": 7.534431375185946, "synch_weights": 0.0015061726744294815, "restore_eval_env_runners": 5.355746725234504e-05, "evaluation_iteration": 0.1428817279494184, "synch_eval_env_connectors": 0.0001979235360691967, "synch_env_connectors": 6.808157487336977e-06}, "env_runners": {"env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": -0.14000000000000007}, "rlmodule_inference_timer": 3.6787307016090955e-05, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.7678558393072336e-05, "get_actions": 4.671131548081083e-05, "listify_data_for_vector_env": 1.190025866819602e-05, "un_batch_to_individual_items": 7.497779562113373e-06, "remove_single_ts_time_rank_from_batch": 1.3377083659548489e-05, "normalize_and_clip_actions": 8.96349261192204e-06}}, "connector_pipeline_timer": 0.00013583896699539939}, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.4387937452286194e-05, "add_states_from_episodes_to_batch": 3.104987734182979e-06, "add_time_dim_to_batch_and_zero_pad": 8.127899957986607e-06, "add_observations_from_episodes_to_batch": 3.2217974681199318e-06, "numpy_to_tensor": 1.4948322971761626e-05}}, "connector_pipeline_timer": 6.835808451093132e-05}, "sample": 0.006583658431018906, "episode_duration_sec_mean": 0.006081235648132861, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "agent_episode_returns_mean": {"default_agent": -0.14000000000000007}, "weights_seq_no": 15.0, "episode_return_mean": -0.14000000000000007, "env_step_timer": 1.671612547080723e-05, "episode_return_max": 8.5, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -8635000.0, "env_reset_timer": 5.456900521299014e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "time_between_sampling": 0.03494999856215445, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "episode_return_min": -11.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -431750.0, "num_env_steps_sampled_lifetime_throughput": 2880.14690603476}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.14251976675971556, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009946056169623125, "add_observations_from_episodes_to_batch": 0.001031438136239076, "add_columns_from_episodes_to_train_batch": 0.04468452583637209, "add_time_dim_to_batch_and_zero_pad": 0.07843061921505713, "add_states_from_episodes_to_batch": 0.0038003863737187315, "batch_individual_items": 0.00433827408097063, "numpy_to_tensor": 8.902419422648824e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.35830482840538025, "module_train_batch_size_mean": 997.6889684010584, "num_module_steps_trained": 5985, "policy_loss": -0.0009297761716879904, "use_intrinsic_rewards": 0.0, "num_module_steps_trained_lifetime": 95760, "total_loss": 0.2771521508693695, "weights_seq_no": 16.0, "entropy": 0.6842042207717896, "mean_kl_loss": 7.37193477107212e-05, "vf_loss_unclipped": 43.52235794067383, "num_trainable_parameters": 16595, "curr_kl_coeff": 2.4655751076352317e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.0003560781478881836, "num_module_steps_trained_lifetime_throughput": 754.9115494258623}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1149120, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 3168000, "num_env_steps_trained_lifetime_throughput": 46893.57365596929}, "default_policy": {"num_module_steps_trained_lifetime": 574560, "weights_seq_no": 96.0, "diff_num_grad_updates_vs_sampler_policy": 81.0, "entropy": 0.6842657327651978, "mean_kl_loss": 6.820935232099146e-05, "vf_loss_unclipped": 43.39091873168945, "vf_explained_var": 0.0016047358512878418, "num_module_steps_trained": 35910, "use_intrinsic_rewards": 1.0, "vf_loss": 0.35840660333633423, "module_train_batch_size_mean": 997.4990256591639, "total_loss": 0.277279257774353, "policy_loss": -0.0008928693132475019}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.4990256591639, "num_module_steps_trained_lifetime": 574560, "total_loss": 0.0, "weights_seq_no": 96.0, "diff_num_grad_updates_vs_sampler_policy": 81.0}}}, "intrinsic_reward_module": {"weights_seq_no": 16.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.6889684010584, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5985, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 95760, "num_module_steps_trained_lifetime_throughput": 754.9207009143604}, "__all_modules__": {"num_env_steps_trained": 33000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 191520, "num_env_steps_trained_lifetime": 528000, "num_env_steps_trained_lifetime_throughput": 4163.538571945652, "num_module_steps_trained_throughput": 19659257.051259547, "num_module_steps_trained_lifetime_throughput": 13380786.473852273}, "IntrinsicAttentionMask": [[[0.0910959467291832, 0.09148722141981125, 0.09047853201627731, 0.09078855067491531, 0.09102046489715576, 0.091332346200943, 0.09094339609146118, 0.09125500172376633, 0.09024886786937714, 0.09021065384149551, 0.09113911539316177], [0.09055280685424805, 0.08982402831315994, 0.09172133356332779, 0.09113173186779022, 0.09069442749023438, 0.09011142700910568, 0.09083940088748932, 0.09025546908378601, 0.0921618789434433, 0.0922355055809021, 0.09047196060419083], [0.09193235635757446, 0.09415680915117264, 0.08851009607315063, 0.09021516889333725, 0.09150826185941696, 0.09327109158039093, 0.09107684344053268, 0.09283135831356049, 0.08726413547992706, 0.0870581865310669, 0.09217564761638641], [0.09151558578014374, 0.09280943125486374, 0.08949951082468033, 0.09050793200731277, 0.09126745164394379, 0.09229578822851181, 0.09101454168558121, 0.09204002469778061, 0.08875755220651627, 0.08863449096679688, 0.09165772050619125], [0.09119956195354462, 0.09181059896945953, 0.09023834764957428, 0.090720534324646, 0.09108186513185501, 0.09156855940818787, 0.09096172451972961, 0.09144777804613113, 0.08988174051046371, 0.0898224413394928, 0.09126690775156021], [0.0907689779996872, 0.09047970920801163, 0.0912298634648323, 0.09099775552749634, 0.09082502126693726, 0.09059395641088486, 0.09088234603404999, 0.09065112471580505, 0.09140269458293915, 0.09143153578042984, 0.09073695540428162], [0.09130498766899109, 0.09214168041944504, 0.0899929404258728, 0.09065049141645432, 0.09114404767751694, 0.09181001037359238, 0.09097986668348312, 0.09164462238550186, 0.08950748294591904, 0.08942682296037674, 0.09139710664749146], [0.09087634831666946, 0.0908084362745285, 0.09098421037197113, 0.09092994034290314, 0.09088948369026184, 0.09083527326583862, 0.09090292453765869, 0.09084869921207428, 0.09102455526590347, 0.0910312756896019, 0.09086883813142776], [0.09223683923482895, 0.09516394883394241, 0.08777595311403275, 0.08999200910329819, 0.09168122708797455, 0.09399588406085968, 0.09111683070659637, 0.093417227268219, 0.08616483956575394, 0.08589921146631241, 0.092555932700634], [0.09228716790676117, 0.0953323170542717, 0.08765370398759842, 0.08995436131954193, 0.09170957654714584, 0.0941166952252388, 0.09112298488616943, 0.09351471066474915, 0.08598249405622482, 0.08570707589387894, 0.09261894971132278], [0.09103650599718094, 0.09130262583494186, 0.09061583876609802, 0.09082717448472977, 0.09098513424396515, 0.09119733422994614, 0.09093265235424042, 0.09114473313093185, 0.09045913070440292, 0.0904330387711525, 0.09106588363647461]], [[0.08819590508937836, 0.08612895756959915, 0.08592646569013596, 0.08757532387971878, 0.08552291989326477, 0.08861689269542694, 0.0869591161608696, 0.09010503441095352, 0.12611985206604004, 0.08613894879817963, 0.08871052414178848], [0.08633439242839813, 0.08328361809253693, 0.08298676460981369, 0.08541451394557953, 0.0823962390422821, 0.0869603306055069, 0.08450443297624588, 0.08918530493974686, 0.1485363095998764, 0.08329827338457108, 0.08709977567195892], [0.0861310064792633, 0.08298635482788086, 0.08268057554960251, 0.08518241345882416, 0.08207239210605621, 0.08677667379379272, 0.0842442661523819, 0.08907303214073181, 0.15093138813972473, 0.08300144970417023, 0.08692052215337753], [0.08767662197351456, 0.08530981093645096, 0.0850784182548523, 0.08696510642766953, 0.0846175029873848, 0.08815973252058029, 0.08625936508178711, 0.08987031877040863, 0.1324746012687683, 0.08532123267650604, 0.0882672369480133], [0.08571375906467438, 0.08238358795642853, 0.08206020295619965, 0.08470834791660309, 0.08141724020242691, 0.08639851212501526, 0.08371473103761673, 0.08883658051490784, 0.15581639111042023, 0.08239955455064774, 0.08655112236738205], [0.08852991461753845, 0.08666826784610748, 0.08648563921451569, 0.08797145634889603, 0.08612155169248581, 0.08890852332115173, 0.08741652220487595, 0.09024541079998016, 0.12198267132043839, 0.08667726814746857, 0.08899272233247757], [0.08712799102067947, 0.08446705341339111, 0.08420742303133011, 0.08632703125476837, 0.08369056135416031, 0.08767233043909073, 0.08553344756364822, 0.08960289508104324, 0.13909782469272614, 0.08447986096143723, 0.0877935141324997], [0.08959932625293732, 0.08847371488809586, 0.08836277574300766, 0.08926268666982651, 0.0881413072347641, 0.08982706815004349, 0.08892730623483658, 0.09062809497117996, 0.10842087119817734, 0.0884791910648346, 0.0898776575922966], [0.0925302505493164, 0.10871719568967819, 0.11047074943780899, 0.09708025306463242, 0.11406315863132477, 0.08958285301923752, 0.10185398906469345, 0.07999401539564133, 0.008134126663208008, 0.10863152146339417, 0.08894196897745132], [0.08634434640407562, 0.0832982063293457, 0.08300179243087769, 0.08542586863040924, 0.08241213858127594, 0.08696931600570679, 0.08451718091964722, 0.08919075131416321, 0.14841914176940918, 0.08331283926963806, 0.08710853010416031], [0.08860226720571518, 0.08678646385669708, 0.08660829067230225, 0.08805766701698303, 0.08625302463769913, 0.08897142857313156, 0.0875164195895195, 0.0902746394276619, 0.12108103185892105, 0.08679525554180145, 0.08905351907014847]], [[0.09078570455312729, 0.09041865915060043, 0.09146451950073242, 0.09152606129646301, 0.09004992991685867, 0.09066224843263626, 0.09072325378656387, 0.09078428894281387, 0.09183438122272491, 0.0913369283080101, 0.09041406959295273], [0.09064896404743195, 0.08988773077726364, 0.09206559509038925, 0.0921945869922638, 0.08912637084722519, 0.09039255231618881, 0.09051920473575592, 0.09064603596925735, 0.09284226596355438, 0.09179846197366714, 0.08987824618816376], [0.09102825820446014, 0.09139367192983627, 0.0903601348400116, 0.090300053358078, 0.09176374971866608, 0.09115083515644073, 0.09109023213386536, 0.09102965891361237, 0.09000023454427719, 0.09048496186733246, 0.09139826148748398], [0.09104958176612854, 0.09148161858320236, 0.09026047587394714, 0.09018956869840622, 0.09191947430372238, 0.09119447320699692, 0.0911228284239769, 0.09105123579502106, 0.08983584493398666, 0.09040781855583191, 0.09148703515529633], [0.0905076190829277, 0.08935177326202393, 0.09267216920852661, 0.09287013113498688, 0.08820084482431412, 0.09011772274971008, 0.0903102308511734, 0.09050314873456955, 0.09386633336544037, 0.09226265549659729, 0.08933739364147186], [0.0907401442527771, 0.09024037420749664, 0.09166638553142548, 0.09175047278404236, 0.08973904699087143, 0.09057196974754333, 0.09065505862236023, 0.0907382220029831, 0.09217210114002228, 0.09149210155010223, 0.09023413062095642], [0.09076271206140518, 0.09032849967479706, 0.09156659990549088, 0.09163952618837357, 0.08989262580871582, 0.0906166285276413, 0.0906888097524643, 0.09076104313135147, 0.09200506657361984, 0.0914154201745987, 0.0903230831027031], [0.09078517556190491, 0.09041661024093628, 0.09146681427955627, 0.09152860939502716, 0.09004636108875275, 0.09066120535135269, 0.09072245657444, 0.0907837525010109, 0.09183822572231293, 0.09133869409561157, 0.09041200578212738], [0.09115484356880188, 0.0919211357831955, 0.08976241201162338, 0.08963774144649506, 0.09270060062408447, 0.0914115160703659, 0.09128455817699432, 0.09115777164697647, 0.08901697397232056, 0.09002170711755753, 0.09193076193332672], [0.09098368138074875, 0.09121110290288925, 0.09056698530912399, 0.09052945673465729, 0.0914410650730133, 0.09106000512838364, 0.09102227538824081, 0.09098455309867859, 0.09034203737974167, 0.09064491838216782, 0.09121394902467728], [0.09064723551273346, 0.08988109230995178, 0.09207312762737274, 0.09220296889543533, 0.08911484479904175, 0.09038916230201721, 0.09051663428544998, 0.09064427763223648, 0.09285493195056915, 0.09180422872304916, 0.08987153321504593]], [[0.08432170748710632, 0.08403131365776062, 0.08640529215335846, 0.08345350623130798, 0.08581116050481796, 0.08761291205883026, 0.08259423077106476, 0.08701048046350479, 0.1469651460647583, 0.08404560387134552, 0.08774865418672562], [0.08404949307441711, 0.0837499126791954, 0.08619997650384903, 0.08315394073724747, 0.08558658510446548, 0.08744721114635468, 0.08226794749498367, 0.0868249461054802, 0.14936791360378265, 0.08376463502645493, 0.08758743852376938], [0.08616314828395844, 0.08593981713056564, 0.08775995671749115, 0.08549489080905914, 0.08730560541152954, 0.08868108689785004, 0.08483181893825531, 0.088221974670887, 0.1308664083480835, 0.0859508067369461, 0.08878442645072937], [0.08349597454071045, 0.08317827433347702, 0.08577879518270493, 0.08254648745059967, 0.08512725681066513, 0.08710455149412155, 0.08160779625177383, 0.08644294738769531, 0.15427035093307495, 0.08319390565156937, 0.08725368231534958], [0.08565748482942581, 0.0854148268699646, 0.08739417791366577, 0.08493157476186752, 0.08689972758293152, 0.08839733153581619, 0.0842118188738823, 0.08789721131324768, 0.13525913655757904, 0.08542676270008087, 0.0885099247097969], [0.08714576065540314, 0.08696213364601135, 0.08845613896846771, 0.0865960344672203, 0.08808375149965286, 0.08920999616384506, 0.08604978024959564, 0.08883443474769592, 0.12239627540111542, 0.08697117120027542, 0.08929447084665298], [0.0826428234577179, 0.08229853957891464, 0.08512026816606522, 0.08161427080631256, 0.08441253751516342, 0.08656195551156998, 0.08059851825237274, 0.08584222942590714, 0.1618691235780716, 0.08231547474861145, 0.08672424405813217], [0.08666300028562546, 0.08645949512720108, 0.0881165936589241, 0.08605392277240753, 0.08770325034856796, 0.08895396441221237, 0.08544914424419403, 0.08853670209646225, 0.12654654681682587, 0.08646951615810394, 0.0890478566288948], [0.10410713404417038, 0.10578632354736328, 0.09296364337205887, 0.10922640562057495, 0.0959867462515831, 0.08716782182455063, 0.11459740251302719, 0.09000243991613388, 0.007914852350950241, 0.1057029664516449, 0.0865442231297493], [0.08406297117471695, 0.08376383781433105, 0.08621017634868622, 0.08316876739263535, 0.08559772372245789, 0.08745546638965607, 0.08228407800197601, 0.08683416247367859, 0.14924877882003784, 0.08377855271100998, 0.08759547024965286], [0.08725254237651825, 0.087073415517807, 0.08853057026863098, 0.08671623468399048, 0.08816742897033691, 0.08926559239625931, 0.08618323504924774, 0.08889943361282349, 0.12148135155439377, 0.08708222210407257, 0.0893479511141777]], [[0.09083615988492966, 0.0899183601140976, 0.09151535481214523, 0.09157693386077881, 0.09009998291730881, 0.09071264415979385, 0.09077367931604385, 0.09083475172519684, 0.0913262590765953, 0.09138770401477814, 0.09101822227239609], [0.09062401950359344, 0.08727193623781204, 0.09316449612379074, 0.0933973491191864, 0.08792795985937119, 0.09016749262809753, 0.09039285778999329, 0.09061878174543381, 0.09245199710130692, 0.09268307685852051, 0.09129996597766876], [0.09097837656736374, 0.0918966606259346, 0.09031061828136444, 0.09025057405233383, 0.09171346575021744, 0.09110088646411896, 0.09104031324386597, 0.09097978472709656, 0.09049554914236069, 0.09043537825345993, 0.09079841524362564], [0.09099065512418747, 0.09207682311534882, 0.09020205587148666, 0.09013119339942932, 0.09185998141765594, 0.09113544970750809, 0.09106384962797165, 0.09099230170249939, 0.09042034298181534, 0.09034930914640427, 0.09077801555395126], [0.09066782891750336, 0.08779314160346985, 0.09283620864152908, 0.093034528195858, 0.08835697919130325, 0.09027724713087082, 0.090470090508461, 0.0906633585691452, 0.0922289490699768, 0.09242597222328186, 0.0912456288933754], [0.09080895036458969, 0.0895603746175766, 0.09173588454723358, 0.09182003885507584, 0.08980709314346313, 0.09064064174890518, 0.09072379767894745, 0.09080702066421509, 0.09147754311561584, 0.0915614664554596, 0.09105716645717621], [0.09082245081663132, 0.08973719924688339, 0.09162686765193939, 0.09169984608888626, 0.08995179086923599, 0.09067627042531967, 0.09074849635362625, 0.0908207818865776, 0.09140278398990631, 0.09147558361291885, 0.09103796631097794], [0.09083583950996399, 0.08991425484418869, 0.0915178656578064, 0.09157969802618027, 0.0900966227054596, 0.090711809694767, 0.0907730981707573, 0.09083442389965057, 0.0913279727101326, 0.09138967096805573, 0.0910186618566513], [0.09094003587961197, 0.09134417772293091, 0.0906447172164917, 0.09061809629201889, 0.09126373380422592, 0.09099408239126205, 0.09096736460924149, 0.09094064682722092, 0.09072662889957428, 0.09069998562335968, 0.09086056798696518], [0.09095259755849838, 0.09152355045080185, 0.09053604304790497, 0.09049852192401886, 0.09140981733798981, 0.09102889150381088, 0.09099116921424866, 0.09095346927642822, 0.0906515121459961, 0.090613953769207, 0.09084044396877289], [0.09087549895048141, 0.09044700115919113, 0.0911911129951477, 0.09121966361999512, 0.09053197503089905, 0.09081796556711197, 0.09084639698266983, 0.09087484329938889, 0.09110336005687714, 0.09113188832998276, 0.09096022695302963]], [[0.08763056993484497, 0.08742455393075943, 0.08537568151950836, 0.08701397478580475, 0.0849747285246849, 0.08994989842176437, 0.08640170842409134, 0.087635338306427, 0.12801693379878998, 0.08743469417095184, 0.08814189583063126], [0.08742959052324295, 0.08721351623535156, 0.08506600558757782, 0.08678295463323593, 0.08464605361223221, 0.08986398577690125, 0.08614110201597214, 0.08743459731340408, 0.13023196160793304, 0.08722414076328278, 0.08796600252389908], [0.08520913869142532, 0.08489516377449036, 0.08179564028978348, 0.08427069336175919, 0.0811939686536789, 0.08877265453338623, 0.08334259688854218, 0.08521641045808792, 0.15440289676189423, 0.08491060882806778, 0.08599020540714264], [0.08701736479997635, 0.086781345307827, 0.08443871140480042, 0.0863112062215805, 0.08398126065731049, 0.08968041092157364, 0.0856107696890831, 0.0870228260755539, 0.1347595900297165, 0.086792953312397, 0.08760354667901993], [0.08472462743520737, 0.08439205586910248, 0.08111324161291122, 0.08373083174228668, 0.08047769218683243, 0.088504858314991, 0.08274867385625839, 0.08473233878612518, 0.15961496531963348, 0.08440840989351273, 0.08555232733488083], [0.08964049071073532, 0.0895497128367424, 0.08864021301269531, 0.08936843276023865, 0.0884607806801796, 0.09065418690443039, 0.08909720182418823, 0.08964258432388306, 0.10552692413330078, 0.08955418318510056, 0.08986527472734451], [0.08637286722660065, 0.08610738068819046, 0.08347760885953903, 0.08557885140180588, 0.08296522498130798, 0.08937489241361618, 0.08479214459657669, 0.08637901395559311, 0.1417989581823349, 0.08612044155597687, 0.08703262358903885], [0.08763517439365387, 0.08742938935756683, 0.08538281172513962, 0.08701927214860916, 0.08498229086399078, 0.08995184302330017, 0.08640769869089127, 0.0876399353146553, 0.12796610593795776, 0.08743951469659805, 0.0881459191441536], [0.09521652013063431, 0.0968584194779396, 0.11506634950637817, 0.10022766143083572, 0.11906895786523819, 0.0787598043680191, 0.10550254583358765, 0.09517889469861984, 0.006067563779652119, 0.09677688777446747, 0.09127642959356308], [0.08743957430124283, 0.08722399175167084, 0.0850813239812851, 0.086794413626194, 0.0846623033285141, 0.08986832201480865, 0.0861540213227272, 0.08744456619024277, 0.1301220953464508, 0.08723460137844086, 0.08797475695610046], [0.08811285346746445, 0.08793195337057114, 0.08612989634275436, 0.08757126331329346, 0.08577659726142883, 0.09014575183391571, 0.08703301101922989, 0.08811704069375992, 0.12267912179231644, 0.08794084936380386, 0.08856161683797836]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_duration_sec_mean": 0.00559996998985298, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.977008269029931e-06, "listify_data_for_vector_env": 1.042062595852747e-05, "un_batch_to_individual_items": 6.551496765099051e-06, "tensor_to_numpy": 1.4838502762011294e-05, "remove_single_ts_time_rank_from_batch": 1.1947707720339944e-05, "get_actions": 3.549733433880051e-05}}, "connector_pipeline_timer": 0.00011384434014190748}, "env_to_module_connector": {"connector_pipeline_timer": 5.848909825851059e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.69479690213957e-06, "numpy_to_tensor": 1.189670547530308e-05, "add_states_from_episodes_to_batch": 2.6755935010824056e-06, "add_observations_from_episodes_to_batch": 2.794097457924494e-06, "batch_individual_items": 1.2324729698358067e-05}}}, "env_step_timer": 1.3830363729764018e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 0.75, "episode_return_max": 14.5, "module_episode_returns_mean": {"default_policy": 0.75}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 0.75}, "num_env_steps_sampled": 400, "episode_len_max": 20, "weights_seq_no": 16.0, "num_episodes": 20, "num_env_steps_sampled_lifetime": 80400, "env_reset_timer": 0.0006185432015165831, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -14.5, "episode_len_mean": 20.0, "num_episodes_lifetime": 320, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 3.093371060907978e-05, "sample": 0.12990573726852467, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "time_between_sampling": 9.954412536535441}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "ba9e8_00000", "date": "2025-08-11_18-10-35", "timestamp": 1754928635, "time_this_iter_s": 10.569581985473633, "time_total_s": 162.53480076789856, "pid": 10327, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3858fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 162.53480076789856, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 51.033333333333324, "ram_util_percent": 82.83333333333333}}
{"timers": {"training_iteration": 9.496700532922137, "restore_env_runners": 1.8090824520565784e-05, "training_step": 9.49646486649763, "env_runner_sampling_timer": 1.770426657653588, "learner_update_timer": 7.538378452684531, "synch_weights": 0.0015047146973701762, "restore_eval_env_runners": 5.336980326156104e-05, "evaluation_iteration": 0.14270305316926304, "synch_eval_env_connectors": 0.00019769513126942736, "synch_env_connectors": 6.786735173451843e-06}, "env_runners": {"env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 1.8600000000000003}, "rlmodule_inference_timer": 3.284770554317659e-05, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5942533873006832e-05, "get_actions": 4.071228165013844e-05, "listify_data_for_vector_env": 1.0763998051619428e-05, "un_batch_to_individual_items": 6.763361030340179e-06, "remove_single_ts_time_rank_from_batch": 1.2140066696856861e-05, "normalize_and_clip_actions": 8.252469079120883e-06}}, "connector_pipeline_timer": 0.00012166030960207938}, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2725133658307994e-05, "add_states_from_episodes_to_batch": 2.810782457221131e-06, "add_time_dim_to_batch_and_zero_pad": 7.324454439656989e-06, "add_observations_from_episodes_to_batch": 2.9241584080395655e-06, "numpy_to_tensor": 1.301088159318044e-05}}, "connector_pipeline_timer": 6.126243495026408e-05}, "sample": 0.005924637239787704, "episode_duration_sec_mean": 0.005436962342821062, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "agent_episode_returns_mean": {"default_agent": 1.8600000000000003}, "weights_seq_no": 16.0, "episode_return_mean": 1.8600000000000003, "env_step_timer": 1.4533113436745457e-05, "episode_return_max": 8.5, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -9252500.0, "env_reset_timer": 4.532364027714004e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "time_between_sampling": 0.03573492421596313, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "episode_return_min": -11.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -462625.0, "num_env_steps_sampled_lifetime_throughput": 3179.4968126039903}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.14249725242235253, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009935525188451456, "add_observations_from_episodes_to_batch": 0.0010295250051105588, "add_columns_from_episodes_to_train_batch": 0.04464857307808481, "add_time_dim_to_batch_and_zero_pad": 0.07846278385337502, "add_states_from_episodes_to_batch": 0.003799103760489525, "batch_individual_items": 0.004334584669178534, "numpy_to_tensor": 8.876645186170093e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.35830453038215637, "module_train_batch_size_mean": 997.6777629636601, "num_module_steps_trained": 5985, "policy_loss": -0.0003770942857954651, "use_intrinsic_rewards": 0.0, "num_module_steps_trained_lifetime": 101745, "total_loss": 0.2777062952518463, "weights_seq_no": 17.0, "entropy": 0.6830963492393494, "mean_kl_loss": 2.053559001069516e-05, "vf_loss_unclipped": 41.06662368774414, "num_trainable_parameters": 16595, "curr_kl_coeff": 1.2327875538176158e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.0013228654861450195, "num_module_steps_trained_lifetime_throughput": 751.7480836541663}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1220940, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 3366000, "num_env_steps_trained_lifetime_throughput": 46165.42038447985}, "default_policy": {"num_module_steps_trained_lifetime": 610470, "weights_seq_no": 102.0, "diff_num_grad_updates_vs_sampler_policy": 86.0, "entropy": 0.6831474304199219, "mean_kl_loss": 1.8280206859344617e-05, "vf_loss_unclipped": 40.92024612426758, "vf_explained_var": 0.0012913346290588379, "num_module_steps_trained": 35910, "use_intrinsic_rewards": 1.0, "vf_loss": 0.35840627551078796, "module_train_batch_size_mean": 997.498558675304, "total_loss": 0.2778063416481018, "policy_loss": -0.0003591985732782632}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.498558675304, "num_module_steps_trained_lifetime": 610470, "total_loss": 0.0, "weights_seq_no": 102.0, "diff_num_grad_updates_vs_sampler_policy": 86.0}}}, "intrinsic_reward_module": {"weights_seq_no": 17.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.6777629636601, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5985, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 101745, "num_module_steps_trained_lifetime_throughput": 751.756612071021}, "__all_modules__": {"num_env_steps_trained": 33000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 203490, "num_env_steps_trained_lifetime": 561000, "num_env_steps_trained_lifetime_throughput": 4146.050224447075, "num_module_steps_trained_throughput": 19255779.5204289, "num_module_steps_trained_lifetime_throughput": 13304621.470664198}, "IntrinsicAttentionMask": [[[0.0908362939953804, 0.09046905487775803, 0.09151548892259598, 0.09157706797122955, 0.09010011702775955, 0.09016074240207672, 0.0907738134264946, 0.09083488583564758, 0.09132639318704605, 0.09138783812522888, 0.09101835638284683], [0.09075462818145752, 0.08999250829219818, 0.09217290580272675, 0.09230204671621323, 0.0892302617430687, 0.08935528248548508, 0.09062471240758896, 0.09075169265270233, 0.09177687019109726, 0.09190545976161957, 0.09113367646932602], [0.09097850322723389, 0.0913437232375145, 0.09031074494123459, 0.09025070071220398, 0.09171359241008759, 0.09165260940790176, 0.09104043990373611, 0.09097990393638611, 0.09049567580223083, 0.09043549746274948, 0.09079854190349579], [0.09099084883928299, 0.09142260253429413, 0.09020224958658218, 0.09013138711452484, 0.09186017513275146, 0.09178800880908966, 0.09106404334306717, 0.0909925028681755, 0.09042053669691086, 0.09034950286149979, 0.09077821671962738], [0.0906691700220108, 0.08951126784086227, 0.09283757954835892, 0.09303589910268784, 0.08835829049348831, 0.08854703605175018, 0.09047143161296844, 0.09066469967365265, 0.09223030507564545, 0.0924273356795311, 0.09124696999788284], [0.09068344533443451, 0.08959051966667175, 0.09272807091474533, 0.09291493147611618, 0.08850143849849701, 0.08867978304624557, 0.09049686044454575, 0.09067922830581665, 0.09215574711561203, 0.09234145283699036, 0.09122853726148605], [0.09082263708114624, 0.09038814157247543, 0.09162705391645432, 0.09170003235340118, 0.08995198458433151, 0.09002362936735153, 0.09074868261814117, 0.09082096815109253, 0.09140297025442123, 0.09147576987743378, 0.09103815257549286], [0.09083598852157593, 0.09046721458435059, 0.09151800721883774, 0.09157983958721161, 0.09009676426649094, 0.0901576355099678, 0.09077323973178864, 0.09083456546068192, 0.09132811427116394, 0.09138981252908707, 0.09101880341768265], [0.09094005823135376, 0.09110106527805328, 0.09064473956823349, 0.09061812609434128, 0.09126375615596771, 0.09123695641756058, 0.09096738696098328, 0.0909406766295433, 0.09072664380073547, 0.09070000797510147, 0.09086058288812637], [0.09095264971256256, 0.0911799818277359, 0.09053608775138855, 0.09049857407808304, 0.09140986949205399, 0.09137199074029922, 0.09099122136831284, 0.0909535214304924, 0.09065156430006027, 0.09061400592327118, 0.09084049612283707], [0.0908755362033844, 0.09070435911417007, 0.09119115024805069, 0.0912197008728981, 0.09053201973438263, 0.09056036174297333, 0.09084643423557281, 0.09087488055229187, 0.09110339730978012, 0.09113192558288574, 0.09096026420593262]], [[0.09190702438354492, 0.09321674704551697, 0.09305354952812195, 0.09289064258337021, 0.09272801876068115, 0.09521396458148956, 0.09094583988189697, 0.09488087892532349, 0.07043459266424179, 0.09322478622198105, 0.09150398522615433], [0.09141639620065689, 0.09199167042970657, 0.09192024171352386, 0.09184885770082474, 0.09177754074335098, 0.09286032617092133, 0.0909912958741188, 0.09271616488695145, 0.08124388754367828, 0.09199519455432892, 0.09123844653367996], [0.09148570150136948, 0.09215125441551208, 0.09206857532262802, 0.09198597073554993, 0.0919034406542778, 0.09315744787454605, 0.09099430590867996, 0.09299036115407944, 0.07982771098613739, 0.0921553298830986, 0.09127996116876602], [0.09155251085758209, 0.09230854362249374, 0.09221458435058594, 0.09212072193622589, 0.0920269563794136, 0.09345292299985886, 0.09099479764699936, 0.09326276928186417, 0.0784340649843216, 0.09231317788362503, 0.09131895750761032], [0.09161687642335892, 0.09246358275413513, 0.0923583135008812, 0.09225316345691681, 0.09214812517166138, 0.09374678134918213, 0.09099280089139938, 0.09353343397378922, 0.07706262916326523, 0.09246877580881119, 0.09135548025369644], [0.09036858379840851, 0.08987043797969818, 0.08993197977542877, 0.08999355882406235, 0.09005517512559891, 0.0891292616724968, 0.09074049443006516, 0.08925136178731918, 0.10026784241199493, 0.08986741304397583, 0.0905238687992096], [0.09217556565999985, 0.09403784573078156, 0.0938052088022232, 0.09357314556837082, 0.09334166347980499, 0.09689854830503464, 0.09081581234931946, 0.09641970694065094, 0.06327857077121735, 0.09404931962490082, 0.09160468727350235], [0.09056976437568665, 0.09024639427661896, 0.09028637409210205, 0.09032637625932693, 0.09036638587713242, 0.0897640734910965, 0.09081078320741653, 0.08984363079071045, 0.09687133133411407, 0.09024441987276077, 0.09067043662071228], [0.08643961697816849, 0.10166870802640915, 0.09964608401060104, 0.09766370803117752, 0.09572075307369232, 0.12964974343776703, 0.07662147283554077, 0.1245424896478653, 0.004087132401764393, 0.10176938027143478, 0.08219091594219208], [0.09141291677951813, 0.09198375046253204, 0.09191287308931351, 0.09184204041957855, 0.09177127480506897, 0.09284564852714539, 0.09099108725786209, 0.09270261228084564, 0.08131421357393265, 0.091987244784832, 0.09123633801937103], [0.09202873706817627, 0.0935688242316246, 0.09337671846151352, 0.09318500757217407, 0.09299369901418686, 0.09592453390359879, 0.09090089797973633, 0.09553106129169464, 0.067356638610363, 0.09357830137014389, 0.09155557304620743]], [[0.09083621948957443, 0.09046897292137146, 0.09095849841833115, 0.09157699346542358, 0.09010004252195358, 0.09071270376443863, 0.09077373892068863, 0.09083481132984161, 0.09132631868124008, 0.09194730967283249, 0.09046439081430435], [0.09075430780649185, 0.08999219536781311, 0.09100878983736038, 0.09230171889066696, 0.08922994881868362, 0.09049760550260544, 0.09062439948320389, 0.09075137227773666, 0.09177654981613159, 0.09308037906885147, 0.08998269587755203], [0.0908627137541771, 0.09062712639570236, 0.09094107896089554, 0.09133687615394592, 0.09039011597633362, 0.0907835140824318, 0.09082265198230743, 0.09086181223392487, 0.09117656946182251, 0.09157339483499527, 0.09062418341636658], [0.09099075943231583, 0.09142250567674637, 0.09084784239530563, 0.09013129770755768, 0.0918600782752037, 0.09113554656505585, 0.09106394648551941, 0.09099240601062775, 0.0904204472899437, 0.08970727026462555, 0.09142792224884033], [0.09066841751337051, 0.08951053023338318, 0.0910562053322792, 0.09303512424230576, 0.08835756033658981, 0.09027782827615738, 0.09047068655490875, 0.09066395461559296, 0.09222954511642456, 0.09423396736383438, 0.08949612826108932], [0.09080906957387924, 0.09030891954898834, 0.09097575396299362, 0.09182015806436539, 0.08980721235275269, 0.09064076840877533, 0.090723916888237, 0.09080714732408524, 0.0914776623249054, 0.09232672303915024, 0.09030266851186752], [0.09082253277301788, 0.09038804471492767, 0.09096727520227432, 0.09169992804527283, 0.08995188772678375, 0.09067635983228683, 0.09074858576059341, 0.09082086384296417, 0.09140287339687347, 0.09213903546333313, 0.09038262069225311], [0.09083592146635056, 0.09046715497970581, 0.09095869958400726, 0.09157977253198624, 0.09009670466184616, 0.09071189165115356, 0.09077317267656326, 0.09083450585603714, 0.09132804721593857, 0.0919516384601593, 0.09046255052089691], [0.09094004333019257, 0.09110105037689209, 0.09088664501905441, 0.09061811119318008, 0.09126374125480652, 0.09099408984184265, 0.09096737205982208, 0.09094066172838211, 0.09072662889957428, 0.09045857191085815, 0.09110306948423386], [0.09106273949146271, 0.09189507365226746, 0.09078802168369293, 0.08941666036844254, 0.09274235367774963, 0.09134146571159363, 0.09120358526706696, 0.091065913438797, 0.08996884524822235, 0.08860985934734344, 0.09190554171800613], [0.09075327217578888, 0.08998623490333557, 0.09100940823554993, 0.0923108160495758, 0.0892191007733345, 0.09049490094184875, 0.09062252193689346, 0.0907503217458725, 0.09178218990564346, 0.09309463948011398, 0.08997667580842972]], [[0.08432173728942871, 0.08403134346008301, 0.08640532940626144, 0.08345352858304977, 0.08581119775772095, 0.08761293441057205, 0.08259426802396774, 0.08701049536466599, 0.146964892745018, 0.08404561132192612, 0.08774866908788681], [0.08404950797557831, 0.0837499275803566, 0.08620000630617142, 0.08315397053956985, 0.08558660000562668, 0.08744721859693527, 0.08226796239614487, 0.0868249461054802, 0.14936764538288116, 0.08376465737819672, 0.08758744597434998], [0.08616317063570023, 0.08593984693288803, 0.08775998651981354, 0.08549492061138153, 0.08730564266443253, 0.08868110179901123, 0.0848318412899971, 0.08822198957204819, 0.13086625933647156, 0.0859508290886879, 0.08878444135189056], [0.08349600434303284, 0.08317830413579941, 0.08577881753444672, 0.08254651725292206, 0.08512727916240692, 0.08710456639528275, 0.08160783350467682, 0.08644295483827591, 0.15427006781101227, 0.08319392800331116, 0.08725370466709137], [0.0856575071811676, 0.08541485667228699, 0.08739420771598816, 0.08493159711360931, 0.08689974993467331, 0.08839734643697739, 0.08421184867620468, 0.08789721876382828, 0.13525895774364471, 0.08542678505182266, 0.0885099470615387], [0.08714577555656433, 0.08696214109659195, 0.08845614641904831, 0.0865960419178009, 0.08808375895023346, 0.08921000361442566, 0.08604978770017624, 0.08883444219827652, 0.12239624559879303, 0.08697117865085602, 0.08929448574781418], [0.08264286816120148, 0.08229858428239822, 0.0851203054189682, 0.08161430805921555, 0.0844125747680664, 0.08656196296215057, 0.08059855550527573, 0.08584224432706833, 0.16186882555484772, 0.08231550455093384, 0.08672427386045456], [0.08666300773620605, 0.08645950257778168, 0.0881166011095047, 0.08605393022298813, 0.08770325779914856, 0.08895396441221237, 0.08544914424419403, 0.08853669464588165, 0.1265464872121811, 0.08646950870752335, 0.0890478566288948], [0.1041070818901062, 0.1057862713932991, 0.09296364337205887, 0.10922633111476898, 0.0959867313504219, 0.08716791123151779, 0.11459730565547943, 0.09000252187252045, 0.007914990186691284, 0.1057029515504837, 0.08654426783323288], [0.08406300097703934, 0.08376386761665344, 0.0862102061510086, 0.08316879719495773, 0.08559776097536087, 0.08745548129081726, 0.0822841078042984, 0.08683418482542038, 0.14924860000610352, 0.08377857506275177, 0.08759550005197525], [0.08725256472826004, 0.0870734229683876, 0.08853059262037277, 0.08671626448631287, 0.08816744387149811, 0.0892656072974205, 0.08618324995040894, 0.08889944851398468, 0.1214812695980072, 0.08708223700523376, 0.0893479660153389]], [[0.09078556299209595, 0.09041851758956909, 0.09146437793970108, 0.09152591973543167, 0.09004979580640793, 0.09066210687160492, 0.09072310477495193, 0.09023167937994003, 0.09127537906169891, 0.09189602732658386, 0.09096752107143402], [0.09064838290214539, 0.08988715708255768, 0.0920649915933609, 0.09219398349523544, 0.08912580460309982, 0.09039197862148285, 0.09051862359046936, 0.08950094878673553, 0.09166942536830902, 0.09297173470258713, 0.09102699160575867], [0.0910281240940094, 0.09139353036880493, 0.09036000818014145, 0.09029991924762726, 0.09176360815763474, 0.0911506935954094, 0.09109009057283401, 0.09158068150281906, 0.09054503589868546, 0.08994026482105255, 0.09084805846214294], [0.09104940295219421, 0.09148143231868744, 0.09026030451059341, 0.0901893898844719, 0.09191928803920746, 0.09119429439306259, 0.09112264961004257, 0.09170281141996384, 0.09047873318195343, 0.08976509422063828, 0.09083662927150726], [0.09050626307725906, 0.08935043960809708, 0.09267076849937439, 0.09286873042583466, 0.08819953352212906, 0.09011637419462204, 0.09030888229608536, 0.08876598626375198, 0.09206458926200867, 0.09406542778015137, 0.09108302742242813], [0.090739905834198, 0.09024012833833694, 0.09166612476110458, 0.09175021946430206, 0.08973880857229233, 0.09057172387838364, 0.09065481275320053, 0.08998600393533707, 0.09140798449516296, 0.09225639700889587, 0.090987928211689], [0.09076252579689026, 0.09032832086086273, 0.09156640619039536, 0.09163933247327805, 0.0898924469947815, 0.09061644971370697, 0.09068862348794937, 0.09010741859674454, 0.09134247153997421, 0.09207814931869507, 0.09097789973020554], [0.0905769020318985, 0.08961555361747742, 0.09237165004014969, 0.09253542870283127, 0.08865619450807571, 0.09025285392999649, 0.09041288495063782, 0.08912862837314606, 0.09186974912881851, 0.0935242772102356, 0.09105585515499115], [0.09096203744411469, 0.0911230817437172, 0.09066664427518845, 0.09064002335071564, 0.0912858098745346, 0.09101609885692596, 0.0909893736243248, 0.0912054181098938, 0.09074857831001282, 0.09048044681549072, 0.0908825471997261], [0.09117492288351059, 0.09200829267501831, 0.08966216444969177, 0.08952681720256805, 0.09285660833120346, 0.09145399928092957, 0.09131594747304916, 0.09243673831224442, 0.09007968753576279, 0.08871902525424957, 0.0907658264040947], [0.09085199236869812, 0.09068085998296738, 0.09116752445697784, 0.09119606763124466, 0.09050857275724411, 0.09079448133707047, 0.09082290530204773, 0.0905936062335968, 0.09107980132102966, 0.09136751294136047, 0.09093670547008514]], [[0.08828511089086533, 0.08621607720851898, 0.08601339161396027, 0.08581116795539856, 0.08560943603515625, 0.08870651572942734, 0.08520737290382385, 0.08828990906476974, 0.12897297739982605, 0.0880877673625946, 0.08880025148391724], [0.08638852834701538, 0.08333583921194077, 0.0830387994647026, 0.08274282515048981, 0.08244789391756058, 0.08701483905315399, 0.08186120539903641, 0.08639564365148544, 0.15352432429790497, 0.08609575033187866, 0.08715437352657318], [0.08617816120386124, 0.0830317959189415, 0.08272585272789001, 0.08242103457450867, 0.08211733400821686, 0.08682416379451752, 0.08151330053806305, 0.0861855074763298, 0.15615850687026978, 0.0858762338757515, 0.08696810901165009], [0.085963673889637, 0.08272441476583481, 0.08240964263677597, 0.08209607005119324, 0.08178369700908661, 0.0866292417049408, 0.08116250485181808, 0.08597125113010406, 0.15882933139801025, 0.085652656853199, 0.08677756041288376], [0.08574503660202026, 0.08241365104913712, 0.08209015429019928, 0.08176791667938232, 0.08144694566726685, 0.08643002808094025, 0.08080880343914032, 0.08575281500816345, 0.16153699159622192, 0.0854249969124794, 0.08658269047737122], [0.08861888200044632, 0.08675535768270493, 0.0865725502371788, 0.08639013767242432, 0.08620809763669968, 0.08899787068367004, 0.08584517240524292, 0.08862320333719254, 0.124465212225914, 0.08844134211540222, 0.08908215165138245], [0.085295170545578, 0.08178196847438812, 0.08144127577543259, 0.08110199123620987, 0.08076412975788116, 0.08601859956979752, 0.08009260892868042, 0.08530338853597641, 0.16706368327140808, 0.0849572941660881, 0.08617988228797913], [0.08828900754451752, 0.08622229844331741, 0.0860198438167572, 0.0858178436756134, 0.0856163278222084, 0.08870992064476013, 0.08521471172571182, 0.08829379826784134, 0.128920778632164, 0.0880918875336647, 0.08880356699228287], [0.08948854357004166, 0.10631097108125687, 0.10814418643712997, 0.11000901460647583, 0.11190599203109741, 0.08644620329141617, 0.11579865217208862, 0.08945324271917343, 0.005702646914869547, 0.09095507115125656, 0.08578552305698395], [0.08812297880649567, 0.08595822006464005, 0.08574629575014114, 0.08553487807512283, 0.0853239893913269, 0.08856417238712311, 0.0849037766456604, 0.0881279930472374, 0.13113896548748016, 0.08791639655828476, 0.08866233378648758], [0.0886908769607544, 0.08687326312065125, 0.08669490367174149, 0.08651690930128098, 0.08633928745985031, 0.08906040340662003, 0.08598513156175613, 0.08869508653879166, 0.1234837993979454, 0.08851774036884308, 0.0891425684094429]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_duration_sec_mean": 0.005730345866177231, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.0325082662635199e-05, "listify_data_for_vector_env": 1.2509486691064884e-05, "un_batch_to_individual_items": 8.649845246850057e-06, "tensor_to_numpy": 1.687660572217205e-05, "remove_single_ts_time_rank_from_batch": 1.4380043672801974e-05, "get_actions": 4.8645114028014555e-05}}, "connector_pipeline_timer": 0.000143873262839031}, "env_to_module_connector": {"connector_pipeline_timer": 6.944258623885778e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.692263072558209e-06, "numpy_to_tensor": 1.4563012336088708e-05, "add_states_from_episodes_to_batch": 3.3458231439743085e-06, "add_observations_from_episodes_to_batch": 3.0733276231785205e-06, "batch_individual_items": 1.512314745488946e-05}}}, "env_step_timer": 1.8071454770118492e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.15, "episode_return_max": 14.5, "module_episode_returns_mean": {"default_policy": 1.15}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 1.15}, "num_env_steps_sampled": 400, "episode_len_max": 20, "weights_seq_no": 17.0, "num_episodes": 20, "num_env_steps_sampled_lifetime": 85400, "env_reset_timer": 0.0006153231902187907, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -14.5, "episode_len_mean": 20.0, "num_episodes_lifetime": 340, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 3.817346420459204e-05, "sample": 0.12991489989677701, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "time_between_sampling": 9.952280365329703}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "ba9e8_00000", "date": "2025-08-11_18-10-45", "timestamp": 1754928645, "time_this_iter_s": 9.847477912902832, "time_total_s": 172.3822786808014, "pid": 10327, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3858fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 172.3822786808014, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 46.31428571428571, "ram_util_percent": 81.57857142857142}}
{"timers": {"training_iteration": 9.508946702173745, "restore_env_runners": 1.8022836809225816e-05, "training_step": 9.508709273252897, "env_runner_sampling_timer": 1.7687546410767505, "learner_update_timer": 7.552275356068191, "synch_weights": 0.0015139817099238955, "restore_eval_env_runners": 5.320526519937795e-05, "evaluation_iteration": 0.14267248430692606, "synch_eval_env_connectors": 0.000197328179410382, "synch_env_connectors": 6.762197604501309e-06}, "env_runners": {"env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 0.09999999999999998}, "rlmodule_inference_timer": 3.2744204758117705e-05, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.600290062847256e-05, "get_actions": 4.0690789194013754e-05, "listify_data_for_vector_env": 1.0895299678273634e-05, "un_batch_to_individual_items": 6.811137531129659e-06, "remove_single_ts_time_rank_from_batch": 1.2270219924860915e-05, "normalize_and_clip_actions": 8.341256235939163e-06}}, "connector_pipeline_timer": 0.0001224043319389575}, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2849203986087606e-05, "add_states_from_episodes_to_batch": 2.8199529910736325e-06, "add_time_dim_to_batch_and_zero_pad": 7.341416784943419e-06, "add_observations_from_episodes_to_batch": 2.9552201343141676e-06, "numpy_to_tensor": 1.3128624408946281e-05}}, "connector_pipeline_timer": 6.16724742765522e-05}, "sample": 0.0059494459443940675, "episode_duration_sec_mean": 0.005466049840208142, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "agent_episode_returns_mean": {"default_agent": 0.09999999999999998}, "weights_seq_no": 17.0, "episode_return_mean": 0.09999999999999998, "env_step_timer": 1.4648690248492616e-05, "episode_return_max": 8.5, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -9870000.0, "env_reset_timer": 4.767515270043528e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "time_between_sampling": 0.03387486346703292, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "episode_return_min": -11.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -493500.0, "num_env_steps_sampled_lifetime_throughput": 3129.164051408191}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.14244857322765103, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009934195776109912, "add_observations_from_episodes_to_batch": 0.0010289589257655761, "add_columns_from_episodes_to_train_batch": 0.04463718067775618, "add_time_dim_to_batch_and_zero_pad": 0.07843119976514226, "add_states_from_episodes_to_batch": 0.0037977035521434143, "batch_individual_items": 0.004332965913206835, "numpy_to_tensor": 8.866003659802586e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.35830453038215637, "module_train_batch_size_mean": 997.6672132667843, "num_module_steps_trained": 5985, "policy_loss": -0.00045345354010351, "use_intrinsic_rewards": 0.0, "num_module_steps_trained_lifetime": 107730, "total_loss": 0.2776322066783905, "weights_seq_no": 18.0, "entropy": 0.6816226243972778, "mean_kl_loss": 5.8771805925061926e-05, "vf_loss_unclipped": 41.98166275024414, "num_trainable_parameters": 16595, "curr_kl_coeff": 6.163937769088079e-07, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.00035965442657470703, "num_module_steps_trained_lifetime_throughput": 748.0603920848619}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1292760, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 3564000, "num_env_steps_trained_lifetime_throughput": 45442.31882436694}, "default_policy": {"num_module_steps_trained_lifetime": 646380, "weights_seq_no": 108.0, "diff_num_grad_updates_vs_sampler_policy": 91.0, "entropy": 0.6816601157188416, "mean_kl_loss": 5.609203071799129e-05, "vf_loss_unclipped": 41.86257553100586, "vf_explained_var": 0.0014952421188354492, "num_module_steps_trained": 35910, "use_intrinsic_rewards": 1.0, "vf_loss": 0.35839998722076416, "module_train_batch_size_mean": 997.4982334615715, "total_loss": 0.2777283191680908, "policy_loss": -0.0004407633387017995}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.4982334615715, "num_module_steps_trained_lifetime": 646380, "total_loss": 0.0, "weights_seq_no": 108.0, "diff_num_grad_updates_vs_sampler_policy": 91.0}}}, "intrinsic_reward_module": {"weights_seq_no": 18.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.6672132667843, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5985, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 107730, "num_module_steps_trained_lifetime_throughput": 748.0683660595594}, "__all_modules__": {"num_env_steps_trained": 33000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 215460, "num_env_steps_trained_lifetime": 594000, "num_env_steps_trained_lifetime_throughput": 4125.67286184789, "num_module_steps_trained_throughput": 18868906.656375803, "num_module_steps_trained_lifetime_throughput": 13230649.537842251}, "IntrinsicAttentionMask": [[[0.09088652580976486, 0.09051907807588577, 0.09100887179374695, 0.09162770956754684, 0.09070191532373428, 0.09021059423685074, 0.09082400798797607, 0.09033203125, 0.0919363722205162, 0.09143836796283722, 0.09051448851823807], [0.09085872024297714, 0.09009573608636856, 0.09111349284648895, 0.09240791201591492, 0.09047495573759079, 0.08945777267217636, 0.09072866290807724, 0.08970861881971359, 0.09305708110332489, 0.09201086312532425, 0.09008622169494629], [0.09089498221874237, 0.09065930545330048, 0.0909733697772026, 0.09136930853128433, 0.09077661484479904, 0.09046119451522827, 0.09085490554571152, 0.09053920954465866, 0.09156643599271774, 0.09124826639890671, 0.09065636247396469], [0.09093162417411804, 0.0913630947470665, 0.09078880399465561, 0.09007272124290466, 0.09114792943000793, 0.09172826260328293, 0.09100477397441864, 0.09158419072628021, 0.08971945941448212, 0.09029070287942886, 0.09136850386857986], [0.09087301790714264, 0.09030678868293762, 0.09106181561946869, 0.09201893210411072, 0.09058837592601776, 0.08983239531517029, 0.09077658504247665, 0.09001903980970383, 0.09249763190746307, 0.09172572195529938, 0.09029972553253174], [0.09083250910043716, 0.08973778039216995, 0.09119895845651627, 0.09306765347719193, 0.09028138965368271, 0.08882556110620499, 0.09064561873674393, 0.08918391913175583, 0.09400917589664459, 0.09249322861433029, 0.08972416073083878], [0.0908820629119873, 0.09044728428125381, 0.09102689474821091, 0.09176003187894821, 0.09066358208656311, 0.09008253365755081, 0.09080806374549866, 0.09022609144449234, 0.0921260416507721, 0.09153562039136887, 0.09044186025857925], [0.09084314107894897, 0.08987897634506226, 0.09116558730602264, 0.09280743449926376, 0.09035792946815491, 0.08907446265220642, 0.09067864716053009, 0.08939062058925629, 0.09363315999507904, 0.09230317175388336, 0.08986697345972061], [0.09094613045454025, 0.091710664331913, 0.09069368243217468, 0.08943250775337219, 0.09132906049489975, 0.09235988557338715, 0.09107554703950882, 0.092103511095047, 0.0888131707906723, 0.08981559425592422, 0.09172027558088303], [0.09092148393392563, 0.091148741543293, 0.09084615111351013, 0.09046757221221924, 0.09103547781705856, 0.09134068340063095, 0.09096004068851471, 0.0912649929523468, 0.09028027951717377, 0.0905829593539238, 0.09115158766508102], [0.0908583477139473, 0.09009042382240295, 0.09111478924751282, 0.09241769462823868, 0.09047210216522217, 0.08944837003946304, 0.09072745591402054, 0.08970083296298981, 0.09307117760181427, 0.09201803058385849, 0.0900808572769165]], [[0.08432327955961227, 0.08403287082910538, 0.0864068940281868, 0.08345505595207214, 0.08316763490438461, 0.0876145213842392, 0.08522269874811172, 0.08701207488775253, 0.14696753025054932, 0.08404714614152908, 0.08775027096271515], [0.08405115455389023, 0.08375155925750732, 0.08620168268680573, 0.08315559476613998, 0.08285919576883316, 0.08744892477989197, 0.08497923612594604, 0.08682664483785629, 0.14937052130699158, 0.08376629650592804, 0.08758915960788727], [0.08616408705711365, 0.08594074845314026, 0.08776091784238815, 0.08549582213163376, 0.08527421951293945, 0.08868204057216644, 0.08685456216335297, 0.0882229208946228, 0.1308676153421402, 0.08595173060894012, 0.08878538757562637], [0.08349785953760147, 0.08318014442920685, 0.08578071743249893, 0.0825483500957489, 0.08223424851894379, 0.08710648864507675, 0.08448256552219391, 0.08644486963748932, 0.15427343547344208, 0.083195760846138, 0.08725563436746597], [0.08321663737297058, 0.08288998156785965, 0.08556490391492844, 0.0822405144572258, 0.08191769570112228, 0.0869295671582222, 0.08422931283712387, 0.08624844998121262, 0.15677371621131897, 0.08290603756904602, 0.0870831236243248], [0.08714637905359268, 0.0869627520442009, 0.08845677226781845, 0.08659665286540985, 0.08641418069601059, 0.0892106220126152, 0.08771355450153351, 0.08883506059646606, 0.12239708751440048, 0.08697178214788437, 0.08929510414600372], [0.08514146506786346, 0.08487976342439651, 0.08701629191637039, 0.08435877412557602, 0.08409947156906128, 0.08810067921876907, 0.08595136553049088, 0.08755991607904434, 0.13977716863155365, 0.0848926305770874, 0.08822246640920639], [0.08666375279426575, 0.08646025508642197, 0.08811736851930618, 0.08605468273162842, 0.08585260808467865, 0.08895473927259445, 0.0872926115989685, 0.08853746205568314, 0.12654757499694824, 0.08647026121616364, 0.08904863148927689], [0.10415787994861603, 0.105837881565094, 0.09300901740789413, 0.10927962511777878, 0.11104223877191544, 0.08721045404672623, 0.09915649145841599, 0.09004645049571991, 0.007918871007859707, 0.10575452446937561, 0.08658651262521744], [0.08406462520360947, 0.08376549184322357, 0.08621186763048172, 0.08317040652036667, 0.08287445455789566, 0.08745717257261276, 0.08499129861593246, 0.08683586120605469, 0.14925144612789154, 0.0837801992893219, 0.08759718388319016], [0.0872531458735466, 0.08707401901483536, 0.08853118121623993, 0.08671684563159943, 0.08653880655765533, 0.08926620334386826, 0.08780638128519058, 0.08890004456043243, 0.12148208171129227, 0.08708282560110092, 0.08934856951236725]], [[0.09115969389677048, 0.09119997918605804, 0.09054183959960938, 0.0905034989118576, 0.09108415991067886, 0.09139624983072281, 0.09100702404975891, 0.09131885319948196, 0.09031202644109726, 0.09027378261089325, 0.09120288491249084], [0.09108526259660721, 0.09111353754997253, 0.09065110236406326, 0.0906241312623024, 0.0910322293639183, 0.09125126153230667, 0.09097807109355927, 0.09119696915149689, 0.09048938751220703, 0.09046246856451035, 0.09111558645963669], [0.092293381690979, 0.09252112358808517, 0.08885768055915833, 0.08864796906709671, 0.0918676033616066, 0.09363735467195511, 0.09143449366092682, 0.09319590032100677, 0.08760682493448257, 0.08740006387233734, 0.09253761172294617], [0.09236323088407516, 0.09260282665491104, 0.08875264972448349, 0.08853249996900558, 0.09191541373729706, 0.09377750754356384, 0.0914599820971489, 0.09331284463405609, 0.0874398872256279, 0.08722298592329025, 0.09262016415596008], [0.09129907935857773, 0.09136193990707397, 0.09033679962158203, 0.09027720987796783, 0.09118124097585678, 0.09166847169399261, 0.09106097370386124, 0.09154755622148514, 0.08997980505228043, 0.08992044627666473, 0.0913664922118187], [0.09072177857160568, 0.09069192409515381, 0.0911824181675911, 0.09121117740869522, 0.09077779948711395, 0.09054684638977051, 0.0908350795507431, 0.09060398489236832, 0.09135515987873077, 0.09138397872447968, 0.0906897708773613], [0.09144118428230286, 0.09152720868587494, 0.09012717753648758, 0.09004595875740051, 0.0912800058722496, 0.09194695949554443, 0.0911155715584755, 0.09178132563829422, 0.08964098244905472, 0.08956020325422287, 0.09153342992067337], [0.09086526930332184, 0.09085826575756073, 0.09097310900688171, 0.09097982943058014, 0.09087840467691422, 0.09082420915365219, 0.09089183807373047, 0.09083762764930725, 0.09101344645023346, 0.09102016687393188, 0.09085775911808014], [0.0927111953496933, 0.09301025420427322, 0.08822736889123917, 0.08795538544654846, 0.09215270727872849, 0.0944792628288269, 0.09158540517091751, 0.09389764070510864, 0.08660797029733658, 0.08634097874164581, 0.09303191304206848], [0.09278050810098648, 0.09309151768684387, 0.08812227100133896, 0.0878399983048439, 0.09219980984926224, 0.09461979568004608, 0.09161008149385452, 0.09401459246873856, 0.08644213527441025, 0.08616524189710617, 0.09311404079198837], [0.09107988327741623, 0.09110728651285172, 0.0906590074300766, 0.0906328484416008, 0.09102847427129745, 0.0912407860159874, 0.09097597748041153, 0.09118816256523132, 0.09050221741199493, 0.09047611057758331, 0.0911092758178711]], [[0.08869197964668274, 0.08661340922117233, 0.0864097848534584, 0.08620662987232208, 0.08600396662950516, 0.08911532163619995, 0.08560005575418472, 0.08869679272174835, 0.1268290877342224, 0.08662344515323639, 0.08920949697494507], [0.08705364912748337, 0.08397745341062546, 0.08367813378572464, 0.08337987959384918, 0.08308268338441849, 0.08768479526042938, 0.08249146491289139, 0.0870608240365982, 0.1497734785079956, 0.08399222791194916, 0.08782540261745453], [0.08687087148427963, 0.08369921147823334, 0.08339081704616547, 0.08308354020118713, 0.08277740329504013, 0.08752207458019257, 0.08216851949691772, 0.08687828481197357, 0.15222758054733276, 0.08371444046497345, 0.08766717463731766], [0.08668434619903564, 0.08341792225837708, 0.08310051262378693, 0.08278431743383408, 0.08246931433677673, 0.08735548704862595, 0.08184292167425156, 0.0866919755935669, 0.15471452474594116, 0.08343358337879181, 0.08750505745410919], [0.08649402111768723, 0.08313354104757309, 0.08280721306800842, 0.08248216658830643, 0.0821583941578865, 0.08718499541282654, 0.08151466399431229, 0.08650188893079758, 0.15723447501659393, 0.08314964175224304, 0.08733900636434555], [0.08897808939218521, 0.08710701018571854, 0.08692345768213272, 0.08674030005931854, 0.08655752241611481, 0.0893586054444313, 0.08619312942028046, 0.08898242563009262, 0.12260014563798904, 0.0871160551905632, 0.08944322913885117], [0.08610188961029053, 0.08255545794963837, 0.08221154659986496, 0.08186905831098557, 0.08152800053358078, 0.08683216571807861, 0.08085013180971146, 0.0861101970076561, 0.1623741239309311, 0.08257243782281876, 0.08699498325586319], [0.08869532495737076, 0.08661911636590958, 0.08641571551561356, 0.08621280640363693, 0.08601035177707672, 0.08911819010972977, 0.0856068953871727, 0.08870014548301697, 0.12678012251853943, 0.08662914484739304, 0.08921225368976593], [0.08866512030363083, 0.10417582094669342, 0.10585612058639526, 0.10756351053714752, 0.1092984527349472, 0.08584088832139969, 0.11285272985696793, 0.08863234519958496, 0.007794479373842478, 0.1040937602519989, 0.08522675186395645], [0.08706256002187729, 0.08399108797311783, 0.08369220793247223, 0.08339439332485199, 0.08309764415025711, 0.08769271522760391, 0.08250730484724045, 0.08706972002983093, 0.14965346455574036, 0.08400583267211914, 0.08783309906721115], [0.08903969079256058, 0.08721492439508438, 0.08703586459159851, 0.08685716986656189, 0.08667885512113571, 0.08941067010164261, 0.08632330596446991, 0.08904390782117844, 0.12167870998382568, 0.08722374588251114, 0.08949316293001175]], [[0.09115985035896301, 0.09120013564825058, 0.09089072793722153, 0.09050366282463074, 0.0910843163728714, 0.09104574471712112, 0.09135770797729492, 0.09096864610910416, 0.0903121829032898, 0.09027393907308578, 0.09120304882526398], [0.09108534455299377, 0.0911136269569397, 0.09089633822441101, 0.09062421321868896, 0.09103231877088547, 0.09100522845983505, 0.09122419357299805, 0.09095108509063721, 0.0904894694685936, 0.09046254307031631, 0.09111566841602325], [0.09165679663419724, 0.0917779803276062, 0.09084999561309814, 0.089697927236557, 0.09142988920211792, 0.09131414443254471, 0.09225297719240189, 0.0910831093788147, 0.08913163095712662, 0.0890188068151474, 0.09178674221038818], [0.092368945479393, 0.09260854870080948, 0.09078145772218704, 0.08853796869516373, 0.09192109853029251, 0.09169308096170425, 0.0935506746172905, 0.09123875200748444, 0.08744528889656067, 0.08722838014364243, 0.09262589365243912], [0.09129947423934937, 0.0913623496890068, 0.09087987244129181, 0.09027759730815887, 0.09118164330720901, 0.09112148731946945, 0.09160839766263962, 0.09100129455327988, 0.08998019993305206, 0.08992083370685577, 0.09136688709259033], [0.09137073159217834, 0.09144517034292221, 0.09087415784597397, 0.09016212821006775, 0.09123123437166214, 0.09116003662347794, 0.09173659235239029, 0.09101780503988266, 0.08981085568666458, 0.08974076062440872, 0.09145055711269379], [0.09079360961914062, 0.09077517688274384, 0.09091706573963165, 0.09109555184841156, 0.09082821011543274, 0.09084589034318924, 0.09070319682359695, 0.09088126569986343, 0.09118425846099854, 0.091202013194561, 0.09077385067939758], [0.09151306748390198, 0.09161070734262466, 0.09086237847805023, 0.08993129432201385, 0.09133017063140869, 0.09123685210943222, 0.09199317544698715, 0.09105049818754196, 0.08947277814149857, 0.08938135951757431, 0.09161776304244995], [0.09272003918886185, 0.09301913529634476, 0.09074318408966064, 0.08796376734972, 0.09216150641441345, 0.09187738597393036, 0.09419699013233185, 0.09131178259849548, 0.08661623299121857, 0.08634921163320541, 0.09304079413414001], [0.09279007464647293, 0.0931011214852333, 0.09073519706726074, 0.08784905076026917, 0.09220931679010391, 0.09191395342350006, 0.0943264365196228, 0.09132605791091919, 0.08645103871822357, 0.0861741229891777, 0.09312364459037781], [0.0910799503326416, 0.09110736101865768, 0.09089673310518265, 0.09063292294740677, 0.09102854877710342, 0.09100229293107986, 0.09121453762054443, 0.09094980359077454, 0.0905022919178009, 0.09047617763280869, 0.09110934287309647]], [[0.09269311279058456, 0.09401403367519379, 0.09236884862184525, 0.09220713376998901, 0.09204570949077606, 0.09451336413621902, 0.09172370284795761, 0.09569240361452103, 0.06991627812385559, 0.09253881871700287, 0.09228663146495819], [0.09176559001207352, 0.09234306216239929, 0.09162312746047974, 0.09155198186635971, 0.09148088842630386, 0.09256017953157425, 0.0913388654589653, 0.09307032823562622, 0.08098123967647552, 0.09169784188270569, 0.09158696234226227], [0.0928991511464119, 0.09440699964761734, 0.09252944588661194, 0.09234514832496643, 0.09216120839118958, 0.09497775137424469, 0.0917944386601448, 0.09632708877325058, 0.0673997551202774, 0.09272322058677673, 0.09243573993444443], [0.09299882501363754, 0.09460051357746124, 0.09260635077953339, 0.09241072833538055, 0.09221553057432175, 0.09520719945430756, 0.09182635694742203, 0.09664235264062881, 0.06617316603660583, 0.09281204640865326, 0.09250688552856445], [0.0930963009595871, 0.09479208290576935, 0.09268102049827576, 0.0924740806221962, 0.09226759523153305, 0.09543483704328537, 0.09185601025819778, 0.09695624560117722, 0.06496728211641312, 0.0928986594080925, 0.092575803399086], [0.09137661755084991, 0.09168089926242828, 0.09130141139030457, 0.09126383066177368, 0.09122626483440399, 0.09179507195949554, 0.09115118533372879, 0.09206284582614899, 0.0855187326669693, 0.09134085476398468, 0.09128230810165405], [0.09328480809926987, 0.09516950696706772, 0.09282383322715759, 0.0925941988825798, 0.09236513078212738, 0.09588481485843658, 0.09190869331359863, 0.09758003801107407, 0.06261651962995529, 0.09306539595127106, 0.0927070677280426], [0.09037034213542938, 0.0900476798415184, 0.09045042842626572, 0.09049050509929657, 0.09053058922290802, 0.08992718160152435, 0.09061083197593689, 0.08964581042528152, 0.0970473438501358, 0.09040840715169907, 0.09047079086303711], [0.09452560544013977, 0.1121678426861763, 0.09060312807559967, 0.08870335668325424, 0.08684342354536057, 0.11958880722522736, 0.08323973417282104, 0.13893328607082367, 0.0031220184173434973, 0.0926402285695076, 0.08963267505168915], [0.09279219061136246, 0.09420184046030045, 0.09244634211063385, 0.09227389842271805, 0.09210177510976791, 0.0947350487112999, 0.09175849705934525, 0.09599482268095016, 0.0687093734741211, 0.0926276221871376, 0.09235867112874985], [0.09295008331537247, 0.09450558573007584, 0.09256880730390549, 0.09237875789403915, 0.09218909591436386, 0.09509458392858505, 0.09181094169616699, 0.09648746997117996, 0.06677382439374924, 0.09276863932609558, 0.09247218072414398]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_duration_sec_mean": 0.005786252536345273, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.0002930395588763e-05, "listify_data_for_vector_env": 1.3140758840874448e-05, "un_batch_to_individual_items": 7.812248645795814e-06, "tensor_to_numpy": 2.0738608873084232e-05, "remove_single_ts_time_rank_from_batch": 1.4670788569031946e-05, "get_actions": 4.779811551011306e-05}}, "connector_pipeline_timer": 0.00014663273873512735}, "env_to_module_connector": {"connector_pipeline_timer": 7.41758444467042e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 8.441015791414118e-06, "numpy_to_tensor": 1.7518253299317757e-05, "add_states_from_episodes_to_batch": 3.3599750172203314e-06, "add_observations_from_episodes_to_batch": 3.2820376340501922e-06, "batch_individual_items": 1.5165097751193202e-05}}}, "env_step_timer": 1.8339107339044078e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 0.55, "episode_return_max": 14.5, "module_episode_returns_mean": {"default_policy": 0.55}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 0.55}, "num_env_steps_sampled": 400, "episode_len_max": 20, "weights_seq_no": 18.0, "num_episodes": 20, "num_env_steps_sampled_lifetime": 90400, "env_reset_timer": 0.0006137078787841583, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -14.5, "episode_len_mean": 20.0, "num_episodes_lifetime": 360, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 4.068865341613507e-05, "sample": 0.1301439700675135, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "time_between_sampling": 9.960420836676347}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "ba9e8_00000", "date": "2025-08-11_18-10-56", "timestamp": 1754928656, "time_this_iter_s": 10.891567945480347, "time_total_s": 183.27384662628174, "pid": 10327, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3858fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 183.27384662628174, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 53.98666666666666, "ram_util_percent": 82.52000000000001}}
{"timers": {"training_iteration": 9.513043203492614, "restore_env_runners": 1.7963017972652376e-05, "training_step": 9.512805161769547, "env_runner_sampling_timer": 1.767546422995425, "learner_update_timer": 7.5576146654278595, "synch_weights": 0.0015159235618907578, "restore_eval_env_runners": 5.327530211449411e-05, "evaluation_iteration": 0.14290395946380388, "synch_eval_env_connectors": 0.0001976544785721561, "synch_env_connectors": 6.749576047253431e-06}, "env_runners": {"env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 0.7399999999999999}, "rlmodule_inference_timer": 3.360744334198916e-05, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.6351597866031066e-05, "get_actions": 4.208919164895547e-05, "listify_data_for_vector_env": 1.1054288518871403e-05, "un_batch_to_individual_items": 6.9231169467535435e-06, "remove_single_ts_time_rank_from_batch": 1.2547092004534327e-05, "normalize_and_clip_actions": 8.431204464599226e-06}}, "connector_pipeline_timer": 0.00012539080451226677}, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.3253718164417327e-05, "add_states_from_episodes_to_batch": 2.8621498740511235e-06, "add_time_dim_to_batch_and_zero_pad": 7.660437633474396e-06, "add_observations_from_episodes_to_batch": 3.0254164666574023e-06, "numpy_to_tensor": 1.3567174851066743e-05}}, "connector_pipeline_timer": 6.357550144403404e-05}, "sample": 0.005982052447906702, "episode_duration_sec_mean": 0.00561560297338292, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "agent_episode_returns_mean": {"default_agent": 0.7399999999999999}, "weights_seq_no": 18.0, "episode_return_mean": 0.7399999999999999, "env_step_timer": 1.5106364719395966e-05, "episode_return_max": 8.5, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -10487500.0, "env_reset_timer": 4.915674164923829e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "time_between_sampling": 0.03751049971956087, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "episode_return_min": -11.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -524375.0, "num_env_steps_sampled_lifetime_throughput": 3065.013645941143}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.14236643999602555, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009924004647356663, "add_observations_from_episodes_to_batch": 0.0010273376667731295, "add_columns_from_episodes_to_train_batch": 0.0446095688710082, "add_time_dim_to_batch_and_zero_pad": 0.07839396276803584, "add_states_from_episodes_to_batch": 0.003795517767033401, "batch_individual_items": 0.004330784583694085, "numpy_to_tensor": 8.845093615217539e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.35830453038215637, "module_train_batch_size_mean": 997.6572809365935, "num_module_steps_trained": 5985, "policy_loss": -0.0001682014117250219, "use_intrinsic_rewards": 0.0, "num_module_steps_trained_lifetime": 113715, "total_loss": 0.2779191732406616, "weights_seq_no": 19.0, "entropy": 0.6805288791656494, "mean_kl_loss": 2.8309696062933654e-05, "vf_loss_unclipped": 42.700069427490234, "num_trainable_parameters": 16595, "curr_kl_coeff": 3.0819688845440396e-07, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.00039207935333251953, "num_module_steps_trained_lifetime_throughput": 744.6044085554811}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1364580, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 3762000, "num_env_steps_trained_lifetime_throughput": 44764.22841224303}, "default_policy": {"num_module_steps_trained_lifetime": 682290, "weights_seq_no": 114.0, "diff_num_grad_updates_vs_sampler_policy": 96.0, "entropy": 0.6805449724197388, "mean_kl_loss": 2.754804700089153e-05, "vf_loss_unclipped": 42.57297897338867, "vf_explained_var": 0.0014451146125793457, "num_module_steps_trained": 35910, "use_intrinsic_rewards": 1.0, "vf_loss": 0.3583930730819702, "module_train_batch_size_mean": 997.4980069784294, "total_loss": 0.2779977023601532, "policy_loss": -0.00016304815653711557}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.4980069784294, "num_module_steps_trained_lifetime": 682290, "total_loss": 0.0, "weights_seq_no": 114.0, "diff_num_grad_updates_vs_sampler_policy": 96.0}}}, "intrinsic_reward_module": {"weights_seq_no": 19.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.6572809365935, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5985, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 113715, "num_module_steps_trained_lifetime_throughput": 744.6118746458685}, "__all_modules__": {"num_env_steps_trained": 33000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 227430, "num_env_steps_trained_lifetime": 627000, "num_env_steps_trained_lifetime_throughput": 4106.577238999872, "num_module_steps_trained_throughput": 18499256.814431466, "num_module_steps_trained_lifetime_throughput": 13166234.722616814}, "IntrinsicAttentionMask": [[[0.0911278948187828, 0.0915193036198616, 0.09051025658845901, 0.09047192335128784, 0.09105238318443298, 0.0910138264298439, 0.09132567793130875, 0.09128700196743011, 0.0906282365322113, 0.09024228155612946, 0.090821273624897], [0.09049355238676071, 0.089765265583992, 0.09166131168603897, 0.09173453599214554, 0.09063508361577988, 0.09070749580860138, 0.09012440592050552, 0.0901964083313942, 0.0914364606142044, 0.09217514097690582, 0.09107041358947754], [0.09211499989032745, 0.0943438708782196, 0.08868593722581863, 0.08847663551568985, 0.0916900634765625, 0.09147366881370544, 0.09323582798242569, 0.09301578253507614, 0.08933273702859879, 0.08723114430904388, 0.09039933979511261], [0.0921756848692894, 0.09452147036790848, 0.0885724276304245, 0.08835272490978241, 0.09172878414392471, 0.09150123596191406, 0.09335494786500931, 0.09312337636947632, 0.0892515480518341, 0.08704587072134018, 0.0903719961643219], [0.0912494882941246, 0.09186086058616638, 0.09028774499893188, 0.09022817760705948, 0.09113172441720963, 0.09107160568237305, 0.09155824780464172, 0.09149783849716187, 0.09047117829322815, 0.0898716151714325, 0.09077158570289612], [0.0913114845752716, 0.0920356884598732, 0.09017404913902283, 0.09010367095470428, 0.09117209166288376, 0.09110093116760254, 0.09167711436748505, 0.09160556644201279, 0.09039081633090973, 0.08968257904052734, 0.09074600040912628], [0.09080816805362701, 0.09062948077917099, 0.09109242260456085, 0.09111015498638153, 0.09084276854991913, 0.09086044877767563, 0.09071773290634155, 0.09073539078235626, 0.09103789925575256, 0.09121663123369217, 0.0909489244222641], [0.09087081253528595, 0.09080291539430618, 0.09097866714000702, 0.09098538756370544, 0.09088395535945892, 0.09089066833257675, 0.09083645790815353, 0.09084317088127136, 0.09095799922943115, 0.09102572500705719, 0.09092424809932709], [0.09192779660224915, 0.0937989130616188, 0.08903513103723526, 0.08885800093412399, 0.09157025814056396, 0.09138809144496918, 0.0928696021437645, 0.09268485009670258, 0.08958207815885544, 0.08780261874198914, 0.09048265963792801], [0.09253772348165512, 0.09559112787246704, 0.08789166808128357, 0.08761013299226761, 0.09195855259895325, 0.09166398644447327, 0.09406992048025131, 0.09376858919858932, 0.08876318484544754, 0.08593976497650146, 0.09020527452230453], [0.09162010997533798, 0.09291280061006546, 0.08960574865341187, 0.08948176354169846, 0.09137218445539474, 0.09124575555324554, 0.09227176010608673, 0.09214407950639725, 0.08998813480138779, 0.08874142915010452, 0.09061621874570847]], [[0.08303946256637573, 0.08538542687892914, 0.08509136736392975, 0.08479831367731094, 0.08450627326965332, 0.08628062903881073, 0.08133825659751892, 0.08841261267662048, 0.1493334323167801, 0.08539994806051254, 0.08641429245471954], [0.08548888564109802, 0.08721437305212021, 0.0869988277554512, 0.08678381145000458, 0.08656933158636093, 0.08786925673484802, 0.0842289999127388, 0.08942124247550964, 0.13023336231708527, 0.08722501248121262, 0.08796687424182892], [0.08519566804170609, 0.0870000571012497, 0.0867745578289032, 0.08654963970184326, 0.08632531017065048, 0.08768534660339355, 0.08387928456068039, 0.08931037038564682, 0.13248097896575928, 0.0870111808180809, 0.08778751641511917], [0.0848996564745903, 0.08678237348794937, 0.08654698729515076, 0.08631223440170288, 0.08607812225818634, 0.08749788999557495, 0.08352728933095932, 0.08919563889503479, 0.13476133346557617, 0.08679398149251938, 0.0876045972108841], [0.0846007689833641, 0.08656124770641327, 0.08631603419780731, 0.08607150614261627, 0.08582767844200134, 0.08730681985616684, 0.08317293226718903, 0.0890769436955452, 0.13707461953163147, 0.08657334744930267, 0.08741801977157593], [0.08635834604501724, 0.08784197270870209, 0.08765687793493271, 0.08747217059135437, 0.08728785812854767, 0.08840393275022507, 0.08527226001024246, 0.08973322063684464, 0.12363466620445251, 0.08785111457109451, 0.0884876474738121], [0.0810961127281189, 0.0838766098022461, 0.08352718502283096, 0.08317922055721283, 0.0828327015042305, 0.08494187891483307, 0.07909005880355835, 0.08748824894428253, 0.16497300565242767, 0.08389386534690857, 0.08510114997625351], [0.08829621970653534, 0.08919546008110046, 0.08908360451459885, 0.08897189795970917, 0.08886032551527023, 0.0895344465970993, 0.08763397485017776, 0.09033287316560745, 0.10930538922548294, 0.08920096606016159, 0.08958487212657928], [0.11124507337808609, 0.09689918160438538, 0.09857010841369629, 0.1002698466181755, 0.10199888795614243, 0.09201803803443909, 0.12326265126466751, 0.08153374493122101, 0.006070093717426062, 0.09681760519742966, 0.09131481498479843], [0.08550326526165009, 0.08722485601902008, 0.08700980246067047, 0.08679527044296265, 0.0865812748670578, 0.08787823468446732, 0.08424617350101471, 0.08942661434412003, 0.13012348115444183, 0.0872354581952095, 0.0879756286740303], [0.08648524433374405, 0.08793255686759949, 0.08775202184915543, 0.08757186681032181, 0.08739207684993744, 0.08848058432340622, 0.08542533218860626, 0.08977660536766052, 0.12268003821372986, 0.08794146776199341, 0.08856222033500671]], [[0.09112807363271713, 0.0911683514714241, 0.09051044285297394, 0.0908205658197403, 0.09140326827764511, 0.09136456251144409, 0.09097547084093094, 0.09093694388866425, 0.09062842279672623, 0.09024246782064438, 0.09082145988941193], [0.0910630151629448, 0.09109129011631012, 0.0906289666891098, 0.09084702283143997, 0.09125612676143646, 0.09122897684574127, 0.09095585346221924, 0.09092879295349121, 0.09071195125579834, 0.09044037759304047, 0.09084764868021011], [0.09212099760770798, 0.09234832972288132, 0.08869170397520065, 0.09040027111768723, 0.09368357062339783, 0.09346247464418411, 0.09126371890306473, 0.09104833751916885, 0.08933854848146439, 0.08723681420087814, 0.09040521830320358], [0.09162358194589615, 0.09175629168748856, 0.08960513025522232, 0.09061472862958908, 0.09253299981355667, 0.09240470826625824, 0.09112194925546646, 0.09099560976028442, 0.08998829126358032, 0.08873908221721649, 0.09061764180660248], [0.09068278968334198, 0.09064153581857681, 0.09132015705108643, 0.09099902212619781, 0.09040162712335587, 0.09044107049703598, 0.0908394530415535, 0.09087909013032913, 0.09119772166013718, 0.09159944206476212, 0.0909981057047844], [0.09074552357196808, 0.0907156690955162, 0.09120628237724304, 0.09097424149513245, 0.09054197371006012, 0.09057054668664932, 0.09085886180400848, 0.09088752418756485, 0.09111784398555756, 0.0914079025387764, 0.09097357839345932], [0.09137426316738129, 0.0914602279663086, 0.09006121754646301, 0.09071926772594452, 0.0919625386595726, 0.09187967330217361, 0.09104889631271362, 0.0909668505191803, 0.09031126648187637, 0.08949466794729233, 0.09072115272283554], [0.09143632650375366, 0.09153388440608978, 0.08994778245687485, 0.09069342166185379, 0.09210415929555893, 0.09201004356145859, 0.09106720238924026, 0.09097415208816528, 0.0902310237288475, 0.08930640667676926, 0.0906955748796463], [0.09193204343318939, 0.09212321043014526, 0.08903923630714417, 0.0904826745390892, 0.0932445228099823, 0.09305901825428009, 0.0912104919552803, 0.09102904051542282, 0.08958620578050613, 0.08780666440725327, 0.09048683941364288], [0.09254883974790573, 0.09285908937454224, 0.08790222555398941, 0.09020940959453583, 0.0946868509054184, 0.09438354521989822, 0.09138135612010956, 0.09108863770961761, 0.08877384662628174, 0.0859500840306282, 0.09021610766649246], [0.09162215143442154, 0.09175458550453186, 0.08960775285959244, 0.09061533957719803, 0.09252971410751343, 0.09240167587995529, 0.09112153947353363, 0.09099545329809189, 0.08999015390872955, 0.0887434110045433, 0.09061824530363083]], [[0.09297136962413788, 0.09280860424041748, 0.09264612197875977, 0.09248393028974533, 0.09232201427221298, 0.09479708969593048, 0.09199904650449753, 0.0944654569029808, 0.07012609392404556, 0.09281661361455917, 0.09256366640329361], [0.09309574961662292, 0.09292154014110565, 0.09274765849113464, 0.0925741121172905, 0.09240087866783142, 0.09505125135183334, 0.09205538779497147, 0.09469585120677948, 0.06886810809373856, 0.09293011575937271, 0.09265942871570587], [0.09321799129247665, 0.09303232282400131, 0.09284701943397522, 0.09266208112239838, 0.09247751533985138, 0.0953037366271019, 0.09210949391126633, 0.0949244573712349, 0.06763100624084473, 0.09304145723581314, 0.09275299310684204], [0.09333812445402145, 0.09314096719026566, 0.09294421970844269, 0.09274788945913315, 0.09255196899175644, 0.09555456787347794, 0.0921613797545433, 0.09515130519866943, 0.06641451269388199, 0.09315066784620285, 0.0928443968296051], [0.0934561938047409, 0.09324751794338226, 0.09303931146860123, 0.0928315594792366, 0.09262428432703018, 0.09580378234386444, 0.09221111238002777, 0.09537642449140549, 0.06521835923194885, 0.09325778484344482, 0.09293368458747864], [0.09143926203250885, 0.09140162169933319, 0.09136400371789932, 0.09132640063762665, 0.09128881245851517, 0.09185800701379776, 0.09121368080377579, 0.09178240597248077, 0.08557736873626709, 0.09140348434448242, 0.09134489297866821], [0.09368621557950974, 0.09345444291830063, 0.09322325140237808, 0.0929926261305809, 0.09276257455348969, 0.09629741311073303, 0.09230417013168335, 0.09582154452800751, 0.06288588047027588, 0.09346584975719452, 0.0931059867143631], [0.09173683077096939, 0.09167692065238953, 0.09161705523729324, 0.09155722707509995, 0.09149742871522903, 0.09240435063838959, 0.09137796610593796, 0.0922837033867836, 0.08258204162120819, 0.0916798785328865, 0.0915866494178772], [0.09886900335550308, 0.09679590910673141, 0.0947662815451622, 0.09277921915054321, 0.09083382040262222, 0.12508399784564972, 0.08706452697515488, 0.11989344656467438, 0.0032654281239956617, 0.09689703583717346, 0.09375128149986267], [0.09308966249227524, 0.09291601926088333, 0.09274270385503769, 0.09256970882415771, 0.09239703416824341, 0.0950387567281723, 0.0920526534318924, 0.09468453377485275, 0.06892959028482437, 0.0929245725274086, 0.092654749751091], [0.09327930212020874, 0.09308779239654541, 0.09289667755365372, 0.09270595014095306, 0.09251561760902405, 0.09543140232563019, 0.09213612973690033, 0.09503994882106781, 0.06701028347015381, 0.09309721738100052, 0.09279970824718475]], [[0.09088718146085739, 0.0905197262763977, 0.09100951999425888, 0.09162835776805878, 0.09070256352424622, 0.09076359122991562, 0.09082464873790741, 0.09033267945051193, 0.09137754142284393, 0.09143901616334915, 0.09051513671875], [0.09086152911186218, 0.09009851515293121, 0.09111631661653519, 0.09241077303886414, 0.09047774970531464, 0.0906045138835907, 0.09073145687580109, 0.08971139043569565, 0.09188497811555862, 0.09201372414827347, 0.09008900076150894], [0.09089524298906326, 0.09065958112478256, 0.0909736379981041, 0.09136956930160522, 0.09077688306570053, 0.09081601351499557, 0.09085516631603241, 0.09053948521614075, 0.09120921045541763, 0.0912485271692276, 0.09065663069486618], [0.09093251079320908, 0.09136398881673813, 0.09078969061374664, 0.0900735929608345, 0.09114883095026016, 0.09107721596956253, 0.09100566059350967, 0.09158509224653244, 0.0903625637292862, 0.0902915745973587, 0.09136940538883209], [0.0908745676279068, 0.09030832350254059, 0.09106337279081345, 0.09202050417661667, 0.09058991074562073, 0.09068397432565689, 0.09077812731266022, 0.0900205671787262, 0.09163215011358261, 0.09172728657722473, 0.09030125290155411], [0.09087879210710526, 0.09037825465202332, 0.09104561805725098, 0.09189066290855408, 0.09062722325325012, 0.0907103568315506, 0.09079357236623764, 0.0901237428188324, 0.09154791384935379, 0.09163188934326172, 0.0903720110654831], [0.09088297188282013, 0.09044818580150604, 0.09102780371904373, 0.09176094830036163, 0.09066448360681534, 0.09073669463396072, 0.09080896526575089, 0.09022698551416397, 0.09146369248628616, 0.09153653681278229, 0.09044275432825089], [0.09084765613079071, 0.08988342434167862, 0.09117011725902557, 0.09281204640865326, 0.09036239981651306, 0.09052262455224991, 0.09068313986063004, 0.08939505368471146, 0.09214437007904053, 0.09230776131153107, 0.08987142145633698], [0.09091810882091522, 0.09107907861471176, 0.09086472541093826, 0.09059625118970871, 0.09099887311458588, 0.09097215533256531, 0.09094543755054474, 0.09116138517856598, 0.09070474654436111, 0.09067811071872711, 0.09108110517263412], [0.09092172235250473, 0.0911489874124527, 0.09084638208150864, 0.09046779572963715, 0.09103571623563766, 0.09099800139665604, 0.09096028655767441, 0.0912652462720871, 0.0906207412481308, 0.0905831903219223, 0.09115183353424072], [0.09086120128631592, 0.09009324014186859, 0.09111765027046204, 0.09242060035467148, 0.0904749259352684, 0.09060252457857132, 0.09073028713464737, 0.08970363438129425, 0.0918913409113884, 0.0920209288597107, 0.09008367359638214]], [[0.08819512277841568, 0.08798778057098389, 0.08592570573091507, 0.08572369813919067, 0.08552215993404388, 0.08861611038446426, 0.08695834130048752, 0.09010425209999084, 0.12611892819404602, 0.08613818883895874, 0.088709756731987], [0.08802516758441925, 0.08780761808156967, 0.08564547449350357, 0.08543380349874496, 0.08522265404462814, 0.08846695721149445, 0.08672789484262466, 0.09002950042486191, 0.12820762395858765, 0.08586813509464264, 0.08856523782014847], [0.08612918853759766, 0.08581183105707169, 0.08267883211374283, 0.08237417787313461, 0.08207065612077713, 0.08677485585212708, 0.08424248546361923, 0.08907116204500198, 0.15092845261096954, 0.08299970626831055, 0.08691869676113129], [0.08592220395803452, 0.0855952575802803, 0.08236987888813019, 0.0820564553141594, 0.0817442238330841, 0.08658748120069504, 0.08397915214300156, 0.08895481377840042, 0.15335482358932495, 0.08270002901554108, 0.08673571050167084], [0.08571172505617142, 0.08537527918815613, 0.08205825090408325, 0.08173613995313644, 0.08141530305147171, 0.0863964781165123, 0.08371274173259735, 0.0888344794511795, 0.15581294894218445, 0.08239759504795074, 0.0865490734577179], [0.08852928876876831, 0.08834274113178253, 0.08648503571748734, 0.08630278706550598, 0.08612094074487686, 0.08890790492296219, 0.0874158963561058, 0.09024477750062943, 0.1219818964600563, 0.08667665719985962, 0.08899208903312683], [0.08712669461965561, 0.08685888350009918, 0.08420616388320923, 0.0839473307132721, 0.08368930965662003, 0.08767103403806686, 0.08553217351436615, 0.08960156887769699, 0.1390959918498993, 0.08447860926389694, 0.08779221028089523], [0.08959909528493881, 0.0894867405295372, 0.08836254477500916, 0.0882517397403717, 0.0881410762667656, 0.08982683718204498, 0.08892706781625748, 0.09062787145376205, 0.10842067003250122, 0.08847896009683609, 0.0898774266242981], [0.09248606115579605, 0.09397781640291214, 0.11041800677776337, 0.11219899356365204, 0.11400871723890305, 0.0895400121808052, 0.10180536657571793, 0.07995576411485672, 0.008130173198878765, 0.10857962816953659, 0.08889946341514587], [0.08634262531995773, 0.08603537827730179, 0.08300014585256577, 0.08270479738712311, 0.08241049200296402, 0.0869675800204277, 0.08451548963785172, 0.08918898552656174, 0.1484163999557495, 0.08331118524074554, 0.08710680902004242], [0.08860165625810623, 0.08841975778341293, 0.08660770207643509, 0.0864298939704895, 0.08625244349241257, 0.08897083252668381, 0.08751581609249115, 0.09027402848005295, 0.12108033150434494, 0.0867946669459343, 0.08905291557312012]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_duration_sec_mean": 0.005865655896486715, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 8.536535397436881e-06, "listify_data_for_vector_env": 1.1911922219899559e-05, "un_batch_to_individual_items": 7.210772009018791e-06, "tensor_to_numpy": 1.7875479934930743e-05, "remove_single_ts_time_rank_from_batch": 1.413058873389101e-05, "get_actions": 4.453537382818692e-05}}, "connector_pipeline_timer": 0.0001335963515504487}, "env_to_module_connector": {"connector_pipeline_timer": 6.758564956926282e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.741413843803941e-06, "numpy_to_tensor": 1.492963058151078e-05, "add_states_from_episodes_to_batch": 3.190434270813629e-06, "add_observations_from_episodes_to_batch": 3.2892011591893723e-06, "batch_individual_items": 1.4355709931436475e-05}}}, "env_step_timer": 1.7543039792631404e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 0.15, "episode_return_max": 14.5, "module_episode_returns_mean": {"default_policy": 0.15}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": 0.15}, "num_env_steps_sampled": 400, "episode_len_max": 20, "weights_seq_no": 19.0, "num_episodes": 20, "num_env_steps_sampled_lifetime": 95400, "env_reset_timer": 0.0006112412202611419, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -14.5, "episode_len_mean": 20.0, "num_episodes_lifetime": 380, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 3.8360128234708996e-05, "sample": 0.13009668495609836, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "time_between_sampling": 9.960459094970172}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "ba9e8_00000", "date": "2025-08-11_18-11-06", "timestamp": 1754928666, "time_this_iter_s": 10.057446002960205, "time_total_s": 193.33129262924194, "pid": 10327, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3858fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 193.33129262924194, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 48.35999999999999, "ram_util_percent": 82.32000000000001}}
{"timers": {"training_iteration": 9.516410404377732, "restore_env_runners": 1.7920477311756032e-05, "training_step": 9.516171115561153, "env_runner_sampling_timer": 1.7665303208545924, "learner_update_timer": 7.56201855127346, "synch_weights": 0.0015177709959310177, "restore_eval_env_runners": 5.31438001113965e-05, "evaluation_iteration": 0.14282991070935688, "synch_eval_env_connectors": 0.00019772710422090946, "synch_env_connectors": 6.730830366949144e-06}, "env_runners": {"env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "module_episode_returns_mean": {"default_policy": 1.0600000000000005}, "rlmodule_inference_timer": 3.444235530503894e-05, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.6598099127704203e-05, "get_actions": 4.278507710253268e-05, "listify_data_for_vector_env": 1.1140867873764768e-05, "un_batch_to_individual_items": 6.9700624929359675e-06, "remove_single_ts_time_rank_from_batch": 1.2613889451343482e-05, "normalize_and_clip_actions": 8.605278070772591e-06}}, "connector_pipeline_timer": 0.00012698685456857223}, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.3350303139506199e-05, "add_states_from_episodes_to_batch": 2.891904199202586e-06, "add_time_dim_to_batch_and_zero_pad": 7.628162667047795e-06, "add_observations_from_episodes_to_batch": 3.041868408805841e-06, "numpy_to_tensor": 1.3750637394675467e-05}}, "connector_pipeline_timer": 6.392558425888617e-05}, "sample": 0.006020106482104051, "episode_duration_sec_mean": 0.0056803118865937, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "agent_episode_returns_mean": {"default_agent": 1.0600000000000005}, "weights_seq_no": 19.0, "episode_return_mean": 1.0600000000000005, "env_step_timer": 1.517723125668995e-05, "episode_return_max": 8.5, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -11105000.0, "env_reset_timer": 5.1856320304210556e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "time_between_sampling": 0.03455757843097707, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "episode_return_min": -11.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -555250.0, "num_env_steps_sampled_lifetime_throughput": 3022.349775832975}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1422921160160488, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009916821261097535, "add_observations_from_episodes_to_batch": 0.001025655959717031, "add_columns_from_episodes_to_train_batch": 0.044577063182541975, "add_time_dim_to_batch_and_zero_pad": 0.07836742981095565, "add_states_from_episodes_to_batch": 0.0037934113396302454, "batch_individual_items": 0.004327836737841647, "numpy_to_tensor": 8.813184669554132e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0015431216992, "vf_loss": 0.3583044707775116, "module_train_batch_size_mean": 997.6479298448816, "num_module_steps_trained": 5985, "policy_loss": -0.00024023849982768297, "use_intrinsic_rewards": 0.0, "num_module_steps_trained_lifetime": 119700, "total_loss": 0.2778483033180237, "weights_seq_no": 20.0, "entropy": 0.6797522902488708, "mean_kl_loss": 1.8896615074481815e-05, "vf_loss_unclipped": 44.34640121459961, "num_trainable_parameters": 16595, "curr_kl_coeff": 1.5409844422720198e-07, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.0002047419548034668, "num_module_steps_trained_lifetime_throughput": 741.2668298705645}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_module_steps_trained": 71820, "num_module_steps_trained_lifetime": 1436400, "num_env_steps_trained": 198000, "num_env_steps_trained_lifetime": 3960000, "num_env_steps_trained_lifetime_throughput": 44125.65034006763}, "default_policy": {"num_module_steps_trained_lifetime": 718200, "weights_seq_no": 120.0, "diff_num_grad_updates_vs_sampler_policy": 101.0, "entropy": 0.6797885298728943, "mean_kl_loss": 1.7549964468344115e-05, "vf_loss_unclipped": 44.1999626159668, "vf_explained_var": 0.0015845894813537598, "num_module_steps_trained": 35910, "use_intrinsic_rewards": 1.0, "vf_loss": 0.3583846688270569, "module_train_batch_size_mean": 997.4978492525759, "total_loss": 0.27792245149612427, "policy_loss": -0.00023131878697313368}, "intrinsic_reward_module": {"num_module_steps_trained": 35910, "module_train_batch_size_mean": 997.4978492525759, "num_module_steps_trained_lifetime": 718200, "total_loss": 0.0, "weights_seq_no": 120.0, "diff_num_grad_updates_vs_sampler_policy": 101.0}}}, "intrinsic_reward_module": {"weights_seq_no": 20.0, "num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.6479298448816, "total_loss": 0.0, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained": 5985, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 119700, "num_module_steps_trained_lifetime_throughput": 741.2738165873589}, "__all_modules__": {"num_env_steps_trained": 33000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_module_steps_trained_lifetime": 239400, "num_env_steps_trained_lifetime": 660000, "num_env_steps_trained_lifetime_throughput": 4088.134921610429, "num_module_steps_trained_throughput": 18154664.374573335, "num_module_steps_trained_lifetime_throughput": 13116372.782104779}, "IntrinsicAttentionMask": [[[0.09109612554311752, 0.09148740768432617, 0.09082718938589096, 0.09044038504362106, 0.09102065116167068, 0.0909821018576622, 0.09129384905099869, 0.09125518798828125, 0.09059664607048035, 0.09021081775426865, 0.09078961610794067], [0.09055348485708237, 0.08982470631599426, 0.09105966240167618, 0.09179528802633286, 0.0906951054930687, 0.09076756238937378, 0.09018409252166748, 0.09025613963603973, 0.0914970263838768, 0.09223619103431702, 0.09113071858882904], [0.09146512299776077, 0.09264495968818665, 0.09065999835729599, 0.08951033651828766, 0.09123868495225906, 0.09112318605184555, 0.09206005930900574, 0.09194352477788925, 0.08997359871864319, 0.08883263170719147, 0.09054789692163467], [0.09198993444442749, 0.09433101117610931, 0.09040895849466324, 0.08817467093467712, 0.09154394268989563, 0.09131686389446259, 0.09316683560609818, 0.09293573349714279, 0.08907169103622437, 0.0868704542517662, 0.09018988907337189], [0.09120001643896103, 0.09181105345487595, 0.09078087657690048, 0.09017925709486008, 0.09108231216669083, 0.09102222323417664, 0.09150860458612442, 0.09144823253154755, 0.090422123670578, 0.08982288837432861, 0.09072236716747284], [0.09125297516584396, 0.09197670966386795, 0.09075704216957092, 0.09004593640565872, 0.09111367166042328, 0.09104255586862564, 0.0916183665394783, 0.09154686331748962, 0.09033289551734924, 0.08962511271238327, 0.09068784862756729], [0.09082276374101639, 0.09064404666423798, 0.0909462571144104, 0.09112481027841568, 0.0908573716878891, 0.0908750593662262, 0.09073231369256973, 0.09074997901916504, 0.09105254709720612, 0.09123130142688751, 0.09096355736255646], [0.09087635576725006, 0.0908084437251091, 0.09092322736978531, 0.09099093079566956, 0.09088949114084244, 0.09089621156454086, 0.09084199368953705, 0.09084870666265488, 0.09096354246139526, 0.0910312756896019, 0.0909297913312912], [0.09177877008914948, 0.09364686906337738, 0.09051188081502914, 0.08871395140886307, 0.09142182022333145, 0.09123995155096054, 0.09271905571222305, 0.09253460168838501, 0.0894368588924408, 0.0876602753996849, 0.09033598750829697], [0.09229804575443268, 0.09534355998039246, 0.0902540534734726, 0.0873832181096077, 0.09172039479017258, 0.09142658859491348, 0.0938262864947319, 0.09352574497461319, 0.08853327482938766, 0.08571716398000717, 0.0899716466665268], [0.0915164053440094, 0.09280764311552048, 0.09063617140054703, 0.08938048779964447, 0.09126877784729004, 0.09114249050617218, 0.09216733276844025, 0.0920397937297821, 0.08988629281520844, 0.08864099532365799, 0.09051366150379181]], [[0.09245236963033676, 0.0937698632478714, 0.0921289399266243, 0.09196765720844269, 0.09180664271116257, 0.09426791220903397, 0.09148547053337097, 0.09544388949871063, 0.0708523541688919, 0.09377796202898026, 0.09204694628715515], [0.09165362268686295, 0.09223039448261261, 0.0915113314986229, 0.09144026786088943, 0.09136926382780075, 0.09244725108146667, 0.09122741222381592, 0.0929567813873291, 0.0814545601606369, 0.09223392605781555, 0.0914752185344696], [0.0926283523440361, 0.09413179755210876, 0.0922597199678421, 0.09207595139741898, 0.09189256280660629, 0.09470091015100479, 0.09152685850858688, 0.0960463136434555, 0.06843022257089615, 0.09414105117321014, 0.09216629713773727], [0.09271322935819626, 0.09431000798940659, 0.0923219621181488, 0.09212694317102432, 0.09193233400583267, 0.09491484612226486, 0.09154435992240906, 0.09634558856487274, 0.06724803149700165, 0.09431983530521393, 0.09222280979156494], [0.09279609471559525, 0.09448640793561935, 0.09238214790821075, 0.09217587113380432, 0.0919700562953949, 0.09512711316347122, 0.09155979752540588, 0.0966436117887497, 0.06608478724956512, 0.09449682384729385, 0.09227727353572845], [0.09131616353988647, 0.09162023663520813, 0.09124100208282471, 0.09120345115661621, 0.09116591513156891, 0.09173434227705002, 0.09109088033437729, 0.09200192987918854, 0.08578207343816757, 0.09162209928035736, 0.09122191369533539], [0.0929558277130127, 0.0948338732123375, 0.09249647706747055, 0.09226764738559723, 0.09203939139842987, 0.09554668515920639, 0.09158457070589066, 0.09723593294620514, 0.06381402909755707, 0.09484545886516571, 0.09238012880086899], [0.0904383584856987, 0.09011545777320862, 0.0905185118317604, 0.09055861085653305, 0.09059872478246689, 0.08999486267566681, 0.09067902714014053, 0.08971326798200607, 0.09673084318637848, 0.09011348336935043, 0.0905388817191124], [0.09299205988645554, 0.10937564820051193, 0.0893288403749466, 0.08755169063806534, 0.08580990880727768, 0.11622628569602966, 0.08242961764335632, 0.13398371636867523, 0.004396812524646521, 0.10948403924703598, 0.08842132985591888], [0.09164828807115555, 0.09222059696912766, 0.09150709211826324, 0.09143657982349396, 0.09136612713336945, 0.09243576228618622, 0.09122536331415176, 0.09294131398200989, 0.08152349293231964, 0.09222409874200821, 0.09147125482559204], [0.09267172962427139, 0.09422258287668228, 0.09229160100221634, 0.09210212528705597, 0.09191302955150604, 0.09480983018875122, 0.0915360078215599, 0.09619854390621185, 0.06782712042331696, 0.09423212707042694, 0.09219527244567871]], [[0.09115985035896301, 0.09120014309883118, 0.09054198861122131, 0.09050364792346954, 0.09143514186143875, 0.09104574471712112, 0.09135771542787552, 0.09096864610910416, 0.09066001325845718, 0.09027392417192459, 0.09085312485694885], [0.09108534455299377, 0.0911136195063591, 0.09065119177103043, 0.09062422066926956, 0.09127850085496902, 0.09100523591041565, 0.09122419357299805, 0.09095108509063721, 0.09073419123888016, 0.09046255797147751, 0.09086992591619492], [0.09229844063520432, 0.09252622723579407, 0.08886254578828812, 0.0886528268456459, 0.09386404603719711, 0.09165585041046143, 0.09342151880264282, 0.09122373163700104, 0.08951063454151154, 0.08740484714508057, 0.09057937562465668], [0.09236883372068405, 0.09260845929384232, 0.08875802159309387, 0.08853785693645477, 0.094016432762146, 0.09169299900531769, 0.09355058521032333, 0.09123866260051727, 0.08943856507539749, 0.08722826093435287, 0.09056137502193451], [0.09065008163452148, 0.09060883522033691, 0.09128721803426743, 0.09132704883813858, 0.09036901593208313, 0.09076707810163498, 0.09044789522886276, 0.09084631502628326, 0.09116483479738235, 0.09156640619039536, 0.09096527844667435], [0.09137072414159775, 0.09144516289234161, 0.09023255109786987, 0.09016212821006775, 0.0918799415230751, 0.09116003662347794, 0.09173659235239029, 0.09101780503988266, 0.09044945985078812, 0.08974076807498932, 0.09080487489700317], [0.09079360961914062, 0.09077517688274384, 0.09107781946659088, 0.09109555184841156, 0.09066787362098694, 0.09084588289260864, 0.09070318192243576, 0.09088125824928284, 0.09102331101894379, 0.091202013194561, 0.09093434363603592], [0.09151304513216019, 0.09161069244146347, 0.09002326428890228, 0.08993127942085266, 0.09218144416809082, 0.09123684465885162, 0.09199316054582596, 0.09105049073696136, 0.09030674397945404, 0.08938135206699371, 0.09077167510986328], [0.09208157658576965, 0.0922730565071106, 0.08918406069278717, 0.08900664001703262, 0.09339620172977448, 0.09154096990823746, 0.09302496165037155, 0.09117711335420609, 0.08973192423582077, 0.0879494845867157, 0.09063402563333511], [0.09278985112905502, 0.09310092777013779, 0.0881311297416687, 0.08784882724285126, 0.09493345022201538, 0.09191375970840454, 0.09432624280452728, 0.09132586419582367, 0.08900502324104309, 0.0861738994717598, 0.09045106172561646], [0.09172609448432922, 0.09185868501663208, 0.08970940858125687, 0.08958528190851212, 0.09263468533754349, 0.09135131537914276, 0.09237850457429886, 0.09109868854284286, 0.090092234313488, 0.08884409070014954, 0.09072104841470718]], [[0.09203638881444931, 0.09197602421045303, 0.09191570430994034, 0.09131014347076416, 0.0917951837182045, 0.09215863049030304, 0.0916748195886612, 0.09203778952360153, 0.08232273906469345, 0.09143299609422684, 0.09133961796760559], [0.09223617613315582, 0.092164546251297, 0.09209298342466354, 0.09137498587369919, 0.09195000678300858, 0.09238125383853912, 0.09180725365877151, 0.09223783761262894, 0.08082454651594162, 0.09152057021856308, 0.09140990674495697], [0.09243360906839371, 0.09235066920518875, 0.09226781129837036, 0.09143711626529694, 0.09210232645273209, 0.09260162711143494, 0.0919371247291565, 0.09243553131818771, 0.07935122400522232, 0.09160546958446503, 0.09147749841213226], [0.09429860860109329, 0.09409941732883453, 0.0939006432890892, 0.09192122519016266, 0.09350436180830002, 0.09470290690660477, 0.09310974925756454, 0.09430323541164398, 0.06582245975732803, 0.09232041984796524, 0.09201688319444656], [0.09282156825065613, 0.09271588176488876, 0.09261032193899155, 0.09155343472957611, 0.09239955991506577, 0.0930357500910759, 0.09218927472829819, 0.09282401949167252, 0.07647792994976044, 0.09176742285490036, 0.09160474687814713], [0.09162489324808121, 0.09158717840909958, 0.09154948592185974, 0.0911705419421196, 0.09147413820028305, 0.09170123934745789, 0.09139885008335114, 0.09162576496601105, 0.08543134480714798, 0.09124749153852463, 0.09118900448083878], [0.09320051968097687, 0.09307191520929337, 0.09294349700212479, 0.09165944159030914, 0.09268718212842941, 0.09346124529838562, 0.09243158251047134, 0.09320350736379623, 0.07370026409626007, 0.09191916882991791, 0.09172171354293823], [0.09203172475099564, 0.09197162091732025, 0.09191156178712845, 0.0913086086511612, 0.0917915552854538, 0.09215343743562698, 0.09167171269655228, 0.09203311800956726, 0.08235781639814377, 0.09143093228340149, 0.09133795648813248], [0.1090088039636612, 0.10672309994697571, 0.10448531806468964, 0.08439750969409943, 0.10014952719211578, 0.11378409713506699, 0.09599365293979645, 0.10906244069337845, 0.002970367670059204, 0.08814338594675064, 0.08528180420398712], [0.09393689781427383, 0.09376166760921478, 0.09358678013086319, 0.09184274077415466, 0.093237966299057, 0.09429240971803665, 0.09289044886827469, 0.09394096583127975, 0.0683882087469101, 0.0921948179602623, 0.09192711859941483], [0.09421258419752121, 0.09401915967464447, 0.09382613003253937, 0.09190328419208527, 0.09344126284122467, 0.09460514038801193, 0.09305797517299652, 0.09421707689762115, 0.06643000990152359, 0.09229116141796112, 0.09199623018503189]], [[0.0910324901342392, 0.09142350405454636, 0.09076374024152756, 0.09072530269622803, 0.09130740165710449, 0.09126873314380646, 0.09088004380464554, 0.09119144827127457, 0.09053335338830948, 0.09014780074357986, 0.09072619676589966], [0.09067294001579285, 0.08994319289922714, 0.09117978066205978, 0.09125262498855591, 0.09015893191099167, 0.09023096412420273, 0.09095990657806396, 0.09037519246339798, 0.09161771833896637, 0.09235786646604538, 0.09125092625617981], [0.09127424657344818, 0.09245163202285767, 0.0904708132147789, 0.09035628288984299, 0.09210097789764404, 0.09198439121246338, 0.09081792831420898, 0.09175165742635727, 0.08978583663702011, 0.08864724636077881, 0.09035894274711609], [0.09130845218896866, 0.09259938448667526, 0.09042844921350479, 0.09030307084321976, 0.09221474826335907, 0.09208689630031586, 0.09080855548381805, 0.09183172136545181, 0.08967877179384232, 0.08843386173248291, 0.09030597656965256], [0.09078064560890198, 0.09038081765174866, 0.09105749428272247, 0.09109722077846527, 0.09049917757511139, 0.09053866565227509, 0.09093748778104782, 0.09061768651008606, 0.09129613637924194, 0.0916982963681221, 0.09109630435705185], [0.09081635624170303, 0.09052693843841553, 0.09101653844118118, 0.09104525297880173, 0.09061264246702194, 0.09064123779535294, 0.09092977643013, 0.09069844335317612, 0.09118897467851639, 0.09147925674915314, 0.0910445898771286], [0.09117016196250916, 0.09200562536716461, 0.09059827029705048, 0.09051663428544998, 0.09175713360309601, 0.09167444705963135, 0.09084553271532059, 0.09150930494070053, 0.09010954201221466, 0.08929477632045746, 0.0905185267329216], [0.09088744223117828, 0.09081952273845673, 0.09093432128429413, 0.09094104170799255, 0.09083965420722961, 0.09084635972976685, 0.09091401100158691, 0.0908597856760025, 0.09097463637590408, 0.09104238450527191, 0.09094088524580002], [0.09147795289754868, 0.0933399349451065, 0.09021521359682083, 0.09003573656082153, 0.09278397262096405, 0.09259938448667526, 0.09075998514890671, 0.09223131090402603, 0.08914370834827423, 0.08737295120954514, 0.09003990143537521], [0.0918114110827446, 0.0948408842086792, 0.08977819979190826, 0.0894906222820282, 0.09393241256475449, 0.09363152831792831, 0.09065324813127518, 0.09303264319896698, 0.08806649595499039, 0.08526522666215897, 0.08949729055166245], [0.09130767732858658, 0.09259596467018127, 0.09042944014072418, 0.09030431509017944, 0.09221212565898895, 0.09208452701568604, 0.09080877900123596, 0.09182986617088318, 0.08968127518892288, 0.08843881636857986, 0.09030722081661224]], [[0.08431442826986313, 0.08402404189109802, 0.0837346687912941, 0.08344628661870956, 0.08315890282392502, 0.08760537207126617, 0.08521375805139542, 0.08977009356021881, 0.1469530612230301, 0.08403833955526352, 0.08774108439683914], [0.08404172211885452, 0.0837421715259552, 0.08344367891550064, 0.08314626663923264, 0.0828498974442482, 0.08743916451931, 0.08496969193220139, 0.0896763801574707, 0.1493547558784485, 0.08375690877437592, 0.08757936209440231], [0.08376599103212357, 0.0834573432803154, 0.08314982801675797, 0.08284344524145126, 0.0825381949543953, 0.08726920187473297, 0.08472238481044769, 0.08957859128713608, 0.1517886221408844, 0.08347253501415253, 0.08741385489702225], [0.08348722755908966, 0.08316955715417862, 0.08285309374332428, 0.08253782987594604, 0.08222377300262451, 0.08709545433521271, 0.08447180688381195, 0.08947668224573135, 0.15425486862659454, 0.08318518847227097, 0.08724455535411835], [0.08320538699626923, 0.08287877589464188, 0.0825534537434578, 0.08222940564155579, 0.08190662413835526, 0.08691788464784622, 0.08421793580055237, 0.08937059342861176, 0.15675367414951324, 0.08289485424757004, 0.08707140386104584], [0.08714289963245392, 0.08695928007364273, 0.08677604049444199, 0.08659319579601288, 0.08641072362661362, 0.08920707553625107, 0.08771005272865295, 0.09054844826459885, 0.1223924458026886, 0.0869683250784874, 0.08929155021905899], [0.08513428270816803, 0.08487261086702347, 0.08461172878742218, 0.08435165137052536, 0.0840923860669136, 0.08809329569339752, 0.08594412356615067, 0.0900331363081932, 0.13976623117923737, 0.08488548547029495, 0.08821506053209305], [0.08876457065343857, 0.08865325152873993, 0.08854208141565323, 0.08843105286359787, 0.08832016587257385, 0.09000935405492783, 0.08910775929689407, 0.09081201255321503, 0.10864099860191345, 0.08865874260663986, 0.0900600478053093], [0.10391225665807724, 0.10558832436800003, 0.10729141533374786, 0.10902197659015656, 0.11078045517206192, 0.08700446039438248, 0.09892262518405914, 0.07769158482551575, 0.007899811491370201, 0.10550504922866821, 0.08638207614421844], [0.08405523747205734, 0.08375614136457443, 0.08345810323953629, 0.0831611305475235, 0.08286520093679428, 0.08744744956493378, 0.08498180657625198, 0.08968111127614975, 0.1492355912923813, 0.08377086371183395, 0.08758742362260818], [0.08724980056285858, 0.08707066625356674, 0.08689191192388535, 0.0867135152220726, 0.0865354835987091, 0.08926279842853546, 0.08780299872159958, 0.09057027101516724, 0.12147780507802963, 0.0870794951915741, 0.08934515714645386]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_duration_sec_mean": 0.005848062103614211, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 7.926247711476416e-06, "listify_data_for_vector_env": 1.0485322062486889e-05, "un_batch_to_individual_items": 6.612175730981993e-06, "tensor_to_numpy": 1.5132264712412103e-05, "remove_single_ts_time_rank_from_batch": 1.2008574446237744e-05, "get_actions": 3.585576670400388e-05}}, "connector_pipeline_timer": 0.00011484207062459052}, "env_to_module_connector": {"connector_pipeline_timer": 5.906937206486578e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.742684052439002e-06, "numpy_to_tensor": 1.2072080120035542e-05, "add_states_from_episodes_to_batch": 2.72465345977868e-06, "add_observations_from_episodes_to_batch": 2.801208202779445e-06, "batch_individual_items": 1.2403738930464758e-05}}}, "env_step_timer": 1.3858547017661082e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": -0.45, "episode_return_max": 14.5, "module_episode_returns_mean": {"default_policy": -0.45}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_min": 20, "agent_episode_returns_mean": {"default_agent": -0.45}, "num_env_steps_sampled": 400, "episode_len_max": 20, "weights_seq_no": 20.0, "num_episodes": 20, "num_env_steps_sampled_lifetime": 100400, "env_reset_timer": 0.0006087983878047321, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -14.5, "episode_len_mean": 20.0, "num_episodes_lifetime": 400, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 3.1485467002918034e-05, "sample": 0.12999304935625125, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "time_between_sampling": 9.959786478610994}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "ba9e8_00000", "date": "2025-08-11_18-11-16", "timestamp": 1754928676, "time_this_iter_s": 9.983705997467041, "time_total_s": 203.31499862670898, "pid": 10327, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3858fd760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 203.31499862670898, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 44.82142857142858, "ram_util_percent": 82.10000000000001}}
