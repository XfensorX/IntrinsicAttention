{"timers": {"training_iteration": 11.745336624910124, "restore_env_runners": 1.679209526628256e-05, "training_step": 11.745120041072369, "env_runner_sampling_timer": 1.7941945421043783, "learner_update_timer": 9.738898916984908, "synch_weights": 0.0016137500060722232}, "env_runners": {"num_env_steps_sampled_lifetime": 627500.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 5.4169470260386156e-05, "listify_data_for_vector_env": 1.1483281497472662e-05, "normalize_and_clip_actions": 1.1233557954498187e-05, "tensor_to_numpy": 1.753773626123835e-05, "remove_single_ts_time_rank_from_batch": 1.2916654079612468e-05, "un_batch_to_individual_items": 7.239034080919255e-06}}, "connector_pipeline_timer": 0.0001439127067848086}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "weights_seq_no": 0.0, "env_reset_timer": 9.279097406547354e-05, "env_to_module_connector": {"connector_pipeline_timer": 6.842455276933621e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.980044663596062e-06, "add_states_from_episodes_to_batch": 3.021154487702353e-06, "numpy_to_tensor": 1.45962434573462e-05, "batch_individual_items": 1.3981442151126642e-05, "add_observations_from_episodes_to_batch": 3.1513680558621024e-06}}}, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "num_episodes": 250.0, "episode_return_min": -13.5, "episode_return_max": 6.5, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "env_to_module_sum_episodes_length_out": 10.191744832559449, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.005835967840161173, "num_episodes_lifetime": 31375.0, "module_episode_returns_mean": {"default_policy": -3.5}, "env_to_module_sum_episodes_length_in": 10.191744832559449, "rlmodule_inference_timer": 4.0339912510902473e-05, "episode_len_max": 20, "time_between_sampling": 0.0007309172017118032, "env_step_timer": 1.6857848813064498e-05, "episode_return_mean": -3.5, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "sample": 0.008141111001185862, "agent_episode_returns_mean": {"default_agent": -3.5}, "num_env_steps_sampled_lifetime_throughput": 2786.1324248654473}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000, "learner_connector": {"connector_pipeline_timer": 0.17247679189313203, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.0090261249570176, "add_observations_from_episodes_to_batch": 0.0008864999981597066, "add_columns_from_episodes_to_train_batch": 0.04124825005419552, "add_time_dim_to_batch_and_zero_pad": 0.10442683391738683, "add_states_from_episodes_to_batch": 0.0036801249952986836, "batch_individual_items": 0.012942166067659855, "numpy_to_tensor": 0.00010137504432350397}}}, "learner_connector_sum_episodes_length_out": 5250}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 31500, "num_module_steps_trained_lifetime": 11988, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3282.8925193511786, "num_module_steps_trained_throughput": 26232554.547112633, "num_module_steps_trained_lifetime_throughput": 11860913.782492787}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 6.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 35964, "mean_kl_loss": 1.5039138816064224e-05, "vf_loss": 0.2648437023162842, "vf_loss_unclipped": 38.864253997802734, "weights_seq_no": 6.0, "policy_loss": 0.0001320670999120921, "vf_explained_var": 0.0014260411262512207, "entropy": 0.6908757090568542, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.2053951472043991}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 35964, "diff_num_grad_updates_vs_sampler_policy": 6.0, "num_module_steps_trained": 35964, "weights_seq_no": 6.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 189000, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 71928, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 44992.614144786836}}}, "default_policy": {"total_loss": 0.20452524721622467, "vf_explained_var": 0.0002484917640686035, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 5994, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 38.92520523071289, "num_module_steps_trained": 5994, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 1.4061939509701915e-05, "policy_loss": 0.00012649421114474535, "vf_loss": 0.26373445987701416, "weights_seq_no": 1.0, "num_trainable_parameters": 16595, "entropy": 0.6908881664276123, "use_intrinsic_rewards": 0.0, "curr_kl_coeff": 0.08079196512699127, "num_module_steps_trained_lifetime_throughput": 624.66999729976}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 5994, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5994, "weights_seq_no": 1.0, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 624.6783535549337}, "IntrinsicAttentionMask": [[[0.3323669135570526, 0.3352481424808502, 0.33238494396209717], [0.33497706055641174, 0.3300769031047821, 0.3349460959434509], [0.3323833644390106, 0.33521556854248047, 0.3324010670185089]], [[0.3323267102241516, 0.33387792110443115, 0.3337953984737396], [0.3329801559448242, 0.3335243761539459, 0.33349546790122986], [0.33294546604156494, 0.33354315161705017, 0.3335114121437073]], [[0.3329063057899475, 0.3312525153160095, 0.33584117889404297], [0.3326420187950134, 0.3299902081489563, 0.3373677432537079], [0.3333629071712494, 0.3334793746471405, 0.3331577479839325]], [[0.3288347125053406, 0.33170682191848755, 0.3394584357738495], [0.3303987979888916, 0.3322782814502716, 0.3373228907585144], [0.3345542550086975, 0.3337656855583191, 0.3316799998283386]], [[0.331600159406662, 0.3341600298881531, 0.33423981070518494], [0.3335919678211212, 0.3332099914550781, 0.3331981301307678], [0.33365386724472046, 0.33318039774894714, 0.3331657350063324]], [[0.31318172812461853, 0.37128427624702454, 0.3155340552330017], [0.4978559613227844, 0.05154019221663475, 0.45060378313064575], [0.3259688913822174, 0.3471583127975464, 0.3268728256225586]]]}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"num_env_steps_sampled_lifetime": 5400, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.7046428312965067e-05, "get_actions": 4.6478504190080593e-05, "normalize_and_clip_actions": 9.590014560463061e-06, "remove_single_ts_time_rank_from_batch": 1.2838269191968141e-05, "un_batch_to_individual_items": 6.755577411798718e-06, "listify_data_for_vector_env": 1.054596606454417e-05}}, "connector_pipeline_timer": 0.00013007122706921371}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.948882988402113e-06, "add_states_from_episodes_to_batch": 2.819056994251126e-06, "numpy_to_tensor": 1.3189226920107633e-05, "batch_individual_items": 1.2732899325533705e-05, "add_observations_from_episodes_to_batch": 3.5799927338254224e-06}}, "connector_pipeline_timer": 6.516098492990808e-05}, "episode_return_max": 12.5, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "env_to_module_sum_episodes_length_in": 10.216013141322508, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": -0.3}, "env_reset_timer": 0.0005682500777766109, "agent_episode_returns_mean": {"default_agent": -0.3}, "env_to_module_sum_episodes_length_out": 10.216013141322508, "episode_len_max": 20, "episode_len_mean": 20.0, "sample": 0.11930237500928342, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.005416424962459132, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "episode_return_mean": -0.3, "env_step_timer": 1.5834817097006207e-05, "weights_seq_no": 1.0, "num_episodes": 20, "episode_return_min": -15.5, "num_episodes_lifetime": 20, "rlmodule_inference_timer": 3.831512690025892e-05, "num_env_steps_sampled": 400}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "b949d_00000", "date": "2025-08-11_18-12-17", "timestamp": 1754928737, "time_this_iter_s": 11.879527807235718, "time_total_s": 11.879527807235718, "pid": 10485, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x152ff98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11.879527807235718, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 38.688235294117646, "ram_util_percent": 81.12352941176471}}
{"timers": {"training_iteration": 11.750956953661516, "restore_env_runners": 1.676250481978059e-05, "training_step": 11.750739364412148, "env_runner_sampling_timer": 1.7980098012741654, "learner_update_timer": 9.738866051975638, "synch_weights": 0.0016103512560948728, "restore_eval_env_runners": 5.787494592368603e-05, "evaluation_iteration": 0.13175245805177838, "synch_eval_env_connectors": 0.00020250002853572369, "synch_env_connectors": 5.209003575146198e-06}, "env_runners": {"num_env_steps_sampled_lifetime": 10000.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 6.350480682660339e-05, "listify_data_for_vector_env": 1.3668107621573812e-05, "normalize_and_clip_actions": 1.0476137868784312e-05, "tensor_to_numpy": 2.1527345792694137e-05, "remove_single_ts_time_rank_from_batch": 1.4725635155643699e-05, "un_batch_to_individual_items": 8.340070180177841e-06}}, "connector_pipeline_timer": 0.00016583625557831943}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "weights_seq_no": 1.0, "env_reset_timer": 6.395817416720808e-05, "env_to_module_connector": {"connector_pipeline_timer": 8.205896052748286e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 9.429045130823428e-06, "add_states_from_episodes_to_batch": 3.3369907569625783e-06, "numpy_to_tensor": 1.9544157972718604e-05, "batch_individual_items": 1.8316469347293183e-05, "add_observations_from_episodes_to_batch": 3.659931675029197e-06}}}, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "num_episodes": 250.0, "episode_return_min": -13.5, "episode_return_max": 6.5, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.00749553734110668, "num_episodes_lifetime": 500.0, "module_episode_returns_mean": {"default_policy": -2.6999999999999993}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 4.797413032787073e-05, "episode_len_max": 20, "time_between_sampling": 0.03809223806517348, "env_step_timer": 2.202882838903828e-05, "episode_return_mean": -2.6999999999999993, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "sample": 0.007682466903337131, "agent_episode_returns_mean": {"default_agent": -2.6999999999999993}, "num_env_steps_sampled_lifetime_throughput": 2669.521797798578}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17421102730440907, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009029525787336751, "add_observations_from_episodes_to_batch": 0.000886127088451758, "add_columns_from_episodes_to_train_batch": 0.04125457421410829, "add_time_dim_to_batch_and_zero_pad": 0.10441895473748446, "add_states_from_episodes_to_batch": 0.0036818999960087236, "batch_individual_items": 0.01467177315731533, "numpy_to_tensor": 0.00010304713388904928}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 63000, "num_module_steps_trained_lifetime": 23976, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3278.3947736205682, "num_module_steps_trained_throughput": 25875939.715641934, "num_module_steps_trained_lifetime_throughput": 11833502.79051805}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 11.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 71928, "mean_kl_loss": 2.48435480898479e-05, "vf_loss": 0.26426732540130615, "vf_loss_unclipped": 40.417842864990234, "weights_seq_no": 12.0, "policy_loss": -0.00021719631331507117, "vf_explained_var": 0.0014843344688415527, "entropy": 0.6904314756393433, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.20459911227226257}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 71928, "diff_num_grad_updates_vs_sampler_policy": 11.0, "num_module_steps_trained": 35964, "weights_seq_no": 12.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 378000, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 143856, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 44746.44404313536}}}, "default_policy": {"total_loss": 0.20399732887744904, "vf_explained_var": 0.0006000995635986328, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 11988, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 40.56718826293945, "num_module_steps_trained": 5994, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 2.6089912353199907e-05, "policy_loss": -0.0002227804798167199, "vf_loss": 0.2635044753551483, "weights_seq_no": 2.0, "num_trainable_parameters": 16595, "entropy": 0.6904188990592957, "use_intrinsic_rewards": 0.0, "curr_kl_coeff": 0.040395982563495636, "num_module_steps_trained_lifetime_throughput": 623.814372664362}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 11988, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5994, "weights_seq_no": 2.0, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 623.8226126688058}, "IntrinsicAttentionMask": [[[0.3316417634487152, 0.3356122374534607, 0.3327459394931793], [0.337956964969635, 0.3271420896053314, 0.33490100502967834], [0.3334053158760071, 0.3332365155220032, 0.33335816860198975]], [[0.332516074180603, 0.33237114548683167, 0.3351127505302429], [0.3325001001358032, 0.33235234022140503, 0.33514755964279175], [0.3328012228012085, 0.3327067196369171, 0.3344919681549072]], [[0.3313206136226654, 0.33140161633491516, 0.33727777004241943], [0.331390917301178, 0.3314691185951233, 0.33713996410369873], [0.3364101052284241, 0.33628350496292114, 0.3273063898086548]], [[0.3332361578941345, 0.33251672983169556, 0.33424708247184753], [0.3330664336681366, 0.33112001419067383, 0.3358135223388672], [0.3334667384624481, 0.3344765603542328, 0.3320566713809967]], [[0.331600159406662, 0.3341600298881531, 0.33423981070518494], [0.33359193801879883, 0.33320996165275574, 0.3331981301307678], [0.33365386724472046, 0.33318042755126953, 0.3331657350063324]], [[0.31454095244407654, 0.37054938077926636, 0.3149097263813019], [0.4743894040584564, 0.05827999860048294, 0.46733054518699646], [0.3164324164390564, 0.3668007552623749, 0.31676679849624634]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_env_steps_sampled_lifetime": 10400, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4395115815477389e-05, "get_actions": 3.562047360508341e-05, "normalize_and_clip_actions": 7.685463942854954e-06, "remove_single_ts_time_rank_from_batch": 1.1745517207390828e-05, "un_batch_to_individual_items": 6.440277297308659e-06, "listify_data_for_vector_env": 1.0053124329500957e-05}}, "connector_pipeline_timer": 0.00011156556867263775}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.676716529979795e-06, "add_states_from_episodes_to_batch": 2.725755710067665e-06, "numpy_to_tensor": 1.1907273103376114e-05, "batch_individual_items": 1.2177919594313142e-05, "add_observations_from_episodes_to_batch": 2.75410677087931e-06}}, "connector_pipeline_timer": 5.82453882731628e-05}, "episode_return_max": 13.5, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "env_to_module_sum_episodes_length_in": 10.366003441359926, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": 1.2}, "env_reset_timer": 0.0005661213269922883, "agent_episode_returns_mean": {"default_agent": 1.2}, "env_to_module_sum_episodes_length_out": 10.366003441359926, "episode_len_max": 20, "episode_len_mean": 20.0, "sample": 0.11924252917873673, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.005292245774762705, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "episode_return_mean": 1.2, "env_step_timer": 1.3592535102075825e-05, "weights_seq_no": 2.0, "num_episodes": 20, "episode_return_min": -15.5, "num_episodes_lifetime": 40, "rlmodule_inference_timer": 3.0967955082940425e-05, "num_env_steps_sampled": 400, "time_between_sampling": 12.358336874982342}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "b949d_00000", "date": "2025-08-11_18-12-29", "timestamp": 1754928749, "time_this_iter_s": 12.432406902313232, "time_total_s": 24.31193470954895, "pid": 10485, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x152ff98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 24.31193470954895, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 47.06666666666667, "ram_util_percent": 81.13333333333334}}
{"timers": {"training_iteration": 11.75262441662564, "restore_env_runners": 1.667779891286045e-05, "training_step": 11.752406119518053, "env_runner_sampling_timer": 1.7970848520115017, "learner_update_timer": 9.741339088125713, "synch_weights": 0.00161243149433285, "restore_eval_env_runners": 5.74703561142087e-05, "evaluation_iteration": 0.13165706930099985, "synch_eval_env_connectors": 0.00020248793880455195, "synch_env_connectors": 5.205243360251189e-06}, "env_runners": {"num_env_steps_sampled_lifetime": -607500.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.6440286874891215e-05, "listify_data_for_vector_env": 1.1348049893757085e-05, "normalize_and_clip_actions": 8.669131478772998e-06, "tensor_to_numpy": 1.7031886419786686e-05, "remove_single_ts_time_rank_from_batch": 1.2728585211186884e-05, "un_batch_to_individual_items": 7.093113647617095e-06}}, "connector_pipeline_timer": 0.00013154676699613839}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "weights_seq_no": 2.0, "env_reset_timer": 5.3697607913907904e-05, "env_to_module_connector": {"connector_pipeline_timer": 6.474246986557761e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.456734042788561e-06, "add_states_from_episodes_to_batch": 2.897682763468602e-06, "numpy_to_tensor": 1.410828535568389e-05, "batch_individual_items": 1.3515004353462203e-05, "add_observations_from_episodes_to_batch": 3.0084564290336407e-06}}}, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "num_episodes": 250.0, "episode_return_min": -13.5, "episode_return_max": 6.5, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.005838062844239175, "num_episodes_lifetime": -30375.0, "module_episode_returns_mean": {"default_policy": -3.339999999999999}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 3.5804911251454494e-05, "episode_len_max": 20, "time_between_sampling": 0.0413797605345609, "env_step_timer": 1.5424721315545406e-05, "episode_return_mean": -3.339999999999999, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "sample": 0.006566042533623999, "agent_episode_returns_mean": {"default_agent": -3.339999999999999}, "num_env_steps_sampled_lifetime_throughput": 2960.009633161153}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17420274869102287, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009030300108820666, "add_observations_from_episodes_to_batch": 0.0008859853973495773, "add_columns_from_episodes_to_train_batch": 0.0412539488913957, "add_time_dim_to_batch_and_zero_pad": 0.10442494477103464, "add_states_from_episodes_to_batch": 0.0036830164152896025, "batch_individual_items": 0.014656966675806326, "numpy_to_tensor": 0.00010287458293605594}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 94500, "num_module_steps_trained_lifetime": 35964, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3272.3244803046978, "num_module_steps_trained_throughput": 25357737.44763818, "num_module_steps_trained_lifetime_throughput": 11821145.318793327}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 16.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 107892, "mean_kl_loss": 1.744870314723812e-05, "vf_loss": 0.26384827494621277, "vf_loss_unclipped": 36.82014465332031, "weights_seq_no": 18.0, "policy_loss": -0.0002522990107536316, "vf_explained_var": 0.0016322135925292969, "entropy": 0.6898559331893921, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.20423723757266998}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 107892, "diff_num_grad_updates_vs_sampler_policy": 16.0, "num_module_steps_trained": 35964, "weights_seq_no": 18.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 567000, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 215784, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 44311.91419609542}}}, "default_policy": {"total_loss": 0.20404215157032013, "vf_explained_var": 0.00040709972381591797, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 17982, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 36.82650375366211, "num_module_steps_trained": 5994, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 1.899716335174162e-05, "policy_loss": -0.00026263497420586646, "vf_loss": 0.2636137306690216, "weights_seq_no": 3.0, "num_trainable_parameters": 16595, "entropy": 0.689835250377655, "use_intrinsic_rewards": 0.0, "curr_kl_coeff": 0.020197991281747818, "num_module_steps_trained_lifetime_throughput": 622.6596472105712}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 17982, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5994, "weights_seq_no": 3.0, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 622.6676533902579}, "IntrinsicAttentionMask": [[[0.33154526352882385, 0.3371306359767914, 0.33132404088974], [0.33382678031921387, 0.33228468894958496, 0.33388856053352356], [0.33145371079444885, 0.33732497692108154, 0.33122125267982483]], [[0.3340105712413788, 0.332157164812088, 0.3338322937488556], [0.33446046710014343, 0.3313762843608856, 0.33416327834129333], [0.33405375480651855, 0.33208218216896057, 0.33386409282684326]], [[0.3323274552822113, 0.33241531252861023, 0.33525723218917847], [0.3323599100112915, 0.3324449360370636, 0.3351951539516449], [0.3334037959575653, 0.33339762687683105, 0.333198606967926]], [[0.3324149250984192, 0.3323177099227905, 0.33526742458343506], [0.33238813281059265, 0.33228808641433716, 0.3353238105773926], [0.33319613337516785, 0.33318156003952026, 0.3336222469806671]], [[0.332750529050827, 0.3336164057254791, 0.33363306522369385], [0.33794310688972473, 0.33109351992607117, 0.3309633135795593], [0.3380432426929474, 0.33104488253593445, 0.3309118449687958]], [[0.3468339741230011, 0.30181685090065, 0.3513491749763489], [0.4273340106010437, 0.05843210592865944, 0.5142339468002319], [0.3299645781517029, 0.3410869836807251, 0.328948438167572]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_env_steps_sampled_lifetime": 15400, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5478537619557274e-05, "get_actions": 3.830593714146892e-05, "normalize_and_clip_actions": 8.014834260080378e-06, "remove_single_ts_time_rank_from_batch": 1.2107645803341906e-05, "un_batch_to_individual_items": 6.716405631190029e-06, "listify_data_for_vector_env": 1.0498635851000321e-05}}, "connector_pipeline_timer": 0.0001177306463430221}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.902180484293719e-06, "add_states_from_episodes_to_batch": 2.9055015167417603e-06, "numpy_to_tensor": 1.2726078923586985e-05, "batch_individual_items": 1.2689846972788594e-05, "add_observations_from_episodes_to_batch": 2.859450501541788e-06}}, "connector_pipeline_timer": 6.096643390195507e-05}, "episode_return_max": 13.5, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "env_to_module_sum_episodes_length_in": 10.368205581254823, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": 0.36666666666666664}, "env_reset_timer": 0.0005639221936347895, "agent_episode_returns_mean": {"default_agent": 0.36666666666666664}, "env_to_module_sum_episodes_length_out": 10.368205581254823, "episode_len_max": 20, "episode_len_mean": 20.0, "sample": 0.11921500055791112, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.005294898598610113, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "episode_return_mean": 0.36666666666666664, "env_step_timer": 1.4522593540569432e-05, "weights_seq_no": 3.0, "num_episodes": 20, "episode_return_min": -15.5, "num_episodes_lifetime": 60, "rlmodule_inference_timer": 3.4030605120231705e-05, "num_env_steps_sampled": 400, "time_between_sampling": 12.354218556652777}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "b949d_00000", "date": "2025-08-11_18-12-41", "timestamp": 1754928761, "time_this_iter_s": 12.046418905258179, "time_total_s": 36.35835361480713, "pid": 10485, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x152ff98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 36.35835361480713, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 43.417647058823526, "ram_util_percent": 81.1470588235294}}
{"timers": {"training_iteration": 11.750673409959399, "restore_env_runners": 1.6627270935801784e-05, "training_step": 11.750454092912586, "env_runner_sampling_timer": 1.7950245347412153, "learner_update_timer": 9.741269651414811, "synch_weights": 0.0016145125985722987, "restore_eval_env_runners": 5.744440294802189e-05, "evaluation_iteration": 0.1315974648577743, "synch_eval_env_connectors": 0.00020241389848524703, "synch_env_connectors": 5.211941082961858e-06}, "env_runners": {"num_env_steps_sampled_lifetime": -1225000.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.207684380372337e-05, "listify_data_for_vector_env": 1.0732355283475645e-05, "normalize_and_clip_actions": 8.218108573562555e-06, "tensor_to_numpy": 1.608077671870433e-05, "remove_single_ts_time_rank_from_batch": 1.2173725536618537e-05, "un_batch_to_individual_items": 6.745409353446012e-06}}, "connector_pipeline_timer": 0.00012315959004159365}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "weights_seq_no": 3.0, "env_reset_timer": 4.8400217236951075e-05, "env_to_module_connector": {"connector_pipeline_timer": 6.124412110670824e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.118374520657171e-06, "add_states_from_episodes_to_batch": 2.7671044688525643e-06, "numpy_to_tensor": 1.3003501327029307e-05, "batch_individual_items": 1.2790639466071062e-05, "add_observations_from_episodes_to_batch": 2.8311607745332796e-06}}}, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "num_episodes": 250.0, "episode_return_min": -13.5, "episode_return_max": 6.5, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.005453829151578248, "num_episodes_lifetime": -61250.0, "module_episode_returns_mean": {"default_policy": -3.8199999999999994}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 3.2985571024747415e-05, "episode_len_max": 20, "time_between_sampling": 0.04193077300597569, "env_step_timer": 1.441865225963831e-05, "episode_return_mean": -3.8199999999999994, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "sample": 0.006034798117911936, "agent_episode_returns_mean": {"default_agent": -3.8199999999999994}, "num_env_steps_sampled_lifetime_throughput": 3124.6405242335477}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.174246319954106, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00904257544759789, "add_observations_from_episodes_to_batch": 0.0008863580432456219, "add_columns_from_episodes_to_train_batch": 0.04126620523310406, "add_time_dim_to_batch_and_zero_pad": 0.10445416449252935, "add_states_from_episodes_to_batch": 0.00369438625028287, "batch_individual_items": 0.01463545116964693, "numpy_to_tensor": 0.00010273416750296017}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 126000, "num_module_steps_trained_lifetime": 47952, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3264.176021283747, "num_module_steps_trained_throughput": 24777987.26417427, "num_module_steps_trained_lifetime_throughput": 11819275.330977168}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 21.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 143856, "mean_kl_loss": 1.95276370504871e-05, "vf_loss": 0.26368942856788635, "vf_loss_unclipped": 39.93537902832031, "weights_seq_no": 24.0, "policy_loss": -0.0003433162346482277, "vf_explained_var": 0.001604914665222168, "entropy": 0.6894192099571228, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.20402349531650543}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 143856, "diff_num_grad_updates_vs_sampler_policy": 21.0, "num_module_steps_trained": 35964, "weights_seq_no": 24.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 756000, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 287712, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 43757.078418485486}}}, "default_policy": {"total_loss": 0.20377060770988464, "vf_explained_var": 0.00020641088485717773, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 23976, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 40.02402114868164, "num_module_steps_trained": 5994, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 2.1533984181587584e-05, "policy_loss": -0.0003595720627345145, "vf_loss": 0.26338914036750793, "weights_seq_no": 4.0, "num_trainable_parameters": 16595, "entropy": 0.68939208984375, "use_intrinsic_rewards": 0.0, "curr_kl_coeff": 0.010098995640873909, "num_module_steps_trained_lifetime_throughput": 621.1095921740786}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 23976, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5994, "weights_seq_no": 4.0, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 621.1173162957907}, "IntrinsicAttentionMask": [[[0.3308042287826538, 0.33861228823661804, 0.33058348298072815], [0.3352991044521332, 0.32922637462615967, 0.33547452092170715], [0.33067455887794495, 0.33888277411460876, 0.3304426670074463]], [[0.3323267102241516, 0.33387792110443115, 0.3337953984737396], [0.3329801857471466, 0.3335243761539459, 0.33349546790122986], [0.33294546604156494, 0.33354315161705017, 0.3335114121437073]], [[0.3313206136226654, 0.3314015865325928, 0.3372777998447418], [0.3313908874988556, 0.3314690887928009, 0.3371399939060211], [0.3364101052284241, 0.33628350496292114, 0.3273063898086548]], [[0.3298320770263672, 0.3296799063682556, 0.3404879868030548], [0.3297671377658844, 0.32961219549179077, 0.3406207263469696], [0.33427664637565613, 0.33431851863861084, 0.33140477538108826]], [[0.3305509686470032, 0.3346845507621765, 0.3347644507884979], [0.3357265293598175, 0.332170695066452, 0.33210277557373047], [0.3358263671398163, 0.33212220668792725, 0.33205148577690125]], [[0.3145408630371094, 0.3705494999885559, 0.31490960717201233], [0.4743899405002594, 0.05827917531132698, 0.4673308730125427], [0.3164324164390564, 0.36680078506469727, 0.31676676869392395]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_env_steps_sampled_lifetime": 20400, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5288838971474544e-05, "get_actions": 3.771552956978991e-05, "normalize_and_clip_actions": 8.073523114760169e-06, "remove_single_ts_time_rank_from_batch": 1.2149552583077081e-05, "un_batch_to_individual_items": 6.671619665000594e-06, "listify_data_for_vector_env": 1.0775157427397106e-05}}, "connector_pipeline_timer": 0.00011724666745565117}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.953595127630937e-06, "add_states_from_episodes_to_batch": 2.762370549110405e-06, "numpy_to_tensor": 1.2490841752712057e-05, "batch_individual_items": 1.2618562981487689e-05, "add_observations_from_episodes_to_batch": 2.861307895313613e-06}}, "connector_pipeline_timer": 6.028610519558741e-05}, "episode_return_max": 13.5, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "env_to_module_sum_episodes_length_in": 10.368237912813044, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": -0.3}, "env_reset_timer": 0.0005616488122284646, "agent_episode_returns_mean": {"default_agent": -0.3}, "env_to_module_sum_episodes_length_out": 10.368237912813044, "episode_len_max": 20, "episode_len_mean": 20.0, "sample": 0.11922398222213647, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.005336319263733458, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "episode_return_mean": -0.3, "env_step_timer": 1.444845867419248e-05, "weights_seq_no": 4.0, "num_episodes": 20, "episode_return_min": -15.5, "num_episodes_lifetime": 80, "rlmodule_inference_timer": 3.2044965113716524e-05, "num_env_steps_sampled": 400, "time_between_sampling": 12.346596674005362}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "b949d_00000", "date": "2025-08-11_18-12-53", "timestamp": 1754928773, "time_this_iter_s": 11.69198489189148, "time_total_s": 48.05033850669861, "pid": 10485, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x152ff98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 48.05033850669861, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 41.33529411764705, "ram_util_percent": 80.97058823529412}}
{"timers": {"training_iteration": 11.749343282110033, "restore_env_runners": 1.6533498196417926e-05, "training_step": 11.749123534072845, "env_runner_sampling_timer": 1.7929065189740678, "learner_update_timer": 9.741968397400457, "synch_weights": 0.0016166066428994572, "restore_eval_env_runners": 5.7517038350924844e-05, "evaluation_iteration": 0.13159173020921727, "synch_eval_env_connectors": 0.00020277059951506087, "synch_env_connectors": 5.211491448571906e-06}, "env_runners": {"num_env_steps_sampled_lifetime": -1842500.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.213935075792578e-05, "listify_data_for_vector_env": 1.065584601129086e-05, "normalize_and_clip_actions": 8.104602318875852e-06, "tensor_to_numpy": 1.5755855636882145e-05, "remove_single_ts_time_rank_from_batch": 1.2061315242905715e-05, "un_batch_to_individual_items": 6.666148831290682e-06}}, "connector_pipeline_timer": 0.00012219935777791445}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "weights_seq_no": 4.0, "env_reset_timer": 4.3554327830887765e-05, "env_to_module_connector": {"connector_pipeline_timer": 6.092002737045336e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.026675767198491e-06, "add_states_from_episodes_to_batch": 2.745650704635408e-06, "numpy_to_tensor": 1.2943276476743141e-05, "batch_individual_items": 1.2711029982339744e-05, "add_observations_from_episodes_to_batch": 2.8067040204658003e-06}}}, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "num_episodes": 250.0, "episode_return_min": -13.5, "episode_return_max": 6.5, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.0054460441907867784, "num_episodes_lifetime": -92125.0, "module_episode_returns_mean": {"default_policy": -3.4200000000000017}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 3.311162643095589e-05, "episode_len_max": 20, "time_between_sampling": 0.041067102631613464, "env_step_timer": 1.4310454485920656e-05, "episode_return_mean": -3.4200000000000017, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "sample": 0.00585269787055342, "agent_episode_returns_mean": {"default_agent": -3.4200000000000017}, "num_env_steps_sampled_lifetime_throughput": 3161.2596664536086}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1742160788352427, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009046629273997396, "add_observations_from_episodes_to_batch": 0.0008860011329417198, "add_columns_from_episodes_to_train_batch": 0.04126933193117006, "add_time_dim_to_batch_and_zero_pad": 0.10443515992773554, "add_states_from_episodes_to_batch": 0.0036954111378917995, "batch_individual_items": 0.014617040407490014, "numpy_to_tensor": 0.00010250765614000379}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 157500, "num_module_steps_trained_lifetime": 59940, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3254.264247469724, "num_module_steps_trained_throughput": 24162714.697297007, "num_module_steps_trained_lifetime_throughput": 11805390.845604999}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 26.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 179820, "mean_kl_loss": 2.0685551135102287e-05, "vf_loss": 0.26356393098831177, "vf_loss_unclipped": 38.36825180053711, "weights_seq_no": 30.0, "policy_loss": -0.00030289613641798496, "vf_explained_var": 0.001651465892791748, "entropy": 0.6887633204460144, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.20396734774112701}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 179820, "diff_num_grad_updates_vs_sampler_policy": 26.0, "num_module_steps_trained": 35964, "weights_seq_no": 30.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 945000, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 359640, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 43127.974980916144}}}, "default_policy": {"total_loss": 0.2038193643093109, "vf_explained_var": -0.0001499652862548828, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 29970, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 38.42743682861328, "num_module_steps_trained": 5994, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 2.2573825845029205e-05, "policy_loss": -0.0003159823245368898, "vf_loss": 0.2633947432041168, "weights_seq_no": 5.0, "num_trainable_parameters": 16595, "entropy": 0.6887364983558655, "use_intrinsic_rewards": 0.0, "curr_kl_coeff": 0.0050494978204369545, "num_module_steps_trained_lifetime_throughput": 619.2240798237751}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 29970, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5994, "weights_seq_no": 5.0, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 619.2314988389782}, "IntrinsicAttentionMask": [[[0.3323669135570526, 0.33524811267852783, 0.3323849141597748], [0.33497706055641174, 0.3300768733024597, 0.3349460959434509], [0.3323833644390106, 0.3352155387401581, 0.3324010670185089]], [[0.33401042222976685, 0.33392128348350525, 0.3320683538913727], [0.33403196930885315, 0.33393996953964233, 0.33202800154685974], [0.3344815671443939, 0.33433008193969727, 0.3311883211135864]], [[0.3313274383544922, 0.3330199718475342, 0.335652619600296], [0.33278363943099976, 0.33324840664863586, 0.333967924118042], [0.3350368142127991, 0.33359190821647644, 0.3313712775707245]], [[0.3308590054512024, 0.3307063579559326, 0.3384346067905426], [0.3308131694793701, 0.3306577205657959, 0.338529109954834], [0.3330996334552765, 0.3330850601196289, 0.3338152766227722]], [[0.33107468485832214, 0.3336305022239685, 0.33529484272003174], [0.33367037773132324, 0.333288311958313, 0.33304131031036377], [0.33535444736480713, 0.33306071162223816, 0.3315848410129547]], [[0.31318163871765137, 0.3712843954563141, 0.31553399562835693], [0.49785667657852173, 0.051539331674575806, 0.45060408115386963], [0.3259688913822174, 0.3471582531929016, 0.3268728256225586]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_env_steps_sampled_lifetime": 25400, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4920387863176133e-05, "get_actions": 3.756414595061093e-05, "normalize_and_clip_actions": 7.990372879656151e-06, "remove_single_ts_time_rank_from_batch": 1.1879019270975377e-05, "un_batch_to_individual_items": 6.615478465896302e-06, "listify_data_for_vector_env": 1.0460290482658528e-05}}, "connector_pipeline_timer": 0.0001156574413171374}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.791421743918927e-06, "add_states_from_episodes_to_batch": 2.752803492783881e-06, "numpy_to_tensor": 1.1979217093493154e-05, "batch_individual_items": 1.236652486464642e-05, "add_observations_from_episodes_to_batch": 2.7618434719133397e-06}}, "connector_pipeline_timer": 5.866245261559153e-05}, "episode_return_max": 13.5, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "env_to_module_sum_episodes_length_in": 10.368238387501162, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": -0.9}, "env_reset_timer": 0.0005594585748750053, "agent_episode_returns_mean": {"default_agent": -0.9}, "env_to_module_sum_episodes_length_out": 10.368238387501162, "episode_len_max": 20, "episode_len_mean": 20.0, "sample": 0.11921002239979149, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.005342144189635292, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "episode_return_mean": -0.9, "env_step_timer": 1.4084269693235385e-05, "weights_seq_no": 5.0, "num_episodes": 20, "episode_return_min": -15.5, "num_episodes_lifetime": 100, "rlmodule_inference_timer": 3.252404634593864e-05, "num_env_steps_sampled": 400, "time_between_sampling": 12.339609708515425}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "b949d_00000", "date": "2025-08-11_18-13-05", "timestamp": 1754928785, "time_this_iter_s": 11.74755311012268, "time_total_s": 59.79789161682129, "pid": 10485, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x152ff98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 59.79789161682129, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 43.10625, "ram_util_percent": 80.73124999999999}}
{"timers": {"training_iteration": 11.745152578458304, "restore_env_runners": 1.6432743450084018e-05, "training_step": 11.744932337062606, "env_runner_sampling_timer": 1.7911150767051234, "learner_update_timer": 9.739488110506322, "synch_weights": 0.0016168959869844895, "restore_eval_env_runners": 5.727061785133555e-05, "evaluation_iteration": 0.1315453595774986, "synch_eval_env_connectors": 0.00020236414335026052, "synch_env_connectors": 5.200206879910548e-06}, "env_runners": {"num_env_steps_sampled_lifetime": -2460000.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.3016121694605466e-05, "listify_data_for_vector_env": 1.0847718538243351e-05, "normalize_and_clip_actions": 8.33022961259981e-06, "tensor_to_numpy": 1.5988884465061574e-05, "remove_single_ts_time_rank_from_batch": 1.2176288603548273e-05, "un_batch_to_individual_items": 6.733509995689038e-06}}, "connector_pipeline_timer": 0.00012422096441340935}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "weights_seq_no": 5.0, "env_reset_timer": 4.586495573774497e-05, "env_to_module_connector": {"connector_pipeline_timer": 6.1890882117289e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.160334391859591e-06, "add_states_from_episodes_to_batch": 2.7634046183206804e-06, "numpy_to_tensor": 1.3183285330248729e-05, "batch_individual_items": 1.2962232047698728e-05, "add_observations_from_episodes_to_batch": 2.8615646819729265e-06}}}, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "num_episodes": 250.0, "episode_return_min": -13.5, "episode_return_max": 6.5, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.0055251341680996125, "num_episodes_lifetime": -123000.0, "module_episode_returns_mean": {"default_policy": -3.2599999999999985}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 3.3963320844530035e-05, "episode_len_max": 20, "time_between_sampling": 0.04124351797482282, "env_step_timer": 1.4577586815804168e-05, "episode_return_mean": -3.2599999999999985, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "sample": 0.005910629184727024, "agent_episode_returns_mean": {"default_agent": -3.2599999999999985}, "num_env_steps_sampled_lifetime_throughput": 3093.2971553465104}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17419678596648805, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00905180882130435, "add_observations_from_episodes_to_batch": 0.0008867186217805367, "add_columns_from_episodes_to_train_batch": 0.0412719177716464, "add_time_dim_to_batch_and_zero_pad": 0.10442681540798682, "add_states_from_episodes_to_batch": 0.0036966736970223094, "batch_individual_items": 0.014597262503657333, "numpy_to_tensor": 0.00010212425035513486}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 189000, "num_module_steps_trained_lifetime": 71928, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3244.4055228909456, "num_module_steps_trained_throughput": 23561225.422066953, "num_module_steps_trained_lifetime_throughput": 11804440.591800895}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 31.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 215784, "mean_kl_loss": 8.115069795167074e-05, "vf_loss": 0.2635028660297394, "vf_loss_unclipped": 39.95356369018555, "weights_seq_no": 36.0, "policy_loss": -0.0014297644374892116, "vf_explained_var": 0.0016605257987976074, "entropy": 0.6875336766242981, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.2028045654296875}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 215784, "diff_num_grad_updates_vs_sampler_policy": 31.0, "num_module_steps_trained": 35964, "weights_seq_no": 36.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 1134000, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 431568, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 42445.62894152165}}}, "default_policy": {"total_loss": 0.20263417065143585, "vf_explained_var": -0.00029718875885009766, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 35964, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 40.01472854614258, "num_module_steps_trained": 5994, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 9.035816765390337e-05, "policy_loss": -0.0015077751595526934, "vf_loss": 0.2634003460407257, "weights_seq_no": 6.0, "num_trainable_parameters": 16595, "entropy": 0.6874592304229736, "use_intrinsic_rewards": 0.0, "curr_kl_coeff": 0.0025247489102184772, "num_module_steps_trained_lifetime_throughput": 617.3487169254261}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 35964, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5994, "weights_seq_no": 6.0, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 617.3558028296461}, "IntrinsicAttentionMask": [[[0.3323669135570526, 0.3352481424808502, 0.33238494396209717], [0.33497706055641174, 0.3300768733024597, 0.3349460959434509], [0.3323833644390106, 0.33521556854248047, 0.3324010670185089]], [[0.33155861496925354, 0.33429351449012756, 0.3341478109359741], [0.33221131563186646, 0.3339402973651886, 0.33384832739830017], [0.33217668533325195, 0.33395907282829285, 0.3338642418384552]], [[0.3329063057899475, 0.3312525451183319, 0.33584120869636536], [0.3326420187950134, 0.3299902081489563, 0.3373677730560303], [0.3333629071712494, 0.3334793746471405, 0.3331577479839325]], [[0.33176735043525696, 0.331670343875885, 0.33656224608421326], [0.331721693277359, 0.33162185549736023, 0.33665651082992554], [0.33400124311447144, 0.33404308557510376, 0.3319556415081024]], [[0.3307816684246063, 0.33457255363464355, 0.3346458077430725], [0.3359590172767639, 0.33205774426460266, 0.3319832384586334], [0.3360588550567627, 0.3320092260837555, 0.3319318890571594]], [[0.3001501262187958, 0.39329203963279724, 0.3065578043460846], [0.5188747048377991, 0.049382030963897705, 0.43174320459365845], [0.3254559338092804, 0.3474225103855133, 0.3271215856075287]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_env_steps_sampled_lifetime": 30400, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5015021893552764e-05, "get_actions": 3.685920573607433e-05, "normalize_and_clip_actions": 7.893052490142823e-06, "remove_single_ts_time_rank_from_batch": 1.1859122100804373e-05, "un_batch_to_individual_items": 6.569556440700144e-06, "listify_data_for_vector_env": 1.0297008764841856e-05}}, "connector_pipeline_timer": 0.00011451327313117357}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.8073992846973035e-06, "add_states_from_episodes_to_batch": 2.7480661793031237e-06, "numpy_to_tensor": 1.2003496290553131e-05, "batch_individual_items": 1.2470875203550255e-05, "add_observations_from_episodes_to_batch": 2.8150422324065763e-06}}, "connector_pipeline_timer": 5.8869257633975455e-05}, "episode_return_max": 13.5, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "env_to_module_sum_episodes_length_in": 10.368238394470474, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": -1.1}, "env_reset_timer": 0.0005586502386092595, "agent_episode_returns_mean": {"default_agent": -1.1}, "env_to_module_sum_episodes_length_out": 10.368238394470474, "episode_len_max": 20, "episode_len_mean": 20.0, "sample": 0.11918659967531137, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.005317257106071338, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "episode_return_mean": -1.1, "env_step_timer": 1.3981382070357029e-05, "weights_seq_no": 6.0, "num_episodes": 20, "episode_return_min": -15.5, "num_episodes_lifetime": 120, "rlmodule_inference_timer": 3.115473771131262e-05, "num_env_steps_sampled": 400, "time_between_sampling": 12.32983038851015}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "b949d_00000", "date": "2025-08-11_18-13-16", "timestamp": 1754928796, "time_this_iter_s": 11.45950722694397, "time_total_s": 71.25739884376526, "pid": 10485, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x152ff98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 71.25739884376526, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 41.23125, "ram_util_percent": 80.70625}}
{"timers": {"training_iteration": 11.749242789763587, "restore_env_runners": 1.64417467882513e-05, "training_step": 11.749021944942086, "env_runner_sampling_timer": 1.7959315371880833, "learner_update_timer": 9.73844143149127, "synch_weights": 0.0016198986969610453, "restore_eval_env_runners": 5.712416171707864e-05, "evaluation_iteration": 0.1314928639022768, "synch_eval_env_connectors": 0.00020218466147703596, "synch_env_connectors": 5.194034030855052e-06}, "env_runners": {"num_env_steps_sampled_lifetime": -3077500.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 6.093064529543001e-05, "listify_data_for_vector_env": 1.3104497594261219e-05, "normalize_and_clip_actions": 1.2505648016887732e-05, "tensor_to_numpy": 2.031261573804781e-05, "remove_single_ts_time_rank_from_batch": 1.771120925905959e-05, "un_batch_to_individual_items": 8.624835144393219e-06}}, "connector_pipeline_timer": 0.00016597768131255681}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "weights_seq_no": 6.0, "env_reset_timer": 4.851452002570745e-05, "env_to_module_connector": {"connector_pipeline_timer": 7.891773260359948e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 9.000800000246409e-06, "add_states_from_episodes_to_batch": 3.408335949453116e-06, "numpy_to_tensor": 1.7429581203799625e-05, "batch_individual_items": 1.5758947451104704e-05, "add_observations_from_episodes_to_batch": 3.4828262946669286e-06}}}, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "num_episodes": 250.0, "episode_return_min": -13.5, "episode_return_max": 6.5, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.007267896994948383, "num_episodes_lifetime": -153875.0, "module_episode_returns_mean": {"default_policy": -1.6599999999999997}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 4.282385644675905e-05, "episode_len_max": 20, "time_between_sampling": 0.04063842390679418, "env_step_timer": 2.2342218414834705e-05, "episode_return_mean": -1.6599999999999997, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "sample": 0.006420150953625168, "agent_episode_returns_mean": {"default_agent": -1.6599999999999997}, "num_env_steps_sampled_lifetime_throughput": 2902.5671882586307}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1742791118569286, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00908256240272313, "add_observations_from_episodes_to_batch": 0.0008873776862138376, "add_columns_from_episodes_to_train_batch": 0.041288374424143286, "add_time_dim_to_batch_and_zero_pad": 0.10445762308377421, "add_states_from_episodes_to_batch": 0.0037055502904968546, "batch_individual_items": 0.014592216128644525, "numpy_to_tensor": 0.00010201133840013816}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 220500, "num_module_steps_trained_lifetime": 83916, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3234.1296808377274, "num_module_steps_trained_throughput": 22986861.90083576, "num_module_steps_trained_lifetime_throughput": 11817940.089172207}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 36.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 251748, "mean_kl_loss": 5.770611824118532e-05, "vf_loss": 0.26343151926994324, "vf_loss_unclipped": 34.685752868652344, "weights_seq_no": 42.0, "policy_loss": -0.0006094675627537072, "vf_explained_var": 0.0017621517181396484, "entropy": 0.6859252452850342, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.20356802642345428}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 251748, "diff_num_grad_updates_vs_sampler_policy": 36.0, "num_module_steps_trained": 35964, "weights_seq_no": 42.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 1323000, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 503496, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 41735.054199928505}}}, "default_policy": {"total_loss": 0.20349080860614777, "vf_explained_var": -0.0002657175064086914, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 41958, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 34.739322662353516, "num_module_steps_trained": 5994, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 6.16304314462468e-05, "policy_loss": -0.0006291643367148936, "vf_loss": 0.26336947083473206, "weights_seq_no": 7.0, "num_trainable_parameters": 16595, "entropy": 0.6858822703361511, "use_intrinsic_rewards": 0.0, "curr_kl_coeff": 0.0012623744551092386, "num_module_steps_trained_lifetime_throughput": 615.3940041568204}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 41958, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5994, "weights_seq_no": 7.0, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 615.4007391589937}, "IntrinsicAttentionMask": [[[0.3316417932510376, 0.3356122672557831, 0.3327459394931793], [0.337956964969635, 0.32714205980300903, 0.33490097522735596], [0.3334052860736847, 0.3332365155220032, 0.33335813879966736]], [[0.332515686750412, 0.33525845408439636, 0.33222588896751404], [0.33281704783439636, 0.3345491886138916, 0.33263373374938965], [0.3324836492538452, 0.33533379435539246, 0.3321825861930847]], [[0.3307875394821167, 0.33247730135917664, 0.33673515915870667], [0.3326359987258911, 0.3331005275249481, 0.33426353335380554], [0.3372538983821869, 0.3346187472343445, 0.32812732458114624]], [[0.3318738043308258, 0.33178332448005676, 0.33634284138679504], [0.33182811737060547, 0.331734836101532, 0.33643707633018494], [0.3341068625450134, 0.3341553509235382, 0.331737756729126]], [[0.332750529050827, 0.3336164057254791, 0.33363306522369385], [0.33794310688972473, 0.33109351992607117, 0.33096328377723694], [0.33804330229759216, 0.33104488253593445, 0.33091187477111816]], [[0.34817588329315186, 0.3011966943740845, 0.35062745213508606], [0.44928401708602905, 0.051993757486343384, 0.4987221956253052], [0.33831191062927246, 0.3225962221622467, 0.33909180760383606]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_env_steps_sampled_lifetime": 35400, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4969988753283277e-05, "get_actions": 3.660594361124601e-05, "normalize_and_clip_actions": 7.997250654047965e-06, "remove_single_ts_time_rank_from_batch": 1.1981368119402407e-05, "un_batch_to_individual_items": 6.604285516107302e-06, "listify_data_for_vector_env": 1.0364314017397321e-05}}, "connector_pipeline_timer": 0.00011479513812710263}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.852767316651857e-06, "add_states_from_episodes_to_batch": 2.761734612786988e-06, "numpy_to_tensor": 1.202046711907237e-05, "batch_individual_items": 1.2433987778321405e-05, "add_observations_from_episodes_to_batch": 2.838108018225143e-06}}, "connector_pipeline_timer": 5.9320768631438006e-05}, "episode_return_max": 13.5, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "env_to_module_sum_episodes_length_in": 10.368238394572801, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": -1.1}, "env_reset_timer": 0.0005567016568225977, "agent_episode_returns_mean": {"default_agent": -1.1}, "env_to_module_sum_episodes_length_out": 10.368238394572801, "episode_len_max": 20, "episode_len_mean": 20.0, "sample": 0.1192271340986801, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.0053999538184143605, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "episode_return_mean": -1.1, "env_step_timer": 1.400155794052472e-05, "weights_seq_no": 7.0, "num_episodes": 20, "episode_return_min": -15.5, "num_episodes_lifetime": 140, "rlmodule_inference_timer": 3.128204060536379e-05, "num_env_steps_sampled": 400, "time_between_sampling": 12.328453433785887}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "b949d_00000", "date": "2025-08-11_18-13-29", "timestamp": 1754928809, "time_this_iter_s": 12.290990114212036, "time_total_s": 83.5483889579773, "pid": 10485, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x152ff98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 83.5483889579773, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 44.76666666666667, "ram_util_percent": 82.03333333333333}}
{"timers": {"training_iteration": 11.759234946866153, "restore_env_runners": 1.6435239719507717e-05, "training_step": 11.759012852572475, "env_runner_sampling_timer": 1.797915450566692, "learner_update_timer": 9.74623318758648, "synch_weights": 0.0016193838806398905, "restore_eval_env_runners": 5.7229999760725836e-05, "evaluation_iteration": 0.1315127110927089, "synch_eval_env_connectors": 0.00020267406564874888, "synch_env_connectors": 5.182502612905849e-06}, "env_runners": {"num_env_steps_sampled_lifetime": -3695000.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 5.1424239929175066e-05, "listify_data_for_vector_env": 1.2014998469867728e-05, "normalize_and_clip_actions": 9.120436763473459e-06, "tensor_to_numpy": 1.833667885036618e-05, "remove_single_ts_time_rank_from_batch": 1.3399713299780985e-05, "un_batch_to_individual_items": 7.465165255058628e-06}}, "connector_pipeline_timer": 0.00014181823318257589}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "weights_seq_no": 7.0, "env_reset_timer": 6.253458804552717e-05, "env_to_module_connector": {"connector_pipeline_timer": 6.949830607641289e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 8.036642359625593e-06, "add_states_from_episodes_to_batch": 3.1186473797731553e-06, "numpy_to_tensor": 1.5337678322819913e-05, "batch_individual_items": 1.4309256051156675e-05, "add_observations_from_episodes_to_batch": 3.1903429127745214e-06}}}, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "num_episodes": 250.0, "episode_return_min": -13.5, "episode_return_max": 6.5, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.006925704341847449, "num_episodes_lifetime": -184750.0, "module_episode_returns_mean": {"default_policy": -2.6200000000000006}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 7.111302172810901e-05, "episode_len_max": 20, "time_between_sampling": 0.040894259080931986, "env_step_timer": 1.655791416674781e-05, "episode_return_mean": -2.6200000000000006, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "sample": 0.007819659811507883, "agent_episode_returns_mean": {"default_agent": -2.6200000000000006}, "num_env_steps_sampled_lifetime_throughput": 2766.5694404859973}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17433754490884482, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009084637198536487, "add_observations_from_episodes_to_batch": 0.0008870984893463777, "add_columns_from_episodes_to_train_batch": 0.0413001898497183, "add_time_dim_to_batch_and_zero_pad": 0.10450645518328013, "add_states_from_episodes_to_batch": 0.003711812697177198, "batch_individual_items": 0.01458233771687491, "numpy_to_tensor": 0.00010180455484131457}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 252000, "num_module_steps_trained_lifetime": 95904, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3220.250818733483, "num_module_steps_trained_throughput": 22418447.537608612, "num_module_steps_trained_lifetime_throughput": 11816377.56506758}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 41.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 287712, "mean_kl_loss": 1.8932825696538202e-05, "vf_loss": 0.2634313702583313, "vf_loss_unclipped": 37.33152770996094, "weights_seq_no": 48.0, "policy_loss": -0.00025687433662824333, "vf_explained_var": 0.0017265677452087402, "entropy": 0.6853390336036682, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.2039150595664978}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 287712, "diff_num_grad_updates_vs_sampler_policy": 41.0, "num_module_steps_trained": 35964, "weights_seq_no": 48.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 1512000, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 575424, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 41004.941533410936}}}, "default_policy": {"total_loss": 0.20385758578777313, "vf_explained_var": 5.5670738220214844e-05, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 47952, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 37.38145065307617, "num_module_steps_trained": 5994, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 2.0475386918406002e-05, "policy_loss": -0.00026682071620598435, "vf_loss": 0.2633741497993469, "weights_seq_no": 8.0, "num_trainable_parameters": 16595, "entropy": 0.6853085160255432, "use_intrinsic_rewards": 0.0, "curr_kl_coeff": 0.0006311872275546193, "num_module_steps_trained_lifetime_throughput": 612.7536983512447}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 47952, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5994, "weights_seq_no": 8.0, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 612.7600883255735}, "IntrinsicAttentionMask": [[[0.3320024013519287, 0.3359771966934204, 0.3320204019546509], [0.3369441330432892, 0.32616162300109863, 0.33689427375793457], [0.33202505111694336, 0.335932195186615, 0.33204275369644165]], [[0.33155861496925354, 0.33429351449012756, 0.3341478109359741], [0.33221131563186646, 0.3339402973651886, 0.33384832739830017], [0.33217668533325195, 0.33395907282829285, 0.3338642418384552]], [[0.3307875394821167, 0.33247730135917664, 0.3367351293563843], [0.3326359689235687, 0.3331005275249481, 0.33426350355148315], [0.3372538983821869, 0.3346187472343445, 0.32812735438346863]], [[0.3306751549243927, 0.3323785960674286, 0.3369462788105011], [0.33223941922187805, 0.3329426348209381, 0.33481791615486145], [0.33639514446258545, 0.33441030979156494, 0.3291946053504944]], [[0.330300509929657, 0.3340858519077301, 0.3356136977672577], [0.33645522594451904, 0.33254823088645935, 0.3309965431690216], [0.33893412351608276, 0.33191731572151184, 0.3291485607624054]], [[0.3481757938861847, 0.3011969029903412, 0.3506273627281189], [0.44928377866744995, 0.05199459567666054, 0.49872153997421265], [0.33831191062927246, 0.3225962817668915, 0.33909180760383606]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_env_steps_sampled_lifetime": 40400, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4807080427274082e-05, "get_actions": 3.61401379247862e-05, "normalize_and_clip_actions": 7.86779048984423e-06, "remove_single_ts_time_rank_from_batch": 1.1883232347790194e-05, "un_batch_to_individual_items": 6.500969179417181e-06, "listify_data_for_vector_env": 1.0124577291206897e-05}}, "connector_pipeline_timer": 0.00011320968981169386}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.737582288407722e-06, "add_states_from_episodes_to_batch": 2.750454030971915e-06, "numpy_to_tensor": 1.1880901022709727e-05, "batch_individual_items": 1.221607174619709e-05, "add_observations_from_episodes_to_batch": 2.7854188333192337e-06}}, "connector_pipeline_timer": 5.841156488110116e-05}, "episode_return_max": 13.5, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "env_to_module_sum_episodes_length_in": 10.3682383945743, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": -1.1}, "env_reset_timer": 0.0005544096407446199, "agent_episode_returns_mean": {"default_agent": -1.1}, "env_to_module_sum_episodes_length_out": 10.3682383945743, "episode_len_max": 20, "episode_len_mean": 20.0, "sample": 0.11918354109794392, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.005385791308945045, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "episode_return_mean": -1.1, "env_step_timer": 1.3687099754043787e-05, "weights_seq_no": 8.0, "num_episodes": 20, "episode_return_min": -15.5, "num_episodes_lifetime": 160, "rlmodule_inference_timer": 3.0838876385416045e-05, "num_env_steps_sampled": 400, "time_between_sampling": 12.332951014447163}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "b949d_00000", "date": "2025-08-11_18-13-42", "timestamp": 1754928822, "time_this_iter_s": 12.875242948532104, "time_total_s": 96.4236319065094, "pid": 10485, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x152ff98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 96.4236319065094, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 50.50000000000001, "ram_util_percent": 82.95555555555555}}
{"timers": {"training_iteration": 11.759921763237267, "restore_env_runners": 1.633255717489724e-05, "training_step": 11.759699699876835, "env_runner_sampling_timer": 1.7958821814811037, "learner_update_timer": 9.747577486960223, "synch_weights": 0.0016197250420105919, "restore_eval_env_runners": 5.699479080484743e-05, "evaluation_iteration": 0.13143428773152788, "synch_eval_env_connectors": 0.00020247107461831673, "synch_env_connectors": 5.176927065832195e-06}, "env_runners": {"num_env_steps_sampled_lifetime": -4312500.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.248478100973444e-05, "listify_data_for_vector_env": 1.0673588461154983e-05, "normalize_and_clip_actions": 8.222010914509373e-06, "tensor_to_numpy": 1.593156361092709e-05, "remove_single_ts_time_rank_from_batch": 1.2127342293380337e-05, "un_batch_to_individual_items": 6.722977691178217e-06}}, "connector_pipeline_timer": 0.000123184680075099}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "weights_seq_no": 8.0, "env_reset_timer": 5.1581167545476136e-05, "env_to_module_connector": {"connector_pipeline_timer": 6.140660820230968e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.061916424176373e-06, "add_states_from_episodes_to_batch": 2.7747319477601505e-06, "numpy_to_tensor": 1.3196026258654178e-05, "batch_individual_items": 1.2758278462388455e-05, "add_observations_from_episodes_to_batch": 2.8453856857469555e-06}}}, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "num_episodes": 250.0, "episode_return_min": -13.5, "episode_return_max": 6.5, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.005458365018479524, "num_episodes_lifetime": -215625.0, "module_episode_returns_mean": {"default_policy": -1.2600000000000002}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 3.339722759246747e-05, "episode_len_max": 20, "time_between_sampling": 0.043891544816822815, "env_step_timer": 1.4361152796645116e-05, "episode_return_mean": -1.2600000000000002, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "sample": 0.0066708930229074405, "agent_episode_returns_mean": {"default_agent": -1.2600000000000002}, "num_env_steps_sampled_lifetime_throughput": 3094.9620521636366}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17561108195919906, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009082287076651556, "add_observations_from_episodes_to_batch": 0.0008876587543806433, "add_columns_from_episodes_to_train_batch": 0.04130381462068761, "add_time_dim_to_batch_and_zero_pad": 0.10449195521086153, "add_states_from_episodes_to_batch": 0.0037126691503965017, "batch_individual_items": 0.015868473089596487, "numpy_to_tensor": 0.00010156150937336769}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 283500, "num_module_steps_trained_lifetime": 107892, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3206.66428510529, "num_module_steps_trained_throughput": 21877357.67273746, "num_module_steps_trained_lifetime_throughput": 11823153.822876243}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 46.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 323676, "mean_kl_loss": 2.874203710234724e-05, "vf_loss": 0.2634192109107971, "vf_loss_unclipped": 38.39228439331055, "weights_seq_no": 54.0, "policy_loss": -0.00037913068081252277, "vf_explained_var": 0.0017105340957641602, "entropy": 0.6844021081924438, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.20378638803958893}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 323676, "diff_num_grad_updates_vs_sampler_policy": 46.0, "num_module_steps_trained": 35964, "weights_seq_no": 54.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 1701000, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 647352, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 40270.70258323076}}}, "default_policy": {"total_loss": 0.20372852683067322, "vf_explained_var": 0.0001074671745300293, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 53946, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 38.44467544555664, "num_module_steps_trained": 5994, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 3.118344466201961e-05, "policy_loss": -0.00039457346429117024, "vf_loss": 0.2633706033229828, "weights_seq_no": 9.0, "num_trainable_parameters": 16595, "entropy": 0.6843606233596802, "use_intrinsic_rewards": 0.0, "curr_kl_coeff": 0.00031559361377730966, "num_module_steps_trained_lifetime_throughput": 610.1690199424669}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 53946, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5994, "weights_seq_no": 9.0, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 610.1750786327143}, "IntrinsicAttentionMask": [[[0.33081695437431335, 0.33639001846313477, 0.3327929675579071], [0.33403128385543823, 0.3324882388114929, 0.3334803879261017], [0.3319622278213501, 0.33499690890312195, 0.33304086327552795]], [[0.332870215177536, 0.3344239592552185, 0.3327057659626007], [0.3331710994243622, 0.33371561765670776, 0.3331133723258972], [0.3328382968902588, 0.33449921011924744, 0.3326624929904938]], [[0.33304572105407715, 0.33257243037223816, 0.33438190817832947], [0.33242911100387573, 0.3309544324874878, 0.33661648631095886], [0.33474501967430115, 0.33712729811668396, 0.3281276524066925]], [[0.32883477210998535, 0.33170682191848755, 0.3394584059715271], [0.330398827791214, 0.3322782814502716, 0.337322860956192], [0.3345542550086975, 0.3337656855583191, 0.331680029630661]], [[0.3310748040676117, 0.33521488308906555, 0.333710253238678], [0.3352736234664917, 0.331722617149353, 0.3330036997795105], [0.3337510824203491, 0.33298608660697937, 0.3332628309726715]], [[0.34046152234077454, 0.31891489028930664, 0.3406236469745636], [0.471152663230896, 0.04993029311299324, 0.47891706228256226], [0.3387467861175537, 0.3223842680454254, 0.3388689458370209]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_env_steps_sampled_lifetime": 45400, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.453654389974436e-05, "get_actions": 3.566452630036466e-05, "normalize_and_clip_actions": 7.764199646810801e-06, "remove_single_ts_time_rank_from_batch": 1.1715765310627254e-05, "un_batch_to_individual_items": 6.482048086347933e-06, "listify_data_for_vector_env": 1.0089835701919509e-05}}, "connector_pipeline_timer": 0.00011201125891587855}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.688998244599691e-06, "add_states_from_episodes_to_batch": 2.725070792522361e-06, "numpy_to_tensor": 1.1736650601565214e-05, "batch_individual_items": 1.2135807857936244e-05, "add_observations_from_episodes_to_batch": 2.7778724097136213e-06}}, "connector_pipeline_timer": 5.783976317325501e-05}, "episode_return_max": 13.5, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": -0.5}, "env_reset_timer": 0.000552085134626692, "agent_episode_returns_mean": {"default_agent": -0.5}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "episode_len_mean": 20.0, "sample": 0.11912977943657191, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.005329014246817678, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "episode_return_mean": -0.5, "env_step_timer": 1.3620955622019306e-05, "weights_seq_no": 9.0, "num_episodes": 20, "episode_return_min": -15.5, "num_episodes_lifetime": 180, "rlmodule_inference_timer": 3.040692885101997e-05, "num_env_steps_sampled": 400, "time_between_sampling": 12.328207243053098}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "b949d_00000", "date": "2025-08-11_18-13-54", "timestamp": 1754928834, "time_this_iter_s": 11.953362941741943, "time_total_s": 108.37699484825134, "pid": 10485, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x152ff98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 108.37699484825134, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 45.71764705882353, "ram_util_percent": 82.59411764705884}}
{"timers": {"training_iteration": 11.770729901434736, "restore_env_runners": 1.6227151718216822e-05, "training_step": 11.770507410378078, "env_runner_sampling_timer": 1.7940172867456388, "learner_update_timer": 9.760073589590103, "synch_weights": 0.0016202140420461635, "restore_eval_env_runners": 5.676400263879667e-05, "evaluation_iteration": 0.13134445110363108, "synch_eval_env_connectors": 0.00020232928391381388, "synch_env_connectors": 5.168498055336823e-06}, "env_runners": {"num_env_steps_sampled_lifetime": -4930000.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.276303897163312e-05, "listify_data_for_vector_env": 1.0869037948471002e-05, "normalize_and_clip_actions": 8.219637106778742e-06, "tensor_to_numpy": 1.5938863778019677e-05, "remove_single_ts_time_rank_from_batch": 1.2247279515616709e-05, "un_batch_to_individual_items": 6.767684608253239e-06}}, "connector_pipeline_timer": 0.0001239068404404184}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "weights_seq_no": 9.0, "env_reset_timer": 4.4924833501992095e-05, "env_to_module_connector": {"connector_pipeline_timer": 6.192776653215602e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.172979785187295e-06, "add_states_from_episodes_to_batch": 2.7817126937407737e-06, "numpy_to_tensor": 1.3150161679622006e-05, "batch_individual_items": 1.3006826302748876e-05, "add_observations_from_episodes_to_batch": 2.867097049844493e-06}}}, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "num_episodes": 250.0, "episode_return_min": -13.5, "episode_return_max": 6.5, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.005527830369770527, "num_episodes_lifetime": -246500.0, "module_episode_returns_mean": {"default_policy": -1.74}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 3.408961501649728e-05, "episode_len_max": 20, "time_between_sampling": 0.04217945590562647, "env_step_timer": 1.4618162909492822e-05, "episode_return_mean": -1.74, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "sample": 0.0059834390062735235, "agent_episode_returns_mean": {"default_agent": -1.74}, "num_env_steps_sampled_lifetime_throughput": 3108.9790904495103}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1756842228098857, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00908468961655881, "add_observations_from_episodes_to_batch": 0.00088791258676728, "add_columns_from_episodes_to_train_batch": 0.041332583554540975, "add_time_dim_to_batch_and_zero_pad": 0.1045554535690438, "add_states_from_episodes_to_batch": 0.003716062458931205, "batch_individual_items": 0.01584344293868641, "numpy_to_tensor": 0.00010150381426282728}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 315000, "num_module_steps_trained_lifetime": 119880, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3190.1520908410025, "num_module_steps_trained_throughput": 21320283.455085844, "num_module_steps_trained_lifetime_throughput": 11804375.8147148}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 51.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 359640, "mean_kl_loss": 2.8534441298688762e-05, "vf_loss": 0.26340287923812866, "vf_loss_unclipped": 36.26982879638672, "weights_seq_no": 60.0, "policy_loss": -0.0004514692700468004, "vf_explained_var": 0.001722574234008789, "entropy": 0.6831408143043518, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.20370322465896606}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 359640, "diff_num_grad_updates_vs_sampler_policy": 51.0, "num_module_steps_trained": 35964, "weights_seq_no": 60.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 1890000, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 719280, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 39532.708372465306}}}, "default_policy": {"total_loss": 0.20364859700202942, "vf_explained_var": -8.726119995117188e-05, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 59940, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 36.324615478515625, "num_module_steps_trained": 5994, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 3.143896537949331e-05, "policy_loss": -0.00047310467925854027, "vf_loss": 0.2633662819862366, "weights_seq_no": 10.0, "num_trainable_parameters": 16595, "entropy": 0.6830880045890808, "use_intrinsic_rewards": 0.0, "curr_kl_coeff": 0.00015779680688865483, "num_module_steps_trained_lifetime_throughput": 607.027605997015}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 59940, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5994, "weights_seq_no": 10.0, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 607.0332738749843}, "IntrinsicAttentionMask": [[[0.33154526352882385, 0.337130606174469, 0.33132404088974], [0.33382678031921387, 0.33228471875190735, 0.33388856053352356], [0.33145371079444885, 0.33732497692108154, 0.3312212824821472]], [[0.33287039399147034, 0.3327881395816803, 0.33434149622917175], [0.33285441994667053, 0.33276933431625366, 0.3343762457370758], [0.33315515518188477, 0.33312344551086426, 0.33372142910957336]], [[0.3323274850845337, 0.33241531252861023, 0.3352572023868561], [0.3323599100112915, 0.3324449360370636, 0.3351951241493225], [0.3334037959575653, 0.33339762687683105, 0.3331986367702484]], [[0.33176738023757935, 0.3316703736782074, 0.33656221628189087], [0.331721693277359, 0.33162185549736023, 0.33665645122528076], [0.33400124311447144, 0.33404308557510376, 0.3319557011127472]], [[0.32982081174850464, 0.3350529372692108, 0.33512628078460693], [0.33969175815582275, 0.3302190601825714, 0.33008918166160583], [0.33983007073402405, 0.3301513195037842, 0.33001866936683655]], [[0.34683385491371155, 0.30181699991226196, 0.3513490557670593], [0.4273337423801422, 0.0584331639111042, 0.5142330527305603], [0.32996460795402527, 0.3410869240760803, 0.3289484679698944]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_env_steps_sampled_lifetime": 50400, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.619699986396012e-05, "get_actions": 4.0485057423524434e-05, "normalize_and_clip_actions": 8.214275815503181e-06, "remove_single_ts_time_rank_from_batch": 1.247410350425621e-05, "un_batch_to_individual_items": 6.806335361376581e-06, "listify_data_for_vector_env": 1.0880286387482077e-05}}, "connector_pipeline_timer": 0.00012219007103816628}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.188313375394061e-06, "add_states_from_episodes_to_batch": 2.8264156072044464e-06, "numpy_to_tensor": 1.2979276715646852e-05, "batch_individual_items": 1.295127277301469e-05, "add_observations_from_episodes_to_batch": 2.9396912020093305e-06}}, "connector_pipeline_timer": 6.260592440811158e-05}, "episode_return_max": 13.5, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": -0.5}, "env_reset_timer": 0.0005497388627499121, "agent_episode_returns_mean": {"default_agent": -0.5}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "episode_len_mean": 20.0, "sample": 0.11924467455203923, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.005437004226259887, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "episode_return_mean": -0.5, "env_step_timer": 1.4816883163661304e-05, "weights_seq_no": 10.0, "num_episodes": 20, "episode_return_min": -15.5, "num_episodes_lifetime": 200, "rlmodule_inference_timer": 3.399831046824331e-05, "num_env_steps_sampled": 400, "time_between_sampling": 12.333629958952345}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "b949d_00000", "date": "2025-08-11_18-14-07", "timestamp": 1754928847, "time_this_iter_s": 12.98415493965149, "time_total_s": 121.36114978790283, "pid": 10485, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x152ff98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 121.36114978790283, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 49.02631578947369, "ram_util_percent": 82.92105263157895}}
{"timers": {"training_iteration": 11.768377362000612, "restore_env_runners": 1.6190710029937734e-05, "training_step": 11.76815381627425, "env_runner_sampling_timer": 1.7923861842977025, "learner_update_timer": 9.759248145363385, "synch_weights": 0.0016307877318181934, "restore_eval_env_runners": 5.672845281065733e-05, "evaluation_iteration": 0.13143267117234758, "synch_eval_env_connectors": 0.0002028155713012908, "synch_env_connectors": 5.173482889295588e-06}, "env_runners": {"num_env_steps_sampled_lifetime": -5547500.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.362079501891808e-05, "listify_data_for_vector_env": 1.0825197161745987e-05, "normalize_and_clip_actions": 8.30762573173211e-06, "tensor_to_numpy": 1.622731811309156e-05, "remove_single_ts_time_rank_from_batch": 1.2312547358417556e-05, "un_batch_to_individual_items": 6.845288894023442e-06}}, "connector_pipeline_timer": 0.00012545338904645833}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "weights_seq_no": 10.0, "env_reset_timer": 4.7467269079709616e-05, "env_to_module_connector": {"connector_pipeline_timer": 6.226214011071401e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.191328887325614e-06, "add_states_from_episodes_to_batch": 2.7767306845128907e-06, "numpy_to_tensor": 1.3434853958391355e-05, "batch_individual_items": 1.2970681322776578e-05, "add_observations_from_episodes_to_batch": 2.8837372448716134e-06}}}, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "num_episodes": 250.0, "episode_return_min": -13.5, "episode_return_max": 6.5, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.0055782416546717286, "num_episodes_lifetime": -277375.0, "module_episode_returns_mean": {"default_policy": -1.4199999999999995}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 3.4102490487745586e-05, "episode_len_max": 20, "time_between_sampling": 0.045785560319431234, "env_step_timer": 1.4704508530931647e-05, "episode_return_mean": -1.4199999999999995, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "sample": 0.005953265332487497, "agent_episode_returns_mean": {"default_agent": -1.4199999999999995}, "num_env_steps_sampled_lifetime_throughput": 3074.712454877069}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17567629349248481, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009083160640312489, "add_observations_from_episodes_to_batch": 0.0008876842916136393, "add_columns_from_episodes_to_train_batch": 0.04134904813828913, "add_time_dim_to_batch_and_zero_pad": 0.1045641823638032, "add_states_from_episodes_to_batch": 0.003718312254336858, "batch_individual_items": 0.015810517260088412, "numpy_to_tensor": 0.00010126043624508207}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 346500, "num_module_steps_trained_lifetime": 131868, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3175.717627061549, "num_module_steps_trained_throughput": 20807464.95141501, "num_module_steps_trained_lifetime_throughput": 11795782.977974132}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 56.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 395604, "mean_kl_loss": 9.094220877159387e-05, "vf_loss": 0.2634110748767853, "vf_loss_unclipped": 39.96501159667969, "weights_seq_no": 66.0, "policy_loss": -0.0009375318186357617, "vf_explained_var": 0.0016911029815673828, "entropy": 0.681494414806366, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.2032361775636673}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 395604, "diff_num_grad_updates_vs_sampler_policy": 56.0, "num_module_steps_trained": 35964, "weights_seq_no": 66.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 2079000, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 791208, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 38814.05898829461}}}, "default_policy": {"total_loss": 0.2031586617231369, "vf_explained_var": -5.3048133850097656e-05, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 65934, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 40.0180778503418, "num_module_steps_trained": 5994, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 9.680538641987368e-05, "policy_loss": -0.0009665085817687213, "vf_loss": 0.2633674740791321, "weights_seq_no": 11.0, "num_trainable_parameters": 16595, "entropy": 0.681429386138916, "use_intrinsic_rewards": 0.0, "curr_kl_coeff": 7.889840344432741e-05, "num_module_steps_trained_lifetime_throughput": 604.2815405861327}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 65934, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5994, "weights_seq_no": 11.0, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 604.286848822075}, "IntrinsicAttentionMask": [[[0.3300791382789612, 0.3378700613975525, 0.33205077052116394], [0.3358822762966156, 0.32979899644851685, 0.33431875705718994], [0.33156079053878784, 0.33580106496810913, 0.332638144493103]], [[0.332516074180603, 0.33237114548683167, 0.3351127505302429], [0.3325001001358032, 0.33235234022140503, 0.33514755964279175], [0.3328012228012085, 0.3327067494392395, 0.3344919681549072]], [[0.33304569125175476, 0.33257240056991577, 0.3343818783760071], [0.33242911100387573, 0.3309544324874878, 0.3366164565086365], [0.33474501967430115, 0.33712729811668396, 0.3281276822090149]], [[0.3332361876964569, 0.33251670002937317, 0.33424705266952515], [0.33306649327278137, 0.3311200737953186, 0.3358135223388672], [0.3334667384624481, 0.3344765603542328, 0.3320566713809967]], [[0.3327505886554718, 0.3336164057254791, 0.33363306522369385], [0.33794307708740234, 0.33109354972839355, 0.3309633433818817], [0.338043212890625, 0.33104488253593445, 0.33091187477111816]], [[0.31454113125801086, 0.3705490231513977, 0.31490984559059143], [0.47438865900039673, 0.058281101286411285, 0.4673302173614502], [0.31643250584602356, 0.3668006360530853, 0.3167668581008911]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_env_steps_sampled_lifetime": 55400, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.87424639276453e-05, "get_actions": 0.00017111500831597945, "normalize_and_clip_actions": 2.3043095105243833e-05, "remove_single_ts_time_rank_from_batch": 3.4270009975645305e-05, "un_batch_to_individual_items": 1.7298235936622527e-05, "listify_data_for_vector_env": 3.138396630383845e-05}}, "connector_pipeline_timer": 0.0004162507521843436}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.7160326055766566e-05, "add_states_from_episodes_to_batch": 8.598067540658609e-06, "numpy_to_tensor": 4.114358198583099e-05, "batch_individual_items": 3.082514796832429e-05, "add_observations_from_episodes_to_batch": 7.744382950680307e-06}}, "connector_pipeline_timer": 0.00015904826473742297}, "episode_return_max": 13.5, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": -0.7}, "env_reset_timer": 0.0005513768939959337, "agent_episode_returns_mean": {"default_agent": -0.7}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "episode_len_mean": 20.0, "sample": 0.12217163030731962, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.008132061739452183, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "episode_return_mean": -0.7, "env_step_timer": 5.326824676383112e-05, "weights_seq_no": 11.0, "num_episodes": 20, "episode_return_min": -15.5, "num_episodes_lifetime": 220, "rlmodule_inference_timer": 0.00014058934403771075, "num_env_steps_sampled": 400, "time_between_sampling": 12.325994136442777}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "b949d_00000", "date": "2025-08-11_18-14-19", "timestamp": 1754928859, "time_this_iter_s": 11.971479892730713, "time_total_s": 133.33262968063354, "pid": 10485, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x152ff98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 133.33262968063354, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 44.405882352941184, "ram_util_percent": 81.96470588235293}}
{"timers": {"training_iteration": 11.769370914210235, "restore_env_runners": 1.6280052805511682e-05, "training_step": 11.769145571031501, "env_runner_sampling_timer": 1.7924714262055355, "learner_update_timer": 9.760056195580528, "synch_weights": 0.0016252727737017878, "restore_eval_env_runners": 5.626033900275547e-05, "evaluation_iteration": 0.13442777779955492, "synch_eval_env_connectors": 0.00020272408458404573, "synch_env_connectors": 5.400917822909713e-06}, "env_runners": {"num_env_steps_sampled_lifetime": -6165000.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.9934988358267936e-05, "listify_data_for_vector_env": 1.3381498065793469e-05, "normalize_and_clip_actions": 9.011792691813996e-06, "tensor_to_numpy": 1.7575644996394843e-05, "remove_single_ts_time_rank_from_batch": 1.3186744846866465e-05, "un_batch_to_individual_items": 7.132374335395183e-06}}, "connector_pipeline_timer": 0.00013909095523780072}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "weights_seq_no": 11.0, "env_reset_timer": 5.955708162739134e-05, "env_to_module_connector": {"connector_pipeline_timer": 6.674461854867728e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.724757510926338e-06, "add_states_from_episodes_to_batch": 2.932079002678658e-06, "numpy_to_tensor": 1.5190699493468626e-05, "batch_individual_items": 1.3703734726311544e-05, "add_observations_from_episodes_to_batch": 3.0644823551235576e-06}}}, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "num_episodes": 250.0, "episode_return_min": -13.5, "episode_return_max": 6.5, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.006138046529144049, "num_episodes_lifetime": -308250.0, "module_episode_returns_mean": {"default_policy": -1.0199999999999996}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 3.771561126106835e-05, "episode_len_max": 20, "time_between_sampling": 0.0424794630470259, "env_step_timer": 1.682260688055251e-05, "episode_return_mean": -1.0199999999999996, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "sample": 0.006470256410850402, "agent_episode_returns_mean": {"default_agent": -1.0199999999999996}, "num_env_steps_sampled_lifetime_throughput": 3040.0734861682367}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1756679055572936, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009087236954484133, "add_observations_from_episodes_to_batch": 0.0008888557883065596, "add_columns_from_episodes_to_train_batch": 0.041356996406087344, "add_time_dim_to_batch_and_zero_pad": 0.10455860637004012, "add_states_from_episodes_to_batch": 0.0037217612118474, "batch_individual_items": 0.015791312916966626, "numpy_to_tensor": 0.00010127492235759443}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 378000, "num_module_steps_trained_lifetime": 143856, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3162.2210059481104, "num_module_steps_trained_throughput": 20311154.122774523, "num_module_steps_trained_lifetime_throughput": 11773744.297481876}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 61.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 431568, "mean_kl_loss": 3.531642141751945e-05, "vf_loss": 0.2634040117263794, "vf_loss_unclipped": 38.90437316894531, "weights_seq_no": 72.0, "policy_loss": -0.0002957566175609827, "vf_explained_var": 0.0016952753067016602, "entropy": 0.6799861788749695, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.20386581122875214}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 431568, "diff_num_grad_updates_vs_sampler_policy": 61.0, "num_module_steps_trained": 35964, "weights_seq_no": 72.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 2268000, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 863136, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 38120.05482986892}}}, "default_policy": {"total_loss": 0.2038232684135437, "vf_explained_var": -5.9604644775390625e-06, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 71928, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 38.9571418762207, "num_module_steps_trained": 5994, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 3.707752694026567e-05, "policy_loss": -0.00030276202596724033, "vf_loss": 0.26336565613746643, "weights_seq_no": 12.0, "num_trainable_parameters": 16595, "entropy": 0.6799530982971191, "use_intrinsic_rewards": 0.0, "curr_kl_coeff": 3.944920172216371e-05, "num_module_steps_trained_lifetime_throughput": 601.7139136876597}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 71928, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5994, "weights_seq_no": 12.0, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 601.7188808010776}, "IntrinsicAttentionMask": [[[0.33154529333114624, 0.337130606174469, 0.3313240706920624], [0.33382678031921387, 0.33228471875190735, 0.33388853073120117], [0.33145377039909363, 0.33732497692108154, 0.3312212824821472]], [[0.3334786593914032, 0.3333333134651184, 0.3331880271434784], [0.3334815204143524, 0.3333333432674408, 0.33318522572517395], [0.33348435163497925, 0.3333333134651184, 0.33318236470222473]], [[0.33174267411231995, 0.33183038234710693, 0.3364269733428955], [0.33179405331611633, 0.3318789303302765, 0.33632707595825195], [0.3344579041004181, 0.3343952000141144, 0.3311469852924347]], [[0.3298555016517639, 0.3327364921569824, 0.33740800619125366], [0.3310639560222626, 0.3329471945762634, 0.3359888792037964], [0.33300328254699707, 0.33327794075012207, 0.33371874690055847]], [[0.3307816982269287, 0.33457252383232117, 0.3346457779407501], [0.33595895767211914, 0.33205777406692505, 0.3319832682609558], [0.3360588252544403, 0.3320092558860779, 0.3319319784641266]], [[0.30015063285827637, 0.393291175365448, 0.3065582513809204], [0.5188729166984558, 0.0493842288851738, 0.4317428469657898], [0.32545605301856995, 0.3474223017692566, 0.32712167501449585]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_env_steps_sampled_lifetime": 60400, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.655438433875381e-05, "get_actions": 4.224119647127233e-05, "normalize_and_clip_actions": 8.614147598662771e-06, "remove_single_ts_time_rank_from_batch": 1.2745632436983306e-05, "un_batch_to_individual_items": 7.137230680277536e-06, "listify_data_for_vector_env": 1.1039667533926276e-05}}, "connector_pipeline_timer": 0.00012683154625668574}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.38030977956176e-06, "add_states_from_episodes_to_batch": 2.9141967920138297e-06, "numpy_to_tensor": 1.3336973088296304e-05, "batch_individual_items": 1.3348173725433593e-05, "add_observations_from_episodes_to_batch": 3.004869772760709e-06}}, "connector_pipeline_timer": 6.325856973763098e-05}, "episode_return_max": 13.5, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": -0.1}, "env_reset_timer": 0.0005500402045919952, "agent_episode_returns_mean": {"default_agent": -0.1}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "episode_len_mean": 20.0, "sample": 0.12220200858364132, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.008153459201566874, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "episode_return_mean": -0.1, "env_step_timer": 1.5601666301958203e-05, "weights_seq_no": 12.0, "num_episodes": 20, "episode_return_min": -15.5, "num_episodes_lifetime": 240, "rlmodule_inference_timer": 3.5190367078193905e-05, "num_env_steps_sampled": 400, "time_between_sampling": 12.322159388828416}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "b949d_00000", "date": "2025-08-11_18-14-31", "timestamp": 1754928871, "time_this_iter_s": 12.004709959030151, "time_total_s": 145.3373396396637, "pid": 10485, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x152ff98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 145.3373396396637, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 41.588235294117645, "ram_util_percent": 81.85882352941177}}
{"timers": {"training_iteration": 11.766919527568694, "restore_env_runners": 1.6178081611417575e-05, "training_step": 11.766693634911, "env_runner_sampling_timer": 1.7920238731933245, "learner_update_timer": 9.757929612784446, "synch_weights": 0.001624309636193119, "restore_eval_env_runners": 5.5843984689079435e-05, "evaluation_iteration": 0.13442281752121932, "synch_eval_env_connectors": 0.00020170726353908283, "synch_env_connectors": 5.398159325961706e-06}, "env_runners": {"num_env_steps_sampled_lifetime": -6782500.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.7491284999854666e-05, "listify_data_for_vector_env": 1.1507493060690926e-05, "normalize_and_clip_actions": 8.870677506926446e-06, "tensor_to_numpy": 1.746693464465852e-05, "remove_single_ts_time_rank_from_batch": 1.2984424561982316e-05, "un_batch_to_individual_items": 7.088075162345206e-06}}, "connector_pipeline_timer": 0.000134176756916484}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "weights_seq_no": 12.0, "env_reset_timer": 5.2624579958524154e-05, "env_to_module_connector": {"connector_pipeline_timer": 6.604668017595663e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.66283545687396e-06, "add_states_from_episodes_to_batch": 2.9791118213861e-06, "numpy_to_tensor": 1.460488840357917e-05, "batch_individual_items": 1.3669452810233113e-05, "add_observations_from_episodes_to_batch": 3.0352437511351417e-06}}}, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "num_episodes": 250.0, "episode_return_min": -13.5, "episode_return_max": 6.5, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.005980020647402855, "num_episodes_lifetime": -339125.0, "module_episode_returns_mean": {"default_policy": -1.74}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 3.671927859102236e-05, "episode_len_max": 20, "time_between_sampling": 0.041520709977408594, "env_step_timer": 1.5845352819793816e-05, "episode_return_mean": -1.74, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "sample": 0.006249596146196403, "agent_episode_returns_mean": {"default_agent": -1.74}, "num_env_steps_sampled_lifetime_throughput": 2929.8371630197735}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17567845900243584, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00908823875482354, "add_observations_from_episodes_to_batch": 0.0008893401492900688, "add_columns_from_episodes_to_train_batch": 0.04136455310268452, "add_time_dim_to_batch_and_zero_pad": 0.10457265988712036, "add_states_from_episodes_to_batch": 0.0037339269303534764, "batch_individual_items": 0.015766589787993876, "numpy_to_tensor": 0.0001014188431754008}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 409500, "num_module_steps_trained_lifetime": 155844, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3152.8609243221263, "num_module_steps_trained_throughput": 19844801.16874399, "num_module_steps_trained_lifetime_throughput": 11766663.51410892}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 66.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 467532, "mean_kl_loss": 1.4266539437812753e-05, "vf_loss": 0.26340141892433167, "vf_loss_unclipped": 37.842742919921875, "weights_seq_no": 78.0, "policy_loss": 2.984744969580788e-05, "vf_explained_var": 0.001689612865447998, "entropy": 0.6789695620536804, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.2041875571012497}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 467532, "diff_num_grad_updates_vs_sampler_policy": 66.0, "num_module_steps_trained": 35964, "weights_seq_no": 78.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 2457000, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 935064, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 37462.55920279979}}}, "default_policy": {"total_loss": 0.20415544509887695, "vf_explained_var": 2.193450927734375e-05, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 77922, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 37.8946418762207, "num_module_steps_trained": 5994, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 1.3829891940986272e-05, "policy_loss": 2.7430420232121833e-05, "vf_loss": 0.2633662819862366, "weights_seq_no": 13.0, "num_trainable_parameters": 16595, "entropy": 0.6789832711219788, "use_intrinsic_rewards": 0.0, "curr_kl_coeff": 1.9724600861081854e-05, "num_module_steps_trained_lifetime_throughput": 599.9333853783862}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 77922, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5994, "weights_seq_no": 13.0, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 599.9380306092186}, "IntrinsicAttentionMask": [[[0.33081698417663574, 0.33639001846313477, 0.3327930271625519], [0.33403128385543823, 0.3324882686138153, 0.3334803879261017], [0.3319622278213501, 0.33499687910079956, 0.33304086327552795]], [[0.33155861496925354, 0.33429351449012756, 0.3341478109359741], [0.33221131563186646, 0.3339402973651886, 0.33384832739830017], [0.33217665553092957, 0.33395904302597046, 0.3338642120361328]], [[0.3329063057899475, 0.3312525451183319, 0.3358411192893982], [0.3326420485973358, 0.3299902379512787, 0.3373676836490631], [0.3333629071712494, 0.3334793448448181, 0.3331577777862549]], [[0.3306751549243927, 0.3323785960674286, 0.3369462192058563], [0.33223944902420044, 0.3329426646232605, 0.33481788635253906], [0.33639514446258545, 0.33441030979156494, 0.3291946351528168]], [[0.33286052942276, 0.33339619636535645, 0.33374327421188354], [0.33546188473701477, 0.3330460786819458, 0.3314920961856842], [0.33714959025382996, 0.3328133523464203, 0.33003711700439453]], [[0.3131820261478424, 0.3712835907936096, 0.3155343234539032], [0.49785470962524414, 0.05154186859726906, 0.4506033957004547], [0.32596904039382935, 0.3471581041812897, 0.32687291502952576]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_env_steps_sampled_lifetime": 65400, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.476824460265234e-05, "get_actions": 3.626177247062111e-05, "normalize_and_clip_actions": 7.818464573042964e-06, "remove_single_ts_time_rank_from_batch": 1.1830612231575161e-05, "un_batch_to_individual_items": 6.555627015815732e-06, "listify_data_for_vector_env": 1.019245716432072e-05}}, "connector_pipeline_timer": 0.00011351431343686537}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.679822702090161e-06, "add_states_from_episodes_to_batch": 2.732351560180375e-06, "numpy_to_tensor": 1.1905222024686248e-05, "batch_individual_items": 1.2213676781101955e-05, "add_observations_from_episodes_to_batch": 2.798932269349583e-06}}, "connector_pipeline_timer": 5.85357756896211e-05}, "episode_return_max": 13.5, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": -0.3}, "env_reset_timer": 0.0005478793832719537, "agent_episode_returns_mean": {"default_agent": -0.3}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "episode_len_mean": 20.0, "sample": 0.12212863641756778, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.008153228340670466, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "episode_return_mean": -0.3, "env_step_timer": 1.3696688171690596e-05, "weights_seq_no": 13.0, "num_episodes": 20, "episode_return_min": -15.5, "num_episodes_lifetime": 260, "rlmodule_inference_timer": 3.113926299384083e-05, "num_env_steps_sampled": 400, "time_between_sampling": 12.314466930349875}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "b949d_00000", "date": "2025-08-11_18-14-42", "timestamp": 1754928882, "time_this_iter_s": 11.65114688873291, "time_total_s": 156.9884865283966, "pid": 10485, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x152ff98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 156.9884865283966, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 41.45625, "ram_util_percent": 78.76875000000001}}
{"timers": {"training_iteration": 11.767035579373037, "restore_env_runners": 1.615088156394821e-05, "training_step": 11.766809059391768, "env_runner_sampling_timer": 1.7919919178021173, "learner_update_timer": 9.758003983316792, "synch_weights": 0.0016264244491157199, "restore_eval_env_runners": 5.563929491647093e-05, "evaluation_iteration": 0.13431594850586603, "synch_eval_env_connectors": 0.00020134644100054956, "synch_env_connectors": 5.384178037281824e-06}, "env_runners": {"num_env_steps_sampled_lifetime": -7400000.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.3769578668442e-05, "listify_data_for_vector_env": 1.1021754222398727e-05, "normalize_and_clip_actions": 8.319919967821978e-06, "tensor_to_numpy": 1.621169491180987e-05, "remove_single_ts_time_rank_from_batch": 1.2457480383849922e-05, "un_batch_to_individual_items": 6.838892036302053e-06}}, "connector_pipeline_timer": 0.0001260730489827129}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "weights_seq_no": 13.0, "env_reset_timer": 5.1220301147040174e-05, "env_to_module_connector": {"connector_pipeline_timer": 6.26858573650822e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.200683783103175e-06, "add_states_from_episodes_to_batch": 2.8087369106059785e-06, "numpy_to_tensor": 1.3487295489459361e-05, "batch_individual_items": 1.3052319512758168e-05, "add_observations_from_episodes_to_batch": 2.914364233701725e-06}}}, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "num_episodes": 250.0, "episode_return_min": -13.5, "episode_return_max": 6.5, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.006226731981150804, "num_episodes_lifetime": -370000.0, "module_episode_returns_mean": {"default_policy": -2.1399999999999997}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 6.946561525686884e-05, "episode_len_max": 20, "time_between_sampling": 0.04033399705055443, "env_step_timer": 1.4788055398469298e-05, "episode_return_mean": -2.1399999999999997, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "sample": 0.0066913051821256096, "agent_episode_returns_mean": {"default_agent": -2.1399999999999997}, "num_env_steps_sampled_lifetime_throughput": 3034.6507035129334}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17564244775261437, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009087761367649027, "add_observations_from_episodes_to_batch": 0.0008887604979468503, "add_columns_from_episodes_to_train_batch": 0.04136826715124503, "add_time_dim_to_batch_and_zero_pad": 0.10456424703779721, "add_states_from_episodes_to_batch": 0.0037347984910026735, "batch_individual_items": 0.0157363734798954, "numpy_to_tensor": 0.00010103590518472116}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 441000, "num_module_steps_trained_lifetime": 167832, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3144.1959563018836, "num_module_steps_trained_throughput": 19422708.83491729, "num_module_steps_trained_lifetime_throughput": 11765549.31658921}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 71.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 503496, "mean_kl_loss": 3.367493991390802e-05, "vf_loss": 0.2633981704711914, "vf_loss_unclipped": 37.311614990234375, "weights_seq_no": 84.0, "policy_loss": -0.00011350078420946375, "vf_explained_var": 0.0016825199127197266, "entropy": 0.6775002479553223, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.2040470540523529}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 503496, "diff_num_grad_updates_vs_sampler_policy": 71.0, "num_module_steps_trained": 35964, "weights_seq_no": 84.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 2646000, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 1006992, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 36848.820893685064}}}, "default_policy": {"total_loss": 0.20401453971862793, "vf_explained_var": -4.875659942626953e-05, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 83916, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 37.36541748046875, "num_module_steps_trained": 5994, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 3.417099651414901e-05, "policy_loss": -0.00011554827506188303, "vf_loss": 0.2633659839630127, "weights_seq_no": 14.0, "num_trainable_parameters": 16595, "entropy": 0.677489697933197, "use_intrinsic_rewards": 0.0, "curr_kl_coeff": 9.862300430540927e-06, "num_module_steps_trained_lifetime_throughput": 598.2851041005654}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 83916, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5994, "weights_seq_no": 14.0, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 598.2894349298556}, "IntrinsicAttentionMask": [[[0.33154529333114624, 0.337130606174469, 0.3313240706920624], [0.33382678031921387, 0.33228471875190735, 0.33388853073120117], [0.33145377039909363, 0.33732497692108154, 0.3312213122844696]], [[0.3335316479206085, 0.3329888582229614, 0.33347952365875244], [0.33398187160491943, 0.33220696449279785, 0.3338111639022827], [0.3335748612880707, 0.33291375637054443, 0.3335113823413849]], [[0.3330463767051697, 0.3330715000629425, 0.3338821530342102], [0.3330787420272827, 0.3331010341644287, 0.3338201940059662], [0.3341207206249237, 0.3340514600276947, 0.3318277895450592]], [[0.33085906505584717, 0.3307064175605774, 0.3384345471858978], [0.3308131992816925, 0.3306577503681183, 0.3385290205478668], [0.3330996334552765, 0.3330850601196289, 0.3338153064250946]], [[0.33055105805397034, 0.3346845507621765, 0.3347644507884979], [0.3357264995574951, 0.3321707248687744, 0.33210280537605286], [0.3358263075351715, 0.33212223649024963, 0.33205148577690125]], [[0.31454119086265564, 0.3705488443374634, 0.3149099051952362], [0.47438839077949524, 0.05828158184885979, 0.46733009815216064], [0.31643256545066833, 0.36680054664611816, 0.3167668879032135]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_env_steps_sampled_lifetime": 70400, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5497005698665756e-05, "get_actions": 3.926236487830404e-05, "normalize_and_clip_actions": 8.107190327756858e-06, "remove_single_ts_time_rank_from_batch": 1.2040802856597307e-05, "un_batch_to_individual_items": 6.627062450636788e-06, "listify_data_for_vector_env": 1.049388194890467e-05}}, "connector_pipeline_timer": 0.00011857649629525661}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.876096144929335e-06, "add_states_from_episodes_to_batch": 2.777585824980801e-06, "numpy_to_tensor": 1.254085440818838e-05, "batch_individual_items": 1.2568307075780592e-05, "add_observations_from_episodes_to_batch": 2.861762152693834e-06}}, "connector_pipeline_timer": 5.977084817713154e-05}, "episode_return_max": 13.5, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": -0.1}, "env_reset_timer": 0.0005456980895187318, "agent_episode_returns_mean": {"default_agent": -0.1}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "episode_len_mean": 20.0, "sample": 0.12211520088262459, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.00821470788680017, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "episode_return_mean": -0.1, "env_step_timer": 1.444129129733765e-05, "weights_seq_no": 14.0, "num_episodes": 20, "episode_return_min": -15.5, "num_episodes_lifetime": 280, "rlmodule_inference_timer": 3.2642052840778916e-05, "num_env_steps_sampled": 400, "time_between_sampling": 12.309424341046475}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "b949d_00000", "date": "2025-08-11_18-14-54", "timestamp": 1754928894, "time_this_iter_s": 11.91469693183899, "time_total_s": 168.9031834602356, "pid": 10485, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x152ff98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 168.9031834602356, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 43.48235294117647, "ram_util_percent": 78.47647058823529}}
{"timers": {"training_iteration": 11.768074770660103, "restore_env_runners": 1.6132712605767798e-05, "training_step": 11.76784812504787, "env_runner_sampling_timer": 1.791331204874406, "learner_update_timer": 9.759675755984503, "synch_weights": 0.001626187294065758, "restore_eval_env_runners": 5.554332107267209e-05, "evaluation_iteration": 0.13429890819063306, "synch_eval_env_connectors": 0.00020123464648395784, "synch_env_connectors": 5.372835998448365e-06}, "env_runners": {"num_env_steps_sampled_lifetime": -8017500.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.0683667395283965e-05, "listify_data_for_vector_env": 1.0540617367792407e-05, "normalize_and_clip_actions": 8.10002008488129e-06, "tensor_to_numpy": 1.565484681242978e-05, "remove_single_ts_time_rank_from_batch": 1.2040362185989699e-05, "un_batch_to_individual_items": 6.611499994659265e-06}}, "connector_pipeline_timer": 0.00012020776145443302}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "weights_seq_no": 14.0, "env_reset_timer": 4.124073757301412e-05, "env_to_module_connector": {"connector_pipeline_timer": 6.022145009588931e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.942668624502955e-06, "add_states_from_episodes_to_batch": 2.7041143036081125e-06, "numpy_to_tensor": 1.2774958918374572e-05, "batch_individual_items": 1.2528593574444422e-05, "add_observations_from_episodes_to_batch": 2.8022814243919118e-06}}}, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "num_episodes": 250.0, "episode_return_min": -13.5, "episode_return_max": 6.5, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.006039007647428664, "num_episodes_lifetime": -400875.0, "module_episode_returns_mean": {"default_policy": -2.6200000000000006}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 6.405067371828785e-05, "episode_len_max": 20, "time_between_sampling": 0.041027683349849596, "env_step_timer": 1.4138014203092076e-05, "episode_return_mean": -2.6200000000000006, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "sample": 0.006157552438763059, "agent_episode_returns_mean": {"default_agent": -2.6200000000000006}, "num_env_steps_sampled_lifetime_throughput": 3207.046120926503}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1755858291052279, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009085422924073822, "add_observations_from_episodes_to_batch": 0.000888086223260456, "add_columns_from_episodes_to_train_batch": 0.041370320310052625, "add_time_dim_to_batch_and_zero_pad": 0.1045419737276672, "add_states_from_episodes_to_batch": 0.0037348380061440556, "batch_individual_items": 0.015704170585203573, "numpy_to_tensor": 0.00010053929626132196}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 472500, "num_module_steps_trained_lifetime": 179820, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3134.982892226908, "num_module_steps_trained_throughput": 19006147.73823796, "num_module_steps_trained_lifetime_throughput": 11752948.358108915}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 76.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 539460, "mean_kl_loss": 1.9482829884509556e-05, "vf_loss": 0.26339465379714966, "vf_loss_unclipped": 37.86390686035156, "weights_seq_no": 90.0, "policy_loss": -0.00013492160360328853, "vf_explained_var": 0.0016494989395141602, "entropy": 0.6764286160469055, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.20402228832244873}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 539460, "diff_num_grad_updates_vs_sampler_policy": 76.0, "num_module_steps_trained": 35964, "weights_seq_no": 90.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 2835000, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 1078920, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 36268.739656370395}}}, "default_policy": {"total_loss": 0.2039937973022461, "vf_explained_var": -0.00012302398681640625, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 89910, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 37.918766021728516, "num_module_steps_trained": 5994, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 2.021436557697598e-05, "policy_loss": -0.00013728022167924792, "vf_loss": 0.26336511969566345, "weights_seq_no": 15.0, "num_trainable_parameters": 16595, "entropy": 0.6764078140258789, "use_intrinsic_rewards": 0.0, "curr_kl_coeff": 4.931150215270463e-06, "num_module_steps_trained_lifetime_throughput": 596.5324986631355}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 89910, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5994, "weights_seq_no": 15.0, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 596.5365167966858}, "IntrinsicAttentionMask": [[[0.33007916808128357, 0.3378700613975525, 0.33205080032348633], [0.3358822464942932, 0.32979899644851685, 0.33431872725486755], [0.33156082034111023, 0.33580103516578674, 0.332638144493103]], [[0.332516074180603, 0.33237114548683167, 0.3351127505302429], [0.3325001001358032, 0.33235234022140503, 0.33514755964279175], [0.3328012526035309, 0.3327067494392395, 0.3344919681549072]], [[0.33304569125175476, 0.33257240056991577, 0.3343818783760071], [0.33242911100387573, 0.3309544324874878, 0.3366164565086365], [0.33474501967430115, 0.33712729811668396, 0.3281277120113373]], [[0.3298321068286896, 0.329679936170578, 0.34048792719841003], [0.3297671675682068, 0.32961219549179077, 0.34062066674232483], [0.33427664637565613, 0.33431851863861084, 0.33140483498573303]], [[0.3327505886554718, 0.3336164057254791, 0.33363306522369385], [0.33794307708740234, 0.33109357953071594, 0.3309633433818817], [0.3380431830883026, 0.33104488253593445, 0.33091187477111816]], [[0.34817564487457275, 0.30119720101356506, 0.3506271541118622], [0.44928354024887085, 0.05199581757187843, 0.498720645904541], [0.3383118510246277, 0.32259634137153625, 0.3390917479991913]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_env_steps_sampled_lifetime": 75400, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4413187065907216e-05, "get_actions": 3.5524392417692356e-05, "normalize_and_clip_actions": 7.71546476372728e-06, "remove_single_ts_time_rank_from_batch": 1.1651006063889022e-05, "un_batch_to_individual_items": 6.456302965868243e-06, "listify_data_for_vector_env": 1.001535143005592e-05}}, "connector_pipeline_timer": 0.00011123127574700183}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.652785457967596e-06, "add_states_from_episodes_to_batch": 2.7299311654404078e-06, "numpy_to_tensor": 1.163352692373259e-05, "batch_individual_items": 1.2082465044895995e-05, "add_observations_from_episodes_to_batch": 2.749523568706109e-06}}, "connector_pipeline_timer": 5.767594756774547e-05}, "episode_return_max": 13.5, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": 1.5}, "env_reset_timer": 0.0005436281891290348, "agent_episode_returns_mean": {"default_agent": 1.5}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "episode_len_mean": 20.0, "sample": 0.12202426512352878, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.008065691600786523, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "episode_return_mean": 1.5, "env_step_timer": 1.3546360511598776e-05, "weights_seq_no": 15.0, "num_episodes": 20, "episode_return_min": -15.5, "num_episodes_lifetime": 300, "rlmodule_inference_timer": 3.024515518159253e-05, "num_env_steps_sampled": 400, "time_between_sampling": 12.305343881806394}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "b949d_00000", "date": "2025-08-11_18-15-06", "timestamp": 1754928906, "time_this_iter_s": 11.995656251907349, "time_total_s": 180.89883971214294, "pid": 10485, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x152ff98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 180.89883971214294, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 48.84117647058824, "ram_util_percent": 80.62352941176471}}
{"timers": {"training_iteration": 11.760029814622637, "restore_env_runners": 1.6155135423681753e-05, "training_step": 11.759802995876354, "env_runner_sampling_timer": 1.7888433390756722, "learner_update_timer": 9.754030506765083, "synch_weights": 0.0016271708306696577, "restore_eval_env_runners": 5.531663891001854e-05, "evaluation_iteration": 0.13417216410897737, "synch_eval_env_connectors": 0.0002025156301017881, "synch_env_connectors": 5.359948461667207e-06}, "env_runners": {"num_env_steps_sampled_lifetime": -8635000.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.006773515957515e-05, "listify_data_for_vector_env": 1.04732955424052e-05, "normalize_and_clip_actions": 8.046781144951171e-06, "tensor_to_numpy": 1.5521808957544394e-05, "remove_single_ts_time_rank_from_batch": 1.1982383904878753e-05, "un_batch_to_individual_items": 6.586808200553065e-06}}, "connector_pipeline_timer": 0.00011912289436074066}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "weights_seq_no": 15.0, "env_reset_timer": 3.731910317971948e-05, "env_to_module_connector": {"connector_pipeline_timer": 6.0013414211503336e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.879745735275732e-06, "add_states_from_episodes_to_batch": 2.692199885610905e-06, "numpy_to_tensor": 1.2772626614854846e-05, "batch_individual_items": 1.2510619517975886e-05, "add_observations_from_episodes_to_batch": 2.780982648903685e-06}}}, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "num_episodes": 250.0, "episode_return_min": -13.5, "episode_return_max": 6.5, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.005312627487815916, "num_episodes_lifetime": -431750.0, "module_episode_returns_mean": {"default_policy": -0.7800000000000001}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 3.192854874859892e-05, "episode_len_max": 20, "time_between_sampling": 0.04159401246683885, "env_step_timer": 1.4053970885780753e-05, "episode_return_mean": -0.7800000000000001, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "sample": 0.0061344255828778066, "agent_episode_returns_mean": {"default_agent": -0.7800000000000001}, "num_env_steps_sampled_lifetime_throughput": 3233.5771877964926}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1755761591546514, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00908253411434905, "add_observations_from_episodes_to_batch": 0.0008876828609692153, "add_columns_from_episodes_to_train_batch": 0.04136543252718482, "add_time_dim_to_batch_and_zero_pad": 0.10454883190044797, "add_states_from_episodes_to_batch": 0.0037423875360572943, "batch_individual_items": 0.015687714719332748, "numpy_to_tensor": 0.00010113057319800848}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 504000, "num_module_steps_trained_lifetime": 191808, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3128.839731590747, "num_module_steps_trained_throughput": 18642161.582132924, "num_module_steps_trained_lifetime_throughput": 11772026.942256916}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 81.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 575424, "mean_kl_loss": 2.5361599909956567e-05, "vf_loss": 0.2633930444717407, "vf_loss_unclipped": 37.31233596801758, "weights_seq_no": 96.0, "policy_loss": -0.0003013410314451903, "vf_explained_var": 0.0016478896141052246, "entropy": 0.6749893426895142, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.20385777950286865}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 575424, "diff_num_grad_updates_vs_sampler_policy": 81.0, "num_module_steps_trained": 35964, "weights_seq_no": 96.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 3024000, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 1150848, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 35727.079799419495}}}, "default_policy": {"total_loss": 0.2038213461637497, "vf_explained_var": -0.00016176700592041016, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 95904, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 37.369083404541016, "num_module_steps_trained": 5994, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 2.7330954253557138e-05, "policy_loss": -0.00031190941808745265, "vf_loss": 0.2633650004863739, "weights_seq_no": 16.0, "num_trainable_parameters": 16595, "entropy": 0.6749386191368103, "use_intrinsic_rewards": 0.0, "curr_kl_coeff": 2.4655751076352317e-06, "num_module_steps_trained_lifetime_throughput": 595.3640314950757}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 95904, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5994, "weights_seq_no": 16.0, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 595.3677666747698}, "IntrinsicAttentionMask": [[[0.3320055305957794, 0.33488354086875916, 0.33311089873313904], [0.3356027603149414, 0.3306935131549835, 0.3337036967277527], [0.33338987827301025, 0.3332674205303192, 0.33334270119667053]], [[0.3346007168292999, 0.3327440321445465, 0.3326552212238312], [0.33544471859931946, 0.3323514461517334, 0.33220377564430237], [0.3354852795600891, 0.33233264088630676, 0.3321821391582489]], [[0.33174267411231995, 0.33183035254478455, 0.3364269435405731], [0.33179402351379395, 0.3318789005279541, 0.33632704615592957], [0.3344579041004181, 0.3343952000141144, 0.3311469852924347]], [[0.3324055075645447, 0.3303850293159485, 0.3372094929218292], [0.33183178305625916, 0.3285968005657196, 0.33957135677337646], [0.33372387290000916, 0.3345961272716522, 0.3316799998283386]], [[0.3316001892089844, 0.3341600000858307, 0.33423978090286255], [0.33359190821647644, 0.3332099914550781, 0.3331981301307678], [0.33365383744239807, 0.33318042755126953, 0.3331657350063324]], [[0.3131820559501648, 0.37128353118896484, 0.3155343532562256], [0.4978545308113098, 0.051542047411203384, 0.45060333609580994], [0.32596901059150696, 0.3471580743789673, 0.32687294483184814]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_env_steps_sampled_lifetime": 80400, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.021751150565975e-05, "get_actions": 7.519568427937497e-05, "normalize_and_clip_actions": 1.1067562951315619e-05, "remove_single_ts_time_rank_from_batch": 1.6299493142789192e-05, "un_batch_to_individual_items": 8.948707494975585e-06, "listify_data_for_vector_env": 1.6636213219324366e-05}}, "connector_pipeline_timer": 0.00022126479450165784}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 9.204930059314239e-06, "add_states_from_episodes_to_batch": 3.248236529311217e-06, "numpy_to_tensor": 2.2882135090928446e-05, "batch_individual_items": 4.052624306916665e-05, "add_observations_from_episodes_to_batch": 3.7989633102046005e-06}}, "connector_pipeline_timer": 0.00012993437921056234}, "episode_return_max": 13.5, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": 1.9}, "env_reset_timer": 0.0005398664869270237, "agent_episode_returns_mean": {"default_agent": 1.9}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "episode_len_mean": 20.0, "sample": 0.1226852545523433, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.005852882436010986, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "episode_return_mean": 1.9, "env_step_timer": 2.91294780062545e-05, "weights_seq_no": 16.0, "num_episodes": 20, "episode_return_min": -15.5, "num_episodes_lifetime": 320, "rlmodule_inference_timer": 0.00010931631485440133, "num_env_steps_sampled": 400, "time_between_sampling": 12.292215410908273}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "b949d_00000", "date": "2025-08-11_18-15-17", "timestamp": 1754928917, "time_this_iter_s": 11.168530941009521, "time_total_s": 192.06737065315247, "pid": 10485, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x152ff98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 192.06737065315247, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 38.706250000000004, "ram_util_percent": 79.3375}}
{"timers": {"training_iteration": 11.759175417316444, "restore_env_runners": 1.7266083863585395e-05, "training_step": 11.758945821757626, "env_runner_sampling_timer": 1.7916647260956178, "learner_update_timer": 9.75014444210681, "synch_weights": 0.0016235391219854402, "restore_eval_env_runners": 5.525263340509008e-05, "evaluation_iteration": 0.1348471083079434, "synch_eval_env_connectors": 0.0002021642234488048, "synch_env_connectors": 5.349678759834519e-06}, "env_runners": {"num_env_steps_sampled_lifetime": -9252500.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 5.749574049961066e-05, "listify_data_for_vector_env": 1.2722667218259456e-05, "normalize_and_clip_actions": 1.0020621287748545e-05, "tensor_to_numpy": 2.0923504410060862e-05, "remove_single_ts_time_rank_from_batch": 1.5189015577591439e-05, "un_batch_to_individual_items": 8.073316292130488e-06}}, "connector_pipeline_timer": 0.0001601499246918325}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "weights_seq_no": 16.0, "env_reset_timer": 6.138127990326467e-05, "env_to_module_connector": {"connector_pipeline_timer": 7.597593737037998e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 9.271771047443095e-06, "add_states_from_episodes_to_batch": 3.669044948511055e-06, "numpy_to_tensor": 1.7061594835310614e-05, "batch_individual_items": 1.542842590400519e-05, "add_observations_from_episodes_to_batch": 3.624487630398024e-06}}}, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "num_episodes": 250.0, "episode_return_min": -13.5, "episode_return_max": 6.5, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.007038937882054595, "num_episodes_lifetime": -462625.0, "module_episode_returns_mean": {"default_policy": -2.0599999999999996}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 4.216141213146865e-05, "episode_len_max": 20, "time_between_sampling": 0.0395112639524545, "env_step_timer": 1.9813863009630885e-05, "episode_return_mean": -2.0599999999999996, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "sample": 0.00661901970780745, "agent_episode_returns_mean": {"default_agent": -2.0599999999999996}, "num_env_steps_sampled_lifetime_throughput": 2817.747647828608}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17567121173284334, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009098873363359402, "add_observations_from_episodes_to_batch": 0.0008876968614085739, "add_columns_from_episodes_to_train_batch": 0.04138671612256716, "add_time_dim_to_batch_and_zero_pad": 0.10458589941122366, "add_states_from_episodes_to_batch": 0.0037729624101335317, "batch_individual_items": 0.015677563822089426, "numpy_to_tensor": 0.00010095884778212493}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 535500, "num_module_steps_trained_lifetime": 203796, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3123.8305089104465, "num_module_steps_trained_throughput": 18264921.515141018, "num_module_steps_trained_lifetime_throughput": 11734476.297426218}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 86.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 611388, "mean_kl_loss": 2.1177698727115057e-05, "vf_loss": 0.2633938193321228, "vf_loss_unclipped": 36.250640869140625, "weights_seq_no": 102.0, "policy_loss": -0.00020256453717593104, "vf_explained_var": 0.0016405582427978516, "entropy": 0.6735316514968872, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.20395873486995697}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 611388, "diff_num_grad_updates_vs_sampler_policy": 86.0, "num_module_steps_trained": 35964, "weights_seq_no": 102.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 3213000, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 1222776, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 35219.37610808674}}}, "default_policy": {"total_loss": 0.20392750203609467, "vf_explained_var": -0.00018095970153808594, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 101898, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 36.307029724121094, "num_module_steps_trained": 5994, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 2.2418569642468356e-05, "policy_loss": -0.00020855534239672124, "vf_loss": 0.2633657455444336, "weights_seq_no": 17.0, "num_trainable_parameters": 16595, "entropy": 0.6734949946403503, "use_intrinsic_rewards": 0.0, "curr_kl_coeff": 1.2327875538176158e-06, "num_module_steps_trained_lifetime_throughput": 594.4113057855251}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 101898, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5994, "weights_seq_no": 17.0, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 594.414744411031}, "IntrinsicAttentionMask": [[[0.3323669731616974, 0.33524808287620544, 0.33238494396209717], [0.33497703075408936, 0.3300769627094269, 0.33494606614112854], [0.332383394241333, 0.3352155089378357, 0.3324010968208313]], [[0.332516074180603, 0.33237117528915405, 0.3351127505302429], [0.3325001001358032, 0.33235234022140503, 0.33514755964279175], [0.3328012526035309, 0.3327067494392395, 0.3344919681549072]], [[0.3307875990867615, 0.332477331161499, 0.3367350995540619], [0.3326359987258911, 0.3331005275249481, 0.33426347374916077], [0.3372538387775421, 0.3346187174320221, 0.328127384185791]], [[0.3330554962158203, 0.33103108406066895, 0.33591341972351074], [0.3328811228275299, 0.32963594794273376, 0.33748286962509155], [0.33329251408576965, 0.3329887092113495, 0.33371874690055847]], [[0.33286052942276, 0.33339619636535645, 0.33374327421188354], [0.33546188473701477, 0.3330461084842682, 0.3314920961856842], [0.33714956045150757, 0.3328133225440979, 0.33003711700439453]], [[0.3145412504673004, 0.3705487549304962, 0.314909964799881], [0.474388062953949, 0.0582820288836956, 0.46732988953590393], [0.3164325952529907, 0.3668005168437958, 0.3167669177055359]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_env_steps_sampled_lifetime": 85400, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.7986713659993057e-05, "get_actions": 4.6589862399342054e-05, "normalize_and_clip_actions": 9.500435206302911e-06, "remove_single_ts_time_rank_from_batch": 1.2900612589290648e-05, "un_batch_to_individual_items": 7.31165762315691e-06, "listify_data_for_vector_env": 1.1602791883529736e-05}}, "connector_pipeline_timer": 0.0001350663749205}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.999606806004572e-06, "add_states_from_episodes_to_batch": 3.1549651986349423e-06, "numpy_to_tensor": 1.4483907588276726e-05, "batch_individual_items": 1.4243926248919282e-05, "add_observations_from_episodes_to_batch": 3.0662480279080153e-06}}, "connector_pipeline_timer": 6.75702178139791e-05}, "episode_return_max": 13.5, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": 0.1}, "env_reset_timer": 0.0005376061521243301, "agent_episode_returns_mean": {"default_agent": 0.1}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "episode_len_mean": 20.0, "sample": 0.12282280409678634, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.005956416187109426, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "episode_return_mean": 0.1, "env_step_timer": 1.632654237904916e-05, "weights_seq_no": 17.0, "num_episodes": 20, "episode_return_min": -15.5, "num_episodes_lifetime": 340, "rlmodule_inference_timer": 3.8003905103735845e-05, "num_env_steps_sampled": 400, "time_between_sampling": 12.286785118049208}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "b949d_00000", "date": "2025-08-11_18-15-29", "timestamp": 1754928929, "time_this_iter_s": 11.825788974761963, "time_total_s": 203.89315962791443, "pid": 10485, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x152ff98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 203.89315962791443, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 46.82941176470588, "ram_util_percent": 80.86470588235294}}
{"timers": {"training_iteration": 11.755504961062284, "restore_env_runners": 1.7170923032996167e-05, "training_step": 11.755275040209758, "env_runner_sampling_timer": 1.7893784392549892, "learner_update_timer": 9.748635828524984, "synch_weights": 0.0016224554002697068, "restore_eval_env_runners": 5.480927670323561e-05, "evaluation_iteration": 0.13497319514545586, "synch_eval_env_connectors": 0.0002039355018298408, "synch_env_connectors": 5.342432615444797e-06}, "env_runners": {"num_env_steps_sampled_lifetime": -9870000.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.0569324976377254e-05, "listify_data_for_vector_env": 1.0574010544023276e-05, "normalize_and_clip_actions": 8.104583742183259e-06, "tensor_to_numpy": 1.5603391282298865e-05, "remove_single_ts_time_rank_from_batch": 1.2039199366642232e-05, "un_batch_to_individual_items": 6.659273858298351e-06}}, "connector_pipeline_timer": 0.00012022260123539165}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "weights_seq_no": 17.0, "env_reset_timer": 5.262661922440293e-05, "env_to_module_connector": {"connector_pipeline_timer": 6.05857201007526e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.991558984000313e-06, "add_states_from_episodes_to_batch": 2.740598288011891e-06, "numpy_to_tensor": 1.2716669461599124e-05, "batch_individual_items": 1.2742885983129983e-05, "add_observations_from_episodes_to_batch": 2.8115038434433436e-06}}}, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "num_episodes": 250.0, "episode_return_min": -13.5, "episode_return_max": 6.5, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.005366973161231725, "num_episodes_lifetime": -493500.0, "module_episode_returns_mean": {"default_policy": -1.1800000000000002}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 3.247278649126453e-05, "episode_len_max": 20, "time_between_sampling": 0.039664411154958536, "env_step_timer": 1.4197469743962767e-05, "episode_return_mean": -1.1800000000000002, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "sample": 0.0066388123581879125, "agent_episode_returns_mean": {"default_agent": -1.1800000000000002}, "num_env_steps_sampled_lifetime_throughput": 3154.950121949094}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17568244044641987, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009099957129408935, "add_observations_from_episodes_to_batch": 0.0008871961428379996, "add_columns_from_episodes_to_train_batch": 0.041405264381996654, "add_time_dim_to_batch_and_zero_pad": 0.10460101583693451, "add_states_from_episodes_to_batch": 0.0037733915364265556, "batch_individual_items": 0.015654522763299424, "numpy_to_tensor": 0.00010083509026360885}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 567000, "num_module_steps_trained_lifetime": 215784, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3119.2888707598204, "num_module_steps_trained_throughput": 17917499.296067208, "num_module_steps_trained_lifetime_throughput": 11730239.498965148}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 91.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 647352, "mean_kl_loss": 3.4408560168230906e-05, "vf_loss": 0.2633931040763855, "vf_loss_unclipped": 37.86418151855469, "weights_seq_no": 108.0, "policy_loss": -0.00032746579381637275, "vf_explained_var": 0.0015889406204223633, "entropy": 0.6721277236938477, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.2038375735282898}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 647352, "diff_num_grad_updates_vs_sampler_policy": 91.0, "num_module_steps_trained": 35964, "weights_seq_no": 108.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 3402000, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 1294704, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 34737.63757780647}}}, "default_policy": {"total_loss": 0.203800767660141, "vf_explained_var": -0.00010776519775390625, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 107892, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 37.91843795776367, "num_module_steps_trained": 5994, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 3.6421661206986755e-05, "policy_loss": -0.00033645174698904157, "vf_loss": 0.26336443424224854, "weights_seq_no": 18.0, "num_trainable_parameters": 16595, "entropy": 0.6720792055130005, "use_intrinsic_rewards": 0.0, "curr_kl_coeff": 6.163937769088079e-07, "num_module_steps_trained_lifetime_throughput": 593.547483792536}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 107892, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5994, "weights_seq_no": 18.0, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 593.5506497561802}, "IntrinsicAttentionMask": [[[0.3323669731616974, 0.33524808287620544, 0.33238497376441956], [0.33497700095176697, 0.3300769329071045, 0.33494603633880615], [0.332383394241333, 0.3352155089378357, 0.3324010968208313]], [[0.3334786593914032, 0.3333333134651184, 0.3331880271434784], [0.3334815204143524, 0.3333333432674408, 0.33318522572517395], [0.33348435163497925, 0.3333333134651184, 0.33318236470222473]], [[0.33287978172302246, 0.3329049050807953, 0.33421528339385986], [0.3329309821128845, 0.3329532742500305, 0.3341156840324402], [0.3355867266654968, 0.33546045422554016, 0.328952819108963]], [[0.32983213663101196, 0.3296799659729004, 0.34048792719841003], [0.3297671675682068, 0.32961219549179077, 0.34062063694000244], [0.33427664637565613, 0.33431851863861084, 0.33140483498573303]], [[0.3328605592250824, 0.3337266445159912, 0.33341285586357117], [0.3370688557624817, 0.33023709058761597, 0.33269405364990234], [0.33554285764694214, 0.33149954676628113, 0.33295756578445435]], [[0.3404613137245178, 0.3189151883125305, 0.3406234383583069], [0.47115224599838257, 0.04993169754743576, 0.4789160192012787], [0.3387467563152313, 0.3223843276500702, 0.3388688862323761]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_env_steps_sampled_lifetime": 90400, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5103516313053593e-05, "get_actions": 3.6385291533519735e-05, "normalize_and_clip_actions": 7.958005838902931e-06, "remove_single_ts_time_rank_from_batch": 1.1924624137787891e-05, "un_batch_to_individual_items": 6.518853747030814e-06, "listify_data_for_vector_env": 1.0192993555878465e-05}}, "connector_pipeline_timer": 0.00011408437386997037}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.793586876496029e-06, "add_states_from_episodes_to_batch": 2.7570966746110583e-06, "numpy_to_tensor": 1.2068192993736432e-05, "batch_individual_items": 1.227023676352573e-05, "add_observations_from_episodes_to_batch": 2.8057162083946174e-06}}, "connector_pipeline_timer": 5.8609154379620714e-05}, "episode_return_max": 13.5, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": 1.1}, "env_reset_timer": 0.000535847590790916, "agent_episode_returns_mean": {"default_agent": 1.1}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "episode_len_mean": 20.0, "sample": 0.12274077313503368, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.005952541670994833, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "episode_return_mean": 1.1, "env_step_timer": 1.3689062221808276e-05, "weights_seq_no": 18.0, "num_episodes": 20, "episode_return_min": -15.5, "num_episodes_lifetime": 360, "rlmodule_inference_timer": 3.062740665166923e-05, "num_env_steps_sampled": 400, "time_between_sampling": 12.27813163145814}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "b949d_00000", "date": "2025-08-11_18-15-41", "timestamp": 1754928941, "time_this_iter_s": 11.519444942474365, "time_total_s": 215.4126045703888, "pid": 10485, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x152ff98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 215.4126045703888, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 44.87058823529412, "ram_util_percent": 79.92352941176472}}
{"timers": {"training_iteration": 11.754961476871042, "restore_env_runners": 1.7063373778984685e-05, "training_step": 11.754730921058016, "env_runner_sampling_timer": 1.7884405027818921, "learner_update_timer": 9.748826092319186, "synch_weights": 0.0016233608463181207, "restore_eval_env_runners": 5.4555353812927736e-05, "evaluation_iteration": 0.13486373861471548, "synch_eval_env_connectors": 0.00020358155661821115, "synch_env_connectors": 5.341508106974642e-06}, "env_runners": {"num_env_steps_sampled_lifetime": -10487500.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.036377540643862e-05, "listify_data_for_vector_env": 1.0634159888190117e-05, "normalize_and_clip_actions": 8.053519327879297e-06, "tensor_to_numpy": 1.5532600372698513e-05, "remove_single_ts_time_rank_from_batch": 1.2019344650767565e-05, "un_batch_to_individual_items": 6.642674294190625e-06}}, "connector_pipeline_timer": 0.00011989469634901244}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "weights_seq_no": 18.0, "env_reset_timer": 4.412806596724185e-05, "env_to_module_connector": {"connector_pipeline_timer": 6.025103955448849e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.955953214563569e-06, "add_states_from_episodes_to_batch": 2.729272542062018e-06, "numpy_to_tensor": 1.258039016808626e-05, "batch_individual_items": 1.259642887848838e-05, "add_observations_from_episodes_to_batch": 2.813892611827208e-06}}}, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "num_episodes": 250.0, "episode_return_min": -13.5, "episode_return_max": 6.5, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.00589787536067888, "num_episodes_lifetime": -524375.0, "module_episode_returns_mean": {"default_policy": -1.5800000000000005}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 6.273784848114836e-05, "episode_len_max": 20, "time_between_sampling": 0.04034057482317273, "env_step_timer": 1.419914364381425e-05, "episode_return_mean": -1.5800000000000005, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "sample": 0.0062776132010122915, "agent_episode_returns_mean": {"default_agent": -1.5800000000000005}, "num_env_steps_sampled_lifetime_throughput": 3185.0232487841245}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1757902693810995, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009098749637639915, "add_observations_from_episodes_to_batch": 0.0008871195918042882, "add_columns_from_episodes_to_train_batch": 0.041408732568118764, "add_time_dim_to_batch_and_zero_pad": 0.10469762067811836, "add_states_from_episodes_to_batch": 0.0037783276211739744, "batch_individual_items": 0.01565824378510704, "numpy_to_tensor": 0.00010146631878374469}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 598500, "num_module_steps_trained_lifetime": 227772, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3114.259822450658, "num_module_steps_trained_throughput": 17543572.772709336, "num_module_steps_trained_lifetime_throughput": 11677500.981693245}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 96.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 683316, "mean_kl_loss": 8.482918929075822e-06, "vf_loss": 0.26339665055274963, "vf_loss_unclipped": 37.84376525878906, "weights_seq_no": 114.0, "policy_loss": -0.00011702290794346482, "vf_explained_var": 0.0015774369239807129, "entropy": 0.6712854504585266, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.20404790341854095}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 683316, "diff_num_grad_updates_vs_sampler_policy": 96.0, "num_module_steps_trained": 35964, "weights_seq_no": 114.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 3591000, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 1366632, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 34277.08443439386}}}, "default_policy": {"total_loss": 0.20401793718338013, "vf_explained_var": -9.059906005859375e-06, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 113886, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 37.89555358886719, "num_module_steps_trained": 5994, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 9.121147741097957e-06, "policy_loss": -0.0001213530485983938, "vf_loss": 0.2633654773235321, "weights_seq_no": 19.0, "num_trainable_parameters": 16595, "entropy": 0.6712539196014404, "use_intrinsic_rewards": 0.0, "curr_kl_coeff": 3.0819688845440396e-07, "num_module_steps_trained_lifetime_throughput": 592.5909806559697}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 113886, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5994, "weights_seq_no": 19.0, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 592.5939284511279}, "IntrinsicAttentionMask": [[[0.33081701397895813, 0.33639001846313477, 0.3327930271625519], [0.33403128385543823, 0.3324882984161377, 0.3334804177284241], [0.3319622576236725, 0.33499687910079956, 0.33304089307785034]], [[0.3325156569480896, 0.33525845408439636, 0.33222588896751404], [0.33281704783439636, 0.3345491886138916, 0.33263373374938965], [0.3324836492538452, 0.33533379435539246, 0.3321825861930847]], [[0.3288218677043915, 0.33180490136146545, 0.33937326073646545], [0.3306697607040405, 0.33243730664253235, 0.33689290285110474], [0.3352866768836975, 0.3339787423610687, 0.33073458075523376]], [[0.3318738639354706, 0.33178338408470154, 0.33634281158447266], [0.33182814717292786, 0.331734836101532, 0.3364369869232178], [0.33410683274269104, 0.3341553211212158, 0.33173781633377075]], [[0.33107486367225647, 0.33521488308906555, 0.333710253238678], [0.3352735936641693, 0.3317226469516754, 0.3330037295818329], [0.33375105261802673, 0.33298611640930176, 0.3332628011703491]], [[0.3001507818698883, 0.39329084753990173, 0.30655837059020996], [0.5188721418380737, 0.04938516765832901, 0.43174272775650024], [0.32545605301856995, 0.3474222719669342, 0.32712167501449585]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_env_steps_sampled_lifetime": 95400, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4735688934447512e-05, "get_actions": 3.645264502675098e-05, "normalize_and_clip_actions": 7.833625107074684e-06, "remove_single_ts_time_rank_from_batch": 1.1844715618069453e-05, "un_batch_to_individual_items": 6.51492134786719e-06, "listify_data_for_vector_env": 1.0199574155772473e-05}}, "connector_pipeline_timer": 0.00011356840434831016}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.723258855028198e-06, "add_states_from_episodes_to_batch": 2.725801195508073e-06, "numpy_to_tensor": 1.1893936187343996e-05, "batch_individual_items": 1.2171108799115953e-05, "add_observations_from_episodes_to_batch": 2.7874124600938357e-06}}, "connector_pipeline_timer": 5.831553467297661e-05}, "episode_return_max": 13.5, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": 1.1}, "env_reset_timer": 0.0005336666152129185, "agent_episode_returns_mean": {"default_agent": 1.1}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "episode_len_mean": 20.0, "sample": 0.1226610370738706, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.005902217912953347, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "episode_return_mean": 1.1, "env_step_timer": 1.3717469485477692e-05, "weights_seq_no": 19.0, "num_episodes": 20, "episode_return_min": -13.5, "num_episodes_lifetime": 380, "rlmodule_inference_timer": 3.1022026262849435e-05, "num_env_steps_sampled": 400, "time_between_sampling": 12.272647456803796}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "b949d_00000", "date": "2025-08-11_18-15-53", "timestamp": 1754928953, "time_this_iter_s": 11.828041076660156, "time_total_s": 227.24064564704895, "pid": 10485, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x152ff98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 227.24064564704895, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 48.262499999999996, "ram_util_percent": 80.1875}}
{"timers": {"training_iteration": 11.754832329602673, "restore_env_runners": 1.6966910571037215e-05, "training_step": 11.754601400597462, "env_runner_sampling_timer": 1.7884089702535708, "learner_update_timer": 9.748639408066719, "synch_weights": 0.0016242313983612178, "restore_eval_env_runners": 5.449855021288414e-05, "evaluation_iteration": 0.1347501745677624, "synch_eval_env_connectors": 0.00020322199013702325, "synch_env_connectors": 5.343503226634862e-06}, "env_runners": {"num_env_steps_sampled_lifetime": -11105000.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.361190934352667e-05, "listify_data_for_vector_env": 1.0954486206942909e-05, "normalize_and_clip_actions": 8.359291492314489e-06, "tensor_to_numpy": 1.6377850521353313e-05, "remove_single_ts_time_rank_from_batch": 1.2412209458780785e-05, "un_batch_to_individual_items": 6.855006433082408e-06}}, "connector_pipeline_timer": 0.00012619827279553453}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "weights_seq_no": 19.0, "env_reset_timer": 4.841868477394576e-05, "env_to_module_connector": {"connector_pipeline_timer": 6.292557375012694e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.2912136406119314e-06, "add_states_from_episodes_to_batch": 2.822844294787497e-06, "numpy_to_tensor": 1.353052960873613e-05, "batch_individual_items": 1.3060040835645407e-05, "add_observations_from_episodes_to_batch": 2.9431133899754156e-06}}}, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "num_episodes": 250.0, "episode_return_min": -13.5, "episode_return_max": 6.5, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.005620133475400507, "num_episodes_lifetime": -555250.0, "module_episode_returns_mean": {"default_policy": -1.0199999999999996}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 3.411803017262191e-05, "episode_len_max": 20, "time_between_sampling": 0.041482189558202466, "env_step_timer": 1.5018028623092385e-05, "episode_return_mean": -1.0199999999999996, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "sample": 0.006041155497838407, "agent_episode_returns_mean": {"default_agent": -1.0199999999999996}, "num_env_steps_sampled_lifetime_throughput": 3058.4034542174554}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1757762966869362, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009102385060832307, "add_observations_from_episodes_to_batch": 0.0008879283950887351, "add_columns_from_episodes_to_train_batch": 0.04141913149212286, "add_time_dim_to_batch_and_zero_pad": 0.10469966655101542, "add_states_from_episodes_to_batch": 0.003779119344160552, "batch_individual_items": 0.015627258847265433, "numpy_to_tensor": 0.00010119665544793871}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 630000, "num_module_steps_trained_lifetime": 239760, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_trainable_parameters": 24861, "num_env_steps_trained_lifetime_throughput": 3109.2058243293513, "num_module_steps_trained_throughput": 17219217.35227032, "num_module_steps_trained_lifetime_throughput": 11662654.74836435}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 101.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 719280, "mean_kl_loss": 7.213194476207718e-05, "vf_loss": 0.2633934020996094, "vf_loss_unclipped": 37.84320068359375, "weights_seq_no": 120.0, "policy_loss": -0.00044139602687209845, "vf_explained_var": 0.0015684962272644043, "entropy": 0.6686393022537231, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.2037353366613388}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 719280, "diff_num_grad_updates_vs_sampler_policy": 101.0, "num_module_steps_trained": 35964, "weights_seq_no": 120.0}, "__all_modules__": {"num_env_steps_trained_lifetime": 3780000, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 1438560, "num_module_steps_trained": 71928, "num_env_steps_trained_lifetime_throughput": 33841.142580051266}}}, "default_policy": {"total_loss": 0.20369359850883484, "vf_explained_var": -3.063678741455078e-05, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime": 119880, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 37.89624786376953, "num_module_steps_trained": 5994, "curr_entropy_coeff": 0.0015431216992, "mean_kl_loss": 7.496783655369654e-05, "policy_loss": -0.000448808801593259, "vf_loss": 0.26336416602134705, "weights_seq_no": 20.0, "num_trainable_parameters": 16595, "entropy": 0.6685883402824402, "use_intrinsic_rewards": 0.0, "curr_kl_coeff": 1.5409844422720198e-07, "num_module_steps_trained_lifetime_throughput": 591.6297077276959}, "intrinsic_reward_module": {"num_module_steps_trained_lifetime": 119880, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 5994, "weights_seq_no": 20.0, "curr_entropy_coeff": 0.0015431216992, "gradients_default_optimizer_global_norm": 0.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "total_loss": 0.0, "module_train_batch_size_mean": 999.0, "num_module_steps_trained_lifetime_throughput": 591.6324423965482}, "IntrinsicAttentionMask": [[[0.33081701397895813, 0.33639001846313477, 0.3327930271625519], [0.33403128385543823, 0.3324882984161377, 0.3334804177284241], [0.3319622576236725, 0.33499687910079956, 0.33304089307785034]], [[0.3334786593914032, 0.3333333134651184, 0.3331880271434784], [0.3334815204143524, 0.3333333432674408, 0.33318522572517395], [0.33348435163497925, 0.3333333134651184, 0.33318236470222473]], [[0.32975855469703674, 0.32990145683288574, 0.3403399884700775], [0.3298291563987732, 0.32996925711631775, 0.34020158648490906], [0.33486974239349365, 0.3348069489002228, 0.33032330870628357]], [[0.32883477210998535, 0.3317068815231323, 0.3394583463668823], [0.3303988575935364, 0.3322783410549164, 0.33732283115386963], [0.3345542550086975, 0.3337656855583191, 0.3316800892353058]], [[0.32680630683898926, 0.3365282118320465, 0.33666545152664185], [0.33663228154182434, 0.33171775937080383, 0.33164992928504944], [0.3367699980735779, 0.33165034651756287, 0.33157968521118164]], [[0.3145413100719452, 0.37054866552352905, 0.31491002440452576], [0.4743877351284027, 0.058282531797885895, 0.4673297107219696], [0.3164326250553131, 0.3668005168437958, 0.3167669475078583]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_env_steps_sampled_lifetime": 100400, "episode_len_min": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5495855783191507e-05, "get_actions": 3.813200265635215e-05, "normalize_and_clip_actions": 8.252092145856642e-06, "remove_single_ts_time_rank_from_batch": 1.2138485033106469e-05, "un_batch_to_individual_items": 6.8057556472913335e-06, "listify_data_for_vector_env": 1.0910564311167103e-05}}, "connector_pipeline_timer": 0.00011832134701973784}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.971270268895627e-06, "add_states_from_episodes_to_batch": 2.7665820838197935e-06, "numpy_to_tensor": 1.2353901203593977e-05, "batch_individual_items": 1.2620825044516153e-05, "add_observations_from_episodes_to_batch": 2.833285944398322e-06}}, "connector_pipeline_timer": 5.9968080728354746e-05}, "episode_return_max": 13.5, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": 0.5}, "env_reset_timer": 0.0005316166085455185, "agent_episode_returns_mean": {"default_agent": 0.5}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "episode_len_mean": 20.0, "sample": 0.12268394336417797, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.006008401241851971, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "episode_return_mean": 0.5, "env_step_timer": 1.4404176180171033e-05, "weights_seq_no": 20.0, "num_episodes": 20, "episode_return_min": -15.5, "num_episodes_lifetime": 400, "rlmodule_inference_timer": 3.245782316824333e-05, "num_env_steps_sampled": 400, "time_between_sampling": 12.26765833140625}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "b949d_00000", "date": "2025-08-11_18-16-05", "timestamp": 1754928965, "time_this_iter_s": 11.879382133483887, "time_total_s": 239.12002778053284, "pid": 10485, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x152ff98a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 239.12002778053284, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 46.59411764705882, "ram_util_percent": 80.11176470588235}}
