{"timers": {"training_iteration": 11.098152374965139, "restore_env_runners": 2.987496554851532e-05, "training_step": 11.097905250033364, "env_runner_sampling_timer": 1.672623416990973, "learner_update_timer": 9.208624458056875, "synch_weights": 0.0015072920359671116}, "env_runners": {"weights_seq_no": 0.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 5.318689076821148e-05, "remove_single_ts_time_rank_from_batch": 1.2534907985246945e-05, "tensor_to_numpy": 1.608223351813888e-05, "un_batch_to_individual_items": 6.890200444322897e-06, "normalize_and_clip_actions": 1.1120320671131459e-05, "listify_data_for_vector_env": 1.1015039409459529e-05}}, "connector_pipeline_timer": 0.000138558771538747}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.6744737673788016e-06, "add_states_from_episodes_to_batch": 2.9676701960795795e-06, "add_time_dim_to_batch_and_zero_pad": 8.136264802750519e-06, "batch_individual_items": 1.3827081592672253e-05, "numpy_to_tensor": 1.624664002366797e-05}}, "connector_pipeline_timer": 7.415233565787037e-05}, "env_to_module_sum_episodes_length_out": 10.191744832559449, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.191744832559449, "num_episodes_lifetime": 31375.0, "env_reset_timer": 0.00011212878303877136, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "episode_duration_sec_mean": 0.005441154636908322, "episode_return_min": -9.5, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "episode_len_max": 20, "env_step_timer": 1.5632183058992005e-05, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": 627500.0, "episode_return_max": 10.5, "episode_len_min": 20, "sample": 0.007575700380536242, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": -0.7000000000000002}, "time_between_sampling": 0.0007045051398453955, "rlmodule_inference_timer": 3.988988533794329e-05, "episode_return_mean": -0.7000000000000002, "module_episode_returns_mean": {"default_policy": -0.7000000000000002}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 2964.5349773209045}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000, "learner_connector": {"connector_pipeline_timer": 0.17543570802081376, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009934458998031914, "add_observations_from_episodes_to_batch": 0.0008659579325467348, "add_columns_from_episodes_to_train_batch": 0.04351483297068626, "add_time_dim_to_batch_and_zero_pad": 0.10430462507065386, "add_states_from_episodes_to_batch": 0.003614375018514693, "batch_individual_items": 0.012948583927936852, "numpy_to_tensor": 7.299997378140688e-05}}}, "learner_connector_sum_episodes_length_out": 5250}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.20430083572864532, "num_module_steps_trained_lifetime": 35964, "policy_loss": -0.00039930673665367067, "diff_num_grad_updates_vs_sampler_policy": 6.0, "weights_seq_no": 6.0, "entropy": 0.6883121728897095, "mean_kl_loss": 2.1338533770176582e-05, "vf_loss": 0.26411470770835876, "vf_loss_unclipped": 37.414310455322266, "vf_explained_var": -0.0022597312927246094, "num_module_steps_trained": 35964, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0}, "__all_modules__": {"num_module_steps_trained": 71928, "num_env_steps_trained_lifetime": 189000, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 71928, "num_env_steps_trained_lifetime_throughput": 51139.317628266566}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 35964, "diff_num_grad_updates_vs_sampler_policy": 6.0, "weights_seq_no": 6.0}}}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 5994, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 1.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime_throughput": 520.595024771524}, "default_policy": {"entropy": 0.6883416175842285, "mean_kl_loss": 2.334910095669329e-05, "vf_loss_unclipped": 37.32540512084961, "curr_entropy_coeff": 0.0015431216992, "vf_explained_var": -0.00019621849060058594, "num_module_steps_trained": 5994, "curr_kl_coeff": 0.08079196512699127, "vf_loss": 0.26358267664909363, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.20386841893196106, "num_module_steps_trained_lifetime": 5994, "policy_loss": -0.00041749776573851705, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 1.0, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 520.5890987771903}, "IntrinsicAttentionMask": [[[0.3346644341945648, 0.3245525658130646, 0.3407830595970154], [0.333668977022171, 0.3311885595321655, 0.33514243364334106], [0.33521726727485657, 0.32066163420677185, 0.3441210985183716]], [[0.3470194339752197, 0.33127880096435547, 0.3217017650604248], [0.34102684259414673, 0.3322127163410187, 0.32676050066947937], [0.33726099133491516, 0.3327723741531372, 0.32996666431427]], [[0.3466927111148834, 0.34569817781448364, 0.3076091408729553], [0.3462161123752594, 0.34525901079177856, 0.30852484703063965], [0.3262820243835449, 0.326763778924942, 0.34695422649383545]], [[0.34372806549072266, 0.321834921836853, 0.33443698287010193], [0.3166631758213043, 0.35229697823524475, 0.3310398757457733], [0.3323909044265747, 0.3343880772590637, 0.3332210183143616]], [[0.33243101835250854, 0.33333250880241394, 0.3342365026473999], [0.3323962092399597, 0.33333244919776917, 0.3342713415622711], [0.3323614299297333, 0.3333323895931244, 0.33430618047714233]], [[0.33072465658187866, 0.33910655975341797, 0.33016878366470337], [0.10017760843038559, 0.8127948045730591, 0.08702760189771652], [0.34483441710472107, 0.3076784908771515, 0.34748712182044983]]], "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 31500, "num_module_steps_trained_lifetime": 11988, "num_env_steps_trained_lifetime_throughput": 2735.851173068679, "num_module_steps_trained_throughput": 33703134.81117954, "num_module_steps_trained_lifetime_throughput": 15202867.862856064}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 3.421894302503519e-05, "un_batch_to_individual_items": 1.2443416669724097e-05, "listify_data_for_vector_env": 2.461468981623116e-05, "remove_single_ts_time_rank_from_batch": 1.911883329440872e-05, "normalize_and_clip_actions": 1.9128443551147458e-05, "get_actions": 0.00016473249489593785}}, "connector_pipeline_timer": 0.0003264898655119573}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.6979751015188454e-05, "add_observations_from_episodes_to_batch": 5.991813596908363e-06, "add_time_dim_to_batch_and_zero_pad": 1.669829064700174e-05, "numpy_to_tensor": 3.104218348099101e-05, "add_states_from_episodes_to_batch": 6.678677237467313e-06}}, "connector_pipeline_timer": 0.0001366600535523836}, "num_env_steps_sampled": 400, "episode_return_max": 12.5, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.216013141322508, "num_episodes_lifetime": 20, "env_reset_timer": 0.0005509170005097985, "episode_duration_sec_mean": 0.008848431258229539, "env_step_timer": 3.4698484345378e-05, "episode_return_mean": -1.95, "env_to_module_sum_episodes_length_out": 10.216013141322508, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.19477512501180172, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "weights_seq_no": 1.0, "module_episode_returns_mean": {"default_policy": -1.95}, "agent_episode_returns_mean": {"default_agent": -1.95}, "episode_return_min": -12.5, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 5400, "episode_len_min": 20, "rlmodule_inference_timer": 8.242016178092239e-05}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "ba9d3_00000", "date": "2025-08-11_18-26-20", "timestamp": 1754929580, "time_this_iter_s": 11.317835092544556, "time_total_s": 11.317835092544556, "pid": 11057, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386e458a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11.317835092544556, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 45.5, "ram_util_percent": 80.10000000000001}}
{"timers": {"training_iteration": 11.097806677885819, "restore_env_runners": 2.9757055453956128e-05, "training_step": 11.097559070872377, "env_runner_sampling_timer": 1.6734897432406433, "learner_update_timer": 9.206183187225832, "synch_weights": 0.0015085432853084058, "restore_eval_env_runners": 6.158300675451756e-05, "evaluation_iteration": 0.21686983294785023, "synch_eval_env_connectors": 0.00018949992954730988, "synch_env_connectors": 5.832989700138569e-06}, "env_runners": {"weights_seq_no": 1.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.69165021551656e-05, "remove_single_ts_time_rank_from_batch": 1.2938462511920385e-05, "tensor_to_numpy": 1.7771641218615866e-05, "un_batch_to_individual_items": 7.124585491431871e-06, "normalize_and_clip_actions": 9.273489707265159e-06, "listify_data_for_vector_env": 1.1690791875207996e-05}}, "connector_pipeline_timer": 0.00013508769441250744}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.1794732018587393e-06, "add_states_from_episodes_to_batch": 2.9619215008795146e-06, "add_time_dim_to_batch_and_zero_pad": 7.794116859347232e-06, "batch_individual_items": 1.3530953801413097e-05, "numpy_to_tensor": 1.5397632113519834e-05}}, "connector_pipeline_timer": 6.768238228819689e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": 500.0, "env_reset_timer": 5.575584617169701e-05, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "episode_duration_sec_mean": 0.005997402138542384, "episode_return_min": -9.5, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "episode_len_max": 20, "env_step_timer": 1.6243981928096e-05, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": 10000.0, "episode_return_max": 10.5, "episode_len_min": 20, "sample": 0.006502672335069527, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 1.699999999999999}, "time_between_sampling": 0.03647216789405581, "rlmodule_inference_timer": 3.5964047934067594e-05, "episode_return_mean": 1.699999999999999, "module_episode_returns_mean": {"default_policy": 1.699999999999999}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3015.2131754666166}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17659833385027016, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009928501908434554, "add_observations_from_episodes_to_batch": 0.0008658550237305463, "add_columns_from_episodes_to_train_batch": 0.043493636721977966, "add_time_dim_to_batch_and_zero_pad": 0.10428427798906341, "add_states_from_episodes_to_batch": 0.00361564960796386, "batch_individual_items": 0.01415836225845851, "numpy_to_tensor": 7.29112233966589e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.2043023705482483, "num_module_steps_trained_lifetime": 71928, "policy_loss": -0.00012678353232331574, "diff_num_grad_updates_vs_sampler_policy": 11.0, "weights_seq_no": 12.0, "entropy": 0.6888877153396606, "mean_kl_loss": 2.4744917027419433e-05, "vf_loss": 0.2637673020362854, "vf_loss_unclipped": 39.10930633544922, "vf_explained_var": -0.0020471811294555664, "num_module_steps_trained": 35964, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0}, "__all_modules__": {"num_module_steps_trained": 71928, "num_env_steps_trained_lifetime": 378000, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 143856, "num_env_steps_trained_lifetime_throughput": 50859.01623088711}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 71928, "diff_num_grad_updates_vs_sampler_policy": 11.0, "weights_seq_no": 12.0}}}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 11988, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 2.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime_throughput": 521.8199847952225}, "default_policy": {"entropy": 0.6888928413391113, "mean_kl_loss": 2.5156023184536025e-05, "vf_loss_unclipped": 39.1546630859375, "curr_entropy_coeff": 0.0015431216992, "vf_explained_var": -0.0007290840148925781, "num_module_steps_trained": 5994, "curr_kl_coeff": 0.040395982563495636, "vf_loss": 0.26399388909339905, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.20447449386119843, "num_module_steps_trained_lifetime": 11988, "policy_loss": -0.00012916421110276133, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 2.0, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 521.8141347975397}, "IntrinsicAttentionMask": [[[0.33465275168418884, 0.3414730727672577, 0.3238741457462311], [0.3352522552013397, 0.3455367982387543, 0.3192109167575836], [0.33359915018081665, 0.33489692211151123, 0.3315039575099945]], [[0.33385995030403137, 0.3356059789657593, 0.3305341601371765], [0.3357841968536377, 0.34443995356559753, 0.3197758197784424], [0.32964199781417847, 0.318743497133255, 0.35161447525024414]], [[0.34150606393814087, 0.3409108817577362, 0.3175830543041229], [0.34102198481559753, 0.34046322107315063, 0.3185148239135742], [0.32080933451652527, 0.3216457664966583, 0.3575448989868164]], [[0.33783793449401855, 0.33116233348846436, 0.3309997320175171], [0.29995423555374146, 0.3493661880493164, 0.3506796658039093], [0.299052894115448, 0.34979766607284546, 0.35114943981170654]], [[0.3332909643650055, 0.3333333134651184, 0.3333756923675537], [0.33325618505477905, 0.3333333432674408, 0.3334105312824249], [0.33322134613990784, 0.3333333134651184, 0.33344531059265137]], [[0.33169829845428467, 0.3386133015155792, 0.3296884000301361], [0.17180223762989044, 0.7153350114822388, 0.1128627136349678], [0.3574490249156952, 0.24117712676525116, 0.40137386322021484]]], "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 63000, "num_module_steps_trained_lifetime": 23976, "num_env_steps_trained_lifetime_throughput": 2742.288702769563, "num_module_steps_trained_throughput": 33204444.545283075, "num_module_steps_trained_lifetime_throughput": 15131678.134294426}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5038568796998324e-05, "un_batch_to_individual_items": 6.728825503966444e-06, "listify_data_for_vector_env": 1.040759112490865e-05, "remove_single_ts_time_rank_from_batch": 1.1947719826556882e-05, "normalize_and_clip_actions": 8.03351325076231e-06, "get_actions": 3.871406200661612e-05}}, "connector_pipeline_timer": 0.00011727186370613864}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2803388282605445e-05, "add_observations_from_episodes_to_batch": 2.9463238801258368e-06, "add_time_dim_to_batch_and_zero_pad": 6.901630374319104e-06, "numpy_to_tensor": 1.2471926548732573e-05, "add_states_from_episodes_to_batch": 2.7627449562686702e-06}}, "connector_pipeline_timer": 6.012020553743186e-05}, "num_env_steps_sampled": 400, "episode_return_max": 14.5, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.366003441359926, "num_episodes_lifetime": 40, "env_reset_timer": 0.0005489369900897145, "episode_duration_sec_mean": 0.007036467705620453, "env_step_timer": 1.4178414460303902e-05, "episode_return_mean": -2.95, "env_to_module_sum_episodes_length_out": 10.366003441359926, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.19397379293222913, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "weights_seq_no": 2.0, "module_episode_returns_mean": {"default_policy": -2.95}, "agent_episode_returns_mean": {"default_agent": -2.95}, "episode_return_min": -12.5, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 10400, "episode_len_min": 20, "rlmodule_inference_timer": 3.2855986341411924e-05, "time_between_sampling": 11.150566833093762}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "ba9d3_00000", "date": "2025-08-11_18-26-31", "timestamp": 1754929591, "time_this_iter_s": 11.190108299255371, "time_total_s": 22.507943391799927, "pid": 11057, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386e458a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 22.507943391799927, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 48.60666666666666, "ram_util_percent": 80.67333333333333}}
{"timers": {"training_iteration": 11.093643018607166, "restore_env_runners": 2.9558654455468057e-05, "training_step": 11.093395374323416, "env_runner_sampling_timer": 1.6730109958073356, "learner_update_timer": 9.20159916493315, "synch_weights": 0.0015079116027918644, "restore_eval_env_runners": 6.140259676612914e-05, "evaluation_iteration": 0.21593669711844996, "synch_eval_env_connectors": 0.00018929242971353234, "synch_env_connectors": 5.835909396409988e-06}, "env_runners": {"weights_seq_no": 2.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.2476817491974374e-05, "remove_single_ts_time_rank_from_batch": 1.2578067236412527e-05, "tensor_to_numpy": 1.6098589601809786e-05, "un_batch_to_individual_items": 6.924535391781031e-06, "normalize_and_clip_actions": 8.332805877892337e-06, "listify_data_for_vector_env": 1.1052204625563335e-05}}, "connector_pipeline_timer": 0.00012493211544435215}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9397526547434724e-06, "add_states_from_episodes_to_batch": 2.832016765675036e-06, "add_time_dim_to_batch_and_zero_pad": 7.308383505051642e-06, "batch_individual_items": 1.302064077374555e-05, "numpy_to_tensor": 1.347725206567022e-05}}, "connector_pipeline_timer": 6.228947716747269e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -30375.0, "env_reset_timer": 4.327561969930892e-05, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "episode_duration_sec_mean": 0.0055772018143907184, "episode_return_min": -9.5, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "episode_len_max": 20, "env_step_timer": 1.487303853404011e-05, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -607500.0, "episode_return_max": 10.5, "episode_len_min": 20, "sample": 0.005857218230689805, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": -1.1800000000000002}, "time_between_sampling": 0.03818874344139294, "rlmodule_inference_timer": 3.389617391188021e-05, "episode_return_mean": -1.1800000000000002, "module_episode_returns_mean": {"default_policy": -1.1800000000000002}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3130.5821774160468}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17738471218171764, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009920795639057177, "add_observations_from_episodes_to_batch": 0.0008659018843667582, "add_columns_from_episodes_to_train_batch": 0.043527806184010115, "add_time_dim_to_batch_and_zero_pad": 0.1050013777090935, "add_states_from_episodes_to_batch": 0.003624315611505881, "batch_individual_items": 0.014188982805085834, "numpy_to_tensor": 7.519586053676904e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.2040155529975891, "num_module_steps_trained_lifetime": 107892, "policy_loss": -0.00028731769998557866, "diff_num_grad_updates_vs_sampler_policy": 16.0, "weights_seq_no": 18.0, "entropy": 0.6896921992301941, "mean_kl_loss": 2.9000801077927463e-05, "vf_loss": 0.2636059820652008, "vf_loss_unclipped": 37.09755325317383, "vf_explained_var": -0.001989603042602539, "num_module_steps_trained": 35964, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0}, "__all_modules__": {"num_module_steps_trained": 71928, "num_env_steps_trained_lifetime": 567000, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 215784, "num_env_steps_trained_lifetime_throughput": 50359.57509930411}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 107892, "diff_num_grad_updates_vs_sampler_policy": 16.0, "weights_seq_no": 18.0}}}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 17982, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 3.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime_throughput": 524.2079162279443}, "default_policy": {"entropy": 0.6897065043449402, "mean_kl_loss": 3.0333974791574292e-05, "vf_loss_unclipped": 36.95168685913086, "curr_entropy_coeff": 0.0015431216992, "vf_explained_var": 0.00019788742065429688, "num_module_steps_trained": 5994, "curr_kl_coeff": 0.020197991281747818, "vf_loss": 0.263407826423645, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.20384937524795532, "num_module_steps_trained_lifetime": 17982, "policy_loss": -0.00029567713500000536, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 3.0, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 524.2022340830836}, "IntrinsicAttentionMask": [[[0.3290920853614807, 0.33579906821250916, 0.33510884642601013], [0.32699155807495117, 0.33702269196510315, 0.3359857499599457], [0.32720547914505005, 0.33689799904823303, 0.33589649200439453]], [[0.33283621072769165, 0.33457690477371216, 0.3325868844985962], [0.3308926820755005, 0.33942240476608276, 0.32968488335609436], [0.33311349153518677, 0.33388349413871765, 0.3330029845237732]], [[0.33901894092559814, 0.33804643154144287, 0.322934627532959], [0.338813453912735, 0.3378768265247345, 0.32330965995788574], [0.33552995324134827, 0.33515915274620056, 0.3293108344078064]], [[0.3392687439918518, 0.33063316345214844, 0.33009812235832214], [0.33317649364471436, 0.3334046006202698, 0.33341893553733826], [0.332795649766922, 0.33357763290405273, 0.33362680673599243]], [[0.3371170461177826, 0.3376500606536865, 0.3252328932285309], [0.33736515045166016, 0.33793383836746216, 0.3247010409832001], [0.3314141631126404, 0.3311516344547272, 0.33743420243263245]], [[0.3307246267795563, 0.3391067385673523, 0.3301686942577362], [0.10017509013414383, 0.8127995729446411, 0.0870252475142479], [0.3448345363140106, 0.30767822265625, 0.34748727083206177]]], "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 94500, "num_module_steps_trained_lifetime": 35964, "num_env_steps_trained_lifetime_throughput": 2754.838241983259, "num_module_steps_trained_throughput": 32439584.734222878, "num_module_steps_trained_lifetime_throughput": 15005201.783156404}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.445266677550117e-05, "un_batch_to_individual_items": 6.576931593357931e-06, "listify_data_for_vector_env": 1.0179055967348303e-05, "remove_single_ts_time_rank_from_batch": 1.167116570467965e-05, "normalize_and_clip_actions": 7.773295623575e-06, "get_actions": 3.5483405705691134e-05}}, "connector_pipeline_timer": 0.00011174804191378314}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2379396923204899e-05, "add_observations_from_episodes_to_batch": 2.8126116621248193e-06, "add_time_dim_to_batch_and_zero_pad": 6.687025199149706e-06, "numpy_to_tensor": 1.1831982481012718e-05, "add_states_from_episodes_to_batch": 2.6879422859098986e-06}}, "connector_pipeline_timer": 5.798102242928773e-05}, "num_env_steps_sampled": 400, "episode_return_max": 14.5, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368205581254823, "num_episodes_lifetime": 60, "env_reset_timer": 0.0005465530303306877, "episode_duration_sec_mean": 0.006416993720146517, "env_step_timer": 1.375322868715778e-05, "episode_return_mean": -1.2833333333333334, "env_to_module_sum_episodes_length_out": 10.368205581254823, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.19316964000364537, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "weights_seq_no": 3.0, "module_episode_returns_mean": {"default_policy": -1.2833333333333334}, "agent_episode_returns_mean": {"default_agent": -1.2833333333333334}, "episode_return_min": -12.5, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 15400, "episode_len_min": 20, "rlmodule_inference_timer": 3.1004196598712424e-05, "time_between_sampling": 11.146223963102091}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "ba9d3_00000", "date": "2025-08-11_18-26-42", "timestamp": 1754929602, "time_this_iter_s": 10.806565999984741, "time_total_s": 33.31450939178467, "pid": 11057, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386e458a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 33.31450939178467, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 40.0625, "ram_util_percent": 80.1625}}
{"timers": {"training_iteration": 11.099996782581398, "restore_env_runners": 2.9379737018141894e-05, "training_step": 11.099748952240585, "env_runner_sampling_timer": 1.6814681529294444, "learner_update_timer": 9.199184781614667, "synch_weights": 0.0015036383257381384, "restore_eval_env_runners": 6.12081618863158e-05, "evaluation_iteration": 0.214998805568018, "synch_eval_env_connectors": 0.00018918575533898548, "synch_env_connectors": 5.824220040813088e-06}, "env_runners": {"weights_seq_no": 3.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 7.65197054789929e-05, "remove_single_ts_time_rank_from_batch": 1.727391770858966e-05, "tensor_to_numpy": 2.7186846404742996e-05, "un_batch_to_individual_items": 9.813633939403692e-06, "normalize_and_clip_actions": 1.2836618434959881e-05, "listify_data_for_vector_env": 1.6110055913532285e-05}}, "connector_pipeline_timer": 0.0001995363422971453}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.265117172991738e-06, "add_states_from_episodes_to_batch": 4.109037406974139e-06, "add_time_dim_to_batch_and_zero_pad": 1.1798501188444224e-05, "batch_individual_items": 1.880248200665816e-05, "numpy_to_tensor": 2.21269798210176e-05}}, "connector_pipeline_timer": 9.17447699027383e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -61250.0, "env_reset_timer": 5.256604710530957e-05, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "episode_duration_sec_mean": 0.00875249934429303, "episode_return_min": -9.5, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "episode_len_max": 20, "env_step_timer": 2.547733352219675e-05, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -1225000.0, "episode_return_max": 10.5, "episode_len_min": 20, "sample": 0.007631468383365531, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 0.019999999999999997}, "time_between_sampling": 0.037493334664459296, "rlmodule_inference_timer": 5.4634298030664884e-05, "episode_return_mean": 0.019999999999999997, "module_episode_returns_mean": {"default_policy": 0.019999999999999997}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 2672.0201075014725}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1775270996393034, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009959840182412765, "add_observations_from_episodes_to_batch": 0.0008662124565222767, "add_columns_from_episodes_to_train_batch": 0.04354555020147946, "add_time_dim_to_batch_and_zero_pad": 0.10509352351248846, "add_states_from_episodes_to_batch": 0.0036333207847974265, "batch_individual_items": 0.014173006307155941, "numpy_to_tensor": 7.533806240698324e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.2037089467048645, "num_module_steps_trained_lifetime": 143856, "policy_loss": -0.00044258360867388546, "diff_num_grad_updates_vs_sampler_policy": 21.0, "weights_seq_no": 24.0, "entropy": 0.6902276277542114, "mean_kl_loss": 4.211579289403744e-05, "vf_loss": 0.2634100019931793, "vf_loss_unclipped": 40.55880355834961, "vf_explained_var": -0.0016796588897705078, "num_module_steps_trained": 35964, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0}, "__all_modules__": {"num_module_steps_trained": 71928, "num_env_steps_trained_lifetime": 756000, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 287712, "num_env_steps_trained_lifetime_throughput": 49706.69036042716}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 143856, "diff_num_grad_updates_vs_sampler_policy": 21.0, "weights_seq_no": 24.0}}}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 23976, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 4.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime_throughput": 526.9574922329476}, "default_policy": {"entropy": 0.690244197845459, "mean_kl_loss": 4.41492120444309e-05, "vf_loss_unclipped": 40.51332473754883, "curr_entropy_coeff": 0.0015431216992, "vf_explained_var": 0.0005252361297607422, "num_module_steps_trained": 5994, "curr_kl_coeff": 0.010098995640873909, "vf_loss": 0.26340529322624207, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.20368820428848267, "num_module_steps_trained_lifetime": 23976, "policy_loss": -0.00045369326835498214, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 4.0, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 526.9520355022959}, "IntrinsicAttentionMask": [[[0.33465278148651123, 0.3414731025695801, 0.3238741159439087], [0.3352522552013397, 0.3455367982387543, 0.31921088695526123], [0.33359915018081665, 0.33489692211151123, 0.3315039277076721]], [[0.3343283236026764, 0.3308390974998474, 0.33483263850212097], [0.3324034512042999, 0.33565816283226013, 0.33193841576576233], [0.33460283279418945, 0.3301495313644409, 0.33524760603904724]], [[0.33901897072792053, 0.33804646134376526, 0.3229345679283142], [0.3388134837150574, 0.3378768563270569, 0.32330963015556335], [0.33552995324134827, 0.33515915274620056, 0.3293108344078064]], [[0.33510857820510864, 0.33228588104248047, 0.3326055705547333], [0.33341261744499207, 0.3332865536212921, 0.3333008587360382], [0.33360520005226135, 0.33317285776138306, 0.333221971988678]], [[0.3371170461177826, 0.3376500606536865, 0.3252328634262085], [0.33736515045166016, 0.33793383836746216, 0.3247010111808777], [0.33141419291496277, 0.33115166425704956, 0.33743420243263245]], [[0.3654947876930237, 0.26060551404953003, 0.3738996684551239], [0.13275744020938873, 0.7490612268447876, 0.11818129569292068], [0.3769221305847168, 0.2338676005601883, 0.3892102837562561]]], "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 126000, "num_module_steps_trained_lifetime": 47952, "num_env_steps_trained_lifetime_throughput": 2769.2885011786184, "num_module_steps_trained_throughput": 31575606.759588555, "num_module_steps_trained_lifetime_throughput": 14881184.424829556}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4529027949578618e-05, "un_batch_to_individual_items": 6.601903720003367e-06, "listify_data_for_vector_env": 1.0165106009299964e-05, "remove_single_ts_time_rank_from_batch": 1.1841950702606536e-05, "normalize_and_clip_actions": 7.924100739080783e-06, "get_actions": 3.542765258005908e-05}}, "connector_pipeline_timer": 0.0001124137117594407}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2443040326688292e-05, "add_observations_from_episodes_to_batch": 2.7816635399045e-06, "add_time_dim_to_batch_and_zero_pad": 6.708997554078905e-06, "numpy_to_tensor": 1.1891364895376517e-05, "add_states_from_episodes_to_batch": 2.714036647081237e-06}}, "connector_pipeline_timer": 5.811072859466981e-05}, "num_env_steps_sampled": 400, "episode_return_max": 14.5, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368237912813044, "num_episodes_lifetime": 80, "env_reset_timer": 0.0005442408302081749, "episode_duration_sec_mean": 0.006110672387876548, "env_step_timer": 1.3561221509741247e-05, "episode_return_mean": -0.7, "env_to_module_sum_episodes_length_out": 10.368237912813044, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.192374329013236, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "weights_seq_no": 4.0, "module_episode_returns_mean": {"default_policy": -0.7}, "agent_episode_returns_mean": {"default_agent": -0.7}, "episode_return_min": -12.5, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 20400, "episode_len_min": 20, "rlmodule_inference_timer": 3.0636535641150307e-05, "time_between_sampling": 11.152323189311625}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "ba9d3_00000", "date": "2025-08-11_18-26-54", "timestamp": 1754929614, "time_this_iter_s": 11.853420972824097, "time_total_s": 45.167930364608765, "pid": 11057, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386e458a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 45.167930364608765, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 47.07058823529411, "ram_util_percent": 80.0764705882353}}
{"timers": {"training_iteration": 11.115957263095398, "restore_env_runners": 2.914718924123328e-05, "training_step": 11.11571005646762, "env_runner_sampling_timer": 1.6831869239002735, "learner_update_timer": 9.21341157587756, "synch_weights": 0.0014980781927511385, "restore_eval_env_runners": 6.073482986877207e-05, "evaluation_iteration": 0.21406498626288098, "synch_eval_env_connectors": 0.00018853930773434695, "synch_env_connectors": 5.820148217957466e-06}, "env_runners": {"weights_seq_no": 4.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 5.2320441176202796e-05, "remove_single_ts_time_rank_from_batch": 1.3493644067440935e-05, "tensor_to_numpy": 1.80337950766783e-05, "un_batch_to_individual_items": 9.721991978152546e-06, "normalize_and_clip_actions": 9.225179847348015e-06, "listify_data_for_vector_env": 1.1823875963258121e-05}}, "connector_pipeline_timer": 0.00014395407910453888}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.434860795997213e-06, "add_states_from_episodes_to_batch": 3.118251134516989e-06, "add_time_dim_to_batch_and_zero_pad": 8.12937784118761e-06, "batch_individual_items": 1.4176129644286107e-05, "numpy_to_tensor": 1.4874523947354155e-05}}, "connector_pipeline_timer": 7.315136879261741e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -92125.0, "env_reset_timer": 6.07434777155705e-05, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "episode_duration_sec_mean": 0.006369109287858014, "episode_return_min": -9.5, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "episode_len_max": 20, "env_step_timer": 1.7711744309364753e-05, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -1842500.0, "episode_return_max": 10.5, "episode_len_min": 20, "sample": 0.008262212352038908, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": -2.2199999999999998}, "time_between_sampling": 0.03805576329182755, "rlmodule_inference_timer": 3.8050302634045255e-05, "episode_return_mean": -2.2199999999999998, "module_episode_returns_mean": {"default_policy": -2.2199999999999998}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 2928.1058621626125}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17747901781310702, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009950090951351683, "add_observations_from_episodes_to_batch": 0.0008658386721344408, "add_columns_from_episodes_to_train_batch": 0.043532139279801325, "add_time_dim_to_batch_and_zero_pad": 0.10507636910711173, "add_states_from_episodes_to_batch": 0.003634650907971938, "batch_individual_items": 0.014164797915025645, "numpy_to_tensor": 7.542134123858532e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.20355717837810516, "num_module_steps_trained_lifetime": 179820, "policy_loss": -0.0005865287384949625, "diff_num_grad_updates_vs_sampler_policy": 26.0, "weights_seq_no": 30.0, "entropy": 0.6910037398338318, "mean_kl_loss": 2.9634094971697778e-05, "vf_loss": 0.26340407133102417, "vf_loss_unclipped": 36.18130874633789, "vf_explained_var": -0.0017881393432617188, "num_module_steps_trained": 35964, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0}, "__all_modules__": {"num_module_steps_trained": 71928, "num_env_steps_trained_lifetime": 945000, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 359640, "num_env_steps_trained_lifetime_throughput": 48929.072221268456}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 179820, "diff_num_grad_updates_vs_sampler_policy": 26.0, "weights_seq_no": 30.0}}}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 29970, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 5.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime_throughput": 528.8123436944178}, "default_policy": {"entropy": 0.6910266280174255, "mean_kl_loss": 3.2415049645351246e-05, "vf_loss_unclipped": 36.10761260986328, "curr_entropy_coeff": 0.0015431216992, "vf_explained_var": 0.0007222294807434082, "num_module_steps_trained": 5994, "curr_kl_coeff": 0.0050494978204369545, "vf_loss": 0.263436496257782, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.20355047285556793, "num_module_steps_trained_lifetime": 29970, "policy_loss": -0.0006139727192930877, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 5.0, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 528.8071387839892}, "IntrinsicAttentionMask": [[[0.3345928490161896, 0.33046379685401917, 0.33494341373443604], [0.3285676836967468, 0.34414562582969666, 0.3272867202758789], [0.33509311079978943, 0.32932254672050476, 0.3355843424797058]], [[0.3470195233821869, 0.33127865195274353, 0.3217017650604248], [0.34102684259414673, 0.3322126269340515, 0.32676050066947937], [0.33726102113723755, 0.33277231454849243, 0.32996660470962524]], [[0.34706035256385803, 0.322345107793808, 0.3305944800376892], [0.3342202603816986, 0.3326158821582794, 0.3331637978553772], [0.3385894000530243, 0.3290969729423523, 0.33231356739997864]], [[0.34372082352638245, 0.33497193455696106, 0.3213072717189789], [0.3330583870410919, 0.33328643441200256, 0.3336551785469055], [0.31598466634750366, 0.3300132751464844, 0.3540019989013672]], [[0.34153327345848083, 0.32897329330444336, 0.3294934332370758], [0.3287222683429718, 0.33578935265541077, 0.33548831939697266], [0.3292575180530548, 0.33550411462783813, 0.33523833751678467]], [[0.3159119188785553, 0.3742615282535553, 0.3098266124725342], [0.10757659375667572, 0.8070580363273621, 0.08536537736654282], [0.3374466896057129, 0.3234637975692749, 0.3390895426273346]]], "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 157500, "num_module_steps_trained_lifetime": 59940, "num_env_steps_trained_lifetime_throughput": 2779.036813751509, "num_module_steps_trained_throughput": 30642594.772393472, "num_module_steps_trained_lifetime_throughput": 14729014.944543034}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4382705843595297e-05, "un_batch_to_individual_items": 6.544389170753516e-06, "listify_data_for_vector_env": 1.0138318434217278e-05, "remove_single_ts_time_rank_from_batch": 1.191779819174412e-05, "normalize_and_clip_actions": 7.858335107743207e-06, "get_actions": 3.5201934527881015e-05}}, "connector_pipeline_timer": 0.00011185394484153113}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2322205624446801e-05, "add_observations_from_episodes_to_batch": 2.8051018218280795e-06, "add_time_dim_to_batch_and_zero_pad": 6.613653343550895e-06, "numpy_to_tensor": 1.1680493569323597e-05, "add_states_from_episodes_to_batch": 2.7011436114684556e-06}}, "connector_pipeline_timer": 5.780050538977779e-05}, "num_env_steps_sampled": 400, "episode_return_max": 14.5, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238387501162, "num_episodes_lifetime": 100, "env_reset_timer": 0.0005420330018324498, "episode_duration_sec_mean": 0.005920664167497307, "env_step_timer": 1.3502514123193878e-05, "episode_return_mean": -0.35, "env_to_module_sum_episodes_length_out": 10.368238387501162, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.1915799619734228, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "weights_seq_no": 5.0, "module_episode_returns_mean": {"default_policy": -0.35}, "agent_episode_returns_mean": {"default_agent": -0.35}, "episode_return_min": -12.5, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 25400, "episode_len_min": 20, "rlmodule_inference_timer": 3.0974853525242134e-05, "time_between_sampling": 11.168030330328198}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "ba9d3_00000", "date": "2025-08-11_18-27-06", "timestamp": 1754929626, "time_this_iter_s": 12.820784091949463, "time_total_s": 57.98871445655823, "pid": 11057, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386e458a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 57.98871445655823, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 52.26666666666667, "ram_util_percent": 81.68333333333334}}
{"timers": {"training_iteration": 11.120251625044297, "restore_env_runners": 2.8917387201405546e-05, "training_step": 11.120004671322711, "env_runner_sampling_timer": 1.6916277513314155, "learner_update_timer": 9.208622188458014, "synch_weights": 0.0014985220009157796, "restore_eval_env_runners": 6.021414113565232e-05, "evaluation_iteration": 0.21314307972918856, "synch_eval_env_connectors": 0.00018795474528386375, "synch_env_connectors": 5.809866774701512e-06}, "env_runners": {"weights_seq_no": 5.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 7.339860412786386e-05, "remove_single_ts_time_rank_from_batch": 1.7773066539739722e-05, "tensor_to_numpy": 2.5168683488219594e-05, "un_batch_to_individual_items": 9.394273784166621e-06, "normalize_and_clip_actions": 1.2734983508177338e-05, "listify_data_for_vector_env": 1.6335309056808467e-05}}, "connector_pipeline_timer": 0.00019265048387063}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 7.389366547448432e-06, "add_states_from_episodes_to_batch": 3.7764653277082414e-06, "add_time_dim_to_batch_and_zero_pad": 1.0782698641461167e-05, "batch_individual_items": 1.8239081464765092e-05, "numpy_to_tensor": 2.3150555571205547e-05}}, "connector_pipeline_timer": 9.397565098524144e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -123000.0, "env_reset_timer": 6.51469968133768e-05, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "episode_duration_sec_mean": 0.008764163645915687, "episode_return_min": -9.5, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "episode_len_max": 20, "env_step_timer": 2.474260509808448e-05, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -2460000.0, "episode_return_max": 10.5, "episode_len_min": 20, "sample": 0.008377906669025536, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": -0.22}, "time_between_sampling": 0.04409583787854298, "rlmodule_inference_timer": 5.637136773805999e-05, "episode_return_mean": -0.22, "module_episode_returns_mean": {"default_policy": -0.22}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 2515.184525201698}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17792804180438657, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009984377952292142, "add_observations_from_episodes_to_batch": 0.0008667419554258685, "add_columns_from_episodes_to_train_batch": 0.04367463454751928, "add_time_dim_to_batch_and_zero_pad": 0.10532322375534449, "add_states_from_episodes_to_batch": 0.003643866068286593, "batch_individual_items": 0.014179628275215926, "numpy_to_tensor": 7.557879716618412e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.20402579009532928, "num_module_steps_trained_lifetime": 215784, "policy_loss": -4.175559297436848e-05, "diff_num_grad_updates_vs_sampler_policy": 31.0, "weights_seq_no": 36.0, "entropy": 0.6908460259437561, "mean_kl_loss": 1.466637087332856e-07, "vf_loss": 0.2633121609687805, "vf_loss_unclipped": 40.280399322509766, "vf_explained_var": -0.001501321792602539, "num_module_steps_trained": 35964, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0}, "__all_modules__": {"num_module_steps_trained": 71928, "num_env_steps_trained_lifetime": 1134000, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 431568, "num_env_steps_trained_lifetime_throughput": 48091.58693036418}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 215784, "diff_num_grad_updates_vs_sampler_policy": 31.0, "weights_seq_no": 36.0}}}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 35964, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 6.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime_throughput": 531.3086267847094}, "default_policy": {"entropy": 0.6908493041992188, "mean_kl_loss": 1.439986903051249e-07, "vf_loss_unclipped": 40.26971435546875, "curr_entropy_coeff": 0.0015431216992, "vf_explained_var": 0.00026112794876098633, "num_module_steps_trained": 5994, "curr_kl_coeff": 0.0025247489102184772, "vf_loss": 0.2632581293582916, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.2039819210767746, "num_module_steps_trained_lifetime": 35964, "policy_loss": -4.355162673164159e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 6.0, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 531.3036961391175}, "IntrinsicAttentionMask": [[[0.33459359407424927, 0.3347688317298889, 0.3306375741958618], [0.3348442018032074, 0.33505454659461975, 0.3301011919975281], [0.3288344442844391, 0.32822710275650024, 0.34293845295906067]], [[0.3338598906993866, 0.3356059193611145, 0.3305341601371765], [0.3357841670513153, 0.3444399833679199, 0.3197758197784424], [0.32964202761650085, 0.31874340772628784, 0.3516145348548889]], [[0.33311301469802856, 0.33301591873168945, 0.333871066570282], [0.33319196105003357, 0.3331296145915985, 0.33367839455604553], [0.33249619603157043, 0.33212876319885254, 0.33537501096725464]], [[0.33647772669792175, 0.32982900738716125, 0.3336932361125946], [0.3095702528953552, 0.3605664074420929, 0.3298633098602295], [0.32519954442977905, 0.3425044119358063, 0.3322960138320923]], [[0.33919212222099304, 0.3305693566799164, 0.3302385210990906], [0.3235940933227539, 0.33791813254356384, 0.33848777413368225], [0.322995126247406, 0.3381997048854828, 0.3388051986694336]], [[0.3793773353099823, 0.25490376353263855, 0.36571890115737915], [0.07156191766262054, 0.8386447429656982, 0.08979324251413345], [0.349371999502182, 0.3055473566055298, 0.345080703496933]]], "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 189000, "num_module_steps_trained_lifetime": 71928, "num_env_steps_trained_lifetime_throughput": 2792.1560538868353, "num_module_steps_trained_throughput": 29729712.999118198, "num_module_steps_trained_lifetime_throughput": 14601810.578764308}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4448839049496397e-05, "un_batch_to_individual_items": 6.542680474696078e-06, "listify_data_for_vector_env": 1.0215540355485437e-05, "remove_single_ts_time_rank_from_batch": 1.1804804046526337e-05, "normalize_and_clip_actions": 7.82038145170994e-06, "get_actions": 3.526440203366478e-05}}, "connector_pipeline_timer": 0.00011204680285424503}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2534963384519033e-05, "add_observations_from_episodes_to_batch": 2.7833435267731414e-06, "add_time_dim_to_batch_and_zero_pad": 6.6860600217782055e-06, "numpy_to_tensor": 1.1841735750313472e-05, "add_states_from_episodes_to_batch": 2.7315958875649187e-06}}, "connector_pipeline_timer": 5.842478719820565e-05}, "num_env_steps_sampled": 400, "episode_return_max": 14.5, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394470474, "num_episodes_lifetime": 120, "env_reset_timer": 0.0005399568416319902, "episode_duration_sec_mean": 0.005190338337561115, "env_step_timer": 1.3716850202577886e-05, "episode_return_mean": 0.45, "env_to_module_sum_episodes_length_out": 10.368238394470474, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.19080425027346398, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "weights_seq_no": 6.0, "module_episode_returns_mean": {"default_policy": 0.45}, "agent_episode_returns_mean": {"default_agent": 0.45}, "episode_return_min": -12.5, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 30400, "episode_len_min": 20, "rlmodule_inference_timer": 3.072276339202311e-05, "time_between_sampling": 11.172098913274409}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "ba9d3_00000", "date": "2025-08-11_18-27-18", "timestamp": 1754929638, "time_this_iter_s": 11.6714928150177, "time_total_s": 69.66020727157593, "pid": 11057, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386e458a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 69.66020727157593, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 44.175, "ram_util_percent": 82.36250000000001}}
{"timers": {"training_iteration": 11.121565926704218, "restore_env_runners": 2.8814462710322747e-05, "training_step": 11.121318370448726, "env_runner_sampling_timer": 1.6952034108980338, "learner_update_timer": 9.20609857865275, "synch_weights": 0.0015021888705452574, "restore_eval_env_runners": 6.007491943077452e-05, "evaluation_iteration": 0.21224186393258385, "synch_eval_env_connectors": 0.00018754852802515566, "synch_env_connectors": 5.79842853209595e-06}, "env_runners": {"weights_seq_no": 6.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 5.307430699105539e-05, "remove_single_ts_time_rank_from_batch": 1.4953132475313636e-05, "tensor_to_numpy": 1.898028582881476e-05, "un_batch_to_individual_items": 7.727614556654719e-06, "normalize_and_clip_actions": 9.55687048640131e-06, "listify_data_for_vector_env": 1.259797387067136e-05}}, "connector_pipeline_timer": 0.00014806167594882608}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.264779947587638e-06, "add_states_from_episodes_to_batch": 3.2427325684233474e-06, "add_time_dim_to_batch_and_zero_pad": 8.549904905119118e-06, "batch_individual_items": 1.4799276921246752e-05, "numpy_to_tensor": 1.651923485458341e-05}}, "connector_pipeline_timer": 7.29398324085174e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -153875.0, "env_reset_timer": 6.150610262830988e-05, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "episode_duration_sec_mean": 0.006502582990564405, "episode_return_min": -9.5, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "episode_len_max": 20, "env_step_timer": 1.9181842238169173e-05, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -3077500.0, "episode_return_max": 10.5, "episode_len_min": 20, "sample": 0.00777456924995907, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": -1.0199999999999996}, "time_between_sampling": 0.03834815853970222, "rlmodule_inference_timer": 4.031310814662709e-05, "episode_return_mean": -1.0199999999999996, "module_episode_returns_mean": {"default_policy": -1.0199999999999996}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 2753.4801911266673}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17800333554629458, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009983287512613046, "add_observations_from_episodes_to_batch": 0.0008675332865908143, "add_columns_from_episodes_to_train_batch": 0.04364990986205721, "add_time_dim_to_batch_and_zero_pad": 0.10539997693805721, "add_states_from_episodes_to_batch": 0.003656294077716784, "batch_individual_items": 0.01419042865265496, "numpy_to_tensor": 7.572592992307165e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.20393863320350647, "num_module_steps_trained_lifetime": 251748, "policy_loss": -0.00013685777958016843, "diff_num_grad_updates_vs_sampler_policy": 36.0, "weights_seq_no": 42.0, "entropy": 0.6913264393806458, "mean_kl_loss": 1.695661194389686e-05, "vf_loss": 0.26331979036331177, "vf_loss_unclipped": 37.64631652832031, "vf_explained_var": -0.0015251636505126953, "num_module_steps_trained": 35964, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0}, "__all_modules__": {"num_module_steps_trained": 71928, "num_env_steps_trained_lifetime": 1323000, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 503496, "num_env_steps_trained_lifetime_throughput": 47228.70051945563}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 251748, "diff_num_grad_updates_vs_sampler_policy": 36.0, "weights_seq_no": 42.0}}}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 41958, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 7.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime_throughput": 534.1112900893177}, "default_policy": {"entropy": 0.691331148147583, "mean_kl_loss": 1.742482345434837e-05, "vf_loss_unclipped": 37.579673767089844, "curr_entropy_coeff": 0.0015431216992, "vf_explained_var": 5.316734313964844e-05, "num_module_steps_trained": 5994, "curr_kl_coeff": 0.0012623744551092386, "vf_loss": 0.2632830739021301, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.20390444993972778, "num_module_steps_trained_lifetime": 41958, "policy_loss": -0.00013974588364362717, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 7.0, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 534.1066358925232}, "IntrinsicAttentionMask": [[[0.3290920853614807, 0.33579906821250916, 0.33510884642601013], [0.32699155807495117, 0.33702269196510315, 0.3359857499599457], [0.32720544934272766, 0.33689799904823303, 0.33589649200439453]], [[0.3338598906993866, 0.3356059193611145, 0.3305341601371765], [0.3357841372489929, 0.34443995356559753, 0.3197758197784424], [0.32964202761650085, 0.31874343752861023, 0.3516145348548889]], [[0.33901894092559814, 0.33804643154144287, 0.322934627532959], [0.338813453912735, 0.3378768265247345, 0.32330965995788574], [0.33552995324134827, 0.33515915274620056, 0.3293108642101288]], [[0.33647772669792175, 0.32982900738716125, 0.3336932361125946], [0.3095702528953552, 0.3605664074420929, 0.3298633098602295], [0.32519954442977905, 0.3425044119358063, 0.3322960138320923]], [[0.33366715908050537, 0.33333322405815125, 0.3329996168613434], [0.33363234996795654, 0.33333325386047363, 0.3330344259738922], [0.3335975110530853, 0.33333325386047363, 0.33306920528411865]], [[0.3654947280883789, 0.26060572266578674, 0.3738996088504791], [0.13275885581970215, 0.7490584254264832, 0.11818268150091171], [0.37692198157310486, 0.23386795818805695, 0.3892101049423218]]], "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 220500, "num_module_steps_trained_lifetime": 83916, "num_env_steps_trained_lifetime_throughput": 2806.8853735763496, "num_module_steps_trained_throughput": 28842867.33867223, "num_module_steps_trained_lifetime_throughput": 14476934.722049488}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4710754461256366e-05, "un_batch_to_individual_items": 6.6153057391598425e-06, "listify_data_for_vector_env": 1.0249874208986102e-05, "remove_single_ts_time_rank_from_batch": 1.1858614285002621e-05, "normalize_and_clip_actions": 7.844828414452421e-06, "get_actions": 3.525322215472411e-05}}, "connector_pipeline_timer": 0.00011255532418849482}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.24457011786372e-05, "add_observations_from_episodes_to_batch": 2.8162012169984583e-06, "add_time_dim_to_batch_and_zero_pad": 6.8099547844802545e-06, "numpy_to_tensor": 1.1880569401692542e-05, "add_states_from_episodes_to_batch": 2.7318908527251253e-06}}, "connector_pipeline_timer": 5.856325673709371e-05}, "num_env_steps_sampled": 400, "episode_return_max": 14.5, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394572801, "num_episodes_lifetime": 140, "env_reset_timer": 0.0005382806030801127, "episode_duration_sec_mean": 0.005198397502535954, "env_step_timer": 1.3680855314742364e-05, "episode_return_mean": 0.85, "env_to_module_sum_episodes_length_out": 10.368238394572801, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.1900530290204807, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "weights_seq_no": 7.0, "module_episode_returns_mean": {"default_policy": 0.85}, "agent_episode_returns_mean": {"default_agent": 0.85}, "episode_return_min": -12.5, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 35400, "episode_len_min": 20, "rlmodule_inference_timer": 3.0612658488131594e-05, "time_between_sampling": 11.173183938731398}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "ba9d3_00000", "date": "2025-08-11_18-27-29", "timestamp": 1754929649, "time_this_iter_s": 11.379503965377808, "time_total_s": 81.03971123695374, "pid": 11057, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386e458a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 81.03971123695374, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 42.92941176470589, "ram_util_percent": 81.88823529411765}}
{"timers": {"training_iteration": 11.133613689937052, "restore_env_runners": 2.8640909176953426e-05, "training_step": 11.133365856744694, "env_runner_sampling_timer": 1.702263136789193, "learner_update_timer": 9.211019182866435, "synch_weights": 0.0015066099017143687, "restore_eval_env_runners": 5.9875420090360886e-05, "evaluation_iteration": 0.21136630195384015, "synch_eval_env_connectors": 0.00018854221360249752, "synch_env_connectors": 5.7871046719164445e-06}, "env_runners": {"weights_seq_no": 7.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 6.025796169299996e-05, "remove_single_ts_time_rank_from_batch": 1.4407601227870848e-05, "tensor_to_numpy": 2.0380033872868003e-05, "un_batch_to_individual_items": 8.109307044456412e-06, "normalize_and_clip_actions": 1.0135413455972488e-05, "listify_data_for_vector_env": 1.377474441758866e-05}}, "connector_pipeline_timer": 0.0001603949090600571}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.6193604615644234e-06, "add_states_from_episodes_to_batch": 3.388976127478615e-06, "add_time_dim_to_batch_and_zero_pad": 9.437249905703613e-06, "batch_individual_items": 1.5993227312080618e-05, "numpy_to_tensor": 1.7918530296264363e-05}}, "connector_pipeline_timer": 7.750968693176449e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -184750.0, "env_reset_timer": 6.225095412460767e-05, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "episode_duration_sec_mean": 0.008441292000468822, "episode_return_min": -9.5, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "episode_len_max": 20, "env_step_timer": 1.9777428837965275e-05, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -3695000.0, "episode_return_max": 10.5, "episode_len_min": 20, "sample": 0.008023056414940622, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": -0.54}, "time_between_sampling": 0.03812239745063525, "rlmodule_inference_timer": 0.00011173666896221437, "episode_return_mean": -0.54, "module_episode_returns_mean": {"default_policy": -0.54}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 2652.855285083}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17795973302045534, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009976156717051248, "add_observations_from_episodes_to_batch": 0.0008688346140920077, "add_columns_from_episodes_to_train_batch": 0.04362973992307083, "add_time_dim_to_batch_and_zero_pad": 0.10537204341931009, "add_states_from_episodes_to_batch": 0.003658305717042775, "batch_individual_items": 0.014198815616448562, "numpy_to_tensor": 7.603574976185167e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.20341497659683228, "num_module_steps_trained_lifetime": 287712, "policy_loss": -0.0006433571106754243, "diff_num_grad_updates_vs_sampler_policy": 41.0, "weights_seq_no": 48.0, "entropy": 0.6917940378189087, "mean_kl_loss": 4.1573559428798035e-05, "vf_loss": 0.263293594121933, "vf_loss_unclipped": 39.09020233154297, "vf_explained_var": -0.0013481378555297852, "num_module_steps_trained": 35964, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0}, "__all_modules__": {"num_module_steps_trained": 71928, "num_env_steps_trained_lifetime": 1512000, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 575424, "num_env_steps_trained_lifetime_throughput": 46352.425083633505}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 287712, "diff_num_grad_updates_vs_sampler_policy": 41.0, "weights_seq_no": 48.0}}}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 47952, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 8.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime_throughput": 536.6971865340487}, "default_policy": {"entropy": 0.6918110847473145, "mean_kl_loss": 4.465660822461359e-05, "vf_loss_unclipped": 39.05954360961914, "curr_entropy_coeff": 0.0015431216992, "vf_explained_var": 0.0001398324966430664, "num_module_steps_trained": 5994, "curr_kl_coeff": 0.0006311872275546193, "vf_loss": 0.26326116919517517, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.20335952937602997, "num_module_steps_trained_lifetime": 47952, "policy_loss": -0.0006668399437330663, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 8.0, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 536.6928134354852}, "IntrinsicAttentionMask": [[[0.3346644341945648, 0.3245525360107422, 0.3407830595970154], [0.333668977022171, 0.3311885595321655, 0.33514246344566345], [0.33521726727485657, 0.32066163420677185, 0.3441210985183716]], [[0.35635995864868164, 0.3132791817188263, 0.3303607702255249], [0.3285753130912781, 0.33758288621902466, 0.33384183049201965], [0.33992037177085876, 0.32751113176345825, 0.3325684666633606]], [[0.33166420459747314, 0.3319419026374817, 0.33639392256736755], [0.3314555585384369, 0.3317676782608032, 0.33677682280540466], [0.32812178134918213, 0.3289772570133209, 0.3429009020328522]], [[0.3351278007030487, 0.3325177729129791, 0.33235448598861694], [0.3290727734565735, 0.33526715636253357, 0.33566009998321533], [0.32869425415992737, 0.33543872833251953, 0.3358669579029083]], [[0.33976390957832336, 0.3186268210411072, 0.34160923957824707], [0.33389124274253845, 0.33206281065940857, 0.3340458869934082], [0.34025105834007263, 0.3175069987773895, 0.34224197268486023]], [[0.3159119486808777, 0.3742614686489105, 0.3098265826702118], [0.10757783055305481, 0.8070557713508606, 0.0853663831949234], [0.3374466598033905, 0.3234638571739197, 0.3390895128250122]]], "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 252000, "num_module_steps_trained_lifetime": 95904, "num_env_steps_trained_lifetime_throughput": 2820.475580067382, "num_module_steps_trained_throughput": 27993087.993359767, "num_module_steps_trained_lifetime_throughput": 14353242.772476349}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.687743679961511e-05, "un_batch_to_individual_items": 7.627376910975795e-06, "listify_data_for_vector_env": 1.1504704582036197e-05, "remove_single_ts_time_rank_from_batch": 1.2938376146322782e-05, "normalize_and_clip_actions": 9.02330321426448e-06, "get_actions": 4.183237960642954e-05}}, "connector_pipeline_timer": 0.0001285868791206372}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.4326491468551802e-05, "add_observations_from_episodes_to_batch": 3.032696351584674e-06, "add_time_dim_to_batch_and_zero_pad": 7.609338442956036e-06, "numpy_to_tensor": 1.370819343017461e-05, "add_states_from_episodes_to_batch": 2.9513134282135874e-06}}, "connector_pipeline_timer": 6.576413263477915e-05}, "num_env_steps_sampled": 400, "episode_return_max": 14.5, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.3682383945743, "num_episodes_lifetime": 160, "env_reset_timer": 0.0005378815474541016, "episode_duration_sec_mean": 0.005306652945000679, "env_step_timer": 1.6044952628047617e-05, "episode_return_mean": 1.45, "env_to_module_sum_episodes_length_out": 10.3682383945743, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.1894114441406486, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "weights_seq_no": 8.0, "module_episode_returns_mean": {"default_policy": 1.45}, "agent_episode_returns_mean": {"default_agent": 1.45}, "episode_return_min": -12.5, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 40400, "episode_len_min": 20, "rlmodule_inference_timer": 3.5664012526914066e-05, "time_between_sampling": 11.185015083514942}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "ba9d3_00000", "date": "2025-08-11_18-27-42", "timestamp": 1754929662, "time_this_iter_s": 12.464550018310547, "time_total_s": 93.50426125526428, "pid": 11057, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386e458a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 93.50426125526428, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 52.27058823529413, "ram_util_percent": 82.3}}
{"timers": {"training_iteration": 11.138611845948441, "restore_env_runners": 2.844991990371934e-05, "training_step": 11.138364056097405, "env_runner_sampling_timer": 1.7007963679204692, "learner_update_timer": 9.216324628538587, "synch_weights": 0.0015080529726427183, "restore_eval_env_runners": 5.981041617019515e-05, "evaluation_iteration": 0.21060240143433265, "synch_eval_env_connectors": 0.00018840179194807807, "synch_env_connectors": 5.772153626048435e-06}, "env_runners": {"weights_seq_no": 8.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.010208715277516e-05, "remove_single_ts_time_rank_from_batch": 1.2088194461511523e-05, "tensor_to_numpy": 1.544825939319109e-05, "un_batch_to_individual_items": 6.6369363903532526e-06, "normalize_and_clip_actions": 8.210218276919413e-06, "listify_data_for_vector_env": 1.0608421570996605e-05}}, "connector_pipeline_timer": 0.00011975224746626901}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8248753926734746e-06, "add_states_from_episodes_to_batch": 2.784412739617867e-06, "add_time_dim_to_batch_and_zero_pad": 6.978240675741081e-06, "batch_individual_items": 1.2495820086984678e-05, "numpy_to_tensor": 1.2878497153406441e-05}}, "connector_pipeline_timer": 6.0100709327316424e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -215625.0, "env_reset_timer": 5.202121318450215e-05, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "episode_duration_sec_mean": 0.005329625627957284, "episode_return_min": -9.5, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "episode_len_max": 20, "env_step_timer": 1.4121327860730236e-05, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -4312500.0, "episode_return_max": 10.5, "episode_len_min": 20, "sample": 0.00707224139424789, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": -0.06}, "time_between_sampling": 0.04066530036317512, "rlmodule_inference_timer": 3.200945016986202e-05, "episode_return_mean": -0.06, "module_episode_returns_mean": {"default_policy": -0.06}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3191.12078315281}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17904406610980386, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009971323480389729, "add_observations_from_episodes_to_batch": 0.0008700608579968974, "add_columns_from_episodes_to_train_batch": 0.0436161825239074, "add_time_dim_to_batch_and_zero_pad": 0.10533830590421392, "add_states_from_episodes_to_batch": 0.0036596593201006443, "batch_individual_items": 0.015333452050675371, "numpy_to_tensor": 7.596456165622287e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.20383459329605103, "num_module_steps_trained_lifetime": 323676, "policy_loss": -0.00020177180704195052, "diff_num_grad_updates_vs_sampler_policy": 46.0, "weights_seq_no": 54.0, "entropy": 0.6921051144599915, "mean_kl_loss": 1.5243170309986454e-05, "vf_loss": 0.2632714807987213, "vf_loss_unclipped": 37.91233444213867, "vf_explained_var": -0.0013083219528198242, "num_module_steps_trained": 35964, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0}, "__all_modules__": {"num_module_steps_trained": 71928, "num_env_steps_trained_lifetime": 1701000, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 647352, "num_env_steps_trained_lifetime_throughput": 45477.33765911999}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 323676, "diff_num_grad_updates_vs_sampler_policy": 46.0, "weights_seq_no": 54.0}}}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 53946, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 9.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime_throughput": 539.0645145815654}, "default_policy": {"entropy": 0.6921126246452332, "mean_kl_loss": 1.6179690646822564e-05, "vf_loss_unclipped": 37.861572265625, "curr_entropy_coeff": 0.0015431216992, "vf_explained_var": 0.00031256675720214844, "num_module_steps_trained": 5994, "curr_kl_coeff": 0.00031559361377730966, "vf_loss": 0.2632836103439331, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.2038351148366928, "num_module_steps_trained_lifetime": 53946, "policy_loss": -0.00020822591613978148, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 9.0, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 539.0604204812129}, "IntrinsicAttentionMask": [[[0.34041664004325867, 0.3301309645175934, 0.32945239543914795], [0.33504924178123474, 0.3325585722923279, 0.3323921859264374], [0.33469077944755554, 0.33272045850753784, 0.33258873224258423]], [[0.3470194935798645, 0.3312787413597107, 0.3217017650604248], [0.34102684259414673, 0.3322126567363739, 0.32676050066947937], [0.33726102113723755, 0.3327723443508148, 0.32996663451194763]], [[0.3466927409172058, 0.34569820761680603, 0.30760911107063293], [0.3462161421775818, 0.34525904059410095, 0.30852484703063965], [0.32628196477890015, 0.32676371932029724, 0.3469543159008026]], [[0.33647769689559937, 0.32982900738716125, 0.3336932361125946], [0.3095702826976776, 0.3605664074420929, 0.3298633098602295], [0.32519957423210144, 0.3425044119358063, 0.3322960138320923]], [[0.34153327345848083, 0.32897332310676575, 0.3294934332370758], [0.3287222683429718, 0.33578935265541077, 0.33548831939697266], [0.3292574882507324, 0.33550411462783813, 0.33523833751678467]], [[0.3159119486808777, 0.3742614984512329, 0.3098265826702118], [0.10757768154144287, 0.8070560097694397, 0.08536628633737564], [0.3374466598033905, 0.3234638571739197, 0.3390895128250122]]], "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 283500, "num_module_steps_trained_lifetime": 107892, "num_env_steps_trained_lifetime_throughput": 2832.917136385883, "num_module_steps_trained_throughput": 27191248.626746114, "num_module_steps_trained_lifetime_throughput": 14248019.936484199}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5486564333602778e-05, "un_batch_to_individual_items": 6.898299503873071e-06, "listify_data_for_vector_env": 1.0758539001695577e-05, "remove_single_ts_time_rank_from_batch": 1.2216509122997409e-05, "normalize_and_clip_actions": 8.550077735789186e-06, "get_actions": 4.045620150603284e-05}}, "connector_pipeline_timer": 0.00012120984103480592}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2899911675819445e-05, "add_observations_from_episodes_to_batch": 2.9488190074586777e-06, "add_time_dim_to_batch_and_zero_pad": 7.02194779698417e-06, "numpy_to_tensor": 1.2769759554518635e-05, "add_states_from_episodes_to_batch": 2.779827355863099e-06}}, "connector_pipeline_timer": 6.05226007343269e-05}, "num_env_steps_sampled": 400, "episode_return_max": 14.5, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 180, "env_reset_timer": 0.0005358573209687291, "episode_duration_sec_mean": 0.005350139186484739, "env_step_timer": 1.4797598034465317e-05, "episode_return_mean": 0.85, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.1887042305389173, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "weights_seq_no": 9.0, "module_episode_returns_mean": {"default_policy": 0.85}, "agent_episode_returns_mean": {"default_agent": 0.85}, "episode_return_min": -12.5, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 45400, "episode_len_min": 20, "rlmodule_inference_timer": 3.381510620796718e-05, "time_between_sampling": 11.189792910179532}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "ba9d3_00000", "date": "2025-08-11_18-27-54", "timestamp": 1754929674, "time_this_iter_s": 11.764439105987549, "time_total_s": 105.26870036125183, "pid": 11057, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386e458a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 105.26870036125183, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 55.129411764705885, "ram_util_percent": 80.92941176470589}}
{"timers": {"training_iteration": 11.132031035819061, "restore_env_runners": 2.829459048916844e-05, "training_step": 11.13178302886697, "env_runner_sampling_timer": 1.6991939959116882, "learner_update_timer": 9.211317906413147, "synch_weights": 0.0015126832728634349, "restore_eval_env_runners": 5.962356193853225e-05, "evaluation_iteration": 0.2097750911706423, "synch_eval_env_connectors": 0.000188108603371201, "synch_env_connectors": 5.7506826568516396e-06}, "env_runners": {"weights_seq_no": 9.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.944530938289619e-05, "remove_single_ts_time_rank_from_batch": 1.210195246701469e-05, "tensor_to_numpy": 1.5295379824596225e-05, "un_batch_to_individual_items": 6.641280900581391e-06, "normalize_and_clip_actions": 8.091361586102908e-06, "listify_data_for_vector_env": 1.0626342636276266e-05}}, "connector_pipeline_timer": 0.00011866271780118153}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.816361769882083e-06, "add_states_from_episodes_to_batch": 2.781283553871306e-06, "add_time_dim_to_batch_and_zero_pad": 7.02683197159471e-06, "batch_individual_items": 1.2670393583868232e-05, "numpy_to_tensor": 1.2582249631121249e-05}}, "connector_pipeline_timer": 5.989184835424858e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -246500.0, "env_reset_timer": 4.013878225481614e-05, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "episode_duration_sec_mean": 0.005292925826739522, "episode_return_min": -9.5, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "episode_len_max": 20, "env_step_timer": 1.398157024910029e-05, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -4930000.0, "episode_return_max": 10.5, "episode_len_min": 20, "sample": 0.005777470922071529, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": -0.38000000000000006}, "time_between_sampling": 0.04136821979485072, "rlmodule_inference_timer": 3.203179874153434e-05, "episode_return_mean": -0.38000000000000006, "module_episode_returns_mean": {"default_policy": -0.38000000000000006}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3234.5325109179216}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17899797002892587, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00995884857574703, "add_observations_from_episodes_to_batch": 0.0008700552492682148, "add_columns_from_episodes_to_train_batch": 0.04358714069854085, "add_time_dim_to_batch_and_zero_pad": 0.10535710243529083, "add_states_from_episodes_to_batch": 0.003661468136913731, "batch_individual_items": 0.015308747110308732, "numpy_to_tensor": 7.60774162804634e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.20378732681274414, "num_module_steps_trained_lifetime": 359640, "policy_loss": -0.00024215706798713654, "diff_num_grad_updates_vs_sampler_policy": 51.0, "weights_seq_no": 60.0, "entropy": 0.6923344135284424, "mean_kl_loss": 1.4494738024950493e-05, "vf_loss": 0.2632632851600647, "vf_loss_unclipped": 38.203250885009766, "vf_explained_var": -0.0012146234512329102, "num_module_steps_trained": 35964, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0}, "__all_modules__": {"num_module_steps_trained": 71928, "num_env_steps_trained_lifetime": 1890000, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 719280, "num_env_steps_trained_lifetime_throughput": 44616.80943881789}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 359640, "diff_num_grad_updates_vs_sampler_policy": 51.0, "weights_seq_no": 60.0}}}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 59940, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 10.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime_throughput": 542.0811197116316}, "default_policy": {"entropy": 0.6923423409461975, "mean_kl_loss": 1.5593393982271664e-05, "vf_loss_unclipped": 38.161293029785156, "curr_entropy_coeff": 0.0015431216992, "vf_explained_var": 0.00019055604934692383, "num_module_steps_trained": 5994, "curr_kl_coeff": 0.00015779680688865483, "vf_loss": 0.2632644474506378, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.20377673208713531, "num_module_steps_trained_lifetime": 59940, "policy_loss": -0.0002513147483114153, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 10.0, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 542.0772864492053}, "IntrinsicAttentionMask": [[[0.33459359407424927, 0.3347688317298889, 0.3306375741958618], [0.3348442316055298, 0.33505457639694214, 0.3301011621952057], [0.3288344442844391, 0.32822710275650024, 0.3429384231567383]], [[0.33283621072769165, 0.33457687497138977, 0.3325868546962738], [0.3308927118778229, 0.33942240476608276, 0.32968491315841675], [0.33311349153518677, 0.33388349413871765, 0.3330030143260956]], [[0.3323127031326294, 0.33461838960647583, 0.3330689072608948], [0.32365867495536804, 0.34562113881111145, 0.33072012662887573], [0.3294644057750702, 0.33821865916252136, 0.33231696486473083]], [[0.33783790469169617, 0.33116233348846436, 0.3309997320175171], [0.2999541461467743, 0.3493662178516388, 0.3506796956062317], [0.2990528345108032, 0.34979769587516785, 0.35114946961402893]], [[0.34153327345848083, 0.32897329330444336, 0.3294934332370758], [0.3287222683429718, 0.33578935265541077, 0.33548831939697266], [0.3292575180530548, 0.33550411462783813, 0.33523833751678467]], [[0.3159119486808777, 0.3742615282535553, 0.3098265826702118], [0.10757731646299362, 0.8070566058158875, 0.08536598086357117], [0.3374466598033905, 0.3234638273715973, 0.3390894830226898]]], "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 315000, "num_module_steps_trained_lifetime": 119880, "num_env_steps_trained_lifetime_throughput": 2848.770729544165, "num_module_steps_trained_throughput": 26419506.67471147, "num_module_steps_trained_lifetime_throughput": 14147705.732255377}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5437746705449146e-05, "un_batch_to_individual_items": 6.920939062636844e-06, "listify_data_for_vector_env": 1.06096571840728e-05, "remove_single_ts_time_rank_from_batch": 1.2274094069724154e-05, "normalize_and_clip_actions": 8.262581184967053e-06, "get_actions": 4.00694181983282e-05}}, "connector_pipeline_timer": 0.00012027055758055922}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.3215898614068549e-05, "add_observations_from_episodes_to_batch": 2.9237938844936945e-06, "add_time_dim_to_batch_and_zero_pad": 7.008691632438572e-06, "numpy_to_tensor": 1.3405528715356838e-05, "add_states_from_episodes_to_batch": 2.7862644289581463e-06}}, "connector_pipeline_timer": 6.17052251450331e-05}, "num_env_steps_sampled": 400, "episode_return_max": 14.5, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 200, "env_reset_timer": 0.0005356220882837749, "episode_duration_sec_mean": 0.005441844160668552, "env_step_timer": 1.5003545115122676e-05, "episode_return_mean": 0.45, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.18805302198363452, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "weights_seq_no": 10.0, "module_episode_returns_mean": {"default_policy": 0.45}, "agent_episode_returns_mean": {"default_agent": 0.45}, "episode_return_min": -12.5, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 50400, "episode_len_min": 20, "rlmodule_inference_timer": 3.403143210465855e-05, "time_between_sampling": 11.183066108157258}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "ba9d3_00000", "date": "2025-08-11_18-28-04", "timestamp": 1754929684, "time_this_iter_s": 10.618138790130615, "time_total_s": 115.88683915138245, "pid": 11057, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386e458a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 115.88683915138245, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 45.626666666666665, "ram_util_percent": 81.98666666666666}}
{"timers": {"training_iteration": 11.134181167130796, "restore_env_runners": 2.8144973888211927e-05, "training_step": 11.13393281648749, "env_runner_sampling_timer": 1.6987909484527204, "learner_update_timer": 9.213735009849215, "synch_weights": 0.0015182093599096756, "restore_eval_env_runners": 5.971232571430879e-05, "evaluation_iteration": 0.20902023858912144, "synch_eval_env_connectors": 0.00018781584724313302, "synch_env_connectors": 5.727755837478596e-06}, "env_runners": {"weights_seq_no": 10.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.407173622761078e-05, "remove_single_ts_time_rank_from_batch": 1.266958891673621e-05, "tensor_to_numpy": 1.619355357977176e-05, "un_batch_to_individual_items": 6.8966977825861995e-06, "normalize_and_clip_actions": 8.536955749124627e-06, "listify_data_for_vector_env": 1.1084097906041385e-05}}, "connector_pipeline_timer": 0.00012729828609603662}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.0761851068584843e-06, "add_states_from_episodes_to_batch": 2.8766677201974105e-06, "add_time_dim_to_batch_and_zero_pad": 7.379351248986216e-06, "batch_individual_items": 1.3118559498185904e-05, "numpy_to_tensor": 1.3729339844050696e-05}}, "connector_pipeline_timer": 6.324659803118414e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -277375.0, "env_reset_timer": 4.4799979721630486e-05, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "episode_duration_sec_mean": 0.005667172987014053, "episode_return_min": -9.5, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "episode_len_max": 20, "env_step_timer": 1.5245956013889752e-05, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -5547500.0, "episode_return_max": 10.5, "episode_len_min": 20, "sample": 0.005875537274037948, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": -0.4600000000000001}, "time_between_sampling": 0.03727706969036059, "rlmodule_inference_timer": 3.449187830565763e-05, "episode_return_mean": -0.4600000000000001, "module_episode_returns_mean": {"default_policy": -0.4600000000000001}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3080.6292557783813}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1790382244976653, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009949745510067599, "add_observations_from_episodes_to_batch": 0.0008698071965265342, "add_columns_from_episodes_to_train_batch": 0.04359844012142152, "add_time_dim_to_batch_and_zero_pad": 0.10540715932084412, "add_states_from_episodes_to_batch": 0.0036695184557132003, "batch_individual_items": 0.015289451299397136, "numpy_to_tensor": 7.60608119284456e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.20387759804725647, "num_module_steps_trained_lifetime": 395604, "policy_loss": -0.00015946818166412413, "diff_num_grad_updates_vs_sampler_policy": 56.0, "weights_seq_no": 66.0, "entropy": 0.6925455927848816, "mean_kl_loss": 1.2170585250714794e-05, "vf_loss": 0.2632738947868347, "vf_loss_unclipped": 37.04375457763672, "vf_explained_var": -0.0011744499206542969, "num_module_steps_trained": 35964, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0}, "__all_modules__": {"num_module_steps_trained": 71928, "num_env_steps_trained_lifetime": 2079000, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 791208, "num_env_steps_trained_lifetime_throughput": 43776.925291584914}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 395604, "diff_num_grad_updates_vs_sampler_policy": 56.0, "weights_seq_no": 66.0}}}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 65934, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 11.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime_throughput": 544.6276650226526}, "default_policy": {"entropy": 0.6925504803657532, "mean_kl_loss": 1.2884269381174818e-05, "vf_loss_unclipped": 36.988121032714844, "curr_entropy_coeff": 0.0015431216992, "vf_explained_var": 2.1457672119140625e-05, "num_module_steps_trained": 5994, "curr_kl_coeff": 7.889840344432741e-05, "vf_loss": 0.26325979828834534, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.2038600891828537, "num_module_steps_trained_lifetime": 65934, "policy_loss": -0.00016401693574152887, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 11.0, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 544.6240758434999}, "IntrinsicAttentionMask": [[[0.33604004979133606, 0.33189308643341064, 0.33206692337989807], [0.3233337700366974, 0.3386635184288025, 0.3380027115345001], [0.32386448979377747, 0.33838027715682983, 0.3377552926540375]], [[0.3322365880012512, 0.3287692368030548, 0.33899426460266113], [0.33430686593055725, 0.3375801742076874, 0.32811301946640015], [0.3277430236339569, 0.3119683265686035, 0.3602885901927948]], [[0.34706032276153564, 0.322345107793808, 0.3305945098400116], [0.3342202603816986, 0.3326158821582794, 0.3331638276576996], [0.3385894000530243, 0.3290969431400299, 0.332313597202301]], [[0.34372809529304504, 0.32183489203453064, 0.33443695306777954], [0.31666305661201477, 0.3522970676422119, 0.3310399055480957], [0.33239084482192993, 0.3343881368637085, 0.3332210183143616]], [[0.33640557527542114, 0.33606889843940735, 0.3275255262851715], [0.3360862135887146, 0.3357849419116974, 0.3281288146972656], [0.32778945565223694, 0.32837632298469543, 0.3438342213630676]], [[0.3654947280883789, 0.26060566306114197, 0.3738996088504791], [0.13275890052318573, 0.7490583658218384, 0.1181827038526535], [0.37692198157310486, 0.23386789858341217, 0.3892101049423218]]], "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 346500, "num_module_steps_trained_lifetime": 131868, "num_env_steps_trained_lifetime_throughput": 2862.1535894218923, "num_module_steps_trained_throughput": 25668827.08024607, "num_module_steps_trained_lifetime_throughput": 14044023.132527873}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.54956363786178e-05, "un_batch_to_individual_items": 6.794549475219743e-06, "listify_data_for_vector_env": 1.0571310382514096e-05, "remove_single_ts_time_rank_from_batch": 1.222706258710972e-05, "normalize_and_clip_actions": 8.237256459691768e-06, "get_actions": 3.747118676887843e-05}}, "connector_pipeline_timer": 0.00011759185206859196}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2840284026182365e-05, "add_observations_from_episodes_to_batch": 2.9923406762053927e-06, "add_time_dim_to_batch_and_zero_pad": 6.9830382769517375e-06, "numpy_to_tensor": 1.239610850611741e-05, "add_states_from_episodes_to_batch": 2.759139364071492e-06}}, "connector_pipeline_timer": 6.0192385768308976e-05}, "num_env_steps_sampled": 400, "episode_return_max": 14.5, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 220, "env_reset_timer": 0.0005337933669034619, "episode_duration_sec_mean": 0.005484154977602884, "env_step_timer": 1.4404255192304859e-05, "episode_return_mean": -0.15, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.1873622121837322, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "weights_seq_no": 11.0, "module_episode_returns_mean": {"default_policy": -0.15}, "agent_episode_returns_mean": {"default_agent": -0.15}, "episode_return_min": -12.5, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 55400, "episode_len_min": 20, "rlmodule_inference_timer": 3.2291393801536736e-05, "time_between_sampling": 11.185054321656004}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "ba9d3_00000", "date": "2025-08-11_18-28-16", "timestamp": 1754929696, "time_this_iter_s": 11.48184871673584, "time_total_s": 127.36868786811829, "pid": 11057, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386e458a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 127.36868786811829, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 44.01764705882353, "ram_util_percent": 81.60000000000001}}
{"timers": {"training_iteration": 11.137711542958911, "restore_env_runners": 2.7972694945679452e-05, "training_step": 11.137463461652676, "env_runner_sampling_timer": 1.6999434639680673, "learner_update_timer": 9.215926390170234, "synch_weights": 0.0015156793463510037, "restore_eval_env_runners": 5.960520153165458e-05, "evaluation_iteration": 0.20823130912333024, "synch_eval_env_connectors": 0.00019016851842496317, "synch_env_connectors": 5.707977982570702e-06}, "env_runners": {"weights_seq_no": 11.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.7763765527951444e-05, "remove_single_ts_time_rank_from_batch": 1.374809680757995e-05, "tensor_to_numpy": 1.744599479528587e-05, "un_batch_to_individual_items": 7.2946100584017675e-06, "normalize_and_clip_actions": 9.252950860234414e-06, "listify_data_for_vector_env": 1.191902515002215e-05}}, "connector_pipeline_timer": 0.00013699545482544927}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.414297477774038e-06, "add_states_from_episodes_to_batch": 3.0762756070079365e-06, "add_time_dim_to_batch_and_zero_pad": 8.109950348492052e-06, "batch_individual_items": 1.5000685031165858e-05, "numpy_to_tensor": 1.5181260493684983e-05}}, "connector_pipeline_timer": 6.965553333670417e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -308250.0, "env_reset_timer": 5.037103799732498e-05, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "episode_duration_sec_mean": 0.006218827802222224, "episode_return_min": -9.5, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "episode_len_max": 20, "env_step_timer": 1.6224620758682947e-05, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -6165000.0, "episode_return_max": 10.5, "episode_len_min": 20, "sample": 0.006444621639986476, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": -0.7800000000000001}, "time_between_sampling": 0.03972655545063156, "rlmodule_inference_timer": 3.7717046909841956e-05, "episode_return_mean": -0.7800000000000001, "module_episode_returns_mean": {"default_policy": -0.7800000000000001}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 2946.960365498653}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1791487285021843, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00994649139432482, "add_observations_from_episodes_to_batch": 0.0008724237147899903, "add_columns_from_episodes_to_train_batch": 0.04357953655029147, "add_time_dim_to_batch_and_zero_pad": 0.10548524147756727, "add_states_from_episodes_to_batch": 0.0036918520209759135, "batch_individual_items": 0.015319253865547583, "numpy_to_tensor": 7.616020453685935e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.20392069220542908, "num_module_steps_trained_lifetime": 431568, "policy_loss": -0.00010280930291628465, "diff_num_grad_updates_vs_sampler_policy": 61.0, "weights_seq_no": 72.0, "entropy": 0.692714512348175, "mean_kl_loss": 1.3767586096946616e-05, "vf_loss": 0.2632564604282379, "vf_loss_unclipped": 37.04214859008789, "vf_explained_var": -0.0011082887649536133, "num_module_steps_trained": 35964, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0}, "__all_modules__": {"num_module_steps_trained": 71928, "num_env_steps_trained_lifetime": 2268000, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 863136, "num_env_steps_trained_lifetime_throughput": 42954.187159374604}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 431568, "diff_num_grad_updates_vs_sampler_policy": 61.0, "weights_seq_no": 72.0}}}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 71928, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 12.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime_throughput": 546.9040598765313}, "default_policy": {"entropy": 0.6927164196968079, "mean_kl_loss": 1.4121811545919627e-05, "vf_loss_unclipped": 36.99174118041992, "curr_entropy_coeff": 0.0015431216992, "vf_explained_var": -1.0251998901367188e-05, "num_module_steps_trained": 5994, "curr_kl_coeff": 3.944920172216371e-05, "vf_loss": 0.26325470209121704, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.20391523838043213, "num_module_steps_trained_lifetime": 71928, "policy_loss": -0.00010467151878401637, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 12.0, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 546.9007174570397}, "IntrinsicAttentionMask": [[[0.3290920853614807, 0.33579906821250916, 0.33510884642601013], [0.32699155807495117, 0.33702269196510315, 0.3359857499599457], [0.32720547914505005, 0.33689799904823303, 0.3358965218067169]], [[0.33223655819892883, 0.3287692070007324, 0.33899423480033875], [0.33430683612823486, 0.3375801742076874, 0.32811298966407776], [0.3277430534362793, 0.3119683265686035, 0.3602885901927948]], [[0.3466927409172058, 0.34569820761680603, 0.30760908126831055], [0.3462161421775818, 0.34525904059410095, 0.3085247874259949], [0.32628196477890015, 0.32676371932029724, 0.346954345703125]], [[0.34372809529304504, 0.32183489203453064, 0.33443695306777954], [0.31666305661201477, 0.3522970378398895, 0.3310399055480957], [0.3323908746242523, 0.3343881368637085, 0.3332210183143616]], [[0.33366715908050537, 0.33333322405815125, 0.3329996168613434], [0.33363234996795654, 0.33333325386047363, 0.3330344259738922], [0.3335975110530853, 0.33333325386047363, 0.33306920528411865]], [[0.3793773353099823, 0.25490379333496094, 0.36571887135505676], [0.07156214118003845, 0.8386444449424744, 0.08979348838329315], [0.3493719696998596, 0.3055473864078522, 0.3450806736946106]]], "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 378000, "num_module_steps_trained_lifetime": 143856, "num_env_steps_trained_lifetime_throughput": 2874.1169630712634, "num_module_steps_trained_throughput": 24970699.763248883, "num_module_steps_trained_lifetime_throughput": 13964088.994686775}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4896408133870622e-05, "un_batch_to_individual_items": 6.740862820525934e-06, "listify_data_for_vector_env": 1.1689843230212712e-05, "remove_single_ts_time_rank_from_batch": 1.2031649311909076e-05, "normalize_and_clip_actions": 8.634928377086484e-06, "get_actions": 3.721405573832609e-05}}, "connector_pipeline_timer": 0.0001178992772665581}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.356009776826735e-05, "add_observations_from_episodes_to_batch": 2.877319269027895e-06, "add_time_dim_to_batch_and_zero_pad": 6.96144681039485e-06, "numpy_to_tensor": 1.2329099184894954e-05, "add_states_from_episodes_to_batch": 2.722130270466699e-06}}, "connector_pipeline_timer": 6.058489017920561e-05}, "num_env_steps_sampled": 400, "episode_return_max": 14.5, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 240, "env_reset_timer": 0.0005315054331755676, "episode_duration_sec_mean": 0.005480693313293159, "env_step_timer": 1.4316760915693887e-05, "episode_return_mean": 0.25, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.18663506006169808, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "weights_seq_no": 12.0, "module_episode_returns_mean": {"default_policy": 0.25}, "agent_episode_returns_mean": {"default_agent": 0.25}, "episode_return_min": -12.5, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 60400, "episode_len_min": 20, "rlmodule_inference_timer": 3.2523101077620707e-05, "time_between_sampling": 11.188366962608658}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "ba9d3_00000", "date": "2025-08-11_18-28-28", "timestamp": 1754929708, "time_this_iter_s": 11.61396312713623, "time_total_s": 138.98265099525452, "pid": 11057, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386e458a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 138.98265099525452, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 43.4875, "ram_util_percent": 82.6875}}
{"timers": {"training_iteration": 11.138651105448911, "restore_env_runners": 2.7764639089105408e-05, "training_step": 11.138402872036972, "env_runner_sampling_timer": 1.6990821543275112, "learner_update_timer": 9.217705487098602, "synch_weights": 0.0015161054736380966, "restore_eval_env_runners": 5.909122930314533e-05, "evaluation_iteration": 0.20738685311309296, "synch_eval_env_connectors": 0.00018971974418739563, "synch_env_connectors": 5.690057988701139e-06}, "env_runners": {"weights_seq_no": 12.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.2647820489688324e-05, "remove_single_ts_time_rank_from_batch": 1.239526036499544e-05, "tensor_to_numpy": 1.5982759294204046e-05, "un_batch_to_individual_items": 6.872336844750437e-06, "normalize_and_clip_actions": 8.355040657092395e-06, "listify_data_for_vector_env": 1.1112223724330763e-05}}, "connector_pipeline_timer": 0.00012480409553886616}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8796398388393743e-06, "add_states_from_episodes_to_batch": 2.8321966115979157e-06, "add_time_dim_to_batch_and_zero_pad": 7.230571414068793e-06, "batch_individual_items": 1.3210685442878784e-05, "numpy_to_tensor": 1.3617911932235274e-05}}, "connector_pipeline_timer": 6.245584918728646e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -339125.0, "env_reset_timer": 5.048652975068119e-05, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "episode_duration_sec_mean": 0.005519367838744072, "episode_return_min": -9.5, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "episode_len_max": 20, "env_step_timer": 1.4818336103607405e-05, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -6782500.0, "episode_return_max": 10.5, "episode_len_min": 20, "sample": 0.0061910297890234315, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 0.4200000000000001}, "time_between_sampling": 0.0398355201277357, "rlmodule_inference_timer": 3.3328518790328564e-05, "episode_return_mean": 0.4200000000000001, "module_episode_returns_mean": {"default_policy": 0.4200000000000001}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3086.7542379873757}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.17908278621651605, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009936419390394547, "add_observations_from_episodes_to_batch": 0.0008726003172446651, "add_columns_from_episodes_to_train_batch": 0.04356521160475796, "add_time_dim_to_batch_and_zero_pad": 0.10546678406261979, "add_states_from_episodes_to_batch": 0.0036949580907461753, "batch_individual_items": 0.015293113827503278, "numpy_to_tensor": 7.61711031349974e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.20371867716312408, "num_module_steps_trained_lifetime": 467532, "policy_loss": -0.00030162782059051096, "diff_num_grad_updates_vs_sampler_policy": 66.0, "weights_seq_no": 78.0, "entropy": 0.6928672194480896, "mean_kl_loss": 2.0789979316759855e-05, "vf_loss": 0.2632512152194977, "vf_loss_unclipped": 38.781742095947266, "vf_explained_var": -0.0009845495223999023, "num_module_steps_trained": 35964, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0}, "__all_modules__": {"num_module_steps_trained": 71928, "num_env_steps_trained_lifetime": 2457000, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 935064, "num_env_steps_trained_lifetime_throughput": 42152.0252329255}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 467532, "diff_num_grad_updates_vs_sampler_policy": 66.0, "weights_seq_no": 78.0}}}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 77922, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 13.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime_throughput": 549.1652071034163}, "default_policy": {"entropy": 0.6928722262382507, "mean_kl_loss": 2.2225736756809056e-05, "vf_loss_unclipped": 38.76328659057617, "curr_entropy_coeff": 0.0015431216992, "vf_explained_var": 1.3113021850585938e-06, "num_module_steps_trained": 5994, "curr_kl_coeff": 1.9724600861081854e-05, "vf_loss": 0.2632615268230438, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.2037123739719391, "num_module_steps_trained_lifetime": 77922, "policy_loss": -0.0003126186493318528, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 13.0, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 549.1621768590969}, "IntrinsicAttentionMask": [[[0.34041666984558105, 0.3301309645175934, 0.32945239543914795], [0.33504924178123474, 0.3325585424900055, 0.332392156124115], [0.33469080924987793, 0.33272048830986023, 0.3325887620449066]], [[0.3338598906993866, 0.3356059193611145, 0.3305341601371765], [0.3357841372489929, 0.34443995356559753, 0.3197758197784424], [0.32964202761650085, 0.31874343752861023, 0.35161450505256653]], [[0.34649041295051575, 0.3312912881374359, 0.3222182095050812], [0.3263204097747803, 0.3343159854412079, 0.33936360478401184], [0.314093679189682, 0.3358460068702698, 0.3500603437423706]], [[0.33138149976730347, 0.34259313344955444, 0.3260253667831421], [0.3297361433506012, 0.3500351011753082, 0.32022878527641296], [0.3321573734283447, 0.33897289633750916, 0.3288697600364685]], [[0.33294177055358887, 0.3340317904949188, 0.3330264091491699], [0.32460638880729675, 0.34895601868629456, 0.3264375627040863], [0.33229777216911316, 0.33518117666244507, 0.33252111077308655]], [[0.36438342928886414, 0.2871425151824951, 0.34847405552864075], [0.03540312871336937, 0.8996824026107788, 0.06491445004940033], [0.2784527540206909, 0.42070573568344116, 0.3008415699005127]]], "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 409500, "num_module_steps_trained_lifetime": 155844, "num_env_steps_trained_lifetime_throughput": 2886.0007546929396, "num_module_steps_trained_throughput": 24279481.741194256, "num_module_steps_trained_lifetime_throughput": 13857172.060167389}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5767689153982165e-05, "un_batch_to_individual_items": 6.857969135738517e-06, "listify_data_for_vector_env": 1.0808825016839871e-05, "remove_single_ts_time_rank_from_batch": 1.2480845528366182e-05, "normalize_and_clip_actions": 8.291655559729328e-06, "get_actions": 3.973572033248614e-05}}, "connector_pipeline_timer": 0.00012142644279979154}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.3283653045207576e-05, "add_observations_from_episodes_to_batch": 3.2090007576386923e-06, "add_time_dim_to_batch_and_zero_pad": 7.268930907839837e-06, "numpy_to_tensor": 1.293858232466344e-05, "add_states_from_episodes_to_batch": 2.852409570129365e-06}}, "connector_pipeline_timer": 6.259795969159938e-05}, "num_env_steps_sampled": 400, "episode_return_max": 14.5, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 260, "env_reset_timer": 0.0005293449581610091, "episode_duration_sec_mean": 0.005428078318946063, "env_step_timer": 1.5147943281172184e-05, "episode_return_mean": -0.75, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.18596518071123144, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "weights_seq_no": 13.0, "module_episode_returns_mean": {"default_policy": -0.75}, "agent_episode_returns_mean": {"default_agent": -0.75}, "episode_return_min": -12.5, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 65400, "episode_len_min": 20, "rlmodule_inference_timer": 3.3738232411095924e-05, "time_between_sampling": 11.189156624232542}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "ba9d3_00000", "date": "2025-08-11_18-28-39", "timestamp": 1754929719, "time_this_iter_s": 11.363952875137329, "time_total_s": 150.34660387039185, "pid": 11057, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386e458a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 150.34660387039185, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 48.775, "ram_util_percent": 81.925}}
{"timers": {"training_iteration": 11.138737413554393, "restore_env_runners": 2.7662822907842102e-05, "training_step": 11.138488454976015, "env_runner_sampling_timer": 1.6990350944533354, "learner_update_timer": 9.217849811387891, "synch_weights": 0.0015203098387682329, "restore_eval_env_runners": 5.890031656345157e-05, "evaluation_iteration": 0.20660447958127576, "synch_eval_env_connectors": 0.00018974671739233816, "synch_env_connectors": 5.6748177958831146e-06}, "env_runners": {"weights_seq_no": 13.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.9897222115699274e-05, "remove_single_ts_time_rank_from_batch": 1.204592384404561e-05, "tensor_to_numpy": 1.5393511308643794e-05, "un_batch_to_individual_items": 6.622004646284102e-06, "normalize_and_clip_actions": 8.101408261413521e-06, "listify_data_for_vector_env": 1.0701857683428815e-05}}, "connector_pipeline_timer": 0.00011928436823878074}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.822661025786848e-06, "add_states_from_episodes_to_batch": 2.7608439861044608e-06, "add_time_dim_to_batch_and_zero_pad": 6.953971291226076e-06, "batch_individual_items": 1.2485088360693997e-05, "numpy_to_tensor": 1.2751573121677531e-05}}, "connector_pipeline_timer": 5.986351998736698e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -370000.0, "env_reset_timer": 4.610610592180907e-05, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "episode_duration_sec_mean": 0.005888027672190218, "episode_return_min": -9.5, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "episode_len_max": 20, "env_step_timer": 1.407827801509571e-05, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -7400000.0, "episode_return_max": 10.5, "episode_len_min": 20, "sample": 0.006244489087607992, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 1.4600000000000006}, "time_between_sampling": 0.03962087367640235, "rlmodule_inference_timer": 6.388993221609502e-05, "episode_return_mean": 1.4600000000000006, "module_episode_returns_mean": {"default_policy": 1.4600000000000006}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3202.6770892149625}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1790057629336908, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009924046026513443, "add_observations_from_episodes_to_batch": 0.000872269734226775, "add_columns_from_episodes_to_train_batch": 0.04353993073918334, "add_time_dim_to_batch_and_zero_pad": 0.10545075914231444, "add_states_from_episodes_to_batch": 0.0036959089299773255, "batch_individual_items": 0.015269703099201584, "numpy_to_tensor": 7.617106146561129e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.2041001319885254, "num_module_steps_trained_lifetime": 503496, "policy_loss": 7.42421907489188e-05, "diff_num_grad_updates_vs_sampler_policy": 71.0, "weights_seq_no": 84.0, "entropy": 0.6929669976234436, "mean_kl_loss": 1.3539729479816742e-05, "vf_loss": 0.2632600963115692, "vf_loss_unclipped": 40.537200927734375, "vf_explained_var": -0.0008705854415893555, "num_module_steps_trained": 35964, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0}, "__all_modules__": {"num_module_steps_trained": 71928, "num_env_steps_trained_lifetime": 2646000, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 1006992, "num_env_steps_trained_lifetime_throughput": 41382.107267147876}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 503496, "diff_num_grad_updates_vs_sampler_policy": 71.0, "weights_seq_no": 84.0}}}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 83916, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 14.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime_throughput": 551.5344677150732}, "default_policy": {"entropy": 0.6929647922515869, "mean_kl_loss": 1.2930759112350643e-05, "vf_loss_unclipped": 40.55534362792969, "curr_entropy_coeff": 0.0015431216992, "vf_explained_var": -5.137920379638672e-05, "num_module_steps_trained": 5994, "curr_kl_coeff": 9.862300430540927e-06, "vf_loss": 0.26326367259025574, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.20409531891345978, "num_module_steps_trained_lifetime": 83916, "policy_loss": 6.882099114591256e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 14.0, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 551.5317109472325}, "IntrinsicAttentionMask": [[[0.34041666984558105, 0.3301309645175934, 0.32945239543914795], [0.33504924178123474, 0.3325585424900055, 0.332392156124115], [0.33469080924987793, 0.33272048830986023, 0.3325887620449066]], [[0.3465242385864258, 0.3046325147151947, 0.34884315729141235], [0.3304676115512848, 0.33952707052230835, 0.3300052881240845], [0.34732404351234436, 0.3028815984725952, 0.3497943878173828]], [[0.33166423439979553, 0.3319419026374817, 0.33639392256736755], [0.3314555287361145, 0.3317676782608032, 0.3367767930030823], [0.32812178134918213, 0.3289772570133209, 0.3429009020328522]], [[0.34372079372406006, 0.33497190475463867, 0.3213072717189789], [0.3330584168434143, 0.33328646421432495, 0.33365514874458313], [0.31598472595214844, 0.330013245344162, 0.3540019690990448]], [[0.34153324365615845, 0.32897329330444336, 0.3294934332370758], [0.3287222385406494, 0.33578935265541077, 0.33548831939697266], [0.3292574882507324, 0.33550411462783813, 0.33523833751678467]], [[0.3159119784832001, 0.37426143884658813, 0.30982664227485657], [0.10757721960544586, 0.8070569634437561, 0.0853658989071846], [0.3374467194080353, 0.3234637677669525, 0.339089572429657]]], "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 441000, "num_module_steps_trained_lifetime": 167832, "num_env_steps_trained_lifetime_throughput": 2898.452557819669, "num_module_steps_trained_throughput": 23624317.51519777, "num_module_steps_trained_lifetime_throughput": 13752203.42134676}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5854264892117123e-05, "un_batch_to_individual_items": 6.972915203286394e-06, "listify_data_for_vector_env": 1.0789812290280553e-05, "remove_single_ts_time_rank_from_batch": 1.2379457528392444e-05, "normalize_and_clip_actions": 8.320614703932012e-06, "get_actions": 4.020565959675926e-05}}, "connector_pipeline_timer": 0.00012160434773149461}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.3324498789163933e-05, "add_observations_from_episodes_to_batch": 3.191631546335781e-06, "add_time_dim_to_batch_and_zero_pad": 7.200038741932317e-06, "numpy_to_tensor": 1.3108773499442933e-05, "add_states_from_episodes_to_batch": 2.8432435258587372e-06}}, "connector_pipeline_timer": 6.239521264084473e-05}, "num_env_steps_sampled": 400, "episode_return_max": 14.5, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 280, "env_reset_timer": 0.0005271035981755663, "episode_duration_sec_mean": 0.005481686199782416, "env_step_timer": 1.4992582341626458e-05, "episode_return_mean": -0.35, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.1853534039042365, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "weights_seq_no": 14.0, "module_episode_returns_mean": {"default_policy": -0.35}, "agent_episode_returns_mean": {"default_agent": -0.35}, "episode_return_min": -12.5, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 70400, "episode_len_min": 20, "rlmodule_inference_timer": 3.328244161036897e-05, "time_between_sampling": 11.18907429548947}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "ba9d3_00000", "date": "2025-08-11_18-28-50", "timestamp": 1754929730, "time_this_iter_s": 11.285454034805298, "time_total_s": 161.63205790519714, "pid": 11057, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386e458a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 161.63205790519714, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 47.818749999999994, "ram_util_percent": 81.53125}}
{"timers": {"training_iteration": 11.143473003168653, "restore_env_runners": 2.7535774397472674e-05, "training_step": 11.143223967086662, "env_runner_sampling_timer": 1.6998029422594731, "learner_update_timer": 9.219839517853048, "synch_weights": 0.0015216117403292159, "restore_eval_env_runners": 5.88279843866897e-05, "evaluation_iteration": 0.20588656686446452, "synch_eval_env_connectors": 0.00018972091988339376, "synch_env_connectors": 5.660569359463642e-06}, "env_runners": {"weights_seq_no": 14.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.222229175865219e-05, "remove_single_ts_time_rank_from_batch": 1.236324081525389e-05, "tensor_to_numpy": 1.59813016316163e-05, "un_batch_to_individual_items": 6.7339614920710854e-06, "normalize_and_clip_actions": 8.366674208466866e-06, "listify_data_for_vector_env": 1.0907158892425532e-05}}, "connector_pipeline_timer": 0.00012378388578861659}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8648586783636547e-06, "add_states_from_episodes_to_batch": 2.838353658928529e-06, "add_time_dim_to_batch_and_zero_pad": 7.152837861736826e-06, "batch_individual_items": 1.28541445604454e-05, "numpy_to_tensor": 1.3224040306671865e-05}}, "connector_pipeline_timer": 6.138155423134178e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -400875.0, "env_reset_timer": 4.603916529875782e-05, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "episode_duration_sec_mean": 0.00616371784545481, "episode_return_min": -9.5, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "episode_len_max": 20, "env_step_timer": 1.4619597608002768e-05, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -8017500.0, "episode_return_max": 10.5, "episode_len_min": 20, "sample": 0.006116078429060699, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 2.0200000000000005}, "time_between_sampling": 0.03901997686303107, "rlmodule_inference_timer": 6.348424000013869e-05, "episode_return_mean": 2.0200000000000005, "module_episode_returns_mean": {"default_policy": 2.0200000000000005}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3137.1350161650657}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1802021486334907, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009959614316838618, "add_observations_from_episodes_to_batch": 0.0008779370370266644, "add_columns_from_episodes_to_train_batch": 0.04414268934259856, "add_time_dim_to_batch_and_zero_pad": 0.10585592239072253, "add_states_from_episodes_to_batch": 0.003718963170753442, "batch_individual_items": 0.015389202727562197, "numpy_to_tensor": 7.939269084423833e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.2037840336561203, "num_module_steps_trained_lifetime": 539460, "policy_loss": -0.00024307162675540894, "diff_num_grad_updates_vs_sampler_policy": 76.0, "weights_seq_no": 90.0, "entropy": 0.6930693984031677, "mean_kl_loss": 2.3463688194169663e-05, "vf_loss": 0.26325979828834534, "vf_loss_unclipped": 39.657196044921875, "vf_explained_var": -0.0008244514465332031, "num_module_steps_trained": 35964, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0}, "__all_modules__": {"num_module_steps_trained": 71928, "num_env_steps_trained_lifetime": 2835000, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 1078920, "num_env_steps_trained_lifetime_throughput": 40649.036660017875}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 539460, "diff_num_grad_updates_vs_sampler_policy": 76.0, "weights_seq_no": 90.0}}}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 89910, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 15.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime_throughput": 553.7155621948011}, "default_policy": {"entropy": 0.6930713057518005, "mean_kl_loss": 2.467075319145806e-05, "vf_loss_unclipped": 39.664039611816406, "curr_entropy_coeff": 0.0015431216992, "vf_explained_var": -9.012222290039062e-05, "num_module_steps_trained": 5994, "curr_kl_coeff": 4.931150215270463e-06, "vf_loss": 0.2632603347301483, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.20377424359321594, "num_module_steps_trained_lifetime": 89910, "policy_loss": -0.00024948760983534157, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 15.0, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 553.7130476569278}, "IntrinsicAttentionMask": [[[0.33465278148651123, 0.3414731025695801, 0.3238741457462311], [0.3352522552013397, 0.3455367982387543, 0.3192109167575836], [0.33359915018081665, 0.33489692211151123, 0.3315039277076721]], [[0.334328293800354, 0.3308390974998474, 0.3348326086997986], [0.3324034512042999, 0.33565816283226013, 0.33193841576576233], [0.33460286259651184, 0.3301495313644409, 0.33524760603904724]], [[0.3367938995361328, 0.33620694279670715, 0.3269991874694824], [0.33658742904663086, 0.33603590726852417, 0.32737669348716736], [0.33328819274902344, 0.3332957625389099, 0.33341604471206665]], [[0.3482988178730011, 0.3261144459247589, 0.3255867063999176], [0.30979102849960327, 0.3446516990661621, 0.345557302236557], [0.3088732063770294, 0.34509193897247314, 0.34603485465049744]], [[0.33259329199790955, 0.3336821496486664, 0.3337245583534241], [0.31715285778045654, 0.3409433960914612, 0.3419037163257599], [0.3165602385997772, 0.3412214517593384, 0.342218279838562]], [[0.3159119486808777, 0.37426137924194336, 0.3098266124725342], [0.10757668316364288, 0.807057797908783, 0.08536545187234879], [0.3374467194080353, 0.32346367835998535, 0.33908960223197937]]], "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 472500, "num_module_steps_trained_lifetime": 179820, "num_env_steps_trained_lifetime_throughput": 2909.915391091522, "num_module_steps_trained_throughput": 23009522.43014654, "num_module_steps_trained_lifetime_throughput": 13666043.998352233}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5003352533261553e-05, "un_batch_to_individual_items": 6.786865154297721e-06, "listify_data_for_vector_env": 1.0346053647074495e-05, "remove_single_ts_time_rank_from_batch": 1.2026527520432262e-05, "normalize_and_clip_actions": 8.063542250363003e-06, "get_actions": 3.777619439809843e-05}}, "connector_pipeline_timer": 0.00011606134263294923}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2867793534737888e-05, "add_observations_from_episodes_to_batch": 2.8616260973709284e-06, "add_time_dim_to_batch_and_zero_pad": 6.858521111089048e-06, "numpy_to_tensor": 1.2575243631046427e-05, "add_states_from_episodes_to_batch": 3.0729474774829464e-06}}, "connector_pipeline_timer": 6.071990535209086e-05}, "num_env_steps_sampled": 400, "episode_return_max": 14.5, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 300, "env_reset_timer": 0.0005250429824484285, "episode_duration_sec_mean": 0.005410679540364072, "env_step_timer": 1.4493483981364547e-05, "episode_return_mean": -0.15, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.18465527320542946, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "weights_seq_no": 15.0, "module_episode_returns_mean": {"default_policy": -0.15}, "agent_episode_returns_mean": {"default_agent": -0.15}, "episode_return_min": -12.5, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 75400, "episode_len_min": 20, "rlmodule_inference_timer": 3.2495648802372165e-05, "time_between_sampling": 11.19362732961427}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "ba9d3_00000", "date": "2025-08-11_18-29-02", "timestamp": 1754929742, "time_this_iter_s": 11.740147352218628, "time_total_s": 173.37220525741577, "pid": 11057, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386e458a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 173.37220525741577, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 51.50588235294118, "ram_util_percent": 81.93529411764706}}
{"timers": {"training_iteration": 11.1400328589763, "restore_env_runners": 2.740000677344097e-05, "training_step": 11.139783803665589, "env_runner_sampling_timer": 1.6980020144971841, "learner_update_timer": 9.218168744754927, "synch_weights": 0.0015213589522299334, "restore_eval_env_runners": 5.86942947330248e-05, "evaluation_iteration": 0.20507423953616674, "synch_eval_env_connectors": 0.0001893278711483698, "synch_env_connectors": 5.648124654050835e-06}, "env_runners": {"weights_seq_no": 15.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.900509684339393e-05, "remove_single_ts_time_rank_from_batch": 1.192451758303458e-05, "tensor_to_numpy": 1.5136580690828808e-05, "un_batch_to_individual_items": 6.5397873537850825e-06, "normalize_and_clip_actions": 8.002794965028077e-06, "listify_data_for_vector_env": 1.0421909530714337e-05}}, "connector_pipeline_timer": 0.00011735566219996913}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7812543214223803e-06, "add_states_from_episodes_to_batch": 2.727094515665291e-06, "add_time_dim_to_batch_and_zero_pad": 6.833199900894159e-06, "batch_individual_items": 1.2393086514680077e-05, "numpy_to_tensor": 1.2554542049406615e-05}}, "connector_pipeline_timer": 5.916360028288962e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -431750.0, "env_reset_timer": 4.402016769976049e-05, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "episode_duration_sec_mean": 0.005220010336488484, "episode_return_min": -9.5, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "episode_len_max": 20, "env_step_timer": 1.3786797042008392e-05, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -8635000.0, "episode_return_max": 10.5, "episode_len_min": 20, "sample": 0.006152748152060339, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": -0.4600000000000001}, "time_between_sampling": 0.04032678247270435, "rlmodule_inference_timer": 3.144012812271449e-05, "episode_return_mean": -0.4600000000000001, "module_episode_returns_mean": {"default_policy": -0.4600000000000001}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3255.0815689954893}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.18018332505698223, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009945977763011888, "add_observations_from_episodes_to_batch": 0.0008780551674675424, "add_columns_from_episodes_to_train_batch": 0.04411751494931734, "add_time_dim_to_batch_and_zero_pad": 0.10588550816720974, "add_states_from_episodes_to_batch": 0.0037246285394021196, "batch_individual_items": 0.015374364030344808, "numpy_to_tensor": 7.941917297669404e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.20376472175121307, "num_module_steps_trained_lifetime": 575424, "policy_loss": -0.0002606298658065498, "diff_num_grad_updates_vs_sampler_policy": 81.0, "weights_seq_no": 96.0, "entropy": 0.6931167244911194, "mean_kl_loss": 1.3171974387660157e-05, "vf_loss": 0.26325976848602295, "vf_loss_unclipped": 38.4831428527832, "vf_explained_var": -0.0008072853088378906, "num_module_steps_trained": 35964, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0}, "__all_modules__": {"num_module_steps_trained": 71928, "num_env_steps_trained_lifetime": 3024000, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 1150848, "num_env_steps_trained_lifetime_throughput": 39956.857174980505}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 575424, "diff_num_grad_updates_vs_sampler_policy": 81.0, "weights_seq_no": 96.0}}}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 95904, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 16.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime_throughput": 555.9361338083263}, "default_policy": {"entropy": 0.6931179761886597, "mean_kl_loss": 1.4401641237782314e-05, "vf_loss_unclipped": 38.46764373779297, "curr_entropy_coeff": 0.0015431216992, "vf_explained_var": -5.7697296142578125e-05, "num_module_steps_trained": 5994, "curr_kl_coeff": 2.4655751076352317e-06, "vf_loss": 0.2632617950439453, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.203752338886261, "num_module_steps_trained_lifetime": 95904, "policy_loss": -0.0002724450023379177, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 16.0, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 555.9338418619333}, "IntrinsicAttentionMask": [[[0.33459359407424927, 0.3347688317298889, 0.3306376039981842], [0.3348442018032074, 0.33505454659461975, 0.33010122179985046], [0.3288344442844391, 0.32822707295417786, 0.34293848276138306]], [[0.33283621072769165, 0.33457690477371216, 0.3325868546962738], [0.3308927118778229, 0.33942246437072754, 0.32968491315841675], [0.33311349153518677, 0.33388349413871765, 0.3330029845237732]], [[0.3416406810283661, 0.32665425539016724, 0.3317050039768219], [0.3288871943950653, 0.33694562315940857, 0.3341672122478485], [0.33322593569755554, 0.3334202468395233, 0.33335375785827637]], [[0.33783799409866333, 0.33116230368614197, 0.3309996724128723], [0.2999541461467743, 0.3493662178516388, 0.3506796956062317], [0.2990528345108032, 0.34979772567749023, 0.3511494994163513]], [[0.33640560507774353, 0.33606892824172974, 0.3275255262851715], [0.336086243391037, 0.3357849717140198, 0.3281288146972656], [0.3277894854545593, 0.32837632298469543, 0.3438342213630676]], [[0.3569391667842865, 0.2905052900314331, 0.3525555431842804], [0.07653403282165527, 0.8351313471794128, 0.08833466470241547], [0.3392081558704376, 0.3226037323474884, 0.33818817138671875]]], "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 504000, "num_module_steps_trained_lifetime": 191808, "num_env_steps_trained_lifetime_throughput": 2921.585605283255, "num_module_steps_trained_throughput": 22407816.36478022, "num_module_steps_trained_lifetime_throughput": 13563617.176741531}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.6511495754896226e-05, "un_batch_to_individual_items": 7.228627815562088e-06, "listify_data_for_vector_env": 1.136558845796958e-05, "remove_single_ts_time_rank_from_batch": 1.4015391600810193e-05, "normalize_and_clip_actions": 8.809868387671174e-06, "get_actions": 4.346664159311069e-05}}, "connector_pipeline_timer": 0.00013015828563122604}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.5916573814771565e-05, "add_observations_from_episodes_to_batch": 3.474910046762009e-06, "add_time_dim_to_batch_and_zero_pad": 8.267491845749534e-06, "numpy_to_tensor": 1.624337030958257e-05, "add_states_from_episodes_to_batch": 3.2276836979054122e-06}}, "connector_pipeline_timer": 7.210118372732714e-05}, "num_env_steps_sampled": 400, "episode_return_max": 14.5, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 320, "env_reset_timer": 0.0005227088030018376, "episode_duration_sec_mean": 0.00543589248904027, "env_step_timer": 1.5818163908981487e-05, "episode_return_mean": -0.55, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.1840179250533115, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "weights_seq_no": 16.0, "module_episode_returns_mean": {"default_policy": -0.55}, "agent_episode_returns_mean": {"default_agent": -0.55}, "episode_return_min": -12.5, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 80400, "episode_len_min": 20, "rlmodule_inference_timer": 3.7533347254151894e-05, "time_between_sampling": 11.189990243819087}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "ba9d3_00000", "date": "2025-08-11_18-29-13", "timestamp": 1754929753, "time_this_iter_s": 10.934276103973389, "time_total_s": 184.30648136138916, "pid": 11057, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386e458a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 184.30648136138916, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 40.95625, "ram_util_percent": 82.0875}}
{"timers": {"training_iteration": 11.140298812056868, "restore_env_runners": 2.727725698428377e-05, "training_step": 11.14004980103966, "env_runner_sampling_timer": 1.6983400418526606, "learner_update_timer": 9.218105623557806, "synch_weights": 0.0015194361926641655, "restore_eval_env_runners": 5.867610116878648e-05, "evaluation_iteration": 0.20433693672164976, "synch_eval_env_connectors": 0.00018879667265701914, "synch_env_connectors": 5.641643788234995e-06}, "env_runners": {"weights_seq_no": 16.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.70739172405191e-05, "remove_single_ts_time_rank_from_batch": 1.2837844252453267e-05, "tensor_to_numpy": 1.73875338307493e-05, "un_batch_to_individual_items": 7.090596693598505e-06, "normalize_and_clip_actions": 8.7849325015814e-06, "listify_data_for_vector_env": 1.1478418279680887e-05}}, "connector_pipeline_timer": 0.00013323993468164507}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.060605591042595e-06, "add_states_from_episodes_to_batch": 2.9728968560748336e-06, "add_time_dim_to_batch_and_zero_pad": 7.834258661235598e-06, "batch_individual_items": 1.3575358608781003e-05, "numpy_to_tensor": 1.4067587011073916e-05}}, "connector_pipeline_timer": 6.558009641734043e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -462625.0, "env_reset_timer": 5.172174470703537e-05, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "episode_duration_sec_mean": 0.005943346665240826, "episode_return_min": -9.5, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "episode_len_max": 20, "env_step_timer": 1.5759342265169537e-05, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -9252500.0, "episode_return_max": 10.5, "episode_len_min": 20, "sample": 0.006235609590871337, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 0.9000000000000005}, "time_between_sampling": 0.03853640011125863, "rlmodule_inference_timer": 3.573326535578865e-05, "episode_return_mean": 0.9000000000000005, "module_episode_returns_mean": {"default_policy": 0.9000000000000005}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 2997.138533394204}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1801229705568946, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009934342145382078, "add_observations_from_episodes_to_batch": 0.0008778029461562002, "add_columns_from_episodes_to_train_batch": 0.044100366879540484, "add_time_dim_to_batch_and_zero_pad": 0.10587074266549239, "add_states_from_episodes_to_batch": 0.0037273697540665856, "batch_individual_items": 0.01535524038948547, "numpy_to_tensor": 7.961748123731585e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.2038254290819168, "num_module_steps_trained_lifetime": 611388, "policy_loss": -0.00020035082707181573, "diff_num_grad_updates_vs_sampler_policy": 86.0, "weights_seq_no": 102.0, "entropy": 0.6931326985359192, "mean_kl_loss": 1.902400799735915e-05, "vf_loss": 0.2632591426372528, "vf_loss_unclipped": 37.894065856933594, "vf_explained_var": -0.0007671117782592773, "num_module_steps_trained": 35964, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0}, "__all_modules__": {"num_module_steps_trained": 71928, "num_env_steps_trained_lifetime": 3213000, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 1222776, "num_env_steps_trained_lifetime_throughput": 39301.24878432068}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 611388, "diff_num_grad_updates_vs_sampler_policy": 86.0, "weights_seq_no": 102.0}}}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 101898, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 17.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime_throughput": 558.5219302034734}, "default_policy": {"entropy": 0.6931325793266296, "mean_kl_loss": 2.0020559531985782e-05, "vf_loss_unclipped": 37.8685188293457, "curr_entropy_coeff": 0.0015431216992, "vf_explained_var": 2.3066997528076172e-05, "num_module_steps_trained": 5994, "curr_kl_coeff": 1.2327875538176158e-06, "vf_loss": 0.26326248049736023, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.2038196474313736, "num_module_steps_trained_lifetime": 101898, "policy_loss": -0.0002056406665360555, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 17.0, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 558.5198253753778}, "IntrinsicAttentionMask": [[[0.33465275168418884, 0.3414731025695801, 0.3238741159439087], [0.3352522850036621, 0.34553682804107666, 0.31921088695526123], [0.33359915018081665, 0.3348969519138336, 0.3315039277076721]], [[0.3322365880012512, 0.3287692368030548, 0.33899420499801636], [0.33430686593055725, 0.33758023381233215, 0.32811295986175537], [0.3277430832386017, 0.3119683265686035, 0.3602885901927948]], [[0.332312673330307, 0.3346184194087982, 0.3330689072608948], [0.32365867495536804, 0.3456211984157562, 0.33072009682655334], [0.3294643759727478, 0.33821865916252136, 0.33231693506240845]], [[0.3482988476753235, 0.3261144161224365, 0.3255867063999176], [0.30979105830192566, 0.3446516990661621, 0.345557302236557], [0.3088732063770294, 0.34509193897247314, 0.34603482484817505]], [[0.3474488854408264, 0.3258337080478668, 0.326717346906662], [0.3345288932323456, 0.3326970338821411, 0.3327740728855133], [0.33506885170936584, 0.33240973949432373, 0.3325214087963104]], [[0.3091419041156769, 0.37796521186828613, 0.3128929138183594], [0.05383637547492981, 0.882490336894989, 0.063673235476017], [0.289827823638916, 0.4140733778476715, 0.29609882831573486]]], "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 535500, "num_module_steps_trained_lifetime": 203796, "num_env_steps_trained_lifetime_throughput": 2935.1750227586563, "num_module_steps_trained_throughput": 21822466.57523684, "num_module_steps_trained_lifetime_throughput": 13465924.83641758}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4654036215331676e-05, "un_batch_to_individual_items": 6.521260311694921e-06, "listify_data_for_vector_env": 1.0162067335397671e-05, "remove_single_ts_time_rank_from_batch": 1.1812508564112035e-05, "normalize_and_clip_actions": 7.862539776682626e-06, "get_actions": 3.561943558046072e-05}}, "connector_pipeline_timer": 0.00011241636718530288}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2511920576222153e-05, "add_observations_from_episodes_to_batch": 2.8051583945289656e-06, "add_time_dim_to_batch_and_zero_pad": 6.654714161747746e-06, "numpy_to_tensor": 1.1994694941871383e-05, "add_states_from_episodes_to_batch": 2.7271630816197364e-06}}, "connector_pipeline_timer": 5.841878647271854e-05}, "num_env_steps_sampled": 400, "episode_return_max": 14.5, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 340, "env_reset_timer": 0.0005213483846937207, "episode_duration_sec_mean": 0.005427032090956345, "env_step_timer": 1.3743420190239996e-05, "episode_return_mean": -0.35, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.18332046538287178, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "weights_seq_no": 17.0, "module_episode_returns_mean": {"default_policy": -0.35}, "agent_episode_returns_mean": {"default_agent": -0.35}, "episode_return_min": -12.5, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 85400, "episode_len_min": 20, "rlmodule_inference_timer": 3.1208949527632414e-05, "time_between_sampling": 11.190345596790879}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "ba9d3_00000", "date": "2025-08-11_18-29-24", "timestamp": 1754929764, "time_this_iter_s": 11.293248891830444, "time_total_s": 195.5997302532196, "pid": 11057, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386e458a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 195.5997302532196, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 43.96875, "ram_util_percent": 82.13125}}
{"timers": {"training_iteration": 11.14038146601696, "restore_env_runners": 2.706115422895307e-05, "training_step": 11.140132598869707, "env_runner_sampling_timer": 1.698061838103925, "learner_update_timer": 9.218427526912865, "synch_weights": 0.0015203276610218064, "restore_eval_env_runners": 5.8255589385740005e-05, "evaluation_iteration": 0.20352887651381646, "synch_eval_env_connectors": 0.00018829287595789867, "synch_env_connectors": 5.621477917416334e-06}, "env_runners": {"weights_seq_no": 17.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.4028438704367565e-05, "remove_single_ts_time_rank_from_batch": 1.2766062208093839e-05, "tensor_to_numpy": 1.647590999864625e-05, "un_batch_to_individual_items": 7.077285130941954e-06, "normalize_and_clip_actions": 8.56494710034848e-06, "listify_data_for_vector_env": 1.1176928498033168e-05}}, "connector_pipeline_timer": 0.00012824072512690143}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.0013566536292747e-06, "add_states_from_episodes_to_batch": 2.974092887128423e-06, "add_time_dim_to_batch_and_zero_pad": 7.519122365401219e-06, "batch_individual_items": 1.3403568229443413e-05, "numpy_to_tensor": 1.3882308318178609e-05}}, "connector_pipeline_timer": 6.401404613118427e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -493500.0, "env_reset_timer": 4.8835594264627e-05, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "episode_duration_sec_mean": 0.005716606543865056, "episode_return_min": -9.5, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "episode_len_max": 20, "env_step_timer": 1.5334173446765355e-05, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -9870000.0, "episode_return_max": 10.5, "episode_len_min": 20, "sample": 0.006034906852002449, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 0.9800000000000004}, "time_between_sampling": 0.03882092293182687, "rlmodule_inference_timer": 3.464250555744723e-05, "episode_return_mean": 0.9800000000000004, "module_episode_returns_mean": {"default_policy": 0.9800000000000004}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3036.8563224785084}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.18007913835049394, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00993155122396387, "add_observations_from_episodes_to_batch": 0.0008776574166520954, "add_columns_from_episodes_to_train_batch": 0.044090610290722844, "add_time_dim_to_batch_and_zero_pad": 0.10586294314894044, "add_states_from_episodes_to_batch": 0.003728500216239456, "batch_individual_items": 0.01533139590572282, "numpy_to_tensor": 7.948380623085505e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.20398521423339844, "num_module_steps_trained_lifetime": 647352, "policy_loss": -3.69857152691111e-05, "diff_num_grad_updates_vs_sampler_policy": 91.0, "weights_seq_no": 108.0, "entropy": 0.6931251287460327, "mean_kl_loss": 4.059821094415383e-06, "vf_loss": 0.26325762271881104, "vf_loss_unclipped": 39.38157272338867, "vf_explained_var": -0.0006810426712036133, "num_module_steps_trained": 35964, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0}, "__all_modules__": {"num_module_steps_trained": 71928, "num_env_steps_trained_lifetime": 3402000, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 1294704, "num_env_steps_trained_lifetime_throughput": 38680.73417920102}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 647352, "diff_num_grad_updates_vs_sampler_policy": 91.0, "weights_seq_no": 108.0}}}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 107892, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 18.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime_throughput": 560.89469224356}, "default_policy": {"entropy": 0.6931250095367432, "mean_kl_loss": 4.1296416384284385e-06, "vf_loss_unclipped": 39.386871337890625, "curr_entropy_coeff": 0.0015431216992, "vf_explained_var": -0.00017464160919189453, "num_module_steps_trained": 5994, "curr_kl_coeff": 6.163937769088079e-07, "vf_loss": 0.26326072216033936, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.20398561656475067, "num_module_steps_trained_lifetime": 107892, "policy_loss": -3.833750815829262e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 18.0, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 560.8928273996822}, "IntrinsicAttentionMask": [[[0.3346644341945648, 0.3245525062084198, 0.34078308939933777], [0.333668977022171, 0.33118849992752075, 0.33514246344566345], [0.33521726727485657, 0.3206615746021271, 0.34412112832069397]], [[0.33386602997779846, 0.3325180113315582, 0.33361589908599854], [0.33226266503334045, 0.3349740207195282, 0.33276328444480896], [0.33356916904449463, 0.33297234773635864, 0.3334585130214691]], [[0.33901897072792053, 0.33804646134376526, 0.3229345977306366], [0.3388134837150574, 0.3378768563270569, 0.32330963015556335], [0.33552998304367065, 0.33515918254852295, 0.3293108344078064]], [[0.3298337459564209, 0.3349219858646393, 0.33524420857429504], [0.3238276541233063, 0.3376425802707672, 0.3385297656059265], [0.32345229387283325, 0.3378123641014099, 0.3387353718280792]], [[0.3364083468914032, 0.32785630226135254, 0.3357353210449219], [0.3281227946281433, 0.3426472544670105, 0.3292299509048462], [0.3357684016227722, 0.3289949595928192, 0.33523666858673096]], [[0.37937718629837036, 0.25490397214889526, 0.3657187819480896], [0.07156157493591309, 0.8386456966400146, 0.08979280292987823], [0.34937185049057007, 0.3055476248264313, 0.34508058428764343]]], "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 567000, "num_module_steps_trained_lifetime": 215784, "num_env_steps_trained_lifetime_throughput": 2947.6452889524303, "num_module_steps_trained_throughput": 21269082.5122615, "num_module_steps_trained_lifetime_throughput": 13364919.466220792}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4493776055079416e-05, "un_batch_to_individual_items": 6.606051705529446e-06, "listify_data_for_vector_env": 1.0218409788490887e-05, "remove_single_ts_time_rank_from_batch": 1.1788505917638803e-05, "normalize_and_clip_actions": 7.84231373275862e-06, "get_actions": 3.5389378863863285e-05}}, "connector_pipeline_timer": 0.00011223687275217313}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.264885775000462e-05, "add_observations_from_episodes_to_batch": 2.803090601924905e-06, "add_time_dim_to_batch_and_zero_pad": 6.725843175672176e-06, "numpy_to_tensor": 1.1937801150083558e-05, "add_states_from_episodes_to_batch": 2.799275083293087e-06}}, "connector_pipeline_timer": 5.8954122816695384e-05}, "num_env_steps_sampled": 400, "episode_return_max": 14.5, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 360, "env_reset_timer": 0.0005195503203340662, "episode_duration_sec_mean": 0.005373142062453553, "env_step_timer": 1.3622909033051198e-05, "episode_return_mean": -0.75, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.18262668030845586, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "weights_seq_no": 18.0, "module_episode_returns_mean": {"default_policy": -0.75}, "agent_episode_returns_mean": {"default_agent": -0.75}, "episode_return_min": -12.5, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 90400, "episode_len_min": 20, "rlmodule_inference_timer": 3.076257960520364e-05, "time_between_sampling": 11.190215035404051}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "ba9d3_00000", "date": "2025-08-11_18-29-36", "timestamp": 1754929776, "time_this_iter_s": 11.27536416053772, "time_total_s": 206.87509441375732, "pid": 11057, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386e458a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 206.87509441375732, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 38.9875, "ram_util_percent": 81.00625000000001}}
{"timers": {"training_iteration": 11.13235769677728, "restore_env_runners": 2.686096347898987e-05, "training_step": 11.132109127880865, "env_runner_sampling_timer": 1.6975691447219774, "learner_update_timer": 9.210951932473236, "synch_weights": 0.0015178027242561578, "restore_eval_env_runners": 5.809886327682725e-05, "evaluation_iteration": 0.20272584357864212, "synch_eval_env_connectors": 0.00018790244750349546, "synch_env_connectors": 5.60026224059622e-06}, "env_runners": {"weights_seq_no": 18.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.880055426105683e-05, "remove_single_ts_time_rank_from_batch": 1.1939581461127167e-05, "tensor_to_numpy": 1.5162415249728772e-05, "un_batch_to_individual_items": 6.556536573101063e-06, "normalize_and_clip_actions": 8.012821023232858e-06, "listify_data_for_vector_env": 1.0549629119854626e-05}}, "connector_pipeline_timer": 0.00011739543047226418}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7854803378366373e-06, "add_states_from_episodes_to_batch": 2.7785280715687195e-06, "add_time_dim_to_batch_and_zero_pad": 6.9213445861773855e-06, "batch_individual_items": 1.2352357931689751e-05, "numpy_to_tensor": 1.234218137653368e-05}}, "connector_pipeline_timer": 5.9055731344480564e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -524375.0, "env_reset_timer": 4.211895285973504e-05, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "episode_duration_sec_mean": 0.005734597667120395, "episode_return_min": -9.5, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "episode_len_max": 20, "env_step_timer": 1.3835075024949646e-05, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -10487500.0, "episode_return_max": 10.5, "episode_len_min": 20, "sample": 0.006252315037454092, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 0.17999999999999997}, "time_between_sampling": 0.03898773556936624, "rlmodule_inference_timer": 5.9670527240861304e-05, "episode_return_mean": 0.17999999999999997, "module_episode_returns_mean": {"default_policy": 0.17999999999999997}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3250.3586090904473}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1799896298868485, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009918942371946494, "add_observations_from_episodes_to_batch": 0.0008770716731893993, "add_columns_from_episodes_to_train_batch": 0.04406613001756889, "add_time_dim_to_batch_and_zero_pad": 0.10583253246759446, "add_states_from_episodes_to_batch": 0.003728506045173532, "batch_individual_items": 0.015311050275791608, "numpy_to_tensor": 7.92302190884697e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.20399153232574463, "num_module_steps_trained_lifetime": 683316, "policy_loss": -3.200575156370178e-05, "diff_num_grad_updates_vs_sampler_policy": 96.0, "weights_seq_no": 114.0, "entropy": 0.6930927634239197, "mean_kl_loss": 1.3315334399521817e-05, "vf_loss": 0.26325738430023193, "vf_loss_unclipped": 39.06857681274414, "vf_explained_var": -0.0006697177886962891, "num_module_steps_trained": 35964, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0}, "__all_modules__": {"num_module_steps_trained": 71928, "num_env_steps_trained_lifetime": 3591000, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 1366632, "num_env_steps_trained_lifetime_throughput": 38107.30287006603}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 683316, "diff_num_grad_updates_vs_sampler_policy": 96.0, "weights_seq_no": 114.0}}}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 113886, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 19.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime_throughput": 563.6869456168822}, "default_policy": {"entropy": 0.6930926442146301, "mean_kl_loss": 1.340084691037191e-05, "vf_loss_unclipped": 39.071922302246094, "curr_entropy_coeff": 0.0015431216992, "vf_explained_var": -0.00028717517852783203, "num_module_steps_trained": 5994, "curr_kl_coeff": 3.0819688845440396e-07, "vf_loss": 0.2632611393928528, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.20399177074432373, "num_module_steps_trained_lifetime": 113886, "policy_loss": -3.2589388865744695e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 19.0, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 563.6852942069148}, "IntrinsicAttentionMask": [[[0.3360399603843689, 0.33189311623573303, 0.3320668935775757], [0.3233337104320526, 0.3386635482311249, 0.3380027115345001], [0.3238644301891327, 0.3383803069591522, 0.33775532245635986]], [[0.33283624053001404, 0.33457693457603455, 0.3325868546962738], [0.3308926820755005, 0.33942246437072754, 0.32968488335609436], [0.3331134617328644, 0.33388349413871765, 0.3330029845237732]], [[0.333964079618454, 0.33424368500709534, 0.3317922055721283], [0.33404263854026794, 0.33435723185539246, 0.331600159406662], [0.33335044980049133, 0.3333579897880554, 0.33329156041145325]], [[0.34372085332870483, 0.33497190475463867, 0.3213071823120117], [0.3330584466457367, 0.33328646421432495, 0.33365511894226074], [0.3159847557544708, 0.3300132751464844, 0.3540019094944]], [[0.33919215202331543, 0.330569326877594, 0.3302384912967682], [0.3235941231250763, 0.33791810274124146, 0.33848774433135986], [0.3229951560497284, 0.3381996750831604, 0.3388051688671112]], [[0.36438366770744324, 0.28714218735694885, 0.3484741747379303], [0.03540292754769325, 0.899682879447937, 0.06491412967443466], [0.27845290303230286, 0.42070552706718445, 0.30084165930747986]]], "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 598500, "num_module_steps_trained_lifetime": 227772, "num_env_steps_trained_lifetime_throughput": 2962.3199316952905, "num_module_steps_trained_throughput": 20785603.111710384, "num_module_steps_trained_lifetime_throughput": 13302430.46187402}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4555585401953945e-05, "un_batch_to_individual_items": 6.578122070239192e-06, "listify_data_for_vector_env": 1.0122748469687318e-05, "remove_single_ts_time_rank_from_batch": 1.170959954547019e-05, "normalize_and_clip_actions": 7.778208969773262e-06, "get_actions": 3.506844020028669e-05}}, "connector_pipeline_timer": 0.00011160522663941017}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2362909014176898e-05, "add_observations_from_episodes_to_batch": 2.7869230052844877e-06, "add_time_dim_to_batch_and_zero_pad": 6.673793276678818e-06, "numpy_to_tensor": 1.1719833899503036e-05, "add_states_from_episodes_to_batch": 2.6699437907929887e-06}}, "connector_pipeline_timer": 5.7969251793838614e-05}, "num_env_steps_sampled": 400, "episode_return_max": 14.5, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 380, "env_reset_timer": 0.0005155152369096238, "episode_duration_sec_mean": 0.00526247667032294, "env_step_timer": 1.3518509841201162e-05, "episode_return_mean": -0.75, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.1819153960058108, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "weights_seq_no": 19.0, "module_episode_returns_mean": {"default_policy": -0.75}, "agent_episode_returns_mean": {"default_agent": -0.75}, "episode_return_min": -12.5, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 95400, "episode_len_min": 20, "rlmodule_inference_timer": 3.061436270008703e-05, "time_between_sampling": 11.181958134209319}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "ba9d3_00000", "date": "2025-08-11_18-29-46", "timestamp": 1754929786, "time_this_iter_s": 10.459423065185547, "time_total_s": 217.33451747894287, "pid": 11057, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386e458a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 217.33451747894287, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 39.86000000000001, "ram_util_percent": 76.97333333333334}}
{"timers": {"training_iteration": 11.120908701059403, "restore_env_runners": 2.6704014764283492e-05, "training_step": 11.120660448681768, "env_runner_sampling_timer": 1.6964994682748307, "learner_update_timer": 9.200613749398743, "synch_weights": 0.0015102338678751384, "restore_eval_env_runners": 5.7640795254069604e-05, "evaluation_iteration": 0.2018810388927899, "synch_eval_env_connectors": 0.00018710634396346544, "synch_env_connectors": 5.5813390623453555e-06}, "env_runners": {"weights_seq_no": 19.0, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.807471774943585e-05, "remove_single_ts_time_rank_from_batch": 1.1901144974294886e-05, "tensor_to_numpy": 1.49198591383783e-05, "un_batch_to_individual_items": 6.500191442936369e-06, "normalize_and_clip_actions": 7.942739230955526e-06, "listify_data_for_vector_env": 1.0386519854880955e-05}}, "connector_pipeline_timer": 0.0001159482835080464}, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7579030054705604e-06, "add_states_from_episodes_to_batch": 2.72501133097935e-06, "add_time_dim_to_batch_and_zero_pad": 6.780656740959776e-06, "batch_individual_items": 1.2143377662774733e-05, "numpy_to_tensor": 1.223126649182947e-05}}, "connector_pipeline_timer": 5.841443318013356e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes_lifetime": -555250.0, "env_reset_timer": 3.8497330858559145e-05, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "episode_duration_sec_mean": 0.005161434300709516, "episode_return_min": -9.5, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "episode_len_max": 20, "env_step_timer": 1.3575462896958257e-05, "num_env_steps_sampled": 5000.0, "num_env_steps_sampled_lifetime": -11105000.0, "episode_return_max": 10.5, "episode_len_min": 20, "sample": 0.0056189131196846, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 1.3799999999999994}, "time_between_sampling": 0.036298351330388216, "rlmodule_inference_timer": 3.0624570564986815e-05, "episode_return_mean": 1.3799999999999994, "module_episode_returns_mean": {"default_policy": 1.3799999999999994}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3304.656758611678}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1799093265082517, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.009907540858824428, "add_observations_from_episodes_to_batch": 0.0008765242868267245, "add_columns_from_episodes_to_train_batch": 0.0440433387176308, "add_time_dim_to_batch_and_zero_pad": 0.10580387422190154, "add_states_from_episodes_to_batch": 0.0037292597342024167, "batch_individual_items": 0.015294271853034704, "numpy_to_tensor": 7.903375729021926e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"differentiable_learners": {"intrinsic_attention_ppo_learner": {"default_policy": {"total_loss": 0.20392097532749176, "num_module_steps_trained_lifetime": 719280, "policy_loss": -9.305193816544488e-05, "diff_num_grad_updates_vs_sampler_policy": 101.0, "weights_seq_no": 120.0, "entropy": 0.6930582523345947, "mean_kl_loss": 5.288351530907676e-06, "vf_loss": 0.2632467448711395, "vf_loss_unclipped": 39.08701705932617, "vf_explained_var": -0.000626683235168457, "num_module_steps_trained": 35964, "use_intrinsic_rewards": 1.0, "module_train_batch_size_mean": 999.0}, "__all_modules__": {"num_module_steps_trained": 71928, "num_env_steps_trained_lifetime": 3780000, "num_env_steps_trained": 189000, "num_module_steps_trained_lifetime": 1438560, "num_env_steps_trained_lifetime_throughput": 37582.6919599229}, "intrinsic_reward_module": {"module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained": 35964, "num_module_steps_trained_lifetime": 719280, "diff_num_grad_updates_vs_sampler_policy": 101.0, "weights_seq_no": 120.0}}}, "intrinsic_reward_module": {"gradients_default_optimizer_global_norm": 0.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.0, "num_module_steps_trained_lifetime": 119880, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 20.0, "num_trainable_parameters": 8266, "default_optimizer_learning_rate": 0.0002715581955, "curr_entropy_coeff": 0.0015431216992, "num_module_steps_trained": 5994, "num_module_steps_trained_lifetime_throughput": 567.0794356955146}, "default_policy": {"entropy": 0.6930570006370544, "mean_kl_loss": 5.6368107834714465e-06, "vf_loss_unclipped": 39.08991241455078, "curr_entropy_coeff": 0.0015431216992, "vf_explained_var": -0.0002390146255493164, "num_module_steps_trained": 5994, "curr_kl_coeff": 1.5409844422720198e-07, "vf_loss": 0.2632559835910797, "use_intrinsic_rewards": 0.0, "module_train_batch_size_mean": 999.0, "total_loss": 0.2039242833852768, "num_module_steps_trained_lifetime": 119880, "policy_loss": -9.605335799278691e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "weights_seq_no": 20.0, "num_trainable_parameters": 16595, "num_module_steps_trained_lifetime_throughput": 567.0779699758801}, "IntrinsicAttentionMask": [[[0.33315882086753845, 0.333333283662796, 0.33350786566734314], [0.333124041557312, 0.3333333134651184, 0.33354270458221436], [0.3330892026424408, 0.33333325386047363, 0.3335774838924408]], [[0.33386602997779846, 0.33251798152923584, 0.33361589908599854], [0.33226266503334045, 0.3349740207195282, 0.33276328444480896], [0.33356916904449463, 0.33297231793403625, 0.3334585130214691]], [[0.333964079618454, 0.33424368500709534, 0.3317922055721283], [0.33404263854026794, 0.33435723185539246, 0.331600159406662], [0.33335044980049133, 0.3333579897880554, 0.33329156041145325]], [[0.33138149976730347, 0.34259307384490967, 0.3260253965854645], [0.3297361433506012, 0.35003504157066345, 0.32022881507873535], [0.3321574032306671, 0.33897286653518677, 0.3288697898387909]], [[0.3391921818256378, 0.330569326877594, 0.3302384912967682], [0.3235941529273987, 0.33791810274124146, 0.33848774433135986], [0.3229951560497284, 0.338199645280838, 0.3388051390647888]], [[0.3307245075702667, 0.33910688757896423, 0.33016857504844666], [0.10017606616020203, 0.8127977848052979, 0.08702615648508072], [0.3448343575000763, 0.30767858028411865, 0.34748706221580505]]], "__all_modules__": {"num_trainable_parameters": 24861, "num_non_trainable_parameters": 0, "num_module_steps_trained": 11988, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 630000, "num_module_steps_trained_lifetime": 239760, "num_env_steps_trained_lifetime_throughput": 2980.1488361398, "num_module_steps_trained_throughput": 20354349.501572352, "num_module_steps_trained_lifetime_throughput": 13263438.47203984}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4583252210297356e-05, "un_batch_to_individual_items": 6.5624094367298925e-06, "listify_data_for_vector_env": 1.021682732071633e-05, "remove_single_ts_time_rank_from_batch": 1.1764435559237362e-05, "normalize_and_clip_actions": 7.829881893327073e-06, "get_actions": 3.545635001447195e-05}}, "connector_pipeline_timer": 0.00011230438743855051}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2516041255100351e-05, "add_observations_from_episodes_to_batch": 2.7672845262237625e-06, "add_time_dim_to_batch_and_zero_pad": 6.635011310752318e-06, "numpy_to_tensor": 1.1739299176715163e-05, "add_states_from_episodes_to_batch": 2.6993733240147415e-06}}, "connector_pipeline_timer": 5.791723097823057e-05}, "num_env_steps_sampled": 400, "episode_return_max": 14.5, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 400, "env_reset_timer": 0.0005112038348534519, "episode_duration_sec_mean": 0.005240881647914648, "env_step_timer": 1.368875204985206e-05, "episode_return_mean": -0.35, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "sample": 0.18121850746660678, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "weights_seq_no": 20.0, "module_episode_returns_mean": {"default_policy": -0.35}, "agent_episode_returns_mean": {"default_agent": -0.35}, "episode_return_min": -12.5, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 100400, "episode_len_min": 20, "rlmodule_inference_timer": 3.1016627648948917e-05, "time_between_sampling": 11.17024317536701}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "ba9d3_00000", "date": "2025-08-11_18-29-56", "timestamp": 1754929796, "time_this_iter_s": 10.108111143112183, "time_total_s": 227.44262862205505, "pid": 11057, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x386e458a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 3, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 3}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 227.44262862205505, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 33.47857142857143, "ram_util_percent": 77.54285714285716}}
