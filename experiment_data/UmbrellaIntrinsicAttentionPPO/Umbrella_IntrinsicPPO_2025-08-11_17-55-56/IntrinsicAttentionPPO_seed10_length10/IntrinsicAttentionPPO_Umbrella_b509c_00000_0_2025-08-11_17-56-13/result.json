{"timers": {"training_iteration": 9.866952082957141, "restore_env_runners": 1.0624993592500687e-05, "training_step": 9.866743625025265, "env_runner_sampling_timer": 1.6611609999090433, "learner_update_timer": 8.029032708029263, "synch_weights": 0.0017137500690296292}, "env_runners": {"num_episodes_lifetime": 31375.0, "rlmodule_inference_timer": 3.8308316750929264e-05, "episode_duration_sec_mean": 0.005339962148107588, "module_episode_returns_mean": {"default_policy": -1.2200000000000002}, "episode_return_min": -10.5, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2886942388091374e-05, "add_states_from_episodes_to_batch": 2.73570364381255e-06, "numpy_to_tensor": 1.3215628213968297e-05, "add_observations_from_episodes_to_batch": 2.9653484495030098e-06, "add_time_dim_to_batch_and_zero_pad": 7.46571665263849e-06}}, "connector_pipeline_timer": 6.353639141994701e-05}, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0863745440535426e-05, "un_batch_to_individual_items": 6.866831362149472e-06, "tensor_to_numpy": 1.580489316445255e-05, "normalize_and_clip_actions": 1.0469570400937786e-05, "remove_single_ts_time_rank_from_batch": 1.2243898526681423e-05, "get_actions": 6.323102254922734e-05}}, "connector_pipeline_timer": 0.0001470260614143825}, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "env_step_timer": 1.5224147912021708e-05, "time_between_sampling": 0.0006887695858852565, "episode_return_mean": -1.2200000000000002, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.191744832559449, "episode_return_max": 9.5, "sample": 0.006823432353288821, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "env_reset_timer": 8.542130293927171e-05, "num_env_steps_sampled_lifetime": 627500.0, "env_to_module_sum_episodes_length_in": 10.191744832559449, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "agent_episode_returns_mean": {"default_agent": -1.2200000000000002}, "weights_seq_no": 0.0, "episode_len_mean": 20.0, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3006.3084749755053}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000, "learner_connector": {"connector_pipeline_timer": 0.13421641697641462, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008913333993405104, "add_observations_from_episodes_to_batch": 0.0009100409224629402, "add_columns_from_episodes_to_train_batch": 0.04139129095710814, "add_time_dim_to_batch_and_zero_pad": 0.07517929200548679, "add_states_from_episodes_to_batch": 0.003447582945227623, "batch_individual_items": 0.004064665990881622, "numpy_to_tensor": 7.195805665105581e-05}}}, "learner_connector_sum_episodes_length_out": 5250}, "learners": {"intrinsic_reward_module": {"num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "weights_seq_no": 1.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.9705930399, "num_module_steps_trained": 5985, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime_throughput": 802.5433832012523}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_env_steps_trained_lifetime": 198000, "num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_module_steps_trained_lifetime": 71820, "num_env_steps_trained_lifetime_throughput": 60262.915901900495}, "default_policy": {"use_intrinsic_rewards": 1.0, "policy_loss": -0.000130116255604662, "weights_seq_no": 6.0, "vf_explained_var": 0.0009845495223999023, "module_train_batch_size_mean": 997.8474438281662, "total_loss": 0.278355211019516, "num_module_steps_trained_lifetime": 35910, "diff_num_grad_updates_vs_sampler_policy": 6.0, "vf_loss_unclipped": 43.606441497802734, "mean_kl_loss": 3.500823822832899e-06, "entropy": 0.6929328441619873, "num_module_steps_trained": 35910, "vf_loss": 0.3588392436504364}, "intrinsic_reward_module": {"total_loss": 0.0, "weights_seq_no": 6.0, "num_module_steps_trained_lifetime": 35910, "diff_num_grad_updates_vs_sampler_policy": 6.0, "module_train_batch_size_mean": 997.8474438281662, "num_module_steps_trained": 35910}}}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 33000, "num_module_steps_trained_lifetime": 11970, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 33000, "num_env_steps_trained_lifetime_throughput": 4426.97469217202, "num_module_steps_trained_throughput": 31757499.75672028, "num_module_steps_trained_lifetime_throughput": 12693516.369097803}, "default_policy": {"weights_seq_no": 1.0, "vf_explained_var": -0.00033986568450927734, "module_train_batch_size_mean": 997.9705930399, "total_loss": 0.2779330909252167, "num_module_steps_trained_lifetime": 5985, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 43.60622024536133, "mean_kl_loss": 4.403667844599113e-06, "curr_kl_coeff": 0.08079196512699127, "entropy": 0.692938506603241, "num_module_steps_trained": 5985, "vf_loss": 0.3583161234855652, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "use_intrinsic_rewards": 0.0, "policy_loss": -0.0001448529801564291, "num_module_steps_trained_lifetime_throughput": 802.5268428339157}, "IntrinsicAttentionMask": [[[0.0909074991941452, 0.09078456461429596, 0.09084193408489227, 0.09098624438047409, 0.09099689871072769, 0.09096072614192963, 0.09088447690010071, 0.09089512377977371, 0.09099267423152924, 0.09086962044239044, 0.09088026732206345], [0.09090519696474075, 0.09061111509799957, 0.09074828028678894, 0.09109386056661606, 0.09111940115690231, 0.09103269129991531, 0.09085008502006531, 0.0908755511045456, 0.0911092758178711, 0.09081453084945679, 0.09083998948335648], [0.09090627729892731, 0.09069205075502396, 0.09079200029373169, 0.091043621301651, 0.09106220304965973, 0.09099909663200378, 0.09086614847183228, 0.09088470041751862, 0.09105483442544937, 0.09084025770425797, 0.09085880219936371], [0.09090892225503922, 0.09089566022157669, 0.09090185165405273, 0.09091740101575851, 0.09091854840517044, 0.09091465175151825, 0.09090643376111984, 0.09090758860111237, 0.09091809391975403, 0.0909048393368721, 0.09090597927570343], [0.09090911597013474, 0.09091069549322128, 0.09090995788574219, 0.09090810269117355, 0.09090796113014221, 0.09090842306613922, 0.09090940654277802, 0.09090927243232727, 0.09090802073478699, 0.09090960025787354, 0.09090946614742279], [0.0909084677696228, 0.09085965901613235, 0.09088244289159775, 0.0909397080540657, 0.09094393253326416, 0.09092958271503448, 0.09089933335781097, 0.09090355038642883, 0.09094225615262985, 0.09089343249797821, 0.09089765697717667], [0.09090707451105118, 0.09075208008289337, 0.09082440286874771, 0.09100638329982758, 0.09101981669664383, 0.09097419679164886, 0.09087804704904556, 0.09089145809412003, 0.09101448953151703, 0.0908593162894249, 0.09087272733449936], [0.0909072756767273, 0.09076709300279617, 0.09083250910043716, 0.09099707752466202, 0.091009221971035, 0.09096796810626984, 0.09088101983070374, 0.09089314937591553, 0.0910044014453888, 0.09086407721042633, 0.09087621420621872], [0.09090904146432877, 0.09090474247932434, 0.09090674668550491, 0.09091179072856903, 0.09091216325759888, 0.090910904109478, 0.0909082368016243, 0.09090860933065414, 0.09091201424598694, 0.09090771526098251, 0.09090808779001236], [0.09090679883956909, 0.09073112159967422, 0.09081308543682098, 0.09101938456296921, 0.09103461354970932, 0.09098288416862488, 0.09087388962507248, 0.0908891037106514, 0.09102857112884521, 0.09085266292095184, 0.09086786210536957], [0.09090700000524521, 0.09074613451957703, 0.09082119166851044, 0.09101007878780365, 0.0910240188241005, 0.09097666293382645, 0.09087686985731125, 0.0908907949924469, 0.09101849049329758, 0.09085743129253387, 0.09087134897708893]], [[0.09084389358758926, 0.09090802073478699, 0.09085788577795029, 0.0909220278263092, 0.09092902392148972, 0.09096682071685791, 0.09088587760925293, 0.09086211025714874, 0.09119270741939545, 0.09089148789644241, 0.09074008464813232], [0.09095339477062225, 0.09090974181890488, 0.09094387292861938, 0.09090021997690201, 0.09089545160531998, 0.09086975455284119, 0.09092480689287186, 0.09094099700450897, 0.09071655571460724, 0.09092099219560623, 0.09102418273687363], [0.09086780995130539, 0.09090843051671982, 0.09087667614221573, 0.09091729670763016, 0.09092172235250473, 0.09094566106796265, 0.09089440852403641, 0.09087935090065002, 0.09108860045671463, 0.09089795500040054, 0.09080204367637634], [0.09097728133201599, 0.09091007709503174, 0.09096261113882065, 0.09089541435241699, 0.09088809043169022, 0.09084855020046234, 0.09093327075242996, 0.09095817804336548, 0.09061291813850403, 0.09092739224433899, 0.09108626842498779], [0.09098920226097107, 0.09091022610664368, 0.09097195416688919, 0.09089300036430359, 0.09088438749313354, 0.09083792567253113, 0.09093748033046722, 0.09096675366163254, 0.09056112170219421, 0.09093057364225388, 0.09111730754375458], [0.0910535529255867, 0.09091102331876755, 0.09102242439985275, 0.09087993949651718, 0.0908644050359726, 0.09078061580657959, 0.09096020460128784, 0.09101303666830063, 0.0902821347117424, 0.09094773232936859, 0.09128498286008835], [0.09091562032699585, 0.0909091904759407, 0.09091421961784363, 0.09090778231620789, 0.09090708196163177, 0.09090328961610794, 0.09091140329837799, 0.090913787484169, 0.09088069200515747, 0.09091084450483322, 0.09092604368925095], [0.09087502956390381, 0.09090854972600937, 0.09088234603404999, 0.09091586619615555, 0.09091951698064804, 0.09093926846981049, 0.09089697152376175, 0.09088455140590668, 0.0910572037100792, 0.09089990705251694, 0.09082074463367462], [0.09143602102994919, 0.09091321378946304, 0.09132165461778641, 0.09079950302839279, 0.09074269980192184, 0.09043678641319275, 0.09109336137771606, 0.09128717333078384, 0.08863239735364914, 0.09104766696691513, 0.09228953719139099], [0.0909252017736435, 0.09090933203697205, 0.09092173725366592, 0.09090586751699448, 0.09090413898229599, 0.09089480340480804, 0.09091480821371078, 0.09092069417238235, 0.09083906561136246, 0.09091342240571976, 0.09095091372728348], [0.09066601097583771, 0.09090450406074524, 0.09071800857782364, 0.09095663577318192, 0.09098272025585175, 0.09112358838319778, 0.09082210063934326, 0.09073371440172195, 0.09196881949901581, 0.09084297716617584, 0.09028090536594391]], [[0.0904398187994957, 0.09091104567050934, 0.09105560183525085, 0.09074622392654419, 0.09077294170856476, 0.09101817011833191, 0.09116290509700775, 0.09118974953889847, 0.0910986065864563, 0.0907890722155571, 0.09081581234931946], [0.09083696454763412, 0.09090942144393921, 0.09093158692121506, 0.09088411182165146, 0.09088821709156036, 0.09092584997415543, 0.09094801545143127, 0.09095212817192078, 0.09093817323446274, 0.09089069813489914, 0.09089480340480804], [0.09095866233110428, 0.09090885519981384, 0.09089363366365433, 0.09092624485492706, 0.09092342108488083, 0.0908975750207901, 0.09088235348463058, 0.09087952971458435, 0.090889111161232, 0.09092172235250473, 0.0909188985824585], [0.09069812297821045, 0.09091002494096756, 0.09097491204738617, 0.09083597362041473, 0.09084798395633698, 0.0909581184387207, 0.0910230353474617, 0.09103506803512573, 0.0909942016005516, 0.09085523337125778, 0.09086725115776062], [0.09072064608335495, 0.0909099355340004, 0.09096788614988327, 0.09084378927946091, 0.09085451811552048, 0.09095288813114166, 0.09101086109876633, 0.09102161228656769, 0.09098511189222336, 0.0908609926700592, 0.09087172150611877], [0.09092716127634048, 0.09090901166200638, 0.09090346097946167, 0.09091534465551376, 0.09091431647539139, 0.09090489894151688, 0.09089934825897217, 0.09089832007884979, 0.09090180695056915, 0.09091369807720184, 0.09091266989707947], [0.0910489410161972, 0.09090840816497803, 0.09086547791957855, 0.09095745533704758, 0.09094949066638947, 0.09087657928466797, 0.09083367884159088, 0.09082572907209396, 0.09085272252559662, 0.09094469249248505, 0.09093672782182693], [0.09107153862714767, 0.09090830385684967, 0.09085845947265625, 0.09096527099609375, 0.09095602482557297, 0.09087134897708893, 0.0908215194940567, 0.09081229567527771, 0.09084364771842957, 0.09095044434070587, 0.09094119817018509], [0.09099484235048294, 0.09090866893529892, 0.09088234603404999, 0.0909387543797493, 0.09093387424945831, 0.09088915586471558, 0.09086283296346664, 0.09085796028375626, 0.09087452292442322, 0.09093092381954193, 0.09092605113983154], [0.09073422849178314, 0.09090987592935562, 0.09096363931894302, 0.09084850549697876, 0.09085845947265625, 0.09094972908496857, 0.09100352227687836, 0.09101349115371704, 0.09097962826490402, 0.09086446464061737, 0.09087442606687546], [0.09075676649808884, 0.09090978652238846, 0.09095662087202072, 0.09085632860660553, 0.09086499363183975, 0.09094449877738953, 0.09099135547876358, 0.0910000428557396, 0.09097054600715637, 0.09087023138999939, 0.0908789113163948]], [[0.09091144055128098, 0.09090549498796463, 0.09093690663576126, 0.09090899676084518, 0.09091074019670486, 0.09092018753290176, 0.09092193096876144, 0.09093796461820602, 0.09084471315145493, 0.09092333167791367, 0.09087832272052765], [0.09091724455356598, 0.09089649468660355, 0.09100624918937683, 0.0909087136387825, 0.09091482311487198, 0.09094779938459396, 0.09095390886068344, 0.09100993722677231, 0.09068437665700912, 0.09095881134271622, 0.09080160409212112], [0.09088600426912308, 0.09094356000423431, 0.09063972532749176, 0.09090966731309891, 0.0908927246928215, 0.09080135077238083, 0.09078443795442581, 0.09062952548265457, 0.09153471887111664, 0.09077087044715881, 0.0912073627114296], [0.09091383963823318, 0.09090180695056915, 0.09096542000770569, 0.09090889245271683, 0.09091243147850037, 0.09093154221773148, 0.09093508869409561, 0.090967558324337, 0.09077876806259155, 0.09093792736530304, 0.09084678441286087], [0.0909121111035347, 0.09090444445610046, 0.09094499796628952, 0.0909089595079422, 0.09091121703386307, 0.09092340618371964, 0.0909256637096405, 0.09094636142253876, 0.09082598239183426, 0.09092747420072556, 0.09086935967206955], [0.09090279787778854, 0.0909186601638794, 0.0908348336815834, 0.09090931713581085, 0.09090464562177658, 0.09087945520877838, 0.09087478369474411, 0.09083201736211777, 0.0910811722278595, 0.09087104350328445, 0.09099127352237701], [0.09090105444192886, 0.09092127531766891, 0.09081441909074783, 0.09090936183929443, 0.09090340882539749, 0.09087128937244415, 0.09086533635854721, 0.09081082791090012, 0.09112852066755295, 0.09086056798696518, 0.09101386368274689], [0.09088493883609772, 0.09094512462615967, 0.09062741696834564, 0.0909096822142601, 0.09089196473360062, 0.09079642593860626, 0.09077873080968857, 0.09061675518751144, 0.09156342595815659, 0.09076454490423203, 0.09122101217508316], [0.09097419679164886, 0.0908018946647644, 0.09171652048826218, 0.09090331941843033, 0.09095406532287598, 0.0912284329533577, 0.09127937257289886, 0.09174742549657822, 0.08905687928199768, 0.0913202315568924, 0.09001760929822922], [0.09089965373277664, 0.09092336893081665, 0.09079805016517639, 0.09090940654277802, 0.0909024253487587, 0.09086474776268005, 0.09085777401924133, 0.09079384058713913, 0.09116650372743607, 0.09085217863321304, 0.0910319834947586], [0.09094329178333282, 0.09085477888584137, 0.09132368117570877, 0.09090688824653625, 0.0909329503774643, 0.09107373654842377, 0.09109985083341599, 0.09133948385715485, 0.08995374292135239, 0.09112079441547394, 0.09045086055994034]], [[0.09043976664543152, 0.09091099351644516, 0.09071945399045944, 0.091082364320755, 0.09077288955450058, 0.09068216383457184, 0.09116285294294357, 0.09118969738483429, 0.09076229482889175, 0.09112537652254105, 0.09115221351385117], [0.09083696454763412, 0.09090942144393921, 0.09088001400232315, 0.09093569964170456, 0.09088821709156036, 0.09087427705526352, 0.09094801545143127, 0.09095212817192078, 0.09088659286499023, 0.09094228595495224, 0.09094639122486115], [0.09067560732364655, 0.09091011434793472, 0.09081486612558365, 0.09099524468183517, 0.09084144979715347, 0.09079631417989731, 0.09103520214557648, 0.09104852378368378, 0.09083618223667145, 0.09101660549640656, 0.09102991968393326], [0.09098122268915176, 0.09090874344110489, 0.09093815088272095, 0.09088248759508133, 0.09092994034290314, 0.09094388782978058, 0.09087017923593521, 0.0908660814166069, 0.09093156456947327, 0.09087590873241425, 0.09087180346250534], [0.09072063863277435, 0.0909099280834198, 0.09083305299282074, 0.09097862243652344, 0.09085451066493988, 0.09081807732582092, 0.09101085364818573, 0.09102160483598709, 0.09085025638341904, 0.09099584817886353, 0.09100659936666489], [0.09064417332410812, 0.09091024100780487, 0.0908021628856659, 0.09100684523582458, 0.09083232283592224, 0.09078110754489899, 0.09105218946933746, 0.09106731414794922, 0.09082634001970291, 0.09103108197450638, 0.09104619920253754], [0.0910489410161972, 0.09090840816497803, 0.09096541255712509, 0.09085752815008163, 0.09094949066638947, 0.0909765288233757, 0.09083367884159088, 0.09082572907209396, 0.09095264226198196, 0.0908447727560997, 0.09083682298660278], [0.09107152372598648, 0.09090828895568848, 0.09097450226545334, 0.09084920585155487, 0.09095600992441177, 0.09098741412162781, 0.09082150459289551, 0.09081228077411652, 0.09095967561006546, 0.09083440154790878, 0.0908251628279686], [0.09071171283721924, 0.09090997278690338, 0.09082945436239243, 0.09098192304372787, 0.09085192531347275, 0.0908137708902359, 0.09101568907499313, 0.09102694690227509, 0.09084746986627579, 0.09099996834993362, 0.09101122617721558], [0.09101741760969162, 0.09090856462717056, 0.09095272421836853, 0.09086915105581284, 0.09094039350748062, 0.09096133708953857, 0.09085066616535187, 0.09084451198577881, 0.09094283729791641, 0.09085927158594131, 0.09085310995578766], [0.0910399928689003, 0.09090845286846161, 0.09096181392669678, 0.09086082875728607, 0.09094691276550293, 0.09097222238779068, 0.09083849936723709, 0.09083105623722076, 0.09094986319541931, 0.0908488929271698, 0.09084144979715347]], [[0.09072559326887131, 0.09095478802919388, 0.09069690108299255, 0.09074562788009644, 0.09091165661811829, 0.0908341109752655, 0.09081974625587463, 0.09086853265762329, 0.09145618230104446, 0.09080823510885239, 0.09117859601974487], [0.09098703414201736, 0.09088952094316483, 0.09099926799535751, 0.09097850322723389, 0.09090784937143326, 0.09094082564115524, 0.09094693511724472, 0.09092617779970169, 0.0906774178147316, 0.0909518375992775, 0.0907946452498436], [0.09069279581308365, 0.09096290171146393, 0.090658999979496, 0.0907164067029953, 0.09091205894947052, 0.09082066267728806, 0.09080374240875244, 0.0908612385392189, 0.0915541872382164, 0.09079017490148544, 0.09122675657272339], [0.09074848890304565, 0.09094912558794022, 0.09072337299585342, 0.09076602756977081, 0.090911366045475, 0.09084349125623703, 0.09083092212677002, 0.09087362885475159, 0.0913878083229065, 0.09082084149122238, 0.09114497154951096], [0.09093790501356125, 0.09090186655521393, 0.09094242006540298, 0.09093475341796875, 0.09090864658355713, 0.0909208282828331, 0.09092308580875397, 0.09091541171073914, 0.09082340449094772, 0.09092489629983902, 0.09086678922176361], [0.09084950387477875, 0.09092400223016739, 0.0908401682972908, 0.09085602313280106, 0.09090998768806458, 0.09088478982448578, 0.09088011831045151, 0.09089598059654236, 0.09108652174472809, 0.09087637811899185, 0.0909966230392456], [0.09083310514688492, 0.0909280776977539, 0.09082121402025223, 0.09084141254425049, 0.09091021120548248, 0.09087809175252914, 0.0908721387386322, 0.09089235216379166, 0.09113533794879913, 0.09086737036705017, 0.09102067351341248], [0.09088876843452454, 0.09091418236494064, 0.09088557958602905, 0.09089098870754242, 0.09090940654277802, 0.09090080857276917, 0.09089921414852142, 0.09090462327003479, 0.09096959978342056, 0.09089793264865875, 0.09093895554542542], [0.09155573695898056, 0.09074395149946213, 0.09165799617767334, 0.09148440510034561, 0.09089602530002594, 0.09117022156715393, 0.09122112393379211, 0.09104835987091064, 0.08900005370378494, 0.09126195311546326, 0.08996016532182693], [0.09081997722387314, 0.09093135595321655, 0.0908060222864151, 0.09082971513271332, 0.090910404920578, 0.09087272733449936, 0.09086574614048004, 0.09088945388793945, 0.09117450565099716, 0.09086015075445175, 0.09103997051715851], [0.09124143421649933, 0.09082501381635666, 0.09129376709461212, 0.0912049189209938, 0.09090316295623779, 0.09104391187429428, 0.0910700112581253, 0.0909813791513443, 0.08992428332567215, 0.09109094738960266, 0.09042123705148697]]]}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"rlmodule_inference_timer": 4.066633896048417e-05, "episode_return_min": -14.5, "episode_return_mean": 0.45, "env_to_module_sum_episodes_length_out": 10.216013141322508, "env_reset_timer": 0.0007701660506427288, "num_env_steps_sampled_lifetime": 5400, "num_episodes": 20, "episode_duration_sec_mean": 0.005929325008764863, "module_episode_returns_mean": {"default_policy": 0.45}, "episode_len_min": 20, "episode_return_max": 13.5, "env_to_module_connector": {"connector_pipeline_timer": 6.918567415357937e-05, "timers": {"connectors": {"numpy_to_tensor": 1.3997103006205672e-05, "add_time_dim_to_batch_and_zero_pad": 8.669494208866903e-06, "batch_individual_items": 1.3547480792750088e-05, "add_states_from_episodes_to_batch": 2.9781852949322618e-06, "add_observations_from_episodes_to_batch": 3.555184124892925e-06}}}, "env_to_module_sum_episodes_length_in": 10.216013141322508, "episode_len_mean": 20.0, "num_episodes_lifetime": 20, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 5.148934993898057e-05, "listify_data_for_vector_env": 1.1048222459027795e-05, "un_batch_to_individual_items": 7.1350986364722855e-06, "normalize_and_clip_actions": 9.979546655212091e-06, "remove_single_ts_time_rank_from_batch": 1.3445598656262625e-05, "tensor_to_numpy": 1.9297400473185868e-05}}, "connector_pipeline_timer": 0.0001392916078835896}, "num_env_steps_sampled": 400, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "num_agent_steps_sampled": {"default_agent": 400}, "env_step_timer": 1.6882555856811906e-05, "agent_episode_returns_mean": {"default_agent": 0.45}, "sample": 0.13134645903483033, "weights_seq_no": 1.0}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "b509c_00000", "date": "2025-08-11_18-29-30", "timestamp": 1754929770, "time_this_iter_s": 10.014511108398438, "time_total_s": 10.014511108398438, "pid": 11229, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x383ebd8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.014511108398438, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 42.74666666666666, "ram_util_percent": 82.64666666666666}}
{"timers": {"training_iteration": 9.86086405670736, "restore_env_runners": 1.0597084183245897e-05, "training_step": 9.860654825435486, "env_runner_sampling_timer": 1.662780987409642, "learner_update_timer": 8.021225980528397, "synch_weights": 0.0017068238183856011, "restore_eval_env_runners": 6.65000407025218e-05, "evaluation_iteration": 0.1446910419035703, "synch_eval_env_connectors": 0.00043404195457696915, "synch_env_connectors": 5.584093742072582e-06}, "env_runners": {"num_episodes_lifetime": 500.0, "rlmodule_inference_timer": 3.497112340061157e-05, "episode_duration_sec_mean": 0.005782334330957386, "module_episode_returns_mean": {"default_policy": -0.17999999999999997}, "episode_return_min": -10.5, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.3483237945934567e-05, "add_states_from_episodes_to_batch": 2.882943786665784e-06, "numpy_to_tensor": 1.3900702922064477e-05, "add_observations_from_episodes_to_batch": 3.0528590313081148e-06, "add_time_dim_to_batch_and_zero_pad": 7.738601706242768e-06}}, "connector_pipeline_timer": 6.502429913369627e-05}, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1282583389046405e-05, "un_batch_to_individual_items": 7.044203123348441e-06, "tensor_to_numpy": 1.6478645178805702e-05, "normalize_and_clip_actions": 8.583934429054044e-06, "remove_single_ts_time_rank_from_batch": 1.3399860477028038e-05, "get_actions": 4.4199224274270936e-05}}, "connector_pipeline_timer": 0.00012970224671515014}, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "env_step_timer": 1.547128984019909e-05, "time_between_sampling": 0.03167415698512998, "episode_return_mean": -0.17999999999999997, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_max": 9.5, "sample": 0.006242429365574382, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "env_reset_timer": 5.2114493914270285e-05, "num_env_steps_sampled_lifetime": 10000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "agent_episode_returns_mean": {"default_agent": -0.17999999999999997}, "weights_seq_no": 1.0, "episode_len_mean": 20.0, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3027.2083635675067}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13422773697646334, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008914053993066773, "add_observations_from_episodes_to_batch": 0.0009092346741817891, "add_columns_from_episodes_to_train_batch": 0.04139310346799903, "add_time_dim_to_batch_and_zero_pad": 0.07518875783542171, "add_states_from_episodes_to_batch": 0.0034487883653491736, "batch_individual_items": 0.004064893909962848, "numpy_to_tensor": 7.192763616330921e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "weights_seq_no": 2.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 11970, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.9429069707118, "num_module_steps_trained": 5985, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime_throughput": 801.9863632577377}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_env_steps_trained_lifetime": 396000, "num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_module_steps_trained_lifetime": 143640, "num_env_steps_trained_lifetime_throughput": 59939.85548245827}, "default_policy": {"use_intrinsic_rewards": 1.0, "policy_loss": -0.0004590218304656446, "weights_seq_no": 12.0, "vf_explained_var": 0.000980675220489502, "module_train_batch_size_mean": 997.7412016936058, "total_loss": 0.2780055105686188, "num_module_steps_trained_lifetime": 71820, "diff_num_grad_updates_vs_sampler_policy": 11.0, "vf_loss_unclipped": 43.59756851196289, "mean_kl_loss": 4.1065904952120036e-05, "entropy": 0.6927460432052612, "num_module_steps_trained": 35910, "vf_loss": 0.3588043451309204}, "intrinsic_reward_module": {"total_loss": 0.0, "weights_seq_no": 12.0, "num_module_steps_trained_lifetime": 71820, "diff_num_grad_updates_vs_sampler_policy": 11.0, "module_train_batch_size_mean": 997.7412016936058, "num_module_steps_trained": 35910}}}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 33000, "num_module_steps_trained_lifetime": 23940, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 66000, "num_env_steps_trained_lifetime_throughput": 4423.881902703887, "num_module_steps_trained_throughput": 31302437.63288142, "num_module_steps_trained_lifetime_throughput": 12682605.766298948}, "default_policy": {"weights_seq_no": 2.0, "vf_explained_var": -0.0012263059616088867, "module_train_batch_size_mean": 997.9429069707118, "total_loss": 0.2776048481464386, "num_module_steps_trained_lifetime": 11970, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 43.65019989013672, "mean_kl_loss": 4.469967825571075e-05, "curr_kl_coeff": 0.040395982563495636, "entropy": 0.6927357912063599, "num_module_steps_trained": 5985, "vf_loss": 0.35831961035728455, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "use_intrinsic_rewards": 0.0, "policy_loss": -0.00047905754763633013, "num_module_steps_trained_lifetime_throughput": 801.9700683731122}, "IntrinsicAttentionMask": [[[0.0905311182141304, 0.09066691249608994, 0.09081108868122101, 0.09083782881498337, 0.09120121598243713, 0.09111005812883377, 0.09091810137033463, 0.09094487875699997, 0.09119056910276413, 0.09088072180747986, 0.09090748429298401], [0.09062330424785614, 0.09072603285312653, 0.09083505719900131, 0.09085526317358017, 0.0911298468708992, 0.09106099605560303, 0.09091594070196152, 0.09093617647886276, 0.09112180769443512, 0.09088769555091858, 0.09090792387723923], [0.09072109311819077, 0.09078870713710785, 0.09086042642593384, 0.09087371826171875, 0.09105421602725983, 0.0910089761018753, 0.09091362357139587, 0.09092692285776138, 0.09104893356561661, 0.09089504182338715, 0.09090834856033325], [0.09073922783136368, 0.09080032259225845, 0.0908651277422905, 0.09087713807821274, 0.09104020893573761, 0.09099933505058289, 0.09091319143772125, 0.09092520922422409, 0.09103544056415558, 0.09089640527963638, 0.09090843051671982], [0.09098532050848007, 0.09095786511898041, 0.09092877805233002, 0.09092339128255844, 0.0908503383398056, 0.09086862951517105, 0.09090722352266312, 0.09090183675289154, 0.09085247665643692, 0.09091474860906601, 0.09090936183929443], [0.09092364460229874, 0.0909184068441391, 0.09091285616159439, 0.09091182798147202, 0.09089788794517517, 0.09090138226747513, 0.09090874344110489, 0.09090771526098251, 0.0908982902765274, 0.0909101814031601, 0.09090915322303772], [0.09079362452030182, 0.09083516150712967, 0.09087921679019928, 0.09088738262653351, 0.09099818021059036, 0.09097041189670563, 0.09091188758611679, 0.09092005342245102, 0.0909949392080307, 0.0909004807472229, 0.09090864658355713], [0.09081177413463593, 0.09084678441286087, 0.09088391810655594, 0.0908908024430275, 0.09098418056964874, 0.0909607857465744, 0.09091144800186157, 0.09091833978891373, 0.09098144620656967, 0.09090184420347214, 0.0909087210893631], [0.09097812324762344, 0.0909532681107521, 0.09092693030834198, 0.090922050178051, 0.09085588902235031, 0.09087245911359787, 0.09090740233659744, 0.09090252220630646, 0.09085782617330551, 0.09091421961784363, 0.09090933948755264], [0.09076829999685287, 0.09081894159317017, 0.09087265282869339, 0.09088260680437088, 0.09101773798465729, 0.09098387509584427, 0.09091249108314514, 0.09092245250940323, 0.09101378172636032, 0.09089858084917068, 0.09090854227542877], [0.09078644216060638, 0.09083056449890137, 0.09087736159563065, 0.09088603407144547, 0.09100373834371567, 0.09097424149513245, 0.09091206640005112, 0.09092073887586594, 0.09100029617547989, 0.09089994430541992, 0.09090862423181534]], [[0.09087930619716644, 0.09102494269609451, 0.09086106717586517, 0.09100668132305145, 0.09088291972875595, 0.09083370864391327, 0.09093914926052094, 0.09097015857696533, 0.09054060280323029, 0.09093183279037476, 0.0911296159029007], [0.09094587713479996, 0.09076470881700516, 0.09096861630678177, 0.09078739583492279, 0.09094137698411942, 0.09100272506475449, 0.09087135642766953, 0.09083279222249985, 0.09136973321437836, 0.09088046103715897, 0.09063490480184555], [0.09087087959051132, 0.09105753898620605, 0.09084750711917877, 0.09103412181138992, 0.09087551385164261, 0.09081246703863144, 0.09094756841659546, 0.09098730236291885, 0.09043712913990021, 0.09093819558620453, 0.09119173139333725], [0.09093759208917618, 0.09079734236001968, 0.09095519036054611, 0.09081491827964783, 0.09093410521745682, 0.09098158031702042, 0.0908799096941948, 0.09085005521774292, 0.09126545488834381, 0.09088695794343948, 0.09069682657718658], [0.09088097512722015, 0.09101849049329758, 0.09086374938488007, 0.0910012423992157, 0.09088438749313354, 0.09083792567253113, 0.09093748033046722, 0.09096675366163254, 0.09056112170219421, 0.09093057364225388, 0.09111730754375458], [0.09085822105407715, 0.09110642224550247, 0.09082715958356857, 0.09107527136802673, 0.0908643826842308, 0.0907805934548378, 0.09096018224954605, 0.09101301431655884, 0.09028211236000061, 0.0909477099776268, 0.09128496050834656], [0.09090680629014969, 0.09091800451278687, 0.09090539813041687, 0.09091660380363464, 0.09090708196163177, 0.09090328961610794, 0.09091140329837799, 0.090913787484169, 0.09088069200515747, 0.09091084450483322, 0.09092604368925095], [0.09092096984386444, 0.09086260944604874, 0.09092829376459122, 0.09086992591619492, 0.09091951698064804, 0.09093926846981049, 0.09089697152376175, 0.09088455140590668, 0.0910572037100792, 0.09089990705251694, 0.09082074463367462], [0.09071991592645645, 0.09163028746843338, 0.0906064510345459, 0.0915156826376915, 0.09074243158102036, 0.09043651819229126, 0.09109308570623398, 0.09128689765930176, 0.08863213658332825, 0.09104739874601364, 0.0922892615199089], [0.09090345352888107, 0.09093108028173447, 0.0908999964594841, 0.0909276157617569, 0.09090413898229599, 0.09089480340480804, 0.09091480821371078, 0.09092069417238235, 0.09083906561136246, 0.09091342240571976, 0.09095091372728348], [0.0909930095076561, 0.09057772904634476, 0.09104519337415695, 0.09062966704368591, 0.09098266810178757, 0.0911235362291336, 0.09082204848527908, 0.09073366224765778, 0.09196876734495163, 0.09084292501211166, 0.09028085321187973]], [[0.09089534729719162, 0.09090599417686462, 0.0909634381532669, 0.09097408503293991, 0.0908510610461235, 0.09081494063138962, 0.09100604057312012, 0.09101669490337372, 0.09084684401750565, 0.09085747599601746, 0.09086811542510986], [0.09089701622724533, 0.09090637415647507, 0.09095688909292221, 0.09096624702215195, 0.09085806459188461, 0.09082630276679993, 0.09099435061216354, 0.09100371599197388, 0.09085436165332794, 0.09086371213197708, 0.09087307006120682], [0.09090595692396164, 0.09090838581323624, 0.09092149883508682, 0.09092393517494202, 0.09089583903551102, 0.09088758379220963, 0.09093122184276581, 0.090933658182621, 0.09089487046003342, 0.09089730679988861, 0.09089973568916321], [0.09090761095285416, 0.09090875834226608, 0.09091494232416153, 0.09091608971357346, 0.09090283513069153, 0.09089894592761993, 0.09091953188180923, 0.09092067927122116, 0.09090238064527512, 0.09090352803468704, 0.09090467542409897], [0.09088842570781708, 0.09090440720319748, 0.09099072217941284, 0.09100672602653503, 0.09082190692424774, 0.09076767414808273, 0.0910547524690628, 0.0910707637667656, 0.09081557393074036, 0.09083154797554016, 0.09084752202033997], [0.09088277071714401, 0.09090311825275421, 0.09101297706365585, 0.09103334695100784, 0.09079811722040176, 0.09072911739349365, 0.0910944938659668, 0.09111488610506058, 0.09079006314277649, 0.0908103883266449, 0.0908307135105133], [0.09091257303953171, 0.09090986847877502, 0.09089528024196625, 0.09089257568120956, 0.09092383831739426, 0.09093302488327026, 0.09088446199893951, 0.09088175743818283, 0.09092491120100021, 0.09092220664024353, 0.09091950207948685], [0.09091422706842422, 0.09091023355722427, 0.09088871628046036, 0.0908847227692604, 0.09093082696199417, 0.09094437956809998, 0.09087276458740234, 0.09086877852678299, 0.09093241393566132, 0.09092842042446136, 0.09092443436384201], [0.09088777005672455, 0.09090426564216614, 0.09099332243204117, 0.09100984036922455, 0.09081913530826569, 0.09076318144798279, 0.09105939418077469, 0.09107591956853867, 0.09081260114908218, 0.09082908183336258, 0.09084556251764297], [0.09088943153619766, 0.09090463817119598, 0.09098676592111588, 0.09100199490785599, 0.0908261314034462, 0.0907745286822319, 0.09104768931865692, 0.09106292575597763, 0.09082011133432388, 0.09083530306816101, 0.09085050970315933], [0.09089108556509018, 0.09090501815080643, 0.09098020941019058, 0.09099414944648743, 0.09083312749862671, 0.09078587591648102, 0.09103598445653915, 0.0910499319434166, 0.09082761406898499, 0.09084153175354004, 0.09085544943809509]], [[0.09083587676286697, 0.09081212431192398, 0.0909377783536911, 0.0908261090517044, 0.09092099964618683, 0.09087085723876953, 0.09087785333395004, 0.09094201028347015, 0.09127289801836014, 0.09097141027450562, 0.09073207527399063], [0.09079020470380783, 0.09075167030096054, 0.09095554798841476, 0.09077435731887817, 0.09092830866575241, 0.090846948325634, 0.09085830301046371, 0.09096240997314453, 0.09150011837482452, 0.09101014584302902, 0.09062189608812332], [0.09103106707334518, 0.09107083082199097, 0.0908607766032219, 0.09104741364717484, 0.09088878333568573, 0.09097255021333694, 0.09096085280179977, 0.0908537209033966, 0.09030435234308243, 0.09080468863248825, 0.09120504558086395], [0.09081710129976273, 0.09078726917505264, 0.09094508737325668, 0.09080483019351959, 0.09092400968074799, 0.09086102992296219, 0.09086982160806656, 0.09095039963722229, 0.0913662537932396, 0.09098733961582184, 0.09068676084280014], [0.09099899977445602, 0.09102829545736313, 0.09087353199720383, 0.09101103991270065, 0.0908941775560379, 0.09095589071512222, 0.09094727784395218, 0.09086833894252777, 0.09046315401792526, 0.0908321961760521, 0.09112711995840073], [0.09090300649404526, 0.09090103209018707, 0.09091147780418396, 0.09090219438076019, 0.09091008454561234, 0.09090591967105865, 0.09090650081634521, 0.09091183543205261, 0.09093927592039108, 0.0909142717719078, 0.09089437127113342], [0.09091641753911972, 0.09091880172491074, 0.09090619534254074, 0.09091740101575851, 0.09090787917375565, 0.09091290831565857, 0.09091220051050186, 0.09090577811002731, 0.09087266772985458, 0.09090282768011093, 0.09092684090137482], [0.09103912115097046, 0.09108152985572815, 0.09085754305124283, 0.09105655550956726, 0.0908874049782753, 0.09097672253847122, 0.09096425026655197, 0.09085002541542053, 0.09026437997817993, 0.09079773724079132, 0.09122466295957565], [0.09166464954614639, 0.09191503375768661, 0.09059901535511017, 0.09176751971244812, 0.0907735601067543, 0.09129729866981506, 0.09122400730848312, 0.0905551090836525, 0.08718923479318619, 0.09025029838085175, 0.09276427328586578], [0.0910952091217041, 0.0911559984087944, 0.0908350795507431, 0.09112019836902618, 0.09087784588336945, 0.09100579470396042, 0.0909879207611084, 0.09082431346178055, 0.0899868831038475, 0.09074945002794266, 0.09136125445365906], [0.09063585102558136, 0.09054764360189438, 0.09101495891809464, 0.09059957414865494, 0.09095245599746704, 0.09076586365699768, 0.09079188853502274, 0.09103070944547653, 0.09226986020803452, 0.09114033728837967, 0.09025087207555771]], [[0.09047012776136398, 0.09060584008693695, 0.09074991196393967, 0.09111294150352478, 0.0911397784948349, 0.09071260690689087, 0.09119345992803574, 0.09122031182050705, 0.09079276770353317, 0.09115596860647202, 0.09084624797105789], [0.09057717770338058, 0.0906798467040062, 0.0907888114452362, 0.09106318652629852, 0.09108345955610275, 0.09076060354709625, 0.09112400561571121, 0.09114428609609604, 0.09082122147083282, 0.0910956934094429, 0.09086164832115173], [0.0906907469034195, 0.09075833112001419, 0.09083002805709839, 0.0910104364156723, 0.091023750603199, 0.09081146866083145, 0.0910504013299942, 0.0910637229681015, 0.09085134416818619, 0.09103179723024368, 0.09087793529033661], [0.0909765362739563, 0.09095562994480133, 0.09093346446752548, 0.09087780863046646, 0.09087370336055756, 0.09093920141458511, 0.09086550027132034, 0.09086139500141144, 0.0909268781542778, 0.09087122976779938, 0.09091867506504059], [0.09099764376878738, 0.09097018837928772, 0.09094109386205673, 0.0908680260181427, 0.09086264669895172, 0.09094862639904022, 0.09085187315940857, 0.090846486389637, 0.0909324511885643, 0.09085939079523087, 0.09092167019844055], [0.09066135436296463, 0.09073802828788757, 0.09081937372684479, 0.09102410078048706, 0.09103921055793762, 0.09079831838607788, 0.09106945246458054, 0.09108457714319229, 0.0908435583114624, 0.09104833751916885, 0.09087373316287994], [0.09103984385728836, 0.0909992903470993, 0.09095632284879684, 0.09084844589233398, 0.09084049612283707, 0.09096743911504745, 0.09082460403442383, 0.09081665426492691, 0.09094356000423431, 0.09083569794893265, 0.09092764556407928], [0.09106095135211945, 0.0910138413310051, 0.0909639373421669, 0.09083865582942963, 0.09082943201065063, 0.09097684919834137, 0.09081096202135086, 0.09080173820257187, 0.09094911813735962, 0.09082385152578354, 0.09093062579631805], [0.09072451293468475, 0.09078165888786316, 0.09084226936101913, 0.09099476039409637, 0.09100601822137833, 0.09082658588886261, 0.09102853387594223, 0.09103979170322418, 0.0908602923154831, 0.09101281315088272, 0.09088277071714401], [0.09101036936044693, 0.0909789577126503, 0.09094568341970444, 0.09086211025714874, 0.09085594862699509, 0.09095429629087448, 0.09084363281726837, 0.09083747863769531, 0.09093579649925232, 0.09085223823785782, 0.09092346578836441], [0.09076663851737976, 0.09081075340509415, 0.09085754305124283, 0.09097520262002945, 0.09098388999700546, 0.09084543585777283, 0.09100125730037689, 0.0910099446773529, 0.09087144583463669, 0.0909891277551651, 0.09088879823684692]], [[0.09091050922870636, 0.09094150364398956, 0.0908922627568245, 0.0909232497215271, 0.09102879464626312, 0.09086490422487259, 0.09097038209438324, 0.09100139141082764, 0.09045759588479996, 0.09084847569465637, 0.09116090834140778], [0.09090986847877502, 0.09092604368925095, 0.09090033918619156, 0.09091652184724808, 0.09097160398960114, 0.09088605642318726, 0.09094111621379852, 0.09095730632543564, 0.09067313373088837, 0.0908774733543396, 0.09104050695896149], [0.09091085940599442, 0.09095057845115662, 0.09088747948408127, 0.09092718362808228, 0.09106245636940002, 0.09085242450237274, 0.09098758548498154, 0.09102733433246613, 0.09033089131116867, 0.09083137661218643, 0.09123185276985168], [0.09091025590896606, 0.09093515574932098, 0.09089559316635132, 0.09092049300670624, 0.09100528806447983, 0.0908736139535904, 0.0909583568572998, 0.09098327159881592, 0.09054616838693619, 0.09086041152477264, 0.09111139923334122], [0.09090770035982132, 0.09088219702243805, 0.09092272073030472, 0.09089721739292145, 0.09081045538187027, 0.09094525128602982, 0.09085845202207565, 0.09083296358585358, 0.0912821888923645, 0.09095878899097443, 0.0907021164894104], [0.09091133624315262, 0.09096414595842361, 0.09088025242090225, 0.09093303978443146, 0.09111293405294418, 0.09083365648984909, 0.0910133495926857, 0.09106621891260147, 0.09014112502336502, 0.09080567955970764, 0.09133832156658173], [0.0909092128276825, 0.09091159701347351, 0.09090780466794968, 0.09091018885374069, 0.09091830253601074, 0.09090569615364075, 0.0909138098359108, 0.09091619402170181, 0.09087427705526352, 0.09090443700551987, 0.09092845022678375], [0.09090843051671982, 0.09089600294828415, 0.090915746986866, 0.09090332686901093, 0.09086104482412338, 0.09092672169208527, 0.09088443219661713, 0.09087201952934265, 0.09109067171812057, 0.09093331545591354, 0.09080822020769119], [0.09091206640005112, 0.09116039425134659, 0.09076615422964096, 0.0910140797495842, 0.0918629989027977, 0.09054772555828094, 0.09139229357242584, 0.09164193272590637, 0.08735007792711258, 0.0904167890548706, 0.09293540567159653], [0.09091157466173172, 0.09097224473953247, 0.09087587893009186, 0.09093651920557022, 0.09114322066307068, 0.09082234650850296, 0.09102878719568253, 0.09108953177928925, 0.09002729505300522, 0.09079020470380783, 0.09140228480100632], [0.09090335667133331, 0.09081489592790604, 0.09095549583435059, 0.09086697548627853, 0.09056634455919266, 0.09103375673294067, 0.09073257446289062, 0.09064426273107529, 0.0922095775604248, 0.09108079224824905, 0.09019190818071365]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.0978730328666806e-05, "episode_return_min": -14.5, "episode_return_mean": -0.05, "env_to_module_sum_episodes_length_out": 10.366003441359926, "env_reset_timer": 0.0007643498107790947, "num_env_steps_sampled_lifetime": 10400, "num_episodes": 20, "episode_duration_sec_mean": 0.005557740604854189, "module_episode_returns_mean": {"default_policy": -0.05}, "episode_len_min": 20, "episode_return_max": 13.5, "env_to_module_connector": {"connector_pipeline_timer": 5.8616763633710454e-05, "timers": {"connectors": {"numpy_to_tensor": 1.1954194422596357e-05, "add_time_dim_to_batch_and_zero_pad": 7.000406835414915e-06, "batch_individual_items": 1.2437533058403287e-05, "add_states_from_episodes_to_batch": 2.75074133085332e-06, "add_observations_from_episodes_to_batch": 2.7788067219750024e-06}}}, "env_to_module_sum_episodes_length_in": 10.366003441359926, "episode_len_mean": 20.0, "num_episodes_lifetime": 40, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.610065331298034e-05, "listify_data_for_vector_env": 1.0434551094823588e-05, "un_batch_to_individual_items": 6.444875055525573e-06, "normalize_and_clip_actions": 7.936497761793709e-06, "remove_single_ts_time_rank_from_batch": 1.1929100912830886e-05, "tensor_to_numpy": 1.5119486379185671e-05}}, "connector_pipeline_timer": 0.00011345669534433545}, "num_env_steps_sampled": 400, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "num_agent_steps_sampled": {"default_agent": 400}, "env_step_timer": 1.3863502679561128e-05, "agent_episode_returns_mean": {"default_agent": -0.05}, "sample": 0.1311671973543707, "weights_seq_no": 2.0, "time_between_sampling": 9.319195667048916}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "b509c_00000", "date": "2025-08-11_18-29-40", "timestamp": 1754929780, "time_this_iter_s": 9.380477905273438, "time_total_s": 19.394989013671875, "pid": 11229, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x383ebd8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.394989013671875, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 42.392307692307696, "ram_util_percent": 78.03846153846153}}
{"timers": {"training_iteration": 9.853945573640848, "restore_env_runners": 1.055528379511088e-05, "training_step": 9.85373625926117, "env_runner_sampling_timer": 1.6614249804456835, "learner_update_timer": 8.01556774864277, "synch_weights": 0.0016987801599781963, "restore_eval_env_runners": 6.602170062251389e-05, "evaluation_iteration": 0.14443998398492114, "synch_eval_env_connectors": 0.00043095986475236717, "synch_env_connectors": 5.581172881647945e-06}, "env_runners": {"num_episodes_lifetime": -30375.0, "rlmodule_inference_timer": 3.100790836315353e-05, "episode_duration_sec_mean": 0.005242982841562478, "module_episode_returns_mean": {"default_policy": 0.54}, "episode_return_min": -10.5, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2358453265596308e-05, "add_states_from_episodes_to_batch": 2.6816367150014507e-06, "numpy_to_tensor": 1.243547841366943e-05, "add_observations_from_episodes_to_batch": 2.8159873510919808e-06, "add_time_dim_to_batch_and_zero_pad": 7.024906951158708e-06}}, "connector_pipeline_timer": 5.9833435073176814e-05}, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0408068302179814e-05, "un_batch_to_individual_items": 6.623807375248054e-06, "tensor_to_numpy": 1.5163682669148972e-05, "normalize_and_clip_actions": 7.993564343707695e-06, "remove_single_ts_time_rank_from_batch": 1.1900063928362298e-05, "get_actions": 3.845996378955319e-05}}, "connector_pipeline_timer": 0.00011745390376977002}, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "env_step_timer": 1.3828746072424039e-05, "time_between_sampling": 0.030870695642272915, "episode_return_mean": 0.54, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_max": 9.5, "sample": 0.0061897857286747, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "env_reset_timer": 4.229884501623303e-05, "num_env_steps_sampled_lifetime": -607500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "agent_episode_returns_mean": {"default_agent": 0.54}, "weights_seq_no": 2.0, "episode_len_mean": 20.0, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3257.4613895944303}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13423635377658064, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008912740124214906, "add_observations_from_episodes_to_batch": 0.0009085385776357725, "add_columns_from_episodes_to_train_batch": 0.041396173262794045, "add_time_dim_to_batch_and_zero_pad": 0.07519291067745071, "add_states_from_episodes_to_batch": 0.0034513208916410803, "batch_individual_items": 0.0040669091408955865, "numpy_to_tensor": 7.187961054733023e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "weights_seq_no": 3.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 17955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.9168410861561, "num_module_steps_trained": 5985, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime_throughput": 800.8099610881706}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_env_steps_trained_lifetime": 594000, "num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_module_steps_trained_lifetime": 215460, "num_env_steps_trained_lifetime_throughput": 59372.306639653034}, "default_policy": {"use_intrinsic_rewards": 1.0, "policy_loss": 9.124974894803017e-05, "weights_seq_no": 18.0, "vf_explained_var": 0.0009042620658874512, "module_train_batch_size_mean": 997.6672132667843, "total_loss": 0.2785191237926483, "num_module_steps_trained_lifetime": 107730, "diff_num_grad_updates_vs_sampler_policy": 16.0, "vf_loss_unclipped": 43.62629699707031, "mean_kl_loss": 3.8425554521381855e-05, "entropy": 0.6925537586212158, "num_module_steps_trained": 35910, "vf_loss": 0.3587574362754822}, "intrinsic_reward_module": {"total_loss": 0.0, "weights_seq_no": 18.0, "num_module_steps_trained_lifetime": 107730, "diff_num_grad_updates_vs_sampler_policy": 16.0, "module_train_batch_size_mean": 997.6672132667843, "num_module_steps_trained": 35910}}}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 33000, "num_module_steps_trained_lifetime": 35910, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 99000, "num_env_steps_trained_lifetime_throughput": 4417.358001627111, "num_module_steps_trained_throughput": 30622700.082230452, "num_module_steps_trained_lifetime_throughput": 12662135.932415813}, "default_policy": {"weights_seq_no": 3.0, "vf_explained_var": -0.0017188787460327148, "module_train_batch_size_mean": 997.9168410861561, "total_loss": 0.2781575322151184, "num_module_steps_trained_lifetime": 17955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 43.433143615722656, "mean_kl_loss": 3.698471482493915e-05, "curr_kl_coeff": 0.020197991281747818, "entropy": 0.6925594210624695, "num_module_steps_trained": 5985, "vf_loss": 0.35830453038215637, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "use_intrinsic_rewards": 0.0, "policy_loss": 8.724260987946764e-05, "num_module_steps_trained_lifetime_throughput": 800.7940708229185}, "IntrinsicAttentionMask": [[[0.09043978899717331, 0.09091101586818695, 0.09105557948350906, 0.0910823866724968, 0.09077291190624237, 0.09068218618631363, 0.09116287529468536, 0.09118971973657608, 0.09076231718063354, 0.09078904241323471, 0.09115223586559296], [0.09083696454763412, 0.09090942144393921, 0.09093158692121506, 0.09093569964170456, 0.09088821709156036, 0.09087427705526352, 0.09094801545143127, 0.09095212817192078, 0.09088659286499023, 0.09089069813489914, 0.09094639122486115], [0.09095866233110428, 0.09090885519981384, 0.09089363366365433, 0.0908908098936081, 0.09092342108488083, 0.09093300998210907, 0.09088235348463058, 0.09087952971458435, 0.09092453867197037, 0.09092172235250473, 0.09088347107172012], [0.09098123013973236, 0.09090875089168549, 0.09088660031557083, 0.09088249504566193, 0.09092994779348373, 0.09094389528036118, 0.09087018668651581, 0.0908660888671875, 0.09093157202005386, 0.09092746675014496, 0.09087181091308594], [0.09072063863277435, 0.0909099280834198, 0.09096787869930267, 0.09097862243652344, 0.09085451066493988, 0.09081807732582092, 0.09101085364818573, 0.09102160483598709, 0.09085025638341904, 0.09086098521947861, 0.09100659936666489], [0.09064418077468872, 0.09091024845838547, 0.09099174290895462, 0.09100685268640518, 0.09083233028650284, 0.09078111499547958, 0.09105219691991806, 0.09106732159852982, 0.09082634747028351, 0.09084143489599228, 0.09104620665311813], [0.0910489410161972, 0.09090840816497803, 0.09086547791957855, 0.09085752815008163, 0.09094949066638947, 0.0909765288233757, 0.09083367884159088, 0.09082572907209396, 0.09095264226198196, 0.09094469249248505, 0.09083682298660278], [0.09107152372598648, 0.09090828895568848, 0.09085844457149506, 0.09084920585155487, 0.09095600992441177, 0.09098741412162781, 0.09082150459289551, 0.09081228077411652, 0.09095967561006546, 0.09095042943954468, 0.0908251628279686], [0.09071171283721924, 0.09090997278690338, 0.09097067266702652, 0.09098192304372787, 0.09085192531347275, 0.0908137708902359, 0.09101568907499313, 0.09102694690227509, 0.09084746986627579, 0.09085870534181595, 0.09101122617721558], [0.09073422849178314, 0.09090987592935562, 0.09096363931894302, 0.0909736156463623, 0.09085845947265625, 0.090824656188488, 0.09100352227687836, 0.09101349115371704, 0.09085451066493988, 0.09086446464061737, 0.09099956601858139], [0.0910399854183197, 0.09090844541788101, 0.0908682644367218, 0.09086082130670547, 0.09094690531492233, 0.09097221493721008, 0.0908384919166565, 0.09083104878664017, 0.09094985574483871, 0.09094240516424179, 0.09084144234657288]], [[0.09079109132289886, 0.09083986282348633, 0.09076238423585892, 0.09081114083528519, 0.09079678356647491, 0.09089969098567963, 0.09070499241352081, 0.0907537192106247, 0.0915222093462944, 0.09087379276752472, 0.0912444218993187], [0.09082692116498947, 0.09086091071367264, 0.09080690890550613, 0.0908408910036087, 0.09083088487386703, 0.09090259671211243, 0.09076690673828125, 0.09080087393522263, 0.09133585542440414, 0.09088455885648727, 0.09114263206720352], [0.09076995402574539, 0.09082742780447006, 0.09073612838983536, 0.09079357981681824, 0.09077665954828262, 0.09089793264865875, 0.09066851437091827, 0.09072592109441757, 0.09163207560777664, 0.09086741507053375, 0.09130436927080154], [0.09080583602190018, 0.09084853529930115, 0.09078069776296616, 0.09082338213920593, 0.09081081300973892, 0.09090089797973633, 0.0907304584980011, 0.09077312052249908, 0.09144555777311325, 0.09087823331356049, 0.09120257198810577], [0.09079527109861374, 0.09084232151508331, 0.09076758474111557, 0.09081462025642395, 0.09080076217651367, 0.09090002626180649, 0.09071221947669983, 0.09075922518968582, 0.09150043874979019, 0.0908750519156456, 0.0912325382232666], [0.09087081253528595, 0.0908866599202156, 0.09086146950721741, 0.09087732434272766, 0.09087266027927399, 0.09090610593557358, 0.09084280580282211, 0.09085866063833237, 0.09110788255929947, 0.09089769423007965, 0.0910179615020752], [0.09072765707969666, 0.09080252051353455, 0.09068360179662704, 0.09075842797756195, 0.09073638916015625, 0.09089437872171402, 0.0905955508351326, 0.09067030996084213, 0.09185216575860977, 0.09085461497306824, 0.09142433851957321], [0.09076356887817383, 0.09082367271184921, 0.09072820097208023, 0.09078827500343323, 0.09077058732509613, 0.09089739620685577, 0.09065750241279602, 0.09071753174066544, 0.09166525304317474, 0.09086548537015915, 0.09132245928049088], [0.09132195264101028, 0.0911489948630333, 0.09142395108938217, 0.09125079959630966, 0.09130174666643143, 0.09093742072582245, 0.0916282907128334, 0.09145475178956985, 0.08877279609441757, 0.09102892130613327, 0.08973044902086258], [0.09085183590650558, 0.0908755362033844, 0.09083787351846695, 0.09086158126592636, 0.09085460007190704, 0.0909046083688736, 0.09080997109413147, 0.09083366394042969, 0.09120649099349976, 0.09089202433824539, 0.09107191115617752], [0.0911218598484993, 0.09103318303823471, 0.09117411822080612, 0.09108538925647736, 0.09111150354146957, 0.09092459082603455, 0.09127873182296753, 0.0911898985505104, 0.08980642259120941, 0.09097156673669815, 0.0903027281165123]], [[0.09088319540023804, 0.09089384227991104, 0.0908176526427269, 0.09082828462123871, 0.09083891659975052, 0.09080280363559723, 0.09099387377500534, 0.09100452810525894, 0.09096835553646088, 0.09097900241613388, 0.09098965674638748], [0.09088632464408875, 0.09089567512273788, 0.09082867205142975, 0.09083802253007889, 0.09084737300872803, 0.09081561863422394, 0.09098364412784576, 0.0909930095076561, 0.09096120297908783, 0.09097056835889816, 0.0909799262881279], [0.090863898396492, 0.09088244289159775, 0.09074966609477997, 0.09076818823814392, 0.09078671783208847, 0.09072380512952805, 0.09105690568685532, 0.09107549488544464, 0.0910123810172081, 0.09103096276521683, 0.09104954451322556], [0.09086702764034271, 0.09088429063558578, 0.09076069295406342, 0.0907779335975647, 0.09079518169164658, 0.09073662012815475, 0.09104667603969574, 0.0910639762878418, 0.09100523591041565, 0.09102252125740051, 0.09103982150554657], [0.09087016433477402, 0.09088614583015442, 0.09077172726392746, 0.09078769385814667, 0.09080366045236588, 0.09074943512678146, 0.09103645384311676, 0.09105246514081955, 0.0909980982542038, 0.09101410210132599, 0.09103010594844818], [0.09085951745510101, 0.09087985754013062, 0.09073426574468613, 0.09075456857681274, 0.09077488631010056, 0.09070590883493423, 0.09107118844985962, 0.0910915732383728, 0.09102234989404678, 0.09104272723197937, 0.09106310456991196], [0.09091566503047943, 0.09091296046972275, 0.09093233942985535, 0.09092963486909866, 0.09092693030834198, 0.09093611687421799, 0.09088755398988724, 0.09088484942913055, 0.09089403599500656, 0.09089133143424988, 0.0908886268734932], [0.09091877937316895, 0.09091479331254959, 0.0909433662891388, 0.09093938022851944, 0.09093538671731949, 0.09094893932342529, 0.09087732434272766, 0.09087333083152771, 0.09088687598705292, 0.09088288992643356, 0.09087890386581421], [0.09090818464756012, 0.09090855717658997, 0.09090589731931686, 0.09090626239776611, 0.09090663492679596, 0.09090537577867508, 0.09091205149888992, 0.09091242402791977, 0.09091116487979889, 0.09091152995824814, 0.09091190248727798], [0.09091131389141083, 0.090910404920578, 0.09091693162918091, 0.09091602265834808, 0.09091510623693466, 0.09091820567846298, 0.09090183675289154, 0.09090092033147812, 0.09090401977300644, 0.09090311080217361, 0.09090219438076019], [0.09091442078351974, 0.09091222286224365, 0.09092795103788376, 0.09092576056718826, 0.09092356264591217, 0.09093102067708969, 0.09089159965515137, 0.09088940173387527, 0.0908968597650528, 0.0908946618437767, 0.09089246392250061]], [[0.09090014547109604, 0.09093113243579865, 0.09088189899921417, 0.09091288596391678, 0.09101841598749161, 0.09085454046726227, 0.09084542840719223, 0.09099102020263672, 0.09056136757135391, 0.09095268696546555, 0.09115051478147507], [0.09090443700551987, 0.09092061221599579, 0.090894915163517, 0.09091109037399292, 0.09096616506576538, 0.0908806249499321, 0.09087586402893066, 0.09095186740159988, 0.09072740375995636, 0.09093186259269714, 0.09103506803512573], [0.0908975899219513, 0.0909372940659523, 0.09087421000003815, 0.09091390669345856, 0.09104916453361511, 0.09083915501832962, 0.09082747995853424, 0.09101404249668121, 0.09046370536088943, 0.0909649208188057, 0.09121853113174438], [0.0909019261598587, 0.09092681854963303, 0.09088726341724396, 0.09091216325759888, 0.09099695086479187, 0.09086528420448303, 0.09085796028375626, 0.09097493439912796, 0.09062960743904114, 0.09094414114952087, 0.09110304713249207], [0.09091629832983017, 0.0908907949924469, 0.09093132615089417, 0.0909058153629303, 0.09081904590129852, 0.09095385670661926, 0.09096137434244156, 0.09084156155586243, 0.09119615703821182, 0.09087306261062622, 0.09071069210767746], [0.09089373052120209, 0.09094652533531189, 0.09086265414953232, 0.09091543406248093, 0.09109529107809067, 0.09081606566905975, 0.09080054610967636, 0.09104858338832855, 0.09031739085912704, 0.09098324924707413, 0.09132063388824463], [0.09089241921901703, 0.09094957262277603, 0.09085877984762192, 0.09091591089963913, 0.09111064672470093, 0.09080834686756134, 0.09079153835773468, 0.09106007218360901, 0.09026864916086197, 0.09098934382200241, 0.09135466814041138], [0.09091262519359589, 0.09090019762516022, 0.09091994166374207, 0.0909075140953064, 0.09086523205041885, 0.09093091636896133, 0.09093458205461502, 0.09087620675563812, 0.09104884415864944, 0.09089156240224838, 0.09081240743398666], [0.09084991365671158, 0.09104320406913757, 0.0907362848520279, 0.09092933684587479, 0.09158948063850403, 0.09056610614061356, 0.09050944447517395, 0.09141770005226135, 0.08875913918018341, 0.09117785841226578, 0.0924215018749237], [0.09090740978717804, 0.09091328829526901, 0.09090394526720047, 0.09090982377529144, 0.09092983603477478, 0.09089875221252441, 0.09089702367782593, 0.09092464298009872, 0.09084301441907883, 0.09091737866401672, 0.09095486998558044], [0.09093350172042847, 0.0908450111746788, 0.09098565578460693, 0.0908971056342125, 0.09059637784957886, 0.09106394648551941, 0.09109005331993103, 0.09067432582378387, 0.09190862625837326, 0.09078352153301239, 0.0902218148112297]], [[0.0909074917435646, 0.09078455716371536, 0.09084192663431168, 0.09085255861282349, 0.0909968912601471, 0.09096071869134903, 0.0910181999206543, 0.09089511632919312, 0.09085898101329803, 0.09086962044239044, 0.09101397544145584], [0.09090515226125717, 0.09061107039451599, 0.09074823558330536, 0.09077367931604385, 0.09111935645341873, 0.09103264659643173, 0.09117045253515244, 0.09087551385164261, 0.09078903496265411, 0.0908144861459732, 0.09116031974554062], [0.09090626239776611, 0.09069202840328217, 0.0907919779419899, 0.09081050753593445, 0.09106218069791794, 0.090999074280262, 0.09109935909509659, 0.09088467806577682, 0.09082169085741043, 0.09084022790193558, 0.09109199047088623], [0.09090645611286163, 0.09070703387260437, 0.09080007672309875, 0.09081733226776123, 0.09105158597230911, 0.09099285304546356, 0.09108618646860123, 0.09088636934757233, 0.09082774072885513, 0.0908450037240982, 0.09107932448387146], [0.09090911597013474, 0.09091069549322128, 0.09090995788574219, 0.09090981632471085, 0.09090796113014221, 0.09090842306613922, 0.09090768545866013, 0.09090927243232727, 0.09090973436832428, 0.09090960025787354, 0.0909077450633049], [0.0909084677696228, 0.09085965901613235, 0.09088243544101715, 0.0908866599202156, 0.09094393253326416, 0.09092958271503448, 0.09095238149166107, 0.09090355038642883, 0.09088920801877975, 0.09089343249797821, 0.09095070511102676], [0.09090948104858398, 0.09094075113534927, 0.0909261554479599, 0.09092345088720322, 0.09088677167892456, 0.09089595824480057, 0.09088137000799179, 0.09091263264417648, 0.09092181921005249, 0.0909191146492958, 0.09088244289159775], [0.0909072756767273, 0.09076710045337677, 0.09083250910043716, 0.09084463864564896, 0.091009221971035, 0.09096796810626984, 0.09103352576494217, 0.09089315682649612, 0.09085195511579514, 0.09086408466100693, 0.09102870523929596], [0.09090659022331238, 0.09071610122919083, 0.09080497175455093, 0.09082145243883133, 0.09104519337415695, 0.09098909795284271, 0.0910782441496849, 0.0908873975276947, 0.09083139896392822, 0.09084787964820862, 0.09107169508934021], [0.0909067839384079, 0.09073110669851303, 0.09081307798624039, 0.09082827717065811, 0.09103459864854813, 0.09098287671804428, 0.09106507152318954, 0.0908890888094902, 0.09083744883537292, 0.09085264801979065, 0.09105902910232544], [0.09090941399335861, 0.09093479812145233, 0.09092295169830322, 0.09092074632644653, 0.09089098125696182, 0.09089843183755875, 0.09088659286499023, 0.09091196954250336, 0.09091942757368088, 0.09091722965240479, 0.09088745713233948]], [[0.09087930619716644, 0.09102494269609451, 0.09097566455602646, 0.09089203923940659, 0.09099754691123962, 0.09094827622175217, 0.09082459658384323, 0.09085556119680405, 0.09054060280323029, 0.09093183279037476, 0.0911296159029007], [0.09094587713479996, 0.09076470881700516, 0.09082593768835068, 0.09093000739812851, 0.0907987430691719, 0.09086000174283981, 0.09101410210132599, 0.09097547829151154, 0.09136973321437836, 0.09088046103715897, 0.09063490480184555], [0.0909234881401062, 0.0908527597784996, 0.09087667614221573, 0.09091729670763016, 0.09086605906486511, 0.09088996797800064, 0.09095009416341782, 0.09093502908945084, 0.09108860045671463, 0.09089795500040054, 0.09080204367637634], [0.09088517725467682, 0.09100218862295151, 0.09096260368824005, 0.0908954069018364, 0.0909801796078682, 0.09094059467315674, 0.09084121882915497, 0.0908660963177681, 0.09061291068792343, 0.09092738479375839, 0.0910862609744072], [0.09093344956636429, 0.09081367403268814, 0.09085416793823242, 0.09092295914888382, 0.09083618223667145, 0.09087667614221573, 0.09097853302955627, 0.09095301479101181, 0.09121336042881012, 0.09089020639657974, 0.0907278060913086], [0.09091098606586456, 0.0909016951918602, 0.0909048393368721, 0.0909101665019989, 0.09090344607830048, 0.09090658277273178, 0.09091447293758392, 0.09091249108314514, 0.09093263000249863, 0.09090762585401535, 0.09089503437280655], [0.0908539816737175, 0.09112270176410675, 0.09103173017501831, 0.090877465903759, 0.09107211232185364, 0.09098120033740997, 0.09075314551591873, 0.09081021696329117, 0.09023047983646393, 0.0909508615732193, 0.09131603688001633], [0.09086833894252777, 0.091067373752594, 0.0910000130534172, 0.09088574349880219, 0.09102991968393326, 0.09096258133649826, 0.09079360961914062, 0.09083590656518936, 0.0904059186577797, 0.09094011038541794, 0.09121048450469971], [0.09071988612413406, 0.09163025766611099, 0.09132135659456253, 0.09079919755458832, 0.09145840257406235, 0.09115008264780045, 0.09037991613149643, 0.09057221561670303, 0.08863210678100586, 0.09104736894369125, 0.09228923171758652], [0.09090345352888107, 0.09093108028173447, 0.09092173725366592, 0.09090586751699448, 0.09092588722705841, 0.09091654419898987, 0.09089306741952896, 0.09089894592761993, 0.09083906561136246, 0.09091342240571976, 0.09095091372728348], [0.0909930020570755, 0.09057772159576416, 0.09071794897317886, 0.09095657616853714, 0.09065565466880798, 0.09079600870609283, 0.09114965051412582, 0.09106094390153885, 0.09196875989437103, 0.09084291756153107, 0.09028084576129913]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.142900268886142e-05, "episode_return_min": -14.5, "episode_return_mean": -0.21666666666666667, "env_to_module_sum_episodes_length_out": 10.368205581254823, "env_reset_timer": 0.0007576671523507685, "num_env_steps_sampled_lifetime": 15400, "num_episodes": 20, "episode_duration_sec_mean": 0.0054359256483924884, "module_episode_returns_mean": {"default_policy": -0.21666666666666667}, "episode_len_min": 20, "episode_return_max": 13.5, "env_to_module_connector": {"connector_pipeline_timer": 5.886325382411164e-05, "timers": {"connectors": {"numpy_to_tensor": 1.1901638532068418e-05, "add_time_dim_to_batch_and_zero_pad": 7.0541893388216425e-06, "batch_individual_items": 1.2497965983020632e-05, "add_states_from_episodes_to_batch": 2.81975357110889e-06, "add_observations_from_episodes_to_batch": 2.8023128169088974e-06}}}, "env_to_module_sum_episodes_length_in": 10.368205581254823, "episode_len_mean": 20.0, "num_episodes_lifetime": 60, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.592930523463515e-05, "listify_data_for_vector_env": 1.054228411314996e-05, "un_batch_to_individual_items": 6.536113039838737e-06, "normalize_and_clip_actions": 7.94531432001817e-06, "remove_single_ts_time_rank_from_batch": 1.195525506749117e-05, "tensor_to_numpy": 1.5102118519203265e-05}}, "connector_pipeline_timer": 0.00011367382731225814}, "num_env_steps_sampled": 400, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "num_agent_steps_sampled": {"default_agent": 400}, "env_step_timer": 1.4057044452700341e-05, "agent_episode_returns_mean": {"default_agent": -0.21666666666666667}, "sample": 0.13098628913065186, "weights_seq_no": 3.0, "time_between_sampling": 9.317929528708337}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "b509c_00000", "date": "2025-08-11_18-29-49", "timestamp": 1754929789, "time_this_iter_s": 9.290000915527344, "time_total_s": 28.68498992919922, "pid": 11229, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x383ebd8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 28.68498992919922, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 40.176923076923075, "ram_util_percent": 77.06923076923077}}
{"timers": {"training_iteration": 9.845358206654872, "restore_env_runners": 1.0521390408510341e-05, "training_step": 9.84514875499805, "env_runner_sampling_timer": 1.6600873660619682, "learner_update_timer": 8.008188790736048, "synch_weights": 0.001701526948692743, "restore_eval_env_runners": 6.545856351731346e-05, "evaluation_iteration": 0.14417798539518847, "synch_eval_env_connectors": 0.0004277810966013931, "synch_env_connectors": 5.56869093561545e-06}, "env_runners": {"num_episodes_lifetime": -61250.0, "rlmodule_inference_timer": 3.127637027257524e-05, "episode_duration_sec_mean": 0.005245511607732626, "module_episode_returns_mean": {"default_policy": -0.58}, "episode_return_min": -10.5, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2359687443359668e-05, "add_states_from_episodes_to_batch": 2.6730106088811917e-06, "numpy_to_tensor": 1.2319731677930542e-05, "add_observations_from_episodes_to_batch": 2.804128037135081e-06, "add_time_dim_to_batch_and_zero_pad": 7.049309241078727e-06}}, "connector_pipeline_timer": 5.9673139133589405e-05}, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0442418469091357e-05, "un_batch_to_individual_items": 6.646614097578877e-06, "tensor_to_numpy": 1.5106754186485525e-05, "normalize_and_clip_actions": 7.97457830646351e-06, "remove_single_ts_time_rank_from_batch": 1.1907985124004559e-05, "get_actions": 3.8291182158335484e-05}}, "connector_pipeline_timer": 0.00011717753431611234}, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "env_step_timer": 1.383604566266809e-05, "time_between_sampling": 0.03156464698386634, "episode_return_mean": -0.58, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_max": 9.5, "sample": 0.005651495693572085, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "env_reset_timer": 3.974954363440091e-05, "num_env_steps_sampled_lifetime": -1225000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "agent_episode_returns_mean": {"default_agent": -0.58}, "weights_seq_no": 3.0, "episode_len_mean": 20.0, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3264.0517651725713}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1342370894087136, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008910757312024361, "add_observations_from_episodes_to_batch": 0.0009082261119780596, "add_columns_from_episodes_to_train_batch": 0.041397446109870804, "add_time_dim_to_batch_and_zero_pad": 0.075193120321071, "add_states_from_episodes_to_batch": 0.003454432262578979, "batch_individual_items": 0.004066491709880182, "numpy_to_tensor": 7.185789425496477e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "weights_seq_no": 4.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 23940, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.8923005732703, "num_module_steps_trained": 5985, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime_throughput": 799.3393442654469}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_env_steps_trained_lifetime": 792000, "num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_module_steps_trained_lifetime": 287280, "num_env_steps_trained_lifetime_throughput": 58642.37614467421}, "default_policy": {"use_intrinsic_rewards": 1.0, "policy_loss": -0.00018505050684325397, "weights_seq_no": 24.0, "vf_explained_var": 0.0009681582450866699, "module_train_batch_size_mean": 997.6156867483631, "total_loss": 0.27822616696357727, "num_module_steps_trained_lifetime": 143640, "diff_num_grad_updates_vs_sampler_policy": 21.0, "vf_loss_unclipped": 43.60444259643555, "mean_kl_loss": 4.084310057805851e-05, "entropy": 0.692172110080719, "num_module_steps_trained": 35910, "vf_loss": 0.3587348461151123}, "intrinsic_reward_module": {"total_loss": 0.0, "weights_seq_no": 24.0, "num_module_steps_trained_lifetime": 143640, "diff_num_grad_updates_vs_sampler_policy": 21.0, "module_train_batch_size_mean": 997.6156867483631, "num_module_steps_trained": 35910}}}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 33000, "num_module_steps_trained_lifetime": 47880, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 132000, "num_env_steps_trained_lifetime_throughput": 4409.202420952829, "num_module_steps_trained_throughput": 29834172.474858716, "num_module_steps_trained_lifetime_throughput": 12633231.96717806}, "default_policy": {"weights_seq_no": 4.0, "vf_explained_var": -0.0014486312866210938, "module_train_batch_size_mean": 997.8923005732703, "total_loss": 0.2778835892677307, "num_module_steps_trained_lifetime": 23940, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 43.5766716003418, "mean_kl_loss": 4.221494964440353e-05, "curr_kl_coeff": 0.010098995640873909, "entropy": 0.6921655535697937, "num_module_steps_trained": 5985, "vf_loss": 0.35830581188201904, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "use_intrinsic_rewards": 0.0, "policy_loss": -0.00018770351016428322, "num_module_steps_trained_lifetime_throughput": 799.3239895464151}, "IntrinsicAttentionMask": [[[0.0909074991941452, 0.0909181460738182, 0.09084193408489227, 0.09085256606340408, 0.09086320549249649, 0.0908270850777626, 0.09088447690010071, 0.0910288617014885, 0.09099267423152924, 0.09086962044239044, 0.09101398289203644], [0.09090768545866013, 0.09091704338788986, 0.09085002541542053, 0.09085937589406967, 0.09086873382329941, 0.09083697199821472, 0.09088744223117828, 0.09101440012454987, 0.090982586145401, 0.09087438136339188, 0.09100131690502167], [0.09090627729892731, 0.09092483669519424, 0.09079199284315109, 0.09081052988767624, 0.09082906693220139, 0.09076612442731857, 0.09086614847183228, 0.0911179780960083, 0.09105483442544937, 0.09084025770425797, 0.09109201282262802], [0.09090646356344223, 0.0909237414598465, 0.09080008417367935, 0.09081733226776123, 0.0908345952630043, 0.0907760038971901, 0.09086911380290985, 0.09110350161790848, 0.09104473888874054, 0.0908450111746788, 0.09107933938503265], [0.09090668708086014, 0.09092266857624054, 0.0908081978559494, 0.0908241719007492, 0.09084014594554901, 0.0907859057188034, 0.09087210148572922, 0.09108905494213104, 0.0910346657037735, 0.09084978699684143, 0.09106668829917908], [0.09090599417686462, 0.09092634171247482, 0.09078067541122437, 0.09080099314451218, 0.09082131832838058, 0.09075230360031128, 0.09086199104785919, 0.09113816916942596, 0.09106891602277756, 0.09083359688520432, 0.09110968559980392], [0.09090707451105118, 0.09092049300670624, 0.09082440286874771, 0.09083781391382217, 0.09085121750831604, 0.09080567955970764, 0.09087804704904556, 0.09106013178825378, 0.09101448953151703, 0.0908593162894249, 0.09104136377573013], [0.0909096896648407, 0.09090569615364075, 0.09093426913022995, 0.0909302830696106, 0.09092628955841064, 0.09093984216451645, 0.09091830998659134, 0.09086424112319946, 0.09087778627872467, 0.09092388302087784, 0.09086980670690536], [0.09090903401374817, 0.09090940654277802, 0.09090674668550491, 0.09090711176395416, 0.09090748429298401, 0.09090622514486313, 0.0909082293510437, 0.09091327339410782, 0.09091201424598694, 0.09090770781040192, 0.09091275185346603], [0.0909067913889885, 0.09092199802398682, 0.09081308543682098, 0.09082827717065811, 0.09084347635507584, 0.09079185873270035, 0.09087388217449188, 0.09108031541109085, 0.09102856367826462, 0.09085265547037125, 0.09105903655290604], [0.09090940654277802, 0.09090720862150192, 0.09092293679714203, 0.09092074632644653, 0.09091854840517044, 0.09092600643634796, 0.09091416001319885, 0.09088438749313354, 0.09089184552431107, 0.09091722220182419, 0.09088744968175888]], [[0.09091050922870636, 0.0910562053322792, 0.09100690484046936, 0.0909232497215271, 0.09091412276029587, 0.09097950905561447, 0.09085578471422195, 0.09088676422834396, 0.09045759588479996, 0.09084847569465637, 0.09116090834140778], [0.09090688824653625, 0.09072579443454742, 0.09078700095415115, 0.0908910259604454, 0.09090238064527512, 0.0908210426568985, 0.0909750759601593, 0.09093646705150604, 0.0914740264415741, 0.09098419547080994, 0.09059605002403259], [0.09090828150510788, 0.09083757549524307, 0.0908614844083786, 0.09090209752321243, 0.0909065306186676, 0.09087477624416351, 0.0909348875284195, 0.09091982245445251, 0.09112916886806488, 0.09093844145536423, 0.09078685939311981], [0.09091025590896606, 0.09102730453014374, 0.09098770469427109, 0.09092049300670624, 0.09091316163539886, 0.09096569567918777, 0.09086628258228302, 0.09089117497205734, 0.09054616838693619, 0.09086041152477264, 0.09111139923334122], [0.09091044217348099, 0.09104800969362259, 0.09100145846605301, 0.09092247486114502, 0.09091386198997498, 0.09097559005022049, 0.09085877239704132, 0.09088801592588425, 0.09048274159431458, 0.09085186570882797, 0.09114685654640198], [0.09090898931026459, 0.09089970588684082, 0.09090285003185272, 0.09090817719697952, 0.09090875834226608, 0.0909045934677124, 0.09091247618198395, 0.09091050922870636, 0.09093794971704483, 0.09091294556856155, 0.09089304506778717], [0.09091146290302277, 0.09118034690618515, 0.09108932316303253, 0.09093496203422546, 0.09091813117265701, 0.09103875607252121, 0.09081055968999863, 0.09086766839027405, 0.09007792174816132, 0.09079708158969879, 0.09137380868196487], [0.09091094881296158, 0.09111007302999496, 0.09104268252849579, 0.09092835336923599, 0.09091588109731674, 0.09100523591041565, 0.09083618223667145, 0.09087849408388138, 0.09029266983270645, 0.09082619100809097, 0.09125325083732605], [0.09091176837682724, 0.09208430349826813, 0.09168606996536255, 0.09101378917694092, 0.09094072878360748, 0.09146542847156525, 0.09047474712133408, 0.09072187542915344, 0.0873498022556305, 0.09041650593280792, 0.09293510764837265], [0.09091155976057053, 0.0911969244480133, 0.091100312769413, 0.09093650430440903, 0.0909186452627182, 0.09104665368795395, 0.09080449491739273, 0.09086508303880692, 0.09002728015184402, 0.09079018980264664, 0.09140226989984512], [0.09090332686901093, 0.09048845618963242, 0.09062855690717697, 0.09086694568395615, 0.09089300036430359, 0.09070653468370438, 0.09105982631444931, 0.0909712091088295, 0.09220954775810242, 0.09108076244592667, 0.09019187837839127]], [[0.09053117036819458, 0.09100287407636642, 0.09114757925271988, 0.09083788096904755, 0.0908646285533905, 0.090773805975914, 0.0909181535243988, 0.09094492346048355, 0.09119062125682831, 0.09088077396154404, 0.09090754389762878], [0.09085102379322052, 0.0909234955906868, 0.09094566106796265, 0.09089817851781845, 0.09090228378772736, 0.09088833630084991, 0.09091050177812576, 0.09091459959745407, 0.09095224738121033, 0.09090476483106613, 0.09090887010097504], [0.09094899892807007, 0.09089919924736023, 0.09088397771120071, 0.09091658890247345, 0.09091376513242722, 0.09092334657907486, 0.09090811759233475, 0.09090530127286911, 0.09087945520877838, 0.09091205894947052, 0.09090924263000488], [0.09073923528194427, 0.09095122665166855, 0.09101613610982895, 0.09087714552879333, 0.09088916331529617, 0.09084835648536682, 0.09091319888830185, 0.09092521667480469, 0.09103544056415558, 0.09089641273021698, 0.09090843051671982], [0.09075736254453659, 0.090946726500988, 0.09100470691919327, 0.09088055789470673, 0.0908912941813469, 0.09085484594106674, 0.09091275930404663, 0.0909234955906868, 0.09102194011211395, 0.09089776873588562, 0.09090850502252579], [0.09069579839706421, 0.0909620150923729, 0.09104356169700623, 0.09086896479129791, 0.09088405221700668, 0.09083281457424164, 0.09091424942016602, 0.09092934429645538, 0.09106780588626862, 0.09089316427707672, 0.09090825915336609], [0.09079362452030182, 0.09093772619962692, 0.09098183363676071, 0.09088738262653351, 0.09089554846286774, 0.09086781740188599, 0.09091188758611679, 0.09092005342245102, 0.0909949392080307, 0.0909004807472229, 0.09090864658355713], [0.09081177413463593, 0.09093323349952698, 0.09097039699554443, 0.0908908024430275, 0.09089768677949905, 0.09087430685758591, 0.09091145545244217, 0.09091833233833313, 0.09098144620656967, 0.09090183675289154, 0.0909087210893631], [0.09097812324762344, 0.09089196473360062, 0.09086564183235168, 0.090922050178051, 0.09091717004776001, 0.09093374013900757, 0.09090740233659744, 0.09090252220630646, 0.09085782617330551, 0.09091421961784363, 0.09090933948755264], [0.09076831489801407, 0.09094401448965073, 0.09099780768156052, 0.09088262170553207, 0.09089258313179016, 0.09085876494646072, 0.09091250598430634, 0.09092246741056442, 0.09101379662752151, 0.09089859575033188, 0.09090855717658997], [0.09078644216060638, 0.09093952178955078, 0.09098636358976364, 0.09088604152202606, 0.09089471399784088, 0.09086524695158005, 0.09091206640005112, 0.09092073887586594, 0.09100029617547989, 0.09089994430541992, 0.09090862423181534]], [[0.09077469259500504, 0.09100401401519775, 0.09074598550796509, 0.09079473465681076, 0.09078038483858109, 0.09070295095443726, 0.09086889773607254, 0.09073732793331146, 0.09150567650794983, 0.0908573791384697, 0.0912279412150383], [0.09096608310937881, 0.09086859226226807, 0.09097830951213837, 0.09095754474401474, 0.09096366167068481, 0.090996652841568, 0.09092599153518677, 0.09098199754953384, 0.09065653383731842, 0.09093088656663895, 0.09077373147010803], [0.09075064212083817, 0.09102091938257217, 0.09071683138608932, 0.09077426791191101, 0.0907573476433754, 0.09066612273454666, 0.09086166322231293, 0.09070662409067154, 0.09161258488893509, 0.09084808826446533, 0.09128494560718536], [0.09079147130250931, 0.09099220484495163, 0.09076634794473648, 0.09080902487039566, 0.09079645574092865, 0.09072866290807724, 0.09087394177913666, 0.09075876325368881, 0.09143109619617462, 0.09086386114358902, 0.09118814766407013], [0.09077945351600647, 0.09100066125392914, 0.0907517671585083, 0.09079879522323608, 0.0907849445939064, 0.09071024507284164, 0.09087032824754715, 0.09074341505765915, 0.09148449450731277, 0.09085921943187714, 0.09121663868427277], [0.09071454405784607, 0.09104623645544052, 0.0906730592250824, 0.0907435268163681, 0.09072277694940567, 0.09061086177825928, 0.09085076302289963, 0.09066054224967957, 0.0917731374502182, 0.0908341035246849, 0.09137048572301865], [0.09085347503423691, 0.09094846993684769, 0.09084157645702362, 0.09086178243160248, 0.09085583686828613, 0.09082373231649399, 0.09089251607656479, 0.0908379852771759, 0.0911557748913765, 0.09088774770498276, 0.09104108065366745], [0.09074337780475616, 0.09102600812911987, 0.09070801734924316, 0.09076808393001556, 0.09075039625167847, 0.09065499901771545, 0.09085946530103683, 0.09069734811782837, 0.09164486080408096, 0.0908452719449997, 0.09130214899778366], [0.09138017147779465, 0.09056994318962097, 0.0914822369813919, 0.09130897372961044, 0.0913599506020546, 0.09163554757833481, 0.09104619920253754, 0.09151306003332138, 0.0888293907046318, 0.09108695387840271, 0.08978766202926636], [0.09084385633468628, 0.09095526486635208, 0.09082990139722824, 0.09085360169410706, 0.09084662795066833, 0.09080897271633148, 0.09088964015245438, 0.09082569181919098, 0.09119848161935806, 0.09088404476642609, 0.09106390923261642], [0.09115169942378998, 0.09073568880558014, 0.091203972697258, 0.09111521393060684, 0.09114134311676025, 0.0912824496626854, 0.09098044037818909, 0.09121976047754288, 0.08983583748340607, 0.09100135415792465, 0.09033229947090149]], [[0.09043978899717331, 0.09091101586818695, 0.09071947634220123, 0.0907461941242218, 0.09110920876264572, 0.09101814031600952, 0.09116287529468536, 0.09118971973657608, 0.09076231718063354, 0.09078904241323471, 0.09115223586559296], [0.09083696454763412, 0.09090942144393921, 0.09088001400232315, 0.09088411182165146, 0.09093979746103287, 0.09092584997415543, 0.09094801545143127, 0.09095212817192078, 0.09088659286499023, 0.09089069813489914, 0.09094639122486115], [0.09067560732364655, 0.09091011434793472, 0.09081486612558365, 0.09082815796136856, 0.09100855886936188, 0.09096334129571915, 0.09103520214557648, 0.09104852378368378, 0.09083618223667145, 0.09084947407245636, 0.09102991968393326], [0.09069811552762985, 0.09091001749038696, 0.0908239558339119, 0.09083596616983414, 0.09099896252155304, 0.0909581109881401, 0.0910230278968811, 0.09103506058454514, 0.09084321558475494, 0.09085522592067719, 0.09101825952529907], [0.09100379794836044, 0.09090863168239594, 0.09094724804162979, 0.09094185382127762, 0.09086878597736359, 0.09088708460330963, 0.09085801243782043, 0.09085263311862946, 0.09093859791755676, 0.09093321114778519, 0.09086015075445175], [0.09092716127634048, 0.09090901166200638, 0.09091637283563614, 0.09091534465551376, 0.09090140461921692, 0.09090489894151688, 0.09089934825897217, 0.09089832007884979, 0.09091472625732422, 0.09091369807720184, 0.0908997505903244], [0.0910489410161972, 0.09090840816497803, 0.09096541255712509, 0.09095745533704758, 0.09084957838058472, 0.09087657928466797, 0.09083367884159088, 0.09082572907209396, 0.09095264226198196, 0.09094469249248505, 0.09083682298660278], [0.09107153117656708, 0.09090829640626907, 0.09097450226545334, 0.09096526354551315, 0.09083998203277588, 0.09087134152650833, 0.0908215120434761, 0.09081228822469711, 0.09095968306064606, 0.09095043689012527, 0.0908251702785492], [0.09071171283721924, 0.09090997278690338, 0.09082945436239243, 0.09084068983793259, 0.09099318087100983, 0.09095495939254761, 0.09101568907499313, 0.09102694690227509, 0.09084746986627579, 0.09085870534181595, 0.09101122617721558], [0.09073422104120255, 0.09090986847877502, 0.09083854407072067, 0.09084849804639816, 0.0909835696220398, 0.09094972163438797, 0.09100351482629776, 0.09101348370313644, 0.09085450321435928, 0.09086445719003677, 0.0909995585680008], [0.0910399928689003, 0.09090845286846161, 0.09096181392669678, 0.09095436334609985, 0.09085338562726974, 0.09087866544723511, 0.09083849936723709, 0.09083105623722076, 0.09094986319541931, 0.09094241261482239, 0.09084144979715347]], [[0.09084385633468628, 0.09082009643316269, 0.0908578485250473, 0.09092199057340622, 0.09084108471870422, 0.09087884426116943, 0.09088584035634995, 0.09094999730587006, 0.09128091484308243, 0.09097940474748611, 0.09074004739522934], [0.09080316126346588, 0.09076462686061859, 0.09082586318254471, 0.09092992544174194, 0.09079866111278534, 0.09085991978645325, 0.09087126702070236, 0.09097539633512497, 0.09151317924261093, 0.09102313965559006, 0.09063483029603958], [0.09086780995130539, 0.0908527597784996, 0.09087666869163513, 0.09091728925704956, 0.09086604416370392, 0.09088996052742004, 0.09089439362287521, 0.09093502163887024, 0.09114439785480499, 0.09095363318920135, 0.09080203622579575], [0.090977244079113, 0.09100215882062912, 0.09096257388591766, 0.09089537709951401, 0.0909801498055458, 0.09094056487083435, 0.09093323349952698, 0.09086606651544571, 0.09052115678787231, 0.09083531051874161, 0.09108623117208481], [0.09083911776542664, 0.09081362932920456, 0.09085412323474884, 0.09092292189598083, 0.09083613753318787, 0.09087663888931274, 0.09088414907455444, 0.09095297008752823, 0.09130800515413284, 0.0909845158457756, 0.09072776883840561], [0.09090366959571838, 0.0909016951918602, 0.0909048393368721, 0.0909101665019989, 0.09090344607830048, 0.09090658277273178, 0.09090716391801834, 0.09091249853372574, 0.09093993902206421, 0.09091493487358093, 0.09089503437280655], [0.09091562032699585, 0.09091800451278687, 0.09091421961784363, 0.09090778231620789, 0.09091589599847794, 0.0909121111035347, 0.09091140329837799, 0.09090498089790344, 0.09087187796831131, 0.09090203046798706, 0.09092604368925095], [0.09102487564086914, 0.09106727689504623, 0.09099991619586945, 0.09088564664125443, 0.0910298228263855, 0.0909624844789505, 0.09095001220703125, 0.0908358097076416, 0.09025026112794876, 0.09078352898359299, 0.09121038764715195], [0.09158060699701309, 0.09183076024055481, 0.09143362194299698, 0.09076318889856339, 0.09160976856946945, 0.09121359139680862, 0.09114035964012146, 0.09047207981348038, 0.0871092900633812, 0.09016754478216171, 0.0926792174577713], [0.09107478708028793, 0.09113556146621704, 0.0910390242934227, 0.09087532013654709, 0.0910818874835968, 0.09098539501428604, 0.09096752852201462, 0.09080395102500916, 0.08996670693159103, 0.09072910994291306, 0.09134077280759811], [0.09066551923751831, 0.09057728201150894, 0.09071752429008484, 0.09095614403486252, 0.09065521508455276, 0.09079557657241821, 0.09082160890102386, 0.09106051176786423, 0.09230006486177444, 0.09117016941308975, 0.09028041362762451]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.63116007859576e-05, "episode_return_min": -14.5, "episode_return_mean": 0.45, "env_to_module_sum_episodes_length_out": 10.368237912813044, "env_reset_timer": 0.0007516709014759399, "num_env_steps_sampled_lifetime": 20400, "num_episodes": 20, "episode_duration_sec_mean": 0.005826629650255199, "module_episode_returns_mean": {"default_policy": 0.45}, "episode_len_min": 20, "episode_return_max": 13.5, "env_to_module_connector": {"connector_pipeline_timer": 6.823115478416983e-05, "timers": {"connectors": {"numpy_to_tensor": 1.3843563611283149e-05, "add_time_dim_to_batch_and_zero_pad": 8.548375371054984e-06, "batch_individual_items": 1.4600216189469652e-05, "add_states_from_episodes_to_batch": 3.0645508809921474e-06, "add_observations_from_episodes_to_batch": 3.731062054090762e-06}}}, "env_to_module_sum_episodes_length_in": 10.368237912813044, "episode_len_mean": 20.0, "num_episodes_lifetime": 80, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 5.030788652943474e-05, "listify_data_for_vector_env": 1.2321264934125756e-05, "un_batch_to_individual_items": 8.080092648323259e-06, "normalize_and_clip_actions": 9.132438493448591e-06, "remove_single_ts_time_rank_from_batch": 1.3635972102078745e-05, "tensor_to_numpy": 1.8366998287157373e-05}}, "connector_pipeline_timer": 0.00014098054017120545}, "num_env_steps_sampled": 400, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "num_agent_steps_sampled": {"default_agent": 400}, "env_step_timer": 2.1239857215038137e-05, "agent_episode_returns_mean": {"default_agent": 0.45}, "sample": 0.1311966333294158, "weights_seq_no": 4.0, "time_between_sampling": 9.315000911751449}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "b509c_00000", "date": "2025-08-11_18-29-58", "timestamp": 1754929798, "time_this_iter_s": 9.158294916152954, "time_total_s": 37.84328484535217, "pid": 11229, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x383ebd8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 37.84328484535217, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 35.64615384615385, "ram_util_percent": 77.58461538461538}}
{"timers": {"training_iteration": 9.837490762918723, "restore_env_runners": 1.0484925572730135e-05, "training_step": 9.83728061577818, "env_runner_sampling_timer": 1.6595224799021482, "learner_update_timer": 8.000799984077704, "synch_weights": 0.001697763338899012, "restore_eval_env_runners": 6.4918567811721e-05, "evaluation_iteration": 0.1443295434605668, "synch_eval_env_connectors": 0.0004259978657477768, "synch_env_connectors": 5.558414150844328e-06}, "env_runners": {"num_episodes_lifetime": -92125.0, "rlmodule_inference_timer": 3.282876678245472e-05, "episode_duration_sec_mean": 0.005479813113342973, "module_episode_returns_mean": {"default_policy": -0.4200000000000001}, "episode_return_min": -10.5, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2741999949816855e-05, "add_states_from_episodes_to_batch": 2.731836648870658e-06, "numpy_to_tensor": 1.2980311505621192e-05, "add_observations_from_episodes_to_batch": 2.8945321981018575e-06, "add_time_dim_to_batch_and_zero_pad": 7.215657328703632e-06}}, "connector_pipeline_timer": 6.139460131306251e-05}, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0768323219727622e-05, "un_batch_to_individual_items": 6.782621504008213e-06, "tensor_to_numpy": 1.786237467400763e-05, "normalize_and_clip_actions": 8.200005987360053e-06, "remove_single_ts_time_rank_from_batch": 1.2127765533678091e-05, "get_actions": 4.0644676792653895e-05}}, "connector_pipeline_timer": 0.00012401008509526186}, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "env_step_timer": 1.4492201207982585e-05, "time_between_sampling": 0.031159393966950756, "episode_return_mean": -0.4200000000000001, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_max": 9.5, "sample": 0.005837097174083572, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "env_reset_timer": 4.7041027934560134e-05, "num_env_steps_sampled_lifetime": -1842500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "agent_episode_returns_mean": {"default_agent": -0.4200000000000001}, "weights_seq_no": 4.0, "episode_len_mean": 20.0, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3154.727876302747}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13424288934479614, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008910775159103825, "add_observations_from_episodes_to_batch": 0.0009075901002706517, "add_columns_from_episodes_to_train_batch": 0.0413981699787591, "add_time_dim_to_batch_and_zero_pad": 0.07519822077862012, "add_states_from_episodes_to_batch": 0.0034568179394313505, "batch_individual_items": 0.0040658822130310805, "numpy_to_tensor": 7.195390475137508e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "weights_seq_no": 5.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 29925, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.8691961675322, "num_module_steps_trained": 5985, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime_throughput": 797.6429014970311}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_env_steps_trained_lifetime": 990000, "num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_module_steps_trained_lifetime": 359100, "num_env_steps_trained_lifetime_throughput": 57810.12614953931}, "default_policy": {"use_intrinsic_rewards": 1.0, "policy_loss": -0.00025307113537564874, "weights_seq_no": 30.0, "vf_explained_var": 0.0010755658149719238, "module_train_batch_size_mean": 997.5798029998547, "total_loss": 0.2781394422054291, "num_module_steps_trained_lifetime": 179550, "diff_num_grad_updates_vs_sampler_policy": 26.0, "vf_loss_unclipped": 43.58478546142578, "mean_kl_loss": 8.778387382335495e-06, "entropy": 0.6919085383415222, "num_module_steps_trained": 35910, "vf_loss": 0.3587169051170349}, "intrinsic_reward_module": {"total_loss": 0.0, "weights_seq_no": 30.0, "num_module_steps_trained_lifetime": 179550, "diff_num_grad_updates_vs_sampler_policy": 26.0, "module_train_batch_size_mean": 997.5798029998547, "num_module_steps_trained": 35910}}}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 33000, "num_module_steps_trained_lifetime": 59850, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 165000, "num_env_steps_trained_lifetime_throughput": 4399.79567471349, "num_module_steps_trained_throughput": 29017664.260516044, "num_module_steps_trained_lifetime_throughput": 12612723.31462356}, "default_policy": {"weights_seq_no": 5.0, "vf_explained_var": -0.0009927749633789062, "module_train_batch_size_mean": 997.8691961675322, "total_loss": 0.27779269218444824, "num_module_steps_trained_lifetime": 29925, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 43.72691345214844, "mean_kl_loss": 1.0779986951092724e-05, "curr_kl_coeff": 0.0050494978204369545, "entropy": 0.6918861865997314, "num_module_steps_trained": 5985, "vf_loss": 0.35830768942832947, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "use_intrinsic_rewards": 0.0, "policy_loss": -0.0002796946500893682, "num_module_steps_trained_lifetime_throughput": 797.6281640243142}, "IntrinsicAttentionMask": [[[0.09043970704078674, 0.09057536721229553, 0.0910554975271225, 0.09108230471611023, 0.0907728299498558, 0.09068210422992706, 0.0911627933382988, 0.09118963778018951, 0.09076223522424698, 0.09112531691789627, 0.09115215390920639], [0.09055416285991669, 0.0906568095088005, 0.09101980179548264, 0.09104005247354507, 0.09080615639686584, 0.09073754400014877, 0.09110085666179657, 0.0911211296916008, 0.09079814702272415, 0.09107254445552826, 0.09109281748533249], [0.09095866233110428, 0.09094429761171341, 0.09089363366365433, 0.0908908098936081, 0.09092342108488083, 0.09093300998210907, 0.09088235348463058, 0.09087952971458435, 0.09092453867197037, 0.09088628739118576, 0.09088347107172012], [0.09098122268915176, 0.0909603089094162, 0.09088659286499023, 0.09088248759508133, 0.09092994034290314, 0.09094388782978058, 0.09087017923593521, 0.0908660814166069, 0.09093156456947327, 0.09087590873241425, 0.09087180346250534], [0.09072063118219376, 0.09077517688274384, 0.09096787124872208, 0.09097861498594284, 0.09085450321435928, 0.09081806987524033, 0.09101084619760513, 0.0910215973854065, 0.09085024893283844, 0.09099584072828293, 0.09100659191608429], [0.09064415842294693, 0.09072081744670868, 0.09099172055721283, 0.09100683033466339, 0.09083230793476105, 0.09078109264373779, 0.09105217456817627, 0.09106729924678802, 0.09082632511854172, 0.09103106707334518, 0.09104618430137634], [0.09104893356561661, 0.09100838005542755, 0.09086547046899796, 0.09085752069950104, 0.09094948321580887, 0.0909765213727951, 0.09083367139101028, 0.09082572162151337, 0.09095263481140137, 0.0908447653055191, 0.09083681553602219], [0.09107152372598648, 0.09102441370487213, 0.09085844457149506, 0.09084920585155487, 0.09095600992441177, 0.09098741412162781, 0.09082150459289551, 0.09081228077411652, 0.09095967561006546, 0.09083440154790878, 0.0908251628279686], [0.09071169793605804, 0.09076883643865585, 0.09097065776586533, 0.09098190814256668, 0.09085191041231155, 0.09081375598907471, 0.09101567417383194, 0.09102693200111389, 0.0908474549651146, 0.09099995344877243, 0.09101121127605438], [0.09101741760969162, 0.09098600596189499, 0.0908753052353859, 0.09086915105581284, 0.09094039350748062, 0.09096133708953857, 0.09085066616535187, 0.09084451198577881, 0.09094283729791641, 0.09085927158594131, 0.09085310995578766], [0.0910399854183197, 0.09100202471017838, 0.0908682644367218, 0.09086082130670547, 0.09094690531492233, 0.09097221493721008, 0.0908384919166565, 0.09083104878664017, 0.09094985574483871, 0.0908488854765892, 0.09084144234657288]], [[0.09082789719104767, 0.0908920094370842, 0.0909297838807106, 0.09090600907802582, 0.09082511812448502, 0.09086287021636963, 0.09095780551433563, 0.09084610641002655, 0.09126487374305725, 0.09096341580152512, 0.09072410315275192], [0.09096426516771317, 0.09092060476541519, 0.0908949077129364, 0.09091108292341232, 0.09096615761518478, 0.0909404382109642, 0.09087585657835007, 0.09095185995101929, 0.0906677097082138, 0.09087204188108444, 0.09103506058454514], [0.09104443341493607, 0.09093720465898514, 0.09087412059307098, 0.0909138172864914, 0.09104907512664795, 0.09098590910434723, 0.09082739055156708, 0.09101395308971405, 0.09031761437654495, 0.09081802517175674, 0.09121844172477722], [0.09099399298429489, 0.09092677384614944, 0.09088721871376038, 0.0909121185541153, 0.09099690616130829, 0.09095731377601624, 0.09085791558027267, 0.09097488969564438, 0.09053782373666763, 0.0908520370721817, 0.09110300242900848], [0.09082198888063431, 0.09089075773954391, 0.09093128889799118, 0.09090577811002731, 0.09081900864839554, 0.09085950255393982, 0.09096133708953857, 0.09084152430295944, 0.09129078686237335, 0.09096735715866089, 0.09071065485477448], [0.09090234339237213, 0.09090767800807953, 0.09091081470251083, 0.09090884029865265, 0.09090211987495422, 0.09090525656938553, 0.09091313928365707, 0.0909038633108139, 0.09093861281871796, 0.09091360867023468, 0.0908937081694603], [0.09110377728939056, 0.0909493938088417, 0.09085860848426819, 0.0909157320857048, 0.0911104679107666, 0.09101951122283936, 0.09079135954380035, 0.09105989336967468, 0.09005887806415558, 0.09077788889408112, 0.09135448932647705], [0.09086667001247406, 0.09090018272399902, 0.09091992676258087, 0.0909074991941452, 0.09086522459983826, 0.09088496118783951, 0.09093456715345383, 0.09087619185447693, 0.09109485894441605, 0.09093749523162842, 0.09081239998340607], [0.09174913167953491, 0.09107638895511627, 0.09068252146244049, 0.09093021601438522, 0.09177835285663605, 0.09138144552707672, 0.09039166569709778, 0.09155748784542084, 0.08726958930492401, 0.0903334766626358, 0.09284976869821548], [0.09111566096544266, 0.0909518226981163, 0.09085547924041748, 0.09091610461473465, 0.09112276136875153, 0.09102622419595718, 0.09078412503004074, 0.09106907993555069, 0.09000708907842636, 0.09076982736587524, 0.09138176590204239], [0.09060623496770859, 0.09084456413984299, 0.09098521620035172, 0.09089666604995728, 0.09059593826532364, 0.09073620289564133, 0.09108960628509521, 0.09067388623952866, 0.09223970770835876, 0.09111054986715317, 0.09022138267755508]], [[0.09047017246484756, 0.09060587733983994, 0.09074994921684265, 0.09111298620700836, 0.09113981574773788, 0.09071264415979385, 0.09119349718093872, 0.09088364243507385, 0.09112917631864548, 0.091156005859375, 0.09084628522396088], [0.09057720005512238, 0.09067986905574799, 0.090788833796978, 0.09106320887804031, 0.09108348190784454, 0.09076062589883804, 0.091124027967453, 0.09088991582393646, 0.09107544273138046, 0.09109571576118469, 0.09086167067289352], [0.09069075435400009, 0.09075834602117538, 0.09083003550767899, 0.0910104438662529, 0.0910237655043602, 0.09081147611141205, 0.0910504087805748, 0.09089651703834534, 0.09101849049329758, 0.09103180468082428, 0.0908779501914978], [0.0909765362739563, 0.09095562994480133, 0.09093346446752548, 0.09087780863046646, 0.09087370336055756, 0.09093920141458511, 0.09086550027132034, 0.09091293811798096, 0.09087532758712769, 0.09087122976779938, 0.09091867506504059], [0.09099762886762619, 0.09097017347812653, 0.09094107896089554, 0.0908680111169815, 0.09086263179779053, 0.09094861149787903, 0.09085185825824738, 0.09091413021087646, 0.09086476266384125, 0.09085937589406967, 0.09092165529727936], [0.09066136181354523, 0.09073803573846817, 0.09081938117742538, 0.09102410078048706, 0.09103921800851822, 0.09079832583665848, 0.09106945991516113, 0.09089481085538864, 0.09103322774171829, 0.09104834496974945, 0.09087374061346054], [0.09103984385728836, 0.0909992903470993, 0.09095632284879684, 0.09084844589233398, 0.09084049612283707, 0.09096743911504745, 0.09082460403442383, 0.09091653674840927, 0.09084364771842957, 0.09083569794893265, 0.09092764556407928], [0.09079606086015701, 0.09083107113838196, 0.09086819738149643, 0.09096154570579529, 0.09096843749284744, 0.0908585861325264, 0.09098221361637115, 0.09090260416269302, 0.09096570312976837, 0.09097259491682053, 0.09089299291372299], [0.09098926931619644, 0.0909644067287445, 0.09093806892633438, 0.0908719003200531, 0.09086702018976212, 0.09094487875699997, 0.09085726737976074, 0.09091366082429886, 0.09086895734071732, 0.09086408466100693, 0.09092047810554504], [0.09101036936044693, 0.0909789577126503, 0.09094568341970444, 0.09086211025714874, 0.09085594862699509, 0.09095429629087448, 0.09084363281726837, 0.09091486036777496, 0.09085839241743088, 0.09085223823785782, 0.09092346578836441], [0.09076663851737976, 0.09081075340509415, 0.09085754305124283, 0.09097520262002945, 0.09098388999700546, 0.09084542840719223, 0.09100125730037689, 0.09090090543031693, 0.09098044782876968, 0.0909891277551651, 0.09088879078626633]], [[0.09085184335708618, 0.09082808345556259, 0.0908658355474472, 0.09092997759580612, 0.09084907174110413, 0.09088683128356934, 0.09089382737874985, 0.09087006002664566, 0.09128893911838531, 0.09098739922046661, 0.09074802696704865], [0.09081611782312393, 0.09077757596969604, 0.09083881229162216, 0.09094289690256119, 0.09081161767244339, 0.0908728763461113, 0.09088423103094101, 0.09084566682577133, 0.09152623265981674, 0.0910361185669899, 0.09064775705337524], [0.0908728539943695, 0.09085781127214432, 0.09088172018527985, 0.09092234075069427, 0.09087109565734863, 0.09089501202106476, 0.09089944511651993, 0.09088439494371414, 0.0911494642496109, 0.09095869213342667, 0.09080708026885986], [0.09096886217594147, 0.09099377691745758, 0.09095419198274612, 0.09088701009750366, 0.09097176790237427, 0.09093219041824341, 0.09092485904693604, 0.09094976633787155, 0.09051281213760376, 0.09082694351673126, 0.09107784181833267], [0.0908476933836937, 0.09082220494747162, 0.0908626988530159, 0.09093150496482849, 0.09084471315145493, 0.0908852219581604, 0.0908927246928215, 0.09086723625659943, 0.09131662547588348, 0.09099310636520386, 0.09073632955551147], [0.0909043401479721, 0.09090236574411392, 0.09090550988912582, 0.09091083705425262, 0.0909041166305542, 0.0909072533249855, 0.09090783447027206, 0.09090586006641388, 0.09094060957431793, 0.09091560542583466, 0.09089570492506027], [0.09091482311487198, 0.090917207300663, 0.09091342240571976, 0.09090698510408401, 0.09091509878635406, 0.09091131389141083, 0.09091060608625412, 0.09091299027204514, 0.09087108075618744, 0.09090123325586319, 0.09092524647712708], [0.09087919443845749, 0.09086677432060242, 0.09088651090860367, 0.09092003107070923, 0.09087774157524109, 0.09089748561382294, 0.09090113639831543, 0.09088871628046036, 0.09110741317272186, 0.09095002710819244, 0.0908249095082283], [0.09149667620658875, 0.09174659848213196, 0.09134982526302338, 0.09068001061677933, 0.09152580797672272, 0.09112999588251114, 0.09105683118104935, 0.09130555391311646, 0.08702945709228516, 0.09008491039276123, 0.09259428083896637], [0.09105436503887177, 0.09111513197422028, 0.09101860970258713, 0.0908549427986145, 0.09106145799160004, 0.09096499532461166, 0.09094712883234024, 0.09100782126188278, 0.08994653820991516, 0.09070876240730286, 0.09132029116153717], [0.09069520235061646, 0.0906069353222847, 0.09074722230434418, 0.09098592400550842, 0.09068489819765091, 0.09082530438899994, 0.09085134416818619, 0.0907629206776619, 0.09233028441667557, 0.09120001643896103, 0.0903099775314331]], [[0.09047015756368637, 0.09060586988925934, 0.09108614921569824, 0.09111297130584717, 0.09113980829715729, 0.09071263670921326, 0.0908568799495697, 0.09122034162282944, 0.09079279750585556, 0.09081953018903732, 0.09118284285068512], [0.09057719260454178, 0.09067986160516739, 0.09104294329881668, 0.09106320142745972, 0.09108347445726395, 0.09076061844825745, 0.09086968004703522, 0.09114430099725723, 0.09082123637199402, 0.09084144234657288, 0.09111598134040833], [0.09095544368028641, 0.09094107896089554, 0.09089041501283646, 0.09088759869337082, 0.09088477492332458, 0.0909297913312912, 0.09091456234455109, 0.09087631106376648, 0.0909213200211525, 0.09091850370168686, 0.09088025242090225], [0.0909765362739563, 0.09095562994480133, 0.09088191390037537, 0.09087780863046646, 0.09087370336055756, 0.09093920141458511, 0.09091704338788986, 0.09086139500141144, 0.0909268781542778, 0.0909227728843689, 0.09086712449789047], [0.09099764376878738, 0.09097018837928772, 0.09087341278791428, 0.0908680260181427, 0.09086264669895172, 0.09094862639904022, 0.09091953188180923, 0.090846486389637, 0.0909324511885643, 0.09092706441879272, 0.09085401147603989], [0.09066136181354523, 0.09073803573846817, 0.0910089910030365, 0.09102410823106766, 0.09103921800851822, 0.09079832583665848, 0.09087972342967987, 0.09108458459377289, 0.090843565762043, 0.09085865318775177, 0.09106346219778061], [0.09077499806880951, 0.09081652015447617, 0.09096315503120422, 0.09097132831811905, 0.09097950160503387, 0.09084916859865189, 0.0908932238817215, 0.09100402891635895, 0.09087365865707397, 0.0908818170428276, 0.09099260717630386], [0.09106095135211945, 0.0910138413310051, 0.09084789454936981, 0.09083865582942963, 0.09082943201065063, 0.09097684919834137, 0.09092696756124496, 0.09080173820257187, 0.09094911813735962, 0.09093987196683884, 0.09081462025642395], [0.09072452038526535, 0.09078166633844376, 0.09098351746797562, 0.09099476784467697, 0.09100602567195892, 0.0908265933394432, 0.09088723361492157, 0.09103979915380478, 0.09086029976606369, 0.09087153524160385, 0.09102407097816467], [0.09074557572603226, 0.09079620242118835, 0.09097501635551453, 0.09098498523235321, 0.0909949541091919, 0.09083600342273712, 0.09088972955942154, 0.09102486819028854, 0.09086586534976959, 0.09087582677602768, 0.0910109430551529], [0.09103147685527802, 0.09099352359771729, 0.09085977077484131, 0.09085232764482498, 0.09084488451480865, 0.09096371382474899, 0.09092351049184799, 0.09082256257534027, 0.09094135463237762, 0.0909339115023613, 0.09083295613527298]], [[0.09086786955595016, 0.09084410220384598, 0.09088186174631119, 0.090858094394207, 0.09086509048938751, 0.09090285748243332, 0.09090986102819443, 0.09097403287887573, 0.09121677279472351, 0.09091547131538391, 0.09076403081417084], [0.09084212779998779, 0.09080357849597931, 0.09086483716964722, 0.09082628041505814, 0.09083762764930725, 0.09089890867471695, 0.09091027081012726, 0.09101443737745285, 0.0914088636636734, 0.0909193828701973, 0.09067372232675552], [0.09088299423456192, 0.09086794406175613, 0.09089186787605286, 0.09087681025266647, 0.09088124334812164, 0.09090515971183777, 0.09090959280729294, 0.09095022082328796, 0.09110382199287415, 0.09091314673423767, 0.09081722050905228], [0.09085728973150253, 0.09082744270563126, 0.09087486565113068, 0.0908450186252594, 0.09085380285978317, 0.09090124070644379, 0.09091003239154816, 0.09099064767360687, 0.09129570424556732, 0.09091708064079285, 0.09072688966989517], [0.09086485952138901, 0.09083937108516693, 0.09087987244129181, 0.09085437655448914, 0.09086188673973083, 0.09090239554643631, 0.09090990573167801, 0.09097874909639359, 0.09123916923999786, 0.09091592580080032, 0.090753473341465], [0.09090566635131836, 0.09090369194746017, 0.09090682864189148, 0.0909048542380333, 0.09090544283390045, 0.09090857952833176, 0.09090916067361832, 0.09091448783874512, 0.0909346267580986, 0.09090962260961533, 0.09089703112840652], [0.09091322124004364, 0.09091560542583466, 0.09091182053089142, 0.09091420471668243, 0.09091349691152573, 0.09090971201658249, 0.09090900421142578, 0.09090258181095123, 0.09087829291820526, 0.09090844541788101, 0.09092364460229874], [0.09098223596811295, 0.09102461487054825, 0.09095728397369385, 0.09099965542554855, 0.0909871757030487, 0.0909198746085167, 0.09090740978717804, 0.09079325199127197, 0.09036347270011902, 0.09089741110801697, 0.09116765856742859], [0.09123995900154114, 0.09143409132957458, 0.09112584590911865, 0.0913197323679924, 0.09126260131597519, 0.09095493704080582, 0.09089803695678711, 0.0903783068060875, 0.0884423553943634, 0.09085244685411453, 0.0920916497707367], [0.09091927111148834, 0.09092515707015991, 0.09091580659151077, 0.09092169255018234, 0.09091995656490326, 0.09091061353683472, 0.09090887755155563, 0.09089302271604538, 0.0908331423997879, 0.0909074917435646, 0.09094498306512833], [0.09075503051280975, 0.09066671133041382, 0.09080708771944046, 0.09071870893239975, 0.09074472635984421, 0.0908852145075798, 0.09091127663850784, 0.09115041047334671, 0.09205912053585052, 0.09093217551708221, 0.09036955237388611]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.403263212642341e-05, "episode_return_min": -14.5, "episode_return_mean": 0.85, "env_to_module_sum_episodes_length_out": 10.368238387501162, "env_reset_timer": 0.000747906692512813, "num_env_steps_sampled_lifetime": 25400, "num_episodes": 20, "episode_duration_sec_mean": 0.00579405871219933, "module_episode_returns_mean": {"default_policy": 0.85}, "episode_len_min": 20, "episode_return_max": 13.5, "env_to_module_connector": {"connector_pipeline_timer": 6.151491366275745e-05, "timers": {"connectors": {"numpy_to_tensor": 1.2749224073148026e-05, "add_time_dim_to_batch_and_zero_pad": 7.3117051427197205e-06, "batch_individual_items": 1.2945095878269476e-05, "add_states_from_episodes_to_batch": 2.8878174581732213e-06, "add_observations_from_episodes_to_batch": 2.9219384944317768e-06}}}, "env_to_module_sum_episodes_length_in": 10.368238387501162, "episode_len_mean": 20.0, "num_episodes_lifetime": 100, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.07167933116388e-05, "listify_data_for_vector_env": 1.095079564701547e-05, "un_batch_to_individual_items": 6.8873191801128746e-06, "normalize_and_clip_actions": 8.424549306420653e-06, "remove_single_ts_time_rank_from_batch": 1.2413624178378759e-05, "tensor_to_numpy": 1.585715110827111e-05}}, "connector_pipeline_timer": 0.000121984946048783}, "num_env_steps_sampled": 400, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "num_agent_steps_sampled": {"default_agent": 400}, "env_step_timer": 1.5101894438065366e-05, "agent_episode_returns_mean": {"default_agent": 0.85}, "sample": 0.13113636074592197, "weights_seq_no": 5.0, "time_between_sampling": 9.312760928464314}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "b509c_00000", "date": "2025-08-11_18-30-08", "timestamp": 1754929808, "time_this_iter_s": 9.195864915847778, "time_total_s": 47.03914976119995, "pid": 11229, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x383ebd8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 47.03914976119995, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 36.684615384615384, "ram_util_percent": 77.00769230769231}}
{"timers": {"training_iteration": 9.83024759486984, "restore_env_runners": 1.0440905650963843e-05, "training_step": 9.830037127540821, "env_runner_sampling_timer": 1.6585317246837026, "learner_update_timer": 7.99446262507619, "synch_weights": 0.0016895411260774897, "restore_eval_env_runners": 6.437522228759597e-05, "evaluation_iteration": 0.14422878885517076, "synch_eval_env_connectors": 0.00042323704635188335, "synch_env_connectors": 5.54283031391562e-06}, "env_runners": {"num_episodes_lifetime": -123000.0, "rlmodule_inference_timer": 3.18845916616528e-05, "episode_duration_sec_mean": 0.0053492299695499235, "module_episode_returns_mean": {"default_policy": 0.22}, "episode_return_min": -10.5, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2641518116740226e-05, "add_states_from_episodes_to_batch": 2.719258993706082e-06, "numpy_to_tensor": 1.273718556083232e-05, "add_observations_from_episodes_to_batch": 2.8759118096601604e-06, "add_time_dim_to_batch_and_zero_pad": 7.192924283181556e-06}}, "connector_pipeline_timer": 6.089616438670245e-05}, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0617642417472502e-05, "un_batch_to_individual_items": 6.724161517312368e-06, "tensor_to_numpy": 1.5564298014159918e-05, "normalize_and_clip_actions": 8.107275188099075e-06, "remove_single_ts_time_rank_from_batch": 1.2042457491248961e-05, "get_actions": 3.9384031673367184e-05}}, "connector_pipeline_timer": 0.00011959874490760118}, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "env_step_timer": 1.4159352983980442e-05, "time_between_sampling": 0.030977070382319994, "episode_return_mean": 0.22, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_max": 9.5, "sample": 0.00575208451885968, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "env_reset_timer": 4.568195807670957e-05, "num_env_steps_sampled_lifetime": -2460000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "agent_episode_returns_mean": {"default_agent": 0.22}, "weights_seq_no": 5.0, "episode_len_mean": 20.0, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3195.234606776124}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13425071836143776, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008909861577315378, "add_observations_from_episodes_to_batch": 0.000907306699279568, "add_columns_from_episodes_to_train_batch": 0.041397192448212106, "add_time_dim_to_batch_and_zero_pad": 0.07520843607069586, "add_states_from_episodes_to_batch": 0.003458203929034742, "batch_individual_items": 0.004065710471014732, "numpy_to_tensor": 7.184686629320224e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "weights_seq_no": 6.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 35910, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.8474438281662, "num_module_steps_trained": 5985, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime_throughput": 795.6740486995974}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_env_steps_trained_lifetime": 1188000, "num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_module_steps_trained_lifetime": 430920, "num_env_steps_trained_lifetime_throughput": 56916.23885428123}, "default_policy": {"use_intrinsic_rewards": 1.0, "policy_loss": -0.00021536684653256088, "weights_seq_no": 36.0, "vf_explained_var": 0.0010448098182678223, "module_train_batch_size_mean": 997.5548130830801, "total_loss": 0.2781587243080139, "num_module_steps_trained_lifetime": 215460, "diff_num_grad_updates_vs_sampler_policy": 31.0, "vf_loss_unclipped": 43.59877014160156, "mean_kl_loss": 6.714900519000366e-05, "entropy": 0.6913254857063293, "num_module_steps_trained": 35910, "vf_loss": 0.3586800694465637}, "intrinsic_reward_module": {"total_loss": 0.0, "weights_seq_no": 36.0, "num_module_steps_trained_lifetime": 215460, "diff_num_grad_updates_vs_sampler_policy": 31.0, "module_train_batch_size_mean": 997.5548130830801, "num_module_steps_trained": 35910}}}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 33000, "num_module_steps_trained_lifetime": 71820, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 198000, "num_env_steps_trained_lifetime_throughput": 4388.882234111461, "num_module_steps_trained_throughput": 28202203.65967077, "num_module_steps_trained_lifetime_throughput": 12588481.530151023}, "default_policy": {"weights_seq_no": 6.0, "vf_explained_var": -0.001384139060974121, "module_train_batch_size_mean": 997.8474438281662, "total_loss": 0.2778514325618744, "num_module_steps_trained_lifetime": 35910, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 43.58856201171875, "mean_kl_loss": 6.859613495180383e-05, "curr_kl_coeff": 0.0025247489102184772, "entropy": 0.6913182139396667, "num_module_steps_trained": 5985, "vf_loss": 0.3583052456378937, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "use_intrinsic_rewards": 0.0, "policy_loss": -0.00022017616720404476, "num_module_steps_trained_lifetime_throughput": 795.6599653200589}, "IntrinsicAttentionMask": [[[0.09085892140865326, 0.09086956083774567, 0.09092698246240616, 0.09093762934207916, 0.09081465005874634, 0.0909121185541153, 0.09096956998109818, 0.09084655344486237, 0.09094405174255371, 0.09095469862222672, 0.09096534550189972], [0.09086497128009796, 0.0908743217587471, 0.09092482179403305, 0.09093418717384338, 0.09082603454589844, 0.09091174602508545, 0.09096226841211319, 0.09085408598184586, 0.09093983471393585, 0.09094919264316559, 0.09095855802297592], [0.09089762717485428, 0.09090006351470947, 0.09091317653656006, 0.09091560542583466, 0.09088750928640366, 0.09090978652238846, 0.09092289954423904, 0.09089480340480804, 0.09091707319021225, 0.09091950953006744, 0.09092193841934204], [0.09090369194746017, 0.0909048318862915, 0.09091102331876755, 0.09091217070817947, 0.09089891612529755, 0.09090942144393921, 0.09091561287641525, 0.09090235829353333, 0.09091286361217499, 0.09091401100158691, 0.09091515839099884], [0.09083371609449387, 0.09084969013929367, 0.09093595296144485, 0.09095194190740585, 0.09076723456382751, 0.09091362357139587, 0.09099993854761124, 0.09081513434648514, 0.09096159785985947, 0.09097759425640106, 0.09099359065294266], [0.09088918566703796, 0.09089341014623642, 0.09091619402170181, 0.09092041850090027, 0.09087160974740982, 0.09091029316186905, 0.09093309193849564, 0.09088427573442459, 0.09092296659946442, 0.09092719852924347, 0.09093141555786133], [0.09092184156179428, 0.0909191370010376, 0.09090454131364822, 0.09090183675289154, 0.09093310683965683, 0.09090831875801086, 0.09089373052120209, 0.09092499315738678, 0.09090020507574081, 0.09089750051498413, 0.09089479595422745], [0.09085187315940857, 0.09086400270462036, 0.09092948585748672, 0.09094161540269852, 0.09080139547586441, 0.09091252833604813, 0.09097804874181747, 0.090837761759758, 0.09094894677400589, 0.09096109122037888, 0.09097323566675186], [0.09090733528137207, 0.09090770781040192, 0.09090971201658249, 0.09091008454561234, 0.09090578556060791, 0.0909091979265213, 0.09091120213270187, 0.09090690314769745, 0.09091030806303024, 0.09091068059206009, 0.09091105312108994], [0.09091339260339737, 0.09091248363256454, 0.09090756624937057, 0.09090664982795715, 0.0909171923995018, 0.09090883284807205, 0.09090391546487808, 0.09091445803642273, 0.09090609848499298, 0.09090518951416016, 0.09090428054332733], [0.09091944247484207, 0.09091724455356598, 0.09090539813041687, 0.09090320020914078, 0.0909285843372345, 0.0909084603190422, 0.0908966213464737, 0.09092199057340622, 0.09090187400579453, 0.09089968353509903, 0.09089748561382294]], [[0.09087930619716644, 0.09102494269609451, 0.09086106717586517, 0.09100668132305145, 0.09088291972875595, 0.09083370864391327, 0.09093914926052094, 0.09097015857696533, 0.09054060280323029, 0.09093183279037476, 0.0911296159029007], [0.09094587713479996, 0.09076470881700516, 0.09096861630678177, 0.09078739583492279, 0.09094137698411942, 0.09100272506475449, 0.09087135642766953, 0.09083279222249985, 0.09136973321437836, 0.09088046103715897, 0.09063490480184555], [0.09087087959051132, 0.09105753898620605, 0.09084750711917877, 0.09103412181138992, 0.09087551385164261, 0.09081246703863144, 0.09094756841659546, 0.09098730236291885, 0.09043712913990021, 0.09093819558620453, 0.09119173139333725], [0.09093759208917618, 0.09079734236001968, 0.09095519036054611, 0.09081491827964783, 0.09093410521745682, 0.09098158031702042, 0.0908799096941948, 0.09085005521774292, 0.09126545488834381, 0.09088695794343948, 0.09069682657718658], [0.09088097512722015, 0.09101849049329758, 0.09086374938488007, 0.0910012423992157, 0.09088438749313354, 0.09083792567253113, 0.09093748033046722, 0.09096675366163254, 0.09056112170219421, 0.09093057364225388, 0.09111730754375458], [0.09085822105407715, 0.09110642224550247, 0.09082715958356857, 0.09107527136802673, 0.0908643826842308, 0.0907805934548378, 0.09096018224954605, 0.09101301431655884, 0.09028211236000061, 0.0909477099776268, 0.09128496050834656], [0.09090680629014969, 0.09091800451278687, 0.09090539813041687, 0.09091660380363464, 0.09090708196163177, 0.09090328961610794, 0.09091140329837799, 0.090913787484169, 0.09088069200515747, 0.09091084450483322, 0.09092604368925095], [0.09092096984386444, 0.09086260944604874, 0.09092829376459122, 0.09086992591619492, 0.09091951698064804, 0.09093926846981049, 0.09089697152376175, 0.09088455140590668, 0.0910572037100792, 0.09089990705251694, 0.09082074463367462], [0.09071991592645645, 0.09163028746843338, 0.0906064510345459, 0.0915156826376915, 0.09074243158102036, 0.09043651819229126, 0.09109308570623398, 0.09128689765930176, 0.08863213658332825, 0.09104739874601364, 0.0922892615199089], [0.09090345352888107, 0.09093108028173447, 0.0908999964594841, 0.0909276157617569, 0.09090413898229599, 0.09089480340480804, 0.09091480821371078, 0.09092069417238235, 0.09083906561136246, 0.09091342240571976, 0.09095091372728348], [0.0909930095076561, 0.09057772904634476, 0.09104519337415695, 0.09062966704368591, 0.09098266810178757, 0.0911235362291336, 0.09082204848527908, 0.09073366224765778, 0.09196876734495163, 0.09084292501211166, 0.09028085321187973]], [[0.09043975919485092, 0.09091098606586456, 0.09071944653987885, 0.09074616432189941, 0.09110917896032333, 0.09068215638399124, 0.09116284549236298, 0.09118968993425369, 0.09109854698181152, 0.09078901261091232, 0.09115220606327057], [0.09083696454763412, 0.09090942144393921, 0.09088001400232315, 0.09088411182165146, 0.09093979746103287, 0.09087427705526352, 0.09094801545143127, 0.09095212817192078, 0.09093817323446274, 0.09089069813489914, 0.09094639122486115], [0.09067560732364655, 0.09091011434793472, 0.09081486612558365, 0.09082815796136856, 0.09100855886936188, 0.09079631417989731, 0.09103520214557648, 0.09104852378368378, 0.09100328385829926, 0.09084947407245636, 0.09102991968393326], [0.09069811552762985, 0.09091001749038696, 0.0908239558339119, 0.09083596616983414, 0.09099896252155304, 0.09080719202756882, 0.0910230278968811, 0.09103506058454514, 0.09099419414997101, 0.09085522592067719, 0.09101825952529907], [0.09100379049777985, 0.09090862423181534, 0.0909472405910492, 0.09094184637069702, 0.09086877852678299, 0.09095476567745209, 0.09085800498723984, 0.09085262566804886, 0.0908709168434143, 0.09093320369720459, 0.09086014330387115], [0.09064417332410812, 0.09091024100780487, 0.0908021628856659, 0.09081724286079407, 0.09102195501327515, 0.09078110754489899, 0.09105218946933746, 0.09106731414794922, 0.09101597219705582, 0.09084142744541168, 0.09104619920253754], [0.0910489410161972, 0.09090840816497803, 0.09096541255712509, 0.09095745533704758, 0.09084957838058472, 0.0909765288233757, 0.09083367884159088, 0.09082572907209396, 0.09085272252559662, 0.09094469249248505, 0.09083682298660278], [0.09107152372598648, 0.09090828895568848, 0.09097450226545334, 0.09096525609493256, 0.09083997458219528, 0.09098741412162781, 0.09082150459289551, 0.09081228077411652, 0.09084363281726837, 0.09095042943954468, 0.0908251628279686], [0.09099484235048294, 0.09090866893529892, 0.09094363451004028, 0.0909387543797493, 0.09087258577346802, 0.09095045179128647, 0.09086283296346664, 0.09085796028375626, 0.09087452292442322, 0.09093092381954193, 0.09086476266384125], [0.09073422104120255, 0.09090986847877502, 0.09083854407072067, 0.09084849804639816, 0.0909835696220398, 0.09082464873790741, 0.09100351482629776, 0.09101348370313644, 0.09097962081432343, 0.09086445719003677, 0.0909995585680008], [0.0910399854183197, 0.09090844541788101, 0.09096180647611618, 0.09095435589551926, 0.09085337817668915, 0.09097221493721008, 0.0908384919166565, 0.09083104878664017, 0.09085632860660553, 0.09094240516424179, 0.09084144234657288]], [[0.09087932109832764, 0.09091030061244965, 0.09086108207702637, 0.09089205414056778, 0.09099756181240082, 0.09094829112291336, 0.09093916416168213, 0.09097017347812653, 0.09054061770439148, 0.09093184769153595, 0.09112963080406189], [0.09089356660842896, 0.09090974181890488, 0.09088404476642609, 0.09090021997690201, 0.09095528721809387, 0.09092957526445389, 0.09092480689287186, 0.09094099700450897, 0.09071655571460724, 0.09092099219560623, 0.09102418273687363], [0.09087090194225311, 0.09091059863567352, 0.09084752947092056, 0.09088721871376038, 0.09102243185043335, 0.09095928817987442, 0.09094759076833725, 0.09098732471466064, 0.090437151491642, 0.09093821793794632, 0.09119175374507904], [0.09088518470525742, 0.09091007709503174, 0.09087052196264267, 0.09089541435241699, 0.09098018705844879, 0.09094060212373734, 0.09093327075242996, 0.09095817804336548, 0.09061291813850403, 0.09092739224433899, 0.09108626842498779], [0.09093345701694489, 0.09090794622898102, 0.09094848483800888, 0.09092296659946442, 0.09083618968725204, 0.09087668359279633, 0.09088419377803802, 0.09085870534181595, 0.09121336787939072, 0.09089021384716034, 0.09072781354188919], [0.09091098606586456, 0.09090900421142578, 0.09091214090585709, 0.0909101665019989, 0.09090344607830048, 0.09090658277273178, 0.09090716391801834, 0.09090518951416016, 0.09093263000249863, 0.09090762585401535, 0.09089503437280655], [0.09090680629014969, 0.0909091904759407, 0.09090539813041687, 0.09090778231620789, 0.09091589599847794, 0.0909121111035347, 0.09091140329837799, 0.090913787484169, 0.09088069200515747, 0.09091084450483322, 0.09092604368925095], [0.09092096984386444, 0.09090854972600937, 0.09092829376459122, 0.09091586619615555, 0.09087357670068741, 0.09089331328868866, 0.09089697152376175, 0.09088455140590668, 0.0910572037100792, 0.09089990705251694, 0.09082074463367462], [0.0907202959060669, 0.0909133180975914, 0.09060683101415634, 0.09079961478710175, 0.09145881980657578, 0.09115049242973328, 0.09109346568584442, 0.0912872850894928, 0.0886325091123581, 0.09104777872562408, 0.09228964895009995], [0.09090345352888107, 0.09090933203697205, 0.0908999964594841, 0.09090586751699448, 0.09092588722705841, 0.09091654419898987, 0.09091480821371078, 0.09092069417238235, 0.09083906561136246, 0.09091342240571976, 0.09095091372728348], [0.09099309146404266, 0.09090453386306763, 0.09104527533054352, 0.0909566655755043, 0.09065574407577515, 0.09079609811306, 0.09082213044166565, 0.09073374420404434, 0.0919688493013382, 0.09084300696849823, 0.0902809351682663]], [[0.09085891395807266, 0.09086955338716507, 0.09092697501182556, 0.09093762189149857, 0.09094826132059097, 0.09077853709459305, 0.09096956253051758, 0.09098020941019058, 0.09081042557954788, 0.09095469117164612, 0.09096533805131912], [0.09086495637893677, 0.09087430685758591, 0.09092480689287186, 0.09093416482210159, 0.09094353020191193, 0.09079427272081375, 0.090962253510952, 0.09097161889076233, 0.09082231670618057, 0.0909491777420044, 0.09095854312181473], [0.09089762717485428, 0.09090005606412888, 0.09091316908597946, 0.09091560542583466, 0.09091803431510925, 0.09087925404310226, 0.09092289209365845, 0.09092532843351364, 0.09088654816150665, 0.09091950207948685, 0.09092193841934204], [0.09090368449687958, 0.0909048318862915, 0.09091101586818695, 0.09091216325759888, 0.0909133106470108, 0.09089501947164536, 0.09091560542583466, 0.09091675281524658, 0.09089845418930054, 0.09091400355100632, 0.09091515094041824], [0.09090973436832428, 0.09090960025787354, 0.09090885519981384, 0.0909087210893631, 0.09090858697891235, 0.09091076999902725, 0.09090831130743027, 0.09090817719697952, 0.09091036021709442, 0.09090849757194519, 0.09090836346149445], [0.09081312268972397, 0.09083344787359238, 0.09094322472810745, 0.09096357971429825, 0.09098394960165024, 0.09065958857536316, 0.09102468192577362, 0.09104505926370621, 0.09072048962116241, 0.09099624305963516, 0.09101660549640656], [0.09092184156179428, 0.0909191370010376, 0.09090454131364822, 0.09090183675289154, 0.09089913219213486, 0.09094229340553284, 0.09089372307062149, 0.09089101850986481, 0.09093417972326279, 0.09089750051498413, 0.09089479595422745], [0.09092789888381958, 0.09092390537261963, 0.09090238809585571, 0.09089839458465576, 0.09089440852403641, 0.09095805883407593, 0.0908864364027977, 0.09088244289159775, 0.09094608575105667, 0.0908920019865036, 0.09088801592588425], [0.09083129465579987, 0.09084778279066086, 0.09093677997589111, 0.0909532830119133, 0.09096979349851608, 0.09070678055286407, 0.09100280702114105, 0.09101932495832443, 0.09075617045164108, 0.09097975492477417, 0.09099626541137695], [0.09091339260339737, 0.09091248363256454, 0.09090755879878998, 0.09090664982795715, 0.09090573340654373, 0.09092028439044952, 0.09090391546487808, 0.09090299904346466, 0.09091755002737045, 0.09090518951416016, 0.09090427309274673], [0.09091943502426147, 0.09091723710298538, 0.09090539067983627, 0.09090319275856018, 0.09090100228786469, 0.09093603491783142, 0.0908966064453125, 0.090894415974617, 0.09092944115400314, 0.09089966863393784, 0.09089747816324234]], [[0.09090544283390045, 0.0908995047211647, 0.09093090891838074, 0.09092497080564499, 0.09092672169208527, 0.09091418981552124, 0.09091594070196152, 0.09091000258922577, 0.09086067974567413, 0.09093931317329407, 0.09087232500314713], [0.09089633077383041, 0.09087558835744858, 0.09098531305789948, 0.09096454083919525, 0.09097065776586533, 0.0909268781542778, 0.09093298763036728, 0.09091223031282425, 0.09074006974697113, 0.09101467579603195, 0.09078071266412735], [0.09094411134719849, 0.09100169688463211, 0.09069766849279404, 0.09075509756803513, 0.09073818475008011, 0.09085940569639206, 0.09084247052669525, 0.0908999964594841, 0.0913790911436081, 0.09061653912067413, 0.09126567095518112], [0.09093515574932098, 0.09097791463136673, 0.09075208753347397, 0.09079476445913315, 0.09078219532966614, 0.09087224304676056, 0.09085967391729355, 0.09090238809585571, 0.0912579596042633, 0.09069179743528366, 0.09117382764816284], [0.09093780070543289, 0.09098492562770844, 0.09073607623577118, 0.09078309684991837, 0.09076924622058868, 0.09086848050355911, 0.09085461497306824, 0.0909016951918602, 0.09129361808300018, 0.090669646859169, 0.09120086580514908], [0.09091880172491074, 0.09093466401100159, 0.0908508226275444, 0.09086667746305466, 0.09086200594902039, 0.09089545160531998, 0.0908907800912857, 0.09090664237737656, 0.09103845059871674, 0.09082841873168945, 0.0910072922706604], [0.09092145413160324, 0.09094168245792389, 0.09083480387926102, 0.09085500985383987, 0.09084905683994293, 0.09089168906211853, 0.09088573604822159, 0.09090595692396164, 0.09107403457164764, 0.09080624580383301, 0.09103429317474365], [0.09091240167617798, 0.09091781824827194, 0.09088920801877975, 0.09089461714029312, 0.09089303016662598, 0.09090443700551987, 0.09090284258127213, 0.09090825915336609, 0.09095320850610733, 0.09088155627250671, 0.09094259142875671], [0.09083586186170578, 0.09071845561265945, 0.09134088456630707, 0.09122282266616821, 0.09125756472349167, 0.0910089761018753, 0.0910436362028122, 0.09092596173286438, 0.08995458483695984, 0.09150804579257965, 0.09018314629793167], [0.09095672518014908, 0.09103528410196304, 0.0906207337975502, 0.09069900214672089, 0.090675950050354, 0.09084120392799377, 0.09081811457872391, 0.09089655429124832, 0.0915505662560463, 0.09051020443439484, 0.09139562398195267], [0.09085416793823242, 0.09076575189828873, 0.09123419225215912, 0.09114539623260498, 0.09117153286933899, 0.09098449349403381, 0.09101057797670364, 0.09092200547456741, 0.09018975496292114, 0.09135986864566803, 0.09036222845315933]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.1733532075201866e-05, "episode_return_min": -14.5, "episode_return_mean": 0.45, "env_to_module_sum_episodes_length_out": 10.368238394470474, "env_reset_timer": 0.0007412147153993229, "num_env_steps_sampled_lifetime": 30400, "num_episodes": 20, "episode_duration_sec_mean": 0.0056554245518054816, "module_episode_returns_mean": {"default_policy": 0.45}, "episode_len_min": 20, "episode_return_max": 13.5, "env_to_module_connector": {"connector_pipeline_timer": 5.926666759134982e-05, "timers": {"connectors": {"numpy_to_tensor": 1.2192390493013372e-05, "add_time_dim_to_batch_and_zero_pad": 6.962930870772758e-06, "batch_individual_items": 1.2568840829522632e-05, "add_states_from_episodes_to_batch": 2.79633988696206e-06, "add_observations_from_episodes_to_batch": 2.800208434567962e-06}}}, "env_to_module_sum_episodes_length_in": 10.368238394470474, "episode_len_mean": 20.0, "num_episodes_lifetime": 120, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.716313855146966e-05, "listify_data_for_vector_env": 1.0618716762300748e-05, "un_batch_to_individual_items": 6.701782625591178e-06, "normalize_and_clip_actions": 8.18702423427513e-06, "remove_single_ts_time_rank_from_batch": 1.2071687854630458e-05, "tensor_to_numpy": 1.5282071085592098e-05}}, "connector_pipeline_timer": 0.00011610054551885822}, "num_env_steps_sampled": 400, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "num_agent_steps_sampled": {"default_agent": 400}, "env_step_timer": 1.4258504331927787e-05, "agent_episode_returns_mean": {"default_agent": 0.45}, "sample": 0.13096478629810526, "weights_seq_no": 6.0, "time_between_sampling": 9.311043424178758}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "b509c_00000", "date": "2025-08-11_18-30-17", "timestamp": 1754929817, "time_this_iter_s": 9.235281944274902, "time_total_s": 56.27443170547485, "pid": 11229, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x383ebd8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 56.27443170547485, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 35.964285714285715, "ram_util_percent": 77.31428571428572}}
{"timers": {"training_iteration": 9.821023278081123, "restore_env_runners": 1.0403166485111272e-05, "training_step": 9.820812691265267, "env_runner_sampling_timer": 1.65721139577707, "learner_update_timer": 7.986474426325546, "synch_weights": 0.001680636965421106, "restore_eval_env_runners": 6.379937977855453e-05, "evaluation_iteration": 0.14397859554665657, "synch_eval_env_connectors": 0.00042040967610934874, "synch_env_connectors": 5.529072875224415e-06}, "env_runners": {"num_episodes_lifetime": -153875.0, "rlmodule_inference_timer": 3.127181865616044e-05, "episode_duration_sec_mean": 0.005244139488786458, "module_episode_returns_mean": {"default_policy": 0.14000000000000007}, "episode_return_min": -10.5, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2410193469605226e-05, "add_states_from_episodes_to_batch": 2.6795264161345906e-06, "numpy_to_tensor": 1.228888048970263e-05, "add_observations_from_episodes_to_batch": 2.8202414215510148e-06, "add_time_dim_to_batch_and_zero_pad": 6.995789577104912e-06}}, "connector_pipeline_timer": 5.9704767422829416e-05}, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0420356836011191e-05, "un_batch_to_individual_items": 6.636371387834235e-06, "tensor_to_numpy": 1.5147333416376079e-05, "normalize_and_clip_actions": 7.958647012909464e-06, "remove_single_ts_time_rank_from_batch": 1.1888185769917397e-05, "get_actions": 3.8229160215243154e-05}}, "connector_pipeline_timer": 0.00011716101458295444}, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "env_step_timer": 1.3861343948251809e-05, "time_between_sampling": 0.031236069932252468, "episode_return_mean": 0.14000000000000007, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_max": 9.5, "sample": 0.005629376863970492, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "env_reset_timer": 4.0595227397826894e-05, "num_env_steps_sampled_lifetime": -3077500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "agent_episode_returns_mean": {"default_agent": 0.14000000000000007}, "weights_seq_no": 6.0, "episode_len_mean": 20.0, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3264.5709290150926}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13425993992798335, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00890913254129513, "add_observations_from_episodes_to_batch": 0.0009064878022388967, "add_columns_from_episodes_to_train_batch": 0.041400439683156154, "add_time_dim_to_batch_and_zero_pad": 0.07521540713004674, "add_states_from_episodes_to_batch": 0.0034616035607927228, "batch_individual_items": 0.004064286286694207, "numpy_to_tensor": 7.17458970935304e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "weights_seq_no": 7.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 41895, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.82696443245, "num_module_steps_trained": 5985, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime_throughput": 793.8013347468817}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_env_steps_trained_lifetime": 1386000, "num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_module_steps_trained_lifetime": 502740, "num_env_steps_trained_lifetime_throughput": 55994.47415221666}, "default_policy": {"use_intrinsic_rewards": 1.0, "policy_loss": -0.00037468093796633184, "weights_seq_no": 42.0, "vf_explained_var": 0.0011481642723083496, "module_train_batch_size_mean": 997.5374097747205, "total_loss": 0.2779926359653473, "num_module_steps_trained_lifetime": 251370, "diff_num_grad_updates_vs_sampler_policy": 36.0, "vf_loss_unclipped": 43.59143829345703, "mean_kl_loss": 9.586552187101915e-05, "entropy": 0.6903101205825806, "num_module_steps_trained": 35910, "vf_loss": 0.3586633503437042}, "intrinsic_reward_module": {"total_loss": 0.0, "weights_seq_no": 42.0, "num_module_steps_trained_lifetime": 251370, "diff_num_grad_updates_vs_sampler_policy": 36.0, "module_train_batch_size_mean": 997.5374097747205, "num_module_steps_trained": 35910}}}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 33000, "num_module_steps_trained_lifetime": 83790, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 231000, "num_env_steps_trained_lifetime_throughput": 4378.496955506938, "num_module_steps_trained_throughput": 27413149.75284088, "num_module_steps_trained_lifetime_throughput": 12570127.590415226}, "default_policy": {"weights_seq_no": 7.0, "vf_explained_var": 0.00037223100662231445, "module_train_batch_size_mean": 997.82696443245, "total_loss": 0.27769342064857483, "num_module_steps_trained_lifetime": 41895, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 43.69984817504883, "mean_kl_loss": 9.877951379166916e-05, "curr_kl_coeff": 0.0012623744551092386, "entropy": 0.6902944445610046, "num_module_steps_trained": 5985, "vf_loss": 0.35830697417259216, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "use_intrinsic_rewards": 0.0, "policy_loss": -0.00038105997373349965, "num_module_steps_trained_lifetime_throughput": 793.7879320200312}, "IntrinsicAttentionMask": [[[0.09047021716833115, 0.09094160050153732, 0.09108620882034302, 0.090776726603508, 0.09113986790180206, 0.09071269631385803, 0.09085693955421448, 0.09122040122747421, 0.09079285711050034, 0.09115605801343918, 0.09084633737802505], [0.09084164351224899, 0.09091410785913467, 0.09093627333641052, 0.09088879823684692, 0.09094448387622833, 0.09087895601987839, 0.09090111404657364, 0.09095681458711624, 0.0908912718296051, 0.0909469723701477, 0.09089948982000351], [0.09095544368028641, 0.09090563654899597, 0.09089041501283646, 0.09092302620410919, 0.09088477492332458, 0.0909297913312912, 0.09091456234455109, 0.09087631106376648, 0.0909213200211525, 0.09088307619094849, 0.09091567993164062], [0.0907118171453476, 0.0909237489104271, 0.0909886434674263, 0.09084969013929367, 0.09101270884275436, 0.09082090854644775, 0.09088572859764099, 0.09104881435632706, 0.09085693955421448, 0.09101997315883636, 0.09088096767663956], [0.09099764376878738, 0.09090248495340347, 0.09087341278791428, 0.09093569964170456, 0.09086264669895172, 0.09094862639904022, 0.09091953188180923, 0.090846486389637, 0.0909324511885643, 0.09085939079523087, 0.09092167019844055], [0.09066138416528702, 0.09092750400304794, 0.09100901335477829, 0.09083448350429535, 0.09103924036026001, 0.09079834818840027, 0.09087974578142166, 0.09108460694551468, 0.09084358811378479, 0.09104836732149124, 0.09087376296520233], [0.09077499806880951, 0.09091906249523163, 0.09096315503120422, 0.09086873382329941, 0.09097950160503387, 0.09084916859865189, 0.0908932238817215, 0.09100402891635895, 0.09087365865707397, 0.09098443388938904, 0.09088999032974243], [0.09106097370386124, 0.09089776128530502, 0.0908479169011116, 0.09095471352338791, 0.09082945436239243, 0.09097687155008316, 0.09092698991298676, 0.09080176055431366, 0.09094914048910141, 0.09082387387752533, 0.09093064814805984], [0.09072453528642654, 0.09092281758785248, 0.09098353236913681, 0.09085353463888168, 0.09100604057312012, 0.0908266082406044, 0.09088724851608276, 0.09103981405496597, 0.09086031466722488, 0.09101283550262451, 0.0908827930688858], [0.09101036936044693, 0.09090152382850647, 0.0908682718873024, 0.09093952178955078, 0.09085594862699509, 0.09095429629087448, 0.09092102199792862, 0.09083747863769531, 0.09093579649925232, 0.09085223823785782, 0.09092346578836441], [0.09076663851737976, 0.09091968089342117, 0.09096652269363403, 0.09086621552705765, 0.09098388999700546, 0.09084543585777283, 0.0908922329545021, 0.0910099446773529, 0.09087144583463669, 0.0909891277551651, 0.09088879823684692]], [[0.09090345352888107, 0.09089750796556473, 0.09090694785118103, 0.09092297405004501, 0.09092472493648529, 0.09093416482210159, 0.09093591570854187, 0.0909080058336258, 0.09085868299007416, 0.09093731641769409, 0.09087033569812775], [0.0908893495798111, 0.09086860716342926, 0.09090156853199005, 0.09095755964517593, 0.09096367657184601, 0.09099666774272919, 0.09100278466939926, 0.09090524911880493, 0.090733103454113, 0.09100768715143204, 0.09077374637126923], [0.09091173857450485, 0.0909145176410675, 0.09091009944677353, 0.09090259671211243, 0.09090178459882736, 0.09089736640453339, 0.09089654684066772, 0.09090960770845413, 0.090932697057724, 0.0908958911895752, 0.09092723578214645], [0.09094949066638947, 0.09099225699901581, 0.09092431515455246, 0.09080907702445984, 0.09079650789499283, 0.09072871506214142, 0.0907161608338356, 0.0909167230129242, 0.09127234667539597, 0.09070609509944916, 0.09118819981813431], [0.09095360338687897, 0.09100073575973511, 0.09092586487531662, 0.09079886972904205, 0.09078501909971237, 0.09071032702922821, 0.09069649130105972, 0.09091749042272568, 0.09130948036909103, 0.0906853973865509, 0.09121671319007874], [0.09097568690776825, 0.09104638546705246, 0.09093407541513443, 0.09074368327856064, 0.0907229334115982, 0.09061101824045181, 0.09059029072523117, 0.09092152863740921, 0.09151002019643784, 0.09057368338108063, 0.09137063473463058], [0.09097976982593536, 0.09105484932661057, 0.0909355953335762, 0.09073345363140106, 0.09071141481399536, 0.09059261530637741, 0.09057062119245529, 0.09092225879430771, 0.09154722094535828, 0.09055298566818237, 0.0913991779088974], [0.09091422706842422, 0.09091964364051819, 0.09091103821992874, 0.09089644253253937, 0.09089484810829163, 0.09088625013828278, 0.09088466316461563, 0.09091007709503174, 0.09095503389835358, 0.09088338166475296, 0.09094441682100296], [0.09079619497060776, 0.09067884087562561, 0.0908653736114502, 0.09118298441171646, 0.09121771156787872, 0.09140534698963165, 0.09144016355276108, 0.09088625013828278, 0.08991529792547226, 0.09146808087825775, 0.09014376252889633], [0.09098304808139801, 0.09106162935495377, 0.0909368097782135, 0.09072525054216385, 0.09070219099521637, 0.0905778706073761, 0.0905548483133316, 0.09092285484075546, 0.09157706052064896, 0.09053639322519302, 0.09142207354307175], [0.09082432091236115, 0.09073593467473984, 0.09087641537189484, 0.09111545979976654, 0.09114158153533936, 0.09128269553184509, 0.09130886942148209, 0.09089214354753494, 0.09016013145446777, 0.09132985770702362, 0.09033254534006119]], [[0.09085891395807266, 0.09086955338716507, 0.09092697501182556, 0.09093762189149857, 0.09081464260816574, 0.0909121111035347, 0.09096956253051758, 0.09098020941019058, 0.09094404429197311, 0.09082105755805969, 0.09096533805131912], [0.09086497128009796, 0.0908743217587471, 0.09092482179403305, 0.09093417972326279, 0.09082603454589844, 0.09091174602508545, 0.09096226841211319, 0.09097163379192352, 0.09093983471393585, 0.09083167463541031, 0.09095855802297592], [0.09089762717485428, 0.09090005606412888, 0.09091316908597946, 0.09091560542583466, 0.09088750928640366, 0.09090977907180786, 0.09092289209365845, 0.09092532843351364, 0.09091707319021225, 0.09088897705078125, 0.09092193841934204], [0.09090368449687958, 0.0909048318862915, 0.09091101586818695, 0.09091216325759888, 0.09089890867471695, 0.09090941399335861, 0.09091560542583466, 0.09091675281524658, 0.09091285616159439, 0.09089960157871246, 0.09091515094041824], [0.09083370864391327, 0.09084968268871307, 0.09093593806028366, 0.09095193445682526, 0.09076722711324692, 0.09091361612081528, 0.09099993109703064, 0.09101593494415283, 0.09096159040927887, 0.09077686071395874, 0.09099358320236206], [0.09088918566703796, 0.09089341014623642, 0.09091619402170181, 0.09092041850090027, 0.09087160974740982, 0.09091029316186905, 0.09093309193849564, 0.09093731641769409, 0.09092296659946442, 0.09087415039539337, 0.09093141555786133], [0.09092184156179428, 0.0909191370010376, 0.09090454131364822, 0.09090183675289154, 0.09093310683965683, 0.09090831875801086, 0.09089373052120209, 0.0908910259604454, 0.09090020507574081, 0.0909314751625061, 0.09089479595422745], [0.09092789888381958, 0.09092390537261963, 0.09090238064527512, 0.09089839458465576, 0.09094450622797012, 0.09090795367956161, 0.0908864364027977, 0.09088244289159775, 0.09089598804712296, 0.09094209969043732, 0.09088800847530365], [0.09090734273195267, 0.09090771526098251, 0.09090972691774368, 0.09091009199619293, 0.09090579301118851, 0.0909092053771019, 0.09091120958328247, 0.09091158211231232, 0.09091032296419144, 0.09090601652860641, 0.09091106057167053], [0.09083735942840576, 0.09085256606340408, 0.0909346416592598, 0.09094986319541931, 0.09077410399913788, 0.09091339260339737, 0.09099552780389786, 0.09101075679063797, 0.09095904231071472, 0.0907832682132721, 0.09098949283361435], [0.09091943502426147, 0.09091723710298538, 0.09090539067983627, 0.09090319275856018, 0.0909285768866539, 0.09090845286846161, 0.0908966138958931, 0.090894415974617, 0.09090186655521393, 0.09092725068330765, 0.09089747816324234]], [[0.09090014547109604, 0.0910458192229271, 0.09088189899921417, 0.09091288596391678, 0.09090375900268555, 0.09096913784742355, 0.09084542840719223, 0.09087640047073364, 0.09056136757135391, 0.09095268696546555, 0.09115051478147507], [0.09091994166374207, 0.09073882550001144, 0.09094267338514328, 0.09090407937765121, 0.09091544151306152, 0.09083408862352371, 0.0909881442785263, 0.09094953536987305, 0.09134367853403091, 0.09085454046726227, 0.09060905873775482], [0.0908975899219513, 0.09108429402112961, 0.09087421000003815, 0.09091390669345856, 0.09090221673250198, 0.09098599851131439, 0.09082747995853424, 0.09086715430021286, 0.09046370536088943, 0.0909649208188057, 0.09121853113174438], [0.0909019187092781, 0.09101895242929459, 0.09088725596666336, 0.09091215580701828, 0.09090482443571091, 0.09095735102891922, 0.09085795283317566, 0.09088283777236938, 0.09062959998846054, 0.09094413369894028, 0.09110303968191147], [0.09090064465999603, 0.09103818982839584, 0.09088341891765594, 0.09091267734766006, 0.09090405702590942, 0.09096578508615494, 0.09084897488355637, 0.09087821841239929, 0.09058072417974472, 0.09095025062561035, 0.09113702923059464], [0.09090965986251831, 0.09090036898851395, 0.09091081470251083, 0.09090884029865265, 0.09090942144393921, 0.09090525656938553, 0.09091314673423767, 0.09091117233037949, 0.09093130379915237, 0.0909062996506691, 0.0908937081694603], [0.09089241921901703, 0.09116125106811523, 0.09085877984762192, 0.09091591089963913, 0.09089908748865128, 0.09101969003677368, 0.09079153835773468, 0.09084863215684891, 0.09026864916086197, 0.09098934382200241, 0.09135466814041138], [0.09089681506156921, 0.09109590947628021, 0.0908718854188919, 0.09091421961784363, 0.09090174734592438, 0.09099108725786209, 0.09082205593585968, 0.09086436778306961, 0.0904342532157898, 0.09096860885620117, 0.0912390649318695], [0.09084989130496979, 0.09176156669855118, 0.0907362625002861, 0.090929314494133, 0.09087242931127548, 0.09128069132566452, 0.09050942212343216, 0.09070199728012085, 0.08875911682844162, 0.09117783606052399, 0.09242147952318192], [0.09090741723775864, 0.09093504399061203, 0.09090395271778107, 0.09090983122587204, 0.09090810269117355, 0.09092050790786743, 0.09089703112840652, 0.0909029096364975, 0.09084302186965942, 0.09091738611459732, 0.09095487743616104], [0.09093350172042847, 0.09051849693059921, 0.09098565578460693, 0.0908971056342125, 0.09092317521572113, 0.09073664247989655, 0.09109005331993103, 0.09100139886140823, 0.09190862625837326, 0.09078352153301239, 0.0902218148112297]], [[0.09040940552949905, 0.09088046848773956, 0.0910249873995781, 0.09105178713798523, 0.09107860177755356, 0.09065172076225281, 0.09079586714506149, 0.09115908294916153, 0.09106796979904175, 0.0907585397362709, 0.091121606528759], [0.09083228558301926, 0.09090473502874374, 0.09092690050601959, 0.0909310132265091, 0.0909351110458374, 0.09086959064006805, 0.0908917486667633, 0.09094744175672531, 0.09093348681926727, 0.09088601171970367, 0.09094170480966568], [0.09096188098192215, 0.09091207385063171, 0.0908968448638916, 0.09089402854442596, 0.09089120477437973, 0.09093622863292694, 0.09092099219560623, 0.09088274836540222, 0.09089232236146927, 0.090924933552742, 0.090886689722538], [0.09098592400550842, 0.09091343730688095, 0.0908912867307663, 0.09088718146085739, 0.09088307619094849, 0.09094858169555664, 0.09092642366886139, 0.09087077528238297, 0.09088470786809921, 0.09093216061592102, 0.0908764973282814], [0.0910099521279335, 0.090914785861969, 0.0908857062458992, 0.09088031947612762, 0.09087493270635605, 0.09096092730760574, 0.09093183279037476, 0.09085877239704132, 0.09087707102298737, 0.09093935787677765, 0.09086629748344421], [0.09062699973583221, 0.09089301526546478, 0.09097449481487274, 0.0909896045923233, 0.09100470691919327, 0.09076391160488129, 0.09084527939558029, 0.09105005860328674, 0.09099872410297394, 0.09082421660423279, 0.09102895110845566], [0.0907563790678978, 0.09090041369199753, 0.09094449877738953, 0.09095267206430435, 0.09096084535121918, 0.09083053469657898, 0.09087458997964859, 0.09098536521196365, 0.09095760434865952, 0.0908631831407547, 0.09097395092248917], [0.09108210355043411, 0.09091885387897491, 0.0908689945936203, 0.09085975587368011, 0.09085052460432053, 0.09099797904491425, 0.09094808250665665, 0.09082283079624176, 0.09085419028997421, 0.09096099436283112, 0.09083572030067444], [0.09100043028593063, 0.09091424942016602, 0.09088792651891708, 0.0908830463886261, 0.09087816625833511, 0.09095603227615356, 0.09092969447374344, 0.09086354076862335, 0.09088010340929031, 0.09093650430440903, 0.09087034314870834], [0.09072288125753403, 0.09089850634336472, 0.09095226228237152, 0.0909622311592102, 0.09097220003604889, 0.0908132940530777, 0.09086700528860092, 0.09100210666656494, 0.09096825122833252, 0.09085310250520706, 0.09098818153142929], [0.09104850888252258, 0.0909169539809227, 0.09087677299976349, 0.09086932986974716, 0.09086187928915024, 0.09098073095083237, 0.09094052016735077, 0.09083955734968185, 0.09086483716964722, 0.09095092117786407, 0.09084995090961456]], [[0.0909094363451004, 0.09092546254396439, 0.09091293811798096, 0.09090700000524521, 0.09090874344110489, 0.09091818332672119, 0.0909419059753418, 0.09093596786260605, 0.09084271639585495, 0.09092133492231369, 0.09087632596492767], [0.09090695530176163, 0.0908152386546135, 0.09088693559169769, 0.09092094749212265, 0.09091093391180038, 0.09085690230131149, 0.09072128683328629, 0.09075523167848587, 0.0912899449467659, 0.09083887189626694, 0.09109681844711304], [0.09090892970561981, 0.09090142697095871, 0.09090729057788849, 0.09091006964445114, 0.09090925008058548, 0.0909048318862915, 0.09089373797178268, 0.09089651703834534, 0.09094016999006271, 0.09090335667133331, 0.09092442691326141], [0.09090979397296906, 0.09094225615262985, 0.09091687947511673, 0.0909048467874527, 0.09090838581323624, 0.09092750400304794, 0.0909755527973175, 0.09096351265907288, 0.09077472984790802, 0.0909338891506195, 0.09084274619817734], [0.09090953320264816, 0.09093022346496582, 0.0909140482544899, 0.09090638160705566, 0.09090863913297653, 0.0909208208322525, 0.09095145016908646, 0.09094377607107162, 0.09082340449094772, 0.09092488884925842, 0.09086677432060242], [0.09090812504291534, 0.09086534380912781, 0.0908987894654274, 0.09091465175151825, 0.09090998023748398, 0.09088478237390518, 0.09082149714231491, 0.09083734452724457, 0.09108651429414749, 0.09087637066841125, 0.09099661558866501], [0.09090404212474823, 0.09070196747779846, 0.09085989743471146, 0.0909348726272583, 0.09091278910636902, 0.09079372137784958, 0.09049522876739502, 0.09056989848613739, 0.09175045043230057, 0.09075400233268738, 0.09132310003042221], [0.09090512990951538, 0.09074293076992035, 0.0908697098493576, 0.09092987328767776, 0.09091215580701828, 0.09081659466028214, 0.0905769094824791, 0.09063688665628433, 0.09158376604318619, 0.0907847061753273, 0.0912412777543068], [0.0909159928560257, 0.09138218313455582, 0.09101754426956177, 0.09084516018629074, 0.090895876288414, 0.09117007255554199, 0.09186270833015442, 0.09168872237205505, 0.088999904692173, 0.09126180410385132, 0.089960016310215], [0.09090762585401535, 0.09084366261959076, 0.09089366346597672, 0.09091737866401672, 0.0909103974699974, 0.09087271988391876, 0.09077811986207962, 0.09080180525779724, 0.09117449820041656, 0.09086014330387115, 0.09103996306657791], [0.09091345220804214, 0.09115259349346161, 0.09096559882164001, 0.09087706357240677, 0.09090311825275421, 0.0910438671708107, 0.09139847010374069, 0.09130951762199402, 0.08992423117160797, 0.09109090268611908, 0.09042118489742279]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.194736348442709e-05, "episode_return_min": -14.5, "episode_return_mean": 0.45, "env_to_module_sum_episodes_length_out": 10.368238394572801, "env_reset_timer": 0.0007346367282640419, "num_env_steps_sampled_lifetime": 35400, "num_episodes": 20, "episode_duration_sec_mean": 0.005673627060605213, "module_episode_returns_mean": {"default_policy": 0.45}, "episode_len_min": 20, "episode_return_max": 13.5, "env_to_module_connector": {"connector_pipeline_timer": 6.0270115668863184e-05, "timers": {"connectors": {"numpy_to_tensor": 1.2404565712026589e-05, "add_time_dim_to_batch_and_zero_pad": 7.0417007665992295e-06, "batch_individual_items": 1.2595552556801015e-05, "add_states_from_episodes_to_batch": 2.974621633487001e-06, "add_observations_from_episodes_to_batch": 2.826903793020168e-06}}}, "env_to_module_sum_episodes_length_in": 10.368238394572801, "episode_len_mean": 20.0, "num_episodes_lifetime": 140, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.846116753232899e-05, "listify_data_for_vector_env": 1.0641645003464642e-05, "un_batch_to_individual_items": 6.730392049118698e-06, "normalize_and_clip_actions": 8.111071038289321e-06, "remove_single_ts_time_rank_from_batch": 1.2045383243099037e-05, "tensor_to_numpy": 1.555758326079385e-05}}, "connector_pipeline_timer": 0.00011780155032617591}, "num_env_steps_sampled": 400, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "num_agent_steps_sampled": {"default_agent": 400}, "env_step_timer": 1.4424931560222102e-05, "agent_episode_returns_mean": {"default_agent": 0.45}, "sample": 0.1308062642748028, "weights_seq_no": 7.0, "time_between_sampling": 9.307252772436195}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "b509c_00000", "date": "2025-08-11_18-30-26", "timestamp": 1754929826, "time_this_iter_s": 9.031200885772705, "time_total_s": 65.30563259124756, "pid": 11229, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x383ebd8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 65.30563259124756, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 34.15833333333333, "ram_util_percent": 76.97500000000001}}
{"timers": {"training_iteration": 9.814846543210328, "restore_env_runners": 1.035455549836909e-05, "training_step": 9.81463619019366, "env_runner_sampling_timer": 1.6559566889090505, "learner_update_timer": 7.98147544539289, "synch_weights": 0.0016726760158555138, "restore_eval_env_runners": 6.322179621957142e-05, "evaluation_iteration": 0.1437433437513961, "synch_eval_env_connectors": 0.0004171784994456659, "synch_env_connectors": 5.512951245654061e-06}, "env_runners": {"num_episodes_lifetime": -184750.0, "rlmodule_inference_timer": 3.14309676088e-05, "episode_duration_sec_mean": 0.005265461314003916, "module_episode_returns_mean": {"default_policy": 0.7800000000000001}, "episode_return_min": -10.5, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2468077945135814e-05, "add_states_from_episodes_to_batch": 2.668151109190245e-06, "numpy_to_tensor": 1.2304137139095962e-05, "add_observations_from_episodes_to_batch": 2.824394232556049e-06, "add_time_dim_to_batch_and_zero_pad": 7.030781652087248e-06}}, "connector_pipeline_timer": 5.982813682246228e-05}, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0512724077222372e-05, "un_batch_to_individual_items": 6.649091364717132e-06, "tensor_to_numpy": 1.5234711901515306e-05, "normalize_and_clip_actions": 7.966219386867357e-06, "remove_single_ts_time_rank_from_batch": 1.1911282318824278e-05, "get_actions": 3.8470982030389356e-05}}, "connector_pipeline_timer": 0.00011769174069468694}, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "env_step_timer": 1.3903370690270192e-05, "time_between_sampling": 0.030634223066630432, "episode_return_mean": 0.7800000000000001, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_max": 9.5, "sample": 0.005625770341097014, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "env_reset_timer": 4.0093084735053986e-05, "num_env_steps_sampled_lifetime": -3695000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "agent_episode_returns_mean": {"default_agent": 0.7800000000000001}, "weights_seq_no": 7.0, "episode_len_mean": 20.0, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3255.0815801052936}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1342661021887504, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008906113716444475, "add_observations_from_episodes_to_batch": 0.0009055308450922805, "add_columns_from_episodes_to_train_batch": 0.04140588903552492, "add_time_dim_to_batch_and_zero_pad": 0.07522059305829162, "add_states_from_episodes_to_batch": 0.0034630191953547006, "batch_individual_items": 0.004063635512977738, "numpy_to_tensor": 7.173509775253609e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "weights_seq_no": 8.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 47880, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.8076834879114, "num_module_steps_trained": 5985, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime_throughput": 791.9124309929833}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_env_steps_trained_lifetime": 1584000, "num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_module_steps_trained_lifetime": 574560, "num_env_steps_trained_lifetime_throughput": 55062.659454086715}, "default_policy": {"use_intrinsic_rewards": 1.0, "policy_loss": -0.000626457273028791, "weights_seq_no": 48.0, "vf_explained_var": 0.0010172128677368164, "module_train_batch_size_mean": 997.5252898807411, "total_loss": 0.2777143716812134, "num_module_steps_trained_lifetime": 287280, "diff_num_grad_updates_vs_sampler_policy": 41.0, "vf_loss_unclipped": 43.588783264160156, "mean_kl_loss": 0.00011786990216933191, "entropy": 0.6891852021217346, "num_module_steps_trained": 35910, "vf_loss": 0.35862255096435547}, "intrinsic_reward_module": {"total_loss": 0.0, "weights_seq_no": 48.0, "num_module_steps_trained_lifetime": 287280, "diff_num_grad_updates_vs_sampler_policy": 41.0, "module_train_batch_size_mean": 997.5252898807411, "num_module_steps_trained": 35910}}}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 33000, "num_module_steps_trained_lifetime": 95760, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 264000, "num_env_steps_trained_lifetime_throughput": 4368.022001507415, "num_module_steps_trained_throughput": 26638121.001069807, "num_module_steps_trained_lifetime_throughput": 12539851.569863645}, "default_policy": {"weights_seq_no": 8.0, "vf_explained_var": -0.0009371042251586914, "module_train_batch_size_mean": 997.8076834879114, "total_loss": 0.2774314284324646, "num_module_steps_trained_lifetime": 47880, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 43.45454788208008, "mean_kl_loss": 0.00012288813013583422, "curr_kl_coeff": 0.0006311872275546193, "entropy": 0.6891567707061768, "num_module_steps_trained": 5985, "vf_loss": 0.3583053648471832, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "use_intrinsic_rewards": 0.0, "policy_loss": -0.0006434625829569995, "num_module_steps_trained_lifetime_throughput": 791.899724740891}, "IntrinsicAttentionMask": [[[0.09050064533948898, 0.0909721776843071, 0.09078051894903183, 0.09080725163221359, 0.09083398431539536, 0.09074319899082184, 0.09088748693466187, 0.09125107526779175, 0.09082338958978653, 0.09118670970201492, 0.09121356159448624], [0.09084633737802505, 0.09091879427433014, 0.09088938683271408, 0.09089348465204239, 0.0908975899219513, 0.09088364988565445, 0.0909058079123497, 0.0909615084528923, 0.09089596569538116, 0.09095166623592377, 0.09095577150583267], [0.09070592373609543, 0.09094051271677017, 0.09084523469209671, 0.09085852652788162, 0.09087182581424713, 0.09082667529582977, 0.09089842438697815, 0.09107896685600281, 0.09086655080318451, 0.09104703366756439, 0.09106035530567169], [0.09072551876306534, 0.09093748778104782, 0.09085140377283096, 0.0908634141087532, 0.09087543189525604, 0.09083463251590729, 0.09089946001768112, 0.09106256812810898, 0.09087066352367401, 0.09103371948003769, 0.09104575961828232], [0.09074512124061584, 0.09093446284532547, 0.09085756540298462, 0.09086829423904419, 0.09087903052568436, 0.0908425822854042, 0.0909004956483841, 0.09104616940021515, 0.09087477624416351, 0.09102040529251099, 0.09103115648031235], [0.09067856520414352, 0.09094473719596863, 0.09083661437034607, 0.09085170179605484, 0.09086678922176361, 0.09081555902957916, 0.09089697152376175, 0.09110186994075775, 0.09086080640554428, 0.09106562286615372, 0.09108074754476547], [0.09078430384397507, 0.09092839062213898, 0.09086988866329193, 0.09087805449962616, 0.09088622033596039, 0.09085848927497864, 0.09090255200862885, 0.0910133644938469, 0.09088297933340073, 0.09099376946687698, 0.09100194275379181], [0.0910503938794136, 0.09088719636201859, 0.09095339477062225, 0.09094414860010147, 0.09093490988016129, 0.09096629917621613, 0.09091642498970032, 0.09079121053218842, 0.09093856811523438, 0.09081332385540009, 0.0908040925860405], [0.09073734283447266, 0.09093565493822098, 0.09085511416196823, 0.09086635708808899, 0.09087760001420975, 0.0908394306898117, 0.09090007841587067, 0.09105266630649567, 0.09087314456701279, 0.09102568030357361, 0.09103693813085556], [0.09100332856178284, 0.09089449048042297, 0.09093864262104034, 0.09093248099088669, 0.09092631191015244, 0.09094725549221039, 0.09091398864984512, 0.09083044528961182, 0.09092876315116882, 0.09084520488977432, 0.09083904325962067], [0.09102296829223633, 0.09089145064353943, 0.090944804251194, 0.09093735367059708, 0.09092990309000015, 0.0909552127122879, 0.0909150093793869, 0.09081407636404037, 0.09093286097049713, 0.09083190560340881, 0.09082446247339249]], [[0.09090007841587067, 0.09104575216770172, 0.0908818319439888, 0.09102748334407806, 0.09101834893226624, 0.0908544734120369, 0.09084536135196686, 0.09099095314741135, 0.09044721722602844, 0.09083805233240128, 0.0911504477262497], [0.0909198448061943, 0.09073872864246368, 0.09094256907701492, 0.09076140820980072, 0.09077275544404984, 0.09097667783498764, 0.09098804742097855, 0.09080678969621658, 0.09148706495761871, 0.09099715948104858, 0.09060896188020706], [0.09089748561382294, 0.09108418971300125, 0.09087410569190979, 0.09106077253818512, 0.09104906022548676, 0.09083905071020126, 0.09082737565040588, 0.09101393818855286, 0.09031759947538376, 0.09081801027059555, 0.09121842682361603], [0.09091746807098389, 0.09077724814414978, 0.09093505144119263, 0.09079480916261673, 0.0908035933971405, 0.09096144884824753, 0.0909702479839325, 0.09082994610071182, 0.09135617315769196, 0.09097729623317719, 0.09067675471305847], [0.09091626107692719, 0.09079650789499283, 0.09093128889799118, 0.09081150591373444, 0.09081900864839554, 0.09095381945371628, 0.09096133708953857, 0.09084152430295944, 0.09129078686237335, 0.09096735715866089, 0.09071065485477448], [0.09089353680610657, 0.09114182740449905, 0.0908624604344368, 0.09111067652702332, 0.09109509736299515, 0.09081587195396423, 0.09080035239458084, 0.09104838967323303, 0.09012347459793091, 0.09078790247440338, 0.09132044017314911], [0.09089221060276031, 0.09116104245185852, 0.0908585786819458, 0.09112729877233505, 0.09111043810844421, 0.09080813825130463, 0.09079132974147797, 0.0910598635673523, 0.09005884826183319, 0.09077785909175873, 0.09135445952415466], [0.09091261029243469, 0.09085425734519958, 0.09091992676258087, 0.09086156636476517, 0.09086522459983826, 0.09093090146780014, 0.09093456715345383, 0.09087619185447693, 0.09109485894441605, 0.09093749523162842, 0.09081239998340607], [0.09082762897014618, 0.09199907630681992, 0.09068185836076736, 0.09185142070055008, 0.09177768230438232, 0.09046363085508347, 0.09039100259542465, 0.09155681729316711, 0.08726895600557327, 0.09033281356096268, 0.09284909069538116], [0.09089113026857376, 0.09117642790079117, 0.0908554419875145, 0.09114062041044235, 0.09112272411584854, 0.0908019170165062, 0.09078408777713776, 0.0910690426826477, 0.09000705182552338, 0.09076979011297226, 0.0913817286491394], [0.09093298763036728, 0.09051797538995743, 0.09098514169454575, 0.09056989848613739, 0.09059586375951767, 0.09106342494487762, 0.09108953922986984, 0.09067381173372269, 0.0922396332025528, 0.0911104753613472, 0.09022130817174911]], [[0.09089533239603043, 0.09077241271734238, 0.0908297747373581, 0.0908404067158699, 0.09098471701145172, 0.09094855189323425, 0.09100602567195892, 0.09088295698165894, 0.09098049998283386, 0.09099115431308746, 0.09086810052394867], [0.09087605774402618, 0.09058207273483276, 0.09071919322013855, 0.09074462950229645, 0.09109019488096237, 0.09100351482629776, 0.09114127606153488, 0.09084642678499222, 0.09108007699251175, 0.09110561013221741, 0.0908108726143837], [0.09088508039712906, 0.09067089855670929, 0.09077081829309464, 0.09078934788703918, 0.0910409614443779, 0.09097786992788315, 0.09107813239097595, 0.09086349606513977, 0.09103359282016754, 0.09105217456817627, 0.09083760529756546], [0.09088674932718277, 0.09068736433982849, 0.09078038483858109, 0.09079763293266296, 0.09103184193372726, 0.09097312390804291, 0.09106643497943878, 0.09086665511131287, 0.0910249799489975, 0.09104228019714355, 0.09084255993366241], [0.09090927243232727, 0.09091085195541382, 0.09091011434793472, 0.09090997278690338, 0.09090811759233475, 0.09090857952833176, 0.09090784192085266, 0.0909094288945198, 0.09090817719697952, 0.09090803563594818, 0.09090962260961533], [0.090903639793396, 0.09085483103990555, 0.09087761491537094, 0.0908818393945694, 0.09093910455703735, 0.09092475473880768, 0.09094755351543427, 0.09089872986078262, 0.09093742817640305, 0.0909416526556015, 0.09089282900094986], [0.09091257303953171, 0.090943843126297, 0.09092924743890762, 0.09092654287815094, 0.09088986366987228, 0.09089905023574829, 0.09088446199893951, 0.09091571718454361, 0.09089093655347824, 0.09088823199272156, 0.09091950207948685], [0.09089340269565582, 0.09075324982404709, 0.09081865102052689, 0.09083077311515808, 0.09099534153938293, 0.09095408767461777, 0.0910196378827095, 0.09087929129600525, 0.09099052846431732, 0.09100267291069031, 0.09086234867572784], [0.09090861678123474, 0.09090431779623032, 0.09090632200241089, 0.09090669453144073, 0.09091173857450485, 0.09091047942638397, 0.09091248363256454, 0.09090818464756012, 0.09091158956289291, 0.09091196209192276, 0.09090766310691833], [0.09091026335954666, 0.09092080593109131, 0.09091588854789734, 0.09091497212648392, 0.09090261161327362, 0.09090571105480194, 0.09090078622102737, 0.09091132879257202, 0.09090296924114227, 0.09090206027030945, 0.0909126028418541], [0.09089108556509018, 0.09073024243116379, 0.0908052921295166, 0.09081920981407166, 0.09100808948278427, 0.09096074104309082, 0.09103597700595856, 0.09087488800287247, 0.09100255370140076, 0.0910165011882782, 0.0908554419875145]], [[0.09088966995477676, 0.09103532880544662, 0.0908714309334755, 0.0909024104475975, 0.09100792557001114, 0.09095864742994308, 0.09094952046871185, 0.09098052978515625, 0.09043686091899872, 0.09082765132188797, 0.0911400094628334], [0.09093282371759415, 0.09075167775154114, 0.09095555543899536, 0.0909169614315033, 0.09078571200370789, 0.0908469557762146, 0.09085831046104431, 0.09081975370645523, 0.09150012582540512, 0.09101015329360962, 0.09062190353870392], [0.09088414907455444, 0.09107083082199097, 0.0908607766032219, 0.0909004658460617, 0.09103570133447647, 0.09097255021333694, 0.09096085280179977, 0.09100058674812317, 0.09030435234308243, 0.09080468863248825, 0.09120504558086395], [0.09089350700378418, 0.09101053327322006, 0.09087885171175003, 0.09090374410152435, 0.09098852425813675, 0.0909489318728447, 0.09094160050153732, 0.09096650779247284, 0.09052948653697968, 0.09084367007017136, 0.09109461307525635], [0.09092484414577484, 0.0908050686120987, 0.09093986451625824, 0.09091435372829437, 0.090827576816082, 0.09086807817220688, 0.09087558090686798, 0.0908500924706459, 0.0912993997335434, 0.09097594022750854, 0.09071921557188034], [0.09091031551361084, 0.09090103209018707, 0.09091147780418396, 0.09090950340032578, 0.09090278297662735, 0.09090591967105865, 0.09090650081634521, 0.09090452641248703, 0.09093927592039108, 0.0909142717719078, 0.09089437127113342], [0.09090760350227356, 0.09091880172491074, 0.09090619534254074, 0.09090857952833176, 0.0909166932106018, 0.09091290831565857, 0.09091220051050186, 0.09091458469629288, 0.09087266772985458, 0.09090282768011093, 0.09092684090137482], [0.09091678261756897, 0.09085842221975327, 0.09092409908771515, 0.09091167151927948, 0.09086938947439194, 0.09088912606239319, 0.09089278429746628, 0.0908803641796112, 0.09109903872013092, 0.0909416675567627, 0.09081656485795975], [0.09074489772319794, 0.09191527962684631, 0.09059926122426987, 0.0908467248082161, 0.09169408679008484, 0.09129753708839417, 0.09122424572706223, 0.09147342294454575, 0.08718946576118469, 0.09025053679943085, 0.09276451915502548], [0.09087079018354416, 0.0911560207605362, 0.0908351019024849, 0.09089571982622147, 0.09110233187675476, 0.09100581705570221, 0.09098794311285019, 0.09104866534471512, 0.0899869054555893, 0.09074947237968445, 0.09136127680540085], [0.09096281975507736, 0.09054767340421677, 0.09101498872041702, 0.0909264087677002, 0.0906255766749382, 0.09076589345932007, 0.09079191833734512, 0.0907035544514656, 0.0922698900103569, 0.09114036709070206, 0.0902509018778801]], [[0.09040939062833786, 0.09088045358657837, 0.0910249724984169, 0.09105177223682404, 0.09107858687639236, 0.09065170586109161, 0.09113223105669022, 0.09115906804800034, 0.09106795489788055, 0.09075852483510971, 0.09078525751829147], [0.09083228558301926, 0.09090473502874374, 0.09092690050601959, 0.0909310132265091, 0.0909351110458374, 0.09086959064006805, 0.09094332903623581, 0.09094744175672531, 0.09093348681926727, 0.09088601171970367, 0.09089012444019318], [0.09096188098192215, 0.09091207385063171, 0.0908968448638916, 0.09089402854442596, 0.09089120477437973, 0.09093622863292694, 0.09088557213544846, 0.09088274836540222, 0.09089232236146927, 0.090924933552742, 0.09092211723327637], [0.09098592400550842, 0.09091343730688095, 0.0908912867307663, 0.09088718146085739, 0.09088307619094849, 0.09094858169555664, 0.09087487310171127, 0.09087077528238297, 0.09088470786809921, 0.09093216061592102, 0.09092805534601212], [0.0910099521279335, 0.090914785861969, 0.0908857062458992, 0.09088031947612762, 0.09087493270635605, 0.09096092730760574, 0.0908641591668129, 0.09085877239704132, 0.09087707102298737, 0.09093935787677765, 0.09093397110700607], [0.09062699973583221, 0.09089301526546478, 0.09097449481487274, 0.0909896045923233, 0.09100470691919327, 0.09076391160488129, 0.09103494137525558, 0.09105005860328674, 0.09099872410297394, 0.09082421660423279, 0.09083929657936096], [0.09105804562568665, 0.09091749787330627, 0.0908745676279068, 0.09086661040782928, 0.09085866063833237, 0.09098562598228455, 0.09084276109933853, 0.09083481132984161, 0.09086181223392487, 0.0909537822008133, 0.09094582498073578], [0.09108210355043411, 0.09091885387897491, 0.0908689945936203, 0.09085975587368011, 0.09085052460432053, 0.09099797904491425, 0.09083206206560135, 0.09082283079624176, 0.09085419028997421, 0.09096099436283112, 0.09095174819231033], [0.09100042283535004, 0.09091424196958542, 0.09088791906833649, 0.0908830389380455, 0.09087815880775452, 0.09095602482557297, 0.09086840599775314, 0.09086353331804276, 0.09088009595870972, 0.09093649685382843, 0.09093162417411804], [0.09072288125753403, 0.09089850634336472, 0.09095226228237152, 0.0909622311592102, 0.09097220003604889, 0.0908132940530777, 0.09099213778972626, 0.09100210666656494, 0.09096825122833252, 0.09085310250520706, 0.09086305648088455], [0.09074687212705612, 0.09089987725019455, 0.09094671159982681, 0.09095539152622223, 0.09096407890319824, 0.0908256471157074, 0.09098144620656967, 0.09099012613296509, 0.09096063673496246, 0.09086032956838608, 0.0908690020442009]], [[0.09090544283390045, 0.0908995047211647, 0.090908944606781, 0.09092497080564499, 0.09092672169208527, 0.09093616157770157, 0.09093791246414185, 0.0909319743514061, 0.090838722884655, 0.09091734141111374, 0.09087233245372772], [0.09089631587266922, 0.09087557345628738, 0.09090853482484818, 0.09096453338861465, 0.09097065031528473, 0.09100364148616791, 0.09100975841283798, 0.09098898619413376, 0.09066350013017654, 0.09093787521123886, 0.09078070521354675], [0.09091078490018845, 0.0909135714173317, 0.09090915322303772, 0.09090165793895721, 0.09090083837509155, 0.09089642018079758, 0.09089560061693192, 0.09089837968349457, 0.09094203263521194, 0.09090521931648254, 0.09092628955841064], [0.09093506634235382, 0.09097782522439957, 0.09090989828109741, 0.09079467505216599, 0.09078210592269897, 0.09071432799100876, 0.09070177376270294, 0.09074442088603973, 0.09141664952039719, 0.09084950387477875, 0.09117373824119568], [0.09093768894672394, 0.09098481386899948, 0.09090995043516159, 0.09078298509120941, 0.09076913446187973, 0.09069444984197617, 0.09068062156438828, 0.09072761237621307, 0.09146856516599655, 0.09084339439868927, 0.09120075404644012], [0.09095178544521332, 0.09102246910333633, 0.0909101814031601, 0.09071984142065048, 0.09069908410310745, 0.09058720618486404, 0.090566486120224, 0.09063687175512314, 0.0917491763830185, 0.0908103883266449, 0.0913466289639473], [0.09095436334609985, 0.09102942049503326, 0.09091019630432129, 0.09070811420679092, 0.09068609029054642, 0.09056731313467026, 0.09054532647132874, 0.09062004089355469, 0.0918012410402298, 0.09080424159765244, 0.09137365221977234], [0.0909455344080925, 0.09100575000047684, 0.09091009199619293, 0.0907478854060173, 0.0907301977276802, 0.09063482284545898, 0.09061716496944427, 0.0906771644949913, 0.09162446856498718, 0.09082505851984024, 0.09128183126449585], [0.09079963713884354, 0.09062766283750534, 0.09090105444192886, 0.09136716276407242, 0.09141817688941956, 0.0916939452290535, 0.09174513816833496, 0.0915713757276535, 0.08888600766658783, 0.09114500135183334, 0.08984487503767014], [0.09092356264591217, 0.09094728529453278, 0.09090959280729294, 0.09084562957286835, 0.09083865582942963, 0.09080100804567337, 0.09079402685165405, 0.09081771969795227, 0.09119047969579697, 0.09087607264518738, 0.09105592966079712], [0.09085381031036377, 0.09076538681983948, 0.09090591967105865, 0.09114503860473633, 0.09117116779088974, 0.09131232649087906, 0.09133850783109665, 0.09124961495399475, 0.08986524492502213, 0.09103114157915115, 0.09036187082529068]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.030405679667843e-05, "episode_return_min": -14.5, "episode_return_mean": 0.45, "env_to_module_sum_episodes_length_out": 10.3682383945743, "env_reset_timer": 0.0007307345210833368, "num_env_steps_sampled_lifetime": 40400, "num_episodes": 20, "episode_duration_sec_mean": 0.005677097934531048, "module_episode_returns_mean": {"default_policy": 0.45}, "episode_len_min": 20, "episode_return_max": 13.5, "env_to_module_connector": {"connector_pipeline_timer": 5.89989215810121e-05, "timers": {"connectors": {"numpy_to_tensor": 1.1877914959163657e-05, "add_time_dim_to_batch_and_zero_pad": 7.156046410942461e-06, "batch_individual_items": 1.2416784337221428e-05, "add_states_from_episodes_to_batch": 2.755524838301202e-06, "add_observations_from_episodes_to_batch": 2.774431133605488e-06}}}, "env_to_module_sum_episodes_length_in": 10.3682383945743, "episode_len_mean": 20.0, "num_episodes_lifetime": 160, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.569171542651215e-05, "listify_data_for_vector_env": 1.0553407567751423e-05, "un_batch_to_individual_items": 6.563392868792984e-06, "normalize_and_clip_actions": 7.94918833300313e-06, "remove_single_ts_time_rank_from_batch": 1.2003176865428162e-05, "tensor_to_numpy": 1.5077651326525318e-05}}, "connector_pipeline_timer": 0.00011369890024735594}, "num_env_steps_sampled": 400, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "num_agent_steps_sampled": {"default_agent": 400}, "env_step_timer": 1.3820070569974663e-05, "agent_episode_returns_mean": {"default_agent": 0.45}, "sample": 0.13064444079191637, "weights_seq_no": 8.0, "time_between_sampling": 9.306491973881284}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "b509c_00000", "date": "2025-08-11_18-30-35", "timestamp": 1754929835, "time_this_iter_s": 9.328678846359253, "time_total_s": 74.63431143760681, "pid": 11229, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x383ebd8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 74.63431143760681, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 38.43571428571429, "ram_util_percent": 76.99285714285715}}
{"timers": {"training_iteration": 9.80777557694901, "restore_env_runners": 1.0308510963295375e-05, "training_step": 9.807565057871306, "env_runner_sampling_timer": 1.654708178270899, "learner_update_timer": 7.975560200938862, "synch_weights": 0.0016667500957972322, "restore_eval_env_runners": 6.267415864529585e-05, "evaluation_iteration": 0.14353144156412057, "synch_eval_env_connectors": 0.0004139846345866924, "synch_env_connectors": 5.5065718133657675e-06}, "env_runners": {"num_episodes_lifetime": -215625.0, "rlmodule_inference_timer": 3.124700968643231e-05, "episode_duration_sec_mean": 0.005252346330322325, "module_episode_returns_mean": {"default_policy": 0.54}, "episode_return_min": -10.5, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2438636736010623e-05, "add_states_from_episodes_to_batch": 2.6785052898540242e-06, "numpy_to_tensor": 1.2465731034421133e-05, "add_observations_from_episodes_to_batch": 2.8177321181151837e-06, "add_time_dim_to_batch_and_zero_pad": 6.981154292418067e-06}}, "connector_pipeline_timer": 5.982153142400752e-05}, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0452065707200781e-05, "un_batch_to_individual_items": 6.62124962085245e-06, "tensor_to_numpy": 1.5146339916709758e-05, "normalize_and_clip_actions": 7.993939021260471e-06, "remove_single_ts_time_rank_from_batch": 1.1897274730499551e-05, "get_actions": 3.829123550327729e-05}}, "connector_pipeline_timer": 0.00011721742924663025}, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "env_step_timer": 1.3855620006363089e-05, "time_between_sampling": 0.03166126595029277, "episode_return_mean": 0.54, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_max": 9.5, "sample": 0.005605898829778261, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "env_reset_timer": 4.124928675951554e-05, "num_env_steps_sampled_lifetime": -4312500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "agent_episode_returns_mean": {"default_agent": 0.54}, "weights_seq_no": 8.0, "episode_len_mean": 20.0, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3260.568491683812}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13427488866691856, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00890504007929009, "add_observations_from_episodes_to_batch": 0.0009049180363162144, "add_columns_from_episodes_to_train_batch": 0.041412275985742604, "add_time_dim_to_batch_and_zero_pad": 0.07522168879731937, "add_states_from_episodes_to_batch": 0.0034663748339689307, "batch_individual_items": 0.004064392908427988, "numpy_to_tensor": 7.174274763890554e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "weights_seq_no": 9.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 53865, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.7895308613665, "num_module_steps_trained": 5985, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime_throughput": 789.8634150000883}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_env_steps_trained_lifetime": 1782000, "num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_module_steps_trained_lifetime": 646380, "num_env_steps_trained_lifetime_throughput": 54138.13551839818}, "default_policy": {"use_intrinsic_rewards": 1.0, "policy_loss": -0.00020271081302780658, "weights_seq_no": 54.0, "vf_explained_var": 0.00101548433303833, "module_train_batch_size_mean": 997.5168494263723, "total_loss": 0.2781147062778473, "num_module_steps_trained_lifetime": 323190, "diff_num_grad_updates_vs_sampler_policy": 46.0, "vf_loss_unclipped": 43.57481384277344, "mean_kl_loss": 6.616973405471072e-05, "entropy": 0.6880674362182617, "num_module_steps_trained": 35910, "vf_loss": 0.35860103368759155}, "intrinsic_reward_module": {"total_loss": 0.0, "weights_seq_no": 54.0, "num_module_steps_trained_lifetime": 323190, "diff_num_grad_updates_vs_sampler_policy": 46.0, "module_train_batch_size_mean": 997.5168494263723, "num_module_steps_trained": 35910}}}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 33000, "num_module_steps_trained_lifetime": 107730, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 297000, "num_env_steps_trained_lifetime_throughput": 4356.663867470437, "num_module_steps_trained_throughput": 25903141.854957897, "num_module_steps_trained_lifetime_throughput": 12524999.999394815}, "default_policy": {"weights_seq_no": 9.0, "vf_explained_var": -0.001330733299255371, "module_train_batch_size_mean": 997.7895308613665, "total_loss": 0.2778725326061249, "num_module_steps_trained_lifetime": 53865, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 43.47021484375, "mean_kl_loss": 6.7534638219513e-05, "curr_kl_coeff": 0.00031559361377730966, "entropy": 0.688055694103241, "num_module_steps_trained": 5985, "vf_loss": 0.3583061993122101, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "use_intrinsic_rewards": 0.0, "policy_loss": -0.00020453851902857423, "num_module_steps_trained_lifetime_throughput": 789.8513684134141}, "IntrinsicAttentionMask": [[[0.09087105095386505, 0.09088169783353806, 0.09080551564693451, 0.09094977378845215, 0.09082677960395813, 0.09092426300048828, 0.09098171442747116, 0.09099236875772476, 0.0909561961889267, 0.09083319455385208, 0.0909774973988533], [0.09087564796209335, 0.09088500589132309, 0.09081801027059555, 0.09094487130641937, 0.09083671122789383, 0.09092243760824203, 0.09097295999526978, 0.09098232537508011, 0.09095051884651184, 0.0908423513174057, 0.09096924215555191], [0.09084274619817734, 0.09086129069328308, 0.09072854369878769, 0.09097999334335327, 0.0907655879855156, 0.09093549847602844, 0.09103571623563766, 0.09105429798364639, 0.09099119901657104, 0.09077677130699158, 0.09102834761142731], [0.09090499579906464, 0.09090614318847656, 0.09089792519807816, 0.09091347455978394, 0.09090021997690201, 0.09091072529554367, 0.09091691672801971, 0.09091806411743164, 0.09091416746377945, 0.09090091288089752, 0.0909164622426033], [0.09085194021463394, 0.09086791425943375, 0.09075351804494858, 0.09097019582986832, 0.0907854437828064, 0.09093186259269714, 0.0910181999206543, 0.09103420376777649, 0.09097984433174133, 0.09079508483409882, 0.09101185202598572], [0.09089399874210358, 0.09089822322130203, 0.09086798131465912, 0.09092523902654648, 0.09087642282247543, 0.09091511368751526, 0.09093791246414185, 0.0909421369433403, 0.09092778712511063, 0.09087897092103958, 0.09093623608350754], [0.09091874957084656, 0.09091604501008987, 0.09093542397022247, 0.09089874476194382, 0.0909300148487091, 0.09090522676706314, 0.09089063853025436, 0.09088793396949768, 0.09089711308479309, 0.09092838317155838, 0.09089171141386032], [0.09092334657907486, 0.09091935306787491, 0.09094793349504471, 0.09089384227991104, 0.0909399539232254, 0.0909034013748169, 0.09088188409805298, 0.09087789803743362, 0.09089143574237823, 0.0909375473856926, 0.09088346362113953], [0.09090776741504669, 0.09090813994407654, 0.09090548008680344, 0.09091051667928696, 0.09090621769428253, 0.09090963006019592, 0.0909116342663765, 0.09091200679540634, 0.09091074764728546, 0.09090644121170044, 0.09091148525476456], [0.0908547043800354, 0.09086991101503372, 0.09076105058193207, 0.09096722304821014, 0.09079142659902573, 0.0909307524561882, 0.09101290255784988, 0.09102813154459, 0.09097641706466675, 0.09080059826374054, 0.09100686013698578], [0.0909169390797615, 0.09091474115848541, 0.09093046933412552, 0.09090069681406021, 0.09092608094215393, 0.09090595692396164, 0.09089411050081253, 0.09089191257953644, 0.09089937061071396, 0.09092475473880768, 0.09089498221874237]], [[0.09079116582870483, 0.0908399373292923, 0.09076245874166489, 0.09081121534109116, 0.09097736328840256, 0.0908997654914856, 0.09070506691932678, 0.09093421697616577, 0.09134069830179214, 0.09069357067346573, 0.09124449640512466], [0.09082696586847305, 0.09086095541715622, 0.09080695360898972, 0.09084094315767288, 0.09095669537782669, 0.09090264141559601, 0.09076695144176483, 0.0909266397356987, 0.09120961278676987, 0.09075893461704254, 0.0911426767706871], [0.09077008068561554, 0.09082755446434021, 0.09073624759912491, 0.09079370647668839, 0.09098952263593674, 0.0908980593085289, 0.09066863358020782, 0.09093866497278214, 0.09141796082258224, 0.09065508842468262, 0.0913044884800911], [0.09080588817596436, 0.09084858745336533, 0.09078075736761093, 0.09082344174385071, 0.09096886962652206, 0.0909009501338005, 0.09073051065206528, 0.09093110263347626, 0.0912867859005928, 0.09072044491767883, 0.09120263159275055], [0.09092758595943451, 0.09091991931200027, 0.09093210101127625, 0.09092443436384201, 0.09089833498001099, 0.09091050922870636, 0.09094113856554031, 0.090905100107193, 0.09084143489599228, 0.09094294905662537, 0.09085647761821747], [0.09087081253528595, 0.0908866748213768, 0.090861476957798, 0.09087733179330826, 0.09093131124973297, 0.09090611338615417, 0.09084281325340271, 0.09091730415821075, 0.09104912728071213, 0.09083907306194305, 0.09101796895265579], [0.09072786569595337, 0.09080273658037186, 0.09068381041288376, 0.09075863659381866, 0.09101378917694092, 0.09089458733797073, 0.09059575945138931, 0.09094750881195068, 0.09157263487577438, 0.0905781239271164, 0.09142455458641052], [0.09089603275060654, 0.0909014418721199, 0.09089284390211105, 0.09089826047420502, 0.09091667830944061, 0.09090808033943176, 0.09088647365570068, 0.09091189503669739, 0.09095685184001923, 0.09088519960641861, 0.09094623476266861], [0.09119187295436859, 0.09107400476932526, 0.0912613496184349, 0.09114339202642441, 0.09074307978153229, 0.09092973172664642, 0.09140045940876007, 0.09084679931402206, 0.08987626433372498, 0.09142836928367615, 0.09010463207960129], [0.09071939438581467, 0.09079775214195251, 0.0906732901930809, 0.09075160324573517, 0.09101864695549011, 0.09089388698339462, 0.09058115631341934, 0.09094926714897156, 0.09160365909337997, 0.09056269377470016, 0.09144862741231918], [0.09112214297056198, 0.0910334661602974, 0.0911744087934494, 0.09108567237854004, 0.09078431874513626, 0.09092487394809723, 0.09127902239561081, 0.09086243063211441, 0.09013065695762634, 0.09130000323057175, 0.09030301868915558]], [[0.09047022461891174, 0.09060592949390411, 0.09108621627092361, 0.09111303836107254, 0.09080345928668976, 0.09104877710342407, 0.09085694700479507, 0.09088370203971863, 0.09112923592329025, 0.0908195972442627, 0.09118290990591049], [0.09057722985744476, 0.09067990630865097, 0.09104298800230026, 0.0910632461309433, 0.0908292904496193, 0.09101469814777374, 0.0908697247505188, 0.09088994562625885, 0.09107548743486404, 0.09084149450063705, 0.0911160260438919], [0.09095544368028641, 0.09094107896089554, 0.09089041501283646, 0.09088759869337082, 0.09092020243406296, 0.09089435636997223, 0.09091456234455109, 0.09091173857450485, 0.09088589251041412, 0.09091850370168686, 0.09088025242090225], [0.0909765362739563, 0.09095562994480133, 0.09088191390037537, 0.09087780863046646, 0.09092525392770767, 0.0908876433968544, 0.09091704338788986, 0.09091293811798096, 0.09087532758712769, 0.0909227728843689, 0.09086712449789047], [0.0907328724861145, 0.09078744053840637, 0.0909801498055458, 0.09099090099334717, 0.09086677432060242, 0.0909651517868042, 0.09088823199272156, 0.09089896827936172, 0.09099738299846649, 0.09087324887514114, 0.09101887792348862], [0.09092599153518677, 0.09092075377702713, 0.09090229123830795, 0.09090126305818558, 0.09091314673423767, 0.09090372920036316, 0.09091109037399292, 0.09091006219387054, 0.09090063720941544, 0.09091252833604813, 0.09089858084917068], [0.09077498316764832, 0.09081652015447617, 0.09096315503120422, 0.09097132831811905, 0.09087689220905304, 0.09095174074172974, 0.0908932164311409, 0.09090138971805573, 0.09097626060247421, 0.0908818170428276, 0.09099260717630386], [0.09079606086015701, 0.09083106368780136, 0.09095465391874313, 0.09096154570579529, 0.09088195860385895, 0.0909450426697731, 0.09089571982622147, 0.09090259671211243, 0.09096570312976837, 0.09088610857725143, 0.09097947925329208], [0.09098926931619644, 0.0909644067287445, 0.09087678045034409, 0.0908719003200531, 0.09092830866575241, 0.09088359028100967, 0.09091854095458984, 0.09091366082429886, 0.09086895734071732, 0.09092535823583603, 0.09085919708013535], [0.09074559062719345, 0.09079622477293015, 0.09097503125667572, 0.0909850001335144, 0.09086983650922775, 0.09096111357212067, 0.09088975191116333, 0.09089970588684082, 0.09099102020263672, 0.09087584167718887, 0.09101095795631409], [0.09103148430585861, 0.09099353104829788, 0.0908597782254219, 0.09085233509540558, 0.09093841165304184, 0.09087017178535461, 0.09092351794242859, 0.09091606736183167, 0.09084784239530563, 0.0909339189529419, 0.09083296358585358]], [[0.09088966995477676, 0.09103532880544662, 0.09098604321479797, 0.0909024104475975, 0.09100792557001114, 0.09084407240152359, 0.09094952046871185, 0.09098052978515625, 0.09043686836957932, 0.09082765132188797, 0.0911400094628334], [0.09093283116817474, 0.09075167775154114, 0.09081290662288666, 0.0909169614315033, 0.09078571200370789, 0.09098966419696808, 0.09085831046104431, 0.09081975370645523, 0.09150012582540512, 0.09101015329360962, 0.09062190353870392], [0.0909184142947197, 0.09084770083427429, 0.09087160974740982, 0.09091222286224365, 0.09086098521947861, 0.09094057977199554, 0.0908893346786499, 0.09087427705526352, 0.09113932400941849, 0.09094857424497604, 0.09079697728157043], [0.09089349955320358, 0.09101052582263947, 0.09097093343734741, 0.09090373665094376, 0.09098851680755615, 0.09085686504840851, 0.09094159305095673, 0.09096650034189224, 0.09052947908639908, 0.09084366261959076, 0.09109460562467575], [0.09092483669519424, 0.0908050686120987, 0.09084555506706238, 0.09091434627771378, 0.0908275693655014, 0.09096240252256393, 0.09087558090686798, 0.09085008502006531, 0.0912993922829628, 0.09097594022750854, 0.09071921557188034], [0.09087580442428589, 0.0911240503191948, 0.09104002267122269, 0.09089750051498413, 0.09107732772827148, 0.09079815447330475, 0.09097778052091599, 0.09103062748908997, 0.09010589122772217, 0.0907701924443245, 0.09130262583494186], [0.09090761095285416, 0.09091880917549133, 0.0909150242805481, 0.09090858697891235, 0.0909167006611824, 0.09090409427881241, 0.09091220796108246, 0.09091459214687347, 0.09087267518043518, 0.09090283513069153, 0.09092684835195541], [0.09091678261756897, 0.09085842221975327, 0.09087815135717392, 0.09091167151927948, 0.09086938947439194, 0.09093507379293442, 0.09089278429746628, 0.0908803641796112, 0.09109903872013092, 0.0909416675567627, 0.09081656485795975], [0.09074469655752182, 0.0919150710105896, 0.09151757508516312, 0.09084653109312057, 0.09169388562440872, 0.09038103371858597, 0.09122404456138611, 0.09147322177886963, 0.08718928694725037, 0.09025034308433533, 0.09276431053876877], [0.09087076783180237, 0.0911559984087944, 0.09105943143367767, 0.09089569747447968, 0.09110230952501297, 0.09078157693147659, 0.0909879207611084, 0.09104864299297333, 0.0899868831038475, 0.09074945002794266, 0.09136125445365906], [0.09096279740333557, 0.09054765105247498, 0.0906878411769867, 0.090926393866539, 0.09062556177377701, 0.0910932794213295, 0.09079189598560333, 0.09070353955030441, 0.09226986765861511, 0.09114034473896027, 0.0902508795261383]], [[0.09040936082601547, 0.09054497629404068, 0.09102494269609451, 0.09105174243450165, 0.09107855707406998, 0.09098751842975616, 0.09113220125436783, 0.09115903824567795, 0.09106792509555817, 0.09075849503278732, 0.09078522771596909], [0.09053118526935577, 0.0906338095664978, 0.09099670499563217, 0.09101695567369461, 0.09103721380233765, 0.09096843004226685, 0.09107773751020432, 0.09109801054000854, 0.09102918207645416, 0.09079530835151672, 0.09081551432609558], [0.09096188098192215, 0.09094751626253128, 0.0908968448638916, 0.09089402854442596, 0.09089120477437973, 0.09090078622102737, 0.09088557213544846, 0.09088274836540222, 0.09089232236146927, 0.090924933552742, 0.09092211723327637], [0.09098591655492783, 0.09096500277519226, 0.0908912792801857, 0.0908871740102768, 0.09088306874036789, 0.09089701622724533, 0.09087486565113068, 0.09087076783180237, 0.09088470041751862, 0.09093215316534042, 0.09092804789543152], [0.0910099521279335, 0.09098248928785324, 0.0908857062458992, 0.09088031947612762, 0.09087493270635605, 0.0908932313323021, 0.0908641591668129, 0.09085877239704132, 0.09087707102298737, 0.09093935787677765, 0.09093397110700607], [0.0909283235669136, 0.09092308580875397, 0.09090462327003479, 0.09090359508991241, 0.09090256690979004, 0.09090606123209, 0.09090051054954529, 0.09089948236942291, 0.09090296924114227, 0.09091486036777496, 0.09091383218765259], [0.09105804562568665, 0.09101748466491699, 0.0908745676279068, 0.09086661040782928, 0.09085866063833237, 0.09088566899299622, 0.09084276109933853, 0.09083481132984161, 0.09086181223392487, 0.0909537822008133, 0.09094582498073578], [0.09108209609985352, 0.09103497862815857, 0.0908689871430397, 0.09085975587368011, 0.09085051715373993, 0.09088188409805298, 0.09083205461502075, 0.09082282334566116, 0.09085418283939362, 0.09096098691225052, 0.09095174074172974], [0.09100042283535004, 0.0909755602478981, 0.09088791906833649, 0.0908830389380455, 0.09087815880775452, 0.09089472889900208, 0.09086840599775314, 0.09086353331804276, 0.09088009595870972, 0.09093649685382843, 0.09093162417411804], [0.09072286635637283, 0.09077348560094833, 0.09095224738121033, 0.09096221625804901, 0.0909721851348877, 0.09093833714723587, 0.09099212288856506, 0.09100209176540375, 0.09096823632717133, 0.09085308760404587, 0.09086304157972336], [0.09074686467647552, 0.09079097211360931, 0.09094670414924622, 0.09095538407564163, 0.09096407145261765, 0.09093458950519562, 0.09098143875598907, 0.09099011868238449, 0.09096062928438187, 0.09086032211780548, 0.0908689945936203]], [[0.09082788974046707, 0.0908920019865036, 0.0908418744802475, 0.09081811457872391, 0.09091300517320633, 0.09086286276578903, 0.09095779806375504, 0.09093400835990906, 0.09126486629247665, 0.09096340835094452, 0.09072409570217133], [0.09096426516771317, 0.09092060476541519, 0.0909547358751297, 0.09097092598676682, 0.09090631455183029, 0.0909404382109642, 0.09087585657835007, 0.09089203178882599, 0.0906677097082138, 0.09087204188108444, 0.09103506058454514], [0.09085769206285477, 0.0908982902765274, 0.09086655080318451, 0.09085150063037872, 0.09091159701347351, 0.09087984263896942, 0.0909399539232254, 0.09092489629983902, 0.09113425016403198, 0.09094350785017014, 0.09079192578792572], [0.09080708771944046, 0.09088761359453201, 0.090824656188488, 0.09079482406377792, 0.09091398864984512, 0.09085101634263992, 0.09097025543451309, 0.09094037115573883, 0.09135618060827255, 0.09097731113433838, 0.09067676216363907], [0.09100884944200516, 0.09092985838651657, 0.09099160134792328, 0.09102088958024979, 0.09090401232242584, 0.09096574038267136, 0.09084893018007278, 0.09087817370891571, 0.09047294408082962, 0.09084203094244003, 0.09113698452711105], [0.09090234339237213, 0.09090767800807953, 0.09090351313352585, 0.09090153127908707, 0.09090942144393921, 0.09090525656938553, 0.09091313928365707, 0.09091117233037949, 0.09093861281871796, 0.09091360867023468, 0.0908937081694603], [0.09110376983880997, 0.09094938635826111, 0.09107005596160889, 0.09112732112407684, 0.09089890122413635, 0.09101950377225876, 0.09079135209321976, 0.09084844589233398, 0.09005887061357498, 0.09077788144350052, 0.09135448187589645], [0.09105338901281357, 0.09093905240297318, 0.09102842211723328, 0.09107082337141037, 0.09090164303779602, 0.09099098294973373, 0.09082195162773132, 0.09086426347494125, 0.09027852863073349, 0.09081196784973145, 0.09123896062374115], [0.09174901992082596, 0.09107627719640732, 0.09160176664590836, 0.09185197204351425, 0.09085710346698761, 0.09138132631778717, 0.09039155393838882, 0.09063845872879028, 0.08726949989795685, 0.09033336490392685, 0.09284964948892593], [0.09111565351486206, 0.0909518152475357, 0.09107986837625504, 0.09114065021276474, 0.09089824557304382, 0.09102621674537659, 0.09078411757946014, 0.09084469825029373, 0.09000708162784576, 0.09076981991529465, 0.09138175845146179], [0.0906062200665474, 0.09084455668926239, 0.09065818786621094, 0.09056995064020157, 0.09092271327972412, 0.09073618799448013, 0.09108959883451462, 0.09100095182657242, 0.09223969280719757, 0.09111054241657257, 0.09022136777639389]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.034736255943845e-05, "episode_return_min": -14.5, "episode_return_mean": 0.65, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.0007242475953907804, "num_env_steps_sampled_lifetime": 45400, "num_episodes": 20, "episode_duration_sec_mean": 0.005315619583707303, "module_episode_returns_mean": {"default_policy": 0.65}, "episode_len_min": 20, "episode_return_max": 13.5, "env_to_module_connector": {"connector_pipeline_timer": 5.921436643097541e-05, "timers": {"connectors": {"numpy_to_tensor": 1.1931842717036764e-05, "add_time_dim_to_batch_and_zero_pad": 7.0780003218302605e-06, "batch_individual_items": 1.2487938000130008e-05, "add_states_from_episodes_to_batch": 2.7969226419341652e-06, "add_observations_from_episodes_to_batch": 2.81174051075833e-06}}}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_episodes_lifetime": 180, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.565456165370283e-05, "listify_data_for_vector_env": 1.0582677061620608e-05, "un_batch_to_individual_items": 6.571119505238884e-06, "normalize_and_clip_actions": 8.015220630775474e-06, "remove_single_ts_time_rank_from_batch": 1.1886596325475129e-05, "tensor_to_numpy": 1.4938789354545156e-05}}, "connector_pipeline_timer": 0.00011376965296430548}, "num_env_steps_sampled": 400, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "num_agent_steps_sampled": {"default_agent": 400}, "env_step_timer": 1.3876807966981766e-05, "agent_episode_returns_mean": {"default_agent": 0.65}, "sample": 0.13046923263450952, "weights_seq_no": 9.0, "time_between_sampling": 9.304762171642746}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "b509c_00000", "date": "2025-08-11_18-30-45", "timestamp": 1754929845, "time_this_iter_s": 9.229279041290283, "time_total_s": 83.8635904788971, "pid": 11229, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x383ebd8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 83.8635904788971, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 37.50000000000001, "ram_util_percent": 77.20769230769231}}
{"timers": {"training_iteration": 9.799131776588853, "restore_env_runners": 1.0267925747491647e-05, "training_step": 9.798921305212453, "env_runner_sampling_timer": 1.653697143578035, "learner_update_timer": 7.967864606020386, "synch_weights": 0.0016588367651061712, "restore_eval_env_runners": 6.213741657999407e-05, "evaluation_iteration": 0.14328267922880514, "synch_eval_env_connectors": 0.00041084603917095595, "synch_env_connectors": 5.500256175400357e-06}, "env_runners": {"num_episodes_lifetime": -246500.0, "rlmodule_inference_timer": 3.1989233119564324e-05, "episode_duration_sec_mean": 0.005331489185802638, "module_episode_returns_mean": {"default_policy": -0.17999999999999997}, "episode_return_min": -10.5, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2593165681220894e-05, "add_states_from_episodes_to_batch": 2.6957169579898904e-06, "numpy_to_tensor": 1.2511526076357357e-05, "add_observations_from_episodes_to_batch": 2.855720766444297e-06, "add_time_dim_to_batch_and_zero_pad": 7.086182085739019e-06}}, "connector_pipeline_timer": 6.043079944381337e-05}, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0682037137241215e-05, "un_batch_to_individual_items": 6.729566948513972e-06, "tensor_to_numpy": 1.541710830155831e-05, "normalize_and_clip_actions": 8.086214302635172e-06, "remove_single_ts_time_rank_from_batch": 1.2043962598720436e-05, "get_actions": 3.9259036177199255e-05}}, "connector_pipeline_timer": 0.00011930245070290951}, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "env_step_timer": 1.405683150026121e-05, "time_between_sampling": 0.031388392690000544, "episode_return_mean": -0.17999999999999997, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_max": 9.5, "sample": 0.005687332733711033, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "env_reset_timer": 4.243592186709483e-05, "num_env_steps_sampled_lifetime": -4930000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "agent_episode_returns_mean": {"default_agent": -0.17999999999999997}, "weights_seq_no": 9.0, "episode_len_mean": 20.0, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3212.826162822525}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13426701145094624, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.0089068396787669, "add_observations_from_episodes_to_batch": 0.0009041288559844937, "add_columns_from_episodes_to_train_batch": 0.04140887572583131, "add_time_dim_to_batch_and_zero_pad": 0.07521571565909137, "add_states_from_episodes_to_batch": 0.003467981495684536, "batch_individual_items": 0.004064354388647389, "numpy_to_tensor": 7.174865046654309e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "weights_seq_no": 10.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 59850, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.772440523815, "num_module_steps_trained": 5985, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime_throughput": 787.9719145217239}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_env_steps_trained_lifetime": 1980000, "num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_module_steps_trained_lifetime": 718200, "num_env_steps_trained_lifetime_throughput": 53229.57339686505}, "default_policy": {"use_intrinsic_rewards": 1.0, "policy_loss": -0.0001134846024797298, "weights_seq_no": 60.0, "vf_explained_var": 0.0012781023979187012, "module_train_batch_size_mean": 997.5109713823833, "total_loss": 0.2781956195831299, "num_module_steps_trained_lifetime": 359100, "diff_num_grad_updates_vs_sampler_policy": 51.0, "vf_loss_unclipped": 43.598304748535156, "mean_kl_loss": 4.95134481752757e-05, "entropy": 0.6869091987609863, "num_module_steps_trained": 35910, "vf_loss": 0.3585914969444275}, "intrinsic_reward_module": {"total_loss": 0.0, "weights_seq_no": 60.0, "num_module_steps_trained_lifetime": 359100, "diff_num_grad_updates_vs_sampler_policy": 51.0, "module_train_batch_size_mean": 997.5109713823833, "num_module_steps_trained": 35910}}}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 33000, "num_module_steps_trained_lifetime": 119700, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 330000, "num_env_steps_trained_lifetime_throughput": 4346.175555911926, "num_module_steps_trained_throughput": 25219306.814534362, "num_module_steps_trained_lifetime_throughput": 12523291.295580316}, "default_policy": {"weights_seq_no": 10.0, "vf_explained_var": 0.0003987550735473633, "module_train_batch_size_mean": 997.772440523815, "total_loss": 0.2779620885848999, "num_module_steps_trained_lifetime": 59850, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 43.69954299926758, "mean_kl_loss": 5.008171865483746e-05, "curr_kl_coeff": 0.00015779680688865483, "entropy": 0.686903178691864, "num_module_steps_trained": 5985, "vf_loss": 0.35830575227737427, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "use_intrinsic_rewards": 0.0, "policy_loss": -0.0001164387067547068, "num_module_steps_trained_lifetime_throughput": 787.9605181798769}, "IntrinsicAttentionMask": [[[0.09053106606006622, 0.09066686034202576, 0.09114746749401093, 0.09083777666091919, 0.09086451679468155, 0.09077370166778564, 0.09091804176568985, 0.09128174930810928, 0.09085391461849213, 0.09088066965341568, 0.09124422073364258], [0.09062327444553375, 0.09072600305080414, 0.09108926355838776, 0.09085523337125778, 0.09087546169757843, 0.09080679714679718, 0.09091591089963913, 0.09119067341089249, 0.09086744487285614, 0.0908876582980156, 0.09116233885288239], [0.09094899147748947, 0.0909346267580986, 0.09088397026062012, 0.09091658145189285, 0.09091375768184662, 0.09092333912849426, 0.09090811014175415, 0.09086986631155014, 0.09091487526893616, 0.09091205149888992, 0.09087380766868591], [0.09073921293020248, 0.09080030769109726, 0.09101612865924835, 0.09087713062763214, 0.09088914841413498, 0.09084834158420563, 0.09091318398714066, 0.0910763144493103, 0.09088438004255295, 0.09089639782905579, 0.09105949848890305], [0.0907573476433754, 0.09081192314624786, 0.09100469201803207, 0.09088054299354553, 0.0908912792801857, 0.09085483103990555, 0.09091274440288544, 0.09105844050645828, 0.09088702499866486, 0.09089775383472443, 0.09104342758655548], [0.09069576114416122, 0.09077246487140656, 0.09104352444410324, 0.09086892753839493, 0.0908840224146843, 0.09083277732133865, 0.09091421216726303, 0.09111914783716202, 0.09087803959846497, 0.09089313447475433, 0.09109801799058914], [0.09079362452030182, 0.09083516150712967, 0.09098182618618011, 0.09088738262653351, 0.09089554846286774, 0.09086780995130539, 0.0909118801355362, 0.09102270752191544, 0.09089230746030807, 0.0909004732966423, 0.09101128578186035], [0.09103982895612717, 0.09099273383617401, 0.09082682430744171, 0.09093359857797623, 0.09092435240745544, 0.09095574915409088, 0.09090587496757507, 0.09078067541122437, 0.09092801809310913, 0.09091877937316895, 0.09079355746507645], [0.09075015783309937, 0.09080731868743896, 0.0910092294216156, 0.09087918698787689, 0.09089042991399765, 0.09085226058959961, 0.09091292321681976, 0.09106552600860596, 0.09088597446680069, 0.09089721739292145, 0.09104979783296585], [0.09076828509569168, 0.09081893414258957, 0.09099778532981873, 0.09088260680437088, 0.09089256078004837, 0.09085874259471893, 0.09091247618198395, 0.09104765206575394, 0.090888611972332, 0.09089857339859009, 0.09103371948003769], [0.09101444482803345, 0.09097649902105331, 0.09084277600049973, 0.09092883765697479, 0.09092139452695847, 0.09094669669866562, 0.09090649336576462, 0.09080556780099869, 0.09092434495687485, 0.09091689437627792, 0.0908159613609314]], [[0.09082791954278946, 0.09089203923940659, 0.09092981368303299, 0.0909060388803482, 0.0908251479268074, 0.09095082432031631, 0.09095782786607742, 0.09093404561281204, 0.09117667376995087, 0.09087550640106201, 0.09072412550449371], [0.09096427261829376, 0.09092061221599579, 0.090894915163517, 0.09091109037399292, 0.09096616506576538, 0.0908806249499321, 0.09087586402893066, 0.09089203923940659, 0.09072740375995636, 0.09093186259269714, 0.09103506803512573], [0.09104451537132263, 0.0909372866153717, 0.09087420254945755, 0.09091389924287796, 0.09104915708303452, 0.09083914756774902, 0.09082747250795364, 0.09086714684963226, 0.09046369791030884, 0.0909649133682251, 0.09121852368116379], [0.09099403023719788, 0.09092681109905243, 0.09088725596666336, 0.09091215580701828, 0.09099694341421127, 0.09086527675390244, 0.09085795283317566, 0.09088283777236938, 0.09062959998846054, 0.09094413369894028, 0.09110303968191147], [0.0908220112323761, 0.0908907875418663, 0.09093131870031357, 0.0909058079123497, 0.09081903845071793, 0.09095384925603867, 0.09096136689186096, 0.0909358486533165, 0.09119614958763123, 0.09087306261062622, 0.09071069210767746], [0.09108909964561462, 0.0909465104341507, 0.09086263924837112, 0.09091541916131973, 0.09109527617692947, 0.09081605076789856, 0.09080053120851517, 0.0908532664179802, 0.09031738340854645, 0.09098323434591293, 0.09132061898708344], [0.09110395610332489, 0.09094957262277603, 0.09085877984762192, 0.09091591089963913, 0.09111064672470093, 0.09080834686756134, 0.09079153835773468, 0.09084863215684891, 0.09026864916086197, 0.09098934382200241, 0.09135466814041138], [0.09105348587036133, 0.09093914926052094, 0.0908718854188919, 0.09091421216726303, 0.09105843305587769, 0.09083450585603714, 0.09082204848527908, 0.09086436033248901, 0.0904342457652092, 0.09096860140562057, 0.09123905748128891], [0.09156666696071625, 0.09104310721158981, 0.09073618799448013, 0.09092923998832703, 0.09158938378095627, 0.0905660092830658, 0.09050934761762619, 0.09070192277431488, 0.08875905722379684, 0.09117776155471802, 0.09242139756679535], [0.09092916548252106, 0.09091329574584961, 0.09090395271778107, 0.09090983122587204, 0.09092984348535538, 0.09089875966310501, 0.09089703112840652, 0.0909029096364975, 0.09084302186965942, 0.09091738611459732, 0.09095487743616104], [0.09060664474964142, 0.09084498137235641, 0.09098563343286514, 0.0908970832824707, 0.09059634804725647, 0.09106391668319702, 0.09109003096818924, 0.09100137650966644, 0.09190859645605087, 0.0907834991812706, 0.09022179245948792]], [[0.0903790220618248, 0.09084992855787277, 0.09099439531564713, 0.09102118760347366, 0.09071192145347595, 0.09095698595046997, 0.09110161662101746, 0.09112844616174698, 0.09070133417844772, 0.09106417000293732, 0.09109098464250565], [0.0908275917172432, 0.09090003371238708, 0.09092219918966293, 0.09092631191015244, 0.09087883681058884, 0.0909164696931839, 0.09093863517045975, 0.09094274044036865, 0.09087721258401871, 0.09093289822340012, 0.09093700349330902], [0.09096510708332062, 0.09091529250144958, 0.09090007096529007, 0.09089725464582443, 0.09092986583709717, 0.09090401232242584, 0.09088879078626633, 0.09088596701622009, 0.0909309834241867, 0.0908927321434021, 0.09088990837335587], [0.09099061042070389, 0.09091812372207642, 0.09089597314596176, 0.09089186787605286, 0.09093932062387466, 0.0909017026424408, 0.09087955206632614, 0.09087545424699783, 0.0909409448504448, 0.09088528901338577, 0.09088118374347687], [0.09069618582725525, 0.09088542312383652, 0.0909433588385582, 0.09095409512519836, 0.09083002060651779, 0.09092836081981659, 0.09098632633686066, 0.09099707007408142, 0.09082576632499695, 0.09097132086753845, 0.09098206460475922], [0.09092950820922852, 0.09091135859489441, 0.0909058079123497, 0.09090477973222733, 0.09091666340827942, 0.09090724587440491, 0.0909016951918602, 0.09090066701173782, 0.09091707319021225, 0.0909031331539154, 0.09090209752321243], [0.09106715023517609, 0.09092658758163452, 0.09088364988565445, 0.09087570011615753, 0.09096768498420715, 0.09089475870132446, 0.09085184335708618, 0.09084389358758926, 0.09097084403038025, 0.0908629447221756, 0.09085498750209808], [0.09109266847372055, 0.09092939645051956, 0.09087953716516495, 0.09087029844522476, 0.09097712486982346, 0.09089243412017822, 0.0908425971865654, 0.09083336591720581, 0.09098079055547714, 0.09085548669099808, 0.09084625542163849], [0.09068609774112701, 0.09088429808616638, 0.09094498306512833, 0.09095623344182968, 0.09082627296447754, 0.09092927724123001, 0.09098998457193375, 0.0910012423992157, 0.09082181751728058, 0.09097427129745483, 0.09098552167415619], [0.091031514108181, 0.09092264622449875, 0.09088937938213348, 0.09088322520256042, 0.09095447510480881, 0.09089798480272293, 0.09086474031209946, 0.0908585786819458, 0.0909569263458252, 0.0908733457326889, 0.09086717665195465], [0.09105702489614487, 0.09092545509338379, 0.09088527411222458, 0.09087783098220825, 0.0909639298915863, 0.09089566767215729, 0.09085549414157867, 0.09084805101156235, 0.09096688032150269, 0.09086588770151138, 0.09085844457149506]], [[0.0909094363451004, 0.09090349078178406, 0.09093490242958069, 0.09090699255466461, 0.09093071520328522, 0.09091818332672119, 0.09091992676258087, 0.09093596041202545, 0.09084270894527435, 0.09092133492231369, 0.09087631851434708], [0.09091026335954666, 0.09088951349258423, 0.09099926054477692, 0.09090173244476318, 0.09098460525274277, 0.09094081073999405, 0.09094692766666412, 0.0910029485821724, 0.0906774178147316, 0.0909518226981163, 0.0907946303486824], [0.0909053236246109, 0.09096288681030273, 0.09065898507833481, 0.09092898666858673, 0.09069948643445969, 0.09082065522670746, 0.09080372750759125, 0.09064879268407822, 0.0915541723370552, 0.09079016000032425, 0.09122674912214279], [0.09090978652238846, 0.09089775383472443, 0.09096136689186096, 0.0909048393368721, 0.09095287322998047, 0.09092749655246735, 0.09093103557825089, 0.09096350520849228, 0.09077472239732742, 0.09093387424945831, 0.09084273129701614], [0.0909060686826706, 0.09095317870378494, 0.09070441126823425, 0.090925432741642, 0.09073757380247116, 0.0908367708325386, 0.09082291275262833, 0.0906960666179657, 0.09143675863742828, 0.09081180393695831, 0.09116904437541962], [0.09090813249349594, 0.09092400223016739, 0.0908401757478714, 0.09091465920209885, 0.09085135161876678, 0.09088478982448578, 0.09088011831045151, 0.09083735197782516, 0.09108652174472809, 0.09087637811899185, 0.0909966230392456], [0.09090784937143326, 0.0909280776977539, 0.09082121402025223, 0.09091617166996002, 0.09083546698093414, 0.09087809175252914, 0.0908721387386322, 0.09081762284040451, 0.09113533794879913, 0.09086737036705017, 0.09102067351341248], [0.09090514481067657, 0.09096533805131912, 0.09064755588769913, 0.09092988818883896, 0.09068990498781204, 0.09081660211086273, 0.09079890698194504, 0.09063689410686493, 0.09158377349376678, 0.0907847136259079, 0.09124129265546799], [0.09091602265834808, 0.09074383974075317, 0.09165787696838379, 0.09084518998861313, 0.09153535962104797, 0.09117010980844498, 0.09122100472450256, 0.09168875962495804, 0.08899995684623718, 0.0912618413567543, 0.08996005356311798], [0.09090763330459595, 0.09093135595321655, 0.0908060222864151, 0.09091738611459732, 0.0908227413892746, 0.09087272733449936, 0.09086574614048004, 0.09080181270837784, 0.09117450565099716, 0.09086015075445175, 0.0910399779677391], [0.09091346710920334, 0.09082499146461487, 0.09129372984170914, 0.09087707847356796, 0.09123103320598602, 0.0910438746213913, 0.09106997400522232, 0.09130953252315521, 0.08992424607276917, 0.09109091013669968, 0.09042119979858398]], [[0.09087105095386505, 0.09088169783353806, 0.09093912690877914, 0.09094977378845215, 0.09096042066812515, 0.09079067409038544, 0.09098171442747116, 0.09099236875772476, 0.09082256257534027, 0.09083319455385208, 0.0909774973988533], [0.09087564796209335, 0.09088500589132309, 0.09093550592660904, 0.09094487130641937, 0.0909542366862297, 0.09080495685338974, 0.09097295999526978, 0.09098232537508011, 0.09083300083875656, 0.0908423513174057, 0.09096924215555191], [0.09090040624141693, 0.09090283513069153, 0.09091594815254211, 0.09091838449239731, 0.0909208133816719, 0.09088203310966492, 0.0909256711602211, 0.0909281075000763, 0.0908893272280693, 0.0908917486667633, 0.0909247174859047], [0.09090499579906464, 0.09090614318847656, 0.09091232717037201, 0.09091347455978394, 0.09091462194919586, 0.09089633077383041, 0.09091691672801971, 0.09091806411743164, 0.0908997654914856, 0.09090091288089752, 0.0909164622426033], [0.09090957790613174, 0.090909443795681, 0.09090869873762131, 0.09090856462717056, 0.09090843051671982, 0.09091061353683472, 0.09090815484523773, 0.09090802073478699, 0.09091020375490189, 0.09091006964445114, 0.09090820699930191], [0.09083633124828339, 0.09085666388273239, 0.09096647053956985, 0.09098683297634125, 0.09100720286369324, 0.09068275988101959, 0.09104794263839722, 0.0910683274269104, 0.09074367582798004, 0.09076398611068726, 0.09103986620903015], [0.09091875702142715, 0.09091605246067047, 0.0909014642238617, 0.09089875966310501, 0.09089605510234833, 0.09093920886516571, 0.09089063853025436, 0.09088793396949768, 0.09093109518289566, 0.09092839062213898, 0.09089171886444092], [0.09092333912849426, 0.09091935306787491, 0.0908978283405304, 0.09089383482933044, 0.09088985621929169, 0.09095349907875061, 0.09088187664747238, 0.09087789058685303, 0.09094152599573135, 0.090937539935112, 0.09088345617055893], [0.0908501073718071, 0.09086659550666809, 0.09095561504364014, 0.09097211807966232, 0.0909886360168457, 0.09072556346654892, 0.09102165699005127, 0.09103817492723465, 0.09077496826648712, 0.09079144150018692, 0.09101510792970657], [0.0908547043800354, 0.09086991101503372, 0.09095200151205063, 0.09096722304821014, 0.09098244458436966, 0.09073983877897263, 0.09101290255784988, 0.09102813154459, 0.09078540652990341, 0.09080059826374054, 0.09100686013698578], [0.09091693162918091, 0.09091473370790482, 0.0909028872847557, 0.09090068936347961, 0.09089849889278412, 0.09093353152275085, 0.09089410305023193, 0.09089191257953644, 0.09092693775892258, 0.09092474728822708, 0.09089497476816177]], [[0.09075842052698135, 0.09080717712640762, 0.09091009199619293, 0.09095893055200577, 0.0909445509314537, 0.09086698293685913, 0.09085261076688766, 0.09072106331586838, 0.09130775183439255, 0.09066086262464523, 0.09121158719062805], [0.09080413728952408, 0.09083811938762665, 0.09090983122587204, 0.0909438505768776, 0.09093383699655533, 0.09087979048490524, 0.09086977690458298, 0.09077809751033783, 0.09118668735027313, 0.09073612093925476, 0.09111976623535156], [0.09090051800012589, 0.09090329706668854, 0.09090916067361832, 0.09091193974018097, 0.0909111276268959, 0.09090670943260193, 0.09090588986873627, 0.09089838713407516, 0.09093175828456879, 0.09089495241641998, 0.09092629700899124], [0.09094619005918503, 0.090934157371521, 0.09090878069400787, 0.09089674800634384, 0.09090029448270798, 0.09091940522193909, 0.09092295169830322, 0.09095541387796402, 0.09081107378005981, 0.09097029268741608, 0.09083465486764908], [0.09093274176120758, 0.09092506766319275, 0.09090889245271683, 0.09090122580528259, 0.09090348333120346, 0.09091566503047943, 0.0909179300069809, 0.09093862026929855, 0.09084659069776535, 0.09094810485839844, 0.09086163341999054], [0.09086015820503235, 0.0908760130405426, 0.0909094586968422, 0.09092532098293304, 0.09092064946889877, 0.09089545160531998, 0.0908907875418663, 0.09084800630807877, 0.09103845059871674, 0.09082841873168945, 0.0910072922706604], [0.0908467024564743, 0.09086691588163376, 0.09090955555438995, 0.09092977643013, 0.09092381596565247, 0.09089169651269913, 0.09088573604822159, 0.0908312126994133, 0.09107403457164764, 0.09080624580383301, 0.09103430062532425], [0.09072336554527283, 0.09078343957662582, 0.09091026335954666, 0.0909704640507698, 0.09095273911952972, 0.0908571258187294, 0.0908394306898117, 0.09067734330892563, 0.0914006382226944, 0.09060318022966385, 0.09128201007843018], [0.09127135574817657, 0.09115339070558548, 0.0909050777554512, 0.09078758955001831, 0.09082216024398804, 0.0910089835524559, 0.09104364365339279, 0.0913618803024292, 0.08995460718870163, 0.09150805324316025, 0.09018316119909286], [0.09066682308912277, 0.09074512869119644, 0.09091050177812576, 0.09098901599645615, 0.09096589684486389, 0.09084120392799377, 0.0908181220293045, 0.09060683846473694, 0.0915505662560463, 0.09051020443439484, 0.09139562398195267], [0.09118190407752991, 0.09109316021203995, 0.0909062847495079, 0.09081780910491943, 0.09084384888410568, 0.09098450094461441, 0.09101058542728424, 0.0912499874830246, 0.09018976986408234, 0.09135987609624863, 0.09036223590373993]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.0071718467811033e-05, "episode_return_min": -14.5, "episode_return_mean": 1.25, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.0007177555395862883, "num_env_steps_sampled_lifetime": 50400, "num_episodes": 20, "episode_duration_sec_mean": 0.005217176693258807, "module_episode_returns_mean": {"default_policy": 1.25}, "episode_len_min": 20, "episode_return_max": 13.5, "env_to_module_connector": {"connector_pipeline_timer": 5.838899062705721e-05, "timers": {"connectors": {"numpy_to_tensor": 1.1918815748480094e-05, "add_time_dim_to_batch_and_zero_pad": 6.94642338128862e-06, "batch_individual_items": 1.2370682273158128e-05, "add_states_from_episodes_to_batch": 2.730962398398925e-06, "add_observations_from_episodes_to_batch": 2.7677377741527893e-06}}}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_episodes_lifetime": 200, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.564251345283127e-05, "listify_data_for_vector_env": 1.0529857135788499e-05, "un_batch_to_individual_items": 6.664084473698058e-06, "normalize_and_clip_actions": 8.147307945552962e-06, "remove_single_ts_time_rank_from_batch": 1.1987161419758569e-05, "tensor_to_numpy": 1.5000288742119894e-05}}, "connector_pipeline_timer": 0.00011373176801460012}, "num_env_steps_sampled": 400, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "num_agent_steps_sampled": {"default_agent": 400}, "env_step_timer": 1.3882969888408851e-05, "agent_episode_returns_mean": {"default_agent": 1.25}, "sample": 0.1302897698877938, "weights_seq_no": 10.0, "time_between_sampling": 9.30139325283605}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "b509c_00000", "date": "2025-08-11_18-30-54", "timestamp": 1754929854, "time_this_iter_s": 9.06386923789978, "time_total_s": 92.92745971679688, "pid": 11229, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x383ebd8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 92.92745971679688, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 35.269230769230774, "ram_util_percent": 76.97692307692307}}
{"timers": {"training_iteration": 9.791548705903596, "restore_env_runners": 1.0226497247442754e-05, "training_step": 9.79133797383063, "env_runner_sampling_timer": 1.6523540454822858, "learner_update_timer": 7.96154987288065, "synch_weights": 0.0016527392375231965, "restore_eval_env_runners": 6.157979144442656e-05, "evaluation_iteration": 0.14302619368705594, "synch_eval_env_connectors": 0.00040785215886102215, "synch_env_connectors": 5.4890036557421335e-06}, "env_runners": {"num_episodes_lifetime": -277375.0, "rlmodule_inference_timer": 3.12872819209435e-05, "episode_duration_sec_mean": 0.005236547979526221, "module_episode_returns_mean": {"default_policy": 2.1399999999999997}, "episode_return_min": -10.5, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2408472269819892e-05, "add_states_from_episodes_to_batch": 2.6642812944056506e-06, "numpy_to_tensor": 1.2300330599644124e-05, "add_observations_from_episodes_to_batch": 2.8071290270374246e-06, "add_time_dim_to_batch_and_zero_pad": 7.037701468175292e-06}}, "connector_pipeline_timer": 5.9667897728779284e-05}, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0389529399469568e-05, "un_batch_to_individual_items": 6.635809487530967e-06, "tensor_to_numpy": 1.5151128631533899e-05, "normalize_and_clip_actions": 7.936381348929477e-06, "remove_single_ts_time_rank_from_batch": 1.187028892649552e-05, "get_actions": 3.8228921305920396e-05}}, "connector_pipeline_timer": 0.00011694996617226788}, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "env_step_timer": 1.3838764106071834e-05, "time_between_sampling": 0.03066063134392457, "episode_return_mean": 2.1399999999999997, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_max": 9.5, "sample": 0.0056174188292045305, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "env_reset_timer": 3.80882644447603e-05, "num_env_steps_sampled_lifetime": -5547500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "agent_episode_returns_mean": {"default_agent": 2.1399999999999997}, "weights_seq_no": 10.0, "episode_len_mean": 20.0, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3278.846419650477}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13427176008637456, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008907112112433833, "add_observations_from_episodes_to_batch": 0.0009033663184719768, "add_columns_from_episodes_to_train_batch": 0.04141159446945135, "add_time_dim_to_batch_and_zero_pad": 0.07521534850285905, "add_states_from_episodes_to_batch": 0.0034696287605974975, "batch_individual_items": 0.004066908344814708, "numpy_to_tensor": 7.168949377096218e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "weights_seq_no": 11.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 65835, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.7563503102639, "num_module_steps_trained": 5985, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime_throughput": 786.0675126530705}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_env_steps_trained_lifetime": 2178000, "num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_module_steps_trained_lifetime": 790020, "num_env_steps_trained_lifetime_throughput": 52344.47473437494}, "default_policy": {"use_intrinsic_rewards": 1.0, "policy_loss": -0.00030635204166173935, "weights_seq_no": 66.0, "vf_explained_var": 0.0010082125663757324, "module_train_batch_size_mean": 997.5068778348534, "total_loss": 0.2779756188392639, "num_module_steps_trained_lifetime": 395010, "diff_num_grad_updates_vs_sampler_policy": 56.0, "vf_loss_unclipped": 43.55039978027344, "mean_kl_loss": 4.014796650153585e-05, "entropy": 0.6859741806983948, "num_module_steps_trained": 35910, "vf_loss": 0.3585567772388458}, "intrinsic_reward_module": {"total_loss": 0.0, "weights_seq_no": 66.0, "num_module_steps_trained_lifetime": 395010, "diff_num_grad_updates_vs_sampler_policy": 56.0, "module_train_batch_size_mean": 997.5068778348534, "num_module_steps_trained": 35910}}}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 33000, "num_module_steps_trained_lifetime": 131670, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 363000, "num_env_steps_trained_lifetime_throughput": 4335.618563625922, "num_module_steps_trained_throughput": 24556687.347422946, "num_module_steps_trained_lifetime_throughput": 12512856.569513293}, "default_policy": {"weights_seq_no": 11.0, "vf_explained_var": -0.0024657249450683594, "module_train_batch_size_mean": 997.7563503102639, "total_loss": 0.2777673900127411, "num_module_steps_trained_lifetime": 65835, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 43.42681121826172, "mean_kl_loss": 4.2311927245464176e-05, "curr_kl_coeff": 7.889840344432741e-05, "entropy": 0.6859461665153503, "num_module_steps_trained": 5985, "vf_loss": 0.358306348323822, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "use_intrinsic_rewards": 0.0, "policy_loss": -0.000313011696562171, "num_module_steps_trained_lifetime_throughput": 786.0567686827255}, "IntrinsicAttentionMask": [[[0.09083463251590729, 0.0908452719449997, 0.09090267866849899, 0.0909133180975914, 0.09092395752668381, 0.09088781476020813, 0.09094525128602982, 0.09095589816570282, 0.09091974049806595, 0.09093038737773895, 0.09094103425741196], [0.09084361046552658, 0.09085296094417572, 0.09090345352888107, 0.09091280400753021, 0.09092216938734055, 0.09089037775993347, 0.09094088524580002, 0.09095025062561035, 0.09091845899820328, 0.09092781692743301, 0.09093717485666275], [0.09089207649230957, 0.09089450538158417, 0.09090762585401535, 0.09091005474328995, 0.09091248363256454, 0.09090422838926315, 0.09091734141111374, 0.09091977775096893, 0.09091152250766754, 0.09091395139694214, 0.09091638773679733], [0.09090106934309006, 0.09090221673250198, 0.09090840816497803, 0.09090954810380936, 0.09091069549322128, 0.09090679883956909, 0.09091299027204514, 0.09091413766145706, 0.09091024100780487, 0.0909113883972168, 0.09091253578662872], [0.09091005474328995, 0.0909099206328392, 0.09090917557477951, 0.09090904146432877, 0.09090890735387802, 0.09090936928987503, 0.09090863168239594, 0.09090849757194519, 0.0909089595079422, 0.09090882539749146, 0.09090868383646011], [0.09087952971458435, 0.0908837541937828, 0.0909065380692482, 0.09091076999902725, 0.09091498702764511, 0.09090064465999603, 0.09092343598604202, 0.09092766046524048, 0.0909133180975914, 0.09091753512620926, 0.09092176705598831], [0.09092801809310913, 0.09092531353235245, 0.09091071784496307, 0.09090801328420639, 0.09090530872344971, 0.09091449528932571, 0.09089989960193634, 0.09089719504117966, 0.09090638160705566, 0.09090367704629898, 0.0909009724855423], [0.09093700349330902, 0.09093301743268967, 0.09091149270534515, 0.0909074991941452, 0.09090351313352585, 0.09091705828905106, 0.09089554101228714, 0.09089154750108719, 0.0909050926566124, 0.09090110659599304, 0.09089711308479309], [0.09090649336576462, 0.09090686589479446, 0.09090887755155563, 0.09090924263000488, 0.09090961515903473, 0.09090835601091385, 0.09091036021709442, 0.09091073274612427, 0.09090947359800339, 0.09090983867645264, 0.09091021120548248], [0.09091546386480331, 0.09091455489397049, 0.09090963006019592, 0.0909087136387825, 0.09090780466794968, 0.090910904109478, 0.09090598672628403, 0.0909050703048706, 0.09090816974639893, 0.0909072607755661, 0.09090634435415268], [0.0909244641661644, 0.0909222662448883, 0.0909104198217392, 0.0909082219004631, 0.09090602397918701, 0.09091348201036453, 0.09090163558721542, 0.09089944511651993, 0.09090690314769745, 0.09090470522642136, 0.09090250730514526]], [[0.09091056138277054, 0.09094155579805374, 0.09100695699453354, 0.09092330187559128, 0.09091417491436005, 0.09086495637893677, 0.09085583686828613, 0.09088681638240814, 0.09057174623012543, 0.09096311032772064, 0.09116096049547195], [0.09090988337993622, 0.09092605859041214, 0.09096019715070724, 0.09091653674840927, 0.09091176837682724, 0.09088607132434845, 0.09088130295276642, 0.09089747816324234, 0.09073283523321152, 0.0909373089671135, 0.09104052186012268], [0.09090829640626907, 0.09089324623346329, 0.0908614993095398, 0.09090211242437363, 0.0909065380692482, 0.09093046933412552, 0.09093490242958069, 0.09091983735561371, 0.09107338637113571, 0.09088277071714401, 0.0907868817448616], [0.09091029316186905, 0.09093519300222397, 0.09098774194717407, 0.09092053025960922, 0.09091319888830185, 0.09087365120649338, 0.090866319835186, 0.09089121222496033, 0.09063795208930969, 0.09095251560211182, 0.0911114364862442], [0.09091048687696457, 0.09093975275754929, 0.09100150316953659, 0.0909225195646286, 0.09091390669345856, 0.09086742997169495, 0.0908588171005249, 0.09088806062936783, 0.09059054404497147, 0.09096010774374008, 0.09114690124988556], [0.09091147780418396, 0.09096428006887436, 0.09107575565576553, 0.0909331813454628, 0.09091763943433762, 0.09083379805088043, 0.09081827104091644, 0.09087102115154266, 0.09033503383398056, 0.09100101888179779, 0.09133846312761307], [0.09091165661811829, 0.09096882492303848, 0.09108951687812805, 0.09093515574932098, 0.09091832488775253, 0.0908275619149208, 0.09081075340509415, 0.09086786210536957, 0.09028775990009308, 0.09100859612226486, 0.0913740023970604], [0.09091105312108994, 0.09095340222120285, 0.09104279428720474, 0.09092846512794495, 0.0909159928560257, 0.09084874391555786, 0.0908362939953804, 0.09087860584259033, 0.09044842422008514, 0.09098286181688309, 0.091253362596035], [0.09091507643461227, 0.09110850095748901, 0.09151782840490341, 0.09099455177783966, 0.09093762934207916, 0.09063106030225754, 0.09057436883449554, 0.09076707810163498, 0.08882281184196472, 0.09124325215816498, 0.09248778223991394], [0.09090937674045563, 0.0909152626991272, 0.09092766791582108, 0.09091179817914963, 0.09091006964445114, 0.0909007266163826, 0.09089899808168411, 0.09090487658977509, 0.09084498882293701, 0.09091935306787491, 0.09095684438943863], [0.09090379625558853, 0.09081532806158066, 0.09062901884317398, 0.09086740761995316, 0.0908934697508812, 0.09103419631719589, 0.09106029570102692, 0.09097167104482651, 0.09187859296798706, 0.09075386077165604, 0.09019234031438828]], [[0.09091965109109879, 0.09079669415950775, 0.09085407108068466, 0.09086470305919647, 0.09100905805826187, 0.09083922207355499, 0.0908966213464737, 0.0909072607755661, 0.09100483357906342, 0.09088176488876343, 0.09102614223957062], [0.09093426167964935, 0.09064009040594101, 0.09077730029821396, 0.09080274403095245, 0.09114854037761688, 0.09074177592992783, 0.09087914228439331, 0.0909046158194542, 0.09113840758800507, 0.0908435732126236, 0.09118951857089996], [0.09092745184898376, 0.09071317315101624, 0.09081314504146576, 0.09083167463541031, 0.09108340740203857, 0.09078726172447205, 0.09088730812072754, 0.09090586006641388, 0.09107603877782822, 0.09086140990257263, 0.09111322462558746], [0.09092619270086288, 0.09072672575712204, 0.09081979095935822, 0.09083704650402069, 0.09107135236263275, 0.09079569578170776, 0.09088882803916931, 0.09090609848499298, 0.09106449037790298, 0.09086471796035767, 0.0910990983247757], [0.0909089595079422, 0.09091053903102875, 0.09090980142354965, 0.09090965986251831, 0.09090780466794968, 0.09090999513864517, 0.09090925753116608, 0.09090911597013474, 0.09090786427259445, 0.090909443795681, 0.09090758860111237], [0.09092921763658524, 0.09069425612688065, 0.09080386906862259, 0.090824194252491, 0.09110026061534882, 0.0907754898071289, 0.09088519215583801, 0.09090553969144821, 0.09109217673540115, 0.09085679799318314, 0.09113296121358871], [0.09092238545417786, 0.09076736122369766, 0.0908396989107132, 0.09085310995578766, 0.0910351425409317, 0.09082097560167313, 0.09089335054159164, 0.0909067690372467, 0.0910298228263855, 0.09087461978197098, 0.0910566970705986], [0.09092112630605698, 0.09078092873096466, 0.09084634482860565, 0.09085847437381744, 0.09102309495210648, 0.09082940965890884, 0.09089487046003342, 0.09090700000524521, 0.09101827442646027, 0.09087792783975601, 0.09104257822036743], [0.09090946614742279, 0.09090516716241837, 0.09090717136859894, 0.09090754389762878, 0.0909125879406929, 0.09090665727853775, 0.09090866148471832, 0.09090903401374817, 0.09091243892908096, 0.09090813994407654, 0.09091318398714066], [0.09092416614294052, 0.09074845910072327, 0.09083043783903122, 0.09084563702344894, 0.09105201065540314, 0.09080921858549118, 0.09089125692844391, 0.09090646356344223, 0.09104596823453903, 0.09087002277374268, 0.09107644110918045], [0.09090691059827805, 0.09093229472637177, 0.09092044830322266, 0.09091824293136597, 0.09088847786188126, 0.09092351049184799, 0.09091166406869888, 0.09090946614742279, 0.0908893495798111, 0.09091472625732422, 0.09088495373725891]], [[0.09083590656518936, 0.09081215411424637, 0.09093780815601349, 0.0908261388540268, 0.09092102944850922, 0.09095881879329681, 0.09096582978963852, 0.09094204008579254, 0.09118469059467316, 0.09088350087404251, 0.09073210507631302], [0.0907902792096138, 0.0907517522573471, 0.09095562249422073, 0.09077443182468414, 0.09092839062213898, 0.09098973870277405, 0.09100110828876495, 0.0909624844789505, 0.09135668724775314, 0.09086748212575912, 0.09062197059392929], [0.09103113412857056, 0.09107089787721634, 0.09086084365844727, 0.09104748070240021, 0.0908888503909111, 0.09082579612731934, 0.09081411361694336, 0.09085378795862198, 0.09045039862394333, 0.09095153957605362, 0.09120511263608932], [0.0908171534538269, 0.09078732132911682, 0.09094513952732086, 0.09080488234758377, 0.09092406183481216, 0.09097153693437576, 0.09098033607006073, 0.09095045179128647, 0.09125537425279617, 0.09087692201137543, 0.09068681299686432], [0.09099903702735901, 0.09102833271026611, 0.09087356925010681, 0.09101107716560364, 0.09089421480894089, 0.09084774553775787, 0.09083913266658783, 0.09086837619543076, 0.09057091921567917, 0.09094040095806122, 0.09112715721130371], [0.09107129275798798, 0.09112419188022614, 0.09084487706422806, 0.0910930410027504, 0.09088210761547089, 0.09079829603433609, 0.0907827764749527, 0.09083550423383713, 0.09029972553253174, 0.09096544981002808, 0.0913027673959732], [0.09108467400074005, 0.0911419540643692, 0.09083954989910126, 0.09110821783542633, 0.09087985008955002, 0.09078912436962128, 0.09077232331037521, 0.09082940220832825, 0.09024955332279205, 0.09097008407115936, 0.09133533388376236], [0.09103921055793762, 0.09108161926269531, 0.09085763245820999, 0.09105664491653442, 0.09088749438524246, 0.09082026034593582, 0.09080781042575836, 0.0908501148223877, 0.09042006731033325, 0.09095434099435806, 0.09122475236654282], [0.09150088578462601, 0.09169556200504303, 0.09067101031541824, 0.09158087521791458, 0.09080708026885986, 0.09050095081329346, 0.09044434130191803, 0.09063676744699478, 0.08869530260562897, 0.09111226350069046, 0.09235500544309616], [0.09092717617750168, 0.09093305468559265, 0.09090196341276169, 0.09092959016561508, 0.09090611338615417, 0.09089677035808563, 0.09089504182338715, 0.09090092033147812, 0.09084104001522064, 0.09091539680957794, 0.09095288813114166], [0.0906362384557724, 0.09054803103208542, 0.09101534634828568, 0.09059996157884598, 0.09095284342765808, 0.09109366685152054, 0.09111978113651276, 0.09103109687566757, 0.09193861484527588, 0.09081315249204636, 0.09025125950574875]], [[0.09047024697065353, 0.09094163030385971, 0.09075002372264862, 0.09111306071281433, 0.09080347418785095, 0.09104879200458527, 0.09119357168674469, 0.09088371694087982, 0.09079287946224213, 0.09081961959600449, 0.09118293225765228], [0.09084165096282959, 0.09091410785913467, 0.09088469296693802, 0.09094037860631943, 0.09089291095733643, 0.09093054383993149, 0.09095270931720734, 0.09090522676706314, 0.0908912792801857, 0.0908953845500946, 0.09095108509063721], [0.09069077670574188, 0.09092532098293304, 0.09083005785942078, 0.09101046621799469, 0.0908566489815712, 0.09097856283187866, 0.09105043113231659, 0.09089653939008713, 0.09085138142108917, 0.09086466580629349, 0.09104514867067337], [0.0909765362739563, 0.09090405702590942, 0.09093346446752548, 0.09087780863046646, 0.09092525392770767, 0.0908876433968544, 0.09086550027132034, 0.09091293811798096, 0.0909268781542778, 0.0909227728843689, 0.09086712449789047], [0.0907328724861145, 0.09092219173908234, 0.09084530919790268, 0.09099089354276657, 0.09086677432060242, 0.0909651517868042, 0.09102313965559006, 0.09089896827936172, 0.09086251258850098, 0.09087324887514114, 0.09101887792348862], [0.09092598408460617, 0.09090783447027206, 0.09091519564390182, 0.09090125560760498, 0.09091313928365707, 0.09090372174978256, 0.09089817106723785, 0.09091005474328995, 0.0909135490655899, 0.09091252088546753, 0.09089857339859009], [0.09103985130786896, 0.09089932590723038, 0.09095633029937744, 0.09084845334291458, 0.09094041585922241, 0.09086751192808151, 0.09082461148500443, 0.09091654419898987, 0.09094356745481491, 0.0909356102347374, 0.09082776308059692], [0.0907960757613182, 0.09091751277446747, 0.09086821228265762, 0.09096156060695648, 0.09088196605443954, 0.0909450575709343, 0.09098222851753235, 0.09090261906385422, 0.09087923914194107, 0.09088612347841263, 0.09097949415445328], [0.09072453528642654, 0.09092281758785248, 0.09084229916334152, 0.09099479019641876, 0.09086477011442184, 0.0909678116440773, 0.09102855622768402, 0.09089849889278412, 0.09086031466722488, 0.09087155759334564, 0.09102409332990646], [0.09074559062719345, 0.09092125296592712, 0.09084992110729218, 0.09098499268293381, 0.09086982905864716, 0.09096110612154007, 0.09101490676403046, 0.09089970588684082, 0.09086588770151138, 0.09087584167718887, 0.09101095050573349], [0.09103148430585861, 0.09089995175600052, 0.09095331281423569, 0.09085233509540558, 0.09093841165304184, 0.09087017178535461, 0.0908300131559372, 0.09091606736183167, 0.09094136208295822, 0.0909339189529419, 0.09083296358585358]], [[0.09088972955942154, 0.09092071652412415, 0.09087149053812027, 0.09090247005224228, 0.09100798517465591, 0.09095870703458786, 0.09083501249551773, 0.09098058938980103, 0.0905509889125824, 0.09094226360321045, 0.09114006906747818], [0.0908990129828453, 0.09091518819332123, 0.09088949114084244, 0.09090566635131836, 0.09096074104309082, 0.09093502163887024, 0.0908704400062561, 0.09094644337892532, 0.0907219871878624, 0.09092643857002258, 0.09102963656187057], [0.0908842459321022, 0.09092395007610321, 0.09086087346076965, 0.09090056270360947, 0.09103579819202423, 0.0909726470708847, 0.09081414341926575, 0.09100068360567093, 0.09045042842626572, 0.09095156937837601, 0.09120514243841171], [0.09089355170726776, 0.09091845154762268, 0.09087889641523361, 0.09090378880500793, 0.09098856896162033, 0.09094897657632828, 0.09084959328174591, 0.09096655249595642, 0.09062126278877258, 0.09093576669692993, 0.09109465777873993], [0.09092487394809723, 0.09089937061071396, 0.09093989431858063, 0.09091438353061676, 0.09082761406898499, 0.09086810797452927, 0.09096994996070862, 0.09085012227296829, 0.09120475500822067, 0.09088163822889328, 0.09071925282478333], [0.09091031551361084, 0.09090834110975266, 0.09091147780418396, 0.09090950340032578, 0.09090278297662735, 0.09090591967105865, 0.0909138098359108, 0.09090452641248703, 0.0909319669008255, 0.09090696275234222, 0.09089437127113342], [0.09087321907281876, 0.09093036502599716, 0.09083958715200424, 0.09089671075344086, 0.09109139442443848, 0.09100046008825302, 0.0907723605632782, 0.09104083478450775, 0.09024959057569504, 0.09097012132406235, 0.09133537113666534], [0.09091680496931076, 0.0909043699502945, 0.09092411398887634, 0.09091168642044067, 0.09086941182613373, 0.09088914841413498, 0.0909387543797493, 0.0908803790807724, 0.09105302393436432, 0.09089573472738266, 0.09081657975912094], [0.09078503400087357, 0.09097819030284882, 0.09067148715257645, 0.090864397585392, 0.09152407199144363, 0.09121552854776382, 0.09044481068849564, 0.09135241061449051, 0.08869577199220657, 0.09111274033784866, 0.09235548973083496], [0.09090543538331985, 0.09091131389141083, 0.09090197086334229, 0.09090784937143326, 0.09092786908149719, 0.09091852605342865, 0.09089504927396774, 0.09092267602682114, 0.09084104746580124, 0.09091540426015854, 0.09095289558172226], [0.09096328169107437, 0.09087476134300232, 0.09101545065641403, 0.0909268781542778, 0.09062604606151581, 0.09076635539531708, 0.09111988544464111, 0.09070402383804321, 0.09193871915340424, 0.09081324934959412, 0.0902513638138771]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.065135072776932e-05, "episode_return_min": -14.5, "episode_return_mean": 1.05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.0007137996548217448, "num_env_steps_sampled_lifetime": 55400, "num_episodes": 20, "episode_duration_sec_mean": 0.005217068332713098, "module_episode_returns_mean": {"default_policy": 1.05}, "episode_len_min": 20, "episode_return_max": 13.5, "env_to_module_connector": {"connector_pipeline_timer": 5.8702270548860064e-05, "timers": {"connectors": {"numpy_to_tensor": 1.1889568335162328e-05, "add_time_dim_to_batch_and_zero_pad": 6.9774948492015675e-06, "batch_individual_items": 1.2354639191715112e-05, "add_states_from_episodes_to_batch": 2.763557365841315e-06, "add_observations_from_episodes_to_batch": 2.770078383793878e-06}}}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_episodes_lifetime": 220, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.574666649250607e-05, "listify_data_for_vector_env": 1.0406095725331357e-05, "un_batch_to_individual_items": 6.619900122663609e-06, "normalize_and_clip_actions": 8.04166539396467e-06, "remove_single_ts_time_rank_from_batch": 1.1887000843298316e-05, "tensor_to_numpy": 1.4972387643664543e-05}}, "connector_pipeline_timer": 0.00011365765375708331}, "num_env_steps_sampled": 400, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "num_agent_steps_sampled": {"default_agent": 400}, "env_step_timer": 1.40167755847369e-05, "agent_episode_returns_mean": {"default_agent": 1.05}, "sample": 0.1301359196891369, "weights_seq_no": 11.0, "time_between_sampling": 9.2990625440572}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "b509c_00000", "date": "2025-08-11_18-31-03", "timestamp": 1754929863, "time_this_iter_s": 9.167185068130493, "time_total_s": 102.09464478492737, "pid": 11229, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x383ebd8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 102.09464478492737, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 37.207692307692305, "ram_util_percent": 77.71538461538462}}
{"timers": {"training_iteration": 9.784314270934928, "restore_env_runners": 1.0184642513770759e-05, "training_step": 9.784103693263281, "env_runner_sampling_timer": 1.6522542712772537, "learner_update_timer": 7.954343448731908, "synch_weights": 0.0016465664257384659, "restore_eval_env_runners": 6.104608379416856e-05, "evaluation_iteration": 0.14282818300037045, "synch_eval_env_connectors": 0.00040518488666787183, "synch_env_connectors": 5.470363022095183e-06}, "env_runners": {"num_episodes_lifetime": -308250.0, "rlmodule_inference_timer": 5.584961527252756e-05, "episode_duration_sec_mean": 0.005711324679665267, "module_episode_returns_mean": {"default_policy": 0.6199999999999999}, "episode_return_min": -10.5, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2469044714299932e-05, "add_states_from_episodes_to_batch": 2.6887252810795913e-06, "numpy_to_tensor": 1.2354381131241566e-05, "add_observations_from_episodes_to_batch": 2.8315132809272955e-06, "add_time_dim_to_batch_and_zero_pad": 7.04815079945629e-06}}, "connector_pipeline_timer": 5.9957695646114614e-05}, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0552051731238891e-05, "un_batch_to_individual_items": 6.649162731856851e-06, "tensor_to_numpy": 1.5213476194772684e-05, "normalize_and_clip_actions": 8.040483220483488e-06, "remove_single_ts_time_rank_from_batch": 1.1949194570679801e-05, "get_actions": 3.8519690725455024e-05}}, "connector_pipeline_timer": 0.00011776317169394951}, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "env_step_timer": 1.3898405695682855e-05, "time_between_sampling": 0.031119247859985745, "episode_return_mean": 0.6199999999999999, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_max": 9.5, "sample": 0.005990139425318418, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "env_reset_timer": 3.741567830626666e-05, "num_env_steps_sampled_lifetime": -6165000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "agent_episode_returns_mean": {"default_agent": 0.6199999999999999}, "weights_seq_no": 11.0, "episode_len_mean": 20.0, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3248.434323657047}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13427545956542333, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008906150571410941, "add_observations_from_episodes_to_batch": 0.0009026389059619072, "add_columns_from_episodes_to_train_batch": 0.04141207685514654, "add_time_dim_to_batch_and_zero_pad": 0.07522040876845176, "add_states_from_episodes_to_batch": 0.0034713599738820907, "batch_individual_items": 0.004066645511994272, "numpy_to_tensor": 7.144468857463159e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "weights_seq_no": 12.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 71820, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.7412016936058, "num_module_steps_trained": 5985, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime_throughput": 784.2794244869178}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_env_steps_trained_lifetime": 2376000, "num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_module_steps_trained_lifetime": 861840, "num_env_steps_trained_lifetime_throughput": 51488.2329271302}, "default_policy": {"use_intrinsic_rewards": 1.0, "policy_loss": -0.0005151364021003246, "weights_seq_no": 72.0, "vf_explained_var": 0.0011208057403564453, "module_train_batch_size_mean": 997.504027034245, "total_loss": 0.2777574360370636, "num_module_steps_trained_lifetime": 430920, "diff_num_grad_updates_vs_sampler_policy": 61.0, "vf_loss_unclipped": 43.561038970947266, "mean_kl_loss": 5.192337994230911e-05, "entropy": 0.6846799850463867, "num_module_steps_trained": 35910, "vf_loss": 0.3585397005081177}, "intrinsic_reward_module": {"total_loss": 0.0, "weights_seq_no": 72.0, "num_module_steps_trained_lifetime": 430920, "diff_num_grad_updates_vs_sampler_policy": 61.0, "module_train_batch_size_mean": 997.504027034245, "num_module_steps_trained": 35910}}}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 33000, "num_module_steps_trained_lifetime": 143640, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 396000, "num_env_steps_trained_lifetime_throughput": 4325.704694121473, "num_module_steps_trained_throughput": 23932427.783379357, "num_module_steps_trained_lifetime_throughput": 12508380.385288307}, "default_policy": {"weights_seq_no": 12.0, "vf_explained_var": -0.0009697675704956055, "module_train_batch_size_mean": 997.7412016936058, "total_loss": 0.2775472104549408, "num_module_steps_trained_lifetime": 71820, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 43.44316101074219, "mean_kl_loss": 5.567712287302129e-05, "curr_kl_coeff": 3.944920172216371e-05, "entropy": 0.6846336126327515, "num_module_steps_trained": 5985, "vf_loss": 0.35830581188201904, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "use_intrinsic_rewards": 0.0, "policy_loss": -0.0005348183331079781, "num_module_steps_trained_lifetime_throughput": 784.2693127678126}, "IntrinsicAttentionMask": [[[0.09034865349531174, 0.09081940352916718, 0.09062805771827698, 0.09099060297012329, 0.09101739525794983, 0.09092642366886139, 0.09107100963592529, 0.09109782427549362, 0.09100677073001862, 0.09103357046842575, 0.09106037765741348], [0.09082291275262833, 0.09089535474777222, 0.09086594730615616, 0.09092162549495697, 0.09092573076486588, 0.09091178327798843, 0.09093394875526428, 0.09093805402517319, 0.09092409908771515, 0.09092821180820465, 0.09093231707811356], [0.09063016623258591, 0.09086455404758453, 0.09076935797929764, 0.090949647128582, 0.0909629538655281, 0.09091775864362717, 0.09098958224058151, 0.09100289642810822, 0.09095767885446548, 0.09097099304199219, 0.0909842997789383], [0.09099530428647995, 0.09092281013727188, 0.09095222502946854, 0.09089655429124832, 0.09089245647192001, 0.09090639650821686, 0.0908842459321022, 0.0908801406621933, 0.09089408069849014, 0.09088997542858124, 0.09088587015867233], [0.09102226793766022, 0.09092708677053452, 0.09096570312976837, 0.09089262038469315, 0.09088723361492157, 0.09090553224086761, 0.09087645262479782, 0.09087106585502625, 0.09088937193155289, 0.09088397771120071, 0.09087859094142914], [0.09093068540096283, 0.09091253578662872, 0.09091989696025848, 0.09090595692396164, 0.09090492129325867, 0.09090842306613922, 0.09090287238359451, 0.09090184420347214, 0.0909053310751915, 0.09090431034564972, 0.09090327471494675], [0.09107625484466553, 0.09093567728996277, 0.09099270403385162, 0.09088478237390518, 0.09087683260440826, 0.09090384095907211, 0.09086092561483383, 0.09085297584533691, 0.09087998420000076, 0.09087202697992325, 0.09086407721042633], [0.09110324084758759, 0.0909399464726448, 0.09100618958473206, 0.09088084846735, 0.09087160974740982, 0.09090298414230347, 0.09085313975811005, 0.09084390848875046, 0.09087526798248291, 0.09086603671312332, 0.09085679799318314], [0.09101158380508423, 0.09092539548873901, 0.09096036851406097, 0.0908941850066185, 0.09088930487632751, 0.09090587496757507, 0.09087955206632614, 0.09087467193603516, 0.09089124202728271, 0.09088636189699173, 0.09088148176670074], [0.09103855490684509, 0.09092967212200165, 0.09097384661436081, 0.09089025110006332, 0.09088408946990967, 0.09090501815080643, 0.09087176620960236, 0.0908656045794487, 0.09088653326034546, 0.0908803716301918, 0.09087421000003815], [0.09106554090976715, 0.09093396365642548, 0.09098733961582184, 0.09088632464408875, 0.09087888151407242, 0.09090416878461838, 0.09086398780345917, 0.09085655212402344, 0.0908818319439888, 0.09087438881397247, 0.09086694568395615]], [[0.0907747894525528, 0.09082355350255966, 0.09092649072408676, 0.09079483896493912, 0.09096094965934753, 0.09070304781198502, 0.0908689945936203, 0.09091781079769135, 0.09132421761751175, 0.09067720919847488, 0.09122803807258606], [0.09081555902957916, 0.09084954112768173, 0.09092126041650772, 0.0908295288681984, 0.09094526618719101, 0.09076555073261261, 0.09088120609521866, 0.09091521799564362, 0.0911981537938118, 0.09074753522872925, 0.09113122522830963], [0.0909014493227005, 0.09090422838926315, 0.09091009199619293, 0.09090258926153183, 0.09091205894947052, 0.09089735895395279, 0.09090682119131088, 0.09090960025787354, 0.0909326896071434, 0.0908958837389946, 0.09092722833156586], [0.09079155325889587, 0.09083424508571625, 0.09092435240745544, 0.09080910682678223, 0.09095451235771179, 0.0907287448644638, 0.09087402373552322, 0.09091676026582718, 0.09127237647771835, 0.09070612490177155, 0.0911882296204567], [0.09093017131090164, 0.09092250466346741, 0.09090632945299149, 0.09092701971530914, 0.09090091288089752, 0.09094146639108658, 0.09091535955667496, 0.09090768545866013, 0.09084402769804001, 0.0909455344080925, 0.0908590629696846], [0.09071476012468338, 0.09078525751829147, 0.0909341350197792, 0.09074373543262482, 0.09098399430513382, 0.09061107039451599, 0.09085097908973694, 0.09092158079147339, 0.09151007235050201, 0.0905737355351448, 0.09137069433927536], [0.0908534899353981, 0.09087369590997696, 0.09091634303331375, 0.09086179733276367, 0.09093061089515686, 0.09082373976707458, 0.09089252352714539, 0.09091275185346603, 0.09108083695173264, 0.09081302583217621, 0.09104109555482864], [0.09089421480894089, 0.09089963138103485, 0.09091103821992874, 0.09089644253253937, 0.09091486036777496, 0.09088625013828278, 0.09090466797351837, 0.09091007709503174, 0.09095503389835358, 0.09088338166475296, 0.09094441682100296], [0.09123160690069199, 0.09111369401216507, 0.09086550027132034, 0.09118311107158661, 0.09078262001276016, 0.0914054736495018, 0.09100400656461716, 0.09088638424873352, 0.0899154469370842, 0.0914682075381279, 0.09014389663934708], [0.09069310873746872, 0.09077143669128418, 0.09093686938285828, 0.09072531014680862, 0.090992271900177, 0.09057793021202087, 0.09084445238113403, 0.09092291444540024, 0.09157711267471313, 0.0905364528298378, 0.09142213314771652], [0.09115202724933624, 0.09106331318616867, 0.0908764973282814, 0.0911155417561531, 0.09081408381462097, 0.09128277748823166, 0.09098076820373535, 0.09089222550392151, 0.09016021341085434, 0.09132993966341019, 0.09033262729644775]], [[0.09050071239471436, 0.09097225219011307, 0.0907805860042572, 0.09080731868743896, 0.09083405882120132, 0.0910794585943222, 0.09088756144046783, 0.09091432392597198, 0.09115993976593018, 0.09118678420782089, 0.09087695181369781], [0.09084633737802505, 0.09091880172491074, 0.09088938683271408, 0.09089349210262299, 0.09089759737253189, 0.09093523770570755, 0.0909058079123497, 0.0909099206328392, 0.09094755351543427, 0.09095166623592377, 0.09090418368577957], [0.09070594608783722, 0.09094053506851196, 0.0908452570438385, 0.09085854887962341, 0.09087184816598892, 0.09099378436803818, 0.09089843928813934, 0.09091174602508545, 0.09103373438119888, 0.09104705601930618, 0.09089317172765732], [0.09072553366422653, 0.09093749523162842, 0.09085141122341156, 0.0908634290099144, 0.09087543934583664, 0.09098560363054276, 0.09089947491884232, 0.09091149270534515, 0.09102170169353485, 0.09103373438119888, 0.09089470654726028], [0.09074512124061584, 0.09093446284532547, 0.09085757285356522, 0.09086830168962479, 0.09087903797626495, 0.09097743034362793, 0.0909004956483841, 0.09091123193502426, 0.09100966900587082, 0.09102041274309158, 0.09089624881744385], [0.09092480689287186, 0.09090665727853775, 0.09091401845216751, 0.09091299027204514, 0.09091196209192276, 0.09090254455804825, 0.09090990573167801, 0.09090887755155563, 0.09089945256710052, 0.09089843183755875, 0.09091031551361084], [0.09078431874513626, 0.09092840552330017, 0.09086989611387253, 0.09087806195020676, 0.09088622778654099, 0.09096109122037888, 0.09090256690979004, 0.09091073274612427, 0.09098561108112335, 0.09099378436803818, 0.09089932590723038], [0.09080392122268677, 0.09092536568641663, 0.09087605774402618, 0.09088294208049774, 0.0908898264169693, 0.09095291793346405, 0.09090358763933182, 0.09091047942638397, 0.09097358584403992, 0.09098047018051147, 0.09090086072683334], [0.09098369628190994, 0.09089753776788712, 0.09093249589204788, 0.0909276157617569, 0.09092273563146591, 0.09087802469730377, 0.09091297537088394, 0.09090809524059296, 0.09086339175701141, 0.09085851162672043, 0.09091491252183914], [0.09100334346294403, 0.09089450538158417, 0.09093865752220154, 0.09093249589204788, 0.09092632681131363, 0.09086985886096954, 0.09091400355100632, 0.09090784192085266, 0.09085138142108917, 0.09084521979093552, 0.09091644734144211], [0.09077654778957367, 0.09092960506677628, 0.09086745232343674, 0.09087612479925156, 0.09088480472564697, 0.09096432477235794, 0.09090214967727661, 0.09091082960367203, 0.09099037200212479, 0.0909990593791008, 0.09089870750904083]], [[0.09090543538331985, 0.0908994972705841, 0.09093090891838074, 0.09092496335506439, 0.09092671424150467, 0.09093615412712097, 0.09091593325138092, 0.0909319594502449, 0.0908387154340744, 0.09091733396053314, 0.09087231755256653], [0.09089631587266922, 0.09087557345628738, 0.09098529815673828, 0.09096453338861465, 0.09097064286470413, 0.09100364148616791, 0.09093297272920609, 0.09098898619413376, 0.09066350013017654, 0.09093787521123886, 0.09078070521354675], [0.09094398468732834, 0.09100156277418137, 0.09069754183292389, 0.09075497090816498, 0.09073805809020996, 0.09064684808254242, 0.0908423438668251, 0.0906873345375061, 0.09159310162067413, 0.09082876890897751, 0.09126553684473038], [0.09093507379293442, 0.09097783267498016, 0.090752013027668, 0.09079468995332718, 0.09078212082386017, 0.09071434289216995, 0.09085959196090698, 0.09074442833662033, 0.09141665697097778, 0.09084951132535934, 0.09117375314235687], [0.09093769639730453, 0.09098482131958008, 0.09073597192764282, 0.09078299254179001, 0.09076914191246033, 0.09069445729255676, 0.09085451066493988, 0.09072761982679367, 0.09146857261657715, 0.09084340929985046, 0.09120076894760132], [0.09095180034637451, 0.09102248400449753, 0.09064940363168716, 0.09071985632181168, 0.09069910645484924, 0.09058722108602524, 0.09082706272602081, 0.09063689410686493, 0.09174919128417969, 0.09081041067838669, 0.09134664386510849], [0.09092143923044205, 0.0909416675567627, 0.09083478152751923, 0.09085499495267868, 0.09084904193878174, 0.09081694483757019, 0.0908857211470604, 0.09083119034767151, 0.09114895761013031, 0.09088094532489777, 0.09103427827358246], [0.0909455418586731, 0.09100576490163803, 0.09068784862756729, 0.0907478928565979, 0.0907302051782608, 0.09063483774662018, 0.09083925932645798, 0.0906771793961525, 0.09162447601556778, 0.09082507342100143, 0.09128184616565704], [0.09079976379871368, 0.09062779694795609, 0.09154066443443298, 0.09136728942394257, 0.0914183035492897, 0.09169407188892365, 0.09110435098409653, 0.09157150238752365, 0.08888614922761917, 0.09114513546228409, 0.08984501659870148], [0.09092357009649277, 0.09094729274511337, 0.09082194417715073, 0.09084563702344894, 0.09083866328001022, 0.09080101549625397, 0.09088167548179626, 0.09081772714853287, 0.09119048714637756, 0.09087608009576797, 0.09105593711137772], [0.09085384011268616, 0.09076542407274246, 0.09123386442661285, 0.09114507585763931, 0.09117121249437332, 0.09131236374378204, 0.09101025015115738, 0.09124965220689774, 0.08986528217792511, 0.09103117883205414, 0.09036190807819366]], [[0.09043971449136734, 0.09057537466287613, 0.0910555049777031, 0.09074611961841583, 0.09110913425683975, 0.09068211168050766, 0.0911628007888794, 0.09118964523077011, 0.09109850227832794, 0.09112533181905746, 0.0908157080411911], [0.09055417031049728, 0.0906568169593811, 0.09101980924606323, 0.09078595042228699, 0.0910603255033493, 0.09073755145072937, 0.09110086411237717, 0.0911211371421814, 0.09105229377746582, 0.09107255190610886, 0.09083857387304306], [0.09095866233110428, 0.09094429761171341, 0.09089363366365433, 0.09092624485492706, 0.09088799357414246, 0.09093300998210907, 0.09088235348463058, 0.09087952971458435, 0.090889111161232, 0.09088628739118576, 0.0909188985824585], [0.09069810807704926, 0.09075917303562164, 0.09097489714622498, 0.09083595871925354, 0.09099895507097244, 0.09080718457698822, 0.0910230204463005, 0.09103505313396454, 0.09099418669939041, 0.09100621193647385, 0.09086723625659943], [0.09100379049777985, 0.09097633510828018, 0.09087955206632614, 0.09094184637069702, 0.09086877852678299, 0.09095476567745209, 0.09085800498723984, 0.09085262566804886, 0.0908709168434143, 0.09086553007364273, 0.09092780947685242], [0.09064416587352753, 0.09072082489728928, 0.09099172800779343, 0.09081723541021347, 0.09102194756269455, 0.09078110009431839, 0.09105218201875687, 0.09106730669736862, 0.09101596474647522, 0.09103107452392578, 0.09085649996995926], [0.09104893356561661, 0.09100838005542755, 0.09086547046899796, 0.09095744788646698, 0.09084957093000412, 0.0909765213727951, 0.09083367139101028, 0.09082572162151337, 0.09085272252559662, 0.0908447653055191, 0.09093672037124634], [0.09107152372598648, 0.09102441370487213, 0.09085844457149506, 0.09096525609493256, 0.09083997458219528, 0.09098741412162781, 0.09082150459289551, 0.09081228077411652, 0.09084363281726837, 0.09083440154790878, 0.0909411832690239], [0.09099484235048294, 0.090969979763031, 0.09088234603404999, 0.0909387543797493, 0.09087258577346802, 0.09095045179128647, 0.09086283296346664, 0.09085796028375626, 0.09087452292442322, 0.09086964279413223, 0.09092605113983154], [0.09101741760969162, 0.09098600596189499, 0.0908753052353859, 0.09094656258821487, 0.09086298942565918, 0.09096133708953857, 0.09085066616535187, 0.09084451198577881, 0.09086542576551437, 0.09085927158594131, 0.0909305065870285], [0.09075675159692764, 0.09080085903406143, 0.09095660597085953, 0.09085631370544434, 0.09097397327423096, 0.09083553403615952, 0.09099134057760239, 0.0910000279545784, 0.09097053110599518, 0.09097921848297119, 0.09087889641523361]], [[0.09075842797756195, 0.09080718457698822, 0.0907297283411026, 0.09095893800258636, 0.0909445583820343, 0.09086699038743973, 0.09085261821746826, 0.09090142697095871, 0.09130775928497314, 0.09066087007522583, 0.09121159464120865], [0.09080412983894348, 0.09083811193704605, 0.09078412503004074, 0.090943843126297, 0.09093382954597473, 0.09087978303432465, 0.09086976945400238, 0.09090378135442734, 0.09118667989969254, 0.09073611348867416, 0.09111975878477097], [0.09073149412870407, 0.09078893810510635, 0.09069768339395523, 0.09096778929233551, 0.09095083922147751, 0.09085941314697266, 0.09084248542785645, 0.0909000039100647, 0.09137909859418869, 0.09061654657125473, 0.09126567840576172], [0.09094619005918503, 0.090934157371521, 0.0909532755613327, 0.09089674800634384, 0.09090029448270798, 0.09091940522193909, 0.09092295169830322, 0.09091091901063919, 0.09081107378005981, 0.09097029268741608, 0.09083465486764908], [0.09093274176120758, 0.09092506766319275, 0.09093725681304932, 0.09090122580528259, 0.09090348333120346, 0.09091566503047943, 0.0909179300069809, 0.09091025590896606, 0.09084659069776535, 0.09094810485839844, 0.09086163341999054], [0.09086015075445175, 0.090876005589962, 0.0908508151769638, 0.09092531353235245, 0.09092064201831818, 0.09089544415473938, 0.0908907800912857, 0.09090663492679596, 0.09103844314813614, 0.09082841128110886, 0.0910072848200798], [0.0908467024564743, 0.09086691588163376, 0.09083480387926102, 0.09092977643013, 0.09092381596565247, 0.09089169651269913, 0.09088573604822159, 0.09090595692396164, 0.09107403457164764, 0.09080624580383301, 0.09103430062532425], [0.09089238941669464, 0.0908978059887886, 0.09088920801877975, 0.09091462939977646, 0.09091303497552872, 0.09090443700551987, 0.09090284258127213, 0.09090825915336609, 0.09095320850610733, 0.09088155627250671, 0.09094259142875671], [0.09127137809991837, 0.09115340560674667, 0.09134091436862946, 0.0907876119017601, 0.09082219004631042, 0.09100901335477829, 0.09104366600513458, 0.09092599898576736, 0.08995463699102402, 0.09150807559490204, 0.09018318355083466], [0.09066683053970337, 0.09074513614177704, 0.0906207486987114, 0.09098902344703674, 0.09096590429544449, 0.09084121882915497, 0.0908181294798851, 0.09089656919240952, 0.09155057370662689, 0.09051021933555603, 0.09139563143253326], [0.0911819189786911, 0.09109317511320114, 0.09123421460390091, 0.09081782400608063, 0.09084386378526688, 0.0909845158457756, 0.09101060032844543, 0.0909220278263092, 0.09018978476524353, 0.09135989099740982, 0.09036225080490112]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.125298814150899e-05, "episode_return_min": -14.5, "episode_return_mean": 1.05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.0007075408186348917, "num_env_steps_sampled_lifetime": 60400, "num_episodes": 20, "episode_duration_sec_mean": 0.00520789667381905, "module_episode_returns_mean": {"default_policy": 1.05}, "episode_len_min": 20, "episode_return_max": 13.5, "env_to_module_connector": {"connector_pipeline_timer": 5.91727250530745e-05, "timers": {"connectors": {"numpy_to_tensor": 1.2048636669273915e-05, "add_time_dim_to_batch_and_zero_pad": 7.0607116533345245e-06, "batch_individual_items": 1.2511663784524892e-05, "add_states_from_episodes_to_batch": 2.8674584875686665e-06, "add_observations_from_episodes_to_batch": 2.7935095330752807e-06}}}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_episodes_lifetime": 240, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.638545600950024e-05, "listify_data_for_vector_env": 1.0594979268979148e-05, "un_batch_to_individual_items": 6.579154980855642e-06, "normalize_and_clip_actions": 8.11439336200208e-06, "remove_single_ts_time_rank_from_batch": 1.1908492334306455e-05, "tensor_to_numpy": 1.515892302674803e-05}}, "connector_pipeline_timer": 0.00011461130527649075}, "num_env_steps_sampled": 400, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "num_agent_steps_sampled": {"default_agent": 400}, "env_step_timer": 1.3962855797273766e-05, "agent_episode_returns_mean": {"default_agent": 1.05}, "sample": 0.1299754896524195, "weights_seq_no": 12.0, "time_between_sampling": 9.29702460153666}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "b509c_00000", "date": "2025-08-11_18-31-12", "timestamp": 1754929872, "time_this_iter_s": 9.190324068069458, "time_total_s": 111.28496885299683, "pid": 11229, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x383ebd8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 111.28496885299683, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 36.307692307692314, "ram_util_percent": 78.08461538461538}}
{"timers": {"training_iteration": 9.77950845697594, "restore_env_runners": 1.0144465941217653e-05, "training_step": 9.77929780091071, "env_runner_sampling_timer": 1.6534863802345923, "learner_update_timer": 7.947408743824541, "synch_weights": 0.0016382978413593818, "restore_eval_env_runners": 6.0587283016736905e-05, "evaluation_iteration": 0.14259215076089773, "synch_eval_env_connectors": 0.00040260220731172156, "synch_env_connectors": 5.4660695545317295e-06}, "env_runners": {"num_episodes_lifetime": -339125.0, "rlmodule_inference_timer": 3.625295565142743e-05, "episode_duration_sec_mean": 0.0058354128515347835, "module_episode_returns_mean": {"default_policy": 0.22}, "episode_return_min": -10.5, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.3252551094943606e-05, "add_states_from_episodes_to_batch": 2.844633414577634e-06, "numpy_to_tensor": 1.3510398466909007e-05, "add_observations_from_episodes_to_batch": 3.0214136990013017e-06, "add_time_dim_to_batch_and_zero_pad": 7.5236500063635726e-06}}, "connector_pipeline_timer": 6.382120439038667e-05}, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1105955084101365e-05, "un_batch_to_individual_items": 7.433240878496327e-06, "tensor_to_numpy": 1.7526347537664735e-05, "normalize_and_clip_actions": 8.4410957844177e-06, "remove_single_ts_time_rank_from_batch": 1.2569790996024097e-05, "get_actions": 4.2444924007397725e-05}}, "connector_pipeline_timer": 0.00012820613949083277}, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "env_step_timer": 1.577320743696901e-05, "time_between_sampling": 0.03078328536047612, "episode_return_mean": 0.22, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_max": 9.5, "sample": 0.005990424740727102, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "env_reset_timer": 3.796384870668178e-05, "num_env_steps_sampled_lifetime": -6782500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "agent_episode_returns_mean": {"default_agent": 0.22}, "weights_seq_no": 12.0, "episode_len_mean": 20.0, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3202.945503826837}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13490710454969085, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008909470315111589, "add_observations_from_episodes_to_batch": 0.0009037525172791385, "add_columns_from_episodes_to_train_batch": 0.0416440023364895, "add_time_dim_to_batch_and_zero_pad": 0.07561256010102328, "add_states_from_episodes_to_batch": 0.0034735984645929007, "batch_individual_items": 0.004068488636672536, "numpy_to_tensor": 7.147233115787107e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "weights_seq_no": 13.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 77805, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.7269395717314, "num_module_steps_trained": 5985, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime_throughput": 782.5744618343509}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_env_steps_trained_lifetime": 2574000, "num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_module_steps_trained_lifetime": 933660, "num_env_steps_trained_lifetime_throughput": 50658.700841863734}, "default_policy": {"use_intrinsic_rewards": 1.0, "policy_loss": -8.350089774467051e-05, "weights_seq_no": 78.0, "vf_explained_var": 0.0012892484664916992, "module_train_batch_size_mean": 997.5020416990191, "total_loss": 0.2781757712364197, "num_module_steps_trained_lifetime": 466830, "diff_num_grad_updates_vs_sampler_policy": 66.0, "vf_loss_unclipped": 43.58845138549805, "mean_kl_loss": 4.0998061194841284e-06, "entropy": 0.6842865347862244, "num_module_steps_trained": 35910, "vf_loss": 0.35853174328804016}, "intrinsic_reward_module": {"total_loss": 0.0, "weights_seq_no": 78.0, "num_module_steps_trained_lifetime": 466830, "diff_num_grad_updates_vs_sampler_policy": 66.0, "module_train_batch_size_mean": 997.5020416990191, "num_module_steps_trained": 35910}}}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 33000, "num_module_steps_trained_lifetime": 155610, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 429000, "num_env_steps_trained_lifetime_throughput": 4316.251404196812, "num_module_steps_trained_throughput": 23329962.40677273, "num_module_steps_trained_lifetime_throughput": 12493184.32047237}, "default_policy": {"weights_seq_no": 13.0, "vf_explained_var": 0.0011185407638549805, "module_train_batch_size_mean": 997.7269395717314, "total_loss": 0.2779950499534607, "num_module_steps_trained_lifetime": 77805, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 43.5954475402832, "mean_kl_loss": 4.563174570648698e-06, "curr_kl_coeff": 1.9724600861081854e-05, "entropy": 0.6842653751373291, "num_module_steps_trained": 5985, "vf_loss": 0.35830795764923096, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "use_intrinsic_rewards": 0.0, "policy_loss": -8.922834240365773e-05, "num_module_steps_trained_lifetime_throughput": 782.5649620555648}, "IntrinsicAttentionMask": [[[0.09047024697065353, 0.09094163030385971, 0.0910862386226654, 0.09111306071281433, 0.09080347418785095, 0.09071271866559982, 0.09119357168674469, 0.09088371694087982, 0.09079287946224213, 0.09115608781576157, 0.09084635972976685], [0.09084165096282959, 0.09091410785913467, 0.09093628078699112, 0.09094037860631943, 0.09089291095733643, 0.09087896347045898, 0.09095270931720734, 0.09090522676706314, 0.0908912792801857, 0.0909469723701477, 0.09089948982000351], [0.09095543622970581, 0.09090562909841537, 0.09089040756225586, 0.09088759124279022, 0.09092019498348236, 0.0909297838807106, 0.09087912738323212, 0.09091173112392426, 0.0909213125705719, 0.09088306874036789, 0.09091567248106003], [0.0909765437245369, 0.09090406447649002, 0.09088192135095596, 0.09087781608104706, 0.09092526137828827, 0.09093920886516571, 0.09086550772190094, 0.09091294556856155, 0.0909268856048584, 0.09087123721837997, 0.09091868251562119], [0.0907328799366951, 0.09092219918966293, 0.090980164706707, 0.09099090099334717, 0.09086678177118301, 0.09083034098148346, 0.09102314710617065, 0.09089897572994232, 0.09086252003908157, 0.09100814163684845, 0.09088398516178131], [0.09066138416528702, 0.09092749655246735, 0.09100901335477829, 0.09102412313222885, 0.09084957093000412, 0.09079834818840027, 0.09106948226690292, 0.09089483320713043, 0.09084358811378479, 0.09104836732149124, 0.09087376296520233], [0.09103985130786896, 0.09089932590723038, 0.0908564031124115, 0.09084845334291458, 0.09094041585922241, 0.09096744656562805, 0.09082461148500443, 0.09091654419898987, 0.09094356745481491, 0.09083570539951324, 0.09092765301465988], [0.09079606831073761, 0.09091750532388687, 0.09095466881990433, 0.09096155315637589, 0.09088195860385895, 0.090858593583107, 0.09098222106695175, 0.09090261161327362, 0.09087923169136047, 0.09097260236740112, 0.09089300036430359], [0.09072453528642654, 0.09092281758785248, 0.09098353236913681, 0.09099479019641876, 0.09086477011442184, 0.0908266082406044, 0.09102855622768402, 0.09089849889278412, 0.09086031466722488, 0.09101283550262451, 0.0908827930688858], [0.09101036936044693, 0.09090152382850647, 0.0908682718873024, 0.09086211025714874, 0.09093335270881653, 0.09095429629087448, 0.09084363281726837, 0.09091486036777496, 0.09093579649925232, 0.09085223823785782, 0.09092346578836441], [0.09076665341854095, 0.09091969579458237, 0.09096653759479523, 0.09097521752119064, 0.09087489545345306, 0.09084544330835342, 0.09100127220153809, 0.09090092033147812, 0.09087146073579788, 0.0909891426563263, 0.09088880568742752]], [[0.0907747820019722, 0.09082353860139847, 0.09092648327350616, 0.090975321829319, 0.09096094220876694, 0.09070304036140442, 0.09068869799375534, 0.09091780334711075, 0.09132421016693115, 0.09067720174789429, 0.09122802317142487], [0.09081555157899857, 0.09084953367710114, 0.09092125296592712, 0.09095527976751328, 0.09094525873661041, 0.09076554328203201, 0.09075554460287094, 0.09091521054506302, 0.0911981463432312, 0.09074752777814865, 0.09113121777772903], [0.0909014567732811, 0.09090423583984375, 0.09091009944677353, 0.09091287851333618, 0.09091206640005112, 0.09089736640453339, 0.09089654684066772, 0.09090960770845413, 0.090932697057724, 0.0908958911895752, 0.09092723578214645], [0.0909421443939209, 0.09093011170625687, 0.09090474247932434, 0.09089270979166031, 0.09089625626802444, 0.09095986187458038, 0.09096340835094452, 0.09090687334537506, 0.09080703556537628, 0.09096624702215195, 0.09083061665296555], [0.09093017131090164, 0.09092250466346741, 0.09090632945299149, 0.09089865535497665, 0.09090091288089752, 0.09094146639108658, 0.09094372391700745, 0.09090768545866013, 0.09084402769804001, 0.0909455344080925, 0.0908590629696846], [0.0907147228717804, 0.09078522771596909, 0.09093409776687622, 0.09100476652383804, 0.09098395705223083, 0.090611033141613, 0.09059031307697296, 0.0909215435385704, 0.09151003509759903, 0.09057369828224182, 0.09137064963579178], [0.09070270508527756, 0.09077754616737366, 0.0909356102347374, 0.09101064503192902, 0.09098854660987854, 0.0905926376581192, 0.09057063609361649, 0.0909222811460495, 0.09154723584651947, 0.09055300056934357, 0.09139920026063919], [0.09089421480894089, 0.09089963138103485, 0.09091103821992874, 0.0909164547920227, 0.09091486036777496, 0.09088625013828278, 0.09088466316461563, 0.09091007709503174, 0.09095503389835358, 0.09088338166475296, 0.09094441682100296], [0.09123150259256363, 0.09111358970403671, 0.09086539596319199, 0.09074795246124268, 0.0907825157046318, 0.09140536934137344, 0.09144018590450287, 0.09088627994060516, 0.08991533517837524, 0.09146810322999954, 0.09014379233121872], [0.09069305658340454, 0.09077138453722, 0.0909368097782135, 0.09101535379886627, 0.09099221974611282, 0.0905778706073761, 0.0905548483133316, 0.09092286229133606, 0.09157706052064896, 0.09053640067577362, 0.09142207354307175], [0.09115196019411087, 0.0910632461309433, 0.09087643027305603, 0.09078798443078995, 0.0908140167593956, 0.09128271043300629, 0.09130888432264328, 0.09089215844869614, 0.09016014635562897, 0.09132987260818481, 0.09033256024122238]], [[0.09043985605239868, 0.09091108292341232, 0.09105563908815384, 0.09108246117830276, 0.09077297896146774, 0.09101821482181549, 0.09116294234991074, 0.09085319191217422, 0.09109864383935928, 0.09078910946846008, 0.09081584960222244], [0.09083696454763412, 0.09090942144393921, 0.09093158692121506, 0.09093568474054337, 0.09088821709156036, 0.09092584997415543, 0.09094801545143127, 0.09090053290128708, 0.09093817323446274, 0.09089069813489914, 0.09089479595422745], [0.09095866233110428, 0.09090885519981384, 0.09089363366365433, 0.0908908098936081, 0.09092342108488083, 0.0908975750207901, 0.09088235348463058, 0.09091495722532272, 0.090889111161232, 0.09092172235250473, 0.0909188985824585], [0.09098123013973236, 0.09090875089168549, 0.09088660031557083, 0.09088249504566193, 0.09092994779348373, 0.09089232981204987, 0.09087018668651581, 0.09091763198375702, 0.09088001400232315, 0.09092746675014496, 0.09092336148023605], [0.09072065353393555, 0.090909942984581, 0.09096789360046387, 0.09097863733768463, 0.09085453301668167, 0.09095289558172226, 0.09101087599992752, 0.09088671952486038, 0.09098512679338455, 0.0908610001206398, 0.09087173640727997], [0.09092716127634048, 0.09090901166200638, 0.09090346097946167, 0.0909024327993393, 0.09091431647539139, 0.09090489894151688, 0.09089934825897217, 0.09091123193502426, 0.09090180695056915, 0.09091369807720184, 0.09091266989707947], [0.0910489484667778, 0.09090841561555862, 0.09086548537015915, 0.09085753560066223, 0.09094949811697006, 0.09087658673524857, 0.09083368629217148, 0.09092562645673752, 0.09085272997617722, 0.09094469994306564, 0.09093673527240753], [0.09078822284936905, 0.09090964496135712, 0.09094680845737457, 0.09095369279384613, 0.09087411314249039, 0.09093718975782394, 0.090974360704422, 0.09089475870132446, 0.09095785766839981, 0.09087826311588287, 0.09088514745235443], [0.09099484235048294, 0.09090866893529892, 0.09088234603404999, 0.090877465903759, 0.09093387424945831, 0.09088915586471558, 0.09086283296346664, 0.09091923385858536, 0.09087452292442322, 0.09093092381954193, 0.09092605113983154], [0.09073424339294434, 0.09090988337993622, 0.09096365422010422, 0.0909736230969429, 0.09085846692323685, 0.09094973653554916, 0.09100352972745895, 0.09088834375143051, 0.09097963571548462, 0.09086447954177856, 0.09087443351745605], [0.09075675904750824, 0.09090978652238846, 0.09095662087202072, 0.09096530824899673, 0.09086499363183975, 0.09094449877738953, 0.09099135547876358, 0.09089101850986481, 0.09097054600715637, 0.09087023138999939, 0.09087890386581421]], [[0.09090014547109604, 0.09093113243579865, 0.09099652618169785, 0.09091288596391678, 0.09090375900268555, 0.09085454046726227, 0.09084542840719223, 0.09099102020263672, 0.09056136757135391, 0.09095268696546555, 0.09115051478147507], [0.09090445190668106, 0.09092062711715698, 0.09095475822687149, 0.09091110527515411, 0.09090633690357208, 0.09088063985109329, 0.09087587893009186, 0.09095188230276108, 0.09072741866111755, 0.09093187749385834, 0.09103508293628693], [0.09091337025165558, 0.0908983126282692, 0.0908665657043457, 0.09090717881917953, 0.0909116119146347, 0.09093554317951202, 0.0909399762749672, 0.09086924046278, 0.09107846766710281, 0.09088784456253052, 0.09079194813966751], [0.0909019261598587, 0.09092681854963303, 0.09097936749458313, 0.09091216325759888, 0.0909048318862915, 0.09086528420448303, 0.09085796028375626, 0.09097493439912796, 0.09062960743904114, 0.09094414114952087, 0.09110304713249207], [0.09090065211057663, 0.09092991054058075, 0.09099165350198746, 0.09091268479824066, 0.09090406447649002, 0.090857595205307, 0.09084898233413696, 0.0909864529967308, 0.09058073908090591, 0.09095025807619095, 0.09113703668117523], [0.09089373052120209, 0.09094652533531189, 0.09105797857046127, 0.09091543406248093, 0.09089989215135574, 0.09081606566905975, 0.09080054610967636, 0.09104858338832855, 0.09031739830970764, 0.09098324924707413, 0.09132063388824463], [0.09089243412017822, 0.09094958752393723, 0.091070257127285, 0.09091592580080032, 0.09089910238981247, 0.09080836176872253, 0.09079155325889587, 0.0910600870847702, 0.09026866406202316, 0.0909893587231636, 0.09135468304157257], [0.09091262519359589, 0.09090019762516022, 0.09087400138378143, 0.0909075140953064, 0.09091117233037949, 0.09093092381954193, 0.09093458205461502, 0.09087620675563812, 0.09104884415864944, 0.09089156240224838, 0.09081241488456726], [0.09085001796483994, 0.09104330837726593, 0.09145233780145645, 0.09092943370342255, 0.09087255597114563, 0.09056620299816132, 0.0905095562338829, 0.09141780436038971, 0.08875925093889236, 0.09117795526981354, 0.09242159873247147], [0.09090740978717804, 0.09091328829526901, 0.09092569351196289, 0.09090982377529144, 0.09090809524059296, 0.09089875221252441, 0.09089702367782593, 0.09092464298009872, 0.09084301441907883, 0.09091737866401672, 0.09095486998558044], [0.09093353152275085, 0.09084504097700119, 0.09065866470336914, 0.09089713543653488, 0.09092319756746292, 0.0910639762878418, 0.09109008312225342, 0.09067435562610626, 0.09190864861011505, 0.09078355133533478, 0.0902218446135521]], [[0.09043972939252853, 0.09057538956403732, 0.09105551987886429, 0.09074613451957703, 0.09110914915800095, 0.09068212658166885, 0.09082631766796112, 0.0911896601319313, 0.09109851717948914, 0.09112534672021866, 0.09115217626094818], [0.09055417776107788, 0.0906568244099617, 0.09101981669664383, 0.09078595787286758, 0.0910603329539299, 0.09073755890130997, 0.09084659814834595, 0.091121144592762, 0.09105230122804642, 0.09107255935668945, 0.09109283238649368], [0.09095866233110428, 0.09094429761171341, 0.09089363366365433, 0.09092624485492706, 0.09088799357414246, 0.09093300998210907, 0.09091778099536896, 0.09087952971458435, 0.090889111161232, 0.09088628739118576, 0.09088347107172012], [0.09069810807704926, 0.09075917303562164, 0.09097489714622498, 0.09083595871925354, 0.09099895507097244, 0.09080718457698822, 0.09087198972702026, 0.09103505313396454, 0.09099418669939041, 0.09100621193647385, 0.09101825207471848], [0.09100379049777985, 0.09097633510828018, 0.09087955206632614, 0.09094184637069702, 0.09086877852678299, 0.09095476567745209, 0.0909256786108017, 0.09085262566804886, 0.0908709168434143, 0.09086553007364273, 0.09086014330387115], [0.09064417332410812, 0.09072083234786987, 0.09099173545837402, 0.09081724286079407, 0.09102195501327515, 0.09078110754489899, 0.09086249023675919, 0.09106731414794922, 0.09101597219705582, 0.09103108197450638, 0.09104619920253754], [0.09076567739248276, 0.09080719947814941, 0.09095381945371628, 0.09085940569639206, 0.09097015857696533, 0.09083984047174454, 0.09088389575481415, 0.0909946858882904, 0.09096692502498627, 0.09097509831190109, 0.09098327159881592], [0.09107152372598648, 0.09102441370487213, 0.09085844457149506, 0.09096525609493256, 0.09083997458219528, 0.09098741412162781, 0.09093751758337021, 0.09081228077411652, 0.09084363281726837, 0.09083440154790878, 0.0908251628279686], [0.09099484235048294, 0.090969979763031, 0.09088234603404999, 0.0909387543797493, 0.09087258577346802, 0.09095045179128647, 0.09092411398887634, 0.09085796028375626, 0.09087452292442322, 0.09086965024471283, 0.09086476266384125], [0.09101741760969162, 0.09098600596189499, 0.0908753052353859, 0.09094656258821487, 0.09086298942565918, 0.09096133708953857, 0.09092807024717331, 0.09084451198577881, 0.09086542576551437, 0.09085927158594131, 0.09085310995578766], [0.0910399854183197, 0.09100202471017838, 0.0908682644367218, 0.09095435589551926, 0.09085337817668915, 0.09097221493721008, 0.09093200415372849, 0.09083104878664017, 0.09085632860660553, 0.0908488854765892, 0.09084144234657288]], [[0.09090543538331985, 0.0908994972705841, 0.09093090891838074, 0.09092496335506439, 0.09092671424150467, 0.09093615412712097, 0.09091593325138092, 0.0909319594502449, 0.0908387154340744, 0.09091733396053314, 0.09087231755256653], [0.09089631587266922, 0.09087557345628738, 0.09098529815673828, 0.09096453338861465, 0.09097064286470413, 0.09100364148616791, 0.09093297272920609, 0.09098898619413376, 0.09066350013017654, 0.09093787521123886, 0.09078070521354675], [0.09094397723674774, 0.09100156277418137, 0.09069753438234329, 0.09075497090816498, 0.09073805809020996, 0.09064684808254242, 0.0908423364162445, 0.0906873345375061, 0.09159310162067413, 0.09082876890897751, 0.09126553684473038], [0.09093507379293442, 0.09097783267498016, 0.090752013027668, 0.09079468995332718, 0.09078212082386017, 0.09071433544158936, 0.09085959196090698, 0.09074442833662033, 0.09141665697097778, 0.09084951132535934, 0.09117374569177628], [0.09093769639730453, 0.09098482131958008, 0.09073597192764282, 0.09078299254179001, 0.09076914191246033, 0.09069445729255676, 0.09085451066493988, 0.09072761982679367, 0.09146857261657715, 0.09084340184926987, 0.09120076894760132], [0.09095180034637451, 0.09102248400449753, 0.09064940363168716, 0.09071985632181168, 0.09069910645484924, 0.09058722108602524, 0.09082706272602081, 0.09063688665628433, 0.09174919128417969, 0.09081040322780609, 0.09134664386510849], [0.09092143923044205, 0.0909416675567627, 0.09083478152751923, 0.09085499495267868, 0.09084904193878174, 0.09081694483757019, 0.0908857136964798, 0.09083119034767151, 0.09114895761013031, 0.09088094532489777, 0.09103427082300186], [0.0909455418586731, 0.09100576490163803, 0.09068784862756729, 0.0907478928565979, 0.0907302051782608, 0.09063483774662018, 0.09083925932645798, 0.0906771793961525, 0.09162447601556778, 0.09082506597042084, 0.09128184616565704], [0.09079976379871368, 0.09062779694795609, 0.09154066443443298, 0.09136728942394257, 0.0914183035492897, 0.09169407188892365, 0.09110435098409653, 0.09157150238752365, 0.08888614177703857, 0.09114513546228409, 0.08984500914812088], [0.09092357009649277, 0.09094729274511337, 0.09082194417715073, 0.09084563702344894, 0.09083866328001022, 0.09080101549625397, 0.09088167548179626, 0.09081772714853287, 0.09119048714637756, 0.09087608009576797, 0.09105593711137772], [0.09085384011268616, 0.09076542407274246, 0.09123386442661285, 0.09114507585763931, 0.09117121249437332, 0.09131236374378204, 0.09101025015115738, 0.09124965220689774, 0.08986528217792511, 0.09103117883205414, 0.09036190807819366]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.1188118621584716e-05, "episode_return_min": -14.5, "episode_return_mean": 1.65, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.000703799159930951, "num_env_steps_sampled_lifetime": 65400, "num_episodes": 20, "episode_duration_sec_mean": 0.005227860402083024, "module_episode_returns_mean": {"default_policy": 1.65}, "episode_len_min": 20, "episode_return_max": 13.5, "env_to_module_connector": {"connector_pipeline_timer": 5.9054974794474734e-05, "timers": {"connectors": {"numpy_to_tensor": 1.1979609022246425e-05, "add_time_dim_to_batch_and_zero_pad": 7.04294858814937e-06, "batch_individual_items": 1.2510202129669109e-05, "add_states_from_episodes_to_batch": 2.772958493619476e-06, "add_observations_from_episodes_to_batch": 2.7909973691757552e-06}}}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_episodes_lifetime": 260, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.6316797192786396e-05, "listify_data_for_vector_env": 1.053421964862265e-05, "un_batch_to_individual_items": 6.5717343317476745e-06, "normalize_and_clip_actions": 7.9597474102442e-06, "remove_single_ts_time_rank_from_batch": 1.1923176519008404e-05, "tensor_to_numpy": 1.4913912558992015e-05}}, "connector_pipeline_timer": 0.00011402376256792167}, "num_env_steps_sampled": 400, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "num_agent_steps_sampled": {"default_agent": 400}, "env_step_timer": 1.3883861051321273e-05, "agent_episode_returns_mean": {"default_agent": 1.65}, "sample": 0.12984257392593215, "weights_seq_no": 13.0, "time_between_sampling": 9.297363069690837}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "b509c_00000", "date": "2025-08-11_18-31-21", "timestamp": 1754929881, "time_this_iter_s": 9.431989908218384, "time_total_s": 120.71695876121521, "pid": 11229, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x383ebd8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 120.71695876121521, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 36.87692307692308, "ram_util_percent": 77.65384615384616}}
{"timers": {"training_iteration": 9.77358241157616, "restore_env_runners": 1.0099691096317608e-05, "training_step": 9.773371539981722, "env_runner_sampling_timer": 1.653550976433117, "learner_update_timer": 7.941348989726775, "synch_weights": 0.0016335461121631046, "restore_eval_env_runners": 6.0051829814742655e-05, "evaluation_iteration": 0.14241863467323448, "synch_eval_env_connectors": 0.00039962284512916666, "synch_env_connectors": 5.445988866181885e-06}, "env_runners": {"num_episodes_lifetime": -370000.0, "rlmodule_inference_timer": 6.190913247447442e-05, "episode_duration_sec_mean": 0.005781971673946825, "module_episode_returns_mean": {"default_policy": 0.86}, "episode_return_min": -10.5, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2489487824015529e-05, "add_states_from_episodes_to_batch": 2.6991039965886597e-06, "numpy_to_tensor": 1.2567085462259743e-05, "add_observations_from_episodes_to_batch": 2.844388667864093e-06, "add_time_dim_to_batch_and_zero_pad": 7.102145510435289e-06}}, "connector_pipeline_timer": 6.031893503404496e-05}, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0497993752897444e-05, "un_batch_to_individual_items": 6.681716640660023e-06, "tensor_to_numpy": 1.5364929386375043e-05, "normalize_and_clip_actions": 8.049865241481095e-06, "remove_single_ts_time_rank_from_batch": 1.2037698444716683e-05, "get_actions": 3.904616978212129e-05}}, "connector_pipeline_timer": 0.00011866277763248244}, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "env_step_timer": 1.3981310874145061e-05, "time_between_sampling": 0.03120965939590627, "episode_return_mean": 0.86, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_max": 9.5, "sample": 0.006360758167695618, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "env_reset_timer": 4.21801567889909e-05, "num_env_steps_sampled_lifetime": -7400000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "agent_episode_returns_mean": {"default_agent": 0.86}, "weights_seq_no": 13.0, "episode_len_mean": 20.0, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3188.1245074270064}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13491139808403915, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008910670191237287, "add_observations_from_episodes_to_batch": 0.0009032712423563141, "add_columns_from_episodes_to_train_batch": 0.0416433939835225, "add_time_dim_to_batch_and_zero_pad": 0.07561815157945317, "add_states_from_episodes_to_batch": 0.003474074149693758, "batch_individual_items": 0.004068178330145219, "numpy_to_tensor": 7.122760793264459e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "weights_seq_no": 14.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 83790, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.7135120670981, "num_module_steps_trained": 5985, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime_throughput": 780.8223730616312}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_env_steps_trained_lifetime": 2772000, "num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_module_steps_trained_lifetime": 1005480, "num_env_steps_trained_lifetime_throughput": 49863.97398662101}, "default_policy": {"use_intrinsic_rewards": 1.0, "policy_loss": -0.0010248067555949092, "weights_seq_no": 84.0, "vf_explained_var": 0.0010957121849060059, "module_train_batch_size_mean": 997.5006590853257, "total_loss": 0.27723196148872375, "num_module_steps_trained_lifetime": 502740, "diff_num_grad_updates_vs_sampler_policy": 71.0, "vf_loss_unclipped": 43.55391311645508, "mean_kl_loss": 8.637606515549123e-05, "entropy": 0.6824067831039429, "num_module_steps_trained": 35910, "vf_loss": 0.35850781202316284}, "intrinsic_reward_module": {"total_loss": 0.0, "weights_seq_no": 84.0, "num_module_steps_trained_lifetime": 502740, "diff_num_grad_updates_vs_sampler_policy": 71.0, "module_train_batch_size_mean": 997.5006590853257, "num_module_steps_trained": 35910}}}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 33000, "num_module_steps_trained_lifetime": 167580, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 462000, "num_env_steps_trained_lifetime_throughput": 4306.54119564483, "num_module_steps_trained_throughput": 22766234.290375173, "num_module_steps_trained_lifetime_throughput": 12489458.244395467}, "default_policy": {"weights_seq_no": 14.0, "vf_explained_var": -0.0012873411178588867, "module_train_batch_size_mean": 997.7135120670981, "total_loss": 0.2770163118839264, "num_module_steps_trained_lifetime": 83790, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 43.45231246948242, "mean_kl_loss": 9.513645636616275e-05, "curr_kl_coeff": 9.862300430540927e-06, "entropy": 0.68231201171875, "num_module_steps_trained": 5985, "vf_loss": 0.35830673575401306, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "use_intrinsic_rewards": 0.0, "policy_loss": -0.001069999998435378, "num_module_steps_trained_lifetime_throughput": 780.8134626580908}, "IntrinsicAttentionMask": [[[0.09087104350328445, 0.09074816107749939, 0.09093911200761795, 0.09094975888729095, 0.09082676470279694, 0.09092424809932709, 0.09098170697689056, 0.09085866808891296, 0.0909561887383461, 0.0909668356180191, 0.09097748249769211], [0.09081792831420898, 0.09052412956953049, 0.0909809097647667, 0.09100641310214996, 0.09071200340986252, 0.090945303440094, 0.09108297526836395, 0.09078831970691681, 0.0910218134522438, 0.09104733169078827, 0.09107285737991333], [0.09090040624141693, 0.09087231755256653, 0.09091595560312271, 0.09091838449239731, 0.09089028835296631, 0.09091256558895111, 0.0909256786108017, 0.0908975750207901, 0.0909198522567749, 0.0909222885966301, 0.0909247174859047], [0.09090499579906464, 0.09089174121618271, 0.09091232717037201, 0.09091347455978394, 0.09090021997690201, 0.09091072529554367, 0.09091691672801971, 0.09090366214513779, 0.09091416746377945, 0.09091531485319138, 0.0909164622426033], [0.09085191786289215, 0.09066741913557053, 0.09095417708158493, 0.09097017347812653, 0.0907854214310646, 0.09093184024095535, 0.0910181775689125, 0.09083333611488342, 0.09097982943058014, 0.09099582582712173, 0.09101182967424393], [0.09089399129152298, 0.09084519743919373, 0.09092100709676743, 0.09092523157596588, 0.09087641537189484, 0.09091511368751526, 0.09093790501356125, 0.0908890813589096, 0.09092777967453003, 0.09093200415372849, 0.09093622863292694], [0.09091874212026596, 0.09095001965761185, 0.0909014493227005, 0.09089874476194382, 0.09093000739812851, 0.09090522676706314, 0.09089063107967377, 0.09092189371585846, 0.09089711308479309, 0.09089440852403641, 0.09089170396327972], [0.09086570143699646, 0.09072559326887131, 0.09094332903623581, 0.0909554660320282, 0.0908152163028717, 0.09092637151479721, 0.09099189937114716, 0.09085159003734589, 0.09096279740333557, 0.09097494184970856, 0.09098708629608154], [0.0909077599644661, 0.09090346097946167, 0.09091013669967651, 0.09091050922870636, 0.09090621024370193, 0.09090962260961533, 0.0909116268157959, 0.09090732783079147, 0.09091073274612427, 0.09091110527515411, 0.09091147780418396], [0.0909123420715332, 0.09092288464307785, 0.09090651571750641, 0.09090559929609299, 0.09091613441705704, 0.09090778976678848, 0.09090286493301392, 0.09091340750455856, 0.09090504795312881, 0.09090413898229599, 0.09090322256088257], [0.0909169390797615, 0.09094232320785522, 0.0909028947353363, 0.09090069681406021, 0.09092608094215393, 0.09090595692396164, 0.09089411050081253, 0.09091949462890625, 0.09089937061071396, 0.09089717268943787, 0.09089498221874237]], [[0.09077480435371399, 0.09082356095314026, 0.09074609726667404, 0.09097534418106079, 0.09078048914670944, 0.09088337421417236, 0.0908690094947815, 0.09091781824827194, 0.09132423251867294, 0.09067721664905548, 0.09122804552316666], [0.09081555902957916, 0.09084954112768173, 0.09079554677009583, 0.09095528721809387, 0.09081952273845673, 0.09089121967554092, 0.09088120609521866, 0.09091521799564362, 0.0911981537938118, 0.09074753522872925, 0.09113122522830963], [0.0907507911324501, 0.09080825746059418, 0.09071697294712067, 0.09098714590072632, 0.09075749665498734, 0.09087873995304108, 0.09086180478334427, 0.09091933816671371, 0.09139853715896606, 0.09063582867383957, 0.0912850946187973], [0.0909421443939209, 0.09093011170625687, 0.09094922989606857, 0.09089270979166031, 0.09094074368476868, 0.09091535955667496, 0.09091890603303909, 0.09090687334537506, 0.09080703556537628, 0.09096624702215195, 0.09083061665296555], [0.09077955037355423, 0.0908265933394432, 0.09075186401605606, 0.09097299724817276, 0.09078504145145416, 0.09088429063558578, 0.09087042510509491, 0.09091751277446747, 0.09130950272083282, 0.0906854197382927, 0.09121674299240112], [0.09086548537015915, 0.0908813402056694, 0.0908561497926712, 0.09093064814805984, 0.09086733311414719, 0.09090077877044678, 0.0908961072564125, 0.09091196954250336, 0.09104378521442413, 0.09083373844623566, 0.0910126268863678], [0.0908534899353981, 0.09087369590997696, 0.09084159135818481, 0.0909365639090538, 0.09085584431886673, 0.09089848399162292, 0.09089252352714539, 0.09091275185346603, 0.09108083695173264, 0.09081302583217621, 0.09104109555482864], [0.09089421480894089, 0.09089963138103485, 0.0908910259604454, 0.0909164547920227, 0.09089484810829163, 0.09090626239776611, 0.09090466797351837, 0.09091007709503174, 0.09095503389835358, 0.09088338166475296, 0.09094441682100296], [0.09123163670301437, 0.09111372381448746, 0.09130114316940308, 0.09074808657169342, 0.09121786803007126, 0.09096938371658325, 0.09100402891635895, 0.09088641405105591, 0.08991546183824539, 0.09146823734045029, 0.09014392644166946], [0.09069312363862991, 0.09077145159244537, 0.09064702689647675, 0.09101542085409164, 0.09070226550102234, 0.0908675566315651, 0.09084446728229523, 0.09092292189598083, 0.09157712757587433, 0.0905364602804184, 0.09142214059829712], [0.09115204215049744, 0.09106332808732986, 0.09120432287454605, 0.09078806638717651, 0.09114167839288712, 0.09095470607280731, 0.09098078310489655, 0.0908922404050827, 0.09016022831201553, 0.09132995456457138, 0.09033264219760895]], [[0.09050062298774719, 0.09063637256622314, 0.09078049659729004, 0.0911436527967453, 0.09083396196365356, 0.09107936173677444, 0.09088746458292007, 0.09125105291604996, 0.09082336723804474, 0.0908501073718071, 0.09121353924274445], [0.09060022979974747, 0.09070293605327606, 0.09081192314624786, 0.09108636528253555, 0.09085234999656677, 0.0910378023982048, 0.09089279919862747, 0.09116748720407486, 0.09084434062242508, 0.09086455404758453, 0.09113916009664536], [0.09070591628551483, 0.09077351540327072, 0.09084522724151611, 0.09102566540241241, 0.09087181836366653, 0.09099374711513519, 0.09089841693639755, 0.09107895940542221, 0.09086654335260391, 0.09087984263896942, 0.0910603478550911], [0.09097184240818024, 0.09095093607902527, 0.09092877060174942, 0.0908731147646904, 0.09092056006193161, 0.09088295698165894, 0.0909123569726944, 0.09085670858621597, 0.09092219173908234, 0.09091808646917343, 0.09086243808269501], [0.09074511379003525, 0.09079967439174652, 0.09085755795240402, 0.0910031646490097, 0.09087902307510376, 0.09097741544246674, 0.0909004881978035, 0.09104616194963455, 0.09087476879358292, 0.09088549762964249, 0.09103114902973175], [0.09092480689287186, 0.09091956913471222, 0.09091401845216751, 0.09090007841587067, 0.09091196209192276, 0.09090254455804825, 0.09090990573167801, 0.09089596569538116, 0.09091237187385559, 0.09091134369373322, 0.09089740365743637], [0.09078430384397507, 0.09082584083080292, 0.09086988866329193, 0.090980663895607, 0.09088622033596039, 0.09096107631921768, 0.09090255200862885, 0.0910133644938469, 0.09088297933340073, 0.09089114516973495, 0.09100194275379181], [0.0910503938794136, 0.09100329130887985, 0.09095339477062225, 0.09082812815904617, 0.09093490988016129, 0.09085024893283844, 0.09091642498970032, 0.09079121053218842, 0.09093856811523438, 0.09092932939529419, 0.0908040925860405], [0.09073734283447266, 0.09079449623823166, 0.09085511416196823, 0.09100763499736786, 0.09087760001420975, 0.0909806564450264, 0.09090007841587067, 0.09105266630649567, 0.09087314456701279, 0.09088438004255295, 0.09103693813085556], [0.09075693786144257, 0.09080757200717926, 0.09086128324270248, 0.09099637717008591, 0.09088119864463806, 0.09097249060869217, 0.09090111404657364, 0.09103626757860184, 0.09087724983692169, 0.09088721126317978, 0.09102233499288559], [0.09102296829223633, 0.0909850150346756, 0.090944804251194, 0.09084384143352509, 0.09092990309000015, 0.09086167067289352, 0.0909150093793869, 0.09081407636404037, 0.09093286097049713, 0.09092541038990021, 0.09082446247339249]], [[0.09081192314624786, 0.0908760279417038, 0.0909137949347496, 0.0908021554350853, 0.09089702367782593, 0.09093480557203293, 0.09094180911779404, 0.09091802686452866, 0.09124882519245148, 0.09094741940498352, 0.09070815145969391], [0.09097515046596527, 0.0909314900636673, 0.09090577811002731, 0.09098181128501892, 0.0909171923995018, 0.09089148789644241, 0.09088672697544098, 0.0909029021859169, 0.09067855775356293, 0.09088291227817535, 0.09104595333337784], [0.09107118099927902, 0.0909639224410057, 0.09090081602334976, 0.09108753502368927, 0.09092883765697479, 0.09086575359106064, 0.09085407108068466, 0.09089376032352448, 0.0903441533446312, 0.09084470570087433, 0.09124524146318436], [0.09078702330589294, 0.0908675342798233, 0.09091497212648392, 0.090774767100811, 0.09089390188455582, 0.09094135463237762, 0.09095015376806259, 0.09092027693986893, 0.09133599698543549, 0.09095720946788788, 0.09065673500299454], [0.09102854877710342, 0.09094954282045364, 0.09090304374694824, 0.09104059636592865, 0.09092368930578232, 0.09087721258401871, 0.09086859971284866, 0.09089784324169159, 0.09049253165721893, 0.09086169302463531, 0.09115671366453171], [0.0911245346069336, 0.09098189324140549, 0.09089798480272293, 0.09114629775285721, 0.09093523770570755, 0.09085138142108917, 0.09083584696054459, 0.090888611972332, 0.09015870839357376, 0.09082339704036713, 0.09135614335536957], [0.09114231169223785, 0.09098786115646362, 0.09089703112840652, 0.09116587042808533, 0.09093735367059708, 0.09084657579660416, 0.0908297598361969, 0.09088687598705292, 0.09009696543216705, 0.09081628918647766, 0.0913931280374527], [0.09108190983533859, 0.09096753597259521, 0.0909002497792244, 0.09109935164451599, 0.09093011915683746, 0.09086286276578903, 0.09085040539503098, 0.0908927246928215, 0.09030681103467941, 0.0908404141664505, 0.09126754105091095], [0.09191782772541046, 0.09124384820461273, 0.09084925055503845, 0.09202097356319427, 0.09102427214384079, 0.09063062816858292, 0.09055786579847336, 0.09080522507429123, 0.08743005990982056, 0.09049957245588303, 0.0930204838514328], [0.09115655720233917, 0.09099264442920685, 0.09089625626802444, 0.09118156880140305, 0.09093904495239258, 0.09084270894527435, 0.09082487225532532, 0.0908854752779007, 0.09004748612642288, 0.09081056714057922, 0.09142278134822845], [0.09054697304964066, 0.09078515321016312, 0.09092571586370468, 0.09051073342561722, 0.09086326509714127, 0.09100394695997238, 0.09103003889322281, 0.09094144403934479, 0.09217938035726547, 0.09105096012353897, 0.09016237407922745]], [[0.0909074917435646, 0.09078455716371536, 0.09097559005022049, 0.09085255861282349, 0.0908631980419159, 0.09096071869134903, 0.0910181999206543, 0.09089511632919312, 0.09099266678094864, 0.09086962044239044, 0.09088025242090225], [0.09090518206357956, 0.09061110019683838, 0.0910683199763298, 0.09077370166778564, 0.09079915285110474, 0.09103267639875412, 0.09117048233747482, 0.090875543653965, 0.0911092609167099, 0.0908145159482956, 0.09083997458219528], [0.0909087285399437, 0.0908806324005127, 0.09092427790164948, 0.09089618176221848, 0.09089861065149307, 0.09092088788747787, 0.09093400090932846, 0.09090589731931686, 0.09092817455530167, 0.09090007841587067, 0.09090250730514526], [0.09090647101402283, 0.09070704877376556, 0.09101701527833939, 0.09081734716892242, 0.0908345952630043, 0.09099286794662476, 0.09108620136976242, 0.09088638424873352, 0.09104474633932114, 0.0908450186252594, 0.09086227416992188], [0.09090667217969894, 0.09072205424308777, 0.0910089910030365, 0.09082416445016861, 0.09084013849496841, 0.09098663926124573, 0.09107302874326706, 0.09088807553052902, 0.0910346582531929, 0.09084977954626083, 0.09086575359106064], [0.0909084677696228, 0.09085965901613235, 0.09093548357486725, 0.0908866599202156, 0.09089088439941406, 0.09092958271503448, 0.09095238149166107, 0.09090355038642883, 0.09094225615262985, 0.09089343249797821, 0.09089765697717667], [0.09090949594974518, 0.09094076603651047, 0.09089219570159912, 0.09092346578836441, 0.09092076122760773, 0.09089597314596176, 0.09088138490915298, 0.09091264754533768, 0.09088785946369171, 0.090919129550457, 0.09091642498970032], [0.0909072756767273, 0.09076710045337677, 0.09098493307828903, 0.09084463864564896, 0.09085676074028015, 0.09096796810626984, 0.09103352576494217, 0.09089315682649612, 0.09100440889596939, 0.09086408466100693, 0.09087621420621872], [0.09090904146432877, 0.09090474247932434, 0.09091141819953918, 0.09090711921453476, 0.0909074917435646, 0.090910904109478, 0.09091290831565857, 0.09090860933065414, 0.09091201424598694, 0.09090771526098251, 0.09090808779001236], [0.09090679883956909, 0.09073112159967422, 0.0910041555762291, 0.0908282920718193, 0.09084348380565643, 0.09098289161920547, 0.09106508642435074, 0.0908891037106514, 0.09102857857942581, 0.09085266292095184, 0.09086786955595016], [0.09090698510408401, 0.09074611961841583, 0.09099612385034561, 0.0908351019024849, 0.09084901958703995, 0.09097665548324585, 0.09105190634727478, 0.0908907875418663, 0.09101848304271698, 0.09085742384195328, 0.09087134152650833]], [[0.09090007841587067, 0.09104575216770172, 0.09099645912647247, 0.09102748334407806, 0.09090369194746017, 0.0908544734120369, 0.09084536135196686, 0.09099095314741135, 0.09044722467660904, 0.09083805233240128, 0.0911504477262497], [0.0909198522567749, 0.09073872864246368, 0.09079994261264801, 0.09076140820980072, 0.09091534465551376, 0.09097667783498764, 0.09098804742097855, 0.09080678969621658, 0.09148706495761871, 0.09099715948104858, 0.09060896188020706], [0.09091334789991379, 0.09084264189004898, 0.09086655080318451, 0.09085150063037872, 0.09091159701347351, 0.09093552082777023, 0.0909399539232254, 0.09086921811103821, 0.09113425016403198, 0.09094350785017014, 0.09079192578792572], [0.09091746807098389, 0.09077724814414978, 0.09082464873790741, 0.09079480916261673, 0.09091398119926453, 0.09096144884824753, 0.0909702479839325, 0.09082994610071182, 0.09135617315769196, 0.09097730368375778, 0.09067675471305847], [0.09090059995651245, 0.09103814512491226, 0.09099160134792328, 0.09102088958024979, 0.09090401232242584, 0.09085754305124283, 0.09084893018007278, 0.09098640084266663, 0.09047294408082962, 0.09084203094244003, 0.09113698452711105], [0.09089354425668716, 0.09114183485507965, 0.09105779230594635, 0.09111068397760391, 0.09089970588684082, 0.09081587940454483, 0.09080035984516144, 0.09104839712381363, 0.0901234820485115, 0.09078790992498398, 0.0913204476237297], [0.09089221060276031, 0.09116104245185852, 0.0910700336098671, 0.09112729877233505, 0.09089887887239456, 0.09080813825130463, 0.09079132974147797, 0.0910598635673523, 0.09005884826183319, 0.09077785909175873, 0.09135445952415466], [0.09091261029243469, 0.09085425734519958, 0.09087398648262024, 0.09086156636476517, 0.09091116487979889, 0.09093090146780014, 0.09093456715345383, 0.09087619185447693, 0.09109485894441605, 0.09093749523162842, 0.09081239998340607], [0.09082778543233871, 0.09199923276901245, 0.09160137176513672, 0.09185157716274261, 0.09085670858621597, 0.090463787317276, 0.09039115905761719, 0.09155697375535965, 0.08726911246776581, 0.09033297747373581, 0.0928492471575737], [0.09089113771915436, 0.09117643535137177, 0.09107984602451324, 0.09114062786102295, 0.09089822322130203, 0.09080192446708679, 0.09078409522771835, 0.0910690501332283, 0.09000705927610397, 0.09076979756355286, 0.09138173609972], [0.09093300253152847, 0.09051799029111862, 0.09065813571214676, 0.09056990593671799, 0.09092266857624054, 0.09106343984603882, 0.09108954668045044, 0.09067382663488388, 0.09223964065313339, 0.0911104828119278, 0.09022131562232971]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.088676571361739e-05, "episode_return_min": -14.5, "episode_return_mean": 1.05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.0006976111678190416, "num_env_steps_sampled_lifetime": 70400, "num_episodes": 20, "episode_duration_sec_mean": 0.005232409182935953, "module_episode_returns_mean": {"default_policy": 1.05}, "episode_len_min": 20, "episode_return_max": 13.5, "env_to_module_connector": {"connector_pipeline_timer": 5.946234392546848e-05, "timers": {"connectors": {"numpy_to_tensor": 1.1996316388843564e-05, "add_time_dim_to_batch_and_zero_pad": 7.086752790949349e-06, "batch_individual_items": 1.2617815580453892e-05, "add_states_from_episodes_to_batch": 2.8188869223518135e-06, "add_observations_from_episodes_to_batch": 2.8195558903721612e-06}}}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_episodes_lifetime": 280, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.59755137007367e-05, "listify_data_for_vector_env": 1.0467946987393352e-05, "un_batch_to_individual_items": 6.574871483521903e-06, "normalize_and_clip_actions": 8.007600007070932e-06, "remove_single_ts_time_rank_from_batch": 1.1968333976555526e-05, "tensor_to_numpy": 1.5017796386816567e-05}}, "connector_pipeline_timer": 0.00011401108795770208}, "num_env_steps_sampled": 400, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "num_agent_steps_sampled": {"default_agent": 400}, "env_step_timer": 1.388482937819891e-05, "agent_episode_returns_mean": {"default_agent": 1.05}, "sample": 0.12967888735675662, "weights_seq_no": 14.0, "time_between_sampling": 9.296562567743639}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "b509c_00000", "date": "2025-08-11_18-31-31", "timestamp": 1754929891, "time_this_iter_s": 9.30883002281189, "time_total_s": 130.0257887840271, "pid": 11229, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x383ebd8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 130.0257887840271, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 37.642857142857146, "ram_util_percent": 77.74285714285715}}
{"timers": {"training_iteration": 9.764951176210449, "restore_env_runners": 1.006452355738791e-05, "training_step": 9.764740078332803, "env_runner_sampling_timer": 1.6521310354183925, "learner_update_timer": 7.934078556078986, "synch_weights": 0.001625009821021463, "restore_eval_env_runners": 5.95925617190275e-05, "evaluation_iteration": 0.1421828649867998, "synch_eval_env_connectors": 0.0003968916158328301, "synch_env_connectors": 5.452779734946089e-06}, "env_runners": {"num_episodes_lifetime": -400875.0, "rlmodule_inference_timer": 3.118318004205236e-05, "episode_duration_sec_mean": 0.005210328832734378, "module_episode_returns_mean": {"default_policy": 0.54}, "episode_return_min": -10.5, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2324108108232743e-05, "add_states_from_episodes_to_batch": 2.6705172255275188e-06, "numpy_to_tensor": 1.223014236843032e-05, "add_observations_from_episodes_to_batch": 2.7933786112614357e-06, "add_time_dim_to_batch_and_zero_pad": 6.9713908717168e-06}}, "connector_pipeline_timer": 5.9380485443221615e-05}, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0368600367167903e-05, "un_batch_to_individual_items": 6.5695617334979924e-06, "tensor_to_numpy": 1.5059814960518262e-05, "normalize_and_clip_actions": 7.943515577830807e-06, "remove_single_ts_time_rank_from_batch": 1.1849533391382725e-05, "get_actions": 3.7914977667787205e-05}}, "connector_pipeline_timer": 0.00011640692874614967}, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "env_step_timer": 1.3684211180213197e-05, "time_between_sampling": 0.03115160449657219, "episode_return_mean": 0.54, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_max": 9.5, "sample": 0.005944759277369426, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "env_reset_timer": 3.615928019050307e-05, "num_env_steps_sampled_lifetime": -8017500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "agent_episode_returns_mean": {"default_agent": 0.54}, "weights_seq_no": 14.0, "episode_len_mean": 20.0, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3297.2778565223743}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13488880118292276, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008909519738805983, "add_observations_from_episodes_to_batch": 0.0009030068597952562, "add_columns_from_episodes_to_train_batch": 0.04163448296280941, "add_time_dim_to_batch_and_zero_pad": 0.07560515839316531, "add_states_from_episodes_to_batch": 0.0034764150677354918, "batch_individual_items": 0.00406774862749663, "numpy_to_tensor": 7.116200150376848e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "weights_seq_no": 15.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 89775, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.7008703380301, "num_module_steps_trained": 5985, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime_throughput": 779.3695462214744}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_env_steps_trained_lifetime": 2970000, "num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_module_steps_trained_lifetime": 1077300, "num_env_steps_trained_lifetime_throughput": 49103.80567755045}, "default_policy": {"use_intrinsic_rewards": 1.0, "policy_loss": -0.0006117162411101162, "weights_seq_no": 90.0, "vf_explained_var": 0.001149296760559082, "module_train_batch_size_mean": 997.4996962148737, "total_loss": 0.2776298224925995, "num_module_steps_trained_lifetime": 538650, "diff_num_grad_updates_vs_sampler_policy": 76.0, "vf_loss_unclipped": 43.55356216430664, "mean_kl_loss": 4.810471727978438e-05, "entropy": 0.6808322072029114, "num_module_steps_trained": 35910, "vf_loss": 0.35849305987358093}, "intrinsic_reward_module": {"total_loss": 0.0, "weights_seq_no": 90.0, "num_module_steps_trained_lifetime": 538650, "diff_num_grad_updates_vs_sampler_policy": 76.0, "module_train_batch_size_mean": 997.4996962148737, "num_module_steps_trained": 35910}}}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 33000, "num_module_steps_trained_lifetime": 179550, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 495000, "num_env_steps_trained_lifetime_throughput": 4298.483028073511, "num_module_steps_trained_throughput": 22235558.374107122, "num_module_steps_trained_lifetime_throughput": 12490671.241543839}, "default_policy": {"weights_seq_no": 15.0, "vf_explained_var": -0.002415299415588379, "module_train_batch_size_mean": 997.7008703380301, "total_loss": 0.2774495780467987, "num_module_steps_trained_lifetime": 89775, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 43.48841857910156, "mean_kl_loss": 5.326783866621554e-05, "curr_kl_coeff": 4.931150215270463e-06, "entropy": 0.6807519793510437, "num_module_steps_trained": 5985, "vf_loss": 0.35830679535865784, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "use_intrinsic_rewards": 0.0, "policy_loss": -0.0006391984643414617, "num_module_steps_trained_lifetime_throughput": 779.3611973655021}, "IntrinsicAttentionMask": [[[0.09088320285081863, 0.09089384973049164, 0.09095128625631332, 0.09082828462123871, 0.09083892405033112, 0.09093641489744186, 0.09099388122558594, 0.09087082743644714, 0.09096835553646088, 0.09084533900022507, 0.09098965674638748], [0.09088633209466934, 0.09089568257331848, 0.09094619750976562, 0.09083802998065948, 0.09084738790988922, 0.09093312174081802, 0.09098365157842636, 0.09087544679641724, 0.09096121042966843, 0.09085303544998169, 0.0909799337387085], [0.09090317785739899, 0.09090561419725418, 0.09091872721910477, 0.09089063107967377, 0.09089305996894836, 0.09091533720493317, 0.09092845022678375, 0.09090034663677216, 0.09092262387275696, 0.09089452773332596, 0.09092748910188675], [0.0908670574426651, 0.09088432043790817, 0.09097754955291748, 0.09077796339988708, 0.09079521149396896, 0.09095341712236404, 0.09104670584201813, 0.0908469706773758, 0.09100526571273804, 0.09080562740564346, 0.09103984385728836], [0.09087018668651581, 0.09088616818189621, 0.09097246080636978, 0.09078770875930786, 0.09080367535352707, 0.0909501239657402, 0.09103647619485855, 0.09085159748792648, 0.09099812060594559, 0.09081331640481949, 0.09103012830018997], [0.09089881181716919, 0.09090303629636765, 0.09092582762241364, 0.09087701141834259, 0.09088123589754105, 0.09091993421316147, 0.09094272553920746, 0.09089390188455582, 0.09093260020017624, 0.0908837839961052, 0.09094104915857315], [0.09091566503047943, 0.09091296046972275, 0.09089836478233337, 0.09092963486909866, 0.09092693030834198, 0.09090214222669601, 0.09088755398988724, 0.09091881662607193, 0.09089402854442596, 0.09092529863119125, 0.0908886194229126], [0.09087956696748734, 0.09089169651269913, 0.09095720201730728, 0.09081694483757019, 0.09082906693220139, 0.09094024449586868, 0.09100577980279922, 0.09086544811725616, 0.09097667038440704, 0.09083639085292816, 0.09100095927715302], [0.09090818464756012, 0.09090855717658997, 0.09091056138277054, 0.09090626239776611, 0.09090663492679596, 0.09091004729270935, 0.09091205149888992, 0.0909077525138855, 0.09091115742921829, 0.09090685844421387, 0.09091190248727798], [0.09087207913398743, 0.09088728576898575, 0.09096939861774445, 0.09079360216856003, 0.09080879390239716, 0.09094814211130142, 0.0910303071141243, 0.09085439145565033, 0.09099381417036057, 0.09081796556711197, 0.09102426469326019], [0.09091442078351974, 0.09091223031282425, 0.09090038388967514, 0.09092576056718826, 0.09092356264591217, 0.09090344607830048, 0.09089159220457077, 0.09091697633266449, 0.0908968597650528, 0.09092223644256592, 0.09089247137308121]], [[0.09083586931228638, 0.09081211686134338, 0.0908498615026474, 0.09091399610042572, 0.09083309769630432, 0.09087084978818893, 0.09096579253673553, 0.09094200283288956, 0.09127289056777954, 0.09097140282392502, 0.09073206782341003], [0.09079020470380783, 0.09075167030096054, 0.09081289917230606, 0.0909169539809227, 0.09078570455312729, 0.090846948325634, 0.09100102633237839, 0.09096240997314453, 0.09150011837482452, 0.09101014584302902, 0.09062189608812332], [0.09086275100708008, 0.09084770083427429, 0.09087160974740982, 0.09091222286224365, 0.09086098521947861, 0.09088490158319473, 0.09094502031803131, 0.09092995524406433, 0.09113932400941849, 0.09094857424497604, 0.09079697728157043], [0.09098560363054276, 0.09101052582263947, 0.09097093343734741, 0.09090373665094376, 0.09098851680755615, 0.0909489244222641, 0.09084954112768173, 0.09087441861629486, 0.09052947908639908, 0.09084366261959076, 0.09109460562467575], [0.09083054959774017, 0.0908050611615181, 0.09084555506706238, 0.09091434627771378, 0.0908275693655014, 0.09086807072162628, 0.09096990525722504, 0.09094439446926117, 0.0912993922829628, 0.09097593277692795, 0.09071920812129974], [0.09090299904346466, 0.09090102463960648, 0.09090416878461838, 0.09090949594974518, 0.09090277552604675, 0.09090591222047806, 0.0909137949347496, 0.09091182798147202, 0.09093926846981049, 0.09091426432132721, 0.09089436382055283], [0.09108449518680573, 0.09114177525043488, 0.09105078876018524, 0.09089649468660355, 0.09109118580818176, 0.09100024402141571, 0.09077214449644089, 0.09082923084497452, 0.09003981202840805, 0.09075867384672165, 0.09133515506982803], [0.09103911370038986, 0.09108152240514755, 0.09101415425539017, 0.09089986234903336, 0.09104406088590622, 0.09097671508789062, 0.0908077135682106, 0.09085001796483994, 0.09026437252759933, 0.09079772979021072, 0.09122465550899506], [0.09166444092988968, 0.0919148176908493, 0.09151732176542282, 0.09084627777338028, 0.09169363230466843, 0.09129708260297775, 0.09030822664499283, 0.09055490046739578, 0.08718904107809067, 0.09025009721517563, 0.09276405721902847], [0.09109519422054291, 0.09115598350763321, 0.09105941653251648, 0.09089568257331848, 0.09110229462385178, 0.09100577980279922, 0.09076373279094696, 0.09082429856061935, 0.08998686820268631, 0.09074943512678146, 0.09136123955249786], [0.09063582867383957, 0.09054762125015259, 0.0906878113746643, 0.09092636406421661, 0.09062553197145462, 0.09076584130525589, 0.09111937135457993, 0.09103068709373474, 0.09226983785629272, 0.09114031493663788, 0.09025084972381592]], [[0.09089534729719162, 0.09090599417686462, 0.09082978963851929, 0.09097408503293991, 0.0908510610461235, 0.09094856679439545, 0.09100604057312012, 0.09101669490337372, 0.09084684401750565, 0.09085747599601746, 0.09086811542510986], [0.09089701622724533, 0.09090637415647507, 0.09083936363458633, 0.09096624702215195, 0.09085806459188461, 0.09094381332397461, 0.09099435061216354, 0.09100371599197388, 0.09085436165332794, 0.09086371213197708, 0.09087307006120682], [0.09088509529829025, 0.09090364724397659, 0.09077084064483643, 0.09102240204811096, 0.09080789983272552, 0.09097789227962494, 0.09107815474271774, 0.09109674394130707, 0.09080055356025696, 0.09081908315420151, 0.09083762019872665], [0.09090761095285416, 0.09090875834226608, 0.09090054035186768, 0.09091608971357346, 0.09090283513069153, 0.09091334044933319, 0.09091953188180923, 0.09092067927122116, 0.09090238064527512, 0.09090352803468704, 0.09090467542409897], [0.09088843315839767, 0.09090441465377808, 0.09078997373580933, 0.09100673347711563, 0.09082191437482834, 0.09096839278936386, 0.0910547599196434, 0.09107077121734619, 0.09081558138132095, 0.09083155542612076, 0.09084752947092056], [0.09090364724397659, 0.09090787172317505, 0.09087762236595154, 0.0909348875284195, 0.09088606387376785, 0.09092476218938828, 0.09094756096601486, 0.09095178544521332, 0.09088438749313354, 0.090888611972332, 0.09089283645153046], [0.09091256558895111, 0.09090986102819443, 0.09092923998832703, 0.09089256078004837, 0.09092383086681366, 0.0908990427851677, 0.09088445454835892, 0.09088174998760223, 0.09092490375041962, 0.09092219918966293, 0.09091949462890625], [0.09091422706842422, 0.09091024100780487, 0.09093881398439407, 0.090884730219841, 0.09093083441257477, 0.09089428931474686, 0.09087277203798294, 0.09086878597736359, 0.09093242138624191, 0.09092842787504196, 0.09092444181442261], [0.09088776260614395, 0.09090425819158554, 0.0907861739397049, 0.09100983291864395, 0.09081912785768509, 0.09097026288509369, 0.09105938673019409, 0.09107591211795807, 0.09081259369850159, 0.09082907438278198, 0.09084555506706238], [0.09088943898677826, 0.09090464562177658, 0.09079574793577194, 0.09100200235843658, 0.0908261388540268, 0.09096551686525345, 0.09104769676923752, 0.09106293320655823, 0.09082011878490448, 0.09083531051874161, 0.09085051715373993], [0.09089108556509018, 0.09090501815080643, 0.0908052995800972, 0.09099414944648743, 0.09083312749862671, 0.09096074104309082, 0.09103598445653915, 0.0910499319434166, 0.09082761406898499, 0.09084153175354004, 0.09085544943809509]], [[0.0909094363451004, 0.09092546254396439, 0.09091293811798096, 0.09090700000524521, 0.09090874344110489, 0.09091818332672119, 0.0909419059753418, 0.09093596786260605, 0.09084271639585495, 0.09092133492231369, 0.09087632596492767], [0.09090695530176163, 0.0908152386546135, 0.09088693559169769, 0.09092094749212265, 0.09091093391180038, 0.09085690230131149, 0.09072128683328629, 0.09075523167848587, 0.0912899449467659, 0.09083887189626694, 0.09109681844711304], [0.09090892970561981, 0.09090142697095871, 0.09090729057788849, 0.09091006964445114, 0.09090925008058548, 0.0909048318862915, 0.09089373797178268, 0.09089651703834534, 0.09094016999006271, 0.09090335667133331, 0.09092442691326141], [0.09090979397296906, 0.09094225615262985, 0.09091687947511673, 0.0909048467874527, 0.09090838581323624, 0.09092750400304794, 0.0909755527973175, 0.09096351265907288, 0.09077472984790802, 0.0909338891506195, 0.09084274619817734], [0.09090953320264816, 0.09093022346496582, 0.0909140482544899, 0.09090638160705566, 0.09090863913297653, 0.0909208208322525, 0.09095145016908646, 0.09094377607107162, 0.09082340449094772, 0.09092488884925842, 0.09086677432060242], [0.09090812504291534, 0.09086534380912781, 0.0908987894654274, 0.09091465175151825, 0.09090998023748398, 0.09088478237390518, 0.09082149714231491, 0.09083734452724457, 0.09108651429414749, 0.09087637066841125, 0.09099661558866501], [0.09090403467416763, 0.09070196002721786, 0.09085988998413086, 0.0909348651766777, 0.09091278910636902, 0.09079371392726898, 0.09049522131681442, 0.09056989848613739, 0.09175044298171997, 0.09075399488210678, 0.09132309257984161], [0.09090512990951538, 0.09074293076992035, 0.0908697098493576, 0.09092987328767776, 0.09091215580701828, 0.09081659466028214, 0.0905769094824791, 0.09063688665628433, 0.09158376604318619, 0.0907847061753273, 0.0912412777543068], [0.0909159928560257, 0.09138218313455582, 0.09101754426956177, 0.09084516018629074, 0.090895876288414, 0.09117007255554199, 0.09186270833015442, 0.09168872237205505, 0.088999904692173, 0.09126180410385132, 0.089960016310215], [0.09090762585401535, 0.09084366261959076, 0.09089366346597672, 0.09091737866401672, 0.0909103974699974, 0.09087271988391876, 0.09077811986207962, 0.09080180525779724, 0.09117449820041656, 0.09086014330387115, 0.09103997051715851], [0.09091345220804214, 0.09115259349346161, 0.09096559882164001, 0.09087706357240677, 0.09090311825275421, 0.0910438671708107, 0.09139847010374069, 0.09130951762199402, 0.08992423862218857, 0.09109090268611908, 0.09042118489742279]], [[0.09050063043832779, 0.09063638001680374, 0.09111683070659637, 0.0911436602473259, 0.09083397686481476, 0.09074319154024124, 0.09122420102357864, 0.09091424196958542, 0.09115985780954361, 0.09085012227296829, 0.09087686985731125], [0.09060024470090866, 0.09070294350385666, 0.09106611460447311, 0.09108638018369675, 0.09085236489772797, 0.09078372269868851, 0.09114721417427063, 0.09091304242610931, 0.09109862148761749, 0.09086456894874573, 0.09088478982448578], [0.09095221757888794, 0.09093785285949707, 0.09088718891143799, 0.09088437259197235, 0.09091697633266449, 0.09092656522989273, 0.09087591618299484, 0.09090851992368698, 0.09088266640901566, 0.09091527760028839, 0.09091246128082275], [0.09097184985876083, 0.09095094352960587, 0.0908772274851799, 0.090873122215271, 0.09092056751251221, 0.09093451499938965, 0.09086081385612488, 0.09090825915336609, 0.09087064862251282, 0.09091809391975403, 0.09091398864984512], [0.09074510633945465, 0.09079967439174652, 0.09099242091178894, 0.0910031646490097, 0.09087902307510376, 0.09084257483482361, 0.09103541076183319, 0.09091122448444366, 0.09100965410470963, 0.09088549762964249, 0.09089623391628265], [0.09067857265472412, 0.09075525403022766, 0.09102626144886017, 0.09104137867689133, 0.09086678922176361, 0.09081555902957916, 0.091086745262146, 0.09091206640005112, 0.09105050563812256, 0.09087589383125305, 0.09089098870754242], [0.09103074669837952, 0.09099020063877106, 0.09084732085466385, 0.09083937108516693, 0.09093131870031357, 0.09095834940671921, 0.09081552177667618, 0.09090744704008102, 0.09083457291126251, 0.09092651307582855, 0.09091855585575104], [0.09080391377210617, 0.09083892405033112, 0.09096252173185349, 0.09096941351890564, 0.0908898115158081, 0.09086644649505615, 0.0909900814294815, 0.09091046452522278, 0.09097357094287872, 0.09089396893978119, 0.09090085327625275], [0.09098369628190994, 0.09095883369445801, 0.09087121486663818, 0.0908663347363472, 0.09092273563146591, 0.09093930572271347, 0.09085170179605484, 0.09090809524059296, 0.09086339175701141, 0.09091978520154953, 0.09091491252183914], [0.09075693786144257, 0.09080757200717926, 0.09098640829324722, 0.09099637717008591, 0.09088119119405746, 0.09084738045930862, 0.09102629125118256, 0.09091107547283173, 0.09100238978862762, 0.09088720381259918, 0.09089716523885727], [0.09077652543783188, 0.09082064777612686, 0.09097643196582794, 0.09098511934280396, 0.09088478237390518, 0.09085533022880554, 0.0910111740231514, 0.09091081470251083, 0.09099035710096359, 0.09089002758264542, 0.09089870005846024]], [[0.09091050177812576, 0.09094149619340897, 0.0908922553062439, 0.09103792160749435, 0.09102878719568253, 0.09086489677429199, 0.09097037464380264, 0.09088675677776337, 0.09045758843421936, 0.09084846824407578, 0.09116090089082718], [0.09090986847877502, 0.09092604368925095, 0.09090033918619156, 0.09097636491060257, 0.09097160398960114, 0.09088605642318726, 0.09094111621379852, 0.09089746326208115, 0.09067313373088837, 0.0908774733543396, 0.09104050695896149], [0.09091085195541382, 0.09095057100057602, 0.09088747203350067, 0.09107416123151779, 0.09106244891881943, 0.09085241705179214, 0.09098757803440094, 0.09088041633367538, 0.09033088386058807, 0.09083136916160583, 0.09123184531927109], [0.09090742468833923, 0.09087756276130676, 0.09092501550912857, 0.09078478813171387, 0.09079356491565704, 0.09095140546560287, 0.09084976464509964, 0.09093032032251358, 0.09134608507156372, 0.09096725285053253, 0.0906667485833168], [0.09090770035982132, 0.09088219702243805, 0.09092272073030472, 0.09080295264720917, 0.09081045538187027, 0.09094525128602982, 0.09085845202207565, 0.09092725813388824, 0.0912821888923645, 0.09095878899097443, 0.0907021164894104], [0.09091132134199142, 0.09096413105726242, 0.09088023751974106, 0.09112849831581116, 0.09111291915178299, 0.0908336415886879, 0.0910133346915245, 0.09087086468935013, 0.09014111012220383, 0.09080566465854645, 0.09133830666542053], [0.0909092128276825, 0.09091159701347351, 0.09090780466794968, 0.09091901034116745, 0.09091830253601074, 0.09090569615364075, 0.0909138098359108, 0.09090737998485565, 0.09087427705526352, 0.09090443700551987, 0.09092845022678375], [0.09091094881296158, 0.0909532979130745, 0.09088601917028427, 0.09108509123325348, 0.09107260406017303, 0.09084863215684891, 0.0909927561879158, 0.09087849408388138, 0.09029266983270645, 0.09082619100809097, 0.09125325083732605], [0.09091180562973022, 0.0911601334810257, 0.09076589345932007, 0.09193654358386993, 0.0918627381324768, 0.09054746478796005, 0.09139203280210495, 0.09072190523147583, 0.08734983205795288, 0.09041652828454971, 0.09293513745069504], [0.09091155976057053, 0.09097222983837128, 0.09087586402893066, 0.09116110950708389, 0.09114320576190948, 0.09082233160734177, 0.09102877229452133, 0.09086508303880692, 0.09002728015184402, 0.09079018980264664, 0.09140226989984512], [0.09090333431959152, 0.09081486612558365, 0.0909554660320282, 0.09054035693407059, 0.09056631475687027, 0.09103372693061829, 0.09073254466056824, 0.0909712091088295, 0.09220954775810242, 0.09108076244592667, 0.09019187837839127]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.030687202682244e-05, "episode_return_min": -14.5, "episode_return_mean": -0.35, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.0006921621457664481, "num_env_steps_sampled_lifetime": 75400, "num_episodes": 20, "episode_duration_sec_mean": 0.005232457461534068, "module_episode_returns_mean": {"default_policy": -0.35}, "episode_len_min": 20, "episode_return_max": 13.5, "env_to_module_connector": {"connector_pipeline_timer": 5.8483391620337324e-05, "timers": {"connectors": {"numpy_to_tensor": 1.1817818615493154e-05, "add_time_dim_to_batch_and_zero_pad": 6.881285238868266e-06, "batch_individual_items": 1.2372255021875844e-05, "add_states_from_episodes_to_batch": 2.754404842840596e-06, "add_observations_from_episodes_to_batch": 2.7664868870871204e-06}}}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_episodes_lifetime": 300, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.5262927614273414e-05, "listify_data_for_vector_env": 1.0370265040075274e-05, "un_batch_to_individual_items": 6.533741847747888e-06, "normalize_and_clip_actions": 7.963345758596704e-06, "remove_single_ts_time_rank_from_batch": 1.1860807552105661e-05, "tensor_to_numpy": 1.4837635030262232e-05}}, "connector_pipeline_timer": 0.00011261090436185084}, "num_env_steps_sampled": 400, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "num_agent_steps_sampled": {"default_agent": 400}, "env_step_timer": 1.3888664019519528e-05, "agent_episode_returns_mean": {"default_agent": -0.35}, "sample": 0.12951058181285582, "weights_seq_no": 15.0, "time_between_sampling": 9.292946243316388}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "b509c_00000", "date": "2025-08-11_18-31-40", "timestamp": 1754929900, "time_this_iter_s": 9.032490968704224, "time_total_s": 139.05827975273132, "pid": 11229, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x383ebd8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 139.05827975273132, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 33.88333333333334, "ram_util_percent": 77.76666666666665}}
{"timers": {"training_iteration": 9.759374716118211, "restore_env_runners": 1.0028047611358256e-05, "training_step": 9.759163602550064, "env_runner_sampling_timer": 1.6507503821538592, "learner_update_timer": 7.928944680098585, "synch_weights": 0.0016169013924888188, "restore_eval_env_runners": 5.906871581249959e-05, "evaluation_iteration": 0.14195182841694673, "synch_eval_env_connectors": 0.0003941110393400339, "synch_env_connectors": 5.449082359565922e-06}, "env_runners": {"num_episodes_lifetime": -431750.0, "rlmodule_inference_timer": 3.104800967278489e-05, "episode_duration_sec_mean": 0.0052198973759077505, "module_episode_returns_mean": {"default_policy": 0.9399999999999996}, "episode_return_min": -10.5, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2379339110812786e-05, "add_states_from_episodes_to_batch": 2.6708210141241802e-06, "numpy_to_tensor": 1.2273512076091682e-05, "add_observations_from_episodes_to_batch": 2.7934492110701328e-06, "add_time_dim_to_batch_and_zero_pad": 6.94503821560838e-06}}, "connector_pipeline_timer": 5.94945919805721e-05}, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.036545709384831e-05, "un_batch_to_individual_items": 6.621095014000029e-06, "tensor_to_numpy": 1.5115310506053148e-05, "normalize_and_clip_actions": 7.89655167075898e-06, "remove_single_ts_time_rank_from_batch": 1.1854131174262103e-05, "get_actions": 3.805007277698647e-05}}, "connector_pipeline_timer": 0.00011662584221264666}, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "env_step_timer": 1.3732814192950392e-05, "time_between_sampling": 0.030673080766059662, "episode_return_mean": 0.9399999999999996, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_max": 9.5, "sample": 0.005599367945727105, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "env_reset_timer": 3.50128661369149e-05, "num_env_steps_sampled_lifetime": -8635000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "agent_episode_returns_mean": {"default_agent": 0.9399999999999996}, "weights_seq_no": 15.0, "episode_len_mean": 20.0, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3290.342651185771}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13487864650099687, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008907366631837976, "add_observations_from_episodes_to_batch": 0.000902467210911084, "add_columns_from_episodes_to_train_batch": 0.04162637854321493, "add_time_dim_to_batch_and_zero_pad": 0.07560626888891436, "add_states_from_episodes_to_batch": 0.0034772550868832288, "batch_individual_items": 0.00406790614133059, "numpy_to_tensor": 7.097955199070801e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "weights_seq_no": 16.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 95760, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.6889684010584, "num_module_steps_trained": 5985, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime_throughput": 777.7269253773893}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_env_steps_trained_lifetime": 3168000, "num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_module_steps_trained_lifetime": 1149120, "num_env_steps_trained_lifetime_throughput": 48377.10200203587}, "default_policy": {"use_intrinsic_rewards": 1.0, "policy_loss": 0.0001405900839017704, "weights_seq_no": 96.0, "vf_explained_var": 0.001314401626586914, "module_train_batch_size_mean": 997.4990256591639, "total_loss": 0.2783718407154083, "num_module_steps_trained_lifetime": 574560, "diff_num_grad_updates_vs_sampler_policy": 81.0, "vf_loss_unclipped": 43.57066345214844, "mean_kl_loss": 1.4793261470913421e-05, "entropy": 0.67995685338974, "num_module_steps_trained": 35910, "vf_loss": 0.35848501324653625}, "intrinsic_reward_module": {"total_loss": 0.0, "weights_seq_no": 96.0, "num_module_steps_trained_lifetime": 574560, "diff_num_grad_updates_vs_sampler_policy": 81.0, "module_train_batch_size_mean": 997.4990256591639, "num_module_steps_trained": 35910}}}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 33000, "num_module_steps_trained_lifetime": 191520, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 528000, "num_env_steps_trained_lifetime_throughput": 4289.379943854277, "num_module_steps_trained_throughput": 21719899.231601063, "num_module_steps_trained_lifetime_throughput": 12482094.873764098}, "default_policy": {"weights_seq_no": 16.0, "vf_explained_var": -0.0013580322265625, "module_train_batch_size_mean": 997.6889684010584, "total_loss": 0.27822035551071167, "num_module_steps_trained_lifetime": 95760, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 43.60483932495117, "mean_kl_loss": 1.3391374523052946e-05, "curr_kl_coeff": 2.4655751076352317e-06, "entropy": 0.6799995303153992, "num_module_steps_trained": 5985, "vf_loss": 0.3583066463470459, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "use_intrinsic_rewards": 0.0, "policy_loss": 0.00013054083683528006, "num_module_steps_trained_lifetime_throughput": 777.719110725388}, "IntrinsicAttentionMask": [[[0.09047017246484756, 0.09060588479042053, 0.09074995666742325, 0.09111298620700836, 0.09113982319831848, 0.0910487249493599, 0.09119350463151932, 0.09122035652399063, 0.09079281240701675, 0.09081954509019852, 0.09084629267454147], [0.09057720750570297, 0.09067987650632858, 0.0907888412475586, 0.09106321632862091, 0.09108348935842514, 0.09101466834545135, 0.0911240354180336, 0.09114431589841843, 0.09082125127315521, 0.09084145724773407, 0.09086167812347412], [0.09069076180458069, 0.09075834602117538, 0.09083004295825958, 0.0910104513168335, 0.0910237655043602, 0.09097854048013687, 0.0910504162311554, 0.0910637378692627, 0.09085135906934738, 0.09086465835571289, 0.0908779501914978], [0.0909765362739563, 0.09095562994480133, 0.09093346446752548, 0.09087780863046646, 0.09087370336055756, 0.0908876433968544, 0.09086550027132034, 0.09086139500141144, 0.0909268781542778, 0.0909227728843689, 0.09091867506504059], [0.09099764376878738, 0.09097018837928772, 0.09094109386205673, 0.0908680260181427, 0.09086264669895172, 0.09088093787431717, 0.09085187315940857, 0.090846486389637, 0.0909324511885643, 0.09092706441879272, 0.09092167019844055], [0.09092598408460617, 0.09092074632644653, 0.09091519564390182, 0.09090125560760498, 0.0909002274274826, 0.09090372174978256, 0.09089817106723785, 0.09089714288711548, 0.0909135490655899, 0.09091252088546753, 0.09091149270534515], [0.09103984385728836, 0.0909992903470993, 0.09095632284879684, 0.09084844589233398, 0.09084049612283707, 0.09086750447750092, 0.09082460403442383, 0.09081665426492691, 0.09094356000423431, 0.0909356027841568, 0.09092764556407928], [0.09106095135211945, 0.0910138413310051, 0.0909639447927475, 0.09083865582942963, 0.09082943201065063, 0.09086078405380249, 0.09081096202135086, 0.09080173820257187, 0.09094911813735962, 0.09093987196683884, 0.09093062579631805], [0.09072452038526535, 0.09078166633844376, 0.09084227681159973, 0.09099476784467697, 0.09100602567195892, 0.0909678041934967, 0.09102854132652283, 0.09103979915380478, 0.09086029976606369, 0.09087153524160385, 0.09088277816772461], [0.09074557572603226, 0.09079620242118835, 0.09084990620613098, 0.09098498523235321, 0.0909949541091919, 0.09096109867095947, 0.09101489931344986, 0.09102486819028854, 0.09086586534976959, 0.09087582677602768, 0.09088578820228577], [0.09076663851737976, 0.09081075340509415, 0.09085754305124283, 0.09097520262002945, 0.09098388999700546, 0.09095439314842224, 0.09100125730037689, 0.0910099446773529, 0.09087144583463669, 0.09088011831045151, 0.09088879823684692]], [[0.09079114347696304, 0.09102050960063934, 0.0909428671002388, 0.09099172800779343, 0.09079683572053909, 0.09071939438581467, 0.09070504456758499, 0.09075377136468887, 0.09134067595005035, 0.09069354832172394, 0.09124447405338287], [0.09095911681652069, 0.09086164087057114, 0.09089459478855133, 0.0908738449215889, 0.09095669537782669, 0.09098968654870987, 0.09099580347537994, 0.09097503125667572, 0.09072614461183548, 0.09100070595741272, 0.0907667800784111], [0.09090238809585571, 0.09091544896364212, 0.09091103076934814, 0.0909138098359108, 0.09090271592140198, 0.090898297727108, 0.09089747816324234, 0.09090025722980499, 0.09093362838029861, 0.09089682251214981, 0.09092816710472107], [0.09093809127807617, 0.0908815786242485, 0.09090068936347961, 0.09088865667581558, 0.09093669056892395, 0.09095580875873566, 0.09095935523509979, 0.09094731509685516, 0.09080298990011215, 0.09096219390630722, 0.09082657098770142], [0.09079533070325851, 0.09101657569408417, 0.09094168990850449, 0.09098881483078003, 0.09080081433057785, 0.09072611480951309, 0.09071227163076401, 0.09075927734375, 0.09132537245750427, 0.09070117771625519, 0.09123259037733078], [0.09073837101459503, 0.09107014536857605, 0.09095780551433563, 0.09102849662303925, 0.09074660390615463, 0.09063465893268585, 0.09061393141746521, 0.09068435430526733, 0.09153389930725098, 0.09059731662273407, 0.09139448404312134], [0.09072781354188919, 0.09108006954193115, 0.0909607857465744, 0.09103584289550781, 0.09073654562234879, 0.09061770886182785, 0.09059570729732513, 0.09067046642303467, 0.0915725827217102, 0.09057807177305222, 0.09142449498176575], [0.09076367318630219, 0.09104636311531067, 0.09095066040754318, 0.09101088345050812, 0.09077068418264389, 0.09067527204751968, 0.09065760672092438, 0.09071763604879379, 0.09144125133752823, 0.09064343571662903, 0.09132256358861923], [0.09119173139333725, 0.09063933044672012, 0.09082578122615814, 0.09070838987827301, 0.09117797017097473, 0.0913655161857605, 0.09140031784772873, 0.0912821888923645, 0.08987612277269363, 0.0914282277226448, 0.09010448306798935], [0.0907193198800087, 0.09108800441026688, 0.09096314758062363, 0.09104170650243759, 0.09072846919298172, 0.09060410410165787, 0.09058107435703278, 0.09065931290388107, 0.091603584587574, 0.0905626192688942, 0.09144855290651321], [0.09112205356359482, 0.09070618450641632, 0.09084662050008774, 0.09075820446014404, 0.0911116972565651, 0.09125276654958725, 0.09127893298864365, 0.09119009971618652, 0.09013056755065918, 0.09129991382360458, 0.09030292928218842]], [[0.09047023952007294, 0.09094162285327911, 0.09075002372264862, 0.09077674895524979, 0.09080347418785095, 0.09104879200458527, 0.09085696190595627, 0.091220423579216, 0.09112925082445145, 0.09081961214542389, 0.09118292480707169], [0.09084164351224899, 0.09091410785913467, 0.09088469296693802, 0.09088879823684692, 0.09089290350675583, 0.09093053638935089, 0.09090111404657364, 0.09095681458711624, 0.0909428596496582, 0.09089537709951401, 0.09095107764005661], [0.09069077670574188, 0.09092532098293304, 0.09083005785942078, 0.09084334969520569, 0.0908566415309906, 0.09097855538129807, 0.09088324010372162, 0.09106375277042389, 0.09101850539445877, 0.09086467325687408, 0.09104514867067337], [0.0907118171453476, 0.0909237489104271, 0.09083767980337143, 0.09084969013929367, 0.09086170792579651, 0.09097184985876083, 0.09088572859764099, 0.09104881435632706, 0.09100794047117233, 0.09086895734071732, 0.0910320058465004], [0.0907328724861145, 0.09092219173908234, 0.09084530919790268, 0.09085603058338165, 0.09086676687002182, 0.0909651443362236, 0.09088822454214096, 0.09103388339281082, 0.0909973755478859, 0.09087324142456055, 0.09101887792348862], [0.09092598408460617, 0.09090783447027206, 0.09091519564390182, 0.09091416746377945, 0.09091313928365707, 0.09090372174978256, 0.09091108292341232, 0.09089714288711548, 0.09090062975883484, 0.09091252088546753, 0.09089857339859009], [0.0907750055193901, 0.09091906994581223, 0.09086057543754578, 0.09086874127388, 0.09087689965963364, 0.09095174819231033, 0.0908932313323021, 0.09100403636693954, 0.09097626805305481, 0.0908818244934082, 0.09099261462688446], [0.09106097370386124, 0.09089776128530502, 0.09096396714448929, 0.09095471352338791, 0.09094547480344772, 0.09086080640554428, 0.09092698991298676, 0.09080176055431366, 0.09083311259746552, 0.09093989431858063, 0.09081464260816574], [0.09098926931619644, 0.09090310335159302, 0.09093806892633438, 0.0909331887960434, 0.09092830866575241, 0.09088359028100967, 0.09091854095458984, 0.09085239470005035, 0.09086895734071732, 0.09092535823583603, 0.09085919708013535], [0.09074558317661285, 0.09092124551534653, 0.09084991365671158, 0.09085986763238907, 0.09086982905864716, 0.09096110612154007, 0.09088973701000214, 0.09102487564086914, 0.09099101275205612, 0.09087583422660828, 0.09101095050573349], [0.09103148430585861, 0.09089995175600052, 0.09095331281423569, 0.09094586223363876, 0.09093841165304184, 0.09087017178535461, 0.09092351794242859, 0.09082257002592087, 0.09084784239530563, 0.0909339189529419, 0.09083296358585358]], [[0.09090014547109604, 0.0910458192229271, 0.09088189899921417, 0.09091288596391678, 0.09090375900268555, 0.09085454046726227, 0.09084542840719223, 0.09099102020263672, 0.09056136757135391, 0.09095268696546555, 0.09115051478147507], [0.09091994166374207, 0.09073882550001144, 0.09094267338514328, 0.09090407937765121, 0.09091544151306152, 0.0909767746925354, 0.0909881442785263, 0.09080688655376434, 0.09134367853403091, 0.09085454046726227, 0.09060905873775482], [0.0908975824713707, 0.09108428657054901, 0.09087420254945755, 0.09091389924287796, 0.09090220928192139, 0.09083914756774902, 0.09082747250795364, 0.09101403504610062, 0.09046369791030884, 0.0909649133682251, 0.09121852368116379], [0.0909019187092781, 0.09101895242929459, 0.09088725596666336, 0.09091215580701828, 0.09090482443571091, 0.09086527675390244, 0.09085795283317566, 0.09097492694854736, 0.09062959998846054, 0.09094413369894028, 0.09110303968191147], [0.09090064465999603, 0.09103818982839584, 0.09088341891765594, 0.09091267734766006, 0.09090405702590942, 0.09085758775472641, 0.09084897488355637, 0.09098644554615021, 0.09058072417974472, 0.09095025062561035, 0.09113702923059464], [0.0908937156200409, 0.09114200621843338, 0.09086263924837112, 0.09091541916131973, 0.09089987725019455, 0.09081605076789856, 0.09080053120851517, 0.09104856848716736, 0.09031737595796585, 0.09098323434591293, 0.09132061898708344], [0.09089241921901703, 0.09116125106811523, 0.09085877984762192, 0.09091591089963913, 0.09089908748865128, 0.09080834686756134, 0.09079153835773468, 0.09106007218360901, 0.09026864916086197, 0.09098934382200241, 0.09135466814041138], [0.09091262519359589, 0.09085426479578018, 0.09091994166374207, 0.0909075140953064, 0.09091117233037949, 0.09093091636896133, 0.09093458205461502, 0.09087620675563812, 0.09104884415864944, 0.09089156240224838, 0.09081240743398666], [0.09084979444742203, 0.09176146984100342, 0.09073616564273834, 0.09092921763658524, 0.09087233245372772, 0.090565986931324, 0.090509332716465, 0.0914175882935524, 0.08875901997089386, 0.09117773920297623, 0.09242138266563416], [0.09090741723775864, 0.09093504399061203, 0.09090395271778107, 0.09090983122587204, 0.09090810269117355, 0.09089875966310501, 0.09089703112840652, 0.09092465043067932, 0.09084302186965942, 0.09091738611459732, 0.09095487743616104], [0.09093347191810608, 0.09051846712827682, 0.09098562598228455, 0.0908970758318901, 0.09092314541339874, 0.09106391668319702, 0.09109002351760864, 0.09067429602146149, 0.09190859645605087, 0.09078349173069, 0.09022178500890732]], [[0.09050067514181137, 0.09097221493721008, 0.09078054875135422, 0.09114370495080948, 0.0911705493927002, 0.09074323624372482, 0.09122424572706223, 0.090914286673069, 0.09082341939210892, 0.09085016697645187, 0.09087691456079483], [0.09084632992744446, 0.09091879427433014, 0.09088937938213348, 0.09094506502151489, 0.0909491777420044, 0.09088364243507385, 0.0909573957324028, 0.09090990573167801, 0.09089595824480057, 0.09090007096529007, 0.09090417623519897], [0.09070593118667603, 0.09094051271677017, 0.09084524214267731, 0.09102567285299301, 0.09103900194168091, 0.09082667529582977, 0.09106564521789551, 0.09091173112392426, 0.0908665582537651, 0.09087985008955002, 0.09089315682649612], [0.09097185730934143, 0.09089938551187515, 0.09092878550291061, 0.09087312966585159, 0.09086902439594269, 0.09093452244997025, 0.09086082130670547, 0.09090826660394669, 0.09092220664024353, 0.09091810137033463, 0.09091399610042572], [0.09099148213863373, 0.09089633077383041, 0.09093493968248367, 0.09086187928915024, 0.09085649251937866, 0.09094246476888657, 0.09084571897983551, 0.0909079909324646, 0.09092628955841064, 0.09092090278863907, 0.09091551601886749], [0.09067858010530472, 0.09094475209712982, 0.09083662927150726, 0.09104139357805252, 0.09105651080608368, 0.09081557393074036, 0.09108676016330719, 0.09091208130121231, 0.09086082130670547, 0.09087590873241425, 0.09089100360870361], [0.09103075414896011, 0.09089024364948273, 0.09094724804162979, 0.09083937853574753, 0.09083142876625061, 0.0909583568572998, 0.09081552922725677, 0.09090745449066162, 0.09093448519706726, 0.09092652052640915, 0.09091856330633163], [0.09080392122268677, 0.09092536568641663, 0.09087605774402618, 0.09096942096948624, 0.0909763053059578, 0.09086645394563675, 0.0909900888800621, 0.09091047197580338, 0.09088709205389023, 0.09089397639036179, 0.09090086072683334], [0.09073734283447266, 0.09093565493822098, 0.09085512161254883, 0.09100763499736786, 0.09101888537406921, 0.0908394306898117, 0.09104140847921371, 0.09091132879257202, 0.09087314456701279, 0.09088438749313354, 0.0908956229686737], [0.09075694531202316, 0.09093263000249863, 0.09086129069328308, 0.0909963846206665, 0.09100635349750519, 0.09084738790988922, 0.09102629870176315, 0.09091108292341232, 0.09087724983692169, 0.09088721126317978, 0.09089717268943787], [0.09077654033899307, 0.09092960506677628, 0.09086745977401733, 0.09098513424396515, 0.09099382162094116, 0.09085534512996674, 0.09101118892431259, 0.09091082960367203, 0.0908813625574112, 0.09089004248380661, 0.09089871495962143]], [[0.09090008586645126, 0.09104575961828232, 0.09099646657705307, 0.090912826359272, 0.09090369939804077, 0.09085448086261749, 0.09095994383096695, 0.09099096059799194, 0.09044722467660904, 0.09083805978298187, 0.09115045517683029], [0.0909198671579361, 0.09073874354362488, 0.0907999575138092, 0.09090399742126465, 0.09091535210609436, 0.09097669273614883, 0.09084536135196686, 0.09080680459737778, 0.09148707985877991, 0.09099717438220978, 0.09060897678136826], [0.09091335535049438, 0.09084264934062958, 0.0908665582537651, 0.09090717136859894, 0.09091160446405411, 0.09093552827835083, 0.09088428318500519, 0.0908692255616188, 0.09113425761461258, 0.09094351530075073, 0.09079193323850632], [0.09090188145637512, 0.0910189151763916, 0.09097932279109955, 0.0909121185541153, 0.09090478718280792, 0.09086523950099945, 0.09094997495412827, 0.09097488969564438, 0.09053782373666763, 0.0908520370721817, 0.09110300242900848], [0.09090059995651245, 0.09103814512491226, 0.09099160134792328, 0.09091263264417648, 0.09090401232242584, 0.09085754305124283, 0.09095712006092072, 0.09098640084266663, 0.09047294408082962, 0.09084203094244003, 0.09113698452711105], [0.09089356660842896, 0.09114185720682144, 0.09105781465768814, 0.0909152701497078, 0.09089972823858261, 0.09081590175628662, 0.09099556505680084, 0.09104841947555542, 0.0901235044002533, 0.09078793227672577, 0.0913204699754715], [0.09090840816497803, 0.0909196063876152, 0.09091582149267197, 0.09090938419103622, 0.09090868383646011, 0.09090489149093628, 0.09091300517320633, 0.09091538935899734, 0.09087347239255905, 0.0909036323428154, 0.09092764556407928], [0.09091261029243469, 0.09085425734519958, 0.09087398648262024, 0.0909074991941452, 0.09091116487979889, 0.09093090146780014, 0.090888611972332, 0.09087619185447693, 0.09109485894441605, 0.09093749523162842, 0.09081239998340607], [0.0908282995223999, 0.09199974685907364, 0.09160187840461731, 0.09093021601438522, 0.09085721522569656, 0.09046429395675659, 0.09130807965993881, 0.09155748784542084, 0.08726959675550461, 0.0903334766626358, 0.09284976869821548], [0.09089116752147675, 0.09117646515369415, 0.09107987582683563, 0.09091610461473465, 0.09089825302362442, 0.09080195426940918, 0.09100835025310516, 0.09106907993555069, 0.09000708907842636, 0.09076982736587524, 0.09138176590204239], [0.09093307703733444, 0.090518057346344, 0.09065821021795273, 0.09089668095111847, 0.09092273563146591, 0.09106350690126419, 0.09076222777366638, 0.09067389369010925, 0.09223971515893936, 0.09111055731773376, 0.09022139012813568]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.0763741291331755e-05, "episode_return_min": -14.5, "episode_return_mean": -0.15, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.0006861367744393923, "num_env_steps_sampled_lifetime": 80400, "num_episodes": 20, "episode_duration_sec_mean": 0.00522460579755716, "module_episode_returns_mean": {"default_policy": -0.15}, "episode_len_min": 20, "episode_return_max": 13.5, "env_to_module_connector": {"connector_pipeline_timer": 5.8805405078501257e-05, "timers": {"connectors": {"numpy_to_tensor": 1.204420994770883e-05, "add_time_dim_to_batch_and_zero_pad": 6.933620674369375e-06, "batch_individual_items": 1.2453072980073567e-05, "add_states_from_episodes_to_batch": 2.7409635306499124e-06, "add_observations_from_episodes_to_batch": 2.774457921095719e-06}}}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_episodes_lifetime": 320, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.562697677195716e-05, "listify_data_for_vector_env": 1.0365106449188199e-05, "un_batch_to_individual_items": 6.5646502897271545e-06, "normalize_and_clip_actions": 7.958152771352354e-06, "remove_single_ts_time_rank_from_batch": 1.188393865130776e-05, "tensor_to_numpy": 1.4979701026967773e-05}}, "connector_pipeline_timer": 0.00011315377688579447}, "num_env_steps_sampled": 400, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "num_agent_steps_sampled": {"default_agent": 400}, "env_step_timer": 1.3881703017293568e-05, "agent_episode_returns_mean": {"default_agent": -0.15}, "sample": 0.12934682099461245, "weights_seq_no": 16.0, "time_between_sampling": 9.292338479212404}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "b509c_00000", "date": "2025-08-11_18-31-49", "timestamp": 1754929909, "time_this_iter_s": 9.32931399345398, "time_total_s": 148.3875937461853, "pid": 11229, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x383ebd8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 148.3875937461853, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 37.378571428571426, "ram_util_percent": 77.84285714285716}}
{"timers": {"training_iteration": 9.752396273956547, "restore_env_runners": 9.984436949756806e-06, "training_step": 9.752185481944682, "env_runner_sampling_timer": 1.6493005291717648, "learner_update_timer": 7.923364062878172, "synch_weights": 0.0016105007090560098, "restore_eval_env_runners": 5.854719798199128e-05, "evaluation_iteration": 0.1417219780424162, "synch_eval_env_connectors": 0.00039155242841421505, "synch_env_connectors": 5.433751321926407e-06}, "env_runners": {"num_episodes_lifetime": -462625.0, "rlmodule_inference_timer": 3.087868486216104e-05, "episode_duration_sec_mean": 0.0051873233169317245, "module_episode_returns_mean": {"default_policy": 1.5800000000000005}, "episode_return_min": -10.5, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2277212977637484e-05, "add_states_from_episodes_to_batch": 2.637667300980105e-06, "numpy_to_tensor": 1.2285571243906195e-05, "add_observations_from_episodes_to_batch": 2.787516861050836e-06, "add_time_dim_to_batch_and_zero_pad": 6.956858386126639e-06}}, "connector_pipeline_timer": 5.929967898645293e-05}, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0310370661029216e-05, "un_batch_to_individual_items": 6.5545853766527035e-06, "tensor_to_numpy": 1.4988897450911496e-05, "normalize_and_clip_actions": 7.902827625417724e-06, "remove_single_ts_time_rank_from_batch": 1.1838661779724273e-05, "get_actions": 3.773018854993984e-05}}, "connector_pipeline_timer": 0.0001159452314741822}, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "env_step_timer": 1.3659332618676289e-05, "time_between_sampling": 0.03173291419535796, "episode_return_mean": 1.5800000000000005, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_max": 9.5, "sample": 0.00554130471117025, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "env_reset_timer": 3.481668928833324e-05, "num_env_steps_sampled_lifetime": -9252500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "agent_episode_returns_mean": {"default_agent": 1.5800000000000005}, "weights_seq_no": 16.0, "episode_len_mean": 20.0, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3309.6045420989512}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1348743921259933, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008904743794923071, "add_observations_from_episodes_to_batch": 0.0009017775394045016, "add_columns_from_episodes_to_train_batch": 0.04162804058731627, "add_time_dim_to_batch_and_zero_pad": 0.07560305995004363, "add_states_from_episodes_to_batch": 0.003479778786244098, "batch_individual_items": 0.004067517499628084, "numpy_to_tensor": 7.075767636764198e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "weights_seq_no": 17.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 101745, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.6777629636601, "num_module_steps_trained": 5985, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime_throughput": 776.2243272671482}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_env_steps_trained_lifetime": 3366000, "num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_module_steps_trained_lifetime": 1220940, "num_env_steps_trained_lifetime_throughput": 47679.103111355675}, "default_policy": {"use_intrinsic_rewards": 1.0, "policy_loss": -0.00035099536762572825, "weights_seq_no": 102.0, "vf_explained_var": 0.0011612772941589355, "module_train_batch_size_mean": 997.498558675304, "total_loss": 0.2778792679309845, "num_module_steps_trained_lifetime": 610470, "diff_num_grad_updates_vs_sampler_policy": 86.0, "vf_loss_unclipped": 43.54016876220703, "mean_kl_loss": 0.00010368786752223969, "entropy": 0.6774358153343201, "num_module_steps_trained": 35910, "vf_loss": 0.35846033692359924}, "intrinsic_reward_module": {"total_loss": 0.0, "weights_seq_no": 102.0, "num_module_steps_trained_lifetime": 610470, "diff_num_grad_updates_vs_sampler_policy": 86.0, "module_train_batch_size_mean": 997.498558675304, "num_module_steps_trained": 35910}}}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 33000, "num_module_steps_trained_lifetime": 203490, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 561000, "num_env_steps_trained_lifetime_throughput": 4281.050916142149, "num_module_steps_trained_throughput": 21228237.64302872, "num_module_steps_trained_lifetime_throughput": 12473782.15873896}, "default_policy": {"weights_seq_no": 17.0, "vf_explained_var": -0.003233790397644043, "module_train_batch_size_mean": 997.6777629636601, "total_loss": 0.2777426540851593, "num_module_steps_trained_lifetime": 101745, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 43.3853874206543, "mean_kl_loss": 0.00010637872765073553, "curr_kl_coeff": 1.2327875538176158e-06, "entropy": 0.6774033904075623, "num_module_steps_trained": 5985, "vf_loss": 0.3583066165447235, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "use_intrinsic_rewards": 0.0, "policy_loss": -0.0003511596587486565, "num_module_steps_trained_lifetime_throughput": 776.2170205566803}, "IntrinsicAttentionMask": [[[0.09047017246484756, 0.09060587733983994, 0.09108616411685944, 0.09111298620700836, 0.09080340713262558, 0.09071264415979385, 0.09119349718093872, 0.09088364243507385, 0.09112917631864548, 0.09081954509019852, 0.09118285775184631], [0.09057720750570297, 0.09067987650632858, 0.09104295819997787, 0.09106321632862091, 0.0908292606472969, 0.09076063334941864, 0.0911240354180336, 0.09088992327451706, 0.09107545018196106, 0.09084145724773407, 0.09111599624156952], [0.09095543622970581, 0.09094107151031494, 0.09089040756225586, 0.09088759124279022, 0.09092019498348236, 0.0909297838807106, 0.09087912738323212, 0.09091173112392426, 0.09088588505983353, 0.09091849625110626, 0.09088024497032166], [0.0909765362739563, 0.09095562994480133, 0.09088191390037537, 0.09087780863046646, 0.09092525392770767, 0.09093920141458511, 0.09086550027132034, 0.09091293811798096, 0.09087532758712769, 0.0909227728843689, 0.09086712449789047], [0.0907328650355339, 0.09078743308782578, 0.0909801498055458, 0.09099088609218597, 0.09086676687002182, 0.09083032608032227, 0.09102313220500946, 0.09089896082878113, 0.0909973755478859, 0.09087324142456055, 0.09101887047290802], [0.09066136926412582, 0.09073804318904877, 0.0910089984536171, 0.09102410823106766, 0.09084955602884293, 0.09079833328723907, 0.09106946736574173, 0.09089481830596924, 0.09103323519229889, 0.09085866063833237, 0.0910634770989418], [0.09103984385728836, 0.0909992903470993, 0.0908563956618309, 0.09084844589233398, 0.09094040840864182, 0.09096743911504745, 0.09082460403442383, 0.09091653674840927, 0.09084364771842957, 0.0909356027841568, 0.09082774817943573], [0.09079606086015701, 0.09083107113838196, 0.09095466136932373, 0.09096154570579529, 0.09088195115327835, 0.0908585861325264, 0.09098221361637115, 0.09090260416269302, 0.09096570312976837, 0.09088610857725143, 0.09097947925329208], [0.09098926931619644, 0.0909644067287445, 0.09087678045034409, 0.0908719003200531, 0.09092830866575241, 0.09094487875699997, 0.09085726737976074, 0.09091366082429886, 0.09086895734071732, 0.09092535823583603, 0.09085919708013535], [0.09074558317661285, 0.09079620987176895, 0.09097502380609512, 0.09098498523235321, 0.09086982160806656, 0.09083601087331772, 0.09101489931344986, 0.09089969843626022, 0.09099100530147552, 0.09087583422660828, 0.0910109430551529], [0.09103147685527802, 0.09099352359771729, 0.09085977077484131, 0.09085232764482498, 0.09093840420246124, 0.09096371382474899, 0.0908300057053566, 0.09091605991125107, 0.09084783494472504, 0.0909339115023613, 0.09083295613527298]], [[0.09081990271806717, 0.0908840075135231, 0.0909217819571495, 0.0908101350069046, 0.09090501070022583, 0.09085487574338913, 0.09094979614019394, 0.09092601388692856, 0.09125684201717377, 0.09095541387796402, 0.09071611613035202], [0.09096971154212952, 0.09092604368925095, 0.09090033918619156, 0.09097636491060257, 0.09091175347566605, 0.09094587713479996, 0.09088128805160522, 0.09089746326208115, 0.09067313373088837, 0.0908774733543396, 0.09104050695896149], [0.09105781465768814, 0.09095057100057602, 0.09088747203350067, 0.09107416123151779, 0.0909154862165451, 0.09099928289651871, 0.09084073454141617, 0.09088041633367538, 0.09033088386058807, 0.09083136916160583, 0.09123184531927109], [0.0907970517873764, 0.09087757021188736, 0.09092501550912857, 0.09078478813171387, 0.09090393781661987, 0.09084097295999527, 0.09096020460128784, 0.09093032032251358, 0.09134608507156372, 0.09096726030111313, 0.0906667485833168], [0.09101870656013489, 0.0909397080540657, 0.0908932164311409, 0.09103075414896011, 0.09091386198997498, 0.09097559005022049, 0.09085877239704132, 0.09088801592588425, 0.09048274159431458, 0.09085186570882797, 0.09114685654640198], [0.090901680290699, 0.0909070149064064, 0.09091015160083771, 0.09090086817741394, 0.09090875834226608, 0.0909045934677124, 0.09091247618198395, 0.09091050922870636, 0.09093794971704483, 0.09091294556856155, 0.09089304506778717], [0.09112304449081421, 0.09096863120794296, 0.09087781608104706, 0.09114660322666168, 0.09091813117265701, 0.09103875607252121, 0.09081055968999863, 0.09086766839027405, 0.09007792174816132, 0.09079708904027939, 0.09137380868196487], [0.09106764942407608, 0.0909532979130745, 0.09088601917028427, 0.09108509123325348, 0.09091588109731674, 0.09100523591041565, 0.09083618223667145, 0.09087849408388138, 0.09029266983270645, 0.09082619100809097, 0.09125325083732605], [0.0918334499001503, 0.09116008877754211, 0.09076584875583649, 0.09193649888038635, 0.09094071388244629, 0.09146541357040405, 0.09047473222017288, 0.09072186052799225, 0.0873497948050499, 0.09041649103164673, 0.09293509274721146], [0.09113610535860062, 0.09097222983837128, 0.09087586402893066, 0.09116110950708389, 0.0909186452627182, 0.09104665368795395, 0.09080449491739273, 0.09086508303880692, 0.09002728015184402, 0.09079018980264664, 0.09140226989984512], [0.09057659655809402, 0.09081485867500305, 0.0909554660320282, 0.09054034948348999, 0.09089299291372299, 0.09070652723312378, 0.09105982631444931, 0.0909712016582489, 0.09220954030752182, 0.09108075499534607, 0.09019187092781067]], [[0.09047015756368637, 0.09060586988925934, 0.09108614921569824, 0.09111297130584717, 0.09113980829715729, 0.09071263670921326, 0.09119348973035812, 0.09122034162282944, 0.09079279750585556, 0.09081953018903732, 0.09084627777338028], [0.09057719260454178, 0.09067986160516739, 0.09104294329881668, 0.09106320142745972, 0.09108347445726395, 0.09076061844825745, 0.0911240205168724, 0.09114430099725723, 0.09082123637199402, 0.09084144234657288, 0.09086166322231293], [0.09095544368028641, 0.09094107896089554, 0.09089041501283646, 0.09088759869337082, 0.09088477492332458, 0.0909297913312912, 0.09087913483381271, 0.09087631106376648, 0.0909213200211525, 0.09091850370168686, 0.09091567993164062], [0.0909765362739563, 0.09095562994480133, 0.09088191390037537, 0.09087780863046646, 0.09087370336055756, 0.09093920141458511, 0.09086550027132034, 0.09086139500141144, 0.0909268781542778, 0.0909227728843689, 0.09091867506504059], [0.09099764376878738, 0.09097018837928772, 0.09087341278791428, 0.0908680260181427, 0.09086264669895172, 0.09094862639904022, 0.09085187315940857, 0.090846486389637, 0.0909324511885643, 0.09092706441879272, 0.09092167019844055], [0.09066135436296463, 0.09073802828788757, 0.0910089835524559, 0.09102410078048706, 0.09103921055793762, 0.09079831838607788, 0.09106945246458054, 0.09108457714319229, 0.0908435583114624, 0.09085864573717117, 0.09087373316287994], [0.09103984385728836, 0.0909992903470993, 0.0908563956618309, 0.09084844589233398, 0.09084049612283707, 0.09096743911504745, 0.09082460403442383, 0.09081665426492691, 0.09094356000423431, 0.0909356027841568, 0.09092764556407928], [0.09106095135211945, 0.0910138413310051, 0.09084789454936981, 0.09083865582942963, 0.09082943201065063, 0.09097684919834137, 0.09081096202135086, 0.09080173820257187, 0.09094911813735962, 0.09093987196683884, 0.09093062579631805], [0.09072452038526535, 0.09078166633844376, 0.09098351746797562, 0.09099476784467697, 0.09100602567195892, 0.0908265933394432, 0.09102854132652283, 0.09103979915380478, 0.09086029976606369, 0.09087153524160385, 0.09088277816772461], [0.09074557572603226, 0.09079620242118835, 0.09097501635551453, 0.09098498523235321, 0.0909949541091919, 0.09083600342273712, 0.09101489931344986, 0.09102486819028854, 0.09086586534976959, 0.09087582677602768, 0.09088578820228577], [0.09076663851737976, 0.09081075340509415, 0.09096652269363403, 0.09097520262002945, 0.09098388999700546, 0.09084543585777283, 0.09100125730037689, 0.0910099446773529, 0.09087144583463669, 0.09088011831045151, 0.09088879823684692]], [[0.09077470004558563, 0.0908234640955925, 0.09074599295854568, 0.09097524732351303, 0.09078039228916168, 0.0908832773566246, 0.09068861603736877, 0.09073733538389206, 0.09150568395853043, 0.09085738658905029, 0.0912279486656189], [0.09081549197435379, 0.09084948152303696, 0.09079548716545105, 0.0909552276134491, 0.09081946313381195, 0.09089116007089615, 0.09075549244880676, 0.09078945219516754, 0.09132436662912369, 0.090873122215271, 0.09113117307424545], [0.09075064957141876, 0.09080810844898224, 0.09071683138608932, 0.09098699688911438, 0.090757355093956, 0.09087859839200974, 0.09064922481775284, 0.09070662409067154, 0.09161258488893509, 0.09084808826446533, 0.09128494560718536], [0.0909421443939209, 0.09093010425567627, 0.09094922989606857, 0.09089270234107971, 0.09094073623418808, 0.09091535955667496, 0.09096340090036392, 0.0909513607621193, 0.09076260775327682, 0.09092173725366592, 0.09083060920238495], [0.09077946096658707, 0.09082650393247604, 0.0907517746090889, 0.0909729078412056, 0.090784952044487, 0.09088420122861862, 0.09069642424583435, 0.09074342250823975, 0.09148450195789337, 0.09085922688245773, 0.09121664613485336], [0.09086548537015915, 0.0908813327550888, 0.0908561497926712, 0.09093064069747925, 0.09086732566356659, 0.09090077131986618, 0.09083747863769531, 0.09085333347320557, 0.09110254049301147, 0.09089235961437225, 0.0910126194357872], [0.09070250391960144, 0.09077734500169754, 0.09065845608711243, 0.0910104438662529, 0.09071123600006104, 0.09086918085813522, 0.09057043492794037, 0.09064517170190811, 0.09182669967412949, 0.09082942456007004, 0.09139899164438248], [0.09074338525533676, 0.09080347418785095, 0.09070803225040436, 0.09099054336547852, 0.09075040370225906, 0.09087718278169632, 0.09063734114170074, 0.09069735556840897, 0.09164486825466156, 0.09084527939558029, 0.09130215644836426], [0.09138019382953644, 0.0912071242928505, 0.0914822518825531, 0.0906711220741272, 0.09135997295379639, 0.0909954160451889, 0.09168672561645508, 0.09151307493448257, 0.0888294130563736, 0.0910869762301445, 0.08978767693042755], [0.09084385633468628, 0.0908675566315651, 0.09082990139722824, 0.09094129502773285, 0.09084662795066833, 0.0908966213464737, 0.09080199897289276, 0.09082569181919098, 0.09119848161935806, 0.09088404476642609, 0.09106391668319702], [0.09115169942378998, 0.091062992811203, 0.09120398014783859, 0.09078773111104965, 0.09114134311676025, 0.09095436334609985, 0.09130862355232239, 0.09121976047754288, 0.08983583748340607, 0.09100135415792465, 0.09033229947090149]], [[0.09088319540023804, 0.09089384227991104, 0.09095127880573273, 0.09082828462123871, 0.09097257256507874, 0.09080280363559723, 0.09086018800735474, 0.09100452810525894, 0.09096835553646088, 0.09084533154964447, 0.09098965674638748], [0.09088632464408875, 0.09089567512273788, 0.09094619005918503, 0.09083802253007889, 0.0909649133682251, 0.09081561863422394, 0.0908660814166069, 0.0909930095076561, 0.09096120297908783, 0.0908530205488205, 0.0909799262881279], [0.09090317785739899, 0.09090560674667358, 0.09091871976852417, 0.09089063107967377, 0.09092358499765396, 0.09088480472564697, 0.09089791774749756, 0.09093087911605835, 0.09092262387275696, 0.09089452773332596, 0.09092748910188675], [0.0908670425415039, 0.09088430553674698, 0.09097753465175629, 0.09077794849872589, 0.09101210534572601, 0.09073663502931595, 0.09082970768213272, 0.09106399118900299, 0.09100525081157684, 0.09080561250448227, 0.09103983640670776], [0.0909094288945198, 0.09090929478406906, 0.09090854972600937, 0.09091013669967651, 0.09090828150510788, 0.09091046452522278, 0.09090972691774368, 0.09090787172317505, 0.09090833365917206, 0.0909099206328392, 0.09090805798768997], [0.0908595472574234, 0.090879887342453, 0.09098971635103226, 0.09075459837913513, 0.09103046357631683, 0.09070593863725662, 0.09081555902957916, 0.09109160304069519, 0.09102237969636917, 0.09078717976808548, 0.09106313437223434], [0.09087643772363663, 0.09088984876871109, 0.09096228331327438, 0.09080719947814941, 0.0909891426563263, 0.09077508002519608, 0.09084741771221161, 0.09102944284677505, 0.0909838154911995, 0.09082869440317154, 0.091010682284832], [0.09091877937316895, 0.09091479331254959, 0.09089326858520508, 0.09093938022851944, 0.09088529646396637, 0.09094893932342529, 0.09092741459608078, 0.09087333083152771, 0.09088687598705292, 0.09093298017978668, 0.09087890386581421], [0.09090818464756012, 0.09090855717658997, 0.09091056883335114, 0.09090626239776611, 0.09091130644083023, 0.09090537577867508, 0.09090737998485565, 0.09091242402791977, 0.09091116487979889, 0.09090685844421387, 0.09091190248727798], [0.09087206423282623, 0.09088726341724396, 0.09096937626600266, 0.09079357981681824, 0.09099982678890228, 0.09075717628002167, 0.09083916991949081, 0.09104552119970322, 0.09099379181861877, 0.09081794321537018, 0.091024249792099], [0.09091442078351974, 0.09091222286224365, 0.09090037643909454, 0.09092576056718826, 0.09089598804712296, 0.09093102067708969, 0.09091917425394058, 0.09088940173387527, 0.0908968523144722, 0.09092223644256592, 0.09089246392250061]], [[0.09087926149368286, 0.09102489799261093, 0.09097561985254288, 0.090891994535923, 0.09099750220775604, 0.09094823151826859, 0.09093910455703735, 0.09097011387348175, 0.090426504611969, 0.09081724286079407, 0.09112957119941711], [0.09094581007957458, 0.09076463431119919, 0.0908258706331253, 0.09092993289232254, 0.09079866856336594, 0.09085992723703384, 0.09087128192186356, 0.09083271771669388, 0.09151318669319153, 0.09102314710617065, 0.09063483774662018], [0.09092347323894501, 0.0908527597784996, 0.09087666869163513, 0.09091728925704956, 0.09086604416370392, 0.09088996052742004, 0.09089439362287521, 0.09087934345006943, 0.09114439785480499, 0.09095363318920135, 0.09080203622579575], [0.09088514745235443, 0.09100215882062912, 0.09096257388591766, 0.09089537709951401, 0.0909801498055458, 0.09094056487083435, 0.09093323349952698, 0.0909581407904625, 0.09052115678787231, 0.09083531051874161, 0.09108623117208481], [0.0909334123134613, 0.09081363677978516, 0.09085412323474884, 0.09092292189598083, 0.09083613753318787, 0.09087663888931274, 0.09088414907455444, 0.09085865318775177, 0.09130800515413284, 0.0909845232963562, 0.09072776883840561], [0.09091097861528397, 0.0909016951918602, 0.0909048393368721, 0.0909101665019989, 0.09090344607830048, 0.09090658277273178, 0.09090716391801834, 0.09090518951416016, 0.09093993902206421, 0.09091493487358093, 0.09089503437280655], [0.09090680629014969, 0.09091800451278687, 0.09091421961784363, 0.09090778231620789, 0.09091589599847794, 0.0909121111035347, 0.09091140329837799, 0.090913787484169, 0.09087187796831131, 0.09090203046798706, 0.09092604368925095], [0.09092096984386444, 0.09086260944604874, 0.09088233858346939, 0.09091585874557495, 0.09087357670068741, 0.09089331328868866, 0.09089697152376175, 0.09088455140590668, 0.09110323339700699, 0.09094585478305817, 0.09082074463367462], [0.09066162258386612, 0.09183092415332794, 0.09143379330635071, 0.09076336026191711, 0.09160993993282318, 0.09121375530958176, 0.09114053100347519, 0.0913894847035408, 0.08710946887731552, 0.09016771614551544, 0.09267938882112503], [0.09085040539503098, 0.09113556891679764, 0.0910390242934227, 0.09087532758712769, 0.0910818949341774, 0.09098540246486664, 0.09096753597259521, 0.09102823585271835, 0.08996671438217163, 0.09072911739349365, 0.09134078025817871], [0.09099258482456207, 0.09057730436325073, 0.09071753919124603, 0.09095616638660431, 0.09065523743629456, 0.0907955914735794, 0.09082162380218506, 0.09073323756456375, 0.09230007976293564, 0.09117019176483154, 0.0902804285287857]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.1087045980073314e-05, "episode_return_min": -14.5, "episode_return_mean": 0.65, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.0006800820763996145, "num_env_steps_sampled_lifetime": 85400, "num_episodes": 20, "episode_duration_sec_mean": 0.005215245787985623, "module_episode_returns_mean": {"default_policy": 0.65}, "episode_len_min": 20, "episode_return_max": 13.5, "env_to_module_connector": {"connector_pipeline_timer": 5.851688418289318e-05, "timers": {"connectors": {"numpy_to_tensor": 1.1993959481305763e-05, "add_time_dim_to_batch_and_zero_pad": 6.941340901715053e-06, "batch_individual_items": 1.2342491181546e-05, "add_states_from_episodes_to_batch": 2.7571151273611733e-06, "add_observations_from_episodes_to_batch": 2.7777360079396314e-06}}}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_episodes_lifetime": 340, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.576714727061571e-05, "listify_data_for_vector_env": 1.0411320731609248e-05, "un_batch_to_individual_items": 6.494416304421859e-06, "normalize_and_clip_actions": 7.903325556764944e-06, "remove_single_ts_time_rank_from_batch": 1.1831013379506979e-05, "tensor_to_numpy": 1.503468593526182e-05}}, "connector_pipeline_timer": 0.00011310097514341277}, "num_env_steps_sampled": 400, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "num_agent_steps_sampled": {"default_agent": 400}, "env_step_timer": 1.3896388383545794e-05, "agent_episode_returns_mean": {"default_agent": 0.65}, "sample": 0.12918294944527847, "weights_seq_no": 17.0, "time_between_sampling": 9.29031806567075}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "b509c_00000", "date": "2025-08-11_18-31-58", "timestamp": 1754929918, "time_this_iter_s": 9.183380126953125, "time_total_s": 157.57097387313843, "pid": 11229, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x383ebd8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 157.57097387313843, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 36.823076923076925, "ram_util_percent": 78.52307692307693}}
{"timers": {"training_iteration": 9.750498029966343, "restore_env_runners": 9.93917157559136e-06, "training_step": 9.750287111295298, "env_runner_sampling_timer": 1.6519778213807246, "learner_update_timer": 7.91873268307997, "synch_weights": 0.0016052315318548515, "restore_eval_env_runners": 5.8117146277576416e-05, "evaluation_iteration": 0.14149108201229052, "synch_eval_env_connectors": 0.0003893339845727548, "synch_env_connectors": 5.429004407498981e-06}, "env_runners": {"num_episodes_lifetime": -493500.0, "rlmodule_inference_timer": 4.047361994205405e-05, "episode_duration_sec_mean": 0.0065922783408314005, "module_episode_returns_mean": {"default_policy": 1.6599999999999997}, "episode_return_min": -10.5, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.6024057772419896e-05, "add_states_from_episodes_to_batch": 3.060944693717652e-06, "numpy_to_tensor": 1.5680073287084032e-05, "add_observations_from_episodes_to_batch": 3.795614211361629e-06, "add_time_dim_to_batch_and_zero_pad": 8.476263204618223e-06}}, "connector_pipeline_timer": 7.436543036885536e-05}, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.4091256255507598e-05, "un_batch_to_individual_items": 7.559691994603688e-06, "tensor_to_numpy": 1.857661027482408e-05, "normalize_and_clip_actions": 9.874560194404078e-06, "remove_single_ts_time_rank_from_batch": 1.3630294056172709e-05, "get_actions": 5.188883435664504e-05}}, "connector_pipeline_timer": 0.00014675484039109655}, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "env_step_timer": 1.759382976004367e-05, "time_between_sampling": 0.031402051458555284, "episode_return_mean": 1.6599999999999997, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_max": 9.5, "sample": 0.006773749714641578, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "env_reset_timer": 4.816333664269788e-05, "num_env_steps_sampled_lifetime": -9870000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "agent_episode_returns_mean": {"default_agent": 1.6599999999999997}, "weights_seq_no": 17.0, "episode_len_mean": 20.0, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 2913.468391509952}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.13488069945516318, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008904453436766982, "add_observations_from_episodes_to_batch": 0.0009009451848942761, "add_columns_from_episodes_to_train_batch": 0.04162871143196085, "add_time_dim_to_batch_and_zero_pad": 0.07560849393097105, "add_states_from_episodes_to_batch": 0.003481267657687572, "batch_individual_items": 0.004068401914658539, "numpy_to_tensor": 7.07867699397203e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "weights_seq_no": 18.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 107730, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.6672132667843, "num_module_steps_trained": 5985, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime_throughput": 774.5395880049701}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_env_steps_trained_lifetime": 3564000, "num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_module_steps_trained_lifetime": 1292760, "num_env_steps_trained_lifetime_throughput": 47008.06245985204}, "default_policy": {"use_intrinsic_rewards": 1.0, "policy_loss": -0.0002573697129264474, "weights_seq_no": 108.0, "vf_explained_var": 0.0013399124145507812, "module_train_batch_size_mean": 997.4982334615715, "total_loss": 0.2779533267021179, "num_module_steps_trained_lifetime": 646380, "diff_num_grad_updates_vs_sampler_policy": 91.0, "vf_loss_unclipped": 43.558013916015625, "mean_kl_loss": 2.3712822439847514e-05, "entropy": 0.6762152314186096, "num_module_steps_trained": 35910, "vf_loss": 0.3584493100643158}, "intrinsic_reward_module": {"total_loss": 0.0, "weights_seq_no": 108.0, "num_module_steps_trained_lifetime": 646380, "diff_num_grad_updates_vs_sampler_policy": 91.0, "module_train_batch_size_mean": 997.4982334615715, "num_module_steps_trained": 35910}}}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 33000, "num_module_steps_trained_lifetime": 215460, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 594000, "num_env_steps_trained_lifetime_throughput": 4271.718883868167, "num_module_steps_trained_throughput": 20765191.25344663, "num_module_steps_trained_lifetime_throughput": 12469762.256391395}, "default_policy": {"weights_seq_no": 18.0, "vf_explained_var": -0.001426100730895996, "module_train_batch_size_mean": 997.6672132667843, "total_loss": 0.27783146500587463, "num_module_steps_trained_lifetime": 107730, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 43.40105438232422, "mean_kl_loss": 2.5588258722564206e-05, "curr_kl_coeff": 6.163937769088079e-07, "entropy": 0.6761666536331177, "num_module_steps_trained": 5985, "vf_loss": 0.3583065867424011, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "use_intrinsic_rewards": 0.0, "policy_loss": -0.0002642441540956497, "num_module_steps_trained_lifetime_throughput": 774.5327567906102}, "IntrinsicAttentionMask": [[[0.0905005931854248, 0.09063634276390076, 0.09111679345369339, 0.09080719947814941, 0.09083393961191177, 0.09074315428733826, 0.09122416377067566, 0.09091420471668243, 0.09082333743572235, 0.09118666499853134, 0.09121351689100266], [0.09060022234916687, 0.09070292115211487, 0.09106609225273132, 0.09083212912082672, 0.09085234254598618, 0.09078370034694672, 0.09114719182252884, 0.09091302007436752, 0.09084432572126389, 0.09111887216567993, 0.09113915264606476], [0.09095221757888794, 0.09093785285949707, 0.09088718891143799, 0.09091980755329132, 0.09091697633266449, 0.09092656522989273, 0.09087591618299484, 0.09090851992368698, 0.09091809391975403, 0.09087985008955002, 0.09087703377008438], [0.09072551131248474, 0.09078659862279892, 0.09100238233804703, 0.09086340665817261, 0.09087541699409485, 0.09083462506532669, 0.09105052053928375, 0.09091147035360336, 0.09087065607309341, 0.09103371202945709, 0.09104575216770172], [0.09074509888887405, 0.09079966694116592, 0.09099241346120834, 0.09086828678846359, 0.09087901562452316, 0.09084256738424301, 0.0910354033112526, 0.09091121703386307, 0.09087475389242172, 0.09102039784193039, 0.09103114157915115], [0.09067855030298233, 0.09075523167848587, 0.09102623909711838, 0.09085167944431305, 0.09086676687002182, 0.09081553667783737, 0.0910867229104042, 0.09091204404830933, 0.09086078405380249, 0.09106560051441193, 0.09108073264360428], [0.09103074669837952, 0.09099020063877106, 0.09084732085466385, 0.09093927592039108, 0.09093131870031357, 0.09095834940671921, 0.09081552177667618, 0.09090744704008102, 0.09093447774648666, 0.0908266231417656, 0.09081867337226868], [0.09080391377210617, 0.09083892405033112, 0.09096252173185349, 0.09088292717933655, 0.0908898115158081, 0.09086644649505615, 0.0909900814294815, 0.09091046452522278, 0.09088708460330963, 0.09098046272993088, 0.09098734706640244], [0.09073732793331146, 0.09079448133707047, 0.09099636226892471, 0.0908663421869278, 0.09087758511304855, 0.09083941578865051, 0.09104139357805252, 0.09091131389141083, 0.09087312966585159, 0.09102566540241241, 0.09103693068027496], [0.09100333601236343, 0.0909719318151474, 0.0908612459897995, 0.09093248844146729, 0.09092631936073303, 0.09094726294279099, 0.09083661437034607, 0.09090783447027206, 0.09092877060174942, 0.09084521234035492, 0.09083905071020126], [0.09102296829223633, 0.0909850150346756, 0.09085128456354141, 0.09093735367059708, 0.09092990309000015, 0.0909552127122879, 0.0908215120434761, 0.09090755879878998, 0.09093286097049713, 0.09083190560340881, 0.09082446247339249]], [[0.09090014547109604, 0.09093113243579865, 0.09088189899921417, 0.09091288596391678, 0.09101841598749161, 0.09096913784742355, 0.09084542840719223, 0.09087640047073364, 0.09056136757135391, 0.09095268696546555, 0.09115051478147507], [0.09090443700551987, 0.09092061221599579, 0.090894915163517, 0.09091109037399292, 0.09096616506576538, 0.0909404456615448, 0.09087586402893066, 0.09089203923940659, 0.09072740375995636, 0.09093186259269714, 0.09103506803512573], [0.0908975899219513, 0.0909372940659523, 0.09087421000003815, 0.09091390669345856, 0.09104916453361511, 0.09098599851131439, 0.09082747995853424, 0.09086715430021286, 0.09046370536088943, 0.0909649208188057, 0.09121853113174438], [0.0909019261598587, 0.09092681854963303, 0.09088726341724396, 0.09091216325759888, 0.09099695086479187, 0.09095735847949982, 0.09085796028375626, 0.09088284522294998, 0.09062960743904114, 0.09094414114952087, 0.09110304713249207], [0.09091629832983017, 0.0908907949924469, 0.09093132615089417, 0.0909058153629303, 0.09081904590129852, 0.0908595472574234, 0.09096137434244156, 0.0909358561038971, 0.09119615703821182, 0.09087307006120682, 0.09071069955825806], [0.09090965241193771, 0.09090767055749893, 0.09091080725193024, 0.09090883284807205, 0.09090211242437363, 0.09090524911880493, 0.09091313928365707, 0.09091116487979889, 0.09093129634857178, 0.0909062922000885, 0.0908937007188797], [0.09089243412017822, 0.09094958752393723, 0.09085879474878311, 0.09091592580080032, 0.09111066162586212, 0.09101970493793488, 0.09079155325889587, 0.0908486470580101, 0.09026866406202316, 0.0909893587231636, 0.09135468304157257], [0.09089682251214981, 0.09093916416168213, 0.0908718928694725, 0.09091422706842422, 0.09105844795703888, 0.09099109470844269, 0.09082206338644028, 0.09086437523365021, 0.09043426066637039, 0.09096861630678177, 0.0912390723824501], [0.09085001051425934, 0.09104330837726593, 0.09073638170957565, 0.09092943370342255, 0.09158958494663239, 0.09128081798553467, 0.09050954878330231, 0.0907021164894104, 0.08875925093889236, 0.09117795526981354, 0.09242159873247147], [0.09090741723775864, 0.09091329574584961, 0.09090395271778107, 0.09090983122587204, 0.09092984348535538, 0.09092050790786743, 0.09089703112840652, 0.0909029096364975, 0.09084302186965942, 0.09091738611459732, 0.09095487743616104], [0.09093353152275085, 0.0908450335264206, 0.09098568558692932, 0.09089713543653488, 0.09059640020132065, 0.09073666483163834, 0.09109008312225342, 0.09100142866373062, 0.09190864861011505, 0.09078355133533478, 0.0902218446135521]], [[0.09056159853935242, 0.09069743007421494, 0.09084165841341019, 0.09120506048202515, 0.0908951610326767, 0.0908043161034584, 0.09094870090484619, 0.09097548574209213, 0.09122126549482346, 0.09091131389141083, 0.09093809127807617], [0.09064634889364243, 0.0907490998506546, 0.09085814654827118, 0.09113273024559021, 0.09089858829975128, 0.09082991629838943, 0.09093905985355377, 0.09095929563045502, 0.09114497154951096, 0.09091079980134964, 0.09093103557825089], [0.0907362550497055, 0.09080386906862259, 0.09087560325860977, 0.09105610102415085, 0.09090220928192139, 0.09085703641176224, 0.090928815305233, 0.09094212204217911, 0.09106414765119553, 0.09091023355722427, 0.09092354029417038], [0.09096246212720871, 0.09094155579805374, 0.09091939777135849, 0.09086374938488007, 0.09091118723154068, 0.09092513471841812, 0.09090297669172287, 0.09089887887239456, 0.09086126834154129, 0.0909087136387825, 0.0909046083688736], [0.09076960384845734, 0.0908241868019104, 0.0908820852637291, 0.09102772921323776, 0.09090355038642883, 0.09086710214614868, 0.09092502295970917, 0.09093575924634933, 0.09103421866893768, 0.09091003239154816, 0.09092076867818832], [0.09071298688650131, 0.09078970551490784, 0.09087108820676804, 0.09107593446969986, 0.09090127795934677, 0.09085002541542053, 0.0909314751625061, 0.09094657003879547, 0.09108506143093109, 0.09091038256883621, 0.09092548489570618], [0.09080294519662857, 0.09084448963403702, 0.09088854491710663, 0.09099933505058289, 0.09090487658977509, 0.09087713807821274, 0.09092121571302414, 0.09092938154935837, 0.09100427478551865, 0.09090980887413025, 0.09091797471046448], [0.09081962704658508, 0.09085463732481003, 0.0908917784690857, 0.09098515659570694, 0.09090554714202881, 0.09088216722011566, 0.09091931581497192, 0.09092620015144348, 0.09098931401968002, 0.0909096971154213, 0.09091658145189285], [0.09097255021333694, 0.0909476950764656, 0.09092135727405548, 0.0908552035689354, 0.09091159701347351, 0.09092816710472107, 0.09090183675289154, 0.09089695662260056, 0.09085226058959961, 0.09090864658355713, 0.09090377390384674], [0.09077965468168259, 0.09083030372858047, 0.09088402986526489, 0.0910191535949707, 0.09090394526720047, 0.09087011963129044, 0.09092386811971664, 0.09093382954597473, 0.09102517366409302, 0.09090995788574219, 0.09091991931200027], [0.0907963290810585, 0.09084045886993408, 0.09088725596666336, 0.09100496768951416, 0.0909046083688736, 0.09087514132261276, 0.09092196077108383, 0.09093064069747925, 0.0910102054476738, 0.09090984612703323, 0.09091852605342865]], [[0.0908239483833313, 0.09087273478507996, 0.09079522639513016, 0.09084399789571762, 0.09082964062690735, 0.09075216203927994, 0.09091820567846298, 0.09078656136989594, 0.09137367457151413, 0.09072631597518921, 0.09127743542194366], [0.09084981679916382, 0.09088381379842758, 0.09082979708909988, 0.09086378663778305, 0.09085378050804138, 0.09079978615045547, 0.0909154862165451, 0.09082376211881638, 0.0912325531244278, 0.09078176319599152, 0.09116560220718384], [0.09080870449542999, 0.09086620807647705, 0.09077486395835876, 0.09083234518766403, 0.09081541746854782, 0.09072413295507431, 0.09091980010271072, 0.09076465666294098, 0.09145686775445938, 0.09069366753101349, 0.09134335070848465], [0.0908345878124237, 0.09087729454040527, 0.09080944210290909, 0.09085214138031006, 0.09083957225084305, 0.09077174961566925, 0.09091709554195404, 0.09080186486244202, 0.09131563454866409, 0.0907491147518158, 0.09123145043849945], [0.09082697331905365, 0.09087403863668442, 0.09079927206039429, 0.09084632247686386, 0.09083247184753418, 0.09075773507356644, 0.09091789275407791, 0.09079091250896454, 0.09135720133781433, 0.09073279052972794, 0.09126438945531845], [0.09078581631183624, 0.09085637331008911, 0.09074429422616959, 0.09081482142210007, 0.09079404920339584, 0.09068204462528229, 0.09092213958501816, 0.09073176980018616, 0.09158175438642502, 0.09064467996358871, 0.09144226461648941], [0.09087387472391129, 0.09089408814907074, 0.0908619686961174, 0.09088218957185745, 0.09087623655796051, 0.09084412455558777, 0.09091292321681976, 0.09085838496685028, 0.09110127389431, 0.0908334031701088, 0.09106152504682541], [0.09080410748720169, 0.09086423367261887, 0.0907687172293663, 0.09082882851362228, 0.09081112593412399, 0.09071566164493561, 0.09092027693986893, 0.09075804054737091, 0.09148198366165161, 0.09068381786346436, 0.09136325120925903], [0.09111256897449493, 0.09099480509757996, 0.09118198603391647, 0.09106413275003433, 0.09109881520271301, 0.09128620475530624, 0.09088525921106339, 0.09120294451713562, 0.08979811519384384, 0.09134885668754578, 0.09002627432346344], [0.09077205508947372, 0.09085045009851456, 0.09072592109441757, 0.09080427885055542, 0.09078119695186615, 0.09065676480531693, 0.09092353284358978, 0.09071200340986252, 0.09165682643651962, 0.09061525762081146, 0.09150170534849167], [0.09106249362230301, 0.0909738689661026, 0.09111472219228745, 0.09102604538202286, 0.09105214476585388, 0.09119311720132828, 0.09089140594005585, 0.09113048762083054, 0.0900716632604599, 0.09124023467302322, 0.09024390578269958]], [[0.09087105840444565, 0.09088169783353806, 0.0908055230975151, 0.09094977378845215, 0.09082677960395813, 0.09092426300048828, 0.09098172187805176, 0.09085868299007416, 0.0909562036395073, 0.0909668505191803, 0.0909774973988533], [0.09087564051151276, 0.09088499844074249, 0.09081800282001495, 0.09094486385583878, 0.09083670377731323, 0.09092243015766144, 0.09097295254468918, 0.09086476266384125, 0.09095051139593124, 0.09095987677574158, 0.09096923470497131], [0.09084275364875793, 0.09086129069328308, 0.09072854369878769, 0.09097999334335327, 0.0907655879855156, 0.09093550592660904, 0.09103571623563766, 0.09082118421792984, 0.09099119901657104, 0.09100977331399918, 0.0910283550620079], [0.09090499579906464, 0.09090613573789597, 0.09089792519807816, 0.09091347455978394, 0.09090021997690201, 0.09091072529554367, 0.09091691672801971, 0.09090366214513779, 0.09091416746377945, 0.09091531485319138, 0.0909164622426033], [0.09085194021463394, 0.09086792171001434, 0.09075352549552917, 0.09097019582986832, 0.0907854437828064, 0.09093186259269714, 0.0910181999206543, 0.09083335846662521, 0.09097985178232193, 0.09099584817886353, 0.09101185202598572], [0.09089399874210358, 0.09089822322130203, 0.09086798131465912, 0.09092523902654648, 0.09087642282247543, 0.09091512113809586, 0.09093791246414185, 0.0908890888094902, 0.09092778712511063, 0.09093201160430908, 0.09093623608350754], [0.09091874957084656, 0.09091604501008987, 0.09093542397022247, 0.09089874476194382, 0.0909300148487091, 0.09090522676706314, 0.09089063853025436, 0.09092190116643906, 0.09089711308479309, 0.09089440852403641, 0.09089171141386032], [0.09086570888757706, 0.09087784588336945, 0.09079097956418991, 0.0909554734826088, 0.0908152237534523, 0.09092637896537781, 0.09099190682172775, 0.09085159748792648, 0.09096280485391617, 0.09097494930028915, 0.09098709374666214], [0.0909077599644661, 0.09090813249349594, 0.09090546518564224, 0.09091050922870636, 0.09090621024370193, 0.09090962260961533, 0.0909116268157959, 0.09090732783079147, 0.09091073274612427, 0.09091110527515411, 0.09091147780418396], [0.0909123495221138, 0.09091144055128098, 0.09091796725988388, 0.09090559929609299, 0.09091614186763763, 0.09090778976678848, 0.09090287238359451, 0.09091340750455856, 0.09090505540370941, 0.09090414643287659, 0.09090323001146317], [0.0909169390797615, 0.09091474115848541, 0.09093046933412552, 0.09090069681406021, 0.09092608094215393, 0.09090595692396164, 0.09089411050081253, 0.09091948717832565, 0.09089937061071396, 0.09089717268943787, 0.09089498221874237]], [[0.09079115092754364, 0.09102050960063934, 0.0907624363899231, 0.09099172800779343, 0.09079683572053909, 0.0908997431397438, 0.09070505201816559, 0.09075377881526947, 0.09134067595005035, 0.09069355577230453, 0.09124447405338287], [0.09095911681652069, 0.09086164087057114, 0.09097134321928024, 0.0908738449215889, 0.09095669537782669, 0.09091292321681976, 0.09099580347537994, 0.09097503125667572, 0.09072614461183548, 0.09100070595741272, 0.0907667800784111], [0.09077005088329315, 0.09104038029909134, 0.09073622524738312, 0.09100645035505295, 0.09077675640583038, 0.09089802950620651, 0.09066860377788544, 0.09072601795196533, 0.09141793102025986, 0.09065505862236023, 0.0913044661283493], [0.09093809127807617, 0.0908815786242485, 0.09094517678022385, 0.09088865667581558, 0.09093669056892395, 0.09091131389141083, 0.09095935523509979, 0.09094731509685516, 0.09080298990011215, 0.09096219390630722, 0.09082657098770142], [0.09079533070325851, 0.09101657569408417, 0.09076763689517975, 0.09098881483078003, 0.09080082178115845, 0.09090008586645126, 0.09071227163076401, 0.0907592847943306, 0.09132537245750427, 0.09070117771625519, 0.09123259782791138], [0.09087081253528595, 0.09094532579183578, 0.090861476957798, 0.09093598276376724, 0.09087266772985458, 0.09090611338615417, 0.09084281325340271, 0.09085866063833237, 0.09104912728071213, 0.09083907306194305, 0.09101796895265579], [0.09072782844305038, 0.09108008444309235, 0.09068376570940018, 0.091035857796669, 0.09073656052350998, 0.09089455008506775, 0.09059572219848633, 0.09067048132419586, 0.0915725901722908, 0.09057807922363281, 0.09142450988292694], [0.09076368808746338, 0.09104637801647186, 0.09072831273078918, 0.09101089835166931, 0.09077069908380508, 0.09089751541614532, 0.09065761417150497, 0.09071764349937439, 0.09144125878810883, 0.09064344316720963, 0.09132257848978043], [0.09119176864624023, 0.0906393751502037, 0.09126124531030655, 0.090708427131176, 0.09117800742387772, 0.09092963486909866, 0.09140035510063171, 0.09128222614526749, 0.08987617492675781, 0.09142826497554779, 0.09010452777147293], [0.09071936458349228, 0.09108804166316986, 0.09067326039075851, 0.09104175120592117, 0.0907285064458847, 0.09089385718107224, 0.09058111906051636, 0.09065935015678406, 0.09160362184047699, 0.09056266397237778, 0.0914485901594162], [0.0911220833659172, 0.09070621430873871, 0.09117434918880463, 0.09075823426246643, 0.09111172705888748, 0.09092481434345245, 0.09127896279096603, 0.09119012951850891, 0.09013060480356216, 0.09129994362592697, 0.0903029590845108]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.051870751851374e-05, "episode_return_min": -14.5, "episode_return_mean": 0.65, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.0006765891760505729, "num_env_steps_sampled_lifetime": 90400, "num_episodes": 20, "episode_duration_sec_mean": 0.00519966580090113, "module_episode_returns_mean": {"default_policy": 0.65}, "episode_len_min": 20, "episode_return_max": 13.5, "env_to_module_connector": {"connector_pipeline_timer": 5.8939109809970584e-05, "timers": {"connectors": {"numpy_to_tensor": 1.1926681899484268e-05, "add_time_dim_to_batch_and_zero_pad": 7.080496024859608e-06, "batch_individual_items": 1.2458476734635101e-05, "add_states_from_episodes_to_batch": 2.764351373854191e-06, "add_observations_from_episodes_to_batch": 2.820462561625368e-06}}}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_episodes_lifetime": 360, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.577652764506528e-05, "listify_data_for_vector_env": 1.0373727577175397e-05, "un_batch_to_individual_items": 6.616645989539943e-06, "normalize_and_clip_actions": 8.033145757966205e-06, "remove_single_ts_time_rank_from_batch": 1.1867926299365384e-05, "tensor_to_numpy": 1.5138172882738034e-05}}, "connector_pipeline_timer": 0.00011352611501288945}, "num_env_steps_sampled": 400, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "num_agent_steps_sampled": {"default_agent": 400}, "env_step_timer": 1.3812478112663112e-05, "agent_episode_returns_mean": {"default_agent": 0.65}, "sample": 0.12903863120069947, "weights_seq_no": 18.0, "time_between_sampling": 9.293327206263532}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "b509c_00000", "date": "2025-08-11_18-32-08", "timestamp": 1754929928, "time_this_iter_s": 9.689173936843872, "time_total_s": 167.2601478099823, "pid": 11229, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x383ebd8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 167.2601478099823, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 39.85384615384615, "ram_util_percent": 77.73846153846154}}
{"timers": {"training_iteration": 9.749314972166598, "restore_env_runners": 9.9181099091267e-06, "training_step": 9.749103598102783, "env_runner_sampling_timer": 1.6519358014960461, "learner_update_timer": 7.917489688328666, "synch_weights": 0.0015994429664002554, "restore_eval_env_runners": 5.771764441697124e-05, "evaluation_iteration": 0.14130921952292724, "synch_eval_env_connectors": 0.00038698647372697873, "synch_env_connectors": 5.423044184280443e-06}, "env_runners": {"num_episodes_lifetime": -524375.0, "rlmodule_inference_timer": 3.378833166835234e-05, "episode_duration_sec_mean": 0.0056518770228140055, "module_episode_returns_mean": {"default_policy": 1.2600000000000002}, "episode_return_min": -10.5, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.333804321349426e-05, "add_states_from_episodes_to_batch": 2.8108047371613886e-06, "numpy_to_tensor": 1.3745079348915022e-05, "add_observations_from_episodes_to_batch": 2.9621173919957106e-06, "add_time_dim_to_batch_and_zero_pad": 7.5314108495391656e-06}}, "connector_pipeline_timer": 6.41104647572913e-05}, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1035632808373846e-05, "un_batch_to_individual_items": 6.969670865587923e-06, "tensor_to_numpy": 1.6281469176129312e-05, "normalize_and_clip_actions": 8.424875326912886e-06, "remove_single_ts_time_rank_from_batch": 1.2493225363305503e-05, "get_actions": 4.219060002646066e-05}}, "connector_pipeline_timer": 0.0001254814480939518}, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "env_step_timer": 1.492026905605166e-05, "time_between_sampling": 0.03168807603497748, "episode_return_mean": 1.2600000000000002, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_max": 9.5, "sample": 0.006012992878456583, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "env_reset_timer": 4.320828052194958e-05, "num_env_steps_sampled_lifetime": -10487500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "agent_episode_returns_mean": {"default_agent": 1.2600000000000002}, "weights_seq_no": 18.0, "episode_len_mean": 20.0, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3107.9417596397448}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1348900520408795, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00890367598195381, "add_observations_from_episodes_to_batch": 0.0009008165631823925, "add_columns_from_episodes_to_train_batch": 0.041643298897692985, "add_time_dim_to_batch_and_zero_pad": 0.07560297441226471, "add_states_from_episodes_to_batch": 0.0034827703915086433, "batch_individual_items": 0.004069259145468889, "numpy_to_tensor": 7.068931201048402e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "weights_seq_no": 19.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 113715, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.6572809365935, "num_module_steps_trained": 5985, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime_throughput": 772.3769510319199}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_env_steps_trained_lifetime": 3762000, "num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_module_steps_trained_lifetime": 1364580, "num_env_steps_trained_lifetime_throughput": 46347.74051606744}, "default_policy": {"use_intrinsic_rewards": 1.0, "policy_loss": -3.355144872330129e-05, "weights_seq_no": 114.0, "vf_explained_var": 0.001236259937286377, "module_train_batch_size_mean": 997.4980069784294, "total_loss": 0.27817094326019287, "num_module_steps_trained_lifetime": 682290, "diff_num_grad_updates_vs_sampler_policy": 96.0, "vf_loss_unclipped": 43.547550201416016, "mean_kl_loss": 3.418251799303107e-05, "entropy": 0.6745857000350952, "num_module_steps_trained": 35910, "vf_loss": 0.3584360182285309}, "intrinsic_reward_module": {"total_loss": 0.0, "weights_seq_no": 114.0, "num_module_steps_trained_lifetime": 682290, "diff_num_grad_updates_vs_sampler_policy": 96.0, "module_train_batch_size_mean": 997.4980069784294, "num_module_steps_trained": 35910}}}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 33000, "num_module_steps_trained_lifetime": 227430, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 627000, "num_env_steps_trained_lifetime_throughput": 4259.754262610064, "num_module_steps_trained_throughput": 20308829.052886736, "num_module_steps_trained_lifetime_throughput": 12449572.266699329}, "default_policy": {"weights_seq_no": 19.0, "vf_explained_var": -0.0021306276321411133, "module_train_batch_size_mean": 997.6572809365935, "total_loss": 0.27806228399276733, "num_module_steps_trained_lifetime": 113715, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 43.341026306152344, "mean_kl_loss": 3.357690366101451e-05, "curr_kl_coeff": 3.0819688845440396e-07, "entropy": 0.6746010184288025, "num_module_steps_trained": 5985, "vf_loss": 0.3583075702190399, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "use_intrinsic_rewards": 0.0, "policy_loss": -3.657627530628815e-05, "num_module_steps_trained_lifetime_throughput": 772.3705942826161}, "IntrinsicAttentionMask": [[[0.09089534729719162, 0.09090599417686462, 0.09082978963851929, 0.09097408503293991, 0.09098473936319351, 0.09081494063138962, 0.09087233245372772, 0.09101669490337372, 0.09084684401750565, 0.09085748344659805, 0.09100181609392166], [0.09089700877666473, 0.09090636670589447, 0.09083935618400574, 0.09096623957157135, 0.09097561240196228, 0.09082629531621933, 0.09087676554918289, 0.09100370854139328, 0.09085435420274734, 0.09086370468139648, 0.09099062532186508], [0.09088508784770966, 0.090903639793396, 0.09077083319425583, 0.09102239459753036, 0.0910409688949585, 0.09074496477842331, 0.09084496647119522, 0.09109673649072647, 0.09080054610967636, 0.09081907570362091, 0.09107077866792679], [0.09090761095285416, 0.09090875834226608, 0.09090054035186768, 0.09091608971357346, 0.09091723710298538, 0.09089893847703934, 0.09090512245893478, 0.09092067927122116, 0.09090238064527512, 0.09090352803468704, 0.09091907739639282], [0.09090927243232727, 0.09090913832187653, 0.09091012179851532, 0.09090825915336609, 0.09090812504291534, 0.09091030806303024, 0.09090957045555115, 0.09090771526098251, 0.09090989828109741, 0.09090976417064667, 0.09090790152549744], [0.09088275581598282, 0.09090310335159302, 0.09075747430324554, 0.09103333204984665, 0.09105371683835983, 0.09072910249233246, 0.09083876013755798, 0.09111487120389938, 0.0907900482416153, 0.0908103734254837, 0.09108639508485794], [0.09089174121618271, 0.09090515971183777, 0.09080908447504044, 0.09099103510379791, 0.09100446850061417, 0.09079036861658096, 0.09086272120475769, 0.09104477614164352, 0.09083058685064316, 0.09084399044513702, 0.09102600812911987], [0.09091422706842422, 0.09091023355722427, 0.09093880653381348, 0.0908847227692604, 0.09088074415922165, 0.09094437956809998, 0.09092285484075546, 0.09086877852678299, 0.09093241393566132, 0.09092842042446136, 0.09087434411048889], [0.09088775515556335, 0.09090425074100494, 0.0907861664891243, 0.09100982546806335, 0.09102634340524673, 0.0907631665468216, 0.09085208922624588, 0.09107590466737747, 0.09081258624792099, 0.09082906693220139, 0.0910528302192688], [0.09088942408561707, 0.09090463072061539, 0.09079573303461075, 0.09100198745727539, 0.0910172164440155, 0.0907745212316513, 0.09085652977228165, 0.09106291830539703, 0.09082010388374329, 0.09083529561758041, 0.09104163944721222], [0.09091191738843918, 0.09090971946716309, 0.09092544764280319, 0.09089568257331848, 0.09089348465204239, 0.09092851728200912, 0.09091667085886002, 0.09088689833879471, 0.09092192351818085, 0.09091973304748535, 0.09088996052742004]], [[0.09080754965543747, 0.09085632860660553, 0.09077883511781693, 0.09082760661840439, 0.09099377691745758, 0.09091617166996002, 0.09072143584489822, 0.0907701775431633, 0.09135717898607254, 0.09070993959903717, 0.09126096218824387], [0.09083838760852814, 0.0908723771572113, 0.0908183753490448, 0.09085235744714737, 0.09096813201904297, 0.09091407060623169, 0.09077836573123932, 0.09081234037876129, 0.09122107923030853, 0.09077034890651703, 0.09115413576364517], [0.09078939259052277, 0.09084687381982803, 0.09075555950403214, 0.09081301838159561, 0.09100887924432755, 0.09091739356517792, 0.09068792313337326, 0.09074534475803375, 0.09143740683794022, 0.09067437052726746, 0.09132391214370728], [0.09082023054361343, 0.0908629298210144, 0.09079509228467941, 0.09083778411149979, 0.09098324179649353, 0.09091531485319138, 0.09074484556913376, 0.09078751504421234, 0.09130120277404785, 0.09073477238416672, 0.0912170335650444], [0.09092500805854797, 0.09091734141111374, 0.09092952311038971, 0.09092185646295547, 0.09089575707912445, 0.09090793877840042, 0.09093856066465378, 0.09093089401721954, 0.09083886444568634, 0.09094037115573883, 0.09085390716791153], [0.09087614715099335, 0.0908920019865036, 0.0908668115735054, 0.09088266640901566, 0.09093664586544037, 0.09091144800186157, 0.09084814041852951, 0.09086399525403976, 0.09105446934700012, 0.09084440022706985, 0.09102330356836319], [0.09075300395488739, 0.09082788974046707, 0.09070893377065659, 0.09078378975391388, 0.0910390093922615, 0.09091977775096893, 0.09062086790800095, 0.09069564193487167, 0.09159800410270691, 0.09060321748256683, 0.09144988656044006], [0.09078389406204224, 0.09084401279687881, 0.09074851870536804, 0.09080860763788223, 0.09101342409849167, 0.09091775119304657, 0.09067779779434204, 0.09073784202337265, 0.09146162122488022, 0.09066363424062729, 0.09134291112422943], [0.09115217626094818, 0.09103436768054962, 0.09122162312269211, 0.09110371768474579, 0.0907035768032074, 0.09089015424251556, 0.0913606733083725, 0.09124258905649185, 0.08983715623617172, 0.09138856828212738, 0.09006541222333908], [0.090745709836483, 0.09082408994436264, 0.09069959819316864, 0.0907779335975647, 0.09104504436254501, 0.09092025458812714, 0.0906074270606041, 0.09068568050861359, 0.0916302278637886, 0.09058896452188492, 0.09147515147924423], [0.09109228849411011, 0.09100363403558731, 0.09114453941583633, 0.09105583280324936, 0.09075457602739334, 0.09089508652687073, 0.09124911576509476, 0.09116030484437943, 0.09010113030672073, 0.0912700891494751, 0.0902734324336052]], [[0.09040938317775726, 0.09088045358657837, 0.09068897366523743, 0.0907156839966774, 0.09107857942581177, 0.09098754078149796, 0.09113222360610962, 0.09115906059741974, 0.09106794744729996, 0.09075851738452911, 0.09112159162759781], [0.09083227813243866, 0.09090472757816315, 0.09087532013654709, 0.090879425406456, 0.0909351035952568, 0.09092115610837936, 0.09094332158565521, 0.09094743430614471, 0.09093347936868668, 0.09088601171970367, 0.09094169735908508], [0.090660460293293, 0.09089493006467819, 0.09079969674348831, 0.09081298857927322, 0.09099335968494415, 0.09094814956188202, 0.09101999551057816, 0.09103331714868546, 0.09098808467388153, 0.09083430469036102, 0.09101472049951553], [0.0906844288110733, 0.09089629352092743, 0.09081025421619415, 0.0908222571015358, 0.09098522365093231, 0.09094437956809998, 0.09100928902626038, 0.09102132171392441, 0.09098045527935028, 0.09084151685237885, 0.09100452065467834], [0.0910099521279335, 0.090914785861969, 0.09095339477062225, 0.09094800055027008, 0.09087493270635605, 0.0908932313323021, 0.0908641591668129, 0.09085877239704132, 0.09087707102298737, 0.09093935787677765, 0.09086629748344421], [0.0909283310174942, 0.0909101814031601, 0.09091754257678986, 0.09091651439666748, 0.09090257436037064, 0.0909060686826706, 0.09090051800012589, 0.09089948982000351, 0.09090297669172287, 0.09091486781835556, 0.09090092033147812], [0.09105804562568665, 0.09091749787330627, 0.09097450971603394, 0.09096655249595642, 0.09085866063833237, 0.09088566899299622, 0.09084276109933853, 0.09083481132984161, 0.09086181223392487, 0.0909537822008133, 0.09084591269493103], [0.09108209609985352, 0.09091884642839432, 0.09098506718873978, 0.0909758135676384, 0.09085051715373993, 0.09088189154863358, 0.09083205461502075, 0.09082282334566116, 0.09085418283939362, 0.09096098691225052, 0.09083571285009384], [0.09100042283535004, 0.09091424196958542, 0.09094921499490738, 0.0909443348646164, 0.09087815880775452, 0.09089472889900208, 0.09086840599775314, 0.09086353331804276, 0.09088009595870972, 0.09093649685382843, 0.09087033569812775], [0.09072287380695343, 0.09089849889278412, 0.09082718193531036, 0.09083713591098785, 0.09097219258546829, 0.09093834459781647, 0.09099213033914566, 0.09100209921598434, 0.09096824377775192, 0.09085309505462646, 0.0909881740808487], [0.09104850888252258, 0.0909169539809227, 0.09097032248973846, 0.09096287190914154, 0.09086187928915024, 0.0908871665596962, 0.09084699302911758, 0.09083955734968185, 0.09086483716964722, 0.09095092117786407, 0.09084995090961456]], [[0.09082791954278946, 0.09089203923940659, 0.09092981368303299, 0.09081815928220749, 0.09091303497552872, 0.09095082432031631, 0.09095782786607742, 0.09093404561281204, 0.09117667376995087, 0.09087550640106201, 0.09072412550449371], [0.09096427261829376, 0.09092061221599579, 0.090894915163517, 0.09097093343734741, 0.09090632200241089, 0.0908806249499321, 0.09087586402893066, 0.09089203923940659, 0.09072740375995636, 0.09093186259269714, 0.09103506803512573], [0.09104451537132263, 0.0909372866153717, 0.09087420254945755, 0.09106086194515228, 0.09090220928192139, 0.09083914756774902, 0.09082747250795364, 0.09086714684963226, 0.09046369791030884, 0.0909649133682251, 0.09121852368116379], [0.09080712497234344, 0.090887650847435, 0.0909351035952568, 0.09079486131668091, 0.09091402590274811, 0.09096149355173111, 0.09097029268741608, 0.09094041585922241, 0.09124530106782913, 0.09086689352989197, 0.09067680686712265], [0.09100889414548874, 0.09092990309000015, 0.09088341891765594, 0.09102093428373337, 0.09090405702590942, 0.09085758775472641, 0.09084897488355637, 0.09087821841239929, 0.09058073163032532, 0.09095025062561035, 0.09113702923059464], [0.09108909964561462, 0.0909465104341507, 0.09086264669895172, 0.09111084789037704, 0.09089987725019455, 0.09081605076789856, 0.09080053120851517, 0.0908532664179802, 0.09031738340854645, 0.09098323434591293, 0.09132061898708344], [0.09110395610332489, 0.09094956517219543, 0.09085877239704132, 0.09112749993801117, 0.09089908003807068, 0.09080833941698074, 0.09079153090715408, 0.09084862470626831, 0.09026864916086197, 0.09098933637142181, 0.09135466068983078], [0.09105348587036133, 0.09093914926052094, 0.0908718854188919, 0.09107092022895813, 0.09090173989534378, 0.09083450585603714, 0.09082204848527908, 0.09086436033248901, 0.0904342457652092, 0.09096860140562057, 0.09123905748128891], [0.09156661480665207, 0.09104306250810623, 0.09073613584041595, 0.09164666384458542, 0.09087231010198593, 0.09056596457958221, 0.09050930291414261, 0.0907018780708313, 0.08875901997089386, 0.09117770940065384, 0.09242134541273117], [0.09092915803194046, 0.09091328829526901, 0.09090394526720047, 0.09093157202005386, 0.09090809524059296, 0.09089875221252441, 0.09089702367782593, 0.0909029021859169, 0.09084301441907883, 0.09091737866401672, 0.09095486998558044], [0.09060664474964142, 0.09084498137235641, 0.09098563343286514, 0.09057038277387619, 0.09092313796281815, 0.09106391668319702, 0.09109002351760864, 0.09100137650966644, 0.09190858900547028, 0.09078349173069, 0.09022178500890732]], [[0.09047015756368637, 0.09060586988925934, 0.09074994176626205, 0.09111297130584717, 0.09080339223146439, 0.0910487100481987, 0.09119348973035812, 0.09122034162282944, 0.09079279750585556, 0.09081953018903732, 0.09118285030126572], [0.09057719260454178, 0.09067986905574799, 0.0907888263463974, 0.09106320142745972, 0.09082924574613571, 0.09101465344429016, 0.0911240205168724, 0.09114430099725723, 0.09082123637199402, 0.09084144234657288, 0.09111598134040833], [0.09069075435400009, 0.09075833857059479, 0.09083003550767899, 0.0910104438662529, 0.09085661917924881, 0.09097853302955627, 0.0910504087805748, 0.0910637304186821, 0.09085135161876678, 0.0908646509051323, 0.09104512631893158], [0.0909765288233757, 0.09095562249422073, 0.09093345701694489, 0.09087780117988586, 0.09092524647712708, 0.0908876359462738, 0.09086549282073975, 0.09086138755083084, 0.0909268707036972, 0.0909227654337883, 0.09086711704730988], [0.0907328650355339, 0.09078742563724518, 0.09084530174732208, 0.09099088609218597, 0.09086675941944122, 0.090965136885643, 0.09102312475442886, 0.09103387594223022, 0.09086250513792038, 0.09087323397397995, 0.09101887047290802], [0.09092598408460617, 0.09092074632644653, 0.09091519564390182, 0.09090125560760498, 0.09091313928365707, 0.09090372174978256, 0.09089817106723785, 0.09089714288711548, 0.0909135490655899, 0.09091252088546753, 0.09089857339859009], [0.09103984385728836, 0.0909992903470993, 0.09095632284879684, 0.09084844589233398, 0.09094040840864182, 0.09086750447750092, 0.09082460403442383, 0.09081665426492691, 0.09094356000423431, 0.0909356027841568, 0.09082775563001633], [0.09106095135211945, 0.0910138413310051, 0.0909639447927475, 0.09083866328001022, 0.09094545245170593, 0.09086079150438309, 0.09081096202135086, 0.09080173820257187, 0.09094911813735962, 0.09093987196683884, 0.09081462025642395], [0.09072452038526535, 0.09078166633844376, 0.09084227681159973, 0.09099476784467697, 0.09086475521326065, 0.0909678041934967, 0.09102854132652283, 0.09103979915380478, 0.09086029976606369, 0.09087153524160385, 0.09102407097816467], [0.09074557572603226, 0.09079620242118835, 0.09084990620613098, 0.09098498523235321, 0.09086982160806656, 0.09096109867095947, 0.09101489931344986, 0.09102486819028854, 0.09086586534976959, 0.09087582677602768, 0.0910109430551529], [0.09103147685527802, 0.09099352359771729, 0.09095330536365509, 0.09085232764482498, 0.09093840420246124, 0.09087016433477402, 0.0908300057053566, 0.09082256257534027, 0.09094135463237762, 0.0909339115023613, 0.09083295613527298]], [[0.09085848182439804, 0.09100409597158432, 0.09084025025367737, 0.09098582714796066, 0.09097670018672943, 0.09092744439840317, 0.09091831743717194, 0.09094931930303574, 0.09051986038684845, 0.09091100096702576, 0.09110873937606812], [0.09097184985876083, 0.09079062938690186, 0.09099458158016205, 0.09081332385540009, 0.0908246710896492, 0.0908859446644783, 0.09089729934930801, 0.09085872769355774, 0.09139581769704819, 0.09090641140937805, 0.09066078811883926], [0.09084419906139374, 0.0910307988524437, 0.09082083404064178, 0.09100738912820816, 0.0909956842660904, 0.09093255549669266, 0.09092086553573608, 0.09096058458089828, 0.09041057527065277, 0.09091149270534515, 0.0911649540066719], [0.09095768630504608, 0.0908174067735672, 0.09097527712583542, 0.09083497524261475, 0.09084376692771912, 0.09089119732379913, 0.0908999890089035, 0.09087013453245163, 0.09128561615943909, 0.0909070372581482, 0.09071686863899231], [0.090950608253479, 0.09083080291748047, 0.0909656286239624, 0.09084580838680267, 0.09085331112146378, 0.09089382737874985, 0.09090133756399155, 0.09087583422660828, 0.09123056381940842, 0.09090735763311386, 0.09074492007493973], [0.09091231226921082, 0.09090302884578705, 0.09091347455978394, 0.09090419113636017, 0.09090477973222733, 0.09090791642665863, 0.09090849757194519, 0.090906523168087, 0.09093396365642548, 0.0909089595079422, 0.0908963680267334], [0.09090521186590195, 0.09091641008853912, 0.09090380370616913, 0.0909150093793869, 0.0909143015742302, 0.09091051667928696, 0.09090981632471085, 0.09091219305992126, 0.09087909758090973, 0.09090925008058548, 0.0909244492650032], [0.09092932939529419, 0.09087096154689789, 0.09093664586544037, 0.09087827801704407, 0.09088193625211716, 0.09090166538953781, 0.0909053236246109, 0.09089290350675583, 0.09106557071208954, 0.09090825915336609, 0.09082909673452377], [0.09059041738510132, 0.09149947762489319, 0.0904771089553833, 0.09138503670692444, 0.09132786840200424, 0.09101998805999756, 0.09096305072307587, 0.09115657955408096, 0.08850563317537308, 0.09091741591691971, 0.0921575054526329], [0.0908994972705841, 0.0909271314740181, 0.09089604020118713, 0.09092366695404053, 0.09092193096876144, 0.0909125879406929, 0.09091085195541382, 0.09091673791408539, 0.09083511680364609, 0.09090946614742279, 0.09094695746898651], [0.09105260670185089, 0.09063705056905746, 0.09110482782125473, 0.0906890332698822, 0.09071503579616547, 0.09085547924041748, 0.09088153392076492, 0.09079308807849884, 0.09202899783849716, 0.0909024253487587, 0.09033998847007751]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.511429780038089e-05, "episode_return_min": -14.5, "episode_return_mean": 0.65, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.0006712649436958946, "num_env_steps_sampled_lifetime": 95400, "num_episodes": 20, "episode_duration_sec_mean": 0.005298432426061481, "module_episode_returns_mean": {"default_policy": 0.65}, "episode_len_min": 20, "episode_return_max": 13.5, "env_to_module_connector": {"connector_pipeline_timer": 6.517853368692236e-05, "timers": {"connectors": {"numpy_to_tensor": 1.462476153881148e-05, "add_time_dim_to_batch_and_zero_pad": 7.72938782048765e-06, "batch_individual_items": 1.3448744829261806e-05, "add_states_from_episodes_to_batch": 2.9572228344863852e-06, "add_observations_from_episodes_to_batch": 3.0406130435234233e-06}}}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_episodes_lifetime": 380, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.294430733338081e-05, "listify_data_for_vector_env": 1.1352129203774023e-05, "un_batch_to_individual_items": 7.313945115311723e-06, "normalize_and_clip_actions": 8.805812832378751e-06, "remove_single_ts_time_rank_from_batch": 1.2774922699447475e-05, "tensor_to_numpy": 1.6758874264904688e-05}}, "connector_pipeline_timer": 0.00012764458500092517}, "num_env_steps_sampled": 400, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "num_agent_steps_sampled": {"default_agent": 400}, "env_step_timer": 1.625200010260332e-05, "agent_episode_returns_mean": {"default_agent": 0.65}, "sample": 0.1290024190485322, "weights_seq_no": 19.0, "time_between_sampling": 9.297070887531067}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "b509c_00000", "date": "2025-08-11_18-32-18", "timestamp": 1754929938, "time_this_iter_s": 9.768074989318848, "time_total_s": 177.02822279930115, "pid": 11229, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x383ebd8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 177.02822279930115, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 43.40714285714285, "ram_util_percent": 78.77857142857144}}
{"timers": {"training_iteration": 9.744880297445949, "restore_env_runners": 9.903508033802355e-06, "training_step": 9.744669040031896, "env_runner_sampling_timer": 1.6506336093104665, "learner_update_timer": 7.914309623535016, "synch_weights": 0.0015938589571000217, "restore_eval_env_runners": 5.730921780255576e-05, "evaluation_iteration": 0.1412195956577814, "synch_eval_env_connectors": 0.0003848936888773971, "synch_env_connectors": 5.435483633094706e-06}, "env_runners": {"num_episodes_lifetime": -555250.0, "rlmodule_inference_timer": 3.132408046857686e-05, "episode_duration_sec_mean": 0.005232025827281178, "module_episode_returns_mean": {"default_policy": 1.3400000000000003}, "episode_return_min": -10.5, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2461647821061687e-05, "add_states_from_episodes_to_batch": 2.713269932412701e-06, "numpy_to_tensor": 1.2365355269074756e-05, "add_observations_from_episodes_to_batch": 2.815098692110931e-06, "add_time_dim_to_batch_and_zero_pad": 7.100398641599625e-06}}, "connector_pipeline_timer": 6.006515859867313e-05}, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0452247617739709e-05, "un_batch_to_individual_items": 6.630636723424109e-06, "tensor_to_numpy": 1.5175858913029658e-05, "normalize_and_clip_actions": 7.971740379229681e-06, "remove_single_ts_time_rank_from_batch": 1.1909160679671122e-05, "get_actions": 3.8322759230918325e-05}}, "connector_pipeline_timer": 0.00011730792685014715}, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "env_step_timer": 1.3895561521410056e-05, "time_between_sampling": 0.032963070810744594, "episode_return_mean": 1.3400000000000003, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_max": 9.5, "sample": 0.005852851976982671, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "env_reset_timer": 4.260051364304329e-05, "num_env_steps_sampled_lifetime": -11105000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "agent_episode_returns_mean": {"default_agent": 1.3400000000000003}, "weights_seq_no": 19.0, "episode_len_mean": 20.0, "num_episodes": 250.0, "num_env_steps_sampled_lifetime_throughput": 3226.966155035345}, "__all_modules__": {"learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"connector_pipeline_timer": 0.1348833640200557, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008900724631991605, "add_observations_from_episodes_to_batch": 0.0009000708981831228, "add_columns_from_episodes_to_train_batch": 0.04163330174854788, "add_time_dim_to_batch_and_zero_pad": 0.07561000716760563, "add_states_from_episodes_to_batch": 0.003484238527411751, "batch_individual_items": 0.0040692315539928164, "numpy_to_tensor": 7.048324924641083e-05}}}, "learner_connector_sum_episodes_length_out": 5250.0}, "learners": {"intrinsic_reward_module": {"num_trainable_parameters": 8266, "curr_entropy_coeff": 0.0015431216992, "total_loss": 0.0, "weights_seq_no": 20.0, "default_optimizer_learning_rate": 0.0002715581955, "num_module_steps_trained_lifetime": 119700, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 997.6479298448816, "num_module_steps_trained": 5985, "gradients_default_optimizer_global_norm": 0.0, "num_module_steps_trained_lifetime_throughput": 770.1980113008585}, "differentiable_learners": {"intrinsic_attention_ppo_learner": {"__all_modules__": {"num_env_steps_trained_lifetime": 3960000, "num_module_steps_trained": 71820, "num_env_steps_trained": 198000, "num_module_steps_trained_lifetime": 1436400, "num_env_steps_trained_lifetime_throughput": 45706.0930147647}, "default_policy": {"use_intrinsic_rewards": 1.0, "policy_loss": -0.0016146181151270866, "weights_seq_no": 120.0, "vf_explained_var": 0.0013182759284973145, "module_train_batch_size_mean": 997.4978492525759, "total_loss": 0.2766035199165344, "num_module_steps_trained_lifetime": 718200, "diff_num_grad_updates_vs_sampler_policy": 101.0, "vf_loss_unclipped": 43.550724029541016, "mean_kl_loss": 0.00012510565284173936, "entropy": 0.6715667843818665, "num_module_steps_trained": 35910, "vf_loss": 0.3584286868572235}, "intrinsic_reward_module": {"total_loss": 0.0, "weights_seq_no": 120.0, "num_module_steps_trained_lifetime": 718200, "diff_num_grad_updates_vs_sampler_policy": 101.0, "module_train_batch_size_mean": 997.4978492525759, "num_module_steps_trained": 35910}}}, "__all_modules__": {"num_module_steps_trained": 11970, "num_trainable_parameters": 24861, "num_env_steps_trained": 33000, "num_module_steps_trained_lifetime": 239400, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 660000, "num_env_steps_trained_lifetime_throughput": 4247.701332308861, "num_module_steps_trained_throughput": 19877319.354856964, "num_module_steps_trained_lifetime_throughput": 12430954.819387797}, "default_policy": {"weights_seq_no": 20.0, "vf_explained_var": -0.0025883913040161133, "module_train_batch_size_mean": 997.6479298448816, "total_loss": 0.27639469504356384, "num_module_steps_trained_lifetime": 119700, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 43.43452072143555, "mean_kl_loss": 0.00013930124987382442, "curr_kl_coeff": 1.5409844422720198e-07, "entropy": 0.671387255191803, "num_module_steps_trained": 5985, "vf_loss": 0.35830727219581604, "num_trainable_parameters": 16595, "curr_entropy_coeff": 0.0015431216992, "use_intrinsic_rewards": 0.0, "policy_loss": -0.0017089344328269362, "num_module_steps_trained_lifetime_throughput": 770.1920993227952}, "IntrinsicAttentionMask": [[[0.09089532494544983, 0.09077240526676178, 0.0908297672867775, 0.09097406268119812, 0.09085103869438171, 0.09081491827964783, 0.09087231010198593, 0.09101667255163193, 0.09098049253225327, 0.09099113941192627, 0.09100179374217987], [0.0908760279417038, 0.09058204293251038, 0.09071916341781616, 0.09106463938951492, 0.09077003598213196, 0.09068366140127182, 0.09082093089818954, 0.09116679430007935, 0.09108003973960876, 0.09110557287931442, 0.09113111346960068], [0.09088505804538727, 0.0906708836555481, 0.09077080339193344, 0.09102236479520798, 0.09080786257982254, 0.09074493497610092, 0.09084493666887283, 0.09109670668840408, 0.09103357791900635, 0.09105215966701508, 0.0910707488656044], [0.09090761095285416, 0.09089434891939163, 0.09090054035186768, 0.09091608971357346, 0.09090283513069153, 0.09089893847703934, 0.09090512245893478, 0.09092067927122116, 0.09091678261756897, 0.0909179300069809, 0.09091907739639282], [0.09088838845491409, 0.0907038077712059, 0.09078992903232574, 0.09100668877363205, 0.09082186967134476, 0.09076763689517975, 0.09085381776094437, 0.09107072651386261, 0.09101634472608566, 0.09103235602378845, 0.09104835987091064], [0.09088272601366043, 0.09064788371324539, 0.09075744450092316, 0.09103330224752426, 0.09079807251691818, 0.09072907269001007, 0.0908387303352356, 0.091114841401577, 0.09104560315608978, 0.09106598794460297, 0.09108636528253555], [0.09089172631502151, 0.0907367616891861, 0.09080906957387924, 0.09099102020263672, 0.09083588421344757, 0.09079035371541977, 0.0908627063035965, 0.09104476124048233, 0.09099912643432617, 0.09101255983114243, 0.09102599322795868], [0.09091423451900482, 0.09096035361289978, 0.09093882143497467, 0.0908847376704216, 0.09093084186315536, 0.09094439446926117, 0.09092286229133606, 0.09086879342794418, 0.0908823311328888, 0.09087834507226944, 0.09087435901165009], [0.09090860933065414, 0.09090431034564972, 0.09090632200241089, 0.09091135859489441, 0.09090705960988998, 0.0909058004617691, 0.09090780466794968, 0.0909128487110138, 0.09091158956289291, 0.09091195464134216, 0.09091232717037201], [0.09091026335954666, 0.09092080593109131, 0.09091588854789734, 0.09090352058410645, 0.0909140557050705, 0.09091715514659882, 0.09091223776340485, 0.09089987725019455, 0.09090296924114227, 0.09090206027030945, 0.09090114384889603], [0.09091192483901978, 0.0909373089671135, 0.09092546254396439, 0.09089569002389908, 0.0909210667014122, 0.09092852473258972, 0.09091667085886002, 0.0908869057893753, 0.09089435636997223, 0.09089216589927673, 0.09088996797800064]], [[0.09082788974046707, 0.09080412983894348, 0.09092977643013, 0.09090600162744522, 0.09082511067390442, 0.09095078706741333, 0.09086985886096954, 0.09093400835990906, 0.09126486629247665, 0.09096340835094452, 0.09072409570217133], [0.09077725559473038, 0.09073873609304428, 0.09094258397817612, 0.09090398997068405, 0.09077276289463043, 0.09097668528556824, 0.09084535390138626, 0.09094944596290588, 0.09148707240819931, 0.09099717438220978, 0.09060897678136826], [0.09104442596435547, 0.09108419716358185, 0.09087411314249039, 0.0909138098359108, 0.09104906767606735, 0.09083905816078186, 0.09097420424222946, 0.0908670574426651, 0.09031761437654495, 0.09081801772117615, 0.09121843427419662], [0.0909939855337143, 0.091018907725811, 0.09088721126317978, 0.0909121111035347, 0.09099689871072769, 0.09086523205041885, 0.09094996750354767, 0.0908827930688858, 0.09053781628608704, 0.0908520296216011, 0.09110299497842789], [0.09082198888063431, 0.09079650789499283, 0.09093128889799118, 0.09090577811002731, 0.09081901609897614, 0.09095382690429688, 0.09086701273918152, 0.09093581885099411, 0.09129078686237335, 0.09096736460924149, 0.09071066230535507], [0.0910889282822609, 0.09114183485507965, 0.09086247533559799, 0.090915247797966, 0.09109510481357574, 0.09081587940454483, 0.09099554270505905, 0.09085309505462646, 0.0901234820485115, 0.09078790992498398, 0.0913204476237297], [0.09091722220182419, 0.0909196063876152, 0.09090700000524521, 0.09090938419103622, 0.09091749787330627, 0.09090489149093628, 0.09091301262378693, 0.09090658277273178, 0.09087347984313965, 0.0909036323428154, 0.09092764556407928], [0.09105337411165237, 0.09109579026699066, 0.09087177366018295, 0.09091410040855408, 0.09105832129716873, 0.09083439409732819, 0.09097848832607269, 0.09086424857378006, 0.0902785211801529, 0.09081195294857025, 0.09123894572257996], [0.09174878150224686, 0.09199938923120499, 0.09068217128515244, 0.09092986583709717, 0.0917779952287674, 0.09046394377946854, 0.09130772948265076, 0.09063822776079178, 0.08726929128170013, 0.09033313393592834, 0.09284940361976624], [0.09111564606428146, 0.09117645025253296, 0.09085546433925629, 0.09091608971357346, 0.09112274646759033, 0.09080193936824799, 0.09100833535194397, 0.09084469079971313, 0.09000707417726517, 0.09076981246471405, 0.0913817510008812], [0.090606190264225, 0.09051800519227982, 0.09098517149686813, 0.09089662879705429, 0.09059589356184006, 0.09106346219778061, 0.0907621756196022, 0.09100091457366943, 0.09223965555429459, 0.09111050516366959, 0.0902213305234909]], [[0.09088319540023804, 0.09089384227991104, 0.09095127880573273, 0.09082828462123871, 0.09097257256507874, 0.09093640744686127, 0.09099387377500534, 0.09100452810525894, 0.09083469957113266, 0.09084533900022507, 0.09085597097873688], [0.09088632464408875, 0.09089567512273788, 0.09094619005918503, 0.09083802253007889, 0.0909649133682251, 0.09093311429023743, 0.09098364412784576, 0.0909930095076561, 0.09084367007017136, 0.0908530205488205, 0.09086237847805023], [0.09090317785739899, 0.09090560674667358, 0.09091871976852417, 0.09089062362909317, 0.09092358499765396, 0.09091532975435257, 0.09092844277620316, 0.09093087911605835, 0.09089209139347076, 0.09089452028274536, 0.09089695662260056], [0.0908670574426651, 0.09088432043790817, 0.09097754955291748, 0.09077796339988708, 0.09101212024688721, 0.09095341712236404, 0.09104670584201813, 0.09106400609016418, 0.09078837186098099, 0.09080562740564346, 0.09082288295030594], [0.09090942144393921, 0.09090928733348846, 0.09090854972600937, 0.09091012924909592, 0.09090827405452728, 0.09090873599052429, 0.0909079983830452, 0.09090785682201385, 0.09091004729270935, 0.09090990573167801, 0.09090977162122726], [0.09089881926774979, 0.09090304374694824, 0.09092583507299423, 0.09087701886892319, 0.09093428403139114, 0.09091993421316147, 0.09094273298978806, 0.09094695746898651, 0.09087956696748734, 0.09088379144668579, 0.09088800847530365], [0.09091566503047943, 0.09091296046972275, 0.09089836478233337, 0.09092963486909866, 0.09089295566082001, 0.09090214222669601, 0.09088755398988724, 0.09088484942913055, 0.09092800319194794, 0.09092529863119125, 0.09092259407043457], [0.09091877937316895, 0.09091479331254959, 0.09089327603578568, 0.09093938022851944, 0.09088529646396637, 0.09089884161949158, 0.09087732434272766, 0.0908733382821083, 0.09093697369098663, 0.09093298763036728, 0.09092899411916733], [0.09086893498897552, 0.09088543057441711, 0.09097447246313095, 0.09078384190797806, 0.09100749343633652, 0.09095142781734467, 0.09104052931070328, 0.09105704724788666, 0.09079378098249435, 0.09081026166677475, 0.09082674235105515], [0.09087207168340683, 0.09088727086782455, 0.09096938371658325, 0.09079358726739883, 0.09099983423948288, 0.09094812721014023, 0.0910302922129631, 0.09104552865028381, 0.09080275893211365, 0.09081795066595078, 0.0908331498503685], [0.09087519347667694, 0.09088911861181259, 0.09096430242061615, 0.09080333262681961, 0.09099217504262924, 0.09094484150409698, 0.09102006256580353, 0.09103401005268097, 0.09081172943115234, 0.0908256471157074, 0.09083956480026245]], [[0.09092092514038086, 0.0910666361451149, 0.09090267866849899, 0.0909336730837822, 0.09092454612255096, 0.09098993241786957, 0.09086619317531586, 0.09089717268943787, 0.09046796709299088, 0.09085888415575027, 0.09117135405540466], [0.09089392423629761, 0.09071286022663116, 0.09091664850711823, 0.09087806940078735, 0.09088942408561707, 0.09080809354782104, 0.09096211194992065, 0.0909235030412674, 0.09146098047494888, 0.09097122400999069, 0.09058313816785812], [0.0909242108464241, 0.09111097455024719, 0.09090082347393036, 0.09094053506851196, 0.09092884510755539, 0.09101264923810959, 0.09085407853126526, 0.09089376777410507, 0.09034416079521179, 0.09084471315145493, 0.09124524891376495], [0.090918630361557, 0.09103568643331528, 0.09090396761894226, 0.09092886745929718, 0.09092153608798981, 0.09097407013177872, 0.09087464958429337, 0.09089954197406769, 0.09055450558662415, 0.09086877852678299, 0.09111978858709335], [0.09092027693986893, 0.09105785191059113, 0.09090304374694824, 0.09093230962753296, 0.09092368930578232, 0.09098543226718903, 0.09086859971284866, 0.09089784324169159, 0.09049253165721893, 0.09086169302463531, 0.09115671366453171], [0.09090832620859146, 0.0908990427851677, 0.09090948849916458, 0.0909075140953064, 0.09090809524059296, 0.09090393036603928, 0.09091181308031082, 0.09090984612703323, 0.0909372866153717, 0.09091228246688843, 0.09089238196611404], [0.09093069285154343, 0.09119963645935059, 0.09089703857898712, 0.09095419943332672, 0.09093736112117767, 0.09105801582336426, 0.0908297672867775, 0.09088688343763351, 0.09009698033332825, 0.09081629663705826, 0.0913931354880333], [0.0909251868724823, 0.09112434834241867, 0.09090025722980499, 0.09094260632991791, 0.09093012660741806, 0.09101948887109756, 0.09085041284561157, 0.0908927321434021, 0.0903068259358406, 0.0908404216170311, 0.09126754850149155], [0.09099549055099487, 0.09216909855604172, 0.09084945172071457, 0.09109760075807571, 0.09102446585893631, 0.09154964983463287, 0.09055805951356888, 0.09080541878938675, 0.08743027597665787, 0.09049976617097855, 0.09302067756652832], [0.0909319743514061, 0.09121739864349365, 0.09089626371860504, 0.0909569188952446, 0.09093905240297318, 0.09106709063053131, 0.09082487970590591, 0.09088548272848129, 0.09004749357700348, 0.09081057459115982, 0.09142278879880905], [0.09087362140417099, 0.09045888483524323, 0.09092573821544647, 0.09083724766969681, 0.09086329489946365, 0.09067688882350922, 0.0910300686955452, 0.09094147384166718, 0.09217940270900726, 0.09105098992586136, 0.09016239643096924]], [[0.09085891395807266, 0.09086955338716507, 0.09092697501182556, 0.09093762189149857, 0.09094826132059097, 0.09077853709459305, 0.09096956253051758, 0.09098020941019058, 0.09094404429197311, 0.09082105755805969, 0.09096533805131912], [0.09086496382951736, 0.0908743143081665, 0.09092481434345245, 0.09093417227268219, 0.09094353765249252, 0.09079428017139435, 0.09096226096153259, 0.09097162634134293, 0.09093982726335526, 0.09083166718482971, 0.09095855057239532], [0.09089762717485428, 0.09090005606412888, 0.09091316908597946, 0.09091560542583466, 0.09091803431510925, 0.09087925404310226, 0.09092289209365845, 0.09092532843351364, 0.09091707319021225, 0.09088897705078125, 0.09092193841934204], [0.09090368449687958, 0.0909048318862915, 0.09091101586818695, 0.09091216325759888, 0.0909133106470108, 0.09089501202106476, 0.09091560542583466, 0.09091675281524658, 0.09091285616159439, 0.09089960157871246, 0.09091515094041824], [0.09090973436832428, 0.09090960025787354, 0.09090885519981384, 0.0909087210893631, 0.09090858697891235, 0.09091076999902725, 0.09090831130743027, 0.09090817719697952, 0.09090863913297653, 0.09091022610664368, 0.09090836346149445], [0.09081312268972397, 0.09083344787359238, 0.09094322472810745, 0.09096357971429825, 0.09098394960165024, 0.09065958857536316, 0.09102468192577362, 0.09104505926370621, 0.09097587317228317, 0.09074079245328903, 0.09101660549640656], [0.09092184901237488, 0.0909191444516182, 0.09090454876422882, 0.09090184420347214, 0.09089913964271545, 0.09094230085611343, 0.09089373052120209, 0.0908910259604454, 0.09090021252632141, 0.0909314826130867, 0.09089480340480804], [0.09092789143323898, 0.09092389792203903, 0.09090238064527512, 0.09089838713407516, 0.09089440107345581, 0.09095805138349533, 0.0908864289522171, 0.09088243544101715, 0.09089598059654236, 0.09094209223985672, 0.09088800847530365], [0.09090734273195267, 0.09090771526098251, 0.09090972691774368, 0.09091009199619293, 0.09091046452522278, 0.09090453386306763, 0.09091120958328247, 0.09091158211231232, 0.09091032296419144, 0.09090601652860641, 0.09091106057167053], [0.09083734452724457, 0.09085255116224289, 0.0909346267580986, 0.09094984829425812, 0.09096506983041763, 0.09072250872850418, 0.09099551290273666, 0.09101074188947678, 0.09095903486013412, 0.0907832533121109, 0.09098947793245316], [0.09091943502426147, 0.09091723710298538, 0.09090539067983627, 0.09090319275856018, 0.09090100228786469, 0.09093603491783142, 0.0908966064453125, 0.090894415974617, 0.09090186655521393, 0.09092725068330765, 0.09089747816324234]], [[0.09090013802051544, 0.0910458117723465, 0.09099651873111725, 0.09091287851333618, 0.09090375900268555, 0.09085454046726227, 0.09084542095661163, 0.09087639302015305, 0.09056136757135391, 0.09095267951488495, 0.09115050733089447], [0.09091994166374207, 0.09073882550001144, 0.09080003947019577, 0.09090407937765121, 0.09091544151306152, 0.0909767746925354, 0.09098813682794571, 0.09094953536987305, 0.09134367108345032, 0.09085454046726227, 0.09060905873775482], [0.09091337025165558, 0.09084265679121017, 0.0908665657043457, 0.09090717881917953, 0.0909116119146347, 0.09093554317951202, 0.0909399762749672, 0.09092491120100021, 0.09107846766710281, 0.09088784456253052, 0.09079194813966751], [0.0909019187092781, 0.09101895242929459, 0.09097936004400253, 0.09091215580701828, 0.09090482443571091, 0.09086527675390244, 0.09085795283317566, 0.09088283777236938, 0.09062959998846054, 0.09094413369894028, 0.09110303968191147], [0.09090064465999603, 0.09103818982839584, 0.09099164605140686, 0.09091266989707947, 0.09090405702590942, 0.09085758775472641, 0.09084897488355637, 0.09087821841239929, 0.09058073163032532, 0.09095025062561035, 0.09113702923059464], [0.0908937156200409, 0.09114200621843338, 0.09105796366930008, 0.09091541916131973, 0.09089987725019455, 0.09081605076789856, 0.09080053120851517, 0.0908532664179802, 0.09031738340854645, 0.09098323434591293, 0.09132061898708344], [0.09089241176843643, 0.09116124361753464, 0.09107023477554321, 0.09091590344905853, 0.09089908003807068, 0.09080833941698074, 0.09079153090715408, 0.09084862470626831, 0.09026864916086197, 0.09098933637142181, 0.09135466068983078], [0.09089680761098862, 0.09109590202569962, 0.09102851897478104, 0.09091420471668243, 0.09090173989534378, 0.09083450585603714, 0.09082204848527908, 0.09086436033248901, 0.0904342457652092, 0.09096860140562057, 0.09123905748128891], [0.09084977209568024, 0.09176144003868103, 0.09145209193229675, 0.09092919528484344, 0.09087231010198593, 0.09056596457958221, 0.0905093103647232, 0.0907018780708313, 0.08875903487205505, 0.09117771685123444, 0.09242134541273117], [0.09090740978717804, 0.09093503654003143, 0.09092569351196289, 0.09090982377529144, 0.09090809524059296, 0.09089875221252441, 0.09089702367782593, 0.0909029021859169, 0.09084301441907883, 0.09091737866401672, 0.09095486998558044], [0.09093347936868668, 0.09051846712827682, 0.09065861254930496, 0.0908970832824707, 0.09092314541339874, 0.09106391668319702, 0.09109003096818924, 0.09100137650966644, 0.09190858900547028, 0.0907834991812706, 0.09022179245948792]]]}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"rlmodule_inference_timer": 3.06866407797709e-05, "episode_return_min": -14.5, "episode_return_mean": 0.65, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.0006654856343110784, "num_env_steps_sampled_lifetime": 100400, "num_episodes": 20, "episode_duration_sec_mean": 0.005303627474932, "module_episode_returns_mean": {"default_policy": 0.65}, "episode_len_min": 20, "episode_return_max": 13.5, "env_to_module_connector": {"connector_pipeline_timer": 5.867838191358381e-05, "timers": {"connectors": {"numpy_to_tensor": 1.1893140322176038e-05, "add_time_dim_to_batch_and_zero_pad": 6.943033687198701e-06, "batch_individual_items": 1.237907390580503e-05, "add_states_from_episodes_to_batch": 2.8040743828032066e-06, "add_observations_from_episodes_to_batch": 2.800998999922265e-06}}}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_episodes_lifetime": 400, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.589315966880361e-05, "listify_data_for_vector_env": 1.055511055358069e-05, "un_batch_to_individual_items": 6.55095328344845e-06, "normalize_and_clip_actions": 8.105513023010175e-06, "remove_single_ts_time_rank_from_batch": 1.1946202160793172e-05, "tensor_to_numpy": 1.5327936155655858e-05}}, "connector_pipeline_timer": 0.00011444783101330626}, "num_env_steps_sampled": 400, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "num_agent_steps_sampled": {"default_agent": 400}, "env_step_timer": 1.3945029052790988e-05, "agent_episode_returns_mean": {"default_agent": 0.65}, "sample": 0.1288439136077999, "weights_seq_no": 20.0, "time_between_sampling": 9.29743954782589}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "b509c_00000", "date": "2025-08-11_18-32-27", "timestamp": 1754929947, "time_this_iter_s": 9.427591800689697, "time_total_s": 186.45581459999084, "pid": 11229, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002715581955, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {"intrinsic_reward_coeff": 0.2795015916508}, "optimizer": {}, "_learner_class": "<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionMetaLearner.IntrinsicAttentionMetaLearner'>", "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x383ebd8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'default_policy': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.DifferentiablePPOModule.DifferentiablePPOModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config={'vf_share_layers': True, 'embedding_dim': 62, 'max_seq_len': 11, 'policy_head_hidden_sizes': [32], 'value_head_hidden_sizes': [101], 'embedding_hidden_sizes': [121]}, catalog_class=None, load_state_path=None, model_config_dict=None), 'intrinsic_reward_module': RLModuleSpec(module_class=<class 'source.intrinsic_attention_ppo.rl_modules.IntrinsicAttentionModule.IntrinsicAttentionModule'>, observation_space=None, action_space=None, inference_only=False, learner_only=True, model_config={'intrinsic_reward_network': {'encoder_hidden_sizes': [], 'encoding_dim': 1, 'num_heads': 1, 'head_hidden_sizes': None, 'layers': [{'type': 'attention'}]}, 'extrinsic_value_hidden_layers': [127, 60], 'vf_share_layers': True, 'max_seq_len': 11}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {"intrinsic_reward_module": {"lr": 0.0002715581955}}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.161583927863, "kl_target": 0.0201019014258, "vf_loss_coeff": 0.7790510010087, "entropy_coeff": 0.0015431216992, "clip_param": 0.2459212356676, "vf_clip_param": 0.3769744131561, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "differentiable_learner_configs": ["DifferentiableLearnerConfig(learner_class=<class 'source.intrinsic_attention_ppo.learners.IntrinsicAttentionPPOLearner.IntrinsicAttentionPPOLearner'>, learner_connector=None, add_default_connectors_to_learner_pipeline=True, is_multi_agent=False, policies_to_update=['default_policy'], lr=0.0060984166342, num_total_minibatches=0, num_epochs=1, minibatch_size=1000, shuffle_batch_per_epoch=True)"], "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9485408017724, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 186.45581459999084, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 44.3, "ram_util_percent": 79.45714285714284}}
